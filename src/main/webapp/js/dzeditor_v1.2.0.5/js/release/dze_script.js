var ID_CUSTOM_BOLD=0,ID_CUSTOM_ITALIC=1,ID_CUSTOM_UNDERLINE=2,ID_CUSTOM_JUSTIFY_LEFT=3,ID_CUSTOM_JUSTIFY_CENTER=4,ID_CUSTOM_JUSTIFY_RIGHT=5,ID_CUSTOM_INSERT_ORDERED_LIST=6,ID_CUSTOM_INSERT_UNORDERED_LIST=7,ID_CUSTOM_STRIKE=8,ID_CUSTOM_SUBSCRIPT=9,ID_CUSTOM_SUPERSCRIPT=10,ID_CUSTOM_OUTDENT=11,ID_CUSTOM_INDENT=12,ID_CUSTOM_UNDO=13,ID_CUSTOM_REDO=14,ID_CUSTOM_CUT=15,ID_CUSTOM_COPY=16,ID_CUSTOM_PASTE=17,ID_CUSTOM_DELETE=18,ID_CUSTOM_SELECT_ALL=19,ID_CUSTOM_FONT_NAME=20,ID_CUSTOM_FONT_SIZE=21,ID_CUSTOM_FORE_COLOR=
22,ID_CUSTOM_BACK_COLOR=23,ID_CUSTOM_TABLE_CREATE=24,ID_CUSTOM_TABLE_ADD_ROW=25,ID_CUSTOM_TABLE_DELETE_ROW=26,ID_CUSTOM_TABLE_ADD_COL=27,ID_CUSTOM_TABLE_DELETE_COL=28,ID_CUSTOM_TABLE_MERGE_CELL=29,ID_CUSTOM_TABLE_SPLIT_ROW=30,ID_CUSTOM_TABLE_SPLIT_COL=31,ID_CUSTOM_HYPERLINK_INSERT=32,ID_CUSTOM_HYPERLINK_REMOVE=33,ID_CUSTOM_IMAGE_INSERT=34,ID_CUSTOM_FLASH_INSERT=35,ID_CUSTOM_MEDIA_INSERT=36,ID_CUSTOM_FULLSCREEN=37,ID_CUSTOM_HELP=38,ID_CUSTOM_HELP_INFO=39,ID_CUSTOM_TABLE_CELL_PROPERTY=40,ID_CUSTOM_TABLE_PROPERTY=
41,ID_CUSTOM_MARK_INSERT=42,ID_CUSTOM_TABLE_TEMPLETE_INSERT=43,ID_CUSTOM_ADJUST_HWP_BASIC=44,ID_CUSTOM_ADJUST_DOC_BASIC=45,ID_CUSTOM_HORIZONTAL_RULE=46,ID_CUSTOM_LETTER_SPACING=47,ID_CUSTOM_LINE_HEIGHT=48,ID_CUSTOM_BODY_BG_COLOR=49,ID_CUSTOM_BODY_BG_IMAGE=50,ID_CUSTOM_DOC_TEMPLETE=51,ID_CUSTOM_PREVIEW=52,ID_CUSTOM_HIDE_MINIBAR=53,ID_CUSTOM_WRITE_AREA_SET=54,ID_CUSTOM_SHOW_EDITABLE_AREA=55,ID_CUSTOM_EXT_FUNCTION=56,ID_CUSTOM_CUSTOMER_TOOL_BUTTON_1=57,ID_CUSTOM_CUSTOMER_TOOL_BUTTON_2=58,ID_CUSTOM_CUSTOMER_TOOL_BUTTON_3=
59,ID_CUSTOM_SAVEAS=60,ID_CUSTOM_PRINT=61,ID_CUSTOM_CODE_INSPECT=62,ID_CUSTOM_Z_INDEX_SETTING=63,ID_CUSTOM_TEXT_BOX=64,ID_CUSTOM_OBJECT_POSITION=65,ID_CUSTOM_TABLE_ADD_ROW_DOWN=66,ID_CUSTOM_TABLE_ADD_COL_RIGHT=67,ID_CUSTOM_TABLE_COPY_ROW_DOWN=68,ID_CUSTOM_JUSTIFY_JUSTIFY=69,ID_CUSTOM_RESPONSIVE_WIDTH=70,ID_CUSTOM_DOC_LAYOUT=71,ID_CUSTOM_HEADING_SIZE=72,ID_CUSTOM_RESPONSIVE_SET=73,ID_CUSTOM_FORM_TABLE=74,ID_CUSTOM_FILE_NEW=75,ID_CUSTOM_FILE_OPEN=76,ID_CUSTOM_FILE_DOCFORM=77,ID_CUSTOM_FILE_LAYOUT=78,
ID_CUSTOM_EDIT_PASTESPECIAL=79,ID_CUSTOM_EDIT_SEARCH=80,ID_CUSTOM_EDIT_REPLACE=81,ID_CUSTOM_VIEW_EDIT=82,ID_CUSTOM_VIEW_HTML=83,ID_CUSTOM_INSERT_IMAGE=84,ID_CUSTOM_INSERT_OBJECT=85,ID_CUSTOM_INSERT_SPECIALCHARS=86,ID_CUSTOM_INSERT_BOOKMARK=87,ID_CUSTOM_STYLE_FONT=88,ID_CUSTOM_STYLE_PARAGRAPH=89,ID_CUSTOM_STYLE_STYLE=90,ID_CUSTOM_STYLE_UNORDEREDLIST=91,ID_CUSTOM_STYLE_ORDEREDLIST=92,ID_CUSTOM_STYLE_INCREASEORDER=93,ID_CUSTOM_STYLE_DECREASEORDER=94,ID_CUSTOM_TABLE_CELL_STYLE=95,ID_CUSTOM_TABLE_ADD_ROW_COL=
96,ID_CUSTOM_TABLE_DELETE_ROW_COL=97,ID_CUSTOM_TABLE_SPLIT_CELL=98,ID_CUSTOM_TABLE_CELL_SAME_HEIGHT=99,ID_CUSTOM_TABLE_CELL_SAME_WIDTH=100,ID_CUSTOM_TABLE_CELL_ALIGN=101,ID_CUSTOM_TABLE_MADANG=102,ID_CUSTOM_TABLE_FORMULA=103,ID_CUSTOM_TABLE_NUMBER_FORMAT=104,ID_CUSTOM_TABLE_SELECT=105,ID_CUSTOM_TABLE_CELL_HORIZONTALALIGN=106,ID_CUSTOM_TABLE_CELL_VERTICALALIGN=107,ID_CUSTOM_TABLE_BLOCK_FORMULA=108,ID_CUSTOM_TABLE_EASY_FORMULA=109,ID_CUSTOM_TABLE_SELECT_FORMULA=110,ID_CUSTOM_HELP_SHORTCUTS=111,ID_CUSTOM_INSERT_OBJECT_MOVIE=
112,ID_CUSTOM_INSERT_OBJECT_FILE=113,ID_CUSTOM_INSERT_OBJECT_HR=114,ID_CUSTOM_TABLE_CELL_HORIZONTAL_LEFT=115,ID_CUSTOM_TABLE_CELL_HORIZONTAL_CENTER=116,ID_CUSTOM_TABLE_CELL_HORIZONTAL_RIGHT=117,ID_CUSTOM_TABLE_CELL_VERTICAL_TOP=118,ID_CUSTOM_TABLE_CELL_VERTICAL_MIDDLE=119,ID_CUSTOM_TABLE_CELL_VERTICAL_BOTTOM=120,ID_CUSTOM_STYLE_STYLE_BASIC=121,ID_CUSTOM_STYLE_STYLE_SUBJECT1=122,ID_CUSTOM_STYLE_STYLE_SUBJECT2=123,ID_CUSTOM_STYLE_STYLE_SUBJECT3=124,ID_CUSTOM_STYLE_STYLE_SUBJECT4=125,ID_CUSTOM_STYLE_STYLE_SUBJECT5=
126,ID_CUSTOM_STYLE_INCREASE_FONTSIZE=127,ID_CUSTOM_STYLE_DECREASE_FONTSIZE=128,ID_CUSTOM_TABLE_BLOCK_SUM=129,ID_CUSTOM_TABLE_BLOCK_AVG=130,ID_CUSTOM_TABLE_BLOCK_MUL=131,ID_CUSTOM_TABLE_HORIZONTAL_SUM=132,ID_CUSTOM_TABLE_VERTICAL_SUM=133,ID_CUSTOM_TABLE_HORIZONTAL_AVERAGE=134,ID_CUSTOM_TABLE_VERTICAL_AVERAGE=135,ID_CUSTOM_TABLE_HORIZONTAL_MULTIPLY=136,ID_CUSTOM_TABLE_VERTICAL_MULTIPLY=137,ID_CUSTOM_TABLE_TABLE_ADD_NUMBER_FORMAT=138,ID_CUSTOM_TABLE_TABLE_REMOTE_NUMBER_FORMAT=139,ID_CUSTOM_FORM_TAG_SWITCH=
140,ID_CUSTOM_FORM_TAG_CHECKBOX=141,ID_CUSTOM_FORM_TAG_SELECT=142,ID_CUSTOM_MAPPING_CODE=143,ID_CUSTOM_MAPPING_CSS=144,ID_CUSTOM_TEMPLETE_FORM=145,ID_CUSTOM_INSERT_PARAGRAPH_STARTPOINT=146,ID_CUSTOM_INSERT_PARAGRAPH_ENDPOINT=147,ID_CUSTOM_TABLE_DELETE_TABLE=148,ID_CUSTOM_INSERT_PARAGRAPH=149,ID_CUSTOM_TABLE_CONVERT_TEXT=150,ID_CUSTOM_IMAGE_PROPERTY=151,ID_CUSTOM_FILE_PROPERTY=152,ID_CUSTOM_EDIT_REPLACE_CASE=153,ID_CUSTOM_TABLE_CELL_BACKCOLOR=154,ID_CUSTOM_TABLE_CELL_ALIGN_LEFT_TOP=155,ID_CUSTOM_TABLE_CELL_ALIGN_CENTER_TOP=
156,ID_CUSTOM_TABLE_CELL_ALIGN_RIGHT_TOP=157,ID_CUSTOM_TABLE_CELL_ALIGN_LEFT_MIDDLE=158,ID_CUSTOM_TABLE_CELL_ALIGN_CENTER_MIDDLE=159,ID_CUSTOM_TABLE_CELL_ALIGN_RIGHT_MIDDLE=160,ID_CUSTOM_TABLE_CELL_ALIGN_LEFT_BOTTOM=161,ID_CUSTOM_TABLE_CELL_ALIGN_CENTER_BOTTOM=162,ID_CUSTOM_TABLE_CELL_ALIGN_RIGHT_BOTTOM=163,ID_CUSTOM_DRAW_TABLE=164,ID_CUSTOM_INSERT_EMOTICONS=165,ID_CUSTOM_EDIT_PRIINT_PAGE_BREAK=166,ID_CUSTOM_VIEW_RULERBAR=167,ID_CUSTOM_STYLE_CASCADE_ORDERLIST=168,ID_CUSTOM_COPY_EXT=169,ID_CUSTOM_COPY_EXT_STYLE=
170,ID_CUSTOM_SELECT_PARAGRAPH=171,ID_CUSTOM_PASTE_EXT=172,ID_CUSTOM_TABLE_DELETE_EXT=173,ID_CUSTOM_TABLE_FORMULA_EXT=174,ID_CUSTOM_IMAGE_BORDER_TYPE=175,ID_CUSTOM_IMAGE_BORDER_THICKNESS=176,ID_CUSTOM_IMAGE_BORDER_COLOR=177,ID_CUSTOM_IMAGE_RESET_PICTURE=178,ID_CUSTOM_IMAGE_BORDER_NONE=179,ID_CUSTOM_IMAGE_BORDER_SOLID=180,ID_CUSTOM_IMAGE_BORDER_DASHED=181,ID_CUSTOM_IMAGE_BORDER_DOTTED=182,ID_CUSTOM_IMAGE_BORDER_DOUBLE=183,ID_CUSTOM_IMAGE_BORDER_1PX=184,ID_CUSTOM_IMAGE_BORDER_2PX=185,ID_CUSTOM_IMAGE_BORDER_3PX=
186,ID_CUSTOM_IMAGE_BORDER_4PX=187,ID_CUSTOM_IMAGE_BORDER_5PX=188,ID_CUSTOM_IMAGE_BORDER_6PX=189,ID_CUSTOM_IMAGE_BORDER_7PX=190,ID_CUSTOM_IMAGE_BORDER_8PX=191,ID_CUSTOM_IMAGE_BORDER_9PX=192,ID_CUSTOM_IMAGE_BORDER_10PX=193,ID_CUSTOM_TABLE_SELECT_CELL=194,ID_CUSTOM_TABLE_SELECT_ROW=195,ID_CUSTOM_TABLE_SELECT_COL=196,ID_CUSTOM_TABLE_SELECT_TABLE=197,ID_CUSTOM_IMAGE_TO_TABLE=198,ID_CUSTOM_TABLE_BORDER_THICKNESS=199,ID_CUSTOM_TABLE_BORDER_TYPE=200,ID_CUSTOM_TABLE_BORDER_COLOR=201,ID_CUSTOM_TABLE_STYLE=
202,ID_CUSTOM_IMAGE_HEIGHT=203,ID_CUSTOM_IMAGE_WIDTH=204,ID_CUSTOM_HELP_IMAGE_TO_TABLE=205,ID_CUSTOM_LOCK_EDIT_CELL=206,ID_CUSTOM_EXTERNAL_DATA_AREA=207,ID_CUSTOM_LOCK_EDIT_TABLE=208,ID_CUSTOM_INIT_CURSOR=209,ID_CUSTOM_INIT_CURSOR_REMOVE=210,ID_CUSTOM_PASTE_CELL=211,ID_CUSTOM_PASTE_CELL_INSERT=212,ID_CUSTOM_PASTE_CELL_OVER_ALL=213,ID_CUSTOM_PASTE_CELL_OVER_CONTENT=214,ID_CUSTOM_PASTE_CELL_INSERT_AS_TABLE=215,ID_CUSTOM_TABLE_CELL_INSERT=216,ID_CUSTOM_TABLE_CELL_DELETE=217,ID_CUSTOM_JUSTIFY_TABLE=218,
ID_CUSTOM_MODIFY_EXTERNAL_DATA_AREA=219,ID_CUSTOM_SET_LIST_START_NEW=220,ID_CUSTOM_SET_LIST_START_CONTINUE=221,ID_CUSTOM_INSERT_STAMP=222,ID_CUSTOM_MODIFY_STAMP=223,ID_CUSTOM_LOCK_EDIT_TABLE_SIZE=224,ID_CUSTOM_TOOLBAR_HANDLE=1111,ID_CUSTOM_TOOLBAR_SEPARATOR=1112,ID_CUSTOM_TOOLBAR_SPACE=1113,ID_CUSTOM_MENU_SEPARATOR=1114,ID_CUSTOM_TOOLBAR_CAPTION=1115;function fnGetEditorPreviewHTML(){return getEditorPreviewHTML(g_nActiveEditNumber)}
function fnAddHTMLCode(a){return addHTMLCode(a,g_nActiveEditNumber)}function fnGetEditorHTMLCode(a,b){return getEditorHTMLCode(a,b)}function fnSetEditorHTMLCode(a,b,c){return setEditorHTMLCode(a,b,c)}function fnInsertHTMLContent(a,b){insertHTMLContent(a,b)}function fnGetEditorText(a){return getEditorText(a)}function fnGetEditorSelectionText(a){return getEditorSelectionText(a)}function fnAddHTMLContent(a,b,c,d,e){return addHTMLContent(a,b,c,d,e)}
function fnReplaceHTMLContent(a,b){return replaceHTMLContent(a,b)}function fnGetEditorDocument(a){try{return g_objEditorDocument[a]}catch(b){}return null}function fnGetEditorWindow(a){try{return g_objEditWindow[a]}catch(b){}return null}function fnFindCountEditorText(a,b){try{return findCountEditorText(a,b)}catch(c){}return 0}function fnFindEditorText(a,b){try{return findEditorText(a,b)}catch(c){}return-1}
function fnFindEditorTextDetail(a,b,c,d,e,f){try{return findEditorTextDetail(a,b,c,d,e,f)}catch(g){}return-1}function fnReplaceEditorText(a,b,c){try{return replaceEditorText(a,b,c)}catch(d){}return-1}function fnReplaceEditorTextDetail(a,b,c,d,e,f,g){try{return replaceEditorTextDetail(a,b,c,d,e,f,g)}catch(h){}return-1}function fnReplaceAllEditorText(a,b,c){try{return replaceAllEditorText(a,b,c)}catch(d){}return-1}function fnResizeEditor(a,b,c){try{resizeEditor(a,b,c)}catch(d){}}
function fnGetEditorMode(a){try{return g_bEditMode[a]}catch(b){}}function fnIsActiveEditorMode(a){try{return g_bEditMode[a]?g_bActivate[a]:!1}catch(b){}return!1}function fnInitWebEditor(){try{initWebEditor()}catch(a){}}function fnGetImageList(a){try{return getImageList(a)}catch(b){}return null}function fnSetContentXHTMLFormat(a,b){try{return setContentXHTMLFormat(a,b)}catch(c){}}function fnBindExternalData(a,b,c){try{doBindExternalDataWithOption(a,b,c)}catch(d){}}
function fnGetModified(a){try{return getModified(a)}catch(b){}}function fnSetPreviewPageURL(a){try{dzeEnvConfig.strPreviewPageURL=a}catch(b){}}function fnGetEditorTagCount_script(a){try{return getEditorTagCount_script(a)}catch(b){}}function fnGetEditorTagCount_iframe(a){try{return getEditorTagCount_iframe(a)}catch(b){}}
function fnShowEditor(a){try{var b=getnEditNumberFromEditId(a);duzon_menubar.rebuildHiddenToolbar();duzon_dialog.nEditNumber=b;duzon_dialog.setEditorSelection();duzon_dialog.setEditorFocus();editor_onselectionchange(b)}catch(c){}};

var DZE_IFRAME_TMP_NO=9999,DZE_TAG_NONE=0,DZE_TAG_IMG=1,DZE_TAG_TABLE=2,DZE_TAG_TR=3,DZE_TAG_TD=4,DZE_TAG_TEXT=5,DZE_TAG_FILE=6,DZE_TAG_MEDIA=7,DZE_TAG_TEXTBOX=8,DZE_TAG_SHAPE=9,DZE_TAG_OBJECT=10,DZE_TAG_EMBEDE=11,DZE_TAG_DIV=11,DZE_OBJ_NONE=0,DZE_OBJ_IMG=1,DZE_OBJ_TABLE=2,DZE_OBJ_TR=3,DZE_OBJ_TD=4,DZE_OBJ_TEXT=5,DZE_OBJ_FILE=6,DZE_OBJ_MEDIA=7,DZE_OBJ_TEXTBOX=8,DZE_OBJ_SHAPE=9,DZE_OBJ_SHAPE_TEXT=10,DZE_OBJ_OBJECT=11,DZE_OBJ_EMBEDE=12,DZE_OBJ_DIV=13,DZE_OBJ_VIDEO=14,DZE_OBJ_CHART=15,DZE_OBJ_HR=16,
OUTLINE_INDICATOR={NONE:-1,LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3,TOP:4,RIGHT:5,BOTTOM:6,LEFT:7,ROTATION:8,TOTAL_COUNTS:9},OUTLINE_BORDER={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3,ROTATION:4,TOTAL_COUNTS:5},DZE_HTMLOBJ_TABLE="table",DZE_HTMLOBJ_IMG="img",DZE_HTMLOBJ_TR="tr",DZE_HTMLOBJ_TD="td",DZE_HTMLOBJ_TEXT="text",DZE_HTMLOBJ_BODY="body",DZE_HTMLOBJ_DIV="div",DZE_HTMLOBJ_P="p",DZE_HTMLOBJ_SPAN="span",DZE_HTMLOBJ_OL="ol",DZE_HTMLOBJ_UL="ul",DZE_HTMLOBJ_LI="li",DZE_TAG_FONT="font";
DZE_TAG_TABLE="table";var DZE_TAG_TBODY="tbody";DZE_TAG_TR="tr";DZE_TAG_IMG="img";DZE_TAG_TR="tr";DZE_TAG_TD="td";var DZE_TAG_TH="th";DZE_TAG_TEXT="text";var DZE_TAG_BODY="body";DZE_TAG_DIV="div";
var DZE_TAG_P="p",DZE_TAG_SPAN="span",DZE_TAG_OL="ol",DZE_TAG_UL="ul",DZE_TAG_LI="li",DZE_TAG_BR="br",DZE_TAG_H1="h1",DZE_TAG_H2="h2",DZE_TAG_H3="h3",DZE_TAG_H4="h4",DZE_TAG_H5="h5",DZE_TAG_H6="h6",DZE_TAG_VIDEO="video",DZE_TAG_SVG="svg",DZE_TAG_EMBED="embed",DZE_TAG_PATH="path",DZE_TAG_GRAPHIC="g",DZE_TAG_IFRAME="iframe",DZE_TAG_CANVAS="canvas",DZE_TAG_HTML="html",DZE_TAG_INPUT="input",DZE_TAG_TEXTAREA="textarea",DZE_TAG_SELECT="select",DZE_TAG_HR="hr",DZE_TAG_VIDEORESIZE="videoresize",DZETAG={A:"a"},
DZE_CUSTOM_ATT_ROWGROUP="dze_rowgroup",DZE_CUSTOM_ATT_PLACEHOLDER_SPAN="dze_placeholder_span",DZE_CUSTOM_ATT_PLACEHOLDER_TD="dze_placeholder_td",DZE_CUSTOM_ATT_FOCUS="dze_focus",DZE_CUSTOM_ATT_HASTEXT="dze_hastext",DZE_CUSTOM_ATT_PLACEHOLDER_IMG="dze_placeholder_img",DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO="dze_placeholder_video",DZE_CUSTOM_ATT_DESC="dze_desc",DZE_CUSTOM_ATT_PROTECT="dze_protect",DZE_CUSTOM_ATT_NEW_DOC_CREATE="newdoccreate",DZE_CUSTOM_VALUE_BIZBOX_REPORT_1="bizbox_report",DZE_CUSTOM_VALUE_BIZBOX_REPORT_5=
"bizbox_report_5",DZE_CUSTOM_VALUE_SCHEDULE="schedule",DZE_CUSTOM_VALUE_TASK="task",DZE_CUSTOM_VALUE_PREV_TASK="prev_task",DZE_CUSTOM_VALUE_REMARK="remark",DZE_CUSTOM_ATT_TABLE_RESIZE="dze_table_resize",DZE_EXTENDS_COLOR_PICKER=0,DZE_EXTENDS_EMOTICON=1,DZE_EXTENDS_COPY_EXT=3,DZE_EXTENDS_PASTE_EXT=4,DZE_EXTENDS_INSERT_PARAGRAPH=5,DZE_EXTENDS_TABLE_DELETE_EXT=6,DZE_EXTENDS_TABLE_SELECT=7,DZE_EXTENDS_TABLE_FORMULA_EXT=8,DZE_EXTENDS_TABLE_NUMBER_FORMAT=9,DZE_EXTENDS_IMAGE_BORDER_TYPE=10,DZE_EXTENDS_IMAGE_BORDER_THICKNESS=
11,DZE_EXTENDS_IMAGE_BORDER_COLOR=12,DZE_EXTENDS_TABLE_BORDER_THICKNESS=13,DZE_EXTENDS_TABLE_BORDER_TYPE=14,DZE_EXTENDS_TABLE_BORDER_COLOR=15,DZE_EXTENDS_TABLE_CELL_ALIGN=18,DZE_EXTENDS_TABLE_STYLE=19,DZE_DISPLAY_EXTENDS_NONE=0,DZE_DISPLAY_EXTENDS_COLOR_PICKER=1,DZE_DISPLAY_EXTENDS_EMOTICON=2,DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST=4,DZE_DISPLAY_EXTENDS_COMMON_POPUP=5,COMBOBOX_TYPE_BORDER_STYLE=0,COMBOBOX_TYPE_BORDER_WIDTH=1,KEEP_SOURCE_FORMMAT=0,KEEP_TEXT_ONLY=1,KEEP_ORG_TABLE_FORMMAT=2,PASTE_CELL_FORMMAT=
3,INSERT_AS_NEW_ROWS=4,INSERT_AS_NESTED_TABLE=5,DZE_FORMAT_TYPE="dze_format_type",DZE_FORMAT_PRECISION="dze_format_precision",DZE_FORMAT_SEPARATOR="dze_format_separator",DZE_FORMAT_SYMBOL="dze_format_symbol",DZE_EDIT_FORMAT="dze_edit_format",DZE_OLD_TYPE="dze_old_type",CONTRACTOR_TYPE=[{code:"N",name:"\uc77c\ubc18"},{code:"A",name:"\uac11"},{code:"B",name:"\uc744"},{code:"C",name:"\ubcd1"},{code:"D",name:"\uc815"},{code:"E",name:"\ubb34"},{code:"F",name:"\uae30"},{code:"G",name:"\uacbd"},{code:"H",
name:"\uc2e0"},{code:"I",name:"\uc784"},{code:"J",name:"\uacc4"}],FONT_WEIGHT_TYPE=[{value:"normal",name:"\ubcf4\ud1b5"},{value:"bold",name:"\uad75\uac8c"}],CUSTOM_INPUT_DIALOG={NAME:0,TAG_NAME:1,TAG_FORMAT:2,CONTRACTOR_TYPE:3,TEXT_LENGTH:4,FONT_FAMILY:5,FONT_SIZE:6,FONT_WEIGHT:7,READONLY_YES:8,READONLY_NO:9,DIALOG_MENU_COUNTS:10},DZE_DIR={NONE:0,LEFT:1,TOP:2,RIGHT:3,BOTTOM:4,HORIZONTAL:5,VERTICAL:6,reverse:function(a){switch(a){case this.LEFT:return this.RIGHT;case this.TOP:return this.BOTTOM;case this.RIGHT:return this.LEFT;
case this.BOTTOM:return this.TOP}},doAllDir:function(a){for(var c=[this.LEFT,this.TOP,this.RIGHT,this.BOTTOM],b=0;b<c.length;b++)a(c[b],this.getString(c[b]))},getString:function(a){switch(a){case this.LEFT:return"left";case this.TOP:return"top";case this.RIGHT:return"right";case this.BOTTOM:return"bottom"}}},BreakException={};

var ID_COMMAND_BOLD=0,ID_COMMAND_ITALIC=1,ID_COMMAND_UNDERLINE=2,ID_COMMAND_JUSTIFY_LEFT=3,ID_COMMAND_JUSTIFY_CENTER=4,ID_COMMAND_JUSTIFY_RIGHT=5,ID_COMMAND_INSERT_ORDERED_LIST=6,ID_COMMAND_INSERT_UNORDERED_LIST=7,ID_COMMAND_STRIKE=8,ID_COMMAND_SUBSCRIPT=9,ID_COMMAND_SUPERSCRIPT=10,ID_COMMAND_OUTDENT=11,ID_COMMAND_INDENT=12,ID_COMMAND_UNDO=13,ID_COMMAND_REDO=14,ID_COMMAND_CUT=15,ID_COMMAND_COPY=16,ID_COMMAND_PASTE=17,ID_COMMAND_DELETE=18,ID_COMMAND_SELECT_ALL=19,ID_COMMAND_FONT_NAME=20,ID_COMMAND_FONT_SIZE=
21,ID_COMMAND_FORE_COLOR=22,ID_COMMAND_BACK_COLOR=23,ID_COMMAND_TABLE_CREATE=24,ID_COMMAND_TABLE_ADD_ROW=25,ID_COMMAND_TABLE_DELETE_ROW=26,ID_COMMAND_TABLE_ADD_COL=27,ID_COMMAND_TABLE_DELETE_COL=28,ID_COMMAND_TABLE_MERGE_CELL=29,ID_COMMAND_TABLE_SPLIT_ROW=30,ID_COMMAND_TABLE_SPLIT_COL=31,ID_COMMAND_HYPERLINK_INSERT=32,ID_COMMAND_HYPERLINK_REMOVE=33,ID_COMMAND_IMAGE_INSERT=34,ID_COMMAND_FLASH_INSERT=35,ID_COMMAND_MEDIA_INSERT=36,ID_COMMAND_FULLSCREEN=37,ID_COMMAND_HELP=38,ID_COMMAND_HELP_INFO=39,ID_COMMAND_TABLE_CELL_PROPERTY=
40,ID_COMMAND_TABLE_PROPERTY=41,ID_COMMAND_MARK_INSERT=42,ID_COMMAND_TABLE_TEMPLETE_INSERT=43,ID_COMMAND_ADJUST_HWP_BASIC=44,ID_COMMAND_ADJUST_DOC_BASIC=45,ID_COMMAND_HORIZONTAL_RULE=46,ID_COMMAND_LETTER_SPACING=47,ID_COMMAND_LINE_HEIGHT=48,ID_COMMAND_BODY_BG_COLOR=49,ID_COMMAND_BODY_BG_IMAGE=50,ID_COMMAND_DOC_TEMPLETE=51,ID_COMMAND_PREVIEW=52,ID_COMMAND_HIDE_MINIBAR=53,ID_COMMAND_WRITE_AREA_SET=54,ID_COMMAND_SHOW_EDITABLE_AREA=55,ID_COMMAND_EXT_FUNCTION=56,ID_COMMAND_CUSTOMER_TOOL_BUTTON_1=57,ID_COMMAND_CUSTOMER_TOOL_BUTTON_2=
58,ID_COMMAND_CUSTOMER_TOOL_BUTTON_3=59,ID_COMMAND_SAVEAS=60,ID_COMMAND_PRINT=61,ID_COMMAND_CODE_INSPECT=62,ID_COMMAND_Z_INDEX_SETTING=63,ID_COMMAND_TEXT_BOX=64,ID_COMMAND_OBJECT_POSITION=65,ID_COMMAND_TABLE_ADD_ROW_DOWN=66,ID_COMMAND_TABLE_ADD_COL_RIGHT=67,ID_COMMAND_TABLE_COPY_ROW_DOWN=68,ID_COMMAND_JUSTIFY_JUSTIFY=69,ID_COMMAND_RESPONSIVE_WIDTH=70,ID_COMMAND_DOC_LAYOUT=71,ID_COMMAND_HEADING_SIZE=72,ID_COMMAND_RESPONSIVE_SET=73,ID_COMMAND_FORM_TABLE=74,ID_COMMAND_FILE_NEW=75,ID_COMMAND_FILE_OPEN=
76,ID_COMMAND_FILE_DOCFORM=77,ID_COMMAND_FILE_LAYOUT=78,ID_COMMAND_EDIT_PASTESPECIAL=79,ID_COMMAND_EDIT_SEARCH=80,ID_COMMAND_EDIT_REPLACE=81,ID_COMMAND_VIEW_EDIT=82,ID_COMMAND_VIEW_HTML=83,ID_COMMAND_INSERT_IMAGE=84,ID_COMMAND_INSERT_OBJECT=85,ID_COMMAND_INSERT_SPECIALCHARS=86,ID_COMMAND_INSERT_BOOKMARK=87,ID_COMMAND_STYLE_FONT=88,ID_COMMAND_STYLE_PARAGRAPH=89,ID_COMMAND_STYLE_STYLE=90,ID_COMMAND_STYLE_UNORDEREDLIST=91,ID_COMMAND_STYLE_ORDEREDLIST=92,ID_COMMAND_STYLE_INCREASEORDER=93,ID_COMMAND_STYLE_DECREASEORDER=
94,ID_COMMAND_TABLE_CELL_STYLE=95,ID_COMMAND_TABLE_ADD_ROW_COL=96,ID_COMMAND_TABLE_DELETE_ROW_COL=97,ID_COMMAND_TABLE_SPLIT_CELL=98,ID_COMMAND_TABLE_CELL_SAME_HEIGHT=99,ID_COMMAND_TABLE_CELL_SAME_WIDTH=100,ID_COMMAND_TABLE_CELL_ALIGN=101,ID_COMMAND_TABLE_MADANG=102,ID_COMMAND_TABLE_FORMULA=103,ID_COMMAND_TABLE_NUMBER_FORMAT=104,ID_COMMAND_TABLE_SELECT=105,ID_COMMAND_TABLE_CELL_HORIZONTALALIGN=106,ID_COMMAND_TABLE_CELL_VERTICALALIGN=107,ID_COMMAND_TABLE_BLOCK_FORMULA=108,ID_COMMAND_TABLE_EASY_FORMULA=
109,ID_COMMAND_TABLE_SELECT_FORMULA=110,ID_COMMAND_HELP_SHORTCUTS=111,ID_COMMAND_INSERT_OBJECT_MOVIE=112,ID_COMMAND_INSERT_OBJECT_FILE=113,ID_COMMAND_INSERT_OBJECT_HR=114,ID_COMMAND_TABLE_CELL_HORIZONTAL_LEFT=115,ID_COMMAND_TABLE_CELL_HORIZONTAL_CENTER=116,ID_COMMAND_TABLE_CELL_HORIZONTAL_RIGHT=117,ID_COMMAND_TABLE_CELL_VERTICAL_TOP=118,ID_COMMAND_TABLE_CELL_VERTICAL_MIDDLE=119,ID_COMMAND_TABLE_CELL_VERTICAL_BOTTOM=120,ID_COMMAND_STYLE_STYLE_BASIC=121,ID_COMMAND_STYLE_STYLE_SUBJECT1=122,ID_COMMAND_STYLE_STYLE_SUBJECT2=
123,ID_COMMAND_STYLE_STYLE_SUBJECT3=124,ID_COMMAND_STYLE_STYLE_SUBJECT4=125,ID_COMMAND_STYLE_STYLE_SUBJECT5=126,ID_COMMAND_STYLE_INCREASE_FONTSIZE=127,ID_COMMAND_STYLE_DECREASE_FONTSIZE=128,ID_COMMAND_TABLE_BLOCK_SUM=129,ID_COMMAND_TABLE_BLOCK_AVG=130,ID_COMMAND_TABLE_BLOCK_MUL=131,ID_COMMAND_TABLE_HORIZONTAL_SUM=132,ID_COMMAND_TABLE_VERTICAL_SUM=133,ID_COMMAND_TABLE_HORIZONTAL_AVERAGE=134,ID_COMMAND_TABLE_VERTICAL_AVERAGE=135,ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY=136,ID_COMMAND_TABLE_VERTICAL_MULTIPLY=
137,ID_COMMAND_TABLE_TABLE_ADD_NUMBER_FORMAT=138,ID_COMMAND_TABLE_TABLE_REMOTE_NUMBER_FORMAT=139,ID_COMMAND_FORM_TAG_SWITCH=140,ID_COMMAND_FORM_TAG_CHECKBOX=141,ID_COMMAND_FORM_TAG_SELECT=142,ID_COMMAND_MAPPING_CODE=143,ID_COMMAND_MAPPING_CSS=144,ID_COMMAND_TEMPLETE_FORM=145,ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT=146,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT=147,ID_COMMAND_TABLE_DELETE_TABLE=148,ID_COMMAND_INSERT_PARAGRAPH=149,ID_COMMAND_TABLE_CONVERT_TEXT=150,ID_COMMAND_IMAGE_PROPERTY=151,ID_COMMAND_FILE_PROPERTY=
152,ID_COMMAND_EDIT_REPLACE_CASE=153,ID_COMMAND_TABLE_CELL_BACKCOLOR=154,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP=155,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP=156,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP=157,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE=158,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE=159,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE=160,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM=161,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM=162,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM=163,ID_COMMAND_DRAW_TABLE=164,ID_COMMAND_INSERT_EMOTICONS=
165,ID_COMMAND_EDIT_PRIINT_PAGE_BREAK=166,ID_COMMAND_VIEW_RULERBAR=167,ID_COMMAND_STYLE_CASCADE_ORDERLIST=168,ID_COMMAND_COPY_EXT=169,ID_COMMAND_COPY_EXT_STYLE=170,ID_COMMAND_SELECT_PARAGRAPH=171,ID_COMMAND_PASTE_EXT=172,ID_COMMAND_TABLE_DELETE_EXT=173,ID_COMMAND_TABLE_FORMULA_EXT=174,ID_COMMAND_IMAGE_BORDER_TYPE=175,ID_COMMAND_IMAGE_BORDER_THICKNESS=176,ID_COMMAND_IMAGE_BORDER_COLOR=177,ID_COMMAND_IMAGE_RESET_PICTURE=178,ID_COMMAND_IMAGE_BORDER_NONE=179,ID_COMMAND_IMAGE_BORDER_SOLID=180,ID_COMMAND_IMAGE_BORDER_DASHED=
181,ID_COMMAND_IMAGE_BORDER_DOTTED=182,ID_COMMAND_IMAGE_BORDER_DOUBLE=183,ID_COMMAND_IMAGE_BORDER_1PX=184,ID_COMMAND_IMAGE_BORDER_2PX=185,ID_COMMAND_IMAGE_BORDER_3PX=186,ID_COMMAND_IMAGE_BORDER_4PX=187,ID_COMMAND_IMAGE_BORDER_5PX=188,ID_COMMAND_IMAGE_BORDER_6PX=189,ID_COMMAND_IMAGE_BORDER_7PX=190,ID_COMMAND_IMAGE_BORDER_8PX=191,ID_COMMAND_IMAGE_BORDER_9PX=192,ID_COMMAND_IMAGE_BORDER_10PX=193,ID_COMMAND_TABLE_SELECT_CELL=194,ID_COMMAND_TABLE_SELECT_COL=195,ID_COMMAND_TABLE_SELECT_ROW=196,ID_COMMAND_TABLE_SELECT_TABLE=
197,ID_COMMAND_IMAGE_TO_TABLE=198,ID_COMMAND_TABLE_BORDER_THICKNESS=199,ID_COMMAND_TABLE_BORDER_TYPE=200,ID_COMMAND_TABLE_BORDER_COLOR=201,ID_COMMAND_TABLE_STYLE=202,ID_COMMAND_IMAGE_HEIGHT=203,ID_COMMAND_IMAGE_WIDTH=204,ID_COMMAND_HELP_IMAGE_TO_TABLE=205,ID_COMMAND_LOCK_EDIT_CELL=206,ID_COMMAND_EXTERNAL_DATA_AREA=207,ID_COMMAND_LOCK_EDIT_TABLE=208,ID_COMMAND_INIT_CURSOR=209,ID_COMMAND_INIT_CURSOR_REMOVE=210,ID_COMMAND_PASTE_CELL=211,ID_COMMAND_PASTE_CELL_INSERT=212,ID_COMMAND_PASTE_CELL_OVER_ALL=
213,ID_COMMAND_PASTE_CELL_OVER_CONTENT=214,ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE=215,ID_COMMAND_TABLE_CELL_INSERT=216,ID_COMMAND_TABLE_CELL_DELETE=217,ID_COMMAND_JUSTIFY_TABLE=218,ID_COMMAND_MODIFY_EXTERNAL_DATA_AREA=219,ID_COMMAND_SET_LIST_START_NEW=220,ID_COMMAND_SET_LIST_START_CONTINUE=221,ID_COMMAND_INSERT_STAMP=222,ID_COMMAND_MODIFY_STAMP=223,ID_COMMAND_LOCK_EDIT_TABLE_SIZE=224,ID_SUPPORT_TYPE_GENERAL=0,ID_SUPPORT_TYPE_MULTI_CELL=1,ID_SUPPORT_TYPE_TABLE_OPERATION=2,ID_SUPPORT_TYPE_PERSISTENCE=
4,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT=0,ID_SUPPORT_CONTROL_TYPE_NO=1,ID_SUPPORT_CONTROL_TYPE_YES=2,ID_TYPE_TOOLBAR_BUTTON=1,ID_TYPE_TOOLBAR_COMBOBOX=2,ID_TYPE_TOOLBAR_DROPDOWN=3,ID_TYPE_TOOLBAR_NOTHING=4,ID_TYPE_TOOLBAR_SPINNER=5,ID_TYPE_TOOLBAR_HANDLE=1111,ID_TYPE_TOOLBAR_SEPARATOR=1112,ID_TYPE_TOOLBAR_SPACE=1113,ID_TYPE_MENU_SEPARATOR=1114,ID_TYPE_TOOLBAR_CAPTION=1115,ID_DISPLAY_TABBAR_PREVIEW=0,ID_DISPLAY_TABBAR_EDIT=1,ID_DISPLAY_TABBAR_SOURCE=2,g_bMenuBar_Display=!0,g_bTabBar_Display=!0,g_bToolBar1_Display=
!0,g_bToolBar2_Display=!0,g_bToolBar3_Display=!1,g_strBackColorCommand=g_browserCHK.ie?"BackColor":"hilitecolor",MOBILE_QUICK_DEFAULT=0,MOBILE_QUICK_FONT_SIZE_DOWN=1,MOBILE_QUICK_FONT_SIZE_UP=2,MOBILE_QUICK_BOLD=3,MOBILE_QUICK_ITALIC=4,MOBILE_QUICK_U_LINE=5,MOBILE_QUICK_M_LINE=6,MOBILE_QUICK_SUPER=7,MOBILE_QUICK_SUB=8,MOBILE_QUICK_TEXT_COLOR=9,MOBILE_QUICK_TEXT_BG_COLOR=10,MOBILE_QUICK_UNORDER=11,MOBILE_QUICK_ORDER=12,MOBILE_QUICK_L_ALIGN=13,MOBILE_QUICK_C_ALIGN=14,MOBILE_QUICK_R_ALIGN=15,MOBILE_QUICK_F_ALIGN=
16,MOBILE_QUICK_INDENT=17,MOBILE_QUICK_OUTENT=18,MOBILE_QUICK_TOGGLE=19,MOBILE_QUICK_FONT_SIZE_SELECT=20,MOBILE_QUICK_FONT_STYLE_SELECT=21,MOBILE_QUICK_INDENTATION=22,MOBILE_QUICK_DRAW_PEN=23,MOBILE_QUICK_DRAW_ERASER=24,MOBILE_QUICK_TABLE=25,MOBILE_QUICK_TABLE_BOTTOMROW_ADD=26,MOBILE_QUICK_TABLE_TOPROW_ADD=27,MOBILE_QUICK_TABLE_LEFTCOL_ADD=28,MOBILE_QUICK_TABLE_RIGHTCOL_ADD=29,MOBILE_QUICK_TABLE_ROW_DELETE=30,MOBILE_QUICK_TABLE_COL_DELETE=31,MOBILE_QUICK_TABLE_DELETE=32,MOBILE_QUICK_TABLE_MERGE_CELL=
33,MOBILE_QUICK_TABLE_SPLIT_CELL=34,MOBILE_QUICK_TABLE_SAME_ROW=35,MOBILE_QUICK_TABLE_SAME_COL=36,MOBILE_QUICK_SHOW_EDIT_MENU=37,MOBILE_QUICK_SHOW_EDIT_COLOR_MENU=38,MOBILE_QUICK_SHOW_DRAW_MENU=39,MOBILE_QUICK_UNDO=40,MOBILE_QUICK_REDO=41,MOBILE_QUICK_DRAW_DELETE_ALL=42,MOBILE_QUICK_DRAW_HIGHTLIGHT_PEN=43,MOBILE_QUICK_DRAW_CONTROLBTN=44,MOBILE_QUICK_UNORDER_CIRCLE=45,MOBILE_QUICK_UNORDER_SQUARE=46,MOBILE_QUICK_ORDER_UPPER_ALP=47,MOBILE_QUICK_ORDER_LOWER_ALP=48,MOBILE_QUICK_ORDER_ROMAN=49,MOBILE_QUICK_DRAW_SIZE_DOWN=
50,MOBILE_QUICK_DRAW_SIZE_UP=51,MOBILE_QUICK_TABLE_BORDER_STYLE_SELECT=52,MOBILE_QUICK_LIST_NONE=53,MOBILE_EDIT_MENU_TEXT=0,MOBILE_EDIT_MENU_PARAGRAPH=1,MOBILE_EDIT_MENU_TABLE=2,MOBILE_EDIT_MENU_QUICK_COLOR=3,EDIT_TEXT_GENERAL_CONTAINER=0,EDIT_TEXT_STYLE_CONTAINER=1,EDIT_TEXT_SIZE_CONTAINER=2,EDIT_TEXT_COLOR_CONTAINER=3,EDIT_TEXT_BG_COLOR_CONTAINER=4,EDIT_PARAGRAPH_SUIT_CONTAINER=5,EDIT_PARAGRAPH_HEAD_CONTAINER=6,EDIT_PARAGRAPH_INOUT_CONTAINER=7,EDIT_PARAGRAPH_LINE_HEIGHT_CONTAINER=8,EDIT_TABLE_ROW_COL=
9,EDIT_TABLE_MOD_CELL=10,EDIT_TABLE_PAINT_COLOR=11,EDIT_TABLE_EDGE_LINE=12,EDIT_TABLE_EDGE_SIZE=13,EDIT_TABLE_EDGE_COLOR=14,DIT_ERASER_SLIDER_BAR=15,MOBILE_QUICK_COLOR_NONE="rgba(0,0,0,0)",MOBILE_QUICK_COLOR_0="#fff",MOBILE_QUICK_COLOR_1="#000",MOBILE_QUICK_COLOR_2="#ff0402",MOBILE_QUICK_COLOR_3="#ffc000",MOBILE_QUICK_COLOR_4="#05a74d",MOBILE_QUICK_COLOR_5="#09aae7",MOBILE_QUICK_COLOR_6="#0a57af",MOBILE_QUICK_COLOR_7="#ff9d9d",MOBILE_QUICK_COLOR_8="#ffd968",MOBILE_QUICK_COLOR_9="#27e57c",MOBILE_QUICK_COLOR_10=
"#53d1ff",MOBILE_QUICK_COLOR_11="#3793f9",MOBILE_INSERT_IMAGE=0,MOBILE_INSERT_GALLERY=1,MOBILE_INSERT_CAMERA=2,MOBILE_INSERT_VIDEO_YOUTUBE=16,MOBILE_INSERT_TABLE=3,MOBILE_INSERT_HR_LINE=7,MOBILE_INSERT_VIDEO=14,MOBILE_INSERT_VIDEO_GALLERY=15,MOBILE_INSERT_SYMBOL=17,MOBILE_INSERT_SYMBOL_LIST=18,MOBILE_INSERT_LAYOUT=4,MOBILE_INSERT_IMAGECLOUD=11,MOBILE_INSERT_IMAGECLOUD_SEARCH=12,MOBILE_INSERT_IMAGECLOUD_ADD=13,MOBILE_INSERT_CHART=19,MOBILE_INSERT_LAYOUT_FORM=21,symbolArr="\u2022\u00b7\u300c\u300d\u300a\u300b\u2606\u2605\u25cb\u25cf\u25ce\u25c7\u25c6\u25a1\u25a0\u25b3\u25b2\u25bd\u25bc\u25c1\u25c0\u25b7\u25b6\u2192\u2190\u2191\u2193\u25c8\u25a3\u25d0\u25d1\u203b\u2234\u25c9\u260e\u260f\u326e\u326f\u3270\u3271\u3272\u3273\u3274\u3275\u3276\u3277\u3278\u3279\u327a\u327b\u2460\u2461\u2462\u2463\u2464\u2465\u2466\u2467\u2468\u2469\u246a\u246b\u246c\u246d\u246e".split(""),
g_arrIcon=null,g_arrConst=[],g_arrConst_TabMode=[];
function setInitConst(){try{g_arrIcon=["toolbar_btn_style_bold.png","toolbar_btn_style_italic.png","toolbar_btn_style_underline.png","toolbar_btn_style_p_left.png","toolbar_btn_style_p_center.png","toolbar_btn_style_p_right.png","toolbar_btn_style_orderlist.png","toolbar_btn_style_unorderlist.png","toolbar_btn_style_strike.png","toolbar_btn_style_subscript.png","toolbar_btn_style_superscript.png","toolbar_btn_style_p_outdent.png","toolbar_btn_style_p_indent.png","toolbar_btn_edit_undo.png","toolbar_btn_edit_redo.png",
"toolbar_btn_edit_cut.png","toolbar_btn_edit_copy.png","toolbar_btn_edit_paste.png","toolbar_btn_edit_delete.png","toolbar_btn_edit_select_all.png","","","toolbar_btn_style_forecolor.png","toolbar_btn_style_backcolor.png","toolbar_btn_table_create.png","toolbar_btn_table_add_row_up.png","toolbar_btn_table_delete_row.png","toolbar_btn_table_add_col_left.png","toolbar_btn_table_delete_col.png","toolbar_btn_table_merge_cell.png","toolbar_btn_table_split_row.gif","toolbar_btn_table_split_col.gif","toolbar_btn_insert_hyperlink.png",
"toolbar_btn_link_disconnect.gif","toolbar_btn_image.gif","toolbar_btn_flash.gif","toolbar_btn_media.gif","toolbar_btn_view_full_view.png","toolbar_btn_help.png","toolbar_btn_help_info.png","toolbar_btn_table_cell_property.png","toolbar_btn_table_property.png","toolbar_btn_mark.gif","toolbar_btn_table_templete_insert.gif","toolbar_btn_adjust_hwp_basic.gif","toolbar_btn_adjust_doc_basic.gif","toolbar_btn_horizontal_rule.gif",g_strBrowserLanguage+"/toolbar_btn_letter_space.gif",g_strBrowserLanguage+
"/toolbar_btn_line_height.gif","toolbar_btn_body_bg_color.gif","toolbar_btn_body_bg_image.gif","toolbar_btn_doc_templete.gif","","toolbar_btn_hide_minibar.gif","toolbar_btn_write_area_set.gif","toolbar_btn_show_editable_area.gif","","","","","toolbar_btn_file_save.png","toolbar_btn_file_print.png","toolbar_btn_code_inspect.gif","toolbar_btn_z_index.gif","toolbar_btn_text_box.gif","toolbar_btn_object_position.gif","toolbar_btn_table_add_row_down.png","toolbar_btn_table_add_col_right.png","toolbar_btn_table_copy_row_down.gif",
"toolbar_btn_style_p_justify.png","toolbar_btn_responsive_width.gif","toolbar_btn_doc_layout.gif","","toolbar_btn_responsive_set.gif","ico_form_layout.png","toolbar_btn_file_new.png","toolbar_btn_file_open.png","toolbar_btn_docform.png","toolbar_btn_file_layout.png","toolbar_btn_edit_paste_special.png","toolbar_btn_edit_find.png","toolbar_btn_edit_replace.png","","","toolbar_btn_insert_picture.png","","toolbar_btn_insert_specialchars.png","toolbar_btn_insert_bookmark.png","toolbar_btn_style_font.png",
"toolbar_btn_style_paragraph.png","toolbar_btn_style_style.png","toolbar_btn_style_unorderlist.png","toolbar_btn_style_orderlist.png","toolbar_btn_style_increaseorder.png","toolbar_btn_style_decreaseorder.png","toolbar_btn_table_cell_style.png","toolbar_btn_table_add_cell.png","toolbar_btn_table_delete_cell.png","toolbar_btn_table_split_cell.png","toolbar_btn_table_same_height.png","toolbar_btn_table_same_width.png","toolbar_btn_table_cell_align_center_middle.png","toolbar_btn_table_madang.png","toolbar_btn_table_formula.png",
"toolbar_btn_table_number_format.png","ico_arrow_select.png","toolbar_btn_table_cell_horizontal_center.png","toolbar_btn_table_cell_align.png","toolbar_btn_table_block_formula.png","toolbar_btn_table_easy_formula.png","toolbar_btn_table_select_formula.png","toolbar_btn_help_shortcut.png","toolbar_btn_insert_video.png","toolbar_btn_insert_file.png","toolbar_btn_insert_hr.png","toolbar_btn_table_cell_horizontal_left.png","toolbar_btn_table_cell_horizontal_center.png","toolbar_btn_table_cell_horizontal_right.png",
"toolbar_btn_table_cell_vertical_top.png","toolbar_btn_table_cell_vertical_middle.png","toolbar_btn_table_cell_vertical_bottom.png","","","","","","","toolbar_btn_style_increase_font.png","toolbar_btn_style_decrease_font.png","toolbar_btn_table_block_sum.png","toolbar_btn_table_block_avg.png","toolbar_btn_table_block_mul.png","toolbar_btn_table_easy_h_sum.png","toolbar_btn_table_easy_v_sum.png","toolbar_btn_table_easy_h_avg.png","toolbar_btn_table_easy_v_avg.png","toolbar_btn_table_easy_h_mul.png",
"toolbar_btn_table_easy_v_mul.png","","","ico_tag_mode.png","ico_checkbox.png","ico_selectbox.png","ico_form_code.png","ico_form_css.png","toolbar_btn_form_template.png","toolbar_tbn_insert_paragraph_startpoint.png","toolbar_tbn_insert_paragraph_endpoint.png","toolbar_btn_table_delete.png","","toolbar_btn_table_convert_text.png","context_btn_prop_picture.png","context_btn_prop_file.png","toolbar_btn_replace_case.png","toolbar_btn_table_backcolor.png","toolbar_btn_table_cell_align_left_top.png","toolbar_btn_table_cell_align_center_top.png",
"toolbar_btn_table_cell_align_right_top.png","toolbar_btn_table_cell_align_left_middle.png","toolbar_btn_table_cell_align_center_middle.png","toolbar_btn_table_cell_align_right_middle.png","toolbar_btn_table_cell_align_left_bottom.png","toolbar_btn_table_cell_align_center_bottom.png","toolbar_btn_table_cell_align_right_bottom.png","toolbar_btn_draw_table.png","toolbar_btn_emoticon.png","toolbar_btn_edit_page_divide.png","toolbar_btn_view_ruler.png","toolbar_btn_style_cascade_orderlist.png","toolbar_btn_edit_copy.png",
"toolbar_btn_edit_copy_ext_style.png","ico_paragraph.png","toolbar_btn_edit_paste.png","toolbar_btn_edit_delete.png","toolbar_btn_table_formula.png","ico_sort_line.png","ico_thin_line.png","ico_line_color.png","ico_picture_back.png","","","","","","","","","","","","","","","","ico_cell_select.png","ico_v_select.png","ico_h_select.png","ico_table_select.png","ico_export_form.png","ico_thin_line.png","ico_sort_line.png","ico_line_color.png","ico_table_style.png","","","ico_export_form.png","ico_cell_lock.png",
"ico_outdata.png","ico_table_lock.png","ico_init_cursor.png","ico_init_cursor_remove.png","ico_cell_copyoption.png","ico_cell_rownew.png","ico_cell_overwrite.png","ico_cell_copy.png","ico_cell_nest.png","toolbar_btn_table_add_cell.png","toolbar_btn_table_delete_cell.png","toolbar_btn_style_p_justify.png","ico_outdata.png","","","ico_stamp.png","ico_stamp.png","column_lock.png"],g_arrConst[0]=["Bold",ID_RES_CONST_STRING_BOLD,"TB_BOLD","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[1]=["Italic",ID_RES_CONST_STRING_ITALIC,"TB_ITALIC","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[2]=["Underline",ID_RES_CONST_STRING_UNDERLINE,"TB_UNDERLINE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[3]=["JustifyLeft",ID_RES_CONST_STRING_JUSTIFYLEFT,"TB_JUSTIFYLEFT","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[4]=["JustifyCenter",ID_RES_CONST_STRING_JUSTIFYCENTER,"TB_JUSTIFYCENTER","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[5]=["JustifyRight",ID_RES_CONST_STRING_JUSTIFYRIGHT,"TB_JUSTIFYRIGHT","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[6]=["InsertOrderedList",ID_RES_CONST_STRING_STYLE_ORDEREDLIST,"TB_ORDERLIST","fnHandler_Tb_OrderedList",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[7]=["InsertUnorderedList",ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,"TB_UNORDERLIST","fnHandler_Tb_UnorderedList",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[8]=["StrikeThrough",ID_RES_CONST_STRING_STRIKE,"TB_STRIKE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[9]=["Subscript",ID_RES_CONST_STRING_SUBSCRIPT,"TB_SUBSCRIPT",
"fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[10]=["Superscript",ID_RES_CONST_STRING_SUPERSCRIPT,"TB_SUPERSCRIPT","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[11]=["Outdent",ID_RES_CONST_STRING_OUTDENT,"TB_OUTDENT","fnHandler_Outdent",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[12]=["Indent",ID_RES_CONST_STRING_INDENT,
"TB_INDENT","fnHandler_Indent",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[13]=["Undo",ID_RES_CONST_STRING_UNDO,"TB_UNDO","fnHandler_Undo",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[14]=["Redo",ID_RES_CONST_STRING_REDO,"TB_REDO","fnHandler_Redo",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[15]=["Cut",ID_RES_CONST_STRING_CUT,"TB_CUT","fnHandler_SupportCommand",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[16]=["Copy",ID_RES_CONST_STRING_COPY,"TB_COPY","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[17]=["Paste",ID_RES_CONST_STRING_PASTE,"TB_PASTE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[18]=["Delete",ID_RES_CONST_STRING_DELETE,"TB_DELETE","fnHandler_SupportCommand",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[19]=["SelectAll",ID_RES_CONST_STRING_SELECT_ALL,"TB_SELECT_ALL","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[20]=["FontName",ID_RES_CONST_STRING_FONT_NAME,"TB_COMBOBOX_FONT_NAME","fnHandler_FontName",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[21]=["FontSize",ID_RES_CONST_STRING_FONT_SIZE,"TB_COMBOBOX_FONT_SIZE",
"fnHandler_FontSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[22]=["ForeColor",ID_RES_CONST_STRING_FORE_COLOR,"TB_SETFORECOLOR","fnHandler_ForeColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[23]=[g_strBackColorCommand,ID_RES_CONST_STRING_BACK_COLOR,"TB_SETBACKCOLOR","fnHandler_BackColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[24]=["",ID_RES_CONST_STRING_TABLE_CREATE,
"TB_TABLE_CREATE","fnHandler_TableCreate",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[25]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW,"TB_TABLE_ADD_ROW","fnHandler_TableAddRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[26]=["",ID_RES_CONST_STRING_TABLE_DELETE_ROW,"TB_TABLE_DELETE_ROW","fnHandler_TableDeleteRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[27]=
["",ID_RES_CONST_STRING_TABLE_ADD_COL,"TB_TABLE_ADD_COL","fnHandler_TableAddCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[28]=["",ID_RES_CONST_STRING_TABLE_DELETE_COL,"TB_TABLE_DELETE_COL","fnHandler_TableDeleteCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[29]=["",ID_RES_CONST_STRING_TABLE_MERGE_CELL,"TB_TABLE_MERGE_CELL","fnHandler_TableMergeCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[30]=["",ID_RES_CONST_STRING_TABLE_SPLIT_ROW,"TB_TABLE_SPLIT_ROW","fnHandler_TableSplitRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[31]=["",ID_RES_CONST_STRING_TABLE_SPLIT_COL,"TB_TABLE_SPLIT_COL","fnHandler_TableSplitCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[32]=["CreateLink",ID_RES_CONST_STRING_HYPERLINK_INSERT,"TB_HYPERLINK_INSERT","fnHandler_HyperLinkInsert",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[33]=["Unlink",ID_RES_CONST_STRING_HYPERLINK_REMOVE,"TB_HYPERLINK_REMOVE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[34]=["InsertImage",ID_RES_CONST_STRING_IMAGE_INSERT,"TB_IMAGE_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[35]=["InsertImage",ID_RES_CONST_STRING_FLASH_INSERT,
"TB_FLASH_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[36]=["InsertImage",ID_RES_CONST_STRING_MEDIA_INSERT,"TB_MEDIA_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[37]=["",ID_RES_CONST_STRING_FULLSCREEN,"TB_FULLSCREEN","fnHandler_FullScreen",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[38]=["",ID_RES_CONST_STRING_HELP,
"","fnHandler_Help",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[39]=["",ID_RES_CONST_STRING_PRODUCT_INFO,"","fnHandler_ProductInfo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[40]=["",ID_RES_CONST_STRING_TABLE_CELL_PROPERTY,"TB_TABLE_CELL_PROPERTY","fnHandler_TableCellProperty",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[41]=["",ID_RES_CONST_STRING_TABLE_PROPERTY,
"TB_TABLE_PROPERTY","fnHandler_TableProperty",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[42]=["",ID_RES_CONST_STRING_MARK_INSERT,"TB_MARK_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[43]=["",ID_RES_CONST_STRING_TABLE_TEMPLETE_INSERT,"TB_TABLE_TEMPLETE_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[44]=["",ID_RES_CONST_STRING_ADJUST_HWP_BASIC,
"TB_ADJUST_HWP_BASIC","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[45]=["",ID_RES_CONST_STRING_ADJUST_DOC_BASIC,"TB_ADJUST_DOC_BASIC","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[46]=["InsertHorizontalRule",ID_RES_CONST_STRING_HORIZONTAL_RULE,"TB_HORIZONTAL_RULE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[47]=["",
ID_RES_CONST_STRING_LETTER_SPACING,"TB_LETTER_SPACING","fnHandler_LetterSpacing",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[48]=["",ID_RES_CONST_STRING_LINE_HEIGHT,"TB_LINE_HEIGHT","fnHandler_LineHeight",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[49]=["",ID_RES_CONST_STRING_BODY_BG_COLOR,"TB_BODY_BG_COLOR","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[50]=
["",ID_RES_CONST_STRING_BODY_BG_IMAGE,"TB_BODY_BG_IMAGE","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[51]=["",ID_RES_CONST_STRING_DOC_TEMPLETE,"TB_DOC_TEMPLETE","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[52]=["",ID_RES_CONST_STRING_PREVIEW,"TB_PREVIEW","fnHandler_Preview",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[53]=
["",ID_RES_CONST_STRING_HIDE_MINIBAR,"TB_HIDE_MINIBAR","fnHandler_HideMiniBar",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[54]=["",ID_RES_CONST_STRING_WRITE_AREA_SET,"TB_WRITE_AREA_SET","fnHandler_WriteAreaSet",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[55]=["",ID_RES_CONST_STRING_SHOW_EDITABLE_AREA,"TB_SHOW_EDITABLE_AREA","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[56]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[57]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[58]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[59]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[60]=
["",ID_RES_CONST_STRING_SAVEAS,"TB_SAVEAS","fnHandler_SaveAs",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[61]=["",ID_RES_CONST_STRING_PRINT,"TB_PRINT","fnHandler_Print",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[62]=["","","TB_CODE_INSPECT","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[63]=["",ID_RES_CONST_STRING_Z_INDEX_SETTING,"TB_ZINDEXSETTING",
"fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[64]=["",ID_RES_CONST_STRING_TEXT_BOX,"TB_TEXT_BOX","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[65]=["",ID_RES_CONST_STRING_OBJECT_POSITION,"TB_OBJECT_POSITION","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[66]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW_DOWN,"TB_TABLE_ADD_ROW_DOWN",
"fnHandler_TableAddRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[67]=["",ID_RES_CONST_STRING_TABLE_ADD_COL_RIGHT,"TB_TABLE_ADD_COL_RIGHT","fnHandler_TableAddCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[68]=["",ID_RES_CONST_STRING_TABLE_COPY_ROW_DOWN,"TB_TABLE_COPY_ROW_DOWN","fnHandler_TableCopyRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[69]=
["JustifyLeft",ID_RES_CONST_STRING_JUSTIFYJUSTIFY,"TB_JUSTIFYJUSTIFY","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[70]=["",ID_RES_CONST_STRING_RESPONSIVE_WIDTH,"TB_RESPONSIVE_WIDTH","fnHandler_ResponsiveWidth",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[71]=["",ID_RES_CONST_STRING_DOC_LAYOUT,"TB_DOC_LAYOUT","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[72]=["formatBlock",ID_RES_CONST_STRING_HEADING_SIZE,"TB_COMBOBOX_HEADING_SIZE","fnHandler_HeadingSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX],g_arrConst[73]=["",ID_RES_CONST_STRING_RESPONSIVE_SET,"TB_RESPONSIVE_SET","fnHandler_ResponsiveSet",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[74]=["",ID_RES_CONST_STRING_FORM_TABLE,"TB_FORM_TABLE","fnHandler_FormTable",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[75]=["",ID_RES_CONST_STRING_FILE_NEW,"TB_FILE_NEW","fnHandler_NewFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[76]=["",ID_RES_CONST_STRING_FILE_OPEN,"TB_FILE_OPEN","fnHandler_OpenFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[77]=["",ID_RES_CONST_STRING_FILE_DOCFORM,"TB_FILE_DOCFORM","fnHandler_DocForm",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[78]=["",ID_RES_CONST_STRING_FILE_LAYOUT,"TB_FILE_LAYOUT","fnHandler_Layout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[79]=["",ID_RES_CONST_STRING_EDIT_PASTESPECIAL,"TB_EDIT_PASTESPECIAL","fnHandler_Pastespecial",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[80]=["",ID_RES_CONST_STRING_EDIT_SEARCH,"TB_EDIT_SEARCH","fnHandler_FindReplaceText",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[81]=["",ID_RES_CONST_STRING_EDIT_REPLACE,"TB_EDIT_REPLACE","fnHandler_FindReplaceText",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[82]=["",ID_RES_CONST_STRING_VIEW_EDIT,"TB_VIEW_EDIT","fnHandler_viewEdit",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[83]=["",ID_RES_CONST_STRING_VIEW_HTML,"TB_VIEW_HTML","fnHandler_viewHtml",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[84]=["InsertImage",ID_RES_CONST_STRING_INSERT_IMAGE,"TB_INSERT_IMAGE","fnHandler_InsertImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[85]=["",ID_RES_CONST_STRING_INSERT_OBJECT,"TB_INSERT_OBJECT","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[86]=["",ID_RES_CONST_STRING_INSERT_SPECIALCHARS,"TB_INSERT_SPECIALCHARS","fnHandler_SpecialChars",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[87]=["",ID_RES_CONST_STRING_INSERT_BOOKMARK,"TB_INSERT_BOOKMARK","fnHandler_InsertBookmark",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[88]=["",ID_RES_CONST_STRING_STYLE_FONT,"TB_STYLE_FONT","fnHandler_StyleFont",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[89]=["",ID_RES_CONST_STRING_STYLE_PARAGRAPH,"TB_STYLE_PARAGRAPH","fnHandler_StyleParagraph",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[90]=["",ID_RES_CONST_STRING_STYLE_STYLE,"TB_STYLE_STYLE","dummyFunc",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[91]=["",ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,"TB_STYLE_UNORDEREDLIST","fnHandler_StyleUnorderedList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[92]=["",ID_RES_CONST_STRING_STYLE_ORDEREDLIST,"TB_STYLE_ORDEREDLIST",
"fnHandler_StyleOrderedList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[93]=["",ID_RES_CONST_STRING_STYLE_INCREASEORDER,"TB_STYLE_INCREASEORDER","fnHandler_IncreaseOrder",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[94]=["",ID_RES_CONST_STRING_STYLE_DECREASEORDER,"TB_STYLE_DECREASEORDER","fnHandler_DecreaseOrder",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[95]=
["",ID_RES_CONST_STRING_TABLE_CELL_STYLE,"TB_TABLE_CELL_STYLE","fnHandler_TableCellStyle",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[96]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW_COL,"TB_TABLE_ADD_ROW_COL","fnHandler_TableAddRowCol",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[97]=["",ID_RES_CONST_STRING_TABLE_DELETE_ROW_COL,"TB_TABLE_DELETE_ROW_COL","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[98]=["",ID_RES_CONST_STRING_TABLE_SPLIT_CELL,"TB_TABLE_SPLIT_CELL","fnHandler_TableSplitCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[99]=["",ID_RES_CONST_STRING_TABLE_CELL_SAME_HEIGHT,"TB_TABLE_CELL_SAME_HEIGHT","fnHandler_TableCellSameHeight",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[100]=["",ID_RES_CONST_STRING_TABLE_CELL_SAME_WIDTH,"TB_TABLE_CELL_SAME_WIDTH",
"fnHandler_TableCellSameWidth",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[101]=["",ID_RES_CONST_STRING_TABLE_CELL_ALIGN,"TB_TABLE_CELL_ALIGN","fnHandler_TableCellAlign",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[102]=["",ID_RES_CONST_STRING_TABLE_MADANG,"TB_TABLE_MADANG","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[103]=["",ID_RES_CONST_STRING_TABLE_FORMULA,
"TB_TABLE_FORMULA","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[104]=["",ID_RES_CONST_STRING_TABLE_NUMBER_FORMAT,"TB_TABLE_NUMBER_FORMAT","fnHandler_TableNumberFormat",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[105]=["",ID_RES_CONST_STRING_TABLE_SELECT,"TB_TABLE_SELECT","fnHandler_TableSelect",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[106]=
["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTALALIGN,"TB_TABLE_CELL_HORIZONTALALIGN","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[107]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICALALIGN,"TB_TABLE_CELL_VERTICALALIGN","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[108]=["",ID_RES_CONST_STRING_TABLE_BLOCK_FORMULA,"TB_TABLE_BLOCK_FORMULA","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[109]=["",ID_RES_CONST_STRING_TABLE_EASY_FORMULA,"TB_TABLE_EASY_FORMULA","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[110]=["",ID_RES_CONST_STRING_TABLE_SELECT_FORMULA,"TB_TABLE_SELECT_FORMULA","fnHandler_TableSelectFormula",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[111]=["",ID_RES_CONST_STRING_HELP_SHORTCUTS,"","fnHandler_ShortCutsInfo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_NOTHING],g_arrConst[112]=["",ID_RES_CONST_STRING_INSERT_OBJECT_MOVIE,"TB_INSERT_OBJECT_MOVIE","fnHandler_InsertExtMovie",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[113]=["",ID_RES_CONST_STRING_INSERT_OBJECT_FILE,"TB_INSERT_OBJECT_FILE","fnHandler_InsertExtFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[114]=["",ID_RES_CONST_STRING_INSERT_OBJECT_HR,"TB_INSERT_OBJECT_HR","fnHandler_InsertHr",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[115]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_LEFT,"TB_TABLE_CELL_HORIZONTAL_LEFT","fnHandler_TableCellHorizontalLeft",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[116]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_CENTER,"TB_TABLE_CELL_HORIZONTAL_CENTER","fnHandler_TableCellHorizontalCenter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[117]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_RIGHT,
"TB_TABLE_CELL_HORIZONTAL_RIGHT","fnHandler_TableCellHorizontalRight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[118]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_TOP,"","fnHandler_TableCellVerticalTop",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[119]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_MIDDLE,"","fnHandler_TableCellVerticalMiddle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[120]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_BOTTOM,"","fnHandler_TableCellVerticalBottom",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[121]=["",ID_RES_CONST_STRING_STYLE_STYLE_BASIC,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[122]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT1,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[123]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT2,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[124]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT3,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[125]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT4,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[126]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT5,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[127]=["",ID_RES_CONST_STRING_STYLE_INCREASE_FONTSIZE,"TB_STYLE_INCREASE_FONTSIZE","fnHandler_StyleIncreaseFontSize",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[128]=["",ID_RES_CONST_STRING_STYLE_DECREASE_FONTSIZE,
"TB_STYLE_DECREASE_FONTSIZE","fnHandler_StyleDecreaseFontSize",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[129]=["",ID_RES_CONST_STRING_TABLE_BLOCK_SUM,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[130]=["",ID_RES_CONST_STRING_TABLE_BLOCK_AVG,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[131]=["",ID_RES_CONST_STRING_TABLE_BLOCK_MUL,
"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[132]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_SUM,"","fnHandler_TableHorizontalSum",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[133]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_SUM,"","fnHandler_TableVerticalSum",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[134]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_AVERAGE,
"","fnHandler_TableHorizontalAverage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[135]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_AVERAGE,"","fnHandler_TableVerticalAverage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[136]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_MULTIPLY,"","fnHandler_TableHorizontalMultiply",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[137]=
["",ID_RES_CONST_STRING_TABLE_VERTICAL_MULTIPLY,"","fnHandler_TableVerticalMultiply",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[138]=["",ID_RES_CONST_STRING_TABLE_ADD_NUMBER_FORMAT,"","fnHandler_TableAddNumberFormat",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[139]=["",ID_RES_CONST_STRING_TABLE_REMOVE_NUMBER_FORMAT,"","fnHandler_TableRemoveNumberFormat",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[140]=["",ID_RES_CONST_STRING_FORM_TAG_SWITCH,"TB_FORM_TAG_SWITCH","fnHandler_FormTagSwitch",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[141]=["",ID_RES_CONST_STRING_FORM_TAG_CHECKBOX,"TB_FORM_TAG_CHECKBOX","fnHandler_CheckBox",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[142]=["",ID_RES_CONST_STRING_FORM_TAG_SELECT,"TB_FORM_TAG_SELECT","fnHandler_SelectBox",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[143]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[144]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[145]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[146]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH_STARTPOINT,"TB_INSERT_PARAGRAPH_STARTPOINT","fnHandler_InsertParagraphStartPoint",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[147]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH_ENDPOINT,"TB_INSERT_PARAGRAPH_ENDPOINT","fnHandler_InsertParagraphEndPoint",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[148]=["",ID_RES_CONST_STRING_TABLE_DELETE_TABLE,"TB_TABLE_DELETE_TABLE","fnHandler_TableDelete",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[149]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH,
"TB_INSERT_PARAGRAPH","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[150]=["",ID_RES_CONST_STRING_TABLE_CONVERT_TEXT,"TB_TABLE_CONVERT_TEXT","fnHandler_TableConvertText",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[151]=["",ID_RES_PROP_INSERT_IMAGE,"TB_PROP_INSERT_IMAGE","fnHandler_InsertImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[152]=["",ID_RES_PROP_INSERT_FILE,
"TB_PROP_INSERT_FILE","fnHandler_InsertExtFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[153]=["",ID_RES_CONST_STRING_REPLACE_CASE,"TB_EDIT_REPLACE_CASE","fnHandler_ReplaceCase",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[154]=["",ID_RED_CONST_STRING_TABLE_CELL_BACKCOLOR,"TB_SETCELLBACKCOLOR","fnHandler_Table_Cell_BackColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],
g_arrConst[155]=["",ID_RED_CONST_STRING_ALIGN_LEFT_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[156]=["",ID_RED_CONST_STRING_ALIGN_CENTER_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[157]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[158]=["",ID_RED_CONST_STRING_ALIGN_LEFT_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[159]=["",ID_RED_CONST_STRING_ALIGN_CENTER_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[160]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[161]=["",ID_RED_CONST_STRING_ALIGN_LEFT_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[162]=["",ID_RED_CONST_STRING_ALIGN_CENTER_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[163]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[164]=["",ID_RES_CONST_STRING_DRAW_TABLE,"TB_DRAW_TABLE","fnHandler_drawTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[165]=["",ID_RES_CONST_STRING_INSERT_EMOTICONS,"TB_INSERT_EMOTICONS","fnHandler_InsertEmoticons",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[166]=["",ID_RES_CONST_STRING_PRINT_PAGE_BREAK,"TB_EDIT_PRINT_PAGE_BREAK","fnHandler_InsertPrintPageBreak",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[167]=["",ID_RES_CONST_STRING_VIEW_RULERBAR,"TB_VIEW_RULERBAR","fnHandler_viewRulerbar",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[168]=["MultilevelList",ID_RES_DIALOG_STRING_CASCADE_ORDERLIST,"TB_STYLE_CASCADE_ORDERLIST","fnHandler_cascadeOrderList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[169]=["Copy",ID_RES_CONST_STRING_COPY,"TB_COPY_EXT",
"fnHandler_CopyExt",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[170]=["Copy",ID_RES_CONST_STRING_COPY_EXT_STYLE,"TB_COPY_EXT_STYLE","fnHandler_CopyExtStyle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[171]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH,"TB_INSERT_SELECT_PARAGRAPH","fnHandler_SelectParagraphDropDown",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],
g_arrConst[172]=["Paste",ID_RES_CONST_STRING_PASTE,"TB_PASTE_EXT","fnHandler_PasteExt",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[173]=["",ID_RES_CONST_BTN_DELETE,"TB_TABLE_DELETE_EXT","fnHandler_TalbeDeleteExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[174]=["",ID_RES_CONST_STRING_TABLE_FORMULA,"TB_TABLE_FORMULA_EXT","fnHandler_TableFomulaExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[175]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_IMAGE_BORDER_TYPE","fnHandler_ImageBorderType",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[176]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,"TB_IMAGE_BORDER_THICKNESS","fnHandler_ImageBorderThickness",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[177]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETIMAGEBORDERCOLOR","fnHandler_ImageBorderColor",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[178]=["",ID_RES_CONST_STRING_RESET_PICTURE,"TB_IMAGE_RESET_PICTURE","fnHandler_ImageResetPicture",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[179]=["",ID_RES_CONST_STRING_NO_LINE,"","fnHandler_ObjectBorderNoLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[180]=["",ID_RES_CONST_STRING_SOLID_LINE,"","fnHandler_ObjectBorderSolidLine",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[181]=["",ID_RES_CONST_STRING_DASHED_LINE,"","fnHandler_ObjectBorderDashedLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[182]=["",ID_RES_CONST_STRING_DOTTED_LINE,"","fnHandler_ObjectBorderDottedLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[183]=["",ID_RES_CONST_STRING_DOUBLE_LINE,"","fnHandler_ObjectBorderDoubleLine",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[184]=["","1px","","fnHandler_ObjectBorder1pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[185]=["","2px","","fnHandler_ObjectBorder2pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[186]=["","3px","","fnHandler_ObjectBorder3pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],
g_arrConst[187]=["","4px","","fnHandler_ObjectBorder4pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[188]=["","5px","","fnHandler_ObjectBorder5pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[189]=["","6px","","fnHandler_ObjectBorder6pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[190]=["","7px","","fnHandler_ObjectBorder7pxLine",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[191]=["","8px","","fnHandler_ObjectBorder8pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[192]=["","9px","","fnHandler_ObjectBorder9pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[193]=["","10px","","fnHandler_ObjectBorder10pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[194]=
["",ID_RES_CONST_STRING_TABLE_SELECT_CELL,"TB_TABLE_SELECT_CELL","fnHandler_TableSelectCell",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[195]=["",ID_RES_CONST_STRING_TABLE_SELECT_COL,"TB_TABLE_SELECT_COL","fnHandler_TableSelectCol",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[196]=["",ID_RES_CONST_STRING_TABLE_SELECT_ROW,"TB_TABLE_SELECT_ROW","fnHandler_TableSelectRow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON],g_arrConst[197]=["",ID_RES_CONST_STRING_TABLE_SELECT_TABLE,"TB_TABLE_SELECT_TABLE","fnHandler_TableSelectTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[198]=["",ID_RES_CONST_STRING_IMAGE_TO_TABLE,"TB_IMAGE_TO_TABLE","fnHandler_imageToTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[199]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,"TB_TABLE_BORDER_THICKNESS","fnHandler_TableBorderThickness",
ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[200]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_TABLE_BORDER_TYPE","fnHandler_TableBorderType",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[201]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETTABLEBORDERCOLOR","fnHandler_TableBorderColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[202]=["",ID_RES_CONST_STRING_STYLE_STYLE,
"TB_TABLE_STYLE","fnHandler_TableStyle",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN],g_arrConst[203]=["",ID_RES_DIALOG_STRING_HEIGHT,"TB_IMAGE_HEIGHT","fnHandler_TBSetImageHeight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"],g_arrConst[204]=["",ID_RES_DIALOG_STRING_WIDTH,"TB_IMAGE_WIDTH","fnHandler_TBSetImageWidth",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"],
g_arrConst[205]=["",ID_RES_CONST_STRING_HELP_IMAGE_TO_TABLE,"","fnHandler_Help_ImageToTable",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING],g_arrConst[206]=["",ID_RES_CONST_STRING_TABLE_LOCK_EDIT_CELL,"TB_LOCK_EDIT_CELL","fnHandler_table_lock_edit_cell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[207]=["",ID_RES_CONST_EXTERNAL_DATA_AREA,"TB_EXTERNAL_DATA_AREA","fnHandler_insertBindBox",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[208]=["",ID_RES_STRING_LOCK_EDIT_TABLE,"TB_LOCK_EDIT_TABLE","fnHandler_lockEditTable",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[209]=["",ID_RES_CONST_STRING_INIT_CURSOR,"TB_INIT_CURSOR","fnHandler_initCursor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[210]=["",ID_RES_CONST_STRING_INIT_CURSOR_REMOVE,"TB_INIT_CURSOR_REMOVE","fnHandler_initCursorRemove",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[211]=["",ID_RES_CONST_STRING_PASTE_CELL,"TB_PASTE_CELL","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[212]=["",ID_RES_CONST_STRING_PASTE_CELL_INSERT,"TB_PASTE_CELL_INSERT","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[213]=["",ID_RES_CONST_STRING_PASTE_CELL_OVER_ALL,"TB_PASTE_CELL_OVER_ALL",
"fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[214]=["",ID_RES_CONST_STRING_PASTE_CELL_OVER_CONTENT,"TB_PASTE_CELL_OVER_CONTENT","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[215]=["",ID_RES_STRING_PASTE_CELL_INSERT_AS_TABLE,"TB_PASTE_CELL_INSERT_AS_TABLE","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[216]=
["",ID_RES_TOOL_STRING_MENU_INSERT,"TB_TABLE_CELL_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[217]=["",ID_RES_CONST_BTN_DELETE,"TB_TABLE_CELL_DELETE","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[218]=["",ID_RES_STRING_JUSTIFY_TABLE,"TB_JUSTIFY_TABLE","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[219]=["",ID_RES_STRING_MODIFY_EXTERNAL_DATA_AREA,
"TB_EXTERNAL_DATA_AREA","fnHandler_showBindBox",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[ID_COMMAND_SET_LIST_START_NEW]=["",ID_RES_STRING_SET_LIST_START_NEW,"TB_SET_LIST_START_NEW","fnHandler_ListStartNew",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[ID_COMMAND_SET_LIST_START_CONTINUE]=["",ID_RES_STRING_SET_LIST_START_CONTINUE,"TB_SET_LIST_START_CONTINUE","fnHandler_ListStartContinue",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[222]=["InsertImage",ID_RES_STRING_INSERT_STAMP,"TB_INSERT_STAMP","fnHandler_InsertStamp",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[223]=["InsertImage",ID_RES_STRING_MODIFY_STAMP,"TB_MODIFY_STAMP","fnHandler_ModifyStamp",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst[224]=["",ID_RES_STRING_LOCK_EDIT_TABLE_SIZE,"TB_LOCK_EDIT_TABLE_SIZE",fnHandler_lockEditTableSize,
ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON],g_arrConst_TabMode[0]=[ID_TB_TABMODE_PREVIEW,"fnTool_TabMode_Preview"],g_arrConst_TabMode[1]=[ID_TB_TABMODE_EDIT,"fnTool_TabMode"],g_arrConst_TabMode[2]=[ID_TB_TABMODE_SOURCE,"fnTool_TabMode"]}catch(a){dalert(a)}}var ID_COMMAND_MENU_TABLE_INDEX=5;
function setInitUpdateVariable(a){try{g_TBButton[a]=[],g_TBComboBox[a]=[],g_TBComboBoxLabel[a]=[],g_TBDropDown[a]=[],g_objMenuWin.arrTBMenu[a]=[],g_TBTabMode[a]=[],g_bEditMode[a]=!0,g_objEditMode.arrWriteAreaSet[a]=!1,g_objEditMode.arrShowEditableAreaOrder[a]=null}catch(b){}};

var g_arrEditorAreaContainer=[],g_arrEditorWidth=[],g_arrEditorHeight=[],g_objEditAreaContainer=[],g_objMainEditAreaContainer=[],g_nToolbarSetHeight=0,g_nTabBarSetHeight=0,g_nBottomResizeHeight=0,g_nEditAreaSetHeight=0,g_objEditContainer=[],g_objEditSourceContainer=[],g_objEditObjectSource=[],g_bMarkWinAssigned=!1;
function initEditAreaContainer(b,a){b.innerHTML='<div id="INIT_LOAD_AREA_'+a+'" class="editor_set_container"></div><div id="INIT_INFO_AREA_'+a+'"></div>';b=document.getElementById("INIT_LOAD_AREA_"+a);g_objEditAreaContainer[a]=b;var e=buildEditAreaContainer(a);b.innerHTML=e;g_objMainEditAreaContainer[a]=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a);g_objEditContainer[a]=document.getElementById(g_strEditContainerName+"_"+a);g_objEditSourceContainer[a]=document.getElementById(g_strEditSourceContainerName+
"_"+a);g_objEditObjectSource[a]=document.getElementById(g_strEditObjectSourceName+"_"+a)}
function buildEditAreaContainer(b){var a="",e=!0;if(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display)e=!1;g_nToolbarSetHeight=113;g_bMenuBar_Display||(g_nToolbarSetHeight-=24);g_bToolBar1_Display||(g_nToolbarSetHeight-=30);g_bToolBar2_Display||(g_nToolbarSetHeight-=30);g_bToolBar3_Display||(g_nToolbarSetHeight-=30);0>=g_nToolbarSetHeight&&(g_nToolbarSetHeight=1);g_nTabBarSetHeight=30;g_bTabBar_Display||(g_nTabBarSetHeight=0);g_nBottomResizeHeight=12;g_bBottomResizeYN||
(g_nBottomResizeHeight=0);if(g_bEditorHeightIFrameYN){var d=g_objPositionUtil.getDocumentClientSize(self).nClientHeight;if(g_bBrowserType_WK){if(0==d){var g=g_objPositionUtil.getDocumentElementObject(!1);g&&(d=g.scrollHeight)}if(0==d)try{var c=window.frameElement;c&&(d=c.clientHeight)}catch(f){}}g_bBrowserType_WK||g_bBrowserType_FF?d+=1:window.attachEvent&&--d;g_arrEditorHeight[b]=d}g_nEditAreaSetHeight=g_arrEditorHeight[b]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight;window.attachEvent&&
(g_nEditAreaSetHeight+=3);a=g_bEditorWidthPercentageYN?a+('<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="EDIT_SET_CONTAINER_'+b+'" height="'+g_arrEditorHeight[b]+'">'):a+('<table style="width:'+g_arrEditorWidth[b]+'px;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="EDIT_SET_CONTAINER_'+b+'" height="'+g_arrEditorHeight[b]+'">');a=(e?a+'<tr valign="top" style="display:none">':a+'<tr valign="top">')+('<td height="'+g_nToolbarSetHeight+
'" style="line-height:normal;border:0px;padding:0px;height:'+g_nToolbarSetHeight+'px;">');a=e?a+('<table style="width:100%;" cellSpacing="0" cellPadding="0" id="TB_CONTAINER_'+b+'">'):a+('<table style="width:100%;" cellSpacing="0" cellPadding="0" id="TB_CONTAINER_'+b+'" class="duzon_controller_container">');g_bMenuBar_Display&&(a=a+"<tr>"+('<td id="TB_CONTAINER_MENU_'+b+'" class="duzon_menubar_line">')+'<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0">',a+='<tr valign="center">',
calculateStringLength(ID_RES_TOOL_STRING_MENU_FILE),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_FILE_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_FILE+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_EDIT),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_EDIT_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_EDIT+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_VIEW),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_VIEW_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_VIEW+
"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_INSERT),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_INSERT_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_INSERT+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_BASIC),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_BASIC_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_BASIC+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_TABLE),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_TABLE_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_TABLE+
"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_HELP),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_HELP_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_HELP+"</td>",a+='<td><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>',a+="</tr>",a+="</table>",a+="</td>",a+="</tr>");g_bToolBar1_Display&&(a+=buildEditAreaContainer_Toolbar(b,1,g_arrToolbar1,!g_bMenuBar_Display));g_bToolBar2_Display&&(a+=buildEditAreaContainer_Toolbar(b,
2,g_arrToolbar2,!g_bMenuBar_Display&&!g_bToolBar1_Display));g_bToolBar3_Display&&(a+=buildEditAreaContainer_Toolbar(b,3,g_arrToolbar3,!g_bMenuBar_Display&&!g_bToolBar1_Display&&!g_bToolBar2_Display));a+="</table>";a+="</td>";a+="</tr>";a+='<tr valign="top">';a+='<td id="MAIN_EDIT_AREA_CONTAINER_'+b+'" height="'+g_nEditAreaSetHeight+'" style="line-height:normal;border:0px;padding:0px;height:'+g_nEditAreaSetHeight+'px;background-color:#FFFFFF;">';a+='<table id="'+g_strEditContainerName+"_"+b+'" style="width:100%;border:0px;" class="editorContainer" cellSpacing="0" cellPadding="0">';
a+="<tr>";e?g_bBrowserType_IE&&""!=g_strDomainPageName?(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame_nothing" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;border:1px solid #c4cad1;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame_nothing" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;border:1px solid #c4cad1;">',
a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>'):g_bBrowserType_IE&&""!=g_strDomainPageName?g_bEditorHeightReSettingYN?(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:'+(g_nEditAreaSetHeight-1)+'px;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" style="height:'+(g_nEditAreaSetHeight-
2)+'px;" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):g_bEditorHeightReSettingYN?
(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:'+(g_nEditAreaSetHeight-1)+'px;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" style="height:'+(g_nEditAreaSetHeight-2)+'px;" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',
a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>');a+="</td>";a+="</tr>";a+="</table>";a+='<table id="'+g_strEditSourceContainerName+"_"+b+'" style="width:100%;border:0px;display:none;" class="editorContainer" cellSpacing="0" cellPadding="0">';a+="<tr>";e?(g_bBrowserType_WK||(a+='<td class="editor_source_frame_padding_nothing" style="line-height:normal;padding:0px;"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+
'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'),a+='<td class="editor_source_frame_main_nothing" style="line-height:normal;padding:0px;"><label for="'+g_strEditObjectSourceName+"_"+b+'"></label><textarea id="'+g_strEditObjectSourceName+"_"+b+'" class="editor_source_frame" title="source" style="line-height:1.4;"></textarea></td>'):a+='<td class="editor_source_frame_main" id="dze_editor_source_frame_main_'+b+'" style="line-height:normal;padding:0px;"><label for="'+
g_strEditObjectSourceName+"_"+b+'"></label><textarea id="'+g_strEditObjectSourceName+"_"+b+'" class="editor_source_frame" title="source" style="line-height:1.4;"></textarea></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";if(g_bTabBar_Display)a=a+('<tr valign="top" id="TB_TABMODE_TR_CONTAINER_'+b+'">')+'<td style="width:100%;line-height:normal;height:20px;border:0px;padding:0px;">',a=a+('<table style="width:100%;border-top:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="TB_TABMODE_CONTAINER_'+
b+'" class="tbToolbarSetTabMode">')+"<tr>",a=a+('<td id="TB_CONTAINER_TABMODE_'+b+'" style="width:100%;line-height:normal;height:20px;border:0px;padding:0px;text-align:right;vertical-align:top;">')+'<table align="left" width="100%" cellSpacing="0" cellPadding="0">',a+="<tr>",g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&(a+='<td style="width:90px;height:24px;">',a+='<div id="TB_TABMODE_EDIT_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_EDIT+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_EDIT+"</div>",a+="</td>"),g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&
(a+='<td style="width:90px;height:24px;">',a+='<div id="TB_TABMODE_SOURCE_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_SOURCE+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_SOURCE+"</div>",a+="</td>"),g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]&&(a+='<td style="width:90px;height:24px;">',a+='<div id="TB_TABMODE_PREVIEW_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_PREVIEW+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_PREVIEW+"</div>",a+="</td>"),a+='<td style="height:24px;">',a+='<div class="duzon_btn_tabmod_area_blank"></div>',
a+="</td>",dzeUiConfig.bCustomBottomResizeBtnYN&&(a+='<td style="width:15px;height:24px;">',a+='<div class="duzon_btn_tabmod_area_resizer">',a=a+("<div id='TB_CONTAINER_BOTTOM_RESIZE_BTN_"+b+"'>")+("<img class='duzon_spinner_btn_arrow_up' src='"+dzeEnvConfig.strPath_Image+"dialog/btn_arrow_up.png' alt='' width='5' height='3' />"),a+="<img class='duzon_spinner_btn_arrow_up' src='"+dzeEnvConfig.strPath_Image+"dialog/btn_arrow_down.png' alt='' width='5' height='3' border='0' />",a+="</div>",a+="</div>",
a+="</td>"),a+="</tr>",a+="</table>",a+="</td>",a+="</tr>",a+="</table>",g_bBottomResizeYN&&(a=a+('<table style="width:100%;border-top:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" class="tbToolbarSetTabMode" id="TB_CONTAINER_BOTTOM_RESIZE_CONTAINER_'+b+'">')+'<tr valign="top">',a=a+('<td id="TB_CONTAINER_BOTTOM_RESIZE_'+b+'" class="duzon_handle_resize_height">')+'<div style="display:inline-block;"></div>',a+="</td>",a+="</tr>",a+="</table>"),a+="</td>",a+="</tr>";else if(!e||g_bTabBar_Display)a+=
'<tr valign="top"><td style="width:100%;line-height:normal;padding:0px;"><div class="tbToolbarSetTabMode_No_Bottom" id="ToolbarSetTabMode_No_Bottom_'+b+'"></div></td></tr>';a+="</table>";b=parseInt(b,10)+DZE_IFRAME_TMP_NO;a+='<div id="'+g_strEditObjectName+"_Parent_"+b+'" style="display:none;">';a+='<iframe id="'+g_strEditObjectName+"_"+b+'"></iframe>';return a+="</div>"}
function buildEditAreaContainer_Toolbar(b,a,e,d){var g="";d&&(g='style="border-width:0px;"');d="<tr>"+('<td id="TB_CONTAINER_TOOL_'+a+"_"+b+'" class="'+g_strSkin_ToolBarLine+'" '+g+">");d+='<table cellSpacing="0px" cellPadding="0px" border="0px" cellPadding="0" height="28px" width="100%"><tr valign="center" height="28px">';g=0;for(var c=e.length;g<c;g++){var f=e[g][0],h=e[g][1];ID_TYPE_TOOLBAR_HANDLE==f?d+=buildEditAreaContainer_Handle(1,7,1):ID_TYPE_TOOLBAR_SEPARATOR==f?d+=buildEditAreaContainer_Separator(1):
ID_TYPE_TOOLBAR_SPACE==f?d+=buildEditAreaContainer_Space(h):ID_TYPE_TOOLBAR_CAPTION==f?d+=buildEditAreaContainer_Caption(h):ID_TYPE_TOOLBAR_BUTTON==g_arrConst[f][6]?d+=buildEditAreaContainer_Button(f,b):ID_TYPE_TOOLBAR_COMBOBOX==g_arrConst[f][6]?ID_COMMAND_FONT_NAME==f?d+=buildEditAreaContainer_ComboBoxInput(f,104,2,h,b):ID_COMMAND_FONT_SIZE==f?d+=buildEditAreaContainer_ComboBox(f,72,1,h,b):ID_COMMAND_HEADING_SIZE==f?d+=buildEditAreaContainer_ComboBox(f,72,1,h,b):ID_COMMAND_LETTER_SPACING==f?d+=buildEditAreaContainer_ComboBox(f,
52,1,h,b):ID_COMMAND_LINE_HEIGHT==f&&(d+=buildEditAreaContainer_ComboBox(f,52,1,h,b)):ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[f][6]&&(d+=buildEditAreaContainer_DropDown(f,b))}d=d+"<td></td><td>"+('<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_'+a+"_HIDDEN_"+b+'" toolbarNo="'+a+'">')+('<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_'+a+"_HIDDEN_TBL_"+b+'"><tr>')+buildEditAreaContainer_Space(8);d+=buildEditAreaContainer_Space(8);d=d+'</tr></table></div></td><td align="right" style="vertical-align:middle">'+
('<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_'+a+"_HIDDEN_"+b+'" onclick="duzon_menubar.viewHiddenTbContainerTool('+a+","+b+')"></div>')+"</td></tr>";d+="</table>";d+="</td>";return d+="</tr>"}
function buildEditAreaContainer_Handle(b,a,e){var d="";0!=b&&(d+='<td width="'+b+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"></td>');0!=a&&(d+='<td width="'+a+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"><div class="'+g_strSkin_HandleDiv+'"></div></td>');0!=e&&(d+='<td width="'+e+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"></td>');return d}
function buildEditAreaContainer_ComboBox(b,a,e,d,g){var c=0;d&&(c=calculateStringLength(g_arrConst[b][1])-6);c=a+(d?c:0)+2;c='<td width="'+c+'" height="28" style="width:'+c+'px;height:16px;line-height:0;border:0px;padding:0px;vertical-align:middle;"><table style="border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0"><tr>';d&&(c+='<td style="height:16px;line-height:0;border:0px;padding-left:5px;padding-top:3px;padding-right:3px;padding-bottom:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+
'">'+g_arrConst[b][1]+"</td>");c+='<td style="width:'+a+'px;height:16px;line-height:0;border:0px;padding:0px;">';c+='<div id="'+g_arrConst[b][2]+"_"+g+'" TBTYPE="toggle" style="line-height:0;width:'+a+'px;overflow:hidden;" title="'+g_arrConst[b][1]+'">';c+='<table style="width:'+a+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';c+="<tr>";g_bBrowserType_WK?g_bDocType_XHTML?(c+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
e+'"><span id="'+g_arrConst[b][2]+"_"+g+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',c+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(c+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
e+'"><span id="'+g_arrConst[b][2]+"_"+g+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',c+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):g_bDocType_XHTML?(c+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
e+'"><span id="'+g_arrConst[b][2]+"_"+g+'_LABEL" style="line-height:0;"></span></td>',c+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(c+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
e+'"><span id="'+g_arrConst[b][2]+"_"+g+'_LABEL" style="line-height:0;"></span></td>',c+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>');c+="</tr>";c+="</table>";c+="</div>";c+="</td>";c+="</tr>";c+="</table>";return c+="</td>"}
function buildEditAreaContainer_ComboBoxInput(b,a,e,d,g){var c=0;d&&(c=calculateStringLength(g_arrConst[b][1])-6);c=a+(d?c:0)+2;c='<td width="'+c+'" height="28" style="width:'+c+'px;height:16px;line-height:0;border:0px;padding:0px;vertical-align:middle;"><table style="border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0"><tr>';d&&(c+='<td style="height:16px;line-height:0;border:0px;padding-left:5px;padding-top:3px;padding-right:3px;padding-bottom:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+
'">'+g_arrConst[b][1]+"</td>");c+='<td style="width:'+a+'px;height:16px;line-height:0;border:0px;padding:0px;">';c+='<div id="'+g_arrConst[b][2]+"_"+g+'" TBTYPE="toggle" style="line-height:0;width:'+a+'px;overflow:hidden;" title="'+g_arrConst[b][1]+'">';c+='<table style="width:'+a+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';c+="<tr>";c+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
e+'"><input type="text" id="'+g_arrConst[b][2]+"_"+g+'_LABEL" style="line-height:0; width:100%; outline: none; border: none;" autocomplete="off"/></span></td>';c+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>';c+="</tr>";c+="</table>";c+="</div>";c+="</td>";
c+="</tr>";c+="</table>";return c+="</td>"}function buildEditAreaContainer_Separator(b){var a="";0!=b&&(a+='<td width="'+b+'" height="28" style="line-height:normal;height:1px;border:0px;padding:0px;vertical-align:middle;"><div class="'+g_strSkin_Separator+'"></div></td>');return a}function buildEditAreaContainer_Space(b){var a="";0!=b&&(a+='<td width="'+b+'" height="28" style="line-height:normal;height:1px;border:0px;padding:0px;vertical-align:middle;"></td>');return a}
function buildEditAreaContainer_Button(b,a){return'<td width="24" height="28" style="padding:0;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'" title="'+g_arrConst[b][1]+'" TBTYPE="toggle" style="overflow:hidden;"><div class="duzon_tb_button_image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[b][1]+'"></div></div>')+"</td>"}
function buildEditAreaContainer_DropDown(b,a){b==ID_COMMAND_MARK_INSERT&&(g_bMarkWinAssigned=!0);var e='<td width="35" height="28" style="line-height:0;height:24px;border:0px;padding:0px;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'" title="'+g_arrConst[b][1]+'" TBTYPE="toggle" style="overflow:hidden;">');e=e+'<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" width="30"><tr><td width="18" style="line-height:0;height:20px;border:0px;padding:0px;">'+
('<div class="tbDropDown_AreaButton"><div class="tb_DropDown_Button_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" alt="'+g_arrConst[b][1]+'" style="vertical-align:baseline;border:none;"></div></div>');b==ID_COMMAND_FORE_COLOR&&(e+='<div id="TB_SETFORECOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');b==ID_COMMAND_BACK_COLOR&&(e+='<div id="TB_SETBACKCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');
b==ID_COMMAND_TABLE_CELL_BACKCOLOR&&(e+='<div id="TB_SETCELLBACKCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');b==ID_COMMAND_IMAGE_BORDER_COLOR&&(e+='<div id="TB_SETIMAGEBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');b==ID_COMMAND_TABLE_BORDER_COLOR&&(e+='<div id="TB_SETTABLEBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');
e=e+'</td><td width="13" style="line-height:0;height:20px;border:0px;padding:0px;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'_SUB" class="'+g_strSkin_DropDown_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div>');return e+"</td></tr></table></div></td>"}
function buildEditAreaContainer_Caption(b){return'<td style="width:'+(12*b.length+1)+'px;height:16px;line-height:normal;border:0px;padding:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+'">'+b+"</td>"}
function calculateStringLength(b){try{if(null==g_strBrowserLanguage)return 0;var a=0,e=b.length;if(ID_LANGUAGE_TYPE_KO==g_strBrowserLanguage)a=12*e+16;else if(ID_LANGUAGE_TYPE_EN==g_strBrowserLanguage)a=9*e+2;else if(ID_LANGUAGE_TYPE_JA==g_strBrowserLanguage)a=12*e+16;else if(ID_LANGUAGE_TYPE_ZH==g_strBrowserLanguage||ID_LANGUAGE_TYPE_ZH_CN==g_strBrowserLanguage)a=12*e+16;return a}catch(d){}return 0};

var duzon_http={createRequest:function(){var a=null;try{try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}}null==a&&alert("Request Error! Please Retry!");return a}catch(b){return a}},loading_screen:!0,loading_image_url:g_dzEditorBasePath+"image/loading-image.gif",loading_image_size:[48,48],ajax:function(a){try{var b=this.createRequest();if("undefined"!=typeof b&&null!=b){var d="undefined"!=typeof a.type?a.type.toLowerCase():
"post",c=a.url,g="undefined"!=typeof a.async?a.async:!0,f="undefined"!=typeof a.dataType?a.dataType:"html",e="undefined"!=typeof a.data?a.data:{};"json"==f&&"post"===d.toLowerCase()&&(e="undefined"!=typeof e?JSON.stringify(e):{});var n="undefined"!=typeof a.success?a.success:function(){},p="undefined"!=typeof a.error?a.error:function(){},v="undefined"!=typeof a.timeout&&0<a.timeout?a.timeout:3E4;"undefined"!=typeof a.loading_screen&&(this.loading_screen=a.loading_screen);"undefined"!=typeof a.loading_image_size&&
(this.loading_image_size=a.loading_image_size);var l="undefined"!=typeof a.bShowLoading?a.bShowLoading:!0,q="undefined"!=typeof FormData&&e instanceof FormData,h=null;if(q)h=e;else if("object"===typeof e){var r=[],m;for(m in e)r.push(m+"="+encodeURIComponent(e[m]));h=r.join("&");"get"==d&&""!=h&&(c=0<c.indexOf("news_list")||0<c.indexOf("post_article")||0<c.indexOf("media_list")||0<c.indexOf("media_register")?c+("?"+h):c+("?"+encodeURI(h)))}else h=e,0<c.indexOf("getEmpMentionList")&&(c+="?"+h);duzon_http.log("url : "+
c);b.open(d,c,g);q||("application/json"==f?b.setRequestHeader("Content-Type","application/json; charset=UTF-8"):"json"==f&&0==h.indexOf("{")?b.setRequestHeader("Content-Type","application/json; charset=UTF-8"):"post"==d&&b.setRequestHeader("Content-type","application/x-www-form-urlencoded"));if(!0===dzeEnvConfig.bUseAmaranthApi&&void 0!==CryptoJS&&!0===a.isCallAmaranthApi){var k=decodeURI(duzon_http.getCookieValue("oAuthToken")),w=duzon_http.getCookieValue("signKey"),t=Math.floor(Date.now()/1E3),
u=duzon_http.getTransactionId();b.withCredentials=!1;b.setRequestHeader("Authorization","Bearer "+k);b.setRequestHeader("timestamp",t);b.setRequestHeader("transaction-id",u);if(!fnObjectCheckNull(k)&&"0"!==k){var x=CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA256(k+u+t+duzon_http.getLocation(c).pathname,w));b.setRequestHeader("wehago-sign",x)}}var y=setTimeout(function(){duzon_http.log("HttpReqeust Timeout!");duzon_http.hideLoading();b.abort()},v);!0===l&&this.showLoading();b.onreadystatechange=
function(){if(4==b.readyState)if(!0===l&&duzon_http.hideLoading(),duzon_http.log("HttpReqeust Complete"),clearTimeout(y),200==b.status){duzon_http.log("HttpReqeust Result : Success");var a="xml"==f?b.responseXML:b.responseText;duzon_http.log("response dataType:"+typeof a);"json"==f&&(a=duzon_http.parseJSON(a));n(a)}else duzon_http.log("HttpReqeust Result : Fail"),p({status:b.status,msg:"response error"})};duzon_http.log("HttpReqeust Start");"post"==d?b.send(h):b.send()}}catch(z){!0===l&&duzon_http.hideLoading(),
p({status:"",msg:"exception error"})}},parseJSON:function(a){if("undefined"!=typeof JSON)try{return JSON.parse(a)}catch(b){try{return eval("("+a+")")}catch(d){return{}}}else try{return eval("("+a+")")}catch(b){return{}}},loadingScreenObj:null,loadingImageObj:null,loadingImageTimer:null,showLoading:function(){try{!0===this.loading_screen&&(this.loadingScreenObj=g_objLayerKit.getLayerDocument().getElementById("dze_idx_loading_screen_obj"),null==this.loadingScreenObj&&(this.loadingScreenObj=g_objLayerKit.getLayerDocument().createElement("div"),
this.loadingScreenObj.id="dze_idx_loading_screen_obj",this.loadingScreenObj.style.position="absolute",this.loadingScreenObj.style.left="0",this.loadingScreenObj.style.top="0",this.loadingScreenObj.style.width="100%",this.loadingScreenObj.style.height="100%",this.loadingScreenObj.style.backgroundColor="gray",this.loadingScreenObj.style.opacity="0.3",this.loadingScreenObj.style.zIndex="30001",g_objLayerKit.getLayerDocument().body.appendChild(this.loadingScreenObj)),this.loadingScreenObj.style.display=
"block",this.resizeLoadingScreen(),""!=this.loading_image_url&&(this.loadingImageObj=g_objLayerKit.getLayerDocument().getElementById("dze_idx_loading_image_obj"),null==this.loadingImageObj&&(this.loadingImageObj=g_objLayerKit.getLayerDocument().createElement("div"),this.loadingImageObj.id="dze_idx_loading_image_obj",this.loadingImageObj.style.backgroundImage="url("+this.loading_image_url+")",this.loadingImageObj.style.position="absolute",this.loadingImageObj.style.left="0",this.loadingImageObj.style.top=
"0",this.loadingImageObj.style.width=this.loading_image_size[0]+"px",this.loadingImageObj.style.height=this.loading_image_size[1]+"px",this.loadingImageObj.style.zIndex="30002",g_objLayerKit.getLayerDocument().body.appendChild(this.loadingImageObj)),this.loadingImageObj.style.display="block",this.setPositionLoadingImage(),this.addLoadingImageEvent()),this.loadingImageTimer=setTimeout(function(){duzon_http.hideLoading()},3E4))}catch(a){}},addLoadingImageEvent:function(){try{g_objLayerKit.getLayerWindow().attachEvent?
(g_objLayerKit.getLayerWindow().attachEvent("onscroll",duzon_http.setPositionLoadingImage),g_objLayerKit.getLayerWindow().attachEvent("onscroll",duzon_http.resizeLoadingScreen),g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_http.setPositionLoadingImage),g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_http.resizeLoadingScreen)):(g_objLayerKit.getLayerWindow().addEventListener("scroll",duzon_http.setPositionLoadingImage,!1),g_objLayerKit.getLayerWindow().addEventListener("scroll",
duzon_http.resizeLoadingScreen,!1),g_objLayerKit.getLayerWindow().addEventListener("resize",duzon_http.setPositionLoadingImage,!1),g_objLayerKit.getLayerWindow().addEventListener("resize",duzon_http.resizeLoadingScreen,!1))}catch(a){}},resizeLoadingScreen:function(){try{if(duzon_http.loadingScreenObj=g_objLayerKit.getElementById("dze_idx_loading_screen_obj"),null!=duzon_http.loadingScreenObj&&"none"!=duzon_http.loadingScreenObj.style.display){var a=0,b=0;duzon_http.loadingScreenObj.style.width=a+
"px";duzon_http.loadingScreenObj.style.height=b+"px";g_objLayerKit.getLayerDocument().documentElement.scrollWidth&&(a=g_objLayerKit.getLayerDocument().documentElement.scrollWidth);g_objLayerKit.getLayerDocument().documentElement.scrollHeight&&(b=g_objLayerKit.getLayerDocument().documentElement.scrollHeight);g_objLayerKit.getLayerWindow().innerHeight&&g_objLayerKit.getLayerWindow().innerHeight>b&&(b=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&
g_objLayerKit.getLayerDocument().documentElement.clientHeight>b&&(b=g_objLayerKit.getLayerDocument().documentElement.clientHeight);g_objLayerKit.getLayerDocument().body.scrollWidth&&g_objLayerKit.getLayerDocument().body.scrollWidth>a&&(a=g_objLayerKit.getLayerDocument().body.scrollWidth);g_objLayerKit.getLayerDocument().body.scrollHeight&&g_objLayerKit.getLayerDocument().body.scrollHeight>b&&(b=g_objLayerKit.getLayerDocument().body.scrollHeight);duzon_http.loadingScreenObj.style.width=a+"px";duzon_http.loadingScreenObj.style.height=
b+"px"}}catch(d){}},setPositionLoadingImage:function(){try{if(duzon_http.loadingImageObj=g_objLayerKit.getElementById("dze_idx_loading_image_obj"),null!=duzon_http.loadingImageObj&&"block"==duzon_http.loadingImageObj.style.display){duzon_http.loadingImageObj.style.position="absolute";if(g_objLayerKit.getLayerWindow().innerWidth)var a=g_objLayerKit.getLayerWindow().innerWidth,b=g_objLayerKit.getLayerWindow().innerHeight;else a=g_objLayerKit.getLayerDocument().documentElement.clientWidth,b=g_objLayerKit.getLayerDocument().documentElement.clientHeight;
var d=a/2-duzon_http.loadingImageObj.offsetWidth/2,c=b/2-duzon_http.loadingImageObj.offsetHeight/2;g_objLayerKit.getLayerDocument().documentElement.scrollTop?(c+=g_objLayerKit.getLayerDocument().documentElement.scrollTop,d+=g_objLayerKit.getLayerDocument().documentElement.scrollLeft):(c+=g_objLayerKit.getLayerDocument().body.scrollTop,d+=g_objLayerKit.getLayerDocument().body.scrollLeft);duzon_http.loadingImageObj.style.left=d+"px";duzon_http.loadingImageObj.style.top=c+"px"}}catch(g){}},hideLoading:function(){try{!0===
this.loading_screen&&(this.loadingImageTimer&&clearTimeout(this.loadingImageTimer),null!=this.loadingImageObj&&(this.loadingImageObj.style.display="none"),null!=this.loadingScreenObj&&(this.loadingScreenObj.style.display="none"),this.loadingImageTimer=null)}catch(a){}},unloadLoading:function(){try{var a=this.loadingScreenObj;a&&a.parentNode&&a.parentNode.removeChild(a);this.loadingScreenObj=null;(a=this.loadingImageObj)&&a.parentNode&&a.parentNode.removeChild(a);this.loadingImageObj=null}catch(b){dalert(b)}},
debug:!0,checkDebuggingStatus:function(){return!0===duzon_http.debug&&!0===dzeEnvConfig.bDebugging?!0:!1},error:function(a,b){if(!0===this.checkDebuggingStatus()&&"undefined"!=typeof console)try{console.error(a,b)}catch(d){}},log:function(a){if(!0===this.checkDebuggingStatus()&&"undefined"!==typeof console)try{console.log("[DZE_HTTP:"+duzon_http.getCurrTime()+"] "+a)}catch(b){duzon_http.error("Error",b)}},getCurrTime:function(){try{var a=new Date,b=a.getFullYear(),d=a.getMonth()+1;10>d&&(d="0"+d);
var c=a.getDate();10>c&&(c="0"+c);var g=a.getHours();10>g&&(g="0"+g);var f=a.getMinutes();10>f&&(f="0"+f);var e=a.getSeconds();10>e&&(e="0"+e);return""+b+"-"+d+"-"+c+" "+g+":"+f+":"+e}catch(n){return""}},getCookieValue:function(a){try{for(var b=document.cookie.split("; "),d=0;d<b.length;d++){var c=b[d].search(a);if(0<=c&&c<b[d].length)return b[d].split("=")[1]}return 0}catch(g){return dalert(g),0}},getTransactionId:function(){function a(){return(65536*(1+Math.random())|0).toString(16).substring(1)}
return a()+a()+a()+a()+a()+a()+a()+a()},getLocation:function(a){var b=a.match(/^(https?:)\/\/(([^:\/?#]*)(?::([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return null!=b?b&&{protocol:b[1],host:b[2],hostname:b[3],port:b[4],pathname:b[5],search:b[6],hash:b[7]}:{pathname:a}}};

var duzon_menubar={nEditNumber:0,objLayerDoc:document,setEditNumber:function(a){this.nEditNumber=a},menuBarContainerObj:{},setMenuBarContainerObj:function(){this.menuBarContainerObj=g_objLayerKit.getElementById("TB_CONTAINER_MENU_"+this.nEditNumber)},calcElementPosition:function(a){if(!a)return{top:0,left:0,width:0,height:0};var b={};b.scrollX=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;b.scrollY=document.documentElement.scrollTop?document.documentElement.scrollTop:
document.body.scrollTop;b.top=a.offsetTop;b.left=a.offsetLeft;b.width=a.offsetWidth;b.height=a.offsetHeight;window.innerWidth?(b.view_window_width=window.innerWidth,b.view_window_height=window.innerHeight):(b.view_window_width=document.documentElement.clientWidth,b.view_window_height=document.documentElement.clientHeight);return b},idx_twodepth_menu_container:"idx_twodepth_menu_container",twodepth_menu_container:{},prev_command_id:"0",viewTwoDepthMenu:function(a,b,e){try{dlog("viewTwoDepthMenu:"+
b);duzon_menubar.twodepth_menu_container=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);if(null!=duzon_menubar.twodepth_menu_container){dlog("duzon_menubar.twodepth_menu_container is not null");if(this.prev_command_id==b){dlog("viewTwoDepthMenu:1:this.prev_command_id->"+this.prev_command_id+",command_id=>"+b);duzon_menubar.twodepth_menu_container.style.display="block";return}dlog("viewTwoDepthMenu:2:this.prev_command_id->"+this.prev_command_id+",command_id=>"+b);duzon_menubar.hideTwoDepthMenu(b)}this.prev_command_id=
b;this.twodepth_menu_container=g_objLayerKit.getLayerDocument().createElement("div");this.twodepth_menu_container.id=this.idx_twodepth_menu_container;this.twodepth_menu_container.className="twodepth_menu_container";g_objLayerKit.getLayerDocument().body.appendChild(this.twodepth_menu_container);b=ID_COMMAND_TYPE_MENU;for(var f=g_objPropertyUtil,c=a;c&&"BODY"!==c.nodeName;){if("DIV"===c.nodeName)if(f.hasClass(c,"MenuContainer")){b=ID_COMMAND_TYPE_MENU;break}else if(f.hasClass(c,"ContextMenuContainer")){b=
ID_COMMAND_TYPE_CONTEXT_MENU;break}c=c.parentNode}if(c&&"BODY"!==c.nodeName){var d=this.setTwoDetphMenuList(e,b);this.twodepth_menu_container.appendChild(d);this.twodepth_menu_container.style.display="block";this.setTwoDepthMenuPosition(c,a,this.twodepth_menu_container)}}catch(k){dalert(k)}},setTwoDetphMenuList:function(a,b){b=b||ID_COMMAND_TYPE_MENU;var e=document.createElement("div"),f=document.createElement("div");f.className="twodepth_menu_list_blank";e.appendChild(f);var c={},d=0;f="";for(var k=
0;k<a.length;k++)if(f="",d=a[k],d!==ID_COMMAND_INSERT_OBJECT_FILE||!1!==dzeUiConfig.bUseServerUpload){c=document.createElement("div");c.className="twodepth_menu_list";(function(){var a=g_arrConst[d][3];c.onmousedown=function(a){if("undefined"==typeof a||null==a)if("undefined"==typeof window.event||null==window.event)a=g_objLayerKit.getLayerWindow().event;TBCancelBubbleEvent(a)};c.onclick=function(b){dlog("func:"+a);currFunc=eval(a);currFunc(b,this,-1)};c.onmouseover=function(b){this.className="twodepth_menu_list_over";
dlog("func:"+a)};c.onmouseout=function(a){this.className="twodepth_menu_list"};c.command=g_arrConst[d][0];c.commandtype=b;c.TBSTATE=ID_STRING_NAME_UNCHECKED;c.command_id=d;c.support_type=g_arrConst[d][4];c.support_control_type=g_arrConst[d][5]})();var m="",g;for(g in shortcutsMenuList)if(g==d){m="<span class='shortcuts_text'>("+shortcutsMenuList[g]+")</span>";break}var h=g_arrConst[d][1];inArray(d,g_objMenuWin.openMenuList)&&(h+="...");f+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";
f+="<tr height='22'>";f+="<td class='twodepth_menu_list_blank_8'></td>";f+="<td class='twodepth_menu_list_icon'>";"undefined"!=typeof g_arrIcon[d]&&""!=g_arrIcon[d]&&(dlog("g_arrIcon[commandID]:"+d+":"+g_arrIcon[d]),f+='<div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[d]+'" alt="'+h+'" width="16" height="16" style="vertical-align:baseline;border:none;"></div>');f+="</td>";f+="<td class='twodepth_menu_list_blank_6'></td>";f+="<td class='twodepth_menu_list_text'>"+
h+m+"</td>";f+="</td>";f+="</tr>";f+="</table>";c.innerHTML=f;e.appendChild(c)}a=document.createElement("div");a.className="twodepth_menu_list_blank";e.appendChild(a);return e},setTwoDepthMenuPosition:function(a,b,e){var f=this.calcElementPosition(a),c=this.calcElementPosition(b);b=this.calcElementPosition(e);a=f.top-a.scrollTop+c.top+2;c=f.left+c.width;var d=duzon_dialog.getActiveDialogWindowSize();c+b.width>d.view_window_width+d.scrollX&&(c=c-f.width-b.width+4);a+b.height>d.view_window_height+d.scrollY&&
(a=a-b.height+20);a<d.scrollY&&(a=d.scrollY);0>a&&(a=0);0>c&&(c=0);e.style.top=a+"px";e.style.left=c+"px"},hideTwoDepthMenu:function(a){dlog("hideTwoDepthMenu");this.twodepth_menu_container=null;(a=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container))&&a.parentNode.removeChild(a)},unload:function(){try{var a=g_objLayerKit.getElementById(this.idx_twodepth_menu_container);a&&a.parentNode&&a.parentNode.removeChild(a)}catch(b){dalert(b)}},toolbar_line:3,viewHiddenTbContainerTool:function(a,
b){dlog("===viewHiddenTbContainerTool==== toolbarNo:"+a+", nEditNumber:"+b);duzon_menubar.nEditNumber=b;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);for(b=1;b<=duzon_menubar.toolbar_line;b++){var e=document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_"+duzon_menubar.nEditNumber);null!=e&&(e.style.display=a==b?"none"==e.style.display?"block":"none":"none")}duzon_menubar.setHiddenTbContainerToolPostion();duzon_menubar.addLayerEvent()},closeHiddenTbContainerTool:function(){for(var a,b=1;b<=
duzon_menubar.toolbar_line;b++)a=document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_"+duzon_menubar.nEditNumber),null!=a&&(a.style.display="none");duzon_menubar.removeLayerEvent()},setHiddenTbContainerToolPostion:function(){dlog("setHiddenTbContainerToolPostion CAll");for(var a=null,b=1;b<=duzon_menubar.toolbar_line&&(a=document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_"+duzon_menubar.nEditNumber),null==a||"none"==a.style.display);b++);if(null!=a&&"none"!=a.style.display){a.style.left=
"0px";a.style.top="0px";b=a.getAttribute("toolbarNo");var e=document.getElementById("EDIT_SET_CONTAINER_"+duzon_menubar.nEditNumber);parentToolbarObj_pos=g_objPositionUtil.getOuterRect(e);var f=duzon_menubar.calcElementPosition(a);e=document.getElementById("TB_CONTAINER_"+duzon_menubar.nEditNumber);tbContainerObj_pos=duzon_menubar.calcElementPosition(e);dlog(f);dlog("--- toolbarNo:"+b);e=parentToolbarObj_pos.top;if(dzeUiConfig.bCustomize_MenuBar_Display){var c=document.getElementById("TB_CONTAINER_MENU_"+
duzon_menubar.nEditNumber);menubarObj_pos=duzon_menubar.calcElementPosition(c);e+=menubarObj_pos.height}c=0;1<=b&&dzeUiConfig.bCustomize_ToolBar1_Display&&(e+=f.height,c++);2<=b&&dzeUiConfig.bCustomize_ToolBar2_Display&&(e+=f.height,c++);3<=b&&dzeUiConfig.bCustomize_ToolBar3_Display&&(e+=f.height,c++);dlog("=== viewToolbarNum : "+c);b=parentToolbarObj_pos.left+tbContainerObj_pos.width-f.width;1<c&&(e-=c-1);f=duzon_dialog.getParentAbsoluteNodePos(a);e-=f.top;b-=f.left;a.style.top=e+"px";a.style.left=
b+"px";dlog("toolbarObj.style.top:"+a.style.top);dlog("toolbarObj.style.left:"+a.style.left);dlog("toolbarObj.id:"+a.id)}},resizeHiddenTbContainerToolPostion:function(){dlog("resizeHiddenTbContainerToolPostion call");for(var a=null,b=1;b<=duzon_menubar.toolbar_line&&(a=document.getElementById("TB_CONTAINER_TOOL_"+b+"_HIDDEN_"+duzon_menubar.nEditNumber),null==a||"none"==a.style.display);b++);null!=a&&duzon_menubar.setHiddenTbContainerToolPostion(a)},addLayerEvent:function(){try{window.attachEvent?
(window.attachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool),window.attachEvent("onresize",duzon_menubar.setHiddenTbContainerToolPostion)):(window.addEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1),window.addEventListener("resize",duzon_menubar.setHiddenTbContainerToolPostion,!1));for(var a in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[a].attachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool):g_objEditorDocument[a].addEventListener("mousedown",
duzon_menubar.closeHiddenTbContainerTool,!1)}catch(b){dalert(b)}},removeLayerEvent:function(){try{window.detachEvent?(window.detachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool),window.detachEvent("onresize",duzon_menubar.setHiddenTbContainerToolPostion)):(window.removeEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1),window.removeEventListener("resize",duzon_menubar.setHiddenTbContainerToolPostion,!1));for(var a in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[a].detachEvent("onmousedown",
duzon_menubar.closeHiddenTbContainerTool):g_objEditorDocument[a].removeEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1)}catch(b){dalert(b)}},availToolbarWidth:0,rebuildHiddenToolbar:function(){for(var a in g_arrEditorAreaContainer){var b=a;duzon_menubar.availToolbarWidth=!0===g_bEditorWidthPercentageYN?duzon_menubar.calcElementPosition(document.getElementById("INIT_LOAD_AREA_"+b)).width-2:parseInt(g_arrEditorWidth[b],10)-7;if(!(0>=duzon_menubar.availToolbarWidth))for(var e,f=
1;3>=f;f++){e=0;var c=f;if(eval("dzeUiConfig.bCustomize_ToolBar"+c+"_Display")){for(var d=document.getElementById("TB_CONTAINER_TOOL_"+c+"_"+b).childNodes[0],k=g_objTableUtil.getTableRowElement(d,0),m=g_objTableUtil.getTableCellsLength(d,0),g=0;g<m;g++){var h=g_objTableUtil.getTableCellElement(d,0,g).getAttribute("width");null!=h&&(e+=parseInt(h,10))}h=document.getElementById("TB_CONTAINER_TOOL_"+c+"_HIDDEN_TBL_"+b);var q=g_objTableUtil.getTableRowElement(h,0),p=g_objTableUtil.getTableCellsLength(h,
0);g=duzon_menubar.availToolbarWidth;"block"==document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+b).style.display&&(g-=13);if(e>g){if(d=g_objTableUtil.getTableCellElement(d,0,m-4),null!=d&&d.getAttribute("width")){var l=q.insertCell(1);d.getAttribute("width")&&l.setAttribute("width",d.getAttribute("width"));d.getAttribute("height")&&l.setAttribute("height",d.getAttribute("height"));d.getAttribute("style")&&l.setAttribute("style",d.getAttribute("style"));for(var n=0;n<d.childNodes.length;n++)l.appendChild(d.childNodes[n]);
k.deleteCell(m-4);document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+b).style.display="block";e-=parseInt(l.getAttribute("width"));e>g&&duzon_menubar.rebuildHiddenToolbar()}}else{if("none"==document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+b).style.display)continue;if(2==p){document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+b).style.display="none";continue}d=g_objTableUtil.getTableCellElement(h,0,1);e+=parseInt(d.getAttribute("width"),10);3==p&&(g+=13);if(g>e){l=
k.insertCell(m-3);d.getAttribute("width")&&l.setAttribute("width",d.getAttribute("width"));d.getAttribute("height")&&l.setAttribute("height",d.getAttribute("height"));d.getAttribute("style")&&l.setAttribute("style",d.getAttribute("style"));for(n=0;n<d.childNodes.length;n++)l.appendChild(d.childNodes[n]);q.deleteCell(1);2==p?document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+b).style.display="none":(k=g_objTableUtil.getTableCellElement(h,0,1),e+=parseInt(k.getAttribute("width"),10),g>e&&
duzon_menubar.rebuildHiddenToolbar())}}h=document.getElementById("TB_CONTAINER_TOOL_"+c+"_HIDDEN_TBL_"+b);p=g_objTableUtil.getTableCellsLength(h,0);2==p&&(document.getElementById("TB_CONTAINER_TOOL_"+c+"_HIDDEN_"+b).style.display="none",document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+b).style.display="none")}}}},evtKeyCode:function(a){this.keyCode=(a?a:window.event).keyCode;dlog("keycode :"+this.keyCode);27==this.keyCode&&duzon_menubar.closeHiddenTbContainerTool()}};

var duzon_dialog={use_backscreen:!0,nEditNumber:0,objLayerDoc:document,objLayerWin:window,arrAllowedFileExt:[".png",".jpg",".gif",".jpeg"],dze_image_align_propertys:["default","middle","top","left","right"],idx_dze_upload_iframe:"idx_dze_upload_iframe",arrHandler:null,setObjLayer:function(){duzon_dialog.objLayerDoc=g_objLayerKit.getLayerDocument();duzon_dialog.objLayerWin=g_objLayerKit.getLayerWindow()},setIncomePath:function(a){try{a&&((a.target||a.srcElement).ownerDocument.body===g_objLayerKit.getLayerDocument().body?
this.income_path="parent":this.income_path="child")}catch(b){dalert(b)}},checkObject:function(a){return"undefined"==typeof a||null==a?!1:!0},dialog_obj:null,extend:function(){function a(){}a.prototype=this;return new a},tabType:!1,setTabType:function(a){"undefined"==typeof a&&(a=!1);this.tabType=a},getTabType:function(){return this.tabType},title:"",setTitle:function(a){this.title=a},getTitle:function(){return this.title},closeDlgIfWindowResize:!1,dialogStatus:!1,unloadCB:function(){},income_path:"child",
resetSelection:!1,viewDialog:function(a,b,c,d,e,f,g,h,k,m,l,n,p){try{dlog("viewDialog nEditNumber : "+b);duzon_dialog.dialogStatus=!0;g_objPasteOptionMenu.remove();this.setObjLayer();this.setIncomePath(a);duzon_dialog.resetSelection=!1;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_nActiveEditNumber=this.nEditNumber=b;this.closeDlgIfWindowResize=!1;"none"!=this.color_picker_mode&&!0!==dzeUiConfig.bTBPreviewLetterOperation||g_objInsertUtil.saveSelectionRange_IE(0,this.nEditNumber);p&&!1===p.viewBackScr||
this.viewBackScreen();this.setTitle(c);this.createDialog(a,c,d,e,f,g);this.fade("in",this.dialog_obj);this.back_screen_obj&&(this.back_screen_obj.className=null==this.dialog_buttonbox_obj?"duzon_backscreen_transparent":"duzon_backscreen");this.setButtonStyle();this.setButtonFocus(m);this.addDialogEvent();h&&"function"===typeof h&&h(this.dialog_obj);this.unloadCB=k&&"function"===typeof k?k:function(){};if("undefined"!=typeof l&&"toolbar"==l&&"undefined"!=typeof n){var u=document.getElementById(n.id.replace(/_SUB/,
"")),q=g_objPositionUtil.getOuterRect(u),t=g_objPositionUtil.getFrameClientRect(),v=t.left+q.left;if(startsWith(n.id,"TB_ORDERLIST")||startsWith(n.id,"TB_UNORDERLIST")||startsWith(n.id,"TB_TABLE_CELL_ALIGN")){var r=this.dialog_obj.offsetWidth;v+r>t.left+t.width&&(v=t.left+t.width-r);this.closeDlgIfWindowResize=!0}this.dialog_obj.style.left=v+"px";this.dialog_obj.style.top=t.top+q.top+q.height+"px"}else this.setObjectPosition(a,this.dialog_obj,l);this.resizeBackScreen()}catch(w){dalert(w)}},addDialogEvent:function(){try{this.arrHandler=
[];var a=function(a,b,c){EventUtil.addHandler(a,b,c);this.arrHandler.push({elem:a,type:b,handler:c})}.bind(this),b=g_objLayerKit.getLayerDocument();a(b,"mousedown",function(a){return this.evtDialogBoxDragDown(a)}.bind(this));a(b,"mousemove",function(a){return this.evtDialogBoxDragMove(a)}.bind(this));a(b,"mouseup",function(a){return this.evtDialogBoxDragUp(a)}.bind(this));a(b,"keydown",function(a){return this.evtKeyCode(a)}.bind(this));for(var c in g_arrEditorAreaContainer)a(b,"keydown",function(a){return this.evtKeyCode(a)}.bind(this))}catch(d){dalert(d)}},
removeDialogEvent:function(){try{if(this.arrHandler){for(var a=0,b=this.arrHandler.length;a<b;a++){var c=this.arrHandler[a];c&&EventUtil.removeHandler(c.elem,c.type,c.handler)}this.arrHandler=null}}catch(d){dalert(d)}},getDefaultPosition:function(a){try{for(var b=g_objNodeUtil,c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a);){if("TD"===a.nodeName&&startsWith(a.id,"TB_CONTAINER")||"DIV"===a.nodeName&&c.hasClass(a,"MenuContainer")||"DIV"===a.nodeName&&c.hasClass(a,"twodepth_menu_list_over")){var d=dzeUiConfig.strDefaultDialogPosition;
return"screen_center"===d||"center"===d||"relative"===d?d:"center"}a=a.parentNode}}catch(e){dalert(e)}},resetTableObjInfo:function(){try{g_objWrapperOutlineResize.resetExtOutlineInfo();var a=GetCurTable(this.nEditNumber);fnObjectCheckNull(a)||g_objTableSelection.deselectAllCell(a)}catch(b){dalert(b)}},setButtonFocus:function(a){try{if("undefined"==typeof a||null===a)a=!0;setTimeout(function(){for(var b=this.dialog_obj.getElementsByTagName("*"),c=[],d=1,e=!1,f=0;f<b.length;f++)if("input"==b[f].nodeName.toLowerCase()||
"select"==b[f].nodeName.toLowerCase()||"textarea"==b[f].nodeName.toLowerCase())b[f].tabIndex=d,c.push(b[f]),1==a&&0==e&&0==b[f].disabled&&(b[f].focus(),e=!0),d++}.bind(this),100)}catch(b){dalert(b)}},setButtonStyle:function(){try{for(var a=this.dialog_obj.getElementsByTagName("*"),b="",c="",d=0;d<a.length;d++)if(b=a[d].nodeName.toLowerCase(),c=a[d].getAttribute("type"),("input"==b||"select"==b)&&""==a[d].className){if("submit"==c||"button"==c)a[d].className="duzon_dialog_btn_normal",a[d].onmouseover=
function(){this.className="duzon_dialog_btn_up"},a[d].onmouseout=function(){this.className="duzon_dialog_btn_normal"},a[d].onmousedown=function(){this.className="duzon_dialog_btn_down"},a[d].onmouseup=function(){this.className="duzon_dialog_btn_up"};"file"==c&&(a[d].className="duzon_dialog_body_fileform");"select"==b&&(a[d].className="duzon_dialog_body_selectform")}}catch(e){dalert(e)}},setObjectPosition:function(a,b,c){try{"undefined"==typeof c&&(c="relative");"center"!=c&&(a?0>=a.offsetX&&0>=a.offsetY&&
(c="center"):c="center");this.setScrollPosition(a,b,c);if("relative"==c){var d=c=0;g_objLayerKit.getLayerDocument().documentElement.scrollWidth?g_objLayerKit.getLayerWindow().innerHeight?(c=g_objLayerKit.getLayerWindow().innerWidth,d=g_objLayerKit.getLayerWindow().innerHeight):(c=g_objLayerKit.getLayerDocument().documentElement.clientWidth,d=g_objLayerKit.getLayerDocument().documentElement.clientHeight):(c=g_objLayerKit.getLayerDocument().body.scrollWidth,d=g_objLayerKit.getLayerDocument().body.scrollHeight);
var e=b.offsetWidth,f=b.offsetHeight;this.mousedownX+e>c+this.scrollX&&(this.mousedownX=this.mousedownX-(this.mousedownX+e-(c+this.scrollX))-20);this.mousedownY+f>d+this.scrollY&&(this.mousedownY=this.mousedownY-(this.mousedownY+f-(d+this.scrollY))-10);(0>=this.mousedownX||0>=this.mousedownY)&&this.setScrollPosition(a,b,"center")}0>this.mousedownX&&(this.mousedownX=0);0>this.mousedownY&&(this.mousedownY=0);b.style.left=this.mousedownX+"px";b.style.top=this.mousedownY+"px"}catch(g){dalert(g)}},back_screen_obj:null,
viewBackScreen:function(){try{!0===this.use_backscreen&&(this.back_screen_obj=g_objLayerKit.getElementById(this.idx_duzon_backscreen),!0!==this.checkObject(this.back_screen_obj)&&this.createBackScreen(),this.addBackScreenEvent(),this.back_screen_obj.onclick=function(){null==duzon_dialog.dialog_buttonbox_obj&&duzon_dialog.closeDialog()},this.back_screen_obj.style.display="block",setTimeout(function(){this.dialog_obj=g_objLayerKit.getElementById(this.idx_duzon_dialog);!0===this.checkObject(this.dialog_obj)&&
"none"!=this.dialog_obj.style.display||this.closeBackScreen()}.bind(this),1E3),this.resizeBackScreen())}catch(a){dalert(a)}},addBackScreenEvent:function(){try{window.attachEvent?g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_dialog.resizeBackScreen):window.addEventListener&&g_objLayerKit.getLayerWindow().addEventListener("resize",duzon_dialog.resizeBackScreen,!1)}catch(a){dalert(a)}},removeBackScreenEvent:function(){try{window.detachEvent?g_objLayerKit.getLayerWindow().detachEvent("onresize",
duzon_dialog.resizeBackScreen):window.removeEventListener&&g_objLayerKit.getLayerWindow().removeEventListener("resize",duzon_dialog.resizeBackScreen,!1)}catch(a){dalert(a)}},idx_duzon_backscreen:"idx_dze_backscreen",createBackScreen:function(){try{var a=g_objLayerKit.getLayerDocument();this.back_screen_obj=a.createElement("div");this.back_screen_obj.id=this.idx_duzon_backscreen;this.back_screen_obj.className="duzon_backscreen_transparent";a.body.appendChild(this.back_screen_obj)}catch(b){dalert(b)}},
resizeBackScreen:function(){try{if(!0===duzon_dialog.use_backscreen&&(duzon_dialog.back_screen_obj=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_backscreen),!0===duzon_dialog.checkObject(duzon_dialog.back_screen_obj)&&"none"!=duzon_dialog.back_screen_obj.style.display)){var a=0,b=0;duzon_dialog.back_screen_obj.style.width=a+"px";duzon_dialog.back_screen_obj.style.height=b+"px";g_objLayerKit.getLayerDocument().documentElement.scrollWidth&&(a=g_objLayerKit.getLayerDocument().documentElement.scrollWidth);
g_objLayerKit.getLayerDocument().documentElement.scrollHeight&&(b=g_objLayerKit.getLayerDocument().documentElement.scrollHeight);g_objLayerKit.getLayerWindow().innerHeight&&g_objLayerKit.getLayerWindow().innerHeight>b&&(b=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&g_objLayerKit.getLayerDocument().documentElement.clientHeight>b&&(b=g_objLayerKit.getLayerDocument().documentElement.clientHeight);g_objLayerKit.getLayerDocument().body.scrollWidth&&
g_objLayerKit.getLayerDocument().body.scrollWidth>a&&(a=g_objLayerKit.getLayerDocument().body.scrollWidth);g_objLayerKit.getLayerDocument().body.scrollHeight&&g_objLayerKit.getLayerDocument().body.scrollHeight>b&&(b=g_objLayerKit.getLayerDocument().body.scrollHeight);duzon_dialog.back_screen_obj.style.width=a+"px";duzon_dialog.back_screen_obj.style.height=b+"px"}}catch(c){dalert(c)}},closeBackScreen:function(){try{!0===duzon_dialog.use_backscreen&&(duzon_dialog.back_screen_obj=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_backscreen),
!0===duzon_dialog.checkObject(duzon_dialog.back_screen_obj)&&(duzon_dialog.back_screen_obj.style.width="0px",duzon_dialog.back_screen_obj.style.height="0px",duzon_dialog.back_screen_obj.style.display="none",this.removeBackScreenEvent()))}catch(a){dalert(a)}},idx_duzon_dialog:"idx_duzon_dialog",createDialog:function(a,b,c,d,e,f){try{if(null!=this.dialog_obj&&(g_objLayerKit.getLayerDocument().body.removeChild(this.dialog_obj),this.dialog_obj=null,null!=this.closeDialogTimer&&(clearTimeout(this.closeDialogTimer),
this.closeDialogTimer=null)),null==this.dialog_obj){var g=g_objLayerKit.getLayerDocument();this.dialog_obj=g.createElement("div");this.dialog_obj.className="duzon_dialog";this.dialog_obj.id=this.idx_duzon_dialog;this.dialog_obj.style.top="0";this.dialog_obj.style.left="0";""!=b&&(this.dialog_title_obj=this.createDialogTitle(b),this.dialog_obj.appendChild(this.dialog_title_obj));this.dialog_body_obj=this.createDialogBody(c);this.dialog_obj.appendChild(this.dialog_body_obj);0<d&&(this.dialog_buttonbox_obj=
this.createDialogButtonBox(d,e,f),this.dialog_obj.appendChild(this.dialog_buttonbox_obj),this!==duzon_dialog&&(duzon_dialog.dialog_buttonbox_obj=this.dialog_buttonbox_obj));g.body.appendChild(this.dialog_obj)}}catch(h){dalert(h)}},unload:function(){try{var a=g_objLayerKit.getLayerDocument(),b=a?a.body.querySelector("#"+this.idx_duzon_dialog):null;b&&b.parentNode&&b.parentNode.removeChild(b);var c=a?a.body.querySelector("#"+this.idx_duzon_backscreen):null;c&&c.parentNode&&c.parentNode.removeChild(c)}catch(d){dalert(d)}},
dialog_title_obj:{},createDialogTitle:function(a){try{var b=g_objLayerKit.getLayerDocument().createElement("div");b.className="duzon_dialog_title";b.innerHTML=a;b.ondragstart=function(){return!1};b.onselectstart=function(){return!1};return b}catch(c){dalert(c)}},dialog_body_obj:{},createDialogBody:function(a){try{var b=g_objLayerKit.getLayerDocument().createElement("div");b.className="duzon_dialog_body";var c=g_objLayerKit.getLayerDocument().createElement("div");"object"==typeof a?c.appendChild(a):
"string"==typeof a&&(c.innerHTML=a);1!=this.getTabType()&&(c.className="duzon_dialog_body_content");this.setTabType(!1);b.appendChild(c);return b}catch(d){dalert(d)}},dialog_buttonbox_obj:null,createDialogButtonBox:function(a,b,c){try{var d=g_objLayerKit.getLayerDocument().createElement("div");d.className="duzon_dialog_buttonbox";for(var e={},f=0;f<a;f++)e={},e=g_objLayerKit.getLayerDocument().createElement("input"),e.type="button",e.value=b[f],function(){var a=c[f],b=f;e.onclick=function(b){a(b?
b:window.event)};var d="duzon_dialog_btn_normal",m="duzon_dialog_btn_up",l="duzon_dialog_btn_down";0==b&&(d="duzon_dialog_btn_ok_normal",m="duzon_dialog_btn_ok_up",l="duzon_dialog_btn_ok_down");e.className=d;e.onmouseover=function(){this.className=m};e.onmouseout=function(){this.className=d};e.onmousedown=function(){this.className=l};e.onmouseup=function(){this.className=m}}(),d.appendChild(e);return d}catch(g){dalert(g)}},closeDialogTimer:null,closeDialog:function(){try{0!=duzon_dialog.dialogStatus&&
(duzon_dialog.dialogStatus=!1,null!=this.dialog_obj&&(this.fade("out",this.dialog_obj),DzeSpinner.closeDialog(),this.closeDialogTimer=setTimeout(function(){null!=this.dialog_obj&&(g_objLayerKit.getLayerDocument().body.removeChild(this.dialog_obj),this.dialog_buttonbox_obj=this.closeDialogTimer=this.dialog_obj=null)}.bind(this),500),this.closeBackScreen(),this.removeDialogEvent(),this.unloadCB(),this.unloadCB=function(){},duzon_dialog.resetSelection&&g_bBrowserType_IE?1==duzon_dialog.isFindDialog&&
this.setEditorFocus():(this.setEditorSelection(),this.setEditorFocus(),editor_onselectionchange(this.nEditNumber),GetMultiCellSelection(this.nEditNumber)&&updateTableHandlerUI.updateTableUIHandler(this.nEditNumber))))}catch(a){dalert(a)}},top_window_onresize:function(){try{this.dialogStatus&&this.dialog_obj&&!0===this.closeDlgIfWindowResize&&this.closeDialog()}catch(a){dalert(a)}},setEditorFocus:function(){try{if(window.attachEvent)g_objEditWindow[this.nEditNumber].focus();else{var a=!1,b=GetCurRange(this.nEditNumber);
if(b&&b.collapsed){var c=b.startContainer.childNodes[b.startOffset]||b.startContainer;g_objNodeUtil.isTextArea(c)&&(c.focus({preventScroll:!0}),a=!0)}a||g_objEditorDocument[this.nEditNumber].body.focus({preventScroll:!0})}}catch(d){dalert(d)}},setEditorSelection:function(){if(g_bBrowserType_IE)try{if(null!=g_objLastRange[this.nEditNumber])if(window.attachEvent)g_objLastRange[this.nEditNumber].select();else{var a=g_objEditWindow[this.nEditNumber].getSelection();a.removeAllRanges();a.addRange(g_objLastRange[this.nEditNumber])}}catch(b){dalert(b)}},
setSelection:function(){this.setEditorSelection()},setOpacity:function(a,b){try{"undefined"!=typeof a&&"undefined"!=typeof a.id&&(a.style.opacity=b,a.style.filter="alpha(opacity="+100*b+")",a.style.MozOpacity=b,a.style.KhtmlOpacity=b)}catch(c){dalert(c)}},fade_effect:!0,fade:function(a,b){try{if(!0!==duzon_dialog.fade_effect)b.style.display="out"==a?"none":"block";else{var c="out"==a?1:.1;duzon_dialog.setOpacity(b,c);b.style.display="block";var d=0,e=setInterval(function(){"out"==a?.1>=c&&(c=0,clearInterval(e),
b.style.display="none"):.9<=c&&(c=1,clearInterval(e));duzon_dialog.setOpacity(b,c);c="out"==a?c-.3*c:c+.3*c;d++},10)}}catch(f){dalert(f)}},drag_status:!1,drag_startX:0,drag_startY:0,org_windowSizeInfo:{},evtDialogBoxDragDown:function(a){try{var b=a?a:window.event;if("duzon_dialog_title"==(b.srcElement?b.srcElement:b.target).className){var c=this.getDialogLayerPosition(b);this.drag_startX=c.mousedownX;this.drag_startY=c.mousedownY;this.drag_status=!0;this.dialog_obj.className="duzon_dialog_move";this.setOpacity(this.dialog_obj,
.5);this.org_windowSizeInfo=this.getActiveDialogWindowSize()}}catch(d){dalert(d)}},evtDialogBoxDragMove:function(a){try{var b=a?a:window.event;if(!0===this.drag_status){var c=this.getDialogLayerPosition(b),d=c.mousedownX-this.drag_startX,e=c.mousedownY-this.drag_startY,f=parseInt(this.dialog_obj.style.left.replace(/px/,""),10)+d,g=parseInt(this.dialog_obj.style.top.replace(/px/,""),10)+e;0<=f&&(!0===dzeUiConfig.bAllowDialogDragInWindow?f+c.width<=this.org_windowSizeInfo.view_window_width+this.org_windowSizeInfo.scrollX?
this.drag_startX=c.mousedownX:f=this.org_windowSizeInfo.view_window_width+this.org_windowSizeInfo.scrollX-c.width:this.drag_startX=c.mousedownX);0>f&&(f=0);0<=g&&(!0===dzeUiConfig.bAllowDialogDragInWindow?g+c.height<=this.org_windowSizeInfo.view_window_height+this.org_windowSizeInfo.scrollY?this.drag_startY=c.mousedownY:g=this.org_windowSizeInfo.view_window_height+this.org_windowSizeInfo.scrollY-c.height:this.drag_startY=c.mousedownY);0>g&&(g=0);this.dialog_obj.style.left=f+"px";this.dialog_obj.style.top=
g+"px"}}catch(h){dalert(h)}},evtDialogBoxDragUp:function(a){try{this.drag_status=!1,this.dialog_obj.className="duzon_dialog",this.setOpacity(this.dialog_obj,1)}catch(b){dalert(b)}},getDialogLayerPosition:function(a){var b={scrollX:0,scrollY:0,mousedownX:0,mousedownY:0,top:0,right:0,bottom:0,left:0,width:0,height:0};try{return"undefined"!=typeof a&&null!=a&&(document.documentElement.scrollLeft?(b.scrollX=document.documentElement.scrollLeft,b.mousedownX=document.documentElement.scrollLeft+a.clientX):
(b.scrollX=document.body.scrollLeft,b.mousedownX=document.body.scrollLeft+a.clientX),document.documentElement.scrollTop?(b.scrollY=document.documentElement.scrollTop,b.mousedownY=document.documentElement.scrollTop+a.clientY):(b.scrollY=document.body.scrollTop,b.mousedownY=document.body.scrollTop+a.clientY)),"none"!=this.dialog_obj.style.display&&(b.top=parseInt(this.dialog_obj.style.top.replace(/px/,""),10),b.left=parseInt(this.dialog_obj.style.left.replace(/px/,""),10),b.width=this.dialog_obj.offsetWidth,
b.height=this.dialog_obj.offsetHeight,b.right=b.left+b.width,b.bottom=b.top+b.height),b}catch(c){return dalert(c),b}},keyCode:"",evtKeyCode:function(a){try{this.keyCode=(a?a:window.event).keyCode,dlog("keycode :"+this.keyCode),27==this.keyCode&&(g_objPropForm.bShowPropForm||this.closeDialog())}catch(b){dalert(b)}},scrollX:0,scrollY:0,mousedownX:0,mousedownY:0,setScrollPosition:function(a,b,c){try{if("undefined"==typeof c&&(c="relative"),"center"!=c&&(a?0>=a.offsetX&&0>=a.offsetY&&(c="center"):c="center"),
"relative"==c){if(g_objLayerKit.getLayerDocument().documentElement.scrollLeft?(this.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft,this.mousedownX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft+a.clientX):(this.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft,this.mousedownX=g_objLayerKit.getLayerDocument().body.scrollLeft+a.clientX),g_objLayerKit.getLayerDocument().documentElement.scrollTop?(this.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop,
this.mousedownY=g_objLayerKit.getLayerDocument().documentElement.scrollTop+a.clientY):(this.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop,this.mousedownY=g_objLayerKit.getLayerDocument().body.scrollTop+a.clientY),"child"==this.income_path){var d=g_objPositionUtil.getFrameClientRect();this.mousedownX=a.clientX+d.left;this.mousedownY=a.clientY+d.top}}else if("center"==c){g_objLayerKit.getLayerDocument().documentElement.scrollLeft?this.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft:
this.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft;g_objLayerKit.getLayerDocument().documentElement.scrollTop?this.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop:this.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop;var e=b.offsetWidth,f=b.offsetHeight,g=g_objPositionUtil.getOuterRect(g_objEditObject[this.nEditNumber]);d=g_objPositionUtil.getFrameClientRect();this.mousedownY=d.top+g.top+10;var h=g_objLayerKit.getLayerDocument().body;if(h===b.parentNode){var k=
h.scrollHeight;this.mousedownY+f>k&&(this.mousedownY=Math.max(k-f-10,10))}this.mousedownX=d.left+g.left+(g.width-e)/2;this.scrollY=this.scrollX=0}else"screen_center"==c&&(g_objLayerKit.getLayerDocument().documentElement.scrollLeft?this.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft:this.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft,g_objLayerKit.getLayerDocument().documentElement.scrollTop?this.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop:this.scrollY=
g_objLayerKit.getLayerDocument().body.scrollTop,c=a=0,g_objLayerKit.getLayerDocument().documentElement.scrollWidth?g_objLayerKit.getLayerWindow().innerHeight?(a=g_objLayerKit.getLayerWindow().innerWidth,c=g_objLayerKit.getLayerWindow().innerHeight):(a=g_objLayerKit.getLayerDocument().documentElement.clientWidth,c=g_objLayerKit.getLayerDocument().documentElement.clientHeight):(a=g_objLayerKit.getLayerDocument().body.scrollWidth,c=g_objLayerKit.getLayerDocument().body.scrollHeight),e=b.offsetWidth,
f=b.offsetHeight,this.mousedownX=a/2+this.scrollX-e/2,this.mousedownY=c/2+this.scrollY-f/2)}catch(m){dalert(m)}},idx_toast_msg:"idx_toast_msg",toastObj:null,toastHideCallback:null,showToastMessage:function(a,b,c,d){try{if(null==this.toastObj){var e=g_objLayerKit.getLayerDocument();this.toastObj=e.createElement("div");this.toastObj.className="duzon_toastmsg_box";this.toastObj.innerHTML=b;e.body.appendChild(this.toastObj);this.fade("in",this.toastObj);this.setObjectPosition(a,this.toastObj);d&&(this.toastHideCallback=
d);setTimeout(function(){this.hideToastMessage()}.bind(this),1E3*c)}}catch(f){dalert(f)}},hideToastMessage:function(){try{null!=this.toastObj&&(this.fade("out",this.toastObj),setTimeout(function(){var a=g_objLayerKit.getLayerDocument();try{a.body.removeChild(this.toastObj)}catch(b){dalert(b)}this.toastObj=null;this.toastHideCallback&&this.toastHideCallback();this.toastHideCallback=null}.bind(this),500))}catch(a){dalert(a)}},showToastMessageArray:function(a,b,c){try{if(b&&b.length){var d=function(){if(0<
b.length){var c=b.shift();this.showToastMessage(a,c,2,function(){this.hideToastMessage(!1,!1);d()})}}.bind(this);d()}}catch(e){dalert(e)}},docFormLeftContent:null,docFormRightContent:null,selectedDocCategoryNo:-1,selectedDocNo:-1,getDocFormContent:function(){try{var a=document.createElement("div");a.className="duzon_dialog_docform_container";var b=document.createElement("div");b.className="duzon_dialog_docform_left";var c=document.createElement("div");c.className="duzon_dialog_docform_left_title";
c.innerHTML=ID_RES_DIALOG_LIST_TITLE_FORM_AREA;this.docFormLeftContent=document.createElement("div");this.docFormLeftContent.className="duzon_dialog_docform_left_content";b.appendChild(c);b.appendChild(this.docFormLeftContent);var d=document.createElement("div");d.className="duzon_dialog_docform_right";var e=document.createElement("div");e.className="duzon_dialog_docform_right_title";e.innerHTML=ID_RES_DIALOG_LIST_TITLE_FORM_SELECT;this.docFormRightContent=document.createElement("div");this.docFormRightContent.className=
"duzon_dialog_docform_right_content";d.appendChild(e);d.appendChild(this.docFormRightContent);a.appendChild(b);a.appendChild(d);var f=null;this.dynamicScriptCall("const/file_docform_const.js",function(){for(var a=0;a<docformTemplateCategory.length;a++)f=document.createElement("div"),f.className="duzon_dialog_docform_category_list",f.innerHTML=docformTemplateCategory[a].category,function(){var b=a;f.onclick=function(){duzon_dialog.selectDocFormCategory(b)}}(),duzon_dialog.docFormLeftContent.appendChild(f);
duzon_dialog.selectDocFormCategory(0)});return a}catch(g){dalert(g)}},selectDocFormCategory:function(a){try{this.selectedDocCategoryNo=a;this.selectedDocNo=0;for(var b=this.docFormLeftContent.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"duzon_dialog_docform_category_list_select":"duzon_dialog_docform_category_list";this.docFormRightContent.innerHTML="";var d=null;for(c=0;c<docformTemplateCategory[a].data.length;c++)d=document.createElement("div"),d.className="duzon_dialog_docform_category_data",
d.innerHTML=docformTemplateCategory[a].data[c].name,function(){var a=c;d.onclick=function(){duzon_dialog.selectDocFormData(a)};d.ondblclick=function(){duzon_dialog.selectDocFormData(a);duzon_dialog.inputSelectDocFormData()}}(),this.docFormRightContent.appendChild(d);0<=this.selectedDocNo&&this.selectDocFormData(this.selectedDocNo)}catch(e){dalert(e)}},selectDocFormData:function(a){try{this.selectedDocNo=a;for(var b=this.docFormRightContent.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=
c==a?"duzon_dialog_docform_category_data_select":"duzon_dialog_docform_category_data"}catch(d){dalert(d)}},inputSelectDocFormData:function(){try{if(0>this.selectedDocCategoryNo||0>this.selectedDocNo)alert(ID_RES_DIALOG_ALERT_SELECT_DOCFORM);else{var a=fnGetEditorHTMLCode(!1,this.nEditNumber);a=a.trim();if(""==a||"<p><br /></p>"==a||"<p><br></p>"==a||"<p>&nbsp;</p>"==a||"<p></p>"==a||"<br>"==a||"<br />"==a||confirm(ID_RES_DIALOG_CONFIRM_DOCFORM_DELETE_CONTENT))this.resetTableObjInfo(),replaceHTMLContent(docformTemplateCategory[this.selectedDocCategoryNo].data[this.selectedDocNo].html,
this.nEditNumber),this.selectedDocNo=-1,this.layoutMode=!1;this.closeDialog()}}catch(b){dalert(b)}},selectedLayoutNo:-1,layoutContainer:null,idx_dze_file_layout_container:"idx_dze_file_layout_container",getLayoutContent:function(){try{this.dynamicScriptCall("const/file_layout_const.js",function(){dlog("file_layout_const load ok")});this.layoutContainer=document.createElement("div");this.layoutContainer.className="duzon_dialog_content_medium";this.layoutContainer.id=this.idx_dze_file_layout_container;
var a="";a+="<table cellspacing=0 cellpadding=0 border=0>";for(var b=0,c=0,d="",e="",f=0;4>f;f++){a+="<tr>";for(var g=0;4>g;g++)c++,d=c,10>c&&(d="0"+c),e=dzeEnvConfig.strPath_Image+"dialog/popup_btn_layout_"+d+".png",a+="<td width='100'>",a+="<div class='duzon_file_layout_unit'><img src='"+e+"' width='98' height='98'/></div>",a+="</td>",3>g&&(a+="<td width='4'></td>"),b++;a+="</tr>";3>f&&(a+="<tr><td colspan='7' height='4'></td></tr>")}a+="</table>";this.selectedLayoutNo=-1;this.layoutContainer.innerHTML=
a;return this.layoutContainer}catch(h){dalert(h)}},addLayoutContentEvent:function(){try{for(var a=this.layoutContainer.getElementsByTagName("div"),b=0;b<a.length;b++)(function(){var c=b;a[b].onclick=function(){duzon_dialog.selectLayoutData(c)};a[b].onmouseover=function(){"duzon_file_layout_unit_select"!=this.className&&(this.className="duzon_file_layout_unit_over")};a[b].onmouseout=function(){"duzon_file_layout_unit_select"!=this.className&&(this.className="duzon_file_layout_unit")}})()}catch(c){dalert(c)}},
selectLayoutData:function(a){try{this.selectedLayoutNo=a;dlog("this.selectedLayoutNo:"+this.selectedLayoutNo);for(var b=this.layoutContainer.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"duzon_file_layout_unit_select":"duzon_file_layout_unit"}catch(d){dalert(d)}},layoutMode:!1,inputSelectLayoutData:function(){try{if(0>this.selectedLayoutNo)alert(ID_RES_DIALOG_ALERT_SELECT_LAYOUT_DESIGN);else{var a=fnGetEditorHTMLCode(!1,this.nEditNumber);a=a.trim();if(""==a||"<p><br /></p>"==
a||"<p><br></p>"==a||"<br>"==a||"<br />"==a||confirm(ID_RES_DIALOG_CONFIRM_LAYOUT_DELETE_CONTENT)){this.resetTableObjInfo();replaceHTMLContent(layoutTemplate[this.selectedLayoutNo],this.nEditNumber);this.layoutMode=!0;this.closeDialog();this.setLayoutStyleToTable(this.nEditNumber);var b=g_objEditorDocument[this.nEditNumber].body,c=b.getElementsByTagName("H1");if(null!=c&&0<c.length){var d=c[0];duzon_dialog.setFocusElement(d,duzon_dialog.nEditNumber,"start")}else{var e=b.getElementsByTagName("P");
null!=e&&0<e.length&&(d=e[0],duzon_dialog.setFocusElement(d,duzon_dialog.nEditNumber,"start"))}g_objEditWindow[duzon_dialog.nEditNumber].scrollTo(0,0)}else this.closeDialog()}}catch(f){dalert(f)}},setLayoutStyleToTable:function(a){try{if(1==this.layoutMode){var b=g_objEditorDocument[a].body.getElementsByTagName("table");for(a=0;a<b.length;a++){b[a].className="dze_tb_layout";for(var c=b[a].getElementsByTagName("*"),d=0;d<c.length;d++)if("th"==c[d].nodeName.toLowerCase()||"td"==c[d].nodeName.toLowerCase())c[d].className=
"dze_tb_layout_td"}}}catch(e){dalert(e)}},setFocusElement:function(a,b,c){try{if(a&&a.parentNode){b=!0;"undefined"!=typeof c&&"end"==c&&(b=!1);var d=a.ownerDocument;if(d)if(d.createRange){var e=d.createRange();g_objNodeUtil.canSelectNodeContents(a)?e.selectNodeContents(a):e.selectNode(a);e.collapse(b);var f=d.defaultView;var g=f.getSelection();g.removeAllRanges();g.addRange(e)}else d.selection&&(e=d.body.createTextRange(),e.moveToElementText(a),e.collapse(b),e.select())}}catch(h){dalert(h)}finally{}},
selectElement:function(a,b){try{if(g_objEditorDocument[b].createRange){var c=g_objEditorDocument[b].createRange();c.selectNodeContents(a);var d=g_objEditorDocument[b].getSelection();d.removeAllRanges();d.addRange(c)}else g_objEditorDocument[b].selection&&(c=g_objEditorDocument[b].body.createTextRange(),c.moveToElementText(a),c.select())}catch(e){dalert(e)}},makeExtFileForm:function(a,b,c,d,e){d="undefined"==typeof d?"":d.join(",");"undefined"==typeof c&&(c="auto");c="<div style='width:"+c+"'><table width='100%' border='0' cellpadding='0' cellspacing='0' style='table-layout:fixed'><tr>";
c+="<td><div class='duzon_dialog_upload_fileview_container' id='"+b+"_view'></div></td>";c+="<td width='4'></td>";c+="<td width='80' class='duzon_dialog_body_fileform_hide_td'>";c+="<input type='button' value='"+ID_RES_CONST_STRING_EDIT_SEARCH+"' style='' class='duzon_dialog_btn_upload'>";c+="<input type='file' name='"+a+"' id='"+b+"'"+(!0===e?"multiple ":" ")+"class='duzon_dialog_body_fileform_hide' accept='"+d+"' />";c+="</td>";c+="</tr>";c+="</table>";return c+="</div>"},addEventExtFileForm:function(a,
b){try{var c=g_objLayerKit.getElementById(a),d=g_objLayerKit.getElementById(a+"_view");c.onchange=function(){for(var a="",c=0,g=this.files.length;c<g;c++){var h=this.files[c].name;-1<h.indexOf("\\")&&(h=h.split("\\").pop());-1<h.indexOf("/")&&(h=h.split("/").pop());0!=c&&(a+=" ");a+='"'+h+'"'}d&&(d.innerHTML="<div style='width:1000px;overflow:hidden'>"+a+"</div>");"undefined"!=typeof b&&b.call(this)};c.onmouseover=function(){this.previousSibling&&(this.previousSibling.style.backgroundColor="#f2f2f2")};
c.onmousedown=function(){this.previousSibling&&(this.previousSibling.style.backgroundColor="#d9d9d9")};c.onmouseup=function(){this.previousSibling&&(this.previousSibling.style.backgroundColor="#f2f2f2")};c.onmouseout=function(){this.previousSibling&&(this.previousSibling.style.backgroundColor="")};d&&(d.onmouseover=function(){this.title=this.innerText})}catch(e){dalert(e)}},disableExtFileForm:function(a){g_objLayerKit.getElementById(a).disabled=!0;g_objLayerKit.getElementById(a).style.cursor="default";
g_objNodeUtil.getLoopParentElement(g_objLayerKit.getElementById(a),"table").style.opacity="0.3"},enableExtFileForm:function(a){g_objLayerKit.getElementById(a).disabled=!1;g_objLayerKit.getElementById(a).style.cursor="pointer";g_objNodeUtil.getLoopParentElement(g_objLayerKit.getElementById(a),"table").style.opacity="1"},disableImageUrlForm:function(a){g_objLayerKit.getElementById(a).disabled=!0;g_objLayerKit.getElementById(a).style.opacity="0.3"},enableImageUrlForm:function(a){g_objLayerKit.getElementById(a).disabled=
!1;g_objLayerKit.getElementById(a).style.opacity="1"},makeSpinnerInputForm:function(a,b,c,d,e,f,g,h){try{return DzeSpinner.getHTML({id:a,value:e,unit:b,width:f,height:g,marginRight:h})}catch(k){dalert(k)}},setEnableSpinner:function(a,b){try{var c=DzeSpinner.getSpinner(a);c&&c.enable(b)}catch(d){dalert(d)}},modifySpinnerValue:function(a,b,c,d,e,f,g,h){try{var k=g_objLayerKit.getElementById(a);return DzeSpinner.createSpinner(k,{max:b,min:c,value:d,callback:e,onmouseup:f,amount:g,alert:h})}catch(m){dalert(m)}},
idx_paste_special_type_text:"idx_duzon_paste_special_type_text",idx_paste_special_type_html:"idx_duzon_paste_special_type_html",getPastespecial:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";a+="<div style='margin-bottom:5px;'><input type='radio' name='paste_special_type' id='"+this.idx_paste_special_type_text+"' value='text' /> "+ID_RES_DIALOG_STRING_NO_STYLE_TEXT+"</div>";a+="<div><input type='radio' name='paste_special_type' id='"+this.idx_paste_special_type_html+"' value='html' checked> "+
ID_RES_DIALOG_STRING_HTML_STYLE_TEXT+"</div>";return a+"</div>"}catch(b){dalert(b)}},idxTabContainer:"idxDuzonTabContainer",tabTitleContainer:null,tabBodyContainer:null,tabDefaultContainer:null,tabBottomContainer:null,defaultTabSize:60,tabOnloadCallbacks:[],getTabContents:function(a,b,c,d,e,f){try{if("undefined"==typeof d){d=[];for(var g=0;g<a;g++)d[g]=this.defaultTabSize}var h=0;for(g=0;g<a;g++)"undefined"==typeof d[g]&&(d[g]=this.defaultTabSize),h+=d[g];this.tabOnloadCallbacks=[];if("undefined"==
typeof f)for(g=0;g<a;g++)this.tabOnloadCallbacks.push(function(){});else for(g=0;g<a;g++)"undefined"==typeof f[g]?this.tabOnloadCallbacks.push(function(){}):this.tabOnloadCallbacks.push(f[g]);this.tabTitleContainer=document.createElement("div");this.tabTitleContainer.className="duzon_dialog_tab_container";this.tabTitleContainer.id=this.idxTabContainer;var k=document.createElement("div");k.className="duzon_dialog_tab_title_blank_left";this.tabTitleContainer.appendChild(k);var m=null,l=this;for(g=0;g<
a;g++)m=document.createElement("div"),m.className="duzon_dialog_tab_titles_off",m.style.width=d[g]+"px",m.innerHTML=b[g],function(){var a=g;m.onclick=function(){l.viewTabContents(a)}}(),this.tabTitleContainer.appendChild(m);var n=document.createElement("div");n.className="duzon_dialog_tab_title_blank_right";n.style.marginLeft=h+2+14+"px";this.tabTitleContainer.appendChild(n);this.tabBodyContainer=document.createElement("div");this.tabBodyContainer.className="duzon_dialog_tab_body_container";b=null;
for(g=0;g<a;g++)b=document.createElement("div"),b.className="duzon_dialog_tab_body_container_off","object"==typeof c[g]?b.appendChild(c[g]):"string"==typeof c[g]&&(b.innerHTML=c[g]),this.tabBodyContainer.appendChild(b);this.tabDefaultContainer=document.createElement("div");this.tabDefaultContainer.className="duzon_dialog_tab_default_container";"undefined"!=typeof e&&("object"==typeof e?this.tabDefaultContainer.appendChild(e):"string"==typeof e&&(this.tabDefaultContainer.innerHTML=e));this.tabBottomContainer=
document.createElement("div");this.tabBottomContainer.className="duzon_dialog_tab_bottom_container";var p=document.createElement("div");p.appendChild(this.tabTitleContainer);p.appendChild(this.tabBodyContainer);p.appendChild(this.tabDefaultContainer);p.appendChild(this.tabBottomContainer);this.tabType=!0;return p}catch(u){dalert(u)}},viewTabContents:function(a){try{for(var b=this.tabTitleContainer.getElementsByTagName("div"),c=1;c<b.length-1;c++)b[c].className=a+1==c?"duzon_dialog_tab_titles_on":
"duzon_dialog_tab_titles_off";var d=this.tabBodyContainer.getElementsByTagName("div");b=[];for(c=0;c<d.length;c++)"duzon_dialog_tab_body_container_on"!=d[c].className&&"duzon_dialog_tab_body_container_off"!=d[c].className||b.push(d[c]);for(c=0;c<b.length;c++)b[c].className=a==c?"duzon_dialog_tab_body_container_on":"duzon_dialog_tab_body_container_off";this.tabOnloadCallbacks[a]()}catch(e){dalert(e)}},idx_duzon_find_text:"idx_duzon_find_text",idx_duzon_replace_text:"idx_duzon_replace_text",idx_find_text_box:"idx_duzon_find_text_box",
idx_replace_text_box:"idx_duzon_replace_text_box",getReplaceFormText:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div id='"+this.idx_find_text_box+"' class='duzon_dialog_find_form_container'>"+ID_RES_DIALOG_STRING_FIND_TEXT+": <input type='text' name='dze_find_text' id='"+this.idx_duzon_find_text+"' value='' size='30' class='duzon_findtext_frm' autocomplete='off'/></div>";a+="<div id='"+this.idx_replace_text_box+"' class='duzon_dialog_find_form_container'>"+ID_RES_DIALOG_STRING_REPLACE_TEXT+
": <input type='text' name='dze_replace_text' id='"+this.idx_duzon_replace_text+"' value='' size='30' class='duzon_replacetext_frm' autocomplete='off'/></div>";return a+"</div>"}catch(b){dalert(b)}},idx_casesensitive:"idx_casesensitive",idx_ignorespace:"idx_ignorespace",idx_findforward:"idx_findforward",idx_findbackward:"idx_findbackward",idx_completeword:"idx_completeword",isFindDialog:!1,getFindOptionFormText:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='duzon_dialog_label_separator'></div>";
a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIND_OPTION+"</div>";a+="<div class='duzon_dialog_string_divline'>";a+="<input type='checkbox' name='dze_casesensitive' id='"+this.idx_casesensitive+"' value='1' /> "+ID_RES_DIALOG_STRING_CASESENSITIVE;a+="<input type='checkbox' name='dze_completeword' id='"+this.idx_completeword+"' value='1' /> "+ID_RES_DIALOG_STRING_COMPLETEWORD;a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+
ID_RES_DIALOG_STRING_FIND_DERECTION+"</div>";a+="<div>";a+="<input type='radio' name='dze_direction' id='"+this.idx_findforward+"' value='0' checked /> "+ID_RES_DIALOG_STRING_FIND_DOWN;a+="<input type='radio' name='dze_direction' id='"+this.idx_findbackward+"' value='1'/> "+ID_RES_DIALOG_STRING_FIND_UP;return a+"</div></div>"}catch(b){dalert(b)}},strFindText:"",getFindReplaceContent:function(){try{return this.getTabContents(2,[ID_RES_CONST_STRING_EDIT_SEARCH,ID_RES_CONST_STRING_EDIT_REPLACE],["",
""],[60,60],this.getReplaceFormText()+this.getFindOptionFormText(),[function(){g_objLayerKit.getElementById(duzon_dialog.idx_replace_text_box).style.display="none";g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus();var a=duzon_dialog.dialog_buttonbox_obj.getElementsByTagName("input");dlog("btnObj[0]:"+a[0].value);a[0].style.display="none";a[1].style.display="none"},function(){g_objLayerKit.getElementById(duzon_dialog.idx_replace_text_box).style.display="inline";var a=duzon_dialog.dialog_buttonbox_obj.getElementsByTagName("input");
a[0].style.display="inline";a[1].style.display="inline";""==g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value?g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus():g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).focus()}])}catch(a){dalert(a)}},idx_dze_ext_movie_source:"idx_dze_ext_movie_source",idx_dze_movie_align_form:"idx_dze_movie_align_form",getInsertExtMovieContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+=
"<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_INPUT_SOURCE+"</div>";a+="<div class=''><textarea name='dze_ext_movie_source' id='"+this.idx_dze_ext_movie_source+"' class='dze_ext_movie_source_form' placeholder='"+ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE+"'></textarea></div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";
a+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_LEFT+" :</td>";a+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_marginleft","px","500","0","0")+"</td>";a+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_TOP+" :</td>";a+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_margintop","px","500","0","0")+"</td>";a+="</tr>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_RIGHT+" :</td>";a+="<td>"+this.makeSpinnerInputForm("dze_movie_marginright",
"px","500","0","0")+"</td>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_BOTTOM+" :</td>";a+="<td>"+this.makeSpinnerInputForm("dze_movie_marginbottom","px","500","0","0")+"</td>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="</tr>";a+="<tr>";a+="<td colspan='2'>"+ID_RES_CONST_STRING_ALIGN+" : <select name='dze_movie_align' id='"+this.idx_dze_movie_align_form+"'><option value='default'>"+ID_RES_DIALOG_STRING_ALIGN_BASIC+"</option><option value='left'>"+ID_RES_DIALOG_STRING_ALIGN_LEFT+"</option><option value='center'>"+
ID_RES_DIALOG_STRING_ALIGN_CENTER+"</option><option value='right'>"+ID_RES_DIALOG_STRING_ALIGN_RIGHT+"</option></select></td>";a+="<td colspan='2' align='right'></td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}},insertExtMovieContent:function(){try{var a=g_objLayerKit.getElementById(this.idx_dze_ext_movie_source);source=a.value.trim();!0===dzeUiConfig.bRemoveXSS&&(source=removeXSS(source,{bCheckIframe:!1}));if(""==source)return alert(ID_RES_DIALOG_STRING_INPUT_MOVIE_SOURCE),a.focus(),
!1;a=g_objLayerKit.getLayerDocument().createElement("div");a.innerHTML=source;var b=a.getElementsByTagName("iframe");if(0===b.length&&(b=a.getElementsByTagName("object"),0===b.length))return alert(ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE),!1;"default"!=g_objLayerKit.getElementById(this.idx_dze_movie_align_form).value&&(a.style.textAlign=g_objLayerKit.getElementById(this.idx_dze_movie_align_form).value);""!=g_objLayerKit.getElementById("dze_movie_marginleft").value&&(a.style.marginLeft=g_objLayerKit.getElementById("dze_movie_marginleft").value+
"px");""!=g_objLayerKit.getElementById("dze_movie_margintop").value&&(a.style.marginTop=g_objLayerKit.getElementById("dze_movie_margintop").value+"px");""!=g_objLayerKit.getElementById("dze_movie_marginright").value&&(a.style.marginRight=g_objLayerKit.getElementById("dze_movie_marginright").value+"px");""!=g_objLayerKit.getElementById("dze_movie_marginbottom").value&&(a.style.marginBottom=g_objLayerKit.getElementById("dze_movie_marginbottom").value+"px");a.style.width="auto";a.style.height="auto";
a.style.overflow="auto";var c=g_objLayerKit.getLayerDocument().createElement("div");c.appendChild(a);this.closeDialog();addHTMLContent(c.innerHTML,null,0,this.nEditNumber);return!0}catch(d){dalert(d)}},idx_dze_insert_extfile_link_box:"idx_dze_insert_extfile_link_box",idx_dze_insert_extfile_text:"idx_dze_insert_extfile_text",idx_dze_up_extfile:"idx_dze_up_extfile",allow_file_ext_array:"doc docx xls xlsx ppt pptx hwp txt pdf".split(" "),getInsertExtFileContent:function(){try{for(var a=[],b=0;b<this.allow_file_ext_array.length;b++)a.push("."+
this.allow_file_ext_array[b]);var c=a.join(",");a="";a+="<div class='duzon_dialog_content_medium'>";a+="<form name='dze_insert_extfile_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadExtFileURL+"' >";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td width='100'>"+ID_RES_DIALOG_STRING_FILE_PATH+" : </td><td></label> <input type='file' name='dze_up_extfile' value='' id='"+this.idx_dze_up_extfile+"' onchange='duzon_dialog.uploadExtFile()' accept='"+
c+"' class='duzon_dialog_body_fileform' /></td>";a+="</tr>";a+="<tr>";a+="<td height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_VIEW_TEXT+" : </td><td></label> <input type='text' name='dze_up_extfile_title' value='' size='256' id='"+this.idx_dze_insert_extfile_text+"' class='duzon_dialog_body_urlform' /></td>";a+="</tr>";a+="</table>";a+="</form>";a+="<div id='"+this.idx_dze_insert_extfile_link_box+"' style='display:none'></div>";a+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+
"' style='width:100%;height:100px;display:none'></iframe>";return a+"</div>"}catch(d){dalert(d)}},uploadExtFile:function(){try{var a=g_objLayerKit.getLayerDocument().dze_insert_extfile_form,b=a.dze_up_extfile.value.split(".").pop().toLowerCase();if(!0!==this.checkInsertFileExt(b))alert(this.allow_file_ext_array.join(",")+" "+ID_RES_DIALOG_ALERT_ALLOW_FORMAT),a.dze_up_extfile.value="";else{var c=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe);c.attachEvent?c.attachEvent("onload",duzon_dialog.onloadActionIframeInsertExtFile):
c.addEventListener("load",duzon_dialog.onloadActionIframeInsertExtFile,!1);a.submit()}}catch(d){dalert(d)}},onloadActionIframeInsertExtFile:function(){try{var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe).contentWindow.document.body.innerHTML,b=duzon_http.parseJSON(a);if("success"!=b.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR);else{DZE_UPLOAD_EVENT.setComplete(duzon_dialog.nEditNumber,b);var c=g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).value.split(".").pop().toLowerCase(),
d=duzon_dialog.setFileExtIconPath(c),e=1==dzeUiConfig.attachFileExtIconView?"<a href='"+b.url+"' type='dzeExtFile' title=\"\" alt='"+b.filename+"' style=\"background-image: url("+d+');background-repeat: no-repeat;background-position: left top;padding:2px 0 2px 18px;margin:0 8px 0 8px;color:#000000;text-decoration:none;font-weight:bold;"  >'+b.filename+"</a>"+duzon_dialog.dze_bookmark_last_tag+" ":"<a href='"+b.url+"' type='dzeExtFile' title=\"\" alt='"+b.filename+'\' style="color:#000000;text-decoration:none;font-weight:bold;"  >'+
b.filename+"</a>"+duzon_dialog.dze_bookmark_last_tag+" ";g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_link_box).innerHTML=e;g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value=b.filename}}catch(f){dalert(f)}},insertExtFileContent:function(){try{var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_link_box);if(""==a.innerHTML.trim())alert(ID_RES_DIALOG_ALERT_SELECTFILE),g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).focus();
else{var b=a.getElementsByTagName("a")[0];b.title=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value;b.innerHTML=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value;var c=a.innerHTML;this.closeDialog();addHTMLContent(c,null,0,this.nEditNumber)}}catch(d){dalert(d)}},checkInsertFileExt:function(a){try{a=a.toLowerCase();for(var b=!1,c=0;c<this.allow_file_ext_array.length;c++)if(this.allow_file_ext_array[c]==a){b=!0;break}return b}catch(d){dalert(d)}},
setFileExtIconPath:function(a){try{a=a.toLowerCase();var b="toolbar_btn_insert_file.png";!0===this.checkInsertFileExt(a)&&("docx"==a&&(a="doc"),"xlsx"==a&&(a="xls"),"pptx"==a&&(a="ppt"),b="ico_"+a+".png");return dzeEnvConfig.strPath_Image+"toolbar/"+b}catch(c){dalert(c)}},modifyExtFileContent:function(){try{this.setEditorSelection();var a=getSelectionParentElement(duzon_dialog.nEditNumber,"A");null!=a&&(a.innerHTML=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value,a.title=
g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value);this.closeDialog()}catch(b){dalert(b)}},nInsTypeIdx:0,insTypeInfo:[{},{}],leftInsTypeContent:null,rightInsTypeContent:null,curCategoryIdx:[0,0],curCategoryItem:[{},{}],recentItemList:[{},{}],recentItemListMaxViewCnt:[9,5],recentItemListCurViewIdx:[0,0],recentItemListMaxCnt:[30,30],dze_idx_recent_data_area:"dze_idx_recent_data_area",dze_idx_instype_recent_btn_pre:"",dze_idx_instype_recent_btn_next:"",makeInsTypeInfo:function(){try{this.insTypeInfo[0]=
{strInsType:"specialchars",strLTitle:ID_RES_DIALOG_STRING_CHARACTER_AREA,strRTitle:ID_RES_DIALOG_STRING_CHARACTER_SELECT,strRecentTitle:ID_RES_DIALOG_STRING_RECECT_USE_CHARACTER,jsSrc:"const/insert_specialchars_const.js",refInfoDB:"dzeSpecialchars"},this.insTypeInfo[1]={strInsType:"emoticons",strLTitle:ID_RES_DIALOG_STRING_CATEGORY_AREA,strRTitle:ID_RES_DIALOG_STRING_EMOTICON_SELECT,strRecentTitle:ID_RES_DIALOG_STRING_RECECT_USE_EMOTICONS,jsSrc:"const/insert_emoticons_const.js",refInfoDB:"dzeEmoticons"}}catch(a){}},
getInsertTypeContent:function(){try{var a=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType;this.dze_idx_instype_recent_btn_pre="dze_idx_"+a+"_recent_btn_pre";this.dze_idx_instype_recent_btn_next="dze_idx_"+a+"_recent_btn_next";var b=document.createElement("div");b.className="duzon_dialog_content_medium";var c=document.createElement("div");c.className="dze_"+a+"_left_container";var d=document.createElement("div");d.className="dze_dlg_left_title";d.innerHTML=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strLTitle+
":";this.leftInsTypeContent=document.createElement("div");this.leftInsTypeContent.className="dze_"+a+"_left_content";c.appendChild(d);c.appendChild(this.leftInsTypeContent);var e=document.createElement("div");e.className="dze_"+a+"_right_container";var f=document.createElement("div");f.className="dze_dlg_right_title";f.innerHTML=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strRTitle+":";this.rightInsTypeContent=document.createElement("div");this.rightInsTypeContent.className="dze_"+a+"_right_content";
var g=document.createElement("div");g.className="dze_dlg_recent_title";g.innerHTML=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strRecentTitle+":";var h=document.createElement("div");h.className="dze_"+a+"_recent_content";d="<table width='100%' height='36' cellspacing='0' cellpadding='0' border='0'>";d+="<tr>";d+="<td width='12'><div class='dze_"+a+"_recent_btn_pre' id='"+this.dze_idx_instype_recent_btn_pre+"'></div></td>";d+="<td><div class='dze_"+a+"_recent_data_container'><div class='dze_"+
a+"_recent_data_area' id='"+this.dze_idx_recent_data_area+"'></div></div></td>";d+="<td width='12'><div class='dze_"+a+"_recent_btn_next' id='"+this.dze_idx_instype_recent_btn_next+"'></div></td>";h.innerHTML=d+"</tr><table>";e.appendChild(f);e.appendChild(this.rightInsTypeContent);0==duzon_dialog.nInsTypeIdx&&(e.appendChild(g),e.appendChild(h));b.appendChild(c);b.appendChild(e);1==duzon_dialog.nInsTypeIdx&&(b.appendChild(g),b.appendChild(h));return b}catch(k){dalert(k)}},loadInsertTypeContent:function(){try{duzon_dialog.dynamicScriptCall(duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].jsSrc,
function(){try{for(var a=null,b=eval(duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].refInfoDB),c=b.length,d=0;d<c;d++)a=null,a=g_objLayerKit.getLayerDocument().createElement("div"),a.className="dze_dlg_left_content_unit",a.innerHTML=b[d].name,function(){var c=d;a.onclick=function(){duzon_dialog.selectCategoryItemList(c,b)}}(),duzon_dialog.leftInsTypeContent.appendChild(a),duzon_dialog.selectCategoryItemList(duzon_dialog.curCategoryIdx[duzon_dialog.nInsTypeIdx],b);duzon_dialog.getRecentItemList();
var e=duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx].length-1,f=e-duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]+1;0>f&&(f=0);duzon_dialog.printRecentItem(f,e);var g=duzon_dialog.selectCategoryItem(duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]);g_objLayerKit.getElementById(duzon_dialog.dze_idx_instype_recent_btn_pre).onclick=function(){duzon_dialog.prevRecentItem()};g_objLayerKit.getElementById(duzon_dialog.dze_idx_instype_recent_btn_next).onclick=function(){duzon_dialog.nextRecentItem()};
var h=23*duzon_dialog.curCategoryIdx[duzon_dialog.nInsTypeIdx];3<duzon_dialog.curCategoryIdx[duzon_dialog.nInsTypeIdx]&&(duzon_dialog.leftInsTypeContent.scrollTop=h-57);if("undefined"!=typeof g&&null!=g&&8<g){var k=Math.floor(g/9);2<k&&(duzon_dialog.rightInsTypeContent.scrollTop=3+32*k-40)}}catch(m){}})}catch(a){dalert(a)}},prevRecentItem:function(){try{if(duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1>duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]){var a=duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+
1-duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]-1;this.printRecentItem(a,a+duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]-1);this.setRecentItemBtns();$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft=""}}catch(b){dalert(b)}},nextRecentItem:function(){try{if(duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx].length>duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1){var a=duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1-
duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]+1;this.printRecentItem(a,a+duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]-1);this.setRecentItemBtns();$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="-5px"}}catch(b){dalert(b)}},emptyRecentListBox:function(){try{for(var a=0;$_(duzon_dialog.dze_idx_recent_data_area).childNodes.length;)$_(duzon_dialog.dze_idx_recent_data_area).removeChild($_(duzon_dialog.dze_idx_recent_data_area).childNodes[0]),a++}catch(b){dalert(b)}},
printRecentItem:function(a,b){try{var c=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType;this.emptyRecentListBox();for(var d=null,e=a;e<=b;e++){dlog("i:"+duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]);if("undefined"==typeof duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]||null==duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]||""==duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e])break;dlog("i2:"+duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e]);
d=document.createElement("div");d.className="dze_"+c+"_right_content_unit";d.innerHTML=duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e];(function(){var a=duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx][e];d.onclick=function(){duzon_dialog.selectCategoryItem(a)};d.ondblclick=function(){duzon_dialog.selectCategoryItem(a);duzon_dialog.insertTypeContent(null)}})();$_(duzon_dialog.dze_idx_recent_data_area).appendChild(d);duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]=e}this.setRecentItemBtns();
0<a?$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="-5px":duzon_dialog.nInsTypeIdx||duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1!=duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]?$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="":$_(duzon_dialog.dze_idx_recent_data_area).style.marginLeft="-5px"}catch(f){dalert(f)}},setRecentItemBtns:function(){try{duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1>duzon_dialog.recentItemListMaxViewCnt[duzon_dialog.nInsTypeIdx]?
($_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.opacity="",$_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.cursor="pointer"):($_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.opacity="0.3",$_(duzon_dialog.dze_idx_instype_recent_btn_pre).style.cursor="default"),duzon_dialog.recentItemList[duzon_dialog.nInsTypeIdx].length>duzon_dialog.recentItemListCurViewIdx[duzon_dialog.nInsTypeIdx]+1?($_(duzon_dialog.dze_idx_instype_recent_btn_next).style.opacity="",$_(duzon_dialog.dze_idx_instype_recent_btn_next).style.cursor=
"pointer"):($_(duzon_dialog.dze_idx_instype_recent_btn_next).style.opacity="0.3",$_(duzon_dialog.dze_idx_instype_recent_btn_next).style.cursor="default")}catch(a){dalert(a)}},makeEmoticonItemHTML:function(a,b,c,d){d=d?32:68;return"<img src='"+dzeEnvConfig.strPath_Image+"emoticons/"+c[a].content[b]+"'  width='"+d+"px' height='"+d+"px'>"},selectCategoryItemList:function(a,b){try{duzon_dialog.rightInsTypeContent.innerHTML="";for(var c=null,d=b[a].content.length,e=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType,
f=0;f<d;f++){c=null;c=document.createElement("div");c.className="dze_"+e+"_right_content_unit";switch(duzon_dialog.nInsTypeIdx){case 0:c.innerHTML=b[a].content[f];break;case 1:c.innerHTML=duzon_dialog.makeEmoticonItemHTML(a,f,b,!1)}(function(){var a=c.innerHTML;c.onclick=function(){duzon_dialog.selectCategoryItem(a)};c.ondblclick=function(){duzon_dialog.selectCategoryItem(a);duzon_dialog.insertTypeContent(null)}})();duzon_dialog.rightInsTypeContent.appendChild(c);duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]==
c.innerHTML&&this.selectCategoryItem(duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx])}leftContentList=this.leftInsTypeContent.getElementsByTagName("div");for(f=0;f<leftContentList.length;f++)leftContentList[f].className=f==a?"dze_dlg_left_content_unit_select":"dze_dlg_left_content_unit";this.curCategoryIdx[duzon_dialog.nInsTypeIdx]=a;duzon_dialog.rightInsTypeContent.scrollTop=0}catch(g){dalert(g)}},selectCategoryItem:function(a){try{if(""!=a){var b=0,c=duzon_dialog.insTypeInfo[duzon_dialog.nInsTypeIdx].strInsType;
duzon_dialog.curCategoryItem[duzon_dialog.nInsTypeIdx]=a;rightContentList=this.rightInsTypeContent.getElementsByTagName("div");for(var d=0;d<rightContentList.length;d++)rightContentList[d].innerHTML==a?(rightContentList[d].className="dze_"+c+"_right_content_unit_down",b=d):rightContentList[d].className="dze_"+c+"_right_content_unit";rightRecentContentList=g_objLayerKit.getElementById(this.dze_idx_recent_data_area).getElementsByTagName("div");for(d=0;d<rightRecentContentList.length;d++)"dze_dlg_right_content_unit_separator"!=
rightRecentContentList[d].className&&(rightRecentContentList[d].className=rightRecentContentList[d].innerHTML==a?"dze_"+c+"_right_content_unit_down":"dze_"+c+"_right_content_unit");return b}}catch(e){return dalert(e),0}},insertTypeContent:function(a){try{a?(this.closeExtendsDlg(),fnAddHTMLContent(a,null,0,this.nEditNumber)):""==this.curCategoryItem[duzon_dialog.nInsTypeIdx]?alert(ID_RES_DIALOG_ALERT_SELECT_CHARACTER):(duzon_dialog.closeDialog(),fnAddHTMLContent(this.curCategoryItem[duzon_dialog.nInsTypeIdx],
null,0,this.nEditNumber),this.setRecentItemList(this.curCategoryItem[duzon_dialog.nInsTypeIdx]))}catch(b){dalert(b)}},setRecentItemList:function(a){try{for(var b=[],c=0;c<this.recentItemList[this.nInsTypeIdx].length;c++)this.recentItemList[this.nInsTypeIdx][c]!=a&&b.push(this.recentItemList[this.nInsTypeIdx][c]);b.push(a);b=this.getMaxArrayList(b,this.recentItemListMaxCnt[this.nInsTypeIdx]);this.recentItemList[this.nInsTypeIdx]=b;if("undefined"!=typeof localStorage)try{0==this.nInsTypeIdx?localStorage.setItem("edtstrg_recentSpecialCharsList",
b.join(",")):1==this.nInsTypeIdx&&localStorage.setItem("edtstrg_recentEmoticonsList",b.join(","))}catch(d){dalert(d)}}catch(d){dalert(d)}},getMaxArrayList:function(a,b){try{if(a.length>b){var c=a.length-b;for(b=0;b<c;b++)a.shift()}return a}catch(d){return dalert(d),[]}},getRecentItemList:function(){if("undefined"!=typeof localStorage)try{0==this.nInsTypeIdx&&localStorage.getItem("edtstrg_recentSpecialCharsList")?this.recentItemList[this.nInsTypeIdx]=localStorage.getItem("edtstrg_recentSpecialCharsList").split(","):
1==this.nInsTypeIdx&&localStorage.getItem("edtstrg_recentEmoticonsList")&&(this.recentItemList[this.nInsTypeIdx]=localStorage.getItem("edtstrg_recentEmoticonsList").split(","))}catch(a){dalert(a),this.recentItemList[this.nInsTypeIdx]=[]}return this.recentItemList[this.nInsTypeIdx]},idx_dze_bookmark_list_select:"idx_dze_bookmark_list_select",idx_dze_bookmark_sort_name:"idx_dze_bookmark_sort_name",idx_dze_bookmark_sort_position:"idx_dze_bookmark_sort_position",idx_dze_bookmark_name_form:"idx_dze_bookmark_name_form",
bookmark_select_text:"",idx_dze_bookmark_insert_btn:"idx_dze_bookmark_insert_btn",idx_dze_bookmark_delete_btn:"idx_dze_bookmark_delete_btn",idx_dze_bookmark_move_btn:"idx_dze_bookmark_move_btn",getInsertBookmarkContent:function(){try{this.bookmark_select_text="";this.bookmark_select_text=getSelectionTextValue(this.nEditNumber);var a="";a+="<div class='duzon_dialog_content_small'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_NAME+"</div>";a+="<div class=''>";a+="<table width='260' height='20' cellspacing='0' cellpadding='0'>";
a+="<tr>";a+="<td width='196' valign='top'>";a+="<input type='text' name='bookmark_name' id='"+this.idx_dze_bookmark_name_form+"' value='"+this.bookmark_select_text+"' class='dze_bookmark_name_formbox' />";a+="</td>";a+="<td width='4'></td>";a+="<td width='60' valign='top'>";a+="<div><input type='button' value='"+ID_RES_DIALOG_BTN_INSERT+"' id='"+this.idx_dze_bookmark_insert_btn+"' class='dze_bookmark_button' /></div>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+="<div style='height:8px'></div>";
a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_LIST+"</div>";a+="<div class=''>";a+="<table width='260' height='132' cellspacing='0' cellpadding='0'>";a+="<tr>";a+="<td width='196' valign='top'>";a+="<div class='dze_bookmark_list_container' id='"+this.idx_dze_bookmark_list_select+"'></div>";a+="</td>";a+="<td width='4'></td>";a+="<td width='60' valign='top'>";a+="<div style='margin-bottom:4px'><input type='button' value='"+ID_RES_CONST_BTN_DELETE+"' id='"+this.idx_dze_bookmark_delete_btn+
"' class='dze_bookmark_button' /></div>";a+="<div><input type='button' value='"+ID_RES_DIALOG_STRING_MOVE+"' id='"+this.idx_dze_bookmark_move_btn+"'  class='dze_bookmark_button' /></div>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_SORT_STANDARD+"</div>";a+="<div class=''>";a+="<input type='radio' name='bk_sort' value='name' id='"+this.idx_dze_bookmark_sort_name+"'> "+
ID_RES_DIALOG_STRING_NAME;a+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='bk_sort' value='position' id='"+this.idx_dze_bookmark_sort_position+"' checked> "+ID_RES_DIALOG_STRING_POSITION;return a+"</div></div>"}catch(b){return dalert(b),""}},bookmark_list:[],makeBookmarkList:function(a){try{var b=g_objEditorDocument[this.nEditNumber].body.getElementsByTagName("a");this.bookmark_list=[];for(var c=0;c<b.length;c++)null!=b[c].getAttribute("name")&&""!=b[c].getAttribute("name")&&(dlog("aObj[i].getAttribute(name):"+
b[c].getAttribute("name")),this.bookmark_list.push(b[c]));"undefined"==typeof a&&(a="position");this.bookmark_list=this.sortBookmarkList(this.bookmark_list,a);this.select_bookmark_no=-1}catch(d){dalert(d)}},sortBookmarkList:function(a,b){try{return"name"==b&&a.sort(function(a,b){a=a.getAttribute("name").toString().toLowerCase();b=b.getAttribute("name").toString().toLowerCase();return a<b?-1:a>b?1:0}),a}catch(c){return dalert(c),a}},printBookmarkList:function(){try{var a="position";1==$_(this.idx_dze_bookmark_sort_name).checked&&
(a="name");this.makeBookmarkList(a);var b=$_(duzon_dialog.idx_dze_bookmark_list_select);b.innerHTML="";for(var c=null,d=0;d<this.bookmark_list.length;d++)c=document.createElement("div"),c.className="dze_bookmark_list_item",c.innerHTML=this.bookmark_list[d].getAttribute("name"),function(){var a=d;c.onclick=function(){duzon_dialog.selectBookmark(a)};c.ondblclick=function(){duzon_dialog.selectBookmark(a);duzon_dialog.moveBookmarkPosition()}}(),b.appendChild(c);this.select_bookmark_no=-1}catch(e){dalert(e)}},
dze_bookmark_last_tag:"&#8203;",inputBookmark:function(){try{var a=$_(duzon_dialog.idx_dze_bookmark_name_form).value;if(""==a)alert(ID_RES_DIALOG_ALERT_INPUT_BOOKMARK_NAME),$_(duzon_dialog.idx_dze_bookmark_name_form).focus();else{if(!0===dzeUiConfig.bUseLockEditCellFunction){var b=g_objEditorDocument[this.nEditNumber].getSelection();if(!1===fnObjectCheckNull(b)&&0<b.rangeCount){var c=b.getRangeAt(0).commonAncestorContainer;c=g_objNodeUtil.getLoopParentElementByTagNames(c,["td","th"]);if(!1===fnObjectCheckNull(c)&&
("TD"===c.nodeName||"TH"===c.nodeName)&&!0===g_objTableFunction.isCellLocked(c)){alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA);return}}}fnAddHTMLContent("<a name='"+a+"' class='dze_bookmark_flag' style='text-decoration:none'>"+this.bookmark_select_text+"</a>"+this.dze_bookmark_last_tag,null,0,this.nEditNumber);g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber);this.closeDialog()}}catch(d){dalert(d)}},select_bookmark_no:-1,selectBookmark:function(a){try{this.select_bookmark_no=a;for(var b=$_(duzon_dialog.idx_dze_bookmark_list_select).getElementsByTagName("div"),
c=0;c<b.length;c++)b[c].className=c==a?"dze_bookmark_list_item_select":"dze_bookmark_list_item"}catch(d){dalert(d)}},removeBookmarkItem:function(){try{if(0>this.select_bookmark_no)alert(ID_RES_DIALOG_ALERT_INPUT_SELECT_DELTE_BOOKMARK_ITEM);else{if(!0===dzeUiConfig.bUseLockEditCellFunction){var a=this.bookmark_list[this.select_bookmark_no];a=g_objNodeUtil.getLoopChildNodeByTagNames(a,["td","th"]);if(!1===fnObjectCheckNull(a)&&("TD"===a.nodeName||"TH"===a.nodeName)&&!0===g_objTableFunction.isCellLocked(a)){alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA);
return}}null!=this.bookmark_list[this.select_bookmark_no].getAttribute("name")&&""!=this.bookmark_list[this.select_bookmark_no].getAttribute("name")&&(this.bookmark_list[this.select_bookmark_no].removeAttribute("name"),null==this.bookmark_list[this.select_bookmark_no].getAttribute("href")||""==this.bookmark_list[this.select_bookmark_no].getAttribute("href"))&&("dze_bookmark_flag"==this.bookmark_list[this.select_bookmark_no].getAttribute("class")&&this.bookmark_list[this.select_bookmark_no].removeAttribute("class"),
""==this.bookmark_list[this.select_bookmark_no].innerHTML?this.bookmark_list[this.select_bookmark_no].parentNode.removeChild(this.bookmark_list[this.select_bookmark_no]):(duzon_dialog.selectElement(duzon_dialog.bookmark_list[duzon_dialog.select_bookmark_no],duzon_dialog.nEditNumber),this.unLink()),this.printBookmarkList(),g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber))}}catch(b){dalert(b)}},moveBookmarkPosition:function(){try{if(0>this.select_bookmark_no)alert(ID_RES_DIALOG_ALERT_INPUT_SELECT_MOVE_BOOKMARK_ITEM);
else{var a=this.bookmark_list[this.select_bookmark_no];this.setEditorFocus();g_objCaretUtil.moveCaret(a,!0)}}catch(b){dalert(b)}},idx_dze_hyperlink_text_form:"idx_dze_hyperlink_text_form",idx_dze_hyperlink_type_url:"idx_dze_hyperlink_type_url",idx_dze_hyperlink_type_bookmark:"idx_dze_hyperlink_type_bookmark",idx_dze_hyperlink_url_form_box:"idx_dze_hyperlink_url_form_box",idx_dze_hyperlink_bookmark_form_box:"idx_dze_hyperlink_bookmark_form_box",idx_dze_hyperlink_form_url:"idx_dze_hyperlink_form_url",
idx_dze_hyperlink_open_type_self:"idx_dze_hyperlink_open_type_self",idx_dze_hyperlink_open_type_blank:"idx_dze_hyperlink_open_type_blank",idx_dze_hyperlink_unlink_button:"idx_dze_hyperlink_unlink_button",idx_dze_hyperlink_bookmark_form_list:"idx_dze_hyperlink_bookmark_form_list",idx_dze_hyperlink_target_menu_box:"idx_dze_hyperlink_target_menu_box",getInsertHyperLinkContent:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_VIEW_TEXT+
"</div>";a+="<div class=''><input type='text' name='hyperlink_text' id='"+this.idx_dze_hyperlink_text_form+"' value='' class='dze_hyperlink_name_formbox' /></div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_LINK_TYPE+"</div>";a+="<div class=''>";a+="<input type='radio' name='link_type' value='url' id='"+this.idx_dze_hyperlink_type_url+"' checked> "+ID_RES_DIALOG_STRING_WEB_ADDR;!0!==dzeUiConfig.bDoNotUseBookmark&&(a+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='link_type' value='bookmark' id='"+
this.idx_dze_hyperlink_type_bookmark+"'> "+ID_RES_CONST_STRING_INSERT_BOOKMARK);a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div id='"+this.idx_dze_hyperlink_url_form_box+"'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_WEB_ADDR+"</div>";a+="<div class=''><input type='text' name='hyperlink_form_url' id='"+this.idx_dze_hyperlink_form_url+"' value='' class='dze_hyperlink_name_formbox' /></div>";a+="</div>";a+="<div id='"+this.idx_dze_hyperlink_bookmark_form_box+
"' style='display:none'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_INSERT_BOOKMARK+"</div>";a+="<div id='"+this.idx_dze_hyperlink_bookmark_form_list+"'>";a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div id='"+this.idx_dze_hyperlink_target_menu_box+"'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_LINK_TARGET+"</div>";a+="<div class=''>";a+="<input type='radio' name='link_open_type' value='_blank' id='"+this.idx_dze_hyperlink_open_type_blank+
"' checked><label for='"+this.idx_dze_hyperlink_open_type_blank+"' style='background: none;'>"+ID_RES_DIALOG_STRING_LINK_NEW_WINDOW+"</label>";a+="<div style='display: none'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='link_open_type' value='_self' id='"+this.idx_dze_hyperlink_open_type_self+"'> "+ID_RES_DIALOG_STRING_LINK_CURRENT_WINDOW+"</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="</div>";a+="<div style='width:auto;text-align:right'><input type='button' id='"+
this.idx_dze_hyperlink_unlink_button+"' value='"+ID_RES_DIALOG_STRING_LINK_NO_CONNECT+"'></div>";return a+"</div>"}catch(b){dalert(b)}},setHyperLinkType:function(){try{1==$_(this.idx_dze_hyperlink_type_url).checked?($_(this.idx_dze_hyperlink_url_form_box).style.display="block",$_(this.idx_dze_hyperlink_bookmark_form_box).style.display="none",$_(this.idx_dze_hyperlink_open_type_blank).disabled=!1,$_(this.idx_dze_hyperlink_target_menu_box).style.display=""):($_(this.idx_dze_hyperlink_url_form_box).style.display=
"none",$_(this.idx_dze_hyperlink_bookmark_form_box).style.display="block",$_(this.idx_dze_hyperlink_open_type_self).disabled=!0,$_(this.idx_dze_hyperlink_open_type_blank).checked=!0,$_(this.idx_dze_hyperlink_target_menu_box).style.display="none")}catch(a){dalert(a)}},unLink:function(){this.setEditorSelection();fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,ID_STRING_COMMAND_UNLINK);g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber)},selectedObject:null,idx_dze_hyperlink_bookmark_list_form:"idx_dze_hyperlink_bookmark_list_form",
setHyperLinkContentData:function(){try{var a=g_objPropContentLink.getPropContentParam(this.nEditNumber),b=a.arrValue[0],c=a.arrValue[1],d=a.arrValue[2],e=a.arrValue[4];this.selectedObject=null;var f=getSelectionControl(this.nEditNumber);null!=f.controlObject&&"undefined"!=typeof f.controlObject&&"img"==f.controlObject.nodeName.toLowerCase()?(this.selectedObject=f.controlObject,e=""==d?f.controlObject.title:d):(e=getSelectionTextValue(this.nEditNumber),""==e&&(e=d));$_(this.idx_dze_hyperlink_text_form).value=
e;a=null;if(0==b.indexOf("#")){if(a=$_(this.idx_dze_hyperlink_type_bookmark))a.checked=!0;$_(this.idx_dze_hyperlink_form_url).value="http://"}else $_(this.idx_dze_hyperlink_type_url).checked=!0,$_(this.idx_dze_hyperlink_form_url).value=b;this.setHyperLinkType();"_self"==c?$_(this.idx_dze_hyperlink_open_type_self).checked=!0:$_(this.idx_dze_hyperlink_open_type_blank).checked=!0;""==b||"http://"==b?($_(this.idx_dze_hyperlink_unlink_button).disabled=!0,$_(this.idx_dze_hyperlink_unlink_button).className=
"duzon_dialog_btn_disabled",$_(this.idx_dze_hyperlink_unlink_button).style.color="#d9d9d9"):($_(this.idx_dze_hyperlink_unlink_button).disabled=!1,$_(this.idx_dze_hyperlink_unlink_button).className="duzon_dialog_btn_normal");this.makeBookmarkList();var g=document.createElement("select");g.className="dze_hyperlink_bookmark_form";g.id=this.idx_dze_hyperlink_bookmark_list_form;c=null;c=document.createElement("option");c.value="";c.innerHTML="----- "+ID_RES_DIALOG_STRING_LIST_SELECT+" -----";g.appendChild(c);
for(a=0;a<this.bookmark_list.length;a++)c=document.createElement("option"),c.value=this.bookmark_list[a].getAttribute("name"),c.innerHTML=this.bookmark_list[a].getAttribute("name"),b=="#"+this.bookmark_list[a].getAttribute("name")&&c.setAttribute("selected","selected"),g.appendChild(c);$_(this.idx_dze_hyperlink_bookmark_form_list).appendChild(g)}catch(h){dalert(h)}},inputHyperLink:function(){try{if(1!=$_(this.idx_dze_hyperlink_type_url).checked||"http://"!=$_(this.idx_dze_hyperlink_form_url).value&&
""!=$_(this.idx_dze_hyperlink_form_url).value){var a=$_(this.idx_dze_hyperlink_type_bookmark);if(a&&1==a.checked&&""==$_(this.idx_dze_hyperlink_bookmark_list_form).value)alert(ID_RES_DIALOG_ALERT_SELECT_BOOKMARK),$_(this.idx_dze_hyperlink_bookmark_list_form).focus();else{var b=a="",c="",d="";a=1==$_(this.idx_dze_hyperlink_type_url).checked?$_(this.idx_dze_hyperlink_form_url).value:"#"+$_(this.idx_dze_hyperlink_bookmark_list_form).value;if(0!=a.indexOf("#")){var e=/^http(s)*:\/\/http(s)*:\/\//i;e.test(a)&&
(a=a.replace(/^http(s)*:\/\//i,""));e=/^http(s)*:\/\//i;e.test(a)||(a=location.protocol+"//"+a)}b=1==$_(this.idx_dze_hyperlink_type_url).checked?1==$_(this.idx_dze_hyperlink_open_type_blank).checked?"_blank":"_self":"_self";c=$_(this.idx_dze_hyperlink_text_form).value;d=$_(this.idx_dze_hyperlink_text_form).value;null!=this.selectedObject&&(d=this.selectedObject.outerHTML,this.selectedObject=null);a=[a,b,c,d];dlog(a);this.closeDialog();g_objPropContentLink.setLinkHTML(a,this.nEditNumber)}}else alert(ID_RES_DIALOG_ALERT_INPUT_WEB_ADDR),
$_(this.idx_dze_hyperlink_form_url).focus()}catch(f){dalert(f)}},makeComboInputForm:function(a,b,c){try{var d="<select name='"+a+"' id='"+a+"'";!1===fnObjectCheckNull(c)&&"number"===typeof c&&(d+=" style='width:"+c+"px !important;'");d+=">";c=function(a){return"<option value='"+b[a].value+"'>"+b[a].text+"</option>"};"dze_style_font_family"==a&&(c=function(a){return"<option value='"+b[a].value+"' style='font-family:"+b[a].value+";'>"+b[a].text.replace(/["']/g,"")+"</option>"});for(a=0;a<b.length;a++)d+=
c(a);return d+"</select>"}catch(e){dalert(e)}},idx_dze_style_font_preview:"idx_dze_style_font_preview",dze_font_propertys:"bold italic underline strike superscript subscript normal".split(" "),max_letterspacing:10,min_letterspacing:-5,getStyleFontContent:function(){try{for(var a=[],b=1;b<g_arrFontName.length;b++)a.push({value:g_arrFontName[b],text:g_arrFontName[b].replace(/["']/g,"")});this.checkFontPropertyList=[];var c="";c+="<div class='duzon_dialog_content_medium'>";c+="<div class='duzon_dialog_label_title'>"+
ID_RES_DIALOG_STRING_BASIC+"</div>";c+="<table width='100%' border='0' celladding='0' cellspacing='0'>";c+="<tr>";c+="<td width='60'>"+ID_RES_CONST_STRING_FONT_NAME+" </td>";c+="<td width='180'>"+this.makeComboInputForm("dze_style_font_family",a)+"</td>";c+="<td width='' align='right'>"+ID_RES_DIALOG_STRING_LETTERSPACING+" </td>";c+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_font_spacing","pt",this.max_letterspacing,this.min_letterspacing,this.min_letterspacing,
"duzon_dialog.preveiwDzeLetterSpacing")+"</div></td>";c+="</tr>";c+="<tr>";c+="<td colspan='4' height='5'></td>";c+="</tr>";c+="<tr>";c+="<td>"+ID_RES_CONST_STRING_FONT_SIZE+" </td>";c+="<td colspan='3'>"+this.makeSpinnerInputForm("dze_style_font_size","pt","36","8","9","duzon_dialog.preveiwDzeFontSize")+"</td>";c+="</tr>";c+="</table>";c+="<div class='duzon_dialog_label_separator'></div>";c+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_PROPERTY+"</div>";c+="<table width='100%' border='0' celladding='0' cellspacing='0'>";
c+="<tr>";c+="<td colspan='4'>";var d=a="",e="";for(b=0;b<this.dze_font_propertys.length;b++)a="idx_dze_style_font_"+this.dze_font_propertys[b],d=dzeEnvConfig.strPath_Image+"dialog/btn_style_font_"+this.dze_font_propertys[b]+".png",e=eval("ID_RES_CONST_STRING_"+this.dze_font_propertys[b].toUpperCase()),c+="<div class='dze_style_font_propery_set' id='"+a+"'><img src='"+d+"' alt='' title='"+e+"' width='28' height='28'></div>";c+="</td>";c+="</tr>";c+="<tr><td colspan='4' height='10'></tr>";c+="<tr>";
c+="<td width='60'>"+ID_RES_CONST_STRING_FORE_COLOR+" </td>";c+="<td width='180'>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_forecolor",70)+"</td>";c+="<td>"+ID_RES_CONST_STRING_BACK_COLOR+" </td>";c+="<td width='90'>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_backcolor",70)+"</td>";c+="</tr>";c+="<tr><td colspan='4' height='10'></tr>";c+="</table>";c+="<div class='dze_style_font_preview_container'><div class='dze_style_font_preview'><span id='"+this.idx_dze_style_font_preview+
"'>"+ID_RES_DIALOG_STRING_FONT_STYLE_PREVIEW+"</span></div></div>";return c+"</div>"}catch(f){dalert(f)}},preveiwDzeFontSize:function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.fontSize=a+"pt"},preveiwDzeLetterSpacing:function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.letterSpacing=a+"pt"},checkFontPropertyList:[],addFontPropertyList:function(a){try{inArray(a,this.checkFontPropertyList)?this.removeFontPropertyList(a):duzon_dialog.checkFontPropertyList.push(a),"normal"!=a&&inArray("normal",
this.checkFontPropertyList)&&this.removeFontPropertyList("normal"),inArray("normal",this.checkFontPropertyList)&&(this.checkFontPropertyList=["normal"]),"superscript"==a&&inArray("subscript",this.checkFontPropertyList)&&this.removeFontPropertyList("subscript"),"subscript"==a&&inArray("superscript",this.checkFontPropertyList)&&this.removeFontPropertyList("superscript")}catch(b){dalert(b)}},removeFontPropertyList:function(a){try{for(var b=[],c=0;c<this.checkFontPropertyList.length;c++)a!=this.checkFontPropertyList[c]&&
b.push(this.checkFontPropertyList[c]);this.checkFontPropertyList=b}catch(d){dalert(d)}},selectFontProperty:function(a){try{dlog("selectFontProperty"),dlog("execName:"+a),this.addFontPropertyList(a),dlog(this.checkFontPropertyList),this.setFontPropertyButtons(),this.setFontProperysPreview()}catch(b){dalert(b)}},removeGabageSelectionFontPropertyList:function(){try{for(var a=[],b=0;b<this.selectionFontStyleList.fontPropertyList.length;b++)"normal"!=this.selectionFontStyleList.fontPropertyList[b]&&a.push(this.selectionFontStyleList.fontPropertyList[b]);
this.selectionFontStyleList.fontPropertyList=a}catch(c){dalert(c)}},setFontPropertyButtons:function(){try{for(var a="",b=0;b<this.dze_font_propertys.length;b++)a="idx_dze_style_font_"+this.dze_font_propertys[b],inArray(this.dze_font_propertys[b],this.checkFontPropertyList)?$_(a).className="dze_style_font_propery_set_down":$_(a).className="dze_style_font_propery_set"}catch(c){dalert(c)}},setFontProperysPreview:function(){try{this.unsetFontProperysPreview();for(var a="",b=0;b<this.checkFontPropertyList.length;b++){a=
this.checkFontPropertyList[b];if("normal"==a){this.unsetFontProperysPreview();break}"bold"==a&&($_(this.idx_dze_style_font_preview).style.fontWeight="bold");"italic"==a&&($_(this.idx_dze_style_font_preview).style.fontStyle="italic");"underline"==a&&($_(this.idx_dze_style_font_preview).style.textDecoration="underline");"strike"==a&&($_(this.idx_dze_style_font_preview).style.textDecoration="line-through");inArray("underline",this.checkFontPropertyList)&&inArray("strike",this.checkFontPropertyList)&&
($_(this.idx_dze_style_font_preview).style.textDecoration="underline line-through");"superscript"==a&&($_(this.idx_dze_style_font_preview).innerHTML="<sup>"+$_(this.idx_dze_style_font_preview).innerHTML+"</sup>");"subscript"==a&&($_(this.idx_dze_style_font_preview).innerHTML="<sub>"+$_(this.idx_dze_style_font_preview).innerHTML+"</sub>")}}catch(c){dalert(c)}},unsetFontProperysPreview:function(){try{$_(this.idx_dze_style_font_preview).style.fontWeight="",$_(this.idx_dze_style_font_preview).style.fontStyle=
"",$_(this.idx_dze_style_font_preview).style.textDecoration="",$_(this.idx_dze_style_font_preview).style.textDecoration="",$_(this.idx_dze_style_font_preview).innerHTML=$_(this.idx_dze_style_font_preview).innerHTML.replace(/<\/*sup>/gi,""),$_(this.idx_dze_style_font_preview).innerHTML=$_(this.idx_dze_style_font_preview).innerHTML.replace(/<\/*sub>/gi,"")}catch(a){dalert(a)}},dze_editor_default_font_size:"9",selectionFontStyleList:{fontPropertyList:[],fontFamily:"",fontSize:"",color:"",backgroundColor:"",
letterSpacing:""},initSelectionFontStyleList:function(a){try{"undefined"==typeof a||null==a?(this.selectionFontStyleList.fontPropertyList=[],this.selectionFontStyleList.fontFamily="",this.selectionFontStyleList.fontSize="",this.selectionFontStyleList.color="",this.selectionFontStyleList.backgroundColor="",this.selectionFontStyleList.letterSpacing=""):(null==a[0]&&(a[0]=""),null==a[1]&&(a[1]=""),null==a[2]&&(a[2]=""),null==a[3]&&(a[3]=""),null==a[4]&&(a[4]=""),this.selectionFontStyleList.fontFamily=
a[0],this.selectionFontStyleList.fontSize=a[1].toLowerCase(),this.selectionFontStyleList.color=a[2],this.selectionFontStyleList.backgroundColor=a[3],this.selectionFontStyleList.letterSpacing=a[4].toLowerCase(),0<=this.selectionFontStyleList.fontSize.indexOf("px")?(this.selectionFontStyleList.fontSize=g_objCommonUtil.convPxToPt(this.selectionFontStyleList.fontSize),this.selectionFontStyleList.fontSize=0>this.selectionFontStyleList.fontSize?"":this.selectionFontStyleList.fontSize+"pt"):0>this.selectionFontStyleList.fontSize.indexOf("pt")&&
(this.selectionFontStyleList.fontSize=""),0<=this.selectionFontStyleList.letterSpacing.indexOf("px")?(this.selectionFontStyleList.letterSpacing=g_objCommonUtil.convPxToPt(this.selectionFontStyleList.letterSpacing),this.selectionFontStyleList.letterSpacing=0>this.selectionFontStyleList.letterSpacing?"":this.selectionFontStyleList.letterSpacing+"pt"):0>this.selectionFontStyleList.letterSpacing.indexOf("pt")&&(this.selectionFontStyleList.letterSpacing=""))}catch(b){dalert(b)}},checkSelectionFontStyle:function(){try{if(strSelectionType=
window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType){this.initSelectionFontStyleList();for(var a="",b=0,c=0;c<this.dze_font_propertys.length-1;c++)if("normal"!=this.dze_font_propertys[c]){a=this.dze_font_propertys[c].toUpperCase();b=eval("ID_COMMAND_"+a);"STRIKE"==a&&(a="StrikeThrough");var d=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],
b,a,this.nEditNumber,-1,strSelectionType);ID_STRING_NAME_CHECKED==d&&(this.selectFontProperty(this.dze_font_propertys[c]),this.selectionFontStyleList.fontPropertyList.push(this.dze_font_propertys[c]))}var e=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);"undefined"!=typeof e&&null!=e&&this.initSelectionFontStyleList(e);$_("dze_style_font_family").value=this.selectionFontStyleList.fontFamily;""!=$_("dze_style_font_family").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.fontFamily=
$_("dze_style_font_family").value);$_("dze_style_font_size").value=this.selectionFontStyleList.fontSize.replace(/(pt|px)/gi,"");""!=$_("dze_style_font_size").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.fontSize=$_("dze_style_font_size").value+"pt");g_objColorComboBoxUtil.setColorValue("dze_font_forecolor",this.selectionFontStyleList.color);""!=this.selectionFontStyleList.color&&($_(duzon_dialog.idx_dze_style_font_preview).style.color=this.selectionFontStyleList.color);g_objColorComboBoxUtil.setColorValue("dze_font_backcolor",
this.selectionFontStyleList.backgroundColor);""!=this.selectionFontStyleList.backgroundColor&&($_(duzon_dialog.idx_dze_style_font_preview).style.backgroundColor=this.selectionFontStyleList.backgroundColor);$_("dze_style_font_spacing").value=this.selectionFontStyleList.letterSpacing.replace(/(pt|px)/gi,"");""!=$_("dze_style_font_spacing").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.letterSpacing=$_("dze_style_font_spacing").value+"pt")}}catch(f){dalert(f)}},setStyleFont:function(){try{this.setEditorSelection();
var a=$_("dze_style_font_family").value;this.selectionFontStyleList.fontFamily!=a&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(a,!1));var b=$_("dze_style_font_size").value;""!=b&&(b+="pt");this.selectionFontStyleList.fontSize!=b&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(b,!1));
var c=g_objColorComboBoxUtil.getColorValue("dze_font_forecolor");if(this.selectionFontStyleList.color!=c){var d=document.getElementById("TB_SETFORECOLOR_"+duzon_dialog.nEditNumber+"_SUB");duzon_dialog.selectColorCode(c,d);g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply(c,!1)}var e=g_objColorComboBoxUtil.getColorValue("dze_font_backcolor");if(this.selectionFontStyleList.backgroundColor!=e){var f=document.getElementById("TB_SETBACKCOLOR_"+duzon_dialog.nEditNumber+"_SUB");duzon_dialog.selectColorCode(e,
f);g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber);fnColorCellApply(e,!1)}var g=$_("dze_style_font_spacing").value;""!=g&&(g+="pt");this.selectionFontStyleList.letterSpacing!=g&&(-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),g_objLetterSpacingWin.fnLetterSpacingCellClick(g,!1));a=c=b="";for(d=0;d<this.dze_font_propertys.length;d++)if(c=b=this.dze_font_propertys[d],"strike"==b.toLowerCase()&&(c=
"StrikeThrough"),inArray("normal",this.checkFontPropertyList)){for(b=0;b<this.selectionFontStyleList.fontPropertyList.length;b++)a=this.selectionFontStyleList.fontPropertyList[b],"strike"==this.selectionFontStyleList.fontPropertyList[b].toLowerCase()&&(a="StrikeThrough"),fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);break}else(inArray(b,this.selectionFontStyleList.fontPropertyList)&&!inArray(b,this.checkFontPropertyList)||!inArray(b,this.selectionFontStyleList.fontPropertyList)&&inArray(b,
this.checkFontPropertyList))&&fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,c);duzon_dialog.resetSelection=!0}catch(h){dalert(h)}},getWebEditorInfoContent:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='dze_logo_container'></div>";a+="<div class='dze_editor_url_info'><a href='http://www.douzone.com' target='_blank'>http://www.douzone.com</a></div>";a+="<div id='dze_version_text' class='dze_editor_url_info' style='display:none'>"+ID_RES_DIALOG_STRING_VERSION+
" : "+dzeVersion.version+"</div>";a+="<div class='dze_editor_copyright_info'>Copyright Douzone Bizon, All right reserved.</div>";a+="<div class='dze_editor_license_info' id='dze_idx_btn_view_license_info_contentbox'>License Info \u25bc</div>";return a+"<div class='dze_editor_license_info_contentbox' id='dze_idx_license_info_contentbox' style='display:none'></div></div>"}catch(b){dalert(b)}},getOnefficeLicenseInfo:function(){try{this.dynamicScriptCall("/const/editor_license_info.js",function(){for(var a=
g_objLayerKit.getLayerDocument(),b=a.getElementById("dze_idx_license_info_contentbox"),c=a.createElement("ul"),d,e=0;e<licenseInfo.length;e++)d=a.createElement("li"),d.innerHTML=licenseInfo[e],c.appendChild(d);b.appendChild(c)})}catch(a){dalert(a)}},dze_idx_shortcuts_content:"dze_idx_shortcuts_content",getShortCutsInfoContent:function(){try{return"<div class='dze_shortcuts_content' id='"+this.dze_idx_shortcuts_content+"'></div>"}catch(a){dalert(a)}},setShortCutsInfo:function(){try{this.dynamicScriptCall("const/shortcuts_info_const.js",
function(){$_(duzon_dialog.dze_idx_shortcuts_content).innerHTML=shortcutsInfo;for(var a=$_(duzon_dialog.dze_idx_shortcuts_content).getElementsByTagName("tr"),b=0;b<a.length;b++)a[b].onmouseover=function(){for(var a=this.getElementsByTagName("td"),b=0;b<a.length;b++)"dze_shortcuts_table_body"==a[b].className&&(a[b].className="dze_shortcuts_table_body_over")},a[b].onmouseout=function(){for(var a=this.getElementsByTagName("td"),b=0;b<a.length;b++)"dze_shortcuts_table_body_over"==a[b].className&&(a[b].className=
"dze_shortcuts_table_body")};this.setObjectPosition(null,this.dialog_obj,"center")}.bind(this))}catch(a){dalert(a)}},curr_forecolor:[],curr_backcolor:[],curr_cell_backcolor:[],curr_image_border_backcolor:[],curr_table_border_backcolor:[],ext_contents_container:null,ext_contents_sub_container:null,idx_dze_ext_item_overlayer:"idx_dze_ext_item_overlayer",affectedColorPreviewSet:!1,color_picker_mode:"none",nExtendsDlgType:0,extendsDlgTypeInfo:[{},{}],makeExtendsDlgInfo:function(){try{this.extendsDlgTypeInfo[0].length||
(this.extendsDlgTypeInfo[DZE_EXTENDS_COLOR_PICKER]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list"},this.extendsDlgTypeInfo[DZE_EXTENDS_EMOTICON]={strExtendsDlgType:"emoticons",jsSrc:"const/insert_emoticons_const.js",refInfoDB:"dzeEmoticons"},this.extendsDlgTypeInfo[DZE_EXTENDS_COPY_EXT]={strExtendsDlgType:"copy_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeCopyExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_PASTE_EXT]={strExtendsDlgType:"paste_ext",
jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzePasteExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_INSERT_PARAGRAPH]={strExtendsDlgType:"insert_paragraph",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeInsertParagraphList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_DELETE_EXT]={strExtendsDlgType:"table_delete_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableDeleteExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_SELECT]={strExtendsDlgType:"table_select",jsSrc:"const/general_commandlist_const.js",
refInfoDB:"dzeTableSelectList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_FORMULA_EXT]={strExtendsDlgType:"table_formula_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableFomulaExtList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_NUMBER_FORMAT]={strExtendsDlgType:"table_number_format",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableNumberFormatList"},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_TYPE]={strExtendsDlgType:"image_border_type",jsSrc:"const/general_commandlist_const.js",
refInfoDB:"dzeObjectBorderTypeList"},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_THICKNESS]={strExtendsDlgType:"image_border_thickness",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderThicknessList"},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_COLOR]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_THICKNESS]={strExtendsDlgType:"table_border_thickness",jsSrc:"const/general_commandlist_const.js",
refInfoDB:"dzeObjectBorderThicknessList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_TYPE]={strExtendsDlgType:"table_border_type",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderTypeList"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_COLOR]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list"},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_CELL_ALIGN]={strExtendsDlgType:"table_cell_align",jsSrc:"const/common_popup_const.js",refInfoDB:"dzeTableCellAlignList"},
this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_STYLE]={strExtendsDlgType:"table_style",jsSrc:"const/common_popup_const.js",refInfoDB:"dzeTableStyleList"})}catch(a){dalert(a)}},getDisplayExtendsDlgType:function(){switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_COLOR_PICKER:case DZE_EXTENDS_IMAGE_BORDER_COLOR:case DZE_EXTENDS_TABLE_BORDER_COLOR:var a=DZE_DISPLAY_EXTENDS_COLOR_PICKER;break;case DZE_EXTENDS_EMOTICON:a=DZE_DISPLAY_EXTENDS_EMOTICON;break;case DZE_EXTENDS_COPY_EXT:case DZE_EXTENDS_PASTE_EXT:case DZE_EXTENDS_INSERT_PARAGRAPH:case DZE_EXTENDS_TABLE_DELETE_EXT:case DZE_EXTENDS_TABLE_SELECT:case DZE_EXTENDS_TABLE_FORMULA_EXT:case DZE_EXTENDS_TABLE_NUMBER_FORMAT:case DZE_EXTENDS_IMAGE_BORDER_TYPE:case DZE_EXTENDS_IMAGE_BORDER_THICKNESS:case DZE_EXTENDS_TABLE_BORDER_THICKNESS:case DZE_EXTENDS_TABLE_BORDER_TYPE:a=
DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST;break;case DZE_EXTENDS_TABLE_CELL_ALIGN:case DZE_EXTENDS_TABLE_STYLE:a=DZE_DISPLAY_EXTENDS_COMMON_POPUP;break;default:a=DZE_DISPLAY_EXTENDS_NONE}return a},createEmoticonsTable:function(a){try{var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("border","0");var c=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB);for(a=0;a<c.length;a++){duzon_dialog.createTitleRowCell(b,
7,c[a].name);duzon_dialog.createEmptyRowCell(b,2,7);var d=b.insertRow();d.setAttribute("height","12");var e=d.insertCell();e.setAttribute("width","3");for(var f=0;8>f;f++){var g=duzon_dialog.createObjUnitDiv(a,f,c,null,null,null,null);e=d.insertCell();e.appendChild(g);3==f&&(e=d.insertCell(),e.setAttribute("width","3"),d=b.insertRow(),d.setAttribute("height","12"),e=d.insertCell(),e.setAttribute("width","3"))}}return b}catch(h){dalert(h)}return null},viewExtendsDlg:function(a,b,c,d,e,f,g,h,k){try{if(g_nActiveEditNumber=
this.nEditNumber=b,g_objPasteOptionMenu.remove(),null!=duzon_dialog.ext_contents_container)duzon_dialog.closeExtendsDlg();else{duzon_dialog.color_picker_mode="basic";g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);1!=duzon_dialog.dialogStatus&&g_objInsertUtil.saveSelectionRange_IE(0,b);"undefined"==typeof f&&(f="toolbar");"undefined"==typeof g&&(g=!0);duzon_dialog.makeExtendsDlgInfo();var m=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType;"undefined"==typeof duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&
(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation=!1);var l=document.createElement("div");duzon_dialog.ext_contents_container=l;l.className="dze_ext_dialog_container";l.id=m+"_"+a.id;l.onclick=function(a){TBCancelBubbleEvent(a?a:window.event)};l.onmousedown=function(a){TBCancelBubbleEvent(a?a:window.event)};l.onmouseover=function(a){TBCancelBubbleEvent(a?a:window.event)};0<=a.id.indexOf("_SUB")?document.getElementById(a.id.replace(/_SUB/,"")).parentNode.appendChild(l):
a.parentNode.appendChild(l);"toolbar"!=f||!0!==dzeUiConfig.bTBPreviewLetterOperation||duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_COLOR_PICKER&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR||(g_objLayerEventUtil.canSaveTableSelectedCellHTML(this.nEditNumber)?g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(this.nEditNumber)):g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber));var n=function(b){l.appendChild(b);
"undefined"!=typeof d&&null!=d&&0<d.length&&(b=DZE_EXTENDS_TABLE_STYLE==duzon_dialog.nExtendsDlgType?duzon_dialog.createDialogButtonBox(2,d,e):duzon_dialog.makeBottomBtnProcess(d,e,f),duzon_dialog.ext_contents_container.appendChild(b));g_objPropertyUtil.setOpacity(l,0);l.style.display="block";duzon_dialog.resizeExtContentsContainerPos(a,!0);if("toolbar"==f&&(duzon_dialog.addExtContentsEvent(),duzon_dialog.getDisplayExtendsDlgType()==DZE_DISPLAY_EXTENDS_COLOR_PICKER&&!0===dzeUiConfig.bTBPreviewLetterOperation&&
!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&duzon_dialog.addColorPreviewEventForTB(a),(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_STYLE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR)&&dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation)){var c=GetCurTable(duzon_dialog.nEditNumber);g_objLayerEventUtil.saveTableHTML(c);l.onmouseenter=function(){duzon_dialog.backupStyleInfo&&
g_objTableOperation.table_SetTableStyle(c,duzon_dialog.backupStyleInfo)};l.onmouseleave=function(){g_objLayerEventUtil.restoreTableHTML(c)}}duzon_dialog.animateDlg(l,"down");k&&k(l);duzon_dialog.onload&&(duzon_dialog.onload(l),duzon_dialog.onload=null)}.bind(this);h?this.getExtendDialogContentFromContent(n,h):this.getExtendDialogContentFromScript(n,a,f,c,g)}}catch(p){g_objPropertyUtil.setOpacity(l,1),dalert(p)}},getExtendDialogContentFromScript:function(a,b,c,d,e){try{this.dynamicScriptCall(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].jsSrc,
function(){var f=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType,g=duzon_dialog.nEditNumber,h=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB);switch(duzon_dialog.getDisplayExtendsDlgType()){case DZE_DISPLAY_EXTENDS_COLOR_PICKER:!0===dzeUiConfig.showTBRecentColor&&this.updateTBRecentColorCtrl(h);f=duzon_dialog.createColorPickerTable(h,d,b,e,c);break;case DZE_DISPLAY_EXTENDS_EMOTICON:f=duzon_dialog.createEmoticonsTable(f);break;case DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST:f=
duzon_dialog.createGeneralCommandListTable(h,g);break;case DZE_DISPLAY_EXTENDS_COMMON_POPUP:f=duzon_dialog.createCommonPopupTable(h,g);break;default:return}a&&a(f)}.bind(this))}catch(f){dalert(f)}},getExtendDialogContentFromContent:function(a,b){try{var c=null;if("string"===typeof b){var d=document.createDocumentFragment(),e=document.createElement("div");e.innerHTML=b;g_objNodeUtil.moveNodesTo(d,e.firstChild);c=d}else c=b;a&&a(c)}catch(f){dalert(f)}},addColorPreviewEventForTB:function(a){try{duzon_dialog.ext_contents_container.onmouseenter=
function(){var a=GetCurTable(duzon_dialog.nEditNumber);a?(g_objLayerEventUtil.saveTableSelectedCellHTML(a),duzon_dialog.removeMultiCellSelectionBG()):g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)},duzon_dialog.ext_contents_container.onmouseleave=function(){var a=GetCurTable(duzon_dialog.nEditNumber);a?(g_objLayerEventUtil.restoreTableSelectedCellHTML(a),duzon_dialog.recoverMultiCellSelectionBG()):(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.strTimeCodeID_Start=
null,duzon_dialog.strTimeCodeID_End=null);duzon_dialog.affectedColorPreviewSet=!1}}catch(b){dalert(b)}},makeBottomBtnProcess:function(a,b,c){try{var d=document.createElement("table");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");d.setAttribute("border","0");d.setAttribute("width","100%");var e=null,f=null;duzon_dialog.createEmptyRowCell(d,8,6);duzon_dialog.createSeperateLineRowCell(d,0,6);duzon_dialog.createEmptyRowCell(d,2,6);for(var g=0;g<a.length;g++)e=d.insertRow(),e.className=
"duzon_menubar_select_item",f=e.insertCell(),f.setAttribute("width","8"),f=e.insertCell(),f.setAttribute("width","16"),f.style.textAlign="center",f.innerHTML=duzon_dialog.makeColorPickerItemHTML(a[g]),function(){var a=b[g];f.onclick=function(b){b=b?b:window.event;"toolbar"==c&&!0===dzeUiConfig.bTBPreviewLetterOperation&&(duzon_dialog.ext_contents_container.onmouseleave=function(){},duzon_dialog.ext_contents_container.onmouseenter=function(){},GetMultiCellSelection()?(g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber)),
duzon_dialog.recoverMultiCellSelectionBG()):g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber));a(b)}}(),f=e.insertCell(),f.setAttribute("width","6"),f=e.insertCell(),f.innerHTML=a[g],function(){var a=b[g];f.onclick=function(b){b=b?b:window.event;"toolbar"==c&&!0===dzeUiConfig.bTBPreviewLetterOperation&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR&&(duzon_dialog.ext_contents_container.onmouseleave=function(){},
duzon_dialog.ext_contents_container.onmouseenter=function(){},GetMultiCellSelection()?(g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber)),duzon_dialog.recoverMultiCellSelectionBG()):g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber));a(b)}}(),f=e.insertCell(),f.setAttribute("width","3"),f=e.insertCell(),f.setAttribute("width","6");duzon_dialog.createEmptyRowCell(d,6,6);return d}catch(h){dalert(h)}},makeColorPickerItemHTML:function(a){try{if(a==
ID_RES_DIALOG_STRING_BASIC)return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_default.png'>";if(a==ID_RES_CONST_STRING_OTHER_COLOR)return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_other.png'>";if(a==ID_RES_DIALOG_BTN_NOCOLOR)return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_null.png'>"}catch(b){dalert(b)}},createEmptyRowCell:function(a,b,c){try{var d=a.insertRow();b&&d.setAttribute("height",b);var e=d.insertCell();c&&e.setAttribute("colspan",c)}catch(f){dalert(f)}},
createTitleRowCell:function(a,b,c,d){try{var e=a?a.insertRow():document.createElement("TR"),f=e.insertCell();f.setAttribute("align","left");b&&f.setAttribute("colspan",b);0===e.rowIndex&&(f.style.borderTopWidth="0px");f.className="dze_extdlg_title_container";f.innerHTML=c;return f}catch(g){dalert(g)}return a},getTitleRowHTML:function(a,b){return(a=this.createTitleRowCell(null,a,b))&&a.parentNode?a.parentNode.outerHTML:""},createSeperateLineRowCell:function(a,b,c){try{var d=a.insertRow();d.setAttribute("height",
"1");var e=null;b&&(e=d.insertCell(),e.setAttribute("width",b));e=d.insertCell();e.className="dze_color_picker_separator_line";c&&e.setAttribute("colspan",c);b&&(e=d.insertCell(),e.setAttribute("width",b))}catch(f){dalert(f)}return a},createColorPickerTable:function(a,b,c,d,e){try{var f=document.createElement("table");f.setAttribute("cellspacing","0");f.setAttribute("cellpadding","0");f.setAttribute("border","0");for(var g=0;g<a.length;g++){switch(g){case 0:duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_COLOR_THEME);
duzon_dialog.createEmptyRowCell(f,8,21);break;case 1:duzon_dialog.createEmptyRowCell(f,6,21);break;case 6:duzon_dialog.createEmptyRowCell(f,8,21);duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_COLOR_STANDARD);duzon_dialog.createEmptyRowCell(f,8,21);break;case 8:!0===dzeUiConfig.showTBRecentColor&&(duzon_dialog.createEmptyRowCell(f,8,21),duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_RECENT_COLOR),duzon_dialog.createEmptyRowCell(f,4,21))}7<=g&&duzon_dialog.createEmptyRowCell(f,
4,21);var h=f.insertRow();h.setAttribute("height","12");duzon_dialog.createColorPickerTableCol(a,g,h,b,c,d,e)}duzon_dialog.ext_contents_sub_container=document.createElement("div");duzon_dialog.ext_contents_sub_container.className="dze_color_picker_palettes_container";duzon_dialog.ext_contents_sub_container.appendChild(f);return duzon_dialog.ext_contents_sub_container}catch(k){dalert(k)}return null},createObjUnitDiv:function(a,b,c,d,e,f,g){try{var h=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType,
k=document.createElement("div");k.className="dze_"+h+"_unit_item";if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_COLOR_PICKER||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_COLOR||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR){var m=c[a][b];k.style.backgroundColor=""!=m?"#"+m:""}else k.innerHTML=duzon_dialog.makeEmoticonItemHTML(a,b,c,!0);(function(){var a=m;k.innerHTML&&(a="<img src='"+k.childNodes[0].src+"'  width='64' height='64'>");k.onmousedown=function(a){TBCancelBubbleEvent(a?
a:window.event)};k.onmouseout=function(a){};k.onmouseover=function(b){dlog("onmouseover event call");b=duzon_dialog.ext_contents_container.getElementsByTagName("table")[0];b=duzon_menubar.calcElementPosition(b);var c=duzon_menubar.calcElementPosition(this.parentNode);duzon_dialog.overLayerObjProcess(a,d,e,f,g,b.left+c.left-1,b.top+c.top-1)}})();return k}catch(l){}return null},createColorPickerTableCol:function(a,b,c,d,e,f,g){try{for(var h=0;h<a[b].length;h++){objNewCell=c.insertCell();objNewCell.setAttribute("width",
"4");var k=duzon_dialog.createObjUnitDiv(b,h,a,d,e,f,g);objNewCell=c.insertCell();objNewCell.setAttribute("width","12");objNewCell.appendChild(k)}objNewCell=c.insertCell();objNewCell.setAttribute("width","4")}catch(m){dalert(m)}},overLayerObjProcess:function(a,b,c,d,e,f,g){try{var h=1!=duzon_dialog.dialogStatus?document.getElementById(duzon_dialog.idx_dze_ext_item_overlayer):g_objLayerKit.getElementById(duzon_dialog.idx_dze_ext_item_overlayer);if(null==h){h=document.createElement("div");h.className=
"dze_ext_item_over_layer";h.id=duzon_dialog.idx_dze_ext_item_overlayer;var k=document.createElement("div");k.className="dze_ext_item_over_layer_innerbox";duzon_dialog.nExtendsDlgType==DZE_EXTENDS_COLOR_PICKER||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_COLOR||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR?(h.style.width="12px",h.style.height="12px",k.style.width="10px",k.style.height="10px"):(h.style.width="30px",h.style.height="30px",k.style.width="28px",k.style.height=
"28px");h.appendChild(k);duzon_dialog.ext_contents_container.appendChild(h)}(function(){dlog("cur_pos_value:"+a);h.onmousedown=function(a){};h.onclick=function(f){duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_COLOR_PICKER&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR?(duzon_dialog.insertTypeContent(a),g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)):("toolbar"==e&&!0===dzeUiConfig.bTBPreviewLetterOperation?(duzon_dialog.ext_contents_container.onmouseleave=
function(){},duzon_dialog.ext_contents_container.onmouseenter=function(){},GetMultiCellSelection()?duzon_dialog.recoverMultiCellSelectionBG():0<=c.id.indexOf("IMAGEBORDERCOLOR")||0<=c.id.indexOf("TABLEBORDERCOLOR")||g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.affectedColorPreviewSet=!1,""!=a&&(1==d&&duzon_dialog.selectColorCode("#"+a,c),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),b("#"+a))):""!=a&&(1==d&&duzon_dialog.selectColorCode("#"+
a,c),b("#"+a)),dzeColorPallet.addRecentColorSet(a))};h.onmouseover=function(c){TBCancelBubbleEvent(c?c:window.event);if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_COLOR_PICKER||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_COLOR||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR)this.title=""!=a?"#"+a:"","toolbar"==e&&!0===dzeUiConfig.bTBPreviewLetterOperation&&(GetMultiCellSelection()||duzon_dialog.setSelectionFromSelectionFlag(),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),
b("#"+a,!1),GetMultiCellSelection()?duzon_dialog.removeMultiCellSelectionBG():(duzon_dialog.insertCurrSelectionFlag(),window.attachEvent?g_objEditorDocument[duzon_dialog.nEditNumber].selection.empty():g_objEditorDocument[duzon_dialog.nEditNumber].getSelection().removeAllRanges()),duzon_dialog.affectedColorPreviewSet=!0)};h.onkeydown=function(a){TBCancelBubbleEvent(a?a:window.event)};h.onkeyup=function(a){TBCancelBubbleEvent(a?a:window.event)}})();h.style.left=f+"px";h.style.top=g+"px";h.style.display=
"block"}catch(m){dalert(m)}},updateTBRecentColorCtrl:function(a){try{8<a.length&&(a.pop(),a.pop());for(var b=dzeColorPallet.getRecentColorSet(),c=[],d=[],e=0;10>e;e++){var f="";f="undefined"==typeof b[e]?"":b[e];c.push(f)}for(e=10;20>e;e++)f="",f="undefined"==typeof b[e]?"":b[e],d.push(f);a.push(c);a.push(d)}catch(g){dalert(g)}},createGeneralCommandListTable:function(a,b){try{if(!a||!a.length)return null;var c=document.createElement("table");c.setAttribute("width","100%");c.setAttribute("cellspacing",
"0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");c.setAttribute("title","");var d=c.insertRow(),e=d.insertCell();e.setAttribute("colspan",6);e.setAttribute("height",5);for(var f="",g="",h="",k=null,m=null,l=0;l<a.length;l++)0<l&&(d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",6),e.setAttribute("height",1),d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",6),e.setAttribute("class","dze_extdlg_general_btn_underline"),d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",
6),e.setAttribute("height",1)),f=a[l],g=g_arrConst[f][1],h=g_arrIcon[f],""!=h&&(k=document.createElement("img"),k.alt=h,k.src=dzeEnvConfig.strPath_Image+"toolbar/"+h),m=eval(g_arrConst[f][3]),d=c.insertRow(),d.setAttribute("class","dze_extdlg_general_btn_unit"),d.MBCODE=f,d.TBSTATE=ID_STRING_NAME_UNCHECKED,d.command=g_arrConst[f][0],d.command_id=f,d.support_type=g_arrConst[f][4],d.support_control_type=g_arrConst[f][5],function(){var a=m;d.onclick=function(c){this.TBSTATE!=ID_STRING_NAME_GRAY&&(c=
c?c:window.event,a(c,this,b),duzon_dialog.closeExtendsDlg(),TBCancelBubbleEvent(c))}}(),d.onmouseover=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className="dze_extdlg_general_btn_over")},d.onmousedown=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(a=a?a:window.event,this.className="dze_extdlg_general_btn_down",TBCancelBubbleEvent(a))},d.onmouseup=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(a=a?a:window.event,this.className="dze_extdlg_general_btn_over",TBCancelBubbleEvent(a))},d.onmouseout=
function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className="dze_extdlg_general_btn_unit")},""==h?duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE?e=duzon_dialog.makeBorderTypeCell(d,f,g):duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS?e=duzon_dialog.makeBorderThicknessCell(d,f,g):(e=d.insertCell(),e.setAttribute("align","middle"),e.innerHTML=
g):(e=d.insertCell(),e.setAttribute("width",8),e=d.insertCell(),e.setAttribute("width",16),e.appendChild(k),e=d.insertCell(),e.setAttribute("width",6),e=d.insertCell(),e.setAttribute("align","left"),e.innerHTML=g,e=d.insertCell(),e.setAttribute("width",10),e=d.insertCell(),e.setAttribute("width",3));d=c.insertRow();e=d.insertCell();e.setAttribute("colspan",6);e.setAttribute("height",5);var n=document.createElement("div");n.className="dze_extdlg_general_command_container";a[0]===ID_COMMAND_TABLE_TABLE_ADD_NUMBER_FORMAT&&
(n.style.width="100px");n.appendChild(c);return n}catch(p){dalert(p)}},makeBorderTypeCell:function(a,b,c){var d=a.insertCell();d.setAttribute("width",5);d=a.insertCell();d.setAttribute("width",88);var e=document.createElement("hr");e.style.border="none";switch(b){case ID_COMMAND_IMAGE_BORDER_SOLID:e.style.borderBottom="solid";break;case ID_COMMAND_IMAGE_BORDER_DASHED:e.style.borderBottom="dashed";break;case ID_COMMAND_IMAGE_BORDER_DOTTED:e.style.borderBottom="dotted";break;case ID_COMMAND_IMAGE_BORDER_DOUBLE:e.style.borderBottom=
"double";break;case ID_COMMAND_IMAGE_BORDER_NONE:d.setAttribute("align","left"),d.innerHTML=c}d.appendChild(e);d=a.insertCell();d.setAttribute("width",5);return d},makeBorderThicknessCell:function(a,b,c){var d=a.insertCell();d.setAttribute("width",5);if(ID_COMMAND_IMAGE_BORDER_NONE==b)return d=a.insertCell(),d.setAttribute("align","left"),d.innerHTML=c,a.insertCell(),a.insertCell(),d=a.insertCell(),d.setAttribute("width",5),d;d=a.insertCell();d.setAttribute("width",88);var e=document.createElement("hr");
e.style.border="none";e.style.borderBottom="solid";b=b-ID_COMMAND_IMAGE_BORDER_1PX+1;0>b&&(b=0);e.style.borderWidth=b+"px";d.appendChild(e);d=a.insertCell();d.setAttribute("width",5);d=a.insertCell();d.setAttribute("width",10);d.setAttribute("align","left");d.innerHTML=c;d=a.insertCell();d.setAttribute("width",5);return d},strTimeCodeID_Start:null,strTimeCodeID_End:null,setTimeCodeID:function(){try{this.strTimeCodeID_End=this.strTimeCodeID_Start=null;var a=(new Date).getTime();this.strTimeCodeID_Start=
"S_"+a;this.strTimeCodeID_End="E_"+a}catch(b){dalert(b)}},insertCurrSelectionFlag:function(){try{var a=this.nEditNumber;if(!GetMultiCellSelection())if(this.setTimeCodeID(),window.attachEvent){var b=g_objEditorDocument[a].selection;if(!fnObjectCheckNull(b)){var c=b.createRange();if(!fnObjectCheckNull(c))if(""==c.htmlText){var d='<span id="'+this.strTimeCodeID_Start+'"></span><span id="'+this.strTimeCodeID_End+'"></span>';c.pasteHTML(d)}else{var e='<span id="'+this.strTimeCodeID_Start+'"></span>',f=
'<span id="'+this.strTimeCodeID_End+'"></span>',g=c.duplicate();g.collapse(!0);g.pasteHTML(e);var h=c.duplicate();h.collapse(!1);h.pasteHTML(f)}}}else if(b=g_objEditWindow[a].getSelection(),1==b.rangeCount){var k=b.getRangeAt(0);if(k.collapsed)d='<span id="'+this.strTimeCodeID_Start+'"></span><span id="'+this.strTimeCodeID_End+'"></span>',insertHTMLCodeAtSelection(d,null,a);else if(c=!1,ID_SELECTION_TEXT_NODE==k.commonAncestorContainer.nodeType&&(c=!0),c){var m=g_objEditorDocument[a].createElement("span"),
l=g_objEditorDocument[a].createElement("span");m.id=this.strTimeCodeID_Start;l.id=this.strTimeCodeID_End;m.innerHTML="&nbsp;";l.innerHTML="&nbsp;";var n=g_objEditorDocument[a].createElement("span");n.appendChild(k.cloneContents());var p=g_objEditorDocument[a].createTextNode(n.textContent);insertHTMLCodeAtSelection(null,l,a);var u=l.parentNode;u.insertBefore(m,l);u.insertBefore(p,l)}else{var q=k.startContainer,t=k.startOffset,v=k.endContainer,r=k.endOffset;m=g_objEditorDocument[a].createElement("span");
l=g_objEditorDocument[a].createElement("span");m.id=this.strTimeCodeID_Start;l.id=this.strTimeCodeID_End;b.removeAllRanges();h=g_objEditorDocument[a].createRange();h.setStartBefore(v);h.setEnd(v,r);h.collapse(!1);b.addRange(h);insertHTMLCodeAtSelection(null,l,a);b.removeAllRanges();g=g_objEditorDocument[a].createRange();g.setStart(q,t);g.setEndAfter(q);g.collapse(!0);b.addRange(g);insertHTMLCodeAtSelection(null,m,a)}}}catch(w){dalert(w)}},setSelectionFromSelectionFlag:function(){try{var a=this.nEditNumber;
if(null!=this.strTimeCodeID_Start&&null!=this.strTimeCodeID_End){if(window.attachEvent){var b=g_objEditorDocument[a].selection;if(fnObjectCheckNull(b)){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}for(var c=g_objEditorDocument[a].getElementById(this.strTimeCodeID_Start),d=!0,e=!0,f="";e=d=!0,f=c.innerHTML,-1==f.indexOf(this.strTimeCodeID_Start)&&(d=!1,c=c.parentElement),f=c.innerHTML,-1==f.indexOf(this.strTimeCodeID_End)&&(e=!1,c=c.parentElement),!d||!e;);var g=g_objEditorDocument[a].getElementById(this.strTimeCodeID_Start),
h=g_objEditorDocument[a].getElementById(this.strTimeCodeID_End),k=b.createRange();k.moveToElementText(g);var m=b.createRange();m.moveToElementText(h);var l=b.createRange();l.moveToElementText(c);l.setEndPoint("StartToStart",k);l.setEndPoint("EndToStart",m);l.select();var n=g_objNodeUtil.getParentElement(g);if(null==n){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}var p=g_objNodeUtil.getParentElement(h)}else{b=g_objEditWindow[a].getSelection();g=g_objEditorDocument[a].getElementById(this.strTimeCodeID_Start);
h=g_objEditorDocument[a].getElementById(this.strTimeCodeID_End);if(null==g||null==h){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}b.removeAllRanges();l=g_objEditorDocument[a].createRange();l.setStartAfter(g);l.setEndBefore(h);b.addRange(l);n=g_objNodeUtil.getParentElement(g);if(null==n){this.strTimeCodeID_End=this.strTimeCodeID_Start=null;return}p=g_objNodeUtil.getParentElement(h)}null!=p&&(n.removeChild(g),p.removeChild(h));this.strTimeCodeID_End=this.strTimeCodeID_Start=null}}catch(u){try{g_objUndoRedo.operateUndoRedoStack(!0,
!0,duzon_dialog.nEditNumber),g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)}catch(q){dalert(q)}}},resizeExtContentsContainerPos:function(a,b){try{if("undefined"!=typeof a&&null!=a&&b){var c=duzon_dialog.getExtContentsPos(a,duzon_dialog.ext_contents_container,"relative");c&&(duzon_dialog.ext_contents_container.style.top=c.top+"px",duzon_dialog.ext_contents_container.style.left=c.left+"px")}else if(null!=duzon_dialog.ext_contents_container&&"none"!=duzon_dialog.ext_contents_container.style.display){var d=
duzon_dialog.ext_contents_container.id.replace(new RegExp("^"+duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType+"_"),""),e=document.getElementById(d);if(null!=e){var f=duzon_dialog.getExtContentsPos(e,duzon_dialog.ext_contents_container,"relative");duzon_dialog.ext_contents_container.style.top=f.top+"px";duzon_dialog.ext_contents_container.style.left=f.left+"px"}}}catch(g){dalert(g)}},animateDlg:function(a,b){try{if(!0!==dzeUiConfig.bToolbarLayerAnimate||!0!==dzeUiConfig.bUseUiMode||
"ribbon"!=dze_menu_control.ui_mode)duzon_dialog.setOpacity(a,1);else if(null!=a&&"none"!=a.style.display){var c=-10,d=-10;if("down"==b){var e=0;a.style.marginTop=c+"px";duzon_dialog.setOpacity(a,e);var f=setInterval(function(){c+=2;e+=.2;0<=c&&(clearInterval(f),c=0);a.style.marginTop=c+"px";duzon_dialog.setOpacity(a,e)},30)}"right"==b&&(e=0,a.style.marginLeft=d+"px",duzon_dialog.setOpacity(a,e),f=setInterval(function(){d+=2;e+=.2;0<=d&&(clearInterval(f),d=0);a.style.marginLeft=d+"px";duzon_dialog.setOpacity(a,
e)},30))}}catch(g){duzon_dialog.setOpacity(a,1),dalert(g)}},getDialogElementPositionFromToolbarElement:function(a,b){try{for(var c=a.id.replace(/_SUB$/,""),d=document.getElementById(c).command_id,e=0,f=0;f<g_arrToolbar1.length;f++)if(g_arrToolbar1[f][0]==d){e=1;break}if(0==e)for(f=0;f<g_arrToolbar2.length;f++)if(g_arrToolbar2[f][0]==d){e=2;break}if(0==e)for(f=0;f<g_arrToolbar3.length;f++)if(g_arrToolbar3[f][0]==d){e=3;break}d=!1;var g=document.getElementById("TB_CONTAINER_TOOL_"+e+"_HIDDEN_"+duzon_dialog.nEditNumber);
if(null!=g){var h=g.getElementsByTagName("div");for(f=0;f<h.length;f++)if(h[f].id==c){d=!0;break}}var k=duzon_menubar.calcElementPosition(document.getElementById(c).parentNode);c={top:0,left:0,trNo:e,isHidden:d};if(1==d){var m=duzon_menubar.calcElementPosition(g);c.left=c.left+parentToolbarObj_pos.width-m.width;c.top=c.top+m.height-2}var l=g_objPositionUtil.getNodeElementPosition(a);c.left=l.left;c.top=l.top;c.top=c.top+k.height-8;if("undefined"!=typeof b){var n=duzon_menubar.calcElementPosition(b),
p=this.getActiveDialogWindowSize();c.left+n.width>p.view_window_width+p.scrollX&&(c.left=c.left-n.width+k.width-4)}0>c.top&&(c.top=0);0>c.left&&(c.left=0);return c}catch(u){dalert(u)}},getExtContentsPos:function(a,b,c,d){try{"undefined"==typeof c&&(c="relative");"undefined"==typeof d&&(d=this.nEditNumber);var e=a.id.replace(/_SUB$/,""),f=document.getElementById("EDIT_SET_CONTAINER_"+d);parentToolbarObj_pos=g_objPositionUtil.getOuterRect(f);var g=document.getElementById(e);if(!g)return null;duzon_menubar.calcElementPosition(g.parentNode);
var h=duzon_menubar.calcElementPosition(g);a={top:0,left:0};var k=g_objPositionUtil.getLayerElementPosition(g,!1),m=duzon_dialog.getParentAbsoluteNodePos(g,d);a.top=k.top-m.top;a.left=k.left-m.left;g&&(a.top+=g.offsetHeight);if("relative"==c){var l=duzon_menubar.calcElementPosition(b);a.left+l.width+m.left>parentToolbarObj_pos.width+parentToolbarObj_pos.left+l.scrollX&&(a.left=a.left-l.width+h.width)}0>a.left&&(a.left=0);return a}catch(n){dalert(n)}},getParentAbsoluteNodePos:function(a,b){try{"undefined"==
typeof b&&(b=duzon_dialog.nEditNumber);var c={left:0,top:0};if(!a)return c;for(var d=0;!(1E3<d)&&a.parentNode;){a=a.parentNode;if("body"==a.nodeName.toLowerCase())break;if(g_bBrowserType_IE)var e=a.currentStyle.getAttribute("position");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)e=g_objEditWindow[b].getComputedStyle(a,null).getPropertyValue("position");if("absolute"==e.toLowerCase()||"relative"==e.toLowerCase()){c=g_objPositionUtil.getLayerElementPosition(a,!1);"duzon_hidden_toolbar_container"==
a.className&&(c.left+=1,c.top+=1);break}d++}return c}catch(f){dalert(f)}},selectColorCode:function(a,b,c){try{if("undefined"!=typeof b&&null!=b&&(dlog("selectColorCode"),g_objCommonUtil.dir(b),"undefined"==typeof c&&(c=this.nEditNumber),!(null==b||0>b.id.indexOf("FORECOLOR")&&0>b.id.indexOf("BACKCOLOR")&&0>b.id.indexOf("CELLBACKCOLOR")&&0>b.id.indexOf("IMAGEBORDERCOLOR")&&0>b.id.indexOf("TABLEBORDERCOLOR")))){0<=b.id.indexOf("FORECOLOR")&&(this.curr_forecolor[c]=a);0<=b.id.indexOf("BACKCOLOR")&&(this.curr_backcolor[c]=
a);0<=b.id.indexOf("CELLBACKCOLOR")&&(this.curr_cell_backcolor[c]=a);0<=b.id.indexOf("IMAGEBORDERCOLOR")&&(this.curr_image_border_backcolor[c]=a);0<=b.id.indexOf("TABLEBORDERCOLOR")&&(this.curr_table_border_backcolor[c]=a);var d=document.getElementById(b.id+"_color_selector");a||0<=b.id.indexOf("FORECOLOR")&&(a=g_strBodyFontColor);d.style.backgroundColor=a}}catch(e){dalert(e)}},closeExtendsDlg:function(){try{if(1==duzon_dialog.isTableStylePreviewApply&&(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),
duzon_dialog.isTableStylePreviewApply=!1),null!=duzon_dialog.ext_contents_container&&"none"!=duzon_dialog.color_picker_mode){this.color_picker_mode="none";var a=!1;if(0<=duzon_dialog.ext_contents_container.parentNode.id.indexOf("TB_SETFORECOLOR_")||0<=duzon_dialog.ext_contents_container.parentNode.id.indexOf("TB_SETBACKCOLOR_"))a=!0;duzon_dialog.ext_contents_container.style.display="none";duzon_dialog.ext_contents_container.parentNode.removeChild(duzon_dialog.ext_contents_container);duzon_dialog.ext_contents_container=
null;duzon_dialog.nExtendsDlgType=0;duzon_dialog.removeExtContentsEvent();1==a&&1!=duzon_dialog.dialogStatus&&(editor_onselectionchange(duzon_dialog.nEditNumber),g_objTableMiniMenu.delayUpdate(duzon_dialog.nEditNumber))}}catch(b){dalert(b)}},addExtContentsEvent:function(){try{window.attachEvent?(window.attachEvent("onmousedown",duzon_dialog.closeExtendsDlg),window.attachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents),window.attachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos)):
(window.addEventListener("mousedown",duzon_dialog.closeExtendsDlg,!1),window.addEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,!1),window.addEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1));for(var a in g_arrEditorAreaContainer)window.attachEvent?(g_objEditorDocument[a].attachEvent("onmousedown",duzon_dialog.closeExtendsDlg),g_objEditorDocument[a].attachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents)):(g_objEditorDocument[a].addEventListener("mousedown",duzon_dialog.closeExtendsDlg,
!1),g_objEditorDocument[a].addEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,!1))}catch(b){dalert(b)}},removeExtContentsEvent:function(){try{window.detachEvent?(window.detachEvent("onmousedown",duzon_dialog.closeExtendsDlg),window.detachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents),window.detachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos)):(window.removeEventListener("mousedown",duzon_dialog.closeExtendsDlg,!1),window.removeEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,
!1),window.removeEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1));for(var a in g_arrEditorAreaContainer)window.detachEvent?(g_objEditorDocument[a].detachEvent("onmousedown",duzon_dialog.closeExtendsDlg),g_objEditorDocument[a].detachEvent("onkeydown",duzon_dialog.evtKeyCodeExtContents)):(g_objEditorDocument[a].removeEventListener("mousedown",duzon_dialog.closeExtendsDlg,!1),g_objEditorDocument[a].removeEventListener("keydown",duzon_dialog.evtKeyCodeExtContents,!1))}catch(b){dalert(b)}},
evtKeyCodeExtContents:function(a){try{var b=a?a:window.event;this.keyCode=b.keyCode;1==duzon_dialog.affectedColorPreviewSet&&(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.affectedColorPreviewSet=!1);27==this.keyCode&&(duzon_dialog.closeExtendsDlg(),TBCancelBubbleEvent(b))}catch(c){dalert(c)}},viewToolbarOrderedList:function(){try{html=this.getStyleOrderedListContent();var a=document.createElement("div");a.innerHTML=html;document.body.appendChild(a)}catch(b){dalert(b)}},
table_cell_align_list:"left_top center_top right_top left_middle center_middle right_middle left_bottom center_bottom right_bottom".split(" "),idx_dze_table_cell_align_container:"idx_dze_table_cell_align_container",getTableCellAlignContent:function(){try{var a=document.createElement("div");a.className="dze_table_cell_align_container";a.id=this.idx_dze_table_cell_horizontalalign_container;for(var b=null,c="",d=0;d<this.table_cell_align_list.length;d++)b=document.createElement("div"),b.className="dze_table_cell_align_unit",
c=eval("ID_RED_CONST_STRING_ALIGN_"+this.table_cell_align_list[d].toUpperCase()),c="<table border=0 cellpadding=0 cellspacing=0><tr><td width='16'><img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_table_cell_align_"+this.table_cell_align_list[d]+".png'></td><td width='6'></td><td>"+c+"</td></tr></table>",b.innerHTML=c,b.onmouseover=function(){this.className="dze_table_cell_align_unit_over"},b.onmouseout=function(){this.className="dze_table_cell_align_unit"},b.onmousedown=function(){this.className=
"dze_table_cell_align_unit_down"},b.onmouseup=function(){this.className="dze_table_cell_align_unit_over"},function(){var a=duzon_dialog.table_cell_align_list[d].split("_"),c=a[0],g=a[1];b.onclick=function(){var a=duzon_dialog.nEditNumber,b;if(b=(b=g_bBrowserType_IE&&!0===duzon_dialog.dialogStatus&&g_objLastRange[a]?GetTableInfo(g_objLastRange[a]):GetCurTableInfo(a))?b.table:null)g_objTableOperation.table_TableCellAlign(b,c,g),commonUpdateAfterChange(a,b,{bResetOutline:!1});duzon_dialog.closeDialog()}}(),
a.appendChild(b);return a}catch(e){dalert(e)}},getTableCellAlignContentWithoutText:function(){try{var a=document.createElement("div");a.className="dze_table_cell_align_ext_container";a.id=this.idx_dze_table_cell_horizontalalign_container;var b=null,c="",d=dzeUiConfig.bTBPreviewLetterOperation;duzon_dialog.isTableStylePreviewApply=!1;for(var e=GetCurTable(duzon_dialog.nEditNumber),f=0;f<this.table_cell_align_list.length;f++)b=document.createElement("div"),b.className="dze_table_cell_align_ext_unit",
c=eval("ID_RED_CONST_STRING_ALIGN_"+this.table_cell_align_list[f].toUpperCase()),c="<span><img title='"+c+"' src='"+dzeEnvConfig.strPath_Image+"ribbon/toolbar_btn_table_cell_align_"+this.table_cell_align_list[f]+".png'></span>",b.innerHTML=c,b.onmouseout=function(){this.className="dze_table_cell_align_ext_unit"},b.onmousedown=function(){this.className="dze_table_cell_align_ext_unit_down"},b.onmouseup=function(){this.className="dze_table_cell_align_ext_unit_over"},function(){var a=duzon_dialog.table_cell_align_list[f].split("_"),
c=a[0],k=a[1];b.onmouseover=function(){this.className="dze_table_cell_align_ext_unit_over";d&&(duzon_dialog.isTableStylePreviewApply=!0,g_objTableOperation.table_TableCellAlign(e,c,k))};b.onclick=function(){duzon_dialog.isTableStylePreviewApply=!1;d||g_objTableOperation.table_TableCellAlign(e,c,k);duzon_dialog.closeExtendsDlg();e&&commonUpdateAfterChange(duzon_dialog.nEditNumber,e)}}(),a.appendChild(b);d&&(e?g_objLayerEventUtil.saveTableSelectedCellHTML(e,!0):g_objUndoRedo.registerUndoRedoStack(0,
duzon_dialog.nEditNumber),a.onmouseleave=function(){var a=GetCurTable(duzon_dialog.nEditNumber);a?g_objLayerEventUtil.restoreTableSelectedCellHTML(a,!0):(g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber),g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber))});return a}catch(g){dalert(g)}},insertZeroWidthCharSpanFocus:function(){try{if(window.attachEvent){var a=g_objEditorDocument[duzon_dialog.nEditNumber].selection;if(!fnObjectCheckNull(a)){var b=a.type;b=b.toLowerCase();
if(ID_STRING_NAME_NONE==b||ID_STRING_NAME_TEXT==b){var c=a.createRange();if(!fnObjectCheckNull(c)&&(a=g_objEditorDocument[duzon_dialog.nEditNumber].selection,""==c.text)){var d="T_"+(new Date).getTime(),e=document.createElement("span");e.innerHTML="&nbsp;";e.id=d;c.pasteHTML(e.outerHTML);var f=g_objEditorDocument[duzon_dialog.nEditNumber].getElementById(d);f.removeAttribute("id");var g=a.createRange();g.moveToElementText(f);g.moveStart("character",1);g.select();f.innerHTML=""}}}}else if(b=getSelectionTypeForUpdateUI(),
ID_STRING_NAME_NONE==b||ID_STRING_NAME_TEXT==b)a=g_objEditWindow[duzon_dialog.nEditNumber].getSelection(),1>=a.rangeCount&&a.getRangeAt(0).collapsed&&(e=document.createElement("span"),e.innerHTML=duzon_dialog.dze_bookmark_last_tag,insertHTMLCodeAtSelection(null,e,duzon_dialog.nEditNumber),duzon_dialog.setFocusElement(e,duzon_dialog.nEditNumber,"start"),duzon_dialog.resetSelection=!0)}catch(h){dalert(h)}},dynamicScriptCall:function(a,b){try{"undefined"==typeof b&&(b=function(){});fullJsSrc=dzeEnvConfig.strPath_JS+
a;for(var c=document.getElementsByTagName("head")[0],d=c.getElementsByTagName("script"),e="",f=!1,g=0;g<d.length;g++)if(e=d[g].getAttribute("src"),null!=e&&0<=e.indexOf(a)){f=!0;break}if(1==f)b();else{var h=document.createElement("script");h.setAttribute("type","text/javascript");h.setAttribute("src",fullJsSrc);var k=!1;document.all?h.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState||k||(k=!0,b())}:h.onload=function(){b()};c.appendChild(h)}}catch(m){dalert(m)}},
getActiveDialogWindowSize:function(){try{var a={};g_objLayerKit.getLayerDocument().documentElement.scrollLeft?a.scrollX=g_objLayerKit.getLayerDocument().documentElement.scrollLeft:a.scrollX=g_objLayerKit.getLayerDocument().body.scrollLeft;g_objLayerKit.getLayerDocument().documentElement.scrollTop?a.scrollY=g_objLayerKit.getLayerDocument().documentElement.scrollTop:a.scrollY=g_objLayerKit.getLayerDocument().body.scrollTop;g_objLayerKit.getLayerWindow().innerWidth?(a.view_window_width=g_objLayerKit.getLayerWindow().innerWidth,
a.view_window_height=g_objLayerKit.getLayerWindow().innerHeight):(a.view_window_width=g_objLayerKit.getLayerDocument().documentElement.clientWidth,a.view_window_height=g_objLayerKit.getLayerDocument().documentElement.clientHeight);return a}catch(b){return dalert(b),{}}},idx_dze_replace_case_capital:"idx_dze_replace_case_capital",idx_dze_replace_case_small:"idx_dze_replace_case_small",idx_dze_replace_case_reverse:"idx_dze_replace_case_reverse",idx_dze_replace_case_firstword_capital:"idx_dze_replace_case_firstword_capital",
replace_case_array:"capital small reverse letter sentence paragraph".split(" "),getReplaceCaseContent:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";a+="<table width='100%' cellpadding='0' cellspacing='0' border='0'>";for(var b="",c="",d="",e=0;e<this.replace_case_array.length;e++)c=this.replace_case_array[e],b="idx_dze_replace_case_"+c,d=eval("ID_RES_CONST_STRING_REPLACE_CASE_"+c.toUpperCase()),a+="<tr><td>",a+="<div class='duzon_dialog_btn_replace_case_item' id='"+b+"'>",
a+="<table width='100%' cellpadding='0' cellspacing='0' border='0'>",a+="<tr>",a+="<td width='30'>",a+="<div class='duzon_dialog_btn_replace_case_item_image'><img src='"+dzeEnvConfig.strPath_Image+"dialog/popup_btn_replace_case_"+c+".png' width='28' height='28' title='"+c+"' alt='"+c+"'></div>",a+="</td>",a+="<td style='background-color:#FFFFFF' width='6'></td>",a+="<td style='background-color:#FFFFFF;cursor:pointer'>"+d+"</td>",a+="</tr>",a+="</table>",a+="</div>",a+="</td></tr>",e<this.replace_case_array.length-
1&&(a+="<tr><td colspan='2' height='6'></td></tr>");return a+"</table></div>"}catch(f){return dalert(f),""}},selectedReplaceCaseValue:"",initReplaceCaseBtnEvent:function(){try{this.selectedReplaceCaseValue="";for(var a=duzon_dialog.dialog_obj.getElementsByTagName("div"),b=0;b<a.length;b++)if("duzon_dialog_btn_replace_case_item"==a[b].className||"duzon_dialog_btn_replace_case_item_over"==a[b].className)a[b].onmouseover=function(){"duzon_dialog_btn_replace_case_item"==this.className&&(this.className=
"duzon_dialog_btn_replace_case_item_over")},a[b].onmouseout=function(){"duzon_dialog_btn_replace_case_item_over"==this.className&&(this.className="duzon_dialog_btn_replace_case_item")},a[b].onclick=function(){duzon_dialog.selectReplaceCase(this.id)}}catch(c){dalert(c)}},selectReplaceCase:function(a){try{for(var b=this.dialog_obj.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].id==a?(b[c].className="duzon_dialog_btn_replace_case_item_down",this.selectedReplaceCaseValue=b[c].id.split("_").pop()):
"duzon_dialog_btn_replace_case_item_down"==b[c].className&&(b[c].className="duzon_dialog_btn_replace_case_item")}catch(d){dalert(d)}},setReplaceCase:function(){try{if(""!=this.selectedReplaceCaseValue)if(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)dlog("strSelectionType : "+this.strSelectionType+" -> return!");
else{var a=(new Date).getTime(),b="S_"+a;a="E_"+a;if(window.attachEvent){var c=g_objEditorDocument[duzon_dialog.nEditNumber].selection;if(!fnObjectCheckNull(c)){var d=c.createRange();if(""!=d.text){c=g_objEditorDocument[this.nEditNumber].selection;9<=g_bBrowserVerInfo&&d.parentElement();var e=d.parentElement(),f='<span id="'+b+'"></span>',g='<span id="'+a+'"></span>',h=d.duplicate();h.collapse(!0);h.pasteHTML(f);var k=d.duplicate();k.collapse(!1);for(k.pasteHTML(g);;){g=f=!0;var m=e.innerHTML;-1==
m.indexOf(b)&&(f=!1,e=e.parentElement);m=e.innerHTML;-1==m.indexOf(a)&&(g=!1,e=e.parentElement);if(f&&g)break}g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1;this.setReplaceCaseStringTree(this.nEditNumber,e,this.selectedReplaceCaseValue,b,a);var l=g_objEditorDocument[this.nEditNumber].getElementById(b),n=g_objEditorDocument[this.nEditNumber].getElementById(a),p=c.createRange();p.moveToElementText(l);var u=c.createRange();u.moveToElementText(n);var q=c.createRange();q.moveToElementText(e);
q.setEndPoint("StartToStart",p);q.setEndPoint("EndToStart",u);q.select();var t=g_objNodeUtil.getParentElement(l);if(null!=t){var v=g_objNodeUtil.getParentElement(n);null!=v&&(t.removeChild(l),v.removeChild(n))}}}}else{d=null;c=g_objEditWindow[duzon_dialog.nEditNumber].getSelection();1>=c.rangeCount&&(d=c.getRangeAt(0));e=!1;var r=d.commonAncestorContainer;if(!d.collapsed)if(ID_SELECTION_TEXT_NODE==r.nodeType&&(e=!0),l=g_objEditorDocument[this.nEditNumber].createElement("span"),n=g_objEditorDocument[this.nEditNumber].createElement("span"),
l.id=b,n.id=a,e){l.innerHTML="&nbsp;";n.innerHTML="&nbsp;";var w=g_objEditorDocument[this.nEditNumber].createElement("span");w.appendChild(d.cloneContents());var B=this.getReplaceCaseString(w.textContent,this.selectedReplaceCaseValue),y=g_objEditorDocument[this.nEditNumber].createTextNode(B);insertHTMLCodeAtSelection(null,n,this.nEditNumber);var x=n.parentNode;x.insertBefore(l,n);x.insertBefore(y,n);x.removeChild(l);x.removeChild(n);q=g_objEditorDocument[this.nEditNumber].createRange();q.selectNode(y);
c.addRange(q)}else{var z=d.startContainer,C=d.startOffset,A=d.endContainer,D=d.endOffset;c.removeAllRanges();k=g_objEditorDocument[this.nEditNumber].createRange();k.setStartBefore(A);k.setEnd(A,D);k.collapse(!1);c.addRange(k);insertHTMLCodeAtSelection(null,n,this.nEditNumber);c.removeAllRanges();h=g_objEditorDocument[this.nEditNumber].createRange();h.setStart(z,C);h.setEndAfter(z);h.collapse(!0);c.addRange(h);for(insertHTMLCodeAtSelection(null,l,this.nEditNumber);!(ID_SELECTION_ELEMENT_NODE==r.nodeType&&
"body"==r.nodeName.toLowerCase()||(g=f=!0,m=r.innerHTML,-1==m.indexOf(b)&&(f=!1,r=r.parentNode),m=r.innerHTML,-1==m.indexOf(a)&&(g=!1,r=r.parentNode),f&&g)););g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1;this.setReplaceCaseStringTree(this.nEditNumber,r,this.selectedReplaceCaseValue,b,a);c.removeAllRanges();q=g_objEditorDocument[this.nEditNumber].createRange();q.setStartAfter(l);q.setEndBefore(n);c.addRange(q);t=g_objNodeUtil.getParentElement(l);null!=t&&(v=g_objNodeUtil.getParentElement(n),
null!=v&&(t.removeChild(l),v.removeChild(n)))}}}}catch(E){dalert(E)}},getReplaceCaseString:function(a,b){try{var c="";if("capital"==b)c=a.toUpperCase();else if("small"==b)c=a.toLowerCase();else if("reverse"==b)for(var d=b=null,e=0;e<a.length;e++)b=a[e].match(/[a-z]/),null!=b?c+=a[e].toUpperCase():(d=a[e].match(/[A-Z]/),c=null!=d?c+a[e].toLowerCase():c+a[e]);else if("letter"==b)if(d=a.split(" "),1<d.length){for(e=0;e<d.length;e++)""!=d[e].trim()&&(d[e]=d[e].capitalizeFirstLetter());c=d.join(" ")}else c=
a.capitalizeFirstLetter();else if("sentence"==b)if(d=a.split(". "),1<d.length){for(e=0;e<d.length;e++)""!=d[e].trim()&&(d[e]=d[e].capitalizeFirstLetter());c=d.join(". ")}else c=a.capitalizeFirstLetter();else"paragraph"==b&&(c=a.capitalizeFirstLetter());return c}catch(f){return dalert(f),""}},setReplaceCaseStringTree:function(a,b,c,d,e){try{if(!g_bFindPos_EndLetterOperation&&null!=b.childNodes){if(ID_SELECTION_ELEMENT_NODE==b.nodeType)if(!g_bFindPos_StartLetterOperation)d==b.id&&(g_bFindPos_StartLetterOperation=
!0);else if(e==b.id){g_bFindPos_EndLetterOperation=!0;return}for(var f=0;f<b.childNodes.length;f++){var g=b.childNodes[f];this.setReplaceCaseStringTree(a,g,c,d,e);if(g_bFindPos_EndLetterOperation)break;if(g_bFindPos_StartLetterOperation&&ID_SELECTION_TEXT_NODE==g.nodeType){var h=!0;""==g.nodeValue&&(h=!1);checkTextNodeAllWhiteCode_Plus_Space(g.nodeValue)&&(h=!1);if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var k=g.nodeValue;try{if(g_bBrowserType_FF||g_bBrowserType_WK){if(1==k.length){var m=
k.charCodeAt(0);if(10==m||13==m)h=!1}}else g_bBrowserType_OP&&2>=k.length&&(m=k.charCodeAt(0),10==m||13==m)&&(h=!1)}catch(n){}}if(h){var l=this.getReplaceCaseString(g.nodeValue,c);g.nodeValue=l}}}}}catch(n){dalert(n)}},viewDetailColorPicker:function(a,b){try{duzon_menubar.hideTwoDepthMenu();this.color_picker_mode="detail";duzon_dialog.ext_contents_container.innerHTML="";var c=document.createElement("div");c.id="dze_idx_detail_color_picker_div";duzon_dialog.ext_contents_container.appendChild(c);dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
a,b);duzon_dialog.ext_contents_container.style.padding="0px";duzon_dialog.ext_contents_container.style.width="auto";duzon_dialog.ext_contents_container.style.height="auto";try{window.detachEvent?window.detachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos):window.removeEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1)}catch(d){}1!=duzon_dialog.dialogStatus&&duzon_dialog.setDetailColorPickerPosition()}catch(d){dalert(d)}},setDetailColorPickerPosition:function(){try{var a=
duzon_dialog.ext_contents_container.offsetWidth,b=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+this.nEditNumber),c=g_objPositionUtil.getElementPosition(b,!1);this.mousedownY=c.top+10;c.width=c.right-c.left;this.mousedownX=c.left+(c.width-a)/2;var d=duzon_dialog.getParentAbsoluteNodePos(duzon_dialog.ext_contents_container,this.nEditNumber);this.mousedownY-=d.top;this.mousedownX-=d.left;duzon_dialog.ext_contents_container.style.left=this.mousedownX+"px";duzon_dialog.ext_contents_container.style.top=
this.mousedownY+"px"}catch(e){dalert(e)}},removeMultiCellSelectionBG:function(a){try{GetMultiCellSelection()&&g_objTableSelection.doAllSelectedCell(function(a){a.hasAttribute("bg_changing")||a.setAttribute("bg_changing",a.style.backgroundColor)})}catch(b){dalert(b)}},recoverMultiCellSelectionBG:function(){try{GetMultiCellSelection()&&g_objTableSelection.doAllSelectedCell(function(a){a.hasAttribute("bg_changing")&&(a.style.backgroundColor=a.getAttribute("bg_changing"),a.removeAttribute("bg_changing"))})}catch(a){dalert(a)}},
getExtCommonPopupTitle:function(){try{switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_TABLE_CELL_ALIGN:var a=ID_RES_CONST_STRING_TABLE_CELL_ALIGN;break;case DZE_EXTENDS_TABLE_STYLE:a=ID_RES_CONST_STRING_STYLE_STYLE;break;default:return}return a}catch(b){dalert(b)}},getExtCommonPopupBody:function(a,b,c){try{switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_TABLE_CELL_ALIGN:a=duzon_dialog.getTableCellAlignContentWithoutText();break;case DZE_EXTENDS_TABLE_STYLE:a=duzon_dialog.getTableStyleContent(b,
c);break;default:return null}return a}catch(d){dalert(d)}},createCommonPopupTable:function(a,b){try{if("undefined"!=typeof a&&null!=a&&0!=a.length){var c=document.createElement("table");c.setAttribute("width","100%");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");duzon_dialog.createTitleRowCell(c,0,duzon_dialog.getExtCommonPopupTitle());var d=document.createElement("div");d.className="dze_cascade_orderlist_top_container";d.appendChild(c);var e=duzon_dialog.getExtCommonPopupBody(null,
a,b);if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_CELL_ALIGN)return e;var f=document.createElement("div");f.className="dze_cascade_orderlist_container";f.appendChild(d);f.appendChild(e);return f}}catch(g){dalert(g)}},isTableStylePreviewApply:!1,getTableStyleContent:function(a,b){try{var c=GetCurTable(b),d=document.createElement("div");d.className="dze_table_style_container";d.id=this.idx_dze_table_style_container;var e=null,f=null;isTableStylePreviewApply=!1;b="";for(var g=0;g<a.length;g++)e=
document.createElement("div"),e.className="dze_table_style_unit",b="<table border=0 cellpadding=0 cellspacing=0><tr><td><img src='"+dzeEnvConfig.strPath_Image+"ribbon/toolbar_btn_table_style_"+(g+1)+".png' width=50 height=35></tr></td></table>",e.innerHTML=b,function(){var b=a[g];e.onmouseover=function(){"dze_table_style_unit_down"!=this.className&&(this.className="dze_table_style_unit_over",!0===dzeUiConfig.bTBPreviewLetterOperation&&(duzon_dialog.isTableStylePreviewApply=!0,g_objTableOperation.table_SetTableStyle(c,
b)))};e.onmouseout=function(){"dze_table_style_unit_down"!=this.className&&(this.className="dze_table_style_unit",!0===dzeUiConfig.bTBPreviewLetterOperation&&f&&(duzon_dialog.isTableStylePreviewApply=!0,g_objTableOperation.table_SetTableStyle(c,f)))};e.onclick=function(){if("dze_table_style_unit_down"!=this.className){for(var a=this.parentNode.getElementsByTagName("div"),d=0;d<a.length;d++)a[d].className="dze_table_style_unit";this.className="dze_table_style_unit_down";f=b;duzon_dialog.isTableStylePreviewApply=
!0;g_objTableOperation.table_SetTableStyle(c,b)}}}(),d.appendChild(e);return d}catch(h){dalert(h)}},getHelpImageToTableContentContainer:function(a){a=document.createElement("div");a.id="dze_idx_help_image_to_table";a.style.width="790px";a.style.height="720px";a.style.overflow="auto";a.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_1.png' /><br /><img src='"+dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_2.png' /><br /><img src='"+dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_3.png' /><br /><img src='"+
dzeEnvConfig.strPath_Image+"dialog/help_image_to_table_4.png' />";return a},resizeTbColorLinePostion:function(){}};

function DzeSpinner(){this.id="";this.max=500;this.min=0;this.amount=1;this.onunitchange=this.onmouseup=this.callback=null;this.bAlert=!0;this.timer2=this.timer1=null;this.arrListener=[];return this}DzeSpinner.arrSpinner=[];DzeSpinner.open=function(a){try{return DzeSpinner.arrSpinner.push(a)}catch(b){dalert(b)}};
DzeSpinner.close=function(a){try{for(var b=function(b){for(var c=g_objPropertyUtil;b&&"BODY"!==b.nodeName;){if(c.element_hasClass(b,a))return!0;b=b.parentNode}return!1},c=DzeSpinner.arrSpinner,d=null,f=0,e=c.length;f<e;f++)(d=c[f])&&b(d.container)&&(d.destroy(),c[f]=null);DzeSpinner.arrSpinner=DzeSpinner.arrSpinner.filter(function(a){return null!=a});return!0}catch(g){dalert(g)}};DzeSpinner.closeDialog=function(){return DzeSpinner.close("duzon_dialog_body")};DzeSpinner.closePanel=function(){return DzeSpinner.close("dze_panel_body")};
DzeSpinner.getSpinner=function(a){try{for(var b=DzeSpinner.arrSpinner,c=null,d=0,f=b.length;d<f;d++)if((c=b[d])&&(c.input&&c.input.id===a||c.container&&c.container.id===a))return c;return null}catch(e){dalert(e)}};
DzeSpinner.getHTML=function(a){try{var b=a.id,c="undefined"!==typeof a.name?a.name:b,d=a.value,f=a.unit,e=a.width,g=a.height,h=a.marginRight,k=a.style||"",l=a.arrUnit;f&&!e&&0>k.indexOf("width")&&(e=72);a="";e=e?"width:"+(parseInt(e)-2)+"px;":"";g=g?"height:"+(parseInt(g)-2)+"px;":"";h=h?"margin-right:"+parseInt(h)+"px;":"";if(k||e||g||h)a=' style="'+k+e+g+h+'"';e="";d&&(e=' value="'+d+'"');f=f||"";d="";d+='<div class="duzon_spinner_input_form_container"'+a+">";d+='<input type="text" name="'+c+'" id="'+
b+'"'+e+' class="duzon_spinner_input_form" autocomplete="off"/ style="text-align: right;">';d+="<div style='font-size: 11px; margin-left: 2px; width: 15px; height: 100%; position: relative; display: flex; align-items: center; text-align: center;'>";d+=f;if(l){d+='<select style="width: 100% !important;height: 100% !important;opacity: 0 !important;position: absolute;left: 0px;top: 0px; cursor: pointer;">';b=0;for(var m=l.length;b<m;b++)d+='<option value="'+l[b]+'">'+l[b]+"</option>";d+="</select>"}d+=
"</div>";d+='<div style="height:100%;margin-left:1px;">';d+='<div class="duzon_spinner_btn_arrow_up"></div>';d+='<div class="duzon_spinner_btn_arrow_down"></div>';return d+"</div></div>"}catch(n){dalert(n)}};DzeSpinner.createSpinner=function(a,b){try{if(!a)return null;var c=DzeSpinner.getSpinner(a.id);c?c.destroy():(c=new DzeSpinner,DzeSpinner.open(c));c.init(a);c.setProperty(b);c.addHandler();return c}catch(d){dalert(d)}};
DzeSpinner.prototype={init:function(a){try{if(a){this.id=a.id;this.input=a;var b=a.parentNode;this.container=b;this.unitSelect=(this.unit=b.childNodes[1])?this.unit.lastChild:null;var c=b.childNodes[2];this.btnUp=c.firstChild;this.btnDown=c.lastChild;this.selectionEnd=this.selectionStart=0;return this}}catch(d){dalert(d)}},setProperty:function(a){try{if(!a)return!1;this.setPropertyValue("max",a.max);this.setPropertyValue("min",a.min);this.setPropertyValue("amount",a.amount);this.setPropertyValue("bAlert",
a.alert);this.setValue(a.value);if(a.unit){var b=this.unit.firstChild;b&&3===b.nodeType&&(b.nodeValue=a.unit)}var c=a.callback;"function"===typeof c?this.callback=c:"string"===typeof c&&c.trim().length&&(this.callback=eval(c));var d=a.onmouseup;"function"===typeof d?this.onmouseup=d:"string"===typeof d&&d.trim().length&&(this.onmouseup=eval(d));var f=a.onkeyup;"function"===typeof f?this.onkeyup=f:"string"===typeof f&&f.trim().length&&(this.onkeyup=eval(f));var e=a.onunitchange;"function"===typeof e?
this.onunitchange=e:"string"===typeof e&&e.trim().length&&(this.onunitchange=eval(e));return this}catch(g){dalert(g)}},setPropertyValue:function(a,b){"undefined"!==typeof b&&null!==b&&(this[a]=b)},getValue:function(){try{var a=this.input.value;""===a&&(a=0);return+parseFloat(a).toFixed(2)}catch(b){dalert(b)}},setValue:function(a){try{"undefined"!==typeof a&&null!==a&&(this.input.value=a)}catch(b){dalert(b)}},getUnit:function(){try{var a=this.unit.firstChild;return a&&3===a.nodeType?a.nodeValue:""}catch(b){dalert(b)}},
getAmount:function(){return this.amount},destroy:function(){try{this.clearTimer();for(var a=0,b=this.arrListener.length;a<b;a++){var c=this.arrListener[a];c&&EventUtil.removeHandler(c.elem,c.type,c.handler)}}catch(d){dalert(d)}},clearTimer:function(){try{this.timer1&&clearTimeout(this.timer1),this.timer2&&clearInterval(this.timer2),this.timer2=this.timer1=null}catch(a){dalert(a)}},enable:function(a){try{a?(this.container.removeAttribute("disabled"),this.input.removeAttribute("disabled"),this.btnUp.removeAttribute("disabled"),
this.btnDown.removeAttribute("disabled")):(this.container.setAttribute("disabled",""),this.input.setAttribute("disabled",""),this.btnUp.setAttribute("disabled",""),this.btnDown.setAttribute("disabled",""))}catch(b){dalert(b)}},addHandler:function(){try{var a=this,b=this.input,c=this.btnUp,d=this.btnDown,f=this.unitSelect,e=function(b,c,d){b&&(EventUtil.addHandler(b,c,d),a.arrListener.push({elem:b,type:c,handler:d}))};c.hasAttribute("onclick")&&c.removeAttribute("onclick");c.onclick=null;d.hasAttribute("onclick")&&
d.removeAttribute("onclick");d.onclick=null;b.hasAttribute("onblur")&&b.removeAttribute("onblur");b.onblur=null;e(c,"mousedown",function(c){1!=b.disabled&&(c?c:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&a.spinnUp()&&(a.timer1=setTimeout(function(){a.timer2=setInterval(function(){a.spinnUp()},70)},500))});e(c,"mouseup",function(c){if(1!=b.disabled&&(a.clearTimer(),a.onmouseup))a.onmouseup(a.getValue())});e(c,"mouseout",function(c){1!=b.disabled&&a.clearTimer()});e(c,"mouseover",function(c){1!=
b.disabled&&a.clearTimer()});e(d,"mousedown",function(c){1!=b.disabled&&(c?c:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&a.spinnDown()&&(a.timer1=setTimeout(function(){a.timer2=setInterval(function(){a.spinnDown()},70)},500))});e(d,"mouseup",function(c){if(1!=b.disabled&&(a.clearTimer(),a.onmouseup))a.onmouseup(a.getValue())});e(d,"mouseout",function(c){1!=b.disabled&&a.clearTimer()});e(d,"mouseover",function(c){1!=b.disabled&&a.clearTimer()});e(b,"blur",function(){a.spinnValCheck()});
e(b,"keydown",function(b){try{var c=b?b:window.event;if("undefined"==typeof c||null==c)dlog("IE8 -> Not Support");else switch(c.keyCode){case ID_KEYCODE_ARROW_TOP:a.spinnUp();TBCancelBubbleEvent(c);break;case ID_KEYCODE_ARROW_BOTTOM:a.spinnDown();TBCancelBubbleEvent(c);break;case ID_KEYCODE_ENTER:a.spinnValCheck()}}catch(k){dalert(k)}});e(b,"keyup",function(c){try{var b=c?c:window.event;if("undefined"!=typeof b&&null!=b){c=!1;switch(b.keyCode){case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_ENTER:c=
!0,TBCancelBubbleEvent(b)}if(isUndoKeyEvent(b)||isRedoKeyEvent(b))c=!0,a.spinnValCheck();if(c&&a.onkeyup)a.onkeyup(a.getValue())}}catch(k){dalert(k)}});e(f,"change",function(c){c="";var b=a.unit.firstChild;3!==b.nodeType&&(b=null);b&&(c=b.nodeValue);if(c!==this.value){if(a.onunitchange)a.onunitchange(this.value);b&&(b.nodeValue=this.value)}});return this}catch(g){dalert(g)}},spinnUp:function(){try{if(1!=this.input.disabled){var a=this.max,b=this.min,c=this.input.value,d=""!==c?this.getValue():b,f=
""!==c?this.getAmount():0,e=this.callback,g=+parseFloat(d+f).toFixed(2);if(fnObjectCheckNull(a)||g<=a)return d=g,e&&e.call(this,d),dlog("DzeSpinner.spinUp"),this.saveCursor(),this.setValue(d),this.restoreCursor(),!0;this.clearTimer();e&&e.call(this,a);this.saveCursor();this.setValue(a);this.restoreCursor();!0===this.bAlert&&""!==c&&alert(ID_RES_DIALOG_ALERT_MAX_VALUE+a);return!1}}catch(h){dalert(h)}},spinnDown:function(){try{if(1!=this.input.disabled){var a=this.min,b=this.input.value,c=""!==b?this.getValue():
a,d=""!==b?this.getAmount():0,f=this.callback,e=+parseFloat(c-d).toFixed(2);if(fnObjectCheckNull(a)||e>=a)return c=e,f&&f.call(this,c),this.saveCursor(),dlog("DzeSpinner.spinnDown"),this.setValue(c),this.restoreCursor(),!0;this.clearTimer();f&&f.call(this,a);this.saveCursor();this.setValue(a);this.restoreCursor();!0===this.bAlert&&""!==b&&alert(ID_RES_DIALOG_ALERT_MIN_VALUE+a);return!1}}catch(g){dalert(g)}},spinnValCheck:function(){try{var a=this.input;if(""===a.value)return!0;var b=this.max,c=this.min,
d=this.getValue(),f=this.callback;if(1!=checkNumber(d))return a.value="",alert(ID_RES_DIALOG_ALERT_NUMBER_ONLY),a.focus(),!1;if(d>b)return this.setValue(b),alert(ID_RES_DIALOG_ALERT_MAX_VALUE+b),a.select(),!1;if(d<c)return this.setValue(c),alert(ID_RES_DIALOG_ALERT_MIN_VALUE+c),a.select(),!1;if("function"===typeof this.onmouseup)this.onmouseup(d);else"function"==typeof f&&f.call(this,d);return!0}catch(e){dalert(e)}},saveCursor:function(){this.input&&(this.selectionStart=this.input.selectionStart,
this.selectionEnd=this.input.selectionEnd)},restoreCursor:function(){this.input&&this.input.setSelectionRange(this.selectionStart,this.selectionEnd)}};

var ImageInsertDlg=duzon_dialog.extend();
(function(){this.IMG_INSERT=0;this.IMG_MODIFY=1;this.IMG_REPLACE=2;this.type=this.IMG_INSERT;this.idx_insertimage_radio_type1="idx_insertimage_radio_type1";this.idx_insertimage_radio_type2="idx_insertimage_radio_type2";this.idx_insertimage_radio_type3="idx_insertimage_radio_type3";this.idx_insertimage_upimage_txt="idx_insertimage_upimage_txt";this.idx_insertimage_upurl_txt="idx_insertimage_upurl_txt";this.idx_insertimage_keyword_txt="idx_insertimage_keyword_txt";this.idx_insertimage_checkbox_orgratio=
"idx_insertimage_checkbox_orgratio";this.idx_insertimage_size_title="idx_insertimage_size_title";this.idx_insertimage_size_table="idx_insertimage_size_table";this.idx_dze_insertimage_width="dze_image_width";this.idx_dze_insertimage_height="dze_image_height";this.idx_dze_org_imagesize="idx_dze_org_imagesize";this.arrAlignBtn=null;this.arrImg=[];this.setImgArray=function(b){this.arrImg=b};this.imgRatio=1;this.backupState=null;this.initBackupState=function(){this.backupState={arrImg:[],width:"",height:"",
bRatioChecked:!0,imgRatio:1}};this.inputUrlPasteTimer=null;this.bOkBtnClick=!1;this.getContents=function(){try{var b=this.type===this.IMG_INSERT&&!1!==dzeUiConfig.bUseMultiImageInsert,a="<div style='width:350px;'>";a+="<form name='dze_insert_image_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadImageURL+"' >";a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";a+="<tr"+(!0===dzeUiConfig.bUseServerUpload?"":" style='display:none;'")+
">";a+="<td><input type='radio' name='dze_insert_type' value='1' id='"+this.idx_insertimage_radio_type1+"' checked='true' /><label for='"+this.idx_insertimage_radio_type1+"' style='background: none;'>"+ID_RES_DIALOG_STRING_FILE_PATH+"</label></td>";a+="<td style='float: right;'>";a+=this.makeExtFileForm("dze_upimage_file",this.idx_insertimage_upimage_txt,"258px",[".png",".jpg",".gif",".jpeg"],b);a+="</td>";a+="</tr>";a+="<tr>";a+="<td colspan='2' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td><input type='radio' name='dze_insert_type' value='2' id='"+
this.idx_insertimage_radio_type2+"' /><label for='"+this.idx_insertimage_radio_type2+"' style='background: none;'>"+ID_RES_DIALOG_STRING_URL_INPUT+"</label></td>";a+="<td style='text-align: right;'><input type='text' name='dze_upimage_url' value='' id='"+this.idx_insertimage_upurl_txt+"' class='duzon_dialog_body_urlform' style='width:256px;' disabled /></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div id='id_image_detail_setting'>";a+="<div id='"+this.idx_insertimage_size_table+
"' width='100%'>";a+="<div class='duzon_dialog_label_title' id='"+this.idx_insertimage_size_title+"'>"+ID_RES_DIALOG_STRING_SIZE+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_DIALOG_STRING_WIDTH+this.makeSpinnerInputForm(this.idx_dze_insertimage_width,"px");a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_DIALOG_STRING_HEIGHT+this.makeSpinnerInputForm(this.idx_dze_insertimage_height,"px");a+="</div>";a+=
"</div>";a+='<div class="duzon_dialog_row">';a+='<div style="width:140px;">';a+="<input type='checkbox' name='dze_image_orgratio' value='1' id='"+this.idx_insertimage_checkbox_orgratio+"' checked='checked' style='margin-right: 5px;'/><label for='"+this.idx_insertimage_checkbox_orgratio+"' style='cursor: pointer; background: none;'>"+ID_RES_DIALOG_STRING_KEEP_RATIO+"</label>";a+="</div>";a+="<input type='button' value='"+ID_RES_DIALOG_STRING_SET_ORG+"' id='"+this.idx_dze_org_imagesize+"' class='duzon_dialog_btn_upload' style='padding-left:6px !important; padding-right:6px !important; padding-top: 3px !important; width:auto !important;' />";
a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_LEFT+duzon_dialog.makeSpinnerInputForm("dze_image_marginleft","px");a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_TOP+duzon_dialog.makeSpinnerInputForm("dze_image_margintop",
"px");a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_RIGHT+duzon_dialog.makeSpinnerInputForm("dze_image_marginright","px");a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_BOTTOM+duzon_dialog.makeSpinnerInputForm("dze_image_marginbottom","px");a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+
ID_RES_CONST_INSERT_IMAGE_PARAGRAPH_ALIGN+"</div>";a+="<div style='height: 50px; margin-top: 4px; display: flex;'>";for(var c=b=null,d=null,e=this.dze_image_align_propertys,f=0,h=e.length;f<h;f++)b="idx_dze_align_style_"+e[f],c=dzeEnvConfig.strPath_Image+"dialog/ico_ali_picture_"+e[f]+".png",d=0===f?window.ID_RES_DIALOG_STRING_ALIGN_BASIC:window["ID_RES_DIALOG_STRING_ALIGN_"+e[f].toUpperCase()],a+="<div class='dze_image_align_propery_set' id='"+b+"'><div><img src='"+c+"' alt='' title='"+d+"' width='28' height='28'></div>"+
d+"</div>";a+="</div>";a+="</div>";a+="</form>";a+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+"' style='width:100%;height:100px;display:none'></iframe>";return a+"</div>"}catch(k){dalert(k)}};this.onLoad=function(b){try{b=b||[];var a=[];b&&Array.isArray(b)&&b.forEach(function(b){a.push(b.cloneNode(!0))});this.setImgArray(a);this.initBackupState();var c=0<b.length?b[0]:null,d=this,e=g_objLayerKit.getLayerDocument().dze_insert_image_form;c&&(g_objLayerKit.getElementById(this.idx_insertimage_upurl_txt).value=
c.src);var f=e.dze_insert_type,h=f[0],k=f[1];if(this.type===this.IMG_MODIFY)k.checked=!0,h.disabled=!0,k.disabled=!0,this.disableExtFileForm(this.idx_insertimage_upimage_txt),this.disableImageUrlForm(this.idx_insertimage_upurl_txt),g_objLayerKit.getElementById("id_image_detail_setting").style.display="";else if(this.type===this.IMG_INSERT||this.type===this.IMG_REPLACE){this.type===this.IMG_INSERT&&!0===dzeUiConfig.bUseServerUpload?(h.checked=!0,this.enableExtFileForm(this.idx_insertimage_upimage_txt),
this.disableImageUrlForm(this.idx_insertimage_upurl_txt)):(k.checked=!0,this.disableExtFileForm(this.idx_insertimage_upimage_txt),this.enableImageUrlForm(this.idx_insertimage_upurl_txt));g_objLayerKit.getElementById("id_image_detail_setting").style.display="";for(var m=null,g=0;g<f.length;g++)f[g].addEventListener("change",function(){this!==m&&(m=this);d.onChangeRadio()});this.addEventExtFileForm(this.idx_insertimage_upimage_txt,function(){d.onChangeImgSrc()});var l=g_objLayerKit.getElementById(this.idx_insertimage_upurl_txt),
n="";l.onkeydown=function(a){a.keyCode===ID_KEYCODE_ENTER&&(n=l.value,d.onChangeImgSrc())};l.onpaste=function(){clearTimeout(this.inputUrlPasteTimer);this.inputUrlPasteTimer=setTimeout(function(){n=l.value;d.onChangeImgSrc()},100)}.bind(this);l.onblur=function(){this.value!==n&&(n=l.value,d.onChangeImgSrc())};!0===dzeUiConfig.bIndependentEdit&&"function"===typeof onefficeExtContent.addUploadForm&&onefficeExtContent.addUploadForm(e)}var r=c?c.width:"",u=e.dze_image_width,x=DzeSpinner.createSpinner(u,
{max:5E3,min:0,value:r});x.setValue=this.setImgWidth.bind(this);u.onkeyup=function(){x.setValue(u.value)};var y=c?c.height:"",v=e.dze_image_height,z=DzeSpinner.createSpinner(v,{max:5E3,min:0,value:y});z.setValue=this.setImgHeight.bind(this);v.onkeyup=function(){z.setValue(v.value)};var A=g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio");c&&(this.imgRatio=0<r?y/r:1,A.checked=c.hasAttribute("dze_image_no_proportion")?!0:!1);A.onclick=function(){d.onClickRatio()};g_objLayerKit.getElementById(this.idx_dze_org_imagesize).onclick=
function(){d.onClickOrgImgSize(!1)};var B=g_objCommonUtil,q={};["marginRight","marginTop","marginBottom","marginLeft"].forEach(function(a,e){q[a]=0;var d=c?B.toPx(c.style[a]):0;b.every(function(b){return d===B.toPx(b.style[a])})&&(q[a]=d)});this.modifySpinnerValue("dze_image_marginright",100,0,q.marginRight,null);this.modifySpinnerValue("dze_image_margintop",100,0,q.marginTop,null);this.modifySpinnerValue("dze_image_marginbottom",100,0,q.marginBottom,null);this.modifySpinnerValue("dze_image_marginleft",
100,0,q.marginLeft,null);var p=this.dze_image_align_propertys;this.arrAlignBtn=[];var C=c?c.align:"",w=c?c.style.verticalAlign:"";g=0;for(var E=p.length;g<E;g++){var t=g_objLayerKit.getElementById("idx_dze_align_style_"+p[g]);this.arrAlignBtn.push(t);f=e="";switch(p[g]){case "default":f="baseline";break;case "middle":f="middle";break;case "top":f="top";break;case "left":e="left";break;case "right":e="right"}t._align=e;t._vertical_align=f;e=!1;0===g&&this.type==this.IMG_INSERT&&(e=!0);e||""!==C||""!==
w||"default"!==p[g]||(e=!0);e||C!==p[g]||(e=!0);e||w!==p[g]||(e=!0);e||"baseline"!==w||"default"!==p[g]||(e=!0);e&&g_objPropertyUtil.addClass(t,"dze_image_align_propery_set_selected");t.onclick=function(){d.onClickAlign(this)}}this.bOkBtnClick=!1;b&&1===b.length&&this.setOrgImageSizeTitle(b[0])}catch(D){dalert(D)}};this.updateImageList=function(b){try{var a=document.createElement("table");a.setAttribute("cellspacing","0");a.setAttribute("cellpadding","0");a.setAttribute("width","100%");a.setAttribute("style",
"border-collapse:collapse;");var c;a.innerHTML="<colgroup><col style='width: 110px;'><col style='width: 10px;'><col style='width: 110px;'><col style='width: 10px;'><col style='width: 110px;'></clogroup>";var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),h=document.createElement("img"),k=document.createElement("p"),m=document.createElement("p");d.appendChild(e);d.appendChild(f);e.appendChild(h);f.appendChild(k);f.appendChild(m);d.style.width="110px";
d.style.marginBottom="5px";e.style.width="100%";e.style.height="70px";e.style.marginBottom="5px";h.style.maxWidth="100%";h.style.maxHeight="100%";f.style.width="100%";f.style.textAlign="left";k.style.marginLeft="5px";m.style.fontSize="11px";m.style.marginLeft="5px";for(e=0;e<b.length;e++){var g=b[e];var l=d.cloneNode(!0);0===e%3&&(c=a.insertRow());var n=c.insertCell();n.appendChild(l);n.style.textAlign="center";l.firstChild.firstChild.setAttribute("src",g.url);l.lastChild.firstChild.textContent=g.description;
""!==g.width&&""!==g.height&&(l.lastChild.lastChild.textContent=g.width+" x "+g.height);2!==e%3&&(n=c.insertCell())}return a}catch(r){dalert(r)}};this.onUnload=function(){try{clearTimeout(this.inputUrlPasteTimer);var b=g_objLayerKit.getLayerDocument().dze_insert_image_form.dze_upimage_url;b&&(b.onblur=null)}catch(a){dalert(a)}};this.onClickOk=function(b){try{if(!this.bOkBtnClick&&this.arrImg&&0!==this.arrImg.length){b=b||function(){};var a=this.getImgProp();if(this.type===this.IMG_MODIFY)b(null,a);
else{var c=g_objLayerKit.getLayerDocument().dze_insert_image_form,d=c.dze_insert_type;if(d[0].checked)this.bOkBtnClick=!0,uploadImg(this.nEditNumber,c,function(c){this.bOkBtnClick=!1;(c=c?c.url:null)&&this.arrImg&&0!==c.length&&0!==this.arrImg.length&&a?b(c,a):dalert("upload err")}.bind(this));else if(d[1].checked){var e=this.getWebImageUrl(c.dze_upimage_url.value);e&&this.arrImg[0].src===e&&b([e],a)}}}}catch(f){dalert(f)}};this.getImgProp=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,
a={};a.arrImg=this.arrImg.slice();var c=b.dze_image_width.value;a.width=""===c||isNaN(c)?"":parseInt(c,10)+"px";var d=b.dze_image_height.value;a.height=""===d||isNaN(d)?"":parseInt(d,10)+"px";a.bKeepRatio=b.dze_image_orgratio.checked;var e=b.dze_image_marginleft.value;a.marginLeft=""===e||"0"===e||isNaN(e)?"":parseInt(e,10)+"px";var f=b.dze_image_marginright.value;a.marginRight=""===f||"0"===f||isNaN(f)?"":parseInt(f,10)+"px";var h=b.dze_image_margintop.value;a.marginTop=""===h||"0"===h||isNaN(h)?
"":parseInt(h,10)+"px";var k=b.dze_image_marginbottom.value;a.marginBottom=""===k||"0"===k||isNaN(k)?"":parseInt(k,10)+"px";c=b="";d=0;for(var m=this.arrAlignBtn.length;d<m;d++){var g=this.arrAlignBtn[d];g_objPropertyUtil.hasClass(g,"dze_image_align_propery_set_selected")&&(g._align&&(b=g._align),g._vertical_align&&(c=g._vertical_align))}a.align=b;a.vertical_align=c;return a}catch(l){dalert(l)}};this.setImgProp=function(b,a,c){try{if(b&&a){c=c||{};var d=!1;!1!==c.bSetSize&&b.style.width!==a.width&&
(d=!0,b.removeAttribute("width"),b.style.width=a.width);!1!==c.bSetSize&&b.style.height!==a.height&&(d=!0,b.removeAttribute("height"),b.style.height=a.height);b.style.marginLeft!==a.marginLeft&&(d=!0,b.style.marginLeft=a.marginLeft);b.style.marginTop!==a.marginTop&&(d=!0,b.style.marginTop=a.marginTop);b.style.marginRight!==a.marginRight&&(d=!0,b.style.marginRight=a.marginRight);b.style.marginBottom!==a.marginBottom&&(d=!0,b.style.marginBottom=a.marginBottom);b.align!==a.align&&(d=!0,""===a.align?
b.removeAttribute("align"):b.align=a.align);b.style.verticalAlign!==a.vertical_align&&(d=!0,b.style.verticalAlign=""===a.vertical_align?"":a.vertical_align);a.bKeepRatio!==b.hasAttribute("dze_image_no_proportion")&&(d=!0,a.bKeepRatio?b.setAttribute("dze_image_no_proportion",""):b.removeAttribute("dze_image_no_proportion"));return d}}catch(e){dalert(e)}};this.onChangeRadio=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,a=b.dze_insert_type,c=g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio"),
d={arrImg:this.arrImg,imgRatio:this.imgRatio,width:b.dze_image_width.value,height:b.dze_image_height.value,bRatioChecked:c.checked},e=this.backupState;this.arrImg=e.arrImg;this.imgRatio=e.imgRatio;this.type!==this.IMG_REPLACE&&(b.dze_image_width.value=e.width,b.dze_image_height.value=e.height,c.checked=e.bRatioChecked);this.backupState=d;a[0].checked?(this.enableExtFileForm(this.idx_insertimage_upimage_txt),this.disableImageUrlForm(this.idx_insertimage_upurl_txt),g_objLayerKit.getElementById("id_image_detail_setting").style.display=
"",g_objLayerKit.getElementById(this.idx_insertimage_upimage_txt).focus()):a[1].checked&&(this.disableExtFileForm(this.idx_insertimage_upimage_txt),this.enableImageUrlForm(this.idx_insertimage_upurl_txt),g_objLayerKit.getElementById("id_image_detail_setting").style.display="",g_objLayerKit.getElementById(this.idx_insertimage_upurl_txt).select());this.enableSize(1<this.arrImg.length?!1:!0)}catch(f){dalert(f)}};this.getWebImageUrl=function(b){try{return g_bBrowserType_CR&&dzeEnvConfig.strGetWebImgURL&&
"https:"===location.protocol&&"http:"===parseURL(b).protocol&&(b=getFullUrlFromPath(dzeEnvConfig.strGetWebImgURL+"?url="+encodeURIComponent(b))),b}catch(a){dalert(a)}};this.onChangeImgSrc=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,a=null;if(!0===dzeUiConfig.bSupportNewsEditor&&!1===fnObjectCheckNull(b.media_file))a=b.media_file.files;else{var c=b.dze_insert_type;!1===fnObjectCheckNull(c)&&(1==c[0].checked?a=b.dze_upimage_file.files:1==c[1].checked&&(a=[this.getWebImageUrl(b.dze_upimage_url.value)]))}this.setImgArray([]);
duzon_http.showLoading();checkValidImgFile(a,function(a,b,c,h){duzon_http.hideLoading();0<h.length?this.showToastMessageArray(null,h,null):this.setImgArray(c);if(this.type!==this.IMG_REPLACE)this.onClickOrgImgSize();!0!==dzeUiConfig.bSupportNewsEditor&&this.enableSize(1<c.length?!1:!0)}.bind(this))}catch(d){dalert(d)}};this.setImgWidth=function(b){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form;if((!this.arrImg||0===this.arrImg.length)&&this.type!==this.IMG_REPLACE)return alert(ID_RES_DIALOG_ALERT_INSERT_IMAGE),
a.dze_image_width.value="",!1;if(""===b||isNaN(b))return a.dze_image_width.value="",!1;b=parseInt(b,10);b=Math.max(0,Math.min(5E3,b));a.dze_image_width.value=b;if(g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio").checked){var c=parseInt(b*this.imgRatio,10);c=Math.max(0,Math.min(5E3,c));a.dze_image_height.value=c}}catch(d){dalert(d)}};this.setImgHeight=function(b){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form;if((!this.arrImg||0===this.arrImg.length)&&this.type!==
this.IMG_REPLACE)return alert(ID_RES_DIALOG_ALERT_INSERT_IMAGE),a.dze_image_height.value="",!1;if(""===b||isNaN(b))return a.dze_image_height.value="",!1;b=parseInt(b,10);b=Math.max(0,Math.min(b,5E3));a.dze_image_height.value=b;if(g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio").checked){var c=parseInt(b/this.imgRatio,10);c=Math.max(0,Math.min(5E3,c));a.dze_image_width.value=c}}catch(d){dalert(d)}};this.enableSize=function(b){try{g_objLayerKit.getElementById(this.idx_dze_insertimage_width).disabled=
b?!1:!0,g_objLayerKit.getElementById(this.idx_dze_insertimage_height).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_insertimage_checkbox_orgratio).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_dze_org_imagesize).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_insertimage_size_title).style.opacity=b?"":.3,g_objLayerKit.getElementById(this.idx_insertimage_size_table).style.opacity=b?"":.3}catch(a){dalert(a)}};this.onClickRatio=function(){try{if(g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio").checked){var b=
g_objLayerKit.getLayerDocument().dze_insert_image_form,a=parseFloat(b.dze_image_width.value),c=parseFloat(b.dze_image_height.value);this.imgRatio=0<a?c/a:1}}catch(d){dalert(d)}};this.onClickOrgImgSize=function(b){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form,c=this.arrImg,d=!1!==b?getMaxBoundSize(this.nEditNumber):null;c.forEach(function(a){setOrgImageSize(a,d,!0)});if(!0!==dzeUiConfig.bSupportNewsEditor){var e=c&&0<c.length?c[0]:null;if(e){b=g_objCommonUtil;var f=b.toPx(e.style.width),
h=b.toPx(e.style.height);a.dze_image_width.value=f;a.dze_image_height.value=h;this.imgRatio=0<f?h/f:1}else a.dze_image_width.value="",a.dze_image_height.value="";this.setOrgImageSizeTitle(e)}}catch(k){dalert(k)}};this.onClickAlign=function(b){try{for(var a=g_objPropertyUtil,c=this.arrAlignBtn,d=0,e=c.length;d<e;d++)c[d]!==b&&a.removeClass(c[d],"dze_image_align_propery_set_selected");a.addClass(b,"dze_image_align_propery_set_selected")}catch(f){dalert(f)}};this.setOrgImageSizeTitle=function(b){try{var a=
g_objLayerKit.getElementById(this.idx_dze_org_imagesize);if(a){var c=b?b.naturalWidth:0,d=b?b.naturalHeight:0;c&&d?a.setAttribute("title",ID_RES_DIALOG_STRING_WIDTH+": "+c+"px , "+ID_RES_DIALOG_STRING_HEIGHT+": "+d+"px"):a.removeAttribute("title")}}catch(e){dalert(e)}}}).call(ImageInsertDlg);

var dzeColorPallet={colorno_gap:8,colorRowCnt:32,color_pix:4,colorset:[],default_hexCode:"000000",gray_hexCode:"808080",layerDoc:document,layerWin:window,showButtons:!0,palletViewType:"image",initialize:function(a,b,d,c){this.setLayerDoc();"undefined"!=typeof c&&null!=c&&""!=c&&(dzeColorPallet.layerDoc=c);if("undefined"==typeof a||""==a||null==dzeColorPallet.layerDoc.getElementById(a))dlog("please set pallet container id!");else{this.createPalletContainer(a);1==this.showButtons&&this.createPalletButtonContainer(a,
d);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_box").ondragstart=function(){return!1};dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_box").onselectstart=function(){return!1};c=255;var e=0,f=0,g="";d=[];for(a=0;a<=this.colorno_gap;a++)e=256/this.colorno_gap*a,255<e&&(e=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=this.colorno_gap-1;0<=a;a--)c=256/this.colorno_gap*a,255<c&&(c=255),g=this.getDecToHex(c)+this.getDecToHex(e)+
this.getDecToHex(f),d.push(g);for(a=1;a<=this.colorno_gap;a++)f=256/this.colorno_gap*a,255<f&&(f=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=this.colorno_gap-1;0<=a;a--)e=256/this.colorno_gap*a,255<e&&(e=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=1;a<=this.colorno_gap;a++)c=256/this.colorno_gap*a,255<c&&(c=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);for(a=this.colorno_gap-1;0<=a;a--)f=256/
this.colorno_gap*a,255<f&&(f=255),g=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(f),d.push(g);e=d.length;var h=g=f=0,k={};for(a=0;a<=this.colorRowCnt;a++)if(this.colorset[a]=[],0==a)for(c=0;c<e;c++)this.colorset[a].push(d[c]);else for(c=0;c<e;c++)k=this.getHexToDec(d[c]),0==c&&(f=k.R_val,g=k.G_val,h=k.B_val),128<k.R_val?(f=k.R_val-Math.ceil((k.R_val-128)/this.colorRowCnt*a),128>f&&(f=128)):(f=k.R_val+Math.ceil((128-k.R_val)/this.colorRowCnt*a),128<f&&(f=128)),128<k.G_val?(g=k.G_val-Math.ceil((k.G_val-
128)/this.colorRowCnt*a),128>g&&(g=128)):(g=k.G_val+Math.ceil((128-k.G_val)/this.colorRowCnt*a),128<g&&(g=128)),128<k.B_val?(h=k.B_val-Math.ceil((k.B_val-128)/this.colorRowCnt*a),128>h&&(h=128)):(h=k.B_val+Math.ceil((128-k.B_val)/this.colorRowCnt*a),128<h&&(h=128)),this.colorset[a].push(this.getDecToHex(f)+this.getDecToHex(g)+this.getDecToHex(h));d="";if("pixel"==this.palletViewType){d+="<table width='' height='' border='0' cellpadding='0' cellspacing='0'>";e="";for(a=0;a<this.colorset.length;a++){d+=
"<tr>";for(c=0;c<this.colorset[a].length;c++)e=this.colorset[a][c],d+="<td width='"+this.color_pix+"' height='"+this.color_pix+"'><div style=\"cursor:default;width:"+this.color_pix+"px;height:"+this.color_pix+"px;background-color:#"+e+'"></div></td>';d+="</tr>"}d+="</table>"}else"image"==this.palletViewType&&(d+="<div class='dze_color_pallet_bg'></div>");dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").innerHTML=d;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").onmousedown=
function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="pallet";dzeColorPallet.showColorSelector(a);a=dzeColorPallet.getColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.viewSubColor(a);dzeColorPallet.showCrossColorSelector("black");dlog("\npallet color mouse down color : "+a);dlog("\n")};a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_selector";a.className="dze_color_pallet_table_selector_black";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").appendChild(a);
b=this.checkHexCode(b);!0===dzeUiConfig.showAchromaticColor&&this.viewAchromatic();b==this.default_hexCode||""==b?this.viewSubColor(this.gray_hexCode):this.viewSubColor(b);this.addFormEvent();this.viewOrgColor(b);this.selectCode(b);this.viewRecentColorSet();this.viewUserColorCodeSet();this.addMouseEvent();dlog("\npallet color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.colorset);dlog("\n")}},setLayerDoc:function(){this.layerDoc=g_objLayerKit.getLayerDocument();this.layerWin=g_objLayerKit.getLayerWindow()},
color_pallet_container_obj:null,createPalletContainer:function(a){var b="<table width='341' border='0' cellpadding='0' cellspacing='0' id='dze_idx_color_pallet_table_box'>\t<tr>\t\t<td width='196'><div id='dze_idx_color_pallet_table' class='dze_color_pallet_table'></div></td>\t\t<td width='10'></td>\t\t<td width='35'><div id='dze_idx_color_pallet_table_sub' class='dze_color_pallet_table_sub'></div></td>\t\t<td width='100'>";!0===dzeUiConfig.showPalletRecentColor&&(b+="\t\t\t<div class='dze_color_pallet_table_recent_color_label'>"+
ID_RES_CONST_STRING_RECENT_COLOR+"</div><div id='dze_idx_color_pallet_table_recent' class='dze_color_pallet_table_recent'></div>");b+="\t\t</td>\t</tr>\t<tr>\t\t<td height='10' colspan='4'></td>\t</tr>";!0===dzeUiConfig.showAchromaticColor&&(b+="\t<tr>\t\t<td height='35'><div id='dze_idx_color_pallet_table_achromatic' class='dze_color_pallet_table_achromatic'></div></td>\t\t<td colspan='3'></td>\t</tr>\t<tr>\t\t<td height='5' colspan='4'></td>\t</tr>");b=b+"</table><table width='341' border='0' cellpadding='0' cellspacing='3' id='dze_idx_color_form_table_box'>\t<tr>"+
("\t\t<td width='50' align='left'>"+ID_RES_CONST_STRING_RED+"(R):</td>");b+="\t\t<td width='50' align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_R_value",width:50,height:22})+"</td>";b+="\t\t<td width='57' align='right'>"+ID_RES_CONST_STRING_HUE+"(H):</td>";b+="\t\t<td width='57' align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_H_value",width:50,height:22})+"</td>";b=b+"\t\t<td width='10' colspan='4'></td>\t\t<td width='' rowspan='4' align='center' valign='bottom'>"+("\t\t\t<div class='dze_color_pallet_table_new_color_box_label'>"+
ID_RES_CONST_STRING_NEW_COLOR+"</div>");b=b+"\t\t\t<div id='dze_idx_new_color' class='dze_color_pallet_table_new_color_box'></div>\t\t\t<div id='dze_idx_old_color' class='dze_color_pallet_table_old_color_box'></div>"+("\t\t\t<div class='dze_color_pallet_table_old_color_box_label'>"+ID_RES_CONST_STRING_CURRENT_COLOR+"</div>");b=b+"\t\t</td>\t</tr>\t<tr>"+("\t\t<td align='left'>"+ID_RES_CONST_STRING_GREEN+"(G):</td>");b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_G_value",width:50,
height:22})+"</td>";b+="\t\t<td align='right'>"+ID_RES_CONST_STRING_SATURATION+"(S): </td>";b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_S_value",width:50,height:22})+"</td>";b=b+"\t\t<td></td>\t</tr>\t<tr>"+("\t\t<td align='left'>"+ID_RES_CONST_STRING_BLUE+"(B):</td>");b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_B_value",width:50,height:22})+"</td>";b+="\t\t<td align='right'>"+ID_RES_CONST_STRING_LIGHTNESS+"(L):</td>";b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_L_value",
width:50,height:22})+"</td>";b+="\t\t<td></td>\t</tr>\t<tr>\t\t<td align='left' colspan='2'>HTML(T):</td>\t\t<td align='right' colspan='2'> #<input type='text' size='3' class='dze_color_pallet_table_htmlcode_form' id='dze_idx_color_value' value='' /></td>\t\t<td></td>\t</tr></table>";!0===dzeUiConfig.showPalletUserColor&&(b+="<table width='341' border='0' cellpadding='0' cellspacing='0'>\t<tr>\t\t<td align='center'><div class='dze_color_pallet_table_hr_separator'></div></td>\t</tr>\t<tr>\t\t<td align='center'><div id='dze_idx_color_pallet_table_user' class='dze_color_pallet_table_user'></div></td>\t</tr></table>");
this.color_pallet_container_obj=dzeColorPallet.layerDoc.createElement("div");this.color_pallet_container_obj.id="dze_idx_color_pallet_container";this.color_pallet_container_obj.className="dze_color_pallet_container";this.color_pallet_container_obj.innerHTML=b;dzeColorPallet.layerDoc.getElementById(a).appendChild(this.color_pallet_container_obj)},color_pallet_button_container_obj:null,createPalletButtonContainer:function(a,b){this.color_pallet_button_container_obj=dzeColorPallet.layerDoc.createElement("div");
this.color_pallet_button_container_obj.id="dze_idx_color_pallet_button_container";this.color_pallet_button_container_obj.className="duzon_dialog_buttonbox";dzeColorPallet.layerDoc.getElementById(a).appendChild(this.color_pallet_button_container_obj);"undefined"==typeof b&&(b=function(){});if(null==b||""==b)b=function(){};a=[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE];for(var d=[function(){var a=dzeColorPallet.getColorCode("hex");b(a)},function(){duzon_dialog.closeExtendsDlg()}],c={},e=0;e<a.length;e++)c=
{},c=dzeColorPallet.layerDoc.createElement("input"),c.type="button",c.value=a[e],function(){var a=d[e],b=e;c.onclick=function(b){a(b?b:dzeColorPallet.layerWin.event)};var h="duzon_dialog_btn_normal",k="duzon_dialog_btn_up",l="duzon_dialog_btn_down";0==b&&(h="duzon_dialog_btn_ok_normal",k="duzon_dialog_btn_ok_up",l="duzon_dialog_btn_ok_down");c.className=h;c.onmouseover=function(){this.className=k};c.onmouseout=function(){this.className=h};c.onmousedown=function(){this.className=l};c.onmouseup=function(){this.className=
k}}(),this.color_pallet_button_container_obj.appendChild(c)},addFormEvent:function(){dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_R_value",255,0,0,"dzeColorPallet.evtModifyFormColorR");dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_G_value",255,0,0,"dzeColorPallet.evtModifyFormColorG");
dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_B_value",255,0,0,"dzeColorPallet.evtModifyFormColorB");dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").onkeyup=function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_H_value",360,0,0,"dzeColorPallet.evtModifyFormColorH");dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").onkeyup=
function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_S_value",100,0,0,"dzeColorPallet.evtModifyFormColorS");dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").onkeyup=function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_L_value",100,0,0,"dzeColorPallet.evtModifyFormColorL");dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").onkeyup=function(){dzeColorPallet.modifyHexCode(this)};dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").onfocus=
function(){this.select()}},evtModifyFormColorR:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorG:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorB:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorH:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value");
dzeColorPallet.modifyHslValue(a)},evtModifyFormColorS:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value");dzeColorPallet.modifyHslValue(a)},evtModifyFormColorL:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value");dzeColorPallet.modifyHslValue(a)},addMouseEvent:function(){window.attachEvent?(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").attachEvent("onmousemove",dzeColorPallet.evtMouseMove),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").attachEvent("onmouseup",
dzeColorPallet.evtMouseUp)):window.addEventListener&&(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").addEventListener("mousemove",dzeColorPallet.evtMouseMove,!1),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").addEventListener("mouseup",dzeColorPallet.evtMouseUp,!1))},removeMouseEvent:function(){window.detachEvent?(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").detachEvent("onmousemove",dzeColorPallet.evtMouseMove),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").detachEvent("onmouseup",
dzeColorPallet.evtMouseUp)):window.removeEventListener&&(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").removeEventListener("mousemove",dzeColorPallet.evtMouseMove,!1),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").removeEventListener("mouseup",dzeColorPallet.evtMouseUp,!1))},evtMouseMove:function(a){a=a?a:dzeColorPallet.layerWin.event;if("pallet"==dzeColorPallet.downPosition){dzeColorPallet.showColorSelector(a);var b=dzeColorPallet.getColorCodeFromSelector();
dzeColorPallet.selectCode(b);dzeColorPallet.viewSubColor(b)}"subColor"==dzeColorPallet.downPosition&&(dzeColorPallet.showSubColorSelector(a),b=dzeColorPallet.getSubColorCodeFromSelector(),dzeColorPallet.selectCode(b));"achromatic"==dzeColorPallet.downPosition&&(dzeColorPallet.showAchromaticSelector(a),b=dzeColorPallet.getAchromaticColorCodeFromSelector(),dzeColorPallet.selectCode(b))},evtMouseUp:function(a){dzeColorPallet.downPosition=""},maxRecentColorNum:20,recentColorCodeSet:[],viewRecentColorSet:function(){if(!0===
dzeUiConfig.showPalletRecentColor&&null!=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent")){dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent").innerHTML="";var a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_recent_color_box";a.className="dze_color_pallet_table_recent_color_box";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent").appendChild(a);for(var b="",d=this.getRecentColorSet(),c=null,
e=0;e<this.maxRecentColorNum;e++)if(c=dzeColorPallet.layerDoc.createElement("div"),c.className="dze_color_pallet_table_recent_color_unit","undefined"!=typeof d[e]&&(b=d[e],c.style.backgroundColor="#"+b,c.style.cursor="pointer",c.title="#"+b,function(){var a=b;c.onclick=function(){dzeColorPallet.selectRecentColor(this,a)}}()),a.appendChild(c),17==e){var f=dzeColorPallet.layerDoc.createElement("div");f.className="dze_color_pallet_table_recent_color_delete";f.title=ID_RES_CONST_BTN_DELETE;f.onclick=
function(){dzeColorPallet.removeRecentColorListConfirm()};a.appendChild(f)}dlog("\nrecent color set array \u2193\u2193\u2193");g_objCommonUtil.dir(d);dlog("\n")}},selectRecentColor:function(a,b){for(var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent_color_box").childNodes,c=0;c<d.length;c++)d[c].style.borderColor="#ffffff";a.style.borderColor="#"+b;dzeColorPallet.selectCode(b);dzeColorPallet.showCrossColorSelector("white")},getRecentColorSet:function(){if("undefined"!=
typeof localStorage)try{localStorage.getItem("edtstrg_recentHexCodeList")&&(this.recentColorCodeSet=localStorage.getItem("edtstrg_recentHexCodeList").split(","))}catch(a){}return this.recentColorCodeSet},setRecentColorSet:function(a){this.recentColorCodeSet=a;if("undefined"!=typeof localStorage)try{localStorage.setItem("edtstrg_recentHexCodeList",a.join(","))}catch(b){}},addRecentColorSet:function(a){a=this.checkHexCode(a);if(6==a.length){var b=this.getRecentColorSet();b=this.removeValueFromArrayList(a,
b);b.unshift(a);b=this.getMaxArrayList(b,this.maxRecentColorNum);this.setRecentColorSet(b);this.viewRecentColorSet()}},removeRecentColorList:function(){this.recentColorCodeSet=[];if("undefined"!=typeof localStorage)try{localStorage.setItem("edtstrg_recentHexCodeList","")}catch(a){}this.viewRecentColorSet()},removeRecentColorListConfirm:function(){0==this.getRecentColorSet().length?alert(ID_RES_CONST_MSG_ALERT_NO_RECENT_COLOR):confirm(ID_RES_CONST_MSG_ALERT_DELETE_RECENT_COLOR)&&this.removeRecentColorList()},
removeValueFromArrayList:function(a,b){for(var d=[],c=0;c<b.length;c++)b[c]!=a&&d.push(b[c]);return d},getMaxArrayList:function(a,b){if(a.length>b){b=a.length-b;for(var d=0;d<b;d++)a.pop()}return a},maxUserColorNum:26,userColorCodeSet:[],viewUserColorCodeSet:function(){if(!0===dzeUiConfig.showPalletUserColor){dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").innerHTML="";var a=dzeColorPallet.layerDoc.createElement("div");a.className="dze_color_pallet_table_user_label";a.innerHTML=
ID_RES_CONST_STRING_USER_SET;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").appendChild(a);a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_user_color_box";a.className="dze_color_pallet_table_user_color_box";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").appendChild(a);for(var b="",d=this.getUserColorCodeSet(),c=null,e=0;e<this.maxUserColorNum;e++)if(c=dzeColorPallet.layerDoc.createElement("div"),c.className="dze_color_pallet_table_user_color_unit",
"undefined"!=typeof d[e]&&(b=d[e],c.style.backgroundColor="#"+b,c.style.cursor="pointer",c.title="#"+b,function(){var a=b;c.onclick=function(){dzeColorPallet.selectUserColor(this,a)}}()),a.appendChild(c),12==e){var f=dzeColorPallet.layerDoc.createElement("div");f.className="dze_color_pallet_table_recent_color_delete";f.title=ID_RES_CONST_BTN_DELETE;f.onclick=function(){dzeColorPallet.removeUserColorListConfirm()};a.appendChild(f);f=dzeColorPallet.layerDoc.createElement("div");f.className="dze_color_pallet_table_user_color_add";
f.title=ID_RES_CONST_STRING_ADD_USER_COLOR;f.onclick=function(){dzeColorPallet.addUserColorCodeSet()};a.appendChild(f)}dlog("\nuser color set array \u2193\u2193\u2193");g_objCommonUtil.dir(d);dlog("\n")}},selected_user_color:"",selectUserColor:function(a,b){for(var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user_color_box").childNodes,c=0;c<d.length;c++)d[c].style.borderColor="#ffffff";a.style.borderColor="#"+b;dzeColorPallet.selectCode(b);dzeColorPallet.showCrossColorSelector("white");
dzeColorPallet.selected_user_color=b},getUserColorCodeSet:function(){if("undefined"!=typeof localStorage)try{localStorage.getItem("edtstrg_userHexCodeList")&&(this.userColorCodeSet=localStorage.getItem("edtstrg_userHexCodeList").split(","))}catch(a){}return this.userColorCodeSet},setUserColorSet:function(a){this.userColorCodeSet=a;if("undefined"!=typeof localStorage)try{localStorage.setItem("edtstrg_userHexCodeList",a.join(","))}catch(b){}},addUserColorCodeSet:function(){var a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value;
a=this.checkHexCode(a);if(6==a.length){var b=this.getUserColorCodeSet();b=this.removeValueFromArrayList(a,b);b.unshift(a);b=this.getMaxArrayList(b,this.maxUserColorNum);this.setUserColorSet(b);this.viewUserColorCodeSet()}},removeUserColorList:function(){this.userColorCodeSet=[];if("undefined"!=typeof localStorage)try{localStorage.setItem("edtstrg_userHexCodeList","")}catch(a){}this.viewUserColorCodeSet()},removeUserColorListConfirm:function(){var a=this.getUserColorCodeSet();0!=a.length&&""!=this.selected_user_color&&
(a=this.removeValueFromArrayList(this.selected_user_color,a),this.setUserColorSet(a),this.viewUserColorCodeSet())},achromaticSet:[],achromaticColorPix:9,viewAchromatic:function(){var a="<table border='0' cellpadding='0' cellspacing='0'><tr>";var b=255,d=255,c=255;d="FFFFFF";b=100;b={};for(var e=0;20>=e&&(b=100-5*e,b=this.hsl2rgb(0,0,b),c=d=b=b.r,d=this.getDecToHex(b)+this.getDecToHex(d)+this.getDecToHex(c),this.achromaticSet.push(d),a+="<td width='"+this.achromaticColorPix+"' height='20'><div style=\"width:"+
this.achromaticColorPix+"px; height:20px;background-color:#"+d+';"></div></td>',0!=b);e++);a+="</tr></table>";dlog("\nachromatic color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.achromaticSet);dlog("\n");dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").innerHTML=a;a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_achromatic_selector";a.className="dze_color_pallet_table_achromatic_selector";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").appendChild(a);
dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").onmousedown=function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="achromatic";dzeColorPallet.showAchromaticSelector(a);a=dzeColorPallet.getAchromaticColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.showCrossColorSelector("white")}},subColorStep:16,subColorPix:4,subColorSet:[],viewSubColor:function(a){dlog("====== viewSubColor START ======");a=this.checkHexCode(a);6!=a.length&&
(a=this.default_hexCode);dlog("==== viewSubColor:"+a);a=this.getHexToDec(a);var b="<table width='' height='99' border='0' cellpadding='0' cellspacing='0'>";var d=255-a.R_val;d=Math.ceil(d/this.subColorStep);var c=255-a.G_val;c=Math.ceil(c/this.subColorStep);var e=255-a.B_val;e=Math.ceil(e/this.subColorStep);var f=255,g=255,h=255,k="FFFFFF";this.subColorSet=[];for(var l=0;l<=this.subColorStep;l++)l==this.subColorStep?(f=a.R_val,g=a.G_val,h=a.B_val):0<l&&(f-=d,g-=c,h-=e),f<a.R_val&&(f=a.R_val),g<a.G_val&&
(g=a.G_val),h<a.B_val&&(h=a.B_val),0>f&&(f=0),0>g&&(g=0),0>h&&(h=0),k=this.getDecToHex(f)+this.getDecToHex(g)+this.getDecToHex(h),this.subColorSet.push(k),b+="<tr>",b+="<td width='20' height='"+this.subColorPix+"'><div style=\"width:20px;height:"+this.subColorPix+"px;background-color:#"+k+'; cursor:default"></div></td>',b+="<td width='15'><div style='width:15px;'></div></td>",b+="</tr>";d=Math.ceil(f/this.subColorStep);c=Math.ceil(g/this.subColorStep);e=Math.ceil(h/this.subColorStep);for(l=1;l<=this.subColorStep;l++)l==
this.subColorStep?h=g=f=0:0<l&&(f-=d,g-=c,h-=e),0>f&&(f=0),0>g&&(g=0),0>h&&(h=0),k=this.getDecToHex(f)+this.getDecToHex(g)+this.getDecToHex(h),this.subColorSet.push(k),b+="<tr>",b+="<td width='20' height='"+this.subColorPix+"'><div style=\"width:20px;height:"+this.subColorPix+"px;background-color:#"+k+'; cursor:default"></div></td>',b+="<td width='15'><div style='width:15px;'></div></td>",b+="</tr>";b+="</table>";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").innerHTML=b;
dlog("\nsub color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.subColorSet);dlog("\n");a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_sub_selector";a.className="dze_color_pallet_table_sub_selector";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").appendChild(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").onmousedown=function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="subColor";
dzeColorPallet.showSubColorSelector(a);a=dzeColorPallet.getSubColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.showCrossColorSelector("white")}},downPosition:"",subColorUp:function(){},checkHexCode:function(a){if("undefined"==typeof a||null==a||""==a)return"";a=a.replace(/[^0-9a-fA-F]/gi,"");a=a.substring(0,6);return a=a.toUpperCase()},selectCode:function(a){dlog("====== selectCode START ===htmlCode ==="+a);a=this.checkHexCode(a);if(6==a.length){dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=
a.toUpperCase();var b=this.getHexToDec(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value=b.R_val;dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value=b.G_val;dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value=b.B_val;b=this.rgbToHsl(b.R_val,b.G_val,b.B_val);dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value=b[0];dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value=b[1];dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value=
b[2];this.viewNewColor(a);dlog("====== selectCode END ======");dlog("")}},modifyHexCode:function(a){dzeColorPallet.showCrossColorSelector("white");var b=this.checkHexCode(a.value);a.value=b;6>b.length||(this.selectCode(b),this.viewSubColor(b))},modifyRgbValue:function(a){dzeColorPallet.showCrossColorSelector("white");a.value=a.value.replace(/[^0-9]/g,"");if(""!=a.value){var b=parseInt(a.value,10);if(0>b)alert(ID_RES_DIALOG_ALERT_MIN_VALUE+"0"),a.value="";else if(255<b)alert(ID_RES_DIALOG_ALERT_MAX_VALUE+
"255"),a.value="";else{b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value;var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value,c=dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value;a=this.rgbToHsl(b,d,c);b=this.getDecToHex(b)+this.getDecToHex(d)+this.getDecToHex(c);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b.toUpperCase();dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value=a[0];dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value=
a[1];dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value=a[2];this.viewNewColor(b);this.viewSubColor(b)}}},modifyHslValue:function(a){dzeColorPallet.showCrossColorSelector("white");a.value=a.value.replace(/[^0-9]/g,"");if(""!=a.value){var b=parseInt(a.value,10);if(0>b)alert(ID_RES_DIALOG_ALERT_MIN_VALUE+"0"),a.value="";else if(360<b)alert(ID_RES_DIALOG_ALERT_MAX_VALUE+"360"),a.value="";else{a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value;b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value;
var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value;a=this.hsl2rgb(a,b,d);b=this.getDecToHex(a.r)+this.getDecToHex(a.g)+this.getDecToHex(a.b);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b.toUpperCase();dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value=a.r;dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value=a.g;dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value=a.b;this.viewNewColor(b);this.viewSubColor(b)}}},
viewOrgColor:function(a){a=this.checkHexCode(a);6==a.length&&(dzeColorPallet.layerDoc.getElementById("dze_idx_old_color").style.backgroundColor="#"+a,dzeColorPallet.layerDoc.getElementById("dze_idx_old_color").title="#"+a.toUpperCase())},viewNewColor:function(a){dlog("======  viewNewColor START ======");dlog("viewNewColor htmlCode : "+a);dzeColorPallet.layerDoc.getElementById("dze_idx_new_color").style.backgroundColor="#"+a;dzeColorPallet.layerDoc.getElementById("dze_idx_new_color").title="#"+a.toUpperCase();
dlog("======  viewNewColor END ======");dlog("")},getColorCode:function(a){"undefined"==typeof a&&(a="hex");"hex"!=a&&"rgb"!=a&&"hsl"!=a&&(a="hex");var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value;b=this.checkHexCode(b);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b;if(6!=b.length)return"";this.addRecentColorSet(b);if("hex"==a)return"#"+b;if("rgb"==a)return a=this.getHexToDec(b),[a.R_val,a.G_val,a.B_val];if("hsl"==a)return a=this.getHexToDec(b),this.rgbToHsl(a.R_val,
a.G_val,a.B_val)},getDecToHex:function(a){a=parseInt(a,10);255<a&&(a=255);a=a.toString(16);1==a.length&&(a="0"+a);return a.toString()},getHexToDec:function(a){var b=parseInt(a.substring(0,2),16),d=parseInt(a.substring(2,4),16);a=parseInt(a.substring(4,6),16);return result={R_val:b,G_val:d,B_val:a}},rgbToHsl:function(a,b,d){a/=255;b/=255;d/=255;var c=Math.max(a,b,d),e=Math.min(a,b,d),f=(c+e)/2;if(c==e)var g=e=0;else{var h=c-e;e=.5<f?h/(2-c-e):h/(c+e);switch(c){case a:g=(b-d)/h;break;case b:g=2+(d-
a)/h;break;case d:g=4+(a-b)/h}g*=60;0>g&&(g+=360)}g=Math.round(g);e=Math.round(100*e);f=Math.round(100*f);return[g,e,f]},hsl2rgb:function(a,b,d){isFinite(a)||(a=0);isFinite(b)||(b=0);isFinite(d)||(d=0);a/=60;0>a&&(a=6- -a%6);a%=6;b=Math.max(0,Math.min(1,b/100));d=Math.max(0,Math.min(1,d/100));var c=(1-Math.abs(2*d-1))*b;var e=c*(1-Math.abs(a%2-1));1>a?(a=c,b=e,e=0):2>a?(a=e,b=c,e=0):3>a?(a=0,b=c):4>a?(a=0,b=e,e=c):5>a?(a=e,b=0,e=c):(a=c,b=0);d-=c/2;a=Math.round(255*(a+d));b=Math.round(255*(b+d));
e=Math.round(255*(e+d));return{r:a,g:b,b:e}},colorSelectorImageMargin:9,showColorSelector:function(a){dlog("====== showColorSelector ======");var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").getBoundingClientRect(),d=a.clientX-b.left;a=a.clientY-b.top;d-=this.colorSelectorImageMargin;a-=this.colorSelectorImageMargin;d<-this.colorSelectorImageMargin+1&&(d=-this.colorSelectorImageMargin+1);a<-this.colorSelectorImageMargin+1&&(a=-this.colorSelectorImageMargin+1);d>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetWidth-
this.colorSelectorImageMargin-2&&(d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetWidth-this.colorSelectorImageMargin-2);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetHeight-this.colorSelectorImageMargin-2&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetHeight-this.colorSelectorImageMargin-2);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.left=d+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.top=
a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.display="block";dlog("selectorX:"+d);dlog("selectorY:"+a);dlog("")},getColorCodeFromSelector:function(){var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.left.replace(/px/gi,""),10),b=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.top.replace(/px/gi,""),10);a=Math.floor(Math.floor(a+this.colorSelectorImageMargin)/
this.color_pix);b=Math.floor(Math.floor(b+this.colorSelectorImageMargin)/this.color_pix);dlog("colNum:"+a);dlog("rowNum:"+b);dlog();b=this.colorset[b][a];dlog("htmlCode:"+b);return b},showCrossColorSelector:function(a){a="dze_color_pallet_table_selector_"+a;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").className=a;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.display="block"},subColorSelectorImageMargin:6,showSubColorSelector:function(a){dlog("====== showSubColorSelector START ======");
if("undefined"==typeof a)dlog("event nothing");else{var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").getBoundingClientRect();a=a.clientY-b.top;a-=this.subColorSelectorImageMargin;a<-this.subColorSelectorImageMargin+2&&(a=-this.subColorSelectorImageMargin+2);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").offsetHeight-this.subColorSelectorImageMargin-2&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").offsetHeight-
this.subColorSelectorImageMargin-2);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.top=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.display="block";dlog("====== showSubColorSelector END ======");dlog("")}},getSubColorCodeFromSelector:function(){var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.top.replace(/px/gi,""),10);dlog("getSubColorCodeFromSelector");
dlog("selectorY:"+a);a=Math.floor(Math.floor(a+7)/this.subColorPix);dlog("rowNum:"+a);a=this.subColorSet[a];dlog("htmlCode:"+a);return a},achromaticSelectorImageMargin:4,showAchromaticSelector:function(a){dlog("====== showAchromaticSelector START ======");if("undefined"!=typeof a){var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").getBoundingClientRect();a=a.clientX-b.left;a-=this.achromaticSelectorImageMargin;0>a&&(a=0);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").offsetWidth-
2*this.achromaticSelectorImageMargin&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").offsetWidth-2*this.achromaticSelectorImageMargin);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.left=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.display="block";dlog("====== showAchromaticSelector END ======");dlog("")}},getAchromaticColorCodeFromSelector:function(){dlog("getAchromaticColorCodeFromSelector START");
var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.left.replace(/px/gi,""),10);a=Math.floor(a+7);dlog("selectorCenterX:"+a);dlog("(selectorCenterX/4):"+a/4);a=Math.floor(a/this.achromaticColorPix);dlog();a=this.achromaticSet[a];dlog("htmlCode:"+a);dlog("getAchromaticColorCodeFromSelector END");return a}};

var ID_TB_QUERY_STATUS_BUTTON=1,ID_TB_QUERY_STATUS_COMBOBOX=2,ID_TB_QUERY_STATUS_DROPDOWN=3,g_objEditSetContainer=[],g_TBContainer=[],g_TBContainerTool=[],g_TBButton=[],g_TBComboBox=[],g_TBComboBoxLabel=[],g_TBDropDown=[],g_bMouseDown_containerBottomResize=!1,g_nContainerBottomResize_EditNumber=null,g_nContainerBottomResize_Start_Y=null,g_nContainerBottomResize_Start_Height=null,g_arrForceCancelBubbleMouseDown=[];
function TBContainerEvent(a){TBCancelBubbleEvent(a);g_objLayerEventUtil.initHideDynamicLayer()}function initEditSetContainer(a,c){g_objEditSetContainer[c]=a}
function TBInitContainer(a){g_TBContainer[g_TBContainer.length]=a;a.onmouseover=TBCancelBubbleEvent;a.onmouseout=TBCancelBubbleEvent;a.onmouseup=TBCancelBubbleEvent;a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBContainerEvent;a.onmousedown=function(a){var b=a.target||a.srcElement,c=document.activeElement;if(!b||"INPUT"!==b.nodeName||b.hasAttribute("readonly"))c&&"INPUT"===c.nodeName&&c.blur(),TBCancelBubbleEvent(a)};window.attachEvent?
a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1)}function TBInitContainerTool(a){g_TBContainerTool[g_TBContainerTool.length]=a;window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1)}
function QueryStatusItem(a,c,b,d,e,f){this.element=c;this.element.command=a;this.button_type=b;this.command_id=d;this.support_type=e;this.support_control_type=f;this.element.command_id=d;return this}
function TBButtonMouseOver(a,c,b,d,e){try{e&&TBCancelBubbleEvent(a);var f=null;a=null;if(ID_TB_QUERY_STATUS_BUTTON==b)f=g_TBButton[d][c].element;else if(ID_TB_QUERY_STATUS_COMBOBOX==b)f=g_TBComboBox[d][c].element;else if(ID_TB_QUERY_STATUS_DROPDOWN==b)f=g_TBDropDown[d][c].element,a=g_TBDropDown[d][c].objSubElement;else return;f.TBSTATE!=ID_STRING_NAME_GRAY&&(f.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==
b?f.className=g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaUp+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaUp,a.className=g_strSkin_DropDown_AreaArrowUp):f.TBSTATE==ID_STRING_NAME_UNCHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon",a.onmouseover=function(a){f.TBSTATE!=ID_STRING_NAME_GRAY&&(!0===dzeUiConfig.bUseUiMode&&0<=this.className.indexOf("_ribbon")?(this.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon",f.className=g_strSkin_DropDown_Area+"_ribbon"):(this.className=g_strSkin_DropDown_AreaArrowOver,
f.className=g_strSkin_DropDown_Area),TBCancelBubbleEvent(a))}):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaOver:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver,a.className=g_strSkin_DropDown_AreaArrowOver,a.onmouseover=function(a){f.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className=g_strSkin_DropDown_AreaArrowOver,f.className=g_strSkin_DropDown_Area,TBCancelBubbleEvent(a))}):!0===dzeUiConfig.bUseUiMode&&
"ribbon"==dze_menu_control.ui_mode&&0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaOver:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver,a.className=
g_strSkin_DropDown_AreaArrowOver))}catch(h){dalert(h)}}
function TBButtonMouseOut(a,c,b,d,e){try{e&&TBCancelBubbleEvent(a),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up+
"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==
b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon",e.className=g_strSkin_DropDown_AreaArrow+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area,e.className=g_strSkin_DropDown_AreaArrow))}catch(f){dalert(f)}}
function TBButtonMouseDown(a,c,b,d,e){try{e&&(TBCancelBubbleEvent(a),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[d]=!0)),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Down+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaDown+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowDown+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Down:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaDown:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaDown,e.className=g_strSkin_DropDown_AreaArrowDown))}catch(f){dalert(f)}}
function TBButtonMouseUp(a,c,b,d,e){try{e&&(TBCancelBubbleEvent(a),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[d]=!1)),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b&&(a.className=g_strSkin_Button_Up+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==
b&&(a.className=g_strSkin_DropDown_AreaOver+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaOver,e.className=g_strSkin_DropDown_AreaArrowUp))}catch(f){dalert(f)}}
function TBInitButton(a,c,b){try{var d=g_arrConst[a][0],e=document.getElementById(g_arrConst[a][2]+"_"+b);if(null!=e){var f=g_arrConst[a][3],h=g_arrConst[a][4],k=g_arrConst[a][5],g=0;if(ID_TB_QUERY_STATUS_BUTTON==c)g_TBButton[b][g_TBButton[b].length]=new QueryStatusItem(d,e,c,a,h,k),g=g_TBButton[b].length-1,e.className=g_strSkin_Button;else if(ID_TB_QUERY_STATUS_COMBOBOX==c){g_TBComboBox[b][g_TBComboBox[b].length]=new QueryStatusItem(d,e,c,a,h,k);g=g_TBComboBox[b].length-1;e.className=g_strSkin_ComboBox_Area;
var l=e.id;g_TBComboBoxLabel[b][g_TBComboBoxLabel[b].length]=new QueryStatusItem("",document.getElementById(l+"_LABEL"),0,-1,-1,-1);var m=g_TBComboBoxLabel[b].length-1;g_objComboBoxWin.setupComboBoxLabel(g_TBComboBoxLabel[b][m].element,a);g_objComboBoxWin.initComboBoxInput(b,e,g_TBComboBoxLabel[b][m].element,a)}else ID_TB_QUERY_STATUS_DROPDOWN==c&&(g_TBDropDown[b][g_TBDropDown[b].length]=new QueryStatusItem(d,e,c,a,h,k),g=g_TBDropDown[b].length-1,e.className=g_strSkin_DropDown_Area,l=e.id,g_TBDropDown[b][g].objSubElement=
document.getElementById(l+"_SUB"),g_TBDropDown[b][g].objSubElement.onclick=function(a){g_objComboBoxWin.forceBlurInput();eval(f+"_Detail")(a,this,b)});e.onmouseover=function(a){TBButtonMouseOver(a,g,c,b,!0)};e.onmouseout=function(a){TBButtonMouseOut(a,g,c,b,!0)};e.onmousedown=function(a){TBButtonMouseDown(a,g,c,b,!0)};e.onmouseup=function(a){TBButtonMouseUp(a,g,c,b,!0)};e.ondragstart=TBCancelBubbleEvent;e.onselectstart=TBCancelBubbleEvent;e.onselect=TBCancelBubbleEvent;e.commandtype=ID_COMMAND_TYPE_TOOL;
e.onclick=function(a){g_objComboBoxWin.forceBlurInput();eval(f)(a,this,b)};e.TBSTATE==ID_STRING_NAME_GRAY?g_objPropertyUtil.setFilterOpacityStyle(e,!0):e.TBSTATE=ID_STRING_NAME_UNCHECKED}}catch(n){}}
function TBSetState(a,c,b){try{if(null!=a)switch(c=c.toLowerCase(),a.className){case g_strSkin_Button:case g_strSkin_Button_Over:case g_strSkin_Button_Down:case g_strSkin_Button_Up:case g_strSkin_ComboBox_Area:case g_strSkin_ComboBox_AreaOver:case g_strSkin_ComboBox_AreaDown:case g_strSkin_ComboBox_AreaUp:case g_strSkin_DropDown_Area:case g_strSkin_DropDown_AreaOver:case g_strSkin_DropDown_AreaDown:case g_strSkin_DropDown_AreaUp:case g_strSkin_DropDown_Area+"_ribbon":case g_strSkin_DropDown_AreaOver+
"_ribbon":case g_strSkin_DropDown_AreaDown+"_ribbon":case g_strSkin_DropDown_AreaUp+"_ribbon":case g_strSkin_Button+"_ribbon":case g_strSkin_Button_Over+"_ribbon":case g_strSkin_Button_Down+"_ribbon":case g_strSkin_Button_Up+"_ribbon":if(c==ID_STRING_NAME_GRAY||c==ID_STRING_NAME_CHECKED||c==ID_STRING_NAME_UNCHECKED){var d=a.TBSTATE;c!=d&&(c==ID_STRING_NAME_CHECKED?(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=
g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp),d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):c==ID_STRING_NAME_UNCHECKED?(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area),d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):c==ID_STRING_NAME_GRAY&&(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area),g_objPropertyUtil.setFilterOpacityStyle(a,!0)),a.TBSTATE=c)}}}catch(e){}}
function TBSetState_DropDown_Parent(a,c,b){try{var d=g_objNodeUtil.getParentElement(a),e=g_objNodeUtil.getLoopParentElement(d,"div");null!=e&&TBSetState(e,c,b)}catch(f){}}
function TBSetToolButton(a,c){try{for(var b=0;b<a.length;b++){var d=a[b][0];if(ID_TYPE_TOOLBAR_HANDLE!=d&&ID_TYPE_TOOLBAR_SEPARATOR!=d&&ID_TYPE_TOOLBAR_SPACE!=d&&ID_TYPE_TOOLBAR_CAPTION!=d){var e=g_arrConst[d][6];TBInitButton(d,e,c);ID_TB_QUERY_STATUS_BUTTON==e?handlerUI.setCommandUpdateIndex(c,d,g_TBButton[c].length-1):ID_TB_QUERY_STATUS_COMBOBOX==e?handlerUI.setCommandUpdateIndex(c,d,g_TBComboBox[c].length-1):ID_TB_QUERY_STATUS_DROPDOWN==e&&handlerUI.setCommandUpdateIndex(c,d,g_TBDropDown[c].length-
1)}}}catch(f){}}function TBInitContainerBottomResize(a,c){try{if(g_bBottomResizeYN)if(window.attachEvent){var b=eval("onmousedown_containerBottomResize_"+c);a.attachEvent("onmousedown",b)}else b=eval("onmousedown_containerBottomResize_"+c),a.addEventListener("mousedown",b,!1)}catch(d){}}
function onmousedown_containerBottomResize(a,c){try{if(!g_bFullScreenMode&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_bBottomResizeYN)){g_objTransparentViewUtil.showTransparentView(!0,1);g_bMouseDown_containerBottomResize=!0;g_nContainerBottomResize_EditNumber=c;var b=g_objPositionUtil.getDocumentScrollPosition(!1).nScrollTop;g_nContainerBottomResize_Start_Y=a.clientY+b;g_nContainerBottomResize_Start_Height=g_arrEditorHeight[c];window.attachEvent?
(document.attachEvent("onmousemove",onmousemove_containerBottomResize),document.attachEvent("onmouseup",onmouseup_containerBottomResize)):(document.addEventListener("mousemove",onmousemove_containerBottomResize,!1),document.addEventListener("mouseup",onmouseup_containerBottomResize,!1))}}catch(d){window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",onmousemove_containerBottomResize,
!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1))}}
function onmousemove_containerBottomResize(a){try{if(!g_bFullScreenMode&&g_bBottomResizeYN&&g_bMouseDown_containerBottomResize){TBCancelBubbleEvent(a);var c=g_objPositionUtil.getDocumentScrollPosition(!1).nScrollTop,b=g_nContainerBottomResize_Start_Height+(a.clientY+c-g_nContainerBottomResize_Start_Y);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(g_nContainerBottomResize_EditNumber,b):resizeEditor_Height(g_nContainerBottomResize_EditNumber,b)}}catch(d){window.detachEvent?
(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",onmousemove_containerBottomResize,!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1))}}
function onmouseup_containerBottomResize(a){try{!g_bFullScreenMode&&g_bBottomResizeYN&&g_bMouseDown_containerBottomResize&&(g_bMouseDown_containerBottomResize=!1,g_nContainerBottomResize_Start_Height=g_nContainerBottomResize_Start_Y=g_nContainerBottomResize_EditNumber=null,g_objTransparentViewUtil.showTransparentView(!1,null),window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",
onmousemove_containerBottomResize,!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1)))}catch(c){}}var bottomResizeBtnIntervals=null,resizeBodyStyleInfo=null;
function TBInitContainerBottomResizeBtn(a,c){try{if(dzeUiConfig.bCustomBottomResizeBtnYN&&dzeUiConfig.bCustomize_TabBar_Display){var b=a.childNodes[0],d=a.childNodes[1];d.onmouseover=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals()};d.onmousedown=function(a){(a?a:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(this.className="duzon_spinner_btn_arrow_over",bottomResizeBtnIntervals=setInterval(function(){resizeBottomResizeGuideLine("increase",c)},7))};
d.onmouseup=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals();var a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c);a&&(a=a.offsetHeight,removeBottomResizeGuideLineObj(c),a=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetHeight+a,!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(c,a):resizeEditor_Height(c,a));g_objLayerKit.getLayerDocument().body.style.overflow="";null!=resizeBodyStyleInfo&&
(g_objLayerKit.getLayerDocument().body.style.overflow=resizeBodyStyleInfo)};d.onmouseout=function(){this.className="duzon_spinner_btn_arrow_up";clearBottomResizeBtnIntervals();removeBottomResizeGuideLineObj(c);g_objLayerKit.getLayerDocument().body.style.overflow="";null!=resizeBodyStyleInfo&&(g_objLayerKit.getLayerDocument().body.style.overflow=resizeBodyStyleInfo)};b.onmouseover=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals()};b.onmousedown=function(a){(a?
a:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(this.className="duzon_spinner_btn_arrow_over",bottomResizeBtnIntervals=setInterval(function(){resizeBottomResizeGuideLine("decrease",c)},7))};b.onmouseup=function(){this.className="duzon_spinner_btn_arrow_over";clearBottomResizeBtnIntervals();var a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c);if(a){var b=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));a=parseInt(a.style.top.replace(/px/,
""),10)-b.bottom;a=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetHeight+a;200>a&&(a=200);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(c,a):resizeEditor_Height(c,a);removeBottomResizeGuideLineObj(c)}};b.onmouseout=function(){this.className="duzon_spinner_btn_arrow_up";clearBottomResizeBtnIntervals();removeBottomResizeGuideLineObj(c)}}}catch(e){dalert(e)}}
function clearBottomResizeBtnIntervals(){try{bottomResizeBtnIntervals&&clearInterval(bottomResizeBtnIntervals),bottomResizeBtnIntervals=null}catch(a){dalert(a)}}
function resizeBottomResizeGuideLine(a,c){try{var b=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideValue_"+c),d=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c),e=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));if(null==d){d=g_objLayerKit.getLayerDocument().createElement("div");d.id="dzeIdxBottomResizeGuideLine_"+c;d.className="dze_bottom_resize_guideline";d.style.width=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetWidth-
2+"px";d.style.height="0px";g_objLayerKit.getLayerDocument().body.appendChild(d);d.style.left=e.left+"px";d.style.top=e.bottom+"px";var f=duzon_dialog.getActiveDialogWindowSize(),h=!1;g_objLayerKit.getLayerDocument().body.scrollHeight>f.view_window_height&&(h=!0);"increase"==a&&0==h&&(g_objLayerKit.getLayerDocument().body.style.overflow&&(resizeBodyStyleInfo=g_objLayerKit.getLayerDocument().body.style.overflow),g_objLayerKit.getLayerDocument().body.style.overflow="hidden");b=g_objLayerKit.getLayerDocument().createElement("div");
b.id="dzeIdxBottomResizeGuideValue_"+c;b.className="dze_bottom_resize_guidevalue";g_objLayerKit.getLayerDocument().body.appendChild(b);var k=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+c).parentNode.parentNode);b.style.left=k.left-b.offsetWidth+12+"px";b.style.top=k.top-23+"px"}if("increase"==a)d.style.height=d.offsetHeight+1+"px",b.style.color="blue",b.innerText="+"+d.style.height;else if("decrease"==a){d.style.borderWidth="1px 1px 0 1px";
d.style.height="0px";var g=parseInt(d.style.top.replace(/px/,""),10)-1,l=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+c));g<l.top+100&&(g=l.top+100);d.style.top=g+"px";e=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));var m=parseInt(d.style.top.replace(/px/,""),10)-e.bottom;b.style.color="red";b.innerText=m+"px"}}catch(n){dalert(n)}}
function removeBottomResizeGuideLineObj(a){var c=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+a);null!=c&&c.parentNode.removeChild(c);a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideValue_"+a);null!=a&&a.parentNode.removeChild(a)};

var ID_TB_TABMODE_PREVIEW=0,ID_TB_TABMODE_EDIT=1,ID_TB_TABMODE_SOURCE=2,g_bEditMode=[],g_TBTabMode=[];function QueryStatusTabModeItem(b,a,d){this.element=b;this.element.TBSTATE=a;this.nTabModeID=d;return this}function TBTabModeButtonMouseOver(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_AreaOver)}catch(f){}}
function TBTabModeButtonMouseOut(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area)}catch(f){}}
function TBTabModeButtonMouseDown(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.TBSTATE==ID_STRING_NAME_CHECKED?e.className=g_strSkin_TabMode_AreaUp:e.TBSTATE==ID_STRING_NAME_UNCHECKED?(e.className=g_strSkin_TabMode_AreaDown,g_objLayerEventUtil.forceBlurInput(),g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer()):e.className=g_strSkin_TabMode_AreaDown)}catch(f){}}
function TBTabModeButtonMouseUp(b,a,d,c){try{c&&TBCancelBubbleEvent(b);var e=g_TBTabMode[d][a].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area)}catch(f){}}
function TBInitTabModeButton(b,a,d,c){try{g_TBTabMode[c][g_TBTabMode[c].length]=new QueryStatusTabModeItem(b,d,a);var e=g_TBTabMode[c].length-1;b.onmouseover=function(a){TBTabModeButtonMouseOver(a,e,c,!0)};b.onmouseout=function(a){TBTabModeButtonMouseOut(a,e,c,!0)};b.onmousedown=function(a){TBTabModeButtonMouseDown(a,e,c,!0)};b.onmouseup=function(a){TBTabModeButtonMouseUp(a,e,c,!0)};b.ondragstart=TBCancelBubbleEvent;b.onselectstart=TBCancelBubbleEvent;b.onselect=TBCancelBubbleEvent;var f=g_arrConst_TabMode[a][1];
b.onclick=function(b){eval(f)(b,this,a,c)};b.className=d==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area;b.TBSTATE==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!0)}catch(g){}}
function TBTabModeSetState(b,a){try{switch(a=a.toLowerCase(),b.className){case g_strSkin_TabMode_Area:case g_strSkin_TabMode_AreaOver:case g_strSkin_TabMode_AreaDown:case g_strSkin_TabMode_AreaUp:if(a==ID_STRING_NAME_GRAY||a==ID_STRING_NAME_CHECKED||a==ID_STRING_NAME_UNCHECKED){var d=b.TBSTATE;a!=d&&(a==ID_STRING_NAME_CHECKED?(b.className=g_strSkin_TabMode_AreaUp,d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_UNCHECKED?(b.className=g_strSkin_TabMode_Area,
d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_GRAY&&(b.className=g_strSkin_TabMode_Area,g_objPropertyUtil.setFilterOpacityStyle(b,!0)),b.TBSTATE=a)}}}catch(c){}}
function fnTool_TabMode(b,a,d,c){TBCancelBubbleEvent(b);if(ID_STRING_NAME_CHECKED!=a.TBSTATE){!0===dzeUiConfig.bApplyPasteStyleMode&&(dzeCopyPasteStyleInfo.unsetPasteStyleModeEditArea(c),dzeCopyPasteStyleInfo.unsetPasteStyleMode(c));fnTool_TabMode_Main(d,c);try{g_bBrowserType_FF&&""!=g_strFocusEventFunction&&d==ID_TB_TABMODE_SOURCE&&eval(g_strFocusEventFunction+"("+c+", 0);")}catch(e){}}}
function fnTool_TabMode_Main(b,a){try{if(dlog("fnTool_TabMode_Main START"),dlog("nTabModeID:"+b),dlog("nEditNumber:"+a),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),2==g_nFormEditMode&&b==ID_TB_TABMODE_SOURCE)fnUserWarningMessage(ID_USER_WARNING_MSG_NO_SOURCE_EDIT);else for(var d=0;d<g_TBTabMode[a].length;d++)if(ID_TB_TABMODE_EDIT==g_TBTabMode[a][d].nTabModeID||ID_TB_TABMODE_SOURCE==g_TBTabMode[a][d].nTabModeID)b==g_TBTabMode[a][d].nTabModeID?(TBTabModeSetState(g_TBTabMode[a][d].element,ID_STRING_NAME_CHECKED),
fnTool_ChangeMode(b,a,!1)):TBTabModeSetState(g_TBTabMode[a][d].element,ID_STRING_NAME_UNCHECKED)}catch(c){dalert(c)}}
function fnTool_ChangeMode(b,a,d){setSelectionObjectInfo(!1,null,null);if(b==ID_TB_TABMODE_EDIT){if(!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]||!g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE])return;g_bEditMode[a]=!0;g_objEditContainer[a].style.visibility="visible";g_objEditContainer[a].style.display="";if(g_bBrowserType_IE)g_objEditSourceContainer[a].style.visibility="hidden",g_objEditSourceContainer[a].style.display="none";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditSourceContainer[a].style.position=
"absolute",g_objEditSourceContainer[a].style.left="-1000px",g_objEditSourceContainer[a].style.top="-1000px",g_objEditSourceContainer[a].style.width="0px",g_objEditSourceContainer[a].style.height="0px",g_objEditSourceContainer[a].style.visibility="hidden";!0===dzeUiConfig.bRemoveXSS&&(g_objEditObjectSource[a].value=removeXSS(g_objEditObjectSource[a].value));var c=g_objEditorDocument[a].body.innerHTML,e=g_objEditObjectSource[a].value;if(!d){var f=!0;if(!g_bSourceAreaScriptAllowYN){var g=e.toLowerCase().indexOf("<script",
0);-1!=g&&(f=!1,fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=c)}g_bSourceAreaIframeAllowYN||(g=e.toLowerCase().indexOf("<iframe",0),-1!=g&&(f=!1,fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=c));f&&(g_objEditorDocument[a].body.innerHTML=g_objEditObjectSource[a].value)}if(g_bBrowserType_IE)d||(!g_bSourceAreaScriptAllowYN&&3!=g_nFormEditMode&&0<g_objEditorDocument[a].scripts.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),
g_objEditorDocument[a].body.innerHTML=c),g_bSourceAreaIframeAllowYN||(e=g_objEditorDocument[a].getElementsByTagName("iframe"),0<e.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=c)),g_objEditWindow[a].focus()),g_objTagUtil.force_formTagSwitch(a),editor_onselectionchange(a),g_objMenuWin.TBMenuSetStateAllEnable(!0,a);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)!g_bSourceAreaScriptAllowYN&&0<g_objEditorDocument[a].body.querySelectorAll("script").length&&
(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=c),g_bSourceAreaIframeAllowYN||(e=g_objEditorDocument[a].body.querySelectorAll("iframe"),0<e.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=c)),g_bBrowserType_FF?3!=g_nFormEditMode&&(setInitEnterCode(g_objEditorDocument[a].body,a),window.setTimeout("setRestoreEditWinFF("+a+")",100)):g_bBrowserType_WK?3!=g_nFormEditMode&&(setInitEnterCode(g_objEditorDocument[a].body,
a),window.setTimeout("setEditModeFocus("+a+")",100)):g_bBrowserType_OP&&window.setTimeout("setEditModeFocus("+a+")",100);tranAllAnchorHrefSharp(a);g_objEditMode.showAllWriteAreaSet(a,!0);g_objAdjustDoc.removeEqualDuplicatedDiv(g_objEditorDocument[a].body);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(a);g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(a);g_objAdjustDoc.changeTableAlignToMarginStyle(a);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtMouseUpShowDynamicMenu();
g_objEditMode.setZeroSpaceCodeToEmptyTd(a);g_objEditMode.convertFormCodeString(a,!1);g_objCaretUtil.removeAllCaretMarker(g_objEditorDocument[a].body);g_objTableSelection.removeAllCellSelection(g_objEditorDocument[a].body);g_objTableUtil.removeAllDzeTable(g_objEditorDocument[a].body);fnTool_ChangeModeForBind(a,b);removeAllDarkReaderAttr(g_objEditorDocument[a].body);adjustAmaranthLink(g_objEditorDocument[a].body);g_objEditObjectSource[a].value!==g_objEditObjectSource[a]._initValue&&g_objUndoRedo.registerUndoRedoStack(0,
a);editor_onselectionchange(a)}else if(b==ID_TB_TABMODE_SOURCE){if(!g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]||!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT])return;g_objTableMiniMenu.showTableMiniMenu(!1);g_objPasteOptionMenu.remove(!1);g_objInputFormatEvent.forceBlurInput(a);g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1);insertSourceSelectionSyncChars(a);tranAllAnchorHrefSharp(a);g_bEditMode[a]=!1;g_objEditContainer[a].style.visibility="hidden";g_objEditContainer[a].style.display="none";if(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)g_objEditSourceContainer[a].style.position="relative",g_objEditSourceContainer[a].style.left="",g_objEditSourceContainer[a].style.top="",g_objEditSourceContainer[a].style.width="",g_objEditSourceContainer[a].style.height="";g_objEditSourceContainer[a].style.visibility="visible";g_objEditSourceContainer[a].style.display="";disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=!0===dzeUiConfig.bUseUiMode&&
"ribbon"==dze_menu_control.ui_mode?g_arrEditorHeight[a]-document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a).offsetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-25+"px":g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-25+"px");g_objEditMode.showAllWriteAreaSet(a,!1);g_bContentPTagStyleApply&&g_objAdjustDoc.setParaInlineStyle(a,g_objEditorDocument[a].body,!0);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(a);g_objAdjustDoc.adjustRemoveGarbageText(a);
g_objAdjustDoc.adjustGarbageEmptyTag(a,!1);g_objAdjustDoc.adjustDuplicateGarbage_P_Node(a);g_objAdjustDoc.remove_Br_Node_Inside_P_Node(a);g_objAdjustDoc.arrangeSpan(g_objEditorDocument[a].body);g_objEditMode.restoreFormCodeString(a);g_objTagUtil.updateCurFormTagAttr(a);g_objCaretUtil.removeAllCaretMarker(g_objEditorDocument[a].body);g_objTableSelection.removeAllCellSelection(g_objEditorDocument[a].body);g_objTableUtil.removeAllDzeTable(g_objEditorDocument[a].body);g_objCopyPaste.removeAllCaptureDiv(g_objEditorDocument[a].body);
fnTool_ChangeModeForBind(a,b);removeAllDarkReaderAttr(g_objEditorDocument[a].body);b=removeZeroWidthSpace(g_objEditorDocument[a].body.innerHTML);!0===dzeUiConfig.bRemoveZeroWidthSpace&&(b=removeZeroWidthSpaceFromString(b));!0===dzeUiConfig.bRemoveXSS&&(b=removeXSS(b));g_objEditorDocument[a].body.innerHTML=b;b=getHTMLContentCodeByXHTMLFormat(a);g_bSourceAreaIframeAllowYN&&setIFrameSrcBlankForTabMode(a);g_objEditObjectSource[a].value=b;g_objEditObjectSource[a]._initValue=g_objEditObjectSource[a].value;
g_objEditObjectSource[a].focus();syncSourceSelection(a)}try{d||""!=g_strTabModeEventFunction&&eval(g_strTabModeEventFunction+"("+a+");")}catch(h){}}function setEditModeFocus(b){try{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[b].body.focus(),g_objCaretUtil.moveCaret(g_objEditorDocument[b].body),editor_onselectionchange(b),g_objMenuWin.TBMenuSetStateAllEnable(!0,b)}catch(a){dalert(a)}}
function fnTool_TabMode_Preview(b,a,d,c){g_nActiveEditNumber=c;TBCancelBubbleEvent(b);g_objTableFlag.ResetTableInfo(!1);!0===dzeUiConfig.bApplyPasteStyleMode&&(dzeCopyPasteStyleInfo.unsetPasteStyleModeEditArea(c),dzeCopyPasteStyleInfo.unsetPasteStyleMode(c));""!=g_strPreviewCallFunction?eval(g_strPreviewCallFunction+";"):(a=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+c),b=a.offsetWidth-2,a=a.offsetHeight+200,700<a&&(a=700),g_objCommonUtil.openWindowCommon(dzeEnvConfig.strPreviewPageURL,b,
a,!0,""));updateTableHandlerUI.updateTableUIHandler(0,0,0,0,c)}
function getEditorPreviewHTML(b){try{var a="";g_bAutoIncludeParentCSS&&(a+=getParentCSS());for(var d=0;d<g_arrAdditionalEditAreaCSS.length;d++)a+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[d]+"'>";a=g_bAutoIncludeParentCSS?a+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"editor_style_inherit.css'>"):a+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"editor_style.css'>");a+="<style>";""!=g_strBodyFontFamily&&(a+="body, td, th {font-family:"+g_strBodyFontFamily+
"}");""!=g_strBodyFontSize&&(a+="body, td, th {font-size:"+g_strBodyFontSize+"}");""!=g_strBodyFontColor&&(a+="body, td, th {color:"+g_strBodyFontColor+"}");""!=g_strBodyLineHeight&&(a+="body, td, th {line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(a+="body, td, th {letter-spacing:"+g_strBodyLetterSpacing+"}");a+="</style>";a+=getEditorHTMLCode(!1,b);a=removeEditorTempTagsFromStrHtml(a);return a=a.replace(/\b\b/g,"")}catch(c){}return""}
function getEditorTagCount_script(b){try{return window.attachEvent?g_objEditorDocument[b].scripts.length:g_objEditorDocument[b].getElementsByTagName("script").length}catch(a){}return-1}function getEditorTagCount_iframe(b){try{return g_objEditorDocument[b].getElementsByTagName("iframe").length}catch(a){}return-1};

var ID_COMMAND_TYPE_TOOL=1,ID_COMMAND_TYPE_MENU=2,ID_COMMAND_TYPE_CONTEXT_MENU=3,ID_STRING_NAME_CONTROL="control",ID_STRING_NAME_GRAY="gray",ID_STRING_NAME_UNCHECKED="unchecked",ID_STRING_NAME_CHECKED="checked",ID_STRING_NAME_HIDE="hide",ID_STRING_NAME_UNDEFINED="undefined",ID_STRING_NAME_NONE="none",ID_STRING_NAME_TEXT="text";function fnHandler_dummy(c,b,a){}
function fnHandler_CommonCheck_DynamicLayer_1(c,b,a){try{TBCancelBubbleEvent(c);if(b&&b.TBSTATE==ID_STRING_NAME_GRAY)return!1;if(b&&ID_COMMAND_TYPE_TOOL==b.commandtype){if(g_bDynamicLayer){var d=g_objContextMenuWin.isShow();g_objLayerEventUtil.initHideDynamicLayer();if(!d)return!1}}else g_objLayerEventUtil.initHideDynamicLayer();return!0}catch(e){}return!1}
function fnHandler_SupportCommand(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command;"selectall"==d.toLowerCase()?ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype?GetCurTable(a)&&(g_objTableSelection.selectTable(a),editor_onselectionchange(a)):fnHandler_SupportCommand_Main(a,d):fnHandler_SupportCommand_Main(a,d)}}catch(e){}}
function fnHandler_SupportCommand_Main(c,b){try{if(""!=b){var a=b.toLowerCase();if(GetMultiCellSelection(c))"copy"==b.toLowerCase()?dzeClipBoard.copySelectedMultiCells(c):"cut"==b.toLowerCase()?dzeClipBoard.cutSelectedMultiCells(c):g_objTableMultiCell.setMultiCellCommand_ExecCommand(b,c);else{"copy"==b.toLowerCase()&&dzeClipBoard.initialize();if(ID_STRING_COMMAND_UNLINK==b)(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&g_objNodeUtil.getSelectionElement_Anchor("A",!0,c),g_objEditorDocument[c].execCommand(b,
!1,null);else try{if("delete"==b.toLowerCase()&&checkSetIFrameSrcBlankForDelete(c),"inserthorizontalrule"==b.toLowerCase())g_objEditorDocument[c].execCommand(b,!1,null);else if("paste"==b.toLowerCase())if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var d=dzeClipBoard.paste(c);!0===d?TBCancelBubbleEvent:alert(ID_RES_USER_MSG_STRING_ALERT_PASTE)}else d=dzeClipBoard.paste(c),!0===d?TBCancelBubbleEvent:(dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteClick(c),g_objEditorDocument[c].execCommand(b,
!1,null));else"insertorderedlist"===a&&toggleOL(c)?g_objUndoRedo.registerUndoRedoStack(0,c):"insertunorderedlist"===a&&toggleUL(c)?g_objUndoRedo.registerUndoRedoStack(0,c):"bold"!==a&&"italic"!==a&&"underline"!==a&&"strikethrough"!==a&&"subscript"!==a&&"superscript"!==a||!g_objTextFormat.checkUse(c)?(g_objEditorDocument[c].execCommand(b,!1,null),"delete"===a&&g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objUndoRedo.registerUndoRedoStack(0,c)):g_objTextFormat.toogleTextFormat(c,a)&&g_objUndoRedo.registerUndoRedoStack(0,
c)}catch(e){fnUserMessage(b.toLowerCase())}editor_onselectionchange(c)}tranAllAnchorHrefSharp(c)}}catch(e){dalert(e)}}
function fnHandler_Align(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command,e=b.command_id;c=!1;ID_STRING_NAME_CHECKED==b.TBSTATE&&(c=!0);if(ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype){var f=GetCurTable(a);if(!f)return;b="";if(!c)if(e==ID_COMMAND_JUSTIFY_LEFT)b="left";else if(e==ID_COMMAND_JUSTIFY_CENTER)b="center";else if(e==ID_COMMAND_JUSTIFY_RIGHT)b="right";else if(e==ID_COMMAND_JUSTIFY_JUSTIFY)c=!0;else return;g_objTableUtil.setAlignTableByStyleProperty(f,
b,c)}else fnHandler_Align_Main(a,d,c,e),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a);GetCurTable(a)?commonUpdateAfterChange(a,GetCurTable(a),{bResetOutline:!1}):g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(g){dalert(g)}}
function fnHandler_Align_Main(c,b,a,d){try{g_objTableSelection.isTableSelected()||(b="",a?b="":d==ID_COMMAND_JUSTIFY_LEFT?b="left":d==ID_COMMAND_JUSTIFY_CENTER?b="center":d==ID_COMMAND_JUSTIFY_RIGHT?b="right":d==ID_COMMAND_JUSTIFY_JUSTIFY&&(b="justify"),g_objLetterFn.setParaStyle(c,{textAlign:b})),g_objTableUtil.setAlignTable(d,a,c),editor_onselectionchange(c)}catch(e){}}
function fnHandler_Undo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objUndoRedo.operateUndoRedoStack(!0,!1,a),"undefined"!=typeof dzeUiConfig.arrFormCodeString&&g_objEditMode.initDivFormCodeObjectEvent(a))}catch(d){}}
function fnHandler_Redo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objUndoRedo.operateUndoRedoStack(!1,!1,a),"undefined"!=typeof dzeUiConfig.arrFormCodeString&&g_objEditMode.initDivFormCodeObjectEvent(a))}catch(d){}}
function fnHandler_TableAddRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);ID_COMMAND_TABLE_ADD_ROW==b.command_id?g_objTableOperation.table_AddTableRow(d,!0):g_objTableOperation.table_AddTableRow(d,!1);commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableCopyRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_AddTableRow(d,!1,!0);commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableDeleteRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.deleteTableRow(d,a)===g_objTableOperation.RET_DELETE_TABLE?fnHandler_TableDelete(c,b,a):(commonUpdateAfterChange(a,d),"undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length&&g_objEditMode.doReservedCallback(a))}}catch(e){}}
function fnHandler_TableAddCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);ID_COMMAND_TABLE_ADD_COL==b.command_id?g_objTableOperation.table_AddTableCol(d,!0):g_objTableOperation.table_AddTableCol(d,!1);commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableDeleteCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.deleteTableCol(d,a)===g_objTableOperation.RET_DELETE_TABLE?fnHandler_TableDelete(c,b,a):(commonUpdateAfterChange(a,d),"undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length&&g_objEditMode.doReservedCallback(a))}}catch(e){}}
function fnHandler_TableMergeCell(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_MergeTableCell(d,a)&&commonUpdateAfterChange(a,d)}}catch(e){}}function fnHandler_TableSplitRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_SplitTableRow(a,d,2)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableSplitCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_SplitTableCol(a,d,2)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableSplitCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_SPLIT_CELL,g_objPropTagTableSplitCell.buildTagTableSplitCell(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableSplitCell.getPropSettingData();b=GetCurTable(a);var c=g_objPropTagTableSplitCell.nSplitCount;g_objPropTagTableSplitCell.bSplitRow?g_objTableOperation.table_SplitTableRow(a,
b,c):g_objTableOperation.table_SplitTableCol(a,b,c);commonUpdateAfterChange(a,b)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagTableSplitCell.initPropTagTableSplitCell()},function(){},!0,"screen_center")}catch(d){}}
function fnHandler_TableAddRowCol(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_ADD_ROW_COL,g_objPropTagTableAddRowCol.buildTagTableAddRowCol(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();var c=g_objPropTagTableAddRowCol;b=g_objTableOperation;c.getPropSettingData();var d=c.nAddCount,g=c.nAddDirection,h=c.bAddRow;c=GetCurTable(a);if(h)for(h=0;h<d;h++)b.table_AddTableRow(c,
0==g?!0:!1);else for(h=0;h<d;h++)b.table_AddTableCol(c,0==g?!0:!1);commonUpdateAfterChange(a,c)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagTableAddRowCol.initPropTagTableAddRowCol()},function(){},!0,"center")}catch(d){}}
function fnHandler_TableCellProperty(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_PROPERTY,duzon_dialog.getTabContents(1,[ID_RES_DIALOG_TAB_GENERAL],[g_objPropTagTableCell.buildTagTableCell()],[60],g_objPropTagTableCell.buildTagTableCellCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){b=GetCurTable(a);duzon_dialog.closeDialog();g_objPropTagTableCell.applyPropTagTableCell();
commonUpdateAfterChange(a,b)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCell.initPropTagTableCell(GetCurTable(a),a)},function(){},!0,duzon_dialog.getDefaultPosition(b))}catch(d){}}
function fnHandler_TableCellStyle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_STYLE,duzon_dialog.getTabContents(2,[ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTableCellStyle.buildTagTableCellStyle_Border(),g_objPropTagTableCellStyle.buildTagTableCellStyle_Background()],[60,60],g_objPropTagTableCellStyle.buildTagTableCellStyleCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
[function(b){b=GetCurTable(a);duzon_dialog.closeDialog();var c=g_objPropTagTableCellStyle.getPropSettingData();if(null!=c){if(b&&c[ID_PROP_NODE_GENERAL]&&null!==c[ID_PROP_NODE_GENERAL][9]){var d=c[ID_PROP_NODE_GENERAL][9];g_objTableSelection.doAllTable(function(a){g_objTableUtil.setTableBorderCollapse(a,d)},b)}g_objTableFunction.setSelectedCellAttribute(c,b.ownerDocument,b,a);commonUpdateAfterChange(a,b)}},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCellStyle.initPropTagTableCellStyle(GetCurTable(a),
a)},function(){},!0,duzon_dialog.getDefaultPosition(b))}catch(d){}}function fnHandler_table_lock_edit_cell(c,b,a){try{if(!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode&&(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))){var d=GetCurTable(a);d&&(c=!1,c=g_objEditMode.checkSelectionContentEditable(a)?g_objTableFunction.setLockEditCell(d,a):g_objTableFunction.removeLockEditCell(d,a),!0===c&&commonUpdateAfterChange(a,d))}}catch(e){dalert(e)}}
function fnHandler_lockEditTable(c,b,a){try{if(!1!==g_bLockEditTableMode&&(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))){var d=GetCurTable(a);!0===g_objTableFunction.setLockEditTable(d)&&commonUpdateAfterChange(a,d)}}catch(e){dalert(e)}}
function fnHandler_TableProperty(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_PROPERTY,function(){var a=g_objTableUtil.isProtect();return duzon_dialog.getTabContents(3,[ID_RES_DIALOG_TAB_GENERAL,ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTable.buildTagTable_General(),g_objPropTagTable.buildTagTable_Border(),g_objPropTagTable.buildTagTable_Background()],[60,a?0:60,a?0:60],g_objPropTagTable.buildTagTableCommon())}(),
2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){if(g_objPropTagTable.checkValidateData()){b=GetCurTable(a);duzon_dialog.closeDialog();var c=g_objPropTagTable.getPropSettingData();null!=c&&(g_objTableSelection.doAllTable(function(b){g_objTableFunction.setTableAttribute(c,b.ownerDocument,b,a)},b),commonUpdateAfterChange(a,b))}},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTable.initPropTagTable(GetCurTable(a),a)},function(){},!0,duzon_dialog.getDefaultPosition(b))}catch(d){}}
function fnHandler_TableCreate(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),ID_COMMAND_TYPE_MENU==b.commandtype?fnSub_TableCreate_Menu_Command(c,a):ID_COMMAND_TYPE_TOOL==b.commandtype&&(setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),g_objTableSizeBoxWin.showTableSizeBoxLayer(b,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0)))}catch(d){}}
function fnHandler_TableCreate_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),fnSub_TableCreate_Menu_Command(c,a))}catch(d){}}
function fnSub_TableCreate_Menu_Command(c,b){try{duzon_dialog.viewDialog(c,b,ID_RES_CONST_STRING_TABLE_CREATE,duzon_dialog.getTabContents(3,[ID_RES_DIALOG_TAB_GENERAL,ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTableCreate.buildTagTableCreate_General(),g_objPropTagTableCreate.buildTagTableCreate_Border(),g_objPropTagTableCreate.buildTagTableCreate_Background()],[60,60,60],g_objPropTagTableCreate.buildTagTableCreateCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
[function(a){g_objPropTagTableCreate.checkValidateData()&&(duzon_dialog.closeDialog(),a=g_objPropTagTableCreate.getPropSettingData(),null!=a&&(a=g_objTableFunction.createTable(a,b)))&&(g_objCaretUtil.moveCaret(a),commonUpdateAfterChange(b,a))},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCreate.initPropTagTableCreate()},function(){},!0,"screen_center")}catch(a){}}
function fnHandler_TableDelete(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d||(d=g_objTableMiniMenu.objTableNode);if(!d||!d.parentNode)return!1;g_objTableOperation.deleteTable(d);updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a);g_objTableFlag.ResetTableInfo(!1);editor_onselectionchange(a);tranAllAnchorHrefSharp(a);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtMouseUpShowDynamicMenu();g_objUndoRedo.registerUndoRedoStack(0,
a)}}catch(e){}}function fnHandler_TableCellSameHeight(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_TableCellSameHeight(d,a)&&commonUpdateAfterChange(a,d)}}catch(e){}}function fnHandler_TableCellSameWidth(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_TableCellSameWidth(d,a)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_execTableCellAlign(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d="left_top center_top right_top left_middle center_middle right_middle left_bottom center_bottom right_bottom".split(" ")[b.command_id-155].split("_"),e=d[0],f=d[1],g=GetCurTable(a);g_objTableOperation.table_TableCellAlign(g,e,f,a)&&commonUpdateAfterChange(a,g)}}catch(h){}}
function fnHandler_TableCellAlign(c,b,a){try{0>b.id.indexOf("TB_TABLE_CELL_ALIGN")||fnHandler_TableCellAlign_Detail(c,b,a)}catch(d){}}
function fnHandler_TableCellAlign_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),"ribbon"!=dze_menu_control.getUiMode()?duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_ALIGN,duzon_dialog.getTableCellAlignContent(),0,[],[],function(){},function(){},!0,"toolbar",b):(duzon_dialog.nExtendsDlgType=
DZE_EXTENDS_TABLE_CELL_ALIGN,duzon_dialog.viewExtendsDlg(b,a)))}}catch(e){}}function fnHandler_TableCellHorizontalLeft(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellHorizontalAlign(d,"left")}}catch(e){}}
function fnHandler_TableCellHorizontalCenter(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellHorizontalAlign(d,"center")}}catch(e){}}function fnHandler_TableCellHorizontalRight(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellHorizontalAlign(d,"right")}}catch(e){}}
function fnHandler_TableCellVerticalTop(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellVerticalAlign(d,"top")}}catch(e){}}function fnHandler_TableCellVerticalMiddle(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellVerticalAlign(d,"middle")}}catch(e){}}
function fnHandler_TableCellVerticalBottom(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellVerticalAlign(d,"bottom")}}catch(e){}}function fnHandler_TableHorizontalSum(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_SUM)}function fnHandler_TableVerticalSum(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_SUM)}
function fnHandler_TableHorizontalAverage(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_AVERAGE)}function fnHandler_TableVerticalAverage(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_AVERAGE)}function fnHandler_TableHorizontalMultiply(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_MULTIPLY)}
function fnHandler_TableVerticalMultiply(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_MULTIPLY)}function fnHandler_TableFormula(c,b,a,d,e){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var f=GetCurTable(a);g_objTableOperation.table_TableFormula(f,d,e,a)&&commonUpdateAfterChange(a,f)}}catch(g){}}
function fnHandler_TableSelectFormula(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_SELECT_FORMULA,g_objPropTagTableSelectFormula.buildTagTableSelectFormula(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1);g_objPropTagTableSelectFormula.setFormulaResultValue();b=GetCurTable(a);commonUpdateAfterChange(a,
b)},function(a){duzon_dialog.closeDialog();g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1)}],function(){var b=GetCurTableInfo(a);b&&g_objPropTagTableSelectFormula.initPropTagTableSelectFormula(b.table,b.cell.parentNode.rowIndex,b.cell.cellIndex,a)},function(){},!0,"center")}catch(d){}}
function fnHandler_HyperLinkInsert(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HYPERLINK_INSERT,duzon_dialog.getInsertHyperLinkContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.inputHyperLink()},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.setHyperLinkContentData();g_objLayerKit.getElementById(duzon_dialog.idx_dze_hyperlink_type_url).onclick=
function(){duzon_dialog.setHyperLinkType()};var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_hyperlink_type_bookmark);a&&(a.onclick=function(){duzon_dialog.setHyperLinkType()});g_objLayerKit.getElementById(duzon_dialog.idx_dze_hyperlink_unlink_button).onclick=function(){duzon_dialog.unLink();duzon_dialog.closeDialog()}},function(){},!0)}catch(d){}}
function fnHandler_FontName(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(0,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_FontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(1,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_HeadingSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(2,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_Outdent(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){c=!1;if(b&&ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype||g_objTableSelection.isTableSelected(a)){var d=GetCurTable(a);if(!d)return;c=!0;g_objTableUtil.getSplitTables(d).forEach(function(a){g_objTableUtil.setTable_Outdent_Indent(a,!0)});g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a)}else c=GetCurListItem(a)?
applyListStyleDepth("increase",a,!1):g_objLetterFn.setParaStyle(a,{outdent:!0});!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a))}}catch(e){dalert(e)}}
function fnHandler_Indent(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){c=!1;if(b&&ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype||g_objTableSelection.isTableSelected(a)){var d=GetCurTable(a);if(!d)return;c=!0;g_objTableUtil.getSplitTables(d).forEach(function(a){g_objTableUtil.setTable_Outdent_Indent(a,!1)});g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a)}else c=GetCurListItem(a)?
applyListStyleDepth("decrease",a,!1):g_objLetterFn.setParaStyle(a,{indent:!0});!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a))}}catch(e){dalert(e)}}
function fnHandler_LetterSpacing(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objLetterSpacingWin.showLetterSpacingLayer(b,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_LineHeight(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objLineHeightWin.showLineHeightLayer(b,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_ForeColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(duzon_dialog.curr_forecolor[a]))}catch(d){}}
function fnHandler_ForeColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(a,b){var c=!0;"undefined"!=typeof b&&(c=b);1==c&&duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;
fnColorCellApply(a,c);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);1!=c||GetMultiCellSelection()||editor_onselectionchange(duzon_dialog.nEditNumber)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR],[function(a){duzon_dialog.selectColorCode("",b);duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply("")},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",
2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var a=dzeColorPallet.getColorCode("hex");""!=a&&(duzon_dialog.selectColorCode(a,b),duzon_dialog.closeDialog(),g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=g_objPropertyUtil.getSelectionAttributeValue(a);"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
duzon_dialog.selectionFontStyleList.color,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0))}}catch(e){}}function fnHandler_BackColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(duzon_dialog.curr_backcolor[a]))}catch(d){}}
function fnHandler_BackColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(a,b){var c=!0;"undefined"!=typeof b&&(c=b);1==c&&duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;
fnColorCellApply(a,c);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);1==c&&editor_onselectionchange(duzon_dialog.nEditNumber)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(){duzon_dialog.selectColorCode("",b);duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;fnColorCellApply("")},function(d){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,
ID_RES_ADJUST_VIEW_CLOSE],[function(){var a=dzeColorPallet.getColorCode("hex");""!=a&&(duzon_dialog.selectColorCode(a,b),duzon_dialog.closeDialog(),g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=g_objPropertyUtil.getSelectionAttributeValue(a);"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
duzon_dialog.selectionFontStyleList.backgroundColor,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}]))}}catch(e){}}function fnHandler_Help(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objCommonUtil.openWindowCommon(dzeEnvConfig.strHelpPageURL,700,700,!1,"")}catch(d){}}
function fnHandler_Preview(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&fnTool_TabMode_Preview(c,b,ID_TB_TABMODE_PREVIEW,a)}catch(d){}}function fnHandler_WriteAreaSet(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objEditMode.arrWriteAreaSet[a]=!g_objEditMode.arrWriteAreaSet[a],TBSetState(b,g_objEditMode.arrWriteAreaSet[a]?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED,ID_TB_QUERY_STATUS_BUTTON))}catch(d){}}
function fnHandler_Print(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTableFlag.ResetTableInfo(!1),g_objEditMode.showAllWriteAreaSet(a,!1),g_objEditMode.showAllContentEditableArea(a,!1),replaceEditorTempTagsFromEditor(a),g_bBrowserType_IE&&2==g_nFormEditMode?g_objEditorDocument[a].execCommand("print",!1,null):g_bBrowserType_IE?g_objEditorDocument[a].execCommand("print",!1,null):g_objEditWindow[a].print(),g_objEditMode.showAllWriteAreaSet(a,!0),g_objEditMode.showAllContentEditableArea(a,
!0),recoverEditorTempTagsFromEditor(a))}catch(d){}}function fnHandler_FormTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1),showFormTable(c,a,!0))}catch(d){}}
function showFormTable(c,b,a){try{var d=function(a){a=a?a:window.event;"duzon_dialog_title"==(a.srcElement?a.srcElement:a.target).className&&g_objPropFormEvent.showAllAreaRectangle()},e=function(a){a=a?a:window.event;"duzon_dialog_title"==(a.srcElement?a.srcElement:a.target).className&&g_objPropFormEvent.hideAllAreaRectangle()};g_objPropForm.bGenerateColGroup=!1;g_objPropForm.bShowPropForm=!0;g_objUndoRedo.registerUndoRedoStack(0,b);var f=ID_RES_PROP_FORM_WIN_TITLE;a||(f=ID_RES_CONST_STRING_DRAW_TABLE);
duzon_dialog.viewDialog(c,b,f,g_objPropForm.buildPropForm(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.closeDialog();g_objPropForm.doApplyGenerateFormCode();g_objPropForm.hidePropForm();g_objUndoRedo.registerUndoRedoStack(0,b)},function(a){duzon_dialog.closeDialog();g_objPropForm.hidePropForm();g_objUndoRedo.operateUndoRedoStack(!0,!0,b)}],function(){g_objPropForm.initPropForm(GetCurTable(b));g_objPropForm.dummyAnchorFocus();window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousedown",
e),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",d)):(g_objLayerKit.getLayerDocument().addEventListener("mousedown",e,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",d,!1))},function(){window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousedown",e),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",d)):(g_objLayerKit.getLayerDocument().removeEventListener("mousedown",e,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",d,!1))},!1,
"screen_center")}catch(g){}}function fnHandler_drawTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1),showFormTable(c,a,!1))}catch(d){}}
function fnHandler_FormTagSwitch(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objTagUtil.bFormTagSwitch=!g_objTagUtil.bFormTagSwitch,g_objTagUtil.formTagSwitch(g_objTagUtil.bFormTagSwitch,a),editor_onselectionchange(a))}catch(d){}}
function fnHandler_CheckBox(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&ID_STRING_NAME_CONTROL!=g_strSelectionType&&(c="",c+='<span contenteditable="false">',insertHTMLCodeAtSelection(c+'<input type="checkbox"></span>',null,a))}catch(d){}}
function fnHandler_SelectBox(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(ID_STRING_NAME_CONTROL==g_strSelectionType?duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_SELECT_WIN_TITLE,g_objPropTagSelect.buildTagSelect(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){g_objPropTagSelect.applyDisplayInfo();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagSelect.initPropTagSelect(g_objObjectSelectionInfo.objSelectionObject)},
function(){},!0):(c="",c+='<span contenteditable="false">',c+="<select>",c+="<option>"+ID_RES_DIALOG_FORM_LIST1+"</option>",c+="<option>"+ID_RES_DIALOG_FORM_LIST2+"</option>",c+="<option>"+ID_RES_DIALOG_FORM_LIST3+"</option>",insertHTMLCodeAtSelection(c+"</select></span>",null,a),g_objUndoRedo.registerUndoRedoStack(0,a)))}catch(d){}}function dummyFunc(c,b,a){dlog("---dummyFunc called---command_id:"+b.command_id)}
function dummyFunc_Detail(c,b,a){dlog("---dummyFunc_Detail called---command_id:"+b.command_id)}
function fnHandler_NewFile(c,b,a){dlog("fnHandler_NewFile nEditNumber:"+a);try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=fnGetEditorHTMLCode(!1,a);d=d.trim();dlog("strEditorHTMLCode:"+d);""!=d&&"<p><br /></p>"!=d&&"<p><br></p>"!=d&&"<p>&nbsp;</p>"!=d&&"<p></p>"!=d&&"<br>"!=d&&"<br />"!=d&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_NEW,ID_RES_DIALOG_CONFIRM_SAVE,3,[ID_RES_DIALOG_CONFIRM_YES,ID_RES_DIALOG_CONFIRM_NO,ID_RES_DIALOG_BTN_CANCEL],
[function(b){saveEditorContentToFile(-1);duzon_dialog.closeDialog();replaceHTMLContent("<p><br /></p>",a)},function(b){replaceHTMLContent("<p><br /></p>",a);duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}],null,null,null,duzon_dialog.getDefaultPosition(b))}}catch(e){}}
function fnHandler_SaveAs(c,b,a){-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(c=fnGetEditorHTMLCode(!1,a),c=c.trim(),""==c||"<p><br /></p>"==c||"<p><br></p>"==c||"<p>&nbsp;</p>"==c||"<p></p>"==c||"<br />"==c||"<br>"==c?alert(ID_RES_DIALOG_CONFIRM_EMPTY_DOC):saveEditorContentToFile(a))}
function saveEditorContentToFile(c){try{dlog("saveEditorContentToFile act");-1==c&&(c=g_nActiveEditNumber);var b=fnGetEditorHTMLCode(!1,c);dlog(b);var a=document.createElement("form");a.action=dzeEnvConfig.strSaveAsPageURL+"?"+duzon_http.getCurrTime();a.method="post";var d=document.createElement("textarea");d.name="content";d.value=b;a.appendChild(d);document.body.appendChild(a);a.submit();dlog("saveEditorContentToFile submit ok");dlog(b);document.body.removeChild(a)}catch(e){}}
function fnHandler_OpenFile(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=OpenFileDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_FILE_OPEN,d.getContent(),2,[ID_RES_CONST_STRING_FILE_OPEN,ID_RES_DIALOG_BTN_CANCEL],[function(b){d.onClickOk(a,b)},function(){d.closeDialog()}],function(){d.onLoad()},function(){},null,d.getDefaultPosition(b));var e=document.getElementById(d.idx_openfile_input);e&&(e.value="")}}catch(f){dalert(f)}}
function fnHandler_DocForm(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_DOCFORM,duzon_dialog.getDocFormContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.inputSelectDocFormData();fnHandler_InsertParagraph(a,"end")},function(a){duzon_dialog.closeDialog()}])}catch(d){}}
function fnHandler_Layout(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_LAYOUT,duzon_dialog.getLayoutContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.inputSelectLayoutData();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.addLayoutContentEvent()},function(){},!0,duzon_dialog.getDefaultPosition(b))}catch(d){}}
function fnHandler_viewEdit(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!g_bEditMode[a]&&fnTool_TabMode_Main(ID_TB_TABMODE_EDIT,a)}catch(d){}}function fnHandler_viewHtml(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnTool_TabMode_Main(ID_TB_TABMODE_SOURCE,a)}catch(d){}}function fnHandler_viewRulerbar(c,b,a){}
function fnHandler_InsertImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a),e=d?d.controlObject:null;if(e&&"IMG"===e.nodeName)fnHandler_ModifyImage(c,b,a);else{var f=ImageInsertDlg;f.type=ImageInsertDlg.IMG_INSERT;f.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_IMAGE,f.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){f.onClickOk(function(b,c){for(var d=g_objEditorDocument[a].createDocumentFragment(),
e=c.arrImg,g=0,h=b.length;g<h;g++){var k=e[g];k.src!==b[g]&&(k.src=b[g]);f.setImgProp(k,c,{bSetSize:1<h?!1:!0});d.appendChild(k)}fnAddHTMLContent(null,d,0,a);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);f.closeDialog()})},function(a){f.closeDialog()}],function(){f.onLoad()},function(){f.onUnload()},!0,duzon_dialog.getDefaultPosition(b))}}}catch(g){dalert(g)}}
function fnHandler_ModifyImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a),e=d?d.controlObject:null;if(e&&"IMG"===e.nodeName){var f=ImageInsertDlg;f.type=ImageInsertDlg.IMG_MODIFY;f.viewDialog(c,a,ID_RES_PROP_INSERT_IMAGE,f.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){f.onClickOk(function(b,c){f.setImgProp(e,c)&&commonUpdateAfterChange(a,e);f.closeDialog()})},function(a){f.closeDialog()}],
function(){f.onLoad([e])},function(){f.onUnload()},!0,duzon_dialog.getDefaultPosition(b))}else dlog("fnHandler_ModifyImage :: no image")}}catch(g){dalert(g)}}
function fnHandler_Pastespecial(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&((g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.command_id==ID_COMMAND_EDIT_PASTESPECIAL?alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_EDIT_PASTESPECIAL,duzon_dialog.getPastespecial(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){1==g_objLayerKit.getElementById(duzon_dialog.idx_paste_special_type_text).checked?
window.clipboardData&&window.clipboardData.getData?(pastedText=g_objLayerKit.getLayerWindow().clipboardData.getData("Text"),fnAddHTMLContent(pastedText,null,0,a),TBCancelBubbleEvent(b),duzon_dialog.closeDialog()):alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):1==g_objLayerKit.getElementById(duzon_dialog.idx_paste_special_type_html).checked&&(duzon_dialog.closeDialog(),fnHandler_SupportCommand_Main(a,"Paste"))},function(a){duzon_dialog.closeDialog()}],null,null,null,duzon_dialog.getDefaultPosition(b)))}catch(d){}}
function fnHandler_TabDialogSample(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_IMAGE,duzon_dialog.getSampleTabContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(a){},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(1)},function(){},!0)}catch(d){}}
function fnHandler_FindReplaceText(c,b,a){try{var d=function(a){var b=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).value,d=1;d=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var e=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(e=1);var f=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(f=1);if(""==b)return alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),
g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus(),!1;var g=replaceAllEditorText(a,b,c,d,e,f,0);if(-1==g)return alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR),!1;setTimeout(function(){0==g?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):alert(ID_RES_DIALOG_ALERT_REPLACEALL_COMPLETE+"\n"+g+ID_RES_DIALOG_ALERT_REPLACE_N)},100);return 0<g?!0:!1},e=function(a,b){if(!0===h)return!1;var c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,d=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).value,
f=1;f=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var g=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(g=1);var k=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(k=1);if(""==c)return alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus(),!1;h=!0;return 1===replaceEditorTextDetail(a,c,d,f,g,k,0,b,function(b){h=!1;-1==b?alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR):
0==b?alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT):1!=b&&5!==b&&(2==b?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):3==b?confirm(0==f?ID_RES_DIALOG_CONFIRM_FIND_END:ID_RES_DIALOG_CONFIRM_FIND_FIRST)&&e(a,!0):4==b?alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA):6==b&&alert(ID_RES_STRING_FIND_END))})?!0:!1},f=function(a,b){var c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value;var d=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var e=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&
(e=1);var g=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(g=1);""==c?(alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus()):(b=findEditorTextDetail(a,c,d,e,g,0,b),dlog("nReturnCode:"+b),-1==b?alert(ID_RES_DIALOG_ALERT_FIND_ERROR):0==b?alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT):1!=b&&(2==b?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):3==b&&confirm(0==d?ID_RES_DIALOG_CONFIRM_FIND_END:ID_RES_DIALOG_CONFIRM_FIND_FIRST)&&
f(a,!0)))};-1==a&&(a=g_nActiveEditNumber);if(fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){if(b.command_id==ID_COMMAND_EDIT_SEARCH)var g="find";else if(b.command_id==ID_COMMAND_EDIT_REPLACE)g="replace";else return;var h=!1;duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FIND_REPLACE,duzon_dialog.getFindReplaceContent(),4,[ID_RES_DIALOG_BTN_REPLACEALL,ID_RES_CONST_STRING_EDIT_REPLACE,ID_RES_DIALOG_BTN_FIND_NEXT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){!0===d(a)&&g_objUndoRedo.registerUndoRedoStack(0,
a)},function(b){!0===e(a)&&g_objUndoRedo.registerUndoRedoStack(0,a)},function(b){f(a)},function(a){duzon_dialog.closeDialog()}],function(b){setTimeout(function(){"find"==g?duzon_dialog.viewTabContents(0):duzon_dialog.viewTabContents(1)},50);""!=duzon_dialog.strFindText&&(g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value=duzon_dialog.strFindText);g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).onblur=function(){duzon_dialog.strFindText=this.value};var c=function(b){b&&
b.keyCode===ID_KEYCODE_ENTER&&(f(a),TBCancelBubbleEvent(b))},d=b.querySelector("#idx_duzon_find_text");b=b.querySelector("#idx_duzon_replace_text");d&&(d.onkeydown=c);b&&(b.onkeydown=c);duzon_dialog.resetSelection=!0;duzon_dialog.isFindDialog=!0},function(){g_objFindTextRange=null},!0,duzon_dialog.getDefaultPosition(b),b,g_objEditWindow[a].find?{viewBackScr:!1}:null)}}catch(k){dalert(k)}}
function fnHandler_InsertExtMovie(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_EXT_MOVIE,duzon_dialog.getInsertExtMovieContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.insertExtMovieContent()&&g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_movie_marginleft",500,0,0,"");duzon_dialog.modifySpinnerValue("dze_movie_margintop",
500,0,0,"");duzon_dialog.modifySpinnerValue("dze_movie_marginright",500,0,0,"");duzon_dialog.modifySpinnerValue("dze_movie_marginbottom",500,0,0,"")},function(){},!0,duzon_dialog.getDefaultPosition(b))}catch(d){}}
function fnHandler_InsertExtFile(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&("dzeExtFile"==g_objPropContentLink.getPropContentParam(a).arrValue[3]?fnHandler_ModifyExtFile(c,b,a):duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FILE_INSERT,duzon_dialog.getInsertExtFileContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.insertExtFileContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],
function(){g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).onchange=function(){duzon_dialog.uploadExtFile()}},function(){},!0,duzon_dialog.getDefaultPosition(b)))}catch(d){}}
function fnHandler_ModifyExtFile(c,b,a){dlog("fnHandler_ModifyExtFile Call");var d=g_objPropContentLink.getPropContentParam(a);if("dzeExtFile"==d.arrValue[3]){dlog("objParam.arrValue:"+d.arrValue);try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FILE_INSERT,duzon_dialog.getInsertExtFileContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.modifyExtFileContent();g_objUndoRedo.registerUndoRedoStack(0,
a)},function(a){duzon_dialog.closeDialog()}],function(){var a=d.arrValue[4];g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).disabled=!0;g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value=a},function(){},!0,"relative")}catch(e){}}}
function fnHandler_InsertHr(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_objInsertUtil.insertTableCodeAtSelection("<hr>",a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){}}function fnHandler_InsertEmoticons_Detail(c,b,a){fnHandler_InsertEmoticons(c,b,a)}
function fnHandler_InsertEmoticons(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a])if("ribbon"!=dze_menu_control.getUiMode())duzon_dialog.nInsTypeIdx=1,duzon_dialog.makeInsTypeInfo(),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_EMOTICONS,duzon_dialog.getInsertTypeContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.insertTypeContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],
function(){setTimeout(function(){duzon_dialog.loadInsertTypeContent()},150)},function(){},!0,duzon_dialog.getDefaultPosition(b));else{var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_EMOTICON,duzon_dialog.makeExtendsDlgInfo(),duzon_dialog.viewExtendsDlg(b,a,null,null,null,"toolbar",null))}}catch(e){}}
function fnHandler_SpecialChars(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(duzon_dialog.nInsTypeIdx=0,duzon_dialog.makeInsTypeInfo(),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_SPECIALCHARS,duzon_dialog.getInsertTypeContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.insertTypeContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){setTimeout(function(){duzon_dialog.loadInsertTypeContent()},
100)},function(){},!0,duzon_dialog.getDefaultPosition(b)))}catch(d){}}
function fnHandler_InsertBookmark(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_BOOKMARK,duzon_dialog.getInsertBookmarkContent(),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.printBookmarkList();g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_insert_btn).onclick=function(){duzon_dialog.inputBookmark()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_delete_btn).onclick=
function(){duzon_dialog.removeBookmarkItem()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_move_btn).onclick=function(){duzon_dialog.moveBookmarkPosition()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_sort_name).onclick=function(){duzon_dialog.printBookmarkList()};g_objLayerKit.getElementById(duzon_dialog.idx_dze_bookmark_sort_position).onclick=function(){duzon_dialog.printBookmarkList()}},function(){},!0,duzon_dialog.getDefaultPosition(b))}catch(d){}}
function fnHandler_InsertParagraphStartPoint(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_InsertParagraph(a,"start"),editor_onselectionchange(a))}catch(d){dalert(d)}}function fnHandler_InsertParagraphEndPoint(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_InsertParagraph(a,"end"),editor_onselectionchange(a))}catch(d){dalert(d)}}
function fnHandler_InsertParagraph(c,b){try{var a=GetCurTable(c);a?dlog("table"):dlog("no table");var d=document.createElement("p");d.id="idx_dze_dummy_p_tag_123456789";d.innerHTML=window.attachEvent?"&nbsp;":"<br />";if(a)if("start"==b)a.parentNode.insertBefore(d,a);else{var e=a.nextSibling;e?a.parentNode.insertBefore(d,e):a.parentNode.appendChild(d)}else"start"==b?g_objEditorDocument[c].body.insertBefore(d,g_objEditorDocument[c].body.childNodes[0]):g_objEditorDocument[c].body.appendChild(d);d.getAttribute("id")&&
d.removeAttribute("id");duzon_dialog.setFocusElement(d,c,"start");null==a&&("start"==b?g_objEditWindow[c].scrollTo(0,0):g_objEditWindow[c].scrollTo(0,g_objEditorDocument[c].body.scrollHeight));g_objUndoRedo.registerUndoRedoStack(0,c)}catch(f){dalert(f)}}
function fnHandler_StyleFont(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(dlog("fnHandler_StyleFont element"),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_FONT,duzon_dialog.getStyleFontContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.setStyleFont();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_style_font_spacing",
duzon_dialog.max_letterspacing,duzon_dialog.min_letterspacing,duzon_dialog.min_letterspacing,"duzon_dialog.preveiwDzeLetterSpacing");duzon_dialog.modifySpinnerValue("dze_style_font_size",36,8,9,"duzon_dialog.preveiwDzeFontSize");for(var a="",b="",c=0;c<duzon_dialog.dze_font_propertys.length;c++)a="idx_dze_style_font_"+duzon_dialog.dze_font_propertys[c],b=duzon_dialog.dze_font_propertys[c],function(){var c=b;g_objLayerKit.getElementById(a).onclick=function(){duzon_dialog.selectFontProperty(c)}}();
g_objColorComboBoxUtil.initColorComboBox("dze_font_forecolor",function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.color=a},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]);g_objColorComboBoxUtil.initColorComboBox("dze_font_backcolor",function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.backgroundColor=a});$_("dze_style_font_family").onchange=function(){$_(duzon_dialog.idx_dze_style_font_preview).style.fontFamily=this.value};g_objColorComboBoxUtil.setColorValue("dze_font_forecolor",
"");g_objColorComboBoxUtil.setColorValue("dze_font_backcolor","");duzon_dialog.checkSelectionFontStyle()},function(){},!0,duzon_dialog.getDefaultPosition(b)))}catch(d){}}
function fnHandler_StyleParagraph(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=ParagraphDlg,e=g_objLetterFn.getSelectedParaStyle(a);d.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_PARAGRAPH,d.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){d.setEditorSelection();d.closeDialog();d.onClickOk(function(b){g_objLetterFn.setParaStyle(a,b);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a)})},function(){d.closeDialog()}],
function(){d.onLoad(e)},function(){},!0)}}catch(f){}}
function fnHandler_StyleHeadingSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE,g_objComboBoxWin.strComboBoxCommand="Heading",b.command_id==ID_COMMAND_STYLE_STYLE_BASIC?g_objComboBoxWin.setComboBox(0):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT1?g_objComboBoxWin.setComboBox(1):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT2?g_objComboBoxWin.setComboBox(2):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT3?
g_objComboBoxWin.setComboBox(3):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT4?g_objComboBoxWin.setComboBox(4):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT5&&g_objComboBoxWin.setComboBox(5))}catch(d){}}
function fnHandler_StyleUnorderedList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){duzon_menubar.closeHiddenTbContainerTool();var d=UListDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,d.getContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var b=d.getListStyle();d.closeDialog();if(b&&(b="none"===b?removeOLUL(a):insertUL(a,b),setCurListForDialog(a),!0===b&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode)))g_objPageControl.onSetDelayedUpdatePageTimer()},
function(){d.closeDialog()}],function(b){var c="",e=GetCurList(a);e&&(c=g_objListUtil.getListStyle(e));d.onLoad(c,b)},function(){},!0,duzon_dialog.getDefaultPosition(b))}}catch(e){}}
function fnHandler_StyleOrderedList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){duzon_menubar.closeHiddenTbContainerTool();var d=OListDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_ORDEREDLIST,d.getContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var b=d.getInfo();d.closeDialog();var c=b.listStyle;b=b.start;if(c&&(c="none"===c?removeOLUL(a):insertOL(a,c,b),setCurListForDialog(a),!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,
a),dzeUiConfig.bOfficePagingMode)))g_objPageControl.onSetDelayedUpdatePageTimer()},function(){d.closeDialog()}],function(b){var c={start:1,listStyle:""},e=GetCurList(a);e&&(c.start=e.getAttribute("start")||"",c.listStyle=g_objListUtil.getListStyle(e));d.onLoad(c,b)},function(){},!0,duzon_dialog.getDefaultPosition(b))}}catch(e){}}
function fnHandler_ProductInfo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_WEBEDITOR_INFO,duzon_dialog.getWebEditorInfoContent(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.getOnefficeLicenseInfo();var a=g_objLayerKit.getLayerDocument().getElementById("dze_idx_btn_view_license_info_contentbox");a.onclick=function(){var b=g_objLayerKit.getLayerDocument().getElementById("dze_idx_license_info_contentbox");
"none"==b.style.display?duzon_dialog.fade("in",b,function(){a.innerHTML="License Info \u25b2"},25):duzon_dialog.fade("out",b,function(){a.innerHTML="License Info \u25bc"},25)}},function(){},!0,"center")}catch(d){}}
function fnHandler_ShortCutsInfo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HELP_SHORTCUTS,duzon_dialog.getShortCutsInfoContent(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.setShortCutsInfo()},function(){},!1,"center")}catch(d){}}
function fnHandler_StyleIncreaseFontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&increaseFontSize(!0,a)}catch(d){}}function fnHandler_StyleDecreaseFontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&increaseFontSize(!1,a)}catch(d){}}
function fnHandler_Tb_OrderedList(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_SupportCommand_Main(a,b.command,!1),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){dalert(d)}}
function fnHandler_Tb_OrderedList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_StyleOrderedList(c,b,a)}catch(d){}}
function fnHandler_Tb_UnorderedList(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_SupportCommand_Main(a,b.command,!1),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){dalert(d)}}
function fnHandler_Tb_UnorderedList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_StyleUnorderedList(c,b,a)}catch(d){}}
function fnHandler_ReplaceCase(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_REPLACE_CASE,duzon_dialog.getReplaceCaseContent(),2,[ID_RES_CONST_STRING_EDIT_REPLACE,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.closeDialog();duzon_dialog.setReplaceCase();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.initReplaceCaseBtnEvent()},function(){},
!0,"center")}catch(d){}}
function fnHandler_Table_Cell_BackColor(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=duzon_dialog.curr_cell_backcolor[a],e=GetCurTable(a);e&&(c=[],c[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""],c[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,d],c[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""],g_objTableFunction.setSelectedCellAttribute(c,e.ownerDocument,e,a),commonUpdateAfterChange(a,e))}}catch(f){}}
function fnHandler_Table_Cell_BackColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);1==d&&duzon_dialog.closeExtendsDlg();if(c=GetCurTable(a)){var e=
[];e[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""];e[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,b];e[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""];g_objTableFunction.setSelectedCellAttribute(e,c.ownerDocument,c,a);1==d&&commonUpdateAfterChange(a,c)}},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(b){duzon_dialog.closeExtendsDlg();if(b=GetCurTable(a)){var c=[];c[ID_PROP_NODE_BORDER]=[!1,!1,!1,!1,!1,!1,!1,"","","","","",""];c[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,""];
c[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""];g_objTableFunction.setSelectedCellAttribute(c,b.ownerDocument,b,a);commonUpdateAfterChange(a,b)}},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c){duzon_dialog.selectColorCode(c,b);duzon_dialog.closeDialog();var d=GetCurTable(a);if(d){var e=[];e[ID_PROP_NODE_BORDER]=[!1,
!1,!1,!1,!1,!1,!1,"","","","","",""];e[ID_PROP_NODE_BACKGROUND_COLOR]=[!1,!0,c];e[ID_PROP_NODE_BACKGROUND_IMAGE]=[!1,!1,"",""];g_objTableFunction.setSelectedCellAttribute(e,d.ownerDocument,d,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b="",c=GetCurTable(a);c&&(c=g_objTableFunction.getSelectedCellAttribute(c.ownerDocument,c,a),null!=c[ID_PROP_NODE_BACKGROUND_COLOR]&&(b=c[ID_PROP_NODE_BACKGROUND_COLOR]));dzeColorPallet.showButtons=
!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",b,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0))}}catch(e){}}function fnHandler_IncreaseOrder(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&applyListStyleDepth("increase",a,c)}catch(d){}}
function fnHandler_DecreaseOrder(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&applyListStyleDepth("decrease",a,c)}catch(d){}}
function fnHandler_TableConvertText(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);if(d){var e=g_objTableOperation.convertTableToFormatText(d);e&&(g_objTableFlag.ResetTableInfo(!0),updateTableHandlerUI.updateTableUIHandler(a),editor_onselectionchange(a),g_objUndoRedo.registerUndoRedoStack(0,a));return e}}}catch(f){dalert(f)}}
function fnHandler_FullScreen(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;dzeFullScreen.view(a)}catch(d){}return!1}function fnHandler_InsertPrintPageBreak(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;insertPrintPageBreak(a)}catch(d){}return!1}function fnHandler_cascadeOrderList(c,b,a){try{fnHandler_cascadeOrderList_Detail(c,b,a)}catch(d){}return!1}
function fnHandler_cascadeOrderList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE==ID_STRING_NAME_GRAY)return;TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var e=MultiLevelListDlg;setCurListForDialog(a);e.viewExtendsDlg(b,a,null,null,null,c,!1,e.getContent(),function(b){e.onLoad(b,a)})}catch(f){}return!1}
function fnHandler_CopyExt(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE==ID_STRING_NAME_GRAY)return;TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COPY_EXT;duzon_dialog.viewExtendsDlg(b,a)}catch(e){dalert(e)}return!1}function fnHandler_CopyExt_Detail(c,b,a){fnHandler_CopyExt(c,b,a)}
function fnHandler_CopyExtStyle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;dzeCopyPasteStyleInfo.copy(a)}catch(d){dalert(d)}return!1}
function fnHandler_SelectParagraphDropDown(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_INSERT_PARAGRAPH,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_SelectParagraphDropDown_Detail(c,b,a){fnHandler_SelectParagraphDropDown(c,b,a)}function fnHandler_PasteExt(c,b,a){fnHandler_SupportCommand(c,b,a)}
function fnHandler_PasteExt_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_PASTE_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TalbeDeleteExt(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_DELETE_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TalbeDeleteExt_Detail(c,b,a){fnHandler_TalbeDeleteExt(c,b,a)}
function fnHandler_TableSelect(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_SELECT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableSelect_Detail(c,b,a){fnHandler_TableSelect(c,b,a)}
function fnHandler_TableFomulaExt(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_FORMULA_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableFomulaExt_Detail(c,b,a){fnHandler_TableFomulaExt(c,b,a)}
function fnHandler_TableNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_NUMBER_FORMAT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableNumberFormat_Detail(c,b,a){fnHandler_TableNumberFormat(c,b,a)}
function fnHandler_ImageBorderType(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_ImageBorderType_Detail(c,b,a){fnHandler_ImageBorderType(c,b,a)}
function fnHandler_ImageBorderThickness(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_ImageBorderThickness_Detail(c,b,a){fnHandler_ImageBorderThickness(c,b,a)}function fnHandler_ImageBorderColor(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=d.controlObject;e.style.borderColor=duzon_dialog.curr_image_border_backcolor[a];commonImageUpdateAfterChange(e,a)}}catch(f){}}
function fnHandler_ImageBorderColor_Detail(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=d.controlObject;duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_COLOR;duzon_dialog.viewExtendsDlg(b,a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);1==d&&duzon_dialog.closeExtendsDlg();f.style.borderColor=
b;1==d&&commonImageUpdateAfterChange(f,a)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(c){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("#FFFFFF",b);f.style.borderColor="#FFFFFF";commonImageUpdateAfterChange(f,a)},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");""!=c&&(duzon_dialog.selectColorCode(c,
b),duzon_dialog.closeDialog(),f.style.borderColor=c,commonImageUpdateAfterChange(f,a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div","",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0)}}catch(g){}}
function imageExceptionCheck(c){try{return null==c||"undefined"==typeof c||"img"!=c.nodeName.toLowerCase()?(dlog("imageExceptionCheck :: no image"),!1):!0}catch(b){}}function commonExceptionCheck(c,b,a){try{return document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]?!0:!1}catch(d){}}
function commonImageUpdateAfterChange(c,b){try{(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(c,!0,!1,b),dze_menu_control.setTBImageSizeInfo(b),g_objUndoRedo.registerUndoRedoStack(0,b),editor_onselectionchange(b)}catch(a){}}
function commonUpdateAfterChange(c,b,a){try{if(b){var d=null;if("IMG"===b.nodeName)(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(b,!0,!1,c),g_objUndoRedo.registerUndoRedoStack(0,c),editor_onselectionchange(c);else if("TABLE"===b.nodeName)a&&!1===a.bResetOutline||g_objWrapperOutlineResize.resetExtOutlineInfo(),editor_onselectionchange(c),updateTableHandlerUI.updateTableUIHandler(c),g_objTableMiniMenu.update(c),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,
!0,!1,c),a&&!1===a.bUndoRedo||g_objUndoRedo.registerUndoRedoStack(0,c);else if(d=g_objVideoControl.getVideo(b))(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(d,!0,!1,c),g_objUndoRedo.registerUndoRedoStack(0,c),editor_onselectionchange(c)}}catch(e){dalert(e)}}
function fnHandler_ImageResetPicture(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=d.controlObject;e.removeAttribute("style");e.removeAttribute("width");e.removeAttribute("height");setOrgImageSize(e,getMaxBoundSize(),!0);commonUpdateAfterChange(a,e)}}catch(f){dalert(f)}}function fnHandler_ObjectBorderNoLine(c,b,a){setObjectBorderLineWithType(c,b,a,"noline")}
function fnHandler_ObjectBorderSolidLine(c,b,a){setObjectBorderLineWithType(c,b,a,"solid")}function fnHandler_ObjectBorderDashedLine(c,b,a){setObjectBorderLineWithType(c,b,a,"dashed")}function fnHandler_ObjectBorderDottedLine(c,b,a){setObjectBorderLineWithType(c,b,a,"dotted")}function fnHandler_ObjectBorderDoubleLine(c,b,a){setObjectBorderLineWithType(c,b,a,"double")}
function setObjectBorderLineWithType(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a))if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS){var e=getSelectionControl(a).controlObject;if("noline"==d)e.style.borderWidth="0px";else{var f=e.style.borderWidth,g=e.style.borderColor;e.style.border=d;"double"==d&&(null==f||""==f||3>parseInt(f))&&(f="3px");0<parseInt(f)&&(e.style.borderWidth=f);g&&(e.style.borderColor=
g)}commonImageUpdateAfterChange(e,a)}else if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE){var h=GetCurTable(a);if(h){var k=g_objTableFunction,l=g_objPropertyUtil,m=g_objTableUtil.getMatrix(h);g_objTableSelection.doAllSelectedCell(function(a){"noline"===d?k.setCellBorderWidth(a,null,"0px",m):DZE_DIR.doAllDir(function(b,c){c=l.getElement_BorderWidth_With_Unit(a,c).nValue;c=parseFloat(c);var e="double"===d?3:1;c<e&&k.setCellBorderWidth(a,
b,e+"px",m)});k.setCellBorderStyle(a,null,d,m)});commonUpdateAfterChange(a,h)}}}catch(n){dalert(n)}}function fnHandler_ObjectBorder1pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"1px")}function fnHandler_ObjectBorder2pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"2px")}function fnHandler_ObjectBorder3pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"3px")}function fnHandler_ObjectBorder4pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"4px")}
function fnHandler_ObjectBorder5pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"5px")}function fnHandler_ObjectBorder6pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"6px")}function fnHandler_ObjectBorder7pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"7px")}function fnHandler_ObjectBorder8pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"8px")}function fnHandler_ObjectBorder9pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"9px")}
function fnHandler_ObjectBorder10pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"10px")}
function setObjectBorderWidthLineWithValue(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a))if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS){var e=getSelectionControl(a).controlObject,f=e.style.borderColor;if(null==e.style.border||""==e.style.border)e.style.border="solid";e.style.borderWidth=d;e.style.borderColor=f;commonImageUpdateAfterChange(e,a)}else if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS||
duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE){var g=GetCurTable(a);if(g){var h=g_objTableFunction,k=g_objTableUtil.getMatrix(g);g_objTableSelection.doAllSelectedCell(function(a){DZE_DIR.doAllDir(function(b,c){a.style["border"+c.capitalizeFirstLetter()+"Style"]||h.setCellBorderStyle(a,b,"solid",k)});h.setCellBorderWidth(a,null,d,k)});commonUpdateAfterChange(a,g)}}}catch(l){dalert(l)}}
function fnHandler_TableSelectCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&GetCurTable(a)&&(g_objTableSelection.table_SelectionCaretCell(a),updateTableHandlerUI.updateTableUIHandler(a))}catch(d){}}function fnHandler_TableSelectCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);d&&(g_objTableSelection.table_selectCol(d,a),g_objTableSelection.updateManualTableUIHandler(a))}}catch(e){}}
function fnHandler_TableSelectRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);d&&(g_objTableSelection.table_selectRow(d,a),g_objTableSelection.updateManualTableUIHandler(a))}}catch(e){}}
function fnHandler_TableSelectTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&GetCurTable(a)&&(g_objLayerEventUtil.initHideDynamicLayer(),g_objTableMiniMenu.showTableMiniMenu(!1,null,a),g_objTableSelection.selectTable(a),updateTableHandlerUI.updateTableUIHandler(a))}catch(d){}}
function fnHandler_imageToTable(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&"undefined"!=typeof dzeUiConfig.bUseImageToTableMenu&&0!=dzeUiConfig.bUseImageToTableMenu&&"undefined"!=typeof dzeUiConfig.strImageToTableURL&&""!=dzeUiConfig.strImageToTableURL){var d=getSelectionControl(a);if(null!=d.controlObject&&"undefined"!=typeof d.controlObject&&"img"==d.controlObject.nodeName.toLowerCase())if(0===d.controlObject.src.indexOf("data:image/")&&0<d.controlObject.src.indexOf(";base64,"))alert(ID_RES_STRING_IMAGE_TO_TABLE_NOT_SUPPORT_IMAGE_SRC);
else if(!0===dzeUiConfig.bUseImageToTableURLParam){var e=dzeUiConfig.strImageToTableURL+"&__="+encodeURIComponent(btoa(d.controlObject.src));g_objCommonUtil.openWindowCommon(e,g_nPreviewWindowWidth,g_nPreviewWindowHeight,!0,"targetWin")}else{g_objCommonUtil.openWindowCommon("about:blank",g_nPreviewWindowWidth,g_nPreviewWindowHeight,!0,"targetWin");var f=document.createElement("form");f.action=dzeUiConfig.strImageToTableURL;f.method="post";f.target="targetWin";var g=document.createElement("input");
g.type="hidden";g.name="imgSrc";g.value=d.controlObject.src;f.appendChild(g);document.body.appendChild(f);f.submit();document.body.removeChild(f)}else g_objCommonUtil.openWindowCommon(dzeUiConfig.strImageToTableURL,g_nPreviewWindowWidth,g_nPreviewWindowHeight,!0,"targetWin")}}catch(h){}}
function fnHandler_TableAddNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=GetCurTable(a)){var d=!1;g_objTableSelection.doAllSelectedCell(function(a){var b=a.getElementsByTagName("p");if(0==b.length&&a.textContent){var c=a.textContent;var e=c.setComma();c!=e&&(d=!0,a.textContent=e)}for(a=0;a<b.length;a++)c=b[a].innerHTML,e=c.setComma(),c!=e&&(d=!0,b[a].innerHTML=e)});d&&g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableRemoveNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(null!=d){var e=!1;g_objTableSelection.doAllSelectedCell(function(a){var b=a.getElementsByTagName("p");if(0==b.length&&a.textContent){var c=a.textContent;var d=c.removeComma();c!=d&&(e=!0,a.textContent=d)}for(a=0;a<b.length;a++)c=b[a].innerHTML,d=c.removeComma(),c!=d&&(e=!0,b[a].innerHTML=d)},d);e&&g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(f){}}
function fnHandler_TableBorderThickness(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TableBorderThickness_Detail(c,b,a){fnHandler_TableBorderThickness(c,b,a)}function fnHandler_TableBorderType(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TableBorderType_Detail(c,b,a){fnHandler_TableBorderType(c,b,a)}function fnHandler_TableBorderColor(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(null!=d){var e=duzon_dialog.curr_table_border_backcolor[a],f=g_objTableUtil.getMatrix(d);if(f){var g=g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){g.setCellBorderColor(a,null,e,f)});commonUpdateAfterChange(a,d)}}}}catch(h){}}
function fnHandler_TableBorderColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(null!=d){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=g_objTableUtil.getMatrix(d);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_COLOR;duzon_dialog.viewExtendsDlg(b,a,function(b,c){var e=!0;"undefined"!=typeof c&&(e=c);1==e&&duzon_dialog.closeExtendsDlg();f.init();var g=
g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){g.setCellBorderColor(a,null,b,f)});1==e&&commonUpdateAfterChange(a,d)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(c){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("#FFFFFF",b);f.init();var e=g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){e.setCellBorderColor(a,null,"#FFFFFF",f)});commonUpdateAfterChange(a,d)},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,
"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c){duzon_dialog.selectColorCode(c,b);duzon_dialog.closeDialog();f.init();var e=g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){e.setCellBorderColor(a,null,c,f)});commonUpdateAfterChange(a,d)}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
"",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0)}}}catch(g){}}function fnHandler_TableStyle(c,b,a){try{fnHandler_TableStyle_Detail(c,b,a)}catch(d){}}
function fnHandler_TableStyle_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(d){var e=document.getElementById(b.id.replace(/_SUB/,""));e.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),g_objUndoRedo.registerUndoRedoStack(0,a),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_STYLE,duzon_dialog.viewExtendsDlg(b,a,null,[ID_RES_PROP_BUILDER_BLOCK_PROP_ITEM_APPLY,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.isTableStylePreviewApply?
(duzon_dialog.isTableStylePreviewApply=!1,duzon_dialog.closeExtendsDlg(),commonUpdateAfterChange(a,d)):alert(ID_RES_DIALOG_ALERT_SELECT_TABLE_STYLE)},function(b){duzon_dialog.closeExtendsDlg();d&&updateTableHandlerUI.updateTableUIHandler(a)}],"toolbar"))}}}catch(f){}}function fnHandler_TBSetImageHeight(c,b,a){try{TBSetImageWidthHeight(b,c,a)}catch(d){dalert(d)}}function fnHandler_TBSetImageWidth(c,b,a){try{TBSetImageWidthHeight(b,c,a)}catch(d){dalert(d)}}
function TBSetImageWidthHeight(c,b,a){try{g_objWrapperOutlineResize.resetExtOutlineInfo_call();var d=getSelectionControl(a).controlObject;if("undefined"==typeof d||null==d)if(d=dze_menu_control.currControlObject,null==d)return;if("img"==d.nodeName.toLowerCase()){var e=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_WIDTH][2]+"_"+a);e&&(widthValue=parseInt(e.value,10),d.style.width=widthValue+"px",d.offsetWidth!=widthValue&&(widthValue-=d.offsetWidth-widthValue,d.style.width=widthValue+
"px"));var f=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_HEIGHT][2]+"_"+a);f&&(heightValue=parseInt(f.value,10),d.style.height=heightValue+"px",d.offsetHeight!=heightValue&&(heightValue-=d.offsetHeight-heightValue,d.style.height=heightValue+"px"))}}catch(g){dalert(g)}}
function fnHandler_Help_ImageToTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HELP_IMAGE_TO_TABLE,duzon_dialog.getHelpImageToTableContentContainer(),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0,"screen_center")}catch(d){dalert(d)}}
function fnHandler_showContractFormBox(c,b){try{var a=c.target,d=InputDataBinderDlg;d.viewDialog(c,b,ID_RES_DIALOG_STRING_CUSTOM_INPUT_BOX,d.createCustomInputBoxDialog(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){d.setCustomInputBox(a);d.closeDialog()},function(){d.closeDialog()}],function(){d.initCustomInputBox(a)},function(){},!0,"screen_center")}catch(e){dalert(e)}}
function fnHandler_insertBindBox(c,b,a){try{if(!1!==dzeUiConfig.bUseDataBind&&(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))){var d=g_objEditorDocument[a].createElement("input");d.type="text";g_objPropertyUtil.element_addClass(d,"dze_external_data_area");d.style.fontFamily="\uad74\ub9bc";d.style.fontSize="9pt";d.setAttribute("readonly","");d.setAttribute("size","10");insertHTMLCodeAtSelection(d.outerHTML,null,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){dalert(e)}}
function fnHandler_initCursorRemove(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),g_objEditMode.removeChild(a,"a","id","dze_init_cursor",function(a){null!=a&&(1===a.nextSibling.data.length&&isZeroSpace(a.nextSibling.data)&&"tmpZeroSpace"===a.nextSibling.data.replace(/[\u200B-\u200D\uFEFF]/g,"tmpZeroSpace")&&a.parentNode.removeChild(a.nextSibling),a.parentNode.removeChild(a))}),g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),g_objLayerEventUtil.initHideDynamicLayer()}catch(d){dalert(d)}}
function fnHandler_initCursor(c,b,a){try{-1===a&&(a=g_nActiveEditNumber);var d=document.getElementById("TB_INIT_CURSOR_"+a);g_objPropertyUtil.element_hasClass(d,"duzon_tb_button_up")?(editor_onselectionchange(a),fnHandler_initCursorRemove(c,b,a)):(g_objEditMode.removeChild(a,"a","id","dze_init_cursor",function(a){null!=a&&a.parentNode.removeChild(a)}),fnAddHTMLContent("<a id='dze_init_cursor' class='dze_init_cursor_flag' title='\ucd08\uae30\uc124\uc815\uc704\uce58' style='text-decoration:none'></a>&#8203;",
null,0,a),g_objCaretUtil.moveCaret(g_objEditorDocument[a].getElementById("dze_init_cursor"),!1,!0),g_objUndoRedo.registerUndoRedoStack(0,a),g_objLayerEventUtil.initHideDynamicLayer(),editor_onselectionchange(a))}catch(e){dalert(e)}}
function fnHandler_showBindBox(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&c){var d=c.target;d&&"INPUT"===d.nodeName&&g_objPropertyUtil.hasClass(d,"dze_external_data_area")||(d=null);if(!d){var e=getSelectionElementNode(a);if(e&&"IMG"===e.nodeName&&g_objPropertyUtil.hasClass(e,"dze_stamp"))return fnHandler_ModifyStamp(c,b,a);e&&"INPUT"===e.nodeName&&g_objPropertyUtil.hasClass(e,"dze_external_data_area")&&(d=e)}if(d){var f=InputDataBinderDlg,g=InputFormatDlg,h=f.getTabContents(2,
[ID_RES_DIALOG_TAB_GENERAL,ID_RES_STRING_NUMBER_FORMAT],[f.createExternalDataBoxDialog(),g.getContent()],[60,80],'<div style="height:1px;width:1px;"></div>');f.viewDialog(c,a,ID_RES_STRING_BOX_PROP,h,2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){g_objInputFormatEvent.removeEditing(d);f.setExternalDataBoxStyle(d);var b=g.getFormatProp();if(b){b.setAttribute(d);var c=d.value,e=b.format(c);!fnObjectCheckNull(e)&&c!==e&&b.checkValid(c)&&(d.value=e)}f.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,
a)},function(){f.closeDialog()}],function(){f.viewTabContents(0);f.initExternalDataBoxDialog(d);g.onLoad(GetInputFormat(d))},function(){},!0,"relative")}}}catch(k){dalert(k)}}
function fnHandler_PasteCell(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){c=0;switch(b.command_id){case ID_COMMAND_PASTE_CELL_INSERT:c=INSERT_AS_NEW_ROWS;break;case ID_COMMAND_PASTE_CELL_OVER_ALL:c=PASTE_CELL_FORMMAT;break;case ID_COMMAND_PASTE_CELL_OVER_CONTENT:c=KEEP_ORG_TABLE_FORMMAT;break;case ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE:c=INSERT_AS_NESTED_TABLE;break;default:return}g_bBrowserType_IE&&dzeUiConfig.bUsePasteCapture?(dzeClipBoard.pasteType=
c,g_objCopyPaste.pasteClick(a)&&g_objEditorDocument[a].execCommand("paste",!1,null)):dzeClipBoard.copyData.length?(dzeClipBoard.pasteType=c,c==INSERT_AS_NEW_ROWS?dzeClipBoard.paste_insert(a,!0):dzeClipBoard.paste(a,!0),dzeClipBoard.pasteType=0):duzon_dialog.showToastMessage(null,ID_RES_CONST_STRING_NO_CELL_COPIED,1.5)}}catch(d){dalert(d)}}
function getAlignValueForSelectionArea(c){try{var b="";if(g_objTableSelection.isTableSelected(c))b=g_objTableUtil.getTableAlign(GetCurTable(c));else{var a={textAlign:""};g_objLetterFn.getSelectedParaStyle(c,a);b=a.textAlign}switch(b){case "left":case "start":return 1;case "center":return 2;case "right":case "end":return 3;case "justify":return 4}}catch(d){}return 0}
function fnHandler_ListStartNew(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!0===setListStartNew(a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){dalert(d)}}
function fnHandler_ListStartContinue(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!0===setListStartContinue(a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){dalert(d)}}
function fnHandler_InsertStamp(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurRange(a);if(d){d.collapse(!0);SetCurRange(d);var e=g_objEditorDocument[a].createElement("img");e.className="dze_stamp";e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAANmSURBVHhe7d1PbtNAHMXxGUPFEqmEXZYJCy5QzlCuUK5Aj4A4QnuF9gr0DPQCLHCX2REqsUSBDvPsn1M7f203jp/C+0hVMoEFzFczY7eV7N0O/Bq+PZ652di5MA7O4esVPvcuHGd/4cAE5+8T57/Hd/fxf5keuaP05eRbfP90rYMgwh/3++Sv8+8PdeKb8C75Gl9uB5P0Nv+kncZBbDWcBffwzj6SBYgTV811m1VTO4hCNIcwccVc2rCWWkGmw/HJgwsftDW1E8Nc1N3KtgaZDkdxVYRTG0pL3vmbweTu2oZrbQwSV8ZHbVG7U2cLWxvkx3D0GZexNpSd8enryd0nGyxJ7LUCK0MxuhLG+fyuthQkPzO0TXUJ84t5tmFFJQiupnSA7wfmGfNtw7lKkFju3N7KHuBWAvd3NszMg2za16QbuK/DzbYNM1kQVNK50Q/Me3mVZEEWK8l+lec/C6LV0a/yKklWnfSyf/hRBl6xQhSEAH6uhNdE2xUHXHFh25pf9kr/4uE+VhAqQUGY4BdEFIQIfltHQcgoCBFcaSkIGQUhoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMgpBREDIKQkZByCgIGQUhoyBkFISMghDJH3osNPAEagWhErRCuPhUQYjgQfkJDhIbS4/wnFw8fz155sIX+0z6lT3eO3nuXtR6zrd0q3jeeoJlguWSfSq9KM9/dqjHw2Trg9elO+X5z4JolfSnOMxt+PitE1TSFdf+xbPj0t5m5kGySy7nr2woexBXx4W9navcGOKk987f2FA6hHkurqzKKkFgMLm71nnSLcwv5tmGFUtBIN/XfGpD2SmfLp4bZd5eV8JD7/Vo1t3JV8b6GLAxCEyHo7PgwqkNpaX8zFi9TZVtDQJ4xHdcKec2lAbynwL6q1UH+Cq1ghS0hTWDLQr3d+Ubv20aBQE8YnrmZnEbU5h12oQoNA5Shq0svmA7++/jYGvCjzLw3fM2IQpPClKwVTOO/6z45Y8fXHiDx4jaHx+U4ttLceJ+xq94a+DTuBrSp0R45Nw/0wcKyXkmEJsAAAAASUVORK5CYII=";
e.setAttribute("dze_image_no_proportion","");e.setAttribute("alt",ID_RES_STRING_STAMP);e.style.width="75px";e.style.height="75px";insertHTMLCodeAtSelection(null,e,a);g_objTextWrap.setTextWrap(e,g_objTextWrap.IN_FRONT_OF_TEXT);setSelectionObjectInfo(!0,"img",e);showExtOutline_ObjectElement(e,!0,!1,a);var f=g_objTextWrap.getAnchor(e);f&&(d.selectNode(f),SetCurRange(d));g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a)}}}catch(g){dalert(g)}}
function fnHandler_ModifyStamp(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=getSelectionElementNode(a);if(d&&"IMG"===d.nodeName&&g_objPropertyUtil.hasClass(d,"dze_stamp")){var e=StampDataBinderDlg;e.viewDialog(c,a,ID_RES_STRING_MODIFY_STAMP,e.getContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){e.okClick(function(a){var b=function(b,c){fnObjectCheckNull(a[b])?""===a[b]&&d.removeAttribute(c||b):d.setAttribute(c||b,a[b])},
c=function(b,c){if(c=c||d)fnObjectCheckNull(a[b])?""===a[b]&&(c.style[b]="",""===c.style.cssText&&c.removeAttribute("style")):c.style[b]=a[b]};b("id");a.key&&(b("key","mapping_key"),g_objPropertyUtil.addClass(d,"dze_external_data_area"));b("src");b("alt");c("left",g_objTextWrap.getAnchor(d));c("top",g_objTextWrap.getAnchor(d));c("width");c("height");c("opacity")});e.closeDialog()},function(){e.closeDialog()}],function(){e.onLoad(d)},function(){},!0,"screen_center")}}}catch(f){dalert(f)}}
function fnHandler_lockEditTableSize(c,b,a){try{if(!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode&&(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))){var d=GetCurTable(a);d&&(c=DZE_CUSTOM_ATT_TABLE_RESIZE,"n"===d.getAttribute(c)?d.removeAttribute(c):d.setAttribute(c,"n"),commonUpdateAfterChange(a,d))}}catch(e){dalert(e)}};

var g_objEditMode=new function(){this.ID_FORM_TYPE_DISABLE=0;this.ID_FORM_TYPE_MANAGER=1;this.ID_FORM_TYPE_USER=2;this.strCusEditContainer="editcell";this.strCusEditField="editfield";this.bWriteAreaSetMouseMoveING=this.bRestrictAreaMouseDown=!1;this.ID_EDIT_MODE_BORDER_STYLE_DOTTED="dotted";this.ID_WRITE_AREA_SET_BORDER_WIDTH="1px";this.ID_WRITE_AREA_SET_BORDER_COLOR="#FE0000";this.ID_SHOW_EDITABLE_AREA_BORDER_WIDTH="1px";this.ID_SHOW_EDITABLE_AREA_BORDER_COLOR="#0000FE";this.arrWriteAreaSet=[];this.arrShowEditableAreaOrder=
[];this.strCusDisableContainer="disablecell";this.strCusDisableField="disablefield";this.strDisableColor="#dedede";this.strTempString_Head="!#@$";this.strTempString_Tail="^$%#";this.strDivFormCodeBgColor="rgba(221, 221, 221, 0.5)";this.strCusFormCode="cusFormCode";this.strCusParentClassName="cusParentClassName";this.strCusParentIDSettingName="cusParentIDSettingName";this.strCusRestrictCell="cusRestrictCell";this.strCusRestrictWidth="cusRestrictWidth";this.strDivFormCodeContainerClassName="formCodeContainer";
this.strDivFormCodeCloseContainerClassName="formCodeCloseContainer";this.strDivFormCodeCloseClassName="formCodeClose";this.strDivFormCodeContentClassName="formCodeContent";this.strDivFormCodeContentSubClassName="formCodeContentSub";this.strDivFormCodeContentTableClassName="formCodeContentTable";this.strFormCodeConvertDoneClassName="formCodeConvertDone";this.strReservedFormCode="dzFormCode";this.arrTempRestrictCell=[];this.switchWriteAreaSet=function(a,c,b,d){try{if(c){var e=this.checkWriteArea_In_Children(a,
b);if(null==e){var f=g_objEditorDocument[d].createElement("div");if(b==this.ID_FORM_TYPE_MANAGER||b==this.ID_FORM_TYPE_USER)g_objPropertyUtil.setTargetCellFlagString(f,this.strCusEditField,"true");else return null;for(;0<a.childNodes.length;){var g=a.childNodes[0];f.appendChild(g)}a.appendChild(f);if(b==this.ID_FORM_TYPE_MANAGER||b==this.ID_FORM_TYPE_USER){a=!1;for(c=0;c<f.childNodes.length;c++)if(g=f.childNodes[c],ID_SELECTION_ELEMENT_NODE==g.nodeType){a=!0;break}else if(ID_SELECTION_TEXT_NODE==
g.nodeType&&!checkTextNodeAllWhiteCode(g.nodeValue)){a=!0;break}a||(f.innerHTML="<p><br /></p>");b==this.ID_FORM_TYPE_MANAGER&&this.switchWriteAreaBorder(f,!0)}else return null;return f}b==this.ID_FORM_TYPE_MANAGER&&this.switchWriteAreaBorder(e,!0);return e}e=this.checkWriteArea_In_Children(a,b);if(null!=e){for(var h=g_objNodeUtil.getParentElement(e);0<e.childNodes.length;)g=e.childNodes[0],h.insertBefore(g,e);h.removeChild(e)}}catch(k){dalert(k)}return null};this.checkWriteArea_In_Children=function(a,
c){try{for(var b=0;b<a.childNodes.length;b++){var d=this.checkLoopWriteArea_In_Children(a.childNodes[b],c);if(null!=d)return d}}catch(e){dalert(e)}return null};this.checkLoopWriteArea_In_Children=function(a,c){try{if(ID_SELECTION_ELEMENT_NODE!=a.nodeType)return null;for(var b=0;b<a.childNodes.length;b++){var d=this.checkLoopWriteArea_In_Children(a.childNodes[b],c);if(null!=d)return d}if("div"==g_objNodeUtil.getElementTagName(a).toLowerCase()&&(c==this.ID_FORM_TYPE_MANAGER||c==this.ID_FORM_TYPE_USER)&&
"true"==g_objPropertyUtil.getTargetCellFlagString(a,this.strCusEditField))return a}catch(e){dalert(e)}return null};this.setupDefined_WriteAreaSet=function(a,c){try{if(1==g_nFormEditMode&&!fnObjectCheckNull(g_objEditorDocument[c])){var b=g_objNodeUtil.getEventSrcElement(a);if(!fnObjectCheckNull(b)&&"table"!=g_objNodeUtil.getElementTagName(b).toLowerCase()){var d=g_objNodeUtil.getLoopParentElementByTagNames(b,["td","th"]);fnObjectCheckNull(d)||("true"==g_objPropertyUtil.getTargetCellFlagString(d,this.strCusEditContainer)?
(d.removeAttribute(this.strCusEditContainer),this.switchWriteAreaSet(d,!1,this.ID_FORM_TYPE_MANAGER,c)):(g_objPropertyUtil.setTargetCellFlagString(d,this.strCusEditContainer,"true"),this.switchWriteAreaSet(d,!0,this.ID_FORM_TYPE_MANAGER,c)))}}}catch(e){dalert(e)}};this.showAllWriteAreaSet=function(a,c){try{if(1==g_nFormEditMode)for(var b=g_objEditorDocument[a].body.querySelectorAll("td, th"),d=0;d<b.length;d++)"true"==g_objPropertyUtil.getTargetCellFlagString(b[d],this.strCusEditContainer)&&this.switchWriteAreaSet(b[d],
c,this.ID_FORM_TYPE_MANAGER,a)}catch(e){dalert(e)}};this.switchWriteAreaBorder=function(a,c){try{a&&(c?(a.style.borderStyle=this.ID_EDIT_MODE_BORDER_STYLE_DOTTED,a.style.borderWidth=this.ID_WRITE_AREA_SET_BORDER_WIDTH,a.style.borderColor=this.ID_WRITE_AREA_SET_BORDER_COLOR):(a.style.borderStyle="",a.style.borderWidth="",a.style.borderColor=""))}catch(b){dalert(b)}};this.initShowEditableArea=function(a){try{2==g_nFormEditMode&&(this.initAssignAreaToArray(a),this.showAllContentEditableArea(a,!0),g_objUndoRedo.registerInitialContentStack(a))}catch(c){dalert(c)}};
this.initAssignAreaToArray=function(a){try{if(2==g_nFormEditMode){this.arrShowEditableAreaOrder[a]=[];for(var c=g_objEditorDocument[a].body.querySelectorAll("td, th"),b=0;b<c.length;b++)"true"==g_objPropertyUtil.getTargetCellFlagString(c[b],this.strCusEditContainer)&&this.arrShowEditableAreaOrder[a].push(c[b])}}catch(d){dalert(d)}};this.showAllContentEditableArea=function(a,c){try{if(2==g_nFormEditMode)if(c)for(var b=0;b<this.arrShowEditableAreaOrder[a].length;b++){var d=this.arrShowEditableAreaOrder[a][b],
e=this.switchWriteAreaSet(d,!0,this.ID_FORM_TYPE_USER,a);e&&(e.contentEditable="true",this.showEditableAreaBorder(e,!0))}else for(b=0;b<this.arrShowEditableAreaOrder[a].length;b++)d=this.arrShowEditableAreaOrder[a][b],this.switchWriteAreaSet(d,!1,this.ID_FORM_TYPE_USER,a)}catch(f){dalert(f)}};this.showEditableAreaBorder=function(a,c){try{a&&(c?(a.style.borderStyle=this.ID_EDIT_MODE_BORDER_STYLE_DOTTED,a.style.borderWidth=this.ID_SHOW_EDITABLE_AREA_BORDER_WIDTH,a.style.borderColor=this.ID_SHOW_EDITABLE_AREA_BORDER_COLOR):
(a.style.borderStyle="",a.style.borderWidth="",a.style.borderColor=""))}catch(b){dalert(b)}};this.getLoopContentEditable=function(a){try{if(2!=g_nFormEditMode||null==a)return!1;var c="";a.contentEditable&&(c=a.contentEditable.toLowerCase());if("true"==c)return!0;var b=g_objNodeUtil.getParentElement(a);return fnObjectCheckNull(b)?!1:this.getLoopContentEditable(b)}catch(d){dalert(d)}return!1};this.isLoopContentEditable=function(a){try{for(;a&&(a.nodeType!=ID_SELECTION_ELEMENT_NODE||"dze_document_container"!=
a.className&&"body"!=a.tagName.toLowerCase());){if(a.contentEditable){var c=a.contentEditable.toLowerCase();if("true"==c)break;else if("false"==c)return!1}a=a.parentNode}return!0}catch(b){dalert(b)}};this.restrictWriteArea_onmousedown=function(a,c){try{this.bWriteAreaSetMouseMoveING=!0;if(fnObjectCheckNull(g_objEditorDocument[c]))return!0;var b=g_objNodeUtil.getEventSrcElement(a);if(fnObjectCheckNull(b))return!0;if(this.getLoopContentEditable(b)){this.bRestrictAreaMouseDown=!1;if(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)editor_onfocus(a,c),editor_onselectionchange(c);return!1}this.bRestrictAreaMouseDown=!0;g_bBrowserType_WK||TBCancelBubbleEvent(a)}catch(d){dalert(d)}return!0};this.restrictWriteArea_onmousemove=function(a,c){try{if(fnObjectCheckNull(g_objEditorDocument[c]))return!0;var b=g_objNodeUtil.getEventSrcElement(a);if(fnObjectCheckNull(b))return!0;if(this.getLoopContentEditable(b))if(this.bRestrictAreaMouseDown&&this.bWriteAreaSetMouseMoveING)g_objEditorDocument[c].body.style.cursor=
"not-allowed",TBCancelBubbleEvent(a);else return g_objEditorDocument[c].body.style.cursor="default",!1;else g_objEditorDocument[c].body.style.cursor="not-allowed",TBCancelBubbleEvent(a)}catch(d){dalert(d)}return!0};this.restrictWriteArea_onmouseup=function(a,c){try{this.bWriteAreaSetMouseMoveING=!1;if(fnObjectCheckNull(g_objEditorDocument[c]))return!0;var b=g_objNodeUtil.getEventSrcElement(a);if(fnObjectCheckNull(b))return!0;if(this.getLoopContentEditable(b))return!1;TBCancelBubbleEvent(a)}catch(d){dalert(d)}return!0};
this.checkSelectionContentEditableArea=function(a){try{if(2!=g_nFormEditMode)return!0;if(window.attachEvent)var c=g_objEditorDocument[a].selection,b=c.createRange(),d=b.parentElement();else{c=g_objEditWindow[a].getSelection();if(1!=c.rangeCount)return!1;b=c.getRangeAt(0);d=b.commonAncestorContainer}return this.getLoopContentEditable(d)}catch(e){dalert(e)}return!0};this.checkSelectionContentEditable=function(a){try{if(!1===dzeUiConfig.bUseLockEditCellFunction||!g_objEditWindow[a].getSelection)return!0;
var c=g_objEditWindow[a].getSelection();if(1>c.rangeCount)return!0;var b=c.getRangeAt(0);if(0==this.isLoopContentEditable(b.commonAncestorContainer))return!1;var d=!0;g_objNodeUtil.traverseNodesInRange(b,function(a){a.nodeType==ID_SELECTION_ELEMENT_NODE&&"false"==a.getAttribute("contenteditable")&&(d=!1);return d});return d}catch(e){dalert(e)}};this.setInputFormClickable=function(a){try{for(var c=g_objEditorDocument[a].getElementsByTagName("input"),b,d,e,f=0;f<c.length;f++)if(b=c[f],"checkbox"===
b.type||"radio"===b.type)d=g_objNodeUtil.getParentElement(b),!0===fnObjectCheckNull(d)||"p"!==d.nodeName.toLowerCase()&&"span"!==d.nodeName.toLowerCase()?(e=g_objEditorDocument[a].createElement("span"),e.setAttribute("contenteditable",!1),e.setAttribute("style","-moz-user-select: auto"),d.insertBefore(e,b),e.appendChild(b)):"false"!==d.getAttribute("contenteditable")&&(d.setAttribute("contenteditable",!1),d.setAttribute("style","-moz-user-select: auto"))}catch(g){dalert(g)}};this.convertFormCodeString=
function(a,c){try{if("undefined"!=typeof dzeUiConfig.arrFormCodeString&&0!=dzeUiConfig.arrFormCodeString.length){for(var b=g_objEditorDocument[a].body.innerHTML,d=[],e=0;e<dzeUiConfig.arrFormCodeString.length;e++)-1!=b.indexOf(dzeUiConfig.arrFormCodeString[e][0])&&d.push(e);if(0!=d.length){if(window.attachEvent)g_objEditorDocument[a].selection.empty();else{var f=g_objEditWindow[a].getSelection();f&&f.removeAllRanges()}b=[];this.setTempFormCodeString(d,b,a);this.replaceFormCodeString(b,a);this.doReservedCallback(a);
if(c){for(e=0;e<b.length;e++)if(""!=b[e][6]){alert(b[e][6]);break}for(e=0;e<b.length;e++)if(1==b[e][5][0]){var g=g_objEditorDocument[a].getElementsByTagName("div");for(c=0;c<g.length;c++){var h=g[c];if(g_objPropertyUtil.element_hasClass(h,this.strDivFormCodeContainerClassName)){var k=g_objNodeUtil.getLoopParentElementByTagNames(h,["td","th"]);if(k){var m=h.getAttribute(this.strCusRestrictCell);if(!fnObjectCheckNull(m)){parseInt(b[e][5][1],10);var n=parseInt(b[e][5][2],10);g_objTableUtil.setNodeValue_Height(k,
n,"px")}}}}}}}}}catch(l){dalert(l)}};this.setTempFormCodeString=function(a,c,b){try{for(var d=0;d<a.length;d++){var e=a[d];this.loopSetTempFormCodeString(g_objEditorDocument[b].body,dzeUiConfig.arrFormCodeString[e][0],c,e)}}catch(f){dalert(f)}};this.loopSetTempFormCodeString=function(a,c,b,d){try{for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(ID_SELECTION_ELEMENT_NODE==f.nodeType)g_objPropertyUtil.element_hasClass(f,this.strDivFormCodeContainerClassName)||this.loopSetTempFormCodeString(f,
c,b,d);else if(ID_SELECTION_TEXT_NODE==f.nodeType){var g=f.nodeValue;if(-1!=g.indexOf(c)){var h=this.strTempString_Head+c+this.strTempString_Tail;g=g.replace(c,h);f.nodeValue=g;this.registerTempFormCodeArray(b,h,d)}}}}catch(k){dalert(k)}};this.registerTempFormCodeArray=function(a,c,b){try{var d=[];d[0]=c;d[1]=dzeUiConfig.arrFormCodeString[b][0];d[2]=dzeUiConfig.arrFormCodeString[b][1];d[3]=dzeUiConfig.arrFormCodeString[b][3];d[4]=dzeUiConfig.arrFormCodeString[b][4];d[5]=dzeUiConfig.arrFormCodeString[b][5];
d[6]=dzeUiConfig.arrFormCodeString[b][6];d[7]=dzeUiConfig.arrFormCodeString[b][7];d[8]="boolean"==typeof dzeUiConfig.arrFormCodeString[b][8]?dzeUiConfig.arrFormCodeString[b][8]:!0;a.push(d)}catch(e){dalert(e)}};this.replaceFormCodeString=function(a,c){try{if(0!=a.length){for(var b=g_objEditorDocument[c].body.innerHTML,d=0;d<a.length;d++){var e=a[d][0],f=this.makeFormCodeDisplayHTML(a[d]);null!=f&&""!=f&&(b=b.replace(e,f))}g_objEditorDocument[c].body.innerHTML=b;this.initDivFormCodeObject(c);this.initDivFormCodeObjectEvent(c)}}catch(g){dalert(g)}};
this.makeFormCodeDisplayHTML=function(a){try{return 2===Number(a[3][0])?this.makeInlineFormCodeDisplayHTML(a):this.makeBlockFormCodeDisplayHTML(a)}catch(c){dalert(c)}};this.makeBlockFormCodeDisplayHTML=function(a){try{var c=a[1],b=a[2],d=Number(a[3][0]),e=a[3][1],f=Number(a[3][2]),g=a[4],h=Number(a[5][0]),k=Number(a[5][1]),m=a[7],n=a[8];a="";var l=!1;1==d&&1==f&&(l=!0);l?(l="background:url("+e+") no-repeat;background-size:100% 100%;",1==h?(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+
'" ',a+=' style="height:100%;border:1px solid #ff0000;',a+=" "+l,a+=" background-color:"+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+m+'" ',a+=" "+this.strCusParentClassName+'="'+g+'" ',a+=" "+this.strCusRestrictCell+'="true" '+this.strCusRestrictWidth+'="'+k+'">'):(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+'" ',a+=' style="width:100%;height:100%;',a+=" "+l,a+=" background-color:"+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+
'="'+m+'" ',a+=" "+this.strCusParentClassName+'="'+g+'">')):1==h?(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+'" ',a+=' style="height:100%;border:1px solid #ff0000;',a+=" background-color:"+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+m+'" ',a+=" "+this.strCusParentClassName+'="'+g+'" ',a+=" "+this.strCusRestrictCell+'="true" '+this.strCusRestrictWidth+'="'+k+'">'):(a+='<div contentEditable="false" class="'+this.strDivFormCodeContainerClassName+
'" ',a+=' style="width:100%;height:100%;background-color:'+this.strDivFormCodeBgColor+';" ',a+=" "+this.strCusParentIDSettingName+'="'+m+'" ',a+=" "+this.strCusParentClassName+'="'+g+'">');if(n){var p="border:1px solid "+this.strDivFormCodeBgColor+";";a+='<div class="'+this.strDivFormCodeCloseContainerClassName+'" style="float:right;margin:1px 1px 1px -20px;">';a+='<img class="'+this.strDivFormCodeCloseClassName+'" src="'+dzeEnvConfig.strPath_Image+'toolbar/minibar_btn_delete.gif" alt="" width="12" height="12" style="'+
p+'" />';a+="</div>"}a+='<div class="'+this.strDivFormCodeContentClassName+'" '+this.strCusFormCode+'="'+c+'" style="height:100%;">';0==d?(a+='<div class="'+this.strDivFormCodeContentSubClassName+'" style="padding:0px;margin:0px;width:100%;height:100%;border:0px;">',a+='<div class="'+this.strDivFormCodeContentTableClassName+'" style="display:table;width:90%;height:100%;" >',a+='<div style="display:table-cell;vertical-align:middle;">',a+='<div style="margin-left:auto;margin-right:auto;width:100%;">',
a+='<span style="color:'+b+';">'+e+"</span>",a+="</div>",a+="</div>",a+="</div>",a+="</div>"):1==d?1==f?a+="&nbsp;":(a+='<div style="display:table;width:90%;height:100%;" >',a+='<div style="display:table-cell;vertical-align:middle;">',a+='<div style="margin-left:auto;margin-right:auto;width:100%;text-align:center;">',a+='<img src="'+e+'" style="border:1px solid #00ffff;" />',a+="</div>",a+="</div>",a+="</div>"):a+="&nbsp;";return a+"</div></div>"}catch(r){dalert(r)}return null};this.makeInlineFormCodeDisplayHTML=
function(a){try{var c=a[1]||"",b=a[2]?"color:"+b+";":"",d=a[3][1];a="";a+='<input readonly dze_auto_resize tabindex="-1"';a+=' class="'+this.strDivFormCodeContainerClassName+'"';a+=" "+this.strCusFormCode+'="'+c+'"';a+=' value="'+d+'"';a+=' style="background-color:'+this.strDivFormCodeBgColor+";"+b+'"';return a+"/>"}catch(e){dalert(e)}};this.doReservedCallback=function(a){try{if(""!=dzeUiConfig.strChangeFormCodeFunction){var c=!1,b=g_objEditorDocument[a],d=b.body.querySelectorAll("div."+this.strDivFormCodeContainerClassName),
e=b.body.querySelectorAll("input."+this.strDivFormCodeContainerClassName);b=0;for(var f=dzeUiConfig.arrFormCodeString.length;b<f;b++){var g=this.getCountFormCodeString(dzeUiConfig.arrFormCodeString[b][0],d,e);dzeUiConfig.arrFormCodeString[b][2]!==g&&(dzeUiConfig.arrFormCodeString[b][2]=g,c=!0)}c&&eval(dzeUiConfig.strChangeFormCodeFunction+"("+a+", 0);")}}catch(h){dalert(h)}};this.doChangeCellCallback=function(a){try{if("undefined"!=typeof dzeUiConfig.strChangeFormCodeFunction&&""!=dzeUiConfig.strChangeFormCodeFunction){for(var c=
g_objEditorDocument[a].querySelectorAll("."+this.strDivFormCodeContainerClassName),b=0;b<c.length;b++){var d=c[b],e=d.getAttribute(this.strCusRestrictCell);if(!fnObjectCheckNull(e)){var f=this.getModule_include_byElementClassName(d,this.strDivFormCodeContentClassName);if(f){var g=f.getAttribute(this.strCusFormCode);if(!fnObjectCheckNull(g)){var h=this.getIndexFormCodeString(g);if(-1!=h){var k=g_objNodeUtil.getLoopParentElementByTagNames(d,["td","th"]);dzeUiConfig.arrFormCodeString[h][5][1]=k.offsetWidth;
dzeUiConfig.arrFormCodeString[h][5][2]=k.offsetHeight}}}}}eval(dzeUiConfig.strChangeFormCodeFunction+"("+a+", 1);")}}catch(m){dalert(m)}};this.getIndexFormCodeString=function(a){try{for(var c=0;c<dzeUiConfig.arrFormCodeString.length;c++)if(a==dzeUiConfig.arrFormCodeString[c][0])return c}catch(b){dalert(b)}return-1};this.getCountFormCodeString=function(a,c,b){try{var d=0;if(c)for(var e=0,f=c.length;e<f;e++){var g=this.getModule_include_byElementClassName(c[e],this.strDivFormCodeContentClassName);if(g){var h=
g.getAttribute(this.strCusFormCode);fnObjectCheckNull(h)||a==h&&d++}}if(b)for(e=0,f=b.length;e<f;e++)h=b[e].getAttribute(this.strCusFormCode),fnObjectCheckNull(h)||a==h&&d++;return d}catch(k){dalert(k)}return 0};this.initDivFormCodeObject=function(a){try{var c=g_objEditorDocument[a],b=c.getElementsByTagName("div");for(a=0;a<b.length;a++){var d=b[a];if(g_objPropertyUtil.element_hasClass(d,this.strDivFormCodeContainerClassName)&&!g_objPropertyUtil.element_hasClass(d,this.strFormCodeConvertDoneClassName)){var e=
g_objNodeUtil.getLoopParentElementByTagNames(d,["td","th"]);if(null==e){var f=!0,g=g_objPropertyUtil.getBackgroundImageURL(d);if(null!=g&&""!=g){var h=d.getAttribute(this.strCusRestrictCell);fnObjectCheckNull(h)||(f=!1)}f&&(d.style.width="",d.style.height="");d.style.display="table-cell";var k=this.getModule_include_byElementClassName(d,this.strDivFormCodeCloseContainerClassName);k&&(k.style.margin="1px");var m=this.getModule_include_byElementClassName(d,this.strDivFormCodeContentClassName);if(m){m.style.height=
"";f&&(m.style.padding="8px 20px 5px 10px");var n=this.getModule_include_byElementClassName(m,this.strDivFormCodeContentSubClassName);if(n){n.style.height="";var l=this.getModule_include_byElementClassName(n,this.strDivFormCodeContentTableClassName);l&&(l.style.width="",l.style.height="")}}}else{this.removeOtherChild(e,d,this.strDivFormCodeContainerClassName);h=d.getAttribute(this.strCusRestrictCell);if(!fnObjectCheckNull(h)){var p=d.getAttribute(this.strCusRestrictWidth);fnObjectCheckNull(p)||parseInt(p,
10)}var r=d.getAttribute(this.strCusParentClassName);if(!fnObjectCheckNull(r)&&""!=r){var q=r.split(" ");for(f=0;f<q.length;f++)if(!e||!e.style.textAlign||"textL"!==q[f]&&"textR"!==q[f]&&"textC"!==q[f])g_objPropertyUtil.element_hasClass(e,q[f])||g_objPropertyUtil.element_addClass(e,q[f])}var t=d.getAttribute(this.strCusParentIDSettingName);if(!fnObjectCheckNull(t)&&""!=t){var u=e.getAttribute("id");null==u||""==u?e.id=t:t!=u&&(e.setAttribute("previd",u),e.id=t)}}g_objPropertyUtil.element_addClass(d,
this.strFormCodeConvertDoneClassName)}}var v=c.body.querySelectorAll("input.formCodeContainer");a=0;for(var w=v.length;a<w;a++)g_objPropertyUtil.element_hasClass(v[a],this.strFormCodeConvertDoneClassName)||(resizeInput(v[a],null,100),g_objPropertyUtil.element_addClass(v[a],this.strFormCodeConvertDoneClassName))}catch(x){dalert(x)}};this.initDivFormCodeObjectEvent=function(a){try{for(var c=g_objEditorDocument[a].getElementsByTagName("div"),b=0;b<c.length;b++){var d=c[b];if(g_objPropertyUtil.element_hasClass(d,
this.strDivFormCodeContainerClassName)){var e=this.getModule_include_byElementClassName(d,this.strDivFormCodeCloseClassName);e&&(e.onmouseover=function(a){this.style.border="1px solid #000000"},e.onmouseout=function(a){this.style.border="1px solid #dddddd"},e.onclick=function(b){g_objEditMode.clickDivFormCodeClose(this,a)})}}}catch(f){dalert(f)}};this.removeOtherChild=function(a,c,b){try{if(!fnObjectCheckNull(a)){for(;0<a.childNodes.length;)a.removeChild(a.childNodes[0]);a.appendChild(c)}}catch(d){dalert(d)}};
this.clickDivFormCodeClose=function(a,c){try{var b=this.getModule_loopParent_byElementClassName(a,this.strDivFormCodeContainerClassName);if(b){var d=g_objNodeUtil.getLoopParentElementByTagNames(b,["td","th"]);if(d){var e=b.getAttribute(this.strCusParentClassName);if(!fnObjectCheckNull(e)&&""!=e){var f=e.split(" ");for(a=0;a<f.length;a++)g_objPropertyUtil.element_hasClass(d,f[a])&&g_objPropertyUtil.element_removeClass(d,f[a])}var g=b.getAttribute(this.strCusParentIDSettingName);if(!fnObjectCheckNull(g)&&
""!=g){var h=d.getAttribute("previd");null==h||""==h?d.removeAttribute("id"):d.id=h}}var k=this.getModule_include_byElementClassName(b,this.strDivFormCodeContentClassName);if(k){var m=k.getAttribute(this.strCusFormCode);if(!fnObjectCheckNull(m)){var n=g_objNodeUtil.getParentElement(b);n.removeChild(b);this.doReservedCallback(c);var l=g_objNodeUtil.getClosest(n,g_objNodeUtil.isCell);l&&!l.firstChild&&(l.innerHTML="<p><br></p>");g_objUndoRedo.registerUndoRedoStack(0,c)}}}}catch(p){dalert(p)}};this.getModule_include_byElementClassName=
function(a,c){try{for(var b=0;b<a.childNodes.length;b++){var d=a.childNodes[b];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(g_objPropertyUtil.element_hasClass(d,c))return d;var e=this.getModule_include_byElementClassName(d,c);if(e)return e}}}catch(f){dalert(f)}return null};this.getModule_loopParent_byElementClassName=function(a,c){try{if(null==a)return null;var b=g_objNodeUtil.getElementTagName(a).toLowerCase();if("body"==b)return null;if("div"==b&&g_objPropertyUtil.element_hasClass(a,c))return a;
for(;;){var d=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(d))break;b=g_objNodeUtil.getElementTagName(d).toLowerCase();if("body"==b)break;if("div"==b&&g_objPropertyUtil.element_hasClass(d,c))return d;a=d;if(fnObjectCheckNull(a))break}}catch(e){dalert(e)}return null};this.restoreFormCodeString=function(a){try{var c=g_objEditorDocument[a];for(a=!1;;){a=!1;for(var b=c.body.querySelectorAll("div."+this.strDivFormCodeContainerClassName),d=0,e=b.length;d<e;d++){var f=b[d],g=this.getModule_include_byElementClassName(f,
this.strDivFormCodeContentClassName);if(g){var h=g.getAttribute(this.strCusFormCode);if(!fnObjectCheckNull(h)){var k=c.createTextNode(h),m=g_objNodeUtil.getParentElement(f);m.insertBefore(k,f);m.removeChild(f);a=!0;break}}}if(!a)break}var n=c.body.querySelectorAll("input."+this.strDivFormCodeContainerClassName);d=0;for(e=n.length;d<e;d++){var l=n[d];h=l.getAttribute(this.strCusFormCode);fnObjectCheckNull(h)||(k=c.createTextNode(h),l.parentNode.replaceChild(k,l))}}catch(p){dalert(p)}};this.checkDropReservedFormCode=
function(a){try{for(var c=!1,b=g_objEditorDocument[a].getElementsByTagName("a"),d=0;d<b.length;d++){var e=b[d],f=e.getAttribute(this.strReservedFormCode);if(!fnObjectCheckNull(f)){var g=g_objEditorDocument[a].createTextNode(f);g_objNodeUtil.getParentElement(e).replaceChild(g,e);d--;c=!0}}c&&this.convertFormCodeString(a,!0)}catch(h){dalert(h)}};this.setEditModeAreaWidth=function(a,c){try{var b=g_objParent_EditObject[c].clientWidth;if(a<b){if(a=b-a,0<a){var d=parseInt(a/2,10);g_objParent_EditObject[c].style.paddingLeft=
d+"px";g_objParent_EditObject[c].style.paddingRight=d+"px";g_objParent_EditObject[c].style.backgroundColor="#9d9d9d"}}else g_objParent_EditObject[c].style.paddingLeft="0px",g_objParent_EditObject[c].style.paddingRight="0px",g_objParent_EditObject[c].style.backgroundColor="#9d9d9d"}catch(e){dalert(e)}};this.removeChild=function(a,c,b,d,e){a=g_objEditorDocument[a].getElementsByTagName(c);for(c=0;c<a.length;c++)a[c][b]===d&&e(a[c])};this.setZeroSpaceCodeToEmptyTd=function(a,c){try{c=c||g_objEditorDocument[a].body;
g_objCaretUtil.saveCaret(a);var b=c.querySelectorAll("td, th");for(c=0;c<b.length;c++){if(0==b[c].childNodes.length)""!=b[c].innerHTML.trim()||window.attachEvent||(b[c].innerHTML="<p><br /></p>");else for(var d=0;d<b[c].childNodes.length;d++)if("p"==b[c].childNodes[d].nodeName.toLowerCase()){""!=b[c].childNodes[d].innerHTML.trim()||window.attachEvent||(b[c].childNodes[d].innerHTML="<br />");break}g_objTagUtil.updateCurFormTagAttr(a);g_objNodeUtil.clean(b[c])}g_objCaretUtil.restoreCaret(a)}catch(e){dalert(e)}};
this.rangeTabInsert=function(a,c){try{var b=null,d=null;g_objNodeUtil.traverseNodesInRange(GetCurRange(a),function(a){if((a=g_objNodeUtil.getLoopParentElement(a,"p"))&&b!==a){var c=g_objEditMode.createTabSpan();a.insertBefore(c,a.firstChild);null===b&&(d=c)}b=a});void 0!=c&&c(d)}catch(e){alert(e)}};this.createTabSpan=function(){var a=document.createElement("span");a.className="tabSpan";a.style.whiteSpace="pre";a.innerHTML="\t";return a};this.removeChild=function(a,c,b,d,e){a=g_objEditorDocument[a].getElementsByTagName(c);
for(c=0;c<a.length;c++)a[c][b]===d&&e(a[c])};this.chkRangeLineCount=function(a){var c=1;g_objNodeUtil.traverseNodesInRange(GetCurRange(a),function(a){"P"===a.nodeName&&c++});return c}};

var g_objTableMultiCell=new function(){this.setMultiCellCommand_Common=function(c,b,a,d,f){try{var q=GetMultiCellSelection(c),n=GetCurTable(c);if(q&&2===b&&d!==ID_LETTER_OPERATION_HEADING_SIZE&&d!==ID_LETTER_OPERATION_OUTDENT_INDENT&&d!==ID_LETTER_OPERATION_BACK_COLOR)g_objTableSelection.doAllSelectedCell(function(a){0==g_objNodeUtil.getTextNodesIn(a,function(a,b){if("TD"!==b.nodeName&&"TH"!==b.nodeName||/^\s+$/.test(a.nodeValue)){var e=[{check:"span"},{check:"a"},{check:"b"},{check:"strong"},{check:"i"},
{check:"em"},{check:"u"},{check:"strike"},{check:"s"},{check:"sup"},{check:"sub"},{check:"font"},{check:"p"},{check:"li"},{check:"dt"},{check:"dd"}];b=(b=g_objNodeUtil.getParentElementForTargetTags(a,e,e.length,"td",!0))?b:g_objNodeUtil.getParentElementForTargetTags(a,e,e.length,"th",!0)}else e=g_objEditorDocument[c].createElement("p"),e.appendChild(a),b.appendChild(e),b=e;return b?(g_objLetterFn.isRemove_LetterOperation(d,f)?g_objLetterFn.removeNodeStyle(b,d):g_objLetterFn.doLetterOperationStyleApply(b,
d,f),!0):!1},!0).length&&(a=g_objNodeUtil.getLoopChildNodeByTagName(a,"p"),g_objLetterFn.isRemove_LetterOperation(d,f)?g_objLetterFn.removeNodeStyle(a,d):g_objLetterFn.doLetterOperationStyleApply(a,d,f))},n);else{var h=g_objTableFunction.getCurrentCell(c),e=null,k=null;if(window.attachEvent){e=g_objEditorDocument[c].selection;if(fnObjectCheckNull(e))return;k=e.createRange();if(fnObjectCheckNull(k))return}else{e=g_objEditWindow[c].getSelection();if(fnObjectCheckNull(e))return;e.removeAllRanges()}var p=
0,r=["Bold","Italic","Underline","StrikeThrough"],m=0,l=null;g_objTableSelection.doAllSelectedCell(function(g){p++;window.attachEvent?(k.moveToElementText(g),k.select()):e.selectAllChildren(g);if(1==b)if(inArray(a,r))try{1==p?(l=g_objEditorDocument[c].queryCommandState(a),0==l&&(m=1),g_objEditorDocument[c].execCommand(a,!1,null)):(l=g_objEditorDocument[c].queryCommandState(a),(1==m&&0==l||0==m&&0!=l)&&g_objEditorDocument[c].execCommand(a,!1,null))}catch(u){g_objEditorDocument[c].execCommand(a,!1,
null)}else g_objEditorDocument[c].execCommand(a,!1,null);else 2==b&&(window.attachEvent?d!=ID_LETTER_OPERATION_HEADING_SIZE&&d!=ID_LETTER_OPERATION_OUTDENT_INDENT&&g_objLetterFn.setLetterOperation(d,f,k,c,!1):(g=e.getRangeAt(0),d!=ID_LETTER_OPERATION_HEADING_SIZE&&d!=ID_LETTER_OPERATION_OUTDENT_INDENT&&g_objLetterFn.setLetterOperation(d,f,g,c,!1)))},n);if(h&&h.table){var t=g_objTableUtil.getTableCellElement(h.table,h.row,h.col);g_objCaretUtil.moveCaret(t)}}}catch(g){dalert(g)}};this.setMultiCellCommand_ExecCommand=
function(c,b){try{fnObjectCheckNull(g_objEditorDocument[b])||fnObjectCheckNull(c)||!GetCurTable(b)||this.setMultiCellCommand_Common(b,1,c,0,"")}catch(a){dalert(a)}};this.setMultiCellCommand_LetterOperation=function(c,b,a){try{fnObjectCheckNull(g_objEditorDocument[a])||fnObjectCheckNull(b)||!GetCurTable(a)||this.setMultiCellCommand_Common(a,2,"",c,b)}catch(d){dalert(d)}}};

function editor_onfocus_0(a){try{editor_onfocus(a,0)}catch(b){}}function editor_onfocus_1(a){try{editor_onfocus(a,1)}catch(b){}}function editor_onfocus_2(a){try{editor_onfocus(a,2)}catch(b){}}function editor_onfocus_3(a){try{editor_onfocus(a,3)}catch(b){}}function editor_onfocus_4(a){try{editor_onfocus(a,4)}catch(b){}}function editor_onfocus_5(a){try{editor_onfocus(a,5)}catch(b){}}function editor_onfocus_6(a){try{editor_onfocus(a,6)}catch(b){}}
function editor_onfocus_7(a){try{editor_onfocus(a,7)}catch(b){}}function editor_onfocus_8(a){try{editor_onfocus(a,8)}catch(b){}}function editor_onfocus_9(a){try{editor_onfocus(a,9)}catch(b){}}function editor_onfocus_10(a){try{editor_onfocus(a,10)}catch(b){}}function editor_onfocus_11(a){try{editor_onfocus(a,11)}catch(b){}}function editor_onfocus_12(a){try{editor_onfocus(a,12)}catch(b){}}function editor_onfocus_13(a){try{editor_onfocus(a,13)}catch(b){}}
function editor_onfocus_14(a){try{editor_onfocus(a,14)}catch(b){}}function editor_onfocus_15(a){try{editor_onfocus(a,15)}catch(b){}}function editor_onfocus_16(a){try{editor_onfocus(a,16)}catch(b){}}function editor_onfocus_17(a){try{editor_onfocus(a,17)}catch(b){}}function editor_onfocus_18(a){try{editor_onfocus(a,18)}catch(b){}}function editor_onfocus_19(a){try{editor_onfocus(a,19)}catch(b){}}function editor_onblur_0(a){try{editor_onblur(a,0)}catch(b){}}
function editor_onblur_1(a){try{editor_onblur(a,1)}catch(b){}}function editor_onblur_2(a){try{editor_onblur(a,2)}catch(b){}}function editor_onblur_3(a){try{editor_onblur(a,3)}catch(b){}}function editor_onblur_4(a){try{editor_onblur(a,4)}catch(b){}}function editor_onblur_5(a){try{editor_onblur(a,5)}catch(b){}}function editor_onblur_6(a){try{editor_onblur(a,6)}catch(b){}}function editor_onblur_7(a){try{editor_onblur(a,7)}catch(b){}}function editor_onblur_8(a){try{editor_onblur(a,8)}catch(b){}}
function editor_onblur_9(a){try{editor_onblur(a,9)}catch(b){}}function editor_onblur_10(a){try{editor_onblur(a,10)}catch(b){}}function editor_onblur_11(a){try{editor_onblur(a,11)}catch(b){}}function editor_onblur_12(a){try{editor_onblur(a,12)}catch(b){}}function editor_onblur_13(a){try{editor_onblur(a,13)}catch(b){}}function editor_onblur_14(a){try{editor_onblur(a,14)}catch(b){}}function editor_onblur_15(a){try{editor_onblur(a,15)}catch(b){}}
function editor_onblur_16(a){try{editor_onblur(a,16)}catch(b){}}function editor_onblur_17(a){try{editor_onblur(a,17)}catch(b){}}function editor_onblur_18(a){try{editor_onblur(a,18)}catch(b){}}function editor_onblur_19(a){try{editor_onblur(a,19)}catch(b){}}function editor_onactivate_0(a){try{editor_onactivate(a,0)}catch(b){}}function editor_onactivate_1(a){try{editor_onactivate(a,1)}catch(b){}}function editor_onactivate_2(a){try{editor_onactivate(a,2)}catch(b){}}
function editor_onactivate_3(a){try{editor_onactivate(a,3)}catch(b){}}function editor_onactivate_4(a){try{editor_onactivate(a,4)}catch(b){}}function editor_onactivate_5(a){try{editor_onactivate(a,5)}catch(b){}}function editor_onactivate_6(a){try{editor_onactivate(a,6)}catch(b){}}function editor_onactivate_7(a){try{editor_onactivate(a,7)}catch(b){}}function editor_onactivate_8(a){try{editor_onactivate(a,8)}catch(b){}}function editor_onactivate_9(a){try{editor_onactivate(a,9)}catch(b){}}
function editor_onactivate_10(a){try{editor_onactivate(a,10)}catch(b){}}function editor_onactivate_11(a){try{editor_onactivate(a,11)}catch(b){}}function editor_onactivate_12(a){try{editor_onactivate(a,12)}catch(b){}}function editor_onactivate_13(a){try{editor_onactivate(a,13)}catch(b){}}function editor_onactivate_14(a){try{editor_onactivate(a,14)}catch(b){}}function editor_onactivate_15(a){try{editor_onactivate(a,15)}catch(b){}}
function editor_onactivate_16(a){try{editor_onactivate(a,16)}catch(b){}}function editor_onactivate_17(a){try{editor_onactivate(a,17)}catch(b){}}function editor_onactivate_18(a){try{editor_onactivate(a,18)}catch(b){}}function editor_onactivate_19(a){try{editor_onactivate(a,19)}catch(b){}}function editor_onscroll_0(a){try{editor_onscroll(a,0)}catch(b){}}function editor_onscroll_1(a){try{editor_onscroll(a,1)}catch(b){}}function editor_onscroll_2(a){try{editor_onscroll(a,2)}catch(b){}}
function editor_onscroll_3(a){try{editor_onscroll(a,3)}catch(b){}}function editor_onscroll_4(a){try{editor_onscroll(a,4)}catch(b){}}function editor_onscroll_5(a){try{editor_onscroll(a,5)}catch(b){}}function editor_onscroll_6(a){try{editor_onscroll(a,6)}catch(b){}}function editor_onscroll_7(a){try{editor_onscroll(a,7)}catch(b){}}function editor_onscroll_8(a){try{editor_onscroll(a,8)}catch(b){}}function editor_onscroll_9(a){try{editor_onscroll(a,9)}catch(b){}}
function editor_onscroll_10(a){try{editor_onscroll(a,10)}catch(b){}}function editor_onscroll_11(a){try{editor_onscroll(a,11)}catch(b){}}function editor_onscroll_12(a){try{editor_onscroll(a,12)}catch(b){}}function editor_onscroll_13(a){try{editor_onscroll(a,13)}catch(b){}}function editor_onscroll_14(a){try{editor_onscroll(a,14)}catch(b){}}function editor_onscroll_15(a){try{editor_onscroll(a,15)}catch(b){}}function editor_onscroll_16(a){try{editor_onscroll(a,16)}catch(b){}}
function editor_onscroll_17(a){try{editor_onscroll(a,17)}catch(b){}}function editor_onscroll_18(a){try{editor_onscroll(a,18)}catch(b){}}function editor_onscroll_19(a){try{editor_onscroll(a,19)}catch(b){}}function onmousedown_containerBottomResize_0(a){try{onmousedown_containerBottomResize(a,0)}catch(b){}}function onmousedown_containerBottomResize_1(a){try{onmousedown_containerBottomResize(a,1)}catch(b){}}
function onmousedown_containerBottomResize_2(a){try{onmousedown_containerBottomResize(a,2)}catch(b){}}function onmousedown_containerBottomResize_3(a){try{onmousedown_containerBottomResize(a,3)}catch(b){}}function onmousedown_containerBottomResize_4(a){try{onmousedown_containerBottomResize(a,4)}catch(b){}}function onmousedown_containerBottomResize_5(a){try{onmousedown_containerBottomResize(a,5)}catch(b){}}
function onmousedown_containerBottomResize_6(a){try{onmousedown_containerBottomResize(a,6)}catch(b){}}function onmousedown_containerBottomResize_7(a){try{onmousedown_containerBottomResize(a,7)}catch(b){}}function onmousedown_containerBottomResize_8(a){try{onmousedown_containerBottomResize(a,8)}catch(b){}}function onmousedown_containerBottomResize_9(a){try{onmousedown_containerBottomResize(a,9)}catch(b){}}
function onmousedown_containerBottomResize_10(a){try{onmousedown_containerBottomResize(a,10)}catch(b){}}function onmousedown_containerBottomResize_11(a){try{onmousedown_containerBottomResize(a,11)}catch(b){}}function onmousedown_containerBottomResize_12(a){try{onmousedown_containerBottomResize(a,12)}catch(b){}}function onmousedown_containerBottomResize_13(a){try{onmousedown_containerBottomResize(a,13)}catch(b){}}
function onmousedown_containerBottomResize_14(a){try{onmousedown_containerBottomResize(a,14)}catch(b){}}function onmousedown_containerBottomResize_15(a){try{onmousedown_containerBottomResize(a,15)}catch(b){}}function onmousedown_containerBottomResize_16(a){try{onmousedown_containerBottomResize(a,16)}catch(b){}}function onmousedown_containerBottomResize_17(a){try{onmousedown_containerBottomResize(a,17)}catch(b){}}
function onmousedown_containerBottomResize_18(a){try{onmousedown_containerBottomResize(a,18)}catch(b){}}function onmousedown_containerBottomResize_19(a){try{onmousedown_containerBottomResize(a,19)}catch(b){}};

var g_bDynamicLayer=!1,g_strSelectionType="",g_bForceNoSelectionChange=!1,g_bMenuEnabled=!0,g_bActivate=[],ID_STRING_COMMAND_CREATELINK="CreateLink",ID_STRING_COMMAND_UNLINK="Unlink",g_objLastRange=[],g_strBookmark_IE=null,g_objObjectSelectionInfo=null,g_objCurrentRange=[];function initSelectionObjectInfo(){this.bSelectObject=!1;this.objSelectionObject=this.strNodeName=null;return this}
function setSelectionObjectInfo(a,c,b){g_objObjectSelectionInfo.bSelectObject=a;g_objObjectSelectionInfo.strNodeName=c;g_objObjectSelectionInfo.objSelectionObject=b}
function editor_onbeforedeactivate(a){try{if(dlog("editor_onbeforedeactivate"),g_bEditMode[a]&&!g_bForceNoSelectionChange&&null==this.dialog_obj)if(g_bBrowserType_IE&&g_arrForceCancelBubbleMouseDown[a])g_arrForceCancelBubbleMouseDown[a]=!1,TBCancelBubbleEvent(null);else{var c=g_objPositionUtil.GetDocumentClientPos_XY(null),b=c.nPos_X,d=c.nPos_Y;if(!(fnObjectCheckNull(g_objEditAreaContainer[a])||fnObjectCheckNull(g_objEditSetContainer[a])||g_bBrowserType_IE&&11>g_bBrowserVerInfo)){var e=g_objPositionUtil.getDocumentScrollPosition(!1),
g=e.nScrollLeft,f=e.nScrollTop,k=e=c=0,m=0,h=g_objEditAreaContainer[a].getBoundingClientRect();c=h.left+g;e=h.top+f;k=h.right+g;m=h.bottom+f;c<=b&&e<=d&&b<=k&&d<=m&&TBCancelBubbleEvent(null)}g_bDynamicLayer&&TBCancelBubbleEvent(null);if(window.attachEvent){var l=g_objEditorDocument[a].selection;g_objLastRange[a]=l.createRange()}else g_bBrowserType_IE&&(l=g_objEditWindow[a].getSelection(),g_objLastRange[a]=l.getRangeAt(0))}}catch(n){g_objLastRange[a]=null}}
function editor_ondeactivate(a){if(!g_bForceNoSelectionChange){var c=document.activeElement;if(c&&"INPUT"===c.nodeName&&!c.hasAttribute("readonly"))return;disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1;g_bActivate[a]=!1;g_objLayerEventUtil.initHideDynamicLayer()}try{g_bBrowserType_IE&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+a+", 0);")}catch(b){}}
function editor_onactivate(a,c){g_bActivate[c]=!0;g_nActiveEditNumber=c;try{g_bBrowserType_IE&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+c+", 1);")}catch(b){}}function editor_onselectionchange_for_iframe(a){try{var c=getSelectionControl(a);if(1==c.rangeLength){var b=c.controlObject.tagName.toLowerCase();"iframe"==b&&(setSelectionObjectInfo(!0,b,c.controlObject),editor_onselectionchange(a))}}catch(d){}}
function editor_onselectstart(a,c){try{var b=g_objMouseEvent;if(b&&g_browserCHK.isMacPC()&&EventUtil.isRightButton(b)){var d=g_objCaretUtil.getRangeFromPoint(b.clientX,b.clientY);d&&(SetCurRange(d.getNativeRange()),a.preventDefault())}removeZeroWidthSpaceWithSelectionEvent(a,c)}catch(e){dalert(e)}}var g_nUiUpdateTimer=null;
function editor_onselectionchange(a){try{if(g_nActiveEditNumber=a,duzon_dialog.nEditNumber=a,duzon_menubar.nEditNumber=a,g_objCaretUtil.nEditNumber=a,!(g_bBrowserType_IE&&ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID||g_bBrowserType_IE&&!g_bActivate[a])){if(window.attachEvent)if(g_strSelectionType=g_objEditorDocument[a].selection.type.toLowerCase(),ID_STRING_NAME_CONTROL==g_strSelectionType){g_objTableFlag.ResetTableInfo(!1);var c=g_objEditorDocument[a].selection.createRange();if(fnObjectCheckNull(c.length))return}else{var b=
g_objEditorDocument[a].selection.createRange();fnObjectCheckNull(b)||(g_strBookmark_IE=b.getBookmark())}else g_strSelectionType=getSelectionTypeForUpdateUI();var d=GetCurTable(a);dzeUiConfig.bUseLockEditCellFunction&&!d&&(g_bHasLockedCell=!g_objEditMode.checkSelectionContentEditable(a));c=!0;2==g_nFormEditMode&&(g_objEditMode.checkSelectionContentEditableArea(a)||(c=!1));c&&g_objInsertUtil.saveSelectionRange_IE(1,a);g_nUiUpdateTimer&&clearTimeout(g_nUiUpdateTimer);g_nUiUpdateTimer=setTimeout(function(){onselectionchange_uiupdate(a)})}}catch(e){dalert(e)}}
function onselectionchange_uiupdate(a){try{g_bMenuEnabled||(g_objMenuWin.TBMenuSetStateAllEnable(!0,a),g_bMenuEnabled=!0);var c=null;if(window.attachEvent){if(c=g_objEditorDocument[a].selection.type.toLowerCase(),ID_STRING_NAME_CONTROL==c){var b=g_objEditorDocument[a].selection.createRange();if(fnObjectCheckNull(b.length)){disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1;return}g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1}}else if(c=getSelectionTypeForUpdateUI(),
ID_STRING_NAME_CONTROL==c)g_objMenuWin.TBMenuSetStateAllEnable(!1,a),g_bMenuEnabled=!1;else if(1!=g_objEditWindow[a].getSelection().rangeCount){disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bMenuEnabled=!1;g_objTableMiniMenu.showTableMiniMenu(!1,null,a);return}b=!0;2==g_nFormEditMode&&(g_objEditMode.checkSelectionContentEditableArea(a)||(b=!1));if(b){updateHandlerUI.update_toolbar_button(c,a);updateHandlerUI.update_toolbar_combobox(c,a);updateHandlerUI.update_toolbar_dropdown(c,
a);2==g_nFormEditMode&&g_objEditMode.bRestrictAreaMouseDown?updateHandlerUI.update_toolbar_manual(c,!0,a):updateHandlerUI.update_toolbar_manual(c,!1,a);var d=GetCurTable(a);updateTableHandlerUI.updateTableUIHandler(a,d)}else disableAllControl(a),g_objMenuWin.TBMenuSetStateAllEnable(!1,a),g_bMenuEnabled=!1;g_objTableMiniMenu.delayUpdate(a)}catch(e){dalert(e)}}
function disableAllControl(a){try{updateTableHandlerUI.clearCache();for(var c=g_objEditorDocument[a],b=0;b<g_TBButton[a].length;b++){var d=g_TBButton[a][b].command_id,e=g_TBButton[a][b].element,g=g_TBButton[a][b].element.command;if(ID_SUPPORT_TYPE_PERSISTENCE!=g_TBButton[a][b].support_type)if(3==g_nFormEditMode)if(ID_COMMAND_UNDO==d||ID_COMMAND_REDO==d){var f=handlerUI.queryCommandStatus(c,d,g,a,-1,null);null!=f&&TBSetState(e,f,g_TBButton[a][b].button_type)}else TBSetState(g_TBButton[a][b].element,
ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type);else TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type)}for(b=0;b<g_TBDropDown[a].length;b++)ID_SUPPORT_TYPE_PERSISTENCE!=g_TBDropDown[a][b].support_type&&TBSetState(g_TBDropDown[a][b].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][b].button_type);for(b=0;b<g_TBComboBox[a].length;b++)ID_SUPPORT_TYPE_PERSISTENCE!=g_TBComboBox[a][b].support_type&&TBSetState(g_TBComboBox[[a]][b].element,ID_STRING_NAME_GRAY,g_TBComboBox[[a]][b].button_type);
duzon_dialog.closeExtendsDlg()}catch(k){}};

var ID_TABLE_EVENT_NOTHING=0,ID_TABLE_EVENT_ROW_RESIZE=1,ID_TABLE_EVENT_COL_RESIZE=2,ID_TABLE_EVENT_CELL_SELECT=3,ID_TABLE_EVENT_TABLE_RESIZE=4,ID_TABLE_EVENT_TABLE_ENTERLINE=5,g_nTableEventID=0,g_bFirst_OnBeforeUnload=!0,g_bFirst_OnUnload=!0,g_arrOnFocus_FF_WK=[],g_objMouseEvent=null,g_objDrag={bDragging:!1},g_arrEditorListener=null,g_arrMouseListener=null,g_nPrevUpKeyCode=null,EventUtil={addHandler:function(a,b,c){try{a.addEventListener?!0===g_bBrowserType_CR&&"wheel"===b?a.addEventListener(b,c,
{passive:!1}):a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c}catch(d){dalert(d)}},removeHandler:function(a,b,c){try{a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null}catch(d){dalert(d)}},normalize:function(a,b){try{a&&(a.nEditNumber=b,dzeUiConfig.bOfficePagingMode&&(a.pageNum=g_objPageControl.getPageNum(a.target||a.srcElement)),a.modifierKey=a.altKey||a.shiftKey||a.ctrlKey||a.metaKey)}catch(c){dalert(c)}},isLeftButton:function(a){return a?
1===(a.button||a.which):!1},isRightButton:function(a){return a?null!==a.button&&void 0!==a.button?2===a.button:null!==a.which&&void 0!==a.which?3===a.which:!1:!1},isLeftButtonPressed:function(a){return a?1===a.buttons:!1},isRightButtonPressed:function(a){return a?2===a.buttons:!1}};
function initGlobalEvent(){try{var a=function(a,c,d){EventUtil.addHandler(a,c,d);g_arrEditorListener.push({elem:a,type:c,handler:d})};a(window,"resize",window_onresize);a(g_objLayerKit.getLayerDocument(),"keydown",document_onkeydown);a(g_objLayerKit.getLayerDocument(),"keyup",document_onkeyup);a(document,"mousedown",document_onmousedown);a(document,"mousemove",document_onmousemove);a(document,"mouseup",document_onmouseup)}catch(b){dalert(b)}}
function initEditorEvent(a){try{g_arrEditorListener=[];var b=function(a,b,c){a&&(EventUtil.addHandler(a,b,c),g_arrEditorListener.push({elem:a,type:b,handler:c}))};a=parseInt(a);var c=g_objEditorDocument[a],d=g_objEditWindow[a],e=d.top;b(c,"contextmenu",function(b){editor_oncontextmenu(b,a);TBCancelBubbleEvent(b);return!1});b(c,"keydown",function(b){editor_onkeydown(b,a)});b(c,"keyup",function(b){editor_onkeyup(b,a)});b(c,"change",function(b){editor_onchange(b,a)});b(c,"compositionstart",function(b){editor_oncompositionstart(b,
a)});b(c,"compositionend",function(b){editor_oncompositionend(b,a)});b(c,"copy",function(b){editor_oncopy(b,a)});b(c,"cut",function(b){editor_oncut(b,a)});b(c,"paste",function(b){editor_onpaste(b,a)});b(c,"selectstart",function(b){editor_onselectstart(b,a)});b(c,"input",function(b){editor_oninput(b,a)});b(e,"resize",function(b){top_window_onresize(b,a)});b(d,"unload",function(b){editor_onunload(b,a)});if(g_bBrowserType_IE)if(g_objLastRange[a]=null,g_objCurrentRange[a]=null,eval("g_objEditObject["+
a+"].onbeforedeactivate = function(evnt){editor_onbeforedeactivate("+a+");};"),eval("g_objEditObject["+a+"].ondeactivate = function(evnt){editor_ondeactivate("+a+");};"),window.attachEvent){eval("g_objEditorDocument["+a+"].onselectionchange = function(evnt){editor_onselectionchange("+a+");};");eval("g_objEditorDocument["+a+'].attachEvent("onactivate", editor_onactivate_'+a+");");try{eval("g_objEditWindow["+a+'].attachEvent("onscroll", editor_onscroll_'+a+");")}catch(f){try{g_objEditorDocument[a].attachEvent("onmousewheel",
editor_onmousewheel)}catch(g){}}}else{eval("g_objEditorDocument["+a+"].onselectionchange = function(evnt){editor_onselectionchange_for_iframe("+a+");};");eval("g_objEditorDocument["+a+'].addEventListener("activate", editor_onactivate_'+a+", false);");try{eval("g_objEditWindow["+a+'].addEventListener("scroll", editor_onscroll_'+a+", false);")}catch(f){try{g_objEditorDocument[a].addEventListener("mousewheel",editor_onmousewheel,!1)}catch(g){}}}else{g_arrOnFocus_FF_WK[a]=!1;if(g_bBrowserType_FF)eval("g_objEditorDocument["+
a+'].addEventListener("focus", editor_onfocus_'+a+", false);"),eval("g_objEditorDocument["+a+'].addEventListener("blur", editor_onblur_'+a+", false);");else if(g_bBrowserType_WK||g_bBrowserType_OP)eval("g_objEditWindow["+a+'].addEventListener("focus", editor_onfocus_'+a+", false);"),eval("g_objEditWindow["+a+'].addEventListener("blur", editor_onblur_'+a+", false);");eval("g_objEditWindow["+a+'].addEventListener("scroll", editor_onscroll_'+a+", false);")}attachMouseEvent()}catch(f){dalert(f)}}
function setWindowResizeEvent(a){try{a?window.setTimeout("setRestoreWindowResizeEvent()",100):window.detachEvent?window.detachEvent("onresize",window_onresize):window.removeEventListener("resize",window_onresize,!1)}catch(b){}}function setRestoreWindowResizeEvent(){try{window.attachEvent?window.attachEvent("onresize",window_onresize):window.addEventListener("resize",window_onresize,!1)}catch(a){}}
function window_onresize(){g_objLayerEventUtil.initHideDynamicLayer();g_objWrapperOutlineResize.resetExtOutlineInfo();if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode){if(g_bEditorHeightIFrameYN&&"undefined"!=typeof window.frameElement&&null!=window.frameElement&&null!=window.frameElement.getAttribute("dzeditor_no")){var a=parseInt(window.frameElement.getAttribute("dzeditor_no"),10);dze_menu_control.resizeEditorHeight(a)}}else if(g_bEditorHeightIFrameYN){a=document.documentElement.clientHeight;
var b=0;"undefined"!=typeof window.frameElement&&null!=window.frameElement&&(null!=window.frameElement.getAttribute("dzeditor_no")&&(b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10)),resizeEditor_Height(b,a))}"undefined"!=typeof duzon_menubar&&duzon_menubar.rebuildHiddenToolbar();addParentScrollEvent();if("undefined"!=typeof dzeUiConfig.nEditModeAreaWidth&&null!=dzeUiConfig.nEditModeAreaWidth&&""!=dzeUiConfig.nEditModeAreaWidth){a=Number(dzeUiConfig.nEditModeAreaWidth);for(var c in g_arrEditorAreaContainer)g_objEditMode.setEditModeAreaWidth(a,
c)}}function top_window_onresize(){try{var a=g_objContextMenuWin;a&&a.isShow()&&a.initContextMenuLayerEvent();duzon_dialog.top_window_onresize();g_objTableSizeBoxWin.initTableSizeLayerEvent();g_objLayerEventUtil.initButtonState();g_objMenuWin.closeMenuLayer();g_objPasteOptionMenu.onWheel()}catch(b){dalert(b)}}function document_onmousedown(a){}function document_onmousemove(a){try{g_objDragger.onMouseMove(a,!1)}catch(b){dalert(b)}}
function document_onmouseup(a){try{g_objDragger.onMouseUp(a,!1)}catch(b){dalert(b)}}
function document_onkeydown(a){try{if(g_objPropForm.bShowPropForm){var b=a.keyCode;a.ctrlKey?86==b?g_objPropFormKeyCode.keyDownPaste(a):(ID_KEYCODE_ARROW_LEFT!=b&&ID_KEYCODE_ARROW_TOP!=b&&ID_KEYCODE_ARROW_RIGHT!=b&&ID_KEYCODE_ARROW_BOTTOM!=b||g_objPropFormKeyCode.keyDownResizeArrow(b,a),g_objPropFormKeyCode.bCtrlKeyDown=!0):a.shiftKey?g_objPropFormKeyCode.bShiftKeyDown=!0:ID_KEYCODE_TAB!=b&&(ID_KEYCODE_ESCAPE==b?g_objPropFormKeyCode.keyDownEscape(a):ID_KEYCODE_DELETE==b?g_objPropFormKeyCode.keyDownDelete(a):
(ID_KEYCODE_ARROW_LEFT==b||ID_KEYCODE_ARROW_TOP==b||ID_KEYCODE_ARROW_RIGHT==b||ID_KEYCODE_ARROW_BOTTOM==b)&&g_objPropFormKeyCode.keyDownMoveArrow(b,a))}else g_objPropTagTableSelectFormula.bShowTagTableSelectFormula&&(b=a.keyCode,ID_KEYCODE_ESCAPE==b&&(duzon_dialog.closeDialog(),g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1)))}catch(c){}}
function document_onkeyup(a){try{g_objPropForm.bShowPropForm&&(0==a.ctrlKey&&(g_objPropFormKeyCode.bCtrlKeyDown=!1),0==a.shiftKey&&(g_objPropFormKeyCode.bShiftKeyDown=!1))}catch(b){}}
function editor_onkeydown(a,b){try{var c=function(a){if(!1===fnObjectCheckNull(a)&&"INPUT"===a.nodeName&&!1===fnObjectCheckNull(a.getAttribute("readonly"))){var b=g_objNodeUtil.getParentElement(a);if(!1===fnObjectCheckNull(b))return b.removeChild(a),!0}return!1};EventUtil.normalize(a,b);var d=a?a.keyCode:0;if(g_bBrowserType_IE&&isEditingKeyCode(d)&&!SelectionUtil.isOnInput(b)){var e=g_objEditWindow[b],f=e?e.getSelection():null;f&&0>=f.rangeCount&&a.preventDefault()}isArrowKeyCode(d)||isModifierKeyCode(d)||
g_objPasteOptionMenu.remove();DZESHORTCUT.setDzeShortCutEvent(a,b);!a.altKey||a.ctrlKey||a.shiftKey||(ID_KEYCODE_ARROW_LEFT==a.keyCode||ID_KEYCODE_ARROW_RIGHT==a.keyCode)&&TBCancelBubbleEvent(a);if(g_objCopyPaste.isCaretOnPasteDiv(b))TBCancelBubbleEvent(a);else{!a.modifierKey&&isNavigationKeyCode(a.keyCode)&&replaceFontTag(a);var g=g_objEditorDocument[b];g&&!g.body.firstChild&&isEditingKeyCode(a.keyCode)&&!a.modifierKey&&(g.body.innerHTML="<p><br></p>",g_objCaretUtil.moveCaret(g.body));var k=g_objTableFunction.getCurrentCell(b),
l=k?k.table:null;if(l){g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();if(!1===g_objTableFunction.isEditableTable(l)){TBCancelBubbleEvent(a);return}if(dzeUiConfig.bUseLockEditCellFunction&&!0===checkDzeCellLocked(a,b)&&!g_objNodeUtil.isTextArea(a.srcElement||a.target)){TBCancelBubbleEvent(a);return}GetMultiCellSelection(b)?a.modifierKey||(ID_KEYCODE_DELETE===d?g_objTableOperation.deleteSelectedCellContents(l,b)&&("undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length&&
g_objEditMode.doReservedCallback(b),TBCancelBubbleEvent(a)):ID_KEYCODE_BACKSPACE===d?g_objTableOperation.deleteSelectedCell(b,l,!1)&&TBCancelBubbleEvent(a):g_objTableSelection.isTableNaviKey(d)||g_objTableSelection.clearCellSelection()):2==g_nFormEditMode||a.cancelBubble||(ID_KEYCODE_TAB!==d||a.altKey||DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)||SelectionUtil.isOnInput(b)?isArrowKeyCode(d)&&!a.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&g_objTableSelection.checkMoveCellForce(a)&&
(d===ID_KEYCODE_ARROW_TOP||d===ID_KEYCODE_ARROW_BOTTOM?g_objTableFunction.moveFocusUpDownCell(a,b)&&TBCancelBubbleEvent(a):(d===ID_KEYCODE_ARROW_LEFT||d===ID_KEYCODE_ARROW_RIGHT)&&g_objTableFunction.moveFocusNextCell(a,b)&&TBCancelBubbleEvent(a)):g_objTableFunction.moveFocusNextCell(a,b)&&TBCancelBubbleEvent(a))}isModifierKeyCode(d)||g_objWrapperOutlineResize.resetExtOutlineInfo();switch(d){case ID_KEYCODE_ESCAPE:return;case ID_KEYCODE_ENTER:setTimeout(function(){if(!0===g_bBrowserType_IE){var a=
g_objEditWindow[b];if((a=(a=(a=a?a.getSelection():null)&&0<a.rangeCount?a.getRangeAt(0):null)?a.startContainer:null)&&a.style&&!1===fnObjectCheckNull(a.style.backgroundColor)){var c=a.innerHTML;if("<br>"===c||"</br>"===c||"<br />"===c)a.innerHTML="&#8203;"}}});applyListBlankEnter(a,b);insertPara(b,a);!1===g_bBrowserType_IE&&setHyperlinkAuto(b);break;case ID_KEYCODE_SPACE:!1===g_bBrowserType_IE&&setHyperlinkAuto(b);break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:g_bDynamicLayer&&
g_objLayerEventUtil.initHideDynamicLayer();break;case ID_KEYCODE_BACKSPACE:deleteIndent(a)&&TBCancelBubbleEvent(a);!1===g_bBrowserType_IE&&!0===removeHyperlink(b)&&TBCancelBubbleEvent(a);!0!==dzeUiConfig.bUseContractForm&&!0!==dzeUiConfig.bUseDataBind||!0!==c(a.target)||TBCancelBubbleEvent(a);checkOnlyBlankPara(a)&&TBCancelBubbleEvent(a);deleteKeyAnchor(a)&&TBCancelBubbleEvent(a);break;case ID_KEYCODE_DELETE:g_bBrowserType_IE&&checkSetIFrameSrcBlankForDelete(b);!0!==dzeUiConfig.bUseContractForm&&
!0!==dzeUiConfig.bUseDataBind||!0!==c(a.target)||TBCancelBubbleEvent(a);deleteKeyAnchor(a)&&TBCancelBubbleEvent(a);onDeleteListEvent(a)&&TBCancelBubbleEvent(a);deleteAlonePara(a)&&(g_objUndoRedo.operateUndoRedoStack(!1,!1,b),TBCancelBubbleEvent(a));checkOnlyBlankPara(a)&&TBCancelBubbleEvent(a);break;case ID_KEYCODE_Y:case ID_KEYCODE_Z:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();var h=g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL?!0:!1;(!h&&a.ctrlKey&&!a.altKey&&!a.shiftKey||
h&&a.metaKey&&d==ID_KEYCODE_Z)&&!g_objNodeUtil.isTextArea(SelectionUtil.isOnInput(b))&&(TBCancelBubbleEvent(a),!h&&d==ID_KEYCODE_Y||h&&a.metaKey&&d==ID_KEYCODE_Z&&a.shiftKey?g_objUndoRedo.operateUndoRedoStack(!1,!1,b):(!h&&d==ID_KEYCODE_Z||h&&a.metaKey&&d==ID_KEYCODE_Z)&&g_objUndoRedo.operateUndoRedoStack(!0,!1,b),"undefined"!=typeof dzeUiConfig.arrFormCodeString&&g_objEditMode.initDivFormCodeObjectEvent(b));break;default:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer()}c=null;(c=SelectionUtil.isOnInput(b))&&
!c.hasAttribute("readonly")&&resizeInput(c);g_objInputFormatEvent.onKeyDown(a);dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteKeyDown(a,b);a&&!a.cancelBubble&&isEditingKeyCode(d)&&!a.modifierKey&&SelectionUtil.isDeleteDirectly(b)&&SelectionUtil.deleteSelection(b)&&(d===ID_KEYCODE_BACKSPACE||d===ID_KEYCODE_DELETE)&&(g_objCaretUtil.scrollToCaret(),TBCancelBubbleEvent(a))}}catch(m){dalert(m)}}
function editor_onkeyup(a,b){try{EventUtil.normalize(a,b);var c=a.keyCode;if(window.addEventListener&&229!=a.keyCode){if(ID_KEYCODE_CTRL==c)return;if(ID_KEYCODE_ALT==c){TBCancelBubbleEvent(a);return}if(ID_KEYCODE_CAPSLOCK==c)return;setSelectionObjectInfo(!1,null,null);editor_onselectionchange(b)}if(a.ctrlKey)89!=c&&90!=c||TBCancelBubbleEvent(a);else if(ID_KEYCODE_V!=c){var d=g_nPrevUpKeyCode;if(!(d===ID_KEYCODE_CTRL&&c===ID_KEYCODE_A||d===ID_KEYCODE_CTRL&&c===ID_KEYCODE_C||DZESHORTCUT.isPressedKeyMapForOS(a,
ID_KEYCODE_CTRL)&&(ID_KEYCODE_V==c||ID_KEYCODE_Z==c||ID_KEYCODE_A==c||ID_KEYCODE_X==c))){d=null;(d=SelectionUtil.isOnInput(b))&&!d.hasAttribute("readonly")&&resizeInput(d);var e=g_objUndoRedo.checkKeyCodeInput(a,b);ID_KEYCODE_CTRL!=c&&ID_KEYCODE_ALT!=c&&ID_KEYCODE_CAPSLOCK!=c&&(!a.modifierKey&&isEditingKeyCode(a.keyCode)&&replaceFontTag(a),g_objTableSelection.onKeyUp(a,b),!0===e&&"undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length&&g_objEditMode.doReservedCallback(b))}}}catch(f){dalert(f)}finally{g_nPrevUpKeyCode=
c}}
function editor_oninput(a,b){try{switch(EventUtil.normalize(a,b),g_objInputFormatEvent.onInput(a),a.inputType){case "insertText":case "insertReplacementText":case "insertLineBreak":case "insertParagraph":case "insertTranspose":case "insertCompositionText":case "deleteWordBackward":case "deleteWordForward":case "deleteSoftLineBackward":case "deleteSoftLineForward":case "deleteEntireSoftLine":case "deleteHardLineBackward":case "deleteHardLineForward":case "deleteContent":case "deleteContentBackward":case "deleteContentForward":removeZeroWidthSpaceWithInputEvent(a,b)}}catch(c){dalert(c)}}
function editor_onchange(a,b){try{if(a){var c=a.target||a.srcElement,d=!1;g_objInputFormatEvent.onChange(a);g_objTagUtil.updateFormTagAttr(c)&&(d=!0,g_objBindStore&&1===c.nodeType&&c.hasAttribute("dze_bind_key")&&g_objBindStore.dispatch({type:"CHANGE",target:c}));d&&g_objUndoRedo.registerUndoRedoStack(0,b)}}catch(e){dalert(e)}}
function editor_onchange_cell(a,b){try{if(a){b=g_objNodeUtil;var c=g_objNodeUtil.getLoopParentElementByTagNames(a.target,["td","th"]);g_objBindStore&&b.isCell(c)&&c.hasAttribute("dze_bind_key")&&g_objBindStore.dispatch({type:"CHANGE",target:c})}}catch(d){dalert(d)}}function editor_oncompositionstart(a,b){try{g_objCaretUtil.bComposing=!0}catch(c){dalert(c)}}function editor_oncompositionend(a,b){try{g_objCaretUtil.bComposing=!1}catch(c){dalert(c)}}
function editor_onfocus(a,b){try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&!g_arrOnFocus_FF_WK[b]&&(g_arrOnFocus_FF_WK[b]=!0,g_bActivate[b]=!0,g_nActiveEditNumber=b)}catch(c){}try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+b+", 1);")}catch(c){}}
function editor_onblur(a,b){try{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){if(g_objTableResize.bResizeMouseDown)return;g_arrOnFocus_FF_WK[b]&&(g_arrOnFocus_FF_WK[b]=!1,setTimeout(function(){var a=document.activeElement;a&&"INPUT"===a.nodeName&&!a.hasAttribute("readonly")||editor_ondeactivate(b)},0))}}catch(c){dalert(c)}try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+b+", 0);")}catch(c){dalert(c)}try{g_objPasteOptionMenu&&
g_objPasteOptionMenu.remove&&g_objPasteOptionMenu.remove()}catch(c){dalert(c)}}
function editor_onunload(a,b){try{if(g_bFirst_OnBeforeUnload){g_bFirst_OnBeforeUnload=!1;for(var c in g_arrEditorAreaContainer)if(g_bBrowserType_IE)g_objEditorDocument[c].execCommand("Unselect"),g_objEditorDocument[c].body.contentEditable=!1,g_objEditorDocument[c].body.innerHTML="";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[c].body.innerHTML=""}}catch(f){dalert(f)}try{if(g_bFirst_OnUnload){g_bFirst_OnUnload=!1;detachMouseEvent();window.detachEvent?window.detachEvent("onresize",
window_onresize):window.removeEventListener("resize",window_onresize,!1);for(c in g_arrEditorAreaContainer){if(g_bBrowserType_IE)g_objEditorDocument[c].execCommand("Unselect"),g_objEditorDocument[c].body.contentEditable=!1,g_objEditorDocument[c].body.innerHTML="";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[c].body.innerHTML="";if(g_bBrowserType_IE)window.detachEvent?eval("g_objEditorDocument["+c+'].detachEvent("onactivate", editor_onactivate_'+c+");"):eval("g_objEditorDocument["+
c+'].removeEventListener("activate", editor_onactivate_'+c+", false);");else{if(g_bBrowserType_FF)eval("g_objEditorDocument["+c+'].removeEventListener("focus", editor_onfocus_'+c+", false);"),eval("g_objEditorDocument["+c+'].removeEventListener("blur", editor_onblur_'+c+", false);");else if(g_bBrowserType_WK||g_bBrowserType_OP)eval("g_objEditWindow["+c+'].removeEventListener("focus", editor_onfocus_'+c+", false);"),eval("g_objEditWindow["+c+'].removeEventListener("blur", editor_onblur_'+c+", false);");
g_bBrowserType_FF&&eval("g_objEditWindow["+c+'].removeEventListener("scroll", editor_onscroll_'+c+", false);")}}c=0;for(var d=g_arrEditorListener?g_arrEditorListener.length:0;c<d;c++){var e=g_arrEditorListener[c];e&&EventUtil.removeHandler(e.elem,e.type,e.handler)}g_arrEditorListener=null;g_objPasteOptionMenu.unload();g_objTransparentViewUtil.unload();g_objContextMenuWin.unload();duzon_menubar.unload();g_objComboBoxWin.unload();g_objMenuWin.unload();duzon_dialog.unload();g_objTableSizeBoxWin.unload();
g_objLineHeightWin.unload(b);g_objLetterSpacingWin.unload(b);duzon_http.unloadLoading();g_objCommonUtil.unloadDPI();g_objTableResize.unload();g_objTableMiniMenu.unload();g_objWrapperOutlineUtil.unload()}}catch(f){dalert(f)}}
function attachMouseEvent(){try{if(g_arrMouseListener)return!1;g_arrMouseListener=[];var a=function(a,b,e){EventUtil.addHandler(a,b,e);g_arrMouseListener.push({elem:a,type:b,handler:e})},b;for(b in g_arrEditorAreaContainer)(function(){var c=b,d=g_objEditorDocument[c];d&&(a(d,"mousedown",function(a){editor_onmousedown(a,c)}),a(d,"mousemove",function(a){editor_onmousemove(a,c)}),a(d,"mouseup",function(a){editor_onmouseup(a,c)}),a(d,"mouseover",function(a){editor_onmouseover(a,c)}),a(d,"click",function(a){editor_onclick(a,
c)}),a(d,"dblclick",function(a){editor_ondblclick(a,c)}))})();return!0}catch(c){dalert(c)}}function detachMouseEvent(){try{if(!g_arrMouseListener)return!1;for(var a=0,b=g_arrMouseListener.length;a<b;a++){var c=g_arrMouseListener[a];c&&EventUtil.removeHandler(c.elem,c.type,c.handler)}g_arrMouseListener=null;return!0}catch(d){dalert(d)}}
function editor_oncontextmenu(a,b){try{if(g_bContextMenuUseYN&&g_nActiveEditNumber==b){var c=g_objNodeUtil.getLoopParentElement(a.target,"table");if(!1!==fnObjectCheckNull(c)||!1!==g_objTableFunction.isEditableTable(c)){var d=g_objContextMenuWin.getContextMenuType(a,b);if(null!=d){g_objWrapperOutlineResize.resetExtOutlineInfo();var e=g_objPositionUtil.getNodeElementPosition(g_objEditObject[b]),f=e.left,g=e.top;c=null;c=window.attachEvent?g_objEditorDocument[b].parentWindow.event:a;var k=f+c.clientX,
l=g+c.clientY;if(g_bBrowserType_IE){if(0===k&&0===l){var h=GetCurRange(b);if(h&&h.getBoundingClientRect){var m=h.getBoundingClientRect();k=f+m.left;l=g+m.top}}dzeEnvConfig.iFrameLayer&&(k+=8,l+=8)}g_objContextMenuWin.showContextMenuLayer(d,k,l,b)}}}}catch(n){dalert(n)}}
function getSelectedObjectType(a){try{if(!0===fnObjectCheckNull(a))return DZE_OBJ_NONE;var b="undefined"!=typeof g_objShapeFunction?!0:!1,c=b?g_objShapeFunction.getShapeObject(a):null,d=a.nodeName.toLowerCase(),e=g_objNodeUtil,f=g_objVideoControl,g=DZE_OBJ_NONE;!1===fnObjectCheckNull(c)?g=DZE_OBJ_SHAPE:!1===fnObjectCheckNull(b?g_objShapeFunction.getTextboxInShape(a):null)?g=DZE_OBJ_SHAPE_TEXT:d===DZE_TAG_IMG?g=!1===fnObjectCheckNull(a.getAttribute("chart_data"))?DZE_OBJ_CHART:f.isVideoSpan(a.parentNode)?
DZE_OBJ_VIDEO:DZE_OBJ_IMG:f.isVideo(a)||f.isVideoControl(a)?g=DZE_OBJ_VIDEO:e.getLoopParentElementByTagNames(a,e.arrCellTagName)&&(g=DZE_OBJ_TABLE);return g}catch(k){dalert(k)}}
function editor_onmousedown(a,b){try{if(!0===fnObjectCheckNull(a))return;EventUtil.normalize(a,b);g_objMouseEvent=a;if(dzeUiConfig.bTempChromeIme&&g_objCaretUtil.bComposing&&g_browserCHK.cr&&!g_browserCHK.edge){var c=g_objEditorDocument[b],d=c?c.body:null;d&&"true"==d.getAttribute("contenteditable")&&(d.setAttribute("contenteditable","false"),d.setAttribute("contenteditable","true"))}g_nActiveEditNumber=b;g_objUndoRedo.setKeyCodeContinue(!1,b);g_objWrapperOutlineResize.resetExtOutlineInfo();EventUtil.isLeftButton(a)&&
g_objContextMenuWin.isShow()&&(g_objContextMenuWin.initContextMenuLayerEvent(),g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer());if(-1==b)return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!1;if(g_objEditMode.arrWriteAreaSet[b])return g_nTableEventID=ID_TABLE_EVENT_NOTHING,g_objEditMode.setupDefined_WriteAreaSet(a,b),!1;if(2==g_nFormEditMode&&g_objEditMode.restrictWriteArea_onmousedown(a,b))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),!1;setSelectionColor(b,
"");var e=getSelectedObjectType(a.target);e!==DZE_OBJ_TABLE&&g_objTableFlag.ResetTableInfo(!1);switch(e){case DZE_OBJ_TABLE:g_objTableSelection.onMouseDown(a,b)&&2==g_nFormEditMode&&!g_objEditMode.getLoopContentEditable(GetCurTable(b))&&(g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(b),g_nTableEventID=ID_TABLE_EVENT_NOTHING);break;case DZE_OBJ_IMG:g_objDragger.onMouseDown(a)}g_objInputFormatEvent.onMouseDown(a);g_objALinkMgr.doEvent(a);return!0}catch(f){dalert(f)}return!1}
function editor_onmousemove(a,b){try{if(EventUtil.normalize(a,b),g_objEditMode.arrWriteAreaSet[b])g_nTableEventID=ID_TABLE_EVENT_NOTHING;else if(2!=g_nFormEditMode||!g_objEditMode.restrictWriteArea_onmousemove(a,b)){if(ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID)g_objTableSelection.onMouseMove(a,b);else g_objTableResize.checkResizeLineLayer(a,b);g_objDragger.onMouseMove(a,!0)}}catch(c){dalert(c)}}function editor_onmouseover(a,b){}
function editor_onmouseup(a,b){try{EventUtil.normalize(a,b);g_objTableResize.bResizeMouseDown=!1;if(g_objEditMode.arrWriteAreaSet[b])return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!1;if(2==g_nFormEditMode&&g_objEditMode.restrictWriteArea_onmouseup(a,b))return g_objTableFlag.ResetTableInfo(!1),updateTableHandlerUI.updateTableUIHandler(0,0,0,0,b),!1;g_browserCHK.mobile&&g_objALinkMgr.doEvent(a);if(ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID&&g_objTableSelection.onMouseUp(a,b)){var c=null;g_bTableCellResizingYN&&
!GetMultiCellSelection(b)&&(c=GetCurCell(b))&&(g_objWrapperOutlineResize.newExtSelectedInfo(DZE_OBJ_TD,c),g_objWrapperOutlineUtil.showExtOutline(c,!0,!0,!1,b));updateHandlerUI.update_toolbar_combobox("",b);dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&updateHandlerUI.update_toolbar_for_locked_cell_option(b)}g_nTableEventID=ID_TABLE_EVENT_NOTHING;GetMultiCellSelection()||checkObjectElemetMouseUp(a,b,g_objMouseEvent);editor_onselectionchange(b);dzeCopyPasteStyleInfo.paste(b);g_objDragger.onMouseUp(a,
!0);return!0}catch(d){dalert(d)}finally{g_objMouseEvent=null}return!1}
function editor_onpaste(a,b){try{if(dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.isPasting())a.preventDefault();else if(!SelectionUtil.isOnInput(b)){g_objAdjustDoc.setTarget(null,b);dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteBefore(a,b)&&(g_objAdjustDoc.setTarget(g_objCopyPaste.getPasteDiv(),b),dzeUiConfig.bRemoveXSS&&g_objCopyPaste.setTimeoutForPaste(function(){var a=g_objCopyPaste.getPasteDiv();a&&(a.innerHTML=removeXSS(a.innerHTML))},0));if(g_bAutoAdjustHwpWordYN){if(g_bBrowserType_WK&&
g_objAdjustDoc.checkPasteCode_Excel_WK(a)){!0===dzeUiConfig.bUseImageExtUpload?g_objExtUploader.pasteImageFromClipboard(a,b):DZE_UPLOAD_EVENT.pasteInsertImageFromClipboard(a,b);g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.adjustPasteCode_WK(b)},300);g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.doAdjustDocProcess(b)},400);return}var c=!0;if(g_bBrowserType_WK||g_bBrowserType_OP)for(var d=(a.clipboardData||a.originalEvent.clipboardData).items,e=0;e<d.length;e++)if(0===d[e].type.indexOf("image")){c=
!1;break}!0===c&&g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.adjustDocProcess(b)},300)}!0===dzeUiConfig.bUseImageExtUpload?g_objExtUploader.pasteImageFromClipboard(a,b):DZE_UPLOAD_EVENT.pasteInsertImageFromClipboard(a,b);!0===dzeUiConfig.bApplyPasteOnefficeLink&&pasteOnefficeLink(a,b);g_objCopyPaste.setTimeoutForPaste(function(){g_objCopyPaste.pause();checkImgLoaded(g_objCopyPaste.getPasteDiv(),function(){g_objCopyPaste.resume()},5)},300)}}catch(f){dalert(f)}}
function editor_onpaste_complete(a,b){try{if(dzeUiConfig.bUsePasteCapture){g_objAdjustDoc.setTarget(null);a=g_objPasteOptionMenu;var c=a.pasteEndNode;a.pasteEndNode=null;g_objUndoRedo.registerUndoRedoStack(0,b);a.pasteEndNode=c;switch(a.pasteContentsType){case g_objCopyPaste.PASTE_IMAGE:break;case g_objCopyPaste.PASTE_TABLE:a.hide();a.show(!0);break;default:a.hide(),a.show(!0)}g_objCaretUtil.scrollToCaret();editor_onselectionchange(b)}}catch(d){dalert(d)}}
function editor_oncopy(a,b){try{if(SelectionUtil.isOnInput(b))return!1;EventUtil.normalize(a,b);dzeClipBoard.initialize();g_objCopyPaste.onCopy(a)}catch(c){dalert(c)}}function editor_oncut(a,b){try{if(SelectionUtil.isOnInput(b))return!1;EventUtil.normalize(a,b);dzeClipBoard.initialize();g_objCopyPaste.onCut(a)}catch(c){dalert(c)}}function editor_onclick(a,b){try{EventUtil.normalize(a,b),g_objALinkMgr.doEvent(a),adjustSelectionOnTripleClickCell(b,a)}catch(c){dalert(c)}}
function editor_ondblclick(a,b){try{if(!0===dzeUiConfig.bUseContractForm){var c=a.target;!1===fnObjectCheckNull(c.getAttribute("ostyle"))&&("input"!==c.nodeName.toLowerCase()||"text"!==c.type.toLowerCase()&&"textarea"!==c.type.toLowerCase()||!1!==fnObjectCheckNull(c.getAttribute("ostyle"))||fnHandler_showContractFormBox(a,b))}!0===dzeUiConfig.bUseDataBind&&(c=a.target,!0===g_objPropertyUtil.element_hasClass(c,"dze_external_data_area")&&fnHandler_showBindBox(a,null,b))}catch(d){dalert(d)}}
function editor_onscroll(a,b){try{g_objContextMenuWin.bContextMenuAttachMouseEvent&&(g_objLayerEventUtil.initHideDynamicLayer({initContextMenu:!1}),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0)),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,b),g_objTableMiniMenu.onWheel(b),g_objPasteOptionMenu.onWheel(a)}catch(c){dalert(c)}}
function editor_onmousewheel(){try{editor_onscroll(null,g_nActiveEditNumber)}catch(a){}}
function attachMouseDragDropEvent(a){try{if(window.addEventListener){dlog("Add dragdrop listener ("+a+")");a=parseInt(a);var b=g_objEditorDocument[a],c=function(a){(a=a||window.event)&&a.preventDefault()};document.addEventListener("dragenter",c,!1);document.addEventListener("dragover",c,!1);document.addEventListener("drop",c,!1);document.addEventListener("dragleave",c,!1);b.addEventListener("dragenter",function(b){b=b||window.event;editor_ondragenter(b,a)},!1);b.addEventListener("dragover",function(b){b=
b||window.event;editor_ondragover(b,a)},!1);b.addEventListener("drop",function(b){b=b||window.event;editor_ondrop(b,a)},!1);b.addEventListener("dragleave",function(b){b=b||window.event;editor_ondragleave(b,a)},!1);b.addEventListener("dragstart",function(b){b=b||window.event;editor_ondragstart(b,a)},!1);b.addEventListener("dragend",function(b){b=b||window.event;editor_ondragend(b,a)},!1)}}catch(d){dalert(d)}}
function editor_ondragenter(a,b){try{g_nActiveEditNumber=b,g_bBrowserType_IE||g_objEditorDocument[b].body.focus()}catch(c){dalert(c)}}
function editor_ondragover(a,b){try{if(g_objEditorDocument[b].body.focus(),g_bBrowserType_IE&&("Files"==a.dataTransfer.types[0]&&TBCancelBubbleEvent(a),!0===dzeUiConfig.bUseLockEditCellFunction)){var c=g_objNodeUtil.getLoopParentElementByTagNames(a.target,["td","th"]);c&&c.contentEditable&&"false"==c.contentEditable.toLowerCase()&&TBCancelBubbleEvent(a)}}catch(d){dalert(d)}}
function editor_ondrop(a,b){try{dlog("editor_ondrop Call nEditNumber : "+b);if(!g_objDrag.bDragging){var c=g_objCaretUtil.getRangeFromPoint(a.clientX,a.clientY);c&&SetCurRange(c.getRange())}"undefined"!=typeof a.dataTransfer.files&&null!=a.dataTransfer.files&&a.dataTransfer.files.length?(TBCancelBubbleEvent(a),DZE_UPLOAD_EVENT.dragNdropInsertImage(a.dataTransfer.files,b)):"undefined"!=dzeUiConfig.arrFormCodeString&&0<dzeUiConfig.arrFormCodeString.length&&window.setTimeout(function(){g_objEditMode.checkDropReservedFormCode(b)},
200);if(g_bBrowserType_IE&&!0===dzeUiConfig.bUseLockEditCellFunction){var d=g_objNodeUtil.getLoopParentElementByTagNames(a.target,["td","th"]);d&&d.contentEditable&&"false"==d.contentEditable.toLowerCase()&&TBCancelBubbleEvent(a)}window.setTimeout(function(){g_objEditMode.removeChild(b,"a","className","dze_bookmark_flag",function(a){a.style.backgroundImage=""});g_objEditMode.removeChild(b,"a","className","dze_init_cursor_flag",function(a){a.style.backgroundImage=""})},200);g_objUndoRedo.registerUndoRedoStack(0,
b)}catch(e){dalert(e)}}function editor_ondragleave(a,b){}function editor_ondragstart(a,b){try{g_objDrag.bDragging=!0}catch(c){dalert(c)}}function editor_ondragend(a,b){try{g_objDrag.bDragging=!1}catch(c){dalert(c)}}
function setDragNDropBg(a,b){try{1==b?(g_objEditorDocument[a].body.style.opacity="0.3",document.getElementById("dzeditor_Parent_"+a).className="editor_drag_frame"):(g_objEditorDocument[a].body.style.opacity="",document.getElementById("dzeditor_Parent_"+a).className="editor_frame")}catch(c){dalert(c)}}
function addParentScrollEvent(){try{dlog("addParentScrollEvent");var a=null,b;for(b in g_arrEditorAreaContainer)a=dzeEnvConfig.iFrameLayer?window.frameElement:document.getElementById("INIT_LOAD_AREA_"+b),addEventParentScrollElement(a,b)}catch(c){dalert(c)}}
function addEventParentScrollElement(a,b){try{var c=a;for(a=0;!(1E3<a)&&c.parentNode;){c=c.parentNode;if("body"==c.nodeName.toLowerCase())break;if(g_bBrowserType_IE)var d=c.currentStyle.getAttribute("overflow");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)d=g_objEditWindow[b].getComputedStyle(c,null).getPropertyValue("overflow");"auto"!=d.toLowerCase()&&"scroll"!=d.toLowerCase()||function(){var a=c;window.attachEvent?a.attachEvent("onscroll",function(){g_objMenuWin.closeMenuLayer();
g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();g_objPasteOptionMenu.onWheel()}):a.addEventListener("scroll",function(){g_objMenuWin.closeMenuLayer();g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();g_objPasteOptionMenu.onWheel()},!1)}();a++}return null}catch(e){dalert(e)}};

var g_strSkin_ClassName="",g_strSkin_HandleDiv="",g_strSkin_Separator="",g_strSkin_Button="",g_strSkin_Button_Over="",g_strSkin_Button_Down="",g_strSkin_Button_Up="",g_strSkin_ComboBox_Area="",g_strSkin_ComboBox_AreaOver="",g_strSkin_ComboBox_AreaDown="",g_strSkin_ComboBox_AreaUp="",g_strSkin_DropDown_Area="",g_strSkin_DropDown_AreaOver="",g_strSkin_DropDown_AreaDown="",g_strSkin_DropDown_AreaUp="",g_strSkin_DropDown_AreaArrow="",g_strSkin_DropDown_AreaArrowOver="",g_strSkin_DropDown_AreaArrowDown=
"",g_strSkin_DropDown_AreaArrowUp="",g_strSkin_Menu_Area="",g_strSkin_Menu_AreaOver="",g_strSkin_Menu_AreaDown="",g_strSkin_Menu_AreaUp="",g_strSkin_TabMode_Area="",g_strSkin_TabMode_AreaOver="",g_strSkin_TabMode_AreaDown="",g_strSkin_TabMode_AreaUp="",g_strSkin_MenuWin="",g_strSkin_MenuItem="",g_strSkin_ComboBoxWin="",g_strSkin_ComboBoxItem_Over="",g_strSkin_ComboBoxItem_Out="",g_strSkin_ComboBoxItem_Down="",g_strSkin_SizeBoxBackWin="",g_strSkin_SizeBoxStatus="",g_strSkin_SizeBoxCell="",g_arrToolbar1=
null,g_arrToolbar2=null,g_arrToolbar3=null,g_arrMenuBar=null,g_arrTabBar=[],g_strSkin_ComboBox_Caption="",g_strSkin_ComboBox_AreaArrow="",g_strSkin_SizeBoxBG="",g_strSkin_SizeBoxStatusText="",g_nIframeBorderSetting=0,g_bEnableEditHorizontalScroll=!0,g_strBodyFontFamily="",g_strBodyFontSize="",g_strBodyFontColor="",g_strBodyLineHeight="",g_strBodyLetterSpacing="",g_strPTagMarginTop="",g_strPTagMarginBottom="",g_nPreviewWindowWidth=0,g_nPreviewWindowHeight=0,g_arrFontName=[],g_strPreviewCallFunction=
"",g_arrAdditionalEditAreaCSS=[],g_strAdditionalHeadContent="",g_bEditFocusYN=!0,g_bSourceAreaScriptAllowYN=!1,g_bSourceAreaIframeAllowYN=!1,g_bTableOperationYN=!0,g_bTableResizingYN=!0,g_bTableCellResizingYN=!0,g_nFormEditMode=0,g_bLockEditCellMode=!1,g_bLockEditTableMode=!1,g_bEditSourceMode=!0,g_bAnchorTargetBlankYN=!1,g_bContentPTagStyleApply=!1,g_bContentXHTMLFormatYN=!1,g_bContentXHTMLTabSettingYN=!0,g_strAdditionalStyle="",g_strCustomAdditionalStyle="",g_bConvertPTagToBrTag=!1,g_arrImgSrcRemoveDomain=
null,g_bAnchorHrefRemoveDomainYN=!1,g_bContextMenuUseYN=!0,g_bContextMenuDisplayInEditAreaYN=!1,g_bEditorWidthPercentageYN=!1,g_bEditorHeightIFrameYN=!1,g_strTabModeEventFunction="",g_bSetTableCellBlank=!1,g_strFocusEventFunction="",g_bBottomResizeYN=!1,g_arrAdjustRemoveAttributeName=[],g_arrAdjustRemoveStyleName=[],g_nAdjustFromPtToPxRatio=60,g_bAutoAdjustHwpWordYN=!0,g_bCheckImgSrcProperty=!0,g_arrCheckImgSrcPropertyValue=[],g_bEncodeEndCharacterYN=!1,g_strDomainPageName="",g_bEditorHeightReSettingYN=
!1,g_bAutoIncludeParentCSS=!1,g_nOutdentIndentWidth=7,g_bAutoBrConvertPTag=!0,g_arrRemoveGarbageText=[],g_nFireFoxLayerSetting_X=0,g_nFireFoxLayerSetting_Y=0,g_arrSkinColor=[],g_bFullScreenMode=!1;
function setSkinToolBar(){g_strSkin_ClassName="duzon_menubar_line";g_strSkin_ToolBarLine="duzon_toolbar_line";g_strSkin_Menu_Area="duzon_menubar_title";g_strSkin_Menu_AreaOver="duzon_menubar_title_over";g_strSkin_Menu_AreaDown="duzon_menubar_title_down";g_strSkin_Menu_AreaUp="duzon_menubar_title_up";g_strSkin_MenuItem="duzon_menubar_select_item";g_strSkin_Separator="duzon_tb_separator";g_strSkin_MenuWin="duzon_context_container";g_strSkin_Button="duzon_tb_button";g_strSkin_Button_Over="duzon_tb_button_over";
g_strSkin_Button_Down="duzon_tb_button_down";g_strSkin_Button_Up="duzon_tb_button_up";g_strSkin_DropDown_Area="duzon_tb_dropdown";g_strSkin_DropDown_AreaOver="duzon_tb_dropdown_over";g_strSkin_DropDown_AreaDown="duzon_tb_dropdown_down";g_strSkin_DropDown_AreaUp="duzon_tb_dropdown_up";g_strSkin_DropDown_AreaArrow="duzon_tb_dropdown_arrow";g_strSkin_DropDown_AreaArrowOver="duzon_tb_dropdown_arrow_over";g_strSkin_DropDown_AreaArrowDown="duzon_tb_dropdown_arrow_down";g_strSkin_DropDown_AreaArrowUp="duzon_tb_dropdown_arrow_up";
g_strSkin_TabMode_AreaDown=g_strSkin_TabMode_AreaOver=g_strSkin_TabMode_Area="duzon_btn_tabmod_area_off";g_strSkin_TabMode_AreaUp="duzon_btn_tabmod_area_on";g_strSkin_ComboBoxWin="duzon_btn_combobox";g_strSkin_ComboBoxItem_Over="duzon_btn_comboboxitem_over";g_strSkin_ComboBoxItem_Out="duzon_btn_comboboxitem_out";g_strSkin_ComboBoxItem_Down="duzon_btn_comboboxitem_down";g_strSkin_ComboBox_AreaArrow="tbComboBox_AreaArrow";g_strSkin_HandleDiv="dze_tbHandleDiv";g_strSkin_ComboBox_Area="dze_tbComboBox_Area";
g_strSkin_ComboBox_AreaOver="dze_tbComboBox_AreaOver";g_strSkin_ComboBox_AreaDown="dze_tbComboBox_AreaDown";g_strSkin_ComboBox_AreaUp="dze_tbComboBox_AreaUp";g_strSkin_SizeBoxBackWin="dze_tbSizeBoxBackWin";g_strSkin_SizeBoxStatus="dze_tbSizeBoxStatus";g_strSkin_SizeBoxCell="dze_tbSizeBoxCell";g_strSkin_ComboBox_Caption="tbComboBox_Caption";g_strSkin_ComboBox_AreaArrow="tbComboBox_AreaArrow";g_strSkin_SizeBoxBG="tbSizeBoxBG";g_strSkin_SizeBoxStatusText="tbSizeBoxStatusText"}
function setCustomDisplay(){try{dzeUiConfig.setCustomToolbars();dzeUiConfig.setCustomContextMenus();g_bMenuBar_Display=dzeUiConfig.bCustomize_MenuBar_Display;g_bTabBar_Display=dzeUiConfig.bCustomize_TabBar_Display;g_bToolBar1_Display=dzeUiConfig.bCustomize_ToolBar1_Display;g_bToolBar2_Display=dzeUiConfig.bCustomize_ToolBar2_Display;g_bToolBar3_Display=dzeUiConfig.bCustomize_ToolBar3_Display;g_arrToolbar1=dzeUiConfig.arrCustomToolbar1;g_arrToolbar2=dzeUiConfig.arrCustomToolbar2;g_arrToolbar3=dzeUiConfig.arrCustomToolbar3;
null!=dzeUiConfig.arrCustomTabBar&&3==dzeUiConfig.arrCustomTabBar.length?(g_arrTabBar=dzeUiConfig.arrCustomTabBar,!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&(g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]=!0)):(g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]=!0);for(var b=!1,c=!1,a=0;a<dzeUiConfig.arrContextMenu_General.length;a++)ID_COMMAND_HYPERLINK_INSERT==dzeUiConfig.arrContextMenu_General[a]?
b=!0:ID_COMMAND_HYPERLINK_REMOVE==dzeUiConfig.arrContextMenu_General[a]&&(c=!0);if(b||c)dzeUiConfig.arrContextMenu_Control.push(ID_TYPE_MENU_SEPARATOR),b&&dzeUiConfig.arrContextMenu_Control.push(ID_COMMAND_HYPERLINK_INSERT),c&&dzeUiConfig.arrContextMenu_Control.push(ID_COMMAND_HYPERLINK_REMOVE);dzeUiConfig.arrContextMenu_Control.unshift(ID_TYPE_MENU_SEPARATOR);dzeUiConfig.arrContextMenu_Control.unshift(ID_COMMAND_IMAGE_PROPERTY);"undefined"!=typeof dzeUiConfig.bUseImageToTableMenu&&"undefined"!=typeof dzeUiConfig.strImageToTableURL&&
1==dzeUiConfig.bUseImageToTableMenu&&""!=dzeUiConfig.strImageToTableURL&&dzeUiConfig.arrContextMenu_Control.push(ID_COMMAND_IMAGE_TO_TABLE);g_arrMenuBar=dzeUiConfig.arrCustomMenuBar;g_nIframeBorderSetting=dzeUiConfig.nCustomIframeBorderSetting;g_nFireFoxLayerSetting_X=dzeUiConfig.nCustomFireFoxLayerSetting_X;g_nFireFoxLayerSetting_Y=dzeUiConfig.nCustomFireFoxLayerSetting_Y;g_bEnableEditHorizontalScroll=dzeUiConfig.bCustomEnableEditHorizontalScroll;g_strBodyFontFamily=dzeUiConfig.strCustomBodyFontFamily.length?
quoteFontFamily(dzeUiConfig.strCustomBodyFontFamily.replace(/["']/g,"")):quoteFontFamily(dzeUiConfig.arrCustomFontName[1].replace(/["']/g,""));g_strBodyFontSize=dzeUiConfig.strCustomBodyFontSize.length?dzeUiConfig.strCustomBodyFontSize:"9pt";g_strBodyFontColor=dzeUiConfig.strCustomBodyFontColor.length?dzeUiConfig.strCustomBodyFontColor:"#000000";g_strBodyLineHeight=dzeUiConfig.strCustomBodyLineHeight.length?g_objPropertyUtil.getUnitlessLineHeight(dzeUiConfig.strCustomBodyLineHeight):"1.2";g_strBodyLetterSpacing=
dzeUiConfig.strCustomBodyLetterSpacing;g_strPTagMarginTop=dzeUiConfig.strCustomPTagMarginTop.length?dzeUiConfig.strCustomPTagMarginTop:"0px";g_strPTagMarginBottom=dzeUiConfig.strCustomPTagMarginBottom.length?dzeUiConfig.strCustomPTagMarginBottom:"0px";g_nPreviewWindowWidth=dzeUiConfig.nCustomPreviewWindowWidth;g_nPreviewWindowHeight=dzeUiConfig.nCustomPreviewWindowHeight;if(null!=dzeUiConfig.arrCustomFontName&&0<dzeUiConfig.arrCustomFontName.length)for(g_arrFontName=dzeUiConfig.arrCustomFontName,
a=0;a<g_arrFontName.length;a++)g_arrFontName[a]=quoteFontFamily(g_arrFontName[a].replace(/["']/g,""));else g_arrFontName[g_arrFontName.length]="",""!=ID_RES_COOMBOBOX_FONT_NAME_0&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_0),""!=ID_RES_COOMBOBOX_FONT_NAME_1&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_1),""!=ID_RES_COOMBOBOX_FONT_NAME_2&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_2),""!=ID_RES_COOMBOBOX_FONT_NAME_3&&(g_arrFontName[g_arrFontName.length]=
ID_RES_COOMBOBOX_FONT_NAME_3),""!=ID_RES_COOMBOBOX_FONT_NAME_4&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_4),""!=ID_RES_COOMBOBOX_FONT_NAME_5&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_5),""!=ID_RES_COOMBOBOX_FONT_NAME_6&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_6),""!=ID_RES_COOMBOBOX_FONT_NAME_7&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_7),""!=ID_RES_COOMBOBOX_FONT_NAME_8&&(g_arrFontName[g_arrFontName.length]=
ID_RES_COOMBOBOX_FONT_NAME_8),""!=ID_RES_COOMBOBOX_FONT_NAME_9&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_9),""!=ID_RES_COOMBOBOX_FONT_NAME_10&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_10);g_strPreviewCallFunction=dzeUiConfig.strCustomPreviewCallFunction;g_arrAdditionalEditAreaCSS=dzeUiConfig.arrCustomAdditionalEditAreaCSS;g_strAdditionalHeadContent=dzeUiConfig.strCustomAdditionalHeadContent;g_bEditFocusYN=dzeUiConfig.bCustomEditFocusYN;g_bSourceAreaScriptAllowYN=
dzeUiConfig.bCustomSourceAreaScriptAllowYN;g_bSourceAreaIframeAllowYN=dzeUiConfig.bCustomSourceAreaIframeAllowYN;g_bTableOperationYN=dzeUiConfig.bCustomTableOperationYN;g_bTableResizingYN=dzeUiConfig.bCustomTableResizingYN;g_nFormEditMode=dzeUiConfig.nCustomFormEditMode;g_bLockEditCellMode=dzeUiConfig.nCustomLockEditCellMode;g_bLockEditTableMode=dzeUiConfig.nLockEditTableMode;g_bEditSourceMode=dzeUiConfig.bCustomEditSourceMode;g_bAnchorTargetBlankYN=dzeUiConfig.bCustomAnchorTargetBlankYN;g_bContentPTagStyleApply=
dzeUiConfig.bCustomContentPTagStyleApply;g_bContentXHTMLFormatYN=dzeUiConfig.bCustomContentXHTMLFormatYN;g_bContentXHTMLTabSettingYN=dzeUiConfig.bCustomContentXHTMLTabSettingYN;g_strAdditionalStyle=g_strCustomAdditionalStyle;g_bConvertPTagToBrTag=dzeUiConfig.bCustomConvertPTagToBrTag;if(0<dzeUiConfig.arrCustomImgSrcRemoveDomain.length)for(g_arrImgSrcRemoveDomain=[],a=0;a<dzeUiConfig.arrCustomImgSrcRemoveDomain.length;a++)g_arrImgSrcRemoveDomain[a]=dzeUiConfig.arrCustomImgSrcRemoveDomain[a].toLowerCase();
if(1==dzeUiConfig.autoAddImgSrcRemoveDomain){null==g_arrImgSrcRemoveDomain&&(g_arrImgSrcRemoveDomain=[]);var d=document.location.href.match(/^(https*:\/\/[a-z0-9-_\.:]*)[\/\?]/i);g_arrImgSrcRemoveDomain.push(d[1])}g_bAnchorHrefRemoveDomainYN=dzeUiConfig.bCustomAnchorHrefRemoveDomainYN;g_bContextMenuUseYN=dzeUiConfig.bCustomContextMenuUseYN;g_bContextMenuDisplayInEditAreaYN=dzeUiConfig.bCustomContextMenuDisplayInEditAreaYN;g_bEditorWidthPercentageYN=dzeUiConfig.bCustomEditorWidthPercentageYN;g_bEditorHeightIFrameYN=
dzeUiConfig.bCustomEditorHeightIFrameYN;g_strTabModeEventFunction=dzeUiConfig.strCustomTabModeEventFunction;g_bSetTableCellBlank=dzeUiConfig.bCustomSetTableCellBlank;g_strFocusEventFunction=dzeUiConfig.strCustomFocusEventFunction;g_bBottomResizeYN=dzeUiConfig.bCustomBottomResizeYN;g_bTableCellResizingYN=dzeUiConfig.bCustomTableCellResizingYN;g_arrAdjustRemoveAttributeName=dzeUiConfig.arrCustomAdjustRemoveAttributeName;g_arrAdjustRemoveStyleName=dzeUiConfig.arrCustomAdjustRemoveStyleName;g_nAdjustFromPtToPxRatio=
dzeUiConfig.nCustomAdjustFromPtToPxRatio;g_bAutoAdjustHwpWordYN=dzeUiConfig.bCustomAutoAdjustHwpWordYN;g_bCheckImgSrcProperty=dzeUiConfig.bCustomCheckImgSrcProperty;g_arrCheckImgSrcPropertyValue=dzeUiConfig.arrCustomCheckImgSrcPropertyValue;g_bEncodeEndCharacterYN=dzeUiConfig.bCustomEncodeEndCharacterYN;g_strDomainPageName=dzeUiConfig.strCustomDomainPageName;g_bEditorHeightReSettingYN=dzeUiConfig.bCustomEditorHeightReSettingYN;g_bAutoIncludeParentCSS=dzeUiConfig.bCustomAutoIncludeParentCSS;g_nOutdentIndentWidth=
dzeUiConfig.nCustomOutdentIndentWidth;g_bAutoBrConvertPTag=dzeUiConfig.bCustomAutoBrConvertPTag;g_arrRemoveGarbageText=dzeUiConfig.arrCustomRemoveGarbageText;if("object"==typeof dzeUiConfig.arrSkinColorSet){for(a=b=0;a<dzeUiConfig.arrSkinColorSet.length;a++)if(dzeEnvConfig.skinColor==dzeUiConfig.arrSkinColorSet[a][0]){b=a;break}g_arrSkinColor=dzeUiConfig.arrSkinColorSet[b];g_objPropertyUtil.setSkinColorSet()}}catch(e){}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_nLetterOperationType=-1,ID_LETTER_OPERATION_FONT_FAMILY=0,ID_LETTER_OPERATION_FONT_SIZE=1,ID_LETTER_OPERATION_FORE_COLOR=2,ID_LETTER_OPERATION_BACK_COLOR=3,ID_LETTER_OPERATION_LETTER_SPACING=4,ID_LETTER_OPERATION_LINE_HEIGHT=5,ID_LETTER_OPERATION_TEXT_DECORATION=6,ID_LETTER_OPERATION_HEADING_SIZE=6,ID_LETTER_OPERATION_OUTDENT_INDENT=7,g_bFindPos_StartLetterOperation=!1,g_bFindPos_EndLetterOperation=!1,g_objLetterFn=new function(){this.nRemoveStyleTransactionCount=0;this.setLetterOperation=function(a,
b,c,d,e){try{var f=(new Date).getTime(),g="S_"+f,h="E_"+f,k=g_objEditorDocument[d];if(window.attachEvent){var l=g_objEditorDocument[d].selection;if(""==c.text){var n=this.isRemove_LetterOperation(a,b);if(!n){var m="T_"+f,r=this.doLetterOperationCreateElement(d,a,b);r.innerHTML="&nbsp;";r.id=m;c.pasteHTML(r.outerHTML);var q=g_objEditorDocument[d].getElementById(m),u=g_objNodeUtil.getParentElement(this.getTopSpanNode(q));g_objAdjustDoc.arrangeSpan(u);q=g_objEditorDocument[d].getElementById(m);q.removeAttribute("id");
var z=l.createRange();z.moveToElementText(q);z.moveStart("character",1);z.select();q.innerHTML=""}}else{var p=c.parentElement(),v='<span id="'+g+'"></span>',t='<span id="'+h+'"></span>',F=c.duplicate();F.collapse(!0);F.pasteHTML(v);var G=c.duplicate();G.collapse(!1);for(G.pasteHTML(t);;){var D=!0,E=!0,A=p.innerHTML;-1==A.indexOf(g)&&(D=!1,p=p.parentElement);A=p.innerHTML;-1==A.indexOf(h)&&(E=!1,p=p.parentElement);if(D&&E)break}(n=this.isRemove_LetterOperation(a,b))?this.processRemove_LetterOperation(d,
p,a,g,h):this.processRangeLetterOperation(d,p,a,b,g,h);this.doRemoveStyleLetterOperation(p,a,b);g_objAdjustDoc.arrangeSpan(p);for(p=g_objEditorDocument[d].getElementById(g);E=D=!0,A=p.innerHTML,-1==A.indexOf(g)&&(D=!1,p=p.parentElement),A=p.innerHTML,-1==A.indexOf(h)&&(E=!1,p=p.parentElement),!D||!E;);var y=g_objEditorDocument[d].getElementById(g),x=g_objEditorDocument[d].getElementById(h);if(e){var S=l.createRange();S.moveToElementText(y);var T=l.createRange();T.moveToElementText(x);m=l.createRange();
m.moveToElementText(p);m.setEndPoint("StartToStart",S);m.setEndPoint("EndToStart",T);m.select()}var I=g_objNodeUtil.getParentElement(y);if(null!=I){var J=g_objNodeUtil.getParentElement(x);null!=J&&(I.removeChild(y),J.removeChild(x))}}}else if(l=g_objEditWindow[d].getSelection(),!(1<l.rangeCount)){p=!1;var w=c.commonAncestorContainer;c.collapsed||ID_SELECTION_TEXT_NODE==w.nodeType&&(p=!0);if(c.collapsed||g_bBrowserType_IE&&GetMultiCellSelection()&&"<p><br></p>"==w.innerHTML){l=null;this.isEmptySpan(w)?
(l="span"==w.nodeName.toLowerCase()?w:w.parentElement,l.id=f):(l=k.createElement("span"),l.id=f,l.innerHTML=duzon_dialog.dze_bookmark_last_tag,insertHTMLCodeAtSelection(null,l,d));var P=this.getClosetBlockElement(l);"span"==l.parentNode.tagName.toLowerCase()&&(this.copySpanStyle(l,l),g_objNodeUtil.splitOn(P,l));this.isRemove_LetterOperation(a,b)?this.removeSpanStyle(l,a):this.doLetterOperationStyleApply(l,a,b);g_objAdjustDoc.arrangeSpan(P);P.innerHTML=removeZeroWidthSpace(P.innerHTML);l=k.getElementById(f);
l.removeAttribute("id");GetMultiCellSelection()||duzon_dialog.setFocusElement(l,d,"end");duzon_dialog.resetSelection=!0}else if(p)if(n=this.isRemove_LetterOperation(a,b))this.setRemove_LetterOperation(a,c,d,g,h,e);else{var K=this.processOnlyTextLetterOperation(d,c,a,b);if(K){for(g=c=K;;)if(g=g_objNodeUtil.getParentElement(g),null!=g)if("span"==g.nodeName.toLowerCase())if(this.removeEmptyChildTextNode(g),1==g.childNodes.length)if(ID_SELECTION_ELEMENT_NODE==g.childNodes[0].nodeType)c=g;else break;else break;
else break;this.doRemoveStyleLetterOperation(c,a,b);g_objAdjustDoc.arrangeSpan(c);l.removeAllRanges();if(e){m=g_objEditorDocument[d].createRange();a=c;for(b=!1;!1===b;)if(!1===b&&(a=a.firstChild,a.nodeType===ID_SELECTION_TEXT_NODE)){b=!0;break}!0===b?(m.setStart(a,0),m.setEnd(a,a.nodeValue.length)):m.selectNode(c);l.addRange(m)}}}else{var L=c.startContainer,Q=c.startOffset,H=c.endContainer,M=c.endOffset;y=g_objEditorDocument[d].createElement("span");x=g_objEditorDocument[d].createElement("span");
y.id=g;x.id=h;f=!1;if(g_bBrowserType_FF){var R=g_objEditorDocument[d].createElement("div");R.appendChild(c.cloneContents());if(1==R.childNodes.length){f=!0;if(ID_SELECTION_TEXT_NODE==R.childNodes[0].nodeType){K=this.processOnlyTextLetterOperation(d,c,a,b);if(!K)return;l.removeAllRanges();e&&(m=g_objEditorDocument[d].createRange(),m.selectNode(K),l.addRange(m));return}insertHTMLCodeAtSelection(null,x,d);var U=x.parentNode;U.insertBefore(y,x);U.insertBefore(R.childNodes[0],x)}}if(!f)if(g_bBrowserType_OP){l.removeAllRanges();
if(null!=L){for(var N="",C=null,B=L;;)if(ID_SELECTION_TEXT_NODE==B.nodeType)C=B,B=B.parentNode,N=C.nodeValue;else break;if(0==Q){var V=this.getPositionOffset_OP(C,L,g,!0);if(-1==V)return;Q=V}this.insertSpanNodeBetweenTextValue_OP(d,B,C,y,N,Q)}if(null!=H){N="";C=null;for(B=H;;)if(ID_SELECTION_TEXT_NODE==B.nodeType)C=B,B=B.parentNode,N=C.nodeValue;else break;if(0==M){var O=this.getPositionOffset_OP(C,H,h,!0);if(-1==O)return;M=O}else{var W=H.nodeValue;if(1==W.length&&254<W.charCodeAt(0)){O=this.getPositionOffset_OP(C,
H,h,!1);if(-1==O)return;M=O}}this.insertSpanNodeBetweenTextValue_OP(d,B,C,x,N,M)}}else l.removeAllRanges(),G=g_objEditorDocument[d].createRange(),G.setStartBefore(H),G.setEnd(H,M),G.collapse(!1),l.addRange(G),insertHTMLCodeAtSelection(null,x,d),l.removeAllRanges(),F=g_objEditorDocument[d].createRange(),F.setStart(L,Q),F.setEndAfter(L),F.collapse(!0),l.addRange(F),insertHTMLCodeAtSelection(null,y,d);for(;!(ID_SELECTION_ELEMENT_NODE==w.nodeType&&"body"==w.nodeName.toLowerCase()||(E=D=!0,A=w.innerHTML,
-1==A.indexOf(g)&&(D=!1,w=w.parentNode),A=w.innerHTML,-1==A.indexOf(h)&&(E=!1,w=w.parentNode),D&&E)););(n=this.isRemove_LetterOperation(a,b))?this.processRemove_LetterOperation(d,w,a,g,h):this.processRangeLetterOperation(d,w,a,b,g,h);this.doRemoveStyleLetterOperation(w,a,b);g_objAdjustDoc.arrangeSpan(w);y=g_objEditorDocument[d].getElementById(g);x=g_objEditorDocument[d].getElementById(h);l.removeAllRanges();if(e){m=g_objEditorDocument[d].createRange();v=y.nextSibling;t=x.previousSibling;!0===fnObjectCheckNull(t)&&
(t=x.parentNode);b=a=!1;if(!1===fnObjectCheckNull(v)&&v.nodeType!==ID_SELECTION_TEXT_NODE&&!1===fnObjectCheckNull(t)&&t.nodeType!==ID_SELECTION_TEXT_NODE){a=v.nodeType===ID_SELECTION_TEXT_NODE;for(b=t.nodeType===ID_SELECTION_TEXT_NODE;!1===a;)if(null===v.firstChild){v=v.parentNode;a=!0;break}else if(v=v.firstChild,v.nodeType===ID_SELECTION_TEXT_NODE){a=!0;break}for(;!1===b;)if(null===t.lastChild){t=t.parentNode;b=!0;break}else if(t=t.lastChild,t.nodeType===ID_SELECTION_TEXT_NODE){b=!0;break}}!0===
a&&!0===b?(m.setStart(v,0),m.setEnd(t,t.nodeType===ID_SELECTION_TEXT_NODE?t.nodeValue.length:t.childNodes.length)):(m.setStartAfter(y),m.setEndBefore(x));l.addRange(m)}I=g_objNodeUtil.getParentElement(y);null!=I&&(J=g_objNodeUtil.getParentElement(x),null!=J&&setTimeout(function(){try{I.removeChild(y),J.removeChild(x)}catch(X){}},0))}}}catch(X){dalert(X)}};this.isRemove_LetterOperation=function(a,b){return""==b&&a==ID_LETTER_OPERATION_FONT_FAMILY||""==b&&a==ID_LETTER_OPERATION_FONT_SIZE||""==b&&a==
ID_LETTER_OPERATION_FORE_COLOR||""==b&&a==ID_LETTER_OPERATION_BACK_COLOR||""==b&&a==ID_LETTER_OPERATION_LETTER_SPACING||"string"==typeof b&&""==b&&a==ID_LETTER_OPERATION_LINE_HEIGHT?!0:!1};this.setRemove_LetterOperation=function(a,b,c,d,e,f){try{if(!window.attachEvent){var g=b.commonAncestorContainer,h=g_objEditWindow[c].getSelection(),k=b.collapsed||g_bBrowserType_IE&&GetMultiCellSelection()&&"<p><br></p>"==g.innerHTML,l=!b.collapsed&&ID_SELECTION_TEXT_NODE==g.nodeType;if(k||l){var n=g_objEditorDocument[c].createElement("span"),
m=g_objEditorDocument[c].createElement("span");n.id=d;m.id=e;n.innerHTML="&nbsp;";m.innerHTML="&nbsp;";var r=g_objEditorDocument[c].createElement("span"),q=b.cloneContents();k&&(r.innerHTML=duzon_dialog.dze_bookmark_last_tag);r.appendChild(q);insertHTMLCodeAtSelection(null,m,c);var u=m.parentNode;u.insertBefore(n,m);u.insertBefore(r,m);this.processRemove_LetterOperation(c,u,a,d,e);u.removeChild(n);u.removeChild(m);this.doRemoveStyleLetterOperation(u,a,"");h.removeAllRanges();if(f){var z=g_objEditorDocument[c].createRange();
z.selectNode(r);h.addRange(z)}k&&duzon_dialog.setFocusElement(r,c,"end")}}}catch(p){dalert(p)}};this.processRemove_LetterOperation=function(a,b,c,d,e){try{for(;this.nodeProcessRemove_LetterOperation(a,b,c,d,e),b=this.checkLoopParentTarget_Remove_LetterOperation(b,c),null!=b;);}catch(f){dalert(f)}};this.nodeProcessRemove_LetterOperation=function(a,b,c,d,e){try{var f=this.checkLetterOperationStyleValue(b,c);null!=f&&this.doRemove_Node_LetterOperation(b,c);for(var g=this.paramReAssignLetterOperation(),
h=!1,k=!1,l=0;l<b.childNodes.length;l++){var n=b.childNodes[l];h||k?h&&!k?this.isIncludeLoopTargetNode(n,e)?(k=!0,g.bFindTarget=!1,this.recursive_reAssign_LetterOperation(a,n,e,c,f,!1,g)):(this.doRemove_Node_LetterOperation(n,c),this.doLoopRemove_LetterOperation(n,c)):(h||!k)&&h&&k&&null!=f&&this.reAssign_LetterOperation(a,b,n,c,f):this.isIncludeLoopTargetNode(n,d)?(h=!0,g.bFindTarget=!1,this.recursive_reAssign_LetterOperation(a,n,d,c,f,!0,g),this.isIncludeLoopTargetNode(n,e)?(k=!0,g.bFindTarget=
!1,g.bFindSameDepthStart=!0,this.recursive_reAssign_LetterOperation(a,n,e,c,f,!1,g)):this.doLoopRemove_LetterOperation_After(n,c,d,g)):null!=f&&this.reAssign_LetterOperation(a,b,n,c,f)}}catch(m){dalert(m)}};this.checkLoopParentTarget_Remove_LetterOperation=function(a,b){try{if("body"==a.nodeName.toLowerCase())return null;var c=g_objNodeUtil.getParentElement(a);if(null==c)return null;var d=c.nodeName.toLowerCase();if("p"!=d&&"span"!=d)return null;a="";if(b==ID_LETTER_OPERATION_FONT_FAMILY){if(a=c.style.fontFamily,
null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_FONT_SIZE){if(a=c.style.fontSize,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_FORE_COLOR){if(a=c.style.color,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_BACK_COLOR){if(a=c.style.backgroundColor,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_LETTER_SPACING){if(a=c.style.letterSpacing,null!=a&&""!=a)return c}else if(b==ID_LETTER_OPERATION_LINE_HEIGHT){a=c.style.lineHeight;a=a.toLowerCase();if("normal"==a)return null;
if(null!=a&&""!=a)return c}}catch(e){dalert(e)}return null};this.checkLetterOperationStyleValue=function(a,b){try{if("body"==a.nodeName.toLowerCase())return null;var c="";if(b==ID_LETTER_OPERATION_FONT_FAMILY)return c=a.style.fontFamily,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_FONT_SIZE)return c=a.style.fontSize,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_FORE_COLOR)return c=a.style.color,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_BACK_COLOR)return c=a.style.backgroundColor,null==
c||""==c?null:c;if(b==ID_LETTER_OPERATION_LETTER_SPACING)return c=a.style.letterSpacing,null==c||""==c?null:c;if(b==ID_LETTER_OPERATION_LINE_HEIGHT){c=a.style.lineHeight;if(null==c||""==c)return null;c=c.toLowerCase();return"normal"==c?null:c}}catch(d){dalert(d)}return null};this.doRemove_Node_LetterOperation=function(a,b){try{ID_SELECTION_ELEMENT_NODE==a.nodeType&&(b==ID_LETTER_OPERATION_FONT_FAMILY?(a.style.fontFamily="",g_bBrowserType_IE?a.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontFamily")):b==ID_LETTER_OPERATION_FONT_SIZE?(a.style.fontSize="",g_bBrowserType_IE?a.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontSize")):b==ID_LETTER_OPERATION_FORE_COLOR?(a.style.color="",g_bBrowserType_IE?a.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("color")):b==ID_LETTER_OPERATION_BACK_COLOR?
(a.style.backgroundColor="",g_bBrowserType_IE?a.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("backgroundColor")):b==ID_LETTER_OPERATION_LETTER_SPACING?(a.style.letterSpacing="",g_bBrowserType_IE?a.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("letterSpacing")):b==ID_LETTER_OPERATION_LINE_HEIGHT&&(a.style.lineHeight="",g_bBrowserType_IE?a.style.removeAttribute("lineHeight"):
(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("lineHeight")))}catch(c){dalert(c)}};this.isIncludeLoopTargetNode=function(a,b){try{if(ID_SELECTION_TEXT_NODE==a.nodeType)return!1;if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&b==a.id)return!0;for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType&&(this.isIncludeLoopTargetNode(d,b)||b==d.id))return!0}}catch(e){dalert(e)}return!1};this.paramReAssignLetterOperation=function(){return{bFindTarget:!1,
bFindSameDepthStart:!1,bFindStart_For_Recursive:!1}};this.recursive_reAssign_LetterOperation=function(a,b,c,d,e,f,g){try{if(1!=g.bFindTarget||!f)if(ID_SELECTION_ELEMENT_NODE==b.nodeType&&c==b.id)g.bFindTarget=!0;else{var h=this.checkLetterOperationStyleValue(b,d);null!=h&&(g.bFindSameDepthStart&&!f||this.doRemove_Node_LetterOperation(b,d),e=h);for(h=0;h<b.childNodes.length;h++){var k=b.childNodes[h];ID_SELECTION_ELEMENT_NODE==k.nodeType?this.recursive_reAssign_LetterOperation(a,k,c,d,e,f,g):ID_SELECTION_TEXT_NODE!=
k.nodeType||g.bFindTarget&&f||(g.bFindTarget&&!f?this.reAssign_LetterOperation(a,b,k,d,e):!g.bFindTarget&&f&&this.reAssign_LetterOperation(a,b,k,d,e))}}}catch(l){dalert(l)}};this.reAssign_LetterOperation=function(a,b,c,d,e){try{var f=g_objEditorDocument[a].createElement("span");d==ID_LETTER_OPERATION_FONT_FAMILY?f.style.fontFamily=e:d==ID_LETTER_OPERATION_FONT_SIZE?f.style.fontSize=e:d==ID_LETTER_OPERATION_FORE_COLOR?f.style.color=e:d==ID_LETTER_OPERATION_BACK_COLOR?f.style.backgroundColor=e:d==ID_LETTER_OPERATION_LETTER_SPACING?
f.style.letterSpacing=e:d==ID_LETTER_OPERATION_LINE_HEIGHT&&(f.style.lineHeight=e);if(ID_SELECTION_TEXT_NODE==c.nodeType)b.insertBefore(f,c),f.appendChild(c);else{for(;0!=c.childNodes.length;)f.appendChild(c.childNodes[0]);c.appendChild(f)}}catch(g){dalert(g)}};this.doLoopRemove_LetterOperation_After=function(a,b,c,d){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&c==a.id)d.bFindStart_For_Recursive=!0;else for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];
ID_SELECTION_ELEMENT_NODE==f.nodeType&&(this.doLoopRemove_LetterOperation_After(f,b,c,d),d.bFindStart_For_Recursive&&this.doRemove_Node_LetterOperation(f,b))}}catch(g){dalert(g)}};this.doLoopRemove_LetterOperation=function(a,b){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==d.nodeType&&(this.doLoopRemove_LetterOperation(d,b),this.removeSpanStyle(d,b))}}catch(e){dalert(e)}};this.processRangeLetterOperation=function(a,
b,c,d,e,f){try{g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1,this.checkLetterOperationTree(a,b,c,d,e,f)}catch(g){dalert(g)}};this.checkLetterOperationTree=function(a,b,c,d,e,f){try{if(!g_bFindPos_EndLetterOperation&&null!=b.childNodes){if(ID_SELECTION_ELEMENT_NODE==b.nodeType)if(!g_bFindPos_StartLetterOperation)e==b.id&&(g_bFindPos_StartLetterOperation=!0);else if(f==b.id){g_bFindPos_EndLetterOperation=!0;return}for(var g=0;g<b.childNodes.length;g++){var h=b.childNodes[g];this.checkLetterOperationTree(a,
h,c,d,e,f);try{"p"!=h.nodeName.toLowerCase()||"<br>"!=h.innerHTML&&"<br/>"!=h.innerHTML&&"<br />"!=h.innerHTML&&h.childNodes.length||(h.innerHTML=duzon_dialog.dze_bookmark_last_tag,this.checkLetterOperationTree(a,h,c,d,e,f))}catch(v){}if(g_bFindPos_EndLetterOperation)break;if(g_bFindPos_StartLetterOperation&&ID_SELECTION_TEXT_NODE==h.nodeType){var k=!0;""==h.nodeValue&&(k=!1);checkTextNodeAllWhiteCode_Plus_Space(h.nodeValue)&&(k=!1);if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var l=
h.nodeValue;try{if(g_bBrowserType_FF||g_bBrowserType_WK){if(1==l.length){var n=l.charCodeAt(0);if(10==n||13==n)k=!1}}else g_bBrowserType_OP&&2>=l.length&&(n=l.charCodeAt(0),10==n||13==n)&&(k=!1)}catch(v){}}if(k){var m=this.doLetterOperationApply(a,h,c,d);if(m){if("span"===b.nodeName.toLowerCase())var r=this.getTextDecorationFromStyle(b);if(!1===fnObjectCheckNull(r)&&(0<=r.indexOf("underline")||0<=r.indexOf("line-through")))for(this.removeSpanStyle(b,ID_LETTER_OPERATION_TEXT_DECORATION),k=0;k<b.childNodes.length;k++){var q=
b.childNodes[k];if(q.nodeType===ID_SELECTION_TEXT_NODE){if(0!==q.nodeValue.length)if(q===h)m.style.textDecoration=r,b.insertBefore(m,q),m.appendChild(b.childNodes[k+1]);else{var u=g_objEditorDocument[a].createElement("span");u.style.textDecoration=r;b.insertBefore(u,q);u.appendChild(b.childNodes[k+1])}}else if("span"!==q.nodeName.toLowerCase()||q.id!==e&&q.id!==f){var z=this.getTextDecorationFromStyle(q);q.style.textDecoration=null!==z&&0<z.length?q.style.textDecoration+(" "+r):r}}else b.insertBefore(m,
h),m.appendChild(h);if(c==ID_LETTER_OPERATION_FONT_SIZE||c==ID_LETTER_OPERATION_FORE_COLOR){var p=g_objNodeUtil.getLoopParentElement(m,"li");null!=p&&(c==ID_LETTER_OPERATION_FONT_SIZE&&(p.style.fontSize=d),c==ID_LETTER_OPERATION_FORE_COLOR&&(p.style.color=d))}}}}}}}catch(v){dalert(v)}};this.doLetterOperationApply=function(a,b,c,d){try{return ID_SELECTION_TEXT_NODE!=b.nodeType?null:this.doLetterOperationCreateElement(a,c,d)}catch(e){dalert(e)}return null};this.doLetterOperationCreateElement=function(a,
b,c){try{var d=g_objEditorDocument[a].createElement("span");return this.doLetterOperationStyleApply(d,b,c)?d:null}catch(e){dalert(e)}return null};this.doLetterOperationStyleApply=function(a,b,c){try{if(!a)return!1;if(b==ID_LETTER_OPERATION_FONT_FAMILY)a.style.fontFamily=quoteFontFamily(c);else if(b==ID_LETTER_OPERATION_FONT_SIZE)a.style.fontSize=c;else if(b==ID_LETTER_OPERATION_FORE_COLOR)a.style.color=c;else if(b==ID_LETTER_OPERATION_BACK_COLOR)a.style.backgroundColor=c;else if(b==ID_LETTER_OPERATION_LETTER_SPACING)a.style.letterSpacing=
c;else if(b==ID_LETTER_OPERATION_LINE_HEIGHT)a.style.lineHeight=c;else return!1;return!0}catch(d){dalert(d)}return!1};this.removeSpanStyle=function(a,b){try{if(b==ID_LETTER_OPERATION_FONT_FAMILY)a.style.fontFamily="",g_bBrowserType_IE?a.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontFamily");else if(b==ID_LETTER_OPERATION_FONT_SIZE)a.style.fontSize="",g_bBrowserType_IE?a.style.removeAttribute("fontSize"):(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontSize");else if(b==ID_LETTER_OPERATION_FORE_COLOR)a.style.color="",g_bBrowserType_IE?a.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("color");else if(b==ID_LETTER_OPERATION_BACK_COLOR)a.style.backgroundColor="",g_bBrowserType_IE?a.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("backgroundColor");
else if(b==ID_LETTER_OPERATION_LETTER_SPACING)a.style.letterSpacing="",g_bBrowserType_IE?a.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("letterSpacing");else if(b==ID_LETTER_OPERATION_LINE_HEIGHT)a.style.lineHeight="",g_bBrowserType_IE?a.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("lineHeight");else if(b===ID_LETTER_OPERATION_TEXT_DECORATION)if(g_bBrowserType_IE)a.style.removeAttribute("text-decoration"),
a.style.removeAttribute("text-decoration-line");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)a.style.removeProperty("text-decoration"),a.style.removeProperty("text-decoration-line")}catch(c){dalert(c)}};this.removeNodeStyle=function(a,b){try{if(!a)return!1;if(b==ID_LETTER_OPERATION_FONT_FAMILY)a.style.fontFamily="",g_bBrowserType_IE?a.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontFamily");else if(b==ID_LETTER_OPERATION_FONT_SIZE)a.style.fontSize=
"",g_bBrowserType_IE?a.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontSize");else if(b==ID_LETTER_OPERATION_FORE_COLOR)a.style.color="",g_bBrowserType_IE?a.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("color");else if(b==ID_LETTER_OPERATION_BACK_COLOR)a.style.backgroundColor="",g_bBrowserType_IE?a.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("backgroundColor");else if(b==ID_LETTER_OPERATION_LETTER_SPACING)a.style.letterSpacing="",g_bBrowserType_IE?a.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("letterSpacing");else if(b==ID_LETTER_OPERATION_LINE_HEIGHT){for(b=g_objPropertyUtil;a.tagName&&"p"!=a.tagName.toLowerCase();){if(fnObjectCheckNull(a.parentNode)||b.hasClass(a,["dze_page_main","dze_page_header_container",
"dze_page_footer_container"]))return!1;a=a.parentNode}a.style.lineHeight="";g_bBrowserType_IE?a.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("lineHeight")}}catch(c){dalert(c)}};this.doRemoveStyleLetterOperation=function(a,b,c){try{this.nRemoveStyleTransactionCount=0;var d=this.paramCheckLetterOperation();for(b=!1;g_bFindPos_EndLetterOperation=g_bFindPos_StartLetterOperation=!1,this.doRemoveStyleChildLetterOperationTree(a,0,d),
0!=this.nRemoveStyleTransactionCount;)this.nRemoveStyleTransactionCount=0,d.textValue=null,d.textDepth=0,b=!0;return b}catch(e){dalert(e)}return!1};this.paramCheckLetterOperation=function(){return{textValue:null,textDepth:0}};this.doRemoveStyleChildLetterOperationTree=function(a,b,c){try{if(null!=a.childNodes)if(b++,null==a.childNodes)c.textValue=null,c.textDepth=0;else if(0==a.childNodes.length&&ID_SELECTION_TEXT_NODE==a.nodeType)c.textValue=a.nodeValue,c.textDepth=b;else{this.removeEmptyChildTextNode(a);
for(var d=0;d<a.childNodes.length;d++){var e=a.childNodes[d];this.doRemoveStyleChildLetterOperationTree(e,b,c);if(null!=c.textValue)if(1==a.childNodes.length&&ID_SELECTION_ELEMENT_NODE==a.nodeType){var f=!1;if("span"==a.nodeName.toLowerCase()){if(b==c.textDepth-2){var g=this.findStyleLetterOperation(e);if(null!=g){this.doMergeAvailableAttribute(a,e,g);var h=a.innerHTML;h=h.toLowerCase();var k=h.indexOf("<span>"),l=h.indexOf("<span style>"),n=h.indexOf('<span style="">');if(0==k||0==l||0==n)f=!0,a.nodeValue=
c.textValue,c.textDepth=b+1}f||(c.textValue=null,c.textDepth=0)}}else c.textValue=null,c.textDepth=0}else c.textValue=null,c.textDepth=0}this.mergeChildAllSpanNode(a)}}catch(m){dalert(m)}};this.mergeChildAllSpanNode=function(a){try{if(!(1>=a.childNodes.length)){for(var b=[],c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE!=d.nodeType||"span"!=d.nodeName.toLowerCase()||1!=d.childNodes.length||ID_SELECTION_TEXT_NODE!=d.childNodes[0].nodeType)return;b[c]=this.findStyleLetterOperation(d)}if(!(a.childNodes.length!=
b.length||1>=b.length)){var e=b[0].strValue_FontFamily,f=b[0].strValue_FontSize,g=b[0].strValue_Color,h=b[0].strValue_BackgroundColor,k=b[0].strValue_LetterSpacing,l=b[0].strValue_LineHeight;for(c=1;c<b.length;c++)if(e!=b[c].strValue_FontFamily||f!=b[c].strValue_FontSize||g!=b[c].strValue_Color||h!=b[c].strValue_BackgroundColor||k!=b[c].strValue_LetterSpacing||l!=b[c].strValue_LineHeight)return;var n=a.innerHTML,m=g_objEditorDocument[g_nActiveEditNumber].createElement("div");m.innerHTML=n;if(a.childNodes.length==
m.childNodes.length){c=!0;var r=g_objEditorDocument[g_nActiveEditNumber].createElement("span");for(r.innerHTML="&nbsp;";0!=m.childNodes.length;){d=m.childNodes[0];var q=g_objEditorDocument[g_nActiveEditNumber].createElement("div");q.appendChild(d);c?(r.childNodes[0].nodeValue=d.childNodes[0].nodeValue,c=!1):r.childNodes[0].nodeValue+=d.childNodes[0].nodeValue;b[0].bFontFamily&&(q.childNodes[0].style.fontFamily="",g_bBrowserType_IE&&d.style.removeAttribute("fontFamily"));b[0].bFontSize&&(q.childNodes[0].style.fontSize=
"",g_bBrowserType_IE&&d.style.removeAttribute("fontSize"));b[0].bColor&&(q.childNodes[0].style.color="",g_bBrowserType_IE&&d.style.removeAttribute("color"));b[0].bBackgroundColor&&(q.childNodes[0].style.backgroundColor="",g_bBrowserType_IE&&d.style.removeAttribute("backgroundColor"));b[0].bLetterSpacing&&(q.childNodes[0].style.letterSpacing="",g_bBrowserType_IE&&d.style.removeAttribute("letterSpacing"));b[0].bLineHeight&&(q.childNodes[0].style.lineHeight="",g_bBrowserType_IE&&d.style.removeAttribute("lineHeight"));
var u=q.innerHTML;u=u.toLowerCase();var z=u.indexOf("<span>"),p=u.indexOf("<span style>"),v=u.indexOf('<span style="">');if(0!=z&&0!=p&&0!=v)return}for(;1!=a.childNodes.length;)a.removeChild(a.childNodes[1]);a.childNodes[0].innerHTML="&nbsp;";a.childNodes[0].replaceChild(r.childNodes[0],a.childNodes[0].childNodes[0])}}}}catch(t){dalert(t)}};this.removeEmptyChildTextNode=function(a){try{if("span"==a.nodeName.toLowerCase())for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];ID_SELECTION_TEXT_NODE==
c.nodeType&&""==c.nodeValue&&(a.removeChild(c),b=-1)}}catch(d){dalert(d)}};this.setParaStyle=function(a,b){try{var c=b.arrPara||this.getSelectedParagraph(a);if(!c||0>c.length)return!1;for(var d=!1,e=!1,f=null,g=0,h=c.length;g<h;g++){f=c[g];"textAlign"in b&&(e=this.setAlign(f,b.textAlign)||e);if("marginLeft"in b||"marginRight"in b||"marginTop"in b||"marginBottom"in b||"listMarginTop"in b||"listMarginBottom"in b)e=this.setMargin(f,b)||e;"outdent"in b&&(e=this.setOutdentIndent(f,!0)||e);"indent"in b&&
(e=this.setOutdentIndent(f,!1)||e);"textIndent"in b&&(e=this.setTextIndent(f,b.textIndent)||e);"lineHeight"in b&&(e=this.setLineHeight(f,b.lineHeight)||e);"head"in b&&(e=this.setNodeHeadingValue(f,b.head,a)||e);!0===e&&(d=!0)}return d}catch(k){dalert(k)}};this.findStyleLetterOperation=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType&&"span"==a.nodeName.toLowerCase()){var b={bFontFamily:!1,bFontSize:!1,bColor:!1,bBackgroundColor:!1,bLetterSpacing:!1,bLineHeight:!1,strValue_FontFamily:"",strValue_FontSize:"",
strValue_Color:"",strValue_BackgroundColor:"",strValue_LetterSpacing:"",strValue_LineHeight:""},c=a.style.fontFamily,d=a.style.fontSize,e=a.style.color,f=a.style.backgroundColor,g=a.style.letterSpacing,h=a.style.lineHeight;null!=c&&""!=c&&(b.bFontFamily=!0,b.strValue_FontFamily=c);null!=d&&""!=d&&(b.bFontSize=!0,b.strValue_FontSize=d);null!=e&&""!=e&&(b.bColor=!0,b.strValue_Color=e);null!=f&&""!=f&&(b.bBackgroundColor=!0,b.strValue_BackgroundColor=f);null!=g&&""!=g&&(b.bLetterSpacing=!0,b.strValue_LetterSpacing=
g);null!=h&&""!=h&&(b.bLineHeight=!0,b.strValue_LineHeight=h);return b}}catch(k){dalert(k)}return null};this.doMergeAvailableAttribute=function(a,b,c){try{c.bFontFamily&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_FONT_FAMILY,b.style.fontFamily),b.style.fontFamily="",g_bBrowserType_IE?b.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("fontFamily"),this.nRemoveStyleTransactionCount++),c.bFontSize&&(this.doLetterOperationStyleApply(a,
ID_LETTER_OPERATION_FONT_SIZE,b.style.fontSize),b.style.fontSize="",g_bBrowserType_IE?b.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("fontSize"),this.nRemoveStyleTransactionCount++),c.bColor&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_FORE_COLOR,b.style.color),b.style.color="",g_bBrowserType_IE?b.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("color"),
this.nRemoveStyleTransactionCount++),c.bBackgroundColor&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_BACK_COLOR,b.style.backgroundColor),b.style.backgroundColor="",g_bBrowserType_IE?b.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("backgroundColor"),this.nRemoveStyleTransactionCount++),c.bLetterSpacing&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_LETTER_SPACING,b.style.letterSpacing),b.style.letterSpacing=
"",g_bBrowserType_IE?b.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("letterSpacing"),this.nRemoveStyleTransactionCount++),c.bLineHeight&&(this.doLetterOperationStyleApply(a,ID_LETTER_OPERATION_LINE_HEIGHT,b.style.lineHeight),b.style.lineHeight="",g_bBrowserType_IE?b.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.style.removeProperty("lineHeight"),this.nRemoveStyleTransactionCount++)}catch(d){dalert(d)}};
this.processOnlyTextLetterOperation=function(a,b,c,d){try{if(window.attachEvent)return null;var e=g_objEditorDocument[a].createElement("span"),f=g_objNodeUtil.getLoopParentElement(b.commonAncestorContainer,"span");if(!1===fnObjectCheckNull(f))var g=this.getTextDecorationFromStyle(f);if(!1===fnObjectCheckNull(g)&&(0<=g.indexOf("underline")||0<=g.indexOf("line-through")))if(this.removeSpanStyle(f,ID_LETTER_OPERATION_TEXT_DECORATION),0<b.startOffset||b.endOffset!==b.endContainer.length){g_objNodeUtil.splitTextNodeByOffset(b);
var h=b.commonAncestorContainer;for(b=0;b<f.childNodes.length;b++){var k=f.childNodes[b];var l=g_objEditorDocument[a].createElement("span");l.style.textDecoration=g;k===h&&(e=l);f.insertBefore(l,k);l.appendChild(f.childNodes[b+1])}}else e.style.textDecoration=g,e.appendChild(b.cloneContents());else e.appendChild(b.cloneContents());if(!this.doLetterOperationStyleApply(e,c,d))return null;SelectionUtil.deleteSelection(a,{bDoNotExpandRange:!0,bDoNotRemoveEmpty:!0});insertHTMLCodeAtSelection(null,e,a);
var n=g_objNodeUtil.getParentElement(e);this.removeEmptyChildTextNode_For_processOnlyTextLetterOperation(n);return e}catch(m){dalert(m)}return null};this.removeEmptyChildTextNode_For_processOnlyTextLetterOperation=function(a){try{for(var b=0;b<a.childNodes.length;b++){var c=a.childNodes[b];ID_SELECTION_TEXT_NODE==c.nodeType&&""==c.nodeValue&&(a.removeChild(c),b=-1)}}catch(d){dalert(d)}};this.getPositionOffset_OP=function(a,b,c,d){try{var e=b.nodeValue;b.nodeValue=d?c+e:e+c;var f=a.nodeValue,g=f.indexOf(c);
if(-1==g)return b.nodeValue=e,-1;var h=f.substr(0,g),k=f.substr(g+c.length);a.nodeValue=h+k;return g}catch(l){dalert(l)}return-1};this.insertSpanNodeBetweenTextValue_OP=function(a,b,c,d,e,f){try{var g=e.substr(0,f),h=e.substr(f),k=g_objEditorDocument[a].createTextNode(g),l=g_objEditorDocument[a].createTextNode(h);b.insertBefore(k,c);b.insertBefore(d,c);b.insertBefore(l,c);b.removeChild(c)}catch(n){dalert(n)}};this.doLoop_Node_Heading=function(a,b,c){try{if(ID_SELECTION_TEXT_NODE!=a.nodeType)for(var d=
0;d<a.childNodes.length;d++){var e=a.childNodes[d];ID_SELECTION_ELEMENT_NODE==e.nodeType&&(this.doLoop_Node_Heading(e,b,c),this.setNodeHeadingValue(e,b,c))}}catch(f){dalert(f)}};this.setNodeHeadingValue=function(a,b,c){try{var d=!1,e=!1;""==b&&(e=!0);var f=g_objCaretUtil,g="dze_replace_head_"+g_objCommonUtil.getUniqueID(),h=a.nodeName.toLowerCase();"h1"==h||"h2"==h||"h3"==h||"h4"==h||"h5"==h||"h6"==h?e?(f.saveCaret(c,g),this.replaceHeadingBlockNode(b,a,c),d=!0):b!==h&&(f.saveCaret(c,g),this.doLoopRemove_LetterOperation(a,
ID_LETTER_OPERATION_FONT_SIZE),this.replaceHeadingBlockNode(b,a),d=!0):"p"!=h&&"li"!=h&&"dt"!=h&&"dd"!=h&&"pre"!=h||e||(f.saveCaret(c,g),this.doLoopRemove_LetterOperation(a,ID_LETTER_OPERATION_FONT_SIZE),this.replaceHeadingBlockNode(b,a),d=!0);!0===d&&f.restoreCaret(c,g);return d}catch(k){dalert(k)}};this.replaceHeadingBlockNode=function(a,b){try{if(b){a||(a="p");if(g_objNodeUtil.isListItem(b)){var c=g_objListUtil.replaceWithPara(b);c&&(b=c)}var d=b.ownerDocument.createElement(a);!0===g_objPropertyUtil.hasClass(b,
"dze_shape_anchor")&&g_objPropertyUtil.addClass(d,"dze_shape_anchor");var e=g_objPropertyUtil.getElement_TextAlign(b);null!=e&&""!=e&&(d.style.textAlign=e);g_objNodeUtil.moveNodesTo(d,b.firstChild);b.parentNode.replaceChild(d,b)}}catch(f){dalert(f)}};this.isParagraph=function(a){return 0<=g_objNodeUtil.arrParaNodeName.indexOf(a.nodeName)||g_objPropertyUtil.hasClass(a,"dze_shape_text_contents")&&g_objPropertyUtil.hasClass(a,"paragraph")?!0:!1};this.getSelectedParagraph=function(a){try{var b=[];this.traverseSelectedParagraph(a,
function(a){b.push(a)});return b}catch(c){dalert(c)}};this.getChildParagraph=function(a){try{for(var b=[],c=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,function(a){return!0===g_objLetterFn.isParagraph(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},!0),d=c.firstChild();d;)b.push(d),d=c.nextNode();return b}catch(e){dalert(e)}};this.traverseSelectedParagraph=function(a,b){function c(a){return a&&1===a.nodeType?g_objLetterFn.isParagraph(a)?!1===g_objEditMode.isLoopContentEditable(a)?
NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_SKIP}function d(a){for(var b=g_objNodeUtil;a&&!b.isBoundNode(a);){if(g_objLetterFn.isParagraph(a))return a;a=a.parentNode}return null}if(!b)return!1;a=function(a){var b=[];GetMultiCellSelection(a)?g_objTableSelection.doAllSelectedCell(function(a){var c=a.ownerDocument.createRange();c.setStart(a,0);c.setEnd(a,a.childNodes.length);b.push(c)}):(a=GetCurRange(a))&&b.push(a);return b}(a);var e=null,f=null;f=null;for(var g=
0,h=a.length;g<h;g++)if(range=a[g],e=g_objNodeUtil.createRangeWalker(range,NodeFilter.SHOW_ELEMENT,c))if(f=e.firstChild())for(;f;)b(f),f=e.nextNode();else(f=d(range.commonAncestorContainer))&&b(f);return!0};this.getSelectedParaStyle=function(a,b,c){function d(a,b){var c=a.style[b];c||(g||(g=a.ownerDocument.defaultView.getComputedStyle(a,null)),c=g[b]);"lineHeight"===b?c=g_objPropertyUtil.getUnitlessLineHeight(c,d(a,"fontSize")):"textAlign"===b&&(c=c.replace("-webkit-",""),c="start"===c?"left":"end"===
c?"right":c);return c?c:""}function e(a,b,c){var e=a,h=b;("listMarginTop"===b||"listMarginBottom"===b)&&g_objNodeUtil.isListItem(a)&&g_objNodeUtil.isList(a.parentNode)&&(e=a.parentNode,h="listMarginTop"===b?"marginTop":"marginBottom");a!==e&&(g=null);b in c&&!1===c.objMultiple[b]&&(""===c[b]?c[b]=d(e,h):c[b]!==d(e,h)&&(c[b]="",c.objMultiple[b]=!0))}function f(a){a||(a={textAlign:"",marginTop:"",marginLeft:"",marginRight:"",marginBottom:"",listMarginTop:"",listMarginBottom:"",textIndent:"",lineHeight:""});
a.objMultiple=cloneSimpleObject(a);Object.keys(a.objMultiple).forEach(function(b){a.objMultiple[b]=!1});return a}var g=null;try{b=f(b);try{this.traverseSelectedParagraph(a,function(a){g=null;e(a,"textAlign",b);e(a,"marginLeft",b);e(a,"marginRight",b);e(a,"marginTop",b);e(a,"marginBottom",b);e(a,"listMarginTop",b);e(a,"listMarginBottom",b);e(a,"textIndent",b);e(a,"lineHeight",b);if(!0===c)throw BreakException;a:{a=b.objMultiple;for(d in a)if(!0!==a[d]){var d=!1;break a}d=!0}if(!0===d)throw BreakException;
})}catch(h){}return b}catch(h){dalert(h)}};this.setAlign=function(a,b){try{if(!a)return!1;b=b||"";return a.style.textAlign!==b?(a.style.textAlign=b,g_objNodeUtil.isListItem(a)&&(a.style.listStylePosition="center"===b||"right"===b?"inside":""),a.hasAttribute("align")&&a.removeAttribute("align"),""===b&&""===a.style.cssText&&a.removeAttribute("style"),!0):!1}catch(c){dalert(c)}};this.setOutdentIndent=function(a,b){try{var c=g_nOutdentIndentWidth,d=g_objPropertyUtil.getElementStyleAttributeValue(a,"margin-left"),
e=g_objCommonUtil.toPx(d);if(b){e=parseInt(e)-parseInt(c);var f=e%c;0!=f&&(e=parseInt(e)+parseInt(f))}else e=parseInt(e)+parseInt(c),f=e%c,0!=f&&(e=parseInt(e)-parseInt(f));0>e&&(e=0);var g=g_objCommonUtil.toPx(a.style.marginLeft);!0===isNaN(g)&&(g=0);if(g===e)return!1;g_objPositionUtil.arrangeObjectPosition(a,e-g);a.style.marginLeft=e+"px";return!0}catch(h){dalert(h)}};this.setMargin=function(a,b){function c(a,b,c){var d=a.style[b];""!==d&&(d=g_objCommonUtil.toPx(d));""!==c&&(c=g_objCommonUtil.toPx(c));
return d!==c?(c=""!==c?c+"px":"",a.style[b]=c,""===c&&""===a.style.cssText&&a.removeAttribute("style"),!0):!1}try{var d=g_objNodeUtil,e=!1;if("marginLeft"in b){var f=g_objCommonUtil.toPx(b.marginLeft),g=g_objCommonUtil.toPx(a.style.marginLeft)-f;c(a,"marginLeft",b.marginLeft)&&(g_objPositionUtil.arrangeObjectPosition(a,g),e=!0)}"marginTop"in b&&c(a,"marginTop",b.marginTop)&&(a.style.paddingTop="",e=!0);"marginRight"in b&&c(a,"marginRight",b.marginRight)&&(e=!0);"marginBottom"in b&&c(a,"marginBottom",
b.marginBottom)&&(a.style.paddingBottom="",e=!0);if("listMarginTop"in b)for(var h=a,k=h.parentNode;(d.isList(h)||d.isListItem(h))&&d.isList(k)&&c(k,"marginTop",b.listMarginTop);)if(k.style.paddingTop="",e=!0,k.parentNode&&k.parentNode.firstChild===k&&d.isList(k.parentNode))h=k,k=k.parentNode;else break;if("listMarginBottom"in b)for(h=a,k=h.parentNode;(d.isList(h)||d.isListItem(h))&&d.isList(k)&&c(k,"marginBottom",b.listMarginBottom);)if(k.style.paddingBottom="",e=!0,k.parentNode&&k.parentNode.lastChild===
k&&d.isList(k.parentNode))h=k,k=k.parentNode;else break;return e}catch(l){dalert(l)}};this.setTextIndent=function(a,b){try{var c=a.style.textIndent;""!==c&&(c=g_objCommonUtil.toPx(c));""!==b&&(b=g_objCommonUtil.toPx(b));return c!==b?(b=""!==b?b+"px":"",a.style.textIndent=b,""===b&&""===a.style.cssText&&a.removeAttribute("style"),!0):!1}catch(d){dalert(d)}};this.setLineHeight=function(a,b){try{if(a.style.lineHeight!==b){a.style.lineHeight=b;b=function(a){if(!a||!a.parentNode)return NodeFilter.FILTER_REJECT;
a=a.tagName.toLowerCase();return g_objNodeUtil.check_is_CM_INLINE(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP};b.acceptNode=b;var c=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,b,!0);for(a=c.firstChild();a;)a.style.lineHeight&&(a.style.lineHeight="",""===a.style.cssText&&a.removeAttribute("style")),a=c.nextNode();return!0}return!1}catch(d){dalert(d)}};this.getTopSpanNode=function(a){try{for(;;){var b=g_objNodeUtil.getParentElement(a);if("span"!=g_objNodeUtil.getElementTagName(b).toLowerCase())break;
a=b}return a}catch(c){dalert(c)}return null};this.copySpanStyle=function(a,b){try{for(var c="";b&&g_objNodeUtil.checkTagName(b,"span");)b.getAttribute("style")&&(c=b.getAttribute("style")+c),b=b.parentNode;c&&a.setAttribute("style",c)}catch(d){dalert(d)}};this.isEmptySpan=function(a){try{if(!a)return!1;if(1===a.nodeType&&("SPAN"===a.nodeName||"FONT"===a.nodeName)&&1===a.childNodes.length){var b=a.childNodes[0];if(3===b.nodeType&&!b.nodeValue.replace(/\u200B/g,""))return!0}else if(3===a.nodeType&&
!0===!a.nodeValue.replace(/\u200B/g,""))return!0;return!1}catch(c){dalert(c)}};this.getClosetBlockElement=function(a){try{for(var b=g_objNodeUtil,c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a)&&!(b.isBlockNode(a)||1==a.nodeType&&"span"===a.tagName.toLowerCase()&&!0===c.element_hasClass(a,"dze_shape_text_span"));)a=a.parentNode;return a}catch(d){dalert(d)}};this.getTextDecorationFromStyle=function(a){try{var b=a.style.textDecoration.toLowerCase();!0!==fnObjectCheckNull(b)&&0!==b.length||!1!==fnObjectCheckNull(a.style.textDecorationLine)||
(b=a.style.textDecorationLine.toLowerCase(),!1===fnObjectCheckNull(b)&&0<b.length&&(this.removeSpanStyle(a,ID_LETTER_OPERATION_TEXT_DECORATION),a.style.textDecoration=b));return b}catch(c){dalert(c)}}};function TextAtt(){}TextAtt.attName="font-family font-size font-style font-weight color background-color letter-spacing text-decoration-line".split(" ");
TextAtt.getPath=function(a,b){try{var c=[],d=g_objNodeUtil;if(!0===b)for(;a&&!d.isBlockNode(a)&&!d.isCell(a);)c.push(a),a=a.parentNode;else{for(;a;)c.push(a),a=a.firstChild;c.reverse()}return c}catch(e){dalert(e)}};
TextAtt.getAtt=function(a){try{var b=new TextAtt;if(!a)return b;var c=!0;3!==a.nodeType&&"BR"!==a.nodeName&&(c=!1);var d=TextAtt.getPath(a,c);c=0;for(var e=d.length;c<e;c++){a=d[c];var f=a.style;if(f){TextAtt.attName.forEach(function(a){a=camelCase(a);b[a]||f[a]&&(b[a]=f[a])});var g=a.tagName;g=g?g.toLowerCase():"";switch(g){case "b":case "strong":case "u":case "i":case "em":case "strike":case "s":case "sup":case "sub":b[g]=!0}}}return b}catch(h){dalert(h)}};
TextAtt.setAtt=function(a,b){try{if(!a||!b||3!==a.nodeType&&"BR"!==a.nodeName)return!1;var c=Object.keys(b);if(0>=c.length)return!1;var d=function(a,b){b=a.ownerDocument.createElement(b);a.parentNode.replaceChild(b,a);b.appendChild(a);return b};c.forEach(function(c){switch(c){case "b":case "strong":case "u":case "i":case "em":case "strike":case "s":case "sup":case "sub":a=d(a,c);return}"SPAN"!==a.nodeName&&(a=d(a,"span"));c=camelCase(c);b[c]&&(a.style[c]=b[c])});return!0}catch(e){dalert(e)}};
function ParaAtt(){}ParaAtt.attName="text-align margin-left margin-right padding-top padding-bottom text-indent line-height color font-family font-size".split(" ");ParaAtt.getPath=function(a,b){try{var c=[],d=g_objNodeUtil;if(!0===b)for(;a&&!d.isCell(a);){if(d.isBlockNode(a)){c.push(a);break}a=a.parentNode}else for(;a;){if(d.isBlockNode(a)){c.push(a);break}a=a.firstChild}return c}catch(e){dalert(e)}};
ParaAtt.getAtt=function(a){try{var b=new ParaAtt;if(!a)return b;var c=!0;3!==a.nodeType&&"BR"!==a.nodeName&&(c=!1);var d=(a=ParaAtt.getPath(a,c)[0])?a.style:null;if(!d)return b;ParaAtt.attName.forEach(function(a){a=camelCase(a);b[a]||d[a]&&(b[a]=d[a])});return b}catch(e){dalert(e)}};ParaAtt.setAtt=function(a,b){try{if(!a||!b||0>=Object.keys(b).length)return!1;ParaAtt.attName.forEach(function(c){c=camelCase(c);b[c]&&(a.style[c]=b[c])});return!0}catch(c){dalert(c)}};

var g_objTextFormat=new function(){this.zeroWidthSpace="&#8203;&#8203;";this.zeroWidthSpaceCode="\u200b\u200b";this.arrTextFormatCommand="bold italic underline strikethrough subscript superscript".split(" ");this.arrTextFormatNodeName="B I U STRIKE SUB SUP".split(" ");this.isInlineNodeName=function(a){switch(a){case "A":case "ABBR":case "ACRONYM":case "B":case "BASEFONT":case "BDO":case "BIG":case "BR":case "CITE":case "CODE":case "DEL":case "DFN":case "EM":case "FONT":case "I":case "INS":case "KBD":case "Q":case "RB":case "RBC":case "RP":case "RT":case "RTC":case "RUBY":case "S":case "SAMP":case "SMALL":case "SPAN":case "STRIKE":case "STRONG":case "SUB":case "SUP":case "TT":case "Y":case "VAR":return!0}return!1};
this.getTextFormatNodeName=function(a){a=this.arrTextFormatCommand.indexOf(a);return 0<=a&&a<this.arrTextFormatNodeName.length?this.arrTextFormatNodeName[a]:""};this.checkUse=function(a){try{if(!g_browserCHK.mobile)return!1;var b=GetCurRange(a);return b?b.collapsed?!0:!1:!1}catch(c){dalert(c)}finally{}};this.toogleTextFormat=function(a,b){try{if(!b||"string"!==typeof b)return!1;b=b.toLowerCase();if(0>this.arrTextFormatCommand.indexOf(b))return!1;!0===this.getTextFormat(a,b)?this.removeTextFormat(a,
b):this.setTextFormat(a,b)}catch(c){dalert(c)}};this.setTextFormat=function(a,b){try{var c=GetCurRange(a);return c?c.collapsed?this.setTextFormatWhenCollapsed(c,b):!1:!1}catch(d){dalert(d)}};this.removeTextFormat=function(a,b){try{var c=GetCurRange(a);return c?c.collapsed?this.removeTextFormatWhenCollapsed(c,b):!1:!1}catch(d){dalert(d)}};this.getTextFormat=function(a,b){try{var c=g_objEditorDocument[a||0],d=c.queryCommandState(b),e=c.queryCommandEnabled(b);return d&&e}catch(f){dalert(f)}};this.setTextFormatWhenCollapsed=
function(a,b){try{if(!a)return!1;var c=a.startContainer,d=a.startOffset,e=c.ownerDocument,f=this.getClosestBound(c);if(!f)return!1;var g=null,l=null;if("subscript"===b||"superscript"===b)l=(g=this.getTopTextFormatElement(f,c,"subscript"===b?"superscript":b))?g.parentNode:null;var h=this.getTextFormatNodeName(b),m=e.createElement(h),k=e.createTextNode(this.zeroWidthSpaceCode);e=1;m.appendChild(k);3===c.nodeType&&""===removeZeroWidthSpaceFromString(c.nodeValue)?c.parentNode.replaceChild(m,c):(3===c.nodeType&&
(d=removeZeroWidthSpaceFromTextNode(c,d)),this.insertNodeAt(m,c,d));if(g){this.split(l,k);this._removeTextFormat(l,k,"subscript"===b?"superscript":b);var n=this.merge(l,k,1);n&&(k=n.offsetNode,e=n.offset)}a.setStart(k,e);a.setEnd(k,e);SetCurRange(a);return!0}catch(p){dalert(p)}};this.removeTextFormatWhenCollapsed=function(a,b){try{if(!a||!b)return!1;var c=a.startContainer,d=a.startOffset,e=c.ownerDocument,f=this.getClosestBound(c);if(!f)return!1;var g=this.getTopTextFormatElement(f,c,b),l=g?g.parentNode:
null;if(!g)return!1;var h=e.createTextNode(this.zeroWidthSpaceCode);e=1;3===c.nodeType&&""===removeZeroWidthSpaceFromString(c.nodeValue)?c.parentNode.replaceChild(h,c):(3===c.nodeType&&(d=removeZeroWidthSpaceFromTextNode(c,d)),this.insertNodeAt(h,c,d));if(!h||!h.parentNode)return!1;this.split(l,h);var m=this._removeTextFormat(l,h,b),k=this.merge(l,h,1);k&&(h=k.offsetNode,e=k.offset);a.setStart(h,e);a.setEnd(h,e);SetCurRange(a);return 0<m?!0:!1}catch(n){dalert(n)}};this.getClosestBound=function(a){return g_objNodeUtil.getClosestParagraph(a)||
g_objNodeUtil.getClosestBound(a)};this.getTopTextFormatElement=function(a,b,c){try{for(var d=null;b&&b.parentNode&&b!==a;)this.isTextFormat(b,c)&&(d=b),b=b.parentNode;return d}catch(e){dalert(e)}};this.isTextFormat=function(a,b){try{return this["is"+b.capitalizeFirstLetter()](a)}catch(c){return dlog("%cis"+b.capitalizeFirstLetter()+"() function not found","color: red;"),!1}};this.isTextFormatElement=function(a,b){try{return this["is"+b.capitalizeFirstLetter()+"Element"](a)}catch(c){return dlog("%cis"+
b.capitalizeFirstLetter()+"Element() function not found","color: red;"),!1}};this.isTextFormatStyle=function(a,b){try{return this["is"+b.capitalizeFirstLetter()+"Style"](a)}catch(c){return dlog("%cis"+b.capitalizeFirstLetter()+"Style() function not found","color: red;"),!1}};this._removeTextFormat=function(a,b,c){try{if(!a||!b)return!1;for(var d=b.parentNode,e=0;b&&d&&b!==a;)d=b.parentNode,this.isTextFormatElement(b,c)?this.removeElement(b)&&e++:this.isTextFormatStyle(b,c)&&this.removeTextFormatStyle(b,
c)&&e++,b=d;return e}catch(f){dalert(f)}};this.removeTextFormatStyle=function(a,b){try{return this["remove"+b.capitalizeFirstLetter()+"Style"](a)}catch(c){return dlog("%cremove"+b.capitalizeFirstLetter()+"Style() function not found.","color: red;"),!1}};this.isBold=function(a){return this.isBoldElement(a)||this.isBoldStyle(a)};this.isBoldElement=function(a){a=a?a.nodeName:"";return"B"===a||"STRONG"===a?!0:!1};this.isBoldStyle=function(a){return(a=a&&1===a.nodeType?a.style.fontWeight:"")&&"string"===
typeof a&&(a=a.toLowerCase(),"bold"===a||"bolder"===a||!isNaN(a)&&700<=parseInt(a,10))?!0:!1};this.setBoldStyle=function(a){a&&1===a.nodeType&&(a.style.fontWeight="bold")};this.removeBoldStyle=function(a){a&&1===a.nodeType&&(a.style.fontWeight="")};this.isItalic=function(a){return this.isItalicElement(a)||this.isItalicStyle(a)};this.isItalicElement=function(a){a=a?a.nodeName:"";return"I"===a||"EM"===a?!0:!1};this.isItalicStyle=function(a){return(a=a&&1===a.nodeType?a.style.fontStyle:"")&&"string"===
typeof a&&(a=a.toLowerCase(),"italic"===a||0<=a.indexOf("oblique"))?!0:!1};this.setItalicStyle=function(a){a&&1===a.nodeType&&(a.style.fontStyle="italic")};this.removeItalicStyle=function(a){a&&1===a.nodeType&&(a.style.fontStyle="")};this.isUnderline=function(a){return this.isUnderlineElement(a)||this.isUnderlineStyle(a)};this.isUnderlineElement=function(a){return"U"===(a?a.nodeName:"")?!0:!1};this.isUnderlineStyle=function(a){return(a=a&&1===a.nodeType?a.style.textDecorationLine:"")&&"string"===
typeof a&&(a=a.toLowerCase(),"underline"===a||"overline"===a)?!0:!1};this.setUnderlineStyle=function(a){a&&1===a.nodeType&&(a.style.textDecorationLine="underline")};this.removeUnderlineStyle=function(a){a&&1===a.nodeType&&(a.style.textDecorationLine="")};this.isStrikethrough=function(a){return this.isStrikethroughElement(a)||this.isStrikethroughStyle(a)};this.isStrikethroughElement=function(a){a=a?a.nodeName:"";return"S"===a||"STRIKE"===a?!0:!1};this.isStrikethroughStyle=function(a){return(a=a&&1===
a.nodeType?a.style.textDecorationLine:"")&&"string"===typeof a&&(a=a.toLowerCase(),"line-through"===a)?!0:!1};this.setStrikethroughStyle=function(a){a&&1===a.nodeType&&(a.style.textDecorationLine="line-through")};this.removeStrikethroughStyle=function(a){a&&1===a.nodeType&&(a.style.textDecorationLine="")};this.isSubscript=function(a){return this.isSubscriptElement(a)||this.isSubscriptStyle(a)};this.isSubscriptElement=function(a){return"SUB"===(a?a.nodeName:"")?!0:!1};this.isSubscriptStyle=function(a){return(a=
a&&1===a.nodeType?a.style.verticalAlign:"")&&"string"===typeof a&&(a=a.toLowerCase(),"sub"===a)?!0:!1};this.setSubscriptStyle=function(a){a&&1===a.nodeType&&(a.style.verticalAlign="sub",a.style.fontSize="smaller")};this.removeSubscriptStyle=function(a){a&&1===a.nodeType&&(a.style.verticalAlign="",a.style.fontSize="")};this.isSuperscript=function(a){return this.isSuperscriptElement(a)||this.isSuperscriptStyle(a)};this.isSuperscriptElement=function(a){return"SUP"===(a?a.nodeName:"")?!0:!1};this.isSuperscriptStyle=
function(a){return(a=a&&1===a.nodeType?a.style.verticalAlign:"")&&"string"===typeof a&&(a=a.toLowerCase(),"supper"===a)?!0:!1};this.setSuperscriptStyle=function(a){a&&1===a.nodeType&&(a.style.verticalAlign="sup",a.style.fontSize="smaller")};this.removeSuperscriptStyle=function(a){a&&1===a.nodeType&&(a.style.verticalAlign="",a.style.fontSize="")};this.removeElement=function(a){try{if(!a||!a.parentNode)return!1;var b=a.parentNode,c=a.ownerDocument.createDocumentFragment();g_objNodeUtil.moveNodesTo(c,
a.firstChild);b.replaceChild(c,a);return!0}catch(d){dalert(d)}};this.insertNodeAt=function(a,b,c){try{3===b.nodeType?0===c?b.parentNode.insertBefore(a,b):(c!==b.nodeValue.length&&b.splitText(c),insertAfter(b,a)):b.insertBefore(a,b.childNodes[c]||null)}catch(d){dalert(d)}};this.split=function(a,b){try{if(!a||!b||a===b||!a.contains(3===b.nodeType?b.parentNode:b))return!1;for(var c=null,d=null,e=null,f=null,g=b.parentNode;a!=g;g=f){c=g;d=g.firstChild===b?g:g.cloneNode(!1);e=null;for(g.lastChild!==b&&
(e=g.cloneNode(!1));e&&b.nextSibling;)e.appendChild(b.nextSibling);d.appendChild(b);insertAfter(c,d);e&&insertAfter(d,e);b=d;f=g.parentNode}return!0}catch(l){dalert(l)}};this.isEqual=function(a,b){a=a.cloneNode(!1);b=b.cloneNode(!1);var c=parseStyle(a.getAttribute("style")),d=parseStyle(b.getAttribute("style"));a.removeAttribute("style");b.removeAttribute("style");return!a.isEqualNode(b)||(c||d)&&(!c&&d||c&&!d||!equalStyle(c,d))?!1:!0};this.merge=function(a,b,c){try{if(!a||!b||a===b||!a.contains(3===
b.nodeType?b.parentNode:b))return!1;for(var d=b,e=d.parentNode,f=null;d&&d!==a;)e=d.parentNode,3===d.nodeType?f=this.mergeSibilingTextNode(d,b,c):1===d.nodeType&&(f=this.mergeSibilingTextFormatElement(d,b,c)),f&&(b=f.offsetNode,c=f.offset),d=e;return{offsetNode:b,offset:c}}catch(g){dalert(g)}};this.mergeSibilingTextNode=function(a,b,c){try{if(!a||!b)return null;for(var d="";a.nextSibling&&3===a.nextSibling.nodeType;)a.nodeValue+=removeZeroWidthSpaceFromString(a.nextSibling.nodeValue),a.parentNode.removeChild(a.nextSibling);
for(;a.previousSibling&&3===a.previousSibling.nodeType;)d=removeZeroWidthSpaceFromString(a.previousSibling.nodeValue),a===b&&(b=a.previousSibling,c+=d.length),a.previousSibling.nodeValue=d+a.nodeValue,a=a.previousSibling,a.parentNode.removeChild(a.nextSibling);d=removeZeroWidthSpaceFromString(b.nodeValue);0<d.length&&(c=removeZeroWidthSpaceFromTextNode(b,c));return{offsetNode:b,offset:c}}catch(e){dalert(e)}};this.mergeSibilingTextFormatElement=function(a,b,c){try{if(!a||!b)return null;for(var d=g_objNodeUtil,
e=a.ownerDocument.createDocumentFragment();a.nextSibling&&a.nextSibling.nodeName===a.nodeName&&this.isEqual(a,a.nextSibling);)d.moveNodesTo(e,a.nextSibling.firstChild),a.appendChild(e),a.parentNode.removeChild(a.nextSibling);for(;a.previousSibling&&a.previousSibling.nodeName===a.nodeName&&this.isEqual(a,a.previousSibling);)a===b&&(b=a.previousSibling,c+=a.previousSibling.childNodes.length),d.moveNodesTo(e,a.firstChild),a.previousSibling.appendChild(e),a=a.previousSibling,a.parentNode.removeChild(a.nextSibling);
return{offsetNode:b,offset:c}}catch(f){dalert(f)}}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(b,d,e){return b==a&&"q"==d&&e==c}}));return!0===c.q}catch(b){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(b){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+c++,b)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),d=new a([[b,2],[c,3]]);if(2!=d.get(b)||3!=d.get(c))return!1;d.delete(b);d.set(c,4);return!d.has(b)&&4==d.get(c)}catch(n){return!1}}function b(){}function d(a){if(!$jscomp.owns(a,f)){var d=new b;$jscomp.defineProperty(a,f,{value:d})}}function e(a){var c=Object[a];c&&(Object[a]=function(a){if(a instanceof b)return a;d(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0,h=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),e=c.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=c.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!c.next().done?!1:!0}catch(p){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var d=this.entries(),c;!(c=d.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,d){var c=d&&typeof d;"object"==
c||"function"==c?b.has(d)?c=b.get(d):(c=""+ ++h,b.set(d,c)):c="p_"+d;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var f=e[a];if(d!==d&&f.key!==f.key||d===f.key)return{id:c,list:e,index:a,entry:f}}return{id:c,list:e,index:-1,entry:void 0}},f=function(a,b){var d=a.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=a.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:b(d)};d=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=f.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();
this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objAdjustDoc=new function(){this.objAdjustWaitStatus=null;this.arrReservedClassName="dze_tb_layout dze_tb_layout_td dze_bookmark_flag dze_document_container dze_page_container dze_page_header_container dze_page_header dze_page_main dze_page_footer_container dze_page_footer dze_printpagebreak dze_page_margin_lt dze_page_margin_rt dze_page_margin_lb dze_page_margin_rb dze_page_margin_indicator_lt dze_page_margin_indicator_rt dze_page_margin_indicator_lb dze_page_margin_indicator_rb dze_caret_marker dze_caret_marker_start dze_caret_marker_end dze_init_cursor_flag dze_shape_anchor dze_shape_main dze_shape_text_span dze_shape_text_contents dze_video_iframe_container_span dze_play_button dze_video_iframe_container_div tabSpan dze_table dze_shape_container dze_shape_text_container paragraph sentence dze_shape dzeExtListStyleTriangle dzeExtListStyleTriangleLi dzeExtListStyleInnerCircle dzeExtListStyleInnerCircleLi dzeExtListStyleFillCircle dzeExtListStyleFillCircleLi dzeExtListStyleDiamond dzeExtListStyleDiamondLi dzeExtListStyleHypon dzeExtListStyleHyponLi dze_page_break_para dze_hide_para dze_external_data_area dze_oneffice_link_flag".split(" ");
this.objPasteCssStruct_WK=null;this.nPasteType_WK=-1;this.ID_PASTE_TYPE_EXCEL=0;this.ID_PASTE_TYPE_WORD=1;this.objAdjustTarget=this.strImgUrl=null;this.nEditNumber=0;this.setTarget=function(a,c){try{this.objAdjustTarget=a,"undefined"!=typeof c&&(this.nEditNumber=c)}catch(b){dalert(b)}};this.getTarget=function(a){try{return"undefined"==typeof a&&(a=this.nEditNumber),this.objAdjustTarget?this.objAdjustTarget:g_objEditorDocument[a].body}catch(c){dalert(c)}};this.initializeAdjustWaitStatus=function(){try{if(null==
this.objAdjustWaitStatus){var a="";a+='<table id="divAdjustWaitStatus" class="divAdjustWaitStatus" style="display:none;position:absolute;z-index:20014;border:0px;" cellSpacing="0" cellPadding="0">';a+='<tr valign="center">';a+='<td align="center" width="100%" height="100%" style="line-height:normal;border:0px;padding:0px;"><img src="'+dzeEnvConfig.strPath_Image+"/toolbar/"+g_strBrowserLanguage+'/view_adjust_status.gif" alt="status"></td>';g_objInsertUtil.insertLayerHTML(a+"</tr></table>",!1)&&(this.objAdjustWaitStatus=
document.getElementById("divAdjustWaitStatus"))}}catch(c){dalert(c)}};this.showAdjustWaitStatus=function(a,c){try{if(this.initializeAdjustWaitStatus(),a){var b=g_objPositionUtil.getElementPosition(g_objEditSetContainer[c],!1);this.objAdjustWaitStatus.style.left=b.left+"px";this.objAdjustWaitStatus.style.top=b.top+"px";this.objAdjustWaitStatus.style.width=b.right-b.left+"px";this.objAdjustWaitStatus.style.height=b.bottom-b.top+"px";this.objAdjustWaitStatus.className="adjustWaitStatus";this.objAdjustWaitStatus.style.display=
""}else this.objAdjustWaitStatus.style.display="none"}catch(d){dalert(d)}};this.adjustDocProcess=function(a){try{2!=g_nFormEditMode&&(this.remove_Br_Node_Inside_P_Node(a),this.showAdjustWaitStatus(!0,a),g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.doAdjustDocProcess(a)},100))}catch(c){dalert(c)}};this.deleteDuplicatedImage=function(a,c){try{if(!0!==fnObjectCheckNull(this.strImgUrl)&&0!==this.strImgUrl.length){var b=g_objEditorDocument[a].getSelection();if(!0!==fnObjectCheckNull(b)&&
0!==b.rangeCount){var d=b.getRangeAt(0).commonAncestorContainer.getElementsByTagName("img");if(!1===fnObjectCheckNull(d)&&0<d.length)for(a=null,b=0;b<d.length;b++)if(a=d[b].src,0<a.indexOf(c)){var e=d[b].previousElementSibling;if(!1===fnObjectCheckNull(e)&&e.src===this.strImgUrl){var f=g_objNodeUtil.getParentElement(d[b]);if(!1===fnObjectCheckNull(f)){f.removeChild(e);this.strImgUrl=null;break}}}}}}catch(g){dalert(g)}};this.checkFocusTxtNodeInLastCell=function(a,c){var b=!1,d=g_objEditWindow[a].getSelection().getRangeAt(0),
e=d.commonAncestorContainer;d.collapsed&&(d=[{check:DZE_HTMLOBJ_TD},{check:DZE_HTMLOBJ_TR},{check:DZE_HTMLOBJ_BODY}],e=g_objNodeUtil.getParentElementForTargetTags(e,d,d.length),getObjNodeType(e,a)==DZE_TAG_TD&&(e=e.offsetParent)&&!e.nextElementSibling&&(b=!0,e=e.nextElementSibling,d=document.createElement("p"),d.setAttribute("id",c),d.innerHTML="<br />",e?this.getTarget(a).insertBefore(d,e):this.getTarget(a).appendChild(d)));return b};this.doAdjustDocProcess=function(a){try{dzeUiConfig.bUsePasteCapture||
g_objCaretUtil.saveCaret();g_objTableFlag.ResetTableInfo(!1);updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a);var c=this.adjustGarbageAttribute(a);this.updateHTMLCode(c,a);this.adjustRemoveGarbageText(a);this.adjustGarbageEmptyTag(a,!0);if(g_bBrowserType_IE){this.adjustDuplicateGarbage_P_Node(a);var b=this.getTarget(a).innerHTML;this.getTarget(a).innerHTML=b}this.setOperation_EnterCode_Br_Node_P_Node(a);this.replaceDeprecatedTag(a);this.setFixedTable(this.getTarget(a));this.addParaToCell(this.getTarget(a));
this.setParaInlineStyle(a,this.getTarget(a),!0);this.adjustStyleUnit(a);this.showAdjustWaitStatus(!1,a);dzeUiConfig.bUsePasteCapture||(g_objCaretUtil.restoreCaret(a),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){this.showAdjustWaitStatus(!1,a),dalert(d)}};this.isExistRemoveGarbageCommentText=function(a){try{if(-1!=this.getTarget(a).innerHTML.toLowerCase().indexOf("\x3c!--[if"))return!0}catch(c){dalert(c)}return!1};this.isExistRemoveGarbageText=function(a){try{var c=this.getTarget(a).innerHTML.toLowerCase();
if(null!=g_arrRemoveGarbageText)for(a=0;a<g_arrRemoveGarbageText.length;a++)if(-1!=c.indexOf(g_arrRemoveGarbageText[a]))return!0}catch(b){dalert(b)}return!1};this.isExistGarbageStyleAttribute=function(a){try{var c=this.getParserStruct(a);return c?this.checkTree(c.stDocRoot):!1}catch(b){dalert(b)}return!1};this.getParserStruct=function(a){try{var c=this.getTarget(a).innerHTML,b=g_objCodeParser.initParserStruct(c);if(!b)return null;g_objCodeParser.parseBody(b.stDocRoot,b);return b}catch(d){dalert(d)}return null};
this.checkTree=function(a){try{for(var c=a.content;null!=c;c=c.next)if(this.checkTree(c)||"font"==c.tagName||this.checkTreeAttribute(c))return!0}catch(b){dalert(b)}return!1};this.checkTreeAttribute=function(a){try{if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++){var b=a.arrAttribute[c];if(g_objCodeDefine.ID_ATTR_STYLE==b.attributeID&&this.checkTreeAttributeStyle(b))return!0}}catch(d){dalert(d)}return!1};this.checkTreeAttributeStyle=function(a){try{var c=a.arrStyleAttribute;if(null==
c)return!1;for(a=0;a<c.length;a++)if(/mso-/gi.test(c[a].styleName))return!0}catch(b){dalert(b)}return!1};this.adjustRemoveGarbageText=function(a){try{null!=g_arrRemoveGarbageText&&this.processRemoveGarbageText(this.getTarget(a))}catch(c){dalert(c)}};this.processRemoveGarbageText=function(a){try{for(var c=a.innerHTML,b=!1,d=0;d<g_arrRemoveGarbageText.length;d++)null!=g_arrRemoveGarbageText[d]&&""!=g_arrRemoveGarbageText[d]&&-1!=c.indexOf(g_arrRemoveGarbageText[d])&&(c=c.replace(g_arrRemoveGarbageText[d],
""),b=!0,d--);b&&(a.innerHTML=c)}catch(e){dalert(e)}};this.adjustGarbageEmptyTag=function(a,c){try{this.processGarbageEmptyTag(this.getTarget(a),c,a)}catch(b){dalert(b)}};this.processGarbageEmptyTag=function(a,c,b){try{var d=g_objLetterFn;if(d){for(var e=0,f=0;f<a.childNodes.length;f++){var g=a.childNodes[f];ID_SELECTION_ELEMENT_NODE==g.nodeType?this.processGarbageEmptyTag(g,c,b):ID_SELECTION_TEXT_NODE==g.nodeType&&e++}var h=g_objNodeUtil.getElementTagName(a).toLowerCase();if(("font"==h||"span"==
h)&&e==a.childNodes.length&&d.isEmptySpan(a)&&(d=!0,"span"==h&&(""!=a.className?d=!1:""!=a.style.whiteSpace?d=!1:""!==a.style.cssText?d=!1:c&&""!=a.id&&(d=!1)),d)){var k=a.innerHTML;if(0<k.length){var l=g_objEditorDocument[b].createTextNode(k),m=g_objNodeUtil.getParentElement(a);m.replaceChild(l,a)}else if(m=g_objNodeUtil.getParentElement(a),m.removeChild(a),"p"===m.nodeName.toLowerCase()&&0===m.childNodes.length){var n=g_objNodeUtil.getParentElement(m);!1===fnObjectCheckNull(n)&&n.removeChild(m)}}}}catch(p){dalert(p)}};
this.adjustDuplicateGarbage_P_Node=function(a){try{if(!g_bBrowserType_IE)return!1;this.processDuplicateGarbage_P_Node(this.getTarget(a))}catch(c){dalert(c)}};this.processDuplicateGarbage_P_Node=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){for(var c=0;c<a.childNodes.length;c++){var b=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==b.nodeType&&this.processDuplicateGarbage_P_Node(b)}if("p"==g_objNodeUtil.getElementTagName(a).toLowerCase()){var d=a.outerHTML,e=d.length;if(4<=e){var f=d.substring(e-
4);f=f.toLowerCase();"</p>"!=f&&(a.outerHTML=d+"</p>")}else 3==e&&"<p>"==d.toLowerCase()&&(a.outerHTML=window.attachEvent?d+"</p>":d+"<br></p>")}}}catch(g){dalert(g)}};this.setOperation_EnterCode_Br_Node_P_Node=function(a){try{if(window.attachEvent)for(var c=this.getTarget(a).getElementsByTagName("p"),b=0;b<c.length;b++){var d=c[b],e=d.childNodes.length;if(1==e){var f=d.childNodes[0];ID_SELECTION_ELEMENT_NODE==f.nodeType&&"br"==g_objNodeUtil.getElementTagName(f).toLowerCase()&&d.removeChild(f)}}else if(window.addEventListener)for(c=
this.getTarget(a).getElementsByTagName("p"),b=0;b<c.length;b++)if(d=c[b],e=d.childNodes.length,0==e){var g=g_objEditorDocument[a].createElement("br");d.appendChild(g)}}catch(h){dalert(h)}};this.removeParaWithoutChild=function(a){try{for(var c=function(a){try{if(!a||1!=a.nodeType)return!1;for(var b=["height","paddingTop","paddingBottom","marginTop","marginBottom"],c=0,d=b.length;c<d;c++){var e=a.style[b[c]];if(e&&parseFloat(e))return!0}return!1}catch(p){dalert(p)}},b=function(a){try{if(!a||1!==a.nodeType)return!1;
var b=a.childNodes;a=null;for(var c=0,d=b.length;c<d;c++)if(a=b[c],3!==a.nodeType||!g_objNodeUtil.isAllWhiteSpace(a))return!1;return!0}catch(n){dalert(n)}},d=this.getTarget(a),e=d?d.querySelectorAll("p, h1, h2, h3, h4, h5, h6, ol, ul"):[],f=e.length-1;0<=f;f--){var g=e[f];g.firstChild&&(!b(g)||""!==g.style.whiteSpace)||c(g)||g.parentNode.removeChild(g)}}catch(h){dalert(h)}};this.adjustGarbageAttribute=function(a){try{var c=this.getParserStruct(a);if(!c)return!1;this.adjustTree(c.stDocRoot,c);return c}catch(b){dalert(b)}};
this.adjustTree=function(a,c){try{for(var b=a.content;null!=b;b=b.next)this.adjustTree(b,c),g_objCodeLexer.NODE_TYPE_COMMENT==b.type?0==c.stDocStreamIn.htmlCode.substring(b.textStartPos,b.textEndPos+1).indexOf("[if")&&(b.type=g_objCodeLexer.NODE_TYPE_TEXT,b.textEndPos=b.textStartPos-1):(-1!=b.tagName.indexOf(":")&&(b.print=!1,b.arrAttribute=null),this.adjustTreeAttribute(b,c))}catch(d){dalert(d)}};this.adjustTreeAttribute=function(a,c){try{if(null!=a.arrAttribute)for(var b=0;b<a.arrAttribute.length;b++){var d=
a.arrAttribute[b];if(g_objCodeDefine.ID_ATTR_STYLE==d.attributeID)this.adjustTreeAttributeStyle(d);else{var e=d.attributeName.toLowerCase(),f=this.adjustTreeAttributeValue(a,d,c);this.adjustRemoveAttributeName(e,f)&&(a.arrAttribute[b]=null)}}}catch(g){dalert(g)}};this.adjustTreeAttributeValue=function(a,c,b){try{return b.stDocStreamIn.htmlCode.substring(c.attributeStartPos,c.attributeEndPos+1)}catch(d){dalert(d)}};this.adjustTreeAttributeStyle=function(a){try{var c=a.arrStyleAttribute;if(null!=c)for(a=
0;a<c.length;a++){var b=c[a].styleName.trim(),d=c[a].styleValue.trim();/mso-/gi.test(b)?c[a]=null:"background-color"==b?"transparent"==d&&(c[a]=null):(b=b.toLowerCase(),this.adjustRemoveAttributeStyleName(b)&&(c[a]=null))}}catch(e){dalert(e)}};this.adjustRemoveAttributeName=function(a,c){try{if(null==g_arrAdjustRemoveAttributeName)return!1;for(var b=0;b<g_arrAdjustRemoveAttributeName.length;b++){var d=g_arrAdjustRemoveAttributeName[b].toLowerCase();if(a==d){if("class"==d||"classname"==d){if(startsWith(c,
"dze"))break;var e=c.split(" ");b=0;for(var f=e.length;b<f;b++){a=0;for(var g=this.arrReservedClassName.length;a<g;a++)if(this.arrReservedClassName[a]&&this.arrReservedClassName[a]===e[b])return!1}}return!0}}}catch(h){dalert(h)}return!1};this.adjustRemoveAttributeStyleName=function(a){try{if(null==g_arrAdjustRemoveStyleName)return!1;for(var c=0;c<g_arrAdjustRemoveStyleName.length;c++){var b=g_arrAdjustRemoveStyleName[c].toLowerCase();if(a==b)return!0}}catch(d){dalert(d)}return!1};this.updateHTMLCode=
function(a,c){try{g_objCodePrint.printTree(a.stDocRoot,0,a);0<a.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,a);for(var b="",d=0;d<a.stDocStreamOut.lineString.length;d++)checkTextNodeAllWhiteCode_Plus_Space(a.stDocStreamOut.lineString[d])||(b+=a.stDocStreamOut.lineString[d]+"\r\n");this.getTarget(c).innerHTML=b}catch(e){dalert(e)}};this.replaceDeprecatedTag=function(a){try{for(;;){var c=this.getTarget(a).getElementsByTagName("font"),b=c.length;if(0==b)break;var d=c[b-1],e=g_objNodeUtil.getParentElement(d),
f=g_objEditorDocument[a].createElement("span");null!=d.face&&""!=d.face&&(f.style.fontFamily=d.face);null!=d.color&&""!=d.color&&(f.style.color=d.color);if(null!=d.size&&""!=d.size){var g="10px";switch(d.size){case "1":g="10px";break;case "2":g="13px";break;case "3":g="16px";break;case "4":g="18px";break;case "5":g="24px";break;case "6":g="32px";break;case "7":g="48px"}f.style.fontSize=g}for(;0<d.childNodes.length;)f.appendChild(d.childNodes[0]);e.replaceChild(f,d);var h=g_objEditorDocument[a].createElement("div");
h.appendChild(d);var k=g_objCodeParser.initParserStruct(h.innerHTML);if(!k)break;g_objCodeParser.parseBody(k.stDocRoot,k);var l=k.stDocRoot.content;if(null!=l&&"font"==l.tagName&&null!=l.arrAttribute)for(g=0;g<l.arrAttribute.length;g++){var m=l.arrAttribute[g];if(g_objCodeDefine.ID_ATTR_STYLE==m.attributeID)for(var n=0;n<m.arrStyleAttribute.length;n++){var p=m.arrStyleAttribute[n].styleName,q=m.arrStyleAttribute[n].styleValue.trim();g_objPropertyUtil.setElementStyleAttributeValue(f,p,q)}}}}catch(r){dalert(r)}};
this.adjustStyleUnit=function(a){try{this.processStyleUnit(this.getTarget(a))}catch(c){dalert(c)}};this.processStyleUnit=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){for(var c=0;c<a.childNodes.length;c++){var b=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==b.nodeType&&this.processStyleUnit(b)}this.doProcessStyleUnit(a)}}catch(d){dalert(d)}};this.doProcessStyleUnit=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var c=g_objNodeUtil.getElementTagName(a).toLowerCase();if("table"==
c||"col"==c||"tr"==c||"td"==c||"th"==c||"div"==c||"p"==c||"h1"==c||"h2"==c||"h3"==c||"h4"==c||"h5"==c||"h6"==c){var b=g_objCommonUtil.extractNumberValueUnit(a.width),d=g_objCommonUtil.extractNumberValueUnit(a.style.width);this.doProcessStyleUnit_Common(a,c,0,b,d);var e=g_objCommonUtil.extractNumberValueUnit(a.height),f=g_objCommonUtil.extractNumberValueUnit(a.style.height);this.doProcessStyleUnit_Common(a,c,1,e,f);var g=g_objCommonUtil.extractNumberValueUnit(a.style.marginLeft);this.doProcessStyleUnit_Common(a,
c,2,null,g);var h=g_objCommonUtil.extractNumberValueUnit(a.style.marginTop);this.doProcessStyleUnit_Common(a,c,3,null,h);var k=g_objCommonUtil.extractNumberValueUnit(a.style.marginRight);this.doProcessStyleUnit_Common(a,c,4,null,k);var l=g_objCommonUtil.extractNumberValueUnit(a.style.marginBottom);this.doProcessStyleUnit_Common(a,c,5,null,l);var m=g_objCommonUtil.extractNumberValueUnit(a.style.paddingLeft);this.doProcessStyleUnit_Common(a,c,6,null,m);var n=g_objCommonUtil.extractNumberValueUnit(a.style.paddingTop);
this.doProcessStyleUnit_Common(a,c,7,null,n);var p=g_objCommonUtil.extractNumberValueUnit(a.style.paddingRight);this.doProcessStyleUnit_Common(a,c,8,null,p);var q=g_objCommonUtil.extractNumberValueUnit(a.style.paddingBottom);this.doProcessStyleUnit_Common(a,c,9,null,q);if("table"==c||"td"==c||"th"==c||"div"==c){var r=g_objCommonUtil.extractNumberValueUnit(a.style.borderLeftWidth);this.doProcessStyleUnit_Common(a,c,10,null,r);var t=g_objCommonUtil.extractNumberValueUnit(a.style.borderTopWidth);this.doProcessStyleUnit_Common(a,
c,11,null,t);var u=g_objCommonUtil.extractNumberValueUnit(a.style.borderRightWidth);this.doProcessStyleUnit_Common(a,c,12,null,u);var v=g_objCommonUtil.extractNumberValueUnit(a.style.borderBottomWidth);this.doProcessStyleUnit_Common(a,c,13,null,v);this.doProcessStyleUnit_Color(a,0,a.style.borderLeftColor);this.doProcessStyleUnit_Color(a,1,a.style.borderTopColor);this.doProcessStyleUnit_Color(a,2,a.style.borderRightColor);this.doProcessStyleUnit_Color(a,3,a.style.borderBottomColor)}}}}catch(w){dalert(w)}};
this.doProcessStyleUnit_Common=function(a,c,b,d,e){try{if(null!=d||null!=e)if(null==d&&null!=e)if("pt"==e.strUnit)if(0==b)a.style.width=a.offsetWidth;else if(1==b)a.style.height=a.offsetHeight;else if(2==b||3==b||4==b||5==b){var f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue);null!=f&&(2==b?a.style.marginLeft=f+"px":3==b?a.style.marginTop=f+"px":4==b?a.style.marginRight=f+"px":5==b&&(a.style.marginBottom=f+"px"))}else if(6==b||7==b||8==b||9==b)f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue),null!=
f&&(6==b?a.style.paddingLeft=f+"px":7==b?a.style.paddingTop=f+"px":8==b?a.style.paddingRight=f+"px":9==b&&(a.style.paddingBottom=f+"px"));else{if(10==b||11==b||12==b||13==b)f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue),null!=f&&(10==b?a.style.borderLeftWidth=f+"px":11==b?a.style.borderTopWidth=f+"px":12==b?a.style.borderRightWidth=f+"px":13==b&&(a.style.borderBottomWidth=f+"px"))}else 2==b||3==b||4==b||5==b?0==e.nValue&&(2==b?a.style.marginLeft=0:3==b?a.style.marginTop=0:4==b?a.style.marginRight=
0:5==b&&(a.style.marginBottom=0)):6!=b&&7!=b&&8!=b&&9!=b||0!=e.nValue||(6==b?a.style.paddingLeft=0:7==b?a.style.paddingTop=0:8==b?a.style.paddingRight=0:9==b&&(a.style.paddingBottom=0));else null!=d&&null==e||null==d||null==e||""!=d.strUnit||"pt"!=e.strUnit||(0==b?a.style.width="":1==b&&"tr"!=c&&(a.style.height=a.offsetHeight))}catch(g){dalert(g)}};this.doProcessStyleUnit_Color=function(a,c,b){try{if(null!=b&&""!=b){var d=g_objCommonUtil.getHexColorCodeByNickName(b);d!=b&&(0==c?a.style.borderLeftColor=
d:1==c?a.style.borderTopColor=d:2==c?a.style.borderRightColor=d:3==c&&(a.style.borderBottomColor=d))}}catch(e){dalert(e)}};this.checkPasteCode_Excel_WK=function(a){try{var c=a.clipboardData.getData("text/html"),b=g_objCodeParser.initParserStruct(c);if(!b)return!1;g_objCodeParser.parseBody(b.stDocRoot,b);var d=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_HTML);if(null==d)return!1;this.nPasteType_WK=-1;var e=this.findNodeAttributeValue(b,d,"xmlns:x");null!=e&&"urn:schemas-microsoft-com:office:excel"==
e&&(this.nPasteType_WK=this.ID_PASTE_TYPE_EXCEL);-1==this.nPasteType_WK&&(e=this.findNodeAttributeValue(b,d,"xmlns:w"),null!=e&&"urn:schemas-microsoft-com:office:word"==e&&(this.nPasteType_WK=this.ID_PASTE_TYPE_WORD));if(-1==this.nPasteType_WK){var f=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_HEAD);if(null!=f){var g=this.findTagNodeAttr(b,f,g_objCodeDefine.ID_TAG_META,"name","generator");if(null!=g){var h=g.arrAttribute;a=0;for(var k=h.length;a<k;a++)if("content"===h[a].attributeName){var l=
b.stDocStreamIn.htmlCode.substring(h[a].attributeStartPos,h[a].attributeEndPos+1).toLowerCase();if(startsWith(l,"microsoft powerpoint")){this.nPasteType_WK=this.ID_PASTE_TYPE_SLIDE;break}}}}}if(-1==this.nPasteType_WK)return!1;var m=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_STYLE);if(null==m)return!1;var n=this.getNodeContent(b,m);if(null==n||""==n)return!1;this.objPasteCssStruct_WK=null;this.objPasteCssStruct_WK=g_objCssParser.initCssParserStruct(n);if(!this.objPasteCssStruct_WK)return!1;
g_objCssParser.parseCss(this.objPasteCssStruct_WK.stDocRoot,this.objPasteCssStruct_WK);return!0}catch(p){dalert(p)}this.objPasteCssStruct_WK=null;return!1};this.findTagNode=function(a,c){try{if(null==a)return null;for(var b=a.content;null!=b;b=b.next)if(g_objCodeDefine.ID_TAG_UNKNOWN!=b.tagID){if(c==b.tagID)return b;var d=this.findTagNode(b,c);if(null!=d)return d}}catch(e){dalert(e)}return null};this.findTagNodeAttr=function(a,c,b,d,e){try{if(null==c)return null;for(var f=c.content;null!=f;f=f.next)if(g_objCodeDefine.ID_TAG_UNKNOWN!==
f.tagID){if(b===f.tagID){var g=f.arrAttribute;c=0;for(var h=g.length;c<h;c++)if(d===g[c].attributeName&&a.stDocStreamIn.htmlCode.substring(g[c].attributeStartPos,g[c].attributeEndPos+1).toLowerCase()===e)return f}var k=this.findTagNodeAttr(a,f,b,d,e);if(null!=k)return k}}catch(l){dalert(l)}return null};this.findNodeAttributeValue=function(a,c,b){try{if(g_objCodeDefine.ID_TAG_UNKNOWN==c.tagID)return null;if(null!=c.arrAttribute)for(var d=0;d<c.arrAttribute.length;d++){var e=c.arrAttribute[d];if(b==
e.attributeName)return a.stDocStreamIn.htmlCode.substring(e.attributeStartPos,e.attributeEndPos+1).toLowerCase()}}catch(f){dalert(f)}return null};this.getNodeContent=function(a,c){try{if(null==c)return null;for(var b="",d=c.content;null!=d;d=d.next)b+=a.stDocStreamIn.htmlCode.substring(d.textStartPos,d.textEndPos+1);return b}catch(e){dalert(e)}return null};this.adjustPasteCode_WK=function(a){try{if(g_bBrowserType_WK&&-1!=this.nPasteType_WK){for(var c=new Set,b=this.objPasteCssStruct_WK.stDocRoot.content;null!=
b;b=b.next)if(null!=b.arrCssClassName)for(var d=0;d<b.arrCssClassName.length;d++){var e=b.arrCssClassName[d];if(null!=e&&""!=e)if(-1!=e.indexOf(".")){var f=e.split(".");if(2==f.length){e=f[1];var g=this.getTarget(a).getElementsByClassName(e);if(null!=g&&0!=g.length){var h=this.makeStyleString_WK(b);if(null!=h&&""!=h){for(var k=0;k<g.length;k++){var l=g[k];"undefined"==typeof l.paste_style&&(l.paste_style="");l.paste_style+=h;c.add(l)}for(;;)if(g=this.getTarget(a).getElementsByClassName(e),0<g.length)g[0].removeAttribute("class");
else break}}}}else{var m=g_objCodeLexer.findTagDefineID(e);if(g_objCodeDefine.ID_TAG_UNKNOWN!=m&&g_objCodeDefine.ID_TAG_TD==m&&(g=this.getTarget(a).getElementsByTagName(e),null!=g&&0!=g.length)){var n=this.makeStyleString_WK_Filter(b);if(null!=n&&""!=n)for(k=0;k<g.length;k++)l=g[k],"undefined"==typeof l.paste_style&&(l.paste_style=""),l.paste_style+=n,c.add(l)}}}c.forEach(function(a){var b=a.getAttribute("style")||"";a.setAttribute("style",a.paste_style+b);a.paste_style=null;a.removeAttribute("paste_style")})}}catch(p){dalert(p)}};
this.makeStyleString_WK=function(a){try{if(null==a)return null;for(var c="",b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b];if(!/mso-/gi.test(d.styleName)){var e=d.styleValue;-1!=d.styleName.indexOf("border")&&(e=e.replace(/dot-dot-dash/gi,"dotted"),e=e.replace(/dot-dash-slanted/gi,"dotted"),e=e.replace(/dot-dash/gi,"dotted"),e=e.replace(/hairline/gi,"dotted"));c+=d.styleName+":"+e+";"}}return c}catch(f){dalert(f)}return null};this.makeStyleString_WK_Filter=function(a){try{if(null==
a)return null;for(var c="",b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b],e=!1;switch(d.styleName){case "font-family":case "white-space":e=!1;break;default:e=!0}e||(c+=d.styleName+":"+d.styleValue+";")}return c}catch(f){dalert(f)}return null};this.setStyleString_With_Compare_WK=function(a,c){try{if(null!=a)for(var b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b];"font-family"==d.styleName?this.setStyleString_With_Compare_Process_WK("font-family",d.styleValue,
c):"white-space"==d.styleName&&this.setStyleString_With_Compare_Process_WK("white-space",d.styleValue,c)}}catch(e){dalert(e)}};this.setStyleString_With_Compare_Process_WK=function(a,c,b){try{for(var d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("style");null==f&&(f="");for(var g=!1,h=f.split(";"),k=0;k<h.length;k++)-1!=h[k].trim().indexOf(a)&&(g=!0);g||e.setAttribute("style",f+";"+a+":"+c+";")}}catch(l){dalert(l)}};this.addParaToCell=function(a){try{if(!a||!dzeUiConfig.bUsePasteCapture)return!1;
var c=a.ownerDocument,b=c.defaultView;if(!c||!b)return!1;var d=g_objNodeUtil,e=null,f=[camelCase("font-family"),camelCase("font-size"),camelCase("color"),camelCase("text-align")],g=[null,g_objPropertyUtil.checkStyleFontSize,null,null],h=a.querySelectorAll("td, th");forEach(h,function(a,h){if(d.hasAllTextInlineChild(h)){a=c.createElement("p");e=null;for(var k=0;k<f.length;k++){var n=f[k];var p=n;var l=h.style[p];p=l?l:(p=(e=e||b.getComputedStyle(h,null))?e[p]:null)?p:null;p&&(g[k]&&(p=g[k](p)),p&&
(a.style[n]=p))}h.firstChild?d.moveNodesTo(a,h.firstChild):a.appendChild(c.createElement("BR"));h.appendChild(a)}},this)}catch(k){dalert(k)}};this.setParaInlineStyle=function(a,c,b){try{if(!c||!dzeUiConfig.bUsePasteCapture)return!1;var d=g_objEditorDocument[a],e=g_objEditWindow[a];if(!d||!e)return!1;var f=[camelCase("font-family"),camelCase("font-size"),isDarkReaderActive(d)?"":camelCase("color"),camelCase("margin-top"),camelCase("margin-bottom")],g=[null,g_objPropertyUtil.checkStyleFontSize,null,
null,null];g_bContentPTagStyleApply&&g_strBodyLineHeight&&(f.push("lineHeight"),g.push(null));var h=c.getElementsByTagName("p");h=[].slice.call(h);if(b){var k=c.getElementsByTagName("li");h=h.concat([].slice.call(k))}h.forEach(function(a){for(var b=null,c=0,d=f.length;c<d;c++){var h=f[c];if(h){var k=a.style[h];k||("lineHeight"===h?k=g_strBodyLineHeight:(b=b||e.getComputedStyle(a,null),k=b[h]),k&&(g[c]&&(k=g[c](k)),k&&(a.style[h]=k)))}}});var l=[].slice.call(c.getElementsByTagName("ol")),m=[].slice.call(c.getElementsByTagName("ul"));
l.concat(m).forEach(function(a){var b=null;""===a.style.marginTop&&(b=b||e.getComputedStyle(a,null),a.style.marginTop=b.marginTop);""===a.style.marginBottom&&(b=b||e.getComputedStyle(a,null),a.style.marginBottom=b.marginBottom);""===a.style.paddingLeft&&(b=b||e.getComputedStyle(a,null),a.style.paddingLeft=b.paddingLeft)});return!0}catch(n){dalert(n)}};this.adjustTable=function(a){try{if(!a)return!1;var c=a.querySelectorAll("table[height], table[style*='height:'], table[style*='min-height:'], table[style*='max-height:']");
g_objTableUtil.removeHeightAttr(c);c=a.querySelectorAll("td[style*='white-space:'], th[style*='white-space:'], td *[style*='white-space:'], th *[style*='white-space:']");forEach(c,function(a,b){a=b.style.whiteSpace.toLowerCase();if("nowrap"===a||"pre"===a)b.style.whiteSpace=""});c=a.querySelectorAll("td[style*='display:'], th[style*='display:']");forEach(c,function(a,b){"none"===b.style.display.toLowerCase()&&(b.style.display="")});c=a.querySelectorAll("table");a=null;for(var b=0,d=c.length;b<d;b++)a=
new TableMatrix(c[b]),a.removeBlankCol(),a.removeBlankRow(),a.removeZeroWidthCol(),a.removeZeroHeightRow();return!0}catch(e){dalert(e)}};this.setFixedTable=function(a){try{if(!a)return!1;var c=g_objTableUtil,b=a.querySelectorAll("table:not(.dze_table)");b=Array.prototype.slice.call(b);b.forEach(function(a){c.setDzeTable(a)});return!0}catch(d){dalert(d)}};this.remove_Br_Node_Inside_P_Node=function(a){try{if(g_bBrowserType_IE){var c=this.getTarget(a).getElementsByTagName("p");for(a=0;a<c.length;a++){var b=
c[a],d=b.childNodes.length;if(!(1>=d)){var e=b.childNodes[d-1];"br"==e.nodeName.toLowerCase()&&this.isAllTextNodeExceptLastOne(b)&&b.removeChild(e)}}}}catch(f){dalert(f)}};this.isAllTextNodeExceptLastOne=function(a){try{for(var c=0;c<a.childNodes.length-1;c++)if(ID_SELECTION_ELEMENT_NODE==a.childNodes[c].nodeType)return!1;return!0}catch(b){dalert(b)}return!1};this.changeTableAlignToMarginStyle=function(a){try{if(g_bBrowserType_IE){var c=this.getTarget(a).getElementsByTagName("table");for(a=0;a<c.length;a++){var b=
c[a],d=b.getAttribute("align");""!=d&&null!=d&&(d=d.toLowerCase(),"left"==d?(b.removeAttribute("align"),b.style.marginLeft="0px",b.style.marginRight="auto"):"right"==d&&(b.removeAttribute("align"),b.style.marginLeft="auto",b.style.marginRight="0px"))}}}catch(e){dalert(e)}};this.addClassForAnchor=function(a){try{if(!0!==fnObjectCheckNull(a)){var c=a.querySelectorAll("p, li, h1, h2, h3, h4, h5, h6");for(a=0;a<c.length;a++){var b=c[a];0<b.querySelectorAll("span.dze_shape_main").length&&(b.style.position=
"",g_objPropertyUtil.addClass(b,"dze_shape_anchor"))}}}catch(d){dalert(d)}};this.changeTextFormat=function(a){try{for(var c=a.nodeName,b=a.ownerDocument.createElement("span"),d=a.getAttribute("style");!0===a.hasChildNodes();)b.appendChild(a.firstChild);!1===fnObjectCheckNull(d)&&0<d.length&&b.setAttribute("style",b.getAttribute("style")+d);switch(c){case "FONT":if(void 0!==a.size&&""!==a.size){var e=a.size;if(e){c=10;switch(e){case "1":c=10;break;case "2":c=13;break;case "3":c=16;break;case "4":c=
18;break;case "5":c=24;break;case "6":c=32;break;case "7":c=48}e=parseFloat(.75*c)+"pt";b.style.fontSize=e}}void 0!==a.face&&""!==a.face&&(b.style.fontFamily=a.face);void 0!==a.color&&""!==a.color&&(b.style.color=a.color)}a.parentNode.insertBefore(b,a);a.parentNode.removeChild(a);return b}catch(f){dalert()}};this.addStyleForAnchor=function(a){try{if(!0!==fnObjectCheckNull(a)){var c=a.querySelectorAll("p, li, h1, h2, h3, h4, h5, h6");for(a=0;a<c.length;a++){var b=c[a];0<b.querySelectorAll("span.dze_shape_main").length&&
(b.style.position="relative");g_objPropertyUtil.removeClass(b,"dze_shape_anchor")}}}catch(d){dalert(d)}};this.arrangeSpan=function(a){try{if(a){var c=function(a){return!a||!a.parentNode||a.id||a.className?!0:!1},b=a.querySelectorAll("span");forEach(b,function(a,b){!1===c(b)&&this.arrangeStyleSpan(b)},this);b=a.querySelectorAll("span");forEach(b,function(a,b){!1===c(b)&&this.mergeSpan(b)},this);b=a.querySelectorAll("span");forEach(b,function(a,b){if(!1===c(b))if(b.parentNode&&!b.firstChild)b.parentNode.removeChild(b);
else{if(a=b.parentNode&&b.firstChild===b.lastChild)a=(a=b.firstChild)?8===a.nodeType||3===a.nodeType&&""===a.nodeValue:!1;a&&b.parentNode.removeChild(b)}},this)}}catch(d){dalert(d)}};this.arrangeStyleSpan=function(a){try{var c=function(a,b){try{if(a&&b){var c=parseStyle(b.getAttribute("style"));if(c){var d=a.style;Object.keys(c).forEach(function(a){var b=d[a];b&&""!==b||(d[a]=c[a])})}}}catch(m){dalert(m)}};if(a&&a.parentNode&&"SPAN"===a.nodeName&&!a.style.border&&a.ownerDocument)for(var b=g_objNodeUtil,
d=a.firstChild,e=a=null,f=null;d;)a=d.nextSibling,e=d.parentNode,1===d.nodeType&&"SPAN"===d.nodeName&&(c(d,e),insertAfter(e,d),a&&(f=e.cloneNode(),b.moveNodesTo(f,a),insertAfter(d,f)),this.removeSpan(e)),d=a}catch(g){dalert(g)}};this.removeSpan=function(a){try{if(a&&!a.id&&!a.className&&!g_objNodeUtil.getClosestAmaranthLink(a)){var c=a.parentNode;if(c){var b=a.ownerDocument;if(b){var d=g_objNodeUtil;if(a.firstChild){if(""===d.getAttribute(a,"style")&&d.removeAttribute(a,"style"),0===a.attributes.length){var e=
b.createDocumentFragment();d.moveNodesTo(e,a.firstChild);c.replaceChild(e,a);d.normalize(c)}}else c.removeChild(a),d.normalize(c)}}}}catch(f){dalert(f)}};this.mergeSpan=function(a){try{if(a&&a.parentNode&&"SPAN"===a.nodeName){var c=a.ownerDocument;if(c){for(var b=g_objNodeUtil,d=null,e=null;a;){e=a.nextSibling;if(!e)break;if(1!==e.nodeType||"SPAN"!==e.nodeName)break;var f=e,g=a.cloneNode(!1),h=f.cloneNode(!1),k=parseStyle(g.getAttribute("style")),l=parseStyle(h.getAttribute("style"));g.removeAttribute("style");
h.removeAttribute("style");if(!g.isEqualNode(h)||(k||l)&&(!k&&l||k&&!l||!equalStyle(k,l)))break;d||(d=c.createDocumentFragment());b.moveNodesTo(d,e.firstChild);a.appendChild(d);b.normalize(a);e.parentNode.removeChild(e)}this.removeSpan(a)}}}catch(m){dalert(m)}};this.removeEqualDuplicatedDiv=function(a){try{if(!a)return!1;var c=a.ownerDocument;if(!c)return!1;var b=c.createDocumentFragment(),d=g_objNodeUtil,e=a.querySelectorAll("div");e=[].slice.call(e);e.forEach(function(a){if(a){var c=a.parentNode;
if(c&&1===c.nodeType&&"DIV"===c.nodeName){var e=a.cloneNode(!1);c=c.cloneNode(!1);e.isEqualNode(c)&&(d.moveNodesTo(b,a.firstChild),a.parentNode.replaceChild(b,a))}}});return!0}catch(f){dalert(f)}}};

function setInitEnterCode(a,d){try{g_bAutoBrConvertPTag&&(setInitEnterCode_Loop(a,d),window.addEventListener&&g_objEditWindow[d].getSelection().removeAllRanges())}catch(e){}}
function setInitEnterCode_Loop(a,d){try{for(var e=0;e<a.childNodes.length;e++){var b=a.childNodes[e];if(ID_SELECTION_ELEMENT_NODE==b.nodeType){setInitEnterCode_Loop(b,d);var g=b.nodeName.toLowerCase();"p"!=g&&isAvailableTarget_EnterCode_Convert(g)&&setInitEnterCode_Logic(b,d)}}var c=a.nodeName.toLowerCase();isAvailableTarget_EnterCode_Convert(c)&&setInitEnterCode_Logic(a,d)}catch(f){}}
function isAvailableTarget_EnterCode_Convert(a){return"body"==a||"td"==a||"th"==a||"div"==a||"article"==a||"section"==a?!0:!1}
function setInitEnterCode_Logic(a,d){try{var e=!1;if(0<a.childNodes.length){if(1==a.childNodes.length){var b=a.childNodes[0];if(ID_SELECTION_TEXT_NODE==b.nodeType){var g=b.nodeValue;checkTextNodeAllWhiteCode_Plus_Space(g)&&(e=!0)}}if(!e){for(var c=g_objEditorDocument[d].createElement("p"),f=!1,h=0;h<a.childNodes.length;h++)if(b=a.childNodes[h],ID_SELECTION_ELEMENT_NODE==b.nodeType){var l=b.nodeName.toLowerCase();"br"==l?(f?(f=!1,a.insertBefore(c,b),a.removeChild(b)):(a.insertBefore(c,b),c.appendChild(b)),
c=null,c=g_objEditorDocument[d].createElement("p")):checkIsInLineNode(l)?(f=!0,c.appendChild(b),h--):f&&(f=!1,a.insertBefore(c,b),h++,c=null,c=g_objEditorDocument[d].createElement("p"))}else if(ID_SELECTION_TEXT_NODE==b.nodeType){g=b.nodeValue;var k=checkTextNodeValue(g);k&&k.bEveryWhiteSpace&&!k.bSomeZeroWidthSpace||(k&&k.bEveryWhiteSpace&&k.bSomeZeroWidthSpace&&g_objNodeUtil.checkTagName(b.parentNode,"body")?b.nodeValue=removeZeroWidthSpaceFromString(g):(f=!0,c.appendChild(b),h--))}f&&a.appendChild(c)}}else e=
!0;e&&(c=make_P_Include_Br_Element(d))&&a.appendChild(c)}catch(m){}}
function checkIsInLineNode(a){return"a"==a||"abbr"==a||"acronym"==a||"b"==a||"basefont"==a||"bdo"==a||"big"==a||"button"==a||"cite"==a||"code"==a||"dfn"==a||"em"==a||"font"==a||"i"==a||"img"==a||"input"==a||"kbd"==a||"label"==a||"legend"==a||"map"==a||"param"==a||"q"==a||"rb"==a||"rbc"==a||"rp"==a||"rt"==a||"rtc"==a||"ruby"==a||"s"==a||"samp"==a||"select"==a||"small"==a||"span"==a||"strike"==a||"strong"==a||"sub"==a||"sup"==a||"textarea"==a||"tt"==a||"u"==a||"var"==a?!0:!1}
function make_P_Include_Br_Element(a){try{var d=g_objEditorDocument[a].createElement("p"),e=g_objEditorDocument[a].createElement("br");d.appendChild(e);return d}catch(b){}return null};

var g_objCodeDefine=new function(){this.arrTagDefine=null;this.ID_TAG_A=0;this.ID_TAG_ABBR=1;this.ID_TAG_ACRONYM=2;this.ID_TAG_ADDRESS=3;this.ID_TAG_APPLET=4;this.ID_TAG_AREA=5;this.ID_TAG_B=6;this.ID_TAG_BASE=7;this.ID_TAG_BASEFONT=8;this.ID_TAG_BDO=9;this.ID_TAG_BIG=10;this.ID_TAG_BLOCKQUOTE=11;this.ID_TAG_BODY=12;this.ID_TAG_BR=13;this.ID_TAG_BUTTON=14;this.ID_TAG_CAPTION=15;this.ID_TAG_CENTER=16;this.ID_TAG_CITE=17;this.ID_TAG_CODE=18;this.ID_TAG_COL=19;this.ID_TAG_COLGROUP=20;this.ID_TAG_DD=
21;this.ID_TAG_DEL=22;this.ID_TAG_DFN=23;this.ID_TAG_DIR=24;this.ID_TAG_DIV=25;this.ID_TAG_DL=26;this.ID_TAG_DT=27;this.ID_TAG_EM=28;this.ID_TAG_FIELDSET=29;this.ID_TAG_FONT=30;this.ID_TAG_FORM=31;this.ID_TAG_FRAME=32;this.ID_TAG_FRAMESET=33;this.ID_TAG_H1=34;this.ID_TAG_H2=35;this.ID_TAG_H3=36;this.ID_TAG_H4=37;this.ID_TAG_H5=38;this.ID_TAG_H6=39;this.ID_TAG_HEAD=40;this.ID_TAG_HR=41;this.ID_TAG_HTML=42;this.ID_TAG_I=43;this.ID_TAG_IFRAME=44;this.ID_TAG_IMG=45;this.ID_TAG_INPUT=46;this.ID_TAG_INS=
47;this.ID_TAG_ISINDEX=48;this.ID_TAG_KBD=49;this.ID_TAG_LABEL=50;this.ID_TAG_LEGEND=51;this.ID_TAG_LI=52;this.ID_TAG_LINK=53;this.ID_TAG_LISTING=54;this.ID_TAG_MAP=55;this.ID_TAG_MENU=56;this.ID_TAG_META=57;this.ID_TAG_NEXTID=58;this.ID_TAG_NOFRAMES=59;this.ID_TAG_NOSCRIPT=60;this.ID_TAG_OBJECT=61;this.ID_TAG_OL=62;this.ID_TAG_OPTGROUP=63;this.ID_TAG_OPTION=64;this.ID_TAG_P=65;this.ID_TAG_PARAM=66;this.ID_TAG_PLAINTEXT=67;this.ID_TAG_PRE=68;this.ID_TAG_Q=69;this.ID_TAG_RB=70;this.ID_TAG_RBC=71;this.ID_TAG_RP=
72;this.ID_TAG_RT=73;this.ID_TAG_RTC=74;this.ID_TAG_RUBY=75;this.ID_TAG_S=76;this.ID_TAG_SAMP=77;this.ID_TAG_SCRIPT=78;this.ID_TAG_SELECT=79;this.ID_TAG_SMALL=80;this.ID_TAG_SPAN=81;this.ID_TAG_STRIKE=82;this.ID_TAG_STRONG=83;this.ID_TAG_STYLE=84;this.ID_TAG_SUB=85;this.ID_TAG_SUP=86;this.ID_TAG_TABLE=87;this.ID_TAG_TBODY=88;this.ID_TAG_TD=89;this.ID_TAG_TEXTAREA=90;this.ID_TAG_TFOOT=91;this.ID_TAG_TH=92;this.ID_TAG_THEAD=93;this.ID_TAG_TITLE=94;this.ID_TAG_TR=95;this.ID_TAG_TT=96;this.ID_TAG_U=97;
this.ID_TAG_UL=98;this.ID_TAG_VAR=99;this.ID_TAG_XMP=100;this.ID_TAG_UNKNOWN=101;this.CM_EMPTY=1;this.CM_HTML=2;this.CM_HEAD=4;this.CM_BLOCK=8;this.CM_INLINE=16;this.CM_LIST=32;this.CM_DEFLIST=64;this.CM_TABLE=128;this.CM_ROWGRP=256;this.CM_ROW=512;this.CM_FIELD=1024;this.CM_OBJECT=2048;this.CM_PARAM=4096;this.CM_FRAMES=8192;this.CM_HEADING=16384;this.CM_OPT=32768;this.CM_IMG=65536;this.CM_MIXED=131072;this.CM_NO_INDENT=262144;this.CM_OBSOLETE=524288;this.CM_NEW=1048576;this.CM_OMITST=2097152;this.arrAttrDefine=
null;this.ID_ATTR_ABBR=0;this.ID_ATTR_ACCEPT=1;this.ID_ATTR_ACCEPT_CHARSET=2;this.ID_ATTR_ACCESSKEY=3;this.ID_ATTR_ACTION=4;this.ID_ATTR_ALIGN=5;this.ID_ATTR_ALINK=6;this.ID_ATTR_ALT=7;this.ID_ATTR_ARCHIVE=8;this.ID_ATTR_AXIS=9;this.ID_ATTR_BACKGROUND=10;this.ID_ATTR_BGCOLOR=11;this.ID_ATTR_BORDER=12;this.ID_ATTR_CELLPADDING=13;this.ID_ATTR_CELLSPACING=14;this.ID_ATTR_CHAR=15;this.ID_ATTR_CHAROFF=16;this.ID_ATTR_CHARSET=17;this.ID_ATTR_CHECKED=18;this.ID_ATTR_CITE=19;this.ID_ATTR_CLASS=20;this.ID_ATTR_CLASSID=
21;this.ID_ATTR_CLEAR=22;this.ID_ATTR_CODE=23;this.ID_ATTR_CODEBASE=24;this.ID_ATTR_CODETYPE=25;this.ID_ATTR_COLOR=26;this.ID_ATTR_COLS=27;this.ID_ATTR_COLSPAN=28;this.ID_ATTR_COMPACT=29;this.ID_ATTR_CONTENT=30;this.ID_ATTR_COORDS=31;this.ID_ATTR_DATA=32;this.ID_ATTR_DATETIME=33;this.ID_ATTR_DECLARE=34;this.ID_ATTR_DEFER=35;this.ID_ATTR_DIR=36;this.ID_ATTR_DISABLED=37;this.ID_ATTR_ENCODING=38;this.ID_ATTR_ENCTYPE=39;this.ID_ATTR_EVENT=40;this.ID_ATTR_FACE=41;this.ID_ATTR_FOR=42;this.ID_ATTR_FRAME=
43;this.ID_ATTR_FRAMEBORDER=44;this.ID_ATTR_HEADERS=45;this.ID_ATTR_HEIGHT=46;this.ID_ATTR_HREF=47;this.ID_ATTR_HREFLANG=48;this.ID_ATTR_HSPACE=49;this.ID_ATTR_HTTP_EQUIV=50;this.ID_ATTR_ID=51;this.ID_ATTR_ISMAP=52;this.ID_ATTR_LABEL=53;this.ID_ATTR_LANG=54;this.ID_ATTR_LANGUAGE=55;this.ID_ATTR_LINK=56;this.ID_ATTR_LONGDESC=57;this.ID_ATTR_MARGINHEIGHT=58;this.ID_ATTR_MARGINWIDTH=59;this.ID_ATTR_MAXLENGTH=60;this.ID_ATTR_MEDIA=61;this.ID_ATTR_METHOD=62;this.ID_ATTR_METHODS=63;this.ID_ATTR_MULTIPLE=
64;this.ID_ATTR_N=65;this.ID_ATTR_NAME=66;this.ID_ATTR_NOHREF=67;this.ID_ATTR_NORESIZE=68;this.ID_ATTR_NOSHADE=69;this.ID_ATTR_NOWRAP=70;this.ID_ATTR_OBJECT=71;this.ID_ATTR_ONBLUR=72;this.ID_ATTR_ONCHANGE=73;this.ID_ATTR_ONCLICK=74;this.ID_ATTR_ONDBLCLICK=75;this.ID_ATTR_ONFOCUS=76;this.ID_ATTR_ONKEYDOWN=77;this.ID_ATTR_ONKEYPRESS=78;this.ID_ATTR_ONKEYUP=79;this.ID_ATTR_ONLOAD=80;this.ID_ATTR_ONMOUSEDOWN=81;this.ID_ATTR_ONMOUSEMOVE=82;this.ID_ATTR_ONMOUSEOUT=83;this.ID_ATTR_ONMOUSEOVER=84;this.ID_ATTR_ONMOUSEUP=
85;this.ID_ATTR_ONRESET=86;this.ID_ATTR_ONSELECT=87;this.ID_ATTR_ONSUBMIT=88;this.ID_ATTR_ONUNLOAD=89;this.ID_ATTR_PROFILE=90;this.ID_ATTR_PROMPT=91;this.ID_ATTR_RBSPAN=92;this.ID_ATTR_READONLY=93;this.ID_ATTR_REL=94;this.ID_ATTR_REV=95;this.ID_ATTR_ROWS=96;this.ID_ATTR_ROWSPAN=97;this.ID_ATTR_RULES=98;this.ID_ATTR_SCHEME=99;this.ID_ATTR_SCOPE=100;this.ID_ATTR_SCROLLING=101;this.ID_ATTR_SDAFORM=102;this.ID_ATTR_SDAPREF=103;this.ID_ATTR_SDASUFF=104;this.ID_ATTR_SELECTED=105;this.ID_ATTR_SHAPE=106;
this.ID_ATTR_SIZE=107;this.ID_ATTR_SPAN=108;this.ID_ATTR_SRC=109;this.ID_ATTR_STANDBY=110;this.ID_ATTR_START=111;this.ID_ATTR_STYLE=112;this.ID_ATTR_SUMMARY=113;this.ID_ATTR_TABINDEX=114;this.ID_ATTR_TARGET=115;this.ID_ATTR_TEXT=116;this.ID_ATTR_TITLE=117;this.ID_ATTR_TYPE=118;this.ID_ATTR_URN=119;this.ID_ATTR_USEMAP=120;this.ID_ATTR_VALIGN=121;this.ID_ATTR_VALUE=122;this.ID_ATTR_VALUETYPE=123;this.ID_ATTR_VERSION=124;this.ID_ATTR_VLINK=125;this.ID_ATTR_VSPACE=126;this.ID_ATTR_WIDTH=127;this.ID_ATTR_XML_LANG=
128;this.ID_ATTR_XML_SPACE=129;this.ID_ATTR_XMLNS=130;this.ID_ATTR_UNKNOWN=131;this.initTagDefine=function(){try{this.arrTagDefine||(this.arrTagDefine=[],this.arrTagDefine[this.ID_TAG_A]=["a",16,0],this.arrTagDefine[this.ID_TAG_ABBR]=["abbr",16,0],this.arrTagDefine[this.ID_TAG_ACRONYM]=["acronym",16,0],this.arrTagDefine[this.ID_TAG_ADDRESS]=["address",8,0],this.arrTagDefine[this.ID_TAG_APPLET]=["applet",71696,0],this.arrTagDefine[this.ID_TAG_AREA]=["area",9,1],this.arrTagDefine[this.ID_TAG_B]=["b",
16,0],this.arrTagDefine[this.ID_TAG_BASE]=["base",5,0],this.arrTagDefine[this.ID_TAG_BASEFONT]=["basefont",17,1],this.arrTagDefine[this.ID_TAG_BDO]=["bdo",16,0],this.arrTagDefine[this.ID_TAG_BIG]=["big",16,0],this.arrTagDefine[this.ID_TAG_BLOCKQUOTE]=["blockquote",8,0],this.arrTagDefine[this.ID_TAG_BODY]=["body",2129922,0],this.arrTagDefine[this.ID_TAG_BR]=["br",17,0],this.arrTagDefine[this.ID_TAG_BUTTON]=["button",16,0],this.arrTagDefine[this.ID_TAG_CAPTION]=["caption",128,0],this.arrTagDefine[this.ID_TAG_CENTER]=
["center",8,0],this.arrTagDefine[this.ID_TAG_CITE]=["cite",16,0],this.arrTagDefine[this.ID_TAG_CODE]=["code",16,0],this.arrTagDefine[this.ID_TAG_COL]=["col",129,0],this.arrTagDefine[this.ID_TAG_COLGROUP]=["colgroup",32896,0],this.arrTagDefine[this.ID_TAG_DD]=["dd",294976,0],this.arrTagDefine[this.ID_TAG_DEL]=["del",131096,0],this.arrTagDefine[this.ID_TAG_DFN]=["dfn",16,0],this.arrTagDefine[this.ID_TAG_DIR]=["dir",524296,0],this.arrTagDefine[this.ID_TAG_DIV]=["div",8,0],this.arrTagDefine[this.ID_TAG_DL]=
["dl",8,0],this.arrTagDefine[this.ID_TAG_DT]=["dt",294976,0],this.arrTagDefine[this.ID_TAG_EM]=["em",16,0],this.arrTagDefine[this.ID_TAG_FIELDSET]=["fieldset",8,0],this.arrTagDefine[this.ID_TAG_FONT]=["font",16,0],this.arrTagDefine[this.ID_TAG_FORM]=["form",8,1],this.arrTagDefine[this.ID_TAG_FRAME]=["frame",8193,0],this.arrTagDefine[this.ID_TAG_FRAMESET]=["frameset",8194,0],this.arrTagDefine[this.ID_TAG_H1]=["h1",16392,0],this.arrTagDefine[this.ID_TAG_H2]=["h2",16392,0],this.arrTagDefine[this.ID_TAG_H3]=
["h3",16392,0],this.arrTagDefine[this.ID_TAG_H4]=["h4",16392,0],this.arrTagDefine[this.ID_TAG_H5]=["h5",16392,0],this.arrTagDefine[this.ID_TAG_H6]=["h6",16392,0],this.arrTagDefine[this.ID_TAG_HEAD]=["head",2129922,0],this.arrTagDefine[this.ID_TAG_HR]=["hr",9,0],this.arrTagDefine[this.ID_TAG_HTML]=["html",2129922,0],this.arrTagDefine[this.ID_TAG_I]=["i",16,0],this.arrTagDefine[this.ID_TAG_IFRAME]=["iframe",16,0],this.arrTagDefine[this.ID_TAG_IMG]=["img",65553,1],this.arrTagDefine[this.ID_TAG_INPUT]=
["input",65553,0],this.arrTagDefine[this.ID_TAG_INS]=["ins",131096,0],this.arrTagDefine[this.ID_TAG_ISINDEX]=["isindex",9,0],this.arrTagDefine[this.ID_TAG_KBD]=["kbd",16,0],this.arrTagDefine[this.ID_TAG_LABEL]=["label",16,0],this.arrTagDefine[this.ID_TAG_LEGEND]=["legend",16,0],this.arrTagDefine[this.ID_TAG_LI]=["li",294944,0],this.arrTagDefine[this.ID_TAG_LINK]=["link",5,1],this.arrTagDefine[this.ID_TAG_LISTING]=["listing",524296,0],this.arrTagDefine[this.ID_TAG_MAP]=["map",16,1],this.arrTagDefine[this.ID_TAG_MENU]=
["menu",524296,0],this.arrTagDefine[this.ID_TAG_META]=["meta",5,1],this.arrTagDefine[this.ID_TAG_NEXTID]=["nextid",5,0],this.arrTagDefine[this.ID_TAG_NOFRAMES]=["noframes",8200,0],this.arrTagDefine[this.ID_TAG_NOSCRIPT]=["noscript",131096,0],this.arrTagDefine[this.ID_TAG_OBJECT]=["object",71700,0],this.arrTagDefine[this.ID_TAG_OL]=["ol",8,0],this.arrTagDefine[this.ID_TAG_OPTGROUP]=["optgroup",33792,0],this.arrTagDefine[this.ID_TAG_OPTION]=["option",33792,0],this.arrTagDefine[this.ID_TAG_P]=["p",32776,
0],this.arrTagDefine[this.ID_TAG_PARAM]=["param",17,1],this.arrTagDefine[this.ID_TAG_PLAINTEXT]=["plaintext",524296,0],this.arrTagDefine[this.ID_TAG_PRE]=["pre",8,0],this.arrTagDefine[this.ID_TAG_Q]=["q",16,0],this.arrTagDefine[this.ID_TAG_RB]=["rb",16,0],this.arrTagDefine[this.ID_TAG_RBC]=["rbc",16,0],this.arrTagDefine[this.ID_TAG_RP]=["rp",16,0],this.arrTagDefine[this.ID_TAG_RT]=["rt",16,0],this.arrTagDefine[this.ID_TAG_RTC]=["rtc",16,0],this.arrTagDefine[this.ID_TAG_RUBY]=["ruby",16,0],this.arrTagDefine[this.ID_TAG_S]=
["s",16,0],this.arrTagDefine[this.ID_TAG_SAMP]=["samp",16,0],this.arrTagDefine[this.ID_TAG_SCRIPT]=["script",131100,1],this.arrTagDefine[this.ID_TAG_SELECT]=["select",1040,0],this.arrTagDefine[this.ID_TAG_SMALL]=["small",16,0],this.arrTagDefine[this.ID_TAG_SPAN]=["span",16,0],this.arrTagDefine[this.ID_TAG_STRIKE]=["strike",16,0],this.arrTagDefine[this.ID_TAG_STRONG]=["strong",16,0],this.arrTagDefine[this.ID_TAG_STYLE]=["style",4,1],this.arrTagDefine[this.ID_TAG_SUB]=["sub",16,0],this.arrTagDefine[this.ID_TAG_SUP]=
["sup",16,0],this.arrTagDefine[this.ID_TAG_TABLE]=["table",8,1],this.arrTagDefine[this.ID_TAG_TBODY]=["tbody",33152,0],this.arrTagDefine[this.ID_TAG_TD]=["td",295424,0],this.arrTagDefine[this.ID_TAG_TEXTAREA]=["textarea",1040,0],this.arrTagDefine[this.ID_TAG_TFOOT]=["tfoot",33152,0],this.arrTagDefine[this.ID_TAG_TH]=["th",295424,0],this.arrTagDefine[this.ID_TAG_THEAD]=["thead",33152,0],this.arrTagDefine[this.ID_TAG_TITLE]=["title",4,0],this.arrTagDefine[this.ID_TAG_TR]=["tr",32896,0],this.arrTagDefine[this.ID_TAG_TT]=
["tt",16,0],this.arrTagDefine[this.ID_TAG_U]=["u",16,0],this.arrTagDefine[this.ID_TAG_UL]=["ul",8,0],this.arrTagDefine[this.ID_TAG_VAR]=["var",16,0],this.arrTagDefine[this.ID_TAG_XMP]=["xmp",524296,0])}catch(b){dalert(b)}};this.getTagDefineID=function(b,a){try{for(var c=this.ID_TAG_UNKNOWN;a<c;a++)if(this.arrTagDefine[a][0]==b)return a}catch(d){dalert(d)}return this.ID_TAG_UNKNOWN};this.nodeHasCM=function(b,a){try{return this.ID_TAG_UNKNOWN==b.tagID?!1:0!=(this.arrTagDefine[b.tagID][1]&a)?!0:!1}catch(c){dalert(c)}return!1};
this.initAttrDefine=function(){try{this.arrAttrDefine||(this.arrAttrDefine=[],this.arrAttrDefine[this.ID_ATTR_ABBR]=["abbr",0],this.arrAttrDefine[this.ID_ATTR_ACCEPT]=["accept",0],this.arrAttrDefine[this.ID_ATTR_ACCEPT_CHARSET]=["accept-charset",0],this.arrAttrDefine[this.ID_ATTR_ACCESSKEY]=["accesskey",0],this.arrAttrDefine[this.ID_ATTR_ACTION]=["action",0],this.arrAttrDefine[this.ID_ATTR_ALIGN]=["align",1],this.arrAttrDefine[this.ID_ATTR_ALINK]=["alink",1],this.arrAttrDefine[this.ID_ATTR_ALT]=["alt",
0],this.arrAttrDefine[this.ID_ATTR_ARCHIVE]=["archive",0],this.arrAttrDefine[this.ID_ATTR_AXIS]=["axis",0],this.arrAttrDefine[this.ID_ATTR_BACKGROUND]=["background",0],this.arrAttrDefine[this.ID_ATTR_BGCOLOR]=["bgcolor",1],this.arrAttrDefine[this.ID_ATTR_BORDER]=["border",1],this.arrAttrDefine[this.ID_ATTR_CELLPADDING]=["cellpadding",0],this.arrAttrDefine[this.ID_ATTR_CELLSPACING]=["cellspacing",0],this.arrAttrDefine[this.ID_ATTR_CHAR]=["char",0],this.arrAttrDefine[this.ID_ATTR_CHAROFF]=["charoff",
0],this.arrAttrDefine[this.ID_ATTR_CHARSET]=["charset",1],this.arrAttrDefine[this.ID_ATTR_CHECKED]=["checked",1],this.arrAttrDefine[this.ID_ATTR_CITE]=["cite",0],this.arrAttrDefine[this.ID_ATTR_CLASS]=["class",0],this.arrAttrDefine[this.ID_ATTR_CLASSID]=["classid",0],this.arrAttrDefine[this.ID_ATTR_CLEAR]=["clear",1],this.arrAttrDefine[this.ID_ATTR_CODE]=["code",0],this.arrAttrDefine[this.ID_ATTR_CODEBASE]=["codebase",0],this.arrAttrDefine[this.ID_ATTR_CODETYPE]=["codetype",0],this.arrAttrDefine[this.ID_ATTR_COLOR]=
["color",1],this.arrAttrDefine[this.ID_ATTR_COLS]=["cols",0],this.arrAttrDefine[this.ID_ATTR_COLSPAN]=["colspan",0],this.arrAttrDefine[this.ID_ATTR_COMPACT]=["compact",1],this.arrAttrDefine[this.ID_ATTR_CONTENT]=["content",0],this.arrAttrDefine[this.ID_ATTR_COORDS]=["coords",0],this.arrAttrDefine[this.ID_ATTR_DATA]=["data",0],this.arrAttrDefine[this.ID_ATTR_DATETIME]=["datetime",0],this.arrAttrDefine[this.ID_ATTR_DECLARE]=["declare",1],this.arrAttrDefine[this.ID_ATTR_DEFER]=["defer",1],this.arrAttrDefine[this.ID_ATTR_DIR]=
["dir",1],this.arrAttrDefine[this.ID_ATTR_DISABLED]=["disabled",1],this.arrAttrDefine[this.ID_ATTR_ENCODING]=["encoding",0],this.arrAttrDefine[this.ID_ATTR_ENCTYPE]=["enctype",1],this.arrAttrDefine[this.ID_ATTR_EVENT]=["event",0],this.arrAttrDefine[this.ID_ATTR_FACE]=["face",1],this.arrAttrDefine[this.ID_ATTR_FOR]=["for",0],this.arrAttrDefine[this.ID_ATTR_FRAME]=["frame",1],this.arrAttrDefine[this.ID_ATTR_FRAMEBORDER]=["frameborder",0],this.arrAttrDefine[this.ID_ATTR_HEADERS]=["headers",0],this.arrAttrDefine[this.ID_ATTR_HEIGHT]=
["height",0],this.arrAttrDefine[this.ID_ATTR_HREF]=["href",0],this.arrAttrDefine[this.ID_ATTR_HREFLANG]=["hreflang",0],this.arrAttrDefine[this.ID_ATTR_HSPACE]=["hspace",0],this.arrAttrDefine[this.ID_ATTR_HTTP_EQUIV]=["http-equiv",0],this.arrAttrDefine[this.ID_ATTR_ID]=["id",0],this.arrAttrDefine[this.ID_ATTR_ISMAP]=["ismap",1],this.arrAttrDefine[this.ID_ATTR_LABEL]=["label",0],this.arrAttrDefine[this.ID_ATTR_LANG]=["lang",1],this.arrAttrDefine[this.ID_ATTR_LANGUAGE]=["language",1],this.arrAttrDefine[this.ID_ATTR_LINK]=
["link",0],this.arrAttrDefine[this.ID_ATTR_LONGDESC]=["longdesc",0],this.arrAttrDefine[this.ID_ATTR_MARGINHEIGHT]=["marginheight",0],this.arrAttrDefine[this.ID_ATTR_MARGINWIDTH]=["marginwidth",0],this.arrAttrDefine[this.ID_ATTR_MAXLENGTH]=["maxlength",0],this.arrAttrDefine[this.ID_ATTR_MEDIA]=["media",0],this.arrAttrDefine[this.ID_ATTR_METHOD]=["method",1],this.arrAttrDefine[this.ID_ATTR_METHODS]=["methods",0],this.arrAttrDefine[this.ID_ATTR_MULTIPLE]=["multiple",1],this.arrAttrDefine[this.ID_ATTR_N]=
["n",0],this.arrAttrDefine[this.ID_ATTR_NAME]=["name",0],this.arrAttrDefine[this.ID_ATTR_NOHREF]=["nohref",1],this.arrAttrDefine[this.ID_ATTR_NORESIZE]=["noresize",1],this.arrAttrDefine[this.ID_ATTR_NOSHADE]=["noshade",1],this.arrAttrDefine[this.ID_ATTR_NOWRAP]=["nowrap",1],this.arrAttrDefine[this.ID_ATTR_OBJECT]=["object",0],this.arrAttrDefine[this.ID_ATTR_ONBLUR]=["onblur",0],this.arrAttrDefine[this.ID_ATTR_ONCHANGE]=["onchange",0],this.arrAttrDefine[this.ID_ATTR_ONCLICK]=["onclick",0],this.arrAttrDefine[this.ID_ATTR_ONDBLCLICK]=
["ondblclick",0],this.arrAttrDefine[this.ID_ATTR_ONFOCUS]=["onfocus",0],this.arrAttrDefine[this.ID_ATTR_ONKEYDOWN]=["onkeydown",0],this.arrAttrDefine[this.ID_ATTR_ONKEYPRESS]=["onkeypress",0],this.arrAttrDefine[this.ID_ATTR_ONKEYUP]=["onkeyup",0],this.arrAttrDefine[this.ID_ATTR_ONLOAD]=["onload",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEDOWN]=["onmousedown",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEMOVE]=["onmousemove",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEOUT]=["onmouseout",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEOVER]=
["onmouseover",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEUP]=["onmouseup",0],this.arrAttrDefine[this.ID_ATTR_ONRESET]=["onreset",0],this.arrAttrDefine[this.ID_ATTR_ONSELECT]=["onselect",0],this.arrAttrDefine[this.ID_ATTR_ONSUBMIT]=["onsubmit",0],this.arrAttrDefine[this.ID_ATTR_ONUNLOAD]=["onunload",0],this.arrAttrDefine[this.ID_ATTR_PROFILE]=["profile",0],this.arrAttrDefine[this.ID_ATTR_PROMPT]=["prompt",0],this.arrAttrDefine[this.ID_ATTR_RBSPAN]=["rbspan",0],this.arrAttrDefine[this.ID_ATTR_READONLY]=
["readonly",1],this.arrAttrDefine[this.ID_ATTR_REL]=["rel",0],this.arrAttrDefine[this.ID_ATTR_REV]=["rev",0],this.arrAttrDefine[this.ID_ATTR_ROWS]=["rows",0],this.arrAttrDefine[this.ID_ATTR_ROWSPAN]=["rowspan",0],this.arrAttrDefine[this.ID_ATTR_RULES]=["rules",0],this.arrAttrDefine[this.ID_ATTR_SCHEME]=["scheme",0],this.arrAttrDefine[this.ID_ATTR_SCOPE]=["scope",1],this.arrAttrDefine[this.ID_ATTR_SCROLLING]=["scrolling",1],this.arrAttrDefine[this.ID_ATTR_SDAFORM]=["sdaform",0],this.arrAttrDefine[this.ID_ATTR_SDAPREF]=
["sdapref",0],this.arrAttrDefine[this.ID_ATTR_SDASUFF]=["sdasuff",0],this.arrAttrDefine[this.ID_ATTR_SELECTED]=["selected",1],this.arrAttrDefine[this.ID_ATTR_SHAPE]=["shape",1],this.arrAttrDefine[this.ID_ATTR_SIZE]=["size",0],this.arrAttrDefine[this.ID_ATTR_SPAN]=["span",0],this.arrAttrDefine[this.ID_ATTR_SRC]=["src",0],this.arrAttrDefine[this.ID_ATTR_STANDBY]=["standby",0],this.arrAttrDefine[this.ID_ATTR_START]=["start",0],this.arrAttrDefine[this.ID_ATTR_STYLE]=["style",1],this.arrAttrDefine[this.ID_ATTR_SUMMARY]=
["summary",0],this.arrAttrDefine[this.ID_ATTR_TABINDEX]=["tabindex",0],this.arrAttrDefine[this.ID_ATTR_TARGET]=["target",1],this.arrAttrDefine[this.ID_ATTR_TEXT]=["text",0],this.arrAttrDefine[this.ID_ATTR_TITLE]=["title",0],this.arrAttrDefine[this.ID_ATTR_TYPE]=["type",0],this.arrAttrDefine[this.ID_ATTR_URN]=["urn",0],this.arrAttrDefine[this.ID_ATTR_USEMAP]=["usemap",0],this.arrAttrDefine[this.ID_ATTR_VALIGN]=["valign",1],this.arrAttrDefine[this.ID_ATTR_VALUE]=["value",0],this.arrAttrDefine[this.ID_ATTR_VALUETYPE]=
["valuetype",1],this.arrAttrDefine[this.ID_ATTR_VERSION]=["version",0],this.arrAttrDefine[this.ID_ATTR_VLINK]=["vlink",0],this.arrAttrDefine[this.ID_ATTR_VSPACE]=["vspace",0],this.arrAttrDefine[this.ID_ATTR_WIDTH]=["width",0],this.arrAttrDefine[this.ID_ATTR_XML_LANG]=["xml:lang",0],this.arrAttrDefine[this.ID_ATTR_XML_SPACE]=["xml:space",0],this.arrAttrDefine[this.ID_ATTR_XMLNS]=["xmlns",0])}catch(b){dalert(b)}};this.getAttrDefineID=function(b,a){try{for(var c=this.ID_ATTR_UNKNOWN;a<c;a++)if(this.arrAttrDefine[a][0]==
b)return a}catch(d){dalert(d)}return this.ID_ATTR_UNKNOWN};this.getAttrDefineOption=function(b){try{return this.arrAttrDefine[b][1]}catch(a){dalert(a)}return 0}};

var g_objCodeStream=new function(){this.initStreamIn=function(a){try{var b={};b.htmlCode=a;b.next=0;b.size=a.length;return b}catch(c){dalert(c)}return null};this.initStreamOut=function(){return{lineString:[],lineBuffer:"",tabApply:!0,convertPTagToBrTag:!1,imgSrcRemoveDomain:null,anchorHrefRemoveDomainYN:!1}};this.endOfStreamIn=function(a){try{return a.stDocStreamIn.next>=a.stDocStreamIn.size}catch(b){dalert(b)}return!0};this.readChar=function(a){try{if(!g_objCodeStream.endOfStreamIn(a))return a.stDocStreamIn.htmlCode.charAt(a.stDocStreamIn.next++)}catch(b){dalert(b)}return null};
this.ungetChar=function(a){try{0<a.stDocStreamIn.next?a.stDocStreamIn.next--:a.stDocStreamIn.next=0}catch(b){dalert(b)}};this.getCharPos=function(a){try{return a.stDocStreamIn.next}catch(b){dalert(b)}};this.setCharPos=function(a,b){try{b.stDocStreamIn.next=a}catch(c){dalert(c)}}};

var g_objCodeLexer=new function(){this.LEX_CONTENT=0;this.LEX_GT=1;this.LEX_STARTTAG=2;this.LEX_ENDTAG=3;this.LEX_COMMENT=4;this.LEX_SECTION=5;this.LEX_CDATA=6;this.LEX_XML_DECLARE_START=7;this.NODE_TYPE_ROOT=0;this.NODE_TYPE_TEXT=1;this.NODE_TYPE_START=2;this.NODE_TYPE_START_END=3;this.NODE_TYPE_END=4;this.NODE_TYPE_COMMENT=5;this.NODE_TYPE_XML_DECLARE_START=6;this.NODE_TYPE_XML_DECLARE_START_END=7;this.NODE_TYPE_XML_DECLARE_END=8;this.ID_COMMENT_END_TAG="--\x3e";this.ID_SCRIPT_END_TAG="\x3c/script>";
this.ID_STYLE_END_TAG="</style>";this.ID_LOWER_CASE_LETTER_A=97;this.ID_LOWER_CASE_LETTER_B=98;this.ID_LOWER_CASE_LETTER_C=99;this.ID_LOWER_CASE_LETTER_D=100;this.ID_LOWER_CASE_LETTER_E=101;this.ID_LOWER_CASE_LETTER_F=102;this.ID_LOWER_CASE_LETTER_G=103;this.ID_LOWER_CASE_LETTER_H=104;this.ID_LOWER_CASE_LETTER_I=105;this.ID_LOWER_CASE_LETTER_J=106;this.ID_LOWER_CASE_LETTER_K=107;this.ID_LOWER_CASE_LETTER_L=108;this.ID_LOWER_CASE_LETTER_M=109;this.ID_LOWER_CASE_LETTER_N=110;this.ID_LOWER_CASE_LETTER_O=
111;this.ID_LOWER_CASE_LETTER_P=112;this.ID_LOWER_CASE_LETTER_Q=113;this.ID_LOWER_CASE_LETTER_R=114;this.ID_LOWER_CASE_LETTER_S=115;this.ID_LOWER_CASE_LETTER_T=116;this.ID_LOWER_CASE_LETTER_U=117;this.ID_LOWER_CASE_LETTER_V=118;this.ID_LOWER_CASE_LETTER_W=119;this.ID_LOWER_CASE_LETTER_X=120;this.ID_LOWER_CASE_LETTER_Y=121;this.ID_LOWER_CASE_LETTER_Z=122;this.initLexer=function(){try{var a={};a.state=this.LEX_CONTENT;a.sequence=-1;a.tagID=g_objCodeDefine.ID_TAG_UNKNOWN;a.tagName="";a.textStartPos=
-1;a.textEndPos=-1;a.attributeDelimiter=null;a.attributeStartPos=-1;a.attributeEndPos=-1;a.pushed=!1;a.emptyClosed=!1;a.compareEndTag="";a.token=null;return a}catch(b){dalert(b)}return null};this.newNode=function(a){try{var b={};b.sequence=a.stDocLexer.sequence++;b.type=this.NODE_TYPE_TEXT;b.closed=!1;b.tagID=g_objCodeDefine.ID_TAG_UNKNOWN;b.tagName="";b.textStartPos=-1;b.textEndPos=-1;b.parent=null;b.next=null;b.content=null;b.last=null;b.arrAttribute=null;b.print=!0;return b}catch(d){dalert(d)}return null};
this.newAttribute=function(a){try{var b={};b.sequence=a.stDocLexer.sequence++;b.attributeID=g_objCodeDefine.ID_ATTR_UNKNOWN;b.attributeName=null;b.delimiter=null;b.attributeStartPos=-1;b.attributeEndPos=-1;b.arrStyleAttribute=null;return b}catch(d){dalert(d)}return null};this.newStyleAttribute=function(){return{styleName:"",styleValue:""}};this.isWhite=function(a){try{var b=a.charCodeAt(0);if(10==b||13==b||32==b)return!0}catch(d){dalert(d)}return!1};this.isSpace=function(a){try{if(32==a.charCodeAt(0))return!0}catch(b){dalert(b)}return!1};
this.isLetter=function(a){try{var b=a.charCodeAt(0);if(65<=b&&90>=b||97<=b&&122>=b)return!0}catch(d){dalert(d)}return!1};this.isDigit=function(a){try{var b=a.charCodeAt(0);if(48<=b&&57>=b)return!0}catch(d){dalert(d)}return!1};this.isNamechar=function(a){try{if(this.isLetter(a)||this.isDigit(a))return!0;var b=a.charCodeAt(0);if(45==b||46==b||58==b||95==b)return!0}catch(d){dalert(d)}return!1};this.getToken=function(a){try{if(a.stDocLexer.pushed)return a.stDocLexer.pushed=!1,a.stDocLexer.token;a.stDocLexer.textStartPos=
-1;a.stDocLexer.textEndPos=-1;a.stDocLexer.emptyClosed=!1;a.stDocLexer.compareEndTag="";for(var b=null;null!=(b=g_objCodeStream.readChar(a));)switch(a.stDocLexer.state){case this.LEX_CONTENT:if(this.isWhite(b)){if(32==b.charCodeAt(0)||10==b.charCodeAt(0)||13==b.charCodeAt(0))-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1;continue}if(ID_KEYCODE_TAB==b.charCodeAt(0)&&
a.stDocLexer.tagID!=g_objCodeDefine.ID_TAG_SPAN)continue;if("<"==b){a.stDocLexer.state=this.LEX_GT;continue}-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1;continue;case this.LEX_GT:if("/"==b){if(null==(b=g_objCodeStream.readChar(a))){g_objCodeStream.ungetChar(a);continue}if(this.isLetter(b)){a.stDocLexer.state=this.LEX_ENDTAG;g_objCodeStream.setCharPos(g_objCodeStream.getCharPos(a)-
2,a);if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}a.stDocLexer.state=this.LEX_CONTENT;continue}if("!"==b){if(null==(b=g_objCodeStream.readChar(a)))g_objCodeStream.ungetChar(a);else if("-"==b)if(null==(b=g_objCodeStream.readChar(a)))g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a);
else if("-"==b){if(-1!=a.stDocLexer.textStartPos)return g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a),a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;a.stDocLexer.state=this.LEX_COMMENT;continue}else g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a);else if("["==b){a.stDocLexer.state=this.LEX_SECTION;
continue}else g_objCodeStream.ungetChar(a);g_objCodeStream.ungetChar(a);a.stDocLexer.state=this.LEX_CONTENT;continue}if("?"==b){g_objCodeStream.ungetChar(a);a.stDocLexer.state=this.LEX_XML_DECLARE_START;if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}if(this.isLetter(b)){a.stDocLexer.state=
this.LEX_STARTTAG;g_objCodeStream.setCharPos(g_objCodeStream.getCharPos(a)-2,a);if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}a.stDocLexer.state=this.LEX_CONTENT;continue;case this.LEX_XML_DECLARE_START:var d=null;b=this.parseTagName(!1,a);">"!=b&&("/"==b&&g_objCodeStream.ungetChar(a),d=
this.parseAttribute(!1,a));a.stDocLexer.token=this.newNode(a);a.stDocLexer.token.tagID=a.stDocLexer.tagID;a.stDocLexer.token.tagName=a.stDocLexer.tagName;a.stDocLexer.token.type=a.stDocLexer.emptyClosed?this.NODE_TYPE_XML_DECLARE_START_END:this.NODE_TYPE_XML_DECLARE_START;a.stDocLexer.token.arrAttribute=d;a.stDocLexer.state=this.LEX_CONTENT;return a.stDocLexer.token;case this.LEX_STARTTAG:return d=null,b=this.parseTagName(!0,a),">"!=b&&("/"==b&&g_objCodeStream.ungetChar(a),d=this.parseAttribute(!0,
a)),a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.tagID=a.stDocLexer.tagID,a.stDocLexer.token.tagName=a.stDocLexer.tagName,a.stDocLexer.token.type=g_objCodeDefine.ID_TAG_UNKNOWN==a.stDocLexer.tagID?"embed"==a.stDocLexer.tagName?this.NODE_TYPE_START_END:a.stDocLexer.emptyClosed?this.NODE_TYPE_START_END:this.NODE_TYPE_START:a.stDocLexer.emptyClosed?this.NODE_TYPE_START_END:this.NODE_TYPE_START,a.stDocLexer.token.arrAttribute=d,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token;case this.LEX_ENDTAG:b=
this.parseTagName(!0,a);a.stDocLexer.token=this.newNode(a);a.stDocLexer.token.tagID=a.stDocLexer.tagID;a.stDocLexer.token.tagName=a.stDocLexer.tagName;for(a.stDocLexer.token.type=this.NODE_TYPE_END;">"!=b&&null!=b;)b=g_objCodeStream.readChar(a);a.stDocLexer.state=this.LEX_CONTENT;return a.stDocLexer.token;case this.LEX_COMMENT:this.replaceCommentEndTag(b,a);if(this.ID_COMMENT_END_TAG==a.stDocLexer.compareEndTag)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_COMMENT,
a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos-2,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token;-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1}if(this.LEX_CONTENT==a.stDocLexer.state){if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=
this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token}else if(this.LEX_COMMENT==a.stDocLexer.state&&-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_COMMENT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token}catch(e){dalert(e)}return null};
this.getCDATAToken=function(a,b){try{if(g_objCodeDefine.ID_TAG_SCRIPT!=a&&g_objCodeDefine.ID_TAG_STYLE!=a)return;b.stDocLexer.compareEndTag="";for(var d=null;null!=(d=g_objCodeStream.readChar(b));){this.replaceScriptStyleEndTag(d,a,b);if(g_objCodeDefine.ID_TAG_SCRIPT==a){if(this.ID_SCRIPT_END_TAG==b.stDocLexer.compareEndTag)return b.stDocLexer.token=this.newNode(b),b.stDocLexer.token.type=this.NODE_TYPE_TEXT,b.stDocLexer.token.textStartPos=b.stDocLexer.textStartPos,b.stDocLexer.token.textEndPos=b.stDocLexer.textEndPos-
8,b.stDocLexer.state=this.LEX_CONTENT,b.stDocLexer.token}else if(g_objCodeDefine.ID_TAG_STYLE==a&&this.ID_STYLE_END_TAG==b.stDocLexer.compareEndTag)return b.stDocLexer.token=this.newNode(b),b.stDocLexer.token.type=this.NODE_TYPE_TEXT,b.stDocLexer.token.textStartPos=b.stDocLexer.textStartPos,b.stDocLexer.token.textEndPos=b.stDocLexer.textEndPos-7,b.stDocLexer.state=this.LEX_CONTENT,b.stDocLexer.token;-1==b.stDocLexer.textStartPos?(b.stDocLexer.textStartPos=g_objCodeStream.getCharPos(b)-1,b.stDocLexer.textEndPos=
b.stDocLexer.textStartPos):b.stDocLexer.textEndPos=g_objCodeStream.getCharPos(b)-1}}catch(e){dalert(e)}return null};this.replaceCommentEndTag=function(a,b){try{3>b.stDocLexer.compareEndTag.length||(b.stDocLexer.compareEndTag=b.stDocLexer.compareEndTag.substring(1,3)),b.stDocLexer.compareEndTag+=a}catch(d){dalert(d)}};this.replaceScriptStyleEndTag=function(a,b,d){try{if(g_objCodeDefine.ID_TAG_SCRIPT==b||g_objCodeDefine.ID_TAG_STYLE==b){var e=0,g=d.stDocLexer.compareEndTag.length;g_objCodeDefine.ID_TAG_SCRIPT==
b?e=9:g_objCodeDefine.ID_TAG_STYLE==b&&(e=8);g<e||(d.stDocLexer.compareEndTag=d.stDocLexer.compareEndTag.substring(1,e));d.stDocLexer.compareEndTag+=a.toLowerCase()}}catch(h){dalert(h)}};this.ungetToken=function(a){try{a.stDocLexer.pushed=!0}catch(b){dalert(b)}};this.parseTagName=function(a,b){try{b.stDocLexer.tagName="";for(var d=null;null!=(d=g_objCodeStream.readChar(b))&&this.isNamechar(d);)b.stDocLexer.tagName+=d.toLowerCase();b.stDocLexer.tagID=a?this.findTagDefineID(b.stDocLexer.tagName):g_objCodeDefine.ID_TAG_UNKNOWN;
return d}catch(e){dalert(e)}return null};this.parseAttribute=function(a,b){try{for(var d=null;!g_objCodeStream.endOfStreamIn(b);){b.stDocLexer.attributeDelimiter=null;b.stDocLexer.attributeStartPos=-1;b.stDocLexer.attributeEndPos=-1;var e=this.parseAttributeName(b);if(null==e)break;null==d&&(d=[]);var g=d.length;d[g]=this.newAttribute(b);d[g].attributeName=e;d[g].attributeID=a?this.findAttrDefineID(e):g_objCodeDefine.ID_ATTR_UNKNOWN;this.parseAttributeValue(b);d[g].delimiter=b.stDocLexer.attributeDelimiter;
d[g].attributeStartPos=b.stDocLexer.attributeStartPos;d[g].attributeEndPos=b.stDocLexer.attributeEndPos;g_objCodeDefine.ID_ATTR_STYLE==d[g].attributeID&&b.bStyleAttribute&&this.parseStyleAttribute(b,d[g])}return d}catch(h){dalert(h)}return null};this.parseAttributeName=function(a){try{for(var b="",d=null;;){d=g_objCodeStream.readChar(a);if(null==d)return g_objCodeStream.ungetChar(a),null;if("/"==d){d=g_objCodeStream.readChar(a);if(">"==d)return a.stDocLexer.emptyClosed=!0,null;g_objCodeStream.ungetChar(a);
d="/";break}if(">"==d)return null;if(!this.isWhite(d))break}for(;;){if(null==d){g_objCodeStream.ungetChar(a);break}if("="==d||">"==d){g_objCodeStream.ungetChar(a);break}if(this.isWhite(d))break;b+=d.toLowerCase();d=g_objCodeStream.readChar(a)}return""==b?null:b}catch(e){dalert(e)}return null};this.parseAttributeValue=function(a){try{for(var b=null,d=null;;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(!this.isWhite(d))break}if("="!=d&&'"'!=d&&"'"!=d)g_objCodeStream.ungetChar(a);
else{for(;;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(!this.isWhite(d))break}for('"'==d||"'"==d?b=d:g_objCodeStream.ungetChar(a);;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(null==b){if(">"==d){g_objCodeStream.ungetChar(a);break}if("/"==d){d=g_objCodeStream.readChar(a);if(">"==d){a.stDocLexer.emptyClosed=!0;g_objCodeStream.ungetChar(a);break}g_objCodeStream.ungetChar(a);c="/"}}else if(d==b)break;if(this.isWhite(d)&&null==
b)break;-1==a.stDocLexer.attributeStartPos?(a.stDocLexer.attributeStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.attributeEndPos=a.stDocLexer.attributeStartPos):a.stDocLexer.attributeEndPos=g_objCodeStream.getCharPos(a)-1}a.stDocLexer.attributeDelimiter=b}}catch(e){dalert(e)}};this.parseStyleAttribute=function(a,b){try{var d=g_objCodeStream.getCharPos(a),e=b.attributeStartPos,g=b.attributeEndPos;g_objCodeStream.setCharPos(e,a);for(var h=null,l=!1,m=!1,n="",f="";e<=g;e++){var k=g_objCodeStream.readChar(a);
if(null==k)break;if(this.isWhite(k)){if(!l)continue;if(!this.isSpace(k))continue}":"==k?l?"background-image"==n.toLowerCase()||"background"==n.toLowerCase()?f+=k:-1!=f.toLowerCase().indexOf("url(")&&(f+=k):l=!0:"'"==k||'"'==k?l&&(f+=k,m=!m):";"==k?-1!=f.indexOf("&quot")?(f=f.replace("&quot","'"),m=!m):-1!=f.indexOf("&amp")?f=f.replace("&amp","&"):!0===m?f+=k:(l=!1,null==h&&(h=[]),h[h.length]=this.addStyleAttribute(a,n,f),f=n="",m=!1):l?f+=k:n+=k}l&&(null==h&&(h=[]),h[h.length]=this.addStyleAttribute(a,
n,f));b.arrStyleAttribute=h;g_objCodeStream.setCharPos(d,a)}catch(p){dalert(p)}};this.addStyleAttribute=function(a,b,d){try{var e=this.newStyleAttribute();e.styleName=b.toLowerCase();e.styleValue=d;return e}catch(g){dalert(g)}};this.findTagDefineID=function(a){try{switch(a.charCodeAt(0)){case this.ID_LOWER_CASE_LETTER_A:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_A);case this.ID_LOWER_CASE_LETTER_B:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_B);case this.ID_LOWER_CASE_LETTER_C:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_CAPTION);case this.ID_LOWER_CASE_LETTER_D:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_DD);case this.ID_LOWER_CASE_LETTER_E:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_EM);case this.ID_LOWER_CASE_LETTER_F:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_FIELDSET);case this.ID_LOWER_CASE_LETTER_H:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_H1);case this.ID_LOWER_CASE_LETTER_I:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_I);case this.ID_LOWER_CASE_LETTER_K:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_KBD);case this.ID_LOWER_CASE_LETTER_L:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_LABEL);case this.ID_LOWER_CASE_LETTER_M:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_MAP);case this.ID_LOWER_CASE_LETTER_N:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_NEXTID);case this.ID_LOWER_CASE_LETTER_O:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_OBJECT);case this.ID_LOWER_CASE_LETTER_P:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_P);case this.ID_LOWER_CASE_LETTER_Q:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_Q);case this.ID_LOWER_CASE_LETTER_R:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_RB);case this.ID_LOWER_CASE_LETTER_S:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_S);case this.ID_LOWER_CASE_LETTER_T:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_TABLE);case this.ID_LOWER_CASE_LETTER_U:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_U);case this.ID_LOWER_CASE_LETTER_V:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_VAR);case this.ID_LOWER_CASE_LETTER_X:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_XMP)}}catch(b){dalert(b)}return g_objCodeDefine.ID_TAG_UNKNOWN};this.findAttrDefineID=function(a){try{switch(a.charCodeAt(0)){case this.ID_LOWER_CASE_LETTER_A:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_ABBR);case this.ID_LOWER_CASE_LETTER_B:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_BACKGROUND);case this.ID_LOWER_CASE_LETTER_C:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_CELLPADDING);case this.ID_LOWER_CASE_LETTER_D:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_DATA);case this.ID_LOWER_CASE_LETTER_E:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_ENCODING);case this.ID_LOWER_CASE_LETTER_F:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_FACE);case this.ID_LOWER_CASE_LETTER_H:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_HEADERS);case this.ID_LOWER_CASE_LETTER_I:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_ID);case this.ID_LOWER_CASE_LETTER_L:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_LABEL);case this.ID_LOWER_CASE_LETTER_M:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_MARGINHEIGHT);case this.ID_LOWER_CASE_LETTER_N:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_N);case this.ID_LOWER_CASE_LETTER_O:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_OBJECT);case this.ID_LOWER_CASE_LETTER_P:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_PROFILE);case this.ID_LOWER_CASE_LETTER_R:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_RBSPAN);case this.ID_LOWER_CASE_LETTER_S:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_SCHEME);case this.ID_LOWER_CASE_LETTER_T:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_TABINDEX);case this.ID_LOWER_CASE_LETTER_U:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_URN);case this.ID_LOWER_CASE_LETTER_V:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_VALIGN);case this.ID_LOWER_CASE_LETTER_W:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_WIDTH);case this.ID_LOWER_CASE_LETTER_X:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_XML_LANG)}}catch(b){dalert(b)}return g_objCodeDefine.ID_ATTR_UNKNOWN}};

var g_objCodeParser=new function(){this.convertXHTMLCode=function(c){try{var b=this.initParserStruct(c);if(!b)return c;this.parseBody(b.stDocRoot,b);g_objCodePrint.printTree(b.stDocRoot,0,b);0<b.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,b);for(var a="",d=0;d<b.stDocStreamOut.lineString.length;d++)checkTextNodeAllWhiteCode_Plus_Space(b.stDocStreamOut.lineString[d])||(a+=b.stDocStreamOut.lineString[d]+"\r\n");return a}catch(e){dalert(e)}return c};this.initParserStruct=function(c){try{var b=
{stDocRoot:null,stDocStreamIn:null,stDocStreamOut:null,stDocLexer:null,bStyleAttribute:!0};g_objCodeDefine.initTagDefine();g_objCodeDefine.initAttrDefine();b.stDocStreamIn=g_objCodeStream.initStreamIn(c);if(!b.stDocStreamIn)return null;b.stDocStreamOut=g_objCodeStream.initStreamOut();if(b.stDocStreamOut)b.stDocStreamOut.tabApply=g_bContentXHTMLTabSettingYN,b.stDocStreamOut.convertPTagToBrTag=g_bConvertPTagToBrTag,null!=g_arrImgSrcRemoveDomain&&0<g_arrImgSrcRemoveDomain.length&&(b.stDocStreamOut.imgSrcRemoveDomain=
g_arrImgSrcRemoveDomain,b.stDocStreamOut.anchorHrefRemoveDomainYN=g_bAnchorHrefRemoveDomainYN);else return null;b.stDocLexer=g_objCodeLexer.initLexer();if(!b.stDocLexer)return null;b.stDocRoot=g_objCodeLexer.newNode(b);b.stDocRoot.type=g_objCodeLexer.NODE_TYPE_ROOT;return b}catch(a){dalert(a)}return null};this.parseBody=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));)g_objCodeLexer.NODE_TYPE_START==a.type?(this.insertNodeAtEnd(c,a),g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY)?
this.parseEmpty(a,b):g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID?this.parseScriptStyle(a,b):g_objCodeDefine.ID_TAG_COLGROUP==a.tagID?this.parseColGroup(a,b):g_objCodeDefine.ID_TAG_TBODY==a.tagID||g_objCodeDefine.ID_TAG_TFOOT==a.tagID||g_objCodeDefine.ID_TAG_THEAD==a.tagID?this.parseRowGroup(a,b):this.parseTag(a,b)):g_objCodeLexer.NODE_TYPE_START_END==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_TEXT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_COMMENT==
a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type&&this.insertNodeAtEnd(c,a)}catch(d){dalert(d)}};this.parseTag=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}if(g_objCodeLexer.NODE_TYPE_END==a.type)for(var d=c.parent;null!=d;d=d.parent)if(a.tagID==d.tagID){g_objCodeLexer.ungetToken(b);return}g_objCodeLexer.NODE_TYPE_START==
a.type?(this.insertNodeAtEnd(c,a),g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY)?this.parseEmpty(a,b):g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID?this.parseScriptStyle(a,b):g_objCodeDefine.ID_TAG_COLGROUP==a.tagID?this.parseColGroup(a,b):g_objCodeDefine.ID_TAG_TBODY==a.tagID||g_objCodeDefine.ID_TAG_TFOOT==a.tagID||g_objCodeDefine.ID_TAG_THEAD==a.tagID?this.parseRowGroup(a,b):this.parseTag(a,b)):g_objCodeLexer.NODE_TYPE_START_END==a.type?this.insertNodeAtEnd(c,
a):g_objCodeLexer.NODE_TYPE_TEXT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_COMMENT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type&&this.insertNodeAtEnd(c,a)}}catch(e){dalert(e)}};this.parseEmpty=function(c,b){try{var a=g_objCodeLexer.getToken(b);a&&(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type?c.closed=!0:g_objCodeLexer.ungetToken(b))}catch(d){dalert(d)}};
this.parseScriptStyle=function(c,b){try{var a=g_objCodeLexer.getCDATAToken(c.tagID,b);a&&(this.insertNodeAtEnd(c,a),a=g_objCodeLexer.getToken(b))&&(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type?c.closed=!0:g_objCodeLexer.ungetToken(b))}catch(d){dalert(d)}};this.parseColGroup=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_TEXT==
a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_END!=a.type&&(g_objCodeLexer.NODE_TYPE_START==a.type||g_objCodeLexer.NODE_TYPE_START_END==a.type))if(g_objCodeDefine.ID_TAG_COL==a.tagID)this.insertNodeAtEnd(c,a);else{g_objCodeLexer.ungetToken(b);break}}}catch(d){dalert(d)}};this.parseRowGroup=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID){if(g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}g_objCodeLexer.ungetToken(b);break}if(g_objCodeDefine.ID_TAG_TABLE==
a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){g_objCodeLexer.ungetToken(b);break}if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_TEXT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_END!=a.type){if((g_objCodeLexer.NODE_TYPE_START==a.type||g_objCodeLexer.NODE_TYPE_START_END==a.type)&&g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_ROWGRP)){g_objCodeLexer.ungetToken(b);break}this.insertNodeAtEnd(c,a);this.parseTag(a,b)}}}catch(d){dalert(d)}};
this.insertNodeAtEnd=function(c,b){try{b.parent=c,null!=c.last?c.last.next=b:c.content=b,c.last=b}catch(a){dalert(a)}}};

var g_objCodePrint=new function(){this.printTree=function(a,b,c){try{if(null!=a)if(g_objCodeLexer.NODE_TYPE_ROOT==a.type)for(var d=a.content;null!=d;d=d.next)this.printTree(d,b,c);else if(g_objCodeLexer.NODE_TYPE_TEXT==a.type)this.printText(a,c);else if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.printComment(a,c);else if(g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type)this.printXMLDeclareStartTag(a,c);else if(g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type)this.printXMLDeclareStartEndTag(a,
c);else if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY))g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)||this.addLineString(b-1,c),this.printStartEndTag(a,c),null!=a.next&&(g_objCodeDefine.ID_TAG_PARAM==a.tagID||g_objCodeDefine.ID_TAG_AREA==a.tagID?this.addLineString(b,c):(g_objCodeDefine.ID_TAG_BR==a.tagID||g_objCodeDefine.ID_TAG_HR==a.tagID)&&this.addLineString(b,c));else if(g_objCodeDefine.ID_TAG_LISTING==a.tagID||g_objCodeDefine.ID_TAG_PLAINTEXT==a.tagID||g_objCodeDefine.ID_TAG_PRE==
a.tagID||g_objCodeDefine.ID_TAG_XMP==a.tagID||g_objCodeDefine.ID_TAG_TEXTAREA==a.tagID){this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c);this.addLineString(b,c)}else if(g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID){this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c);this.addLineString(b,c)}else if(g_objCodeDefine.ID_TAG_UNKNOWN==
a.tagID&&"embed"==a.tagName)this.printStartEndTag(a,c);else if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)){this.printStartTag(a,c);if(g_objCodeDefine.ID_TAG_OBJECT==a.tagID){var e=[];for(d=a.content;null!=d;d=d.next)if(g_objCodeDefine.ID_TAG_PARAM==d.tagID){var f=this.getParamAttributeNameValue(d,c);this.addArrayParamAttributeNameValue(e,f)||this.printTree(d,b,c)}else this.printTree(d,b,c)}else for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c)}else{e=b;this.checkTabApply(a,
c)&&e++;this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,e,c);this.checkTabApply(a,c)&&this.addLineString(b,c);this.printEndTag(a,c);this.addLineString(b,c)}}catch(g){dalert(g)}};this.isWhite=function(a){try{for(var b="",c=0,d=a.length;c<d;c++)if(b=a.charCodeAt(c),10!==b&&13!==b&&32!==b&&9!==b)return!1;return!0}catch(e){dalert(e)}return!1};this.nodeHasCMBlockContent=function(a){try{for(var b=a.content;null!=b;b=b.next){a=b;var c=g_objCodeDefine;var d=
c.nodeHasCM(a,c.CM_INLINE)?!1:c.nodeHasCM(a,c.CM_BLOCK)||c.nodeHasCM(a,c.CM_TABLE)||c.nodeHasCM(a,c.CM_HEAD)||c.nodeHasCM(a,c.CM_ROWGRP)||c.nodeHasCM(a,c.CM_ROW)||c.nodeHasCM(a,c.CM_LIST)?!0:void 0;if(d)return!0}return!1}catch(e){dalert(e)}};this.printText=function(a,b){try{var c=b.stDocStreamIn.htmlCode.substring(a.textStartPos,a.textEndPos+1);this.isWhite(c)&&this.nodeHasCMBlockContent(a.parent)||(b.stDocStreamOut.lineBuffer+=c)}catch(d){dalert(d)}};this.printComment=function(a,b){try{b.stDocStreamOut.lineBuffer+=
"\x3c!--",b.stDocStreamOut.lineBuffer+=b.stDocStreamIn.htmlCode.substring(a.textStartPos,a.textEndPos+1),b.stDocStreamOut.lineBuffer+="--\x3e"}catch(c){dalert(c)}};this.printStartTag=function(a,b){try{if(a.print&&(g_objCodeDefine.ID_TAG_P!=a.tagID||!b.stDocStreamOut.convertPTagToBrTag||null!=a.arrAttribute)){b.stDocStreamOut.lineBuffer+="<"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=">"}}catch(d){dalert(d)}};
this.getParamAttributeNameValue=function(a,b){try{if(g_objCodeDefine.ID_TAG_PARAM!=a.tagID||null==a.arrAttribute)return null;for(var c=0;c<a.arrAttribute.length;c++){var d=a.arrAttribute[c];if(g_objCodeDefine.ID_ATTR_NAME==d.attributeID){var e=b.stDocStreamIn.htmlCode.substring(d.attributeStartPos,d.attributeEndPos+1);return e=e.toLowerCase()}}}catch(f){dalert(f)}return null};this.addArrayParamAttributeNameValue=function(a,b){try{for(var c=0;c<a.length;c++)if(a[c]==b)return!0;a[a.length]=b}catch(d){dalert(d)}return!1};
this.printStartEndTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" />"}}catch(d){dalert(d)}};this.printEndTag=function(a,b){try{a.print&&(g_objCodeDefine.ID_TAG_P==a.tagID&&b.stDocStreamOut.convertPTagToBrTag&&null==a.arrAttribute?-1==b.stDocStreamOut.lineBuffer.indexOf("<br />")&&(b.stDocStreamOut.lineBuffer+="<br",b.stDocStreamOut.lineBuffer+=
" />"):b.stDocStreamOut.lineBuffer+="</"+a.tagName+">")}catch(c){dalert(c)}};this.printAttribute=function(a,b,c){try{if(null!=b){var d=null==b.delimiter?'"':b.delimiter,e="";-1!=b.attributeStartPos&&(g_objCodeDefine.ID_ATTR_UNKNOWN==b.attributeID?e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1):g_objCodeDefine.ID_TAG_IMG==a.tagID&&g_objCodeDefine.ID_ATTR_SRC==b.attributeID&&null!=c.stDocStreamOut.imgSrcRemoveDomain?e=this.getAttributeValueByRemoveDomain(c,b):g_objCodeDefine.ID_TAG_A==
a.tagID&&g_objCodeDefine.ID_ATTR_HREF==b.attributeID&&null!=c.stDocStreamOut.imgSrcRemoveDomain&&1==c.stDocStreamOut.anchorHrefRemoveDomainYN?e=this.getAttributeValueByRemoveDomain(c,b):g_objCodeDefine.ID_TAG_TD==a.tagID&&g_objCodeDefine.ID_ATTR_VALIGN==b.attributeID?(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase(),"center"==e&&(e="middle")):g_objCodeDefine.ID_ATTR_STYLE==b.attributeID?c.bStyleAttribute?e=this.printStyleAttribute(b.arrStyleAttribute):(e=
c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase(),-1!=e.indexOf("background")&&(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1))):e=g_objCodeDefine.getAttrDefineOption(b.attributeID)?c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase():c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1));c.stDocStreamOut.lineBuffer+=" "+b.attributeName+"="+d+e+d}}catch(f){dalert(f)}};
this.printStyleAttribute=function(a){try{if(null==a)return"";for(var b="",c=0;c<a.length;c++){var d=a[c];if(null!=d){var e=d.styleValue.trim();if(!(0<=d.styleName.indexOf("background")||0<=d.styleName.indexOf("background-image"))&&(e=e.toLowerCase(),"border-image"==d.styleName&&"none"==e))continue;b+=d.styleName+":"+e+";"}}return b}catch(f){dalert(f)}return""};this.printXMLDeclareStartTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<?"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<
a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" ?>"}}catch(d){dalert(d)}};this.printXMLDeclareStartEndTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<?"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" />"}}catch(d){dalert(d)}};this.addLineString=function(a,b){try{0<b.stDocStreamOut.lineBuffer.length&&(b.stDocStreamOut.lineString[b.stDocStreamOut.lineString.length]=
this.getTabString(a)+b.stDocStreamOut.lineBuffer,b.stDocStreamOut.lineBuffer="")}catch(c){dalert(c)}};this.checkTabApply=function(a,b){try{if(!b.stDocStreamOut.tabApply||g_objCodeDefine.ID_TAG_UNKNOWN==a.tagID||g_objCodeDefine.ID_TAG_HTML==a.tagID||g_objCodeDefine.ID_TAG_TITLE==a.tagID||g_objCodeDefine.ID_TAG_P==a.tagID||g_objCodeDefine.ID_TAG_TEXTAREA==a.tagID||g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_HEADING))return!1;if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_FIELD|g_objCodeDefine.CM_OBJECT)||
g_objCodeDefine.ID_TAG_MAP==a.tagID)return!0;if(null!=a.content&&g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_NO_INDENT)){for(a=a.content;null!=a;a=a.next)if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_BLOCK))return!0;return!1}return!g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)&&null!=a.content}catch(c){dalert(c)}return!1};this.getTabString=function(a){try{if(0>=a)return"";for(var b="",c=0;c<a;c++)b+="\t";return b}catch(d){dalert(d)}return""};this.getAttributeValueByRemoveDomain=function(a,
b){try{var c=a.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1),d=c.toLowerCase();for(b=0;b<a.stDocStreamOut.imgSrcRemoveDomain.length;b++)if(0==d.indexOf(a.stDocStreamOut.imgSrcRemoveDomain[b])){var e=d.length,f=a.stDocStreamOut.imgSrcRemoveDomain[b].length;if(f<=e&&"/"==d.charAt(f)){c=c.substring(f,e);break}}return c}catch(g){dalert(g)}return""}};

var g_objCssParser=new function(){this.LEX_START_CSS=11;this.LEX_CSS_COMMENT=12;this.initCssParserStruct=function(b){try{var a={stDocRoot:null,stDocStreamIn:null,stDocStreamOut:null,stDocLexer:null};a.stDocStreamIn=g_objCodeStream.initStreamIn(b);if(!a.stDocStreamIn)return null;a.stDocStreamOut=g_objCodeStream.initStreamOut();if(!a.stDocStreamOut)return null;a.stDocLexer=this.initCssLexer();if(!a.stDocLexer)return null;a.stDocRoot=this.newCssNode(a);a.stDocRoot.type=g_objCodeLexer.NODE_TYPE_ROOT;
return a}catch(c){dalert(c)}return null};this.initCssLexer=function(){try{var b={};b.state=g_objCodeLexer.LEX_CONTENT;b.sequence=-1;b.rowCssClassName="";b.rowCssClassContent="";b.token=null;return b}catch(a){dalert(a)}return null};this.newCssNode=function(b){try{var a={};a.sequence=b.stDocLexer.sequence++;a.type=g_objCodeLexer.NODE_TYPE_TEXT;a.arrCssClassName=null;a.arrCssClassAttribute=null;a.parent=null;a.next=null;a.content=null;a.last=null;return a}catch(c){dalert(c)}return null};this.parseCss=
function(b,a){try{for(var c;null!=(c=this.getCssToken(a));)g_objCodeLexer.NODE_TYPE_TEXT==c.type&&g_objCodeParser.insertNodeAtEnd(b,c)}catch(e){dalert(e)}};this.getCssToken=function(b){try{b.stDocLexer.rowCssClassName="";b.stDocLexer.rowCssClassContent="";for(var a=null;null!=(a=g_objCodeStream.readChar(b));)switch(b.stDocLexer.state){case g_objCodeLexer.LEX_CONTENT:if(this.isCheckWhite_Plus_Space(a))continue;if("<"==a){null!=(a=g_objCodeStream.readChar(b))&&("!"==a?null!=(a=g_objCodeStream.readChar(b))&&
("-"==a?null!=(a=g_objCodeStream.readChar(b))&&"-"!=a&&g_objCodeStream.ungetChar(b):g_objCodeStream.ungetChar(b)):g_objCodeStream.ungetChar(b));continue}if("/"==a){null!=(a=g_objCodeStream.readChar(b))&&("*"==a?null!=(a=g_objCodeStream.readChar(b))&&(b.stDocLexer.state=this.LEX_CSS_COMMENT):g_objCodeStream.ungetChar(b));continue}if("{"==a){b.stDocLexer.state=this.LEX_START_CSS;continue}else b.stDocLexer.rowCssClassName+=a;continue;case this.LEX_START_CSS:if("}"!=a)b.stDocLexer.rowCssClassContent+=
a;else return b.stDocLexer.token=this.newCssNode(b),b.stDocLexer.token.type=g_objCodeLexer.NODE_TYPE_TEXT,b.stDocLexer.token.arrCssClassName=this.getCssClassName(b.stDocLexer.rowCssClassName),b.stDocLexer.token.arrCssClassAttribute=this.getCssClassAttribute(b.stDocLexer.rowCssClassContent),b.stDocLexer.state=g_objCodeLexer.LEX_CONTENT,b.stDocLexer.token;continue;case this.LEX_CSS_COMMENT:if("*"==a&&null!=(a=g_objCodeStream.readChar(b))){if("/"==a)return b.stDocLexer.token=this.newCssNode(b),b.stDocLexer.token.type=
g_objCodeLexer.NODE_TYPE_COMMENT,b.stDocLexer.token.arrCssClassName=null,b.stDocLexer.token.arrCssClassAttribute=null,b.stDocLexer.state=g_objCodeLexer.LEX_CONTENT,b.stDocLexer.token;g_objCodeStream.ungetChar(b)}}}catch(c){dalert(c)}return null};this.getCssClassName=function(b){try{for(var a=[],c="",e=0;e<b.length;e++){var f=b.charAt(e);this.isCheckWhite_Plus_Space(f)||(","==f?(a.push(c),c=""):c+=f)}""!=c&&a.push(c);return a}catch(g){dalert(g)}return""};this.getCssClassAttribute=function(b){try{for(var a=
[],c=!1,e="",f="",g=!1,h=0;h<b.length;h++){var d=b.charAt(h);if(null==d)break;if(c){if(this.isCheckWhite(d))continue}else if(this.isCheckWhite_Plus_Space(d))continue;if('"'==d||"'"==d)g=g?!1:!0;":"==d?g?c?f+=d:e+=d:c=!0:";"==d?g?c?f+=d:e+=d:(c=!1,a[a.length]=g_objCodeLexer.addStyleAttribute(null,e,f),f=e=""):c?f+=d:e+=d}c&&(a[a.length]=g_objCodeLexer.addStyleAttribute(null,e,f));return a}catch(k){dalert(k)}return null};this.isCheckWhite=function(b){try{var a=b.charCodeAt(0);if(9==a||10==a||13==a)return!0}catch(c){dalert(c)}return!1};
this.isCheckWhite_Plus_Space=function(b){try{var a=b.charCodeAt(0);if(9==a||10==a||13==a||32==a)return!0}catch(c){dalert(c)}return!1}};

var g_strEditObjectName="dzeditor",g_strEditObjectSourceName="dzeditorSource",g_strEditContainerName="dzeditorContainer",g_strEditSourceContainerName="dzeditorSourceContainer",g_bInitWebEditor=!1,g_objEditObject=[],g_objEditWindow=[],g_objEditorDocument=[],g_bModified=!1,g_objParent_EditObject=[],g_nActiveEditNumber=0,g_bLoadContentHTMLCode=!0,g_nLoadContentEditNumber=[],g_bLoadContentEncode=[],g_strLoadContentHTMLCode=[];function returnTrue(){return!0}function returnFalse(){return!1}
var g_nDomainAccessViolationCount=0;g_browserCHK.ie?document.attachEvent?document.attachEvent("onreadystatechange",fnLoadingEventFired):window.addEventListener("DOMContentLoaded",fnLoadingEventFired,!0):window.addEventListener("DOMContentLoaded",fnLoadingEventFired,!0);
function fnLoadingEventFired(){try{g_bBrowserType_IE?document.attachEvent?"complete"==document.readyState&&fnLoadEditor():"complete"==document.readyState?fnLoadEditor():window.setTimeout("fnLoadingEventFired()",100):fnLoadEditor()}catch(a){}}function fnLoadEditor(){try{g_bInitWebEditor||(g_bInitWebEditor=!0,initWebEditor(),window_onload())}catch(a){}}function window_onload(){g_bBrowserType_IE||(window.setTimeout("fnSubInitializeLayer()",100),window.setTimeout("initializeLastSetting()",500))}
function initWebEditor(){try{setBuildEditorArea();setInitConst();getDocumentType();setCustomVariable();setCustomDisplay();setSkinToolBar();g_objObjectSelectionInfo=new initSelectionObjectInfo;if(g_bBrowserType_IE){var a=!1,b;for(b in g_arrEditorAreaContainer)initEditAreaContainer(document.getElementById(g_arrEditorAreaContainer[b]),b);for(b in g_arrEditorAreaContainer)try{if(!fnSetEditObject(b))return}catch(c){a=!0}if(a){window.setTimeout("initWebEditor_Domain()",500);return}}else for(b in g_arrEditorAreaContainer)if(initEditAreaContainer(document.getElementById(g_arrEditorAreaContainer[b]),
b),!fnSetEditObject(b))return;for(b in g_arrEditorAreaContainer){if(!fnSetEditorMode(b))return;try{var d=parseInt(b)+parseInt(DZE_IFRAME_TMP_NO);fnSetEditorMode(d)}catch(c){}}fnInitialize();if(!g_bLoadContentHTMLCode)for(b=0;b<g_nLoadContentEditNumber.length;b++)retrySetEditorHTMLCode(g_strLoadContentHTMLCode[b],g_bLoadContentEncode[b],g_nLoadContentEditNumber[b]);g_bBrowserType_IE&&(window.setTimeout("fnSubInitializeLayer()",100),window.setTimeout("initializeLastSetting()",500));duzon_menubar.rebuildHiddenToolbar()}catch(c){dalert(c)}}
function initWebEditor_Domain(){try{if(g_bBrowserType_IE&&!(5<g_nDomainAccessViolationCount)){var a=!1,b;for(b in g_arrEditorAreaContainer)try{if(!fnSetEditObject(b))return}catch(d){a=!0}if(a)g_nDomainAccessViolationCount++,window.setTimeout("initWebEditor_Domain()",1E3);else{for(b in g_arrEditorAreaContainer)if(!fnSetEditorMode(b))return;fnInitialize();if(!g_bLoadContentHTMLCode)for(b=0;b<g_nLoadContentEditNumber.length;b++)retrySetEditorHTMLCode(g_strLoadContentHTMLCode[b],g_bLoadContentEncode[b],
g_nLoadContentEditNumber[b]);window.setTimeout("fnSubInitializeLayer()",100);window.setTimeout("initializeLastSetting()",500);duzon_menubar.rebuildHiddenToolbar()}}}catch(d){dalert(d)}}
function setBuildEditorArea(){for(var a=document.getElementsByTagName("div"),b=0,d=-1,c=0;c<a.length;c++)a[c].getAttribute("dzeditor")&&"true"==a[c].getAttribute("dzeditor")&&(d++,dzeEnvConfig.iFrameLayer?(null!=window.frameElement.getAttribute("dzeditor_no")?b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10):window.frameElement.setAttribute("dzeditor_no",b),a[c].id="DZEDITOR_CONTAINER_"+b,a[c].setAttribute("dzeload","true"),g_arrEditorAreaContainer[b]=a[c].id):(a[c].getAttribute("id")||
(a[c].id="DZEDITOR_CONTAINER_"+d),a[c].setAttribute("dzeload","true"),g_arrEditorAreaContainer.push(a[c].id)))}function setCustomVariable(){for(var a in g_arrEditorAreaContainer)g_arrEditorWidth[a]=dzeUiConfig.nEditorWidth,g_arrEditorHeight[a]=dzeUiConfig.nEditorHeight}
function fnSetEditObject(a){var b=parseInt(a,10)+DZE_IFRAME_TMP_NO;return g_bBrowserType_IE?(eval("g_objEditWindow["+a+"] = "+g_strEditObjectName+"_"+a),g_objEditorDocument[a]=g_objEditWindow[a].document,g_objEditObject[a]=document.getElementById(g_strEditObjectName+"_"+a),g_objParent_EditObject[a]=document.getElementById(g_strEditObjectName+"_Parent_"+a),eval("g_objEditWindow["+b+"] = "+g_strEditObjectName+"_"+b),g_objEditorDocument[b]=g_objEditWindow[b].document,g_objEditObject[b]=document.getElementById(g_strEditObjectName+
"_"+b),g_objParent_EditObject[b]=document.getElementById(g_strEditObjectName+"_Parent_"+b),!0):g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP?(g_objEditWindow[a]=document.getElementById(g_strEditObjectName+"_"+a).contentWindow,g_objEditorDocument[a]=document.getElementById(g_strEditObjectName+"_"+a).contentDocument,g_objEditObject[a]=document.getElementById(g_strEditObjectName+"_"+a),g_objParent_EditObject[a]=document.getElementById(g_strEditObjectName+"_Parent_"+a),g_objEditWindow[b]=document.getElementById(g_strEditObjectName+
"_"+b).contentWindow,g_objEditorDocument[b]=document.getElementById(g_strEditObjectName+"_"+b).contentDocument,g_objEditObject[b]=document.getElementById(g_strEditObjectName+"_"+b),g_objParent_EditObject[b]=document.getElementById(g_strEditObjectName+"_Parent_"+b),!0):!1}
function fnSetEditorMode(a){var b="",d="";g_bEnableEditHorizontalScroll||(b+="overflow-x:hidden;word-wrap:break-word;");!0===dzeUiConfig.bSetCustomEditorBodyMargin&&"undefined"!=typeof dzeUiConfig.nCustomEditorBodyMarginValues&&4==dzeUiConfig.nCustomEditorBodyMarginValues.length&&(b+="margin-top:"+dzeUiConfig.nCustomEditorBodyMarginValues[0]+"px;",b+="margin-bottom:"+dzeUiConfig.nCustomEditorBodyMarginValues[1]+"px;",b+="margin-left:"+dzeUiConfig.nCustomEditorBodyMarginValues[2]+"px;",b+="margin-right:"+
dzeUiConfig.nCustomEditorBodyMarginValues[3]+"px;");"undefined"!=typeof dzeUiConfig.nEditModeAreaWidth&&null!=dzeUiConfig.nEditModeAreaWidth&&""!=dzeUiConfig.nEditModeAreaWidth&&(b+="background-color:#ffffff;");if(g_bBrowserType_IE){var c="";c=3==g_nFormEditMode?c+"<!DOCTYPE html>":c+"<html>";c=c+"<head>"+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"customer_editwin.css'>");g_bAutoIncludeParentCSS&&(c+=getParentCSS());for(var e=0;e<g_arrAdditionalEditAreaCSS.length;e++)c+="<link rel='stylesheet' href='"+
g_arrAdditionalEditAreaCSS[e]+"'>";""!=g_strAdditionalHeadContent&&(c+=g_strAdditionalHeadContent);d=g_bAutoIncludeParentCSS?dzeEnvConfig.strPath_CSS+"editor_style_inherit.css":dzeEnvConfig.strPath_CSS+"editor_style.css";c=c+("<link rel='stylesheet' href='"+d+"'>")+"<style>html {overflow: auto}";""!=g_strBodyFontFamily&&(c+="body, td, th {font-family:"+g_strBodyFontFamily+"}");""!=g_strBodyFontSize&&(c+="body, td, th {font-size:"+g_strBodyFontSize+"}");""!=g_strBodyFontColor&&(c+="body, td, th {color:"+
g_strBodyFontColor+"}");""!=g_strBodyLineHeight&&(c+="body, td, th {line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(c+="body, td, th {letter-spacing:"+g_strBodyLetterSpacing+"}");c=c+"</style><style type='text/css' id='dze_selections' selection_color=''></style></head>"+("<body spellcheck='false' style='"+b+"'>");c=window.attachEvent?c+"<p></p>":c+"<p><br/></p>";c+="</body></html>";g_objEditorDocument[a].open();g_objEditorDocument[a].write(c);g_objEditorDocument[a].close();if(0==
g_nFormEditMode||1==g_nFormEditMode)g_objEditorDocument[a].body.contentEditable=!0}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){c="";c=3==g_nFormEditMode?c+"<!DOCTYPE html>":c+"<html>";c=c+"<head>"+("<link rel='stylesheet' href='"+dzeEnvConfig.strPath_CSS+"customer_editwin.css'>");g_bAutoIncludeParentCSS&&(c+=getParentCSS());for(e=0;e<g_arrAdditionalEditAreaCSS.length;e++)c+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[e]+"'>";""!=g_strAdditionalHeadContent&&(c+=
g_strAdditionalHeadContent);d=g_bAutoIncludeParentCSS?dzeEnvConfig.strPath_CSS+"editor_style_inherit.css":dzeEnvConfig.strPath_CSS+"editor_style.css";c=c+("<link rel='stylesheet' href='"+d+"'>")+"<style>h1, h2, h3, h4, h5, dl, dt, dd, ul, li, ol, th, td, p, blockquote,form, fieldset, legend, div,body, table tbody td, table th{ -webkit-print-color-adjust:exact;}html {overflow: auto}";""!=g_strBodyFontFamily&&(c+="body, td, th {font-family:"+g_strBodyFontFamily+"}");""!=g_strBodyFontSize&&(c+="body, td, th {font-size:"+
g_strBodyFontSize+"}");""!=g_strBodyFontColor&&(c+="body, td, th {color:"+g_strBodyFontColor+"}");""!=g_strBodyLineHeight&&(c+="body, td, th {line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(c+="body, td, th {letter-spacing:"+g_strBodyLetterSpacing+"}");c=c+"</style><style type='text/css' id='dze_selections' selection_color=''></style></head>"+("<body spellcheck='false' style='"+b+"'>")+"<p><br/></p>";c+="</body>";c+="</html>";g_objEditorDocument[a].open();g_objEditorDocument[a].write(c);
g_objEditorDocument[a].close();if(0==g_nFormEditMode||1==g_nFormEditMode)g_objEditorDocument[a].body.contentEditable=!0}else return!1;d&&("break-all"==dzeUiConfig.strEditorStyleBodyWordBreak||"keep-all"==dzeUiConfig.strEditorStyleBodyWordBreak)&&(b=g_objEditorDocument[a].querySelector("link[href='"+d+"']"))&&(b.onload=function(){changeCss("body","word-break",dzeUiConfig.strEditorStyleBodyWordBreak,g_objEditorDocument[a],d)});return!0}
function initToolbar(a){try{g_arrForceCancelBubbleMouseDown[a]=!1}catch(b){}TBInitContainer(document.getElementById("TB_CONTAINER_"+a));g_bTabBar_Display&&TBInitContainer(document.getElementById("TB_TABMODE_CONTAINER_"+a));g_bMenuBar_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_MENU_"+a));g_bToolBar1_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_1_"+a));g_bToolBar2_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_2_"+a));g_bToolBar3_Display&&
TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_3_"+a));g_bTabBar_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TABMODE_"+a));g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_FILE_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_EDIT_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_VIEW_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_INSERT_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_BASIC_"+
a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_TABLE_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_HELP_"+a),a);g_bToolBar1_Display&&TBSetToolButton(g_arrToolbar1,a);g_bToolBar2_Display&&TBSetToolButton(g_arrToolbar2,a);g_bToolBar3_Display&&TBSetToolButton(g_arrToolbar3,a);g_bTabBar_Display&&(g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_PREVIEW_"+a),ID_TB_TABMODE_PREVIEW,ID_STRING_NAME_UNCHECKED,a),g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&
TBInitTabModeButton(document.getElementById("TB_TABMODE_EDIT_"+a),ID_TB_TABMODE_EDIT,ID_STRING_NAME_CHECKED,a),g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_SOURCE_"+a),ID_TB_TABMODE_SOURCE,ID_STRING_NAME_UNCHECKED,a));g_bBottomResizeYN&&TBInitContainerBottomResize(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+a),a);dzeUiConfig.bCustomBottomResizeBtnYN&&TBInitContainerBottomResizeBtn(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+
a),a)}function initBranchEvent(a){updateTableHandlerUI.updateTableUIHandler(0,0,0,0,a);initEditorEvent(a)}
function fnInitialize(){try{for(var a in g_arrEditorAreaContainer)setInitUpdateVariable(a),initEditSetContainer(document.getElementById("EDIT_SET_CONTAINER_"+a),a),initToolbar(a),initBranchEvent(a),setEditorContainerOutline(a),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,dzeUiConfig.nEditorHeight),!0===dzeUiConfig.bUseUiMode&&dze_menu_control.initialize(a),attachMouseDragDropEvent(a);initGlobalEvent();window.setTimeout("initializeAnotherOption()",300)}catch(b){}}
function fnSubInitializeLayer(){try{g_objCodeDefine.initTagDefine();if(0==g_nFormEditMode||1==g_nFormEditMode||3==g_nFormEditMode)if(g_bEditFocusYN){var a=0,b=-1,d;for(d in g_arrEditorAreaContainer)0==a&&(b=d),0<d&&window.setTimeout("editor_ondeactivate("+d+")",100),a++;0==b&&(g_bBrowserType_WK||g_bBrowserType_OP?(g_arrOnFocus_FF_WK[0]=!0,window.setTimeout("setEditModeFocus(0)",100)):(g_bBrowserType_FF&&(g_arrOnFocus_FF_WK[0]=!0,editor_onselectionchange(0)),setFirstEditWindowFocus(),g_bBrowserType_IE&&
editor_onselectionchange(0)))}else for(d in g_arrEditorAreaContainer)editor_ondeactivate(d);else if(2==g_nFormEditMode)for(d in g_arrEditorAreaContainer)(function(){var a=d;window.setTimeout(function(){editor_ondeactivate(a)},100)})();window.setTimeout(function(){g_objWrapperOutlineUtil.initializeExtOutline(!1)},200);if(2!=g_nFormEditMode)for(d in g_arrEditorAreaContainer)g_objUndoRedo.registerInitialContentStack(d)}catch(c){dalert(c)}}
function setFirstEditWindowFocus(){try{window.attachEvent?g_objEditWindow[0].focus():g_objEditorDocument[0].body.focus()}catch(a){}}
function initializeAnotherOption(){try{if(!g_bEditSourceMode)for(var a in g_arrEditorAreaContainer)fnTool_TabMode_Main(ID_TB_TABMODE_SOURCE,a);for(a in g_arrEditorAreaContainer){var b=document.getElementById("TB_SETFORECOLOR_"+a+"_SUB");""!=g_strBodyFontColor?duzon_dialog.selectColorCode(g_strBodyFontColor,b,a):duzon_dialog.selectColorCode("#000000",b,a);var d=document.getElementById("TB_SETBACKCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#FFFFFF",d,a);var c=document.getElementById("TB_SETCELLBACKCOLOR_"+
a+"_SUB");duzon_dialog.selectColorCode("",c,a);var e=document.getElementById("TB_SETIMAGEBORDERCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",e,a);var f=document.getElementById("TB_SETTABLEBORDERCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",f,a)}}catch(g){}}
function initializeLastSetting(){try{if(g_bBrowserType_IE&&9>=g_bBrowserVerInfo)for(var a in g_arrEditorAreaContainer)0!=g_objParent_EditObject[a].clientHeight&&(g_objEditorDocument[a].body.style.height=g_objParent_EditObject[a].clientHeight-10+"px");if(dzeEnvConfig.iFrameLayer){var b=g_objLayerKit.getLayerDocument();g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"menuwin.css",function(){g_objPropertyUtil.setSkinColorSet(b)});g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+
"proplayer.css");g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"webeditor.css");g_objInsertUtil.dynamicLoad_JS(b,dzeEnvConfig.strPath_JS+"dze_iframe_function.js")}addParentScrollEvent();if(""!=dzeUiConfig.strLoadingDoneFunction)for(a in g_arrEditorAreaContainer)try{eval(dzeUiConfig.strLoadingDoneFunction+"("+a+");")}catch(c){}if("undefined"!=typeof dzeUiConfig.nEditModeAreaWidth&&null!=dzeUiConfig.nEditModeAreaWidth&&""!=dzeUiConfig.nEditModeAreaWidth){var d=Number(dzeUiConfig.nEditModeAreaWidth);
for(a in g_arrEditorAreaContainer)g_objEditMode.setEditModeAreaWidth(d,a)}if(g_bEditFocusYN)for(a in g_arrEditorAreaContainer)initializeDocFocus(a);for(a in g_arrEditorAreaContainer)g_objUndoRedo.registerInitialContentStack(a)}catch(c){dalert(c)}}
function getParentCSS(){try{for(var a="",b=document.getElementsByTagName("link"),d=0;d<b.length;d++)if("stylesheet"==b[d].rel.toLowerCase()){var c=!0,e=b[d].href;-1!=e.indexOf(dzeEnvConfig.strPath_CSS)&&(c=!1);c&&getParentCSS_is_arrAdditionalEditAreaCSS(e)&&(c=!1);c&&(a+='<link rel="stylesheet" type="text/css" href="'+e+'" />')}return a}catch(f){}return""}
function getParentCSS_is_arrAdditionalEditAreaCSS(a){try{for(var b=0;b<g_arrAdditionalEditAreaCSS.length;b++)if(-1!=a.indexOf(g_arrAdditionalEditAreaCSS[b]))return!0}catch(d){}return!1}function getModified(a){try{if("undefined"===typeof a&&(a=g_nActiveEditNumber),!1!==g_bModified&&0<g_objUndoRedo.arrUndoRedoStruct[a].nUndoRedoStackPos)return!0}catch(b){}return!1};

var shortcutsMenuList=[];shortcutsMenuList[ID_COMMAND_FILE_NEW]="Alt+N";shortcutsMenuList[ID_COMMAND_FILE_OPEN]="Alt+O";shortcutsMenuList[ID_COMMAND_SAVEAS]="Alt+S";shortcutsMenuList[ID_COMMAND_PRINT]="Alt+P";shortcutsMenuList[ID_COMMAND_UNDO]="Ctrl+Z";shortcutsMenuList[ID_COMMAND_REDO]="Ctrl+Shift+Z";shortcutsMenuList[ID_COMMAND_CUT]="Ctrl+X";shortcutsMenuList[ID_COMMAND_COPY]="Ctrl+C";shortcutsMenuList[ID_COMMAND_PASTE]="Ctrl+V";shortcutsMenuList[ID_COMMAND_EDIT_PASTESPECIAL]="Ctrl+Alt+V";
shortcutsMenuList[ID_COMMAND_DELETE]="Ctrl+E";shortcutsMenuList[ID_COMMAND_SELECT_ALL]="Ctrl+A";shortcutsMenuList[ID_COMMAND_EDIT_SEARCH]="Ctrl+F";shortcutsMenuList[ID_COMMAND_EDIT_REPLACE]="Ctrl+H";shortcutsMenuList[ID_COMMAND_INSERT_SPECIALCHARS]="Ctrl+F10";shortcutsMenuList[ID_COMMAND_INSERT_BOOKMARK]="Ctrl+K,B";shortcutsMenuList[ID_COMMAND_HYPERLINK_INSERT]="Ctrl+K,H";shortcutsMenuList[ID_COMMAND_STYLE_FONT]="Alt+L";shortcutsMenuList[ID_COMMAND_STYLE_PARAGRAPH]="Alt+W";
shortcutsMenuList[ID_COMMAND_STYLE_ORDEREDLIST]="Ctrl+Shift+[";shortcutsMenuList[ID_COMMAND_STYLE_UNORDEREDLIST]="Ctrl+Shift+]";shortcutsMenuList[ID_COMMAND_STYLE_INCREASE_FONTSIZE]="Alt+Shift+E";shortcutsMenuList[ID_COMMAND_STYLE_DECREASE_FONTSIZE]="Alt+Shift+R";shortcutsMenuList[ID_COMMAND_STYLE_INCREASEORDER]="Ctrl+Shift+\u2190";shortcutsMenuList[ID_COMMAND_STYLE_DECREASEORDER]="Ctrl+Shift+\u2192";shortcutsMenuList[ID_COMMAND_TABLE_ADD_ROW_COL]="Alt+Insert";
shortcutsMenuList[ID_COMMAND_TABLE_DELETE_ROW]="Ctrl+BackSpace";shortcutsMenuList[ID_COMMAND_TABLE_DELETE_COL]="Alt+Shift+Delete";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_SUM]="Ctrl+Shift+H";shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_SUM]="Ctrl+Shift+V";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_AVERAGE]="Ctrl+Shift+J";shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_AVERAGE]="Ctrl+Shift+B";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY]="Ctrl+Shift+K";
shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_MULTIPLY]="Ctrl+Shift+G";shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_HEIGHT]="Ctrl+Alt+H";shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_WIDTH]="Ctrl+Alt+W";shortcutsMenuList[ID_COMMAND_TABLE_MERGE_CELL]="Ctrl+Alt+M";shortcutsMenuList[ID_COMMAND_TABLE_SPLIT_CELL]="Ctrl+Alt+S";
var DZESHORTCUT={nEditNumber:-1,evnt:null,keyCodeArray:[],isPressedKeyMapForOS:function(a,b){try{if(!1===g_browserCHK.isMacPC())switch(b){case ID_KEYCODE_CTRL:if(a.ctrlKey)return!0;break;case ID_KEYCODE_ALT:if(a.altKey)return!0}else switch(b){case ID_KEYCODE_CTRL:if(a.metaKey)return!0;break;case ID_KEYCODE_ALT:if(a.altKey)return!0}return!1}catch(c){}},setKeyCodeArray:function(a){inArray(a,this.keyCodeArray)||this.keyCodeArray.push(a)},clearKeyCodeArray:function(){this.keyCodeArray=[]},checkMatchMultiAlphaKeyCode:function(a){for(var b=
0,c=0;c<this.keyCodeArray.length;c++)for(var d=0;d<a.length;d++)a[d]==this.keyCodeArray[c]&&d==c&&b++;return b==a.length?!0:!1},construct:function(a,b){this.nEditNumber=b;this.evnt=a},setDzeShortCutEvent:function(a,b){this.construct(a,b);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_E||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||
this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_H||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey&&this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_DELETE&&TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||
this.evnt.keyCode!=ID_KEYCODE_S||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_O&&this.evnt.keyCode!=ID_KEYCODE_I&&this.evnt.keyCode!=ID_KEYCODE_W&&this.evnt.keyCode!=ID_KEYCODE_Q||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey&&this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_E&&TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_W||TBCancelBubbleEvent(this.evnt);
this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_L||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_N||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_U&&this.evnt.keyCode!=ID_KEYCODE_I&&this.evnt.keyCode!=ID_KEYCODE_B||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=
ID_KEYCODE_F7||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||this.evnt.altKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||TBCancelBubbleEvent(this.evnt);!GetMultiCellSelection()||this.evnt.keyCode!=ID_KEYCODE_M&&this.evnt.keyCode!=ID_KEYCODE_H&&this.evnt.keyCode!=ID_KEYCODE_W||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey&&!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_G&&TBCancelBubbleEvent(this.evnt);!a.ctrlKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_A&&
a.keyCode!=ID_KEYCODE_F&&a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_B&&a.keyCode!=ID_KEYCODE_H||(this.setKeyCodeArray("ctrl"),this.setKeyCodeArray(a.keyCode),setTimeout(function(){0<DZESHORTCUT.keyCodeArray.length&&DZESHORTCUT.clearKeyCodeArray()},1E3));this.setNewFile();this.setOpenFile();this.setSaveAs();this.setPrint();this.setRedo();this.setPastespecial();this.setDelete();!a.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_F||this.setFindText();
!a.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_A&&a.keyCode!=ID_KEYCODE_H||this.setReplaceText();this.setSpecialChars();!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_B||this.setInsertBookmark();!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_H||this.setHyperLinkInsert();this.setStyleFont();this.setStyleParagraph();this.setInsertOrderedList();
this.setInsertUnOrderedList();this.setIncreaseFontSize();this.setIncreaseLetterSpacing();this.setFontProperty();this.setParagraphAlign();this.setIndentParagraph();this.setLeftMargin();this.setRightMargin();this.setLineHeight();this.setAutoListStyle();this.setApplyListStyleDepth();this.tableAddRowCol();this.tableHorizontalSum();this.tableVerticalSum();this.tableHorizontalAverage();this.tableVerticalAverage();this.tableHorizontalMultiply();this.tableVerticalMultiply();this.tableMergeCell();this.tableSplitCell();
this.tableCellSameHeight();this.tableCellSameWidth();this.tableAddRow();this.tableDeleteRow();this.tableDeleteCol();this.tableSelectOneCell();this.copyMutiCell();this.cutMutiCell();this.setTabKeyAction();this.moveMultiCellSelection();this.setTableResizeAction();this.setSelectEntireCells();this.copy();this.cut();this.applyEscKeyAction();this.destruct(a)},setNewFile:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_N){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+
"_"+this.nEditNumber);fnHandler_NewFile(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setOpenFile:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_O){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_OpenFile(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setSaveAs:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&
this.evnt.keyCode==ID_KEYCODE_S||!this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_S){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_SaveAs(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setPrint:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_P){var a=document.getElementById(g_arrConst[ID_COMMAND_PRINT][2]+"_"+this.nEditNumber);
fnHandler_Print(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setRedo:function(){try{!this.evnt.altKey&&this.evnt.ctrlKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_Z&&(g_objUndoRedo.operateUndoRedoStack(!1,!1,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setPastespecial:function(){try{if(this.evnt.ctrlKey&&this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_V){var a=document.getElementById(g_arrConst[ID_COMMAND_EDIT_PASTESPECIAL][2]+
"_"+this.nEditNumber);fnHandler_Pastespecial(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setDelete:function(){try{if(this.evnt.ctrlKey&&!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_E){var a=document.getElementById(g_arrConst[ID_COMMAND_DELETE][2]+"_"+this.nEditNumber);fnHandler_SupportCommand(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setFindText:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",
ID_KEYCODE_Q,ID_KEYCODE_F])||this.evnt.ctrlKey&&!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_F){var a=document.getElementById(g_arrConst[ID_COMMAND_EDIT_SEARCH][2]+"_"+this.nEditNumber);fnHandler_FindReplaceText(this.evnt,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setReplaceText:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_Q,ID_KEYCODE_A])||this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_H])){var a=
document.getElementById(g_arrConst[ID_COMMAND_EDIT_REPLACE][2]+"_"+this.nEditNumber);fnHandler_FindReplaceText(null,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setSpecialChars:function(){try{if(this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_F10){var a=document.getElementById(g_arrConst[ID_COMMAND_INSERT_SPECIALCHARS][2]+"_"+this.nEditNumber);fnHandler_SpecialChars(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},
setInsertBookmark:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_K,ID_KEYCODE_B])){var a=document.getElementById(g_arrConst[ID_COMMAND_SAVEAS][2]+"_"+this.nEditNumber);fnHandler_InsertBookmark(null,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setHyperLinkInsert:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_K,ID_KEYCODE_H])){var a=document.getElementById(g_arrConst[ID_COMMAND_HYPERLINK_INSERT][2]+
"_"+this.nEditNumber);fnHandler_HyperLinkInsert(null,a,this.nEditNumber);DZESHORTCUT.clearKeyCodeArray();TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setStyleFont:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_L){var a=document.getElementById(g_arrConst[ID_COMMAND_FONT_NAME][2]+"_"+this.nEditNumber);fnHandler_StyleFont(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setStyleParagraph:function(){try{if(this.evnt.altKey&&
!this.evnt.shiftKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_W){var a=document.getElementById(g_arrConst[ID_COMMAND_LINE_HEIGHT][2]+"_"+this.nEditNumber);fnHandler_StyleParagraph(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setInsertOrderedList:function(){try{if(!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET){var a=document.getElementById(g_arrConst[ID_COMMAND_INSERT_ORDERED_LIST][2]+"_"+this.nEditNumber);
fnHandler_SupportCommand(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setInsertUnOrderedList:function(){try{if(!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_CLOSESQUAREBRACKET){var a=document.getElementById(g_arrConst[ID_COMMAND_INSERT_UNORDERED_LIST][2]+"_"+this.nEditNumber);fnHandler_SupportCommand(null,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setIncreaseFontSize:function(){try{if(this.evnt.altKey&&
this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_E||this.evnt.keyCode==ID_KEYCODE_R)||!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET||this.evnt.keyCode==ID_KEYCODE_CLOSESQUAREBRACKET)){dlog("setIncreaseFontSize start");var a=!0;if(this.evnt.keyCode==ID_KEYCODE_R||this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET){var b=document.getElementById(g_arrConst[ID_COMMAND_STYLE_DECREASE_FONTSIZE][2]+"_"+this.nEditNumber);fnHandler_StyleDecreaseFontSize(this.evnt,
b,this.nEditNumber);a=!1}else b=document.getElementById(g_arrConst[ID_COMMAND_STYLE_INCREASE_FONTSIZE][2]+"_"+this.nEditNumber),fnHandler_StyleIncreaseFontSize(this.evnt,b,this.nEditNumber);dlog("increaseType:"+a);TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},setIncreaseLetterSpacing:function(){try{if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_W||this.evnt.keyCode==ID_KEYCODE_N)&&(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber),
!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){dlog("setIncreaseLetterSpacing start");var a=!0;this.evnt.keyCode==ID_KEYCODE_N&&(a=!1);strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)dlog("select type is not support -> strSelectionType : "+strSelectionType);else{var b=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);
duzon_dialog.initSelectionFontStyleList(b);dlog(duzon_dialog.selectionFontStyleList);""==duzon_dialog.selectionFontStyleList.letterSpacing&&(duzon_dialog.selectionFontStyleList.letterSpacing="0pt");var c=parseInt(duzon_dialog.selectionFontStyleList.letterSpacing.replace(/pt/,""),10);dlog("org letterSpacing:"+c);a=!0===a?c+1:c-1;a<duzon_dialog.min_letterspacing||a>duzon_dialog.max_letterspacing?dlog("increaseSpacing exception - increaseSpacing : "+a):(dlog("increaseSpacing:"+a),g_objLetterSpacingWin.fnLetterSpacingCellClick(a+
"pt"),TBCancelBubbleEvent(this.evnt))}}}catch(d){dalert(d)}},setFontProperty:function(){try{if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey){if(dzeUiConfig.bUseLockEditCellFunction&&(1==g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber),!1)||0==g_objEditMode.checkSelectionContentEditable(this.nEditNumber)))return;var a="";if(this.evnt.keyCode==ID_KEYCODE_U)a=g_arrConst[ID_COMMAND_UNDERLINE][0];else if(this.evnt.keyCode==ID_KEYCODE_B)a=g_arrConst[ID_COMMAND_BOLD][0];else if(this.evnt.keyCode==
ID_KEYCODE_I)a=g_arrConst[ID_COMMAND_ITALIC][0];else if(this.evnt.keyCode==ID_KEYCODE_P)a=g_arrConst[ID_COMMAND_SUPERSCRIPT][0];else if(this.evnt.keyCode==ID_KEYCODE_S)a=g_arrConst[ID_COMMAND_SUBSCRIPT][0];else return;dlog("strCommand:"+a);fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);TBCancelBubbleEvent(this.evnt)}if(this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_A&&(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:
getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType)){var b=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],ID_COMMAND_SUPERSCRIPT,g_arrConst[ID_COMMAND_SUPERSCRIPT][0],this.nEditNumber,-1,strSelectionType),c=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],ID_COMMAND_SUBSCRIPT,g_arrConst[ID_COMMAND_SUBSCRIPT][0],this.nEditNumber,-1,strSelectionType);dlog("strStateSuper:"+
b);dlog("strStateSub:"+c);b==ID_STRING_NAME_CHECKED?(a=g_arrConst[ID_COMMAND_SUPERSCRIPT][0],fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a),a=g_arrConst[ID_COMMAND_SUBSCRIPT][0]):a=c==ID_STRING_NAME_CHECKED?g_arrConst[ID_COMMAND_SUBSCRIPT][0]:g_arrConst[ID_COMMAND_SUPERSCRIPT][0];dlog("strCommand:"+a);fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);TBCancelBubbleEvent(this.evnt)}}catch(d){dalert(d)}},setParagraphAlign:function(){try{if(!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey){var a=
"";if(this.evnt.keyCode==ID_KEYCODE_M)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_JUSTIFY][2]+"_"+this.nEditNumber);else if(this.evnt.keyCode==ID_KEYCODE_L)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_LEFT][2]+"_"+this.nEditNumber);else if(this.evnt.keyCode==ID_KEYCODE_R)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_RIGHT][2]+"_"+this.nEditNumber);else if(this.evnt.keyCode==ID_KEYCODE_C)a=document.getElementById(g_arrConst[ID_COMMAND_JUSTIFY_CENTER][2]+"_"+this.nEditNumber);
else return;fnHandler_Align(this.evnt,a,this.nEditNumber);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setIndentParagraph:function(){try{if(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_F5||!this.evnt.altKey&&this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_O)fnHandler_Outdent(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt);if(!this.evnt.altKey&&
!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_F6||!this.evnt.altKey&&this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_I)fnHandler_Indent(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt)}catch(a){dalert(a)}},margin_unit_val:5,setLeftMargin:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_5||this.evnt.keyCode==
ID_KEYCODE_6)&&(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber),!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);dlog("===setIndentParagraph===");dlog(a);var b=a[6];""==b&&(b="0px");a=b=parseInt(b.replace(/px/gi,""),10);this.evnt.keyCode==ID_KEYCODE_5?b>ParagraphDlg.marginLeftMin&&(a-=this.margin_unit_val):this.evnt.keyCode==ID_KEYCODE_6&&b<ParagraphDlg.marginLeftMax&&
(a+=this.margin_unit_val);a<ParagraphDlg.marginLeftMin&&(a=ParagraphDlg.marginLeftMin);a>ParagraphDlg.marginLeftMax&&(a=ParagraphDlg.marginLeftMax);g_objLetterFn.setParaStyle(this.nEditNumber,{marginLeft:a});TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},setRightMargin:function(){try{if(this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_7||this.evnt.keyCode==ID_KEYCODE_8)&&(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber),
!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);dlog("===setIndentParagraph===");dlog(a);var b=a[8];""==b&&(b="0px");a=b=parseInt(b.replace(/px/gi,""),10);this.evnt.keyCode==ID_KEYCODE_8?a>ParagraphDlg.marginRightMin&&(a-=this.margin_unit_val):this.evnt.keyCode==ID_KEYCODE_7&&a<ParagraphDlg.marginRightMax&&(a+=this.margin_unit_val);a<ParagraphDlg.marginRightMin&&(a=ParagraphDlg.marginRightMin);a>ParagraphDlg.marginRightMax&&
(a=ParagraphDlg.marginRightMax);g_objLetterFn.setParaStyle(this.nEditNumber,{marginRight:a});TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},lineheight_unit_val:.1,setLineHeight:function(){try{if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_A||this.evnt.keyCode==ID_KEYCODE_Z)||!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_Q||this.evnt.keyCode==ID_KEYCODE_W))if(!dzeUiConfig.bUseLockEditCellFunction||1!=g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber),
!1)&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber)){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);dlog("===setIndentParagraph===");dlog(a);var b=a[5];""==b&&(b="1.2");b=parseFloat(b,10);dlog("lineHeight:"+b);a=b;if(this.evnt.keyCode==ID_KEYCODE_A||this.evnt.keyCode==ID_KEYCODE_Q)a>ParagraphDlg.lineHeightMin&&(a-=this.lineheight_unit_val);else if(this.evnt.keyCode==ID_KEYCODE_Z||this.evnt.keyCode==ID_KEYCODE_W)a<ParagraphDlg.lineHeightMax&&(a+=this.lineheight_unit_val);
else return;dlog("newLineHeight:"+a);a<ParagraphDlg.lineHeightMin&&(a=ParagraphDlg.lineHeightMin);a>ParagraphDlg.lineHeightMax&&(a=ParagraphDlg.lineHeightMax);dlog("newLineHeight2:"+a);g_objLineHeightWin.fnLineHeightCellClick(a);TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},setAutoListStyle:function(){try{this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_SPACE||applyAutoListStyle(this.evnt,this.nEditNumber),this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||
this.evnt.keyCode!=ID_KEYCODE_BACKSPACE||applyListStyleBackSpace(this.evnt,this.nEditNumber),this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!==ID_KEYCODE_DELETE||applyListStyleDelete(this.evnt,this.nEditNumber)}catch(a){dalert(a)}},setApplyListStyleDepth:function(){try{if((this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey||!this.evnt.altKey&&this.evnt.ctrlKey&&this.evnt.shiftKey)&&(this.evnt.keyCode==ID_KEYCODE_ARROW_RIGHT||this.evnt.keyCode==ID_KEYCODE_ARROW_LEFT)){if(this.evnt.keyCode==
ID_KEYCODE_ARROW_RIGHT)var a="decrease";else if(this.evnt.keyCode==ID_KEYCODE_ARROW_LEFT)a="increase";else return;applyListStyleDepth(a,this.nEditNumber,!0,!1)}}catch(b){dalert(b)}},tableAddRowCol:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_INSERT){var a=GetCurTable(this.nEditNumber);a&&!g_objTableUtil.isProtect(a)&&fnHandler_TableAddRowCol(this.evnt,{},this.nEditNumber)}}catch(b){dalert(b)}},tableHorizontalSum:function(){try{this.evnt.altKey||
!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_H||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber,!1))||fnHandler_TableHorizontalSum(this.evnt,{},this.nEditNumber)}catch(a){dalert(a)}},tableVerticalSum:function(){try{this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_V||!0===dzeUiConfig.bUseLockEditCellFunction&&
!0===g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber,!1))||fnHandler_TableVerticalSum(this.evnt,{},this.nEditNumber)}catch(a){dalert(a)}},tableHorizontalAverage:function(){try{this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_J||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber,!1))||fnHandler_TableHorizontalAverage(this.evnt,{},this.nEditNumber)}catch(a){dalert(a)}},
tableVerticalAverage:function(){try{this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_B||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber,!1))||fnHandler_TableVerticalAverage(this.evnt,{},this.nEditNumber)}catch(a){dalert(a)}},tableHorizontalMultiply:function(){try{this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||
this.evnt.keyCode!=ID_KEYCODE_K||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber,!1))||fnHandler_TableHorizontalMultiply(this.evnt,{},this.nEditNumber)}catch(a){dalert(a)}},tableVerticalMultiply:function(){try{this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_G||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedEditCell(GetCurTable(this.nEditNumber,
!1))||fnHandler_TableVerticalMultiply(this.evnt,{},this.nEditNumber)}catch(a){dalert(a)}},tableCellSameHeight:function(){try{if(this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_H&&GetMultiCellSelection()){var a=document.getElementById("TB_TABLE_CELL_SAME_HEIGHT_"+this.nEditNumber);fnHandler_TableCellSameHeight(this.evnt,a,this.nEditNumber)}}catch(b){dalert(b)}},tableCellSameWidth:function(){try{if(this.evnt.altKey&&this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==
ID_KEYCODE_W&&GetMultiCellSelection()){var a=document.getElementById("TB_TABLE_CELL_SAME_WIDTH_"+this.nEditNumber);fnHandler_TableCellSameWidth(this.evnt,a,this.nEditNumber)}}catch(b){dalert(b)}},tableMergeCell:function(){try{if(this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_M&&GetMultiCellSelection()&&!g_objTableUtil.isProtect()){var a=document.getElementById("TB_TABLE_MERGE_CELL_"+this.nEditNumber);fnHandler_TableMergeCell(this.evnt,
a,this.nEditNumber)}}catch(b){dalert(b)}},tableSplitCell:function(){try{if(this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_S&&!g_objTableUtil.isProtect()){var a=document.getElementById("TB_TABLE_SPLIT_CELL_"+this.nEditNumber);fnHandler_TableSplitCell(this.evnt,a,this.nEditNumber)}}catch(b){dalert(b)}},tableAddRow:function(){try{if(!this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&
this.evnt.keyCode==ID_KEYCODE_ENTER){var a=GetCurTable(this.nEditNumber);if(a&&!g_objTableUtil.isProtect(a)){var b=document.getElementById("TB_TABLE_ADD_ROW_DOWN_"+this.nEditNumber);fnHandler_TableAddRow(this.evnt,b,this.nEditNumber)}}}catch(c){dalert(c)}},tableDeleteRow:function(){try{if(!this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_BACKSPACE&&!g_objTableUtil.isProtect()){var a=document.getElementById("TB_TABLE_DELETE_ROW_"+
this.nEditNumber);fnHandler_TableDeleteRow(this.evnt,a,this.nEditNumber)}}catch(b){dalert(b)}},tableDeleteCol:function(){try{if(this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_DELETE&&!g_objTableUtil.isProtect()){var a=document.getElementById("TB_TABLE_DELETE_COL_"+this.nEditNumber);fnHandler_TableDeleteCol(this.evnt,a,this.nEditNumber)}}catch(b){dalert(b)}},tableSelectOneCell:function(){try{this.evnt.altKey||this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=
ID_KEYCODE_F5||(g_objTableSelection.table_SelectionCaretCell(this.nEditNumber),updateTableHandlerUI.updateTableUIHandler(this.nEditNumber))}catch(a){dalert(a)}},unsetPasteStyleMode:function(){try{!0===dzeUiConfig.bApplyPasteStyleMode&&(dzeCopyPasteStyleInfo.unsetPasteStyleModeEditArea(this.nEditNumber),dzeCopyPasteStyleInfo.unsetPasteStyleMode(this.nEditNumber))}catch(a){dalert(a)}},copyMutiCell:function(){try{if(!this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&
this.evnt.keyCode==ID_KEYCODE_C){var a=this.nEditNumber;GetMultiCellSelection(a)&&(dzeClipBoard.copySelectedMultiCells(a),TBCancelBubbleEvent(this.evnt))}}catch(b){dalert(b)}},cutMutiCell:function(){try{if(!this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_X){var a=this.nEditNumber;GetMultiCellSelection(a)&&(dzeClipBoard.cutSelectedMultiCells(a),TBCancelBubbleEvent(this.evnt))}}catch(b){dalert(b)}},setTabKeyAction:function(){try{var a=
this.nEditNumber,b=!this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_TAB,c=this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.keyCode===ID_KEYCODE_T;if(b||c){var d=SelectionUtil.isOnInput(a);if(d){var e=g_objEditorDocument[a].querySelectorAll("input, textarea");e=[].slice.call(e);var f=e.indexOf(d);!this.evnt.shiftKey&&f===e.length-1||this.evnt.shiftKey&&0===f?TBCancelBubbleEvent(this.evnt):!this.evnt.shiftKey&&f+1<e.length?g_objInputFormatEvent.setEditing(e[f+1]):this.evnt.shiftKey&&
0<=f-1&&g_objInputFormatEvent.setEditing(e[f-1])}else{c=!1;d=null;if((d=GetCurListItem(a))&&SelectionUtil.existOnFirst(d,GetCurRange(a))||isMultiCaretOnSameRootList(this.nEditNumber))c=applyListStyleDepth(this.evnt.shiftKey?"increase":"decrease",a,this.evnt,!0);else{if(b&&GetCurTable(a))return;g_objCaretUtil.isContentEditable(a)&&(this.evnt.shiftKey?this.evnt.shiftKey&&(c=applyTabKeyAction(!1,a,this.evnt)):c=applyTabKeyAction(!0,a,this.evnt))}!0===c&&TBCancelBubbleEvent(this.evnt);this.evnt.shiftKey&&
!this.evnt.cancelBubble&&deleteIndent(this.evnt,!0)&&TBCancelBubbleEvent(this.evnt);b&&this.evnt.preventDefault()}}}catch(g){dalert(g)}},moveMultiCellSelection:function(){try{g_objTableSelection.onKeyDown_multiCellSelection(this.evnt,this.nEditNumber)&&TBCancelBubbleEvent(this.evnt)}catch(a){dalert(a)}},setTableResizeAction:function(){try{var a=this.nEditNumber;!GetMultiCellSelection(a)||ID_KEYCODE_ARROW_TOP!=this.evnt.keyCode&&ID_KEYCODE_ARROW_BOTTOM!=this.evnt.keyCode&&ID_KEYCODE_ARROW_RIGHT!=this.evnt.keyCode&&
ID_KEYCODE_ARROW_LEFT!=this.evnt.keyCode||!this.evnt.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||ID_KEYCODE_ARROW_TOP!=this.evnt.keyCode&&ID_KEYCODE_ARROW_BOTTOM!=this.evnt.keyCode&&ID_KEYCODE_ARROW_RIGHT!=this.evnt.keyCode&&ID_KEYCODE_ARROW_LEFT!=this.evnt.keyCode||!0!==g_objTableResize.applyTableResizeKeyAction(this.evnt,a)||TBCancelBubbleEvent(this.evnt)}catch(b){dalert(b)}},setSelectEntireCells:function(){try{if(!this.cancelBubble&&!SelectionUtil.isOnInput(this.nEditNumber)){var a=
!1,b=this.nEditNumber,c=g_objTableSelection;!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.altKey||this.evnt.shiftKey||ID_KEYCODE_A!=this.evnt.keyCode?!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.altKey||this.evnt.shiftKey||ID_KEYCODE_SPACE!=this.evnt.keyCode?DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.altKey&&this.evnt.shiftKey&&ID_KEYCODE_SPACE==this.evnt.keyCode&&(a=c.table_selectRow(GetCurTable(b),b)):a=c.table_selectCol(GetCurTable(b),
b):a=c.table_selectAll(GetCurTable(b),b);!0===a&&(g_objTableSelection.updateManualTableUIHandler(b),TBCancelBubbleEvent(this.evnt))}}catch(d){dalert(d)}},copy:function(){try{if(!this.evnt.cancelBubble&&!1===this.evnt.altKey&&!1===this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_C)return g_objCopyPaste.onCopyBefore(this.evnt)}catch(a){dalert(a)}},cut:function(){try{if(!this.evnt.cancelBubble&&!1===this.evnt.altKey&&!1===this.evnt.shiftKey&&
DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_X)return g_objCopyPaste.onCutBefore(this.evnt)}catch(a){dalert(a)}},applyEscKeyAction:function(){try{this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_ESCAPE||(this.unsetPasteStyleMode(),dzeClipBoard.initialize(),g_objPasteOptionMenu.remove())}catch(a){dalert(a)}},destruct:function(a){}};

var g_objWrapperOutlineResize=new function(){this.objExtDragPosInfo=this.objExtSelectedInfo=null;this.resetExtOutlineInfo=function(a){try{"undefined"===typeof a&&(a=null),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),a&&a.shiftKey&&g_objWrapperOutlineResize.objExtSelectedInfo&&g_objWrapperOutlineResize.objExtSelectedInfo.nObjType===DZE_OBJ_IMG||this.resetExtOutlineInfo_call()}catch(c){dalert(c)}};this.resetExtOutlineInfo_call=function(){try{this.objExtDragPosInfo=this.objExtSelectedInfo=null,
g_objWrapperOutlineUtil.nExtOutlineRectPressedType=OUTLINE_INDICATOR.NONE,g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1)}catch(a){dalert(a)}};this.newExtSelectedInfo=function(a,c){try{this.objExtSelectedInfo={};this.objExtSelectedInfo.nObjType=a;this.objExtSelectedInfo.objElement=c;return}catch(d){dalert(d)}this.objExtSelectedInfo=null};this.newExtDragPosInfo=function(a,c,d){try{if(null==a)return null;this.objExtDragPosInfo={};this.objExtDragPosInfo.startPosXY=g_objPositionUtil.GetDocumentClientPos_XY(c);
var e=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(a,d);this.objExtDragPosInfo.rcOrgArea=e;var n=a.style.width,h=a.style.height,f=a.offsetWidth,l=a.offsetHeight;a.style.width=e.right-e.left+"px";a.style.height=e.bottom-e.top+"px";var g=a.offsetWidth-f,b=a.offsetHeight-l;a.style.width=n;a.style.height=h;this.objExtDragPosInfo.nDiff_X=g;this.objExtDragPosInfo.nDiff_Y=b;return}catch(m){dalert(m)}this.objExtDragPosInfo=null};this.resizePositionByDragForExtMode=function(a,c,d,e,n){try{if(OUTLINE_INDICATOR.NONE!=
e&&null!=this.objExtDragPosInfo&&null!=c){var h=this.objExtDragPosInfo.startPosXY,f=g_objPositionUtil.GetDocumentClientPos_XY(d),l=f.nPos_X-h.nPos_X,g=f.nPos_Y-h.nPos_Y,b=this.objExtDragPosInfo.rcOrgArea,m=b.right-b.left,p=b.bottom-b.top;f=null;b=m;var k=p,q=d.shiftKey||c.hasAttribute("dze_image_no_proportion");switch(e){case OUTLINE_INDICATOR.LEFT:b-=l;q=!1;break;case OUTLINE_INDICATOR.RIGHT:b+=l;q=!1;break;case OUTLINE_INDICATOR.TOP:k-=g;q=!1;break;case OUTLINE_INDICATOR.BOTTOM:k+=g;q=!1;break;
case OUTLINE_INDICATOR.LEFT_TOP:b-=l;k-=g;break;case OUTLINE_INDICATOR.RIGHT_BOTTOM:b+=l;k+=g;break;case OUTLINE_INDICATOR.RIGHT_TOP:b+=l;k-=g;break;case OUTLINE_INDICATOR.LEFT_BOTTOM:b-=l,k+=g}b=Math.max(parseInt(b,10),0);k=Math.max(parseInt(k,10),0);d=b-m;e=k-p;var r=q?this.getRatioSize(h.nPos_X,h.nPos_Y,m,p,b,k):null;r&&(b=r.width,k=r.height,d=b-m,e=k-p);DZE_OBJ_TABLE===a?(f=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(c,n),d=b-f.width,e=k-f.height,g_objTableResize.doResizeTable(c,d,
e)):DZE_OBJ_TD===a?(f=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(c,n),d=b-f.width,e=k-f.height,d&&g_objTableResize.doResizeColFromCell(c,d),e&&g_objTableResize.doResizeRowFromCell(c,e)):this.resizeStyleWidthHeight(c,0===d?!1:!0,b,0===e?!1:!0,k);g_objWrapperOutlineUtil.showExtOutline(c,!0,!0,!1,n)}}catch(t){dalert(t)}};this.resizeStyleWidthHeight=function(a,c,d,e,n){try{if(c&&0<=d){var h=a.height,f=a.style.height;if(""==h&&""==f){var l=a.offsetHeight;a.style.height=l}else""!=h&&""==f?(a.style.height=
h,this.removeAttributeWidthHeight(a,!1,!0)):""==h&&""!=f||""==h||""==f||this.removeAttributeWidthHeight(a,!1,!0);var g=a.style.width,b=a.offsetWidth;a.style.width=d+"px";b==a.offsetWidth&&""!=g&&(a.style.width=g)}if(e&&0<=n){var m=a.width;g=a.style.width;""==m&&""==g?(b=a.offsetWidth,a.style.width=b):""!=m&&""==g?(a.style.width=m,this.removeAttributeWidthHeight(a,!0,!1)):""==m&&""!=g||""==m||""==g||this.removeAttributeWidthHeight(a,!0,!1);f=a.style.height;l=a.offsetHeight;a.style.height=n+"px";l==
a.offsetHeight&&""!=f&&(a.style.height=f)}this.removeAttributeWidthHeight(a,c,e)}catch(p){dalert(p)}};this.removeAttributeWidthHeight=function(a,c,d){try{c&&a.removeAttribute("width"),d&&a.removeAttribute("height")}catch(e){dalert(e)}};this.afterResizeTargetElement=function(a,c){try{null!=this.objExtSelectedInfo&&g_objUndoRedo.registerUndoRedoStack(0,c)}catch(d){dalert(d)}};this.getRatioSize=function(a,c,d,e,n,h){try{d/=e;var f=parseInt(n/d,10),l=g_objPositionUtil.dist(a,c,a+n,c+f),g=parseInt(h*d,
10),b=g_objPositionUtil.dist(a,c,a+g,c+h);a={width:n,height:h};l>=b?(a.width=n,a.height=f):(a.width=g,a.height=h);a.width=Math.max(parseInt(a.width,10),0);a.height=Math.max(parseInt(a.height,10),0);return a}catch(m){dalert(m)}}};

var g_objUndoRedo=new function(){this.arrUndoRedoStruct=[];this.bDoNotInitialStack=!1;this.newUndoRedoStack=function(){try{var b={bKeyCodeContinue:!1};b.nLastKeyCode=ID_KEYCODE_NONE;b.nUndoRedoStackPos=-1;b.nUndoRedoStack_LastEventPos=-1;b.arrUndoRedoStack=[];return b}catch(c){dalert(c)}return null};this.newUndoRedoSelection=function(){return{nCaseID:0,arrStartContainerPos:null,posStartOffset:null,arrEndContainerPos:null,posEndOffset:null,strBackgroundColor:"",strBackgroundImageURL:"",strBackgroundImageRepeat:""}};
this.initUndoRedoStack=function(b){try{var c=this.newUndoRedoStack();return c?this.arrUndoRedoStruct[b]=c:null}catch(a){dalert(a)}return null};this.registerInitialContentStack=function(b){try{if(!0!==this.bDoNotInitialStack){var c=this.initUndoRedoStack(b);c.nUndoRedoStackPos++;c.nUndoRedoStack_LastEventPos=c.nUndoRedoStackPos;var a=this.getContentStack(b),d=this.getUndoRedoSelection(0,b),e=this.getUndoRedoBindData(b);c.arrUndoRedoStack[c.nUndoRedoStackPos]=[a,d,e]}}catch(f){dalert(f)}};this.registerUndoRedoStack=
function(b,c){try{this.registerUndoRedoContent(b,c)}catch(a){dalert(a)}};this.registerUndoRedoContent=function(b,c){try{var a=this.arrUndoRedoStruct[c];if(null!=a){g_objPasteOptionMenu.remove();g_bModified=!0;a.nUndoRedoStackPos++;a.nUndoRedoStack_LastEventPos=a.nUndoRedoStackPos;a.bKeyCodeContinue=!1;a.nLastKeyCode=ID_KEYCODE_NONE;var d=this.getContentStack(c),e=this.getUndoRedoSelection(b,c),f=this.getUndoRedoBindData(c);a.arrUndoRedoStack[a.nUndoRedoStackPos]=[d,e,f]}}catch(g){dalert(g)}};this.getUndoRedoSelection=
function(b,c){try{var a=this.newUndoRedoSelection();a.nCaseID=b;a.strBackgroundColor=getBodyBackgroundColor(c);a.strBackgroundImageURL=g_objPropertyUtil.getBackgroundImageURL(g_objEditorDocument[c].body);a.strBackgroundImageRepeat=getBodyBackgroundRepeat(c);a.bCellSelected=GetMultiCellSelection(c);if(window.attachEvent){var d=g_objEditorDocument[c].selection,e=d.type;e=e.toLowerCase();if(ID_STRING_NAME_NONE==e||ID_STRING_NAME_TEXT==e){var f=d.createRange(),g=f.parentElement(),h=this.getSelectionPos_IE(f,
g,d);a.arrStartContainerPos=this.getNodePosition(c,g);a.arrEndContainerPos=null;a.posStartOffset=h.nStartRangePos;a.posEndOffset=h.nEndRangePos}}else{d=g_objEditWindow[c].getSelection();if(null==d)return a;1==d.rangeCount&&(f=d.getRangeAt(0),a.arrStartContainerPos=this.getNodePosition(c,f.startContainer),a.arrEndContainerPos=this.getNodePosition(c,f.endContainer),a.posStartOffset=this.getNodeOffset(f.startContainer,f.startOffset),a.posEndOffset=this.getNodeOffset(f.endContainer,f.endOffset),g_bBrowserType_IE&&
1===Math.abs(a.posEndOffset-a.posStartOffset)&&g_objCaretUtil.isComposing()&&(a.posStartOffset=a.posEndOffset))}return a}catch(k){dalert(k)}};this.getUndoRedoBindData=function(b){try{if(dzeUiConfig&&dzeUiConfig.bUseDataBind&&dzeUiConfig.bUseDataBindTwoWay&&g_objBindStore&&g_objMutationObserver){var c={};c.state=g_objBindStore.getState();c.state=JSON.parse(JSON.stringify(c.state));c.observers=[];var a=g_objEditorDocument[b].body,d=g_objMutationObserver._targetNodes;d&&forEach(d,function(d,f){f&&f.parentNode&&
a!==f&&a.contains(3===f.nodeType?f.parentNode:f)?c.observers.push(this.getNodePosition(b,f)):dlog("bind node deleted: "+f)},this);return c}}catch(e){dalert(e)}};this.getContentStack=function(b){try{return g_objEditorDocument[b].body.innerHTML}catch(c){dalert(c)}return""};this.operateUndoRedoStack=function(b,c,a){try{var d=this.arrUndoRedoStruct[a];if(!(null==d||-1>=d.nUndoRedoStackPos)){g_objWrapperOutlineResize.resetExtOutlineInfo();if(b){if(0==d.nUndoRedoStackPos)return;d.nUndoRedoStackPos--;this.assignContentStack(d,
a);c&&(d.nUndoRedoStack_LastEventPos=d.nUndoRedoStackPos)}else{if(d.nUndoRedoStack_LastEventPos<=d.nUndoRedoStackPos)return;d.nUndoRedoStackPos++;this.assignContentStack(d,a)}this.restoreCellSelection(a,d.arrUndoRedoStack[d.nUndoRedoStackPos][1].bCellSelected);g_objPasteOptionMenu.remove();editor_onselectionchange(a);"undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length&&g_objEditMode.doReservedCallback(a)}}catch(e){dalert(e)}};this.assignContentStack=function(b,
c){try{if(!(0>b.nUndoRedoStackPos)){var a=b.arrUndoRedoStack[b.nUndoRedoStackPos][1],d=getBodyBackgroundColor(c);a.strBackgroundColor!=d&&setBodyBackgroundColor(a.strBackgroundColor,c);var e=g_objPropertyUtil.getBackgroundImageURL(g_objEditorDocument[c].body);a.strBackgroundImageURL!=e&&setBodyBackgroundImage(a.strBackgroundImageURL,c);var f=getBodyBackgroundRepeat(c);a.strBackgroundImageRepeat!=f&&setBodyBackgroundRepeat(a.strBackgroundImageRepeat,c);g_objEditorDocument[c].body.innerHTML=b.arrUndoRedoStack[b.nUndoRedoStackPos][0];
this.restoreSelection(a,c);this.restoreUndoRedoBindData(b.arrUndoRedoStack[b.nUndoRedoStackPos][2],c)}}catch(g){window.attachEvent?g_objEditorDocument[c].selection.empty():g_objEditWindow[c].getSelection().removeAllRanges(),dalert(g)}};this.restoreSelection=function(b,c){try{if(null==b.arrStartContainerPos){if(!window.attachEvent){var a=g_objEditWindow[c].getSelection();a.removeAllRanges()}}else if(window.attachEvent){a=g_objEditorDocument[c].selection;var d=this.setNodePosition(b.arrStartContainerPos,
g_objEditorDocument[c].body),e=a.createRange();e.moveToElementText(d);e.collapse(!0);e.moveStart("character",b.posStartOffset);e.moveEnd("character",b.posEndOffset-b.posStartOffset);e.select()}else{d=function(a){var b=g_objEditorDocument[c].body;return b===a||b.contains(3===a.nodeType?a.parentNode:a)?!0:!1};a=g_objEditWindow[c].getSelection();a.removeAllRanges();e=g_objEditorDocument[c].createRange();var f=this.setNodePosition(b.arrStartContainerPos,g_objEditorDocument[c].body);if(null!=f&&d(f)){var g=
this.setNodePosition(b.arrEndContainerPos,g_objEditorDocument[c].body);if(null!=g&&d(g)){if(f===g&&"BR"===f.nodeName)dalert(""),e.selectNode(f),e.collapse(!0);else try{e.setStart(f,b.posStartOffset),e.setEnd(g,b.posEndOffset)}catch(h){return}a.addRange(e)}}}}catch(h){dalert(h)}};this.restoreUndoRedoBindData=function(b,c){try{if(b&&dzeUiConfig&&dzeUiConfig.bUseDataBind&&dzeUiConfig.bUseDataBindTwoWay&&g_objBindStore&&g_objMutationObserver){g_objBindStore.dispatch({type:"UNDOREDO",new_state:b.state});
var a=b.observers,d=g_objEditorDocument[c].body,e=g_objMutationObserver,f=g_objMutationConfig;e.disconnect();e._targetNodes=void 0;forEach(a,function(a,b){(a=this.setNodePosition(b,d))&&mutationObserve(e,a,f)},this)}}catch(g){dalert(g)}};this.getNodePosition=function(b,c){try{b=c;c=[];for(var a=-1;500>a;){a++;if("BODY"===b.nodeName)break;if(0===a&&3===b.nodeType&&0===b.nodeValue.length)b=g_objNodeUtil.getParentElement(b);else{var d=this.getNodePosition_previousSibling_By_textNode_Check(b);c.push(d);
b=g_objNodeUtil.getParentElement(b);if(!b)return null}}return c}catch(e){dalert(e)}};this.getNodePosition_previousSibling_By_textNode_Check=function(b){try{for(var c=0,a=b.nodeType;b.previousSibling;)if(b=b.previousSibling,a!==b.nodeType||3!==b.nodeType)c++,a=b.nodeType;return c}catch(d){dalert(d)}};this.getNodeOffset=function(b,c){try{if(!b||3!==b.nodeType)return c;for(var a=b.previousSibling;a&&3===a.nodeType;)c+=a.nodeValue.length,a=a.previousSibling;return c}catch(d){dalert(d)}};this.setNodePosition=
function(b,c){try{if(!b||!b.length)return null;for(var a=b.length;0<a;a--){c=c.firstChild;if(null==c)return null;for(var d=0;d<b[a-1];)d++,c.nextSibling&&(c=c.nextSibling)}return c}catch(e){dalert(e)}};this.getSelectionPos_IE=function(b,c,a){try{var d=a.createRange();d.moveToElementText(c);if(!d.inRange(b))return{nStartRangePos:0,nEndRangePos:0};c=!0;""==b.text&&(c=!1);var e=b=0,f=!1,g=a.createRange();g.collapse(!0);g.moveEnd("character",1);var h=a.createRange();h.collapse(!1);h.moveStart("character",
-1);var k=a=0;d.collapse(!0);k=d.moveEnd("character",1);e+=k;if(0==k)return{nStartRangePos:0,nEndRangePos:0};for(;;){if(!f){var l=d.inRange(g),m=g.inRange(d);if(l||m)if(f=!0,!c)return{nStartRangePos:b,nEndRangePos:b}}if(f){l=d.inRange(h);var n=h.inRange(d);if(l||n)break}a=d.moveStart("character",1);f||(b+=a);k=d.moveEnd("character",1);e+=k;if(0==k)break}return{nStartRangePos:b,nEndRangePos:e}}catch(p){dalert(p)}return{nStartRangePos:0,nEndRangePos:0}};this.checkKeyCodeInput=function(b,c){try{var a=
this.arrUndoRedoStruct[c];if(null==a)return!1;var d=function(a){var b=g_objUndoRedo.getContentStack(c),d=g_objUndoRedo.getUndoRedoSelection(0,c),e=g_objUndoRedo.getUndoRedoBindData(c);a.arrUndoRedoStack[a.nUndoRedoStackPos]=[b,d,e]},e=b.keyCode,f=!1;if(isNavigationKeyCode(e))return!0===a.bKeyCodeContinue&&d(a),a.bKeyCodeContinue=!1;if(DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)&&!1===b.altKey&&!1===b.shiftKey&&(ID_KEYCODE_V==e||ID_KEYCODE_Z==e||ID_KEYCODE_A==e||ID_KEYCODE_C==e||ID_KEYCODE_Y==
e||ID_KEYCODE_S==e)||b&&b.metaKey&&b.shiftKey&&e==ID_KEYCODE_Z&&g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL||91===e||92===e||93===e)return!1;a.nLastKeyCode==e||e!=ID_KEYCODE_ENTER&&e!=ID_KEYCODE_SPACE&&e!=ID_KEYCODE_DELETE||(a.bKeyCodeContinue=!1);a.bKeyCodeContinue?d(a):g_objUndoRedo.getContentStack(c)!=a.arrUndoRedoStack[a.nUndoRedoStackPos][0]&&(g_objUndoRedo.registerUndoRedoContent(0,c,null),f=a.bKeyCodeContinue=!0);a.nLastKeyCode=e;return f}catch(g){dalert(g)}};this.setKeyCodeContinue=
function(b,c){try{var a=this.arrUndoRedoStruct[c];null!=a&&(a.bKeyCodeContinue=b)}catch(d){dalert(d)}};this.restoreCellSelection=function(b,c){try{if(c){var a=g_objTableSelection,d=GetCurCell(b);if(!d||!a.isCellSelected(d)){var e=g_objEditorDocument[b].querySelectorAll("td[cusflag], th[cusflag]");forEach(e,function(b,c){a.deselectCell(c)})}}}catch(f){dalert(f)}}};

var g_strBlankImageName="blank.gif",ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT=1,ID_DROPDOWN_LAYER_POSITION_TYPE_RIGHT=2,ID_KEYCODE_NONE=0,ID_KEYCODE_BACKSPACE=8,ID_KEYCODE_TAB=9,ID_KEYCODE_ENTER=13,ID_KEYCODE_SHIFT=16,ID_KEYCODE_CTRL=17,ID_KEYCODE_ALT=18,ID_KEYCODE_CAPSLOCK=20,ID_KEYCODE_ESCAPE=27,ID_KEYCODE_SPACE=32,ID_KEYCODE_PAGE_UP=33,ID_KEYCODE_PAGE_DOWN=34,ID_KEYCODE_END=35,ID_KEYCODE_HOME=36,ID_KEYCODE_ARROW_LEFT=37,ID_KEYCODE_ARROW_TOP=38,ID_KEYCODE_ARROW_RIGHT=39,ID_KEYCODE_ARROW_BOTTOM=40,ID_KEYCODE_A=
65,ID_KEYCODE_B=66,ID_KEYCODE_C=67,ID_KEYCODE_D=68,ID_KEYCODE_E=69,ID_KEYCODE_F=70,ID_KEYCODE_G=71,ID_KEYCODE_H=72,ID_KEYCODE_I=73,ID_KEYCODE_J=74,ID_KEYCODE_K=75,ID_KEYCODE_L=76,ID_KEYCODE_M=77,ID_KEYCODE_N=78,ID_KEYCODE_O=79,ID_KEYCODE_P=80,ID_KEYCODE_Q=81,ID_KEYCODE_R=82,ID_KEYCODE_S=83,ID_KEYCODE_T=84,ID_KEYCODE_U=85,ID_KEYCODE_V=86,ID_KEYCODE_W=87,ID_KEYCODE_X=88,ID_KEYCODE_Y=89,ID_KEYCODE_Z=90,ID_KEYCODE_MAC_COMMAND=91,ID_KEYCODE_LEFT_WINDOW=91,ID_KEYCODE_RIGHT_WINDOW=92,ID_KEYCODE_MENU=93,
ID_KEYCODE_INSERT=45,ID_KEYCODE_DELETE=46,ID_KEYCODE_PLUS=107,ID_KEYCODE_MINUS=109,ID_KEYCODE_F5=116,ID_KEYCODE_F6=117,ID_KEYCODE_F7=118,ID_KEYCODE_F8=119,ID_KEYCODE_F10=121,ID_KEYCODE_NUM_LOCK=144,ID_KEYCODE_5=53,ID_KEYCODE_6=54,ID_KEYCODE_7=55,ID_KEYCODE_8=56,ID_KEYCODE_OPENSQUAREBRACKET=219,ID_KEYCODE_CLOSESQUAREBRACKET=221;function isArrowKeyCode(a){switch(a){case 37:case 38:case 39:case 40:return!0}return!1}
function isNavigationKeyCode(a){switch(a){case 33:case 34:case 36:case 35:case 27:return!0}return isArrowKeyCode(a)?!0:!1}function isModifierKeyCode(a){switch(a){case 17:case 16:case 18:case 91:case 92:return!0}return!1}function isLockKeyCode(a){switch(a){case 20:case 144:case 145:return!0}return!1}
function isContextualKeyCode(a){switch(a){case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 44:case 19:case 21:case 25:case 93:return!0}return!1}function isNonEditingKeyCode(a){return isNavigationKeyCode(a)||isModifierKeyCode(a)||isLockKeyCode(a)||isContextualKeyCode(a)?!0:!1}function isEditingKeyCode(a){return!isNonEditingKeyCode(a)}
function isUndoKeyEvent(a){if(!a)return!1;var c=a.keyCode,e=g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL;return e&&90===c&&a.metaKey&&!a.ctrlKey&&!a.altKey&&!a.shiftKey||!e&&a.ctrlKey&&!a.altKey&&!a.shiftKey&&90===c?!0:!1}function isRedoKeyEvent(a){if(!a)return!1;var c=a.keyCode,e=g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL;return e&&90===c&&a.metaKey&&!a.ctrlKey&&!a.altKey&&a.shiftKey||!e&&89===c&&a.ctrlKey&&!a.altKey&&!a.shiftKey?!0:!1}
function fnColorCellApply(a,c){try{var e=!0;"undefined"!=typeof c&&(e=c);if(GetMultiCellSelection())g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,a,g_nActiveEditNumber);else if(window.attachEvent){SetActiveEditorArea(g_nActiveEditNumber);var b=g_objEditorDocument[g_nActiveEditNumber].selection;if(fnObjectCheckNull(b))return null;var d=b.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var g=b.createRange();if(fnObjectCheckNull(g))return;g_objLetterFn.setLetterOperation(g_nLetterOperationType,
a,g,g_nActiveEditNumber,!0)}}else if(d=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d)try{b=g_objEditWindow[g_nActiveEditNumber].getSelection(),g=b.getRangeAt(0),g_objLetterFn.setLetterOperation(g_nLetterOperationType,a,g,g_nActiveEditNumber,!0)}catch(h){}tranAllAnchorHrefSharp(g_nActiveEditNumber);!1!==e&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber);editor_onmousedown(null,-1)}catch(h){}}
function checkObjectElemetMouseUp(a,c,e){try{if(!window.attachEvent){var b=g_objNodeUtil.getEventSrcElement(a),d=fnObjectCheckNull(e)?null:g_objNodeUtil.getEventSrcElement(e),g=b.ownerDocument;if(g){var h=g.defaultView;if(h){e=a=null;if(!fnObjectCheckNull(b)){if(d&&b!=d||g_objPropertyUtil.hasClass(b,"formCodeClose"))return;var f=g_objNodeUtil.getElementTagName(b).toLowerCase();d=!0;if(dzeUiConfig.bUseLockEditCellFunction){var k=g_objNodeUtil.getLoopParentElementByTagNames(b,["td","th"]);k&&k.contentEditable&&
"false"==k.contentEditable.toLowerCase()&&(d=!1)}var l=g_objNodeUtil.getLoopParentElement(b,"table");!1===fnObjectCheckNull(l)&&!1===g_objTableFunction.isEditableTable(l)&&(d=!1);if("img"==f){setSelectionObjectInfo(!0,f,b);showExtOutline_ObjectElement(b,d,!1,c);a=h.getSelection();a.removeAllRanges();e=g.createRange();var m=g_objTextWrap.getAnchor(b);m?e.selectNode(m):e.selectNode(b);a.addRange(e);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.setTBImageSizeInfo(c);
return}if("embed"==f||"object"==f){setSelectionObjectInfo(!0,f,b);(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(b,d,!1,c);return}if("div"==f){if(g_bBrowserType_IE&&!g_objEditorDocument[c].queryCommandEnabled("Bold")){setSelectionObjectInfo(!0,f,b);return}}else{if("iframe"==f){setSelectionObjectInfo(!0,f,b);(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(b,d,!1,c);return}if("hr"==f){setSelectionObjectInfo(!0,f,b);(g_bBrowserType_FF||g_bBrowserType_WK||
g_bBrowserType_OP)&&showExtOutline_ObjectElement(b,d,!1,c);return}if("input"==f){"checkbox"==b.getAttribute("type").toLowerCase()&&setSelectionObjectInfo(!0,f,b);return}if("select"==f){setSelectionObjectInfo(!0,f,b);return}}}setSelectionObjectInfo(!1,null,null)}}}}catch(n){dalert(n)}}function setSelectionObjectElemet(a,c){try{var e=g_objEditWindow[c].getSelection();e.removeAllRanges();var b=g_objEditorDocument[c].createRange();b.selectNode(a);e.addRange(b)}catch(d){}}
function showExtOutline_ObjectElement(a,c,e,b){try{var d=getObjType(a,b);DZE_OBJ_HR===d?c=!1:DZE_OBJ_VIDEO===d&&a&&("IMG"===a.nodeName||0<=g_objVideoControl.arrVideoNodeName.indexOf(a.nodeName))&&g_objVideoControl.isVideoSpan(a.parentNode)&&(a=a.parentNode);g_objWrapperOutlineResize.newExtSelectedInfo(d,a);g_objWrapperOutlineUtil.showExtOutline(a,!0,c,e,b)}catch(g){}}
function getSelectionElementNode(a){try{if(window.attachEvent)return null;var c=null;if(g_objObjectSelectionInfo.bSelectObject)c=g_objObjectSelectionInfo.objSelectionObject;else{var e=g_objEditWindow[a].getSelection(),b=e?e.rangeCount:0,d=0<b?e.getRangeAt(0):null;d&&(c=d.startContainer.childNodes[d.startOffset]);if(!c&&0===b&&g_bBrowserType_IE){var g=SelectionUtil.isOnInput(a);g&&(c=g)}}return c}catch(h){}return null}
var ID_USER_WARNING_MSG_SCRIPT=1,ID_USER_WARNING_MSG_NO_IFRAME=3,ID_USER_WARNING_MSG_NO_SOURCE_EDIT=4;function fnUserMessage(a){"cut"==a?alert(ID_RES_USER_MSG_STRING_ALERT_CUT):"copy"==a?alert(ID_RES_USER_MSG_STRING_ALERT_COPY):"paste"==a&&alert(ID_RES_USER_MSG_STRING_ALERT_PASTE)}
function fnUserWarningMessage(a){ID_USER_WARNING_MSG_SCRIPT==a?alert(ID_RES_USER_MSG_STRING_WARNING_SCRIPT):ID_USER_WARNING_MSG_NO_IFRAME==a?alert(ID_RES_USER_MSG_STRING_WARNING_NO_IFRAME):ID_USER_WARNING_MSG_NO_SOURCE_EDIT==a&&alert(ID_RES_USER_MSG_STRING_WARNING_NO_SOURCE_EDIT)};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_bBrowserType_IE=!1,g_bBrowserType_FF=!1,g_bBrowserType_WK=!1,g_bBrowserType_CR=!1,g_bBrowserType_OP=!1,g_bBrowserType_EDGE=!1,g_bBrowserType_SF=!1,g_bBrowserVerInfo=0,g_bDocType_XHTML=!1,ID_SELECTION_DUPLICATE=0,ID_SELECTION_ELEMENT_NODE=1,ID_SELECTION_ATTRIBUTE_NODE=2,ID_SELECTION_TEXT_NODE=3,ID_SELECTION_CDATA_SECTION_NODE=4,ID_SELECTION_ENTITY_REFERENCE_NODE=5,ID_SELECTION_ENTITY_NODE=6,ID_SELECTION_PROCESSING_INSTRUCTION_NODE=7,ID_SELECTION_COMMENT_NODE=8,ID_SELECTION_DOCUMENT_NODE=9,ID_SELECTION_DOCUMENT_TYPE_NODE=
10,ID_SELECTION_DOCUMENT_FRAGMENT_NODE=11,ID_SELECTION_NOTATION_NODE=12,ID_EVENT_MOUSE_CLICK_LEFT=-1,ID_EVENT_MOUSE_CLICK_LEFT_STANDARD=0,ID_EVENT_MOUSE_CLICK_RIGHT=2,g_strBrowserLanguage=null,ID_LANGUAGE_TYPE_EN="en",ID_LANGUAGE_TYPE_KO="ko",ID_LANGUAGE_TYPE_JA="ja",ID_LANGUAGE_TYPE_ZH="zh",ID_LANGUAGE_TYPE_ZH_CN="zh-cn",g_objFindTextRange=null,g_nFindTextCount=0,g_strBodyBackgroundColor_Retry=[],g_strBodyBackgroundImage_Retry=[],g_strBodyBackgroundRepeat_Retry=[];
g_browserCHK.ie?(g_bBrowserType_IE=!0,g_bBrowserVerInfo=g_browserCHK.verInfo):g_browserCHK.ff?(g_bBrowserType_FF=!0,g_bBrowserVerInfo=g_browserCHK.verInfo):g_browserCHK.wk?(g_bBrowserType_WK=!0,g_browserCHK.cr&&(g_bBrowserType_CR=!0),g_browserCHK.edge&&(g_bBrowserType_EDGE=!0),g_browserCHK.sf&&(g_bBrowserType_SF=!0)):g_browserCHK.op&&(g_bBrowserType_OP=!0);function fnObjectCheckNull(a){return null==a||ID_STRING_NAME_UNDEFINED==typeof a?!0:!1}
function HTMLEncode(a){a=a.replace(/&/gi,"&amp;");a=a.replace(/</gi,"&lt;");g_bEncodeEndCharacterYN&&(a=a.replace(/>/gi,"&gt;"));return a}function HTMLDecode(a){g_bEncodeEndCharacterYN&&(a=a.replace(/&gt;/gi,">"));a=a.replace(/&lt;/gi,"<");return a=a.replace(/&amp;/gi,"&")}function TBCancelBubbleEvent(a){try{a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault&&a.preventDefault())}catch(b){dalert(b)}}
function TBCancelBubbleEvent_iFrameLayer(a){try{window.attachEvent?null!=window.parent.event&&(window.parent.event.returnValue=!1,window.parent.event.cancelBubble=!0):null!=a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault())}catch(b){}}function getDocumentType(){try{g_bDocType_XHTML=!(null==document.compatMode||"CSS1Compat"!=document.compatMode),ID_EVENT_MOUSE_CLICK_LEFT=window.attachEvent?1:0}catch(a){}}
function getSelectionType(){try{if(!window.attachEvent){for(var a=0,b="",c=!0,d=g_objEditWindow[g_nActiveEditNumber].getSelection(),e=d.rangeCount,f=0;f<e;f++){var g=d.getRangeAt(f).startContainer;if(c)c=!1,a=g.nodeType,b=g.nodeName;else if(a!=g.nodeType&&b!=g.nodeName)return{nodeType:ID_SELECTION_DUPLICATE,nodeName:"",length:e}}1==e&&g_objObjectSelectionInfo.bSelectObject&&(a=ID_SELECTION_ELEMENT_NODE,b=g_objObjectSelectionInfo.strNodeName);if(0===e&&g_bBrowserType_IE){var h=SelectionUtil.isOnInput(g_nActiveEditNumber);
h&&(a=h.nodeType,b=h.nodeName,e=1)}return{nodeType:a,nodeName:b,length:e}}}catch(k){}}function getSelectionTypeForUpdateUI(){try{if(window.attachEvent)return;var a=ID_STRING_NAME_NONE,b=getSelectionType();if(ID_SELECTION_ELEMENT_NODE==b.nodeType){if(g_objObjectSelectionInfo.bSelectObject)return ID_STRING_NAME_CONTROL}else ID_SELECTION_TEXT_NODE==b.nodeType&&(a=ID_STRING_NAME_TEXT);return a}catch(c){}return ID_STRING_NAME_NONE}
function getSelectionTextValue(a){var b="";try{if(window.attachEvent)ID_STRING_NAME_TEXT==g_objEditorDocument[a].selection.type.toLowerCase()&&(b=g_objEditorDocument[a].selection.createRange().text);else{var c=g_objEditWindow[a].getSelection().getRangeAt(0);c.startContainer.nodeType==ID_SELECTION_TEXT_NODE&&(b=c.toString())}return b}catch(d){}return""}
function getSelectionElement(a,b,c){try{if(window.addEventListener){var d=g_objEditWindow[c].getSelection(),e=d.getRangeAt(0);c=null;for(var f=e.startContainer;f;){if(a==f.nodeName.toUpperCase()){c=f;break}f=f.parentNode}if(!c)return null;b&&(g_bBrowserType_FF?e.selectNode(c):(g_bBrowserType_IE||g_bBrowserType_WK||g_bBrowserType_OP)&&d.selectAllChildren(c));return c}}catch(g){}return null}
function removeSpanTab(a){function b(a){return a?"SPAN"===a.nodeName&&(g_objPropertyUtil.hasClass(a,"tabSpan")||"pre"===a.style.whiteSpace&&a.firstChild&&a.firstChild===a.lastChild&&3===a.firstChild.nodeType&&"\t"===a.firstChild.nodeValue)?!0:!1:!1}for(var c=0,d=0;100>d&&void 0!=a;){d++;if(void 0!=a&&b(a.parentNode)){a=a.parentNode;a.parentNode.removeChild(a);c++;break}if(void 0!=a.children&&0<a.children.length)for(var e=a.children.length;0<=e;e--){var f=a.children[e];if(void 0!=f&&b(f)){a.removeChild(f);
c++;d=100;break}}if(void 0!=a&&b(a)){a.parentNode.removeChild(a);c++;break}if("P"===a.nodeName)break;a=a.previousSibling}return c}
function removeSpanTabSelection(a){dlog("removeSpanTabSelection nEditNumber:"+a);try{if(!window.attachEvent){var b=g_objEditWindow[a].getSelection().getRangeAt(0),c=b.startOffset;a=0;if(b.collapsed){var d=b.commonAncestorContainer;"P"===d.nodeName&&(d=d.childNodes[c-1]);a+=removeSpanTab(d)}else{var e=[],f=null;g_objNodeUtil.traverseNodesInRange(b,function(a){(a=g_objNodeUtil.getLoopParentElement(a,"p"))&&f!==a&&e.push(a);f=a});for(b=0;b<e.length;b++)a+=removeSpanTab(e[b])}return a}}catch(g){dalert(g)}finally{b=
null}}
function insertHTMLCodeAtSelection(a,b,c){try{if(window.attachEvent){var d=g_objEditorDocument[c].selection.createRange();fnObjectCheckNull(d)||d.pasteHTML(a)}else{var e=g_objEditorDocument[c],f=e?e.defaultView:null,g=f?f.getSelection():null;if(!g||1!==g.rangeCount)return;d=null;if(null!==a){d=e.createRange();var h=d.createContextualFragment(a);if(null===h)return;insertHTMLCodeAtSelection_SubDetail(h,c)}else{if(null===b)return;insertHTMLCodeAtSelection_SubDetail(b,c)}}g_objInsertUtil.saveSelectionRange_IE(0,c)}catch(k){dalert(k)}}
function objRangeTabCustom(a,b,c,d){a.selectNode(c);a.collapse(!1);b.removeAllRanges();void 0===d&&(d=a);b.addRange(d)}
function insertHTMLCodeAtSelection_SubDetail(a,b){try{if(!window.attachEvent){"tabSpan"!=a.className&&SelectionUtil.deleteSelection(b);var c=g_objEditWindow[b].getSelection(),d=c.getRangeAt(0),e=d.cloneRange(),f=d.startContainer,g=d.startOffset;11===a.nodeType&&a.firstChild===a.lastChild&&(a=a.firstChild);var h=a;11===a.nodeType&&(h=a.lastChild);var k=g_objEditMode.chkRangeLineCount(b);if(11===a.nodeType&&!g_objNodeUtil.hasAllTextInlineChild(a)||"HR"===a.nodeName||"TABLE"===a.nodeName)return g_objInsertUtil.insertTableAtSelection(a,
b);if("IMG"===a.nodeName||11===a.nodeType&&g_objNodeUtil.isAllChild(a,function(a){return 1===a.nodeType&&"IMG"===a.nodeName})||"VIDEO"===a.nodeName||"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_video_iframe_container_span"))return g_objInsertUtil.insertImgAtSelection(a,b);if(3===f.nodeType){var l=!1;if("tabSpan"===a.className&&"\t"===f.data)if(0!=g&&1===k)SelectionUtil.deleteSelection(b),insertAfter(f,a),objRangeTabCustom(d,c,h);else{g_objEditMode.rangeTabInsert(b,function(a){e=d.cloneRange();
h=a;objRangeTabCustom(d,c,h,e)});l=!0;return}if(!1===l){var m=f.splitText(g);if(m){d.collapsed?(m.parentNode.insertBefore(a,m),objRangeTabCustom(d,c,h)):0!=g&&1===k?(SelectionUtil.deleteSelection(b),insertAfter(f,a),objRangeTabCustom(d,c,h)):g_objEditMode.rangeTabInsert(b,function(a){e=d.cloneRange();h=a;objRangeTabCustom(d,c,h,e)});return}f?insertAfter(f,a):dalert()}}else if(g_objObjectSelectionInfo.bTxbx)l=f.childNodes[g],fnObjectCheckNull(l)?f.appendChild(a):f.insertBefore(a,l);else if(l=f.childNodes[g],
fnObjectCheckNull(l))"br"==g_objNodeUtil.getElementTagName(f).toLowerCase()?g_objNodeUtil.getParentElement(f).insertBefore(a,f):f.appendChild(a);else if("tabSpan"===a.className)if(d.collapsed)f.insertBefore(a,l);else{g_objEditMode.rangeTabInsert(b,function(a){e=d.cloneRange();h=a;objRangeTabCustom(d,c,h,e)});return}else f.insertBefore(a,l);d.selectNode(h);d.collapse(!1);c.removeAllRanges();c.addRange(d)}}catch(q){dlog(q),dalert(q)}finally{d=e=null}}
function fnReturnFalsePropagation(a){try{if(window.attachEvent)return!1;TBCancelBubbleEvent(a);a.stopPropagation()}catch(b){}}
function doCommonRestoreEditWinFF(a){try{g_bBrowserType_FF&&(g_objEditContainer[a].style.visibility="hidden",g_objEditContainer[a].style.display="none",0!=g_nFormEditMode&&1!=g_nFormEditMode||setEditModeConversion_FF(a,!1),g_objEditSourceContainer[a].style.position="relative",g_objEditSourceContainer[a].style.left="",g_objEditSourceContainer[a].style.top="",g_objEditSourceContainer[a].style.width="",g_objEditSourceContainer[a].style.height="",g_objEditSourceContainer[a].style.visibility="visible",
g_objEditSourceContainer[a].style.display="",g_objEditObjectSource[a].focus(),g_objEditContainer[a].style.visibility="visible",g_objEditContainer[a].style.display="",0!=g_nFormEditMode&&1!=g_nFormEditMode||setEditModeConversion_FF(a,!0),g_objEditSourceContainer[a].style.position="absolute",g_objEditSourceContainer[a].style.left="-1000px",g_objEditSourceContainer[a].style.top="-1000px",g_objEditSourceContainer[a].style.width="0px",g_objEditSourceContainer[a].style.height="0px",g_objEditSourceContainer[a].style.visibility=
"hidden")}catch(b){}}function setRestoreEditWinFF(a){try{g_bBrowserType_FF&&(doCommonRestoreEditWinFF(a),window.setTimeout("setEditModeFocus("+a+")",100))}catch(b){}}function setInitRestoreEditWinFF(a){}
function getSelectionControl(a){try{var b=null,c=null;if(window.attachEvent){var d=g_objEditorDocument[a].selection.createRange();c=d.length;1==c&&(b=9<=g_bBrowserVerInfo?d.item(0):d(0))}else{var e=g_objEditWindow[a].getSelection();c=e.rangeCount;if(1==c)if(g_objObjectSelectionInfo.bSelectObject)b=g_objObjectSelectionInfo.objSelectionObject;else{var f=e.getRangeAt(0).startContainer,g=e.getRangeAt(0).startOffset;b=f.childNodes[g]}}return{rangeLength:c,controlObject:b}}catch(h){}return{rangeLength:0,
controlObject:null}}function getObjNodeType(a,b){try{if(fnObjectCheckNull(a))return DZE_TAG_NONE;var c=g_objNodeUtil.getCheckElementTagName(a);a=DZE_TAG_NONE;"img"==c?a=DZE_TAG_IMG:"table"==c?a=DZE_TAG_TABLE:"tr"==c?a=DZE_TAG_TR:"td"==c||"th"==c?a=DZE_TAG_TD:"text"==c&&(a=DZE_TAG_TEXT);return a}catch(d){}return{rangeLength:0,controlObject:null}}
function getObjType(a,b){try{if(fnObjectCheckNull(a))return DZE_OBJ_NONE;var c=g_objNodeUtil.getCheckElementTagName(a);b=DZE_OBJ_NONE;c==DZE_TAG_IMG?b=isSVG(a)?DZE_OBJ_TEXTBOX:g_objVideoControl.isVideoSpan(a.parentNode)?DZE_OBJ_VIDEO:DZE_OBJ_IMG:c==DZE_TAG_TABLE?b=DZE_OBJ_TABLE:c==DZE_TAG_TR?b=DZE_OBJ_TR:c==DZE_TAG_TD||c==DZE_TAG_TH?b=DZE_OBJ_TD:c==DZE_TAG_TEXT?b=DZE_OBJ_TEXT:c==DZE_TAG_VIDEO?b=DZE_OBJ_VIDEO:c==DZE_TAG_SPAN?b=isTextBox(a)?DZE_OBJ_TEXTBOX:0===a.id.indexOf("dze_shape")?DZE_OBJ_SHAPE:
g_objVideoControl.isVideoSpan(a)?DZE_OBJ_VIDEO:DZE_OBJ_TEXT:c==DZE_TAG_EMBED||c==DZE_TAG_SVG?isSVG(a)&&(b=DZE_OBJ_TEXTBOX):c==DZE_TAG_HR?b=DZE_OBJ_HR:c==DZE_TAG_IFRAME&&g_objVideoControl.isVideoSpan(a.parentNode)&&(b=DZE_OBJ_VIDEO);return b}catch(d){dalert(d)}}function getBodyBackgroundColor(a){try{return g_objEditorDocument[a].body.style.backgroundColor}catch(b){}}
function setBodyBackgroundColor(a,b){try{g_objEditorDocument[b].body.style.backgroundColor=""!=a?a:""}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundColor_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundColor("+b+")",500))}}function retry_setBodyBackgroundColor(a){try{var b=g_strBodyBackgroundColor_Retry[a];g_objEditorDocument[a].body.style.backgroundColor=""!=b?b:""}catch(c){}}
function setBodyBackgroundImage(a,b){try{"none"==a.toLowerCase()?g_objEditorDocument[b].body.style.backgroundImage=a:g_objEditorDocument[b].body.style.backgroundImage="url("+a+")"}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundImage_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundImage("+b+")",500))}}
function retry_setBodyBackgroundImage(a){try{var b=g_strBodyBackgroundImage_Retry[a];"none"==b.toLowerCase()?g_objEditorDocument[a].body.style.backgroundImage=b:g_objEditorDocument[a].body.style.backgroundImage="url("+b+")"}catch(c){}}function getBodyBackgroundRepeat(a){try{return g_objEditorDocument[a].body.style.backgroundRepeat}catch(b){}}
function setBodyBackgroundRepeat(a,b){try{g_objEditorDocument[b].body.style.backgroundRepeat=a}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundRepeat_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundRepeat("+b+")",500))}}function retry_setBodyBackgroundRepeat(a){try{g_objEditorDocument[a].body.style.backgroundRepeat=g_strBodyBackgroundRepeat_Retry[a]}catch(b){}}
function addHTMLCode(a,b){try{if(window.attachEvent)ID_STRING_NAME_CONTROL!=g_objEditorDocument[b].selection.type.toLowerCase()&&g_objInsertUtil.insertTableCodeAtSelection(a,b);else{var c=getSelectionType();c.nodeType!=ID_SELECTION_ELEMENT_NODE&&c.nodeType!=ID_SELECTION_TEXT_NODE||g_objInsertUtil.insertTableCodeAtSelection(a,b)}}catch(d){dalert(d)}}
function getEditorImageUrl(a){try{void 0===a&&(a=0);var b=g_objEditorDocument[a].body.getElementsByTagName("img");a=[];for(var c=0;c<b.length;c++)a.push({type:"img",url:b[c].getAttribute("src")});return a}catch(d){return dalert(d),[]}}
function getEditorHTMLCode(a,b){try{g_bEditMode[b]||syncEditorHTMLCodeFromSouceTab(b);g_objTagUtil.updateCurFormTagAttr(b);var c=parseInt(b,10)+DZE_IFRAME_TMP_NO,d=g_objEditorDocument[c];d.body.innerHTML=g_objEditorDocument[b].body.innerHTML;g_objEditMode.showAllWriteAreaSet(c,!1);g_objEditMode.showAllContentEditableArea(c,!1);g_bAnchorTargetBlankYN&&setAnchorTargetBlank(c);g_bContentPTagStyleApply&&g_objAdjustDoc.setParaInlineStyle(c,d.body,!0);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(c);
g_objAdjustDoc.removeEqualDuplicatedDiv(d.body);g_objAdjustDoc.adjustRemoveGarbageText(c);g_objAdjustDoc.adjustGarbageEmptyTag(c,!1);g_objAdjustDoc.adjustDuplicateGarbage_P_Node(c);g_objAdjustDoc.remove_Br_Node_Inside_P_Node(c);g_objAdjustDoc.arrangeSpan(d.body);g_objEditMode.restoreFormCodeString(c);g_objNodeUtil.removeAllCommentNode(d.body);g_objCaretUtil.removeAllCaretMarker(d.body);g_objTableSelection.removeAllCellSelection(d.body);g_objTableUtil.removeAllDzeTable(d.body);g_objNodeUtil.removeElementsBySelector(d.body,
"li>div, li>p, span#dze_paste_caret_pos, ol>span, ul>span");g_objListUtil.replaceAllParaWithListItem(d.body);g_objCopyPaste.removeAllCaptureDiv(d.body);removeAllDarkReaderAttr(d.body);setTabSpanInlineStyle(d.body);g_objInputFormatEvent.removeAllEditingInput(d.body);b="";if(a){var e=getHTMLContentCodeByXHTMLFormat(c);b=HTMLEncode(e)}else b=getHTMLContentCodeByXHTMLFormat(c);b=removeZeroWidthSpace(b);!0===dzeUiConfig.bRemoveZeroWidthSpace&&(b=removeZeroWidthSpaceFromString(b));!0===dzeUiConfig.bRemoveXSS&&
(b=removeXSS(b));return b}catch(f){}return""}function getEditorHTMLCodeFromId(a,b){b=getnEditNumberFromEditId(b);return null==b?"":getEditorHTMLCode(a,b)}
function syncEditorHTMLCodeFromSouceTab(a){try{var b=g_objEditorDocument[a].body.innerHTML,c=g_objEditObjectSource[a].value,d=!0;if(!g_bSourceAreaScriptAllowYN){var e=c.toLowerCase().indexOf("<script",0);-1!=e&&(d=!1,g_objEditorDocument[a].body.innerHTML=b,fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT))}g_bSourceAreaIframeAllowYN||(e=c.toLowerCase().indexOf("<iframe",0),-1!=e&&(d=!1,g_objEditorDocument[a].body.innerHTML=b,fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME)));!0===dzeUiConfig.bRemoveXSS&&
(c=removeXSS(c));d&&(g_objEditorDocument[a].body.innerHTML=c);if(g_bBrowserType_IE){!g_bSourceAreaScriptAllowYN&&3!=g_nFormEditMode&&0<g_objEditorDocument[a].scripts.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b);if(!g_bSourceAreaIframeAllowYN){var f=g_objEditorDocument[a].getElementsByTagName("iframe");0<f.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)}g_objEditWindow[a].focus();g_objTagUtil.force_formTagSwitch(a)}else if(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)!g_bSourceAreaScriptAllowYN&&0<g_objEditorDocument[a].body.querySelectorAll("script").length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(f=g_objEditorDocument[a].body.querySelectorAll("iframe"),0<f.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)),g_bBrowserType_FF?3!=g_nFormEditMode&&setInitEnterCode(g_objEditorDocument[a].body,a):
g_bBrowserType_WK&&3!=g_nFormEditMode&&setInitEnterCode(g_objEditorDocument[a].body,a);tranAllAnchorHrefSharp(a);g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(a);g_objAdjustDoc.changeTableAlignToMarginStyle(a);g_objUndoRedo.registerInitialContentStack(a)}catch(g){dalert(g)}}function checkImgSrcPropertyValueAndForceRemove(a){try{var b=g_objEditorDocument[a].getElementsByTagName("img");for(a=0;a<b.length;a++)validateImgSrcPropertyValue(b[a].src)&&(b[a].src="")}catch(c){}}
function validateImgSrcPropertyValue(a){try{var b=a.toLowerCase();a=!1;var c=-1,d=b.length;c=b.indexOf(".jpg");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".gif");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".png");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".bmp");if(-1!=c){if(d!=c+4)return!0;a=!0}if(!a)return!0;for(d=0;d<g_arrCheckImgSrcPropertyValue.length;d++)if(-1!=b.indexOf(g_arrCheckImgSrcPropertyValue[d]))return!0;return!1}catch(e){}return!0}
function setEditorHTMLCode(a,b,c){try{g_objEditorDocument[c].body.innerHTML=b?HTMLDecode(a):a,3!=g_nFormEditMode&&setInitEnterCode(g_objEditorDocument[c].body,c)}catch(d){g_bLoadContentHTMLCode=!1;g_nLoadContentEditNumber[g_nLoadContentEditNumber.length]=c;g_bLoadContentEncode[g_bLoadContentEncode.length]=b;g_strLoadContentHTMLCode[g_strLoadContentHTMLCode.length]=a;return}try{tranAllAnchorHrefSharp(c),g_objEditMode.showAllWriteAreaSet(c,!0),!0===g_bBrowserType_FF&&g_objEditMode.setInputFormClickable(c),
g_objAdjustDoc.removeEqualDuplicatedDiv(g_objEditorDocument[c].body),g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(c),g_objAdjustDoc.changeTableAlignToMarginStyle(c),g_objEditMode.setZeroSpaceCodeToEmptyTd(c),g_objEditMode.convertFormCodeString(c,!1),adjustAmaranthLink(g_objEditorDocument[c].body),g_bBrowserType_IE&&g_objTagUtil.force_formTagSwitch(c),2==g_nFormEditMode?g_objEditMode.initShowEditableArea(c):g_objUndoRedo.registerInitialContentStack(c),g_objBindStore=null,g_objTableMiniMenu.showTableMiniMenu(!1,
null,c),setSelectionObjectInfo(!1,null,null)}catch(d){dalert(d)}}function setEditorHTMLCodeFromId(a,b,c){c=getnEditNumberFromEditId(c);return null==c?"":setEditorHTMLCode(a,b,c)}
function retrySetEditorHTMLCode(a,b,c){try{g_objEditorDocument[c].body.innerHTML=b?HTMLDecode(a):a,3!=g_nFormEditMode&&(setInitEnterCode(g_objEditorDocument[c].body,c),g_bBrowserType_IE&&""==a.trim()&&(g_objEditorDocument[c].body.innerHTML=window.attachEvent?"<p></p>":"<p><br/></p>")),tranAllAnchorHrefSharp(c),g_objEditMode.showAllWriteAreaSet(c,!0),g_objAdjustDoc.removeEqualDuplicatedDiv(g_objEditorDocument[c].body),g_objAdjustDoc.setOperation_EnterCode_Br_Node_P_Node(c),g_objAdjustDoc.changeTableAlignToMarginStyle(c),
2==g_nFormEditMode?g_objEditMode.initShowEditableArea(c):g_objUndoRedo.registerInitialContentStack(c),g_objEditMode.setZeroSpaceCodeToEmptyTd(c),g_objEditMode.convertFormCodeString(c,!1),g_bBrowserType_IE&&g_objTagUtil.force_formTagSwitch(c),g_objBindStore=null,g_objTableMiniMenu.showTableMiniMenu(!1,null,c)}catch(d){dalert(d)}}
function tranAllAnchorHrefSharp(a){try{var b=document.URL;b+="#";b=b.toLowerCase();var c=g_objEditorDocument[a].getElementsByTagName("A");for(a=0;a<c.length;a++){var d=c[a].href;d=d.toLowerCase();if(0==d.indexOf(b))if(b==d)c[a].href="#";else{var e=c[a].href,f=e.substring(b.length-1,e.length);c[a].href=f}}}catch(g){}}
function checkAnchorHrefSharp(a){try{var b=document.URL;b+="#";b=b.toLowerCase();var c=a.toLowerCase();if(0==c.indexOf(b))return b==c?"#":a.substring(b.length-1,a.length)}catch(d){}return null}function SetActiveEditorArea(a){g_objEditorDocument[a].body.setActive()}
function insertHTMLContent(a,b){try{if(window.attachEvent)g_objEditWindow[b].focus(),ID_STRING_NAME_CONTROL!=g_objEditorDocument[b].selection.type.toLowerCase()&&insertHTMLCodeAtSelection(a,null,b);else{g_objEditorDocument[b].body.focus();var c=getSelectionType();c.nodeType!=ID_SELECTION_ELEMENT_NODE&&c.nodeType!=ID_SELECTION_TEXT_NODE||insertHTMLCodeAtSelection(a,null,b)}}catch(d){}}
function addHTMLContent(a,b,c,d,e){try{if(0==c)if(window.attachEvent)if(null!=g_objLastRange[d]){if(""==g_objLastRange[d].htmlText)if(g_bActivate[d]){var f=g_objEditorDocument[d].selection.createRange();fnObjectCheckNull(f)||(g_strBookmark_IE=f.getBookmark(),insertHTMLCodeAtSelection(a,null,d))}else g_objLastRange[d].select(),insertHTMLCodeAtSelection(a,null,d);else g_objLastRange[d].select(),insertHTMLCodeAtSelection(a,null,d);g_objLastRange[d]=null}else if(g_bActivate[d])f=g_objEditorDocument[d].selection.createRange(),
fnObjectCheckNull(f)||(g_strBookmark_IE=f.getBookmark(),insertHTMLCodeAtSelection(a,null,d));else{var g=g_objEditorDocument[d].body.innerHTML+a;g_objEditorDocument[d].body.innerHTML=g}else{if(g_bBrowserType_IE&&null!=g_objLastRange[d]){var h=g_objEditWindow[d].getSelection();h.removeAllRanges();h.addRange(g_objLastRange[d])}var k=getSelectionType();k.nodeType!=ID_SELECTION_ELEMENT_NODE&&k.nodeType!=ID_SELECTION_TEXT_NODE||insertHTMLCodeAtSelection(a,b,d)}else 1==c?(g="",g=a+g_objEditorDocument[d].body.innerHTML,
g_objEditorDocument[d].body.innerHTML=g):2==c&&(g="",g=g_objEditorDocument[d].body.innerHTML+a,g_objEditorDocument[d].body.innerHTML=g);g_objEditMode.setZeroSpaceCodeToEmptyTd(d);g_objEditMode.convertFormCodeString(d,!0);!0===e&&g_objUndoRedo.registerUndoRedoStack(0,d)}catch(l){dalert(l)}}function replaceHTMLContent(a,b){try{g_objEditorDocument[b].body.innerHTML=a}catch(c){dalert(c)}}
function getEditorText(a){try{return g_objPropertyUtil.getTextContent(g_objEditorDocument[a].body)}catch(b){}return""}function setEditModeConversion_FF(a,b){try{!g_bBrowserType_FF||0!=g_nFormEditMode&&1!=g_nFormEditMode||(g_objEditorDocument[a].body.contentEditable=b)}catch(c){}}
function getEditorSelectionText(a){try{var b="";if(window.attachEvent){var c=g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return"";var d=c.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var e=c.createRange();if(fnObjectCheckNull(e))return"";b=e.text}}else if(d=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d)c=g_objEditWindow[g_nActiveEditNumber].getSelection(),b=c.getRangeAt(0).toString();return b}catch(f){}return""}
function findCountEditorText(a,b){try{if(""==b)return;var c=!0,d=0,e=fnGetEditorDocument(a);if(g_bBrowserType_IE)for(var f=e.body.createTextRange();c;){if(c=f.findText(b))d++,f.collapse(!1)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var g=fnGetEditorWindow(a),h=e.body.scrollLeft,k=e.body.scrollTop,l=g.getSelection();for(l.removeAllRanges();c;)(c=g.find(b))&&d++;l=g.getSelection();l.removeAllRanges();g.scrollTo(h,k)}return d}catch(m){}return 0}
function findEditorText(a,b){try{if(""==b)return 0;var c=-1;if(g_bBrowserType_IE){var d=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=d.body.createTextRange());var e=g_objFindTextRange.findText(b);e?(c=1,g_nFindTextCount++,g_objFindTextRange.select(),g_objFindTextRange.collapse(!1)):(c=0==g_nFindTextCount?2:3,g_nFindTextCount=0,g_objFindTextRange=d.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var f=fnGetEditorWindow(a);(e=f.find(b))?
c=1:(c=3,f.getSelection().removeAllRanges())}return c}catch(g){}return-1}
function findEditorTextDetail(a,b,c,d,e,f,g,h){try{if(""==b)return 0;f=-1;var k=g_objEditorDocument[a],l=k.defaultView;if(l.find){var m=l.getSelection(),q=GetCurRangeProp(a);!0===g&&m.removeAllRanges();if(l.find(b,d,c,!1,e))f=1;else{m.removeAllRanges();var n=k.body.scrollTop;l.find(b,d,c,!1,e)?(f=3,k.body.scrollTop=n):f=2}1===f?g_objCaretUtil.scrollToCaret(a):2!==f&&3!==f||!q.isValid()||(m.removeAllRanges(),m.addRange(q.getNativeRange()))}else k.body.createTextRange&&(g_objFindTextRange&&!0!==g||
(g_objFindTextRange=k.body.createTextRange()),g=1E5,l=0,1===c&&(l|=1,g*=-1),1===e&&(l|=2),1===d&&(l|=4),g_objFindTextRange.text&&(1===d?g_objFindTextRange.text===b:g_objFindTextRange.text.toLowerCase()===b.toLowerCase())&&g_objFindTextRange.collapse(0===c?!1:!0),g_objFindTextRange.findText(b,g,l)?(f=1,g_objFindTextRange.select()):(g_objFindTextRange=k.body.createTextRange(),f=g_objFindTextRange.findText(b,g,l)?3:2),1===f&&g_objCaretUtil.scrollToCaret(a));return f}catch(p){dalert(p)}return-1}
function replaceTextCommon(a,b,c){try{var d=a.getRangeAt(0);a.removeAllRanges();d.deleteContents();var e=d.startContainer,f=d.startOffset;d=b.createRange();if(3==e.nodeType)e.insertData(f,c),d.setEnd(e,f+c.length),d.setStart(e,f+c.length);else{var g=e.childNodes[f],h=b.createTextNode(c);e.insertBefore(h,g);d.setEnd(g,0);d.setStart(g,0)}a.addRange(d);return!0}catch(k){}return!1}
function replaceEditorText(a,b,c){try{if(""==b)return 0;var d=-1;if(g_bBrowserType_IE){var e=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=e.body.createTextRange());var f=g_objFindTextRange.findText(b);f?(d=1,g_objFindTextRange.select(),g_objFindTextRange.text=c,g_objFindTextRange.findText(c,-c.length,1),g_objFindTextRange.select()):(d=3,g_objFindTextRange=e.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var g=fnGetEditorWindow(a);if(f=
g.find(b)){d=1;var h=g.getSelection();if(1!=h.rangeCount)return-1;e=fnGetEditorDocument(a);if(!replaceTextCommon(h,e,c))return-1;g.find(c,!1,!0)}else d=3,h=g.getSelection(),h.removeAllRanges()}return d}catch(k){}return-1}
function replaceEditorTextDetail(a,b,c,d,e,f,g,h,k){try{if(""==b)return 0;var l=-1,m=g_objEditorDocument[a],q=m.defaultView,n=null;if(q.find){var p=q.getSelection(),t=GetCurRangeProp(a);if(!0===h)p.removeAllRanges();else{var r=GetCurRange(a);r&&(r.collapse(1===d?!1:!0),p.removeAllRanges(),p.addRange(r));r=null}if(q.find(b,e,d,!1,f)){var u=GetCurRangeProp(a);t.isValid()&&u.isValid()&&t.equal(u)?l=1:(l=5,g_objCaretUtil.scrollToCaret(a))}else{p.removeAllRanges();var v=m.body.scrollTop;q.find(b,e,d,!1,
f)?(l=3,m.body.scrollTop=v):l=2;t.isValid()&&(p.removeAllRanges(),p.addRange(t.getNativeRange()))}1===l&&(g_objEditMode.checkSelectionContentEditable(a)?replaceTextCommon(p,m,c)||(l=-1):l=4);n=function(){1===l&&(q.find(b,e,d,!1,f)||(l=6),g_objCaretUtil.scrollToCaret(a))};k?setTimeout(function(){n();k(l)},100):n()}else if(m.body.createTextRange){g_objFindTextRange&&!0!==h||(g_objFindTextRange=m.body.createTextRange());var x=1E5,w=0;1===d&&(w|=1,x*=-1);1===f&&(w|=2);1===e&&(w|=4);var y=g_objFindTextRange.duplicate();
g_objFindTextRange.findText(b,x,w)?g_objFindTextRange.isEqual(y)?l=1:(l=5,g_objFindTextRange.select()):(g_objFindTextRange=m.body.createTextRange(),l=g_objFindTextRange.findText(b,x,w)?3:2);1===l&&(g_objEditMode.checkSelectionContentEditable(a)?g_objFindTextRange.text=c:l=4);n=function(){1===l&&(g_objFindTextRange.findText(b,x,w)||(l=6),g_objFindTextRange.select(),g_objCaretUtil.scrollToCaret(a))};k?setTimeout(function(){n();k(l)},100):n()}return l}catch(z){dalert(z)}return-1}
function replaceAllEditorText(a,b,c,d,e,f,g){try{if(""==b)return-1;var h=g_objEditorDocument[a],k=h.defaultView;g=0;if(k.find){var l=GetCurRangeProp(a),m=k.getSelection();for(m.removeAllRanges();k.find(b,e,d,!1,f);){if(1!==m.rangeCount)return-1;if(g_objEditMode.checkSelectionContentEditable(a)){if(!replaceTextCommon(m,h,c))return-1;g++}}m.removeAllRanges();l.isValid()&&m.addRange(l.getNativeRange())}else if(h.body.createTextRange){var q=h.body.createTextRange();h=1E5;k=0;1===d&&(k|=1,h*=-1);1===f&&
(k|=2);1===e&&(k|=4);for(e=g_objEditMode;q.findText(b,h,k);)e.checkSelectionContentEditable(a)&&(q.select(),q.text=c,g++,q.collapse(0===d?!1:!0))}else return-1;return g}catch(n){dalert(n)}return-1}
function resizeEditor(a,b,c){try{g_arrEditorWidth[a]=b,g_arrEditorHeight[a]=c,g_nEditAreaSetHeight=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight,g_objEditSetContainer[a].style.width=g_arrEditorWidth[a]+"px",g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px",g_objMainEditAreaContainer[a].style.height=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight+"px",g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=g_arrEditorHeight[a]-
g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-22+"px"),document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+"px"}catch(d){}}
function resizeEditor_Height(a,b){try{200>b&&(b=200);"undefined"==typeof b?b=document.documentElement.clientHeight:dzeEnvConfig.iFrameLayer&&g_bEditorHeightIFrameYN&&("100%"!=window.frameElement.getAttribute("height")&&(window.frameElement.style.height=b+"px"),window.frameElement.parentNode.style.height=b+"px",b=document.documentElement.clientHeight);g_nTabBarSetHeight=0;if(g_bTabBar_Display){var c=document.getElementById("TB_TABMODE_TR_CONTAINER_"+a);null!=c&&(g_nTabBarSetHeight=c.offsetHeight)}g_nToolbarSetHeight=
0;var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(g_nToolbarSetHeight=d.offsetHeight);g_arrEditorHeight[a]=b;g_nEditAreaSetHeight=b-g_nToolbarSetHeight-g_nTabBarSetHeight;if(!(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display||g_bTabBar_Display)){var e=document.getElementById("dzeditor_Parent_"+a),f=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(e,"border-top-width",a).replace(/px/,""),10)+parseInt(g_objPropertyUtil.getElementStyleAttributeValue(e,
"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=f}else if(!g_bTabBar_Display){var g=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a),h=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(g,"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=h}g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px";g_objEditSetContainer[a].setAttribute("height",g_arrEditorHeight[a]);document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).style.height=g_nEditAreaSetHeight+
"px";document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).setAttribute("height",g_nEditAreaSetHeight);document.getElementById("dzeditor_Parent_"+a).style.height=g_nEditAreaSetHeight-1+"px";document.getElementById("dzeditor_"+a).style.height=g_nEditAreaSetHeight-2+"px";document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+"px";document.getElementById("TB_CONTAINER_"+a).parentNode.setAttribute("height",document.getElementById("TB_CONTAINER_"+
a).offsetHeight);g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=g_nEditAreaSetHeight-22+"px");if(!0===g_browserCHK.iOS){var k=document.getElementById("EDIT_SET_CONTAINER_"+a).querySelectorAll("table#TB_CONTAINER_"+a)[0].offsetHeight,l=document.getElementById("dzeditor_Parent_"+a).getAttribute("style");document.getElementById("dzeditor_Parent_"+a).setAttribute("style",l+" position: fixed; right: 0px; bottom: 0px; left: 0px; top: "+k+"px; overflow-y: scroll; -webkit-overflow-scrolling:touch; z-index: 20008;");
document.getElementById("dzeditor_"+a).setAttribute("scrolling","yes")}}catch(m){dalert(m)}}
function resizeInput(a,b,c,d){try{if(a&&1===a.nodeType&&"INPUT"===a.nodeName&&a.hasAttribute("dze_auto_resize")&&!(0>g_objNodeUtil.arrTextInputType.indexOf(a.type))){var e=a.value;if(!e)return b&&(a.style.width=b+"px"),a;var f=a.ownerDocument.createElement("span");f.id=a.id;f.className=a.className;var g=parseStyle(a.getAttribute("style"));g&&Object.keys(g).forEach(function(a){"width"!==a&&(f.style[a]=g[a])},this);f.style.whiteSpace="pre";f.innerHTML=e;var h=null;appendBodyTemporary(f,null,function(){h=
f.offsetWidth});h&&(h+=5,c&&(h=Math.max(h,c)),d&&(h=Math.min(h,d)),a.style.width=h+"px");return a}}catch(k){dalert(k)}}function setAnchorTargetBlank(a){try{var b=g_objEditorDocument[a].getElementsByTagName("A");for(a=0;a<b.length;a++)b[a].target="_blank"}catch(c){}}function getImageList(a){try{var b=[],c=g_objEditorDocument[a].getElementsByTagName("IMG");for(a=0;a<c.length;a++)b[a]=getImageSrcValue(c[a].src);return b}catch(d){}}
function getImageSrcValue(a){try{var b=document.location.href;if(g_bBrowserType_IE){var c=b.lastIndexOf("/");if(b.substring(0,c+1)==a)return""}else if(b==a)return"";if(null!=g_arrImgSrcRemoveDomain){var d=a.toLowerCase();for(b=0;b<g_arrImgSrcRemoveDomain.length;b++)if(0==d.indexOf(g_arrImgSrcRemoveDomain[b])){var e=d.length,f=g_arrImgSrcRemoveDomain[b].length;if(f<=e&&"/"==d.charAt(f))return a.substring(f,e)}}return a}catch(g){}}
function setContentPTagStyleApply(a,b,c){try{b=b||g_objEditorDocument[a];c=c||!1;for(var d=null,e=function(b,e){var f=g_objNodeUtil;if(c&&f.checkTagName(b.parentNode,"td","th")){var g=b.parentNode;switch(e){case "font-family":if(g=g.style.fontFamily)return g;break;case "font-size":if(g=g.style.fontSize)return g;break;case "color":if(g=g.style.color)return g;break;case "line-height":if(g=g.style.lineHeight)return g;break;case "letter-spacing":if(g=g.style.letterSpacing)return g}}if(c&&!f.checkTagName(b.parentNode,
"body")&&(b=(d=d||g_objEditWindow[a].getComputedStyle(b,null))?d.getPropertyValue(e):""))return b;switch(e){case "font-family":return g_strBodyFontFamily;case "font-size":return g_strBodyFontSize;case "color":return g_strBodyFontColor;case "line-height":return g_strBodyLineHeight;case "letter-spacing":return g_strBodyLetterSpacing}},f=b.getElementsByTagName("P"),g=0;g<f.length;g++){var h=f[g];d=null;var k=f[g].style.marginTop;if(""==k||null==k)f[g].style.marginTop=g_strPTagMarginTop;var l=f[g].style.marginBottom;
if(""==l||null==l)f[g].style.marginBottom=g_strPTagMarginBottom;var m=h.style.fontFamily;if(""==m||null==m)h.style.fontFamily=e(h,"font-family");var q=h.style.fontSize;if(""==q||null==q)h.style.fontSize=e(h,"font-size");var n=h.style.color;if(""==n||null==n)h.style.color=e(h,"color");var p=h.style.lineHeight;if(""==p||null==p)h.style.lineHeight=e(h,"line-height");var t=h.style.letterSpacing;if(""==t||null==t)h.style.letterSpacing=e(h,"letter-spacing")}var r=b.getElementsByTagName("BLOCKQUOTE");for(g=
0;g<r.length;g++){k=r[g].style.marginTop;if(""==k||null==k)r[g].style.marginTop=g_strPTagMarginTop;l=r[g].style.marginBottom;if(""==l||null==l)r[g].style.marginBottom=g_strPTagMarginBottom;m=r[g].style.fontFamily;if(""==m||null==m)r[g].style.fontFamily=g_strBodyFontFamily;q=r[g].style.fontSize;if(""==q||null==q)r[g].style.fontSize=g_strBodyFontSize;n=r[g].style.color;if(""==n||null==n)r[g].style.color=g_strBodyFontColor;p=r[g].style.lineHeight;if(""==p||null==p)r[g].style.lineHeight=g_strBodyLineHeight;
t=r[g].style.letterSpacing;if(""==t||null==t)r[g].style.letterSpacing=g_strBodyLetterSpacing}var u=b.querySelectorAll("td, th");for(g=0;g<u.length;g++){m=u[g].style.fontFamily;if(""==m||null==m)u[g].style.fontFamily=g_strBodyFontFamily;q=u[g].style.fontSize;if(""==q||null==q)u[g].style.fontSize=g_strBodyFontSize;n=u[g].style.color;if(""==n||null==n)u[g].style.color=g_strBodyFontColor;p=u[g].style.lineHeight;if(""==p||null==p)u[g].style.lineHeight=g_strBodyLineHeight;t=u[g].style.letterSpacing;if(""==
t||null==t)u[g].style.letterSpacing=g_strBodyLetterSpacing}}catch(v){dalert(v)}}function getHTMLContentCodeByXHTMLFormat(a){try{return g_bContentXHTMLFormatYN?g_objCodeParser.convertXHTMLCode(g_objEditorDocument[a].body.innerHTML):g_objEditorDocument[a].body.innerHTML}catch(b){}}function setContentXHTMLFormat(a,b){try{g_bContentXHTMLFormatYN=a,g_bContentXHTMLTabSettingYN=b}catch(c){}}
function setIFrameSrcBlankForTabMode(a){try{var b=g_objEditorDocument[a].getElementsByTagName("iframe");for(a=0;a<b.length;a++)b[a].src="about:blank"}catch(c){}}
function checkSetIFrameSrcBlankForDelete(a){try{if(!window.addEventListener){var b=g_objEditorDocument[a].getElementsByTagName("iframe");if(0!=b.length){for(var c=[],d=[],e=(new Date).getTime(),f=0;f<b.length;f++)if(null==b[f].id||""==b[f].id){var g="i_"+e+"_"+f;c[f]=g;b[f].id=g;d[f]=!1}else c[f]=b[f].id.toLowerCase(),d[f]=!0;var h=g_objEditorDocument[a].selection.createRange().htmlText.toLowerCase();for(f=0;f<c.length;f++)-1!=h.indexOf(c[f])?b[f].src="about:blank":d[f]||(b[f].id="")}}}catch(k){}}
function checkTextNodeAllWhiteCode(a){try{for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(9!=c&&10!=c&&13!=c)return!1}return!0}catch(d){}return!1}function checkTextNodeAllWhiteCode_Plus_Space(a){try{for(var b=0;b<a.length;b++){var c=a.charCodeAt(b);if(9!=c&&10!=c&&13!=c&&32!=c)return!1}return!0}catch(d){}return!1}
function checkTextNodeValue(a){try{if(!a||0==a.length)return null;for(var b={bEveryWhiteSpace:!0,bSomeZeroWidthSpace:!1},c=0,d=a.length;c<d;c++)switch(a.charCodeAt(c)){case 9:case 10:case 13:case 32:break;case 8203:case 8204:case 8205:case 65279:b.bSomeZeroWidthSpace=!0;break;default:b.bEveryWhiteSpace=!1}return b}catch(e){return dalert(e),null}}
var DZE_UPLOAD_EVENT={uploaded_file_list:[],initUploadedFileList:function(a){"undefined"==typeof this.uploaded_file_list[a]&&(this.uploaded_file_list[a]=[])},addUploadedFileList:function(a,b){this.initUploadedFileList(a);this.uploaded_file_list[a].push(b)},removeUploadedFileList:function(a,b){this.initUploadedFileList(a);for(var c=[],d=0;d<this.uploaded_file_list[a].length;d++)b!=this.uploaded_file_list[a][d].url&&c.push(this.uploaded_file_list[a][d]);this.uploaded_file_list[a]=c},getUploadedFileList:function(a){this.initUploadedFileList(a);
this.checkDeleted(a);return this.uploaded_file_list[a]},emptyUploadedFileList:function(a){this.initUploadedFileList(a);this.uploaded_file_list[a]=[]},checkDeleted:function(a){try{var b=this.uploaded_file_list[a];if(b&&b[0]){var c=g_objEditorDocument[a];if(c){var d=[];forEach(b,function(a,b){b&&b.url&&(d[a]=isRelativeUrl(b.url)?getFullUrlFromPath(b.url):b.url)},this);var e=[],f=c.body.querySelectorAll("img[src]");forEach(f,function(a,b){if(a=b.src)a=isRelativeUrl(a)?getFullUrlFromPath(a):a,0>e.indexOf(a)&&
e.push(a)},this);forEach(b,function(a,b){b.deleted=0>e.indexOf(d[a])?!0:!1},this);return b}}}catch(g){dalert(g)}},setComplete:function(a,b){try{if(b&&b.url){dlog("DZE_UPLOAD_EVENT. onComplete === (nEditNumber:"+a+")");this.initUploadedFileList(a);var c=b.type,d=b.filename||[];Array.isArray(b.filename)||(d=[b.filename]);var e=b.url||[];Array.isArray(b.url)||(e=[b.url]);var f=new Date,g=f&&f.toLocaleString?f.toLocaleString("en-US"):"";forEach(e,function(b,e){this.addUploadedFileList(a,{url:e,filename:d[b]||
"",type:c,time:g})},this);this.onComplete(a,b)}}catch(h){dalert(h)}},onComplete:function(a,b){},pasteInsertImageFromClipboard:function(a,b){try{if(dlog("---pasteInsertImageFromClipboard start----"),!1!==dzeUiConfig.bUseServerUpload){if(window.addEventListener)if(g_bBrowserType_IE||g_bBrowserType_FF)dlog("---IE-FF---"),g_objCopyPaste.setTimeoutForPaste(function(){for(var a=g_objCopyPaste.getPasteDiv().getElementsByTagName("img"),c=0;c<a.length;c++)if(/^data:image\/png;base64,/i.test(a[c].src)){dlog(a[c].src);
var d=new XMLHttpRequest;d.open("POST",dzeEnvConfig.strSavePasteImageURL,!0);d.onload=function(){var d=this.responseText;dlog("file upload result: "+d);d=duzon_http.parseJSON(d);dlog(d);"success"==d.result&&(a[c].src=d.url,DZE_UPLOAD_EVENT.setComplete(b,d));g_objCopyPaste.resume()};d.onerror=function(){alert("Error");g_objCopyPaste.resume()};var e=new FormData;e.append("dze_upimage_data",a[c].src);d.send(e);g_objCopyPaste.pause();break}},0);else if(g_bBrowserType_WK||g_bBrowserType_OP){var c="";a.clipboardData&&
a.clipboardData.getData&&(c=a.clipboardData.getData("text/plain"));dlog("---pastedText---");dlog(c);if(""!==c){g_objCopyPaste.setTimeoutForPaste(function(){for(var a=g_objCopyPaste.getPasteDiv().getElementsByTagName("img"),b=0;b<a.length;b++)/^file:\/\//i.test(a[b].src)&&a[b].parentNode.removeChild(a[b])},0);return}var d=new XMLHttpRequest;d.open("POST",dzeEnvConfig.strSavePasteImageURL,!0);d.onload=function(){var a=this.responseText;dlog("file upload result: "+a);a=duzon_http.parseJSON(a);dlog(a);
"success"==a.result&&(addHTMLContent("<img src='"+a.url+"' />",null,0,b),DZE_UPLOAD_EVENT.setComplete(b,a),g_objAdjustDoc.deleteDuplicatedImage(b,a.filename),dzeUiConfig.bUsePasteCapture||g_objUndoRedo.registerUndoRedoStack(0,b));g_objCopyPaste.resume()};d.onerror=function(){alert("Error");g_objCopyPaste.resume()};var e=(a.clipboardData||a.originalEvent.clipboardData).items;c=null;g_objAdjustDoc.strImgUrl=null;for(var f=0;f<e.length;f++)if(0===e[f].type.indexOf("image"))c=e[f].getAsFile();else if(0===
e[f].type.indexOf("text/html")){var g=a.clipboardData.getData("text/html");g=g.substring(g.indexOf("<img"),g.length);g=g.substring(0,g.indexOf("/>")+2);var h=g_objEditorDocument[b].createElement("div");h.innerHTML=g;g_objAdjustDoc.strImgUrl=h.firstChild.src}if(null!==c){dlog("blob isgood");TBCancelBubbleEvent(a);var k=new FileReader;k.onload=function(a){var b=new FormData;b.append("dze_upimage_data",a.target.result);d.send(b);g_objCopyPaste.pause()};k.onerror=function(a){g_objCopyPaste.resume()};
k.readAsDataURL(c);g_objCopyPaste.pause()}}dlog("---pasteInsertImageFromClipboard End---")}}catch(l){dalert(l),g_objCopyPaste.resume()}},allow_dnd_file_ext:["gif","jpg","jpeg","png","bmp"],dnd_upload_list:[],onUploadSuccess:null,onUploadError:null,onUploadComplete:null,dragNdropInsertImage:function(a,b){try{if(dlog("dragNdropInsertImage=== CAll"),a&&a.length){this.dnd_upload_list=[];this.onUploadSuccess=function(){};this.onUploadError=function(){};this.onUploadComplete=function(){};for(var c=0;c<
a.length;c++)this.dnd_upload_list.push(a[c]);if(!0===dzeUiConfig.bUseImageExtUpload)g_objExtUploader.initWithUploadList(b,this.dnd_upload_list);else{var d=this.dnd_upload_list.length,e=!1;this.onUploadSuccess=function(){e=!0;d--;if(0>=d)this.onUploadComplete()}.bind(this);this.onUploadError=function(){d--;if(0>=d)this.onUploadComplete()}.bind(this);this.onUploadComplete=function(){if(!e)return!1;g_objUndoRedo.registerUndoRedoStack(0,b);editor_onselectionchange(b)}.bind(this);this.dragNdropUpload(b)}}}catch(f){dalert(f)}},
dragNdropUpload:function(a){try{dlog("\uc5c5\ub85c\ub4dc \ud560 \ud30c\uc77c \uac1c\uc218 : "+DZE_UPLOAD_EVENT.dnd_upload_list.length);var b=DZE_UPLOAD_EVENT.dnd_upload_list.length;if(0<DZE_UPLOAD_EVENT.dnd_upload_list.length){var c=new XMLHttpRequest;c.open("POST",dzeEnvConfig.strUploadImageURL,!0);var d=setTimeout(function(){try{c.abort(),dlog("xhr timeout")}catch(h){}},6E4);c.onload=function(){clearTimeout(d);var c=this.responseText;dlog("file upload result: "+c);c=duzon_http.parseJSON(c);if("success"!=
c.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR);else{dragDropInsertHTML("<img id='dze_idx_temporary_image_"+b+"' src='"+c.url+"' />",a);var e=g_objEditorDocument[a].getElementById("dze_idx_temporary_image_"+b);e&&(e.style.display="none",e.onload=function(){this.style.display="";this.removeAttribute("id");setOrgImageSize(this,getMaxBoundSize(a,this),!0);DZE_UPLOAD_EVENT.onUploadSuccess()},e.onerror=function(){this.style.display="";DZE_UPLOAD_EVENT.onUploadSuccess()});DZE_UPLOAD_EVENT.setComplete(a,
c);DZE_UPLOAD_EVENT.dragNdropUpload(a)}};c.onerror=function(){clearTimeout(d);dlog("xhr Error")};dlog("type:"+typeof DZE_UPLOAD_EVENT.dnd_upload_list);var e=DZE_UPLOAD_EVENT.dnd_upload_list.shift();dlog("destFile---");dlog("\uc5c5\ub85c\ub4dc \ud560 \ud30c\uc77c \uac1c\uc2182 : "+DZE_UPLOAD_EVENT.dnd_upload_list.length);var f=e.name.split(".").pop().toLowerCase();if(!inArray(f,DZE_UPLOAD_EVENT.allow_dnd_file_ext))try{clearTimeout(d);c.abort();alert('"'+e.name+'" '+ID_RES_CONST_STRING_CANNOT_UPLOAD_FILE_TYPE+
" "+DZE_UPLOAD_EVENT.allow_dnd_file_ext.join(", "));return}catch(h){return}var g=new FormData;g.append("dze_upimage_file",e);g.append("type","dnd_upload_image");c.send(g)}}catch(h){dalert(h)}}};g_getSelectionAttribute_Absolute=!1;
function increaseFontSize(a,b){try{if("undefined"==typeof a||0!=a)a=!0;strSelectionType=window.attachEvent?g_objEditorDocument[b].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)dlog("select type is not support -> strSelectionType : "+strSelectionType);else{g_getSelectionAttribute_Absolute=!0;var c=g_objPropertyUtil.getSelectionAttributeValue(b);g_getSelectionAttribute_Absolute=
!1;duzon_dialog.initSelectionFontStyleList(c);dlog("fontSize:"+duzon_dialog.selectionFontStyleList.fontSize);if(""!=duzon_dialog.selectionFontStyleList.fontSize){dlog("curr font size : "+duzon_dialog.selectionFontStyleList.fontSize);var d=updateHandlerUI.getMappingIndex_FontSize(duzon_dialog.selectionFontStyleList.fontSize,b);dlog("fontSizeIdx:"+d);a=!0===a?d+1:d-1;dlog("increaseIdx:"+a);if("undefined"!=typeof g_objComboBoxWin.arrFontSize[a]&&""!=g_objComboBoxWin.arrFontSize[a])g_nLetterOperationType=
ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(g_objComboBoxWin.arrFontSize[a]);else{a=-1;for(b=0;b<g_objComboBoxWin.arrFontSize.length;b++)if(parseInt(duzon_dialog.selectionFontStyleList.fontSize.replace(/pt/,""),10)<=parseInt(g_objComboBoxWin.arrFontSize[b].replace(/pt/,""),10)){a=b;break}0<=a&&g_objComboBoxWin.setComboBox(g_objComboBoxWin.arrFontSize[a])}}}}catch(e){dalert(e)}}
function removeEditorTempTagsFromStrHtml(a){try{var b=document.createElement("div");b.innerHTML=a;var c=b.getElementsByTagName("table");for(a=0;a<c.length;a++)if("dze_tb_layout"==c[a].className){c[a].removeAttribute("class");for(var d=c[a].getElementsByTagName("*"),e=0;e<d.length;e++)"th"!=d[e].nodeName.toLowerCase()&&"td"!=d[e].nodeName.toLowerCase()||"dze_tb_layout_td"!=d[e].className||d[e].removeAttribute("class")}var f=b.getElementsByTagName("a");for(a=0;a<f.length;a++)"dze_bookmark_flag"==f[a].className?
f[a].removeAttribute("class"):"dze_init_cursor_flag"==f[a].className&&f[a].removeAttribute("class");var g=b.getElementsByTagName("div");for(a=0;a<g.length;a++)"dze_printpagebreak_guide"==g[a].className&&(g[a].style.display="none");var h=b.getElementsByTagName("span");for(a=0;a<h.length;a++)"dze_init_cursor_flag"==h[a].className&&(h[a].style.display="none");return b.innerHTML}catch(k){dalert(k)}}
function replaceEditorTempTagsFromEditor(a){try{for(var b=g_objEditorDocument[a].getElementsByTagName("table"),c=0;c<b.length;c++)if("dze_tb_layout"==b[c].className){b[c].className="dze_tb_layout_dummy";for(var d=b[c].getElementsByTagName("*"),e=0;e<d.length;e++)"th"!=d[e].nodeName.toLowerCase()&&"td"!=d[e].nodeName.toLowerCase()||"dze_tb_layout_td"!=d[e].className||(d[e].className="dze_tb_layout_td_dummy")}var f=g_objEditorDocument[a].getElementsByTagName("a");for(c=0;c<f.length;c++)"dze_bookmark_flag"==
f[c].className?f[c].className="dze_bookmark_flag_dummy":"dze_init_cursor_flag"==f[c].className&&(f[c].className="dze_init_cursor_flag_dummy");var g=g_objEditorDocument[a].getElementsByTagName("div");for(c=0;c<g.length;c++)"dze_printpagebreak_guide"==g[c].className&&(g[c].className="dze_printpagebreak_guide_dummy");var h=g_objEditorDocument[a].getElementsByTagName("span");for(c=0;c<h.length;c++)"dze_init_cursor_flag"==h[c].className&&(h[c].className="dze_init_cursor_flag_dummy")}catch(k){dalert(k)}}
function recoverEditorTempTagsFromEditor(a){try{for(var b=g_objEditorDocument[a].getElementsByTagName("table"),c=0;c<b.length;c++)if("dze_tb_layout_dummy"==b[c].className){b[c].className="dze_tb_layout";for(var d=b[c].getElementsByTagName("*"),e=0;e<d.length;e++)"th"!=d[e].nodeName.toLowerCase()&&"td"!=d[e].nodeName.toLowerCase()||"dze_tb_layout_td_dummy"!=d[e].className||(d[e].className="dze_tb_layout_td")}var f=g_objEditorDocument[a].getElementsByTagName("a");for(c=0;c<f.length;c++)"dze_bookmark_flag_dummy"==
f[c].className?f[c].className="dze_bookmark_flag":"dze_init_cursor_flag_dummy"==f[c].className&&(f[c].className="dze_init_cursor_flag");var g=g_objEditorDocument[a].getElementsByTagName("div");for(c=0;c<g.length;c++)"dze_printpagebreak_guide_dummy"==g[c].className&&(g[c].className="dze_printpagebreak_guide");var h=g_objEditorDocument[a].getElementsByTagName("span");for(c=0;c<h.length;c++)"dze_init_cursor_flag_dummy"==h[c].className&&(h[c].className="dze_init_cursor_flag")}catch(k){dalert(k)}}
function removeGabageEmptyTag(a){try{var b=g_objEditorDocument[a].getElementsByTagName("*"),c=b.length;if(c)for(a=c-1;0<=a;a--)"ol"!=b[a].nodeName.toLowerCase()&&"ul"!=b[a].nodeName.toLowerCase()||""!=b[a].innerHTML.trim()||(dlog(":::removeGabageEmptyTag OL/UL remove ok cnt : "+a),b[a].parentNode.removeChild(b[a]))}catch(d){dalert(d)}}
function getCurrentPostionNode(a){try{var b=g_objEditWindow[a].getSelection();return fnObjectCheckNull(b)||1!=b.rangeCount?null:b.getRangeAt(0).commonAncestorContainer}catch(c){dalert(c)}}function removeEmptySpaceCharacter(a){try{var b=getCurrentPostionNode(a);g_objCaretUtil.saveCaret(a);removeZeroWidthSpaceFromElement(b);g_objCaretUtil.restoreCaret(a);!0!==g_bBrowserType_IE&&(b=getCurrentPostionNode(a),b.normalize())}catch(c){dalert(c)}}
function removeZeroWidthSpace(a){try{return a=a.replace(/([^>])\u200B/g,"$1"),a=a.replace(/\u200B([^<])/g,"$1")}catch(b){dalert(b)}}function isZeroSpace(a){try{return a=a?a.replace(/[\u200B-\u200D\uFEFF]/g,"tmpZeroSpace"):"","tmpZeroSpace"===a?!0:!1}catch(b){dalert(b)}}function removeZeroWidthSpaceFromString(a){try{return a?a.replace(/[\u200B-\u200D\uFEFF]/g,""):""}catch(b){dalert(b)}}
function removeZeroWidthSpaceFromElement(a){try{if("undefined"==typeof a||null==a)return a;var b=GetCurTableInfo(),c=b?b.cell:null;if(b&&b.table)if(GetMultiCellSelection()&&a.getElementsByTagName)for(var d=a.getElementsByTagName("span"),e=0;e<d.length;e++)d[e].innerHTML=d[e].innerHTML.replace(/\u200B/g,"");else{if(c&&c)return c.innerHTML=c.innerHTML.replace(/\u200B/g,""),c}else{for(d=0;;){d++;if(10<d)break;if(a.parentNode)if(e=a.parentNode.nodeName.toLowerCase(),"body"==a.nodeName.toLowerCase()||
"undefined"==typeof e||null==e||"body"==e||"td"==e||"th"==e)break;else a=a.parentNode;else break}3==a.nodeType?a.nodeValue=removeZeroWidthSpace(a.nodeValue):a.innerHTML=removeZeroWidthSpace(a.innerHTML)}return a}catch(f){dalert(f)}}
function removeZeroWidthSpaceFromTextNode(a,b){try{if(!a||3!==a.nodeType)return b;for(var c=a.nodeValue,d=null,e=b||0,f=0,g=c.length;f<g;f++)switch(d=c.charCodeAt(f),d){case 8203:case 8204:case 8205:case 65279:f<e&&e--}return e!==b?(a.nodeValue=removeZeroWidthSpaceFromString(c),e):b}catch(h){dalert(h)}}
function removeZeroWidthSpaceWithInputEvent(a,b){try{if(g_objCaretUtil.isComposing(a))return!1;var c=GetCurRange(b);if(c&&c.collapsed&&c.commonAncestorContainer&&3===c.commonAncestorContainer.nodeType&&c.commonAncestorContainer===c.startContainer){var d=c.startContainer,e=c.startOffset,f=d.nodeValue,g=removeZeroWidthSpaceFromString(f);if(f!==g&&0<g.length)return e=removeZeroWidthSpaceFromTextNode(d,e),c.setStart(d,e),c.setEnd(d,e),SetCurRange(c),!0}return!1}catch(h){dalert(h)}finally{}}
function removeZeroWidthSpaceWithSelectionEvent(a,b){try{a=0;var c=GetCurRange(b);if(c&&c.collapsed&&c.commonAncestorContainer&&3===c.commonAncestorContainer.nodeType&&c.commonAncestorContainer===c.startContainer){var d=c.startContainer,e=d.nodeValue,f=removeZeroWidthSpaceFromString(e);if(e!==f&&0<=f.length)for(b=function(a){return"B"===a||"I"===a||"U"===a||"STRIKE"===a||"SUB"===a||"SUP"===a},c=null;d&&!g_objNodeUtil.isLoopBreakNode(d);){c=d.parentNode;if(b(c.nodeName)&&3===d.nodeType&&0===removeZeroWidthSpaceFromString(d.nodeValue).length)c.removeChild(d),
a++;else if(b(c.nodeName)&&3===d.nodeType&&0<removeZeroWidthSpaceFromString(d.nodeValue).length)d.nodeValue=removeZeroWidthSpaceFromString(d.nodeValue),a++;else if(!d.firstChild&&b(d.nodeName))c.removeChild(d),a++;else break;d=c}}return 0<a?!0:!1}catch(g){dalert(g)}finally{c=null}}
function removeXSS(a,b){try{if(!0!==dzeUiConfig.bRemoveXSS)return a;var c=a.trim();if(""==c||"<br>"==c||"<br />"==c||"<p><br></p>"==c||"<p><br /></p>"==c||"<p>&nbsp;</p>"==c)return a;dlog("--- removeXSS START ---");dlog("--- step 1~2 result");a=a.replace(/<[^>]+/g,function(a){a=a.replace(/\bon[a-zA-Z]+="[^"]+"*/gi,"");return a=a.replace(/\bon[a-zA-Z]+=["]*[^\(]+\([^\)]+\)["]*/gi,"")});c=/<[^>]*(o:gfxdata=|data-sheets-value=)[^>]*(&#[x]*\d+|[\t\\]+[a-zA-Z0-9]+)[^>]+>/gi;var d=a.match(c);null!=d&&d.length&&
(a=a.replace(c,"__DZE_MATCH_PATTERNS__"));a=a.replace(/&#[x]*\d+;?/gi,"");a=a.replace(/<[^>]*(javascript:)[^>]+>/gi,"");if(null!=d&&d.length)for(var e=0;e<d.length;e++)a=a.replace(/__DZE_MATCH_PATTERNS__/,d[e]);d=[];dlog("--- step 3 result\n"+a);a=a.replace(/<[^>]*marquee[^>]*>/gi,"");dlog("--- step 4 result\n"+a);if(!b||!1!==b.bCheckIframe){b=!1;c="youtube.com tv.naver.com serviceapi.nmv.naver.com play-tv.kakao.com play.wecandeo.com feelmaker.co.kr news.sbs.co.kr calendar.google.com player.vimeo.com".split(" ");
if((d=a.match(/(<iframe.+?<\/iframe>)/gi))&&d.length){e=0;for(var f=d.length;e<f;e++){b=!1;for(var g=c.length-1;0<=g;g--)if(0<=d[e].indexOf(c[g])){b=!0;break}!0!==b&&(a=a.replace(d[e],""))}}if((d=a.match(/(<object.+?<\/object>)/gi))&&d.length)for(e=0,f=d.length;e<f;e++){b=!1;for(g=c.length-1;0<=g;g--)if(0<=d[e].indexOf(c[g])){b=!0;break}!0!==b&&(a=a.replace(d[e],""))}}dlog("--- removeXSS END ---");return a}catch(h){dalert(h)}}
function isDarkReaderActive(a){return g_bBrowserType_CR&&a&&a.head&&a.head.querySelector("meta[name='darkreader']")?!0:!1}
function removeAllDarkReaderAttr(a){try{if(!a||!isDarkReaderActive(a.ownerDocument))return!1;for(var b=a.querySelectorAll("*"),c=a=null,d="",e="",f=0,g=b.length-1;0<=g;g--){a=b[g];for(var h=a.attributes.length-1;0<=h;h--)c=a.attributes[h],c.name&&0<=c.name.indexOf("darkreader")&&(a.removeAttribute(c.name),f++);for(h=a.style.length-1;0<=h;h--)d=a.style[h],e=a.style[d],d&&0<=d.indexOf("darkreader")?(a.style.removeProperty(d),f++):e&&0<=e.indexOf("darkreader")&&(a.style.removeProperty(d),f++)}return 0<
f?!0:!1}catch(k){dalert(k)}}
function dragDropInsertHTML(a,b){try{g_bBrowserType_IE&&g_objInsertUtil.activeSaveRangeFocus(1,b);if(window.attachEvent){var c=g_objEditorDocument[b].selection;if(!c)return;var d=c.createRange();if(!d)return;if("endContainer"in d)var e=d.endContainer;else{var f=d.parentElement().childNodes.length;e=0==f?d.parentElement():d.parentElement().childNodes[f-1]}if(e&&"nodeType"in e)var g=e.nodeType;else return}else g=getSelectionType().nodeType;if(g==ID_SELECTION_ELEMENT_NODE||g==ID_SELECTION_TEXT_NODE)window.attachEvent?
setTimeout(function(){insertHTMLCodeAtSelection(a,null,b)},100):insertHTMLCodeAtSelection(a,null,b);else if(!window.attachEvent&&g_bBrowserType_IE&&(c=g_objEditWindow[b].getSelection(),0==c.rangeCount)){var h=g_objEditorDocument[b].body;d=g_objEditorDocument[b].createRange();d.selectNode(h);d.collapse(!0);c.addRange(d);insertHTMLCodeAtSelection(a,null,b)}}catch(k){dalert(k)}}
function getnEditNumberFromEditId(a){for(var b in g_arrEditorAreaContainer)if(g_arrEditorAreaContainer[b]==a)return b;return null}
function setEditorContainerOutline(a){try{if(!(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display)){var b=document.getElementById("dzeditor_Parent_"+a),c=document.getElementById("dze_editor_source_frame_main_"+a);g_bTabBar_Display?(null!=b&&(b.style.borderWidth="1px 1px 0px 1px",b.style.borderStyle="solid",b.style.borderColor="#a0a0a0"),null!=c&&(c.style.borderTopWidth="0px",c.style.borderBottomWidth="1px")):(null!=b&&(b.style.borderWidth="1px 1px 1px 1px",b.style.borderStyle=
"solid",b.style.borderColor="#a0a0a0"),null!=c&&(c.style.borderTopWidth="0px",c.style.borderBottomWidth="`0px"))}if(!0===dzeUiConfig.bSetCustomEditorContainerOutLine&&"undefined"!=typeof dzeUiConfig.nCustomEditorContainerOutLineValues&&4==dzeUiConfig.nCustomEditorContainerOutLineValues.length){g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display||g_bTabBar_Display||null==b||(b.style.borderTopWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[0]+"px",b.style.borderBottomWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px");var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(d.style.borderTopWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[0]+"px",d.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",d.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");b=document.getElementById("dzeditor_Parent_"+a);null!=b&&(b.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",b.style.borderRightWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");c=document.getElementById("dze_editor_source_frame_main_"+a);null!=c&&(c.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",c.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");var e=document.getElementById("TB_TABMODE_CONTAINER_"+a);if(null!=e){var f=document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_CONTAINER_"+a);null!=f?(f.style.borderBottomWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[1]+
"px",f.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",f.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px"):(e.style.borderBottomWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px",e.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",e.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px")}else{var g=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a);null!=g&&(g.style.borderBottomWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px")}}}catch(h){dalert(h)}}
function insertSourceSelectionSyncChars(a){try{if(!0===dzeUiConfig.bSyncSourceSelection)if(GetMultiCellSelection())dlog("Not Support MultiCellSelection!");else if(window.attachEvent){var b=g_objEditorDocument[a].selection;if(!fnObjectCheckNull(b)){var c=b.createRange();if(!fnObjectCheckNull(c))if(""==c.htmlText)c.pasteHTML("\b\b");else{var d=c.duplicate();d.collapse(!0);d.pasteHTML("\b\b");var e=c.duplicate();e.collapse(!1);e.pasteHTML("\b\b")}}}else if(b=g_objEditWindow[a].getSelection(),1==b.rangeCount){var f=
b.getRangeAt(0);if(f.collapsed)insertHTMLCodeAtSelection("\b\b",null,a);else if(c=!1,ID_SELECTION_TEXT_NODE==f.commonAncestorContainer.nodeType&&(c=!0),c){var g=g_objEditorDocument[a].createElement("span");g.appendChild(f.cloneContents());var h=g_objEditorDocument[a].createTextNode("\b\b"+g.textContent+"\b\b");insertHTMLCodeAtSelection(null,h,a)}else{var k=f.startContainer,l=f.startOffset,m=f.endContainer,q=f.endOffset,n=g_objEditorDocument[a].createTextNode("\b\b"),p=g_objEditorDocument[a].createTextNode("\b\b");
b.removeAllRanges();e=g_objEditorDocument[a].createRange();e.setStartBefore(m);e.setEnd(m,q);e.collapse(!1);b.addRange(e);insertHTMLCodeAtSelection(null,p,a);b.removeAllRanges();d=g_objEditorDocument[a].createRange();d.setStart(k,l);d.setEndAfter(k);d.collapse(!0);b.addRange(d);insertHTMLCodeAtSelection(null,n,a)}}}catch(t){dalert(t)}}
function syncSourceSelection(a){try{if(!0===dzeUiConfig.bSyncSourceSelection){var b=g_objEditObjectSource[a].value;"selectionStart"in g_objEditObjectSource[a]||(b=b.replace(/\r/g,""));var c=b.indexOf("\b\b");if(!(0>c)){var d=b.substring(0,c),e=b.indexOf("\b\b",c+2);e=0>e?c:e-2;g_objEditObjectSource[a].value=b.replace(/\b\b/g,"");g_objEditorDocument[a].body.innerHTML=g_objEditorDocument[a].body.innerHTML.replace(/\b\b/g,"");if("selectionStart"in g_objEditObjectSource[a])g_objEditObjectSource[a].selectionStart=
c,g_objEditObjectSource[a].selectionEnd=e,g_objEditObjectSource[a].focus();else{var f=g_objEditObjectSource[a].createTextRange();f.moveStart("character",c);f.collapse();f.moveEnd("character",e-c);f.select()}var g=(d.match(/\n/g)||[]).length;g_objEditObjectSource[a].scrollTop=16*g+8}}}catch(h){dalert(h)}}
var dzeFullScreen={dzeOrgParentStyleInfo:null,dzeOrgIframeStyleInfo:null,dzeOrgTblContainerStyleInfo:null,nEditNumber:-1,view:function(a){this.nEditNumber=a;-1==this.nEditNumber&&(this.nEditNumber=g_nActiveEditNumber);try{if(dzeEnvConfig.iFrameLayer){var b=window.frameElement;!1===g_bFullScreenMode?(b.getAttribute("style")&&(this.dzeOrgIframeStyleInfo=b.getAttribute("style"),b.removeAttribute("style")),b.style.position="absolute",b.style.zIndex=20009,g_objLayerKit.getLayerDocument().body.getAttribute("style")&&
(this.dzeOrgParentStyleInfo=g_objLayerKit.getLayerDocument().body.getAttribute("style"),g_objLayerKit.getLayerDocument().body.removeAttribute("style")),g_objLayerKit.getLayerDocument().body.style.overflow="hidden",g_objLayerKit.getLayerDocument().body.style.margin=0,g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display="none"),dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display=
"none"),this.evtResizeFrame(),this.addResizeIframeEvent(this.nEditNumber),g_bFullScreenMode=!0):(b.removeAttribute("style"),g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display=""),dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display=""),null!=this.dzeOrgIframeStyleInfo&&(b.setAttribute("style",this.dzeOrgIframeStyleInfo),this.dzeOrgIframeStyleInfo=
null),g_objLayerKit.getLayerDocument().body.removeAttribute("style"),null!=this.dzeOrgParentStyleInfo&&(g_objLayerKit.getLayerDocument().body.setAttribute("style",this.dzeOrgParentStyleInfo),this.dzeOrgParentStyleInfo=null),this.removeResizeIframeEvent(this.nEditNumber),g_bFullScreenMode=!1)}else{var c=document.getElementById("EDIT_SET_CONTAINER_"+this.nEditNumber);if(!1===g_bFullScreenMode)this.dzeOrgTblContainerStyleInfo=null,c.getAttribute("style")&&(this.dzeOrgTblContainerStyleInfo=c.getAttribute("style"),
c.removeAttribute("style")),c.style.position="absolute",c.style.zIndex=20009,this.dzeOrgParentStyleInfo=null,g_objLayerKit.getLayerDocument().body.getAttribute("style")&&(this.dzeOrgParentStyleInfo=g_objLayerKit.getLayerDocument().body.getAttribute("style"),g_objLayerKit.getLayerDocument().body.removeAttribute("style")),g_objLayerKit.getLayerDocument().body.style.overflow="hidden",g_objLayerKit.getLayerDocument().body.style.margin="0px",g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+
this.nEditNumber).style.display="none"),dzeUiConfig.bCustomBottomResizeBtnYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display="none"),this.evtResizeTblContainer(),this.addResizeTblContainerEvent(this.nEditNumber),g_bFullScreenMode=!0;else{g_objLayerKit.getLayerDocument().body.removeAttribute("style");g_bBottomResizeYN&&(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+this.nEditNumber).style.display="");dzeUiConfig.bCustomBottomResizeBtnYN&&
(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+this.nEditNumber).parentNode.parentNode.style.display="");null!=this.dzeOrgParentStyleInfo&&(g_objLayerKit.getLayerDocument().body.setAttribute("style",this.dzeOrgParentStyleInfo),this.dzeOrgParentStyleInfo=null);c.removeAttribute("style");if(null!=this.dzeOrgTblContainerStyleInfo){c.setAttribute("style",this.dzeOrgTblContainerStyleInfo);var d=parseInt(c.style.height.replace(/px/,""),10);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?
dze_menu_control.resizeEditorHeight(this.nEditNumber,d):resizeEditor_Height(this.nEditNumber,d);this.dzeOrgTblContainerStyleInfo=null}this.removeResizeTblContainerEvent(this.nEditNumber);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtResizeShowHideTb();g_bFullScreenMode=!1}}editor_onselectionchange(this.nEditNumber)}catch(e){dalert(e)}},addResizeIframeEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.attachEvent("onresize",
dzeFullScreen.evtResizeFrame):b.addEventListener("resize",dzeFullScreen.evtResizeFrame,!1)}catch(c){dalert(c)}},removeResizeIframeEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.detachEvent("onresize",dzeFullScreen.evtResizeFrame):b.removeEventListener("resize",dzeFullScreen.evtResizeFrame,!1)}catch(c){dalert(c)}},addResizeTblContainerEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.attachEvent("onresize",dzeFullScreen.evtResizeTblContainer):
b.addEventListener("resize",dzeFullScreen.evtResizeTblContainer,!1)}catch(c){dalert(c)}},removeResizeTblContainerEvent:function(a){try{this.nEditNumber=a;var b=g_objLayerKit.getLayerWindow();b.attachEvent?b.detachEvent("onresize",dzeFullScreen.evtResizeTblContainer):b.removeEventListener("resize",dzeFullScreen.evtResizeTblContainer,!1)}catch(c){dalert(c)}},evtResizeFrame:function(){try{if(dzeEnvConfig.iFrameLayer){var a=window.frameElement;a.style.left=0;a.style.top=0;var b=g_objPositionUtil.getElementPosition(a,
dzeEnvConfig.iFrameLayer),c=duzon_dialog.getActiveDialogWindowSize();a.style.left=c.scrollX-b.left+"px";a.style.top=c.scrollY-b.top+"px";a.style.height=c.view_window_height+"px";a.style.width=c.view_window_width+"px"}}catch(d){dalert(d)}},evtResizeTblContainer:function(){try{if(!dzeEnvConfig.iFrameLayer){var a=document.getElementById("EDIT_SET_CONTAINER_"+dzeFullScreen.nEditNumber);a.style.top=0;a.style.left=0;var b=g_objPositionUtil.getElementPosition(a,dzeEnvConfig.iFrameLayer),c=duzon_dialog.getActiveDialogWindowSize();
a.style.top=-b.top+"px";a.style.left=-b.left+"px";!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode?dze_menu_control.resizeEditorHeight(this.nEditNumber,c.view_window_height):resizeEditor_Height(this.nEditNumber,c.view_window_height);a.style.width=c.view_window_width+"px";!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtResizeShowHideTb()}}catch(d){dalert(d)}}};
function insertPrintPageBreak(a){try{if(!GetCurTable(a)){var b=document.createElement("div");b.className="dze_printpagebreak";b.setAttribute("contenteditable","false");b.innerHTML='<div class="dze_printpagebreak_guide" contenteditable="false" title="'+ID_RES_CONST_STRING_PRINT_PAGE_BREAK+'"></div>';var c=document.createElement("p");c.innerHTML=window.attachEvent?"&nbsp;":"<br />";var d=g_objNodeUtil.getAncestorNodeOnCaret(a);if(d){if(3==d.nodeType&&(d=d.parentNode,!d))return;if("body"==d.nodeName.toLowerCase())insertHTMLCodeAtSelection(b.outerHTML+
c.outerHTML,null,a);else{for(var e=0;;){e++;if(30<e)break;if(!d.parentNode)break;if("body"==d.parentNode.nodeName.toLowerCase())break;d=d.parentNode}if(!d||"body"!=d.parentNode.nodeName.toLowerCase())return;d.nextSibling?d.parentNode.insertBefore(b,d.nextSibling):d.parentNode.appendChild(b);""!=d.innerHTML&&"<br>"!=d.innerHTML&&"<br />"!=d.innerHTML&&"&nbsp;"!=d.innerHTML||d.parentNode.removeChild(d);b.nextSibling||(b.parentNode.appendChild(c),duzon_dialog.setFocusElement(c,a,"start"))}g_objUndoRedo.registerUndoRedoStack(0,
a)}}}catch(f){dalert(f)}}
var dzeCopyPasteStyleInfo={nEditNumber:-1,pasteStyleMode:!1,isEmpty:!0,styleInfo:{},initStyleInfo:function(){try{this.styleInfo={fontFamily:"",fontSize:"",color:"",backgroundColor:"",letterSpacing:"",lineHeight:"",bold:!1,italic:!1,underline:!1,strike:!1,superScript:!1,subScript:!1,textAlign:-1,listType:[],listStyleType:[],listClassName:[],listChildClassName:[],listChildStyle:[],heading:"-1"},this.isEmpty=!0}catch(a){dalert(a)}},copy:function(a){try{if(!0===dzeUiConfig.bApplyPasteStyleMode&&(this.initStyleInfo(),
!GetMultiCellSelection())){var b=g_objPropertyUtil.getSelectionAttributeValue(a,!0);b&&(b[0]?(this.styleInfo.fontFamily=b[0],this.isEmpty=!1):1==b[11]&&"undefined"!=typeof b[22][0]&&(this.styleInfo.fontFamily=b[22][0],this.isEmpty=!1),b[1]?(this.styleInfo.fontSize=b[1],this.isEmpty=!1):1==b[12]&&"undefined"!=typeof b[23][0]&&(this.styleInfo.fontSize=b[23][0],this.isEmpty=!1),b[2]?(this.styleInfo.color=b[2],this.isEmpty=!1):1==b[13]&&"undefined"!=typeof b[24][0]&&(this.styleInfo.color=b[24][0],this.isEmpty=
!1),b[3]?(this.styleInfo.backgroundColor=b[3],this.isEmpty=!1):1==b[14]&&"undefined"!=typeof b[25][0]&&(this.styleInfo.backgroundColor=b[25][0],this.isEmpty=!1),b[4]?(this.styleInfo.letterSpacing=b[4],this.isEmpty=!1):1==b[15]&&"undefined"!=typeof b[26][0]&&(this.styleInfo.letterSpacing=b[26][0],this.isEmpty=!1),b[5]?(this.styleInfo.lineHeight=b[5],this.isEmpty=!1):1==b[16]&&"undefined"!=typeof b[27][0]&&(this.styleInfo.lineHeight=b[27][0],this.isEmpty=!1));strSelectionType=window.attachEvent?g_objEditorDocument[a].selection.type:
getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType){b="";for(var c=0,d=0;d<duzon_dialog.dze_font_propertys.length-1;d++)if("normal"!=duzon_dialog.dze_font_propertys[d]){b=duzon_dialog.dze_font_propertys[d].toUpperCase();c=eval("ID_COMMAND_"+b);"STRIKE"==b&&(b="StrikeThrough");var e=handlerUI.queryCommandStatus(g_objEditorDocument[a],c,b,a,-1,strSelectionType);if(ID_STRING_NAME_CHECKED==e)switch(b){case "StrikeThrough":this.styleInfo.strike=
!0;this.isEmpty=!1;break;case "BOLD":this.styleInfo.bold=!0;this.isEmpty=!1;break;case "ITALIC":this.styleInfo.italic=!0;this.isEmpty=!1;break;case "UNDERLINE":this.styleInfo.underline=!0;this.isEmpty=!1;break;case "SUPERSCRIPT":this.styleInfo.superScript=!0;this.isEmpty=!1;break;case "SUBSCRIPT":this.styleInfo.subScript=!0,this.isEmpty=!1}}this.styleInfo.textAlign=getAlignValueForSelectionArea(a);this.styleInfo.heading=updateHandlerUI.getMappingIndex_Heading(a);0<parseInt(this.styleInfo.heading,
10)&&(this.isEmpty=!1);var f=g_objNodeUtil.getAncestorNodeOnCaret(a);if(f&&(f.nodeType==ID_SELECTION_TEXT_NODE&&(f=f.parentNode),"li"==f.nodeName.toLowerCase()&&(f=f.parentNode),"ol"==f.nodeName.toLowerCase()||"ul"==f.nodeName.toLowerCase())){for(e=0;e++,this.styleInfo.listType.push(f.nodeName.toUpperCase()),this.styleInfo.listStyleType.push(f.style.listStyleType),this.styleInfo.listClassName.push(f.className),0<f.childNodes.length&&"li"==f.childNodes[0].nodeName.toLowerCase()&&(f.childNodes[0].className?
this.styleInfo.listChildClassName.push(f.childNodes[0].className):this.styleInfo.listChildClassName.push(""),f.childNodes[0].getAttribute("style")?this.styleInfo.listChildStyle.push(f.childNodes[0].getAttribute("style")):this.styleInfo.listChildStyle.push(null)),f=g_objNodeUtil.getLoopChildNodeByTagNames(f,["ol","ul"]),f&&!(10<e););this.isEmpty=!1}!1===this.isEmpty&&this.setPasteStyleMode(a)}}}catch(g){dalert(g)}},paste:function(a){try{if(!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&
!0!==this.isEmpty){this.unsetPasteStyleModeEditArea(a);if(!GetMultiCellSelection()){this.nEditNumber=a;var b=window.attachEvent?g_objEditorDocument[a].selection.type:getSelectionTypeForUpdateUI();b=b.toLowerCase();if(ID_STRING_NAME_TEXT==b||ID_STRING_NAME_NONE==b){var c=g_objNodeUtil.getAncestorNodeOnCaret(a);if(0<parseInt(this.styleInfo.heading,10))g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(this.styleInfo.heading,
!1);else{if(this.styleInfo.listType.length){var d=g_objNodeUtil.getLoopParentElement(c,this.styleInfo.listType[0].toLowerCase());null==d&&("UL"==this.styleInfo.listType[0]?fnHandler_SupportCommand_Main(a,"InsertUnOrderedList"):fnHandler_SupportCommand_Main(a,"InsertOrderedList"),c=g_objNodeUtil.getAncestorNodeOnCaret(a),d=g_objNodeUtil.getLoopParentElement(c,this.styleInfo.listType[0].toLowerCase()));if(d)for(c=0;c<this.styleInfo.listType.length&&d.nodeName.toUpperCase()==this.styleInfo.listType[c];c++){this.styleInfo.listStyleType[c]?
d.style.listStyleType=this.styleInfo.listStyleType[c]:d.getAttribute("style")&&d.removeAttribute("style");this.styleInfo.listClassName?d.className=this.styleInfo.listClassName[c]:d.getAttribute("class")&&d.removeAttribute("class");for(var e=0;e<d.childNodes.length;e++)"li"==d.childNodes[e].nodeName.toLowerCase()&&(this.styleInfo.listChildClassName[c]?d.childNodes[e].className=this.styleInfo.listChildClassName[c]:d.childNodes[e].getAttribute("class")&&d.childNodes[e].removeAttribute("class"),this.styleInfo.listChildStyle[c]?
d.childNodes[e].setAttribute("style",this.styleInfo.listChildStyle[c]):d.childNodes[e].getAttribute("style")&&d.childNodes[e].removeAttribute("style"));d=g_objNodeUtil.getLoopChildNodeByTagNames(d,["ol","ul"]);if(!d)break}}this.styleInfo.fontFamily&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(this.styleInfo.fontFamily,!1));this.styleInfo.fontSize&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,
g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(this.styleInfo.fontSize,!1));this.styleInfo.color&&(g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(this.styleInfo.color,!1),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=a));g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;fnColorCellApply(this.styleInfo.backgroundColor,!1);-1==g_nActiveEditNumber&&(g_nActiveEditNumber=a);""!=this.styleInfo.letterSpacing&&g_objLetterSpacingWin.fnLetterSpacingCellClick(this.styleInfo.letterSpacing,
!1);""!=this.styleInfo.lineHeight&&g_objLineHeightWin.fnLineHeightCellClick(this.styleInfo.lineHeight,!1);if(0<=this.styleInfo.textAlign){d=!1;0==this.styleInfo.textAlign&&(d=!0);var f=1==this.styleInfo.textAlign?"Left":2==this.styleInfo.textAlign?"Center":3==this.styleInfo.textAlign?"Right":4==this.styleInfo.textAlign?"Justify":"Left",g=eval("ID_COMMAND_JUSTIFY_"+f.toUpperCase());fnHandler_Align_Main(a,"Justify"+f,d,g)}f="";g=-1;g=ID_COMMAND_BOLD;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],
g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.bold?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"bold"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"bold");g=ID_COMMAND_ITALIC;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.italic?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Italic"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Italic");g=ID_COMMAND_UNDERLINE;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],
g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.underline?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Underline"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"Underline");g=ID_COMMAND_STRIKE;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.strike?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"StrikeThrough"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"StrikeThrough");g=ID_COMMAND_SUPERSCRIPT;
f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.superScript?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"superscript"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"superscript");g=ID_COMMAND_SUBSCRIPT;f=handlerUI.queryCommandStatus(g_objEditorDocument[a],g,g_arrConst[g][0],a,-1,b);1==this.styleInfo.subScript?f!=ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,"subscript"):f==ID_STRING_NAME_CHECKED&&fnHandler_SupportCommand_Main(a,
"subscript")}g_objUndoRedo.registerUndoRedoStack(0,a)}}this.unsetPasteStyleMode(a)}}catch(h){this.unsetPasteStyleMode(a),dalert(h)}},setPasteStyleMode:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&(this.setPasteStyleModeEditArea(a),this.pasteStyleMode=!0,editor_ondeactivate(a))}catch(b){this.pasteStyleMode=!1,dalert(b)}},unsetPasteStyleMode:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&(this.pasteStyleMode=!1,this.orgContentEditable=!0,this.initStyleInfo(),
editor_onactivate(null,a),g_objMenuWin.TBMenuSetStateAllEnable(!0,a),g_bMenuEnabled=!0)}catch(b){dalert(b)}},orgContentEditable:!0,setPasteStyleModeEditArea:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0!==this.pasteStyleMode&&(null==g_objEditorDocument[a].body.getAttribute("contentEditable")||""==g_objEditorDocument[a].body.getAttribute("contentEditable")?this.orgContentEditable=null:this.orgContentEditable=g_objEditorDocument[a].body.getAttribute("contentEditable"),g_objEditorDocument[a].body.contentEditable=
!1,g_objEditorDocument[a].body.style.cursor="pointer")}catch(b){dalert(b)}},unsetPasteStyleModeEditArea:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&(null==this.orgContentEditable?g_objEditorDocument[a].body.removeAttribute("contentEditable"):g_objEditorDocument[a].body.contentEditable=this.orgContentEditable,g_objEditorDocument[a].body.style.cursor="")}catch(b){g_objEditorDocument[a].body.contentEditable=!0,g_objEditorDocument[a].body.style.cursor="",dalert(b)}}},
dzeClipBoard={copyData:[],pasteType:"",initialize:function(){if(!this.copyData||0<this.copyData.length)this.copyData=[]},copySelectedMultiCells:function(a){try{if(!GetMultiCellSelection(a))return!1;var b=this.copyMultiCell(a);if(!b||!this.copyToNativeClipboard(a,b))return!1;this.copyData=[b];duzon_dialog.showToastMessage(null,ID_RES_CONST_STRING_CELL_CONTENTS_COPIED,1.5);return!0}catch(c){dalert(c)}},cutSelectedMultiCells:function(a){try{return this.copySelectedMultiCells(a)?g_objTableOperation.deleteSelectedCell(a,
GetCurTable(a)):!1}catch(b){dalert(b)}},copyMultiCell:function(a){try{if(!GetMultiCellSelection(a))return null;var b=GetCurTable(a),c=b.ownerDocument,d=g_objTableUtil.getMatrix(b);if(!d)return null;var e=d.getSelection();e=e&&e[0]?e[0]:null;if(!e)return null;var f=d.clone();g_objTableUtil.addColgroup(f.table,f);f.removeRow(e.nEndRow+1,d.rowLength-1);f.removeCol(e.nEndCol+1,d.colLength-1);f.removeRow(0,e.nStartRow-1);f.removeCol(0,e.nStartCol-1);var g=c.createElement("DIV");a=0;for(var h=f.tables.length;a<
h;a++)g.appendChild(f.tables[a]);appendBodyTemporary(g,null,function(){var a=g.querySelectorAll("td[cusflag], th[cusflag], td[bg_changing], th[bg_changing]");forEach(a,function(a,b){b&&(b.removeAttribute("cusflag"),b.removeAttribute("bg_changing"))},this)});var k=g.firstChild;return k&&"TABLE"===k.nodeName?k.outerHTML:""}catch(l){dalert(l)}},copyToNativeClipboard:function(a,b){try{if(!0===fnObjectCheckNull(b)||0===b.length)return!1;var c=g_objEditorDocument[a],d=g_objEditWindow[a].getSelection(),
e=d&&0<d.rangeCount?d.getRangeAt(0):null,f=e?new RangeProp(e):null,g=c.body.scrollTop,h=c.createElement("div");h.innerHTML=b;var k=e?e:c.createRange();appendBodyTemporary(h,null,function(){k.selectNodeContents(h);d.removeAllRanges();d.addRange(k);c.execCommand("copy",!1,null)});f?(f.getRange(e),d.removeAllRanges(),d.addRange(e)):d.removeAllRanges();c.body.scrollTop=g;return!0}catch(l){dalert(l)}},setTableObjToDzeClipData:function(a){try{if("undefined"==typeof a||null==a||"TABLE"!==a.nodeName)return!1;
dzeClipBoard.copyData=[];dzeClipBoard.copyData.push(a.outerHTML);return!0}catch(b){return dalert(b),!1}},paste_insert:function(a,b){try{if(!dzeClipBoard.copyData.length)return!1;var c=g_objEditorDocument[a].createElement("div");c.innerHTML=dzeClipBoard.copyData[0];var d=c.firstChild;if("TABLE"!==d.nodeName)return!1;c=g_objTableUtil;g_objTableFlag.removeFlagInfo(d);var e=GetCurTable(a);if(!e)return!1;var f=new TableMatrix(e);if(!f)return!1;var g=f.getSelection();if(!g||1<g.length)return!1;g=g[0];for(var h=
c.getTableCellsLength(d,0),k=null,l=0,m=0;m<h;m++)k=c.getTableCellElement(d,0,m),l+=k.colSpan;var q=c.getTableCellsLength(e,0);h=null;var n=0;for(m=0;m<q;m++)h=c.getTableCellElement(e,0,m),n+=h.colSpan;var p=null;appendBodyTemporary(d,null,function(){p=new TableMatrix(d);n>l?p.insertBlankCol(p.colLength,n-l):n<l&&p.removeCol(n,l-1);l=n;g_objTableUtil.resetTableCellPixelSize(d)}.bind(this));if(!p)return!1;var t=p.removeRow(0,p.rowLength-1);if(!t)return!1;var r=g.nEndRow;f.splitRow(r+1);insertAfter(f.trs[r],
t);g_objTableMiniMenu.delayUpdate(a);!1!==b&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a));return!0}catch(u){dalert(u)}},setDefaultCellProperty:function(a){try{if(a)for(var b=g_objTableUtil,c={backgroundColor:"",border:"1px solid #000000",padding:"",textAlign:"",verticalAlign:""},d=0,e=a.rows.length;d<e;d++)for(var f=b.getTableCellsLength(a,d),g=0;g<f;g++){var h=b.getTableCellElement(a,d,g),k;for(k in c)h.style[k]=c[k]}}catch(l){dalert(l)}},paste:function(a,b){try{if(!dzeClipBoard.copyData.length)return!1;
var c=GetCurTable(a),d=GetMultiCellSelection(a);d||c&&g_objTableFlag.ResetTableInfo(!1);var e=g_objEditorDocument[a].createElement("div");e.innerHTML=dzeClipBoard.copyData[0];var f=e.childNodes[0];g_objTableFlag.removeFlagInfo(f);var g=e=!1,h=g_objTableUtil,k=h.isBizboxReportTable(c),l=h.isBizboxReportTable(f);d||this.pasteType||!k||l||(g=!0);e||c&&this.pasteType!==INSERT_AS_NESTED_TABLE&&!g||(k&&l&&h.removeBizboxReportTableAttr(f),e=this.pasteTableNest(a,f));var m=GetSelectedCellCount(a);!e&&d&&
1<m&&(e=this.pasteTableSelect(a,f));e||(e=this.pasteTableMerge(a,f));!0===e&&(!1!==b&&g_objUndoRedo.registerUndoRedoStack(0,a),c&&g_objTableMiniMenu.delayUpdate(a));return e}catch(q){return dalert(q),!1}},pasteTableNest:function(a,b){try{return g_objInsertUtil.insertTableAtSelection(b,a)?!0:!1}catch(c){dalert(c)}},pasteTableSelect:function(a,b){try{if(!GetMultiCellSelection(a)||!b)return!1;!0===(this.pasteType==KEEP_ORG_TABLE_FORMMAT?!0:!1)&&this.setDefaultCellProperty(b);var c=GetCurTable(a);a=null;
var d=new TableMatrix(c);if(!d)return!1;var e=d.getSelection();e=e&&e[0]?e[0]:null;if(!e)return!1;a=new TableMatrix(b);var f=e.nStartRow,g=e.nEndRow,h=e.nStartCol,k=e.nEndCol;a.insertBlankCol(0,h);a.insertBlankRow(0,f);this.pasteCell(d,a,f,h,g,k);g_objCaretUtil.moveCaret(d.getCell(f,h));return!0}catch(l){dalert(l)}},pasteTableMerge:function(a,b){try{var c=GetCurTable(a);if(!c||!b)return!1;var d=c.ownerDocument;if(!d)return!1;var e=null,f=new TableMatrix(c);if(!f)return!1;var g=f.getSelection();g=
g&&g[0]?g[0]:null;if(!g)return!1;var h=g_objNodeUtil.getClosetBound(c);if(!h)return!1;g_objTableUtil.addColgroup(c);g_objTableUtil.addColgroup(b);var k=this.pasteType===KEEP_ORG_TABLE_FORMMAT?!0:!1,l=g.nStartRow,m=0,q=g.nStartCol,n=0,p=null,t=f.calculateColWidth(),r=d.createElement("div");r.appendChild(b);var u={width:g_objPositionUtil.getInnerWidth(h)};appendBodyTemporary(r,u,function(){!0===k&&this.setDefaultCellProperty(b);e=new TableMatrix(b);m=l+e.rowLength-1;n=q+e.colLength-1;e.insertBlankCol(0,
q);e.insertBlankCol(e.colLength,f.colLength-e.colLength);var a=0;var c=l;for(var d=0,g=f.tables.length;d<g&&0<c;d++){var h=f.tables[d].rows.length;var r=c>=h?h:c;c-=h;e.insertBlankRow(a,r);a=r}a=e.rowLength;c=f.rowLength-e.rowLength;for(d=f.tables.length-1;0<=d&&0<c;d--)h=f.tables[d].rows.length,r=c>=h?h:c,c-=h,e.insertBlankRow(a,r);p=e.calculateColWidth();e.calculateRowHeight();g_objTableUtil.resetTableCellPixelSize(b)}.bind(this));if(!e)return!1;a=g_objNodeUtil;c=g_objTableUtil;m>=f.rowLength&&
f.insertRow(f.rowLength,m-f.rowLength+1);this.pasteCell(f,e,l,q,m,n);if(n>=f.colLength){var v=e.clone();v.removeRow(f.rowLength,e.rowLength-f.rowLength);var x=v.removeCol(f.colLength,n);if(x){for(v=0;v<f.rowLength;v++){var w=d.createDocumentFragment();a.moveNodesTo(w,x.childNodes[v].firstChild);f.trs[v].appendChild(w)}var y=e.arraySum(t),z=e.arraySum(p,f.colLength,n);c.setTableWidth(f.tables,y+z);if(0<f.colgroups.length){var A=d.createDocumentFragment();for(v=f.colLength;v<=n;v++){var B=d.createElement("col");
B.style.width=p[v];A.appendChild(B)}v=0;for(var D=f.colgroups.length;v<D;v++)a.getImmediateChildNodesByTagName(f.colgroups[v],"col")[0].parentNode.appendChild(A.cloneNode(!0))}f.makeMatrix()}}dzeUiConfig.bUsePasteOptionMenu&&g_objPasteOptionMenu.setPasteEndNode(f.getCell(l,q));g_objCaretUtil.moveCaret(f.getCell(l,q));return!0}catch(C){return dalert(C),!1}},pasteCell:function(a,b,c,d,e,f){try{if(!a||!b)return!1;for(var g=this.pasteType===KEEP_ORG_TABLE_FORMMAT?!0:!1,h=g_objNodeUtil,k=g_objTableUtil,
l=g_objPropertyUtil;c<=e&&c<a.rowLength;c++)for(var m=d;m<=f&&m<a.colLength;m++)if(b.isShow(c,m)&&a.isShow(c,m)){var q=b.getCell(c,m),n=a.getCell(c,m);if(q&&n&&"false"!==n.getAttribute("contenteditable")){var p=q.cloneNode(!0);if(!1===g){var t=l.getStyleWidth(n);t&&k.setNodeValue_Width(p,t,"px");(t=l.getStyleHeight(n))&&k.setNodeValue_Height(p,t,"px");k.setColspan(p,k.getColspan(n));k.setRowspan(p,k.getRowspan(n));var r=n.getAttribute("cusflag");r&&p.setAttribute("cusflag",r);n.parentNode.replaceChild(p,
n)}else h.removeAllChild(n),h.moveNodesTo(n,p.firstChild)}}return!0}catch(u){dalert(u)}},pasteOlUl:function(a,b,c){try{c=g_objNodeUtil;var d=g_objListUtil;if(!c.isList(a)||!GetCurList(b))return!1;SelectionUtil.deleteSelection(b);var e=GetCurRange(b);if(!e||!e.collapsed)return!1;var f=GetCurList(b);if(!f)return!1;for(;a.firstChild===a.lastChild&&c.isList(a.firstChild);)a=a.firstChild;d.removeFirstLastBlankLi(a);var g=f.ownerDocument,h=g.createElement("span");e.insertNode(h);c.insertBrIfSplitAtLast(f,
h);c.splitOn(f,h);var k=h.previousSibling,l=h.nextSibling;c.isBlankPara(k)&&k.parentNode.removeChild(k);var m=g.createDocumentFragment();c.moveNodesTo(m,a.firstChild);h.parentNode.replaceChild(m,h);h=g.createElement("span");l.firstChild?l.insertBefore(h,l.firstChild):l.appendChild(h);g_objPasteOptionMenu.setPasteEndNode(h);g_objCaretUtil.moveCaret(l);return!0}catch(q){dalert(q)}}};
function initCursorNodeDisplay(a){var b=g_objEditorDocument[a].getElementById("dze_init_cursor");null!==document.getElementById("TB_INIT_CURSOR_"+a)&&(b.style.display="block")}
function initializeDocFocus(a){try{var b=g_objEditorDocument[a].body,c=g_objEditorDocument[a].getElementById("dze_init_cursor"),d=null===document.getElementById("TB_INIT_CURSOR_"+a);void 0!=c&&"SPAN"===c.nodeName&&(g_objEditMode.removeChild(a,"span","className","dze_init_cursor_flag",function(a){null!=a&&a.parentNode.removeChild(a)}),c=null);if(null!=c){b=c;var e="start";null===b.nextSibling||"BR"===b.nextSibling.nodeName?(b=b.previousSibling,e="end"):b=b.nextSibling;g_objCaretUtil.scrollTo(c);d&&
(duzon_dialog.setFocusElement(b,a,e),g_objEditMode.removeChild(a,"a","className","dze_init_cursor_flag",function(a){null!=a&&a.parentNode.removeChild(a)}))}else g_objCaretUtil.moveCaret(b);editor_onselectionchange(a)}catch(f){dalert(f)}}
function deleteAlonePara(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||a.modifierKey)return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed||!b.startContainer)return!1;var c=b.startContainer.childNodes[b.startOffset]||b.startContainer;a=g_objNodeUtil;var d=a.getLoopParentElementByTagNames(c,"p ol ul dl h1 h2 h3 h4 h5 h6".split(" "));if(!d||d.nextSibling&&(d.nodeName===d.nextSibling.nodeName||a.checkTagName(d,"p","ol","ul","dl")&&a.checkTagName(d.nextSibling,"p","ol","ul","dl")))return!1;
if(a.isList(d)){b=["li","dt","dd"];var e=a.getLoopParentElementByTagNames(c,b);if(!e||e.nextSibling&&e.nodeName===e.nextSibling.nodeName)return!1;e.previousSibling&&0<=b.indexOf(e.previousSibling.nodeName.toLowerCase())&&(d=e)}var f=g_objNodeUtil.getClosetBound(d);if(!f||f.firstChild===d&&!d.nextSibling||a.isNodeInShape(c)||!g_objNodeUtil.isBlankPara(d))return!1;walker=getCaretNodeWalker(c);if(!walker)return!1;var g=walker.getNextNodeOutside(d);if(a.isCell(f)){var h=a.getClosetBound(g);if(f!==h){var k=
walker.getPrevNodeOutside(d);k&&(g=k)}}g||(g=walker.getPrevNodeOutside(d));if(!g)return!1;dlog("delete para direct");var l=0!==(d.compareDocumentPosition(g)&Node.DOCUMENT_POSITION_PRECEDING);g_objCaretUtil.moveCaret(g,!0,!l);d.parentNode.removeChild(d);return!0}catch(m){dalert(m)}}
function checkOnlyBlankPara(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_DELETE&&a.keyCode!==ID_KEYCODE_BACKSPACE)return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed||!b.startContainer)return!1;a=g_objNodeUtil;for(var c=b.startContainer;c&&!a.isLoopBreakNode(c.parentNode);)c=c.parentNode;if(!c||"P"!==c.nodeName||!a.isLoopBreakNode(c.parentNode)||!a.isBlankPara(c))return!1;var d=c.previousSibling,e=c.nextSibling;return d&&!a.isDocFirstNode(d)||e&&!a.isDocLastNode(e)?
!1:!0}catch(f){dalert(f)}finally{}}
function getCaretNodeWalker(a,b){try{if(!a)return null;var c=g_objNodeUtil,d=null;if(b)d=b;else for(d=a;d&&!c.isLoopBreakNode(d);)d=d.parentNode;if(!d)return null;var e=d.ownerDocument;b=function(b){return a&&a===b?NodeFilter.FILTER_ACCEPT:c.canCaretExistOn(b)};g_bBrowserType_IE||(b={acceptNode:b});var f=e.createTreeWalker(d,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,b,!1),g=f.firstChild();if(!g)return null;for(;g!==a;)if(g=f.nextNode(),!g)return null;if(!f.currentNode)return null;var h=0;return{currentNode:function(){return f.currentNode},
prevNode:function(){this.currentNode();var a=f.previousNode();a&&h--;return a},nextNode:function(){this.currentNode();var a=f.nextNode();a&&h++;return a},init:function(){var a;if(0>h){var b=Math.abs(h);for(a=0;a<b;a++)this.nextNode()}if(0<h)for(b=h,a=0;a<b;a++)this.nextNode()},getNextNodeOutside:function(a){if(!a)return null;for(var b=h,c=this.nextNode();c&&1===a.nodeType&&a.contains(3===c.nodeType?c.parentNode:c);)c=this.nextNode();a=h-b;for(b=0;b<a;b++)this.prevNode();return c},getPrevNodeOutside:function(a){if(!a)return null;
for(var b=h,c=this.prevNode();c&&1===c.nodeType&&a.contains(3===c.nodeType?c.parentNode:c);)c=this.prevNode();a=b-h;for(b=0;b<a;b++)this.nextNode();return c}}}catch(k){dalert(k)}}
function applyTabKeyAction(a,b,c){try{if(!c||c.cancelBubble)return!1;if(a){var d=document.createElement("span");d.className="tabSpan";d.style.whiteSpace="pre";d.innerHTML="\t";insertHTMLCodeAtSelection(null,d,b);g_objUndoRedo.registerUndoRedoStack(0,b);return!0}return 0<removeSpanTabSelection(b)?(g_objUndoRedo.registerUndoRedoStack(0,b),!0):!1}catch(e){dalert(e)}finally{range=null}}
function setTabSpanInlineStyle(a){try{if(a){var b=a.querySelectorAll("span.tabSpan");forEach(b,function(a,b){b.style.whiteSpace="pre"})}}catch(c){dalert(c)}}function pasteOnefficeLink(a,b){return!0===dzeEnvConfig.bUseAmaranthApi?pasteOnefficeLinkAmaranth(a,b):pasteOnefficeLinkOld(a,b)}
function pasteOnefficeLinkOld(a,b){try{if(!0===dzeUiConfig.bApplyPasteOnefficeLink){var c="";c=(a.clipboardData||window.clipboardData).getData("Text");if(""!=c&&/^http[s]*:\/\/(.*)\/oneffice\/oneffice\.do\?/i.test(c)){TBCancelBubbleEvent(a);var d=c;parseOpenGraphData(d,function(a){var c="ONEFFICE \ubb38\uc11c\uc785\ub2c8\ub2e4.";a&&a.title&&(c=a.title);a=document.createElement("div");a.style.width="250px";a.style.height="auto";a.style.backgroundColor="#ffffff";a.style.border="#d9d9d9 1px solid";a.style.borderRadius=
"7px";a.style.padding="0";a.setAttribute("contenteditable","false");var e=getFullUrlFromPath(dzeEnvConfig.strPath_Image+"oneffice/bi_oneffice_130.png"),h=getFullUrlFromPath(dzeEnvConfig.strPath_Image+"oneffice/ico_cloud_file.png");a.innerHTML="<div style='width:250px;padding: 30px 0;text-align:center;border-bottom-width:1px;border-bottom-color:#d9d9d9;border-bottom-style:solid;background-color:#f2f2f2;border-radius: 7px 7px 0 0' contenteditable='false' contenteditable='false'><a href=\""+d+"\" target=\"_blank\"><span style='padding:30px 50px;'><img src='"+
e+"' width='130' style='border:0;'/></span></a></div>";a.innerHTML+="<div style='width:auto;padding:10px;font-size:10pt;text-align:left;overflow:hidden;text-overflow: ellipsis;white-space:nowrap;line-height:1.5;font-weight:bold;'><img src='"+h+"' width='16' height='16' /> <a href=\""+d+'" target="_blank" title=\''+c+"' style='color:#1C90FB;font-weight:bold;'><span>"+c+"</span></a></div>";insertHTMLCodeAtSelection(a.outerHTML+"<p><br /></p>",null,b);g_objUndoRedo.registerUndoRedoStack(0,b)})}}}catch(e){dalert(e)}}
function parseOpenGraphData(a,b){if(a&&b)try{duzon_http.ajax({type:"post",url:dzeEnvConfig.strGetWebContentURL,async:!0,data:{remoteUrl:a},timeout:3E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){var c={title:"",description:"",image:"",type:""};if(""!=a&&(a=a.match(/[\s]*[\t]*<meta[\s]+[^>]*>[\s]*[\t]*/gi),null!=a&&a.length)){var e=document.createElement("head");e.innerHTML=a.join("");a=e.getElementsByTagName("meta");for(e=0;e<a.length;e++)if(a[e].getAttribute("property")&&
0==a[e].getAttribute("property").indexOf("og:")&&a[e].getAttribute("content")){var f=a[e].getAttribute("property").replace(/^og:/,"");c[f]=a[e].getAttribute("content")}}b(c)},error:function(a){dalert(a);b(null)}})}catch(c){dalert(c),b(null)}}
function pasteOnefficeLinkAmaranth(a,b){try{if(!0===dzeUiConfig.bApplyPasteOnefficeLink){var c="";(c=(a.clipboardData||window.clipboardData).getData("Text"))&&(c=c.trim());if(c&&isValidURL(c)){var d=c;g_objCopyPaste.setTimeoutForPaste(function(){g_objCopyPaste.pause();var a=function(a){if(g_objCopyPaste.isPasting()){var c=g_objCopyPaste.getPasteDiv();c&&(c.innerHTML="<p>"+a+"</p>")}else insertHTMLCodeAtSelection(a,null,b)},c=function(b,c){g_objCopyPaste.resume();var e="",f="";if(c)dalert(c),e=d;else if(b){e=
b.title;if(!e||0>=e.trim().length)e=d;(f=b.cls)&&0<f.trim().length&&(f=' class="'+f+'"')}a('<a href="'+d+'" target="_blank"'+f+"><span>"+e+"</span></a> ")};-1<d.indexOf("?keep=true")||-1<d.indexOf("&keep=true")?parseAmaranthLinkData("keep",d,function(a,b){c(a,b)}):(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/mail/api/mail018A18?"))&&-1<d.indexOf("callComp=UDAP007")||(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/schres/sc111K02?"))&&-1<d.indexOf("callComp=UEAP011")||(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/eap/eap111A02?"))&&
-1<d.indexOf("callComp=UBAP002")||(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/ea/ea040A35?"))&&-1<d.indexOf("callComp=UCAP001")||(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/kiss/APIHandler/prj001A15?"))&&(-1<d.indexOf("callComp=UGAP011")||-1<d.indexOf("callComp=UGAP012"))||(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/board/APIHandler/board001K01?")||-1<d.indexOf("/board/APIHandler/board001K03?"))&&(-1<d.indexOf("callComp=UFAP003")||-1<d.indexOf("callComp=UFAP017"))||-1<d.indexOf("/#/popup?")&&-1<d.indexOf("callComp=UAAP017")||
-1<d.indexOf("/messenger/messenger03A22?")&&-1<d.indexOf("type=message")||(-1<d.indexOf("/#/popup?")||-1<d.indexOf("/gw/gw118A31?"))&&-1<d.indexOf("callComp=UHAP003")?parseAmaranthLinkData("link",d,function(a,b){c(a,b)}):isOnechamberURL(d)||isOnefficeURL(d)?parseOpenGraphDataAmaranth(d,function(b){g_objCopyPaste.resume();var c=d,e="O",f=null;b&&b.title&&(c=b.title);b&&b.type&&(e=b.type);b&&b.onefficeUID&&(f=b.onefficeUID);b=null;isOnechamberURL(d)?b="onechamber":isOnefficeURL(d)&&(b="oneffice");var g=
"";b&&0<b.length&&(g="dze_"+b+"_link_flag","oneffice"==b&&"S"===e&&(g=g.replace("_link_flag","_slide_link_flag")),g=' class="'+g+'"');c='<a href="'+d+'" target="'+getOnefficePopupName(f)+'"'+g+"><span>"+c+"</span></a> ";a(c);d&&isOnefficeURL(d)&&"undefined"!==typeof panelManagerLeft&&panelManagerLeft.getInstanceRelationDoc().addRelatedDoc({docUID:oneffice.currTDocUid,URL:d},void 0,!0)}):(g_objCopyPaste.resume(),a('<a href="'+d+'" target="_blank">'+d+"</a> "))})}}}catch(e){dalert(e)}}
function getOnefficePopupName(a){return a&&"_blank"!=a?"onepopup_"+a:"_blank"}function parseOpenGraphDataAmaranth(a,b){try{duzon_http.ajax({isCallAmaranthApi:!0,type:"post",url:"/ecm/oneffice/one001A31",async:!0,data:{url:a},dataType:"json",timeout:5E3,success:function(a){var c={};0===a.resultCode&&a.resultData&&a.resultData.docName&&(c=a.resultData.fileType,c={title:a.resultData.docName,type:c&&""!=c?c:"O"});b(c)},error:function(a){b(void 0,a)}})}catch(c){b(void 0,c)}}
function parseAmaranthLinkData(a,b,c){var d=(a="keep"===a)?"NOT_KEEP_MODULE":"NOT_LINK_MODULE";try{duzon_http.ajax({isCallAmaranthApi:!0,type:"post",url:a?"/ecm/oneffice/one013A05":"/ecm/oneffice/one013A07",async:!0,data:{url:b},dataType:"json",timeout:2E3,success:function(a){var b=null;0===a.resultCode&&a.resultData&&a.resultData.moduleGbn!==d&&(a=a.resultData,b={},a.moduleGbn&&0<a.moduleGbn.length&&(b.moduleGbn=a.moduleGbn),a.cls&&0<a.cls.length&&(b.cls=a.cls),a.title&&0<a.title.length&&(b.title=
Base64.decode(a.title)),b.type=a.type&&0<a.type.length?a.type:"O");c(b,b?void 0:d)},error:function(a){c(void 0,a)}})}catch(e){c(void 0,e)}}
function adjustAmaranthLink(a,b){try{if(!a||b&&"undefined"!==typeof DzeVer&&0<DzeVer.compare(b,"4.2.04.19"))return!1;var c=a.ownerDocument,d=0;[].slice.call(a.querySelectorAll("a.dze_oneffice_link_flag, a.dze_oneffice_slide_link_flag, a.dze_onechamber_link_flag, a.dze_amaranth_link")).forEach(function(a){for(var b=a.childNodes,e,h,k=0,l=b.length;k<l;k++)e=b[k],3===e.nodeType&&e.nodeValue&&(h=c.createElement("span"),a.replaceChild(h,e),h.appendChild(e),d++)});return 0<d}catch(e){dalert(e)}}
function checkDzeCellLocked(a,b){try{if(!0!==dzeUiConfig.bUseLockEditCellFunction||a.keyCode==ID_KEYCODE_ARROW_LEFT||a.keyCode==ID_KEYCODE_ARROW_TOP||a.keyCode==ID_KEYCODE_ARROW_RIGHT||a.keyCode==ID_KEYCODE_ARROW_BOTTOM||a.keyCode==ID_KEYCODE_TAB||a.ctrlKey&&!a.altKey&&!a.shiftKey&&(a.keyCode==ID_KEYCODE_Z||a.keyCode==ID_KEYCODE_Y))return!1;var c=g_objNodeUtil.getAncestorNodeOnCaret(b);if(!c)return!1;var d=g_objNodeUtil.getLoopParentElementByTagNames(c,["td","th"]);return d?g_objTableFunction.isCellLocked(d):
!1}catch(e){return dalert(e),!1}}function setSelectionColor(a,b){try{b=b||"";var c=g_objEditorDocument[a].head.querySelector("style#dze_selections");c&&c.getAttribute("selection_color")!=b&&(c.innerHTML=""===b?"":"::selection { background: "+b+"; }",c.setAttribute("selection_color",b))}catch(d){return dalert(d),!1}}function getSelectionColor(a){try{var b=g_objEditorDocument[a].head.querySelector("style#dze_selections");return b?b.getAttribute("selection_color"):""}catch(c){dalert(c)}}
function setHyperlinkAuto(a,b){try{if(!SelectionUtil.isOnInput(a)){var c=!1,d=b?!0:!1;if(!0===d)var e=b;else{g_objCaretUtil.saveCaret();var f=g_objEditorDocument[a].getElementById(g_objCaretUtil.ID_CURRENT_CARET);e=f.previousSibling}checkHyperlinkableText=function(a){if(!(!0===fnObjectCheckNull(a)||"a"===a.nodeName.toLowerCase()||1>a.childNodes.length))for(var b,c=0;c<a.childNodes.length;c++)b=a.childNodes[c],"a"!==b.nodeName.toLowerCase()&&(b.nodeType===ID_SELECTION_TEXT_NODE?(setHyperlink(1,b),
setHyperlink(2,b),setHyperlink(3,b)):checkHyperlinkableText(b))};setHyperlink=function(b,e){try{switch(b){case 1:var f=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gi;break;case 2:f=/(www\.[\S]+(\b|$))/gi;break;case 3:f=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gi}var g=e.nodeValue.match(f);if(!1===d){if(!0===fnObjectCheckNull(g)||1>g.length)b=2,f=/(www\.[\S]+(\b|$))/gi,g=e.nodeValue.match(f);if(!0===fnObjectCheckNull(g)||1>g.length)b=3,f=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gi,
g=e.nodeValue.match(f)}if(!(!0===fnObjectCheckNull(g)||1>g.length))for(var h,k,p,t,r=g.length-1;0<=r;r--){k=g[r].trim();h=e.nodeValue;if(!1===d&&(h.length!==h.lastIndexOf(k)+k.length||r!==g.length-1))break;var u=h.lastIndexOf(k);if(0!==u){var v=h.charAt(u-1);if(!0===/^\s+$/.test(v))e.splitText(u),p=e.nextSibling;else continue}else p=e;1===b?h=p.nodeValue.replace(f,'<a href="$&" target="_blank">$&</a>'):2===b?h=p.nodeValue.replace(f,'<a href="http://$&" target="_blank">$&</a>'):3===b&&(h=p.nodeValue.replace(f,
'<a href="mailto:$&">$&</a>'));var x=g_objEditorDocument[a].createElement("a");t=g_objNodeUtil.getParentElement(p);t.insertBefore(x,p);t.removeChild(p);x.outerHTML=h;c=!0}}catch(w){dalert(w)}};if(!1===fnObjectCheckNull(e)&&(3!==e.nodeType||!g_objNodeUtil.getLoopParentElement(e,"A",!0)))if(!0===d)checkHyperlinkableText(e);else if(e.nodeType===ID_SELECTION_TEXT_NODE){var g=e.nodeValue.charAt(e.nodeValue.length-1);!1===/^\s+$/.test(g)&&setHyperlink(1,e)}else checkHyperlinkableText(e)}}catch(h){dalert(h)}finally{!1===
d&&g_objCaretUtil.restoreCaret(),!1===c&&!1===fnObjectCheckNull(e)&&(e.nodeType===ID_SELECTION_TEXT_NODE?(b=g_objNodeUtil.getParentElement(e),!1===fnObjectCheckNull(b)&&b.normalize()):e.normalize())}}
function removeHyperlink(a){try{var b=g_objEditorDocument[a].getSelection();if(!(!0===fnObjectCheckNull(b)||0>=b.rangeCount)){var c=b.getRangeAt(0).cloneRange(),d=g_objNodeUtil.getSelectionElement_Anchor("A",!0,a);if(!0===fnObjectCheckNull(d))return!1;var e=d.firstChild;if(!0===fnObjectCheckNull(e))return!1;if(e.nodeType===ID_SELECTION_TEXT_NODE&&c.startOffset!==e.nodeValue.length)return b.removeAllRanges(),b.addRange(c),!1;fnHandler_SupportCommand_Main(a,ID_STRING_COMMAND_UNLINK);var f=g_objEditorDocument[a].createRange();
e.nodeType===ID_SELECTION_TEXT_NODE?(f.setStart(e,e.nodeValue.length),f.setEnd(e,e.nodeValue.length)):f=c;b.removeAllRanges();b.addRange(f);g_objUndoRedo.registerUndoRedoStack(0,a);return!0}}catch(g){dalert(g)}}
function insertPara(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_ENTER||a.modifierKey)return!1;var b=a.nEditNumber,c=GetCurRange(b);if(!c)return!1;var d=g_objNodeUtil,e=SelectionUtil,f=c.startContainer.childNodes[c.startOffset]||c.startContainer,g="undefined"!==typeof g_objShapeFunction?g_objShapeFunction:null;if(g&&g.getTextboxInShape(f)||g.getShapeObject(f))return!1;var h=d.getLoopParentElementByTagNames(f,d.arrParaTagName);if(!h)return!1;var k=d.getClosetBound(f);if(!k||!k.contains(h)||
!k.contains(3===f.nodeType?f.parentNode:f))return!1;var l=getParaProp_NotCopy(h),m=g_bBrowserType_IE&&e.existOnFirst(h,c),q=g_bBrowserType_IE&&e.existOnLast(h,c);if(!(0<Object.keys(l).length||m||q||c.collapsed&&d.isOffsetBetweenBr(c.startContainer,c.startOffset)))return!1;dlog("*** insert para!!!");!0===e.deleteSelection(b)&&(c=GetCurRange(b));var n=h.ownerDocument.createElement("span");c.insertNode(n);var p=n.previousSibling;p&&3===p.nodeType&&0===p.textContent.length&&(n.parentNode.removeChild(p),
p=n.previousSibling);for(;null!==p&&"SPAN"===p.nodeName&&!0===g_objPropertyUtil.hasClass(p,"dze_shape_main");)n.parentNode.insertBefore(n,p),p=n.previousSibling;d.splitOn(h.parentNode,n);var t=n.previousSibling,r=n.nextSibling;n.parentNode.removeChild(n);"LI"===r.nodeName&&!0===l.bListStyleType&&(r.style.listStyleType="",""===r.style.cssText&&r.removeAttribute("style"));var u=d.findLastBr(t);u&&d.isLastBr(u,t)&&insertAfter(u,u.cloneNode());d.insertBrIntoBlankPara(t);d.insertBrIntoBlankPara(r);d.isBlankPara(t)||
d.removeEmptyNode(t,p);g_objCaretUtil.moveCaret(r,!0);a.preventDefault();return!0}catch(v){dalert(v)}finally{}}
function getParaProp_NotCopy(a){try{var b={};if(!a)return b;var c=g_objPropertyUtil;a.hasAttribute("dze_split")&&(b.bSplit=!0);a.hasAttribute("dze_split_child")&&(b.bSplitChild=!0);c.hasClass(a,"dze_page_break_para")&&(b.bPageBreak=!0);c.hasClass(a,"dze_shape_anchor")&&(b.bShapeAnchor=!0);!0!==b.bSplit&&!0!==b.bSplitChild||"LI"!==a.nodeName||"none"!==a.style.listStyleType||(b.bListStyleType=!0);return b}catch(d){dalert(d)}}
function getEditorFontList(){var a=[];try{a=g_arrFontName}catch(b){}return a}
function setEditorFontList(a,b){var c=g_arrFontName,d=[];void 0===b&&(b=0);try{if("string"===typeof a){if(d.push(a),""===d)return c}else if(d=a,0===d.length)return c;for(var e in d){var f=d[e];switch(b){case 0:inArray(f,c)||c.push(f);break;case 1:null!=f&&""!=f&&(g_arrFontName=removeArrayItem(f,c)),c=g_arrFontName}}null!=g_objLayerKit.getLayerDocument().getElementById("divComboBoxSelect")&&(g_objLayerKit.getLayerDocument().getElementById("divComboBoxSelect").remove(),g_objComboBoxWin.objComboBoxLayer=
null)}catch(g){}return c}function appendBodyTemporary(a,b,c){try{if(a){var d={position:"fixed",left:screen.width,top:0,zIndex:99999};if(b)for(var e in d)b[e]||(b[e]=d[e]);else b=d;d={};for(e in b)d[e]=a.style[e],a.style[e]=b[e];a.ownerDocument.body.appendChild(a);c&&c();for(e in b)a.style[e]=d[e]}}catch(f){dalert(f)}finally{a.ownerDocument.body.removeChild(a)}}
function isSVG(a){try{return a&&"undefined"!=typeof a&&g_objNodeUtil.getElementTagName(a).toLowerCase()==DZE_TAG_SVG?!0:!1}catch(b){dalert(b)}}
function getMaxBoundSize(a,b){try{var c={width:g_objPositionUtil.getInnerWidth(g_objEditorDocument[a].body),height:Number.MAX_VALUE};!0===dzeUiConfig.bOfficeOnePageLongMode&&(c.height=Number.MAX_VALUE);if(!b){var d=null;d=g_bBrowserType_IE&&!0===duzon_dialog.dialogStatus?g_objLastRange[a]:GetCurRange(a);b=d.startContainer}if(!b)return c;for(a=g_objNodeUtil;b&&!a.isBoundNode(b)&&!a.isListItem(b);)b=b.parentNode;if(!b)return c;var e=g_objPositionUtil.getInnerWidth(b);c.width=Math.max(Math.min(e,c.width),
10);return c}catch(f){return dalert(f),c}}function setOrgImageSize(a,b,c){try{if(a){var d=c?a.naturalWidth:a.width,e=c?a.naturalHeight:a.height;if(d&&e)return b&&b.width&&b.height&&(c=d/e,d>b.width&&(d=b.width,e=b.width/c),e>b.height&&(e=b.height,d=b.height*c)),a.removeAttribute("width"),a.removeAttribute("height"),a.style.width=parseInt(d,10)+"px",a.style.height=parseInt(e,10)+"px",a}}catch(f){dalert(f)}}
function escapeHtml(a,b){try{return"string"===typeof a&&(a=a.replace(/</g,"&lt"),a=a.replace(/>/g,"&gt"),b&&!1===b.tab||(a=a.replace(/\t/g,'<span style="white-space:pre;">\t</span>')),b&&!1===b.br||(a=a.replace(/(?:\r\n|\r|\n){1,}/g,"<br>"))),a}catch(c){return dalert(c),a}}
function replaceFontTag(a){try{if(!a||a.cancelBubble||g_objCaretUtil.isComposing(a))return!1;var b=a.nEditNumber,c=GetCurRange(b);if(!c||!c.collapsed)return!1;var d=c.startContainer;if(!d)return!1;a=null;for(c=g_objNodeUtil;d&&!c.isBlockNode(d);){switch(d.nodeName){case "FONT":a||(a=[]),a.push(d)}d=d.parentNode}if(!a)return!1;d=g_objCaretUtil;var e="replaceFontTag_"+g_objCommonUtil.getUniqueID();d.saveCaret(b,e);c=g_objAdjustDoc;for(var f=[],g=null,h=0,k=a.length;h<k;h++)g=c.changeTextFormat(a[h]),
f.push(g);h=0;for(k=f.length;h<k;h++)c.arrangeStyleSpan(f[h]);d.restoreCaret(b,e);return!0}catch(l){dalert(l)}finally{}}function checkImgLoaded(a,b,c){try{if(a&&b){var d=a.querySelectorAll("img");d=[].slice.call(d);d=d.filter(function(a){return!a.hasAttribute("loading")});var e=d.length;if(0>=e)b();else if(!isNaN(c)&&e>=c)b();else{a=null;c=0;for(var f=e;c<f;c++)a=d[c],a.complete?(e--,0>=e&&b()):a.onload=a.onerror=function(){this.onload=this.onerror=null;e--;0>=e&&b()}}}}catch(g){dalert(g)}}
function adjustSelectionOnTripleClickCell(a,b){try{if(!g_bBrowserType_CR||b.cancelBubble||3>b.detail)return!1;var c=GetCurRange(a);if(!c||c.collapsed)return!1;a=g_objNodeUtil;var d=a.arrCellTagName,e=c.startContainer,f=c.startOffset,g=c.endContainer,h=c.endOffset;if(!e||!g)return!1;var k=a.getLoopParentElementByTagNames(e,d);if(!k)return!1;b=!1;var l=a.getLoopParentElementByTagNames(g,d);l&&SelectionUtil.isOnFirst(l,g,h)&&g_objTableFunction.getFindNextCell(k)===l&&(b=!0);if(!1===b){var m=a.getLoopParentElement(k,
"table"),q=m&&m.nextSibling&&1===m.nextSibling.nodeType?m.nextSibling:null;m&&q&&q.contains(g)&&SelectionUtil.isOnFirst(q,g,h)&&(b=!0)}!0===b&&(3===e.nodeType?(g=e,h=e.nodeValue.length):(g=e,h=e.childNodes.length));return c.startContainer!==e||c.startOffset!==f||c.endContainer!==g||c.endOffset!==h?(c.setStart(e,f),c.setEnd(g,h),SetCurRange(c),!0):!1}catch(n){dalert(n)}}
function deleteIndent(a,b){function c(a){if(0===a.value)return a;Math.abs(a.value)>=a.remain?(a.value=0<a.value?a.value-a.remain:a.value+a.remain,a.remain=0):Math.abs(a.value)<a.remain&&(a.remain=0<a.value?a.remain-a.value:a.remain+a.value,a.value=0);return a}try{if(!a)return!1;var d=a.nEditNumber,e=GetCurRange(d);if(!e)return!1;var f=null;if(e.collapsed){var g=e.startContainer,h=e.startOffset,k=g_objNodeUtil.getLoopParentElementByTagNames(g,g_objNodeUtil.arrParaTagName);if(!k||!SelectionUtil.isOnFirst(k,
g,h))return!1;f=[k]}else{if(a.keyCode===ID_KEYCODE_BACKSPACE)return!1;f=g_objLetterFn.getSelectedParagraph(d)}if(!f||0>=f.length)return!1;a=0;k=null;for(var l=h=g=e=d=0,m=0,q=f.length;m<q;m++)if(k=f[m],e=h=g_objCommonUtil.toPx(k.style.textIndent),d=l=g_objCommonUtil.toPx(k.style.marginLeft),g=e+d,0!==g){if(0>g||!0!==b)l=h=0;else{var n=20;0!==g%20&&(n=g%20);n={value:e,remain:n};c(n);h=n.value;n.value=d;c(n);l=n.value}if(e!==h||d!==l)k.style.textIndent=0===h?"":h,k.style.marginLeft=0===l?"":l,""===
k.style.cssText&&k.removeAttribute("style"),a++}return 0<a?!0:!1}catch(p){dalert(p)}finally{e=null}};

var g_objALinkMgr=new function(){this.doEvent=function(a){try{if(a&&!a.cancelBubble)switch(a.type){case "mousedown":this.doLink(a);break;case "click":this.doLink(a)}}catch(c){dalert(c)}};this.doLink=function(a){try{if(!a)return!1;var c=a.target||a.srcElement,e=a.nEditNumber,d=!a.altKey&&!a.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL),b=this.getALink(a,c);if(!b)return!1;var f=b?g_objEditMode.isLoopContentEditable(b):!1;if((d||!f)&&b&&"A"==b.nodeName&&"dze_bookmark_flag"!=b.className){var h=
this.getTargetLink(b);if(this.isBookmark(h)){if("click"!==a.type){var l=this.getBookmarkName(h);this.goBookmarksPos(null,l,e)}}else"click"!==a.type&&(window.open(b.href,"","width=1366,height=768,left=0,top=0,resizable=yes,scrollbars=yes,noopener"),dlog("window open"));TBCancelBubbleEvent(a);return!0}return!1}catch(g){dalert(g)}};this.getALink=function(a,c){try{var e=g_objNodeUtil;if(g_bBrowserType_CR&&!g_bBrowserType_EDGE){var d=a.composedPath();for(a=0;a<d.length;a++){var b=d[a];if(b&&"A"===b.nodeName)return b;
if(e.isLoopBreakNode(b))break}}else return e.getLoopParentElement(c,"a");return null}catch(f){dalert(f)}};this.getEditorMode=function(){return!0};this.isBookmark=function(a){return 0==a.indexOf("#")?1:0};this.getTargetLink=function(a){return a.href.replace(document.location.href,"")};this.getBookmarkName=function(a){return decodeURIComponent(a.replace("#",""))};this.getTargetInfo=function(a){try{if(!a)return 0;var c=g_objNodeUtil,e=a.offsetTop;if(!e)return 0;for(var d=a.offsetParent;d&&!c.isLoopBreakNode(d);){var b=
d.offsetTop;b||(b=0);e+=b;d=d.offsetParent}return e}catch(f){dalert(f)}return 0};this.moveBmkPos=function(a,c,e,d){try{var b=a.getAttribute("name");if(null==b||""==b)return 2;if(b==c){var f=g_objALinkMgr.getTargetInfo(a);if(0<f){var h=g_objEditorDocument[d].body,l=h.scrollTop,g=f-10;if(500<Math.abs(g-l)){var m=(g-l)/10,k=l+m;h.scrollTop=k;var p=0,n=setInterval(function(){p++;if(100<p)return clearInterval(n),h.scrollTop=g,1;k+=m;0<m&&k>g&&(k=g,clearInterval(n));0>m&&k<g&&(k=g,clearInterval(n));h.scrollTop=
k},30)}else h.scrollTop=g;a.focus()}return 1}return 0}catch(q){dalert(q)}};this.goBookmarksPos=function(a,c,e){try{if("undefined"!=typeof c&&null!=c&&""!=c){null==a&&(a=g_objEditorDocument[e].body.getElementsByTagName("a"));for(var d=g_objALinkMgr.getEditorMode(),b=0;b<a.length;b++)switch(g_objALinkMgr.moveBmkPos(a[b],c,d,e)){case 1:return}}}catch(f){dalert(f)}}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(b,d,e){return b==a&&"q"==d&&e==c}}));return!0===c.q}catch(b){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(b){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+c++,b)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),d=Object.seal({}),c=new a([[b,2],[d,3]]);if(2!=c.get(b)||3!=c.get(d))return!1;c.delete(b);c.set(d,4);return!c.has(b)&&4==c.get(d)}catch(p){return!1}}function b(){}function d(a){if(!$jscomp.owns(a,f)){var d=new b;$jscomp.defineProperty(a,f,{value:d})}}function e(a){var c=Object[a];c&&(Object[a]=function(a){if(a instanceof b)return a;d(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var l=0,h=function(a){this.id_=(l+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),e=c.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=c.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!c.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=new WeakMap,d=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var d=this.entries(),c;!(c=d.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,d){var c=d&&typeof d;"object"==
c||"function"==c?b.has(d)?c=b.get(d):(c=""+ ++h,b.set(d,c)):c="p_"+d;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var f=e[a];if(d!==d&&f.key!==f.key||d===f.key)return{id:c,list:e,index:a,entry:f}}return{id:c,list:e,index:-1,entry:void 0}},f=function(a,d){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:d(b)};b=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),l=f.next();if(l.done||l.value[0]!=b||l.value[1]!=b)return!1;l=f.next();return l.done||l.value[0]==b||4!=l.value[0].x||l.value[1]!=l.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();
this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");
function canListEdit(a){return"undefined"!==typeof g_objSelectedShapesArray&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?!1:!0}function GetCurList(a){return _getCurList(a,!0)}function GetCurListItem(a){return _getCurList(a,!1)}
function _getCurList(a,c){try{a=fnObjectCheckNull(a)?g_nActiveEditNumber:a;if(!canListEdit(a))return null;var b=GetCurRange(a);if(!b)return null;a=g_objNodeUtil;for(var d=g_objListUtil,e=b.startContainer.childNodes[b.startOffset]||b.startContainer;e&&!a.isBoundNode(e);){if(c&&a.isList(e)||!c&&a.isListItem(e))return e;e=e.parentNode}if(b.collapsed){var f=b.startContainer,l=b.startOffset,h=1===f.nodeType?f.childNodes[l-1]:null;if(h&&a.isList(h)&&1===d.getListItemCount(h)){if(c)return h;if(!c&&a.isListItem(h.lastChild))return h.lastChild}}return null}catch(g){dalert(g)}finally{}}
function GetCurListInfo(a,c){return g_objListUtil.getListInfo(GetCurList(a),c)}function GetCurListItemInfo(a,c){return g_objListUtil.getListItemInfo(GetCurListItem(a),c)}function toggleOL(a){try{var c=!1,b=GetCurList(a);return c=b&&"OL"===b.nodeName?removeOLUL(a):insertOL(a)}catch(d){dalert(d)}}function toggleUL(a){try{var c=!1,b=GetCurList(a);return c=b&&"UL"===b.nodeName?removeOLUL(a):insertUL(a)}catch(d){dalert(d)}}
function insertOL(a,c,b){try{var d=g_objListUtil,e=g_objCaretUtil,f=GetCurRange(a),l=f?f.collapsed:!0,h=g_objLetterFn.getSelectedParagraph(a);f=null;var g=0,k=e.createMarkerId("insertorderedlist");e.saveCaret(a,k);for(var m=0,p=h.length;m<p;m++)f=h[m],1===p&&l&&d.isList(f.parentNode)&&d.replaceWithOL(f.parentNode,c,b)?g++:d.replaceWithOL(f,c,b)&&g++;e.restoreCaret(a,k);return 0<g?!0:!1}catch(n){dalert(n)}}
function insertUL(a,c){try{var b=g_objListUtil,d=g_objCaretUtil,e=GetCurRange(a),f=e?e.collapsed:!0,l=g_objLetterFn.getSelectedParagraph(a);e=null;var h=0,g=d.createMarkerId("insertunorderedlist");d.saveCaret(a,g);for(var k=0,m=l.length;k<m;k++)e=l[k],1===m&&f&&b.isList(e.parentNode)&&b.replaceWithUL(e.parentNode,c)?h++:b.replaceWithUL(e,c)&&h++;d.restoreCaret(a,g);return 0<h?!0:!1}catch(p){dalert(p)}}
function removeOLUL(a){try{var c=g_objListUtil,b=g_objCaretUtil,d=g_objLetterFn.getSelectedParagraph(a),e=null,f=0,l=b.createMarkerId("removeolul");b.saveCaret(a,l);for(var h=0,g=d.length;h<g;h++)e=d[h],c.isListItem(e)&&c.replaceWithPara(e)&&f++;b.restoreCaret(a,l);return 0<f?!0:!1}catch(k){dalert(k)}}
function applyListStyleDepth(a,c,b,d,e){try{if(!0!==dzeUiConfig.bApplyListStyleDepth||GetMultiCellSelection(c))return!1;var f=!1;"decrease"===a?f=applyListStyleDepth_Decrease(c,b,d,e):"increase"===a&&(f=applyListStyleDepth_Increase(c,b,d,e));return f}catch(l){dalert(l)}}
function applyListStyleDepth_Decrease(a,c,b,d){try{null===d&&(d=!0);var e=g_objListUtil,f=e.getCurListItemsInRange(a,{bStartEndLi:d,bCheckBound:b});if(!f||0===f.length)return!1;b="";d=0;for(var l=f.length;d<l;d++){var h=e.getListItemInfo(f[d],{style:!0});if(h&&h.nextStyle&&!(h.level>=h.maxLevel)){""===b&&(b=g_objCaretUtil.createMarkerId("list_depth_decrease"),g_objCaretUtil.saveCaret(a,b));var g=h.listItem,k=g.ownerDocument.createElement(h.nextNodeName);g.parentNode.replaceChild(k,g);k.appendChild(g);
e.setListStyle(k,h.nextStyle);e.mergSiblingList(g.parentNode);applyListStyleDepth_SetListItemStyle(g)}}if(e=b?!0:!1)g_objCaretUtil.restoreCaret(a,b),dzeUiConfig.bOfficePagingMode&&(updateOList(f[0].parentNode),g_objPageControl.onSetDelayedUpdatePageTimerForNode(f[0])),!1!==c&&g_objUndoRedo.registerUndoRedoStack(0,a);return e}catch(m){dalert(m)}}
function applyListStyleDepth_Increase(a,c,b,d){try{null===d&&(d=!0);var e=g_objListUtil,f=e.getCurListItemsInRange(a,{bStartEndLi:d,bCheckBound:b});if(!f||0===f.length)return!1;d=g_objNodeUtil;b="";for(var l=0,h=f.length;l<h;l++){var g=e.getListItemInfo(f[l]);if(g&&!(0>=g.level)){""===b&&(b=g_objCaretUtil.createMarkerId("list_depth_increase"),g_objCaretUtil.saveCaret(a,b));var k=g.listItem;d.splitOn(g.list.parentNode,k);var m=k.previousSibling;m&&!m.firstChild&&m.parentNode.removeChild(m);for(var p=
null,n=k.nextSibling;n&&d.isList(n);)p=n.nextSibling,n.firstChild||n.parentNode.removeChild(n),n=p;e.mergSiblingList(k.parentNode,!1,!0);applyListStyleDepth_SetListItemStyle(k);if((n="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getNextSibling(k):null)&&d.isList(n))for(p=n;p;)d.isList(p)&&p.removeAttribute("start"),p=p.firstChild}}if(e=b?!0:!1){g_objCaretUtil.restoreCaret(a,b);updateOList(f[0].parentNode);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(f[0]);
!1!==c&&g_objUndoRedo.registerUndoRedoStack(0,a)}return e}catch(r){dalert(r)}}function hasListInRange(a,c){try{var b=g_objListUtil.getCurListItemsInRange(a,{bStartEndLi:!1,bCheckBound:c});return b&&0!==b.length?!0:!1}catch(d){dalert(d)}}
function applyListStyleDepth_SetListItemStyle(a){try{if(!a)return!1;var c=g_objPropertyUtil;forEach(["dzeExtListStyleTriangleLi","dzeExtListStyleInnerCircleLi","dzeExtListStyleFillCircleLi","dzeExtListStyleDiamondLi","dzeExtListStyleHyponLi"],function(b,d){c.removeClass(a,d)},this);return!0}catch(b){dalert(b)}}
function applyAutoListStyle(a,c){try{if(!(!0!==dzeUiConfig.bAutoSetListStyleType||0<g_objSelectedShapesArray.length||g_objShapeEvtMgr.getShapeTextContainer()||GetMultiCellSelection(c))){var b=!1;if(window.getSelection){var d=g_objEditWindow[c].getSelection();if(d&&1==d.rangeCount){var e=d.getRangeAt(0);b=e.collapsed}else return}else{d=g_objEditorDocument[c].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;""==e.htmlText&&(b=!0)}if(b){var f="commonAncestorContainer"in
e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(f)if(3!=f.nodeType)dlog("nodeType != 3 -> N/A!");else{b="";var l=/^(1|01|A|I)\.\s*/i;if(/^(\-|\*)\s*/i.test(f.nodeValue.replace(/\u200B/g,"")))dlog("match pattern -> ul"),b="ul";else if(l.test(f.nodeValue.replace(/\u200B/g,"")))dlog("match pattern -> ol"),b="ol";else{dlog("no match pattern -> N/A! : value:"+f.nodeValue);return}if("ol"==b){if("li"==f.parentNode.nodeName.toLowerCase()){dlog("inner ol/ul list -> N/A!");return}var h=/^1\.\s*/,
g=/^01\.\s*/,k=/^A\.\s*/;l=/^a\.\s*/;var m=/^I\.\s*/,p=/^i\.\s*/;b="";var n=null;if(h.test(f.nodeValue))n=h,b="decimal";else if(g.test(f.nodeValue))n=g,b="decimal-leading-zero";else if(k.test(f.nodeValue))n=k,b="upper-alpha";else if(l.test(f.nodeValue))n=l,b="lower-alpha";else if(m.test(f.nodeValue))n=m,b="upper-roman";else if(p.test(f.nodeValue))n=p,b="lower-roman";else{dlog("OL list type unknown -> N/A!");return}dlog("autoListType -> "+b);f.nodeValue=f.nodeValue.replace(n,"\u200b");fnHandler_SupportCommand_Main(c,
"InsertOrderedList");if(window.attachEvent){d=g_objEditorDocument[c].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;if(""==e.htmlText){f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(!f)return;var r=g_objNodeUtil.getLoopParentElement(f,"OL");if(!r)return;r.style.listStyleType=b;var q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,
c,"first"))}}else{d=g_objEditWindow[c].getSelection();if(!d)return;if(1==d.rangeCount&&(e=d.getRangeAt(0),e.collapsed)){f=e.commonAncestorContainer;if(!f)return;r=g_objNodeUtil.getLoopParentElement(f,"ol");if(!r)return;r.style.listStyleType=b;q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,c,"first"))}}}else if("ul"==b){r=/^\*\s*/;l=/^\-\s*/;b="";n=null;if(r.test(f.nodeValue.replace(/\u200B/g,"")))n=r,b="disc";else if(l.test(f.nodeValue.replace(/\u200B/g,
"")))n=l,b="hypon";else{dlog("UL list type unknown -> N/A!");return}if("hypon"==b&&!0!==dzeUiConfig.useExtUnorderedListStyleType){dlog("useExtUnorderedListStyleType : "+dzeUiConfig.useExtUnorderedListStyleType+" -> N/A!");return}if("li"==f.parentNode.nodeName.toLowerCase()){if(""==f.parentNode.innerText.replace(n,"\u200b").replace(/\u200B/g,"").trim()){duzon_dialog.setFocusElement(f.parentNode,c,"end");dlog("no li content -> N/A!");return}if(!f.previousSibling||1<f.nodeValue.replace(/\u200B/g,"").length){dlog("li content ok-> N/A!");
return}}f.nodeValue=f.nodeValue.replace(/\u200B/g,"");f.nodeValue=f.nodeValue.replace(n,"\u200b");if("li"==f.parentNode.nodeName.toLowerCase()){h=document.createElement("ul");if("disc"==b)h.style.listStyleType=b;else if("hypon"==b)h.className="dzeExtListStyleHypon";else return;f.parentNode.nextSibling?f.parentNode.parentNode.insertBefore(h,f.parentNode.nextSibling):f.parentNode.parentNode.appendChild(h);f.parentNode.innerHTML=f.parentNode.innerHTML.replace(/\u200B/g,"").replace(/<br>$/,"");g=document.createElement("li");
g.className="dzeExtListStyleHyponLi";g.innerHTML=duzon_dialog.dze_bookmark_last_tag;h.appendChild(g);"disc"==b&&g.getAttribute("class")&&g.removeAttribute("class");duzon_dialog.setFocusElement(g,c,"end")}else if(fnHandler_SupportCommand_Main(c,"InsertUnOrderedList"),window.attachEvent){d=g_objEditorDocument[c].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;if(""==e.htmlText){f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];
if(!f)return;k=g_objNodeUtil.getLoopParentElement(f,"ul");if(!k)return;if("disc"==b)k.style.listStyleType=b;else if("hypon"==b)k.className="dzeExtListStyleHypon";else return;q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,c,"first"))}}else{d=g_objEditWindow[c].getSelection();if(!d)return;if(1==d.rangeCount&&(e=d.getRangeAt(0),e.collapsed)){f=e.commonAncestorContainer;if(!f)return;k=g_objNodeUtil.getLoopParentElement(f,
"ul");if(!k)return;if("disc"==b)k.style.listStyleType=b;else if("hypon"==b)k.className="dzeExtListStyleHypon";else return;q=g_objNodeUtil.getLoopParentElement(f,"li");q.className="dzeExtListStyleHyponLi";null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,c,"first"))}}}else{dlog("autoListType none -> N/A!");return}g_objUndoRedo.registerUndoRedoStack(0,c);TBCancelBubbleEvent(a)}}else dlog("collapsed = false -> N/A!")}}catch(t){dalert(t)}finally{}}
function applyListStyleBackSpace(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_BACKSPACE)return!1;var c=a.nEditNumber,b=g_objListUtil,d=GetCurListItem(c);if(!d)return!1;var e=GetCurRange(c);if(!e||!e.collapsed)return!1;var f=e.startContainer,l=e.startOffset;if(!SelectionUtil.isOnFirst(d,f,l))return!1;var h=b.getRootList(d);if(!h)return!1;var g=b.isList(h.previousSibling)?h.previousSibling:null;if(g&&SelectionUtil.isOnFirst(h,f,l)&&b.mergeRootList(g,h))return g_objCaretUtil.moveCaret(d,
!1),TBCancelBubbleEvent(a),!0;var k=b.getLevel(d);if(0<k){if(applyListStyleDepth("increase",c))return TBCancelBubbleEvent(a),!0}else if(0===k){var m=b.replaceWithPara(d);if(m)return g_objCaretUtil.moveCaret(m),TBCancelBubbleEvent(a),!0}return!1}catch(p){dalert(p)}finally{}}
function applyListStyleDelete(a){function c(c){var h=f.isList(c.nextSibling)?c.nextSibling:null;if(h&&SelectionUtil.isOnLast(c,b,d)){var g=!1,k=[h];"undefined"!==typeof g_objSplitUtil&&(k=k.concat(g_objSplitUtil.getNextSplitNodes(h)));h=0;for(var m=k.length;h<m;h++)f.mergeRootList(c,k[h])&&(g=!0);if(g)return g_objCaretUtil.moveCaret(l,!1,!1),g_objUndoRedo.registerUndoRedoStack(0,e),TBCancelBubbleEvent(a),!0}return!1}var b=null,d=null;try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_DELETE)return!1;
var e=a.nEditNumber,f=g_objListUtil,l=GetCurListItem(e);if(!l)return!1;var h=l.parentNode;if(!f.isList(h))return!1;var g=GetCurRange(e);if(!g||!g.collapsed)return!1;b=g.startContainer;d=g.startOffset;var k=c(h);!1===k&&(k=c(f.getRootList(h)));return k}catch(m){dalert(m)}finally{g=null}}
function applyListBlankEnter(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_ENTER)return!1;var c=a.nEditNumber,b=g_objListUtil,d=GetCurListItem(c);if(!d||!g_objNodeUtil.isBlankPara(d))return!1;var e=b.getLevel(d);if(0<e){if(applyListStyleDepth("increase",c))return TBCancelBubbleEvent(a),!0}else if(0===e){var f=b.replaceWithPara(d);if(f)return g_objCaretUtil.moveCaret(f),TBCancelBubbleEvent(a),!0}return!1}catch(l){dalert(l)}}
function updateOListAfterEnterKeydown(a,c){try{if(dzeUiConfig.bOfficePagingMode&&"undefined"!==typeof g_objSplitUtil&&!(a.keyCode!=ID_KEYCODE_ENTER||a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)){a=g_objNodeUtil;var b=a.getAncestorNodeOnCaret(c);b=a.getLoopParentElement(b,"li");!b||1<b.childNodes.length||0<b.innerText.trim().length||setTimeout(function(){var a=g_objNodeUtil.getAncestorNodeOnCaret(c);if(a=g_objSplitUtil.getNextSibling(a))a.start=1,updateOList(a)},0)}}catch(d){dalert(d)}}
function updateOList(a,c){try{if(a&&dzeUiConfig.bOfficePagingMode&&"undefined"!==typeof g_objSplitUtil){var b=g_objNodeUtil,d=g_objSplitUtil,e=[],f=b.checkTagName(a,"ol","ul");if(f){if(!0===c||"undefined"==typeof c){var l=b.checkTagName(f.parentNode,"ol","ul");l&&updateOList(l,!0)}var h=d.getPreviousSplitSibling(f);for((h=b.checkTagName(h,"ol","ul"))&&(f=h);f;){for(var g=f.start||1,k=f.firstChild;k;)"LI"===k.nodeName&&"none"!==k.style.listStyleType&&g++,b.checkTagName(k,"ol","ul")&&e.push(k),k=k.nextSibling;
var m=d.getNextSplitSibling(f);if((m=b.checkTagName(m,"ol","ul"))&&0<g){for(var p=m.firstChild;p;){if("LI"===p.nodeName&&"none"===p.style.listStyleType)g--;else break;p=p.nextSibling}0<g&&(m.start=g)}f=m}if(!1===c||"undefined"==typeof c)for(a=0;a<e.length;a++)updateOList(e[a],!1)}}}catch(n){dalert(n)}}
function setMultiLevelListStyle(a,c){try{if(!c)return!1;var b=c.length;if(!b)return!1;var d=GetCurList(a);d||(insertOL(a),d=GetCurList(a));if(!d)return!1;for(var e=g_objNodeUtil,f=g_objListUtil,l=d.ownerDocument,h=new Set,g=g_objLetterFn.getSelectedParagraph(a),k=d=null,m=0,p=g.length;m<p;m++)if((d=e.isListItem(g[m])?f.getRootList(g[m]):null)&&h.add(d),"undefined"!==typeof g_objSplitUtil){if(d&&0===m&&(k=g_objSplitUtil.getPrevSplitNodes(d)))for(var n=0;n<k.length;n++)h.add(k[n]);if(d&&m===p-1&&(k=
g_objSplitUtil.getNextSplitNodes(d)))for(n=0;n<k.length;n++)h.add(k[n])}var r=g_objCaretUtil.createMarkerId("set_multi_level_list");g_objCaretUtil.saveCaret(a,r);h.forEach(function(a){var d=[a];a=[].slice.call(a.querySelectorAll("OL, UL"));d=d.concat(a);a=0;for(var h=d.length;a<h;a++){var g=d[a],k=f.getLevel(g);if(0<=k&&k<b){k=c[k];var m=f.isULStyle(k)?"UL":"OL";g.nodeName!==m&&(m=l.createElement(m),e.copyAttribute(m,g),e.moveNodesTo(m,g.firstChild),g.parentNode.replaceChild(m,g),g=m);f.setListStyle(g,
k);f.mergePreviousList(g)}}});g_objCaretUtil.restoreCaret(a,r);g_objUndoRedo.registerUndoRedoStack(0,a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();return!0}catch(q){dalert(q)}}
function deleteLiBr(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||a.modifierKey)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed||!c.startContainer)return!1;var b=g_objNodeUtil,d=g_objCaretUtil,e=c.startContainer,f=c.startOffset,l=e.ownerDocument,h=a.nEditNumber;3===e.nodeType&&""===e.nodeValue&&(f=b.getChildIndex(e)+1,e=e.parentNode);var g=e.childNodes[f];if(!g||"BR"!==g.nodeName)return!1;var k=b.getLoopParentElementByTagNames(e,b.arrListItemTagName,!0);if(!k)return!1;
a=null;for(c=g;c&&!b.isListItem(c)&&!b.isLoopBreakNode(c);){if("DIV"===c.nodeName){a=c;break}c=c.parentNode}if(a){var m="delete_li_remove_div_"+g_objCommonUtil.getUniqueID();d.saveCaret(h,m);var p=l.createDocumentFragment();b.moveNodesTo(p,a.firstChild);a.parentNode.replaceChild(p,a);d.restoreCaret(h,m)}k=b.getLoopParentElementByTagNames(e,b.arrListItemTagName,!0);if(!k)return!1;b=null;d=g;for(e=null;d&&d!==k;){for(e=d.nextSibling;e;)if(3===e.nodeType&&""===e.nodeValue)e=e.nextSibling;else break;
if(e&&1===e.nodeType&&"TABLE"===e.nodeName){b=e;break}d=d.parentNode}if(!b)return!1;dlog("delete br direct");d=g;for(g=null;d&&d!==k;){g=d.parentNode;if(g!==k&&(g.firstChild!==d||g.lastChild!==d))break;g.removeChild(d);d=g}g_objCaretUtil.moveCaret(b);return!0}catch(n){dalert(n)}finally{}}
function deleteNextLi(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||a.modifierKey)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed||!c.startContainer)return!1;var b=c.startContainer,d=c.startOffset;c=g_objNodeUtil;var e=c.getLoopParentElementByTagNames(b,c.arrListItemTagName,!0);if(!e||!SelectionUtil.isOnLast(e,b,d))return!1;var f=g_objListUtil.getNextListItem(e);if(!f||e.nodeName!==f.nodeName||!f.firstChild||"TABLE"!==f.firstChild.nodeName)return!1;b=g_objCaretUtil;var l=
a.nEditNumber,h="delete_next_li_"+g_objCommonUtil.getUniqueID();b.saveCaret(l,h);var g=e.ownerDocument.createDocumentFragment();c.moveNodesTo(g,f.firstChild);e.appendChild(g);a=f;for(f=null;a&&!a.firstChild&&!c.isLoopBreakNode(a)&&(f=a.parentNode,f.removeChild(a),a=f,a.previousSibling!==e););b.restoreCaret(l,h);return!0}catch(k){dalert(k)}finally{}}
function isMultiCaretOnSameRootList(a){try{var c=GetCurRange(a);if(!c||c.collapsed)return!1;a=g_objListUtil;var b=a.getRootList(c.startContainer),d=a.getRootList(c.endContainer);return b&&d?b===d||"undefined"!==typeof g_objSplitUtil&&0<=g_objSplitUtil.getSplitNodes(b).indexOf(d)?!0:!1:!1}catch(e){dalert(e)}}var g_objCurListForDialog=null;function setCurListForDialog(a){try{var c=GetCurList(a);return c?c?(g_objCurListForDialog=c,!0):!1:!1}catch(b){dalert(b)}}
function getCurListForDialog(){try{return g_objNodeUtil.isAlive(g_objCurListForDialog)?g_objCurListForDialog:null}catch(a){dalert(a)}}function getCurListStyleArrayForDialog(){try{var a=getCurListForDialog();if(!a)return null;var c=g_objListUtil,b=a?c.getRootList(a):null;return b?c.getListStyleArray(b):null}catch(d){dalert(d)}}
function setListStartNew(a){try{var c=GetCurListItem(a),b=c?c.parentNode:null,d=g_objListUtil;if(!b||"OL"!==b.nodeName||1===d.getStart(b)&&d.isFirstListItem(c))return!1;var e=g_objCaretUtil.createMarkerId("dze_list_start_new");g_objCaretUtil.saveCaret(a,e);var f=d.replaceWithListFromListItem(c,"OL",d.getListStyle(b),1,!1);g_objCaretUtil.restoreCaret(a,e);updateOList(c.parentNode,!1);return f?!0:!1}catch(l){dalert(l)}}
function setListStartContinue(a){try{var c=GetCurList(a);if(!c||"OL"!==c.nodeName)return!1;a=g_objListUtil;for(var b=a.findPreviousList(c);b&&0===a.getListItemCount(b);)b=a.findPreviousList(b);if(!b)return!1;a.continueStart(c,b);a.setListStyle(c,a.getListStyle(b));updateOList(c,!1);return!0}catch(d){dalert(d)}}
function onDeleteListEvent(a){try{var c=!1;deleteListItemAfterTripleClick(a)&&(c=!0);deleteBlankListItem(a)&&(c=!0);deleteNextBlankListItem(a)&&(c=!0);pullAndDeleteNextListItem(a)&&(c=!0);deleteLiBr(a)&&(c=!0);deleteNextLi(a)&&(c=!0);return c}catch(b){dalert(b)}}
function deleteListItemAfterTripleClick(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=GetCurRange(a.nEditNumber);if(!c||c.collapsed)return!1;var b=c.startContainer,d=c.endContainer,e=c.startOffset,f=c.endOffset;if(!b||!d)return!1;a=g_objListUtil;var l=g_objNodeUtil.getLoopParentBlockNode(b);return a.isListItem(l)&&a.isListItem(d)&&a.getNextListItem(l)===d?SelectionUtil.isOnFirst(l,b,e)&&SelectionUtil.isOnFirst(d,d,f)?deleteListItem(l):!1:!1}catch(h){dalert(h)}finally{}}
function deleteBlankListItem(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed)return!1;a=g_objListUtil;var b=g_objNodeUtil,d=b.getLoopParentBlockNode(c.startContainer);return a.isListItem(d)&&b.isBlankPara(d)?deleteListItem(d):!1}catch(e){dalert(e)}finally{}}
function deleteNextBlankListItem(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed)return!1;a=g_objListUtil;var b=g_objNodeUtil,d=b.getLoopParentBlockNode(c.startContainer);if(!a.isListItem(d))return!1;var e=a.getNextListItem(d);if(!e||!b.isBlankPara(e))return!1;var f=e.parentNode;return f&&f.firstChild===f.lastChild?deleteListItem(e):!1}catch(l){dalert(l)}finally{}}
function getCaretNodeAfterDeleteListItem(a){try{var c=g_objListUtil,b=c.getNextListItem(a);if(b)return b;var d=c.getRootList(a),e=d?d.nextSibling:null;if(e)return e;var f=c.getPreviousListItem(a);if(f)return f;var l=d?d.previousSibling:null;return l?l:null}catch(h){dalert(h)}}
function deleteListItem(a){try{if(!a)return!1;var c=g_objListUtil,b=getCaretNodeAfterDeleteListItem(a);dlog(" * Delete list item directly!");if(!b){var d=c.replaceWithPara(a);g_objCaretUtil.moveCaret(d);return!0}for(var e=a.parentNode;c.isList(e)&&e.firstChild===e.lastChild&&e.firstChild===a;)a=e,e=e.parentNode;a.parentNode.removeChild(a);c.isListItem(b)&&c.mergSiblingList(b.parentNode);g_objCaretUtil.moveCaret(b);return!0}catch(f){dalert(f)}}
function pullAndDeleteNextListItem(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=a.nEditNumber,b=GetCurRange(c);if(!b||!b.collapsed)return!1;a=g_objListUtil;var d=g_objNodeUtil,e=d.getLoopParentBlockNode(b.startContainer);if(!a.isListItem(e))return!1;var f=a.getNextListItem(e);if(!a.isListItem(f)||!SelectionUtil.isOnLast(e,b.startContainer,b.startOffset,!0))return!1;var l=g_objCaretUtil.createMarkerId("pull_list_item");g_objCaretUtil.saveCaret(c,l);var h=e.ownerDocument.createDocumentFragment();
d.moveNodesTo(h,f.firstChild);e.appendChild(h);g_objCaretUtil.restoreCaret(c,l);for(var g=f.parentNode;a.isList(g)&&g.firstChild===g.lastChild&&g.firstChild===f;)f=g,g=g.parentNode;f.parentNode.removeChild(f);a.mergSiblingList(e.parentNode);dlog(" * Delete and pull list item directly!");return!0}catch(k){dalert(k)}finally{}};

var g_objVideoControl=new function(){this.arrVideoNodeName=["IFRAME","IMG","EMBED","OBJECT"];this.isVideo=this.getVideo=function(a){try{return a&&1===a.nodeType?"VIDEO"===a.nodeName||this.isVideoSpan(a)?a:0<=this.arrVideoNodeName.indexOf(a.nodeName)&&this.isVideoSpan(a.parentNode)?a.parentNode:null:null}catch(b){dalert(b)}};this.isVideoSpan=function(a){return a&&1===a.nodeType&&"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_video_iframe_container_span")?a:null};this.isVideoControl=function(a){return a&&
1===a.nodeType&&("VIDEORESIZE"===a.nodeName||"BUTTON"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_play_button"))?a:null}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},b=Object.create(new $jscomp.global.Proxy(a,{get:function(d,c,e){return d==a&&"q"==c&&e==b}}));return!0===b.q}catch(d){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+b++,d)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("WeakMap",function(a){function b(){if(!a||!Object.seal)return!1;try{var f=Object.seal({}),b=Object.seal({}),c=new a([[f,2],[b,3]]);if(2!=c.get(f)||3!=c.get(b))return!1;c.delete(f);c.set(b,4);return!c.has(f)&&4==c.get(b)}catch(l){return!1}}function d(){}function c(a){if(!$jscomp.owns(a,g)){var f=new d;$jscomp.defineProperty(a,g,{value:f})}}function e(a){var f=Object[a];f&&(Object[a]=function(a){if(a instanceof d)return a;c(a);return f(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;var g="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var h=0,k=function(a){this.id_=(h+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var f;!(f=a.next()).done;)f=f.value,this.set(f[0],f[1])}};k.prototype.set=function(a,b){c(a);if(!$jscomp.owns(a,g))throw Error("WeakMap key fail: "+a);a[g][this.id_]=b;return this};k.prototype.get=function(a){return $jscomp.owns(a,g)?a[g][this.id_]:void 0};k.prototype.has=
function(a){return $jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)};k.prototype.delete=function(a){return $jscomp.owns(a,g)&&$jscomp.owns(a[g],this.id_)?delete a[g][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var f=Object.seal({x:4}),b=new a($jscomp.makeIterator([[f,"s"]]));if("s"!=b.get(f)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var c=b.entries(),d=c.next();if(d.done||d.value[0]!=f||"s"!=d.value[1])return!1;d=c.next();return d.done||4!=d.value[0].x||"t"!=d.value[1]||!c.next().done?!1:!0}catch(q){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var d=new WeakMap,c=function(a){this.data_={};this.head_=h();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};c.prototype.set=function(a,b){a=0===a?0:a;var c=e(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=b:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};c.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};c.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=h();this.size=0};c.prototype.has=function(a){return!!e(this,a).entry};
c.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};c.prototype.entries=function(){return g(this,function(a){return[a.key,a.value]})};c.prototype.keys=function(){return g(this,function(a){return a.key})};c.prototype.values=function(){return g(this,function(a){return a.value})};c.prototype.forEach=function(a,b){for(var c=this.entries(),d;!(d=c.next()).done;)d=d.value,a.call(b,d[1],d[0],this)};c.prototype[Symbol.iterator]=c.prototype.entries;var e=function(a,b){var c=b&&typeof b;"object"==
c||"function"==c?d.has(b)?c=d.get(b):(c=""+ ++k,d.set(b,c)):c="p_"+b;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var f=e[a];if(b!==b&&f.key!==f.key||b===f.key)return{id:c,list:e,index:a,entry:f}}return{id:c,list:e,index:-1,entry:void 0}},g=function(a,b){var c=a.head_;return $jscomp.iteratorPrototype(function(){if(c){for(;c.head!=a.head_;)c=c.previous;for(;c.next!=c.head;)return c=c.next,{done:!1,value:b(c)};c=null}return{done:!0,value:void 0}})},h=function(){var a={};return a.previous=
a.next=a.head=a},k=0;return c},"es6","es3");
$jscomp.polyfill("Set",function(a){function b(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var c=Object.seal({x:4}),b=new a($jscomp.makeIterator([c]));if(!b.has(c)||1!=b.size||b.add(c)!=b||1!=b.size||b.add({x:4})!=b||2!=b.size)return!1;var d=b.entries(),h=d.next();if(h.done||h.value[0]!=c||h.value[1]!=c)return!1;h=d.next();return h.done||h.value[0]==c||4!=h.value[0].x||h.value[1]!=h.value[0]?!1:d.next().done}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(b())return a;$jscomp.initSymbolIterator();var d=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};d.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};d.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};d.prototype.clear=function(){this.map_.clear();
this.size=0};d.prototype.has=function(a){return this.map_.has(a)};d.prototype.entries=function(){return this.map_.entries()};d.prototype.values=function(){return this.map_.values()};d.prototype.keys=d.prototype.values;d.prototype[Symbol.iterator]=d.prototype.values;d.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return d},"es6","es3");var OpenFileDlg=duzon_dialog.extend();
(function(){this.idx_openfile_form="idx_duzon_openfile_form";this.idx_openfile_input="idx_duzon_openfile_input";this.idx_openfile_input_css="idx_duzon_openfile_input_css";this.idx_openfile_iframe="idx_duzon_openfile_iframe";this.nm_openfile_iframe="nm_duzon_openfile_iframe";this.avail_openfile_ext=["html","htm","txt"];this.getContent=function(){var a="<form method='post' id='"+this.idx_openfile_form+"' enctype='multipart/form-data' action=''>";a=a+"<table width='100%' border='0' cellpadding='0' cellspacing='0'><tr>"+
("<td style='padding-right:8px;'>"+ID_RES_STRING_SELECT_FILE+"</td>");a=a+"<td style='float: right;'>"+this.makeExtFileForm("openfile",this.idx_openfile_input,"230px",[".html",".htm",".txt"]);a=a+"</td></tr></table><div class=\"duzon_dialog_label_separator\"></div><table id='opencss_table' width='100%' border='0' cellpadding='0' cellspacing='0'><tr>"+("<td style='padding-right:8px;'>"+ID_RES_STRING_SELECT_CSS_FILE+"</td>");a=a+"<td style='float: right;'>"+this.makeExtFileForm("openfilecss",this.idx_openfile_input_css,
"230px",[".css"]);return a+"</td></tr><tr><td colspan='2' height='5'></td></tr></table></form>"};this.onLoad=function(){try{var a=this;this.enableCssFileInput(!1);this.addEventExtFileForm(this.idx_openfile_input,function(){var b=this.value.split(".").pop().toLowerCase();b&&!inArray(b,a.avail_openfile_ext)?alert("'"+b+"' "+ID_RES_DIALOG_ALERT_ALLOWFILES+" : "+a.avail_openfile_ext.join(", ")):a.enableCssFileInput("htm"===b||"html"===b?!0:!1)});this.addEventExtFileForm(this.idx_openfile_input_css,function(){var a=
this.value.split(".").pop().toLowerCase();a&&"css"!==a&&alert(ID_RES_STRING_ALERT_INVALID_CSSFILE)})}catch(b){dalert(b)}};this.onClickOk=function(a,b){var d=g_objLayerKit.getElementById(this.idx_openfile_input);b=g_objLayerKit.getElementById(this.idx_openfile_input_css);if(""!==d.value&&d.files&&d.files.length){var c=d.value.split(".").pop().toLowerCase();if(inArray(c,this.avail_openfile_ext)){var e=b.value.split(".").pop().toLowerCase();if(b&&b.files&&0<b.files.length&&"css"!==e)alert(ID_RES_STRING_ALERT_INVALID_CSSFILE);
else if(e=fnGetEditorHTMLCode(!1,a),e=e.trim(),""==e||"<p><br /></p>"==e||"<p><br></p>"==e||"<p>&nbsp;</p>"==e||"<p></p>"==e||"<br>"==e||"<br />"==e||confirm(ID_RES_DIALOG_CONFIRM_FILE_DELETE_CONTENT)){d=d.files[0];var g=b&&b.files&&0<b.files.length?b.files[0]:null,h=this;try{if("txt"===c)g_objFileUtil.readFile(d,function(b){h.closeDialog();g_objOpenFile.insertToEditor(a,g_objOpenFile.convertTextToHTML(b))});else if("html"===c||"htm"===c){var k=function(b,c){h.closeDialog();var d=document.implementation.createHTMLDocument("NewDoc");
d.documentElement.innerHTML=b;c&&g_objOpenFile.addStyleElement(d,c);g_objOpenFile.setInlineStyleFromStyleElement(d);g_objNodeUtil.clean(d.body);g_objOpenFile.insertToEditor(a,d.body.innerHTML)};g_objFileUtil.readFile(d,function(a){g?g_objFileUtil.readFile(g,function(b){k(a,b)}):k(a,null)})}}catch(f){alert(f),h.closeDialog()}}}else alert("'"+c+"' "+ID_RES_DIALOG_ALERT_ALLOWFILES+" : "+this.avail_openfile_ext.join(", "))}else alert(ID_RES_DIALOG_ALERT_SELECTFILE)};this.enableCssFileInput=function(a){try{g_objLayerKit.getElementById("opencss_table").style.opacity=
a?"":.3,g_objLayerKit.getElementById(this.idx_openfile_input_css).disabled=!a}catch(b){dalert(b)}}}).call(OpenFileDlg);
var g_objFileUtil=new function(){this.isUTF8=function(a){for(var b,d=0,c=a.length;d<c;d++)if(0!==(a[d]&128)){if(192===(a[d]&224))b=2;else if(224===(a[d]&240))b=3;else if(240===(a[d]&248))b=4;else if(248===(a[d]&252))b=5;else if(252===(a[d]&254))b=6;else return!1;for(;0<--b;)if(++d>=a.length||128!==(a[d]&192))return!1}return!0};this.readEncode=function(a,b){var d=new FileReader;d.onload=function(a){if(a.target.error)throw ID_RES_STRING_CANNOT_READ_FILE;a=new Uint8Array(a.target.result);b(g_objFileUtil.isUTF8(a)?
"utf-8":"euc-kr")};d.readAsArrayBuffer(a)};this.readFile=function(a,b){this.readEncode(a,function(d){var c=new FileReader;c.onload=function(a){if(a.target.error)throw ID_RES_STRING_CANNOT_READ_FILE;b(a.target.result)};c.readAsText(a,d)})};this.readFileArray=function(a,b){for(var d=a.length,c=d,e=[],g=0;g<d;g++)this.readFile(a[g],function(a){e.push(a);c--;0>=c&&b(e)})}},g_objOpenFile=new function(){this.insertToEditor=function(a,b){try{g_objUndoRedo.bDoNotInitialStack=!0,setEditorHTMLCode(b,!1,a),
g_objUndoRedo.bDoNotInitialStack=!1,g_objCaretUtil.moveCaret(g_objEditorDocument[a].body),editor_onselectionchange(a),g_objUndoRedo.registerUndoRedoStack(0,a)}catch(d){dalert(d)}};this.setInlineStyleFromStyleElement=function(a){try{var b=a.head||a.getElementsByTagName("head")[0];if(b){var d=b.getElementsByTagName("style");b=0;for(var c=d.length;b<c;b++){var e=d[b];if(""===e.type||"text/css"===e.type){var g=g_objCssParser.initCssParserStruct(e.textContent);if(g){g_objCssParser.parseCss(g.stDocRoot,
g);for(var h=new Set,k=g.stDocRoot.content;null!=k;k=k.next)if(null!=k.arrCssClassName)for(var f=0;f<k.arrCssClassName.length;f++){var n=k.arrCssClassName[f];if(null!=n&&""!=n)if(-1!=n.indexOf(".")){var t=n.split(".");if(2==t.length){n=t[1];var l=a.getElementsByClassName(n);if(null!=l&&0!=l.length){var q=g_objAdjustDoc.makeStyleString_WK(k);if(null!=q&&""!=q){for(var p=0;p<l.length;p++){var m=l[p];"undefined"==typeof m.paste_style&&(m.paste_style="");m.paste_style+=q;h.add(m)}for(;;)if(l=a.getElementsByClassName(n),
0<l.length)l[0].removeAttribute("class");else break}}}}else{var u=g_objCodeLexer.findTagDefineID(n);if(g_objCodeDefine.ID_TAG_UNKNOWN!=u&&g_objCodeDefine.ID_TAG_TD==u&&(l=a.getElementsByTagName(n),null!=l&&0!=l.length)){var r=g_objAdjustDoc.makeStyleString_WK_Filter(k);if(null!=r&&""!=r)for(p=0;p<l.length;p++)m=l[p],"undefined"==typeof m.paste_style&&(m.paste_style=""),m.paste_style+=r,h.add(m)}}}h.forEach(function(a){var b=a.getAttribute("style")||"";a.setAttribute("style",a.paste_style+b);a.paste_style=
null;delete a.paste_style;a.removeAttribute("paste_style")})}}}}}catch(v){dalert(v)}};this.addStyleElement=function(a,b){try{var d=a.head||a.getElementsByTagName("head")[0];if(d){var c=a.createElement("style");c.setAttribute("type","text/css");c.styleSheet?c.styleSheet.cssText=b:c.appendChild(a.createTextNode(b));d.appendChild(c)}}catch(e){dalert(e)}};this.convertTextToHTML=function(a){try{return a=escapeHtml(a,{tab:!1,br:!1}),a=a.replace(/\r\n/g,"XiLBXZ"),a=a.replace(/\n/g,"XiLBXZ"),a=a.replace(/\r/g,
"XiLBXZ"),a=a.replace(/\t/g,"XiLBXZT"),a=a.replace(/\s/g,"&nbsp;"),a=a.replace(/XiLBXZT/g,'<span style="white-space:pre;">\t</span>'),a=a.trim(),a=a.replace(/XiLBXZXiLBXZ/gi,"</p><p><br></p><p>"),a=a.replace(/XiLBXZ/gi,"<br>\r\n"),a="<p>"+a+"</p>",a=a.replace("<p></p>","<p><br></p>"),a=a.replace("\r\n\r\n",""),a=a.replace(/<\/p><p>/g,"</p>\r\n\r\n<p>"),a=a.replace(/<p><br>/g,"<p>"),a=a.replace(/ <\/p>/g,"</p>"),a=a.replace(/XiLBXZT/gi,"\t")}catch(b){return dalert(b),a}}};

var dzeVersion={version:"1.2.0.5",showVersion:function(a){void 0===a&&(a=!0);a=a?"block":"none";parent.document.getElementById("dze_version_text").style.display=a;dlog("=== DzEditor Version : ",this.version)}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof f?a:new f(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var f=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};f.prototype.createResolveAndReject_=function(){function a(a){return function(h){c||(c=!0,a.call(b,h))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};f.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof f)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};f.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(l){this.reject_(l);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};f.prototype.reject_=function(a){this.settle_(2,a)};f.prototype.fulfill_=function(a){this.settle_(1,a)};f.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var g=new b;f.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};f.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(m){c.reject(m)}};f.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(t){h(t)}}:b}var d,h,g=new f(function(a,b){d=a;h=b});this.callWhenSettled_(c(a,d),c(b,h));return g};
f.prototype.catch=function(a){return this.then(void 0,a)};f.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?g.asyncExecute(c):this.onSettledCallbacks_.push(c)};f.resolve=c;f.reject=function(a){return new f(function(b,c){c(a)})};f.race=function(a){return new f(function(b,d){for(var f=$jscomp.makeIterator(a),h=f.next();!h.done;h=f.next())c(h.value).callWhenSettled_(b,
d)})};f.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new f(function(a,f){function h(b){return function(c){g[b]=c;k--;0==k&&a(g)}}var g=[],k=0;do g.push(void 0),k++,c(d.value).callWhenSettled_(h(g.length-1),f),d=b.next();while(!d.done)})};return f},"es6","es3");
var commonUtil=function(){this.dpiValue=this.dpiDiv=null;commonUtil.prototype.contains=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1};commonUtil.prototype.displayErrorAlert=function(a,b){try{dzeEnvConfig.bDebugging&&alert(b+" :: "+a)}catch(c){}};commonUtil.prototype.log=function(a){try{dzeEnvConfig.bDebugging&&"undefined"!==typeof console&&console.log(a)}catch(b){}};commonUtil.prototype.dir=function(a){try{dzeEnvConfig.bDebugging&&"undefined"!==typeof console&&console.dir(a)}catch(b){}};
commonUtil.prototype.afterFocusSetting_FF=function(a){try{g_objEditorDocument[a].body.focus()}catch(b){dalert(b)}};commonUtil.prototype.openWindowCommon=function(a,b,c,d,f){try{var g,h=(screen.width-b)/2,k=(screen.height-c)/2;(g=window.open(a,f,d?"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+b+",height="+c+",top="+k+",left="+h:"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width="+b+",height="+c+",top="+k+
",left="+h))&&4<=parseInt(navigator.appVersion)&&g.window.focus()}catch(l){dalert(l)}};commonUtil.prototype.getTimeCodeString=function(){try{return(new Date).getTime()}catch(a){dalert(a)}};commonUtil.prototype.getUniqueID=function(){try{return Math.random().toString(36).substr(2,9)}catch(a){dalert(a)}};commonUtil.prototype.checkIsHexColorCode=function(a){try{if(null==a||""==a)return!1;if("#"==a.charCodeAt(0))return!0}catch(b){dalert(b)}return!1};commonUtil.prototype.checkIsRGBColorCode=function(a){try{if(null==
a||""==a)return!1;if("rgb"==a.substr(0,3).toLowerCase())return!0}catch(b){dalert(b)}return!1};commonUtil.prototype.convert_RGB_To_Hex=function(a){try{var b=a.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),c=(b&&b[4]||"").trim(),d=b?(b[1]|256).toString(16).slice(1)+(b[2]|256).toString(16).slice(1)+(b[3]|256).toString(16).slice(1):a;if(""!==c){var f=c;f=Math.round(100*f)/100;c=Math.round(255*f);var g=(c+65536).toString(16).substr(-2).toUpperCase();d+=g}return"#"+d}catch(h){dalert(h)}return null};
commonUtil.prototype.getHexColorCode=function(a){try{return this.checkIsRGBColorCode(a)&&(a=this.convert_RGB_To_Hex(a)),a}catch(b){dalert(b)}return""};commonUtil.prototype.getHexColorCodeByNickName=function(a){try{var b=a.toLowerCase();return"black"==b?"#000000":"red"==b?"#ff0000":"windowtext"==b?"#000000":a}catch(c){dalert(c)}return a};commonUtil.prototype.extractNumberValueUnit=function(a,b){try{if(null==a||""==a)return null;if("number"===typeof a)return{nValue:a,strUnit:""};for(var c=!0,d="",f=
"",g=0;g<a.length;g++){var h=a.charAt(g);g_objCodeLexer.isWhite(h)||(c?g_objCodeLexer.isDigit(h)?d+=h:"."==h?d+=h:"-"==h?d+=h:(c=!1,f+=h):f+=h)}f=f.toLowerCase();!0!==b&&"px"==f&&(f="");return{nValue:d,strUnit:f}}catch(k){dalert(k)}return null};commonUtil.prototype.getNumberValue=function(a){try{return/^[0-9\-]+$/.test(a)?parseInt(a):null}catch(b){dalert(b)}return null};commonUtil.prototype.toPx=function(a,b,c){try{var d=0,f=this.extractNumberValueUnit(a);f&&(d=this.convToPx(f.nValue,f.strUnit,b,
c));return d}catch(g){dalert(g)}};commonUtil.prototype.convToPx=function(a,b,c,d){try{switch(b){case "pt":a=this.convPtToPx(a,d);break;case "mm":a=this.convMMToPx(a);break;case "%":c?a=this.convPercentToPx(c,.01*a):dalert(e)}return parseFloat(a)}catch(f){dalert(f)}};commonUtil.prototype.mappingFrom_Pt_To_Px=function(a){try{if(0==a)return 0;if(20>=g_nAdjustFromPtToPxRatio)return null;var b=parseInt(100*a/g_nAdjustFromPtToPxRatio);return 0==b?1:b}catch(c){dalert(c)}return null};commonUtil.prototype.convPxToPt=
function(a){""==a&&(a=0);a=a.replace(/px/gi,"");if(!/^[0-9\.\-]+$/.test(a))return-1;a=parseInt(a,10);return Math.round(.75*a)};commonUtil.prototype.convPtToPx=function(a,b){""==a&&(a=0);if("string"==typeof a&&(a=a.replace(/pt/gi,""),!/^[0-9\.\-]+$/.test(a)))return-1;a=parseInt(a,10);return!0===b?a/.75:Math.round(a/.75)};commonUtil.prototype.convMMToPx=function(a){a=parseFloat(a);return a*this.getDPI()/25.4};commonUtil.prototype.convPxToMM=function(a){a=parseFloat(a);return 25.4*a/this.getDPI()};commonUtil.prototype.CMToPx=
function(a){return this.convMMToPx(10*parseFloat(a))};commonUtil.prototype.PxToCM=function(a){return this.convPxToMM(a)/10};commonUtil.prototype.getDPI=function(){try{if(null!==this.dpiValue)return this.dpiValue;this.dpiDiv=this.dpiDiv||document.getElementById("dpi");this.dpiDiv||(this.dpiDiv=g_objInsertUtil.insertLayerHTML('<div id="dpi" style="width: 1in; height: 1in; left: -100%; top: -100%; position: absolute;"></div>',!1));return this.dpiDiv?this.dpiValue=this.dpiDiv.offsetHeight:1}catch(a){dalert(a)}};
commonUtil.prototype.unloadDPI=function(){try{var a=this.dpiDiv||document.getElementById("dpi");a&&a.parentNode&&a.parentNode.removeChild(a);this.dpiDiv=null}catch(b){dalert(b)}};commonUtil.prototype.convPercentToPx=function(a,b){return a&&a.parentNode?(a=g_objNodeUtil.getClosetBound(a,function(a){return a&&g_objNodeUtil.isListItem(a)?!0:!1}))?g_objPositionUtil.getInnerWidth(a)*parseFloat(b):b:b};commonUtil.prototype.convPxToPercent=function(a,b){try{if(!a||!a.parentNode)return b;var c=g_objNodeUtil.getClosetBound(a,
function(a){return a&&g_objNodeUtil.isListItem(a)?!0:!1});if(!c)return b;var d=g_objPositionUtil.getInnerWidth(c);return parseFloat(b)/d}catch(f){dalert(f)}};this.IS_VALID_VALUE=function(a){try{return fnObjectCheckNull(a)||"object"==typeof a||"boolean"==typeof a?!1:!0}catch(b){dalert(b)}}},g_objCommonUtil=new commonUtil;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});
String.prototype.replaceAll||(String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)});Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a,b){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if("function"!==typeof a)throw new TypeError("predicate must be a function");for(var f=0;f<d;){var g=c[f];if(a.call(b,g,f,c))return g;f++}}});
var startsWith=function(a,b,c){try{return a&&b?a.substring(!c||0>c?0:c,b.length)===b:!1}catch(d){dalert(d)}},endsWith=function(a,b,c){try{if(!a||!b)return!1;c=!c||c>a.length?a.length:c;return a.substring(c-b.length,c)===b}catch(d){dalert(d)}};Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);
Element.prototype.closest||(Element.prototype.closest=function(a){var b=this;do{if(Element.prototype.matches.call(b,a))return b;b=b.parentElement||b.parentNode}while(null!==b&&1===b.nodeType);return null});
var inArray=function(a,b){for(var c in b)if(b[c]==a)return!0;return!1},removeArrayItem=function(a,b){for(var c=[],d=0;b.length>d;d++)b[d].trim()!=a.trim()&&c.push(b[d]);return c},inArrayIndex=function(a,b){for(var c in b)if(b[c]==a)return parseInt(c);return-1},forEach=function(a,b,c){for(var d=0;d<a.length;d++)b.call(c,d,a[d])};
Array.prototype.forEach||(Array.prototype.forEach=function(a,b){if("function"!==typeof a)throw new TypeError(a+" is not a function");b=b||this;for(var c=0,d=this.length;c!==d;++c)a.call(b,this[c],c,this)});var pushArray=function(a,b){forEach(b,function(b,d){a.push(d)});return a};
function getSelectionParentElement(a,b){b=b.toUpperCase();var c=null;if(window.attachEvent){a=g_objEditorDocument[a].selection.createRange();if(fnObjectCheckNull(a))return null;g_strBookmark_IE=a.getBookmark();if(a.moveToBookmark(g_strBookmark_IE))for(c=a.parentElement();c&&c.nodeName.toUpperCase()!=b;)c=c.parentElement}else c=getSelectionElement(b,!1,a);return c}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var $_=function(a){return duzon_dialog.objLayerDoc.getElementById(a)};
Number.prototype.setComma=function(){return this.toString().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")};String.prototype.setComma=function(){return this.replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")};String.prototype.removeComma=function(){return this.replace(/,/g,"")};Number.prototype.removeComma=function(){return this};function insertAfter(a,b){try{var c=null;return c=a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b)}catch(d){dalert(d)}}
function checkNumber(a){try{return/^[0-9\-]+(\.[0-9]+)*$/.test(a)?!0:!1}catch(b){return dalert(b),!1}}function getIntegerDivision(a,b){var c=Math.floor(a/b);a%=b;for(var d=[],f=0;f<b;f++)d[f]=c;for(f=b-1;0<f&&0<a;f--)d[f]+=1,a--;return d}
function changeCss(a,b,c,d,f){try{for(var g,h=0;h<d.styleSheets.length;h++)if(!(f&&d.styleSheets[h].href&&0>d.styleSheets[h].href.lastIndexOf(f)))try{d.styleSheets[h].insertRule(a+" { "+b+": "+c+"; }",d.styleSheets[h][g].length)}catch(l){try{d.styleSheets[h].addRule(a,b+": "+c+";")}catch(m){try{d.styleSheets[h].rules?g="rules":d.styleSheets[h].cssRules&&(g="cssRules");for(var k=0;k<d.styleSheets[h][g].length;k++)if(d.styleSheets[h][g][k].selectorText==a&&d.styleSheets[h][g][k].style[b]){d.styleSheets[h][g][k].style[b]=
c;break}}catch(p){}}}}catch(l){dalert(l)}}
var Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b="",c=0;for(a=Base64._utf8_encode(a);c<a.length;){var d=a.charCodeAt(c++);var f=a.charCodeAt(c++);var g=a.charCodeAt(c++);var h=d>>2;d=(d&3)<<4|f>>4;var k=(f&15)<<2|g>>6;var l=g&63;isNaN(f)?k=l=64:isNaN(g)&&(l=64);b=b+Base64._keyStr.charAt(h)+Base64._keyStr.charAt(d)+Base64._keyStr.charAt(k)+Base64._keyStr.charAt(l)}return b},decode:function(a){var b="",c=0;for(a=a.replace(/[^A-Za-z0-9\+\/=]/g,
"");c<a.length;){var d=Base64._keyStr.indexOf(a.charAt(c++));var f=Base64._keyStr.indexOf(a.charAt(c++));var g=Base64._keyStr.indexOf(a.charAt(c++));var h=Base64._keyStr.indexOf(a.charAt(c++));d=d<<2|f>>4;f=(f&15)<<4|g>>2;var k=(g&3)<<6|h;b+=String.fromCharCode(d);64!=g&&(b+=String.fromCharCode(f));64!=h&&(b+=String.fromCharCode(k))}return b=Base64._utf8_decode(b)},_utf8_encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):
(127<d&&2048>d?b+=String.fromCharCode(d>>6|192):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128)),b+=String.fromCharCode(d&63|128))}return b},_utf8_decode:function(a){var b="",c=0;for(c1=c2=0;c<a.length;){var d=a.charCodeAt(c);128>d?(b+=String.fromCharCode(d),c++):191<d&&224>d?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((d&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),c+=3)}return b}};
window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));function isRelativeUrl(a){return 0==a.indexOf("http://")||0==a.indexOf("https://")||0==a.indexOf("//")?!1:!0}function getFullUrlFromPath(a){return 0==a.indexOf("http://")||0==a.indexOf("https://")||0==a.indexOf("//")?a:0==a.indexOf("/")?document.location.origin+a:document.location.href.substring(0,location.href.lastIndexOf("/"))+"/"+a}
function cloneSimpleObject(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function isShowScrollBar(a){try{return{vertical:g_objEditObject[a].scrollHeight<g_objEditorDocument[a].body.scrollHeight,horizontal:g_objEditObject[a].scrollWidth<g_objEditorDocument[a].body.scrollWidth}}catch(b){dalert(b)}}
function parseURL(a){var b=document.createElement("a"),c={},d;b.href=a;a=b.search.replace(/^\?/,"").split("&");for(d=0;d<a.length;d++){var f=a[d].split("=");c[f[0]]=f[1]}return{protocol:b.protocol,host:b.host,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,searchObject:c,hash:b.hash}}function camelCase(a){return a.replace(/-([a-z])/ig,function(a,c){return c.toUpperCase()})}
function parseStyle(a){try{if(!a||""==a)return null;var b={},c=a.split(";");a=0;for(var d=c.length;a<d;a++){var f=c[a].split(":");if(f&&""!=f&&2==f.length&&f[0]){var g=f[0].trim(),h=f[1].trim();g=camelCase(g);b[g]=h}}return b}catch(k){return dalert(k),null}}
function equalStyle(a,b){try{var c=Object.getOwnPropertyNames(a),d=Object.getOwnPropertyNames(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var f=c[d],g=a[f],h=b[f];if(g&&h)if("fontFamily"===f)g=g.replace(/['"]+/g,""),h=h.replace(/['"]+/g,"");else if("letterSpacing"===f||"fontSize"===f){var k=g_objCommonUtil.extractNumberValueUnit(g),l=g_objCommonUtil.extractNumberValueUnit(h);if(k&&l){if(g.strUnit!==h.strUnit||parseFloat(k.nValue)!==parseFloat(l.nValue))return!1;continue}}if(g!==h)return!1}return!0}catch(m){dalert(m)}}
function throttle(a,b,c){try{var d=a;c=Array.prototype.slice.call(arguments,2);clearTimeout(b.tId);b.tId=setTimeout(function(){b.apply(d,c)},1)}catch(f){dalert(f)}}function functionName(a){try{var b=a.toString();b=b.substr(9);return b=b.substr(0,b.indexOf("("))}catch(c){dalert(c)}}
function quoteFontFamily(a){try{if(""==a)return a;for(var b=/^["'].*["']$/,c=/[\t\n\f\r ]/g,d=a.split(","),f=0;f<d.length;f++){var g=d[f].trim();!b.test(g)&&c.test(g)?d[f]='"'+g+'"':d[f]=g}return d=d.join(", ")}catch(h){return dalert(h),a}}function dlog(a){try{dzeEnvConfig.bDebugging&&console.log.apply(console,arguments)}catch(b){}}
function dalert(a){if(dzeEnvConfig.bDebugging){try{throw Error();}catch(c){var b=c}b&&(b=b.stack.split("\n"),b.splice(0,2),b=b.join("\n"),console.log(a+" \n"+b),alert(a+" \n"+b))}}function toFloat(a,b){-1!=(a+"").indexOf(".")&&(a=a.toFixed(b),a=a.replace(/(0+$)/,""));return a}
function uploadImg(a,b,c,d){try{if(b)if(!0===dzeUiConfig.bUseContentExtUpload)d=d||CONST_DZE_UPLOAD_TYPE_IMAGE,g_objExtUploader.initWithUploadItem(b,d),g_objExtUploader._uploadImgCallback=function(a){g_objExtUploader._uploadImgCallback=null;a=[a];var b=[""];c&&c({result:"success",url:a,filename:b})};else{var f=new FormData(b),g=dzeEnvConfig.strUploadImageURL;isRelativeUrl(g)||g.substring(0,g.lastIndexOf("/"));duzon_http.ajax({type:"post",url:g,async:!0,data:f,dataType:"form-data",timeout:3E4,loading_screen:!0,
loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(b){b=duzon_http.parseJSON(b);"success"!=b.result?alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR):(b.url&&!Array.isArray(b.url)&&(b.url=[b.url]),b.filename&&!Array.isArray(b.filename)&&(b.filename=[b.filename]),b.relativeUrl&&!Array.isArray(b.relativeUrl)&&(b.relativeUrl=[b.relativeUrl]),DZE_UPLOAD_EVENT.setComplete(a,b),c&&c(b))},error:function(){dalert("upload err");c&&c(null)}})}}catch(h){dalert(h)}}
function textEllipsis(a,b){try{return b||(b=50),a&&a.length>b&&(a=a.substr(0,47)+"..."),a}catch(c){return dalert(c),a}}function checkValidImgFile(a,b){try{b=b||function(){};for(var c=[],d=0,f=a.length;d<f;d++){var g=new Image;c.push(g)}checkImgFileExt({files:a,names:[],imgs:c,errMsgs:[]}).then(checkImgFileLoad).then(function(a){b(a.files,a.names,a.imgs,a.errMsgs)}).catch(function(c){dalert(c);b(a,[],[],[])})}catch(h){dalert(h)}}
function checkImgFileExt(a){return new Promise(function(b){for(var c=a.files,d=a.imgs,f=a.names,g=a.errMsgs,h=[],k=[],l=duzon_dialog.arrAllowedFileExt,m=0,p=c.length;m<p;m++){var n=c[m];if("[object File]"===Object.prototype.toString.call(n)){n=n.name;var q="."+n.split(".").pop().toLowerCase();inArray(q,l)||(d[m]=null,h.push(n))}else n=c[m].toLowerCase(),0!=n.indexOf("http")&&0!=n.indexOf("//")&&(c[m]="http://"+c[m]),n=c[m],q=/[.]/.exec(n)?"."+/[^.]+$/.exec(n)[0]:"",q=q.split(/&|\?|%/)[0],q=q.toLowerCase(),
inArray(q,l)||(d[m]=null,k.push(n));f[m]=n}0<h.length&&g.push('"'+textEllipsis(h.join('", "'))+'" '+ID_RES_CONST_STRING_CANNOT_UPLOAD_FILE_TYPE+" "+l.join(", "));0<k.length&&g.push('"'+textEllipsis(k.join('", "'))+'" '+ID_RES_CONST_STRING_INVALID_IMG_URL+" "+l.join(", "));b(a)}.bind(this))}
function checkImgFileLoad(a){return new Promise(function(b){var c=a.files,d=a.names,f=a.imgs,g=a.errMsgs,h=g_objLayerKit.getLayerDocument().defaultView,k=h.URL||h.webkitURL;h=c.length;var l=[],m=function(){0<l.length&&g.push(ID_RES_DIALOG_ALERT_SELECT_VALID_IMAGE+'\n"'+l.join('", "')+'"');b(a)};if(0===h)m();else for(var p=h,n=0;n<h;n++)f[n]?function(){var a=n,b=c[a],h=d[a],g=f[a],r="";r="[object File]"===Object.prototype.toString.call(b)?k.createObjectURL(b):b;g.src=r;g.onload=function(){g.onload=
g.onerror=null;p--;0===p&&m()};g.onerror=function(){g.onload=g.onerror=null;f[a]=null;l.push(textEllipsis(h));p--;0===p&&m()}}():(p--,0===p&&m())}.bind(this))}function isValidURL(a){return null==a.match(/^(http(s)?:\/\/.)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)?!1:!0}function isOnechamberURL(a){return null==a.match(/\/ecm\/onechamber\/\?token=/gi)?!1:!0}
function isOnefficeURL(a){return null==a.match(/(\/ecm\/onechamber\/\?token=)|(\/ecm\/oneffice\/\?token=)|(\/ecm\/oneffice\/one003A06)|\/(oneffice_view|oneffice).(do|html)\?.+/gi)?!1:!0}function decimalAdjust(a,b,c){if("undefined"===typeof c||0===+c)return Math[a](b);b=+b;c=+c;if(isNaN(b)||"number"!==typeof c||0!==c%1)return NaN;b=b.toString().split("e");b=Math[a](+(b[0]+"e"+(b[1]?+b[1]-c:-c)));b=b.toString().split("e");return+(b[0]+"e"+(b[1]?+b[1]+c:c))}
function round10(a,b){return decimalAdjust("round",a,b)}function floor10(a,b){return decimalAdjust("floor",a,b)}function ceil10(a,b){return decimalAdjust("ceil",a,b)};

var g_objPropertyUtil=new function(){this.arrOpacityValue="0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9".split(" ");this.arrFilterValue="alpha(opacity=0) alpha(opacity=10) alpha(opacity=20) alpha(opacity=30) alpha(opacity=40) alpha(opacity=50) alpha(opacity=60) alpha(opacity=70) alpha(opacity=80) alpha(opacity=90)".split(" ");this.LEFT=0;this.TOP=1;this.RIGHT=2;this.BOTTOM=3;this.applyFilterOpacityStyle=function(a,b,c){try{!0!==fnObjectCheckNull(a)&&(b?g_bBrowserType_IE?(a.style.opacity=this.arrOpacityValue[c],
a.style.filter=window.attachEvent?this.arrFilterValue[c]:this.arrOpacityValue[c]):a.style.opacity=this.arrOpacityValue[c]:g_bBrowserType_IE?(a.style.opacity="",a.style.filter=""):a.style.opacity="")}catch(e){dalert(e)}};this.setFilterOpacityStyle=function(a,b){try{this.applyFilterOpacityStyle(a,b,3)}catch(c){dalert(c)}};this.setOpacity=function(a,b){try{"undefined"!=typeof a&&"undefined"!=typeof a.id&&(a.style.opacity=b,a.style.filter="alpha(opacity="+100*b+")",a.style.MozOpacity=b,a.style.KhtmlOpacity=
b)}catch(c){dalert(c)}};this.element_hasClass=this.hasClass=function(a,b){try{if(!a||1!==a.nodeType)return!1;var c=a.className;if(!c||"string"!=typeof c)return!1;Array.isArray(b)||(b=[b]);var e=a.classList;if(e&&e.contains){for(var d=0,f=b.length;d<f;d++)if(b[d]&&e.contains(b[d]))return!0;return!1}var g=c.split(" ");d=0;for(f=g.length;d<f;d++){a=0;for(var h=b.length;a<h;a++)if(b[a]&&b[a]===g[d])return!0}}catch(k){dalert(k)}return!1};this.element_addClass=this.addClass=function(a,b){try{var c=a.className;
if(""!=c)for(var e=c.split(" "),d=0;d<e.length;d++)if(e[d]==b)return;a.className=""==c?b:c+" "+b}catch(f){dalert(f)}};this.element_removeClass=this.removeClass=function(a,b){try{var c="",e=!1,d=a.className;if(""!=d){var f=d.split(" ");for(d=0;d<f.length;d++)f[d]==b?e=!0:c=""==c?c+f[d]:c+(" "+f[d])}e&&(""==c?a.removeAttribute("class"):a.className=c)}catch(g){dalert(g)}};this.element_replaceClass=this.replaceClass=function(a,b,c){try{var e="",d=a.className;if(""!=d){var f=d.split(" ");for(d=0;d<f.length;d++)e=
f[d]==b?""==e?e+c:e+(" "+c):""==e?e+f[d]:e+(" "+f[d]);a.className=e}}catch(g){dalert(g)}};this.getElementStyleAttributeValue=function(a,b){try{var c="";if(g_bBrowserType_IE)c=a.currentStyle.getAttribute(b);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)c=a.ownerDocument.defaultView.getComputedStyle(a,null).getPropertyValue(b);return c=null==c?"":c.toLowerCase()}catch(e){dalert(e)}return""};this.setElementStyleAttributeValue=function(a,b,c){try{a.style.setProperty?a.style.setProperty(b,
c,null):a.style.setAttribute(b,c)}catch(e){dalert(e)}};this.getElementBorderStyleAttributeSet=function(a,b){try{var c=[];c[0]=this.getElementStyleAttributeValue(a,"border-left-width",b);c[1]=this.getElementStyleAttributeValue(a,"border-left-style",b);c[2]=this.getElementStyleAttributeValue(a,"border-left-color",b);c[3]=this.getElementStyleAttributeValue(a,"border-top-width",b);c[4]=this.getElementStyleAttributeValue(a,"border-top-style",b);c[5]=this.getElementStyleAttributeValue(a,"border-top-color",
b);c[6]=this.getElementStyleAttributeValue(a,"border-right-width",b);c[7]=this.getElementStyleAttributeValue(a,"border-right-style",b);c[8]=this.getElementStyleAttributeValue(a,"border-right-color",b);c[9]=this.getElementStyleAttributeValue(a,"border-bottom-width",b);c[10]=this.getElementStyleAttributeValue(a,"border-bottom-style",b);c[11]=this.getElementStyleAttributeValue(a,"border-bottom-color",b);this.checkElementBorderWidthByNickName(c[0])&&(c[0]="1px");this.checkElementBorderWidthByNickName(c[3])&&
(c[3]="1px");this.checkElementBorderWidthByNickName(c[6])&&(c[6]="1px");this.checkElementBorderWidthByNickName(c[9])&&(c[9]="1px");return c}catch(e){dalert(e)}return null};this.checkElementBorderWidthByNickName=function(a){try{var b=a.toLowerCase();if("medium"==b||"thin"==b||"thick"==b||"initial"==b)return!0}catch(c){dalert(c)}return!1};this.setElementBorderStyleAttributeSet=function(a,b){try{null!=b&&12==b.length&&(this.setElementStyleAttributeValue(a,"border-left-width",b[0]),this.setElementStyleAttributeValue(a,
"border-left-style",b[1]),this.setElementStyleAttributeValue(a,"border-left-color",b[2]),this.setElementStyleAttributeValue(a,"border-top-width",b[3]),this.setElementStyleAttributeValue(a,"border-top-style",b[4]),this.setElementStyleAttributeValue(a,"border-top-color",b[5]),this.setElementStyleAttributeValue(a,"border-right-width",b[6]),this.setElementStyleAttributeValue(a,"border-right-style",b[7]),this.setElementStyleAttributeValue(a,"border-right-color",b[8]),this.setElementStyleAttributeValue(a,
"border-bottom-width",b[9]),this.setElementStyleAttributeValue(a,"border-bottom-style",b[10]),this.setElementStyleAttributeValue(a,"border-bottom-color",b[11]))}catch(c){dalert(c)}};this.getElementBorderStyleAttributeValue=function(a,b,c){try{var e=this.getElementStyleAttributeValue(a,b,c);if(""==e||null==e||ID_STRING_NAME_UNDEFINED==e)return"";if(this.checkElementBorderWidthByNickName(e))return 1;var d=g_objCommonUtil.getNumberValue(e);return null==d?"":d}catch(f){dalert(f)}return""};this.getTargetCellFlag=
function(a,b){try{var c=a.getAttribute(b);return null==c||""==c?null:parseInt(c)}catch(e){dalert(e)}};this.setTargetCellFlag=function(a,b,c){try{a.setAttribute(b,c)}catch(e){dalert(e)}};this.getTargetCellFlagString=function(a,b){try{return a.getAttribute(b)}catch(c){dalert(c)}};this.setTargetCellFlagString=function(a,b,c){try{a.setAttribute(b,c)}catch(e){dalert(e)}};this.getDocumentOverFlow=function(a){try{a="";var b=g_objPositionUtil.getDocumentElementObject(!1);if(b)return a=b.style.overflow}catch(c){dalert(c)}return""};
this.setDocumentOverFlow=function(a,b){try{var c=g_objPositionUtil.getDocumentElementObject(!1);c&&(c.style.overflow=b)}catch(e){dalert(e)}};this.checkStyleValues=function(a,b){try{a[0]=this.checkStyleFontValue(a[0]);a[1]=this.checkStyleFontSize(a[1]);a[4]=this.checkStyleLetterSpacingValue(a[4]);a[5]=this.checkStyleLineHeightValue(a[5],a[16],b);if(1==a[11])for(var c=0;c<a[22].length;c++)a[22][c]=this.checkStyleFontValue(a[22][c]);if(1==a[12])for(c=0;c<a[23].length;c++)a[23][c]=this.checkStyleFontSize(a[23][c]);
if(1==a[15])for(c=0;c<a[26].length;c++)a[26][c]=this.checkStyleLetterSpacingValue(a[26][c]);if(1==a[16])for(c=0;c<a[27].length;c++)a[27][c]=this.checkStyleLineHeightValue(a[27][c]);if(1==a[16])for(c=0;c<a[27].length;c++)a[27][c]=this.checkStyleLineHeightValue(a[27][c])}catch(e){dalert(e)}};this.checkStyleLineHeightValue=function(a,b,c){try{if("undefined"==typeof a||null==a)a="";if("undefined"==typeof b||1!=b)b=!1;""==a?0==b&&""!=g_strBodyLineHeight&&(a=g_strBodyLineHeight):((0<=a.toLowerCase().indexOf("px")||
0<=a.toLowerCase().indexOf("pt"))&&""!=g_strBodyLineHeight&&(a=g_strBodyLineHeight),0<=a.indexOf("%")&&(a=parseInt(a.replace(/%/g,""),10)/100),"string"!=typeof a&&(a=a.toString()),a=a.replace(/[^0-9\.]/g,""));return a}catch(e){dalert(e)}return""};this.checkStyleFontValue=function(a){try{if("undefined"==typeof a||null==a)a="";return a}catch(b){return""}};this.checkStyleFontSize=function(a){try{if("undefined"==typeof a||null==a)a="";0<=a.indexOf("px")&&(a=g_objCommonUtil.convPxToPt(a),a=0>a?"":a+"pt");
return a}catch(b){return""}};this.checkStyleLetterSpacingValue=function(a){try{if("string"!=typeof a)return a;a=a.toLowerCase();0<=a.indexOf("px")&&(a=g_objCommonUtil.convPxToPt(a),a=0>a?"":a+"pt");return a}catch(b){return""}};this.getSelectionAttributeValue_MultiCell=function(a){try{if(-1==a||!GetMultiCellSelection(a))return null;var b=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]],c={};g_objTableSelection.doAllSelectedCell(function(e){var d=
[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];c.nDepth=0;c.nTranCount=0;if(!this.getNodeAttributeValue_MultiCell(e,d,c,a)||100<this.getSelectionAttributeValue_MultiCell_Count)return null;0!=c.nTranCount&&this.checkCompareAttributeValue(b,d,!0,!1)}.bind(this));b[0]=this.checkStyleFontValue(b[0]);b[1]=this.checkStyleFontSize(b[1]);b[5]=this.checkStyleLineHeightValue(b[5],!1,a);return b}catch(e){dalert(e)}return null};this.getNodeAttributeValue_MultiCell=
function(a,b,c,e){try{c.nDepth++;for(var d=0;d<a.childNodes.length;d++){var f=a.childNodes[d];if(ID_SELECTION_ELEMENT_NODE==f.nodeType){if(!this.getNodeAttributeValue_MultiCell(f,b,c,e))return!1}else if(ID_SELECTION_TEXT_NODE==f.nodeType){c.nTranCount++;var g="",h=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];g=this.getElementStyleAttributeValue(a,"font-family",e);g=this.getElementStyleAttributeFisrtValue(g);h[0]=g;g=this.getElementStyleAttributeValue(a,
"font-size",e);h[1]=g;g=this.getElementStyleAttributeValue(a,"color",e);h[2]=g;g=this.getElementStyleAttributeValue(a,"letter-spacing",e);h[4]=g;g=this.getElementStyleAttributeValue(a,"line-height",e);h[5]=g;this.checkCompareAttributeValue(b,h,!0,!1)}}c.nDepth--;return!0}catch(k){dalert(k)}return!1};this.getSelectionAttributeValue=function(a,b){try{if(-1==a)return null;var c=[];b="undefined"!=typeof b&&!0===b?33:11;var e=this.doGetSelectionAttributeValue(a);if(null==e){for(var d=0;d<b;d++)c[d]="";
return c}for(d=0;d<b;d++)c[d]=e[d],null==c[d]&&(c[d]="");this.checkStyleValues(c,a);return c}catch(f){dalert(f)}};this.doGetSelectionAttributeValue=function(a){try{if(-1==a)return;var b=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[a].selection.type.toLowerCase())return;var c=g_objEditorDocument[a].selection,e=c.createRange(),d=e.parentElement();if(""==
e.text){var f=this.checkTargetNodeName(d);return this.getNodeAttributeValueDetail(d,!0,f,a)}var g=!1,h=!1;"p"==d.nodeName.toLowerCase()&&(d=this.getSelectionParentNode(d,c,e));for(var k=0;k<d.childNodes.length;k++){var l=d.childNodes[k];if(ID_SELECTION_ELEMENT_NODE==l.nodeType&&ID_SELECTION_ELEMENT_NODE==l.nodeType){var q=c.createRange();q.moveToElementText(l);q.collapse(!0);var t=c.createRange();t.moveToElementText(l);t.collapse(!1);var v=e.inRange(q),w=e.inRange(t);if(g)if(v){if(n=this.getNodeAttributeValue(l,
b,a),!n)return null}else{h=!0;break}else if(w&&(g=!0),v||w){var n=this.getNodeAttributeValue(l,b,a);if(!n)return null}}}if(!g||!h){f=this.checkTargetNodeName(d);var m=this.getNodeAttributeValueDetail(d,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}return b}c=g_objEditWindow[a].getSelection();if(1!=c.rangeCount)return;e=c.getRangeAt(0);c=!1;d=e.commonAncestorContainer;e.collapsed?c=!0:ID_SELECTION_TEXT_NODE==d.nodeType&&(c=!0);if(c)return ID_SELECTION_ELEMENT_NODE!=d.nodeType&&
(d=g_objNodeUtil.getParentElement(d)),f=this.checkTargetNodeName(d),this.getNodeAttributeValueDetail(d,!0,f,a);g=!1;h=g_objEditorDocument[a].createRange();var u=[];g_objNodeUtil.traverseNodesInRange(e,function(a){!1===fnObjectCheckNull(a)&&a.nodeType===ID_SELECTION_TEXT_NODE&&u.push(a)});for(k=0;k<u.length;k++)if(l=u[k],h.selectNode(l),g)if(r=e.compareBoundaryPoints(Range.START_TO_END,h),0==r||-1==r)break;else if(ID_SELECTION_ELEMENT_NODE==l.nodeType){if(n=this.getNodeAttributeValue(l,b,a),!n)return null}else{if(ID_SELECTION_TEXT_NODE==
l.nodeType)if(p=g_objNodeUtil.getParentElement(l),f=this.checkTargetNodeName(p),checkTextNodeAllWhiteCode(l.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(p,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,m,!1,f)}}else{m=this.getNodeAttributeValueDetail(p,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}}else{var r=e.compareBoundaryPoints(Range.END_TO_START,h);if(-1==r)if(g=!0,ID_SELECTION_ELEMENT_NODE==l.nodeType){if(n=this.getNodeAttributeValue(l,b,a),
!n)return null}else if(ID_SELECTION_TEXT_NODE==l.nodeType){var p=g_objNodeUtil.getParentElement(l);f=this.checkTargetNodeName(p);if(checkTextNodeAllWhiteCode(l.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(p,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,m,!1,f)}}else if(b=this.getNodeAttributeValueDetail(p,!0,f,a),null==b)return null}}return b}catch(x){dalert(x)}return null};this.getSelectionParentNode=function(a,b,c){try{var e=b.createRange();e.moveToElementText(a);return e.inRange(c)?
a:g_objNodeUtil.getParentElement(a)}catch(d){dalert(d)}};this.getNodeAttributeValue=function(a,b,c){try{for(var e="",d=0;d<a.childNodes.length;d++){var f=a.childNodes[d];if(ID_SELECTION_ELEMENT_NODE==f.nodeType){if(!this.getNodeAttributeValue(f,b,c))return!1}else ID_SELECTION_TEXT_NODE==f.nodeType&&(e+=f.nodeValue)}if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var g=this.checkTargetNodeName(a);if(checkTextNodeAllWhiteCode(e)){if(g){var h=this.getNodeAttributeValueDetail(a,!1,g,c);if(null==h)return!1;
this.checkCompareAttributeValue(b,h,!1,g)}return!0}h=this.getNodeAttributeValueDetail(a,!0,g,c);if(null==h)return!1;this.checkCompareAttributeValue(b,h,!0,g)}return!0}catch(k){dalert(k)}return!1};this.checkCompareAttributeValue=function(a,b,c,e){try{for(var d=0;11>d;d++)"undefined"==typeof a[d+11+11]&&(a[d+11+11]=[]),a[d+11+11].push(b[d]),a[d+11]&&!0!==g_getSelectionAttribute_Absolute?a[d]="":null==a[d]?6>d?c&&(a[d]=b[d]):e&&(a[d]=b[d]):6>d?c&&a[d]!=b[d]&&(a[d]=!0!==g_getSelectionAttribute_Absolute?
"":b[d],a[d+11]=!0):e&&a[d]!=b[d]&&(a[d]=!0!==g_getSelectionAttribute_Absolute?"":b[d],a[d+11]=!0)}catch(f){dalert(f)}};this.getNodeAttributeValueDetail=function(a,b,c,e){try{var d=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];if("undefined"==typeof a||null==a||"undefined"==typeof a.style||null==a.style)return d;var f=a;if(c||b){var g=g_objNodeUtil.getClosetParagraph(a);g&&(f=g)}for(g=0;11>g;g++){var h="";if(0==g)b&&(h=a.style.fontFamily,
""==h&&(h=this.getElementStyleAttributeValue(a,"font-family",e),h=this.getElementStyleAttributeFisrtValue(h)));else if(1==g)b&&(h=a.style.fontSize,""==h&&(h=this.getElementStyleAttributeValue(a,"font-size",e)));else if(2==g)b&&(h=a.style.color,""==h&&(h=this.getElementStyleAttributeValue(a,"color",e)),h=g_objCommonUtil.getHexColorCode(h));else if(3==g){if(b)try{h=a.style.backgroundColor;if(""==h)for(var k=a,l=0;"undefined"!=typeof k&&null!=k&&"body"!=k.nodeName.toLowerCase();){if(("span"==k.nodeName.toLowerCase()||
"p"==k.nodeName.toLowerCase())&&k.getAttribute("style")&&k.style.backgroundColor){h=k.style.backgroundColor;break}l++;if(10<l)break;k=k.parentNode}h=g_objCommonUtil.getHexColorCode(h)}catch(q){h=""}}else 4==g?b&&(h=a.style.letterSpacing,""==h&&(h=this.getElementStyleAttributeValue(a,"letter-spacing",e))):5==g?b&&(h=f.style.lineHeight,""==h&&(h=this.getElementStyleAttributeValue(f,"line-height",e)),h=this.getUnitlessLineHeight(h,this.getElementStyleAttributeValue(f,"font-size",e))):6==g?c&&(h=f.style.marginLeft):
7==g?c&&(h=f.style.marginTop):8==g?c&&(h=f.style.marginRight):9==g?c&&(h=f.style.marginBottom):10==g&&c&&(h=f.style.textIndent);d[g]=h}return d}catch(q){dalert(q)}return null};this.getUnitlessLineHeight=function(a,b){try{var c=g_objCommonUtil;if("normal"===a||"initial"===a||"inherit"===a)return g_strBodyLineHeight;var e=c.extractNumberValueUnit(a,!0);if(!e)return a;if("%"===e.strUnit)a=parseInt(e.nValue,10)/100;else if(""!==e.strUnit&&"em"!==e.strUnit&&b&&("px"===e.strUnit||"pt"===e.strUnit)){var d=
c.toPx(b,null,!0),f=c.toPx(a,null,!0);d&&f&&(b=f/d,a=b=Math.round(100*b)/100)}return a+""}catch(g){dalert(g)}};this.getElementStyleAttributeFisrtValue=function(a){try{var b=a.split(",");if(0==b.length)return"";if(1==b.length)return a;var c=b[0].trim();return c=c.replace(/(")/g,"")}catch(e){dalert(e)}};this.checkTargetNodeName=function(a){try{var b=this.checkNodeName(a,"p");b||(b=this.checkNodeName(a,"h1"));b||(b=this.checkNodeName(a,"h2"));b||(b=this.checkNodeName(a,"h3"));b||(b=this.checkNodeName(a,
"h4"));b||(b=this.checkNodeName(a,"h5"));b||(b=this.checkNodeName(a,"h6"));return b}catch(c){dalert(c)}return!1};this.checkNodeName=function(a,b){try{b=b.toLowerCase();var c=g_objNodeUtil.getElementTagName(a).toLowerCase();if(b==c)return!0}catch(e){dalert(e)}return!1};this.removeStyleAttribute=function(a,b){try{a.style.removeAttribute?a.style.removeAttribute(b):a.style.removeProperty&&a.style.removeProperty(b)}catch(c){dalert(c)}};this.getBackgroundImageURL=function(a){try{var b=a.style.backgroundImage;
""!=b&&(a=b,a.toLowerCase(),-1!=a.indexOf("url(")&&(b=a.substring(4,a.length-1)));'"'==b[0]&&'"'==b[b.length-1]&&(b=b.substring(1,b.length-1));return b}catch(c){dalert(c)}return""};this.getElement_Align=function(a){try{var b=a.align;if(""==b||null==b||ID_STRING_NAME_UNDEFINED==b)b="";return b}catch(c){dalert(c)}return null};this.setElement_Align=function(a,b){try{fnObjectCheckNull(b)||(""==b?(a.align="",a.removeAttribute("align")):a.align=b)}catch(c){dalert(c)}};this.getElement_TextAlign=function(a){try{var b=
a.style.textAlign;if(""==b||null==b||ID_STRING_NAME_UNDEFINED==b)b="";return b}catch(c){dalert(c)}return null};this.setElement_TextAlign=function(a,b){try{fnObjectCheckNull(b)||(a.style.textAlign=""==b?"":b)}catch(c){dalert(c)}};this.getElement_BorderWidth_With_Unit=function(a,b){try{var c="";"left"==b?c=a.style.borderLeftWidth:"top"==b?c=a.style.borderTopWidth:"right"==b?c=a.style.borderRightWidth:"bottom"==b&&(c=a.style.borderBottomWidth);return""==c||null==c||ID_STRING_NAME_UNDEFINED==c?{nValue:0,
strUnit:""}:this.checkElementBorderWidthByNickName(c)?{nValue:1,strUnit:"px"}:g_objCommonUtil.extractNumberValueUnit(c)}catch(e){dalert(e)}return null};this.getElement_BGColor=function(a){try{var b=a.style.backgroundColor;if(""==b||null==b||ID_STRING_NAME_UNDEFINED==b)if(b=a.bgColor,""==b||null==b||ID_STRING_NAME_UNDEFINED==b)b="";return b}catch(c){dalert(c)}return""};this.setElement_BGColor=function(a,b){try{"-1"==b||""==b||"null"==b?(a.bgColor="",a.style.backgroundColor="",a.removeAttribute("bgColor"),
a.style.removeAttribute?a.style.removeAttribute("backgroundColor"):a.style.removeProperty&&a.style.removeProperty("backgroundColor")):(a.bgColor=b,a.style.backgroundColor=b)}catch(c){dalert(c)}};this.setElement_BorderLeftColor=function(a,b){try{"-1"==b||""==b?(a.style.borderLeftColor="",a.style.removeAttribute?a.style.removeAttribute("borderLeftColor"):a.style.removeProperty&&a.style.removeProperty("borderLeftColor")):a.style.borderLeftColor=b}catch(c){dalert(c)}};this.setElement_BorderTopColor=function(a,
b){try{"-1"==b||""==b?(a.style.borderTopColor="",a.style.removeAttribute?a.style.removeAttribute("borderTopColor"):a.style.removeProperty&&a.style.removeProperty("borderTopColor")):a.style.borderTopColor=b}catch(c){dalert(c)}};this.setElement_BorderRightColor=function(a,b){try{"-1"==b||""==b?(a.style.borderRightColor="",a.style.removeAttribute?a.style.removeAttribute("borderRightColor"):a.style.removeProperty&&a.style.removeProperty("borderRightColor")):a.style.borderRightColor=b}catch(c){dalert(c)}};
this.setElement_BorderBottomColor=function(a,b){try{"-1"==b||""==b?(a.style.borderBottomColor="",a.style.removeAttribute?a.style.removeAttribute("borderBottomColor"):a.style.removeProperty&&a.style.removeProperty("borderBottomColor")):a.style.borderBottomColor=b}catch(c){dalert(c)}};this.setElement_BorderStyle=function(a,b,c){try{fnObjectCheckNull(b)&&(b=""),"left"==c?a.style.borderLeftStyle=b:"top"==c?a.style.borderTopStyle=b:"right"==c?a.style.borderRightStyle=b:"bottom"==c&&(a.style.borderBottomStyle=
b)}catch(e){dalert(e)}};this.getElementPaddingStyleAttributeSet=function(a,b){try{var c=[];c[0]=this.getElementStyleAttributeValue(a,"padding-left",b);c[1]=this.getElementStyleAttributeValue(a,"padding-top",b);c[2]=this.getElementStyleAttributeValue(a,"padding-right",b);c[3]=this.getElementStyleAttributeValue(a,"padding-bottom",b);return c}catch(e){dalert(e)}return null};this.getPadding=function(a,b){try{if(!a||a.nodeType!=ID_SELECTION_ELEMENT_NODE)return 0;var c=g_objCommonUtil,e=this.LEFT,d=this.BOTTOM,
f=[];"undefined"!=typeof b&&(d=e=b);for(b=e;b<=d;b++){e="";switch(b){case this.LEFT:e=a.style.paddingLeft;break;case this.TOP:e=a.style.paddingTop;break;case this.RIGHT:e=a.style.paddingRight;break;case this.BOTTOM:e=a.style.paddingBottom}var g=c.extractNumberValueUnit(e);g=g?"pt"==g.strUnit?c.convPtToPx(g.nValue):parseFloat(g.nValue):0;f.push(parseFloat(g.toFixed(2)))}return 1==f.length?f[0]:f}catch(h){dalert(h)}};this.setElementPaddingStyleAttributeSet=function(a,b){try{null!=b&&4==b.length&&(this.setElementStyleAttributeValue(a,
"padding-left",b[0]),this.setElementStyleAttributeValue(a,"padding-top",b[1]),this.setElementStyleAttributeValue(a,"padding-right",b[2]),this.setElementStyleAttributeValue(a,"padding-bottom",b[3]))}catch(c){dalert(c)}};this.getStyleStringByOption=function(a,b,c){try{var e=a.getAttribute("style");e=e.trim();var d=e.split(";");for(a=0;a<d.length;a++)if(""==d[a])d.splice(a,1),a--;else{var f=d[a].split(":");if(2==f.length){var g=f[0].trim().toLowerCase();b&&"width"==g?(d.splice(a,1),a--):c&&"height"==
g&&(d.splice(a,1),a--)}else d.splice(a,1),a--}b="";for(a=0;a<d.length;a++)b+=d[a],b+=";";return b}catch(h){dalert(h)}return""};this.getTextContent=function(a){try{var b="";a.innerText?b=a.innerText:a.textContent&&(b=a.textContent);return b}catch(c){dalert(c)}return""};this.setSkinColorSet=function(a){try{g_arrSkinColor.length&&"blue"!=g_arrSkinColor[0]&&("undefined"==typeof a&&(a=document),changeCss(".duzon_menubar_title_over","background-color",g_arrSkinColor[1],a),changeCss(".duzon_menubar_title_down",
"background-color",g_arrSkinColor[1],a),changeCss(".duzon_menubar_title_up","background-color",g_arrSkinColor[1],a),changeCss(".duzon_menubar_line","background-color",g_arrSkinColor[2],a),changeCss(".duzon_menubar_title","background-color",g_arrSkinColor[2],a),changeCss(".duzon_dialog_title","background-color",g_arrSkinColor[2],a),changeCss(".dze_extdlg_title_container","background-color",g_arrSkinColor[2],a),!0===dzeUiConfig.bUseUiMode&&g_arrSkinColor[3]&&(changeCss(".duzon_tb_button_over_ribbon",
"background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_button_down_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_button_up_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_over_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_down_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_up_ribbon","background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_arrow_over_ribbon",
"background-color",g_arrSkinColor[3],document),changeCss(".duzon_tb_dropdown_arrow_down_ribbon","background-color",g_arrSkinColor[3],document)))}catch(b){dalert(b)}};this.getStyleWidth=function(a){try{if(!a)return 0;var b=g_objCommonUtil,c=b.extractNumberValueUnit(a.style.width||a.width),e=c?b.convToPx(c.nValue,c.strUnit,a):0;return parseFloat(e.toFixed(2))}catch(d){dalert(d)}};this.getStyleHeight=function(a){try{if(!a)return 0;var b=g_objCommonUtil,c=b.extractNumberValueUnit(a.style.height||a.height),
e=c?b.convToPx(c.nValue,c.strUnit,a):0;return parseFloat(e.toFixed(2))}catch(d){dalert(d)}}};

var g_objNodeUtil=new function(){this.arrParaTagName="p li h1 h2 h3 h4 h5 h6 dt dd pre".split(" ");this.arrParaNodeName="P LI H1 H2 H3 H4 H5 H6 DT DD PRE".split(" ");this.arrCellTagName=["td","th"];this.arrCellNodeName=["TD","TH"];this.arrListNodeName=["OL","UL","DL"];this.arrListTagName=["ol","ul","dl"];this.arrListItemNodeName=["LI","DT","DD"];this.arrListItemTagName=["li","dt","dd"];this.arrTextInputType="text password search tel url week month number".split(" ");this.setAttribute=function(a,b,
c){try{a&&a.hasAttribute&&a.setAttribute(b,c)}catch(d){dalert(d)}};this.getAttribute=function(a,b){try{if(a&&a.getAttribute)return a.getAttribute(b)}catch(c){dalert(c)}};this.removeAttribute=function(a,b){try{if(a&&a.removeAttribute)return a.removeAttribute(b)}catch(c){dalert(c)}};this.hasAttribute=function(a,b){try{if(a&&a.hasAttribute)return a.hasAttribute(b)}catch(c){dalert(c)}};this.copyAttribute=function(a,b){try{if(!a||!b)return!1;for(var c=null,d=Array.prototype.slice.call(b.attributes);c=
d.pop();)a.setAttribute(c.nodeName,c.nodeValue);return!0}catch(e){dalert(e)}};this.getChildrenCollection=function(a){try{var b=null;return b=window.attachEvent?a.children:a.childNodes}catch(c){dalert(c)}return null};this.getSelectionElement_NodeChk=function(a,b){var c=!1,d=g_objPropertyUtil;try{if(window.attachEvent)return c;var e=g_objEditWindow[a].getSelection();if(null===e.anchorNode||!e.getRangeAt(0).collapsed)return c;var f=e.getRangeAt(0).commonAncestorContainer,g=e.getRangeAt(0).startContainer,
h=f.previousSibling,k=f.nextSibling,l=g.previousSibling,t=f.parentNode,u=f.parentNode.nextSibling,w=f.parentNode.previousSibling;a=0;void 0!=f.data&&(a=f.data.length);f.className===b&&(c=!0,dlog("container_chk"));null===k&&""===f.data&&h&&d.element_hasClass(h.previousSibling,b)&&(c=!0,dlog("last_chk"));!c&&d.element_hasClass(k,b)&&a<=e.getRangeAt(0).endOffset&&(c=!0,dlog("next_chk"));!c&&d.element_hasClass(u,b)&&"string"!=typeof u&&a<=e.getRangeAt(0).endOffset&&(c=!0,dlog("next_parent_chk"));if(!c&&
d.element_hasClass(h,b)&&(1===e.getRangeAt(0).endOffset||1===f.length)){c=!0;dlog("prev_chk");var v=h.data;void 0!=v&&(v=v.replace(/\u200B/,"temp_chk_node"));"temp_chk_node"===v&&d.element_hasClass(h.previousSibling,b)&&(c=!1,dlog("prev_ele_chk"))}!c&&d.element_hasClass(l,b)&&1>=e.getRangeAt(0).endOffset&&(c=!0,dlog("prev_start_chk"));!c&&d.element_hasClass(w,b)&&"string"!=typeof w&&a<=e.getRangeAt(0).endOffset&&(c=!0,dlog("prev_parent_chk"));if(!c&&("P"===t.nodeName||0!=f.childNodes.length)){var r=
e.getRangeAt(0).endOffset;for(e=0;e<r;e++){var q=f.childNodes[r-(e+1)],m=void 0!=q?q.data:null;null!=m&&1===m.length&&d.element_hasClass(q.previousSibling,b)&&(c=!0)}}return c}catch(n){dalert(n)}};this.getSelectionElement_Anchor=function(a,b,c){try{if(window.attachEvent)return null;var d=g_objEditWindow[c].getSelection();if(0==d.rangeCount)return;var e=d.getRangeAt(0),f=null,g=e.startContainer;g_bBrowserType_IE&&g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&
"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase()&&(g=g_objObjectSelectionInfo.objSelectionObject);for(;g;){if(a==g.nodeName.toUpperCase()){f=g;break}g=g.parentNode}if(!f)if(g_bBrowserType_IE){if(g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase())return null;var h=e.commonAncestorContainer,k=g_objEditorDocument[c].createRange();for(c=0;c<h.childNodes.length;c++){var l=
h.childNodes[c];k.selectNode(l);var t=e.compareBoundaryPoints(Range.START_TO_START,k);if((0==t||-1==t)&&a==l.nodeName.toUpperCase()){f=l;break}}if(!f)return null}else return null;b&&(g_bBrowserType_FF?e.selectNode(f):(g_bBrowserType_IE||g_bBrowserType_WK||g_bBrowserType_OP)&&d.selectAllChildren(f));return f}catch(u){dalert(u)}finally{}return null};this.getElementTagName=function(a){try{if(window.attachEvent){if("undefined"!=typeof a.tagName)return a.tagName;if("undefined"!=typeof a.nodeName)return a.nodeName}else return a.nodeName}catch(b){dalert(b)}return null};
this.getLoopChildNodeByTagName=function(a,b){try{if(!a||!a.childNodes)return null;for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(b==this.getElementTagName(d).toLowerCase())return d;var e=this.getLoopChildNodeByTagName(d,b);if(e)return e}}}catch(f){dalert(f)}return null};this.getLoopChildNodeByTagNames=function(a,b){try{for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(inArray(this.getElementTagName(d).toLowerCase(),
b))return d;var e=this.getLoopChildNodeByTagName(d,b);if(e)return e}}}catch(f){dalert(f)}return null};this.getImmediateChildNodesByTagName=function(a,b){try{if(!a)return[];for(var c=[],d=a.childNodes.length,e=0;e<d;e++)this.checkTagName(a.childNodes[e],b)&&c.push(a.childNodes[e]);return c}catch(f){dalert(f)}};this.getParentElement=function(a){try{return!0===fnObjectCheckNull(a)?null:window.attachEvent?"undefined"!=typeof a.parentElement?a.parentElement:a.parentNode:a.parentNode}catch(b){dalert(b)}return null};
this.getCheckElementTagName=function(a){if(!a)return"";a=g_objNodeUtil.getElementTagName(a);return"undefined"==typeof a||null==a?"":a=a.toLowerCase()};this.CheckTagName=function(a,b,c){for(var d=0;d<b;d++){var e=a[d].check.toLowerCase();if("undefined"==typeof e||null==e)return null;if(e==c)return d}return-1};this.checkTagName=function(a){try{if(!a||!a.tagName)return null;for(var b=a.tagName.toLowerCase(),c=1,d=arguments.length;c<d;c++)if(b==arguments[c])return a;return null}catch(e){dalert(e)}};this.getParentElementForTargetTags=
function(a,b,c,d,e){try{if(null==a||0==c||!(a.nodeType==ID_SELECTION_TEXT_NODE||e&&this.checkTagName(a,"br"))||"undefined"==typeof b)return null;for(d=d||DZE_TAG_BODY;;){var f=g_objNodeUtil.getCheckElementTagName(a);if(!f)break;var g=g_objNodeUtil.CheckTagName(b,c,f);if(0<=g)return a;if(0>g||null===g){var h=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(h))break;a=h}else if(f==d)break}}catch(k){dalert(k)}return null};this.getLoopParentElement=function(a,b,c){try{if(!a||!b)return null;for(var d=
b.toUpperCase();a&&(!0!==c||!this.isBoundNode(a));){if(d===a.nodeName)return a;a=a.parentNode}}catch(e){dalert(e)}return null};this.getLoopParentElementByTagNames=function(a,b,c){try{if(!0===fnObjectCheckNull(a))return null;for(var d=null;!(this.isLoopBreakNode(a)||!0===c&&this.isBoundNode(a));){if(!0===inArray(this.getElementTagName(a).toLowerCase(),b))return a;d=this.getParentElement(a);if(!0===fnObjectCheckNull(d))break;a=d}return null}catch(e){dalert(e)}};this.getLoopParentNodeOn=function(a,b){try{if(!a||
!b)return null;for(var c=null;a&&!this.isLoopBreakNode(a)&&a!==b;)c=a,a=a.parentNode;return c}catch(d){dalert(d)}};this.getLoopParentByClassName=function(a,b){try{if(!0===fnObjectCheckNull(a))return null;var c=this.getParentElement(a);if(!1===fnObjectCheckNull(c))for(var d;!1===this.isLoopBreakNode(c);){d=c.classList;if(!1===fnObjectCheckNull(d)&&d.contains(b))return c;c=this.getParentElement(c)}return null}catch(e){dalert(e)}};this.getLoopBreakNode=function(a){try{if(!a)return null;for(var b=g_objNodeUtil;a&&
!b.isLoopBreakNode(a);)a=a.parentNode;return b.isLoopBreakNode(a)?a:null}catch(c){dalert(c)}};this.addOptionForSelectBox=function(a,b,c){try{var d=document.createElement("option");d.value=b;d.text=c;window.attachEvent?a.add(d):a.add(d,null)}catch(e){dalert(e)}};this.getNodeWidthHeight=function(a,b){try{var c=!1,d=null,e="",f="";f=b?a.style.width:a.style.height;if(""!=f&&null!=f){var g=g_objCommonUtil.extractNumberValueUnit(f);null!=g&&(c=!0,d=g.nValue,e=g.strUnit)}c||(f=b?a.width:a.height,""!=f&&
null!=f&&(g=g_objCommonUtil.extractNumberValueUnit(f),null!=g&&(d=g.nValue,e=g.strUnit)));d=null!=d&&""!=d?parseInt(d):null;return{styleValue:c,nValue:d,strUnit:e}}catch(h){dalert(h)}return null};this.getEventSrcElement=function(a){try{return window.attachEvent?a.srcElement:a.target}catch(b){dalert(b)}return null};this.initFalsePropagationEvent=function(a){try{a&&(window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1))}catch(b){dalert(b)}};
this.check_is_CM_INLINE=function(a){return"a"==a||"abbr"==a||"acronym"==a||"b"==a||"basefont"==a||"bdo"==a||"big"==a||"br"==a||"button"==a||"cite"==a||"code"==a||"del"==a||"dfn"==a||"em"==a||"font"==a||"i"==a||"iframe"==a||"img"==a||"input"==a||"ins"==a||"kbd"==a||"label"==a||"legend"==a||"map"==a||"param"==a||"q"==a||"rb"==a||"rbc"==a||"rp"==a||"rt"==a||"rtc"==a||"ruby"==a||"s"==a||"samp"==a||"select"==a||"small"==a||"span"==a||"strike"==a||"strong"==a||"sub"==a||"sup"==a||"textarea"==a||"tt"==a||
"u"==a||"var"==a?!0:!1};this.getAncestorNodeOnCaret=function(a){try{if(null==g_objEditWindow[a])return;var b=null;if(window.addEventListener){var c=g_objEditWindow[a].getSelection();1==c.rangeCount&&(b=c.getRangeAt(0))}else{c=g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return;b=c.createRange();if(fnObjectCheckNull(b))return}if(null==b)return null;a=null;return a="commonAncestorContainer"in b?b.commonAncestorContainer:b.parentElement().childNodes[0]}catch(d){dalert(d)}finally{}return null};
this.traverseNodesInRange=function(a,b){try{var c=a.startContainer.childNodes[a.startOffset]||a.startContainer,d=a.endContainer.childNodes[a.endOffset]||a.endContainer,e=a.commonAncestorContainer;if(c!==d||c.firstChild)for(a=c,c=null;a;){c=this.getNextNode(a,!1,d);if(!1===b(a))break;if(a===d||a===e||this.isLoopBreakNode(a))break;a=c}else b(c)}catch(f){dalert(f)}};this.getNextNode=function(a,b,c){try{return c===a||this.isLoopBreakNode(a)?null:a.firstChild&&!b?a.firstChild:a.parentNode?a.nextSibling||
this.getNextNode(a.parentNode,!0,c):null}catch(d){dalert(d)}};this.moveNodesTo=function(a,b,c){try{if(a&&b){for(var d=null;b;){d=b.nextSibling;a.appendChild(b);if(b===c)break;b=d}return a}}catch(e){dalert(e)}};this.removeAllChild=function(a){try{for(;a.firstChild;)a.removeChild(a.firstChild)}catch(b){dalert(b)}};this.splitOn=function(a,b,c){try{if(!a||!b||a===b||!a.contains(3===b.nodeType?b.parentNode:b))return null;for(var d=null,e=null,f=b.parentNode;a!=f;f=e){for(d=f.cloneNode(!1);b.nextSibling;)d.appendChild(b.nextSibling);
e=f.parentNode;e.insertBefore(d,f.nextSibling);this.onSplit(f,d);e.insertBefore(b,d);c&&c(b)}return d}catch(g){dalert(g)}};this.onSplit=function(a,b){};this.isBoundNode=function(a){try{var b=a.nodeName;if("TD"===b||"TH"===b||"DIV"===b||"CENTER"===b||"SECTION"===b||"ARTICLE"===b)return!0;var c=a.style,d=c?c.position.toLowerCase():"";return c&&("absolute"===d||"fixed"===d)&&this.isBlockNodeName(a.nodeName)||"SPAN"===b&&g_objPropertyUtil.hasClass(a,"dze_shape_text_container")||"DIV"===b&&("dze_copy_capture"===
a.id||"dze_paste_capture"===a.id)||this.isLoopBreakNode(a)?!0:!1}catch(e){dalert(e)}};this.getCloset=this.getClosest=function(a,b){try{if(!a||!b)return null;for(;a;){if(b&&!0===b(a))return a;a=a.parentNode}return null}catch(c){dalert(c)}};this.getClosetBound=this.getClosestBound=function(a,b){return this.getCloset(a,function(a){if(g_objNodeUtil.isBoundNode(a)||b&&!0===b(a))return!0})};this.getClosetParagraph=this.getClosestParagraph=function(a,b){return this.getCloset(a,function(a){if(1===a.nodeType&&
0<=g_objNodeUtil.arrParaNodeName.indexOf(a.nodeName)||b&&!0===b(a))return!0})};this.getClosestAmaranthLink=function(a){try{var b=["dze_oneffice_link_flag","dze_oneffice_slide_link_flag","dze_onechamber_link_flag","dze_amaranth_link"],c=!1,d=this,e=g_objPropertyUtil,f=this.getClosest(a,function(a){return"A"===a.nodeName&&e.hasClass(a,b)?c=!0:d.isBlockNode(a)?!0:!1});return c&&f?f:null}catch(g){dalert(g)}};this.findSplitPosition=function(a,b){try{if(!a)return null;for(var c=a.parentNode;c&&c!==b&&!this.isLoopBreakNode(c);){for(;a;){var d=
a.previousSibling;if(!d||"BR"===d.nodeName||!this.isZeroWidthNode(d))break;a=d}if(this.isCell(a))break;if(c.firstChild!==a)break;a=c;c=a.parentNode}return a}catch(e){dalert(e)}};this.insertBrIfSplitAtLast=function(a,b){try{if(!b)return null;for(var c=b.ownerDocument,d=null,e=b.parentNode,f=null;e&&e!==a&&!this.isBoundNode(e);){for(;b;){f=b.nextSibling;if(!f)break;if("BR"===f.nodeName||3===f.nodeType&&0<f.nodeValue.length)return null;if(!this.isZeroWidthNode(f))break;b=f}if(e.lastChild===b){var g=
!1;switch(e.nodeName){case "P":case "LI":case "DD":case "DT":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":g=!0}if(g){d=c.createElement("BR");e.appendChild(d);break}}b=e;e=b.parentNode}return d}catch(h){dalert(h)}};this.isZeroWidthNode=function(a){try{if(!a)return!1;var b=g_objPropertyUtil;if("COLGROUP"===a.nodeName||"SPAN"===a.nodeName&&(b.hasClass(a,"dze_page_break")||b.hasClass(a,"dze_shape_main")))return!0;if(1===a.nodeType){if(this.isInlineNode(a)&&0===a.offsetWidth){var c=a.getBoundingClientRect();
c=g_objPositionUtil.clientRectToOffsetRect(c);if(0===c.width)return!0}}else if(3===a.nodeType&&(0===a.nodeValue.length||!this.checkTagName(a.parentNode,"p","span","li")&&this.isIgnorable(a)))return!0;return!1}catch(d){dalert(d)}};this.isNodeInShape=function(a){try{for(var b=g_objNodeUtil,c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a);){if("SPAN"===a.nodeName&&c.hasClass(a,"dze_shape_main"))return!0;a=a.parentNode}return!1}catch(d){dalert(d)}};this.isNodeInQR=function(a){try{for(var b=g_objNodeUtil,
c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a);){if("DIV"===a.nodeName&&(c.hasClass(a,"oneffice_qrcode_first_container")||c.hasClass(a,"oneffice_qrcode_last_container")))return!0;a=a.parentNode}return!1}catch(d){dalert(d)}};this.canSelectNodeContents=function(a){if(1===a.nodeType)switch(a.nodeName){case "BR":case "IMG":case "VIDEO":case "SELECT":case "INPUT":return!1}return!0};this.canCaretExistOn=function(a){if(!a||!a.parentNode)return NodeFilter.FILTER_SKIP;var b=a.nodeType,c=a.nodeName,d=a.parentNode,
e=!1;if(3===b&&!g_objNodeUtil.isIgnorable(a)&&"VIDEO"!==d.nodeName)e=!0;else if(1===b)if(!g_objNodeUtil.canSelectNodeContents(a))e=!0;else if(g_bBrowserType_IE&&"P"===c&&0===a.childNodes.length&&0<a.offsetHeight)e=!0;else if(g_bBrowserType_CR&&"HR"===c)e=!0;else if("LI"===c||"DT"===c||"DD"===c)e=!0;return e?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP};this.getFirstTextNode=function(a,b){return x(!0,a,b)};this.getLastTextNode=function(a,b){return x(!1,a,b)};var x=function(a,b,c){try{if(!b)return null;
var d=b.ownerDocument;if(!d)return null;var e=this.canCaretExistOn;e.acceptNode=this.canCaretExistOn;for(var f=d.createTreeWalker(b,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,e,!1),g=a?f.firstChild():f.lastChild();g&&this.isNodeInQR(g);)g=a?f.nextNode():f.previousNode();if(!0===c&&!this.isNodeInShape(b))for(;g&&this.isNodeInShape(g);)g=a?f.nextNode():f.previousNode();return g}catch(h){dalert(h)}}.bind(this);this.getTextNodeInRange=function(a,b){try{var c=a.ownerDocument;if(!0===fnObjectCheckNull(c))return null;
3===a.nodeType&&(a=a.parentNode);var d=c.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,this.treeWalkerFilter_TextNodeInRange,!1),e=d.firstChild();a=[];c=!1;var f=g_objHeaderFooter.getHeaderFooterEditMode(),g=g_objPageNumber;do if(!1===c)e===b.start&&(c=!0);else{if(e===b.end)break;if(!1!==f||!0!==g_objHeaderFooter.contains(e))g.isDiv(e.parentNode)||a.push(e)}while(null!==(e=d.nextNode()));return a}catch(h){dalert()}};this.treeWalkerFilter_TextNodeInRange=function(a){try{if(3===a.nodeType){if(!1===
g_objNodeUtil.isIgnorable(a))return NodeFilter.FILTER_ACCEPT}else if(1===a.nodeType){if(0===g_objSelectedShapesArray.length&&g_objPropertyUtil.hasClass(a,"dze_shape_main"))return NodeFilter.FILTER_REJECT;if("BR"===a.nodeName||a.id===g_objCaretUtil.ID_CURRENT_CARET||g_bBrowserType_IE&&"P"===a.nodeName&&0===a.childNodes.length&&0<a.offsetHeight)return NodeFilter.FILTER_ACCEPT}return NodeFilter.FILTER_SKIP}catch(b){dalert()}};this.treeWalkerFilter_TextNodeInRange.acceptNode=this.treeWalkerFilter_TextNodeInRange;
this.createRangeWalker=function(a,b,c){try{if(!a)return null;var d=a.commonAncestorContainer,e=a.startContainer.childNodes[a.startOffset]||a.startContainer,f=a.endContainer.childNodes[a.endOffset-1]||a.endContainer;if(!d||!e||!f)return null;var g=this,h=function(a,b){b=g.getParents(a,b);b=b.reverse();b.push(a);a=0;for(var c=b.length;a<c;a++)b[a]=g.getChildIndex(b[a]);return b},k=c;k&&k.acceptNode&&(k=k.acceptNode);a=function(a){try{for(var b=h(e,d),c=h(f,d),g=h(a,d),l=!1,r=!1,q=0;;){var m=b[q],n=
c[q],p=g[q];q++;m=l||isNaN(m)?-1:m;n=r||isNaN(n)?Number.MAX_VALUE:n;if(isNaN(p))break;if(p<m||p>n)return NodeFilter.FILTER_REJECT;if(p>m&&p<n)break;else if(p!==m||p!==n)p===m?r=!0:p===n&&(l=!0)}return k?k(a):NodeFilter.FILTER_ACCEPT}catch(y){dalert(y)}};a.acceptNode=a;return d.ownerDocument.createTreeWalker(d,b,a,!0)}catch(l){dalert(l)}finally{a=null}};this.splitTextNodeByOffset=function(a){try{var b=a.startContainer,c=a.endContainer,d=!1,e=!1;if("body"===b.nodeName.toLowerCase()||"body"===c.nodeName.toLowerCase()){for(var f=
!1,g=!1;!1===f||!1===g;){if(!1===f&&(b=b.firstChild,b.nodeType===ID_SELECTION_TEXT_NODE)){f=!0;continue}!1===g&&(c="br"===c.tagName.toLowerCase()?c.previousSibling:c.lastChild,c.nodeType===ID_SELECTION_TEXT_NODE&&(g=!0))}a.setStart(b,0);a.setEnd(c,c.nodeValue.length)}0!==a.startOffset&&(d=!0,a.startContainer.splitText(a.startOffset));a.endOffset!==a.endContainer.length&&(e=!0,a.collapse(!1),a.endContainer.splitText(a.endOffset));!0===d&&a.setStart(b.nextSibling,0);!0===e&&(!1===d&&a.setStart(b,0),
b===c?a.setEnd(a.endContainer,a.endContainer.length):a.setEnd(c,c.nodeValue.length))}catch(h){dalert(h)}};this.getNodesOnSelection=function(a,b,c){try{if(!a||1>a.rangeCount)return[];var d=3===b?NodeFilter.SHOW_TEXT:1===b?NodeFilter.SHOW_ELEMENT:null;if(null===d)return[];var e=a.getRangeAt(0),f=this.createRangeWalker(e,d,c),g=f.firstChild();if(!g&&f.currentNode&&f.currentNode.nodeType===b&&(!c||c(f.currentNode)))return[f.currentNode];a=null;for(c=[];g;){3===g.nodeType&&3===b&&/^\s*$/.test(g.nodeValue)||
c.push(g);a=f.nextNode();if(a===g)break;g=a}return c}catch(h){dalert(h)}};this.getTextNodesIn=function(a,b,c){try{var d=[];if(a)for(var e=a.childNodes,f=0,g=e.length;f<g;f++){var h=e[f],k=h?h.nodeType:0;if(k==ID_SELECTION_TEXT_NODE)b&&!b(h,a)||d.push(h);else if(c&&this.checkTagName(h,"br"))b&&!b(h,a)||d.push(h);else if(k==ID_SELECTION_ELEMENT_NODE||k==ID_SELECTION_DOCUMENT_NODE||k==ID_SELECTION_DOCUMENT_FRAGMENT_NODE)d=d.concat(this.getTextNodesIn(h,b,c))}return d}catch(l){dalert(l)}};this.clean=
function(a){try{if(a)for(var b=function(a){var c=[];a=a.childNodes;for(var d=a.length;d--;){var e=a[d];if(e){var f=e.nodeType;3===f||8===f?c.push(e):e.firstChild&&c.push.apply(c,b(e))}}return c},c=b(a),d=g_objPropertyUtil,e=0,f=c.length;e<f;e++){var g=c[e];if(g){if(3===g.nodeType&&(a=g.parentNode)&&1===a.nodeType)if("SPAN"===a.nodeName&&d.hasClass(a,"tabSpan"))continue;else if(""!==a.style.whiteSpace)continue;this.isIgnorable(g)&&g.parentNode.removeChild(g)}}}catch(h){dalert(h)}};this.removeAllCommentNode=
function(a){try{if(a){var b=function(a){var c=[];a=a.childNodes;for(var d=a.length;d--;){var e=a[d];e&&(8===e.nodeType?c.push(e):e.firstChild&&c.push.apply(c,b(e)))}return c},c=b(a);a=0;for(var d=c.length;a<d;a++){var e=c[a];e&&this.isIgnorable(e)&&e.parentNode.removeChild(e)}}}catch(f){dalert(f)}};this.normalize=function(a){try{if(a)if(g_bBrowserType_IE){if(3===a.nodeType)for(;a.nextSibling&&3===a.nextSibling.nodeType;)a.nodeValue+=a.nextSibling.nodeValue,a.parentNode.removeChild(a.nextSibling);
else this.normalize(a.firstChild);this.normalize(a.nextSibling)}else a.normalize()}catch(b){dalert(b)}};this.isAllWhiteSpace=function(a){try{return a?!/[^\t\n\r ]/.test(a.textContent):!1}catch(b){dalert(b)}};this.isIgnorable=function(a){try{return a?8===a.nodeType||3===a.nodeType&&this.isAllWhiteSpace(a):!1}catch(b){dalert(b)}};this.isLoopBreakNode=function(a){try{if(!a)return!0;var b=this.isLoopBreakNode.arrClassName;b||(b="dze_page_main dze_page_header dze_page_footer dze_page_container dze_page_header_container dze_page_footer_container dze_document_container cloud_container dze_print_page_main dze_print_page_container".split(" "),
this.isLoopBreakNode.arrClassName=b);if(1===a.nodeType){var c=a.className;if(c&&"string"===typeof c){c=0;for(var d=b.length;c<d;c++)if(a.classList.contains(b[c]))return!0}if("BODY"===a.nodeName||"dze_copy_capture"===a.id||"dze_paste_capture"===a.id)return!0}return!1}catch(e){dalert(e)}};this.getLoopHeaderFooterBody=function(a){try{if(!0===fnObjectCheckNull(a))return null;for(var b=["dze_page_main","dze_page_header","dze_page_footer"],c=null;!1===fnObjectCheckNull(a)&&"BODY"!==a.nodeName;){c=a.classList;
if(!1===fnObjectCheckNull(c))for(var d=0;d<b.length;d++)if(!0===c.contains(b[d]))return a;a=this.getParentElement(a)}return null}catch(e){dalert(e)}};this.isInlineNode=function(a){try{return a?this.isInlineNodeName(a.nodeName):!1}catch(b){return dalert(b),!1}};this.isInlineNodeName=function(a){switch(a){case "A":case "ABBR":case "ACRONYM":case "B":case "BASEFONT":case "BDO":case "BIG":case "BR":case "BUTTON":case "CITE":case "CODE":case "DEL":case "DFN":case "EM":case "FONT":case "I":case "IFRAME":case "IMG":case "INPUT":case "INS":case "KBD":case "LABEL":case "LEGEND":case "MAP":case "PARAM":case "Q":case "RB":case "RBC":case "RP":case "RT":case "RTC":case "RUBY":case "S":case "SAMP":case "SELECT":case "SMALL":case "SPAN":case "STRIKE":case "STRONG":case "SUB":case "SUP":case "TEXTAREA":case "TT":case "Y":case "VAR":return!0}return!1};
this.getLoopParentInlineNode=function(a){try{if(this.isInlineNode(a))return a;for(var b=a.parentNode;!this.isInlineNode(b);){if(this.isBlockNode(b)||this.isLoopBreakNode(b)){b=null;break}b=b.parentNode}return b}catch(c){dalert(c)}};this.isBlockNode=function(a){try{return a?this.isBlockNodeName(a.nodeName):!1}catch(b){return dalert(b),!1}};this.isBlockNodeName=function(a){switch(a){case "ADDRESS":case "ARTICLE":case "ASIDE":case "BLOCKQUOTE":case "CANVAS":case "DD":case "DIV":case "DL":case "DT":case "FIELDSET":case "FIGCAPTION":case "FIGURE":case "FOOTER":case "FORM":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":case "HEADER":case "HR":case "LI":case "MAIN":case "NAV":case "NOSCRIPT":case "OL":case "P":case "PRE":case "SECTION":case "TABLE":case "TFOOT":case "UL":case "VIDEO":return!0}return!1};
this.getLoopParentBlockNode=function(a){try{if(this.isBlockNode(a))return a;for(var b=a.parentNode;!this.isBlockNode(b);){if(this.isLoopBreakNode(b)){b=null;break}b=b.parentNode}return b}catch(c){dalert(c)}};this.hasAllTextInlineChild=function(a){try{if(!a)return!1;for(var b=a.firstChild;b;){if(3!==b.nodeType&&!this.isInlineNode(b))return!1;b=b.nextSibling}return!0}catch(c){return dalert(c),!1}};this.isAllChild=function(a,b){try{if(!a||!b)return!1;for(var c=a.firstChild;c;){if(!b(c))return!1;c=c.nextSibling}return!0}catch(d){dalert(d)}};
this.isTextArea=function(a){var b=a&&1===a.nodeType?a.nodeName:"";return"TEXTAREA"===b||"INPUT"===b&&0<=this.arrTextInputType.indexOf(a.type)?!0:!1};this.isHead=function(a){a=a&&1===a.nodeType?a.nodeName:"";return!a||"H1"!==a&&"H2"!==a&&"H3"!==a&&"H4"!==a&&"H5"!==a&&"H6"!==a?!1:!0};this.isParagraph=function(a){return a&&1===a.nodeType&&0<=this.arrParaNodeName.indexOf(a.nodeName)?!0:!1};this.isList=function(a){return(a=a&&1===a.nodeType?a.nodeName:"")&&0<=this.arrListNodeName.indexOf(a)?!0:!1};this.isListItem=
function(a){return(a=a&&1===a.nodeType?a.nodeName:"")&&0<=this.arrListItemNodeName.indexOf(a)?!0:!1};this.isCell=function(a){return!a||1!==a.nodeType||"TD"!==a.nodeName&&"TH"!==a.nodeName?!1:!0};this.isTr=function(a){return a&&1===a.nodeType&&"TR"===a.nodeName?!0:!1};this.isPageMain=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_page_main")?!0:!1};this.isPageContainer=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,
"dze_page_container")?!0:!1};this.isDocContainer=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_document_container")?!0:!1};this.isHeaderFooter=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,["dze_page_main","dze_page_header"])?!0:!1};this.isHeaderFooterMain=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,["dze_page_main","dze_page_header","dze_page_footer"])?!0:!1};this.removeElementsBySelector=
function(a,b,c){try{if(!(a&&a.firstChild&&b&&a.ownerDocument))return!1;var d=a.querySelectorAll(b);d=[].slice.call(d);d.forEach(function(b){c&&c(b)===NodeFilter.FILTER_SKIP||this.removeElementNotChild(b,a)}.bind(this));return!0}catch(e){dalert(e)}};this.removeElementNotChild=function(a,b){try{if(!a||!a.parentNode)return!1;var c=a.ownerDocument,d=c.createDocumentFragment();if(a.parentNode===b||this.isCell(a.parentNode)){for(var e=b=null,f=a.firstChild;f;)e=f.nextSibling,3===f.nodeType||this.isInlineNode(f)?
(b=b||c.createElement("p"),b.appendChild(f)):(b&&(d.appendChild(b),b=null),d.appendChild(f)),f=e;b&&d.appendChild(b);a.parentNode.replaceChild(d,a)}else!this.isListItem(a.parentNode)||"P"!==a.nodeName&&"DIV"!==a.nodeName?!this.isList(a.parentNode)||"P"!==a.nodeName&&"DIV"!==a.nodeName?(this.moveNodesTo(d,a.firstChild),a.parentNode.replaceChild(d,a)):(this.moveNodesTo(d,a.firstChild),f=null,f="DL"===a.parentNode.nodeName?a.parentNode.firstChild===a?c.createElement("dt"):c.createElement("dd"):c.createElement("li"),
f.appendChild(d),a.parentNode.replaceChild(f,a)):(this.moveNodesTo(d,a.firstChild),a.previousSibling&&"BR"!==a.previousSibling.nodeName&&"inline"!==a.style.display&&"inline-block"!==a.style.display&&d.firstChild&&d.insertBefore(c.createElement("BR"),d.firstChild),a.parentNode.replaceChild(d,a))}catch(g){dalert(g)}};this.getChildIndex=function(a){try{for(var b=0;a=a.previousSibling;)b++;return b}catch(c){dalert(c)}};this.isBlankBound=function(a){try{return!a||1<a.childNodes.length?!1:this.isBlankPara(a.firstChild)}catch(b){dalert(b)}};
this.isBlankPara=function(a){try{if(!a||!inArray(a.nodeName,this.arrParaNodeName))return!1;if(!a.firstChild)return!0;var b=function(){return NodeFilter.FILTER_ACCEPT};b.acceptNode=b;var c=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,b,!1);if(!c)return!1;a=g_objPropertyUtil;b="";for(var d=0,e=0,f=c.firstChild();f;){e=f.nodeType;if(3===e){if(b=removeZeroWidthSpaceFromString(f.nodeValue),0<b.length)return!1}else if(1===e)if("BR"===f.nodeName){if(d++,1<d)return!1}else{if("SPAN"===
f.nodeName&&!0===a.hasClass(f,"dze_shape_main"))return!1;switch(f.nodeName){case "IMG":case "INPUT":case "BUTTON":case "IFRAME":case "TEXTAREA":return!1}if(this.isBlockNode(f))return!1}f=c.nextNode()}return!0}catch(g){dalert(g)}};this.findBr=function(a,b){try{if(!a)return null;var c=function(a){return 1!==a.nodeType||"BR"!==a.nodeName||g_objNodeUtil.isNodeInShape(a)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT};c.acceptNode=c;var d=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,c,!1);
if(!d)return null;var e=d.firstChild();if(!0===b)for(a=null;a=d.nextNode();)e=a;return e}catch(f){dalert(f)}};this.findLastBr=function(a){return this.findBr(a,!0)};this.isLastBr=function(a,b){try{if(!a)return!1;if(!b)for(var c=a;c&&!this.isLoopBreakNode(c);){if(this.isBlockNode(c)){b=c;break}c=c.parentNode}if(!b)return!1;c=a;for(a=null;c&&c!==b&&!this.isLoopBreakNode(c);){if((a=c.nextSibling)&&(3!==a.nodeType||""!==a.nodeValue))return!1;c=c.parentNode}return!0}catch(d){dalert(d)}};this.isOffsetBetweenBr=
function(a,b){try{if(!a||1!==a.nodeType)return!1;var c=a.childNodes[b-1],d=a.childNodes[b];return c&&d?"BR"!==c.nodeName||"BR"!==d.nodeName||this.isLastBr(d)?!1:!0:!1}catch(e){dalert(e)}};this.insertBr=function(a,b,c){try{if(!a||!a.parentNode)return null;for(var d=g_objPropertyUtil,e=a,f=null;e&&e.firstChild;){for(f=e.firstChild;f;)if("SPAN"===f.nodeName&&d.hasClass(f,"dze_shape_main"))f=f.nextSibling;else break;if(!f||1!==f.nodeType||!this.isInlineNode(f)||!this.canSelectNodeContents(f))break;e=
f}if(!e)return null;b||(b=a.ownerDocument.createElement("BR"));!0===c&&e.firstChild?e.insertBefore(b,e.firstChild):e.appendChild(b);this.normalize(a);return b}catch(g){dalert(g)}};this.insertBrIntoBlankPara=function(a){return a&&a.parentNode&&this.isBlankPara(a)&&!this.findBr(a)?this.insertBr(a):null};this.removeEmptyNode=function(a,b){try{var c={bDeleted:!1,offsetNode:null,offset:0};if(!b||!b.parentNode)return c;if(!a)for(a=b;a&&!this.isBlockNode(a);)a=a.parentNode;if(!a||!a.parentNode)return c;
for(var d=null;b&&!this.isBoundNode(b)&&b!==a&&!(3===b.nodeType&&0<b.nodeValue.length)&&(1!==b.nodeType||"IMG"!==b.nodeName&&"BR"!==b.nodeName&&"HR"!==b.nodeName&&"VIDEO"!==b.nodeName)&&(1!==b.nodeType||!b.firstChild||"BR"===b.firstChild.nodeName&&b.firstChild===b.lastChild||3===b.firstChild.nodeType&&0===b.firstChild.nodeValue.length&&b.firstChild===b.lastChild);)c.bDeleted=!0,c.offsetNode=b.parentNode,c.offset=this.getChildIndex(b),d=b.parentNode,d.removeChild(b),b=d;return c}catch(e){dalert(e)}};
this.getChildrenClass=function(a,b){var c=[];if(void 0!==a.children&&0!==a.children.length){for(var d=a.children.length,e=0;e<d;e++){var f=a.children[e];f.className===b&&c.push(f)}return c}};this.getInnerText=function(a,b){try{if(!a)return"";var c="",d=g_objTableOperation,e=a.lastChild;void 0===b&&(b=0);for(var f=a.firstChild,g=null;f;){g=f.nextSibling;var h="";"TABLE"===f.nodeName?h=d.tableToText(f):"OL"===f.nodeName||"UL"===f.nodeName?h=this.getInnerText(f,b+1):"LI"===f.nodeName?(h=this.getInnerText(f,
b+1))&&f!==e&&this.isBlockNode(f)&&(h+="\n"):"BR"===f.nodeName&&f!==a.lastChild?h="\n":3===f.nodeType?h=f.nodeValue:(h=f.innerText)&&f!==e&&this.isBlockNode(f)&&(h+="\n");h&&(c+=h);f=g}return c}catch(k){dalert(k)}return""};this.isDocFirstNode=function(a){try{return a?"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"oneffice_qrcode_first_container")?!0:!1:!1}catch(b){dalert(b)}};this.isDocLastNode=function(a){try{return a?"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"oneffice_qrcode_last_container")?
!0:!1:!1}catch(b){dalert(b)}};this.getDocFirstNodes=function(){try{if(!parent)return null;var a=g_objPageControl.getPageMain(0);if(!a)return null;for(var b=g_objSplitUtil,c=[],d=a.firstChild;d&&this.isDocFirstNode(d);)c.push(d),d=b.getNextSibling(d);return c}catch(e){dalert(e)}};this.getDocLastNodes=function(){try{if(!parent)return null;var a=g_objPageControl,b=a.getTotalPageCount(),c=a.getPageMain(b-1);if(!c)return null;a=g_objSplitUtil;b=[];for(var d=c.firstChild;d&&this.isDocLastNode(d);)b.push(d),
d=a.getPreviousSibling(d);return b}catch(e){dalert(e)}};this.pullDocFirstNode=function(a){try{if(!a)return null;var b=a.ownerDocument.createDocumentFragment(),c=a.querySelectorAll("div.oneffice_qrcode_first_container");forEach(c,function(a,c){b.appendChild(c)},this);return b}catch(d){dalert(d)}};this.pullDocLastNode=function(a){try{if(!a)return null;var b=a.ownerDocument.createDocumentFragment(),c=a.querySelectorAll("div.oneffice_qrcode_last_container");forEach(c,function(a,c){b.appendChild(c)},this);
return b}catch(d){dalert(d)}};this.getParents=function(a,b){try{var c=[];for(a=a.parentNode;a&&"BODY"!==a.nodeName;){c.push(a);if(b&&b===a)break;a=a.parentNode}return c}catch(d){dalert(d)}};this.isAlive=function(a){try{if(!a)return!1;for(var b=a.parentNode;b&&"BODY"!==b.nodeName;)b=b.parentNode;return b&&"BODY"===b.nodeName?!0:!1}catch(c){dalert(c)}}};

var layerEventUtil=function(){var e=this;this.arrTableHTML=this.arrTableCellHTML=this.objCurrentLayer=null;this.bRestoreUnDo=!1;layerEventUtil.prototype.showLayerWin=function(a,b,f,c){try{a.style.left="-2000px";a.style.top="-2000px";a.style.display="";var e=g_objPositionUtil,d=e.domRectToRect(b.getBoundingClientRect()),k=e.getFrameClientRect();e.moveRect(d,k.left,k.top);var g=d.bottom;if(ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT==f){var h=d.left;g_bBrowserType_FF?(h=h-g_nFireFoxLayerSetting_X+1,g=g-g_nFireFoxLayerSetting_Y+
1):g_bBrowserType_WK?(h+=2,g+=2):g_bBrowserType_OP?(h+=1,g+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(h+=2,g+=2);d.left=h-2+g_nIframeBorderSetting;d.top=g-2+g_nIframeBorderSetting}else if(ID_DROPDOWN_LAYER_POSITION_TYPE_RIGHT==f)h=d.right,g_bBrowserType_FF?(h=h-g_nFireFoxLayerSetting_X+1,g=g-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(h+=2,g+=2):g_bBrowserType_OP?(h+=1,g+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(h+=2,g+=2),d.left=h-a.offsetWidth-2+g_nIframeBorderSetting,
d.top=g-2+g_nIframeBorderSetting;else return;a.style.display="";a.style.height="";d.height=a.offsetHeight;d.bottom=d.top+d.height;d.width=a.offsetWidth;d.right=d.left+d.width;d=this.adjustMenuRect(a,d,!0);a.style.left=d.left+"px";a.style.top=d.top+"px";d.bScroll?(a.style.height=d.height+"px",a.style.overflowY="scroll"):(a.style.height="",a.style.overflowY="");a.scrollTop=0;duzon_dialog.animateDlg(a,"down");this.objCurrentLayer=a;this.bRestoreUnDo=c;detachMouseEvent();this.addLayerEvent();g_objPasteOptionMenu.remove()}catch(m){dalert(m)}};
layerEventUtil.prototype.addLayerEvent=function(){try{dzeEnvConfig.iFrameLayer&&(window.attachEvent?g_objLayerKit.getLayerDocument().attachEvent("onmousedown",this.checkdownParentLayer):g_objLayerKit.getLayerDocument().addEventListener("mousedown",this.checkdownParentLayer,!1));window.attachEvent?document.attachEvent("onmousedown",this.checkdownLayer):document.addEventListener("mousedown",this.checkdownLayer,!1);for(var a in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[a].attachEvent("onmousedown",
this.checkdownHideLayer):g_objEditorDocument[a].addEventListener("mousedown",this.checkdownHideLayer,!1)}catch(b){dalert(b)}};layerEventUtil.prototype.removeLayerEvent=function(){try{dzeEnvConfig.iFrameLayer&&(window.attachEvent?g_objLayerKit.getLayerDocument().detachEvent("onmousedown",this.checkdownParentLayer):g_objLayerKit.getLayerDocument().removeEventListener("mousedown",this.checkdownParentLayer,!1));window.detachEvent?document.detachEvent("onmousedown",this.checkdownLayer):document.removeEventListener("mousedown",
this.checkdownLayer,!1);for(var a in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[a].detachEvent("onmousedown",this.checkdownHideLayer):g_objEditorDocument[a].removeEventListener("mousedown",this.checkdownHideLayer,!1)}catch(b){dalert(b)}};layerEventUtil.prototype.checkdownParentLayer=function(a){try{if(null!=e.objCurrentLayer){TBCancelBubbleEvent_iFrameLayer(a);var b=g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(a),f=b.nPos_X,c=b.nPos_Y,l=e.objCurrentLayer.offsetWidth,
d=e.objCurrentLayer.offsetHeight;e.objCurrentLayer.offsetLeft<f&&e.objCurrentLayer.offsetTop<c&&f<e.objCurrentLayer.offsetLeft+l&&c<e.objCurrentLayer.offsetTop+d||(e.initHideDynamicLayer(),e.restoreUnDoForPreview())}}catch(k){dalert(k)}};layerEventUtil.prototype.checkdownLayer=function(a){try{if(null!=e.objCurrentLayer){TBCancelBubbleEvent(a);var b=g_objPositionUtil.GetDocumentClientPos_XY(a),f=b.nPos_X,c=b.nPos_Y,l=e.objCurrentLayer.offsetWidth,d=e.objCurrentLayer.offsetHeight;e.objCurrentLayer.offsetLeft<
f&&e.objCurrentLayer.offsetTop<c&&f<e.objCurrentLayer.offsetLeft+l&&c<e.objCurrentLayer.offsetTop+d||(e.initHideDynamicLayer(),e.restoreUnDoForPreview())}}catch(k){dalert(k)}};layerEventUtil.prototype.forceBlurInput=function(a){try{var b=document.activeElement;b&&"INPUT"===b.nodeName&&!b.hasAttribute("readonly")&&(b.cancelValue&&"function"===typeof b.cancelValue&&b.cancelValue(),b.blur())}catch(f){dalert(f)}};layerEventUtil.prototype.checkdownHideLayer=function(a){try{e.initHideDynamicLayer(),e.restoreUnDoForPreview(),
editor_onmousedown(null,-1),g_objTableFlag.ResetTableInfo(!1)}catch(b){dalert(b)}};layerEventUtil.prototype.initHideDynamicLayer=function(a){try{g_bDynamicLayer&&(g_objMenuWin.TBMenuCloseMenuState(),g_objMenuWin.initMenuLayerEvent(),g_objComboBoxWin.initComboBoxLayerEvent(),this.forceBlurInput(),g_objTableSizeBoxWin.initTableSizeLayerEvent(),a&&!1===a.initContextMenu||g_objContextMenuWin.initContextMenuLayerEvent(),g_objLetterSpacingWin.initLetterSpacingLayerEvent(),g_objLineHeightWin.initLineHeightLayerEvent(),
g_objWrapperOutlineResize.resetExtOutlineInfo(),this.initButtonState(),g_bDynamicLayer=!1,g_objContextMenuWin.isShow()&&(g_bDynamicLayer=!0),g_bForceNoSelectionChange=!1,attachMouseEvent(),duzon_menubar.closeHiddenTbContainerTool(),!0===dzeUiConfig.bUseUiMode&&(dze_menu_control.removeUiToggleBtnLayer(),dze_menu_control.removeHelpBtnLayer()),this.arrTableCellHTML=null,this.bRestoreUnDo=!1)}catch(b){dalert(b)}};layerEventUtil.prototype.initButtonState=function(){try{for(var a in g_TBDropDown)for(var b in g_TBDropDown[a])fnObjectCheckNull(g_TBDropDown[a][b].element)||
ID_STRING_NAME_CHECKED==g_TBDropDown[a][b].element.TBSTATE&&TBSetState(g_TBDropDown[a][b].element,ID_STRING_NAME_UNCHECKED,g_TBDropDown[a][b].button_type);for(a in g_TBComboBox)for(b in g_TBComboBox[a])fnObjectCheckNull(g_TBComboBox[a][b].element)||ID_STRING_NAME_CHECKED==g_TBComboBox[a][b].element.TBSTATE&&TBSetState(g_TBComboBox[a][b].element,ID_STRING_NAME_UNCHECKED,g_TBComboBox[a][b].button_type)}catch(f){dalert(f)}};layerEventUtil.prototype.canSaveTableHTML=layerEventUtil.prototype.canSaveTableSelectedCellHTML=
function(a){try{return"undefined"!==typeof g_objSelectedShapesArray&&g_objSelectedShapesArray&&0<g_objSelectedShapesArray.length?!1:GetCurTable(a)?!0:!1}catch(b){dalert(b)}};layerEventUtil.prototype.saveTableHTML=function(a){try{this.arrTableHTML=g_objTableFunction.getTableSelectedHTML(a)}catch(b){dalert(b)}};layerEventUtil.prototype.restoreTableHTML=function(a){try{g_objTableFunction.setTableSelectedHTML(a,this.arrTableHTML)}catch(b){dalert(b)}};layerEventUtil.prototype.saveTableSelectedCellHTML=
function(a,b){try{this.arrTableCellHTML=g_objTableFunction.getTableSelectedCellHTML(a,b)}catch(f){dalert(f)}};layerEventUtil.prototype.restoreTableSelectedCellHTML=function(a,b){try{g_objTableFunction.setTableSelectedCellHTML(a,this.arrTableCellHTML,b)}catch(f){dalert(f)}};layerEventUtil.prototype.getSelectedTableArray=function(){try{return this.arrTableCellHTML}catch(a){dalert(a)}};layerEventUtil.prototype.restoreUnDoForPreview=function(){try{!0===this.bRestoreUnDo&&!0===dzeUiConfig.bTBPreviewLetterOperation&&
g_objUndoRedo.operateUndoRedoStack(!0,!0,g_nActiveEditNumber)}catch(a){dalert(a)}};layerEventUtil.prototype.adjustMenuRect=function(a,b,e){try{if(a&&b){var c={left:b.left,top:b.top,width:b.width,height:b.height,right:b.right,bottom:b.bottom},f=0;a=0;g_objLayerKit.getLayerWindow().innerWidth&&(f=g_objLayerKit.getLayerWindow().innerWidth);g_objLayerKit.getLayerWindow().innerHeight&&(a=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientWidth&&(f=g_objLayerKit.getLayerDocument().documentElement.clientWidth);
g_objLayerKit.getLayerDocument().documentElement.clientHeight&&(a=g_objLayerKit.getLayerDocument().documentElement.clientHeight);var d=0,k=0;d=g_objLayerKit.getLayerDocument().documentElement.scrollLeft?g_objLayerKit.getLayerDocument().documentElement.scrollLeft:g_objLayerKit.getLayerDocument().body.scrollLeft;b=k=g_objLayerKit.getLayerDocument().documentElement.scrollTop?g_objLayerKit.getLayerDocument().documentElement.scrollTop:g_objLayerKit.getLayerDocument().body.scrollTop;k=a+k;var g=d;f+=d;
c.bottom>k&&!0!==e&&(c.top-=c.bottom-k,c.top<b&&(c.top=b));c.right>f&&!0!==e&&(c.left-=c.right-f,c.left<g&&(c.left=g));!0===e&&c.bottom>k?(c.height=Math.max(k-c.top-2,20),c.bottom=c.top+c.height,c.bScroll=!0):!0!==e&&c.height>a?(c.height=a-2,c.bottom=c.top+c.height,c.bScroll=!0):c.bScroll=!1;0>c.left&&(c.left=0);0>c.top&&(c.top=0);return c}}catch(h){dalert(h)}}},g_objLayerEventUtil=new layerEventUtil;

var transparentViewUtil=function(){this.arrTransparentView=[];transparentViewUtil.prototype.initTransparentView=function(b){try{var a=this.getTransparentView(b);if(a)return a;b=b||document;a=b.createElement("div");a.innerHTML='<div id="transparentView" style="display:none;position:absolute;z-index:20009;border:0px;background-color:#ffffff;filter:alpha(opacity=40);opacity:0.4;"></div>';a=a.firstChild;b.body.appendChild(a);return this.arrTransparentView[this.arrTransparentView.length]=a}catch(d){dalert(d)}};
transparentViewUtil.prototype.unload=function(){try{for(var b=this.arrTransparentView,a=null,d=0,c=b.length;d<c;d++)(a=b[d])&&a.parentNode&&a.parentNode.removeChild(a);this.arrTransparentView=[]}catch(e){dalert(e)}};transparentViewUtil.prototype.getTransparentView=function(b){try{b=b||document;for(var a=this.arrTransparentView,d=null,c=0,e=a.length;c<e;c++)if(d=a[c],d.ownerDocument===b)return d;return null}catch(f){dalert(f)}};transparentViewUtil.prototype.showTransparentView=function(b,a,d){try{var c=
this.initTransparentView(d);if(c)if(b){g_objPropertyUtil.applyFilterOpacityStyle(c,b,a);var e=g_objPositionUtil.getDocumentClientSize(c.ownerDocument.defaultView),f=e.nClientWidth,h=e.nClientHeight,g=g_objPositionUtil.getDocumentScrollPosition(!1),k=g.nScrollLeft,l=g.nScrollTop;c.style.left="0px";c.style.top="0px";c.style.width=k+f+"px";c.style.height=l+h+"px";c.style.display=""}else c.style.display="none"}catch(m){dalert(m)}}},g_objTransparentViewUtil=new transparentViewUtil;

var g_objTableUtil=new function(){this.ID_TABLE_ALIGN_NONE=0;this.ID_TABLE_ALIGN_LEFT=1;this.ID_TABLE_ALIGN_CENTER=2;this.ID_TABLE_ALIGN_RIGHT=3;this.RESET_WIDTH=1;this.RESET_HEIGHT=16;this.RESET_ALL=this.RESET_WIDTH|this.RESET_HEIGHT;this.getTableRowElement=function(a,b){try{var c=function(a,b){try{return a.rows(b)}catch(g){dalert(g)}return null},d=function(a,b){try{return a.rows[b]}catch(g){dalert(g)}return null};this.getTableRowElement=g_bBrowserType_IE?c:d;return this.getTableRowElement(a,b)}catch(e){dalert(e)}return null};
this.getTableCellElement=function(a,b,c){try{var d=function(a,b,c){try{return a.rows(b).cells(c)}catch(m){dalert(m)}return null},e=function(a,b,c){try{return a.rows[b].cells[c]}catch(m){dalert(m)}return null};this.getTableCellElement=g_bBrowserType_IE?d:e;return this.getTableCellElement(a,b,c)}catch(f){dalert(f)}return null};this.getTableCellsLength=function(a,b){try{var c=function(a,b){try{return a.rows(b).cells.length}catch(g){dalert(g)}return null},d=function(a,b){try{return a.rows[b].cells.length}catch(g){dalert(g)}return null};
this.getTableCellsLength=g_bBrowserType_IE?c:d;return this.getTableCellsLength(a,b)}catch(e){dalert(e)}return null};this.getClosetTable=function(a,b){try{for(;a&&a!==b.parentNode&&"BODY"!==a.nodeName;){if("TABLE"===a.nodeName)return a;a=a.parentNode}return null}catch(c){dalert(c)}};this.getFarthestTable=function(a,b){try{for(var c=null;a&&a!==b.parentNode&&"BODY"!==a.nodeName;)"TABLE"===a.nodeName&&(c=a),a=a.parentNode;return c}catch(d){dalert(d)}};this.getClosetCell=function(a,b){try{for(;a&&a!==
b.parentNode&&"BODY"!==a.nodeName;){if("TD"===a.nodeName||"TH"===a.nodeName)return a;a=a.parentNode}return null}catch(c){dalert(c)}};this.getFirstCell=function(a){try{if(!a)return null;var b=a.rows;if(!b||0>=b.length)return null;var c=b[0].cells;return!c||0>=c.length?null:c[0]}catch(d){dalert(d)}};this.getLastCell=function(a){try{if(!a)return null;var b=new TableMatrix(a,!0);return b?b.getCell(b.rowLength-1,b.colLength-1):null}catch(c){dalert(c)}};this.isCellInFirstRow=function(a){try{if(!a)return!1;
var b=g_objNodeUtil,c=b.getLoopParentElement(a,"tr"),d=b.getLoopParentElement(c,"table");if(!d)return!1;var e=d.rows;return e&&0<e.length&&e[0]===c?!0:!1}catch(f){dalert(f)}};this.isCellInLastRow=function(a){try{if(!a)return!1;var b=g_objNodeUtil,c=b.getLoopParentElement(a,"tr"),d=b.getLoopParentElement(c,"table");if(!d)return!1;var e=d.rows;if(!e)return!1;var f=e.length;return 0>=f?!1:f===c.rowIndex+this.getRowspan(a)?!0:!1}catch(g){dalert(g)}};this.cloneCell=function(a,b,c){try{if(!a||"TD"!==a.nodeName&&
"TH"!==a.nodeName)return null;"undefined"===typeof c&&(c=!1);var d=a.cloneNode(b);!1===b&&a.firstChild&&this.setCellInnerText("",d,a);c||(g_objTableSelection.deselectCell(d),d.removeAttribute("cusSelYN"),d.removeAttribute("bgcolor"),d.removeAttribute("cusBGStyleYN"),d.removeAttribute("cusOriBGColor"));if(d.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD)&&!d.hasAttribute("dze_split")){if(this.isBlankCell(d)){var e=d.getAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD);e&&(this.setCellInnerText(e,d,null),d.removeAttribute(DZE_CUSTOM_ATT_HASTEXT))}d.removeAttribute(DZE_CUSTOM_ATT_FOCUS)}if(d.hasAttribute("style")&&
!1===b){var f=parseStyle(d.getAttribute("style")),g=g_objNodeUtil.checkTagName(d.firstChild,"p");if(f&&g)for(var h in f)if("fontFamily"==h||"fontSize"==h||"color"==h||"fontWeight"==h||"lineHeight"==h||"letterSpacing"==h)g.style[h]||(g.style[h]=f[h])}return d}catch(m){dalert(m)}};this.isProtect=function(a){try{return(a=a||GetCurTable())&&a.hasAttribute&&a.hasAttribute(DZE_CUSTOM_ATT_PROTECT)&&"true"===a.getAttribute(DZE_CUSTOM_ATT_PROTECT)?!0:!1}catch(b){dalert(b)}};this.createEmptyCell=function(a,
b,c){try{var d=g_objEditorDocument[c].createElement("td");d.innerHTML="<p><br /></p>";this.setRowspan(d,a);this.setColspan(d,b);return d}catch(e){dalert(e)}};this.isBlankCell=function(a){try{if(!a)return!0;var b=a.firstChild;return b&&(b.nextSibling||"P"!==b.nodeName||b.firstChild&&!g_objNodeUtil.isBlankPara(b))?!1:!0}catch(c){dalert(c)}};this.getTableMaxColSpanCount=function(a){try{for(var b=0,c=a.rows.length,d=0;d<c;d++){for(var e=0,f=this.getTableCellsLength(a,d),g=0;g<f;g++){var h=this.getTableCellElement(a,
d,g);e+=h.colSpan}b<e&&(b=e)}return b}catch(m){dalert(m)}return 0};this.getTableRowColSpanCount=function(a,b){try{for(var c=0,d=this.getTableCellsLength(a,b),e=0;e<d;e++){var f=this.getTableCellElement(a,b,e);c+=f.colSpan}return c}catch(g){dalert(g)}return 0};this.getTableColGroupWidthValue=function(a){try{var b=[],c=a.getElementsByTagName("col");for(a=0;a<c.length;a++){var d=c[a].getAttribute("width"),e=g_objCommonUtil.extractNumberValueUnit(d);if(null==e)return null;b[a]=e}return b}catch(f){dalert(f)}return null};
this.getTableMargin=function(a){try{var b=parseInt(a.style.marginLeft),c=parseInt(a.style.marginTop),d=parseInt(a.style.marginRight),e=parseInt(a.style.marginBottom);if(isNaN(b)||ID_STRING_NAME_UNDEFINED===b)b=0;if(isNaN(c)||ID_STRING_NAME_UNDEFINED===c)c=0;if(isNaN(d)||ID_STRING_NAME_UNDEFINED===d)d=0;if(isNaN(e)||ID_STRING_NAME_UNDEFINED===e)e=0;return{left:b,top:c,right:d,bottom:e}}catch(f){dalert(f)}return null};this.getTableCellPadding=function(a){try{var b=a.cellPadding;if(null===b||""===b||
ID_STRING_NAME_UNDEFINED===b)return"";var c=g_objCommonUtil.getNumberValue(b);return null==c?"":c}catch(d){dalert(d)}return null};this.setTableCellPadding=function(a,b){try{null===b||""===b?a.removeAttribute("cellpadding"):a.cellPadding=b}catch(c){dalert(c)}};this.getTableCellSpacing=function(a){try{var b=a.cellSpacing;if(null===b||""===b||ID_STRING_NAME_UNDEFINED===b)return 0;var c=g_objCommonUtil.getNumberValue(b);return null==c?0:c}catch(d){dalert(d)}return null};this.setTableCellSpacing=function(a,
b){try{null===b||""===b?a.removeAttribute("cellspacing"):a.cellSpacing=b}catch(c){dalert(c)}};this.getTableBorderCollapse=function(a){try{if(null==a.getAttribute("style"))return!1;var b=a.style.borderCollapse;return null===b||""===b||ID_STRING_NAME_UNDEFINED===b||"collapse"!==b?!1:!0}catch(c){dalert(c)}return null};this.setTableBorderCollapse=function(a,b){try{null===b||""===b||!0!==b?a.getAttribute("style")&&a.style.borderCollapse&&(a.style.borderCollapse="separate"):a.style.borderCollapse="collapse"}catch(c){dalert(c)}};
this.setNodeValue_Width=function(a,b,c){try{if(a){b=Math.max(parseFloat(b.toFixed(2)),0);a.getAttribute("width")&&a.removeAttribute("width");var d=a.style;d&&("important"===d.getPropertyPriority("width")&&d.removeProperty("width"),a.style.width=b+c)}}catch(e){dalert(e)}};this.setNodeValue_Height=function(a,b,c){try{if(a){b=Math.max(parseFloat(b.toFixed(2)),0);a.getAttribute("height")&&a.removeAttribute("height");var d=a.style;d&&("important"===d.getPropertyPriority("height")&&d.removeProperty("height"),
a.style.height=b+c)}}catch(e){dalert(e)}};this.getColspan=function(a){try{if(!a)return 1;var b=a.getAttribute("colspan")|0;return parseInt(b?b:1)}catch(c){dalert(c)}};this.getRowspan=function(a){try{if(!a)return 1;var b=a.getAttribute("rowspan")|0;return parseInt(b?b:1)}catch(c){dalert(c)}};this.setColspan=function(a,b){try{a&&(1>=b?a.removeAttribute("colspan"):a.setAttribute("colspan",b))}catch(c){dalert(c)}};this.setRowspan=function(a,b){try{a&&(1>=b?a.removeAttribute("rowspan"):a.setAttribute("rowspan",
b))}catch(c){dalert(c)}};this.getAlignTableByStyleProperty=function(a){try{if("0px"!=a.style.marginLeft&&"0"!=a.style.marginLeft||"auto"!=a.style.marginRight){if("auto"==a.style.marginLeft&&"auto"==a.style.marginRight)return this.ID_TABLE_ALIGN_CENTER;if("auto"==a.style.marginLeft&&("0px"==a.style.marginRight||"0"==a.style.marginRight))return this.ID_TABLE_ALIGN_RIGHT}else return this.ID_TABLE_ALIGN_LEFT;var b=a.getAttribute("align");if(null==b||""==b)return this.ID_TABLE_ALIGN_NONE;b=b.toLowerCase();
return"left"==b?this.ID_TABLE_ALIGN_LEFT:"center"==b?this.ID_TABLE_ALIGN_CENTER:"right"==b?this.ID_TABLE_ALIGN_RIGHT:this.ID_TABLE_ALIGN_NONE}catch(c){dalert(c)}return this.ID_TABLE_ALIGN_NONE};this.setAlignTableByStyleProperty=function(a,b,c,d,e,f,g){try{a.removeAttribute("align"),c?(a.style.marginLeft="undefined"!==typeof d?d:"",a.style.marginRight="undefined"!==typeof f?f:""):(c="undefined"!==typeof d?d:"0",f="undefined"!==typeof f?f:"0","left"==b?(a.style.marginLeft=c,a.style.marginRight="auto"):
"center"==b?(a.style.marginLeft="auto",a.style.marginRight="auto"):"right"==b&&(a.style.marginLeft="auto",a.style.marginRight=f)),"undefined"!==typeof e&&(a.style.marginTop=e),"undefined"!==typeof g&&(a.style.marginBottom=g)}catch(h){dalert(h)}};this.getID=function(a){try{var b=a.id;return!1===fnObjectCheckNull(b)&&0<b.length?b:""}catch(c){dalert(c)}};this.setID=function(a,b){try{this.getID(a)!==b&&(a.id=b)}catch(c){dalert(c)}};this.getClass=function(a){try{var b=a.className;return!1===fnObjectCheckNull(b)&&
0<b.length?b:""}catch(c){dalert(c)}};this.setClass=function(a,b){try{this.getClass(a)!==b&&(a.className=b)}catch(c){dalert(c)}};this.setTable_Outdent_Indent=function(a,b){try{a.removeAttribute("align");var c=a.style.marginLeft,d=a.style.marginRight;c=c.toLowerCase();d=d.toLowerCase();"auto"==c&&(c=a.style.marginLeft="");"auto"==d&&(a.style.marginRight="");var e=dzeUiConfig.nCustomOutdentIndentWidth;b&&(e*=-1);""==c?a.style.marginLeft=e+"px":isNaN(c)?-1==c.indexOf("px")?a.style.marginRight="":a.style.marginLeft=
parseInt(c)+e+"px":a.style.marginLeft=parseInt(c)+e+"px"}catch(f){dalert(f)}};this.setAlignTable=function(a,b,c){try{var d="";if(!b)if(a==ID_COMMAND_JUSTIFY_LEFT)d="left";else if(a==ID_COMMAND_JUSTIFY_CENTER)d="center";else if(a==ID_COMMAND_JUSTIFY_RIGHT)d="right";else if(a==ID_COMMAND_JUSTIFY_JUSTIFY)b=!0;else return;if(window.attachEvent)for(var e=g_objEditorDocument[c].selection,f=e.createRange(),g=f.parentElement(),h=g.getElementsByTagName("table"),m=0;m<h.length;m++){var l=h[m],k=e.createRange();
k.moveToElementText(l);k.collapse(!0);var n=e.createRange();n.moveToElementText(l);n.collapse(!1);var r=f.inRange(k),t=f.inRange(n);r||t&&g_objTableUtil.setAlignTableByStyleProperty(l,d,b);r&&t&&g_objTableUtil.setAlignTableByStyleProperty(l,d,b);r&&(t||g_objTableUtil.setAlignTableByStyleProperty(l,d,b))}else if(g_objTableSelection.isTableSelected(c)){var u=GetCurTable(c);g_objTableSelection.doAllTable(function(a){this.setAlignTableByStyleProperty(a,d,b)}.bind(this),u)}else if(e=g_objEditWindow[c].getSelection(),
1==e.rangeCount){f=e.getRangeAt(0);g=f.commonAncestorContainer;var p=g_objEditorDocument[c].createRange();if(g.nodeType!=ID_SELECTION_TEXT_NODE)for(h=g.getElementsByTagName("table"),m=0;m<h.length;m++){l=h[m];p.selectNode(l);var q=f.compareBoundaryPoints(Range.END_TO_START,p),v=f.compareBoundaryPoints(Range.START_TO_START,p),w=f.compareBoundaryPoints(Range.END_TO_END,p),y=f.compareBoundaryPoints(Range.START_TO_END,p);-1!=q||1!=v&&0!=v||g_objTableUtil.setAlignTableByStyleProperty(l,d,b);0!=v&&-1!=
v||1!=w&&0!=w||g_objTableUtil.setAlignTableByStyleProperty(l,d,b);1!=y||0!=w&&-1!=w||g_objTableUtil.setAlignTableByStyleProperty(l,d,b)}}}catch(x){dalert(x)}finally{f=null}};this.setMultiToOneColgroup=function(a){try{if(!a)return!1;var b=g_objNodeUtil,c=b.getImmediateChildNodesByTagName(a,"colgroup");if(1>=c.length)return!1;var d=c[0];for(a=1;a<c.length;a++)b.moveNodesTo(d,c[a].firstChild),c[a].parentNode.removeChild(c[a]);return!0}catch(e){dalert(e)}};this.addColgroup=function(a,b){try{if(!a)return!1;
var c=g_objNodeUtil,d=g_objTableUtil,e=a.ownerDocument,f=b||g_objTableUtil.getMatrix(a),g=f.tables,h=!1,m=c.getImmediateChildNodesByTagName(a,"colgroup")[0];h|=this.setMultiToOneColgroup(a);var l=c.getImmediateChildNodesByTagName(m,"col");a=!1;for(var k=0;k<l.length;k++)if(!l[k].style.width){a=!0;break}if(!m||l.length!=f.colLength||a){var n=f.calculateColWidth();if(!n)return!1;h|=1;var r=f.arraySum(n),t=e.createDocumentFragment();for(k=0;k<f.colLength;k++){var u=e.createElement("col");u.style.width=
n[k]+"px";t.appendChild(u)}for(k=0;k<g.length;k++){var p=c.getImmediateChildNodesByTagName(g[k],"colgroup")[0];h|=this.setMultiToOneColgroup(g[k]);p||(p=e.createElement("colgroup"),g[k].firstChild?g[k].insertBefore(p,g[k].firstChild):g[k].insertBefore(p));c.removeAllChild(p);p.appendChild(t.cloneNode(!0))}d.setTableWidth(f.tables,r)}h&&b&&b.initColgroup();return h}catch(q){dalert(q)}};this.removeColgroup=function(a){try{if(a){var b=g_objNodeUtil,c=g_objTableUtil.getSplitTables(a);a=null;for(var d=
0;d<c.length;d++)(a=b.getImmediateChildNodesByTagName(c[d],"colgroup")[0])&&c[d].removeChild(a)}}catch(e){dalert(e)}};this.removeTableColGroupAll=function(a){try{if(a){a.setAttribute("cusCheckTarget","y");var b=a.getElementsByTagName("colgroup");if(null!==b&&0<b.length){for(var c,d,e=0;e<b.length;e++)if(c=g_objNodeUtil.getLoopParentElement(b[e],"table"),"y"===c.getAttribute("cusCheckTarget")){d="y";break}if(!fnObjectCheckNull(d)&&"y"===d)for(g_objTableResize.resetTableCellPixelWidth(a),e=b.length-
1;0<=e;e--)c=g_objNodeUtil.getLoopParentElement(b[e],"table"),"y"===c.getAttribute("cusCheckTarget")&&a.removeChild(b[e])}a.removeAttribute("cusCheckTarget")}}catch(f){dalert(f)}};this.getSplitTables=function(a){return[a]};this.getRows=function(a){try{return a?[].slice.call(a.rows):null}catch(b){dalert(b)}};this.getMatrix=function(a){try{return a?new TableMatrix(a):null}catch(b){dalert(b)}};this.isBizboxReportTable=function(a){try{var b=g_objNodeUtil.getAttribute(a,"tools");return b===DZE_CUSTOM_VALUE_BIZBOX_REPORT_1||
b===DZE_CUSTOM_VALUE_BIZBOX_REPORT_5?!0:!1}catch(c){dalert(c)}};this.removeBizboxReportTableAttr=function(a){try{if(a){var b=g_objNodeUtil;b.removeAttribute(a,"tools");b.removeAttribute(a,"dze_desc");b.removeAttribute(a,"dze_protect");var c=a.querySelectorAll("tr[dze_rowgroup]");forEach(c,function(a,c){b.removeAttribute(c,"dze_rowgroup")});var d=a.querySelectorAll("td[dze_placeholder_td], th[dze_placeholder_td]");forEach(d,function(a,c){b.removeAttribute(c,"dze_placeholder_td");b.removeAttribute(c,
"dze_hastext");b.removeAttribute(c,"dze_focus")})}}catch(e){dalert(e)}};this.setDzeTable=function(a,b){try{if(!a)return!1;var c=g_objPropertyUtil;if(c.hasClass(a,"dze_table"))return!1;b=b||this.getMatrix(a);var d=a.style,e=null;if("fixed"!==d.tableLayout||"break-word"!==d.wordWrap||"normal"!==d.wordBreak)e=this.getTableCellPixelSize(a,b);var f=b.tables;d=0;for(var g=f.length;d<g;d++)c.addClass(f[d],"dze_table");this.setTableCellPixelSize(a,b,e);return!0}catch(h){dalert(h)}};this.removeAllDzeTable=
function(a){try{if(a){var b=g_objPropertyUtil,c=a.querySelectorAll("table.dze_table");forEach(c,function(a,c){b.removeClass(c,"dze_table");c.style.tableLayout="fixed";c.style.wordWrap="break-word";c.style.wordBreak="normal"},this)}}catch(d){dalert(d)}};this.resetTableCellPixelSize=function(a,b,c){try{c=c||this.RESET_ALL;var d=this.getTableCellPixelSize(a,b,c);return this.setTableCellPixelSize(a,b,d,c)}catch(e){dalert(e)}};this.getTableCellPixelSize=function(a,b,c){try{if(!a)return null;c=c||this.RESET_ALL;
b=b||this.getMatrix(a);a=[];var d=[],e=0;if(c&this.RESET_WIDTH){a=b.calculateColWidth();for(var f=0,g=a.length;f<g;f++)e+=a[f]}c&this.RESET_HEIGHT&&(d=b.calculateRowHeight());return{tableWidth:e,arrColWidth:a,arrRowHeight:d}}catch(h){dalert(h)}};this.setTableCellPixelSize=function(a,b,c,d){try{if(!a||!c)return!1;var e=c.tableWidth,f=c.arrColWidth,g=c.arrRowHeight;if(!f||!g)return!1;d=d||this.RESET_ALL;b=b||this.getMatrix(a);c=g_objNodeUtil;for(var h=g_objTableUtil,m=b.tables,l=0;l<b.rowLength;l++)for(var k=
0;k<b.colLength;k++)if(b.isShow(l,k)){var n=b.getCell(l,k),r=b.getRowRange(l,k),t=b.getColRange(l,k);d&this.RESET_WIDTH&&this.setNodeValue_Width(n,h.offsetWidthToStyleWidth(b.arraySum(f,t.start,t.end),n),"px");d&this.RESET_HEIGHT&&this.setNodeValue_Height(n,h.offsetHeightToStyleHeight(b.arraySum(g,r.start,r.end),n),"px")}if(d&this.RESET_WIDTH){this.addColgroup(a,b);for(a=0;a<m.length;a++)for(var u=c.getImmediateChildNodesByTagName(m[a],"colgroup")[0],p=c.getImmediateChildNodesByTagName(u,"col"),q=
0;q<p.length;q++)this.setNodeValue_Width(p[q],f[q],"px");e&&this.setTableWidth(b.tables,e)}if(d&this.RESET_HEIGHT)for(q=0;q<b.trs.length;q++)this.setNodeValue_Height(b.trs[q],g[q],"px");return!0}catch(v){dalert(v)}};this.getCellWidthAppendant=function(a){try{if(!a)return 0;var b=g_objNodeUtil.getLoopParentElement(a,"table");if(!b)return 0;var c=g_objPropertyUtil,d=parseFloat(c.getElement_BorderWidth_With_Unit(a,"left").nValue)+parseFloat(c.getElement_BorderWidth_With_Unit(a,"right").nValue);"collapse"===
b.style.borderCollapse&&(d/=2);var e=c.getPadding(a,c.LEFT)+c.getPadding(a,c.RIGHT),f=b.cellPadding?2*parseFloat(b.cellPadding):0;return d+e+f}catch(g){dalert(g)}};this.getCellHeightAppendant=function(a){try{if(!a)return 0;var b=g_objNodeUtil.getLoopParentElement(a,"table");if(!b)return 0;var c=g_objPropertyUtil,d=parseFloat(c.getElement_BorderWidth_With_Unit(a,"top").nValue)+parseFloat(c.getElement_BorderWidth_With_Unit(a,"bottom").nValue);"collapse"===b.style.borderCollapse&&(d/=2);var e=c.getPadding(a,
c.TOP)+c.getPadding(a,c.BOTTOM),f=b.cellPadding?2*parseFloat(b.cellPadding):0;return d+e+f}catch(g){dalert(g)}};this.offsetWidthToStyleWidth=function(a,b){try{if(!a||!b)return 0;var c=a-this.getCellWidthAppendant(b);return Math.max(c,0)}catch(d){dalert(d)}};this.offsetHeightToStyleHeight=function(a,b){try{if(!a||!b)return 0;var c=a-this.getCellHeightAppendant(b);return Math.max(c,0)}catch(d){dalert(d)}};this.styleWidthToOffsetWidth=function(a,b){try{if(!a||!b)return 0;var c=a+this.getCellWidthAppendant(b);
return Math.max(c,0)}catch(d){dalert(d)}};this.styleHeightToOffsetHeight=function(a,b){try{if(!a||!b)return 0;var c=a+this.getCellHeightAppendant(b);return Math.max(c,0)}catch(d){dalert(d)}};this.setTableWidth=function(a,b){try{if(!a)return!1;var c=a;Array.isArray(a)||(c=[a]);for(var d=g_objPropertyUtil,e=0,f=c.length;e<f;e++){a=c[e];var g=a.rows,h=g&&0<g.length?g[0]:null,m=h?h.cells:null,l=m?m.length:0,k=this.isPercentTable(a),n=0;0<l&&(n=parseFloat(d.getElement_BorderWidth_With_Unit(m[0],"left").nValue)/
2+parseFloat(d.getElement_BorderWidth_With_Unit(m[l-1],"right").nValue)/2,n=Math.floor(n));this.setNodeValue_Width(a,b+n,"px");k&&this.setPercentTable(a)}}catch(r){dalert(r)}};this.getParentListArray=function(a,b){try{if(!a)return null;for(var c=g_objNodeUtil,d=null;a&&a!==b&&!c.isBoundNode(a);)null===d&&c.isListItem(a)?(d=[],d.push(a)):d&&(c.isList(a)||c.isListItem(a))&&d.push(a),a=a.parentNode;return d&&1<d.length&&!c.isList(d[d.length-1])?null:d}catch(e){dalert(e)}};this.setCellInnerText=function(a,
b,c){try{if(!b)return null;a=a||"<br>";refCell=c?c:b;var d=b.ownerDocument,e=b.querySelectorAll("span.dze_shape_main"),f=0<e.length?d.createDocumentFragment():null;forEach(e,function(a,b){b&&"absolute"===b.style.position&&f.appendChild(b)},this);var g=g_objNodeUtil.getFirstTextNode(refCell),h=TextAtt.getAtt(g),m=ParaAtt.getAtt(g);e=d=null;var l=b!==refCell||null===c?this.getParentListArray(g,refCell):null;if(l&&1<l.length){g=c=null;for(var k=0,n=l.length;k<n;k++)g=l[k].cloneNode(!1),g.removeAttribute("start"),
c?(g.appendChild(c),c=g):c=d=g;c&&d&&(d.innerHTML=a,b.innerHTML="",b.appendChild(c))}d||(b.innerHTML="<p>"+a+"</p>",d=b.firstChild,e=d.firstChild);TextAtt.setAtt(e,h);ParaAtt.setAtt(d,m);f&&f.firstChild&&(g_objPropertyUtil.addClass(d,"dze_shape_anchor"),d.firstChild?d.insertBefore(f,d.firstChild):d.appendChild(f));return b}catch(r){dalert(r)}};this.isSameTable=function(a,b){try{return a&&b?this.getSplitTables(a).some(function(a){return b==a})?!0:!1:!1}catch(c){dalert(c)}};this.isCellInSameTable=function(a,
b){try{if(!a||!b)return!1;var c=g_objNodeUtil,d=c.getLoopParentElement(a.parentNode,"table"),e=c.getLoopParentElement(b.parentNode,"table");return this.isSameTable(d,e)?!0:!1}catch(f){dalert(f)}};this.isPercentTable=function(a){return a?(a=g_objNodeUtil.getNodeWidthHeight(a,!0))&&"%"===a.strUnit?!0:!1:!1};this.setPercentTable=function(a){try{if(!a)return!1;var b=a;Array.isArray(a)||(b=[a]);if(this.isPercentTable(b[0]))return!0;for(var c=g_objCommonUtil,d=null,e=0,f=b.length;e<f;e++)(a=b[e])&&a.parentNode&&
(d=Math.floor(100*c.convPxToPercent(a,a.offsetWidth)),this.setNodeValue_Width(a,d,"%"));return!0}catch(g){dalert(g)}};this.isPxTable=function(a){return a?(a=g_objNodeUtil.getNodeWidthHeight(a,!0))&&"px"===a.strUnit||""===a.strUnit?!0:!1:!1};this.setPxTable=function(a){try{if(!a)return!1;var b=a;Array.isArray(a)||(b=[a]);if(this.isPxTable(b[0])||!this.isPercentTable(b[0]))return!0;for(var c=g_objCommonUtil,d=null,e=null,f=0,g=b.length;f<g;f++)a=b[f],e=g_objNodeUtil.getNodeWidthHeight(a,!0).nValue/
100,d=Math.floor(c.convPercentToPx(a,e)),this.setNodeValue_Width(a,d,"px");return!0}catch(h){dalert(h)}};this.removeHeightAttr=function(a){try{if(!a)return!1;var b=a;"undefined"===typeof b.length&&(b=[a]);var c=g_objNodeUtil,d=g_objPropertyUtil;forEach(b,function(a,b){c.removeAttribute(b,"height");d.removeStyleAttribute(b,"height");d.removeStyleAttribute(b,"min-height");d.removeStyleAttribute(b,"max-height")},this);return!0}catch(e){dalert(e)}};this.getTableAlign=function(a){try{if(!a)return"";var b=
a.style,c=b.marginLeft,d=b.marginRight;return 0===parseInt(c,10)&&"auto"===d?"left":"auto"===c&&0===parseInt(d,10)?"right":"auto"===c&&"auto"===d?"center":""===c&&""===d?"justify":""}catch(e){dalert(e)}};this.setCellTextAlign=function(a,b){try{a.style.textAlign="none"===b?"":b,a.removeAttribute("align"),this.setCellTextAlignForFormEditMode(a,b)}catch(c){dalert(c)}};this.setCellTextAlignForFormEditMode=function(a,b){try{if(a&&"undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length){var c=
g_objPropertyUtil;"left"===b?(c.removeClass(a,"textR"),c.removeClass(a,"textC")):"center"===b?(c.removeClass(a,"textL"),c.removeClass(a,"textR")):"right"===b&&(c.removeClass(a,"textL"),c.removeClass(a,"textC"))}}catch(d){dalert(d)}}};

function TableMatrix(a,b,d){this.matrix=null;this.table=a?a:null;this.colgroups=this.trs=this.tables=null;this.colLength=this.rowLength=0;this.arrBlankRow=this.arrBlankCol=this.arrRowHeight=this.arrColWidth=null;this.bDirty=!1;this.bOneTable=b?!0:!1;this.bDoNotFindSplitTable=!1;a&&this.makeMatrix();return this}
TableMatrix.prototype={SHOW:1,HIDE_ROWSPAN:16,HIDE_COLSPAN:256,DZE_TEMP:"dze_temp",isShow:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.SHOW)?!0:!1},isHide:function(a,b){return!this.isShow(a,b)},isHideForRowspan:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.HIDE_ROWSPAN)?!0:!1},isHideForColspan:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.HIDE_COLSPAN)?!0:!1},getHeightSumObj:function(a){var b=
a;return{getHeight:function(a){a=Math.min(b,a);b-=a;return a=Math.max(a,0)}}},getColspan:function(a){a=a.getAttribute("colspan")|0;return parseInt(a?a:1)},getRowspan:function(a){a=a.getAttribute("rowspan")|0;return parseInt(a?a:1)},setColspan:function(a,b){1>=b?a.removeAttribute("colspan"):a.setAttribute("colspan",b)},setRowspan:function(a,b){1>=b?a.removeAttribute("rowspan"):a.setAttribute("rowspan",b)},arraySum:function(a,b,d){d="undefined"==typeof d?a.length-1:d;var c=0;for(b="undefined"==typeof b?
0:b;b<=d;b++)c+=a[b];return c},arrayCloset:function(a,b){for(var d=Number.MAX_VALUE,c=0,e=0;e<a.length;e++){var f=Math.abs(b-a[e]);f<d&&(c=e,d=f)}return a[c]},arrayUnion:function(a,b){a=a.concat();for(var d=0;d<b.length;d++)0>a.indexOf(b[d])&&a.push(b[d]);return a},arrayWidthToPos:function(a,b){b[0]=0;for(var d=1;d<=a.length;d++)b[d]=b[d-1]+a[d-1];return b},arrayPosToWidth:function(a,b){for(var d=0;d<a.length-1;d++)b[d]=a[d+1]-a[d];return b},arrayFillNullWithMedian:function(a){try{if(a){for(var b=
1,d=a.length;b<d;b++)if(null===a[b]){for(var c=b-1;0<=c&&null===a[c];c--);for(var e=b+1;e<d&&null===a[e];e++);0>c&&(c=0);e>=d&&(e=d-1);var f=a[c],h=a[e];e-=c;h<f&&(h=f);var g=this.getIntegerDivision(h-f,e);for(e=0;e<g.length-1;e++)a[e+c+1]=a[e+c]+g[e]}return a}}catch(k){dalert(k)}},getGCD:function(a,b){return b?this.getGCD(b,a%b):a},getIntegerDivision:function(a,b){var d=Math.floor(a/b);a%=b;for(var c=[],e=0;e<b;e++)c[e]=d;for(e=b-1;0<e&&0<a;e--)c[e]+=1,a--;return c},getCellIndex:function(a,b){try{if(0>
a||a>=this.rowLength||0>b||b>=this.colLength)return null;var d=0,c=0;for(d=a;this.isHideForRowspan(d,b);d--);for(a=0;c<=b;c++)this.isHide(d,c)&&a++;return{row:d,col:c-a-1}}catch(e){dalert(e)}},getCell:function(a,b){try{var d=this.getCellIndex(a,b);return d?this.trs[d.row].cells[d.col]:null}catch(c){dalert(c)}},getNextCell:function(a,b){try{for(b+=1;a<this.rowLength;a++){for(;b<this.colLength;b++)if(this.isShow(a,b))return this.getCell(a,b);b=0}return null}catch(d){dalert(d)}},getPrevCell:function(a,
b){try{for(--b;0<=a;a--){for(;0<=b;b--)if(this.isShow(a,b))return this.getCell(a,b);b=this.colLength}return null}catch(d){dalert(d)}},getNextCellFromCell:function(a){try{var b=this.getMatrixIndex(a);return b&&b[0]?this.getNextCell(b[0].row,b[0].col):null}catch(d){dalert(d)}},getPrevCellFromCell:function(a){try{var b=this.getMatrixIndex(a);return b&&b[0]?this.getPrevCell(b[0].row,b[0].col):null}catch(d){dalert(d)}},getMatrixIndex:function(a){try{if(!a)return null;var b=this.trs.indexOf(a.parentNode);
if(0>b)return null;var d=a.cellIndex,c=0;for(a=0;a<=d&&c<this.colLength;a++,c++)this.isHide(b,c)&&a--;--c;var e=this.getColRange(b,c),f=this.getRowRange(b,c);b=[];for(var h=f.start;h<=f.end;h++)for(a=e.start;a<=e.end;a++)b.push({row:h,col:a});return b}catch(g){dalert(g)}},getRowRange:function(a,b){try{for(var d=0,c=0;this.isHideForColspan(a,b);b--);for(;this.isHideForRowspan(a,b);a--);d=a;for(a+=1;this.isHideForRowspan(a,b);a++);c=a-1;return{start:d,end:c,length:c-d+1}}catch(e){dalert(e)}},getColRange:function(a,
b){try{for(var d=0,c=0;this.isHideForColspan(a,b);b--);for(;this.isHideForRowspan(a,b);a--);d=b;for(b+=1;this.isHideForColspan(a,b);b++);c=b-1;return{start:d,end:c,length:c-d+1}}catch(e){dalert(e)}},getRowRangeFromCell:function(a){try{var b=this.getMatrixIndex(a);return b?this.getRowRange(b[0].row,b[0].col):null}catch(d){dalert(d)}},getColRangeFromCell:function(a){try{var b=this.getMatrixIndex(a);return b?this.getColRange(b[0].row,b[0].col):null}catch(d){dalert(d)}},insertCell:function(a,b,d){try{if(!a)return!1;
for(var c=d;c<this.colLength&&!this.isShow(b,c);c++);var e=this.getCell(b,c);e?this.trs[b].insertBefore(a,e):this.trs[b].appendChild(a);if(a&&("TD"===a.nodeName||"TH"===a.nodeName)){var f=this.getColspan(a),h=this.getRowspan(a);for(a=b;a<b+h;a++)for(c=d;c<d+f;c++)"undefined"!=typeof this.matrix[a][c]&&(a==b&&c==d?this.matrix[a][c]=this.SHOW:(this.matrix[a][c]=0,c>d&&(this.matrix[a][c]|=this.HIDE_COLSPAN),a>b&&(this.matrix[a][c]|=this.HIDE_ROWSPAN)))}return!0}catch(g){dalert(g)}},equalCell:function(a,
b,d,c){try{if(a==d&&b==c)return!0;var e=this.getCellIndex(a,b),f=this.getCellIndex(d,c);return e.row==f.row&&e.col==f.col?!0:!1}catch(h){dalert(h)}},createBlankCell:function(a,b){try{var d=this.table.ownerDocument.createElement("td");d.innerHTML="<p><br /></p>";d.style.width="0px";this.setRowspan(d,a);this.setColspan(d,b);return d}catch(c){dalert(c)}},clone:function(){try{var a=new TableMatrix(null);a.bClone=!0;a.table=this.table.cloneNode(!0);a.tables||(a.tables=[]);for(var b=0;b<this.tables.length;b++)a.tables[b]=
this.tables[b]==this.table?a.table:this.tables[b].cloneNode(!0);a.initTrs();a.initColgroup();a.rowLength=this.rowLength;a.colLength=this.colLength;a.arrColWidth=this.arrColWidth?this.arrColWidth.slice(0):this.calculateColWidth();a.arrRowHeight=this.arrRowHeight?this.arrRowHeight.slice(0):this.calculateRowHeight();a.bDirty=this.bDirty;a.matrix=this.matrix?this.matrix.slice(0):null;return a}catch(d){dalert(d)}},setTable:function(a){try{if(!a)return this;this.table=a;this.makeMatrix();return this}catch(b){dalert(b)}},
setTableArray:function(a,b){try{if(!a||0==a.length)return this;this.table=b||a[0];this.tables=a;this.bOneTable=1==a.length?!0:!1;this.bDoNotFindSplitTable=!0;this.makeMatrix();return this}catch(d){dalert(d)}},init:function(){try{this.bClone?(this.initTrs(),this.initColgroup(),this.bDirty=!1):(this.initTables(),this.initTrs(),this.initColgroup(),this.bDirty=!1,this.clearCache())}catch(a){dalert(a)}},initTables:function(){try{var a=null,b=null;a=this.bOneTable?[this.table]:this.bDoNotFindSplitTable&&
this.tables.length?this.tables:g_objTableUtil.getSplitTables(this.table);for(var d=0,c=a.length;d<c;d++)for(;b=a[d].rows[0];)if(0===b.cells.length)b.parentNode.removeChild(b);else break;this.tables=a}catch(e){dalert(e)}},initTrs:function(){try{if(!this.trs||0<this.trs.length)this.trs=[];for(var a=0,b=this.tables.length;a<b;a++){var d=[].slice.call(this.tables[a].rows);this.trs=this.trs.concat(d)}}catch(c){dalert(c)}},initColgroup:function(){try{if(!this.colgroups||0<this.colgroups.length)this.colgroups=
[];for(var a=0,b=this.tables.length;a<b;a++){var d=g_objNodeUtil.getImmediateChildNodesByTagName(this.tables[a],"colgroup");this.colgroups=this.colgroups.concat(d)}}catch(c){dalert(c)}},clearCache:function(){try{this.arrBlankRow=this.arrBlankCol=this.arrRowHeight=this.arrColWidth=null}catch(a){dalert(a)}},makeMatrix:function(){try{this.init();this.matrix=[];var a=this.trs,b=null,d=null,c=null,e=0,f=0,h=0,g=0,k=a.length,l=0;for(f=0;f<k;f++)for(d=a[f],b=d.cells,l=b.length,h=e=0;e<l;e++){c=b[e];for(var n=
this.getColspan(c),p=this.getRowspan(c);this.matrix[f]&&this.matrix[f][h];h++);for(var m=h;m<h+n;m++)for(var q=f;q<f+p;q++)this.matrix[q]||(this.matrix[q]=[]),q==f&&m==h?this.matrix[q][m]=this.SHOW:(this.matrix[q][m]=0,m>h&&(this.matrix[q][m]|=this.HIDE_COLSPAN),q>f&&(this.matrix[q][m]|=this.HIDE_ROWSPAN))}this.rowLength=this.matrix.length;this.colLength=0<this.rowLength?this.matrix[0].length:0;if(this.matrix.length>k){for(g=this.matrix.length-1;g>=k;g--)for(h=this.matrix[g].length-1;0<=h;h=this.getColRange(g,
h).start-1)if(this.matrix[g][h]&&this.isHideForRowspan(g,h)){var r=this.getCell(g,h);r&&this.setRowspan(r,this.getRowspan(r)-1)}this.matrix.splice(k);this.rowLength=k}}catch(u){dalert(u)}},calculateColWidth:function(){try{if(this.arrColWidth&&this.arrColWidth.length==this.colLength)return this.arrColWidth.slice(0);for(var a=[],b=0;b<this.colLength;b++)a[b]=null;var d=a.length;for(b=0;b<this.rowLength&&0<d;b++)for(var c=0,e=0;e<this.colLength;e++)if(!this.isHideForColspan(b,e))if(e=this.getColRange(b,
e).end,null===a[e]){var f=this.getCell(b,e);c+=f.offsetWidth;a[e]=c;d--}else c=a[e];a.splice(0,0,0);if(a.every(function(a){return 0===a||null===a}))return null;this.arrayFillNullWithMedian(a);this.arrColWidth=this.arrayPosToWidth(a,[]);return this.arrColWidth.slice(0)}catch(h){dalert(h)}},calculateRowHeight:function(){try{if(this.arrRowHeight&&this.arrRowHeight.length==this.rowLength)return this.arrRowHeight.slice(0);for(var a=[],b=0;b<this.rowLength;b++)a[b]=null;for(var d=a.length,c=0;c<this.colLength&&
0<d;c++){var e=0;for(b=0;b<this.rowLength;b++)if(!this.isHideForRowspan(b,c))if(b=this.getRowRange(b,c).end,null===a[b]){var f=this.getCell(b,c);e+=f.offsetHeight;a[b]=e;d--}else e=a[b]}a.splice(0,0,0);if(a.every(function(a){return 0===a||null===a}))return null;b=1;for(var h=a.length;b<h;b++)null===a[b]&&(a[b]=a[b-1]+this.trs[b-1].offsetHeight);this.arrRowHeight=this.arrayPosToWidth(a,[]);return this.arrRowHeight.slice(0)}catch(g){dalert(g)}},splitRow:function(a,b){try{if("undefined"==typeof a||0>
a||a>=this.rowLength)return!1;b=b?!0:!1;for(var d=this.calculateRowHeight(),c=g_objTableUtil,e=g_objPropertyUtil,f=this.colLength-1;0<=f;f--)if(this.isHideForRowspan(a,f)){var h=this.getCell(a,f),g=h.cloneNode(b),k=this.getRowRange(a,f),l=this.getColRange(a,f);this.setRowspan(h,a-k.start);this.setRowspan(g,k.end-a+1);var n=e.getStyleHeight(h);n=this.getHeightSumObj(n);var p=c.offsetHeightToStyleHeight(this.arraySum(d,k.start,a-1),h);c.setNodeValue_Height(h,n.getHeight(p),"px");p=c.offsetHeightToStyleHeight(this.arraySum(d,
a,k.end),h);c.setNodeValue_Height(g,n.getHeight(p),"px");this.insertCell(g,a,f);f=l.start;this.bDirty=!0}this.bDirty&&this.makeMatrix();return!0}catch(m){dalert(m)}},splitCol:function(a,b){try{if("undefined"==typeof a||0>a||a>=this.colLength)return!1;b=b?!0:!1;for(var d=this.calculateColWidth(),c=g_objTableUtil,e=g_objPropertyUtil,f=this.rowLength-1;0<=f;f--)if(this.isHideForColspan(f,a)){var h=this.getCell(f,a),g=h.cloneNode(b),k=this.getRowRange(f,a),l=this.getColRange(f,a);this.setColspan(h,a-
l.start);this.setColspan(g,l.end-a+1);if(10<e.getStyleWidth(h)){var n=c.offsetWidthToStyleWidth(this.arraySum(d,l.start,a-1),h);c.setNodeValue_Width(h,n,"px");n=c.offsetWidthToStyleWidth(this.arraySum(d,a,l.end),h);c.setNodeValue_Width(g,n,"px")}insertAfter(h,g);f=k.start;this.bDirty=!0}this.bDirty&&this.makeMatrix();return!0}catch(p){dalert(p)}},removeRow:function(a,b,d){try{if(isNaN(a))return null;isNaN(b)&&(b=a);if(a>b||0>a||a>=this.rowLength||0>b||b>=this.rowLength)return null;var c=this.table.ownerDocument;
if(!c)return null;for(var e=g_objNodeUtil,f=g_objTableUtil,h=g_objPropertyUtil,g=!1,k=this.colLength-1;0<=k;k--){var l=this.getRowRange(a,k);l.start<a&&l.end>b&&e.setAttribute(this.getCell(a,k),this.DZE_TEMP,"")}this.splitRow(a,!1);this.splitRow(b+1,!0);var n=d&&!1===d.returnFragment?null:c.createDocumentFragment();c=d=null;l=[];for(var p=b;p>=a;p--)(c=(d=this.trs[p])?d.parentNode:null)&&("TBODY"===c.nodeName||"THEAD"===c.nodeName)&&0>l.indexOf(c)&&l.push(c),n?n.firstChild?n.insertBefore(d,n.firstChild):
n.appendChild(d):d.parentNode.removeChild(d);for(var m=l.length-1;0<=m;m--)(c=l[m])&&c.parentNode&&!c.firstChild&&c.parentNode.removeChild(c);for(m=this.tables.length-1;0<=m;m--)0==this.tables[m].rows.length&&(this.tables[m].parentNode&&this.tables[m].parentNode.removeChild(this.tables[m]),this.table==this.tables[m]&&(0<=m-1?this.table=this.tables[m-1]:m+1<this.tables.length&&(this.table=this.tables[m+1])),this.tables.splice(m,1));this.makeMatrix();for(k=this.colLength-1;0<=k;k--){var q=this.getCell(a-
1,k),r=this.getCell(a,k);q=e.hasAttribute(q,this.DZE_TEMP)?q:null;r=e.hasAttribute(r,this.DZE_TEMP)?r:null;e.removeAttribute(q,this.DZE_TEMP);e.removeAttribute(r,this.DZE_TEMP);if(q&&r){if(10<h.getStyleHeight(q)){var u=f.offsetHeightToStyleHeight(q.offsetHeight+r.offsetHeight,q);f.setNodeValue_Height(q,u,"px")}this.setRowspan(q,this.getRowspan(q)+this.getRowspan(r));r.parentNode.removeChild(r);g=!0}}g&&this.makeMatrix();this.arrRowHeight&&0<this.arrRowHeight.length&&this.arrRowHeight.splice(a,b-a+
1);return n&&n.firstChild?n:null}catch(t){dalert(t)}},removeCol:function(a,b,d){try{if(isNaN(a))return null;isNaN(b)&&(b=a);if(a>b||0>a||a>=this.colLength||0>b||b>=this.colLength)return null;var c=g_objNodeUtil,e=g_objTableUtil,f=this.table.ownerDocument;if(!f)return null;for(var h=this.calculateColWidth(),g=this.rowLength-1;0<=g;g--){var k=this.getColRange(g,a);k.start<a&&k.end>b&&c.setAttribute(this.getCell(g,a),this.DZE_TEMP,"")}this.splitCol(a,!1);this.splitCol(b+1,!0);var l=[];for(g=0;g<this.rowLength;g++)for(var n=
a;n<=b;n++)l[g]||(l[g]=[]),l[g][n]=!1;var p=d&&!1===d.returnFragment?null:f.createDocumentFragment();for(g=this.rowLength-1;0<=g;g--){var m=this.trs[g].cloneNode(!1);for(n=b;n>=a;n--)if(!l[g][n]){var q=this.getRowRange(g,n);k=this.getColRange(g,n);if(!(q.start<g)){for(var r=q.start;r<=q.end;r++)for(var u=k.start;u<=k.end;u++)l[r]&&!1===l[r][u]&&(l[r][u]=!0);m.insertBefore(this.getCell(g,n),m.firstChild)}}p&&(p.firstChild?p.insertBefore(m,p.firstChild):p.appendChild(m))}this.makeMatrix();for(g=this.rowLength-
1;0<=g;g--){var t=this.getCell(g,a-1),v=this.getCell(g,a);t=c.hasAttribute(t,this.DZE_TEMP)?t:null;v=c.hasAttribute(v,this.DZE_TEMP)?v:null;c.removeAttribute(t,this.DZE_TEMP);c.removeAttribute(v,this.DZE_TEMP);if(t&&v){var y=e.offsetWidthToStyleWidth(t.offsetWidth+v.offsetWidth,t);e.setNodeValue_Width(t,y,"px");this.setColspan(t,this.getColspan(t)+this.getColspan(v));v.parentNode.removeChild(v)}}d=0;for(var x=this.colgroups.length;d<x;d++){var w=c.getImmediateChildNodesByTagName(this.colgroups[d],
"col");for(f=b;f>=a;f--)w[f]&&w[f].parentNode&&w[f].parentNode.removeChild(w[f])}h.splice(a,b-a+1);e.setTableWidth(this.tables,this.arraySum(h));this.makeMatrix();this.arrColWidth&&0<this.arrColWidth.length&&this.arrColWidth.splice(a,b-a+1);return p&&p.firstChild?p:null}catch(z){dalert(z)}},cloneRow:function(a,b,d){try{if(a>b||0>a||a>=this.rowLength||0>b||b>=this.rowLength)return null;var c=this.table.ownerDocument;if(!c)return null;d=d?!0:!1;for(var e=g_objTableUtil,f=g_objPropertyUtil,h=null,g=
[],k=a;k<=b;k++)for(var l=0;l<this.colLength;l++)g[k]||(g[k]=[]),g[k][l]=!1;var n=c.createDocumentFragment();for(k=a;k<=b;k++){var p=this.trs[k].cloneNode(!1);for(l=0;l<this.colLength;l++)if(!g[k][l]){for(var m=this.getRowRange(k,l),q=this.getColRange(k,l),r=m.start;r<=m.end;r++)for(var u=q.start;u<=q.end;u++)g[r]&&!1===g[r][u]&&(g[r][u]=!0);var t=this.getCell(k,l),v=e.cloneCell(t,d),y=Math.max(a,m.start),x=Math.min(b,m.end),w=this.getRowspan(t);c=x-y+1;if(w!=c&&(this.setRowspan(v,c),10<f.getStyleHeight(t))){h=
h||this.calculateRowHeight();var z=this.arraySum(h,y,x);e.setNodeValue_Height(v,e.offsetHeightToStyleHeight(z,t),"px")}p.appendChild(v)}n.appendChild(p)}return n}catch(A){dalert(A)}},cloneCol:function(a,b,d){try{if(a>b||0>a||a>=this.colLength||0>b||b>=this.colLength)return null;var c=this.table.ownerDocument;if(!c)return null;d=d?!0:!1;for(var e=g_objTableUtil,f=null,h=[],g=0;g<this.rowLength;g++)for(var k=a;k<=b;k++)h[g]||(h[g]=[]),h[g][k]=!1;var l=c.createDocumentFragment();for(g=0;g<this.rowLength;g++){var n=
this.trs[g].cloneNode(!1);for(k=a;k<=b;k++)if(!h[g][k]){for(var p=this.getRowRange(g,k),m=this.getColRange(g,k),q=p.start;q<=p.end;q++)for(var r=m.start;r<=m.end;r++)h[q]&&!1===h[q][r]&&(h[q][r]=!0);var u=this.getCell(g,k),t=e.cloneCell(u,d),v=Math.max(a,m.start),y=Math.min(b,m.end),x=this.getColspan(u);c=y-v+1;if(c!=x){this.setColspan(t,c);f=f||this.calculateColWidth();var w=this.arraySum(f,v,y);e.setNodeValue_Width(t,e.offsetWidthToStyleWidth(w,u),"px")}n.appendChild(t)}l.appendChild(n)}return l}catch(z){dalert(z)}},
divideCellCol:function(a,b){try{if(!a||1>b)return!1;if(1==b||this.divideCellCol_NotAddCol(a,b))return!0;var d=this.table.ownerDocument;if(!d)return!1;var c=g_objTableUtil,e=this.getDividePosition(a,b,!0);if(!e)return!1;var f=this.getDivideRowCol(e);if(!f)return!1;for(var h=this.getMatrixIndex(a),g=this.getColRange(h[0].row,h[0].col),k=f.length-1;0<=k;k--)1<f[k].span&&this.divideCol(g.start+k,f[k].span,f[k].arrSize);f=this.getDivideCell(e);if(!f)return!1;h=this.getMatrixIndex(a);this.getColRange(h[0].row,
h[0].col);var l=d.createDocumentFragment();for(k=0;k<b;k++)d=a,0<k&&(d=c.cloneCell(a,!1,!0),l.appendChild(d)),this.setColspan(d,f[k].span),c.setNodeValue_Width(d,c.offsetWidthToStyleWidth(f[k].size,a),"px");var n=a.parentNode,p=a.nextSibling;p?n.insertBefore(l,p):n.appendChild(l);this.makeMatrix();this.arrColWidth=null;return!0}catch(m){dalert(m)}},divideCellRow:function(a,b){try{if(!a||1>b)return!1;if(1==b||this.divideCellRow_NotAddRow(a,b))return!0;if(!this.table.ownerDocument)return!1;var d=g_objTableUtil,
c=this.getDividePosition(a,b,!1);if(!c)return!1;var e=this.getDivideRowCol(c);if(!e)return!1;for(var f=this.getMatrixIndex(a),h=this.getRowRange(f[0].row,f[0].col),g=e.length-1;0<=g;g--)1<e[g].span&&this.divideRow(h.start+g,e[g].span,e[g].arrSize);e=this.getDivideCell(c);if(!e)return!1;f=this.getMatrixIndex(a);h=this.getRowRange(f[0].row,f[0].col);var k=h.end+1;for(g=e.length-1;0<=g;g--)b=a,0<g&&(b=d.cloneCell(a,!1,!0)),this.setRowspan(b,e[g].span),d.setNodeValue_Height(b,d.offsetHeightToStyleHeight(e[g].size,
a),"px"),0<g&&(k-=e[g].span,this.insertCell(b,k,f[0].col));this.makeMatrix();this.arrRowHeight=null;return!0}catch(l){dalert(l)}},getDividePosition:function(a,b,d){try{var c=this.getMatrixIndex(a);if(!c)return null;var e=null,f=null;a=0;d?(e=this.getColRange(c[0].row,c[0].col),f=this.arrColWidth=this.arrColWidth||this.calculateColWidth(),a=10):(e=this.getRowRange(c[0].row,c[0].col),f=this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight(),a=25);if(!f)return null;d=[];c=[];var h=[],g=f.slice(e.start,
e.end+1);this.arrayWidthToPos(g,d);var k=this.getIntegerDivision(this.arraySum(g),b);this.arrayWidthToPos(k,c);c[0]=0;c[b]=d[d.length-1];for(b=1;b<c.length-1;b++){var l=this.arrayCloset(d,c[b]),n=Math.abs(c[b]-l);0!=n&&n<a&&0>c.indexOf(l)&&l<c[b+1]&&(c[b]=l)}h=this.arrayUnion(d,c);h.sort(function(a,b){return a-b});return{arrCurPos:d,arrPos:c,arrNewPos:h}}catch(p){dalert(p)}},getDivideRowCol:function(a){try{if(!a)return null;var b=a.arrCurPos,d=a.arrNewPos;if(!b||!d)return null;a=[];for(var c=0,e=
0,f=1;f<b.length;f++){e=d.indexOf(b[f],c+1);var h=[];this.arrayPosToWidth(d.slice(c,e+1),h);a.push({span:e-c,arrSize:h});c=e}return a}catch(g){dalert(g)}},getDivideCell:function(a){try{if(!a)return null;var b=a.arrPos,d=a.arrNewPos;if(!b||!d)return null;a=[];for(var c=0,e=0,f=1;f<b.length;f++)e=d.indexOf(b[f],c+1),a.push({span:e-c,size:d[e]-d[c]}),c=e;return a}catch(h){dalert(h)}},divideCellCol_NotAddCol:function(a,b){try{if(!a||isNaN(b)||1>b)return!1;if(1==b)return!0;var d=this.table.ownerDocument;
if(!d)return!1;var c=this.getColspan(a),e=this.getGCD(c,b);if(c<b||e!=b)return!1;var f=g_objTableUtil,h=this.getMatrixIndex(a),g=this.getColRange(h[0].row,h[0].col);this.arrColWidth=this.arrColWidth||this.calculateColWidth();var k=this.arrColWidth.slice(g.start,g.end+1),l=parseInt(c/e),n=d.createDocumentFragment();for(d=0;d<b;d++){c=a;0<d&&(c=f.cloneCell(a,!1,!0),n.appendChild(c));this.setColspan(c,l);var p=this.arraySum(k,l*d,l*d+l-1);f.setNodeValue_Width(c,f.offsetWidthToStyleWidth(p,a),"px")}var m=
a.parentNode,q=a.nextSibling;q?m.insertBefore(n,q):m.appendChild(n);this.makeMatrix();return!0}catch(r){dalert(r)}},divideCellRow_NotAddRow:function(a,b){try{if(!a||isNaN(b)||1>b)return!1;if(1==b)return!0;if(!this.table.ownerDocument)return!1;var d=this.getRowspan(a),c=this.getGCD(d,b);if(d<b||c!=b)return!1;var e=g_objTableUtil,f=this.getMatrixIndex(a),h=f[0].row,g=f[0].col,k=this.getRowRange(h,g);this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight();var l=this.arrRowHeight.slice(k.start,
k.end+1),n=parseInt(d/c);for(--b;0<=b;b--){d=a;0<b&&(d=e.cloneCell(a,!1,!0));this.setRowspan(d,n);var p=this.arraySum(l,n*b,n*b+n-1);e.setNodeValue_Height(d,e.offsetWidthToStyleWidth(p,a),"px");0<b&&this.insertCell(d,h+b*n,g)}this.makeMatrix();return!0}catch(m){dalert(m)}},divideCol:function(a,b,d){try{if(isNaN(a)||isNaN(b))return!1;if(1==b)return!0;var c=this.table.ownerDocument;if(!c)return!1;var e=g_objNodeUtil,f=g_objTableUtil;this.arrColWidth=this.arrColWidth||this.calculateColWidth();if(!d){var h=
this.arrColWidth[a];d=[];for(var g=0;g<b;g++)d.push(+(h/b).toFixed(2))}for(var k=this.rowLength-1;0<=k;k=this.getRowRange(k,a).start-1){var l=this.getCell(k,a);l&&this.setColspan(l,this.getColspan(l)+b-1)}var n=c.createDocumentFragment();g=0;for(var p=this.colgroups.length;g<p;g++){var m=e.getImmediateChildNodesByTagName(this.colgroups[g],"col")[a];for(c=0;c<b;c++)h=m,0<c&&(h=m.cloneNode(),n.appendChild(h)),f.setNodeValue_Width(h,d[c],"px");var q=m.parentNode,r=m.nextSibling;r?q.insertBefore(n,r):
q.appendChild(n)}this.makeMatrix();return!0}catch(u){dalert(u)}},divideRow:function(a,b,d){try{if(isNaN(a)||isNaN(b)||0>a||a>=this.rowLength)return!1;if(1==b)return!0;var c=this.table.ownerDocument;if(!c)return!1;var e=g_objPropertyUtil,f=g_objTableUtil;if(!d){this.calculateRowHeight();var h=this.arrRowHeight[a];d=[];for(var g=0;g<b;g++)d.push(+(h/b).toFixed(2))}for(var k=this.colLength-1;0<=k;k=this.getColRange(a,k).start-1){var l=this.getCell(a,k);l&&this.setRowspan(l,this.getRowspan(l)+b-1)}var n=
c.createDocumentFragment(),p=this.trs[a],m=e.getStyleHeight(p);m=this.getHeightSumObj(m);for(g=0;g<b;g++)a=p,0<g&&(a=p.cloneNode(),n.appendChild(a)),f.setNodeValue_Height(a,m.getHeight(d[g]),"px");var q=p.parentNode,r=p.nextSibling;r?q.insertBefore(n,r):q.appendChild(n);this.makeMatrix();return!0}catch(u){dalert(u)}},divideTable:function(a){try{if(0>=a||a>=this.rowLength)return null;var b=g_objNodeUtil;this.splitRow(a);var d=this.trs[a-1],c=this.trs[a],e=c.ownerDocument,f=d.parentNode,h=c.parentNode,
g=b.getLoopParentElement(d.parentNode,"table"),k=g.cloneNode(!1),l=b.getImmediateChildNodesByTagName(g,"colgroup");if(0<l.length){var n=e.createDocumentFragment();a=0;for(var p=l.length;a<p;a++)n.appendChild(l[a].cloneNode(!0));k.firstChild?k.insertBefore(n,k.firstChild):k.appendChild(n)}if(f===h){var m=h.cloneNode(!1);b.moveNodesTo(m,c);k.appendChild(m);h=m}b.moveNodesTo(k,h);insertAfter(g,k);return k}catch(q){dalert(q)}},divideCellAtY:function(a,b,d){try{if(!a||!d||!this.table.ownerDocument)return!1;
var c=g_objNodeUtil,e=g_objPropertyUtil,f=g_objTableUtil,h=this.getMatrixIndex(a),g=this.getRowRange(h[0].row,h[0].col);if(!(g.start<b&&b<=g.end))return!1;var k=f.cloneCell(a,!1,!0);c.removeAllChild(k);var l=e.getStyleHeight(a);l=this.getHeightSumObj(l);var n=f.offsetHeightToStyleHeight(d[0],a);f.setNodeValue_Height(a,l.getHeight(n),"px");n=f.offsetHeightToStyleHeight(d[1],a);f.setNodeValue_Height(k,l.getHeight(n),"px");this.setRowspan(a,b-g.start);this.setRowspan(k,g.end-b+1);this.insertCell(k,b,
h[0].col);this.makeMatrix();return!0}catch(p){dalert(p)}},insertBlankCol:function(a,b){try{if("undefined"==typeof a||0>a||a>this.colLength||0>=b)return!1;b=b||0;this.splitCol(a,!1);var d=this.createBlankCell(this.rowLength,b);this.insertCell(d,0,a);if(0<this.colgroups.length){var c=this.table.ownerDocument;d=g_objNodeUtil;for(var e=c.createDocumentFragment(),f=0;f<b;f++){var h=c.createElement("col");h.style.width="0px";e.appendChild(h)}f=0;for(var g=this.colgroups.length;f<g;f++){var k=d.getImmediateChildNodesByTagName(this.colgroups[f],
"col");k[a]&&k[a].parentNode&&(a<k.length?k[a].parentNode.insertBefore(e.cloneNode(!0),k[a]):k[a].parentNode.appendChild(e.cloneNode(!0)))}}this.makeMatrix();return!0}catch(l){dalert(l)}},insertBlankRow:function(a,b){try{if("undefined"==typeof a||0>a||a>this.rowLength||0>=b)return!1;b=b||0;this.splitRow(a,!1);var d=this.table.ownerDocument,c=d.createDocumentFragment(),e=d.createElement("tr");for(d=0;d<b;d++)c.appendChild(e.cloneNode(!1));var f=this.createBlankCell(b,this.colLength);c.firstChild.appendChild(f);
0>=a?this.trs[0].parentNode.insertBefore(c,this.trs[0]):insertAfter(this.trs[a-1],c);this.makeMatrix();return!0}catch(h){dalert(h)}},insertRow:function(a,b){try{if("undefined"==typeof a||0>a||a>this.rowLength)return!1;b=b||1;this.splitRow(a,!1);a=0<a?a-1:a;for(var d=this.cloneRow(a,a),c=this.table.ownerDocument.createDocumentFragment(),e=0;e<b;e++)c.appendChild(d.cloneNode(!0));0==a?this.trs[0].parentNode.insertBefore(c,this.trs[0]):insertAfter(this.trs[a],c);this.makeMatrix();return!0}catch(f){dalert(f)}},
getSelection:function(){try{var a=!1,b=[],d=function(a){a=this.getMatrixIndex(a);for(var c=a.length-1;0<=c;c--){var d=a[c].row,e=a[c].col;b[d]||(b[d]=[]);b[d][e]=!0}}.bind(this),c=function(a,c,d,e){for(;a<=d;a++)for(var f=c;f<=e;f++)b[a]&&b[a][f]&&(b[a][f]=!1)}.bind(this),e=function(a,c,d,e){for(;a<=d;a++)for(var f=c;f<=e;f++)if(!b[a]||!b[a][f])return!1;return!0}.bind(this);g_objTableSelection.doAllSelectedCell(function(b){d(b);a=!0},this.table);if(!a)return null;for(var f=[],h=null,g=0,k=-1,l=-1,
n=-1,p=-1,m=0,q=b.length;m<q;m++)if(b[m])for(var r=0,u=b[m].length;r<u;r++)if(b[m][r]){k=l=m;n=p=r;g=1;for(var t=m;t<q;t++)for(var v=r;v<u;v++)if(e(m,r,t,v)){var y=(t-m+1)*(v-r+1);y>g&&(l=t,p=v,g=y)}c(k,n,l,p);f.push({nStartRow:k,nStartCol:n,nEndRow:l,nEndCol:p})}h=c=null;for(m=0;m<f.length;m++){c=f[m];h=null;for(var x=c.nStartRow;x<=c.nEndRow;x++)for(var w=c.nStartCol;w<=c.nEndCol;w++)this.isShow(x,w)&&(h||(h=[]),h.push(this.getCell(x,w)));c.arrCell=h}return f}catch(z){dalert(z)}},isBlankCol:function(a){try{if(0>
a||a>=this.colLength)return!0;if(this.arrBlankCol&&null!==this.arrBlankCol[a])return this.arrBlankCol[a];if(!this.arrBlankCol){this.arrBlankCol=[];for(var b=0;b<this.colLength;b++)this.arrBlankCol[b]=null}for(b=0;b<this.rowLength&&!this.isShow(b,a);b++);this.arrBlankCol[a]=b<this.rowLength?!1:!0;return this.arrBlankCol[a]}catch(d){dalert(d)}},isBlankRow:function(a){try{if(0>a||a>=this.rowLength)return!0;if(this.arrBlankRow&&null!==this.arrBlankRow[a])return this.arrBlankRow[a];if(!this.arrBlankRow){this.arrBlankRow=
[];for(var b=0;b<this.rowLength;b++)this.arrBlankRow[b]=null}for(b=0;b<this.colLength&&!this.isShow(a,b);b++);this.arrBlankRow[a]=b<this.colLength?!1:!0;return this.arrBlankRow[a]}catch(d){dalert(d)}},removeBlankCol:function(){try{for(var a=g_objTableResize,b=a.nMinWidth,d=a.nMinWidth=0,c=this.colLength-1;1<=c;c--)if(this.isBlankCol(c)){var e=this.calculateColWidth();if(!e)break;e=e.slice();e[c-1]+=e[c];e[c]=0;a.setColWidth(this,c,0);a.setColWidth(this,c-1,e[c-1]);this.removeCol(c,c,{returnFragment:!1});
d++}return d}catch(f){dalert(f)}finally{a.nMinWidth=b}},removeBlankRow:function(){try{for(var a=g_objTableResize,b=a.nMinHeight,d=a.nMinHeight=0,c=this.rowLength-1;1<=c;c--)if(this.isBlankRow(c)){var e=this.calculateRowHeight();if(!e)return 0;e=e.slice();e[c-1]+=e[c];e[c]=0;a.setRowHeight(this,c,0);a.setRowHeight(this,c-1,e[c-1]);this.removeRow(c,c,{returnFragment:!1});d++}return d}catch(f){dalert(f)}finally{a.nMinHeight=b}},removeZeroWidthCol:function(){try{var a=this.calculateColWidth();if(!a)return 0;
for(var b=!1,d=0,c=this.colLength-1;0<=c;c--)if(0===a[c]){b=!1;for(var e=this.rowLength-1;0<=e;e--)if(this.isShow(e,c)&&1===this.getColRange(e,c).length){b=!0;break}!1===b&&(this.removeCol(c,c,{returnFragment:!1}),d++)}return d}catch(f){dalert(f)}},removeZeroHeightRow:function(){try{var a=this.calculateRowHeight();if(!a)return 0;for(var b=!1,d=0,c=this.rowLength-1;0<=c;c--)if(0===a[c]){b=!1;for(var e=this.colLength-1;0<=e;e--)if(this.isShow(c,e)&&1===this.getRowRange(c,e).length){b=!0;break}!1===
b&&(this.removeRow(c,c,{returnFragment:!1}),d++)}return d}catch(f){dalert(f)}}};

var g_objPositionUtil=new function(){this.getNodeElementPosition=function(a){try{var b=this.getElementPosition(a,!1);if(dzeEnvConfig.iFrameLayer){var d=this.getElementPosition(window.frameElement,!0);b.left+=d.left;b.top+=d.top;b.right+=d.left;b.bottom+=d.top}return b}catch(c){dalert(c)}return{left:0,top:0,right:0,bottom:0}};this.getElementPosition=function(a,b){try{var d={left:0,top:0,right:0,bottom:0},c=this.getDocumentScrollPosition(b),e=c.nScrollLeft,f=c.nScrollTop,g=a.getBoundingClientRect();
d.left=parseInt(g.left+e);d.top=parseInt(g.top+f);d.right=parseInt(g.right+e);d.bottom=parseInt(g.bottom+f);return d}catch(h){dalert(h)}return{left:0,top:0,right:0,bottom:0}};this.getOuterRect=function(a){try{if(a&&g_objCommonUtil.IS_VALID_VALUE(a.offsetWidth)&&g_objCommonUtil.IS_VALID_VALUE(a.offsetHeight))return{left:this.getLeft(a),top:this.getTop(a),width:a.offsetWidth,height:a.offsetHeight};if(a&&a.nodeName==DZE_TAG_SVG){var b=a.width.baseVal,d=b.unitType==SVGLength.SVG_LENGTHTYPE_PERCENTAGE?
a.clientWidth*b.valueInSpecifiedUnits/100:b.value;b=a.height.baseVal;return{left:a.x.baseVal.value,top:a.y.baseVal.value,width:d,height:b.unitType==SVGLength.SVG_LENGTHTYPE_PERCENTAGE?a.clientHeight*b.valueInSpecifiedUnits/100:b.value}}return null}catch(c){dalert(c)}};this.getFrameClientRect=function(){try{var a=this.getEmptyRect();if(dzeEnvConfig.iFrameLayer){var b=window.frameElement;b&&(a=this.domRectToRect(b.getBoundingClientRect()));var d=window.parent,c=d?d.document:null;if(c&&d!==window){d=
b=0;var e=null;g_bBrowserType_SF?(b=(((e=c.body)||(e=c.documentElement))&&"number"==typeof e.scrollLeft?e:c.body.parentNode).scrollLeft,d=(((e=c.body)||(e=c.documentElement))&&"number"==typeof e.scrollTop?e:c.body.parentNode).scrollTop):(b=(((e=c.documentElement)||(e=c.body.parentNode))&&"number"==typeof e.scrollLeft?e:c.body).scrollLeft,d=(((e=c.documentElement)||(e=c.body.parentNode))&&"number"==typeof e.scrollTop?e:c.body).scrollTop);this.moveRect(a,b,d)}}return a}catch(f){dalert(f)}};this.getLeft=
function(a){try{if(null==a)return 0;var b=a.offsetLeft;return g_objCommonUtil.IS_VALID_VALUE(b)?b+this.getInnerLeft(a.offsetParent):0}catch(d){dalert(d)}};this.getInnerLeft=function(a){try{if(null==a)return 0;if(g_bDocType_XHTML){if(a==document.documentElement)return 0}else if(a==document.body)return 0;return this.getLeft(a)+this.getBorderLeft(a)}catch(b){dalert(b)}};this.getBorderLeft=function(a){try{return g_bBrowserType_IE?a.clientLeft:parseInt(window.getComputedStyle(a,null).getPropertyValue("border-left-width"))}catch(b){dalert(b)}};
this.getInnerScrollLeft=function(a){try{if(null==a||null==a.offsetParent||a.ownerDocument==g_objEditorDocument[g_nActiveEditNumber])return 0;for(var b=a,d=0,c=0;b&&!1===b.isEqualNode(a.offsetParent);)c=b.scrollLeft,!1===fnObjectCheckNull(c)&&!1===isNaN(c)&&(d-=c),b=b.parentNode;return d}catch(e){dalert(e)}};this.getTop=function(a){try{if(null==a)return 0;var b=a.offsetTop;return g_objCommonUtil.IS_VALID_VALUE(b)?b+this.getInnerTop(a.offsetParent):0}catch(d){dalert(d)}};this.getInnerTop=function(a){try{if(null==
a)return 0;if(g_bDocType_XHTML){if(a==document.documentElement)return 0}else if(a==document.body)return 0;return this.getTop(a)+this.getBorderTop(a)}catch(b){dalert(b)}};this.getInnerSize=function(a){return{width:this.getInnerWidth(a),height:this.getInnerHeight(a)}};this.getInnerWidth=function(a){try{if(!a||1!==a.nodeType)return 10;var b=a.offsetWidth,d=g_objPropertyUtil,c=d.getPadding(a,d.LEFT)+d.getPadding(a,d.RIGHT);b-=c;if(g_objNodeUtil.isCell(a)){var e=g_objNodeUtil.getLoopParentElement(a,"table");
if(e){if(e.cellPadding){var f=g_objCommonUtil.extractNumberValueUnit(e.cellPadding),g=0;f&&(g=g_objCommonUtil.convToPx(f.nValue,f.strUnit),isNaN(g)||(b-=2*parseFloat(e.cellPadding)))}var h=g_objPropertyUtil.getElementStyleAttributeValue(e,"border-left-width");a=0;h&&(f=g_objCommonUtil.extractNumberValueUnit(h),g=0,f&&(g=g_objCommonUtil.convToPx(f.nValue,f.strUnit),isNaN(g)||(a=g)));var k=g_objPropertyUtil.getElementStyleAttributeValue(e,"border-right-width");h=0;k&&(f=g_objCommonUtil.extractNumberValueUnit(k),
g=0,f&&(g=g_objCommonUtil.convToPx(f.nValue,f.strUnit),isNaN(g)||(h=g)));if(0<a+h){var l=g_objTableUtil.getTableMaxColSpanCount(e);b-=(a+h)/l}}}return parseInt(b,10)}catch(m){return dalert(m),10}};this.getInnerHeight=function(a){try{if(!a||1!==a.nodeType)return 10;var b=a.offsetHeight,d=g_objPropertyUtil,c=d.getPadding(a,d.TOP)+d.getPadding(a,d.BOTTOM);b-=c;if(g_objNodeUtil.isCell(a)){var e=g_objNodeUtil.getLoopParentElement(a,"table");if(e&&e.cellPadding){var f=g_objCommonUtil.extractNumberValueUnit(e.cellPadding);
a=0;f&&(a=g_objCommonUtil.convToPx(f.nValue,f.strUnit),isNaN(a)||(b-=2*parseFloat(e.cellPadding)))}}return b}catch(g){return dalert(g),10}};this.getBorderTop=function(a){try{return g_bBrowserType_IE?a.clientTop:parseInt(window.getComputedStyle(a,null).getPropertyValue("border-top-width"))}catch(b){dalert(b)}};this.getDocumentTop=function(a){try{if(!a||1!==a.nodeType)return 0;var b=g_objCommonUtil,d=a.offsetTop;if(!b.IS_VALID_VALUE(d))return 0;var c=a.offsetParent;for(a=0;c&&"BODY"!==c.nodeName;)a=
c.offsetTop,b.IS_VALID_VALUE(a)||(a=0),d+=a,c=c.offsetParent;return d}catch(e){dalert(e)}};this.getDocumentLeft=function(a){try{if(!a||1!==a.nodeType)return 0;var b=g_objCommonUtil,d=a.offsetLeft;if(!b.IS_VALID_VALUE(d))return 0;var c=a.offsetParent;for(a=0;c&&"BODY"!==c.nodeName;)a=c.offsetLeft,b.IS_VALID_VALUE(a)||(a=0),d+=a,c=c.offsetParent;return d}catch(e){dalert(e)}};this.getDocumentPos=function(a){return{x:this.getDocumentLeft(a),y:this.getDocumentTop(a)}};this.domRectToRect=function(a){return this.createRect(a.left,
a.top,a.width,a.height)};this.createRect=function(a,b,d,c){try{var e={};e.left=a;e.top=b;e.width=d;e.height=c;e.right=a+d;e.bottom=b+c;e.x=a;e.y=b;return e}catch(f){dalert(f)}};this.getEmptyRect=function(){return{left:0,right:0,top:0,bottom:0,x:0,y:0,width:0,height:0}};this.moveRect=function(a,b,d){if(!a)return null;a.left+=b;a.right+=b;a.top+=d;a.bottom+=d;return a};this.equalRect=function(a,b){return a&&b?a.left===b.left&&a.top===b.top&&a.right===b.right&&a.bottom===b.bottom&&a.width===b.width&&
a.height===b.height?!0:!1:!1};this.isEmptyRect=function(a){return!a||a.left===a.right&&a.top===a.bottom?!0:!1};this.dist=function(a,b,d,c){a=a>d?a-d:d-a;b=b>c?b-c:c-b;return Math.sqrt(a*a+b*b)};this.clientRectToOffsetRect=function(a){try{var b=this.domRectToRect(a);b.left/=1;b.top/=1;b.width/=1;b.height/=1;b.right=b.left+b.width;b.bottom=b.top+b.height;b.x=b.left;b.y=b.top;return b}catch(d){dalert(d)}};this.getTextNodeRect=function(a,b,d){try{var c={left:0,top:0,right:0,bottom:0,width:0,height:0,
x:0,y:0},e=null;if(!a||""===a.nodeValue)return c;var f=a.parentNode,g=a.ownerDocument;if(!f||!g)return c;e=g.createRange();e.selectNodeContents(a);var h=a.nodeValue.length;!fnObjectCheckNull(b)&&0<=b&&b<h&&e.setStart(a,b);!fnObjectCheckNull(d)&&0<=d&&d<=h&&e.setEnd(a,d);var k=e.getBoundingClientRect(),l=f.getBoundingClientRect();k=this.clientRectToOffsetRect(k);l=this.clientRectToOffsetRect(l);c.left=k.left-l.left+this.getPageLeft(f);c.top=k.top-l.top+this.getPageTop(f);c.width=k.width;c.height=k.height;
c.right=c.left+c.width;c.bottom=c.top+c.height;c.x=c.left;c.y=c.y;return c}catch(m){dalert(m)}finally{}};this.getCharRect=function(a){try{var b=[];this.forEachCharRect(a,function(a,c){b.push(c)});return b}catch(d){dalert(d)}};this.forEachCharRect=function(a,b,d,c){try{if(!a||!b||3!==a.nodeType&&(1!==a.nodeType||"BR"!==a.nodeName))return null;d=!1===d?!1:!0;var e=a.parentNode.ownerDocument.createRange(),f=null;if(3===a.nodeType){var g=a.nodeValue.length;for(void 0===c&&(c=d?0:g-1);d?c<g:0<=c;d?c++:
c--)e.setStart(a,c),e.setEnd(a,c+1),f=e.getBoundingClientRect(),b(c,f)}else e.selectNode(a),f=e.getBoundingClientRect(),b(0,f)}catch(h){h!==BreakException&&dalert(h)}finally{}};this.getBrNodeRect=function(a,b){try{if(!a)return 0;var d="undefined"!=typeof g_objPageControl?g_objPageControl:null;d&&d.saveCaret&&d.saveCaret();var c=a.ownerDocument.createElement("span");d=0;a.parentNode.replaceChild(c,a);c.innerHTML="&#8203;";switch(b){case "left":case "right":d=this.getPageLeft(c);break;case "top":d=
this.getPageTop(c);break;default:d=this.getPageTop(c)+c.offsetHeight}c.parentNode.replaceChild(a,c);return d}catch(e){dalert(e)}};this.getInnerScrollTop=function(a){try{if(null==a||null==a.offsetParent||a.ownerDocument==g_objEditorDocument[g_nActiveEditNumber])return 0;for(var b=a,d=0,c=0;b&&!1===b.isEqualNode(a.offsetParent);)c=b.scrollTop,!1===fnObjectCheckNull(c)&&!1===isNaN(c)&&(d-=c),b=b.parentNode;return d}catch(e){dalert(e)}};this.getDocumentScrollPosition=function(a){try{var b=this.getDocumentElementObject(a);
(a=b)&&b.ownerDocument&&b.ownerDocument.scrollingElement&&(a=b.ownerDocument.scrollingElement);if(a)return{nScrollLeft:a.scrollLeft,nScrollTop:a.scrollTop}}catch(d){dalert(d)}return{nScrollLeft:0,nScrollTop:0}};this.getDocumentElementObject=function(a){try{if(a){if(g_bBrowserType_IE||g_bBrowserType_FF||g_bBrowserType_OP)return g_bDocType_XHTML?window.parent.document.documentElement:window.parent.document.body;if(g_bBrowserType_WK)return window.parent.document.body}else{if(g_bBrowserType_IE||g_bBrowserType_FF||
g_bBrowserType_OP)return g_bDocType_XHTML?document.documentElement:document.body;if(g_bBrowserType_WK)return document.body}}catch(b){dalert(b)}return null};this.getEditorDocumentType=function(a){try{return!(null==g_objEditorDocument[a].compatMode||"CSS1Compat"!=g_objEditorDocument[a].compatMode)}catch(b){dalert(b)}};this.getEditDocScrollPosition=function(a,b){try{if(g_bBrowserType_IE)return this.getEditorDocumentType(b)?{nScrollLeft:a.documentElement.scrollLeft,nScrollTop:a.documentElement.scrollTop}:
{nScrollLeft:a.body.scrollLeft,nScrollTop:a.body.scrollTop};if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return{nScrollLeft:a.body.scrollLeft,nScrollTop:a.body.scrollTop}}catch(d){dalert(d)}return{nScrollLeft:0,nScrollTop:0}};this.getElementPosClientRect=function(a){try{var b={left:0,top:0,right:0,bottom:0};if(!a||1!==a.nodeType)return b;var d=a.getBoundingClientRect();b.left=parseInt(d.left);b.top=parseInt(d.top);b.right=parseInt(d.right);b.bottom=parseInt(d.bottom);b.width=parseInt(d.width);
b.height=parseInt(d.height);return b}catch(c){dalert(c)}return{left:0,top:0,right:0,bottom:0}};this.getOuterRectByClientWidthHeight=function(a){try{return g_objCommonUtil.IS_VALID_VALUE(a.clientWidth)&&g_objCommonUtil.IS_VALID_VALUE(a.clientHeight)?a.nodeName==DZE_TAG_SVG?{left:a.x.baseVal.value,top:a.y.baseVal.value,width:a.clientWidth,height:a.clientHeight}:{left:this.getLeft(a),top:this.getTop(a),width:a.clientWidth,height:a.clientHeight}:{left:0,top:0,width:0,height:0}}catch(b){dalert(b)}};this.getElementPosInEditArea=
function(a){try{var b={left:0,top:0,right:0,bottom:0};if(g_bBrowserType_IE){var d=a.getBoundingClientRect();b.left=parseInt(d.left);b.top=parseInt(d.top);b.right=parseInt(d.right);b.bottom=parseInt(d.bottom)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var c=this.getOuterRectByClientWidthHeight(a);b.left=parseInt(c.left);b.top=parseInt(c.top);b.right=parseInt(c.left)+parseInt(c.width);b.bottom=parseInt(c.top)+parseInt(c.height)}return b}catch(e){dalert(e)}return{left:0,top:0,right:0,
bottom:0}};this.getElementPosInEditAreaWithScrollPos=function(a,b){try{var d=this.getEditorDocumentType(b),c=0,e=0;g_bBrowserType_IE&&(d?(c=g_objEditorDocument[b].documentElement.scrollLeft,e=g_objEditorDocument[b].documentElement.scrollTop):(c=g_objEditorDocument[b].body.scrollLeft,e=g_objEditorDocument[b].body.scrollTop));var f=this.getElementPosInEditArea_ByOffset(a);f.left+=c;f.top+=e;f.right+=c;f.bottom+=e;f.left=parseInt(f.left);f.top=parseInt(f.top);f.right=parseInt(f.right);f.bottom=parseInt(f.bottom);
f.width=f.right-f.left;f.height=f.bottom-f.top;return f}catch(g){dalert(g)}return null};this.getElementPosInEditArea_ByOffset=function(a){try{var b={left:0,top:0,right:0,bottom:0};if(g_bBrowserType_IE){var d=a.getBoundingClientRect();d&&(b.left=d.left,b.top=d.top,b.right=d.right,b.bottom=d.bottom)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var c=this.getOuterRect(a);c&&(b.left=c.left,b.top=c.top,b.right=c.left+c.width,b.bottom=c.top+c.height)}return b}catch(e){dalert(e)}return{left:0,
top:0,right:0,bottom:0}};this.getTableCellPosInEditAreaWithScrollPos=function(a,b,d,c){try{if(fnObjectCheckNull(a))return null;var e={left:0,top:0,right:0,bottom:0};if(g_bBrowserType_IE||g_bBrowserType_FF)return this.getElementPosInEditAreaWithScrollPos(a,c);if(g_bBrowserType_WK||g_bBrowserType_OP){var f=this.getElementPosInEditAreaWithScrollPos(g_objTableUtil.getTableRowElement(b,d),c);e=this.getElementPosInEditAreaWithScrollPos(a,c);e.top=f.top;var g=d+a.rowSpan;if(g<b.rows.length){var h=this.getElementPosInEditAreaWithScrollPos(g_objTableUtil.getTableRowElement(b,
g),c);e.bottom=h.top-1}else{var k=this.getElementPosInEditAreaWithScrollPos(b,c);e.bottom=k.bottom-1}return e}}catch(l){dalert(l)}return{left:0,top:0,right:0,bottom:0}};this.GetDocumentClientPos_XY=function(a){try{var b=this.getDocumentElementObject(!1);if(b&&a){if("touchstart"===a.type||"touchmove"===a.type||"touchend"===a.type){var d=a.touches;return{nPos_X:d[0].clientX+b.scrollLeft,nPos_Y:d[0].clientY+b.scrollTop}}return{nPos_X:a.clientX+b.scrollLeft,nPos_Y:a.clientY+b.scrollTop}}}catch(c){dalert(c)}return{nPos_X:0,
nPos_Y:0}};this.GetDocumentClientPos_XY_iFrameLayer=function(a){try{if(!dzeEnvConfig.iFrameLayer)return;var b=this.getDocumentElementObject(!0);if(b){if(g_bBrowserType_IE)return{nPos_X:window.parent.event.clientX+b.scrollLeft,nPos_Y:window.parent.event.clientY+b.scrollTop};if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)return{nPos_X:a.clientX+b.scrollLeft,nPos_Y:a.clientY+b.scrollTop}}}catch(d){dalert(d)}return{nPos_X:0,nPos_Y:0}};this.getDocumentClientSize=function(a){try{var b=this.getDocumentElementObject(!1);
if(b)return{nClientWidth:b.clientWidth,nClientHeight:b.clientHeight}}catch(d){dalert(d)}return{nClientWidth:0,nClientHeight:0}};this.getLayerNodeElementPosition=function(a){try{var b=this.getLayerElementPosition(a,!1);if(dzeEnvConfig.iFrameLayer){var d=this.getLayerElementPosition(window.frameElement,!0);b.left+=d.left;b.top+=d.top;b.right+=d.left;b.bottom+=d.top}return b}catch(c){dalert(c)}return{left:0,top:0,right:0,bottom:0}};this.getLayerElementPosition=function(a,b){try{b={left:0,top:0,right:0,
bottom:0};if(!a)return b;var d=this.getOuterRect(a);b.left=parseInt(d.left);b.top=parseInt(d.top);b.right=parseInt(d.left)+parseInt(d.width);b.bottom=parseInt(d.top)+parseInt(d.height);return b}catch(c){dalert(c)}return{left:0,top:0,right:0,bottom:0}};this.getOverlapRange=function(a,b,d,c){a=Math.max(a,d);b=Math.min(b,c);return a<b?b-a:0};this.isOverlap=function(a,b,d,c){try{return Math.max(a,d)<=Math.min(b,c)?!0:!1}catch(e){dalert(e)}};this.arrangeObjectPosition=function(a,b){try{for(var d,c,e=0;e<
a.childNodes.length;e++)c=a.childNodes[e],c.nodeType===ID_SELECTION_ELEMENT_NODE&&"absolute"===c.style.position&&(d=parseFloat(c.style.left),c.style.left=d-b)}catch(f){dalert(f)}}};

var tagUtil=function(){this.bFormTagSwitch=!1;this.arrInputType="checkbox radio text password search tel url week month".split(" ");tagUtil.prototype.updateCurFormTagAttr=function(a){try{var c=g_objEditorDocument[a];return c?this.updateFormTagAttr(c.activeElement):!1}catch(d){dalert(d)}};tagUtil.prototype.updateFormTagAttr=function(a){try{if(a&&1===a.nodeType){var c=!1;if("INPUT"===a.nodeName)switch(a.type){case "checkbox":var d=a.checked,b="true"===a.getAttribute("checked")?!0:!1;d!==b&&(d?a.setAttribute("checked",
!0):a.removeAttribute("checked"),c=!0);break;case "radio":d=a.checked;b="true"===a.getAttribute("checked")?!0:!1;d?a.setAttribute("checked",!0):a.removeAttribute("checked");if(d&&a.name){var e=a.ownerDocument.querySelectorAll("input[type=radio][name="+a.name+"]");forEach(e,function(b,c){c!==a&&c.hasAttribute("checked")&&c.removeAttribute("checked")},this)}c=!0;break;case "text":case "search":case "tel":case "url":case "week":case "month":case "date":var f=a.value,h=a.getAttribute("value");f!==h&&
(a.setAttribute("value",a.value),c=!0)}else if("TEXTAREA"===a.nodeName)f=a.value,f!==a.textContent&&(a.textContent=f,c=!0);else if("SELECT"===a.nodeName){var l=a.selectedIndex;d=-1;var g=a.options;b=0;for(var k=g.length;b<k;b++)if("selected"===g[b].getAttribute("selected")){d=b;break}if(l!==d){b=0;for(k=g.length;b<k;b++)b===l?g[b].setAttribute("selected","selected"):g[b].removeAttribute("selected");c=!0}}return c}}catch(m){dalert(m)}};tagUtil.prototype.formTagSwitch=function(a,c){try{var d=g_objEditorDocument[c];
if(d){var b=d.getElementsByTagName("input");c=0;for(var e=b.length;c<e;c++)0<=this.arrInputType.indexOf(b[c].type)&&this.formTagSwitch_ContentEditable(b[c],a);var f=d.getElementsByTagName("select");c=0;for(e=f.length;c<e;c++)this.formTagSwitch_ContentEditable(f[c],a)}}catch(h){dalert(h)}};tagUtil.prototype.formTagSwitch_ContentEditable=function(a,c){try{if(a){var d=a.ownerDocument;if(d){var b=a.parentNode;b&&(!1===c?(c=function(a){var b=d.createElement("span");b.contentEditable="false";var c=null;
"INPUT"===a.nodeName&&"radio"===a.type&&g_objPropertyUtil.hasClass(a,"dze_checkbox_radio")&&a.nextSibling&&"LABEL"===a.nextSibling.nodeName&&(c=a.nextSibling);a.parentNode.replaceChild(b,a);b.appendChild(a);c&&b.appendChild(c);return b},"SPAN"===b.nodeName?b.firstChild===b.lastChild&&b.firstChild===a?b.contentEditable="false":(b.removeAttribute("contentEditable"),g_objNodeUtil.splitOn(b.parentNode,a),c(a)):c(a)):"SPAN"===b.nodeName&&(b.firstChild===b.lastChild&&b.firstChild===a?(b.removeChild(a),
b.parentNode.replaceChild(a,b)):(b.removeAttribute("contentEditable"),g_objNodeUtil.splitOn(b.parentNode,a))))}}}catch(e){dalert(e)}};tagUtil.prototype.force_formTagSwitch=function(a){try{var c=g_objEditorDocument[a];if(c){this.bFormTagSwitch=!1;var d=c.getElementsByTagName("input");a=0;for(var b=d.length;a<b;a++)0<=this.arrInputType.indexOf(d[a].type)&&this.formTagSwitch_ContentEditable(d[a],!1);var e=c.getElementsByTagName("select");a=0;for(b=e.length;a<b;a++)this.formTagSwitch_ContentEditable(e[a],
!1)}}catch(f){dalert(f)}}},g_objTagUtil=new tagUtil;

var insertUtil=function(){insertUtil.prototype.insertTableCodeAtSelection=function(a,c){try{if(window.attachEvent){var b=g_objEditorDocument[c].selection;if(null!=b){var d=b.createRange();d.execCommand("Delete");var f=d.parentElement(),e=this.getNodePosition_For_PTag(f);if(null==e)insertHTMLCodeAtSelection(a,null,c);else{var m=g_objUndoRedo.getSelectionPos_IE(d,e.paramNode,b),g=g_objEditorDocument[c].createElement("p");g.innerHTML=e.paramNode.innerHTML;var h=g_objNodeUtil.getParentElement(e.paramNode);
if(null!=h){f=!1;if(0==g.childNodes.length)f=!0;else if(1==g.childNodes.length){var k=g.childNodes[0];ID_SELECTION_ELEMENT_NODE==k.nodeType&&"br"==g_objNodeUtil.getElementTagName(k).toLowerCase()&&(f=!0)}if(f){var l=g_objEditorDocument[c].createElement("div");for(l.innerHTML=a;0<l.childNodes.length;)k=l.childNodes[0],h.insertBefore(k,e.paramNode)}else{h.insertBefore(g,e.paramNode);l=g_objEditorDocument[c].createElement("div");for(l.innerHTML=a;0<l.childNodes.length;)k=l.childNodes[0],h.insertBefore(k,
e.paramNode);d=b.createRange();d.moveToElementText(g);d.moveStart("character",m.nStartRangePos);d.execCommand("Delete");d=b.createRange();d.moveToElementText(e.paramNode);d.collapse(!0);d.moveEnd("character",m.nStartRangePos);d.execCommand("Delete")}}}}}else{var n=g_objEditorDocument[c].createRange().createContextualFragment(a);return n&&n.firstChild?this.insertTableAtSelection(n,c):!1}}catch(p){dalert(p)}};insertUtil.prototype.insertTableAtSelection=function(a,c){try{if(!a)return null;11===a.nodeType&&
a.firstChild===a.lastChild&&(a=a.firstChild);var b=GetCurRange(c);if(!b)return null;for(var d=g_objNodeUtil,f=!0,e=a;e;){if("TABLE"!==e.nodeName){f=!1;break}e=e.nextSibling}e=null;f&&(e=function(a){return d.checkTagName(a,"li","dt","dd")?!0:!1});var m=g_objEditorDocument[c];SelectionUtil.deleteSelection(c);b=GetCurRange(c);var g=d.getClosetBound(b.startContainer,e);if(!g)return null;var h=m.createElement("span");b.insertNode(h);var k=d.findSplitPosition(h,g);k.parentNode.insertBefore(h,k);var l=h.previousSibling,
n=h.nextSibling;d.splitOn(g,h);var p=h.previousSibling,q=h.nextSibling;d.insertBrIntoBlankPara(p);d.insertBrIntoBlankPara(q);d.isBlankPara(p)||d.removeEmptyNode(p,l);"TABLE"===a.nodeName&&d.checkTagName(g,"li","dt","dd")&&(d.isBlankPara(q)||d.removeEmptyNode(q,n));h.parentNode.replaceChild(a,h);g_objCaretUtil.moveCaret(q,!1);return a}catch(r){dalert(r)}finally{b=null}};insertUtil.prototype.insertImgAtSelection=function(a,c){try{if(!a)return!1;var b=GetCurRange(c);if(!b)return!1;var d=a;11===a.nodeType&&
(d=a.childNodes[a.childNodes.length-1]);var f=g_objNodeUtil;SelectionUtil.deleteSelection(c);var e=g_objEditorDocument[c];b=GetCurRange(c);var m=f.getClosetBound(b.startContainer,function(a){return f.isBlockNode(a)});if(m){var g=e.createElement("span");b.insertNode(g);var h=g.previousSibling,k=g.nextSibling;f.splitOn(m,g);f.removeEmptyNode(null,h);f.removeEmptyNode(null,k);g.parentNode.replaceChild(a,g);g_objCaretUtil.moveCaret(d,!1,!1);return!0}}catch(l){dalert(l)}finally{b=null}};insertUtil.prototype.getNodePosition_For_PTag=
function(a){try{for(var c=[];;){if("body"==a.nodeName.toLowerCase())return null;if("p"==a.nodeName.toLowerCase())break;var b=this.getNodePosition_previousSibling_For_PTag(a);c[c.length]=b;a=g_objNodeUtil.getParentElement(a);if(null==a)return null}return{paramNode:a,paramPos:c}}catch(d){dalert(d)}return null};insertUtil.prototype.getNodePosition_previousSibling_For_PTag=function(a){try{for(var c=0;null!=a.previousSibling;)c++,a=a.previousSibling;return c}catch(b){dalert(b)}};insertUtil.prototype.insertLayerHTML=
function(a,c){try{var b=null;if(c){if(b=g_objLayerKit.getLayerDocument(),null==b)return!1}else b=document;if(!b)return null;a=a.trim();var d=b.createElement("div");d.innerHTML=a;1===d.childNodes.length&&(d=d.firstChild);b.body.appendChild(d);return d}catch(f){dalert(f)}return!1};insertUtil.prototype.saveSelectionRange_IE=function(a,c){try{if(0==a)if(window.attachEvent){var b=g_objEditorDocument[c]?g_objEditorDocument[c].selection:null;b&&(g_objLastRange[c]=b.createRange())}else g_bBrowserType_IE&&
(b=g_objEditWindow[c]?g_objEditWindow[c].getSelection():null)&&1==b.rangeCount&&(g_objLastRange[c]=b.getRangeAt(0));else 1==a&&(window.attachEvent?(b=g_objEditorDocument[c]?g_objEditorDocument[c].selection:null)&&(g_objCurrentRange[c]=b.createRange()):g_bBrowserType_IE&&(b=g_objEditWindow[c]?g_objEditWindow[c].getSelection():null)&&1==b.rangeCount&&(g_objCurrentRange[c]=b.getRangeAt(0)))}catch(d){dalert(d)}};insertUtil.prototype.activeSaveRangeFocus=function(a,c){try{if("undefined"!=typeof a){var b=
null;if(0==a)b=g_objLastRange[c];else if(1==a)b=g_objCurrentRange[c];else return;window.attachEvent?g_objEditWindow[c].focus():g_objEditorDocument[c].body.focus();if(null!=b)if(window.attachEvent)b.select();else if(g_bBrowserType_IE){var d=g_objEditWindow[c].getSelection();d.removeAllRanges();d.addRange(b)}}}catch(f){dalert(f)}};insertUtil.prototype.dynamicLoad_CSS=function(a,c,b){try{"undefined"==typeof b&&(b=function(){});var d=a.getElementsByTagName("head")[0],f=d.getElementsByTagName("link");
for(a=0;a<f.length;a++)if(f[a].getAttribute("href")==c){b();return}var e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("type","text/css");e.setAttribute("href",c);e.onload=function(){b()};d.appendChild(e)}catch(m){dalert(m)}};insertUtil.prototype.dynamicLoad_JS=function(a,c){try{var b=a.getElementsByTagName("head")[0],d=b.getElementsByTagName("script");for(a=0;a<d.length;a++)if(d[a].getAttribute("src")==c)return;var f=document.createElement("script");f.setAttribute("type",
"text/javascript");f.setAttribute("src",c);b.appendChild(f)}catch(e){dalert(e)}}},g_objInsertUtil=new insertUtil;

var g_objBorderComboBoxUtil=new function(){var h=this;this.arrBorderStyle=["noline","solid","dotted","dashed","double"];this.arrBorderWidth=["0","1","2","3"];this.makeBorderComboBoxHTML=function(c,d,f,e){try{var a="";a+='<div id="borderComboBoxContainer_'+c+'" class="'+g_strSkin_ComboBox_Area+'" style="width:'+f+'px;line-height:0;overflow:hidden;display:inline-block">';a+='<table style="border:0px;width:'+f+'px;line-height:0;table-layout:fixed;" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td class="tbComboBox_AreaLabel_1" style="line-height:0;height:14px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding:2px;">';
if(0==d)for(var b=0;b<this.arrBorderStyle.length;b++)a="double"==this.arrBorderStyle[b]?a+('<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="height:1px;border-top:3px '+this.arrBorderStyle[b]+' #000000;display:none;"></div>'):"noline"==this.arrBorderStyle[b]?a+('<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="display:none;">'+ID_RES_CONST_STRING_NO_LINE+"</div>"):a+('<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="height:1px;border-top:1px '+this.arrBorderStyle[b]+' #000000;display:none;"></div>');
else if(1==d)for(b=0;b<this.arrBorderWidth.length;b++)a+='<div id="borderComboBoxLabel_Sub_'+c+"_"+b+'" style="height:1px;border-top:'+this.arrBorderWidth[b]+'px solid #000000;display:none;"></div>';a+="</td>";a+='<td class="'+g_strSkin_ComboBox_AreaArrow+'" style="line-height:0;width:14px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;">';a+='<img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;">';
a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div id="borderComboBoxLayer_'+c+'" style="position:absolute;display:none;z-index:20032;">';a+='<table cellpadding=1 cellspacing=1 border=0 style="width:'+e+'px;border-collapse:separate;table-layout:auto;" class="'+g_strSkin_ComboBoxWin+'">';a+="<tr>";a+='<td style="line-height:normal;height:20px;border:0;">';a+='<table cellpadding=1 cellspacing=1 border=0 style="width:'+e+'px;border-collapse:separate;table-layout:auto;">';if(0==d)for(b=0;b<this.arrBorderStyle.length;b++)a+=
"<tr>",a+='<td style="line-height:normal;padding:1px;height:20px;border:0;">',a+='<table id="borderSubContainer_'+c+"_"+this.arrBorderStyle[b]+'" width="'+e+'px" height="20" cellpadding=1 cellspacing=1 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" style="border-collapse:collapse;">',a+="<tr>",a+='<td width="1" style="border:0;height:20px;"></td>',a+='<td id="borderSub_'+c+"_"+this.arrBorderStyle[b]+'" cusBorderIndex="'+b+'" style="line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;border:0;height:20px;">',
a="double"==this.arrBorderStyle[b]?a+('<div style="height:1px;border-top:3px '+this.arrBorderStyle[b]+' #000000;"></div>'):"noline"==this.arrBorderStyle[b]?a+('<div style="">'+ID_RES_CONST_STRING_NO_LINE+"</div>"):a+('<div style="height:1px;border-top:1px '+this.arrBorderStyle[b]+' #000000;"></div>'),a+="</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>";else if(1==d)for(b=0;b<this.arrBorderWidth.length;b++)a+="<tr>",a+='<td style="line-height:normal;padding:1px;height:18px;border:0;">',a+='<table id="borderSubContainer_'+
c+"_"+this.arrBorderWidth[b]+'" width="'+e+'px" height="18" cellpadding=1 cellspacing=1 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" style="border-collapse:collapse;">',a+="<tr>",a+='<td width="1" style="border:0;height:18px;"></td>',a+='<td id="borderSub_'+c+"_"+this.arrBorderWidth[b]+'" cusBorderIndex="'+b+'" style="line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;border:0;height:18px;">',a+='<div style="height:1px;border-top:'+this.arrBorderWidth[b]+
'px solid #000000;"></div>',a+="</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(g){dalert(g)}};this.initBorderComboBox=function(c,d,f){try{var e=g_objLayerKit.getElementById("borderComboBoxContainer_"+c);if(null!=e){var a=g_objLayerKit.getElementById("borderComboBoxLayer_"+c);if(null!=a)if(e.onmouseover=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_AreaOver)},e.onmouseout=function(b){""!=a.style.display&&
(this.className=g_strSkin_ComboBox_Area)},e.onmousedown=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_AreaDown)},e.onmouseup=function(b){""!=a.style.display&&(this.className=g_strSkin_ComboBox_Area)},e.onclick=function(a){h.showBorderComboBoxLayer(c)},g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_1").style.display="",0==d)for(var b=0;b<this.arrBorderStyle.length;b++){var g=g_objLayerKit.getElementById("borderSubContainer_"+c+"_"+this.arrBorderStyle[b]);g.onmouseover=
function(a){g_objComboBoxWin.fnComboBoxItemOver(this)};g.onmouseout=function(a){g_objComboBoxWin.fnComboBoxItemOut(this)};g_objLayerKit.getElementById("borderSub_"+c+"_"+this.arrBorderStyle[b]).onclick=function(a){h.clickBorderComboBoxLayer(this,c,d);"undefined"!=typeof f&&f(h.getSelectedBorderValue(c,d))}}else if(1==d)for(b=0;b<this.arrBorderWidth.length;b++)g=g_objLayerKit.getElementById("borderSubContainer_"+c+"_"+this.arrBorderWidth[b]),g.onmouseover=function(a){g_objComboBoxWin.fnComboBoxItemOver(this)},
g.onmouseout=function(a){g_objComboBoxWin.fnComboBoxItemOut(this)},g_objLayerKit.getElementById("borderSub_"+c+"_"+this.arrBorderWidth[b]).onclick=function(a){h.clickBorderComboBoxLayer(this,c,d);"undefined"!=typeof f&&f(h.getSelectedBorderValue(c,d))}}}catch(k){dalert(k)}};this.showBorderComboBoxLayer=function(c){try{var d=g_objLayerKit.getElementById("borderComboBoxContainer_"+c);if(null!=d){var f=g_objLayerKit.getElementById("borderComboBoxLayer_"+c);null!=f&&(""==f.style.display?(f.style.display=
"none",d.className=g_strSkin_ComboBox_Area):(f.style.display="",d.className=g_strSkin_ComboBox_AreaDown))}}catch(e){dalert(e)}};this.clickBorderComboBoxLayer=function(c,d,f){try{this.showBorderComboBoxLayer(d);var e=g_objPropertyUtil.getTargetCellFlag(c,"cusBorderIndex");if("double"==this.arrBorderStyle[e]){var a=g_objLayerKit.getElementById("txtBorderWidth")||g_objLayerKit.getElementById("txtFormBorderWidth");a&&3>a.value&&(a.value=3,g_objBorderSelectionUtil.setBorderWidth(3))}var b=this.getSubArrayObject(f);
if(null!=b)for(c=0;c<b.length;c++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+d+"_"+c).style.display=c==e?"":"none"}catch(g){dalert(g)}};this.getSelectedBorderValue=function(c,d){try{var f=this.getSubArrayObject(d);if(null==f)return"";for(d=0;d<f.length;d++)if(""==g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_"+d).style.display)return f[d];return""}catch(e){dalert(e)}};this.setSelectedBorderValue=function(c,d,f){try{var e=this.getSubArrayObject(d);if(null!=e)for(d=0;d<e.length;d++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+
c+"_"+d).style.display=e[d]==f?"":"none"}catch(a){dalert(a)}};this.setSelectedIndex=function(c,d,f){try{var e=this.getSubArrayObject(d);if(null!=e)for(d=0;d<e.length;d++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_"+d).style.display=d==f?"":"none"}catch(a){dalert(a)}};this.getSubArrayObject=function(c){try{if(COMBOBOX_TYPE_BORDER_STYLE==c)return this.arrBorderStyle;if(1==c)return this.arrBorderWidth}catch(d){dalert(d)}return null}};

var g_objBorderSelectionUtil=new function(){var h=this;this.bUseSelectRec=!1;this.arrID_SelectRec=["selectRec_0","selectRec_1","selectRec_2"];this.arrObjSelectRec=[];this.arrID_MainRec=["mainRec_0","mainRec_1","mainRec_2","mainRec_3"];this.arrObjMainRec=[];this.arrID_MiniRec="miniRec_h_0 miniRec_h_1 miniRec_h_2 miniRec_v_0 miniRec_v_1 miniRec_v_2".split(" ");this.arrObjMiniRec=[];this.bHide_MiniRec_v_1=this.bHide_MiniRec_h_1=!1;this.nBorderWidth=0;this.strBorderColor=this.strBorderStyle="";this.makeBorderSelectionHTML=
function(c,b,d,a){try{var e=2*b+2*d,f=parseInt(e/3),g=e+10;this.bUseSelectRec=1==c?!1:a;a="";a+='<div id="borderSelectionContainer" style="overflow:hidden;min-height:96px;display:inline-flex;align-items:center;">';a+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td colspan="2">';this.bUseSelectRec&&(a+=this.makeBorderSelectionHTML_selectRec(g));a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+=this.makeBorderSelectionHTML_mainRec(c,
b,d);a+="</td>";a+="<td>";a+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td style="height:'+f+'px;vertical-align:top;">';a+=this.makeBorderSelectionHTML_miniRec("miniRec_h_0",10,!0,0);a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="height:'+f+'px;vertical-align:middle;">';0==c&&(a+=this.makeBorderSelectionHTML_miniRec("miniRec_h_1",10,!0,1));a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="height:'+f+'px;vertical-align:bottom;">';
a+=this.makeBorderSelectionHTML_miniRec("miniRec_h_2",10,!0,2);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<table width="'+e+'"style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td align="left">';a+=this.makeBorderSelectionHTML_miniRec("miniRec_v_0",10,!1,0);a+="</td>";a+='<td align="center">';0==c&&(a+=this.makeBorderSelectionHTML_miniRec("miniRec_v_1",10,!1,1));a+="</td>";a+='<td align="right">';
a+=this.makeBorderSelectionHTML_miniRec("miniRec_v_2",10,!1,2);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="<td></td>";a+="</tr>";return a+"</table></div>"}catch(k){dalert(k)}};this.makeBorderSelectionHTML_selectRec=function(c){try{var b=parseInt((c-24)/3),d=parseInt(b/2);c=ID_RES_STRING_ALL;var a=ID_RES_STRING_OUTER,e=ID_RES_STRING_INNER,f="";f+='<table border="0" cellspacing="0" cellpadding="0">';f+="<tr>";f+='<td width="'+b+'">';f+='<table id="selectRec_0" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+="</tr>";f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+="</tr>";f+="</table>";f+="</td>";f+='<td width="12"></td>';f+='<td width="'+b+'" align="center">';f+='<table id="selectRec_1" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_1" title="'+a+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_2" title="'+a+'"></td>';f+="</tr>";f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_3" title="'+a+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_4" title="'+a+'"></td>';f+="</tr>";f+="</table>";f+="</td>";f+='<td width="12"></td>';f+='<td width="'+b+'" align="right">';f+='<table id="selectRec_2" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_1" title="'+e+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_2" title="'+e+'"></td>';f+="</tr>";f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_3" title="'+e+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_4" title="'+e+'"></td>';f+="</tr>";f+="</table>";f+="</td>";f+="</tr>";f+="<tr>";f+='<td colspan="5" height="14"></td>';return f+"</tr></table>"}catch(g){dalert(g)}};
this.makeBorderSelectionHTML_mainRec=function(c,b,d){try{var a="";a+='<table style="border-collapse:collapse;table-layout:fixed;min-height: 80px;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td class="b_s_out_left_top" style="width:'+b+"px;height:"+b+'px;"></td>';a+='<td style="width:'+d+"px;height:"+b+'px;"></td>';a+='<td style="width:'+d+"px;height:"+b+'px;"></td>';a+='<td class="b_s_out_right_top" style="width:'+b+"px;height:"+b+'px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="height:'+
d+'px;"></td>';0==c?(a+='<td id="mainRec_0" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>',a+='<td id="mainRec_1" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>'):(a+='<td id="mainRec_0" class="b_s_in_left b_s_in_top" style="height:'+d+'px;"></td>',a+='<td id="mainRec_1" class="b_s_in_right b_s_in_top" style="height:'+d+'px;"></td>');a+='<td style="height:'+d+'px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="height:'+
d+'px;"></td>';0==c?(a+='<td id="mainRec_2" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>',a+='<td id="mainRec_3" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>'):(a+='<td id="mainRec_2" class="b_s_in_left b_s_in_bottom" style="height:'+d+'px;"></td>',a+='<td id="mainRec_3" class="b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>');a+='<td style="height:'+d+'px;"></td>';a+="</tr>";a+="<tr>";a+='<td class="b_s_out_left_bottom" style="height:'+
b+'px;"></td>';a+='<td style="height:'+b+'px;"></td>';a+='<td style="height:'+b+'px;"></td>';a+='<td class="b_s_out_right_bottom" style="height:'+b+'px;"></td>';return a+"</tr></table>"}catch(e){dalert(e)}};this.makeBorderSelectionHTML_miniRec=function(c,b,d,a){try{var e="";e+='<table id="'+c+'" class="b_s_mini" style="border-collapse:separate;table-layout:fixed;cursor:pointer;border-spacing:2px;" border="0" cellspacing="2" cellpadding="0">';d?0==a?(e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #000000;"></td>',
e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>"):1==a?(e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #000000;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',
e+="</tr>"):2==a&&(e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #000000;"></td>',e+="</tr>"):(e+="<tr>",0==a?(e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #000000;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+
b+'px;border-left:1px solid #c5c5c5;"></td>'):1==a?(e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #000000;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>'):2==a&&(e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #000000;"></td>'),
e+="</tr>");return e+"</table>"}catch(f){dalert(f)}};this.initBorderSelection=function(){try{this.bHide_MiniRec_v_1=this.bHide_MiniRec_h_1=!1;this.nBorderWidth=0;this.strBorderColor=this.strBorderStyle="";if(this.bUseSelectRec)for(var c=0;c<this.arrID_SelectRec.length;c++)this.arrObjSelectRec[c]=g_objLayerKit.getElementById(this.arrID_SelectRec[c]),this.arrObjSelectRec[c].onclick=function(b){h.clickSelectRec(this)};for(c=0;c<this.arrID_MainRec.length;c++)this.arrObjMainRec[c]=g_objLayerKit.getElementById(this.arrID_MainRec[c]);
for(c=0;c<this.arrID_MiniRec.length;c++){var b=g_objLayerKit.getElementById(this.arrID_MiniRec[c]);null==b?this.arrObjMiniRec[c]=null:(this.arrObjMiniRec[c]=b,b.onclick=function(){h.clickMiniRec(this)})}}catch(d){dalert(d)}};this.initPropTagTableCellStyleBorder=function(c){try{if(c){var b=c[0][0],d=c[0][1];b||d?!b&&d?this.hideMiniRec("miniRec_h_1"):b&&!d&&this.hideMiniRec("miniRec_v_1"):(this.hideMiniRec("miniRec_h_1"),this.hideMiniRec("miniRec_v_1"));var a=c[1];c="";b=0;for(var e=d="",f=0;f<a.length;f++)c=
2>=f?"h":"v",b=f%3,d="miniRec_"+c+"_"+b,e="bHide_MiniRec_"+c+"_"+b,!0!==this[e]&&(a[f]&&a[f]!==ID_PROP_BORDER_DUPLICATED?this.setChecked_borderValue(d,!1,a[f]):this.setChecked_borderValue(d,!1,""));this.updateSelectRec()}}catch(g){dalert(g)}};this.setBorderWidth=function(c){try{g_objPropTagCommon.setSelectedTableCustomStyle(),this.nBorderWidth=c}catch(b){dalert(b)}};this.setBorderStyle=function(c){try{g_objPropTagCommon.setSelectedTableCustomStyle(),this.strBorderStyle=c}catch(b){dalert(b)}};this.setBorderColor=
function(c){try{g_objPropTagCommon.setSelectedTableCustomStyle(),this.strBorderColor=c}catch(b){dalert(b)}};this.getBorderString=function(){try{return"noline"==this.strBorderStyle?"0px solid #000000":""==this.strBorderColor?this.nBorderWidth+"px none":this.nBorderWidth+"px "+this.strBorderStyle+" "+this.strBorderColor}catch(c){dalert(c)}};this.getMiniRecBorderString=function(c){return c?this.getBorderValue(c.id):""};this.clickSelectRec=function(c){try{if(this.bUseSelectRec){g_objPropTagCommon.setSelectedTableCustomStyle();
for(var b=c.id,d=-1,a=!1,e=0;e<this.arrID_SelectRec.length;e++)this.arrID_SelectRec[e]==b?(d=e,this.select(c),a=!0):this.isSelected(this.arrObjSelectRec[e])&&this.deselect(this.arrObjSelectRec[e]);a?0==d?(this.setChecked(this.arrID_MiniRec[0],!0),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!0),this.setChecked(this.arrID_MiniRec[2],!0),this.setChecked(this.arrID_MiniRec[3],!0),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!0),this.setChecked(this.arrID_MiniRec[5],
!0)):1==d?(this.setChecked(this.arrID_MiniRec[0],!0),this.setChecked(this.arrID_MiniRec[2],!0),this.setChecked(this.arrID_MiniRec[3],!0),this.setChecked(this.arrID_MiniRec[5],!0)):2==d&&(this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!0),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!0)):(this.setChecked(this.arrID_MiniRec[0],!1),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!1),this.setChecked(this.arrID_MiniRec[2],!1),this.setChecked(this.arrID_MiniRec[3],
!1),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!1),this.setChecked(this.arrID_MiniRec[5],!1))}}catch(f){dalert(f)}};this.isSelected=function(c){return g_objPropertyUtil.hasClass(c,"b_s_rec_selected")};this.select=function(c,b){return!1===b?this.deselect(c):g_objPropertyUtil.addClass(c,"b_s_rec_selected")};this.deselect=function(c){return g_objPropertyUtil.removeClass(c,"b_s_rec_selected")};this.updateSelectRec=function(){try{if(this.bUseSelectRec){for(var c=[],b=0;b<this.arrObjMiniRec.length;b++){if(1==
b){if(this.bHide_MiniRec_h_1){c[b]=!0;continue}}else if(4==b&&this.bHide_MiniRec_v_1){c[b]=!0;continue}this.isSelected(this.arrObjMiniRec[b])?c[b]=!0:c[b]=!1}var d=-1;1==c[0]&&1==c[1]&&1==c[2]&&1==c[3]&&1==c[4]&&1==c[5]&&this.checkAll()?d=0:1==c[0]&&0==c[1]&&1==c[2]&&1==c[3]&&0==c[4]&&1==c[5]&&this.checkOuter()?d=1:0==c[0]&&1==c[1]&&0==c[2]&&0==c[3]&&1==c[4]&&0==c[5]&&this.checkInner()&&(d=2);for(b=0;b<this.arrObjSelectRec.length;b++)b==d?this.isSelected(this.arrObjSelectRec[b])||this.select(this.arrObjSelectRec[b]):
this.isSelected(this.arrObjSelectRec[b])&&this.deselect(this.arrObjSelectRec[b])}}catch(a){dalert(a)}};this.clickMiniRec=function(c){try{var b=!1,d=this.getBorderString(),a=this.getMiniRecBorderString(c);b=this.compareBorderString(d,a)?!1:!0;this.doClickMiniRec(c,b);this.select(c,b);this.bUseSelectRec&&this.updateSelectRec()}catch(e){dalert(e)}};this.rightDiv=this.leftDiv=null;this.compareBorderString=function(c,b){try{var d=this.leftDiv,a=this.rightDiv;null===d&&(this.leftDiv=d=document.createElement("div"));
null===a&&(this.rightDiv=a=document.createElement("div"));var e=d.style,f=a.style;e.border=c;f.border=b;return e.borderWidth===f.borderWidth&&e.borderStyle===f.borderStyle&&e.borderColor===f.borderColor?!0:!1}catch(g){dalert(g)}};this.doClickMiniRec=function(c,b){try{g_objPropTagCommon.setSelectedTableCustomStyle();var d="";b&&(d=this.getBorderString());this.setMiniRecBorder(c.id,d)}catch(a){dalert(a)}};this.getBorderSelectionMiniRecById=function(c){try{for(var b=0;b<this.arrID_MiniRec.length;b++)if(this.arrID_MiniRec[b]==
c)return this.arrObjMiniRec[b]}catch(d){dalert(d)}return null};this.getBorderValue=function(c){try{var b=null,d="";this.arrID_MiniRec[0]===c?(b=this.arrObjMainRec[0],d=b.style.borderTopWidth+" "+b.style.borderTopStyle+" "+b.style.borderTopColor):this.arrID_MiniRec[1]===c?(b=this.arrObjMainRec[0],d=b.style.borderBottomWidth+" "+b.style.borderBottomStyle+" "+b.style.borderBottomColor):this.arrID_MiniRec[2]===c?(b=this.arrObjMainRec[2],d=b.style.borderBottomWidth+" "+b.style.borderBottomStyle+" "+b.style.borderBottomColor):
this.arrID_MiniRec[3]===c?(b=this.arrObjMainRec[0],d=b.style.borderLeftWidth+" "+b.style.borderLeftStyle+" "+b.style.borderLeftColor):this.arrID_MiniRec[4]==c?(b=this.arrObjMainRec[0],d=b.style.borderRightWidth+" "+b.style.borderRightStyle+" "+b.style.borderRightColor):this.arrID_MiniRec[5]==c&&(b=this.arrObjMainRec[1],d=b.style.borderRightWidth+" "+b.style.borderRightStyle+" "+b.style.borderRightColor);return d.trim()}catch(a){dalert(a)}return""};this.getChecked=function(c){try{var b=this.getBorderSelectionMiniRecById(c);
return null==b?null:g_objPropertyUtil.element_hasClass(b,"b_s_rec_selected")?!0:!1}catch(d){dalert(d)}return null};this.setChecked=function(c,b){try{var d=this.getBorderSelectionMiniRecById(c);null!=d&&(b?this.isSelected(d)||this.select(d):this.isSelected(d)&&this.deselect(d),this.doClickMiniRec(d,b))}catch(a){dalert(a)}};this.hideMiniRec=function(c){try{if(c==this.arrID_MiniRec[1]||c==this.arrID_MiniRec[4]){var b=this.getBorderSelectionMiniRecById(c);if(null==b)return null;b.style.display="none";
b=g_objPropertyUtil;var d=g_objTableUtil,a=function(a,b,c){return d.getTableCellElement(a,b,c)};c==this.arrID_MiniRec[1]?(this.bHide_MiniRec_h_1=!0,b.removeClass(this.arrObjMainRec[0],"b_s_in_bottom"),b.removeClass(this.arrObjMainRec[1],"b_s_in_bottom"),b.removeClass(this.arrObjMainRec[2],"b_s_in_top"),b.removeClass(this.arrObjMainRec[3],"b_s_in_top"),a(this.arrObjSelectRec[0],0,0).style.borderBottom="0px",a(this.arrObjSelectRec[0],0,1).style.borderBottom="0px",a(this.arrObjSelectRec[0],1,0).style.borderTop=
"0px",a(this.arrObjSelectRec[0],1,1).style.borderTop="0px",a(this.arrObjSelectRec[1],0,0).style.borderBottom="0px",a(this.arrObjSelectRec[1],0,1).style.borderBottom="0px",a(this.arrObjSelectRec[1],1,0).style.borderTop="0px",a(this.arrObjSelectRec[1],1,1).style.borderTop="0px",a(this.arrObjSelectRec[2],0,0).style.borderBottom="0px",a(this.arrObjSelectRec[2],0,1).style.borderBottom="0px",a(this.arrObjSelectRec[2],1,0).style.borderTop="0px",a(this.arrObjSelectRec[2],1,1).style.borderTop="0px"):c==this.arrID_MiniRec[4]&&
(this.bHide_MiniRec_v_1=!0,b.removeClass(this.arrObjMainRec[0],"b_s_in_right"),b.removeClass(this.arrObjMainRec[1],"b_s_in_left"),b.removeClass(this.arrObjMainRec[2],"b_s_in_right"),b.removeClass(this.arrObjMainRec[3],"b_s_in_left"),a(this.arrObjSelectRec[0],0,0).style.borderRight="0px",a(this.arrObjSelectRec[0],0,1).style.borderLeft="0px",a(this.arrObjSelectRec[0],1,0).style.borderRight="0px",a(this.arrObjSelectRec[0],1,1).style.borderLeft="0px",a(this.arrObjSelectRec[1],0,0).style.borderRight="0px",
a(this.arrObjSelectRec[1],0,1).style.borderLeft="0px",a(this.arrObjSelectRec[1],1,0).style.borderRight="0px",a(this.arrObjSelectRec[1],1,1).style.borderLeft="0px",a(this.arrObjSelectRec[2],0,0).style.borderRight="0px",a(this.arrObjSelectRec[2],0,1).style.borderLeft="0px",a(this.arrObjSelectRec[2],1,0).style.borderRight="0px",a(this.arrObjSelectRec[2],1,1).style.borderLeft="0px");this.bHide_MiniRec_h_1&&this.bHide_MiniRec_v_1&&(this.arrObjSelectRec[1].style.display="none",this.arrObjSelectRec[2].style.display=
"none")}}catch(e){dalert(e)}};this.setChecked_borderValue=function(c,b,d){try{var a=this.getBorderSelectionMiniRecById(c);null!=a&&(g_objPropTagCommon.setSelectedTableCustomStyle(),b?this.isSelected(a)||this.select(a):this.isSelected(a)&&this.deselect(a),this.setMiniRecBorder(c,d))}catch(e){dalert(e)}};this.setMiniRecBorder=function(c,b){try{var d=this.arrID_MiniRec,a=this.arrObjMainRec;d[0]==c?(a[0].style.borderTop=b,a[1].style.borderTop=b):d[1]==c?(a[0].style.borderBottom=b,a[1].style.borderBottom=
b,a[2].style.borderTop=b,a[3].style.borderTop=b):d[2]==c?(a[2].style.borderBottom=b,a[3].style.borderBottom=b):d[3]==c?(a[0].style.borderLeft=b,a[2].style.borderLeft=b):d[4]==c?(a[0].style.borderRight=b,a[2].style.borderRight=b,a[1].style.borderLeft=b,a[3].style.borderLeft=b):d[5]==c&&(a[1].style.borderRight=b,a[3].style.borderRight=b)}catch(e){dalert(e)}};this.checkAll=function(){try{var c=this.arrObjMainRec[0].style.borderTop,b=this.arrObjMainRec[0].style.borderBottom,d=this.arrObjMainRec[0].style.borderLeft,
a=this.arrObjMainRec[0].style.borderRight,e=this.arrObjMainRec[1].style.borderRight;return c!==this.arrObjMainRec[2].style.borderBottom||c!==d||c!==e||!this.bHide_MiniRec_h_1&&c!==b||!this.bHide_MiniRec_v_1&&c!==a?!1:!0}catch(f){dalert(f)}};this.checkOuter=function(){try{var c=this.arrObjMainRec[0].style.borderTop,b=this.arrObjMainRec[0].style.borderLeft,d=this.arrObjMainRec[1].style.borderRight;return c===this.arrObjMainRec[2].style.borderBottom&&c===b&&c===d?!0:!1}catch(a){dalert(a)}};this.checkInner=
function(){try{return this.arrObjMainRec[0].style.borderBottom===this.arrObjMainRec[0].style.borderRight?!0:!1}catch(c){dalert(c)}}};

var colorComboBoxUtil=function(){var e=this;this.strDisabledColor="#dedede";colorComboBoxUtil.prototype.makeColorComboBoxHTML=function(b,c){try{var a="";a+='<div id="colorComboBoxContainer_'+b+'" class="'+g_strSkin_ComboBox_Area+'" style="width:'+c+'px;line-height:0;overflow:hidden;display:inline-block">';a+='<table style="border:0px;width:'+c+'px;line-height:0;table-layout:fixed;" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td id="colorComboBoxLabel_'+b+'" class="tbComboBox_AreaLabel_1" style="line-height:0;height:14px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding:3px;">';
a+='<div id="colorComboBoxLabel_Sub_'+b+'" style="height:10px;background-color:#000000;border:1px dotted #000000;"></div>';a+="</td>";a+='<td class="'+g_strSkin_ComboBox_AreaArrow+'" style="line-height:0;width:14px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;">';a+='<img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;">';a+="</td>";a+="</tr>";return a+"</table></div>"}catch(d){dalert(d)}};
colorComboBoxUtil.prototype.initColorComboBox=function(b,c,a){try{var d=g_objLayerKit.getElementById("colorComboBoxContainer_"+b);null!=d&&(d.onmouseover=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_AreaOver)},d.onmouseout=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_Area)},d.onmousedown=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_AreaDown)},
d.onmouseup=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_Area)},d.onclick=function(d){"undefined"==typeof a&&(a=[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR]);g_objPropertyUtil.element_hasClass(this,"disableStatus")||duzon_dialog.viewExtendsDlg(this,g_nActiveEditNumber,function(a){duzon_dialog.closeExtendsDlg();e.clickColorComboBoxLayer(b,a);"undefined"!=typeof c&&c(a)},a,[function(a){duzon_dialog.closeExtendsDlg();e.clickColorComboBoxLayer(b,
"");"undefined"!=typeof c&&c("")},function(a){a=e.getColorValue(b);duzon_dialog.viewDetailColorPicker(a,function(a){""!=a&&(duzon_dialog.closeExtendsDlg(),e.clickColorComboBoxLayer(b,a),"undefined"!=typeof c&&c(a))})}],"",!1)})}catch(f){dalert(f)}};colorComboBoxUtil.prototype.clickColorComboBoxLayer=function(b,c){try{g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+b).style.backgroundColor=c}catch(a){dalert(a)}};colorComboBoxUtil.prototype.getColorValue=function(b){try{var c=g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+
b).style.backgroundColor;return g_objCommonUtil.getHexColorCode(c)}catch(a){dalert(a)}};colorComboBoxUtil.prototype.setColorValue=function(b,c){try{g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+b).style.backgroundColor=c}catch(a){dalert(a)}};colorComboBoxUtil.prototype.setActive=function(b,c){try{var a=g_objLayerKit.getElementById("colorComboBoxContainer_"+b);if(null!=a){var d=g_objLayerKit.getElementById("colorComboBoxLabel_"+b);null!=d&&(c?(a.style.backgroundColor="",d.style.backgroundColor=
"",g_objPropertyUtil.applyFilterOpacityStyle(a,!1,-1),g_objPropertyUtil.element_hasClass(a,"disableStatus")&&g_objPropertyUtil.element_removeClass(a,"disableStatus")):(a.style.backgroundColor=this.strDisabledColor,d.style.backgroundColor=this.strDisabledColor,g_objPropertyUtil.applyFilterOpacityStyle(a,!0,4),g_objPropertyUtil.element_hasClass(a,"disableStatus")||g_objPropertyUtil.element_addClass(a,"disableStatus")))}}catch(f){dalert(f)}}},g_objColorComboBoxUtil=new colorComboBoxUtil;

var nOutlineCount=0,outlineUtil=function(){this.arrStrID_Outline_Line=this.arrStrID_Outline_Rectangle=this.arrObjContainer=this.rootContaienr=this.arrObj_Outline_Line=this.arrObj_Outline_Rectangle=null;this.nOutline_Basis_Min_Line=6;this.nOutline_Basis_Min_Center_Rectangle=30;this.bSkipSolidDotted=!1;this.indicatorWidth=7;this.bResizeAllowed=!0;outlineUtil.prototype.initializeExtOutline=function(a){try{var b=g_objLayerKit.getElementById("dze_outline_image");null!==b&&b.parentNode.removeChild(b);var d=
!1;a&&dzeEnvConfig.iFrameLayer&&(g_objLayerKit.getLayerDocument(),d=!0);this.arrObj_Outline_Rectangle=[];for(a=0;8>a;a++)this.arrObj_Outline_Rectangle[a]=null;this.arrObj_Outline_Line=[];for(a=0;4>a;a++)this.arrObj_Outline_Line[a]=null;this.arrObjContainer=[];var c=g_objCommonUtil.getTimeCodeString()+"_"+nOutlineCount;nOutlineCount++;this.arrStrID_Outline_Rectangle=[];for(a=0;8>a;a++)this.arrStrID_Outline_Rectangle[a]="outline_rect_"+c+"_"+a;this.arrStrID_Outline_Line=[];for(a=0;4>a;a++)this.arrStrID_Outline_Line[a]=
"outline_line_"+c+"_"+a;c="";b=g_bDocType_XHTML;var e=!0;g_bBrowserType_IE&&6>=g_bBrowserVerInfo&&(e=!1);g_bBrowserType_IE&&!b&&(e=!1);var k=g_objInsertUtil.insertLayerHTML('<div id="dze_outline_image"></div>',d);this.rootContaienr=k;var l=function(a,b,c){a=g_objInsertUtil.insertLayerHTML(a,d);k.appendChild(a);if(!a)return a;var e=void 0===a.children[0]?a:a.children[0];"line"===c?this.arrObj_Outline_Line[b]=e:this.arrObj_Outline_Rectangle[b]=e;return this.arrObjContainer.push(a)}.bind(this);for(a=
0;8>a;a++)if(c=e?'<div id="'+this.arrStrID_Outline_Rectangle[a]+'" style="display:none;position:absolute;z-index:20008;width:'+this.indicatorWidth+"px;height:"+this.indicatorWidth+'px;border:1px solid #7F7F7F;background-color:#ffffff"></div>':'<img id="'+this.arrStrID_Outline_Rectangle[a]+'" src="'+g_strBlankImageData+'" width="5" height="5" border="0" alt="" style="display:none;position:absolute;z-index:20008;width:5px;height:5px;border:1px solid #7F7F7F;background-color:#ffffff;" />',!l(c,a,"rect"))return;
for(a=0;4>a&&(c=0==a||2==a?e?'<div id="'+this.arrStrID_Outline_Line[a]+'" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:1px solid #7F7F7F;border-top:0px;border-right:0px;border-bottom:0px;"></div>':'<img id="'+this.arrStrID_Outline_Line[a]+'" src="'+g_strBlankImageData+'" alt="" style="display:none;position:absolute;z-index:20007;width:1px;border-left:1px solid #7F7F7F;border-top:0px;border-right:0px;border-bottom:0px;" />':e?'<div id="'+this.arrStrID_Outline_Line[a]+
'" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:0px;border-top:1px solid #7F7F7F;border-right:0px;border-bottom:0px;"></div>':'<img id="'+this.arrStrID_Outline_Line[a]+'" src="'+g_strBlankImageData+'" alt="" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:0px;border-top:1px solid #7F7F7F;border-right:0px;border-bottom:0px;"></div>',l(c,a,"line"));a++);}catch(h){dalert(h)}};outlineUtil.prototype.finalize=outlineUtil.prototype.unload=
function(){try{var a=this.arrObjContainer;if(a){for(var b=null,d=a.length-1;0<=d;d--)(b=a[d])&&b.parentNode&&b.parentNode.removeChild(b);this.arrObjContainer=null}}catch(c){dalert(c)}};outlineUtil.prototype.getDocument=function(){return this.rootContaienr?this.rootContaienr.ownerDocument:document};outlineUtil.prototype.showExtOutline=function(a,b,d,c,e,k,l,h,n){try{for(var f=0;8>f;f++)if(null==this.arrObj_Outline_Rectangle[f])return!1;for(f=0;4>f;f++){if(null==this.arrObj_Outline_Line[f])return!1;
this.bSkipSolidDotted||(this.arrObj_Outline_Line[f].style.borderStyle=d?"dotted":"solid")}if(a){var g=this.indicatorWidth/2;g+=1;a=null;a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP];a.style.left=c-g+"px";a.style.top=e-g+"px";a.style.display="";a.style.backgroundColor="#ffffff";a.style.cursor=this.bResizeAllowed?"NW-resize":"not-allowed";a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP];a.style.left=k-g+"px";a.style.top=e-g+"px";a.style.display="";a.style.backgroundColor="#ffffff";
a.style.cursor=this.bResizeAllowed?"NE-resize":"not-allowed";a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM];a.style.left=k-g+"px";a.style.top=l-g+"px";a.style.display="";h?(a.style.backgroundColor="#ffffff",a.style.cursor=this.bResizeAllowed?"NW-resize":"not-allowed"):(a.style.backgroundColor="#c0c0c0",a.style.cursor="default");a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM];a.style.left=c-g+"px";a.style.top=l-g+"px";a.style.display="";a.style.backgroundColor="#ffffff";
a.style.cursor=this.bResizeAllowed?"SW-resize":"not-allowed";h=k-c;d=l-e;if(h>this.nOutline_Basis_Min_Center_Rectangle){var m=c+h/2;a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP];a.style.left=m-g+"px";a.style.top=e-g+"px";a.style.display="";a.style.backgroundColor="#ffffff";a.style.cursor=this.bResizeAllowed?"N-resize":"not-allowed";a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM];a.style.left=m-g+"px";a.style.top=l-g+"px";a.style.display="";a.style.backgroundColor="#ffffff";a.style.cursor=
this.bResizeAllowed?"S-resize":"not-allowed"}else this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.display="none",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.display="none";d>this.nOutline_Basis_Min_Center_Rectangle?(m=e+d/2,a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT],a.style.left=k-g+"px",a.style.top=m-g+"px",a.style.display="",n?(a.style.backgroundColor="#ffffff",a.style.cursor=this.bResizeAllowed?"E-resize":"not-allowed"):(a.style.backgroundColor="#c0c0c0",
a.style.cursor="default"),a=this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT],a.style.left=c-g+"px",a.style.top=m-g+"px",a.style.display="",a.style.backgroundColor="#ffffff",a.style.cursor=this.bResizeAllowed?"W-resize":"not-allowed"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.display="none",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.display="none");d>this.nOutline_Basis_Min_Line?(b?(this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.top=
e+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.width="1px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.height=d-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.width="1px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.height=d+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.display=
"none";h>this.nOutline_Basis_Min_Line?(b?(this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.left=c+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.width=h-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.width=h+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.display=
"none";d>this.nOutline_Basis_Min_Line?(b?(this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.left=k-1+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.top=e+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.height=d-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.left=k+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.height=d+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.display=
""):this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.display="none";h>this.nOutline_Basis_Min_Line?(b?(this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.left=c+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.top=l-1+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.width=h-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.top=l+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.width=
h+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.display="none";if(!b)for(f=0;8>f;f++)this.arrObj_Outline_Rectangle[f].style.display="none"}else{for(f=0;8>f;f++)this.arrObj_Outline_Rectangle[f].style.display="none";for(f=0;4>f;f++)this.arrObj_Outline_Line[f].style.display="none"}}catch(p){dalert(p)}};outlineUtil.prototype.setZIndexExtOutline=function(a){this.setZIndexExtOutlineRect(a);this.setZIndexExtOutlineLine(a)};outlineUtil.prototype.setZIndexExtOutlineRect=
function(a){try{for(var b=0;8>b;b++)this.arrObj_Outline_Rectangle[b].style.zIndex=a}catch(d){dalert(d)}};outlineUtil.prototype.setZIndexExtOutlineLine=function(a){try{for(var b=0;4>b;b++)this.arrObj_Outline_Line[b].style.zIndex=a}catch(d){dalert(d)}};outlineUtil.prototype.setExtOutlineBorder=function(a){try{if(a&&12===a.length){this.bSkipSolidDotted=!0;for(var b=0;4>b;b++){var d=b%4*3,c=0===b%2?"Left":"Top",e=a[d],k=a[d+1],l=a[d+2];"hidden"===k?(this.arrObj_Outline_Line[b].style["border"+c+"Width"]=
"2px",this.arrObj_Outline_Line[b].style["border"+c+"Style"]="dashed",this.arrObj_Outline_Line[b].style["border"+c+"Color"]="#c5c5c5"):(this.arrObj_Outline_Line[b].style["border"+c+"Width"]=""===e?"0px":e,this.arrObj_Outline_Line[b].style["border"+c+"Style"]="noline"===k?"none":k,this.arrObj_Outline_Line[b].style["border"+c+"Color"]=l)}}}catch(h){dalert(h)}}};

var g_objCaretUtil=new function(){this.CARET_MARKER="dze_caret_marker";this.CARET_MARKER_START="dze_caret_marker_start";this.CARET_MARKER_END="dze_caret_marker_end";this.arrCaretMarkerClassName=[this.CARET_MARKER,this.CARET_MARKER_START,this.CARET_MARKER_END];this.ID_CURRENT_CARET="dze_page_caret_current_position";this.DZE_ONTEXT="dze_ontext";this.DZE_ONINPUT="dze_oninput";this.DZE_PAIR="dze_pair";this.nEditNumber=0;this.DEFAULT_SCROLL_MARGIN=60;this.bComposing=!1;this.arrCaretElementName=["IMG",
"EMBED","OBJECT","BR"];this.arrNotMarkerClassName=["dze_page_container","dze_document_container","dze_document_main_container"];this.isComposing=function(a){try{return a&&"undefined"!==typeof a.isComposing?a.isComposing:this.bComposing}catch(c){dalert(c)}};this.isCollapsed=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var c=g_objEditWindow[a];return(c?c.getSelection():null).isCollapsed?!0:!1}catch(b){dalert(b)}};this.removeMarkerAttribute=function(a){try{if(a&&"SPAN"===a.nodeName){var c=
g_objNodeUtil,b=g_objPropertyUtil,d=a.id;d&&0<=d.indexOf("caret")&&c.removeAttribute(a,"id");b.removeClass(a,this.CARET_MARKER);b.removeClass(a,this.CARET_MARKER_START);b.removeClass(a,this.CARET_MARKER_END);c.removeAttribute(a,this.DZE_ONTEXT);c.removeAttribute(a,this.DZE_PAIR);return!0}}catch(e){dalert(e)}};this.removeAllCaretMarker=function(a){try{if(a){var c=a.querySelectorAll("span."+this.CARET_MARKER+", span."+this.CARET_MARKER_START+", span."+this.CARET_MARKER_END);forEach(c,function(a,c){c&&
c.parentNode&&(c.firstChild?this.removeMarkerAttribute(c):c.parentNode.removeChild(c))},this)}}catch(b){dalert(b)}};this.insertCaretMarker=function(a,c,b){try{if(!a||!c)return null;var d=a.commonAncestorContainer;if(!d)return null;var e=d.ownerDocument;if(!e)return null;var h=a.startContainer,g=a.endContainer;if(h&&"TR"===h.nodeName||g&&"TR"===g.nodeName)return null;var f=d=null,k=a.cloneRange(),n=h&&3===h.nodeType,q=g&&3===g.nodeType;"undefined"!==typeof b&&k.collapse(b);b=null;var l=k.collapsed;
if(l){f=e.createElement("span");f.id=c;f.className=this.CARET_MARKER;f.setAttribute(this.DZE_ONTEXT,q);!1===fnObjectCheckNull(a.startContainer.classList)&&!0===a.startContainer.classList.contains("dze_shape_main")&&k.selectNode(a.startContainer);var m=a.startContainer.childNodes[a.startOffset]||a.startContainer;g_objNodeUtil.isTextArea(m)&&f.setAttribute(this.DZE_ONINPUT,m.selectionStart+","+m.selectionEnd)}else{var r=g_objCommonUtil.getUniqueID();d=e.createElement("span");d.id=c;d.className=this.CARET_MARKER_START;
d.setAttribute(this.DZE_PAIR,r);d.setAttribute(this.DZE_ONTEXT,n);k.collapse(!0);k.insertNode(d);(b=d.nextSibling)&&3===b.nodeType&&""===b.nodeValue&&b.parentNode.removeChild(b);f=e.createElement("span");f.id=c;f.className=this.CARET_MARKER_END;f.setAttribute(this.DZE_PAIR,r);f.setAttribute(this.DZE_ONTEXT,q);k=a.cloneRange();k.collapse(!1)}k.insertNode(f);(b=f.nextSibling)&&3===b.nodeType&&""===b.nodeValue&&b.parentNode.removeChild(b);return{start:d,end:f,collapsed:l}}catch(u){dalert(u)}};this.removeCaretMarker=
function(a,c,b){try{if(!a||!c)return null;var d=g_objEditorDocument[this.nEditNumber];if(!d)return null;var e=b?b:d.getElementById(c);if(!e)return null;b=g_objNodeUtil;var h=this,g=e.className&&e.className!==this.CARET_MARKER?!1:!0,f=e.className===this.CARET_MARKER_START?!0:!1,k=null;g||(k=d.querySelector("#"+c+"."+(f?this.CARET_MARKER_END:this.CARET_MARKER_START)))||(g=!0);c=function(a,b){1===b.textNode.nodeType&&inArray(b.textNode.nodeName,h.arrCaretElementName)?a.setStartAfter(b.textNode):a.setStart(b.textNode,
b.textOffset)};var n=function(a,b){1===b.textNode.nodeType&&inArray(b.textNode.nodeName,h.arrCaretElementName)?a.setEndAfter(b.textNode):a.setEnd(b.textNode,b.textOffset)},q={result:!0,inputSelection:null};if(g)if(this.isExistOnText(e)){var l=e.parentNode;a.selectNodeContents(l);a.setEndAfter(e);var m=this.getTextCountInRange(a);e.parentNode.removeChild(e);b.normalize(l);a.selectNodeContents(l);q=this.getTextNodeFromOffset(m,a);c(a,q);a.collapse(!0)}else q.inputSelection=this.getInputSelection(e),
a.selectNode(e),a.deleteContents();else{g=f?e:k;e=f?k:e;var r=this.isExistOnText(g),u=this.isExistOnText(e),v=g.parentNode,w=e.parentNode;k=f=0;var p=m=l=null,t=null;r&&u?(a.selectNodeContents(v),a.setEndAfter(g),f=this.getTextCountInRange(a),a.selectNodeContents(w),a.setEndAfter(e),k=this.getTextCountInRange(a),v.removeChild(g),w.removeChild(e),b.normalize(v),b.normalize(w),a.selectNodeContents(v),l=this.getTextNodeFromOffset(f,a),a.selectNodeContents(w),m=this.getTextNodeFromOffset(k,a),c(a,l),
n(a,m)):r&&!u?(a.selectNodeContents(v),a.setEndAfter(g),f=this.getTextCountInRange(a),v.removeChild(g),b.normalize(v),t=d.createRange(),t.selectNode(e),t.deleteContents(),a.selectNodeContents(v),l=this.getTextNodeFromOffset(f,a),c(a,l),a.setEnd(t.endContainer,t.endOffset)):!r&&u?(a.selectNodeContents(w),a.setEndAfter(e),k=this.getTextCountInRange(a),w.removeChild(e),b.normalize(w),p=d.createRange(),p.selectNode(g),p.deleteContents(),a.selectNodeContents(w),m=this.getTextNodeFromOffset(k,a),a.setStart(p.startContainer,
p.startOffset),n(a,m)):(p=d.createRange(),p.selectNode(g),p.deleteContents(),t=d.createRange(),t.selectNode(e),t.deleteContents(),a.setStart(p.startContainer,p.startOffset),a.setEnd(t.endContainer,t.endOffset));t=p=null}return q}catch(x){dalert(x)}};this.isExistOnText=function(a){try{if(!a)return!1;var c="true"===a.getAttribute(this.DZE_ONTEXT)?!0:!1,b=a.previousSibling,d=a.nextSibling;a=null;var e=g_objNodeUtil;b&&3===b.nodeType&&!e.isIgnorable(b)?a=b:d&&3===d.nodeType&&!e.isIgnorable(d)&&(a=d);
return a&&c}catch(h){dalert(h)}};this.getInputSelection=function(a){try{if(!a)return null;var c=a.getAttribute(this.DZE_ONINPUT);if(!c)return null;var b=a.nextSibling;if(!b||1!==b.nodeType||!("TEXTAREA"===b.nodeName||"INPUT"===b.nodeName&&0<=g_objNodeUtil.arrTextInputType.indexOf(b.type)))return null;var d=c.split(",");return d&&2===d.length?{input:b,selectionStart:parseInt(d[0]),selectionEnd:parseInt(d[1])}:null}catch(e){dalert(e)}};this.getTextCountInRange=function(a){try{if(!a)return 0;var c=0,
b=a.endContainer.childNodes[a.endOffset]||a.endContainer,d=g_objNodeUtil;d.traverseNodesInRange(a,function(a){if(!a||a===b)return!1;3!==a.nodeType||d.isIgnorable(a)?1===a.nodeType&&inArray(a.nodeName,this.arrCaretElementName)&&(c+=1):c+=a.nodeValue.length;return!0}.bind(this));return c}catch(e){dalert(e)}};this.getTextNodeFromOffset=function(a,c){try{if(!c)return null;var b={textNode:null,textOffset:a},d=g_objNodeUtil;d.traverseNodesInRange(c,function(a){if(!a)return!1;var e=0;3!==a.nodeType||d.isIgnorable(a)?
1===a.nodeType&&inArray(a.nodeName,this.arrCaretElementName)&&(e=1):(e=a.nodeValue.length,a.parentNode!==c.commonAncestorContainer&&(e=(e=a.nodeValue)?e.length:0));if(b.textOffset>e)b.textOffset-=e;else return b.textNode=a,!1;return!0}.bind(this));return b.textNode?b:null}catch(e){dalert(e)}};this.createMarkerId=function(a){var c=Math.random().toString(36).substr(2,9);return a?a+"_"+c:"dze_caret_marker_"+c};this.saveCaret=function(a,c){try{if("undefined"===typeof a||null===a)a=g_nActiveEditNumber;
var b=g_objEditorDocument[a],d=b.defaultView;if(!d||!b)return null;this.nEditNumber=a;var e=d.getSelection();if(!e)return null;a=null;c=c||this.ID_CURRENT_CARET;b=0;for(var h=e.rangeCount;b<h&&1>b;b++){var g=e.getRangeAt(b);g&&(a=this.insertCaretMarker(g,c),g=null)}return a}catch(f){dalert(f)}};this.restoreCaret=function(a,c){try{if("undefined"===typeof a||null===a)a=g_nActiveEditNumber;var b=g_objEditorDocument[a],d=b.defaultView;if(!d||!b)return!1;this.nEditNumber=a;c=c||this.ID_CURRENT_CARET;a=
null;var e=b.getElementById(c);if(e){var h=b.createRange();if(a=this.removeCaretMarker(h,c,e)){var g=a.inputSelection;if(g)g.input.focus({preventScroll:!0}),g.input.setSelectionRange(g.selectionStart,g.selectionEnd);else{var f=d.getSelection();f.removeAllRanges();f.addRange(h)}}}return a&&!0===a.result?!0:!1}catch(k){dalert(k)}};this.moveCaret=function(a,c,b){try{if(!a)return!1;var d=g_objNodeUtil,e=a.ownerDocument,h=e.defaultView.getSelection(),g=null,f=a,k=0;3===f.nodeType?(!1===b?k=f.nodeValue.length:
!0===b||isNaN(b)?k=0:0<=k&&k<=f.nodeValue.length&&(k=b),g=e.createRange(),g.setStart(f,k),g.setEnd(f,k),h.removeAllRanges(),h.addRange(g)):1!==f.nodeType||g_objNodeUtil.canSelectNodeContents(f)?(h=null,f=(h=!1===b?d.getLastTextNode(f):d.getFirstTextNode(f,!0))?h:f,h||!d.isCell(f)||f.firstChild||(f.innerHTML="<P><BR></P>",f=f.firstChild),b=!1===b?"end":"start","BR"===f.nodeName&&(b="end",h=null,f.previousSibling&&3===f.previousSibling.nodeType?h=f.previousSibling:(h=e.createTextNode(""),f.parentNode.insertBefore(h,
f)),f=h),d.isCell(a)&&a!==d.getLoopParentElementByTagNames(f,d.arrCellTagName)&&(f=a,b="start"),duzon_dialog.setFocusElement(f,this.nEditNumber,b)):(g=e.createRange(),g.selectNode(f),g.collapse(!1===b?!1:!0),h.removeAllRanges(),h.addRange(g));!1!==c&&this.scrollToCaret();return!0}catch(n){dalert(n)}finally{}};this.moveCaretFromPoint=function(a,c){try{var b=this.getRangeFromPoint(a,c);return b&&b.sc?SetCurRange(b.getRange()):!1}catch(d){dalert(d)}};this.moveCaretToNextCharacter=function(a){try{var c=
g_objEditWindow[this.nEditNumber],b=c?c.getSelection():null;if(b&&0<b.rangeCount&&b.focusNode&&b.focusNode.nodeType==ID_SELECTION_TEXT_NODE){var d=b.focusNode;b.collapse(d,Math.min(d.length,b.focusOffset+a));return!0}return!1}catch(e){dalert(e)}};this.scrollToCaret=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var c=GetCurRange(a);if(!c)return!1;var b=c.startContainer,d=c.startOffset,e=b.childNodes[d]||b;if(!g_objNodeUtil.getLoopBreakNode(e))return!1;if(!c.getBoundingClientRect)return this.scrollTo(e,
a);var h=g_objPositionUtil,g=c.getBoundingClientRect();g=h.domRectToRect(g);if(h.isEmptyRect(g)){var f=b.childNodes[d];f&&"BR"===f.nodeName&&b.childNodes[d-1]&&(e=b.childNodes[d-1]);e||(e=b);return this.scrollTo(e,a)}var k=g_objEditorDocument[a].body,n=g_objEditObject[a];if(!k||!n)return!1;var q=k.scrollLeft,l=k.scrollTop;h.moveRect(g,q,l);var m=h.createRect(q,l,n.offsetWidth,n.offsetHeight);return this.setScroll(k,this.getScrollPos(g,m))}catch(r){dalert(r)}finally{}};this.scrollTo=function(a,c){try{if(a){"undefined"===
typeof c&&(c=g_nActiveEditNumber);var b=g_objEditorDocument[c].body,d=g_objEditObject[c];if(!b||!d)return!1;for(;1!==a.nodeType||"BR"===a.nodeName||"OPTION"===a.nodeName;)a=a.parentNode;c=g_objPositionUtil;var e=c.createRect(b.scrollLeft,b.scrollTop,d.offsetWidth,d.offsetHeight),h=c.createRect(c.getDocumentLeft(a),c.getDocumentTop(a),a.offsetWidth,a.offsetHeight);return this.setScroll(b,this.getScrollPos(h,e))}}catch(g){dalert(g)}};this.getScrollPos=function(a,c){try{var b={left:null,top:null};a.bottom>
c.bottom?b.top=Math.max(a.bottom-c.height+60,0):a.top<c.top&&(b.top=Math.max(a.top-60,0));a.right>c.right?b.left=Math.max(a.right-c.width+60,0):a.left<c.left&&(b.left=Math.max(a.left-60,0));return b}catch(d){dalert(d)}};this.setScroll=function(a,c){try{if(!a||!c)return!1;var b=!1;null!==c.top&&(a.scrollTop=c.top,b=!0);null!==c.left&&(a.scrollLeft=c.left,b=!0);return b}catch(d){dalert(d)}};this.getCaretNormalContainer=function(a){var c=!1;if(window.getSelection)if((a=g_objEditWindow[a].getSelection())&&
1==a.rangeCount)a=a.getRangeAt(0),c=a.collapsed;else return null;else{a=g_objEditorDocument[a].selection;if(fnObjectCheckNull(a))return null;a=a.createRange();if(fnObjectCheckNull(a))return null;""==a.htmlText&&(c=!0)}if(!c)return dlog("collapsed = false -> N/A!"),null;c="commonAncestorContainer"in a?a.commonAncestorContainer:a.parentElement().childNodes[0];if(!c)return dlog("no objAncestorNode -> N/A!"),null;c.nodeType==ID_SELECTION_TEXT_NODE&&(c=c.parentNode);return c.nodeType!=ID_SELECTION_ELEMENT_NODE?
(dlog("nodeType != 1 -> N/A!"),null):{objRange:a,objAncestorNode:c}};this.getRangeFromPoint=function(a,c){try{var b=g_objEditorDocument[this.nEditNumber],d=null;if(b.caretRangeFromPoint)d=b.caretRangeFromPoint(a,c);else if(b.caretPositionFromPoint){if((d=b.caretPositionFromPoint(a,c))&&d.offsetNode)return(new RangeProp).init(d.offsetNode,d.offset,d.offsetNode,d.offset)}else b.body.createTextRange&&(d=this.getRangeFromPointForIE(a,c));if(!d)return null;var e=new RangeProp(d);return e.sc&&e.ec?e:null}catch(h){dalert(h)}finally{}};
this.getRangeFromPointForIE=function(a,c){try{var b=g_objEditorDocument[this.nEditNumber],d=b.body.createTextRange();try{if(d.moveToPoint(a,c),d){var e=d.duplicate(),h=e.parentElement();if(h instanceof window.HTMLInputElement)return null;var g=d.duplicate();g.moveToElementText(h);g.setEndPoint("EndToEnd",e);return this.getRangeFromText(h.firstChild,g.text)}}catch(n){if(b.elementFromPoint)try{var f=b.elementFromPoint(a,c),k=b.createRange();f&&inArray(f.nodeName,this.arrCaretElementName)?k.selectNode(f):
k.selectNodeContents(f);k.collapse(!1);return k}catch(q){}}return null}catch(n){dalert(n)}finally{}};this.getRangeFromText=function(a,c){try{for(var b=g_objEditorDocument[this.nEditNumber],d=null,e=null;a;){if(3===a.nodeType){var h=a.nodeValue;if(h=h?h.replace(/\u00a0/g," "):null){var g=c.length;if(0>=g||c===h)return{startContainer:a,endContainer:a,startOffset:g,endOffset:g};for(var f=c,k=h,n=f.length,q=k.length,l=0,m=0,r=null,u=null;l<n&&m<q;){r=f.charCodeAt(l);for(u=k.charCodeAt(m);(10===r||13===
r)&&l<n;)r=f.charCodeAt(++l);for(;(10===u||13===u)&&m<q;)u=k.charCodeAt(++m);if(r!==u)break;l++;m++}var v=l;var w=m;if(v>=g)return{startContainer:a,endContainer:a,startOffset:w,endOffset:w};c=c.substring(v)}}else 1===a.nodeType&&(d=d||b.body.createTextRange(),d.moveToElementText(a),c=c.substring(d.text.length),d=null,e=a);a=a.nextSibling}var p=e&&"BR"===e.nodeName,t=e&&e.firstChild&&e.firstChild===e.lastChild&&"BR"===e.firstChild.nodeName;return p||t?{startContainer:p?e.parentNode:e,endContainer:p?
e.parentNode:e,startOffset:0,endOffset:0}:null}catch(x){dalert(x)}};this.isCollapsed=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var c=g_objEditWindow[a];return(c?c.getSelection():null).isCollapsed?!0:!1}catch(b){dalert(b)}};this.isContentEditable=function(a){try{var c=GetCurRange(a);if(!c)return!1;for(var b=c.startContainer,d=c.endContainer;b&&1!==b.nodeType;)b=b.parentNode;for(;d&&1!==d.nodeType;)d=d.parentNode;return b&&d?b.isContentEditable&&d.isContentEditable:!1}catch(e){dalert(e)}}};

var SelectionUtil={getCurRange:function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var b=g_objEditorDocument[a],c=b?b.defaultView:null,d=c?c.getSelection():null;if(!d)return null;var g=d.rangeCount;if(0>=g)return null;if(1===g)return d.getRangeAt(0);if(1<g){var f=d.getRangeAt(0),e=d.getRangeAt(g-1),l=b.createRange();l.setStart(f.startContainer,f.startOffset);l.setEnd(e.endContainer,e.endOffset);return l}return null}catch(k){dalert(k)}},setCurRange:function(a){try{if(!a||!a.commonAncestorContainer)return!1;
var b=a.commonAncestorContainer.ownerDocument,c=b?b.defaultView:null,d=c?c.getSelection():null;if(!d)return!1;d.removeAllRanges();d.addRange(a);return!0}catch(g){dalert(g)}},isMultiSelected:function(a){try{var b=this.getCurRange(a);if(!b||b.collapsed)return!1;a=g_objNodeUtil;return a.getLoopHeaderFooterBody(b.startContainer)!==a.getLoopHeaderFooterBody(b.endContainer)?!0:!1}catch(c){dalert(c)}finally{}},isBoundContentsAllSelected:function(a){try{var b=this.getCurRange(a);if(!b||b.collapsed)return!1;
if(b.startContainer&&b.startContainer===b.endContainer){var c=b.startContainer;a=g_objNodeUtil;if(a.isBoundNode(c)&&("SPAN"!==c.nodeName||!g_objPropertyUtil.hasClass(c,"dze_shape_text_contents"))){for(var d=b.startOffset,g=b.endOffset,f=c.firstChild;f&&a.isDocFirstNode(f);)d=Math.max(0,d-1),f=f.nextSibling;for(var e=c.lastChild;e&&a.isDocLastNode(e);)g=Math.max(0,g+1),e=e.previousSibling;if(0===d&&g===c.childNodes.length)return!0}}return!1}catch(l){dalert(l)}finally{}},isSelectionOnCell:function(a){try{var b=
this.getCurRange(a);if(!b||b.collapsed)return!1;var c=b.startContainer.childNodes[b.startOffset]||b.startContainer,d=b.endContainer.childNodes[b.endOffset]||b.endContainer;if(!c||!d)return!1;a=g_objNodeUtil;var g=a.arrCellTagName,f=a.getLoopParentElementByTagNames(c,g),e=a.getLoopParentElementByTagNames(d,g);return(f||e)&&f!==e?!0:!1}catch(l){dalert(l)}finally{}},isDeleteDirectly:function(a){try{return this.isBoundContentsAllSelected(a)||this.isMultiSelected(a)||this.isSelectionOnCell(a)?!0:!1}catch(b){dalert(b)}},
deleteSelection:function(a,b){try{return this.isSelectionOnCell(a)?g_objTableOperation.deleteSelectionOnCell(a):this.isBoundContentsAllSelected(a)||this.isMultiSelected(a)?this.execDeleteCurSelection(a)?!0:!1:this.execDeleteCurSelection(a,b)}catch(c){dalert(c)}},execDeleteCurSelection:function(a,b){try{var c=GetCurRange(a);if(c){var d=this.execDeleteSelection(c,b);d&&(d.getRange(c),this.setCurRange(c));return d}}catch(g){dalert(g)}finally{}},execDeleteSelection:function(a,b){try{if(!a||a.collapsed)return null;
var c=new RangeArray(a);if(!c||c.collapsed())return null;var d=b&&!0===b.bDoNotExpandRange?!0:!1,g=b&&!0===b.bDoNotRemoveEmpty?!0:!1;a=g_objNodeUtil;var f=dzeUiConfig.bOfficePgOverflowVisible,e=c.getDocument(),l=c.getRangeCount(),k=c.getRangePropAt(0),m=c.getRangePropAt(l-1);d||(3===k.sc.nodeType&&0===k.so&&(k.so=a.getChildIndex(k.sc),k.sc=k.sc.parentNode),3===m.ec.nodeType&&m.eo===m.ec.nodeValue.length&&(m.eo=a.getChildIndex(m.ec)+1,m.ec=m.ec.parentNode));var h=k.clone();h.ec=m.ec;h.eo=m.eo;var n=
e.createRange();for(d=l-1;0<=d;d--)if(c.arrRangeProp[d].getRange(n),n.deleteContents(),f){var r=n.commonAncestorContainer;a.isPageMain(r)&&this.insertParaToEmptyBound(r)}var t=h.sc===h.ec;h.eo=t?h.so:0;var p=g?null:a.removeEmptyNode(null,h.sc);p&&!0===p.bDeleted&&(h.sc=p.offsetNode,h.so=p.offset);t?(h.ec=h.sc,h.eo=h.so):(p=g?null:a.removeEmptyNode(null,h.ec))&&!0===p.bDeleted&&(h.ec=p.offsetNode,h.eo=p.offset);h.sc&&h.sc.parentNode&&h.ec&&h.sc.nodeName===h.ec.nodeName&&h.sc.nextSibling===h.ec&&!h.sc.firstChild&&
0===h.eo&&a.isParagraph(h.sc)&&(h.sc.parentNode.removeChild(h.sc),h.sc=h.ec,h.so=h.eo);var q=this.insertParaToEmptyBound(h.sc)||a.insertBrIntoBlankPara(h.sc);this.insertParaToEmptyBound(h.ec)||a.insertBrIntoBlankPara(h.ec);h.ec=h.sc;h.eo=h.so;if(q){var u=e.createTextNode("");q.parentNode.insertBefore(u,q);n.selectNodeContents(u)}else if(3!==n.startContainer.nodeType||n.startContainer!==n.endContainer)h.isValid()?(n.setStart(h.sc,h.so),n.setEnd(h.sc,h.so)):dalert("invalid rangeprop");return new RangeProp(n)}catch(v){dalert(v)}finally{}},
insertParaToEmptyBound:function(a){try{if(!a||!a.parentNode)return null;var b=g_objNodeUtil;if(!b.isBoundNode(a))return null;var c=a.firstChild;if(b.isPageMain(a))for(;c&&(b.isDocFirstNode(c)||b.isDocLastNode(c));)c=c.nextSibling;if(!c){if(!dzeUiConfig.bOfficePgOverflowVisible&&b.isPageMain(a)&&a!==g_objPageControl.getPageMain(0))return null;var d=a.ownerDocument,g=d.createElement("P"),f=d.createElement("BR");g.appendChild(f);c=null;for(var e=a.lastChild;e&&b.isDocLastNode(e);)c=e,e=e.previousSibling;
c?a.insertBefore(g,c):a.appendChild(g)}return f}catch(l){dalert(l)}},existOnFirst:function(a,b){try{return a&&b?this.isOnFirst(a,b.startContainer,b.startOffset):!1}catch(c){dalert(c)}},existOnLast:function(a,b){try{return a&&b?this.isOnLast(a,b.endContainer,b.endOffset):!1}catch(c){dalert(c)}},isOnFirst:function(a,b,c){try{if(!a||!b||!a.contains(3===b.nodeType?b.parentNode:b))return!1;for(var d=g_objNodeUtil,g=g_objPropertyUtil,f=0,e=null,l=!0;b!==a.parentNode;){f=0;if(3===b.nodeType)1===c&&""===
b.nodeValue?c=0:0<b.nodeValue.length&&32===b.nodeValue.charCodeAt(0)&&1===c&&(c=0);else if(1===b.nodeType)for(e=b.firstChild;e;){if(1===e.nodeType&&"SPAN"===e.nodeName&&g.hasClass(e,"dze_shape_main"))f++;else if(3===e.nodeType&&0===e.nodeValue.length)f++;else if(1!==e.nodeType||"SPAN"!==e.nodeName||e.firstChild||e===b.firstChild&&e===b.lastChild)break;else f++;e=e.nextSibling}if(0<c-f){l=!1;break}if(d.isLoopBreakNode(b))break;c=d.getChildIndex(b);b=b.parentNode}return l}catch(k){dalert(k)}},isOnLast:function(a,
b,c,d){try{if(!a||!b||!a.contains(3===b.nodeType?b.parentNode:b))return!1;for(var g=g_objNodeUtil,f=0,e=null,l=!0;b!==a.parentNode;){f=0;if(3===b.nodeType)f=b.nodeValue.length,0<f&&32===b.nodeValue.charCodeAt(f-1)&&c===f&&--f;else if(1===b.nodeType&&(f=b.childNodes.length,0<f))for(e=b.lastChild;e;){if(1===e.nodeType&&"BR"===e.nodeName&&!0!==d)f--;else if(3===e.nodeType&&0===e.nodeValue.length)f--;else if(1!==e.nodeType||"SPAN"!==e.nodeName||e.firstChild||e===b.firstChild&&e===b.lastChild)break;else f--;
e=e.previousSibling}if(c<f){l=!1;break}if(g.isLoopBreakNode(b))break;c=g.getChildIndex(b)+1;b=b.parentNode}return l}catch(k){dalert(k)}},isOnFirstLine:function(a,b,c,d){try{if(!(a&&a.parentNode&&b&&b.parentNode)||a!==b&&!a.contains(3===b.nodeType?b.parentNode:b))return!1;if(this.isOnFirst(a,b,c))return!0;var g=g_objPositionUtil,f=d||this.getOffsetRect(b,c);if(g.isEmptyRect(f))return!1;var e=f.top,l=this.getTreeWalkerWalkedToNode(a,b);if(!l)return!1;var k=l.currentNode,m=null;if(3===k.nodeType&&k===
b&&(g.forEachCharRect(k,function(a,b){if(b&&b.top<e)throw m=!1,BreakException;},!1,c-2),!1===m))return!1;for(;k;){if(3===k.nodeType||1===k.nodeType&&"BR"===k.nodeName){if(g.forEachCharRect(k,function(a,b){if(b&&b.top<e)throw m=!1,BreakException;},!1),!1===m)return!1}else{var h=k.getBoundingClientRect();if(h&&h.top<e)return!1}k=l.previousNode()}return!0}catch(n){dalert(n)}},isOnLastLine:function(a,b,c,d){try{if(!(a&&a.parentNode&&b&&b.parentNode)||a!==b&&!a.contains(3===b.nodeType?b.parentNode:b))return!1;
if(this.isOnLast(a,b,c))return!0;var g=g_objPositionUtil,f=d||this.getOffsetRect(b,c);if(g.isEmptyRect(f))return!1;var e=f.bottom-3,l=this.getTreeWalkerWalkedToNode(a,b);if(!l)return!1;var k=l.currentNode,m=null;if(k===b&&3===k.nodeType&&(g.forEachCharRect(k,function(a,b){if(b&&b.top>=e)throw m=!1,BreakException;},!0,c),!1===m))return!1;for(k=l.currentNode;k;){if(3===k.nodeType||1===k.nodeType&&"BR"===k.nodeName){if(g.forEachCharRect(k,function(b,a){if(a&&a.top>=e)throw m=!1,BreakException;}),!1===
m)return!1}else{var h=k.getBoundingClientRect();if(h&&h.top>=e)return!1}k=l.nextNode()}return!0}catch(n){dalert(n)}},getTreeWalkerWalkedToNode:function(a,b){try{if(!a||!b)return null;var c=b.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,function(a){return b===a?NodeFilter.FILTER_ACCEPT:g_objNodeUtil.canCaretExistOn(a)},!1),d=c.firstChild();if(!d)return null;for(;d!==b;)if(d=c.nextNode(),!d)return null;return c.currentNode?c:null}catch(g){dalert(g)}},getOffsetRect:function(a,
b){try{if(!a||!a.parentNode)return g_objPositionUtil.getEmptyRect();var c=g_objPositionUtil,d=a.ownerDocument.createRange();d.setStart(a,b);d.setEnd(a,b);var g=c.domRectToRect(d.getBoundingClientRect());if(c.isEmptyRect(g)){var f=a.childNodes[b]||a.childNodes[b-1]||a;f&&3===f.nodeType?(d.selectNode(f),g=c.domRectToRect(d.getBoundingClientRect()),c.isEmptyRect(g)&&(f=f.parentNode)&&f.getBoundingClientRect&&(g=c.domRectToRect(f.getBoundingClientRect()))):f&&f.getBoundingClientRect&&(g=c.domRectToRect(f.getBoundingClientRect()))}if(c.isEmptyRect(g)){var e=
a.parentNode,l=g_objNodeUtil.getChildIndex(a);d.setStart(e,l);d.setEnd(e,l);g=c.domRectToRect(d.getBoundingClientRect())}return g}catch(k){return dalert(k),g_objPositionUtil.getEmptyRect()}finally{}},isOnInput:function(a){try{var b=g_objEditorDocument[a];if(!b)return null;var c=b.activeElement;return!c||1!==c.nodeType||"INPUT"!==c.nodeName&&"TEXTAREA"!==c.nodeName?null:c}catch(d){dalert(d)}},getRangeFirstChildChk:function(a,b){var c=!1;a=GetCurRange(a);var d=a.commonAncestorContainer,g=d.children;
if(1>d.childElementCount)return!1;!1===g_objPropertyUtil.element_hasClass(a.commonAncestorContainer,"dze_page_main")?(a=g[0],SelectionUtil.getRangeTextStyleChk(a,b)&&(c=!0)):(a=g[0],d=a.children,0<a.childElementCount&&(a=d[0],SelectionUtil.getRangeTextStyleChk(a,b)&&(c=!0)));return c},getRangeChildChk:function(a,b){try{var c=!1,d=GetCurRange(a);a=function(a){return g_objHeaderFooter.getHeaderFooterEditMode()!==g_objHeaderFooter.contains(a)?NodeFilter.FILTER_REJECT:"SPAN"===a.nodeName?NodeFilter.FILTER_ACCEPT:
NodeFilter.FILTER_SKIP};a.acceptNode=a;for(var g=g_objNodeUtil.createRangeWalker(d,NodeFilter.SHOW_ELEMENT,a),f=g.firstChild();f;){if(SelectionUtil.getRangeTextStyleChk(f,b))c=!0;else return!1;f=g.nextNode()}return c}catch(e){dalert(e)}finally{d=null}},getRangeTextStyleChk:function(a,b){var c=!1;if("SPAN"===a.nodeName&&!1===fnObjectCheckNull(a)){var d=a.style.fontWeight.toLowerCase(),g=a.style.fontFamily.toLowerCase(),f=a.style.fontStyle.toLowerCase(),e=a.style.textDecorationLine;e=void 0===a.style.textDecorationLine?
a.style.textDecoration.toLowerCase():e.toLowerCase();var l=a.style.fontSize.toLowerCase(),k=a.style.letterSpacing.toLowerCase(),m=b.toLowerCase();if(d===m||g===m||l===m||k===m||f===m||-1<e.indexOf(m)||"strikethrough"===m&&-1<e.indexOf("line-through"))c=!0;if(0<a.childNodes.length)for(d=a.childNodes,g=0;g<d.length;g++)f=d[g],"SPAN"===f.nodeName&&!1===fnObjectCheckNull(a)&&(c=this.getRangeTextStyleChk(f,b))}return c}},GetCurRange=SelectionUtil.getCurRange.bind(SelectionUtil),SetCurRange=SelectionUtil.setCurRange.bind(SelectionUtil);

function GetCurRangeArray(a){try{return new RangeArray(GetCurRange(a))}catch(b){dalert(b)}}function GetCurRangeProp(a){try{return new RangeProp(GetCurRange(a))}catch(b){dalert(b)}}function RangeProp(a){this.sc=null;this.so=0;this.ec=null;this.eo=0;a&&this.initFromRange(a);return this}
RangeProp.prototype={init:function(a,b,c,d){try{return this.sc=a,this.so=b,"undefined"===typeof c?(this.ec=a,this.eo=b):(this.ec=c,this.eo=d),this}catch(e){dalert(e)}},initFromRange:function(a){try{if(!a)return this;this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;return this}catch(b){dalert(b)}},equal:function(a){try{return a&&this.so===a.so&&this.eo===a.eo&&this.sc===a.sc&&this.ec===a.ec?!0:!1}catch(b){dalert(b)}},clone:function(){try{var a=new RangeProp;
a.sc=this.sc;a.so=this.so;a.ec=this.ec;a.eo=this.eo;return a}catch(b){dalert(b)}},reverse:function(){try{var a=this.sc;this.sc=this.ec;this.ec=a;a=this.so;this.so=this.eo;this.eo=a;return this}catch(b){dalert(b)}},getRange:function(a){try{if(!a){if(!this.sc)return null;a=this.sc.ownerDocument.createRange()}a.setStart(this.sc,this.so);a.setEnd(this.ec,this.eo);return a}catch(b){dalert(b)}},collapsed:function(){return this.sc===this.ec&&this.so===this.eo?!0:!1},isNull:function(){return this.sc&&this.ec&&
this.sc.parentNode&&this.ec.parentNode?!1:!0},isValid:function(){try{if(!(this.sc&&this.ec&&this.sc.parentNode&&this.ec.parentNode))return!1;var a=3===this.sc.nodeType?this.sc.nodeValue.length:this.sc.childNodes.length;if(!(0<=this.so&&this.so<=a))return!1;a=3===this.ec.nodeType?this.ec.nodeValue.length:this.ec.childNodes.length;return 0<=this.eo&&this.eo<=a?!0:!1}catch(b){dalert(b)}},print:function(){dlog("sc: "+this.sc+", so: "+this.so+", ec: "+this.ec+", eo: "+this.eo)}};
RangeProp.prototype.getNativeRange=RangeProp.prototype.getRange;function RangeArray(a){this.arrRangeProp=[];this.init(a);return this}
RangeArray.prototype={init:function(a){try{if(!a)return this;this.arrRangeProp.push(new RangeProp(a));return this}catch(b){dalert(b)}},isNull:function(){try{return!this.arrRangeProp||0>=this.arrRangeProp.length||1===this.arrRangeProp.length&&(null===this.arrRangeProp[0].sc||null===this.arrRangeProp[0].ec)?!0:!1}catch(a){dalert(a)}},getDocument:function(){try{for(var a=0,b=this.getRangeCount();a<b;a++){var c=this.arrRangeProp[a].sc||this.arrRangeProp[a].ec;if(c)return c.ownerDocument}return null}catch(d){dalert(d)}},
getRangePropAt:function(a){try{return this.isNull()?null:this.arrRangeProp[a]}catch(b){dalert(b)}},getRangeAt:function(a){try{return this.isNull()?null:this.arrRangeProp[a].getRange()}catch(b){dalert(b)}},getRangeCount:function(){return this.isNull()?0:this.arrRangeProp.length},getOneRange:function(){try{if(this.isNull())return null;var a=this.getDocument().createRange(),b=this.getRangeCount();a.setStart(this.arrRangeProp[0].sc,this.arrRangeProp[0].so);a.setEnd(this.arrRangeProp[b-1].ec,this.arrRangeProp[b-
1].eo);return a}catch(c){dalert(c)}},setCurRange:function(){try{var a=this.getDocument(),b=a?a.defaultView:null,c=b?b.getSelection():null;if(!c)return!1;var d=this.getOneRange();if(!d)return!1;c.removeAllRanges();c.addRange(d);return!0}catch(e){dalert(e)}},collapsed:function(){try{return this.isNull()||1===this.getRangeCount()&&this.arrRangeProp[0].sc===this.arrRangeProp[0].ec&&this.arrRangeProp[0].so===this.arrRangeProp[0].eo?!0:!1}catch(a){dalert(a)}},collapse:function(a){try{a?this.arrRangeProp.splice(1,
this.arrRangeProp.length):this.arrRangeProp.splice(0,this.arrRangeProp.length-1),this.arrRangeProp[0].ec=this.arrRangeProp[0].sc,this.arrRangeProp[0].eo=this.arrRangeProp[0].so}catch(b){dalert(b)}},deleteContents:function(){try{if(!this.isNull()){for(var a=this.getDocument().createRange(),b=this.getRangeCount()-1;0<=b;b--)this.arrRangeProp[b].getRange(a),a.deleteContents();this.arrRangeProp=[];this.arrRangeProp.push(new RangeProp(a))}}catch(c){dalert(c)}},extractContents:function(){try{if(this.isNull())return null;
var a=this.getDocument(),b=a.createRange(),c=null,d=a.createElement("div");a=0;for(var e=this.getRangeCount();a<e;a++)this.arrRangeProp[a].getRange(b),c=range.extractContents(),d.appendChild(c);this.arrRangeProp=[];this.arrRangeProp.push(new RangeProp(b));appendBodyTemporary(d,null,function(){b.selectNodeContents(d);c=b.extractContents()});b=null;return c}catch(f){dalert(f)}},cloneContents:function(a){try{if(this.isNull())return null;var b=this.getDocument(),c=b.createRange(),d=null,e=b.createElement("div");
a=0;for(var f=this.getRangeCount();a<f;a++)this.arrRangeProp[a].getRange(c),d=c.cloneContents(),e.appendChild(d);appendBodyTemporary(e,null,function(){c.selectNodeContents(e);d=c.extractContents()});c=null;return d}catch(g){dalert(g)}},doAllRange:function(a){try{if(a&&!this.isNull())for(var b,c=0,d=this.getRangeCount();c<d&&(b=a(this.ranges[c]),!1!==b);c++);}catch(e){dalert(e)}}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objListUtil=new function(){this.arrCustomULStyle=["dzeExtListStyleTriangle","dzeExtListStyleInnerCircle","dzeExtListStyleFillCircle","dzeExtListStyleDiamond","dzeExtListStyleHypon"];this.arrTextStyleName="fontFamily fontSize color fontWeight fontStyle textDecoration verticalAlign".split(" ");this.isParaNodeName=function(a){return"P"===a||"PRE"===a||this.isHeadNodeName(a)};this.isHeadNodeName=function(a){return"H1"===a||"H2"===a||"H3"===a||"H4"===a||"H5"===a};this.isListNodeName=function(a){return"OL"===
a||"UL"===a||"DL"===a};this.isListItemNodeName=function(a){return"LI"===a||"DT"===a||"DD"===a};this.isPara=function(a){return a&&1===a.nodeType&&this.isParaNodeName(a.nodeName)};this.isList=function(a){return a&&1===a.nodeType&&this.isListNodeName(a.nodeName)};this.isListItem=function(a){return a&&1===a.nodeType&&this.isListItemNodeName(a.nodeName)};this.getPreviousSibling=function(a){if(!a)return null;var b=a.previousSibling;b||"undefined"===typeof g_objSplitUtil||(b=g_objSplitUtil.getPreviousSplitSibling(a));
return b};this.getNextSibling=function(a){if(!a)return null;var b=a.nextSibling;b||"undefined"===typeof g_objSplitUtil||(b=g_objSplitUtil.getNextSplitSibling(a));return b};this.isULStyle=function(a){return"disc"===a||"circle"===a||"square"===a||this.isCustomULStyle(a)};this.isCustomULStyle=function(a){return a&&0<=this.arrCustomULStyle.indexOf(a)?!0:!1};this.isDefaultListStyle=function(a,b){return""===b||"OL"===a&&"decimal"===b||"UL"===a&&"disc"===b};this.getDefaultListStyle=function(a){return"OL"===
a?"decimal":"UL"===a?"disc":""};this.getDefaultListStyleArray=function(a){return"OL"===a?dzeUiConfig.applyOListStyleDepthItems:"UL"===a?dzeUiConfig.applyUListStyleDepthItems:null};this.getListInfo=function(a,b,c){try{if(!a||!a.parentNode||!this.isList(a))return null;c=c||{};var d=this.getRootList(a),e=this.getLevel(a),f=a.nodeName,g=this.getDefaultListStyleArray(f);c.list=a;c.rootList=d;c.nodeName=f;c.level=e;c.maxLevel=g?g.length:0;c.listItemCount=this.getListItemCount(a);if(b&&!0===b.style){f=a=
"";var h=this.getListStyleArray(d);h&&(0<=e&&e<h.length&&(a=h[e]),0<=e+1&&e+1<h.length&&(f=h[e+1]));c.style=a;c.nextStyle=f;c.nextNodeName=this.isULStyle(f)?"UL":"OL"}if(b&&!0===b.nextRootList){var k=this.getNextSibling(d);k&&k.nodeName===d.nodeName&&(c.nextRootList=k)}if(b&&!0===b.prevRootList){var l=this.getPreviousSibling(d);l&&l.nodeName===d.nodeName&&(c.prevRootList=l)}return c}catch(n){dalert(n)}};this.getListItemInfo=function(a,b){try{if(!this.isListItem(a))return null;var c=a.parentNode;if(!c||
!c.parentNode||!this.isList(c))return null;var d={};d.listItem=a;d.list=c;d.index=this.getIndex(a);return this.getListInfo(c,b,d)}catch(e){dalert(e)}};this.getListStyle=function(a){try{if(!this.isList(a))return"";var b=a.nodeName,c=a.style.listStyleType;if(!c&&"UL"===b){for(var d="",e=g_objPropertyUtil,f=0,g=this.arrCustomULStyle;f<g;f++)e.hasClass(a,this.arrCustomULStyle[f])&&(d=this.arrCustomULStyle[f]);if(d)return d}if(this.isDefaultListStyle(b,c))return this.getDefaultListStyle(b);"UL"!==b||this.isULStyle(c)||
(c=this.getDefaultListStyle("UL"));return c}catch(h){dalert(h)}};this.setListStyle=function(a,b){try{if(!this.isList(a))return!1;b=b||"";for(var c=g_objPropertyUtil,d=0,e=this.arrCustomULStyle.length;d<e;d++)c.removeClass(a,this.arrCustomULStyle[d]);if(this.isDefaultListStyle(a.nodeName,b))return a.style.listStyleType=this.getDefaultListStyle(a.nodeName),!0;0<=this.arrCustomULStyle.indexOf(b)&&(c.addClass(a,b),b="");"UL"!==a.nodeName||this.isULStyle(b)||(b="");a.style.listStyleType=b;""===b&&""===
a.style.cssText&&a.removeAttribute("style");return!0}catch(f){dalert(f)}};this.getLoopParentListItem=function(a,b){return g_objNodeUtil.getLoopParentElementByTagNames(a,g_objNodeUtil.arrListItemTagName,b)};this.getCurListItemsInRange=function(a,b){try{var c=[];b=b||{};var d=GetCurRange(a);if(!d)return c;var e=g_objNodeUtil,f="undefined"!==typeof g_objHeaderFooter?g_objHeaderFooter:null;a=SelectionUtil;var g=d.startContainer.childNodes[d.startOffset]||d.startContainer,h=d.endContainer.childNodes[d.endOffset-
1]||d.endContainer;if(!g||!h)return c;var k=!1===b.bCheckBound?!1:!0;if(!0===b.bStartEndLi&&!(this.isList(g)||this.getLoopParentListItem(g,k)||this.isList(h)||this.getLoopParentListItem(h,k)))return c;if(g.compareDocumentPosition(h)&Node.DOCUMENT_POSITION_PRECEDING){var l=g;g=h;h=l}var n=e.createRangeWalker(d,NodeFilter.SHOW_ELEMENT,function(a){if(1!==a.nodeType)var b=!1;else if("TABLE"===a.nodeName)b=!0;else{var c=(b=a.style)?b.position.toLowerCase():"";b=b&&("absolute"===c||"fixed"===c)&&e.isBlockNodeName(a.nodeName)||
"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_shape_text_contents")||"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"shape_textbox")?!0:!1}return!b||a.contains(3===g.nodeType?g.parentNode:g)||a.contains(3===h.nodeType?h.parentNode:h)?!a||1!==a.nodeType||"LI"!==a.nodeName&&"DT"!==a.nodeName&&"DD"!==a.nodeName?NodeFilter.FILTER_SKIP:f&&f.getHeaderFooterEditMode()!==f.contains(a)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});if(!n)return c;var m=n.firstChild();
for(l=null;m;){c.push(m);l=n.nextNode();if(l===m)break;m=l}var p=0<c.length?c[0]:null;p&&a.isOnLast(p,d.startContainer,d.startOffset)&&c.splice(0,1);(p=0<c.length?c[c.length-1]:null)&&a.isOnFirst(p,d.endContainer,d.endOffset)&&c.splice(c.length-1,1);0===c.length&&(p=this.getLoopParentListItem(d.commonAncestorContainer,k))&&c.push(p);"undefined"!==typeof g_objSplitUtil&&g_objSplitUtil.expandSplitNodes(c);if(!0===b.bExceptSomeSelect){b=[];var r=this.getLoopParentListItem(g,k),t=this.getLoopParentListItem(h,
k);r&&!a.isOnFirst(r,d.startContainer,d.startOffset)&&0>b.indexOf(r)&&b.push(r);t&&a.isOnFirst(t,d.endContainer,d.endOffset)&&0>b.indexOf(t)&&b.push(t);forEach(b,function(a,b){a=c.indexOf(b);0<=a&&c.splice(a,1)},this)}return c}catch(q){dalert(q)}};this.getListStyleArray=function(a){try{if(!this.isList(a))return null;for(var b=[],c=this.getFirstLists(a),d=0,e=c.length;d<e;d++)b.push(this.getListStyle(c[d]));var f=this.getDefaultListStyleArray(a.nodeName);e=b.length;var g=f?f.length:-1;if(e<g){a:{try{if(!f||
!b||f.length<b.length){var h=-1;break a}a=0;for(var k=f.length-b.length;a<k;a++){c=!0;for(var l=0,n=b.length;l<n;l++)if(f[a+l]!==b[l]){c=!1;break}if(!0===c){h=a;break a}}h=-1;break a}catch(m){dalert(m)}h=void 0}if(0<=h)for(d=e,k=0;d<g;d++,k++)b[d]=f[(h+e+k)%g];else for(d=e;d<g;d++)b[d]=f[d]}return b}catch(m){dalert(m)}};this.getIndex=function(a){try{for(var b=-1;a;)this.isListItem(a)&&b++,a=this.getPreviousSibling(a);return b}catch(c){dalert(c)}};this.getListItemCount=function(a,b,c){try{if(!a)return 0;
for(var d=0,e=a.firstChild;e;)this.isListItem(e)&&(!0!==b||"none"!==e.style.display)&&d++,e=!0===c?e.nextSibling:this.getNextSibling(e);return d}catch(f){dalert(f)}};this.isFirstListItem=function(a){try{if(!this.isListItem(a)&&!this.isList(a.parentNode))return!1;for(var b=a.parentNode.firstChild;b;){if(this.isListItem(b))return b===a?!0:!1;b=this.getNextSibling(b)}return 0}catch(c){dalert(c)}};this.getLevel=function(a){try{for(var b=-1;a&&!g_objNodeUtil.isBoundNode(a);)this.isList(a)&&b++,a=a.parentNode;
return b}catch(c){dalert(c)}};this.getRootList=function(a){try{for(var b=null;a&&!g_objNodeUtil.isBoundNode(a);)this.isList(a)&&(b=a),a=a.parentNode;return b}catch(c){dalert(c)}};this.getDirectULChildren=function(a){try{for(var b=[],c=a?a.firstChild:null;c;)1===c.nodeType&&"UL"===c.nodeName&&b.push(c),c=c.nextSibling;return b}catch(d){dalert(d)}};this.setStart=function(a,b){try{if(!a||"OL"!==a.nodeName||isNaN(b)||0>=b)return!1;1===b?a.removeAttribute("start"):a.setAttribute("start",b);return!0}catch(c){dalert(c)}};
this.getStart=function(a){try{if(!a||"OL"!==a.nodeName)return-1;var b=a.getAttribute("start")||1;return parseInt(b,10)}catch(c){dalert(c)}};this.continueStart=function(a,b){if(!a||"OL"!==a.nodeName)return!1;b=this.getStart(b)+this.getListItemCount(b);return this.setStart(a,b)};this.getFirstLists=function(a){try{if(!this.isList(a))return[];"undefined"!==typeof g_objSplitUtil&&(a=g_objSplitUtil.getFirstSplitNode(a));var b=[],c=this.getLevel(a);b[c]=a;for(var d=[],e=a.firstChild;e||0<d.length;){e?this.isList(e)&&
d.push(e):e=d.shift().firstChild;this.isList(e)&&(c=this.getLevel(e),b[c]||(b[c]=e));if(!e)break;e=this.getNextSibling(e)}return b}catch(f){dalert(f)}};this.getFirstChildListArray=function(a){try{if(!this.isList(a))return[];for(var b=[],c=0;a;)this.isList(a)&&(b[c++]=a),a=a.firstChild;return b}catch(d){dalert(d)}};this.getLastChildListArray=function(a){try{if(!this.isList(a))return[];for(var b=[],c=0;a;)this.isList(a)&&(b[c++]=a),a=a.lastChild;return b}catch(d){dalert(d)}};this.getFirstListItem=function(a){try{if(!this.isList(a))return null;
for(var b=a.firstChild;b;){if(this.isListItem(b))return b;if(this.isList(b))b=b.firstChild;else break}return null}catch(c){dalert(c)}};this.getLastListItem=function(a){try{if(!this.isList(a))return null;for(var b=a.lastChild;b;){if(this.isListItem(b))return b;if(this.isList(b))b=b.lastChild;else break}return null}catch(c){dalert(c)}};this.getNextListItem=function(a){try{if(!this.isList(a.parentNode))return null;for(var b=a.nodeName,c=null;a;){if((c=this.getNextSibling(a))&&c.nodeName===b)return c;
if(c&&this.isList(c))return this.getFirstListItem(c);if(c)break;else a=a.parentNode}return null}catch(d){dalert(d)}};this.getPreviousListItem=function(a){try{if(!this.isList(a.parentNode))return null;for(var b=a.nodeName,c=null;a;){if((c=this.getPreviousSibling(a))&&c.nodeName===b)return c;if(c&&this.isList(c))return this.getLastListItem(c);if(c)break;else a=a.parentNode}return null}catch(d){dalert(d)}};this.mergeRootList=function(a,b,c,d){try{if(!(this.isList(a)&&this.isList(b)&&a.parentNode&&b.parentNode))return!1;
for(var e=this.getLastChildListArray(a),f=this.getFirstChildListArray(b),g=Math.max(e.length,f.length)-1;0<=g;g--){var h=e[g],k=f[g];if(h&&k&&this.mergeList(h,k,c,d)){var l=this.getDirectULChildren(h);for(a=0;a+1<l.length;a++)this.getNextSibling(l[a])===l[a+1]&&this.mergeList(l[a],l[a+1],!0,!0)&&(l[a+1]=l[a])}}return!0}catch(n){dalert(n)}};this.mergSiblingList=function(a,b,c){try{if(!this.isList(a))return null;!1!==b&&(a=this.mergePreviousList(a));!1!==c&&(a=this.mergeNextList(a));return a}catch(d){dalert(d)}};
this.mergePreviousList=function(a){try{for(var b=g_objNodeUtil,c=null;a;)if(c=this.getPreviousSibling(a),this.isList(c)&&this.isList(a)&&c.nodeName===a.nodeName)b.moveNodesTo(c,a.firstChild),a.parentNode.removeChild(a),a=c;else break;return a}catch(d){dalert(d)}};this.mergeNextList=function(a){try{for(var b=g_objNodeUtil,c=null;a;)if(c=this.getNextSibling(a),this.isList(a)&&this.isList(c)&&a.nodeName===c.nodeName)b.moveNodesTo(a,c.firstChild),c.parentNode.removeChild(c);else break;return a}catch(d){dalert(d)}};
this.mergeList=function(a,b,c,d){try{if(!(a&&b&&this.isList(a)&&this.isList(b)))return!1;var e=a.ownerDocument,f=null;if(!0===c&&a.nodeName!==b.nodeName||!0===d&&this.getListStyle(a)!==this.getListStyle(b))return!1;f=e.createDocumentFragment();g_objNodeUtil.moveNodesTo(f,b.firstChild);a.appendChild(f);b.parentNode&&b.parentNode.removeChild(b);return!0}catch(g){dalert(g)}};this.arrangeList=function(a,b){try{if("UL"===a.nodeName){var c=a.className,d=b.className;if(!fnObjectCheckNull(c)&&""!==c&&c!==
d)return!1}if(dzeJ(a).css("list-style-type")!==dzeJ(b).css("list-style-type"))return!1;for(;b.hasChildNodes();)a.appendChild(b.firstChild);b.parentNode.removeChild(b);b=[];for(c=0;c<a.childNodes.length-1;c++){var e=a.childNodes[c];var f=e.nodeName;"OL"!==f&&"UL"!==f||f!==a.childNodes[c+1].nodeName||(-1===b.indexOf(e)&&b.push(e),b.push(a.childNodes[c+1]))}var g=b.length-1;if(1<b.length)for(c=0;c<g;c++){var h=b[c];var k=b[c+1];fnObjectCheckNull(h)||fnObjectCheckNull(k)||h.nodeName===k.nodeName&&this.arrangeList(h,
k)&&(b[c+1]=h)}return!0}catch(l){dalert(l)}};this.replaceAllParaWithListItem=function(a){try{if(a){var b=a.ownerDocument,c=null,d=g_objNodeUtil,e=a.querySelectorAll("ol>p, ul>p");e=[].slice.call(e);e.forEach(function(a){c||(c=b.createDocumentFragment());d.moveNodesTo(c,a.firstChild);var e=this.isListItem(a.previousSibling)?a.previousSibling.cloneNode(!1):a.parentNode&&"DL"===a.parentNode.nodeName?b.createElement("DD"):b.createElement("LI");e.appendChild(c);a.parentNode.replaceChild(e,a)}.bind(this))}}catch(f){dalert(f)}};
this.removeFirstLastBlankLi=function(a){try{if(!this.isList(a))return!1;for(var b=g_objNodeUtil,c=a.firstChild,d=c.nextSibling;c&&d;){if(this.isListItem(c)&&b.isBlankPara(c))c.parentNode.removeChild(c);else break;c=d;d=c.nextSibling}c=a.lastChild;for(d=c.previousSibling;c&&d;){if(this.isListItem(c)&&b.isBlankPara(c))c.parentNode.removeChild(c);else break;c=d;d=c.previousSibling}return!0}catch(e){dalert(e)}};this.replaceWithLI=function(a){try{var b=a.ownerDocument.createElement("LI");this.copyAttribute(b,
a);g_objNodeUtil.moveNodesTo(b,a.firstChild);a.parentNode.replaceChild(b,a);return b}catch(c){dalert(c)}};this.replaceWithPara=function(a,b){try{if(!this.isListItem(a))return null;b=b||"P";if(!this.isParaNodeName(b))return null;var c=g_objNodeUtil,d=a.ownerDocument,e=this.getRootList(a).parentNode,f=this.getLevel(a),g=d.createElement(b);this.copyAttribute(g,a);0<f&&(g.style.paddingLeft="",g.style.marginLeft=20*f+20+"px");c.splitOn(e,a,function(a){g_objListUtil.onSplit(a)});var h=d.createDocumentFragment();
c.moveNodesTo(h,a.firstChild);g.appendChild(h);a.parentNode.replaceChild(g,a);this.setChildTextStyle(g,this.getTextStyle(g));a=0;for(var k=this.arrTextStyleName.length;a<k;a++)g.style[this.arrTextStyleName[a]]="";""===g.style.cssText&&g.removeAttribute("style");c.insertBrIntoBlankPara(g);return g}catch(l){dalert(l)}};this.replaceWithOL=function(a,b,c){return this.isPara(a)?this.replaceWithListFromPara(a,"OL",b,c):this.isList(a)?this.replaceWithList(a,"OL",b,c):this.isListItem(a)?this.replaceWithListFromListItem(a,
"OL",b,c):null};this.replaceWithUL=function(a,b){return this.isPara(a)?this.replaceWithListFromPara(a,"UL",b):this.isList(a)?this.replaceWithList(a,"UL",b):this.isListItem(a)?this.replaceWithListFromListItem(a,"UL",b):null};this.replaceWithList=function(a,b,c,d){try{var e=g_objNodeUtil,f=null;f="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getSplitNodes(a):[a];for(var g=null,h=null,k=null,l=null,n=a.ownerDocument,m=n.createDocumentFragment(),p=0,r=f.length;p<r;p++)if(h=f[p],h.parentNode){h.nodeName!==
b?(k=n.createElement(b),this.copyAttribute(k,h),e.moveNodesTo(m,h.firstChild),k.appendChild(m),h.parentNode.replaceChild(k,h)):k=h;if("OL"===b||"UL"===b){var t=k.childNodes,q=null;p=0;for(r=t.length;p<r;p++)q=t[p],1!==q.nodeType||"DD"!==q.nodeName&&"DT"!==q.nodeName||this.replaceWithLI(q)}"undefined"!==typeof c?this.setListStyle(k,c):this.followListStyle(k);this.setStart(k,d);l=k.firstChild;this.mergeRootList(this.getPreviousSibling(l.parentNode),l.parentNode,!0,!0);this.mergeRootList(l.parentNode,
this.getNextSibling(l.parentNode),!0,!0);null===g&&h===a&&(g=l.parentNode)}return g}catch(u){dalert(u)}};this.replaceWithListFromListItem=function(a,b,c,d,e,f){try{var g=g_objNodeUtil,h=a.ownerDocument;"OL"!==b&&"UL"!==b||"DD"!==a.nodeName&&"DT"!==a.nodeName||(a=this.replaceWithLI(a));var k=a.parentNode,l=k.parentNode,n=h.createElement(b);this.copyAttribute(n,k);g.splitOn(l,a,function(a){g_objListUtil.onSplit(a)});this.copySplitAttribute(n,a.nextSibling);a.parentNode.replaceChild(n,a);n.appendChild(a);
null!==c&&"undefined"!==typeof c?this.setListStyle(n,c):this.followListStyle(n);this.setStart(n,d);!1!==e&&(n=a.parentNode,this.mergeRootList(this.getPreviousSibling(n),n,!0,!0));!1!==f&&(n=a.parentNode,this.mergeRootList(n,this.getNextSibling(n),!0,!0));return a}catch(m){dalert(m)}};this.replaceWithListFromPara=function(a,b,c,d){try{if(!this.isPara(a)||!a.parentNode||!this.isListNodeName(b))return null;var e=g_objNodeUtil,f=a.ownerDocument,g=f.createElement(b),h=f.createElement("DL"===b?"DD":"LI"),
k=g;g.appendChild(h);this.copyAttribute(h,a);this.setTextStyle(h,this.getChildSameTextStyle(a));"undefined"!==typeof c&&this.setListStyle(g,c);this.setStart(g,d);d=0;for(var l=g_objCommonUtil.toPx(a.style.marginLeft)||0;20<=l;)l-=20,d++;for(var n=[].slice.call(a.childNodes),m=null,p=0,r=n.length;p<r;p++)if((m=n[p])&&1===m.nodeType&&"SPAN"===m.nodeName&&g_objPropertyUtil.hasClass(m,"tabSpan"))m.parentNode.removeChild(m),d++;else if(!m||1!==m.nodeType||"SPAN"!==m.nodeName||!g_objPropertyUtil.hasClass(m,
"dze_shape_main"))if(!m||3!==m.nodeType||""!==m.nodeValue)if(!m||1!==m.nodeType||"SPAN"!==m.nodeName||!g_objPropertyUtil.hasClass(m,g_objCaretUtil.arrCaretMarkerClassName))break;if(0<d){h.style.paddingLeft="";h.style.marginLeft=0===l?"":l+"px";""===h.style.cssText&&h.removeAttribute("style");var t=this.getLastChildListArray(this.getPreviousSibling(a)),q=k;for(p=d;0<p;p--)k=t[p]?t[p].cloneNode(!1):f.createElement(b),k.appendChild(q),q=k}var u=f.createDocumentFragment();e.moveNodesTo(u,a.firstChild);
h.appendChild(u);a.parentNode.replaceChild(k,a);for(q=g;q!==k;)(!c||c&&q!==g)&&this.followListStyle(q),q=q.parentNode;k=this.getRootList(h);this.mergeRootList(this.getPreviousSibling(k),k,!0);k=this.getRootList(h);this.mergeRootList(k,this.getNextSibling(k),!0);return h}catch(v){dalert(v)}};this.onSplit=function(a){try{this.removeEmptyList(a.previousSibling);this.removeEmptyList(a.nextSibling);var b=a.previousSibling,c=a.nextSibling;b&&"OL"===b.nodeName&&c&&"OL"===c.nodeName&&b.style.listStyleType===
c.style.listStyleType&&this.continueStart(c,b)}catch(d){dalert(d)}};this.removeEmptyList=function(a){this.isList(a)&&!a.firstChild&&a.parentNode.removeChild(a)};this.copyAttribute=function(a,b){try{var c=g_objNodeUtil.copyAttribute(a,b);if(this.isList(a)){var d=a.nodeName;"UL"!==d&&"DL"!==d||a.removeAttribute("start");"UL"!==d||this.isULStyle(a.style.listStyleType)||(a.style.listStyleType="",""===a.style.cssText&&a.removeAttribute("style"))}var e=a.style.textAlign;this.isListItem(a)?a.style.listStylePosition=
"center"===e||"right"===e?"inside":"":a.style.listStylePosition="";""===a.style.cssText&&a.removeAttribute("style");return c}catch(f){dalert(f)}};this.copySplitAttribute=function(a,b){try{if(!(a&&b&&a.hasAttribute&&b.hasAttribute))return!1;if("undefined"!==typeof g_objSplitUtil){var c=g_objSplitUtil.DZE_SPLIT,d=g_objSplitUtil.DZE_SPLIT_CHILD;b.hasAttribute&&b.hasAttribute(c)&&a.setAttribute(c,b.getAttribute(c));b.hasAttribute(d)&&a.setAttribute(d,b.getAttribute(d));return!0}return!1}catch(e){dalert(e)}};
this.setTextStyle=function(a,b){try{Object.keys(b).forEach(function(c){a.style[c]=b[c]})}catch(c){dalert(c)}};this.textNodefilter=function(a){return"undefined"!==typeof g_objSelectedShapesArray&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()||!g_objPropertyUtil.hasClass(a,"dze_shape_main")?3!==a.nodeType?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT};this.setChildTextStyle=function(a,b){try{var c=Object.keys(b);if(0===c.length)return!1;
var d=a.ownerDocument,e=d.createTreeWalker(a,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,this.textNodefilter,!0),f=this,g=e.firstChild();for(a=null;g;){a=e.nextNode();var h=g.parentNode;g_objNodeUtil.isInlineNode(h)||(h=d.createElement("SPAN"),g.parentNode.replaceChild(h,g),h.appendChild(g));c.forEach(function(a){f.isDefaultTextStyle(a,h.style[a])&&h.style[a]!==b[a]&&(h.style[a]=b[a])});g=a}return!0}catch(k){dalert(k)}};this.getTextStyle=function(a){try{for(var b={},c="",d="",e=null,f=0,g=this.arrTextStyleName.length;f<
g;f++){c=this.arrTextStyleName[f];d="";if(3===a.nodeType)for(e=a.parentNode;e&&""===d&&!g_objNodeUtil.isBoundNode(e);)d=this.getTextStyleValue(e,c),e=e.parentNode;else d=this.getTextStyleValue(a,c);d&&(b[c]=d)}return b}catch(h){dalert(h)}};this.getTextStyleValue=function(a,b){try{if(!a||1!==a.nodeType)return"";var c=a.nodeName,d=a.style[b];if(""===d&&this.isHeadNodeName(c)){if("fontSize"===b)return"H1"===c?"21pt":"H2"===c?"18pt":"H3"===c?"15pt":"H4"===c?"12pt":"H5"===c?"10pt":"";if("fontWeight"===
b)return"bold"}return d}catch(e){dalert(e)}};this.isDefaultTextStyle=function(a,b){return!b||""===b||"normal"===b||"none"===b||"verticalAlign"===a&&"baseline"===b||"color"===a&&"baseline"===b||"fontSize"===a&&b===g_strBodyFontSize||"fontFamily"===a&&b===g_strBodyFontFamily?!0:!1};this.deleteDefaultTextStyle=function(a){try{for(var b="",c="",d=0,e=this.arrTextStyleName.length;d<e;d++)b=this.arrTextStyleName[d],(c=a[b])&&this.isDefaultTextStyle(b,c)&&delete a[b];return a}catch(f){dalert(f)}};this.mergeTextStyle=
function(a,b){for(var c={},d,e=0,f=this.arrTextStyleName.length;e<f;e++)d=this.arrTextStyleName[e],a[d]&&b[d]&&a[d]===b[d]&&(c[d]=b[d]);return c};this.getChildSameTextStyle=function(a){try{var b=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,this.textNodefilter,!0),c=null;for(a=b.firstChild();a;){if(c){var d=this.getTextStyle(a);c=this.mergeTextStyle(c,d)}else c=this.getTextStyle(a);a=b.nextNode()}c&&(c=this.deleteDefaultTextStyle(c));return c||{}}catch(e){dalert(e)}};
this.followListStyle=function(a){try{if(!this.isList(a))return!1;var b=this.getPreviousList(a),c=this.getListStyle(b);if(!c){var d=this.getLevel(a),e=this.getDefaultListStyleArray(a.nodeName);e&&e[d]&&(c=e[d])}this.setListStyle(a,c);return!0}catch(f){dalert(f)}};this.getListFilter=function(a,b){var c=this;return function(d){if(!c.isList(d)||a&&d.nodeName!==a)return NodeFilter.FILTER_SKIP;if(!isNaN(b)){d=c.getLevel(d);if(d>b)return NodeFilter.FILTER_REJECT;if(d<b)return NodeFilter.FILTER_SKIP}return NodeFilter.FILTER_ACCEPT}};
this.getPreviousList=function(a){try{if(!this.isList(a))return null;var b=a.ownerDocument,c=this.getRootList(a),d=this.getLevel(a),e=null;e="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getSplitNodes(c):[c];for(var f=c=null,g=null,h=0,k=e.length;h<k;h++)for(c=b.createTreeWalker(e[h],NodeFilter.SHOW_ELEMENT,this.getListFilter(a.nodeName,d),!0),f=c.firstChild();f;){if(f===a)return g&&g!==a?g:null;g=f;f=c.nextNode()}return null}catch(l){dalert(l)}};this.getLastChildList=function(a,b,c){try{if(!this.isList(a)||
isNaN(c))return null;var d=a.ownerDocument,e=null;e="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getSplitNodes(a):[a];for(var f=a=null,g=null,h=0,k=e.length;h<k;h++)for(a=d.createTreeWalker(e[h],NodeFilter.SHOW_ELEMENT,this.getListFilter(b,c),!0),f=a.firstChild();f;)g=f,f=a.nextNode();return g}catch(l){dalert(l)}};this.findPreviousList=function(a){function b(a){if(!a)return null;var b=g_objListUtil.getPreviousSibling(a);if(b)return b;if(g_objNodeUtil.isCell(a))return g_objTableFunction.getFindUpDownCell(a,
!0);if(g_objNodeUtil.isCell(a.parentNode)){var c=g_objTableFunction;for(b=c.getFindUpDownCell(a.parentNode,!0);b&&!b.lastChild;)b=c.getFindUpDownCell(b,!0);return b?b.lastChild:null}if(a&&g_objNodeUtil.isPageMain(a.parentNode)&&(c=g_objPageControl,"undefined"!==typeof c)){for(b=c.getPageMain(c.getPageNum(a.parentNode)-1);b&&!b.lastChild;)b=c.getPageMain(c.getPageNum(b)-1);return b?b.lastChild:null}return null}try{if(!this.isList(a))return null;for(var c=this.getRootList(a),d=this.getLevel(a),e=a.nodeName,
f=this.getListFilter(e,d),g=c;g;){if(0===d&&g!==a&&f(g)===NodeFilter.FILTER_ACCEPT)return g;if(0<d&&this.isList(g)&&(prevList=g===c?this.getPreviousList(a):this.getLastChildList(g,e,d)))return prevList;g=b(g)}return null}catch(h){dalert(h)}}};

var g_objWrapperOutlineUtil=new function(){var b=this;this.objOutlineUtil=null;this.nExtOutlineRectPressedType=OUTLINE_INDICATOR.NONE;this.initializeExtOutline=function(b){try{this.objOutlineUtil=new outlineUtil;this.objOutlineUtil.initializeExtOutline(b);for(var a=this,c=EventUtil,d=OUTLINE_INDICATOR.LEFT,h=this.objOutlineUtil.arrObj_Outline_Rectangle,f=null,k=OUTLINE_INDICATOR.LEFT_TOP;k<=d;k++)f=h[k],function(){var b=k;c.addHandler(f,"mousedown",function(c){a.outlineRectangle_onmousedown(b,c)});
c.addHandler(f,"touchstart",function(c){a.outlineRectangle_onmousedown(b,c)})}()}catch(l){dalert(l)}};this.unload=function(){try{this.objOutlineUtil&&(this.objOutlineUtil.unload(),this.objOutlineUtil=null)}catch(d){dalert(d)}};this.getDocument=function(){return this.objOutlineUtil?this.objOutlineUtil.getDocument():document};this.showExtOutline=function(d,a,c,e,h){try{if(null!=this.objOutlineUtil){var f=0,k=0,l=0,p=0;if(a){if(null==d||null==g_objWrapperOutlineResize.objExtSelectedInfo)return!1;var g=
null,n=g_objWrapperOutlineResize.objExtSelectedInfo.nObjType;switch(n){case DZE_OBJ_TEXTBOX:case DZE_OBJ_IMG:case DZE_OBJ_TABLE:case DZE_OBJ_TD:case DZE_OBJ_VIDEO:g=g_objPositionUtil.getElementPosClientRect(d);break;case DZE_OBJ_HR:g=g_objPositionUtil.getElementPosClientRect(d);g.top-=6;g.bottom+=6;break;default:return!1}if(n===DZE_OBJ_TABLE||n===DZE_OBJ_TD){var q=g_objNodeUtil.getLoopParentElement(d,"table");this.objOutlineUtil.bResizeAllowed=g_objTableFunction.canTableResize(q)}else this.objOutlineUtil.bResizeAllowed=
!0;var m=g_objPositionUtil.getElementPosition(g_objEditObject[h],!1);f=m.left+g.left;k=m.top+g.top;l=m.left+g.right;p=m.top+g.bottom}this.objOutlineUtil.showExtOutline(a,c,e,f,k,l,p,!0,!0);a||g_objTransparentViewUtil.showTransparentView(!1,null,b.getDocument())}}catch(r){dalert(r)}};this.outlineRectangle_onmousedown=function(d,a){try{if(null!=g_objWrapperOutlineResize.objExtSelectedInfo){TBCancelBubbleEvent(a);var c=g_nActiveEditNumber;g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[c]=!0);b.nExtOutlineRectPressedType=
d;var e=g_objWrapperOutlineResize.objExtSelectedInfo.objElement;switch(g_objWrapperOutlineResize.objExtSelectedInfo.nObjType){case DZE_OBJ_IMG:case DZE_OBJ_VIDEO:case DZE_OBJ_TEXTBOX:g_objWrapperOutlineResize.newExtDragPosInfo(e,a,c);break;case DZE_OBJ_TD:var h=g_objNodeUtil.getLoopParentElement(e,"table");if(!h||!g_objTableFunction.canTableResize(h))return;g_objTableResize.prepareResize(h,!0);g_objWrapperOutlineResize.newExtDragPosInfo(e,a,c);break;case DZE_OBJ_TABLE:if(!g_objTableFunction.canTableResize(e))return;
g_objTableResize.prepareResize(e,!0);g_objWrapperOutlineResize.newExtDragPosInfo(e,a,c);break;default:return}g_bTableResizingYN&&g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objTransparentViewUtil.showTransparentView(!0,0,b.getDocument());b.addMouseListener(a)}}catch(f){dalert(f)}};this.outlineRectangle_onmousemove=function(d){try{if(-1!=b.nExtOutlineRectPressedType){var a=g_objWrapperOutlineResize.objExtSelectedInfo,c=a.nObjType,e=a.objElement,h=b.nExtOutlineRectPressedType;a=g_nActiveEditNumber;
switch(c){case DZE_OBJ_IMG:case DZE_OBJ_VIDEO:case DZE_OBJ_TD:case DZE_OBJ_TABLE:g_objWrapperOutlineResize.resizePositionByDragForExtMode(c,e,d,h,a)}}}catch(f){dalert(f)}};this.outlineRectangle_onmouseup=function(d){try{if(g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=!1),null!=g_objWrapperOutlineResize.objExtSelectedInfo){DZE_OBJ_TABLE==g_objWrapperOutlineResize.objExtSelectedInfo.nObjType&&g_objWrapperOutlineResize.afterResizeTargetElement(b.nExtOutlineRectPressedType,
g_nActiveEditNumber);b.nExtOutlineRectPressedType=OUTLINE_INDICATOR.NONE;g_objWrapperOutlineResize.objExtDragPosInfo=null;g_objTransparentViewUtil.showTransparentView(!1,null,b.getDocument());b.removeMouseListener(d);switch(g_objWrapperOutlineResize.objExtSelectedInfo.nObjType){case DZE_OBJ_VIDEO:case DZE_OBJ_TEXTBOX:case DZE_OBJ_IMG:b.showExtOutline(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!0,!1,g_nActiveEditNumber);break;case DZE_OBJ_TABLE:case DZE_OBJ_TD:b.showExtOutline(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,
!0,!0,!1,g_nActiveEditNumber)}g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}}catch(a){dalert(a)}};this.addMouseListener=function(d){try{var a=EventUtil,c=b.getDocument();"touchstart"===d.type?(a.addHandler(c,"touchmove",b.outlineRectangle_onmousemove),a.addHandler(c,"touchend",b.outlineRectangle_onmouseup)):(a.addHandler(c,"mousemove",b.outlineRectangle_onmousemove),a.addHandler(c,"mouseup",b.outlineRectangle_onmouseup))}catch(e){dalert(e)}};this.removeMouseListener=function(d){try{var a=
EventUtil,c=b.getDocument();"touchend"===d.type?(a.removeHandler(c,"touchmove",b.outlineRectangle_onmousemove),a.removeHandler(c,"touchend",b.outlineRectangle_onmouseup)):(a.removeHandler(c,"mousemove",b.outlineRectangle_onmousemove),a.removeHandler(c,"mouseup",b.outlineRectangle_onmouseup))}catch(e){dalert(e)}}};

var handlerUI={arrCommandUpdateIndex:[],arrContextUpdateIndex:[],arrMenuTableUpdateIndex:[],getCommandUpdateIndex:function(b,a){try{if("undefined"==typeof this.arrCommandUpdateIndex[b]||"undefined"==typeof this.arrCommandUpdateIndex[b][a])return-1;var c=this.arrCommandUpdateIndex[b][a];return null==c?-1:c}catch(d){dalert(d)}return-1},setCommandUpdateIndex:function(b,a,c){try{fnObjectCheckNull(this.arrCommandUpdateIndex[b])&&(this.arrCommandUpdateIndex[b]=[]),this.arrCommandUpdateIndex[b][a]=c}catch(d){dalert(d)}},
getContextUpdateIndex:function(b,a){try{var c=this.arrContextUpdateIndex[b][a];return null==c?-1:c}catch(d){dalert(d)}return-1},setContextUpdateIndex:function(b,a,c){try{fnObjectCheckNull(this.arrContextUpdateIndex[b])&&(this.arrContextUpdateIndex[b]=[]),this.arrContextUpdateIndex[b][a]=c}catch(d){dalert(d)}},getMenuTableUpdateIndex:function(b){try{var a=this.arrCommandUpdateIndex[b];return null==a?-1:a}catch(c){dalert(c)}return-1},setMenuTableUpdateIndex:function(b,a){try{this.arrCommandUpdateIndex[b]=
a}catch(c){dalert(c)}},queryCommandStatus:function(b,a,c,d,n,k){try{var f=!1,e=!1,l=!1;if(a==ID_COMMAND_BOLD||a==ID_COMMAND_ITALIC||a==ID_COMMAND_UNDERLINE||a==ID_COMMAND_STRIKE||a==ID_COMMAND_SUBSCRIPT||a==ID_COMMAND_SUPERSCRIPT||a==ID_COMMAND_CUT||a==ID_COMMAND_COPY||a==ID_COMMAND_DELETE||a==ID_COMMAND_SELECT_ALL||a==ID_COMMAND_HORIZONTAL_RULE||a==ID_CUSTOM_COPY_EXT){try{f=b.queryCommandState(c);e=b.queryCommandEnabled(c);var t=GetCurRange(d);a!=ID_COMMAND_CUT&&a!=ID_COMMAND_COPY||!g_bBrowserType_EDGE||
null==t||t.collapsed||(f=!1,e=!0)}catch(p){e=f=!1}a!=ID_COMMAND_CUT&&a!=ID_COMMAND_COPY||!GetMultiCellSelection(d)||(e=!0)}else if(a===ID_COMMAND_INSERT_ORDERED_LIST||a===ID_COMMAND_INSERT_UNORDERED_LIST||a===ID_COMMAND_STYLE_CASCADE_ORDERLIST)if(e=!0,f=!1,"undefined"!==typeof g_objSelectedShapesArray&&"undefined"!==typeof g_objShapeEvtMgr&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()&&(e=!1),a===ID_COMMAND_INSERT_ORDERED_LIST){var g=GetCurList(d);g&&"OL"===g.nodeName&&
(f=!0)}else a===ID_COMMAND_INSERT_UNORDERED_LIST&&(g=GetCurList(d))&&"UL"===g.nodeName&&(f=!0);else if(a===ID_COMMAND_SET_LIST_START_NEW){l=!0;var m=GetCurListItem(d);!m||!m.parentNode||"OL"!==m.parentNode.nodeName||"undefined"===typeof g_objListUtil||g_objListUtil.isFirstListItem(m)&&1===g_objListUtil.getStart(m.parentNode)||(e=!0,l=!1)}else if(a===ID_COMMAND_SET_LIST_START_CONTINUE)l=!0,(g=GetCurList(d))&&"OL"===g.nodeName&&(e=!0,l=!1);else if(a==ID_COMMAND_PASTE||a==ID_COMMAND_PASTE_EXT)if(g_bBrowserType_IE)try{f=
b.queryCommandState(c),e=b.queryCommandEnabled(c)}catch(p){e=f=!1}else{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)f=!1,e=!0}else if(a==ID_COMMAND_OUTDENT||a==ID_COMMAND_INDENT||a==ID_COMMAND_FORE_COLOR||a==ID_COMMAND_BACK_COLOR||a==ID_COMMAND_HYPERLINK_INSERT||a==ID_COMMAND_HYPERLINK_REMOVE||a==ID_COMMAND_INSERT_IMAGE||a==ID_COMMAND_INSERT_STAMP)if(g_bBrowserType_IE){if(f=b.queryCommandState(c),e=b.queryCommandEnabled(c),a==ID_COMMAND_HYPERLINK_INSERT&&e&&ID_STRING_NAME_CONTROL!=k){var r=
getSelectionTextValue(d);if(""==r)if(window.attachEvent){var u=g_objEditorDocument[d].selection;if(null==u)e=!1;else{var v=u.createRange().parentElement(),h=g_objNodeUtil.getLoopParentElement(v,"a");e=h?!0:!1}}else e=(h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,d))?!0:!1}}else{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){try{f=b.queryCommandState(c)}catch(p){f=!1}a==ID_COMMAND_HYPERLINK_INSERT||a==ID_COMMAND_HYPERLINK_REMOVE?ID_STRING_NAME_NONE==k||ID_STRING_NAME_TEXT==k||null==
k?(r=getSelectionTextValue(d),e=""==r?(h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,d))?g_bBrowserType_WK||g_bBrowserType_OP?!0:b.queryCommandEnabled(c):!1:ID_STRING_COMMAND_UNLINK==c?(h=g_objNodeUtil.getSelectionElement_Anchor("A",!1,d))?b.queryCommandEnabled(c):!1:b.queryCommandEnabled(c)):ID_STRING_NAME_CONTROL==k&&("img"==getSelectionElementNode(d).nodeName.toLowerCase()?ID_STRING_COMMAND_CREATELINK==c?(f=!1,e=!0):ID_STRING_COMMAND_UNLINK==c&&((h=g_objNodeUtil.getSelectionElement_Anchor("A",
!1,d))?(f=!1,e=!0):e=f=!1):e=f=!1):e=b.queryCommandEnabled(c)}}else if(a==ID_COMMAND_JUSTIFY_LEFT||a==ID_COMMAND_JUSTIFY_CENTER||a==ID_COMMAND_JUSTIFY_RIGHT||a==ID_COMMAND_JUSTIFY_JUSTIFY)f=!1,e=!0,1==n&&a==ID_COMMAND_JUSTIFY_LEFT?f=!0:2==n&&a==ID_COMMAND_JUSTIFY_CENTER?f=!0:3==n&&a==ID_COMMAND_JUSTIFY_RIGHT?f=!0:4==n&&a==ID_COMMAND_JUSTIFY_JUSTIFY&&(f=!0);else{if(a==ID_COMMAND_UNDO||a==ID_COMMAND_REDO){var q=g_objUndoRedo.arrUndoRedoStruct[d];return null==q?ID_STRING_NAME_GRAY:a==ID_COMMAND_UNDO?
0==q.nUndoRedoStackPos?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED:q.nUndoRedoStack_LastEventPos<=q.nUndoRedoStackPos?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED}return a==ID_COMMAND_FORM_TABLE||a==ID_COMMAND_DRAW_TABLE?ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_FORM_TAG_SWITCH?g_objTagUtil.bFormTagSwitch?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_FORM_TAG_CHECKBOX||a==ID_COMMAND_FORM_TAG_SELECT||a==ID_COMMAND_EDIT_REPLACE_CASE?ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_INSERT_BOOKMARK?
!0===dzeUiConfig.bDoNotUseBookmark?ID_STRING_NAME_HIDE:ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_EDIT_PASTESPECIAL||a==ID_COMMAND_EDIT_SEARCH||a==ID_COMMAND_EDIT_REPLACE||a==ID_COMMAND_INSERT_SPECIALCHARS||a==ID_COMMAND_INSERT_EMOTICONS||a==ID_COMMAND_INSERT_OBJECT_MOVIE||a==ID_COMMAND_INSERT_OBJECT_FILE||a==ID_COMMAND_INSERT_OBJECT_HR||a==ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT||a==ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT||a==ID_COMMAND_STYLE_INCREASE_FONTSIZE||a==ID_COMMAND_STYLE_DECREASE_FONTSIZE||a==
ID_COMMAND_INSERT_BOOKMARK||a==ID_COMMAND_INSERT_OBJECT||a==ID_COMMAND_INSERT_PARAGRAPH||a==ID_COMMAND_STYLE_INCREASEORDER||a==ID_COMMAND_STYLE_DECREASEORDER||a==ID_COMMAND_FILE_NEW||a==ID_COMMAND_FILE_OPEN||a==ID_COMMAND_FILE_LAYOUT||a==ID_COMMAND_EDIT_REPLACE_CASE||a==ID_COMMAND_STYLE_FONT||a==ID_COMMAND_STYLE_PARAGRAPH||a==ID_COMMAND_IMAGE_PROPERTY||a==ID_COMMAND_IMAGE_RESET_PICTURE||a==ID_COMMAND_IMAGE_TO_TABLE?ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_HELP?ID_STRING_NAME_GRAY:a==ID_COMMAND_FULLSCREEN?
!0===g_bFullScreenMode?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_EDIT_PRIINT_PAGE_BREAK?GetCurTable(d)?ID_STRING_NAME_GRAY:GetCurTable(d)?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED:a==ID_COMMAND_INIT_CURSOR||a==ID_COMMAND_INIT_CURSOR_REMOVE?(h=g_objNodeUtil.getSelectionElement_NodeChk(d,"dze_init_cursor_flag"))?ID_STRING_NAME_CHECKED:a==ID_COMMAND_INIT_CURSOR_REMOVE?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED:null}if(f&&e)return ID_STRING_NAME_CHECKED;if(!f&&e)return ID_STRING_NAME_UNCHECKED;
if(l)return ID_STRING_NAME_HIDE;if(!e)return ID_STRING_NAME_GRAY}catch(p){dalert(p)}return null},setDisableMenu:function(b,a){var c=!0,d=GetCurTable();!1===fnObjectCheckNull(d)&&(c=!0===a?!0:g_objTableFunction.hasLockedEditCell(d,!1));"number"!=typeof b&&(b=Number(b));switch(b){case ID_COMMAND_CUT:case ID_COMMAND_PASTE:case ID_COMMAND_EDIT_PASTESPECIAL:case ID_COMMAND_DELETE:case ID_COMMAND_STYLE_FONT:case ID_COMMAND_STYLE_PARAGRAPH:case ID_COMMAND_STYLE_STYLE:case ID_COMMAND_STYLE_UNORDEREDLIST:case ID_COMMAND_STYLE_ORDEREDLIST:case ID_COMMAND_INSERT_ORDERED_LIST:case ID_COMMAND_INSERT_UNORDERED_LIST:case ID_COMMAND_JUSTIFY_LEFT:case ID_COMMAND_JUSTIFY_CENTER:case ID_COMMAND_JUSTIFY_RIGHT:case ID_COMMAND_JUSTIFY_JUSTIFY:case ID_COMMAND_OUTDENT:case ID_COMMAND_INDENT:case ID_COMMAND_INSERT_IMAGE:case ID_COMMAND_INSERT_OBJECT:case ID_COMMAND_INSERT_OBJECT_MOVIE:case ID_COMMAND_INSERT_OBJECT_FILE:case ID_COMMAND_INSERT_OBJECT_HR:case ID_COMMAND_INSERT_SPECIALCHARS:case ID_COMMAND_HYPERLINK_INSERT:case ID_COMMAND_INIT_CURSOR:case ID_COMMAND_INSERT_STAMP:case ID_COMMAND_IMAGE_PROPERTY:case ID_COMMAND_STYLE_INCREASE_FONTSIZE:case ID_COMMAND_STYLE_DECREASE_FONTSIZE:case ID_COMMAND_BOLD:case ID_COMMAND_ITALIC:case ID_COMMAND_UNDERLINE:case ID_COMMAND_STRIKE:case ID_COMMAND_SUPERSCRIPT:case ID_COMMAND_SUBSCRIPT:case ID_COMMAND_FORE_COLOR:case ID_COMMAND_BACK_COLOR:case ID_COMMAND_HEADING_SIZE:case ID_COMMAND_FONT_NAME:case ID_COMMAND_FONT_SIZE:case ID_COMMAND_LINE_HEIGHT:case ID_COMMAND_LETTER_SPACING:case ID_COMMAND_TABLE_CELL_PROPERTY:case ID_COMMAND_TABLE_CREATE:case ID_COMMAND_DRAW_TABLE:case ID_COMMAND_TABLE_CELL_STYLE:if(b===
ID_COMMAND_TABLE_CELL_STYLE&&!0===GetMultiCellSelection())return!1;case ID_COMMAND_TABLE_CELL_ALIGN:case ID_COMMAND_TABLE_CELL_BACKCOLOR:case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SPLIT_CELL:case ID_COMMAND_TABLE_FORMULA:case ID_COMMAND_TABLE_SELECT_FORMULA:case ID_COMMAND_TABLE_NUMBER_FORMAT:return!0!==a&&b===ID_COMMAND_TABLE_NUMBER_FORMAT&&!0===GetMultiCellSelection()?!1:c?!0:!1;case ID_COMMAND_TABLE_DELETE_ROW:if(!0!==a)return g_objTableFunction.isIncludedProtectedCellInRow();case ID_COMMAND_TABLE_DELETE_COL:if(!0!==
a)return g_objTableFunction.isIncludedProtectedCellInColumn();case ID_COMMAND_TABLE_DELETE_TABLE:case ID_COMMAND_TABLE_CONVERT_TEXT:return!0;case ID_COMMAND_TABLE_CELL_SAME_HEIGHT:case ID_COMMAND_TABLE_CELL_SAME_WIDTH:case ID_COMMAND_TABLE_ADD_ROW:case ID_COMMAND_TABLE_ADD_COL:case ID_COMMAND_TABLE_ADD_ROW_DOWN:case ID_COMMAND_TABLE_ADD_COL_RIGHT:if(!0===a)return!0;default:return!1}}};

var updateHandlerUI={update_toolbar_button:function(b,a){try{var f=g_objEditorDocument[a];if(ID_STRING_NAME_CONTROL==b){var d=getSelectionControl(a);if(1==d.rangeLength){for(var e=d.controlObject.tagName.toLowerCase(),c=0;c<g_TBButton[a].length;c++){var g=g_TBButton[a][c].command_id,h=g_TBButton[a][c].element,n=g_TBButton[a][c].element.command;if(ID_SUPPORT_CONTROL_TYPE_NO==g_TBButton[a][c].support_control_type)TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type);
else if(ID_SUPPORT_CONTROL_TYPE_YES==g_TBButton[a][c].support_control_type)if(ID_COMMAND_HYPERLINK_INSERT==g||ID_COMMAND_HYPERLINK_REMOVE==g)if("img"==e){var k=handlerUI.queryCommandStatus(f,g,n,a,-1,b);null!=k&&TBSetState(h,k,g_TBButton[a][c].button_type)}else TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type);else ID_COMMAND_INSERT_IMAGE==g||ID_COMMAND_IMAGE_PROPERTY==g||ID_COMMAND_IMAGE_RESET_PICTURE==g?"img"==e?TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_UNCHECKED,
g_TBButton[a][c].button_type):TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type):ID_COMMAND_FORM_TAG_CHECKBOX==g?TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type):ID_COMMAND_FORM_TAG_SELECT==g&&("select"==e?TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_UNCHECKED,g_TBButton[a][c].button_type):TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type))}for(c=0;c<g_TBDropDown[a].length;c++)if(g=g_TBDropDown[a][c].command_id,
ID_COMMAND_IMAGE_BORDER_TYPE==g||ID_COMMAND_IMAGE_BORDER_THICKNESS==g||ID_COMMAND_IMAGE_BORDER_COLOR==g)"img"==e?TBSetState(g_TBDropDown[a][c].element,ID_STRING_NAME_UNCHECKED,g_TBDropDown[a][c].button_type):TBSetState(g_TBDropDown[a][c].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][c].button_type)}else for(c=0;c<g_TBButton[a].length;c++)ID_SUPPORT_CONTROL_TYPE_INDEPENDENT!=g_TBButton[a][c].support_control_type&&TBSetState(g_TBButton[a][c].element,ID_STRING_NAME_GRAY,g_TBButton[a][c].button_type)}else{var l=
getAlignValueForSelectionArea(a),m=GetCurTable(a);for(c=0;c<g_TBButton[a].length;c++)g=g_TBButton[a][c].command_id,h=g_TBButton[a][c].element,n=g_TBButton[a][c].element.command,k=handlerUI.queryCommandStatus(f,g,n,a,l,b),d=null,!1===fnObjectCheckNull(m)&&!1===g_objTableFunction.isEditableTable(m)?d=handlerUI.setDisableMenu(g,!0):dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(d=handlerUI.setDisableMenu(g)),k=1==d?ID_STRING_NAME_GRAY:k,null!=k&&TBSetState(h,k,g_TBButton[a][c].button_type)}}catch(p){dalert(p)}},
update_toolbar_combobox:function(b,a){try{var f=!1;if(ID_STRING_NAME_CONTROL==b)for(var d=0;d<g_TBComboBox[a].length;d++){if(ID_SUPPORT_CONTROL_TYPE_NO==g_TBComboBox[a][d].support_control_type){TBSetState(g_TBComboBox[a][d].element,ID_STRING_NAME_GRAY,g_TBComboBox[a][d].button_type);var e=g_objNodeUtil.getChildrenCollection(g_TBComboBoxLabel[a][d].element);if(null==e)break;for(var c=0;c<e.length;c++)e[c].style.display="none"}}else{b=null;var g=!1;GetMultiCellSelection()?(g=!0,b=g_objPropertyUtil.getSelectionAttributeValue_MultiCell(a)):
b=g_objPropertyUtil.getSelectionAttributeValue(a);if("undefined"!=typeof b&&null!=b){var h=GetCurTable(a);duzon_dialog.initSelectionFontStyleList(b);for(d=0;d<g_TBComboBox[a].length;d++){var n=g_TBComboBox[a][d].element,k=g_TBComboBox[a][d].element.command,l=g_TBComboBox[a][d].element.command_id;if(l==ID_COMMAND_FONT_NAME||l==ID_COMMAND_FONT_SIZE||l==ID_COMMAND_HEADING_SIZE)if(g)f=!0;else try{f=g_objEditorDocument[a].queryCommandEnabled(k)}catch(p){f=!1}else if(l==ID_COMMAND_LETTER_SPACING||l==ID_COMMAND_LINE_HEIGHT)if(g)f=
!0;else try{f=g_objEditorDocument[a].queryCommandEnabled("FontName")}catch(p){f=!1}else break;var m=null;!1===fnObjectCheckNull(h)&&!1===g_objTableFunction.isEditableTable(h)?m=handlerUI.setDisableMenu(l,!0):dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(m=handlerUI.setDisableMenu(l));if(f=1==m?!1:f)TBSetState(n,ID_STRING_NAME_UNCHECKED,g_TBComboBox[a][d].button_type),m=-1,l==ID_COMMAND_FONT_NAME?"INPUT"===g_TBComboBoxLabel[a][d].element.nodeName?g_TBComboBoxLabel[a][d].element.value=""==
duzon_dialog.selectionFontStyleList.fontFamily?ID_RES_CONST_STRING_FONT_NAME:duzon_dialog.selectionFontStyleList.fontFamily.replace(/["']/g,""):g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.fontFamily?"<span>"+ID_RES_CONST_STRING_FONT_NAME+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.fontFamily.replace(/["']/g,"")+"</span>":l==ID_COMMAND_FONT_SIZE?g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.fontSize?"<span>"+ID_RES_CONST_STRING_FONT_SIZE+
"</span>":"<span>"+duzon_dialog.selectionFontStyleList.fontSize+"</span>":l==ID_COMMAND_HEADING_SIZE?(m=this.getMappingIndex_Heading(a),-1==m&&(m=0),g_TBComboBoxLabel[a][d].element.innerHTML=0==m?"<span>"+ID_RES_CONST_STRING_HEADING_SIZE+"</span>":"<span>"+g_objComboBoxWin.arrHeadingText[m]+"</span>"):l==ID_COMMAND_LETTER_SPACING?g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.letterSpacing?"<span>"+ID_RES_CONST_STRING_LETTER_SPACING+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.letterSpacing+
"</span>":l==ID_COMMAND_LINE_HEIGHT&&(null==b[5]&&(b[5]=""),g_TBComboBoxLabel[a][d].element.innerHTML=null==b[5]||""==b[5]?"<span>"+ID_RES_CONST_STRING_LINE_HEIGHT+"</span>":"<span>"+parseInt(Math.round(100*parseFloat(b[5])),10)+"%</span>");else{TBSetState(n,ID_STRING_NAME_GRAY,g_TBComboBox[a][d].button_type);e=g_objNodeUtil.getChildrenCollection(g_TBComboBoxLabel[a][d].element);if(null==e)break;for(c=0;c<e.length;c++)ID_SELECTION_ELEMENT_NODE==e[c].nodeType&&(e[c].style.display="none")}}}}}catch(p){dalert(p)}},
getMappingIndex_FontName:function(b,a){try{for(a=0;a<g_arrFontName.length;a++){if("undefined"==typeof b||null==b||""==b)return 0;if(b.toLowerCase()==g_arrFontName[a])return a}return-1}catch(f){dalert(f)}},getMappingIndex_FontSize:function(b,a){try{if(null==b)return-1;for(a=0;a<g_objComboBoxWin.arrFontSize.length;a++)if(b==g_objComboBoxWin.arrFontSize[a])return a;b=b.toLowerCase();a=-1;"11px"==b?a=1:"12px"==b?a=2:"13px"==b?a=3:"15px"==b?a=4:"16px"==b?a=5:"17px"==b?a=6:"19px"==b?a=7:"21px"==b?a=8:"22px"==
b?a=9:"23px"==b?a=10:"24px"==b?a=11:"25px"==b?a=12:"26px"==b?a=13:"32px"==b?a=14:"40px"==b?a=15:"48px"==b&&(a=16);return a}catch(f){dalert(f)}},getMappingIndex_LetterSpacing:function(b,a){try{if(null==b)return-1;b=b.toLowerCase();for(a=0;a<g_objLetterSpacingWin.arrLetterSpacing.length;a++)if(b==g_objLetterSpacingWin.arrLetterSpacing[a])return a;return-1}catch(f){dalert(f)}},getMappingIndex_LineHeight:function(b,a){try{if(null==b)return-1;for(a=0;a<g_objLineHeightWin.arrLineHeight.length;a++)if(b==
g_objLineHeightWin.arrLineHeight[a])return a;return-1}catch(f){dalert(f)}},getMappingIndex_Heading:function(b){try{var a=-1;if(window.attachEvent){var f=g_objEditorDocument[b].selection,d=f.createRange(),e=d.parentElement();""==d.text?a=this.getLoop_ParentHeadingBlock(e):this.is_Include_heading_block(e)||(a=this.getLoop_ParentHeadingBlock(e))}else{f=g_objEditWindow[b].getSelection();if(1!=f.rangeCount)return-1;d=f.getRangeAt(0);e=d.commonAncestorContainer;ID_SELECTION_TEXT_NODE==e.nodeType?(e=g_objNodeUtil.getParentElement(e),
a=this.getLoop_ParentHeadingBlock(e)):this.is_Include_heading_block(e)||(a=this.getLoop_ParentHeadingBlock(e))}return a}catch(c){dalert(c)}return-1},getLoop_ParentHeadingBlock:function(b){try{if(fnObjectCheckNull(b)||ID_SELECTION_ELEMENT_NODE!=b.nodeType)return-1;var a=b.nodeName.toLowerCase();if("body"==a)return-1;var f=this.checkIsHeadingBlock(a);if(-1!=f)return f;for(;;){var d=g_objNodeUtil.getParentElement(b);if(fnObjectCheckNull(d))break;a=d.nodeName.toLowerCase();if("body"==a)break;f=this.checkIsHeadingBlock(a);
if(-1!=f)return f;b=d}}catch(e){dalert(e)}return-1},checkIsHeadingBlock:function(b){try{for(var a=1;a<g_objComboBoxWin.arrHeadingBlock.length;a++)if(b==g_objComboBoxWin.arrHeadingBlock[a])return a}catch(f){dalert(f)}return-1},is_Include_heading_block:function(b){try{if(null==b)return!1;for(var a=0;a<b.childNodes.length;a++){var f=b.childNodes[a];if(ID_SELECTION_ELEMENT_NODE==f.nodeType){var d=f.nodeName.toLowerCase();if(-1!=updateHandlerUI.checkIsHeadingBlock(d)||this.is_Include_heading_block(f))return!0}}}catch(e){dalert(e)}return!1},
update_toolbar_dropdown:function(b,a){try{var f=g_objEditorDocument[a];if(ID_STRING_NAME_CONTROL==b)for(var d=0;d<g_TBDropDown[a].length;d++)ID_SUPPORT_CONTROL_TYPE_NO==g_TBDropDown[a][d].support_control_type&&TBSetState(g_TBDropDown[a][d].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][d].button_type);else{var e=GetCurTable(a);for(d=0;d<g_TBDropDown[a].length;d++){var c=g_TBDropDown[a][d].element,g=g_TBDropDown[a][d].element.command,h=g_TBDropDown[a][d].element.command_id;if(""!=g){var n=handlerUI.queryCommandStatus(f,
h,g,a,-1,b),k=!1;!1===fnObjectCheckNull(e)&&!1===g_objTableFunction.isEditableTable(e)?k=handlerUI.setDisableMenu(h,!0):dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(k=handlerUI.setDisableMenu(h));n=1==k?ID_STRING_NAME_GRAY:n;null!=n&&TBSetState(c,n,g_TBDropDown[a][d].button_type)}else k=!1,k=!1===fnObjectCheckNull(e)&&!1===g_objTableFunction.isEditableTable(e)?handlerUI.setDisableMenu(h,!0):handlerUI.setDisableMenu(h),!0===k&&TBSetState(c,ID_STRING_NAME_GRAY,g_TBDropDown[a][d].button_type)}}}catch(l){dalert(l)}},
setStateButton:function(b,a,f,d){try{var e=handlerUI.getCommandUpdateIndex(b,a);if(-1!=e){var c=null;ID_TB_QUERY_STATUS_BUTTON==f?(c=g_TBButton[b][e].element,ID_COMMAND_WRITE_AREA_SET==a&&(d=g_objEditMode.arrWriteAreaSet[b]?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED)):ID_TB_QUERY_STATUS_COMBOBOX==f?c=g_TBComboBox[b][e].element:ID_TB_QUERY_STATUS_DROPDOWN==f&&(c=g_TBDropDown[b][e].element);TBSetState(c,d,f)}}catch(g){dalert(g)}},update_toolbar_manual:function(b,a,f){try{var d=[[ID_COMMAND_TABLE_CREATE,
ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_DOC_TEMPLETE,ID_TB_QUERY_STATUS_BUTTON],[ID_COMMAND_INSERT_EMOTICONS,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SELECT_PARAGRAPH,ID_TB_QUERY_STATUS_DROPDOWN]];if(ID_STRING_NAME_CONTROL===b||a)var e=ID_STRING_NAME_GRAY;else d.push([ID_COMMAND_IMAGE_BORDER_TYPE,ID_TB_QUERY_STATUS_DROPDOWN]),d.push([ID_COMMAND_IMAGE_BORDER_THICKNESS,ID_TB_QUERY_STATUS_DROPDOWN]),d.push([ID_COMMAND_IMAGE_BORDER_COLOR,ID_TB_QUERY_STATUS_DROPDOWN]);var c=GetCurTable(f);for(b=0;b<d.length;b++){if(!0===
fnObjectCheckNull(e)){var g=null;!1===fnObjectCheckNull(c)&&!1===g_objTableFunction.isEditableTable(c)?g=handlerUI.setDisableMenu(d[b][0],!0):dzeUiConfig.bUseLockEditCellFunction&&g_objTableFunction.hasLockedEditCell(c,!1)&&(g=handlerUI.setDisableMenu(d[b][0]));g=!0===g?g:a;e=!0===g?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED}this.setStateButton(f,d[b][0],d[b][1],e)}this.setStateButton(f,ID_COMMAND_HIDE_MINIBAR,ID_TB_QUERY_STATUS_BUTTON,null);this.setStateButton(f,ID_COMMAND_WRITE_AREA_SET,ID_TB_QUERY_STATUS_BUTTON,
null)}catch(h){dalert(h)}},update_context_menu:function(b,a,f,d,e){try{var c=g_objEditorDocument[d],g=e?e.bHasLockedCell:!1;for(e=0;e<g_objContextMenuWin.arrTBContextMenuItem[b].length;e++){var h=g_objContextMenuWin.arrTBContextMenuItem[b][e],n=g_objContextMenuWin.arrTBContextMenuItem[b][e].command,k=g_objContextMenuWin.arrTBContextMenuItem[b][e].command_id;if("img"==f&&ID_COMMAND_INSERT_IMAGE==k)g_objMenuWin.TBSubMenuSetState(h,ID_STRING_NAME_UNCHECKED);else{var l=handlerUI.queryCommandStatus(c,
k,n,d,-1,a);null==l&&h.TBSTATE==ID_STRING_NAME_UNCHECKED&&(l=ID_STRING_NAME_UNCHECKED);null!=l&&g_objMenuWin.TBSubMenuSetState(h,l);if(k==ID_COMMAND_INIT_CURSOR){var m=document.getElementById("TB_INIT_CURSOR_"+d),p=h.cells[1].childNodes[0].childNodes[0].src;g_objPropertyUtil.element_hasClass(m,"duzon_tb_button_up")?(h.cells[3].innerHTML=ID_RES_CONST_STRING_INIT_CURSOR_REMOVE,h.cells[1].childNodes[0].childNodes[0].src=p.replace("ico_init_cursor.","ico_init_cursor_remove.")):(h.cells[3].innerHTML=ID_RES_CONST_STRING_INIT_CURSOR,
h.cells[1].childNodes[0].childNodes[0].src=p.replace("ico_init_cursor_remove.","ico_init_cursor."))}else k==ID_COMMAND_INIT_CURSOR_REMOVE?h.style.display="none":k==ID_COMMAND_LOCK_EDIT_CELL&&(h.cells[3].innerHTML=g?ID_RES_STRING_CLEAR_TABLE_LOCK_EDIT_CELL:ID_RES_CONST_STRING_TABLE_LOCK_EDIT_CELL)}}}catch(q){dalert(q)}},update_toolbar_for_locked_cell_option:function(b){try{for(var a,f,d,e=GetCurTable(b),c=0;c<g_TBButton[b].length;c++)a=g_TBButton[b][c].command_id,f=g_TBButton[b][c].element,(d=!1===
fnObjectCheckNull(e)&&!1===g_objTableFunction.isEditableTable(e)?handlerUI.setDisableMenu(a,!0):handlerUI.setDisableMenu(a))&&TBSetState(f,ID_STRING_NAME_GRAY,g_TBButton[b][c].button_type);for(c=0;c<g_TBDropDown[b].length;c++)a=g_TBDropDown[b][c].command_id,f=g_TBDropDown[b][c].element,(d=!1===fnObjectCheckNull(e)&&!1===g_objTableFunction.isEditableTable(e)?handlerUI.setDisableMenu(a,!0):handlerUI.setDisableMenu(a))&&TBSetState(f,ID_STRING_NAME_GRAY,g_TBDropDown[b][c].button_type)}catch(g){dalert(g)}}};

var updateTableHandlerUI={nEditNumber:0,curEnableForRibbon:{},curEnableForContext:{},clearCache:function(){try{this.curEnableForRibbon={},this.curEnableForContext={}}catch(a){dalert(a)}},setStateTableButton:function(a,c){try{if(this.curEnableForRibbon[a]!==c){this.curEnableForRibbon[a]=c;var d=handlerUI.getCommandUpdateIndex(this.nEditNumber,a);if(-1!=d){c=c?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;var b=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(b=handlerUI.setDisableMenu(a));
c=1==b?ID_STRING_NAME_GRAY:c;b=null;var f=g_arrConst[a][6];switch(f){case ID_TB_QUERY_STATUS_DROPDOWN:b=g_TBDropDown[this.nEditNumber][d].element;break;case ID_TB_QUERY_STATUS_BUTTON:b=g_TBButton[this.nEditNumber][d].element}TBSetState(b,c,f)}}}catch(e){dalert(e)}},updateTableUIHandler:function(a,c){try{if(this.nEditNumber=a,(c=c||GetCurTable(a))||!dzeUiConfig.bUseUiMode||"ribbon"!==dze_menu_control.ui_mode){var d=g_objObjectSelectionInfo;d&&d.bSelectObject&&"img"===d.strNodeName&&(c=null);var b=
this.setStateTableButton.bind(this),f=(d=c?!0:!1)&&g_objTableFunction.canTableResize(c),e=d&&g_objTableFunction.isEditableTable(c);b(ID_COMMAND_LOCK_EDIT_CELL,d);b(ID_COMMAND_TABLE_ADD_COL,e);b(ID_COMMAND_TABLE_ADD_COL_RIGHT,e);b(ID_COMMAND_TABLE_DELETE_ROW,e);b(ID_COMMAND_TABLE_DELETE_COL,e);b(ID_COMMAND_TABLE_SPLIT_CELL,e);b(ID_COMMAND_TABLE_SPLIT_ROW,e);b(ID_COMMAND_TABLE_SPLIT_COL,e);b(ID_COMMAND_TABLE_ADD_ROW,e);b(ID_COMMAND_TABLE_ADD_ROW_DOWN,e);b(ID_COMMAND_TABLE_COPY_ROW_DOWN,e);b(ID_COMMAND_TABLE_CELL_SAME_WIDTH,
f);b(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,f);b(ID_COMMAND_TABLE_CONVERT_TEXT,e);b(ID_COMMAND_TABLE_PROPERTY,e);b(ID_COMMAND_TABLE_CELL_PROPERTY,e);b(ID_COMMAND_TABLE_CELL_STYLE,e);b(ID_COMMAND_COPY,d);b(ID_COMMAND_TABLE_DELETE_EXT,d);b(ID_COMMAND_TABLE_NUMBER_FORMAT,e);b(ID_COMMAND_TABLE_BORDER_THICKNESS,e);b(ID_COMMAND_TABLE_BORDER_TYPE,e);b(ID_COMMAND_TABLE_BORDER_COLOR,e);b(ID_COMMAND_TABLE_STYLE,e);b(ID_COMMAND_COPY_EXT,d);b(ID_COMMAND_TABLE_SELECT,d);b(ID_COMMAND_TABLE_FORMULA_EXT,e);var g=e?GetSelectedCellCount(a):
-1;b(ID_COMMAND_TABLE_MERGE_CELL,1<g);b(ID_COMMAND_TABLE_SELECT_FORMULA,0===g);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN,e?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY);updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,e?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY);g_objTableUtil.isProtect(c)&&(b(ID_COMMAND_TABLE_CELL_STYLE,!1),b(ID_COMMAND_TABLE_BORDER_TYPE,!1),b(ID_COMMAND_TABLE_BORDER_THICKNESS,!1),b(ID_COMMAND_TABLE_BORDER_COLOR,
!1),b(ID_COMMAND_TABLE_ADD_ROW,!1),b(ID_COMMAND_TABLE_ADD_ROW_DOWN,!1),b(ID_COMMAND_TABLE_ADD_COL,!1),b(ID_COMMAND_TABLE_ADD_COL_RIGHT,!1),b(ID_COMMAND_TABLE_MERGE_CELL,!1),b(ID_COMMAND_TABLE_SPLIT_CELL,!1),b(ID_COMMAND_TABLE_STYLE,!1),b(ID_COMMAND_TABLE_CONVERT_TEXT,!1),updateHandlerUI.setStateButton(a,ID_COMMAND_TABLE_CELL_BACKCOLOR,ID_TB_QUERY_STATUS_DROPDOWN,ID_STRING_NAME_GRAY));return!0}}catch(h){dalert(h)}},setStateTableContextMenu:function(a,c,d,b){try{this.curEnableForContext[c]=b;var f=
handlerUI.getContextUpdateIndex(a,c);-1!=f&&(a=b?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY,b=null,dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(b=handlerUI.setDisableMenu(c)),a=1==b?ID_STRING_NAME_GRAY:a,g_objMenuWin.TBSubMenuSetState(d[f],a))}catch(e){dalert(e)}},updateTableContextMenuUIHandler:function(a,c){try{this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_COL_RIGHT,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_ROW,
c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_DELETE_COL,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_CELL,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_ROW,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_COL,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_ADD_ROW_DOWN,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_COPY_ROW_DOWN,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_WIDTH,
c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,c,!0);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_FORMULA,c,!0);var d=GetSelectedCellCount();this.setStateTableContextMenu(a,ID_COMMAND_TABLE_MERGE_CELL,c,1<d);this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SELECT_FORMULA,c,0===d);g_objTableUtil.isProtect(GetCurTable())&&(this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_STYLE,c,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CELL_INSERT,c,!1),this.setStateTableContextMenu(a,
ID_COMMAND_TABLE_MERGE_CELL,c,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_SPLIT_CELL,c,!1),this.setStateTableContextMenu(a,ID_COMMAND_TABLE_CONVERT_TEXT,c,!1))}catch(b){dalert(b)}},setStateTableMenu:function(a,c,d){try{var b=handlerUI.getMenuTableUpdateIndex(a);if(-1!=b){d=d?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;var f=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(f=handlerUI.setDisableMenu(a));d=1==f?ID_STRING_NAME_GRAY:d;g_objMenuWin.TBSubMenuSetState(c[b],d)}}catch(e){dalert(e)}},
updateTableMenuUIHandler:function(){try{var a=g_objMenuWin.objSubMenuItem[ID_COMMAND_MENU_TABLE_INDEX],c=GetCurTable()?!0:!1,d=this.setStateTableMenu.bind(this);d(ID_COMMAND_LOCK_EDIT_CELL,a,c);d(ID_COMMAND_TABLE_DELETE_ROW,a,c);d(ID_COMMAND_TABLE_DELETE_COL,a,c);d(ID_COMMAND_TABLE_SPLIT_CELL,a,c);d(ID_COMMAND_TABLE_ADD_ROW_COL,a,c);d(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a,c);d(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a,c);d(ID_COMMAND_TABLE_FORMULA,a,c);d(ID_COMMAND_TABLE_SELECT_FORMULA,a,c);d(ID_COMMAND_TABLE_PROPERTY,
a,c);d(ID_COMMAND_TABLE_CELL_PROPERTY,a,c);d(ID_COMMAND_TABLE_CELL_STYLE,a,c);d(ID_COMMAND_TABLE_CONVERT_TEXT,a,c);d(ID_COMMAND_TABLE_CELL_ALIGN,a,c);var b=c?GetSelectedCellCount():-1;d(ID_COMMAND_TABLE_MERGE_CELL,a,1<b);d(ID_COMMAND_TABLE_SELECT_FORMULA,a,0===b);c&&GetMultiCellSelection()?d(ID_COMMAND_TABLE_CREATE,a,!1):d(ID_COMMAND_TABLE_CREATE,a,!0)}catch(f){dalert(f)}}};

function GetCurTableInfo(m){try{return"undefined"==typeof m&&(m=g_nActiveEditNumber),GetTableInfo(GetCurRange(m))}catch(b){dalert(b)}}
function GetTableInfo(m){try{if(!m)return null;var b=m.endContainer.childNodes[m.endOffset]||m.endContainer,a=null,c=null,d=null,e=null,h=g_objNodeUtil,f=h.arrCellTagName;a=h.getLoopParentElementByTagNames(m.startContainer.childNodes[m.startOffset]||m.startContainer,f);if(!a)return null;d=h.getLoopParentElement(a,"table");if(!d)return null;if(m.collapsed)return{table:d,cell:a,endCell:a};c=h.getLoopParentElementByTagNames(b,f);return c?a===c?{table:d,cell:a,endCell:a}:(e=h.getLoopParentElement(c,"table"))&&
g_objTableUtil.getSplitTables(d).some(function(a){return e===a})?{table:d,cell:a,endCell:c}:null:null}catch(g){dalert(g)}}function GetCurTable(m){try{var b=GetCurTableInfo(m);return b?b.table:null}catch(a){dalert(a)}}function GetCurCell(m){try{var b=GetCurTableInfo(m);return b?b.cell:null}catch(a){dalert(a)}}function GetMultiCellSelection(m){try{var b=GetCurCell(m);return b&&g_objTableSelection.isCellSelected(b)?!0:!1}catch(a){dalert(a)}}
function GetSelectedCellCount(m,b){try{var a=b||GetCurTable(m);if(!a)return 0;var c=0,d=g_objTableUtil.getSplitTables(a);forEach(d,function(a,b){(a=b.querySelectorAll("td[cusflag], th[cusflag]"))&&(c+=a.length)});return c}catch(e){dalert(e)}}
var g_objTableSelection=new function(){function m(){this.init();return this}this.orgSelColor="#CFD9F3";this.curCellForKeyUp=null;m.prototype.deselectPrevCell=function(){try{if(this.matrix)for(var b=g_objTableSelection,a=this.sy;a<=this.ey;a++)for(var c=this.sx;c<=this.ex;c++)this.matrix.isShow(a,c)&&b.deselectCell(this.matrix.getCell(a,c))}catch(d){dalert(d)}};m.prototype.init=function(){try{this.lastCell=this.firstCell=this.startCell=this.startTable=this.matrix=null,this.nCellCount=0,this.start_midx=
null,this.ex=this.ey=this.sx=this.sy=0,this.bMouseUp=!1}catch(b){dalert(b)}};this.prevSel=new m;this.doAllTable=function(b,a){try{if(b&&(a=a||GetCurTable())){var c=g_objTableUtil.getSplitTables(a);a=0;for(var d=c.length;a<d;a++)b(c[a])}}catch(e){}};this.doAllSelectedCell=function(b,a){try{if(b&&(a=a||GetCurTable())){var c=g_nActiveEditNumber,d=null,e=(d=g_bBrowserType_IE&&!0===duzon_dialog.dialogStatus&&g_objLastRange[c]?GetTableInfo(g_objLastRange[c]):GetCurTableInfo(c))?d.cell:null,h=g_objTableUtil.getSplitTables(a);
d=c=a=null;for(var f=0,g=0,k=h.length;g<k;g++){a=h[g];for(var n=0,l=a.rows.length;n<l;n++,f++){c=a.rows[n];for(var p=0,m=c.cells.length;p<m;p++)((d=c.cells[p])&&d.hasAttribute("cusflag")||e&&e==d)&&b(d,f,p,n,p,a,m,g)}}}}catch(t){}};this.doAllCell=function(b,a){try{if(b&&(a=a||GetCurTable()))for(var c=g_objTableUtil.getSplitTables(a),d=a=null,e=null,h=0,f=0,g=c.length;f<g;f++){a=c[f];for(var k=0,n=a.rows.length;k<n;k++,h++){d=a.rows[k];for(var l=0,p=d.cells.length;l<p;l++)(e=d.cells[l])&&b(e,h,l,k,
l,a,p)}}}catch(v){dalert(v)}};this.onMouseDown=function(b,a){try{if(!g_bTableOperationYN||!b)return!1;a=b.nEditNumber;if("undefined"==typeof a)return!1;var c=b.target||b.srcElement;if(!c)return!1;var d=g_objNodeUtil,e=d.getLoopParentElementByTagNames(c,d.arrCellTagName),h=d.getLoopParentElement(e,"tr"),f=d.getLoopParentElement(h,"table"),g=GetCurTable(a);f&&g_objTableUtil.getSplitTables(f).some(function(a){return g==a})||(this.clearCellSelection(g),g_objTableFlag.ResetTableInfo(!1),g_nTableEventID=
ID_TABLE_EVENT_NOTHING);if(e&&h&&f){var k=!1;this.doAllTable(function(a){k||a!==g||(k=!0)},f);var n=GetMultiCellSelection(a);if(k&&b.shiftKey&&!DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)&&!b.altKey&&this.onMouseDown_multiCellSelection(b,e))return setSelectionColor(a,"transparent"),TBCancelBubbleEvent(b),!0;var l=n&&this.isCellSelected(e),p=2===b.buttons;if(!k||p&&!l||!p)g_objTableFlag.ResetTableInfo(!1),this.clearCellSelection(g),this.nCellCount=0;this.prevSel.init();this.prevSel.startTable=
f;this.prevSel.startCell=e;this.prevSel.firstCell=e;this.prevSel.lastCell=e;this.orgSelColor=getSelectionColor(a);dzeUiConfig.bUseLockEditCellFunction&&(g_bHasLockedCell=g_objTableFunction.hasLockedEditCell(f,!0));g_nTableEventID=ID_TABLE_EVENT_CELL_SELECT;return!0}return!1}catch(v){dalert(v)}};this.onMouseMove=function(b,a){try{g_bTableOperationYN&&ID_TABLE_EVENT_CELL_SELECT==g_nTableEventID&&b&&2!==b.buttons&&1===b.buttons&&throttle(this,function(a,b){this.prevSel.bMouseUp||(this.selectingCell(a,
b)||(this.prevSel.firstCell=null,this.prevSel.lastCell=null,this.prevSel.nCellCount=0,this.clearCellSelection(this.prevSel.startTable)),a=0<this.prevSel.nCellCount?"transparent":this.orgSelColor,this.prev_color!=a&&(this.prev_color=a,setSelectionColor(b,a)))},b,a)}catch(c){dalert(c)}};this.selectingCell=function(b,a){try{var c=b.target||b.srcElement;if(!c)return!1;a=g_objNodeUtil;var d=c?c.ownerDocument:null;(g_bBrowserType_IE||g_bBrowserType_EDGE)&&a.isPageMain(c)&&d.elementFromPoint&&(c=d.elementFromPoint(b.clientX,
b.clientY));var e=a.getLoopParentElement(c,"td")||a.getLoopParentElement(c,"th"),h=a.getLoopParentElement(e,"table");if(!h)return!1;var f=this.prevSel,g=f.matrix||(f.matrix=(new TableMatrix).setTable(f.startTable));if(!g||!g.tables||!g.tables.some(function(a){return h==a}))return!1;var k=f.start_midx||(f.start_midx=g.getMatrixIndex(f.startCell)),n=g.getMatrixIndex(e);if(!k||!n)return!1;f.deselectPrevCell();f.sy=Math.min(k[0].row,n[0].row);f.sx=Math.min(k[0].col,n[0].col);f.ey=Math.max(k[k.length-
1].row,n[n.length-1].row);f.ex=Math.max(k[k.length-1].col,n[n.length-1].col);f.nCellCount=0;f.firstCell=null;f.lastCell=null;if(f.startCell==e){f.firstCell=e;f.lastCell=e;c=!1;if(e){var l=g_objPositionUtil.getElementPosClientRect(e);d=g_objPropertyUtil;if(Math.abs(l.right-b.clientX)<Math.max(d.getPadding(e,d.RIGHT),4)||Math.abs(l.left-b.clientX)<Math.max(d.getPadding(e,d.LEFT),4))c=!0;if(Math.abs(l.top-b.clientY)<Math.max(d.getPadding(e,d.TOP),4)||Math.abs(l.bottom-b.clientY)<Math.max(d.getPadding(e,
d.BOTTOM),4))c=!0}c&&(this.selectCell(e,2),f.nCellCount=1)}else this.expandSelect(g,f),this.table_selectRange(g,f);return!0}catch(p){dalert(p)}};this.onMouseUp=function(b,a){try{if(!b||!g_bTableOperationYN)return!1;a=b.nEditNumber;if("undefined"==typeof a)return!1;var c=!1,d=this.prevSel;d.firstCell&&d.lastCell&&0<d.nCellCount&&(c=!0,2!==b.button&&g_objCaretUtil.moveCaret(d.firstCell,!1));d.init();d.bMouseUp=!0;setSelectionColor(a,this.orgSelColor);return c}catch(e){dalert(e)}};this.getCellSelObject=
function(b){var a={};a.sy=b[0].row;a.sx=b[0].col;a.ey=b[b.length-1].row;a.ex=b[b.length-1].col;return a};this.equalCellSelObject=function(b,a){return b&&a&&b.sy===a.sy&&b.sx===a.sx&&b.ey===a.ey&&b.ex===a.ex?!0:!1};this.onMouseDown_multiCellSelection=function(b,a){try{var c=GetCurTableInfo(b.nEditNumber);if(!c)return!1;var d=c.table,e=c.cell,h=c.endCell;e===h&&(h=a);if(!e||!h||e===h)return!1;var f=new TableMatrix(d);if(!f)return!1;var g=f.getMatrixIndex(e);if(!g)return!1;var k=f.getMatrixIndex(h);
if(!k)return!1;var n=this.getCellSelObject(g),l=this.getCellSelObject(k);l.sy=Math.min(l.sy,n.sy);l.ey=Math.max(l.ey,n.ey);l.sx=Math.min(l.sx,n.sx);l.ex=Math.max(l.ex,n.ex);this.clearCellSelection(d);this.expandSelect(f,l);this.table_selectRange(f,l);return!0}catch(p){dalert(p)}};this.isTableNaviKey=function(b){switch(b){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:case 9:return!0}return!1};this.onKeyDown_multiCellSelection=function(b,a){try{if(!b||b.cancelBubble||b.altKey||DZESHORTCUT.isPressedKeyMapForOS(b,
ID_KEYCODE_CTRL)||!GetMultiCellSelection(a))return!1;var c=b.keyCode;if(!this.isTableNaviKey(c))return!1;var d=GetCurRange(a);if(!d)return!1;var e=GetCurTableInfo(a);if(!e)return!1;var h=e.table,f=e.cell,g=new TableMatrix(h);if(!g)return!1;var k=g.getSelection();k=k&&k[0]?k[0]:null;if(!k)return!1;if(b.shiftKey&&c!==ID_KEYCODE_TAB){var n=g.getMatrixIndex(f);if(!n)return!1;var l=this.getCellSelObject(n),p={sy:k.nStartRow,sx:k.nStartCol,ey:k.nEndRow,ex:k.nEndCol};b=!1;switch(c){case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_HOME:l.ex>=
p.ex&&(b=!0);break;case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_PAGE_UP:l.ey>=p.ey&&(b=!0);break;case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_END:l.sx<=p.sx&&(b=!0);break;case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_PAGE_DOWN:l.sy<=p.sy&&(b=!0)}var m=cloneSimpleObject(p);m=b?this.expandSelectFromKey(g,m,l,c):this.shrinkSelectFromKey(g,m,l,c);if(!d.collapsed){if(this.equalCellSelObject(m,l))return this.clearCellSelection(h),!0;b=SelectionUtil;var t=c===ID_KEYCODE_ARROW_RIGHT||c===ID_KEYCODE_ARROW_LEFT?
this.equalCellSelObject(p,l):!1,u=t?b.existOnFirst(f,d):!1,q=t?b.existOnLast(f,d):!1;if(c===ID_KEYCODE_ARROW_RIGHT&&t&&u&&!q||c===ID_KEYCODE_ARROW_LEFT&&t&&!u&&q)return this.clearCellSelection(h),!0}this.clearCellSelection(h);this.table_selectRange(g,m)}else{c===ID_KEYCODE_TAB&&(c=b.shiftKey?ID_KEYCODE_ARROW_LEFT:ID_KEYCODE_ARROW_RIGHT);if(c!==ID_KEYCODE_TAB&&!d.collapsed)return this.clearCellSelection(h),!1;var r=this.findCellFromKey(g,f,c);r||(r=f);r!==f&&(this.clearCellSelection(h),this.selectCell(r,
2),g_objCaretUtil.moveCaret(r))}return!0}catch(w){dalert(w)}finally{}};this.onKeyUp=function(b,a){try{if(g_bTableOperationYN&&b){var c=b.keyCode;if(!(!this.isTableNaviKey(c)&&c!==ID_KEYCODE_DELETE||DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)||b.altKey)){var d=GetCurTableInfo(a);if(d){var e=d.table,h=d.cell;h&&e&&(this.isCellSelected(h)?updateTableHandlerUI.updateTableUIHandler(a):h!==this.curCellForKeyUp&&(this.curCellForKeyUp=h,g_objTableFlag.removeFlagInfo(e),updateTableHandlerUI.updateTableUIHandler(a),
g_objTableMiniMenu.delayUpdate(a)))}else this.curCellForKeyUp=null,g_objTableFlag.ResetTableInfo(!1),g_objTableMiniMenu.showTableMiniMenu(!1,null,a)}}}catch(f){dalert(f)}};this.isTableSelected=function(b){try{var a=GetCurTable(b);if(!a)return!1;var c=g_objWrapperOutlineResize.objExtSelectedInfo;return c&&c.nObjType===DZE_OBJ_TABLE&&c.objElement===a?!0:!1}catch(d){dalert(d)}};this.isCellSelected=function(b){try{if(!b||!b.getAttribute)return!1;var a=b.getAttribute("cusflag");a=parseInt(a,10);switch(a){case 2:case 3:case 4:return!0}return!1}catch(c){dalert(c)}};
this.selectTable=function(b){try{var a=GetCurTable(b);a&&(g_objTableSelection.table_selectAll(a,b),g_objTableSelection.updateManualTableUIHandler(b),g_objTableMiniMenu.showTableMiniMenu(!1),showExtOutline_ObjectElement(a,!0,!1,b))}catch(c){dalert(c)}};this.clearCellSelection=function(b,a){try{b=b||GetCurTable();if(!b)return!1;this.doAllSelectedCell(function(b,d,e,h,f,g,k,n){b.hasAttribute("cusflag")&&(d=b.getAttribute("cusflag"),b.removeAttribute("cusflag"),a&&a.push([n,h,e,d]))},b);return a?a:null}catch(c){dalert(c)}};
this.restoreCellSelection=function(b,a){try{if(!b)return!1;a=a||GetCurTable();if(!a)return!1;var c=g_objTableUtil,d=c.getSplitTables(a);a=0;for(var e=b.length;a<e;a++){var h=b[a];if(h){var f=c.getTableCellElement(d[h[0]],h[1],h[2]);f&&f.setAttribute("cusflag",h[3])}}return!0}catch(g){dalert(g)}};this.selectCell=function(b,a){try{if(!b)return!1;switch(a){case 2:case 3:case 4:b.setAttribute("cusflag",a);break;default:this.deselectCell(b)}return!0}catch(c){dalert(c)}};this.selectCellRange=function(b,
a){try{if(!b||!a)return!1;if(b===a)return this.selectCell(b,2);var c=g_objNodeUtil,d=c.getLoopParentElement(b,"table"),e=c.getLoopParentElement(a,"table");if(!d||!e||!g_objTableUtil.isSameTable(d,e))return!1;var h=new TableMatrix(d);if(!h)return!1;var f=h.getMatrixIndex(b);if(!f)return!1;var g=h.getMatrixIndex(a);if(!g)return!1;var k={sy:Math.min(f[0].row,g[0].row),sx:Math.min(f[0].col,g[0].col),ey:Math.max(f[f.length-1].row,g[g.length-1].row),ex:Math.max(f[f.length-1].col,g[g.length-1].col)};this.clearCellSelection(d);
this.table_selectRange(h,k);return!0}catch(n){dalert(n)}};this.deselectAllCell=function(b){try{if(!b)return!1;this.doAllCell(function(a){this.deselectCell(a)}.bind(this),b);return!0}catch(a){dalert(a)}};this.deselectCell=function(b){try{b&&b.hasAttribute("cusflag")&&b.removeAttribute("cusflag")}catch(a){dalert(a)}};this.removeAllCellSelection=function(b){try{if(b){var a=b.querySelectorAll("td[cusflag], th[cusflag], td[bg_changing], th[bg_changing]");forEach(a,function(a,b){b&&(b.removeAttribute("cusflag"),
b.removeAttribute("bg_changing"))},this)}}catch(c){dalert(c)}};this.expandSelect=function(b,a){try{if(!b||!a)return null;for(var c=50,d=!0;d&&0<c;){d=!1;c--;if(0<a.sx)for(var e=a.sy;e<=a.ey;e++)for(;b.isHideForColspan(e,a.sx);a.sx--)d=!0;if(a.ex<b.colLength-1)for(e=a.sy;e<=a.ey;e++)for(;b.isHideForColspan(e,a.ex+1);a.ex++)d=!0;if(0<a.sy)for(var h=a.sx;h<=a.ex;h++)for(;b.isHideForRowspan(a.sy,h);a.sy--)d=!0;if(a.ey<b.rowLength-1)for(h=a.sx;h<=a.ex;h++)for(;b.isHideForRowspan(a.ey+1,h);a.ey++)d=!0}return a}catch(f){dalert(f)}};
this.table_SelectionCaretCell=function(b){try{if(!GetMultiCellSelection(b)){var a=GetCurCell(b);a&&this.selectCell(a,2)}}catch(c){dalert(c)}};this.table_selectAll=function(b,a){try{if(!b)return!1;var c=null,d=null,e=0;this.doAllCell(function(a){c||(c=a);d=a;this.selectCell(a,3);e++}.bind(this),b);this.selectCell(c,2);this.selectCell(d,4);return!0}catch(h){dalert(h)}};this.table_selectRow=function(b,a){try{if(!b)return!1;var c=g_objTableUtil.getMatrix(b),d=c?c.getSelection():null;if(!d||1<d.length)return!1;
d=d[0];d.sy=d.nStartRow;d.ey=d.nEndRow;d.sx=0;d.ex=c.colLength-1;this.expandSelect(c,d);this.table_selectRange(c,d);return!0}catch(e){dalert(e)}};this.table_selectCol=function(b,a){try{if(!b)return!1;var c=g_objTableUtil.getMatrix(b),d=c?c.getSelection():null;if(!d||1<d.length)return!1;d=d[0];d.sy=0;d.ey=c.rowLength-1;d.sx=d.nStartCol;d.ex=d.nEndCol;this.expandSelect(c,d);this.table_selectRange(c,d);return!0}catch(e){dalert(e)}};this.table_selectRange=function(b,a){try{if(!b||!a)return null;for(var c=
null,d=null,e=0,h=a.sy;h<=a.ey&&h<b.rowLength;h++)for(var f=a.sx;f<=a.ex&&f<b.colLength;f++)b.isShow(h,f)&&(d=b.getCell(h,f),c||(c=d),this.selectCell(d,3),e++);this.selectCell(c,2);this.selectCell(d,4);a.firstCell=c;a.lastCell=d;a.nCellCount=e;return a}catch(g){dalert(g)}};this.expandSelectFromKey=function(b,a,c,d){try{var e=null,h=null,f=null,g=null,k=cloneSimpleObject(a);switch(d){case ID_KEYCODE_ARROW_LEFT:a.sx--;if(0>a.sx&&(a.sx=0,c.ey===a.ey?a.sy=Math.max(a.sy-1,0):a.ey=Math.max(a.ey-1,0),a.ey<
a.sy)){var n=a.sy;a.sy=a.ey;a.ey=n}break;case ID_KEYCODE_ARROW_TOP:a.sy--;break;case ID_KEYCODE_ARROW_RIGHT:a.ex++;a.ex>=b.colLength&&(a.ex=b.colLength-1,c.ey===a.ey?a.sy=Math.min(a.sy+1,b.rowLength-1):a.ey=Math.min(a.ey+1,b.rowLength-1),a.ey<a.sy&&(n=a.sy,a.sy=a.ey,a.ey=n));break;case ID_KEYCODE_ARROW_BOTTOM:a.ey++;break;case ID_KEYCODE_PAGE_UP:a.sy=Math.max(a.sy-5,0);break;case ID_KEYCODE_PAGE_DOWN:a.ey=Math.min(a.ey+5,b.rowLength-1);break;case ID_KEYCODE_HOME:e=a.sx;for(var l=a.sy;l<=a.ey;l++)g=
b.trs[l].cells,f=g[0],h=b.getMatrixIndex(f),e=Math.min(e,h[0].col);a.sx=e;break;case ID_KEYCODE_END:e=a.ex;for(l=a.sy;l<=a.ey;l++)g=b.trs[l].cells,f=g[g.length-1],h=b.getMatrixIndex(f),e=Math.max(e,h[h.length-1].col);a.ex=e}var m=this.expandSelect(b,a);c=null;a.sy<k.sy?c=b.getCell(a.sy,a.sx):a.ey>k.ey&&(c=b.getCell(a.ey,a.ex));c&&g_objCaretUtil.scrollTo(c);return m}catch(v){dalert(v)}};this.shrinkSelectFromKey=function(b,a,c,d){try{if(!b||!a||!c)return null;var e=!1,h=!1,f=function(a,b,c,d,e){for(;a<=
b;a++)for(var f=c;f<=d;f++)e(a,f)},g=null;switch(d){case ID_KEYCODE_ARROW_TOP:g=b.getRowRange(a.ey,c.sx);g=b.getRowRange(g.start-1,c.sx);a.ey=g.end;h=!0;break;case ID_KEYCODE_ARROW_BOTTOM:g=b.getRowRange(a.sy,c.sx);g=b.getRowRange(g.end+1,c.sx);a.sy=g.start;e=!0;break;case ID_KEYCODE_ARROW_LEFT:g=b.getColRange(c.sy,a.ex);g=b.getColRange(c.sy,g.start-1);a.ex=g.end;break;case ID_KEYCODE_ARROW_RIGHT:g=b.getColRange(c.sy,a.sx);g=b.getColRange(c.sy,g.end+1);a.sx=g.start;break;case ID_KEYCODE_HOME:a.ex=
c.ex;break;case ID_KEYCODE_END:a.sx=c.sx;break;case ID_KEYCODE_PAGE_UP:a.ey=c.ey;h=!0;break;case ID_KEYCODE_PAGE_DOWN:a.sy=c.sy,e=!0}switch(d){case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_HOME:case ID_KEYCODE_END:f(a.sy,a.ey,a.sx,c.sx-1,function(c,d){g=b.getRowRange(c,d);if(g.start<a.sy||g.end>a.ey)a.sx=Math.max(a.sx,b.getColRange(c,d).end+1)});f(a.sy,a.ey,c.ex+1,a.ex,function(c,d){g=b.getRowRange(c,d);if(g.start<a.sy||g.end>a.ey)a.ex=Math.min(a.ex,b.getColRange(c,d).start-
1)});break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_PAGE_UP:case ID_KEYCODE_PAGE_DOWN:f(a.sy,c.sy-1,a.sx,a.ex,function(c,d){g=b.getColRange(c,d);if(g.start<a.sx||g.end>a.ex)a.sy=Math.max(a.sy,b.getRowRange(c,d).end+1)}),f(c.ey+1,a.ey,a.sx,a.ex,function(c,d){g=b.getColRange(c,d);if(g.start<a.sx||g.end>a.ex)a.ey=Math.min(a.ey,b.getRowRange(c,d).start-1)})}c=null;e?c=b.getCell(a.sy,a.sx):h&&(c=b.getCell(a.ey,a.ex));c&&g_objCaretUtil.scrollTo(c);return a}catch(k){dalert(k)}};
this.findCellFromKey=function(b,a,c){try{var d=b.getMatrixIndex(a);if(!d)return null;var e=d[0].row,h=d[0].col,f=d[d.length-1].row;d=null;switch(c){case ID_KEYCODE_ARROW_TOP:a=b.getCell(e-1,h);break;case ID_KEYCODE_ARROW_BOTTOM:a=b.getCell(f+1,h);break;case ID_KEYCODE_ARROW_LEFT:a=b.getPrevCell(e,h);break;case ID_KEYCODE_ARROW_RIGHT:a=b.getNextCell(e,h);break;case ID_KEYCODE_HOME:d=b.trs[e];a=d.cells[0];break;case ID_KEYCODE_END:d=b.trs[e];a=d.cells[d.cells.length-1];break;case ID_KEYCODE_PAGE_UP:a=
b.getCell(Math.max(e-5,0),h);break;case ID_KEYCODE_PAGE_DOWN:a=b.getCell(Math.min(f+5,b.rowLength-1),h)}return a}catch(g){dalert(g)}};this.checkMoveCellForce=function(b){try{if(!b||b.cancelBubble||g_bBrowserType_OP)return!1;var a=b.target||b.srcElement;if(!a)return!1;var c=a.ownerDocument,d=c?c.defaultView:null,e=d?d.getSelection():null;if(!e)return!1;var h=b.nEditNumber;if(GetMultiCellSelection(h))return!1;var f=GetCurRange(h);if(!f)return!1;a=null;c=0;e.anchorNode&&e.anchorNode===f.endContainer&&
e.anchorOffset===f.endOffset?(a=f.startContainer,c=f.startOffset):(a=f.endContainer,c=f.endOffset);if(!a)return!1;var g=f.startContainer.childNodes[f.startOffset]||f.startContainer;if(!f.collapsed&&1===f.endOffset-f.startOffset&&g&&f.startContainer===f.endContainer&&"HR"===g.nodeName)return!1;e=g_objNodeUtil;var k=e.getLoopParentElementByTagNames(a,e.arrCellTagName);if(!k)return!1;var n=e.getLoopParentElement(k,"table");if(!n)return!1;e=g_objTableUtil;g=SelectionUtil;var l=e.getSplitTables(n),m=l.indexOf(n),
v=l.length,t=g_bBrowserType_CR&&!g_bBrowserType_EDGE||g_bBrowserType_SF||g_browserCHK.iOS&&g_browserCHK.isWebView(),u=b.keyCode,q=b.shiftKey&&!b.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL),r=SelectionUtil.isOnInput(h);if(u===ID_KEYCODE_ARROW_TOP){if(q&&g.isOnFirst(k,a,c)&&!r||!q&&t&&g.isOnFirst(k,a,c)||q&&g.isOnFirstLine(k,a,c)||!q&&t&&g.isOnFirstLine(k,a,c)&&!r||0<m&&e.isCellInFirstRow(k)&&g.isOnFirstLine(k,a,c))return!0}else if(u===ID_KEYCODE_ARROW_BOTTOM){if(q&&g.isOnLast(k,a,
c)&&!r||!q&&t&&g.isOnLast(k,a,c)||q&&g.isOnLastLine(k,a,c)&&!r||!q&&t&&g.isOnLastLine(k,a,c)||m+1!==v&&e.isCellInLastRow(k)&&g.isOnLastLine(k,a,c))return!0}else if(u===ID_KEYCODE_ARROW_LEFT){if(g.isOnFirst(k,a,c)&&e.getFirstCell(n)===k||q&&g.isOnFirst(k,a,c)&&!r)return!0}else if(u===ID_KEYCODE_ARROW_RIGHT){if(g.isOnLast(k,a,c)&&e.getLastCell(n)===k||q&&g.isOnLast(k,a,c)&&!r)return!0}else if(u===ID_KEYCODE_BACKSPACE&&f.collapsed&&g.isOnFirst(k,a,c)&&"undefined"!==typeof g_objSplitUtil&&0!==g_objSplitUtil.getSplitNodes(k).indexOf(k))return!0;
return!1}catch(w){return dalert(w),!1}finally{}};this.updateManualTableUIHandler=function(b){try{updateTableHandlerUI.updateTableUIHandler(b),GetMultiCellSelection(b)&&updateHandlerUI.update_toolbar_combobox("",b)}catch(a){dalert(a)}}};

var g_bHasLockedCell=!1,g_objTableFlag=new function(){this.ResetTableInfo=function(b,a){try{if(!(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)||-1==g_objWrapperOutlineUtil.nExtOutlineRectPressedType){"undefined"==typeof a?g_objWrapperOutlineResize.resetExtOutlineInfo():a&&g_objWrapperOutlineResize.resetExtOutlineInfo();var d=GetCurTable();fnObjectCheckNull(d)||(b||this.removeFlagInfo(d),g_bHasLockedCell=!1)}}catch(c){dalert(c)}};this.removeFlagInfo=function(b,a){try{var d=g_objNodeUtil,
c=g_objTableUtil,k=g_objTableSelection,g=!1===a?[b]:c.getSplitTables(b);b=0;for(var l=g.length;b<l;b++){var e=g[b];a=0;for(var m=e.rows.length;a<m;a++)for(var n=c.getTableCellsLength(e,a),f=0;f<n;f++){var h=c.getTableCellElement(e,a,f);k.deselectCell(h);d.removeAttribute(h,"bg_changing")}}}catch(p){dalert(p)}}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,d){b!=Array.prototype&&b!=Object.prototype&&(b[a]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(b,a){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function b(d){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+a++,d)}var a=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};
$jscomp.iteratorFromArray=function(b,a){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var d=0,c={next:function(){if(d<b.length){var e=d++;return{value:a(e,b[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill=function(b,a,d,c){if(a){d=$jscomp.global;b=b.split(".");for(c=0;c<b.length-1;c++){var e=b[c];e in d||(d[e]={});d=d[e]}b=b[b.length-1];c=d[b];a=a(c);a!=c&&null!=a&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objTableOperation=new function(){this.RET_FALSE=0;this.RET_TRUE=1;this.RET_DELETE_TABLE=2;this.FORMULA_SUM=0;this.FORMULA_AVERAGE=1;this.FORMULA_MULTIPLY=2;this.table_AddTableRow=function(b,a,d){try{if(!b||!b.parentNode)return!1;var c=b.ownerDocument,e=g_objTableUtil.getMatrix(b);if(!c||!e)return!1;var g=e.getSelection();if(!g||1<g.length)return!1;d=d?!0:!1;g=g[0];b=g_objNodeUtil;c=g_objTableUtil;var f=e.DZE_TEMP;e.calculateRowHeight();var h=a?g.nStartRow:g.nEndRow;h=a?h:h+1;for(var k=e.colLength-
1;0<=k;k--)if(e.equalCell(g.nStartRow,k,g.nEndRow,k)){var l=e.getRowRange(g.nStartRow,k);a?l.start<g.nStartRow&&l.end>=g.nEndRow&&b.setAttribute(e.getCell(g.nStartRow,k),f,""):l.start<=g.nStartRow&&l.end>g.nEndRow&&b.setAttribute(e.getCell(g.nStartRow,k),f,"")}e.splitRow(h);var m=e.cloneRow(g.nStartRow,g.nEndRow,d);forEach(m.querySelectorAll("td, th"),function(a,b){b.firstChild||(b.innerHTML="<P><BR></P>")});removeAllBindDataAttr(m);a?e.trs[h].parentNode.insertBefore(m,e.trs[h]):insertAfter(e.trs[h-
1],m);e.makeMatrix();var t=g.nEndRow-g.nStartRow+1,n=g.nStartRow-1,p=g.nEndRow+t+1;t=p-n+1;for(k=e.colLength-1;0<=k;k--){d=a=null;for(g=n;g<=p;g=e.getRowRange(g,k).end+1)a=e.getCell(g,k),a=b.hasAttribute(a,f)?a:null,b.removeAttribute(a,f),a&&(d=d||[],d.push(a));if(d&&0!=d.length){a=d[0];l=g=0;for(var q=d.length;l<q;l++)g+=e.getRowspan(d[l]);l=1;for(q=d.length;l<q;l++)d[l].parentNode.removeChild(d[l]);e.setRowspan(a,g);var r=c.offsetHeightToStyleHeight(a.offsetHeight,a);c.setNodeValue_Height(a,r,"px")}}return!0}catch(x){dalert(x)}};
this.deleteTableRow=function(b,a){try{if(!b)return this.RET_FALSE;var d=new TableMatrix(b),c=d?d.getSelection():null;if(!c||1<c.length)return this.RET_FALSE;c=c[0];if(d.rowLength===c.nEndRow-c.nStartRow+1)return this.RET_DELETE_TABLE;var e=b.ownerDocument,g=e?e.defaultView:null,f=g?g.getSelection():null;f&&f.removeAllRanges();d.removeRow(c.nStartRow,c.nEndRow,{returnFragment:!1});var h=d.getCell(c.nStartRow,c.nStartCol);h=(h=h?h:d.getCell(c.nStartRow-1,c.nStartCol))?h:d.tables[0].rows[0].cells[0];
g_objCaretUtil.moveCaret(h);return this.RET_TRUE}catch(k){dalert(k)}};this.table_AddTableCol=function(b,a){try{if(!b||!b.parentNode)return!1;var d=b.ownerDocument,c=g_objTableUtil.getMatrix(b);if(!d||!c)return!1;var e=c.getSelection();if(!e||1<e.length)return!1;e=e[0];var g=g_objNodeUtil,f=g_objTableUtil,h=g_objTableResize,k=c.DZE_TEMP,l=b.parentNode,m=g_objPropertyUtil.getPadding(l),t=Math.floor(l.offsetWidth-m[g_objPropertyUtil.LEFT]-m[g_objPropertyUtil.RIGHT]),n=b.offsetWidth,p=c.calculateColWidth(),
q=a?e.nStartCol:e.nEndCol+1;f.addColgroup(b,c);for(var r=c.rowLength-1;0<=r;r--)if(c.equalCell(r,e.nStartCol,r,e.nEndCol)){var x=c.getColRange(r,e.nStartCol);a?x.start<e.nStartCol&&x.end>=e.nEndCol&&g.setAttribute(c.getCell(r,e.nStartCol),k,""):x.start<=e.nStartCol&&x.end>e.nEndCol&&g.setAttribute(c.getCell(r,e.nStartCol),k,"")}c.splitCol(q);var v=d.createDocumentFragment(),z=c.cloneCol(e.nStartCol,e.nEndCol);removeAllBindDataAttr(z);for(r=c.rowLength-1;0<=r;r--)g.moveNodesTo(v,z.removeChild(z.lastChild).firstChild),
c.insertCell(v,r,q);c.makeMatrix();a=0;for(var y=c.colgroups.length;a<y;a++){for(var A=c.colgroups[a],B=g.getImmediateChildNodesByTagName(A,"col"),u=e.nStartCol;u<=e.nEndCol;u++)v.appendChild(B[u].cloneNode(!1));A.insertBefore(v,B[e.nEndCol+1])}var w=c.arraySum(p),D=c.arraySum(p,e.nStartCol,e.nEndCol);f.setTableWidth(c.tables,w+D);var E=e.nStartCol-1,F=e.nEndCol+(e.nEndCol-e.nStartCol+1)+1;for(r=c.rowLength-1;0<=r;r--){p=e=null;for(v=E;v<=F;v=c.getColRange(r,v).end+1)e=c.getCell(r,v),e=g.hasAttribute(e,
k)?e:null,g.removeAttribute(e,k),e&&(p=p||[],p.push(e));if(p&&0!=p.length){e=p[0];a=v=0;for(y=p.length;a<y;a++)v+=c.getColspan(p[a]);a=1;for(y=p.length;a<y;a++)p[a].parentNode.removeChild(p[a]);c.setColspan(e,v);var G=f.offsetWidthToStyleWidth(e.offsetWidth,e);f.setNodeValue_Width(e,G,"px")}}var C=b.offsetWidth;1>=Math.abs(n-t)&&C>t&&C<=1.25*n&&h.setTableSize(b,n,0);return!0}catch(H){dalert(H)}return!1};this.deleteTableCol=function(b,a){try{if(!b)return this.RET_FALSE;var d=new TableMatrix(b),c=d?
d.getSelection():null;if(!c||1<c.length)return this.RET_FALSE;c=c[0];if(d.colLength===c.nEndCol-c.nStartCol+1)return this.RET_DELETE_TABLE;var e=b.ownerDocument,g=e?e.defaultView:null,f=g?g.getSelection():null;f&&f.removeAllRanges();d.removeCol(c.nStartCol,c.nEndCol,{returnFragment:!1});var h=d.getCell(c.nStartRow,c.nStartCol);h=(h=h?h:d.getCell(c.nStartRow,c.nStartCol-1))?h:d.tables[0].rows[0].cells[0];g_objCaretUtil.moveCaret(h);return this.RET_TRUE}catch(k){dalert(k)}};this.deleteTable=function(b){try{if(!b)return!1;
var a=g_objNodeUtil,d=g_objTableUtil.getSplitTables(b),c=GetCurTable(),e=a.getClosetBound(c);b=null;0<=d.indexOf(c)&&(b=(b=getCaretNodeWalker(d[d.length-1]).getNextNodeOutside(d[d.length-1]))||getCaretNodeWalker(d[0]).getPrevNodeOutside(d[0]));c=0;for(var g=d.length;c<g;c++)d[c]&&d[c].parentNode.removeChild(d[c]);!e||e.firstChild||a.isBoundNode(e)||(e.innerHTML=a.isNodeInShape(e)?"<BR>":"<P><BR></P>",b||(b=e));b&&g_objCaretUtil.moveCaret(b,!1);return!0}catch(f){dalert(f)}};this.deleteCellContents=
function(b,a){try{if(!b||!0===g_objTableFunction.isCellLocked(b))return!1;var d=!1!==a?GetCurCell():null;a=!1;b===d&&(a=!0);g_objTableUtil.setCellInnerText("",b);a&&g_objCaretUtil.moveCaret(b);return!0}catch(c){dalert(c)}};this.deleteSelectedCellContents=function(b,a){try{if(!b)return!1;var d=GetCurCell(a),c=!1,e=0;g_objTableSelection.doAllSelectedCell(function(a){this.deleteCellContents(a,!1)&&e++;a==d&&(c=!0)}.bind(this),b);c&&g_objCaretUtil.moveCaret(d);return 0<e?!0:!1}catch(g){dalert(g)}};this.deleteSelectedCell=
function(b,a,d){try{if(!a||!g_objTableFunction.isEditableTable(a))return!1;var c=g_objTableUtil.getMatrix(a);if(!c)return!1;var e=c.getSelection();e=e&&e[0]?e[0]:null;if(!e)return!1;for(var g=g_objTableSelection,f=0==e.nStartRow&&e.nEndRow==c.rowLength-1,h=!0,k=e.nStartRow;k<=e.nEndRow&&h;k++)forEach(c.trs[k].cells,function(a,b){g.isCellSelected(b)||(h=!1)},this);c=h&&f;e=!1;if(e=h&&!f?g_objTableOperation.deleteTableRow(a,b):!h&&f?g_objTableOperation.deleteTableCol(a,b):c?g_objTableOperation.deleteTable(a):
g_objTableOperation.deleteSelectedCellContents(a,b))c?(!1!==d&&g_objUndoRedo.registerUndoRedoStack(0,b),editor_onselectionchange(b)):commonUpdateAfterChange(b,a,{bUndoRedo:d}),"undefined"!==typeof dzeUiConfig.arrFormCodeString&&dzeUiConfig.arrFormCodeString.length&&g_objEditMode.doReservedCallback(b);return e}catch(l){dalert(l)}};this.table_MergeTableCell=function(b,a){try{if(!b||!b.parentNode)return!1;var d=b.ownerDocument,c=g_objTableUtil,e=g_objTableFunction,g=g_objNodeUtil,f=c.getMatrix(b),h=
f?f.getSelection():null;if(!h||1!=h.length)return!1;h=h[0];if(1>=h.arrCell.length)return!1;var k=f.calculateColWidth(),l=f.calculateRowHeight(),m=h.arrCell;g_objCaretUtil.moveCaret(m[0]);var t={};b=0;for(var n=m.length;b<n;b++)t[0]||(t[0]=[]),t[0].push(m[b]);var p=Object.keys(t),q="";1<p.length&&(q=(q=m[0].getAttribute("dze_split"))||g_objCommonUtil.getUniqueID());p.forEach(function(a){var b=t[a];a=b[0];q&&a.setAttribute("dze_split",q);for(var h=Number.MAX_VALUE,m=0,n=Number.MAX_VALUE,p=0,r=0,u=b.length;r<
u;r++){var w=f.getMatrixIndex(b[r]);h=Math.min(h,w[0].row);m=Math.max(m,w[w.length-1].row);n=Math.min(n,w[0].col);p=Math.max(p,w[w.length-1].col)}u=f.getCell(h,p);r=f.getCell(m,n);u=e.GetTableCellBorderAttribute(u,"right");e.SetTableCellBorderAttribute(a,u,"right");u=e.GetTableCellBorderAttribute(r,"bottom");e.SetTableCellBorderAttribute(a,u,"bottom");f.setRowspan(a,m-h+1);f.setColspan(a,p-n+1);w=d.createDocumentFragment();r=1;for(u=b.length;r<u;r++)c.isBlankCell(b[r])||g.moveNodesTo(w,b[r].firstChild),
b[r].parentNode.removeChild(b[r]);f.makeMatrix();w.firstChild&&a.appendChild(w);b=f.arraySum(k,n,p);h=f.arraySum(l,h,m);c.setNodeValue_Width(a,c.offsetWidthToStyleWidth(b,a),"px");c.setNodeValue_Height(a,c.offsetHeightToStyleHeight(h,a),"px")});f.removeBlankCol();f.removeBlankRow();return!0}catch(r){dalert(r)}return!1};this.table_SplitTableRow=function(b,a,d){try{if(!a||1==d)return!1;0<g_objNodeUtil.getImmediateChildNodesByTagName(a,"colgroup").length&&g_objTableUtil.addColgroup(a,c);var c=g_objTableUtil.getMatrix(a),
e=c.getSelection();if(!e||1<e.length)return!1;e=e[0];var g=e.arrCell.slice();g.sort(function(a,b){return a.rowSpan-b.rowSpan});b=g_objTableSelection;var f=b.isCellSelected(g[0]);a=0;for(var h=g.length;a<h;a++)c.divideCellRow(g[a],d);if(f){e=c.getSelection()[0];for(a=e.arrCell.length-1;0<=a;a--)b.selectCell(e.arrCell[a],3);b.selectCell(c.getCell(e.nStartRow,e.nStartCol),2);b.selectCell(c.getCell(e.nEndRow,e.nEndCol),4)}g_objCaretUtil.moveCaret(c.getCell(e.nStartRow,e.nStartCol));return!0}catch(k){dalert(k)}};
this.table_SplitTableCol=function(b,a,d){try{if(!a||1===d)return!1;0<g_objNodeUtil.getImmediateChildNodesByTagName(a,"colgroup").length&&g_objTableUtil.addColgroup(a,c);var c=g_objTableUtil.getMatrix(a),e=c.getSelection();if(!e||1<e.length)return!1;e=e[0];var g=e.arrCell.slice();g.sort(function(a,b){return a.colSpan-b.colSpan});b=g_objTableSelection;var f=b.isCellSelected(g[0]);a=0;for(var h=g.length;a<h;a++)c.divideCellCol(g[a],d);if(f){e=c.getSelection()[0];for(a=e.arrCell.length-1;0<=a;a--)b.selectCell(e.arrCell[a],
3);b.selectCell(c.getCell(e.nStartRow,e.nStartCol),2);b.selectCell(c.getCell(e.nEndRow,e.nEndCol),4)}g_objCaretUtil.moveCaret(c.getCell(e.nStartRow,e.nStartCol));return!0}catch(k){dalert(k)}};this.table_TableCellSameHeight=function(b){try{if(!b)return!1;var a=g_objTableResize,d=g_objTableUtil.getMatrix(b),c=d?d.getSelection():null;if(!c||1>c.length)return!1;for(var e=Number.MAX_VALUE,g=0,f=0,h=0,k=0;k<c.length;k++)e=Math.min(c[k].nStartRow,e),g=Math.max(c[k].nEndRow,g);f=g-e+1;if(1>=f&&g_objTableSelection.isCellSelected(c[0].arrCell[0]))return duzon_dialog.showToastMessage(null,
ID_RES_STRING_SELECT_MULTI_ROW,2,"screen_center"),!1;1>=f&&(e=0,g=d.rowLength-1,f=g-e+1);a.prepareResize(b,!1);for(b=20;0<b;){var l=d.arraySum(d.calculateRowHeight()),m=d.calculateRowHeight(),t=d.arraySum(m,e,g);if(0==h)for(var n=e;n<=g;n++)d.isBlankRow(n)&&h++;var p=d.getIntegerDivision(t,f-h);n=e;for(c=0;n<=g;n++,c++)d.isBlankRow(n)?(m[n]=0,c--):m[n]=p[c];var q=d.arrayWidthToPos(m,[]);for(n=e;n<=g;n++)d.isBlankRow(n)&&(q[n]=null);d.arrayFillNullWithMedian(q);m=d.arrayPosToWidth(q,m);for(n=e;n<=
g;n++)a.setRowHeight(d,n,m[n]);d.clearCache();var r=d.arraySum(d.calculateRowHeight());if(5>=Math.abs(r-l))break;b--}a.afterResize();return!0}catch(x){dalert(x)}return!1};this.table_TableCellSameWidth=function(b){try{if(!b)return!1;var a=g_objTableResize,d=g_objTableUtil.getMatrix(b),c=d?d.getSelection():null;if(!c||1>c.length)return!1;for(var e=Number.MAX_VALUE,g=0,f=0,h=0,k=0;k<c.length;k++)e=Math.min(c[k].nStartCol,e),g=Math.max(c[k].nEndCol,g);f=g-e+1;if(1>=f&&g_objTableSelection.isCellSelected(c[0].arrCell[0]))return duzon_dialog.showToastMessage(null,
ID_RES_STRING_SELECT_MULTI_COL,2,"screen_center"),!1;1>=f&&(e=0,g=d.colLength-1,f=g-e+1);a.prepareResize(b,!1);var l=d.calculateColWidth(),m=d.arraySum(l,e,g);for(k=e;k<=g;k++)d.isBlankCol(k)&&h++;var t=d.getIntegerDivision(m,f-h);k=e;for(b=0;k<=g;k++,b++)d.isBlankCol(k)?(l[k]=0,b--):l[k]=t[b];var n=d.arrayWidthToPos(l,[]);for(k=e;k<=g;k++)d.isBlankCol(k)&&(n[k]=null);d.arrayFillNullWithMedian(n);l=d.arrayPosToWidth(n,l);for(k=e;k<=g;k++)a.setColWidth(d,k,l[k]);a.afterResize();return!0}catch(p){dalert(p)}return!1};
this.table_TableCellAlign=function(b,a,d){try{if(!b)return!1;var c=this.table_TableCellHorizontalAlign(b,a);return c|=this.table_TableCellVerticalAlign(b,d)}catch(e){dalert(e)}};this.table_TableCellHorizontalAlign=function(b,a){try{if(!b||"left"!==a&&"center"!==a&&"right"!==a&&"none"!==a)return!1;g_objTableSelection.doAllSelectedCell(function(b){"false"!==b.getAttribute("contenteditable")&&g_objTableUtil.setCellTextAlign(b,a)},b);return!0}catch(d){dalert(d)}};this.table_TableCellVerticalAlign=function(b,
a){try{if(!b||"top"!=a&&"middle"!=a&&"bottom"!=a)return!1;g_objTableSelection.doAllSelectedCell(function(b){"false"!==b.getAttribute("contenteditable")&&(b.style.verticalAlign=a)},b);return!0}catch(d){dalert(d)}};this.table_TableFormula=function(b,a,d,c){try{if(fnObjectCheckNull(b)||!b.ownerDocument)return!1;var e=g_objTableUtil,g=e.getMatrix(b),f=g?g.getSelection():null;if(!f||1<f.length)return!1;f=f[0];var h=0,k=GetCurCell(c);f.arrCell.forEach(function(b){var c=g.getMatrixIndex(b);if(c){var l=g.getRowRange(c[0].row,
c[0].col);c=g.getColRange(c[0].row,c[0].col);if(a==DZE_DIR.HORIZONTAL){var n=l.start;l=l.end;var p=0;var q=g.colLength-1}else if(a==DZE_DIR.VERTICAL)n=0,l=g.rowLength-1,p=c.start,q=c.end;else return;for(c=[];n<=l;n++)for(var r=p;r<=q;r++)if(g.isShow(n,r)){var x=g.getCell(n,r);inArray(x,f.arrCell)||c.push(x)}if(0!=c.length){l=[];for(p=0;p<c.length;p++)q=g_objPropertyUtil.getTextContent(c[p]),q=q.trim(),q=q.removeComma(),q=removeZeroWidthSpaceFromString(q),""==q?l[p]=null:isNaN(q)?l[p]=null:l[p]=parseFloat(q);
c=g_objTableFunction.doFormulaData(l,d);if(null!=c){if(1==d||2==d)c=toFloat(c,3);l=!1;b==k&&(l=!0);e.setCellInnerText(""+c,b);l&&g_objCaretUtil.moveCaret(k,!1,!1);h++}}}});return 0<h?!0:!1}catch(l){dalert(l)}};this.table_SetTableStyle=function(b,a){try{for(var d=b.rows.length,c=g_objTableUtil.getTableCellsLength(b,0),e=0;e<d;e++)for(var g=0;g<c;g++){var f=g_objTableUtil.getTableCellElement(b,e,g);if("undefined"!=f&&null!=f)if(0==e){var h=""==a.firstRow_seperateColor?a.firstRow_borderColor[1]:a.firstRow_seperateColor;
var k=""==a.firstRow_seperateColor?a.firstRow_borderColor[3]:a.firstRow_seperateColor;""==a.firstRow_seperateColor?(f.style.borderRightWidth=0,f.style.borderLeftWidth=0):(f.style.borderRightWidth=1,f.style.borderLeftWidth=1);0==g&&(f.style.borderLeftWidth=1,a.firstRow_backgroundColor!=a.firstRow_borderColor[3]&&(k=a.firstRow_borderColor[3]));g==c-1&&(f.style.borderRightWidth=1,a.firstRow_backgroundColor!=a.firstRow_borderColor[1]&&(h=a.firstRow_borderColor[1]));f.style.borderColor=a.firstRow_borderColor[0]+
" "+k+" "+a.firstRow_borderColor[2]+" "+h;f.style.backgroundColor=a.firstRow_backgroundColor;f.style.color=a.firstRow_fontColor}else if(0==g){h=a.firstCol_borderColor[1];var l=a.firstCol_backgroundColor;""==l&&(l=1==e%2?a.evenRow_backgroundColor:a.oddRow_backgroundColor);""==a.firstCol_borderColor[1]?(f.style.borderRightWidth=0,h="#ffffff"):f.style.borderRightWidth=1;f.style.borderColor=a.firstCol_borderColor[0]+" "+h+" "+a.firstCol_borderColor[2]+" "+a.firstCol_borderColor[3];f.style.backgroundColor=
l;f.style.color=a.firstCol_fontColor}else 1==e%2?(h=""==a.etcRow_seperateColor?a.evenRow_borderColor[1]:a.etcRow_seperateColor,""==a.etcRow_seperateColor?(f.style.borderRightWidth=0,f.style.borderLeftWidth=0):(f.style.borderRightWidth=1,f.style.borderLeftWidth=1),g==c-1&&(f.style.borderRightWidth=1,a.evenRow_backgroundColor!=a.evenRow_borderColor[1]&&(h=a.evenRow_borderColor[1])),f.style.borderColor=a.evenRow_borderColor[0]+" "+h+" "+a.evenRow_borderColor[2]+" "+a.evenRow_borderColor[3],f.style.backgroundColor=
a.evenRow_backgroundColor,f.style.color=a.evenRow_fontColor):0==e%2&&(h=""==a.etcRow_seperateColor?a.oddRow_borderColor[1]:a.etcRow_seperateColor,""==a.etcRow_seperateColor?(f.style.borderRightWidth=0,f.style.borderLeftWidth=0):(f.style.borderRightWidth=1,f.style.borderLeftWidth=1),g==c-1&&(f.style.borderRightWidth=1,a.evenRow_backgroundColor!=a.oddRow_borderColor[1]&&(h=a.oddRow_borderColor[1])),f.style.borderColor=a.oddRow_borderColor[0]+" "+h+" "+a.oddRow_borderColor[2]+" "+a.oddRow_borderColor[3],
f.style.backgroundColor=a.oddRow_backgroundColor,f.style.color=a.oddRow_fontColor)}}catch(m){dalert(m)}};this.convertChildTableToText=function(b,a){try{if(!b)return!1;[].slice.call(b.getElementsByTagName("table")).forEach(function(b){this.convertTableToText(b,a)}.bind(this));return!0}catch(d){dalert(d)}};this.convertTableToText=function(b,a){try{var d=g_objNodeUtil;if(!b||!b.parentNode||!d.checkTagName(b,"table"))return!1;var c=b.ownerDocument,e=null;g_objTableUtil.getSplitTables(b).forEach(function(a){var b=
a.parentNode,g=[a];g=g.concat([].slice.call(a.getElementsByTagName("table")));if(0>=g.length)return!1;g.forEach(function(a){a=d.splitOn(b,a);d.checkTagName(a,"table")&&g.push(a)}.bind(this));g.forEach(function(a){var b=this.tableToText(a,"<p>","</p>","","<span style='white-space:pre'>\t</span>");b=c.createRange().createContextualFragment(b);e=b.lastChild;a.parentNode.replaceChild(b,a)}.bind(this))}.bind(this));e&&!1!==a&&g_objCaretUtil.moveCaret(e,!0,!1);return!0}catch(g){dalert(g)}};this.tableToText=
function(b,a,d,c,e){try{"undefined"==typeof a&&(a="");"undefined"==typeof d&&(d="\n");"undefined"==typeof c&&(c="");"undefined"==typeof e&&(e="\t");var g=g_objNodeUtil,f="",h=b.rows;b=0;for(var k=h.length;b<k;b++){var l=h[b].cells;f+=a;for(var m=0,t=l.length;m<t;m++)0!=m&&(f+=c),f+=g.getInnerText(l[m]),m!=t-1&&(f+=e);f+=d}return f}catch(n){dalert(n)}};this.convertTableToFormatText=function(b){try{if(!b||!b.parentNode||"TABLE"!==b.nodeName)return!1;var a=g_objNodeUtil,d=g_objTableUtil,c=g_objCaretUtil,
e=b.ownerDocument.createDocumentFragment(),g=c.saveCaret(),f=a.getLoopParentElementByTagNames(g?g.start?g.start:g.end:null,["td","th"]);g_objTableUtil.getSplitTables(b).forEach(function(b){var c=b.parentNode,g=[b];g=g.concat([].slice.call(b.getElementsByTagName("table")));if(0>=g.length)return!1;g.forEach(function(b){(b=a.splitOn(c,b))&&"TABLE"===b.nodeName&&g.push(b)}.bind(this));g.forEach(function(b){var c=b.querySelectorAll("td, th");forEach(c,function(b,c){d.isBlankCell(c)&&f!==c||a.moveNodesTo(e,
c.firstChild)});caretNode=e.lastChild;b.parentNode.replaceChild(e,b)}.bind(this))}.bind(this));c.restoreCaret();return!0}catch(h){dalert(h)}};this.insertTableRowForTest=function(b,a,d){try{if(!b||!a||!d)return!1;var c=g_objNodeUtil,e=g_objTableUtil,g=g_objTableResize,f=b.DZE_TEMP;b.calculateRowHeight();for(var h=a.nEndRow,k=h+1,l=0;l<a.nStartCol;l++)b.equalCell(a.nStartRow,l,a.nEndRow,l)&&c.setAttribute(b.getCell(a.nStartRow,l),f,"");for(l=a.nEndCol+1;l<b.colLength;l++)b.equalCell(a.nStartRow,l,a.nEndRow,
l)&&c.setAttribute(b.getCell(a.nStartRow,l),f,"");b.splitRow(k);insertAfter(b.trs[h],d);b.makeMatrix();var m=a.nStartRow-1,t=a.nEndRow+(a.nEndRow-a.nStartRow+1)+1;for(l=a.nStartCol-1;0<=l;l--){d=a=null;for(h=m;h<=t;h=b.getRowRange(h,l).end+1)a=b.getCell(h,l),a=c.hasAttribute(a,f)?a:null,c.removeAttribute(a,f),a&&(d=d||[],d.push(a));if(d&&0!=d.length){a=d[0];k=h=0;for(var n=d.length;k<n;k++)h+=b.getRowspan(d[k]);k=1;for(n=d.length;k<n;k++)d[k].parentNode.removeChild(d[k]);b.setRowspan(a,h);var p=g.offsetHeightToStyleHeight(a.offsetHeight,
a);e.setNodeValue_Height(a,p,"px")}}b.makeMatrix();return!0}catch(q){dalert(q)}};this.autoInsertNewRow=function(b,a,d,c){try{var e=c.ownerDocument,g=c.rows,f=g.length,h=b.getRowRange(a,d).end;for(a=0;a<d;a++)if(!b.isHideForColspan(h,a)){var k=b.getCell(h,a),l=b.getRowspan(k);l+=f;b.setRowspan(k,l)}var m=e.createDocumentFragment();for(d=0;d<f;d++)m.appendChild(g[0]);insertAfter(b.trs[h],m);b.makeMatrix()}catch(t){dalert(t)}};this.deleteCell=function(b,a,d){try{if(!b&&!a)return!1;var c=g_objNodeUtil,
e=g_objTableUtil;if(b&&a&&!e.isCellInSameTable(b,a))return!1;d=d||new TableMatrix(c.getLoopParentElement(b||a,"table"),!1,!0);if(!d)return!1;var g=d.getMatrixIndex(b),f=d.getMatrixIndex(a);g&&f&&(g[0].row>f[0].row||g[0].row===f[0].row&&g[0].col>f[0].col)&&(b=f,f=g,g=b);a=b=0;var h=d.colLength-1,k=d.rowLength-1;g&&f?(b=g[0].col,a=g[0].row,h=f[f.length-1].col,k=f[f.length-1].row):g&&!f?(b=g[0].col,a=g[0].row):!g&&f&&(h=f[f.length-1].col,k=f[0].row);if(0===a&&0===b&&k===d.rowLength-1&&h===d.colLength-
1)return this.deleteTable(d.table);if(a===k)for(var l=b;l<=h;l++)d.isShow(a,l)&&this.deleteCellContents(d.getCell(a,l));else{for(l=b;l<d.colLength;l++)d.isShow(a,l)&&this.deleteCellContents(d.getCell(a,l));for(l=0;l<=h;l++)d.isShow(k,l)&&this.deleteCellContents(d.getCell(k,l))}a<=k&&d.removeRow(0===b?a:a+1,h===d.colLength-1?k:k-1);return!0}catch(m){dalert(m)}};this.nativeRangeToCellRange=function(b){try{if(!b||b.collapsed)return null;var a=b.startContainer,d=b.startOffset,c=b.endContainer,e=b.endOffset;
if(!a||"TR"!==a.nodeName&&"TABLE"!==a.nodeName||!c||"TR"!==c.nodeName&&"TABLE"!==c.nodeName)return null;b=g_objNodeUtil;var g=b.getLoopParentElement(a,"table"),f=b.getLoopParentElement(c,"table");if(!g||!f||!g_objTableUtil.isSameTable(g,f))return null;var h=new TableMatrix(g,!1,!0);if(!h)return null;g=null;"TABLE"===a.nodeName&&0===d?g=a.rows[0].cells[0]:"TR"===a.nodeName&&(g=a.cells[d],!g&&1<d&&a.cells[d-1]&&(g=h.getNextCellFromCell(a.cells[d-1])));a=null;if("TABLE"===c.nodeName&&e===c.childNodes.length){var k=
c.rows[c.rows.length-1];a=k.cells[k.cells.length-1]}else"TR"===c.nodeName&&(1<e&&(a=c.cells[e-1]),!a&&c.cells[e]&&(a=h.getPrevCellFromCell(c.cells[e])));if(!g||!a)return null;var l=h.getMatrixIndex(g),m=h.getMatrixIndex(a);return l&&m&&(l[0].row>m[0].row||l[0].row===m[0].row&&l[0].col>m[0].col)?null:{matrix:h,stCell:g,enCell:a}}catch(t){dalert(t)}};this.sortRangePropArrayInDocumentOrder=function(b){try{if(b&&b.length){var a=b[0].sc.ownerDocument;if(a){var d=a.createRange(),c=a.createRange();b.sort(function(a,
b){if(a.sc===b.sc)return a.so-b.so;a.getRange(d);b.getRange(c);return d.compareBoundaryPoints(Range.START_TO_START,c)})}}}catch(e){dalert(e)}finally{c=d=null}};this.getDepthUntilBound=function(b,a){try{for(var d=0;b&&b!==a.parentNode&&"BODY"!==b.nodeName;)d++,b=b.parentNode;return d}catch(c){dalert(c)}};this.getClosetTableIfTr=function(b){try{var a=b.nodeName;return"TR"===a||"TBODY"===a||"THEAD"===a||"COLGROUP"===a?g_objNodeUtil.getLoopParentElement(b,"table"):null}catch(d){dalert(d)}};this.divideRangeOnCellForDel=
function(b){try{if(!b)return null;var a=g_objNodeUtil,d=g_objTableUtil,c=b.commonAncestorContainer;if(!c)return null;c=this.getClosetTableIfTr(c)||c;if(!c)return null;for(var e=[],g=function(a,b,c,d){var f=new RangeProp;f.init(a,b,c,d);e.push(f)},f=new RangeProp(b),h=b=null,k=null,l=null,m=0,t=0,n=!1,p=null;!(p&&f.equal(p)||f.collapsed());)p=f.clone(),b=d.getClosetCell(f.sc,c),k=d.getClosetTable(b,c),h=d.getClosetCell(f.ec,c),l=d.getClosetTable(h,c),m=this.getDepthUntilBound(b,c),t=this.getDepthUntilBound(h,
c),(n=d.isSameTable(k,l))?(g(f.sc,f.so,b,b.childNodes.length),g(b.parentNode,a.getChildIndex(b)+1,h.parentNode,a.getChildIndex(h)),g(h,0,f.ec,f.eo),f.ec=f.sc,f.eo=f.so):m>=t&&k?(g(f.sc,f.so,b,b.childNodes.length),g(b.parentNode,a.getChildIndex(b)+1,k,k.childNodes.length),f.sc=k.parentNode,f.so=a.getChildIndex(k)+1):m<=t&&l?(g(l,0,h.parentNode,a.getChildIndex(h)),g(h,0,f.ec,f.eo),f.ec=l.parentNode,f.eo=a.getChildIndex(l)):(e.push(f.clone()),f.ec=f.sc,f.eo=f.so);for(a=0;a<e.length;a++)e[a].collapsed()&&
(e.splice(a,1),a--);this.sortRangePropArrayInDocumentOrder(e);return e}catch(q){dalert(q)}};this.divideRangeOnCellForCopy=function(b){try{if(!b)return null;var a=g_objNodeUtil,d=g_objTableUtil,c=b.commonAncestorContainer;if(!c)return null;c=this.getClosetTableIfTr(c)||c;if(!c)return null;for(var e=[],g=function(a,b,c,d){var f=new RangeProp;f.init(a,b,c,d);e.push(f)},f=new RangeProp(b),h=b=null,k=null,l=null,m=0,t=0,n=!1,p=null;!(p&&f.equal(p)||f.collapsed());)if(p=f.clone(),b=d.getClosetCell(f.sc,
c),k=d.getClosetTable(b,c),h=d.getClosetCell(f.ec,c),l=d.getClosetTable(h,c),m=this.getDepthUntilBound(b,c),t=this.getDepthUntilBound(h,c),n=d.isSameTable(k,l))g(b,0,f.sc,f.so),g(k,0,b.parentNode,a.getChildIndex(b)),g(f.ec,f.eo,h,h.childNodes.length),g(h.parentNode,a.getChildIndex(h)+1,l,l.childNodes.length),f.sc=k.parentNode,f.so=a.getChildIndex(k),f.ec=l.parentNode,f.eo=a.getChildIndex(l)+1;else if(m>=t&&k)g(b,0,f.sc,f.so),g(k,0,b.parentNode,a.getChildIndex(b)),f.sc=k.parentNode,f.so=a.getChildIndex(k);
else if(m<=t&&l)g(f.ec,f.eo,h,h.childNodes.length),g(h.parentNode,a.getChildIndex(h)+1,l,l.childNodes.length),f.ec=l.parentNode,f.eo=a.getChildIndex(l)+1;else break;for(a=0;a<e.length;a++)e[a].collapsed()&&(e.splice(a,1),a--);this.sortRangePropArrayInDocumentOrder(e);return e}catch(q){dalert(q)}};this.deleteSelectionOnCell=function(b){try{if(GetMultiCellSelection(b)||!SelectionUtil.isSelectionOnCell(b))return!1;var a=GetCurRange(b);if(!a||a.collapsed)return!1;var d=this.divideRangeOnCellForDel(a);
if(!d)return!1;var c=g_objEditorDocument[b];c.defaultView.getSelection().removeAllRanges();dlog("delete selection on cell directly!");b=SelectionUtil;var e=c.createRange();c=null;a=[];for(var g=null,f=d.length-1;0<=f;f--)d[f].getRange(e),(c=this.nativeRangeToCellRange(e))?this.deleteCell(c.stCell,c.enCell,c.matrix):(g=b.execDeleteSelection(e))&&a.push(g);this.sortRangePropArrayInDocumentOrder(a);(g=a[0])&&SetCurRange(g.getRange(e));return!0}catch(h){dalert(h)}finally{}};this.cloneSelectionOnCell=
function(b){try{if(GetMultiCellSelection(b)||!SelectionUtil.isSelectionOnCell(b))return!1;var a=GetCurRange(b);if(!a||a.collapsed)return!1;var d=a.commonAncestorContainer;if(!d)return!1;d=this.getClosetTableIfTr(d)||d;if(!d)return!1;b=g_objTableUtil;var c=g_objNodeUtil,e=function(a,b,d){for(var e=[b];a&&a!==d;)b=c.getChildIndex(a),e.push(b),a=a.parentNode;return e.reverse()},g=function(a,b){for(var c=0,d,e=0,f=a.length;e<f;e++){c=a[e];d=b.childNodes[c];if(!d)break;b=d}return{offsetNode:b,offset:c}},
f=d.ownerDocument,h=new RangeProp(a),k=null,l=null,m=b.getFarthestTable(h.sc,d),t=b.getFarthestTable(h.ec,d);m&&(m.setAttribute("DZE_TEMP_CLONE_TABLE_START",""),k=e(h.sc,h.so,m));t&&(t.setAttribute("DZE_TEMP_CLONE_TABLE_END",""),l=e(h.ec,h.eo,t));m&&(h.sc=m.parentNode,h.so=c.getChildIndex(m));t&&(h.ec=t.parentNode,h.eo=c.getChildIndex(t)+1);var n=f.createRange();n.setStart(h.sc,h.so);n.setEnd(h.ec,h.eo);var p=(new RangeArray(n)).cloneContents(!1);m&&m.removeAttribute("DZE_TEMP_CLONE_TABLE_START");
t&&t.removeAttribute("DZE_TEMP_CLONE_TABLE_END");var q=f.createElement("div");q.appendChild(p);appendBodyTemporary(q,null,function(){var a=new RangeProp;a.init(q,0,q,q.childNodes.length);var b=q.querySelector("table[DZE_TEMP_CLONE_TABLE_START]"),d=q.querySelector("table[DZE_TEMP_CLONE_TABLE_END]");b&&(b.removeAttribute("DZE_TEMP_CLONE_TABLE_START"),b=g(k,b),a.sc=b.offsetNode,a.so=b.offset);d&&(d.removeAttribute("DZE_TEMP_CLONE_TABLE_END"),b=g(l,d),a.ec=b.offsetNode,a.eo=b.offset);d=SelectionUtil;
a.getRange(n);a=this.divideRangeOnCellForCopy(n);for(b=a.length-1;0<=b;b--){a[b].getRange(n);var e=this.nativeRangeToCellRange(n);e?this.deleteCell(e.stCell,e.enCell,e.matrix):d.execDeleteSelection(n)}c.moveNodesTo(p,q.firstChild)}.bind(this));return p}catch(r){dalert(r)}finally{n=a=null}}};

var g_objTableFunction=new function(){this.createTable=function(a,c){try{g_bActivate[c]||g_objInsertUtil.activeSaveRangeFocus(0,c);var b=!1;if(window.attachEvent)ID_STRING_NAME_CONTROL!=g_objEditorDocument[g_nActiveEditNumber].selection.type.toLowerCase()&&(b=!0);else{var d=getSelectionType();if(d.nodeType==ID_SELECTION_ELEMENT_NODE||d.nodeType==ID_SELECTION_TEXT_NODE)b=!0}if(!b)return null;var e=GetCurRange(c);if(!e)return null;var g=g_objTableUtil,f=g_objNodeUtil,l=f.getClosetBound(e.startContainer,
function(a){return f.isListItem(a)?!0:!1});if(!l)return null;var h=l.ownerDocument,k=g_objPositionUtil.getInnerWidth(l);b=function(a){return"undefined"!==typeof a&&null!==a?!0:!1};var m=a[0],n=a[1],p=a[2],w=b(a[3])?a[3]:"px",x=b(a[6])?a[6]:3,r=b(a[7])?a[7]:"1px solid rgb(0, 0, 0)",y=b(a[8])?a[8]:"1px solid rgb(0, 0, 0)",A=b(a[9])?a[9]:"1px solid rgb(0, 0, 0)",E=b(a[10])?a[10]:"1px solid rgb(0, 0, 0)",G=b(a[11])?a[11]:"1px solid rgb(0, 0, 0)",L=b(a[12])?a[12]:"1px solid rgb(0, 0, 0)",F=a[13],t=a[14],
O=a[15],B=a[16],M=a[17],u=a[18],v=a[19],q=a[20],I=a[21],H=a[22],J=b(a[23])?a[23]:!0,C=a[24],D=a[25];"%"==w?null==p&&(p=100):null==p&&(p=k);a="width:"+ID_TABLE_INSERT_CELL_WIDTH+"px;";k="height:"+ID_TABLE_INSERT_CELL_HEIGHT+"px;";b="";null!=p&&(b="width:"+p+w+";");w="";null!=x&&(w='cellpadding="'+x+'"');x='cellspacing="0"';null!=H&&(x='cellspacing="'+H+'"');H="";!0===J&&(H="border-collapse:collapse;");J=!1;r==y&&r==A&&r==E&&r==G&&r==L&&(J=!0);d="";null!=F&&(d="background-color:"+F+";");F="";null!=
t&&(F="background-image:url("+t+");",F+="background-repeat:"+O+";");t="";""!=B?"left"==B?t="margin-left:"+("undefined"!==typeof u?u:"0")+";margin-right:auto;":"center"==B?t="margin-left:auto;margin-right:auto;":"right"==B&&(t="margin-left:auto;margin-right:"+("undefined"!==typeof q?q:"0")+";"):("undefined"!==typeof u&&null!==u&&0!==u&&(t=t+"margin-left:"+u+";"),"undefined"!==typeof q&&null!==q&&0!==q&&(t=t+"margin-right:"+q+";"));"undefined"!==typeof v&&null!==v&&0!==v&&(t=t+"margin-top:"+v+";");
"undefined"!==typeof I&&null!==I&&0!==I&&(t=t+"margin-bottom:"+I+";");B="<p><br></p>";window.attachEvent&&(B="<p>&nbsp;</p>");(v=H+b+t+d+F)&&(v='style="'+v+'"');u="";u+="<table "+(C?'id="'+C+'"':"")+' class="dze_table'+(D?" "+D:"")+'" '+x+" "+w+" "+v+">";for(C=0;C<m;C++){u+="<tr>";for(D=0;D<n;D++)v="",v+=a,v+=k,J?v+="border:"+r+";":(q="",2<=m?0==C?q+="border-top:"+r+";":C==m-1?q+="border-bottom:"+A+";":(q+="border-top:"+y+";",q+="border-bottom:"+y+";"):(q+="border-top:"+r+";",q+="border-bottom:"+
A+";"),2<=n&&(0==D?q+="border-left:"+E+";":D==n-1?q+="border-right:"+L+";":(q+="border-left:"+G+";",q+="border-right:"+G+";")),""!=q&&(v+=q)),u+='<td style="'+v+'">',u+=B,u+="</td>";u+="</tr>"}var z=g_objInsertUtil.insertTableCodeAtSelection(u+"</table>",c);if(!0===g_browserCHK.sf&&z&&f.isCell(z.parentNode)&&z.parentNode.firstChild===z){var K=h.createElement("p");K.className="dze_hide_para";K.innerHTML="<br>";z.parentNode.insertBefore(K,z)}var P=getIntegerDivision(p,n);g_objTableSelection.doAllCell(function(a,
b,c){b=g.offsetWidthToStyleWidth(P[c],a);g.setNodeValue_Width(a,b,"px")},z);M&&g_objTableOperation.table_SetTableStyle(z,M);return z}catch(N){dalert(N)}return!1};this.GetTableCellBorderAttribute=function(a,c){try{if(!a||"left"!=c&&"top"!=c&&"right"!=c&&"bottom"!=c)return null;var b=g_objPropertyUtil,d={};d.style=b.getElementStyleAttributeValue(a,"border-"+c+"-style",g_nActiveEditNumber);var e=b.getElement_BorderWidth_With_Unit(a,c);null!=e&&(d.width=e.nValue,d.width_unit=e.strUnit);d.color=b.getElementStyleAttributeValue(a,
"border-"+c+"-color",g_nActiveEditNumber);return d}catch(g){dalert(g)}};this.SetTableCellBorderAttribute=function(a,c,b){try{if(!a||!c||"left"!=b&&"top"!=b&&"right"!=b&&"bottom"!=b)return!1;var d=g_objPropertyUtil;""==c.width_unit&&(c.width_unit="px");0!=c.width&&(a.style[camelCase("border-"+b+"-width")]=c.width+c.width_unit,d.setElement_BorderStyle(a,c.style,b),"left"==b&&d.setElement_BorderLeftColor(a,c.color),"top"==b&&d.setElement_BorderTopColor(a,c.color),"right"==b&&d.setElement_BorderRightColor(a,
c.color),"bottom"==b&&d.setElement_BorderBottomColor(a,c.color));return!0}catch(e){dalert(e)}};this.doFormulaData=function(a,c){try{for(var b=null,d=null,e=0,g=0;g<a.length;g++)if(null!=a[g]){var f=a[g].toString(),l=f.split(".");if(0==c||1==c){null==b&&(b=0);null==d&&(d=0);if(2==l.length){b+=parseInt(l[0]);var h="0."+l[1];d+=parseFloat(h)}else b+=parseInt(f);1==c&&e++}else if(2==c)if(null==b&&(b=1),2==l.length){var k=null,m=null;k=b*parseInt(l[0]);h="0."+l[1];m=b*parseFloat(h);b=k+m}else b*=parseInt(f)}if(null!=
b){if(0==c)return b+d;if(1==c)return(b+d)/e;if(2==c)return b}}catch(n){dalert(n)}return null};this.getSelectedCellAttribute=function(a,c,b){try{if(fnObjectCheckNull(a)||fnObjectCheckNull(c))return null;var d=[];d[ID_PROP_NODE_BACKGROUND_COLOR]=[];d[ID_PROP_NODE_BACKGROUND_IMAGE]=[];var e=0;g_objTableSelection.doAllSelectedCell(function(a){var b=a.style.backgroundColor;null!=b&&""!=b?b=g_objCommonUtil.getHexColorCode(b):(b=a.bgColor,b=null!=b&&""!=b?g_objCommonUtil.getHexColorCode(b):null);d[ID_PROP_NODE_BACKGROUND_COLOR][e]=
b;b=g_objPropertyUtil.getBackgroundImageURL(a);if(null==b||""==b)b=null;a=a.style.backgroundRepeat;if(null==a||""==a)a=null;d[ID_PROP_NODE_BACKGROUND_IMAGE][e]=[b,a];e++},c);if(0==e)return null;a=[];a[ID_PROP_NODE_BORDER]=this.getCellBorderAttribute(c,!0);a[ID_PROP_NODE_BACKGROUND_COLOR]=d[ID_PROP_NODE_BACKGROUND_COLOR][0];a[ID_PROP_NODE_BACKGROUND_IMAGE]=d[ID_PROP_NODE_BACKGROUND_IMAGE][0];if(1<e)for(c=1;c<e;c++)d[ID_PROP_NODE_BACKGROUND_COLOR][0]!=d[ID_PROP_NODE_BACKGROUND_COLOR][c]&&(a[ID_PROP_NODE_BACKGROUND_COLOR]=
null),d[ID_PROP_NODE_BACKGROUND_IMAGE][0][0]!=d[ID_PROP_NODE_BACKGROUND_IMAGE][c][0]&&(a[ID_PROP_NODE_BACKGROUND_IMAGE]=[null,null]),d[ID_PROP_NODE_BACKGROUND_IMAGE][0][1]!=d[ID_PROP_NODE_BACKGROUND_IMAGE][c][1]&&(a[ID_PROP_NODE_BACKGROUND_IMAGE]=[null,null]);return a}catch(g){dalert(g)}return null};this.getCellBorderAttribute=function(a,c,b){try{fnObjectCheckNull(b)&&(b="");var d="borderTop"+b,e="borderBottom"+b,g="borderRight"+b;b="borderLeft"+b;var f=[[!1,!1],[]];f[1][0]=null;f[1][1]=null;f[1][2]=
null;f[1][3]=null;f[1][4]=null;f[1][5]=null;var l=g_objTableUtil.getMatrix(a),h=l?l.getSelection():null;if(!h||1<h.length)return null;h=c?h[0]:{nStartRow:0,nStartCol:0,nEndRow:l.rowLength-1,nEndCol:l.colLength-1,arrCell:[]};c=a=0;for(var k=h.nStartCol;k<=h.nEndCol&&!(l.isBlankCol(k)||a++,1<a);k++);for(k=h.nStartRow;k<=h.nEndRow&&!(l.isBlankRow(k)||c++,1<c);k++);f[0]=[1<c?!0:!1,1<a?!0:!1];a=k=0;var m=c=null;for(k=Math.max(h.nStartRow-1,0);k<=h.nStartRow&&0<=k;k++)for(a=h.nStartCol;a<=h.nEndCol;a++)if(!l.isHideForColspan(k,
a)){if(f[1][0]==ID_PROP_BORDER_DUPLICATED)break;c=l.getColRange(k,a);c.start<h.nStartCol||c.end>h.nEndCol||(m=l.getCell(k,a),k==h.nStartRow?this.assignMappingBorderValue(f[1],0,m.style[d]):this.assignMappingBorderValue(f[1],0,m.style[e]))}for(k=h.nStartRow;k<=h.nEndRow;k++)for(a=h.nStartCol;a<=h.nEndCol;a++)if(l.isShow(k,a)){if(f[1][1]==ID_PROP_BORDER_DUPLICATED)break;m=l.getCell(k,a);k==h.nStartRow?this.assignMappingBorderValue(f[1],1,m.style[e]):this.assignMappingBorderValue(f[1],1,m.style[d])}for(k=
h.nEndRow;k<=h.nEndRow+1&&k<l.rowLength;k++)for(a=h.nStartCol;a<=h.nEndCol;a++)if(!l.isHideForColspan(k,a)){if(f[1][2]==ID_PROP_BORDER_DUPLICATED)break;c=l.getColRange(k,a);c.start<h.nStartCol||c.end>h.nEndCol||(m=l.getCell(k,a),k==h.nEndRow?this.assignMappingBorderValue(f[1],2,m.style[e]):this.assignMappingBorderValue(f[1],2,m.style[d]))}for(a=Math.max(h.nStartCol-1,0);a<=h.nStartCol&&0<=a;a++)for(k=h.nStartRow;k<=h.nEndRow;k++)if(!l.isHideForRowspan(k,a)){if(f[1][3]==ID_PROP_BORDER_DUPLICATED)break;
c=l.getRowRange(k,a);c.start<h.nStartRow||c.end>h.nEndRow||(m=l.getCell(k,a),a==h.nStartCol?this.assignMappingBorderValue(f[1],3,m.style[b]):this.assignMappingBorderValue(f[1],3,m.style[g]))}for(k=h.nStartRow;k<=h.nEndRow;k++)for(a=h.nStartCol;a<=h.nEndCol;a++)if(l.isShow(k,a)){if(f[1][4]==ID_PROP_BORDER_DUPLICATED)break;m=l.getCell(k,a);a==h.nStartCol?this.assignMappingBorderValue(f[1],4,m.style[g]):this.assignMappingBorderValue(f[1],4,m.style[b])}for(a=h.nEndCol;a<=h.nEndCol+1&&a<l.colLength;a++)for(k=
h.nStartRow;k<=h.nEndRow;k++)if(!l.isHideForRowspan(k,a)){if(f[1][5]==ID_PROP_BORDER_DUPLICATED)break;c=l.getRowRange(k,a);c.start<h.nStartRow||c.end>h.nEndRow||(m=l.getCell(k,a),a==h.nEndCol?this.assignMappingBorderValue(f[1],5,m.style[g]):this.assignMappingBorderValue(f[1],5,m.style[b]))}return f}catch(n){dalert(n)}return null};this.assignMappingBorderValue=function(a,c,b){try{ID_PROP_BORDER_DUPLICATED!=a[c]&&(null==a[c]?a[c]=b:b!=a[c]&&(a[c]=ID_PROP_BORDER_DUPLICATED))}catch(d){dalert(d)}};this.setSelectedCellAttribute=
function(a,c,b,d){try{fnObjectCheckNull(c)||fnObjectCheckNull(b)||(this.setCellBorderAttribute(a[ID_PROP_NODE_BORDER],c,b,!0,d),a[ID_PROP_NODE_BACKGROUND_COLOR][0]?g_objTableSelection.doAllCell(function(b){!0!==this.isCellLocked(b)&&(this.setSelectedCellAttribute_BackgroundColor(b,!0,a[ID_PROP_NODE_BACKGROUND_COLOR][2]),this.setSelectedCellAttribute_BackgroundImage(b,!0,a[ID_PROP_NODE_BACKGROUND_IMAGE][2],a[ID_PROP_NODE_BACKGROUND_IMAGE][3]))}.bind(this),b):g_objTableSelection.doAllSelectedCell(function(b){!0!==
this.isCellLocked(b)&&(this.setSelectedCellAttribute_BackgroundColor(b,a[ID_PROP_NODE_BACKGROUND_COLOR][1],a[ID_PROP_NODE_BACKGROUND_COLOR][2]),this.setSelectedCellAttribute_BackgroundImage(b,a[ID_PROP_NODE_BACKGROUND_IMAGE][1],a[ID_PROP_NODE_BACKGROUND_IMAGE][2],a[ID_PROP_NODE_BACKGROUND_IMAGE][3]))}.bind(this),b))}catch(e){dalert(e)}};this.setCellBorderAttribute=function(a,c,b,d,e){try{if(a[0]){var g=a[1]?a[7]:"",f=a[2]?a[8]:"",l=a[3]?a[9]:"",h=a[4]?a[10]:"",k=a[5]?a[11]:"",m=a[6]?a[12]:"",n=new TableMatrix(b),
p=n?n.getSelection():null;if(p&&!(1<p.length)){if(d)p=p[0];else{var w=[];g_objTableSelection.doAllTable(function(a){a=[].slice.call(a.querySelectorAll("td, th"));w=w.concat(a)},b);p={nStartRow:0,nStartCol:0,nEndRow:n.rowLength-1,nEndCol:n.colLength-1,arrCell:w}}var x=p.nStartRow,r=p.nEndRow,y=p.nStartCol,A=p.nEndCol;p.arrCell.forEach(function(a){var b=n.getRowRangeFromCell(a),c=n.getColRangeFromCell(a);var d=y==c.start?h:k;null!==d&&this.setCellBorder(a,DZE_DIR.LEFT,d,n);d=A==c.end?m:k;null!==d&&
this.setCellBorder(a,DZE_DIR.RIGHT,d,n);d=x==b.start?g:f;null!==d&&this.setCellBorder(a,DZE_DIR.TOP,d,n);d=r==b.end?l:f;null!==d&&this.setCellBorder(a,DZE_DIR.BOTTOM,d,n)}.bind(this))}}}catch(E){dalert(E)}};this.setCellBorder=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeft=b;break;case DZE_DIR.TOP:a.style.borderTop=b;break;case DZE_DIR.RIGHT:a.style.borderRight=b;break;case DZE_DIR.BOTTOM:a.style.borderBottom=b;break;default:a.style.border=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,
"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,c,b,d,this.setCellBorder)}}}catch(g){dalert(g)}};this.setCellBorderWidth=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeftWidth=b;break;case DZE_DIR.TOP:a.style.borderTopWidth=b;break;case DZE_DIR.RIGHT:a.style.borderRightWidth=b;break;case DZE_DIR.BOTTOM:a.style.borderBottomWidth=b;break;default:a.style.borderWidth=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&
this.setNeighborCellBorder(a,c,b,d,this.setCellBorderWidth)}}}catch(g){dalert(g)}};this.setCellBorderStyle=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeftStyle=b;break;case DZE_DIR.TOP:a.style.borderTopStyle=b;break;case DZE_DIR.RIGHT:a.style.borderRightStyle=b;break;case DZE_DIR.BOTTOM:a.style.borderBottomStyle=b;break;default:a.style.borderStyle=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,
c,b,d,this.setCellBorderStyle)}}}catch(g){dalert(g)}};this.setCellBorderColor=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeftColor=b;break;case DZE_DIR.TOP:a.style.borderTopColor=b;break;case DZE_DIR.RIGHT:a.style.borderRightColor=b;break;case DZE_DIR.BOTTOM:a.style.borderBottomColor=b;break;default:a.style.borderColor=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,c,b,d,this.setCellBorderColor)}}}catch(g){dalert(g)}};
this.setNeighborCellBorder=function(a,c,b,d,e){try{var g=null;g=c?[c]:[DZE_DIR.LEFT,DZE_DIR.TOP,DZE_DIR.RIGHT,DZE_DIR.BOTTOM];for(c=0;c<g.length;c++)for(var f=g[c],l=DZE_DIR.reverse(f),h=this.getNeighborCell(a,f,d),k=0;k<h.length;k++)e(h[k],l,b)}catch(m){dalert(m)}};this.getNeighborCell=function(a,c,b){try{var d=[];if(!a||!c||!b)return d;var e=b.getMatrixIndex(a),g=e[0].row,f=e[0].col,l=b.getRowRange(g,f),h=b.getColRange(g,f);if(c==DZE_DIR.TOP){if(g=l.start-1,0>g)return d}else if(c==DZE_DIR.BOTTOM){if(g=
l.end+1,g>=b.rowLength)return d}else if(c==DZE_DIR.LEFT){if(f=h.start-1,0>f)return d}else if(c==DZE_DIR.RIGHT){if(f=h.end+1,f>=b.colLength)return d}else return d;if(c==DZE_DIR.TOP||c==DZE_DIR.BOTTOM)for(f=h.start;f<=h.end&&f<b.colLength;f++){if(!b.isHideForColspan(g,f)){var k=b.getColRange(g,f);h.start<=k.start&&h.end>=k.end&&d.push(b.getCell(g,f))}}else if(c==DZE_DIR.LEFT||c==DZE_DIR.RIGHT)for(g=l.start;g<=l.end&&g<b.rowLength;g++)b.isHideForRowspan(g,f)||(k=b.getRowRange(g,f),l.start<=k.start&&
l.end>=k.end&&d.push(b.getCell(g,f)));return d}catch(m){dalert(m)}};this.setSelectedCellAttribute_BackgroundColor=function(a,c,b){try{c&&(null==b||""==b?(a.removeAttribute("bgColor"),g_objPropertyUtil.removeStyleAttribute(a,"background-color")):(a.removeAttribute("bgColor"),a.style.backgroundColor=b))}catch(d){dalert(d)}};this.setSelectedCellAttribute_BackgroundImage=function(a,c,b,d){try{c&&(null==b||""==b?(g_objPropertyUtil.removeStyleAttribute(a,"background-image"),g_objPropertyUtil.removeStyleAttribute(a,
"background-repeat")):(a.style.backgroundImage="url("+getFullUrlFromPath(b)+")",a.style.backgroundRepeat=d,"no-repeat"==d&&(a.style.backgroundPosition="center center")))}catch(e){dalert(e)}};this.setTableAttribute=function(a,c,b,d){try{if(!fnObjectCheckNull(c)&&!fnObjectCheckNull(b)){if(a[ID_PROP_NODE_BORDER][0]){var e=a[ID_PROP_NODE_BORDER][2],g=a[ID_PROP_NODE_BORDER][5],f=a[ID_PROP_NODE_BORDER][7],l=a[ID_PROP_NODE_BORDER][8],h=a[ID_PROP_NODE_BORDER][10],k=a[ID_PROP_NODE_BORDER][11],m=a[ID_PROP_NODE_BORDER][12],
n=!1;f==a[ID_PROP_NODE_BORDER][9]&&f==h&&f==m&&(e&&g?f==l&&f==k&&(n=!0):e&&!g?f==l&&(n=!0):!e&&g?f==k&&(n=!0):n=!0);if(n){var p=b.rows.length;for(c=0;c<p;c++){var w=g_objTableUtil.getTableCellsLength(b,c);for(d=0;d<w;d++)g_objTableUtil.getTableCellElement(b,c,d).style.border=f}}else this.setCellBorderAttribute(a[ID_PROP_NODE_BORDER],c,b,!1,d)}if(a[ID_PROP_NODE_BACKGROUND_COLOR][0]){var x=a[ID_PROP_NODE_BACKGROUND_COLOR][1];forEach(b.rows,function(a,b){g_objPropertyUtil.removeStyleAttribute(b,"background")},
this);null==x||""==x?g_objPropertyUtil.removeStyleAttribute(b,"background-color"):b.style.backgroundColor=x}this.setSelectedCellAttribute_BackgroundImage(b,a[ID_PROP_NODE_BACKGROUND_IMAGE][0],a[ID_PROP_NODE_BACKGROUND_IMAGE][1],a[ID_PROP_NODE_BACKGROUND_IMAGE][2]);var r=a[ID_PROP_NODE_GENERAL][0],y=a[ID_PROP_NODE_GENERAL][1];r&&(f=r,"%"===y&&(f=g_objCommonUtil.convPercentToPx(b,r/100),f=parseFloat(f.toFixed(2))),g_objTableResize.setTableSize(b,f,0,!0),"%"===y&&g_objTableUtil.setNodeValue_Width(b,
r,y));g_objTableUtil.setTableCellPadding(b,a[ID_PROP_NODE_GENERAL][2]);g_objTableUtil.setTableCellSpacing(b,a[ID_PROP_NODE_GENERAL][8]);g_objTableUtil.setTableBorderCollapse(b,a[ID_PROP_NODE_GENERAL][9]);var A=a[ID_PROP_NODE_GENERAL][3];r=!1;""==A&&(r=!0);g_objTableUtil.setAlignTableByStyleProperty(b,A,r,a[ID_PROP_NODE_GENERAL][4],a[ID_PROP_NODE_GENERAL][5],a[ID_PROP_NODE_GENERAL][6],a[ID_PROP_NODE_GENERAL][7]);if(!0===dzeUiConfig.bUseReportForm){var E=a[ID_PROP_NODE_GENERAL][11];b.setAttribute("id",
a[ID_PROP_NODE_GENERAL][10]);b.setAttribute("mapping_key",E)}a[ID_PROP_NODE_STYLE]&&g_objTableOperation.table_SetTableStyle(b,a[ID_PROP_NODE_STYLE]);g_objTableUtil.setID(b,a[ID_PROP_NODE_GENERAL][10]);g_objTableUtil.setClass(b,a[ID_PROP_NODE_GENERAL][11]);b.setAttribute("mapping_key",a[ID_PROP_NODE_GENERAL][12])}}catch(G){dalert(G)}};this.setLockEditCell=function(a,c){try{if(!fnObjectCheckNull(a)){var b=!1;g_objTableSelection.doAllSelectedCell(function(a){"false"!==a.getAttribute("contenteditable")&&
(a.setAttribute("contenteditable",!1),b=!0)}.bind(this),a);return b}}catch(d){dalert(d)}};this.removeLockEditCell=function(a,c){try{if(!fnObjectCheckNull(a)){var b=!1;g_objTableSelection.doAllSelectedCell(function(a){"false"===a.getAttribute("contenteditable")&&(a.removeAttribute("contenteditable"),b=!0)}.bind(this),a);return b}}catch(d){dalert(d)}};this.getLockedCells=function(a){try{if(fnObjectCheckNull(a))return!1;for(var c=a.rows.length,b,d,e=[],g=0;g<c;g++){b=g_objTableUtil.getTableCellsLength(a,
g);for(var f=0;f<b;f++)d=g_objTableUtil.getTableCellElement(a,g,f),"false"===d.getAttribute("contenteditable")&&e.push(d)}return e}catch(l){dalert(l)}};this.hasLockedEditCell=function(a,c){try{if(fnObjectCheckNull(a))return!1;var b=!1;if(c)try{this.doAllCell(function(a){if("false"==a.getAttribute("contenteditable"))throw b=!0,BreakException;}.bind(this),a)}catch(d){return b}else try{this.doAllSelectedCell(function(a){if("false"==a.getAttribute("contenteditable"))throw b=!0,BreakException;}.bind(this),
a)}catch(d){return b}return!1}catch(d){dalert(d)}};this.isCellLocked=function(a){try{if(!1===dzeUiConfig.bUseLockEditCellFunction||fnObjectCheckNull(a))return!1;var c=g_objNodeUtil.getElementTagName(a).toLowerCase();return"td"!==c&&"th"!==c||"false"!==a.getAttribute("contenteditable")?!1:!0}catch(b){dalert(b)}};this.isNeighborCellLocked=function(a,c){try{if(!a||"TD"!==a.nodeName&&"TH"!==a.nodeName)return!1;var b=g_objNodeUtil.getLoopParentElement(a,"table"),d=g_objNodeUtil.getParentElement(a).rowIndex,
e=this.getFindCell(b,d,a.cellIndex,c);if(e){var g=g_objTableUtil.getTableCellElement(b,e.nextRow,e.nextCol);if(this.isCellLocked(g))return!0}return!1}catch(f){dalert(f)}};this.canTableResize=function(a){try{return a&&"TABLE"===a.nodeName&&"n"===a.getAttribute(DZE_CUSTOM_ATT_TABLE_RESIZE)?!1:!0}catch(c){return dalert(c),!0}};this.isIncludedProtectedCellInColumn=function(){try{var a=g_objTableFunction.getCurrentCell(g_nActiveEditNumber);if(null===a||null===a.table)return!1;for(var c=a.table.rows,b,
d=0;d<c.length;d++)if(b=c[d].cells[a.col],null!==b&&!0===this.isCellLocked(b))return!0;return!1}catch(e){dalert(e)}};this.isIncludedProtectedCellInRow=function(){try{var a=g_objTableFunction.getCurrentCell(g_nActiveEditNumber);if(null===a||null===a.table)return!1;var c=a.table.rows[a.row].cells;for(a=0;a<c.length;a++){var b=c[a];if(null!==b&&!0===this.isCellLocked(b))return!0}return!1}catch(d){dalert(d)}};this.setLockEditTable=function(a){try{return"false"===a.getAttribute("contenteditable")?a.removeAttribute("contenteditable"):
a.setAttribute("contenteditable",!1),!0}catch(c){dalert(c)}};this.isEditableTable=function(a,c){try{!0===fnObjectCheckNull(c)&&(c=!0);var b=a.getAttribute("contenteditable"),d=!0===fnObjectCheckNull(b)||"true"===b;!0===d&&!0===c&&(a=g_objNodeUtil.getLoopParentElement(a.parentNode,"table"),null!==a&&(d=this.isEditableTable(a,c)));return d}catch(e){dalert(e)}};this.IsEditContainerLoopParentElement=function(a){try{if(null==a)return!1;var c=g_strEditContainerName+"_"+g_nActiveEditNumber;if(a.id==c)return!0;
for(;;){var b=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(b))break;if("body"==g_objNodeUtil.getElementTagName(b).toLowerCase())break;if(b.id==c)return!0;a=b;if(fnObjectCheckNull(a))break}}catch(d){dalert(d)}return!1};this.moveFocusNextCell=function(a,c){try{if(!a)return!1;var b=a.keyCode,d=a.shiftKey&&!a.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL);a=!0;var e=ID_KEYCODE_TAB===b;if(!(ID_KEYCODE_ARROW_LEFT===b||d&&e))if(ID_KEYCODE_ARROW_RIGHT===b||!d&&e)a=!1;else return!1;
var g=GetCurTableInfo(c),f=g?g.cell:null,l=g?g.table:null;if(!f)return!1;var h=g_objTableSelection;if(d&&!e&&!h.isCellSelected(f))return h.selectCell(f,2),this.setCellSelectionRange(c,f,a),!0;var k=this.getFindNextCell(f,!a);if(!k){if(d&&!e)return!1;if(!g_bBrowserType_IE&&l&&ID_KEYCODE_ARROW_LEFT===b&&!d&&!e){var m=l.ownerDocument;win=m.defaultView;sel=win.getSelection();range=m.createRange();range.setStartBefore(l);range.setEndBefore(l);sel.removeAllRanges();sel.addRange(range);return!0}return this.setFocusSiblingNode(g.table,
a,c)}if(d&&!e){if(f===k)return h.deselectAllCell(g.table);var n=h.selectCellRange(f,k);n&&this.setCellSelectionRange(c,f,a);return n}return this.setFocusNextCell(k,a)}catch(p){dalert(p)}return!1};this.moveFocusUpDownCell=function(a,c){try{if(!a)return!1;var b=a.keyCode,d=a.shiftKey&&!a.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL);a=!0;if(ID_KEYCODE_ARROW_BOTTOM===b)a=!1;else if(ID_KEYCODE_ARROW_TOP!==b&&ID_KEYCODE_BACKSPACE!==b)return!1;var e=GetCurTableInfo(c),g=e?e.cell:null;if(!g)return!1;
b=g_objTableSelection;var f=this.getFindUpDownCell(g,a);if(!f)return d?!1:this.setFocusSiblingNode(e.table,a,c);if(d){if(g===f)return b.deselectAllCell(e.table);var l=b.selectCellRange(g,f);l&&this.setCellSelectionRange(c,g,a);return l}return this.setFocusNextCell(f,a)}catch(h){dalert(h)}return!1};this.moveFocusCell=function(a,c){try{var b=a.keyCode;a=!0;if(ID_KEYCODE_ARROW_BOTTOM==b||ID_KEYCODE_ARROW_RIGHT==b||ID_KEYCODE_TAB==b)a=!0;else if(ID_KEYCODE_ARROW_TOP==b||ID_KEYCODE_ARROW_LEFT==b)a=!1;
else return!1;var d=this.getCurrentCell(c);if(null==d)return!1;var e=d.table,g={nextRow:d.row,nextCol:d.col};for(d=null;;){g=this.getFindCell(e,g.nextRow,g.nextCol,b);if(null==g){d=null;break}d=g_objTableUtil.getTableCellElement(e,g.nextRow,g.nextCol);break}return null==d?this.setFocusSiblingNode(e,!a,c):this.setFocusNextCell(d,!a)}catch(f){dalert(f)}};this.setCellSelectionRange=function(a,c,b){try{var d=GetCurRange(a);if(d.collapsed)if(b){if(d.startContainer!==c||0!==d.startOffset)d.setStart(c,0),
SetCurRange(d)}else if(d.endContainer!==c||d.endOffset!==c.childNodes.length)d.setEnd(c,c.childNodes.length),SetCurRange(d);return!0}catch(e){dalert(e)}finally{}};this.getCurrentCell=function(a){try{var c=null,b=null,d=-1,e=-1;if(window.attachEvent){var g=g_objEditorDocument[a].selection;if(null==g)return null;var f=g.createRange();if(null==f)return null;var l=f.parentElement();b=(b=g_objNodeUtil.getLoopParentElement(l,"td"))||g_objNodeUtil.getLoopParentElement(l,"th");if(fnObjectCheckNull(b)||this.IsEditContainerLoopParentElement(b))return null;
var h=g_objNodeUtil.getLoopParentElement(b,"tr")}else{g=g_objEditWindow[a].getSelection();if(null==g||1!=g.rangeCount)return null;f=g.getRangeAt(0);l=f.commonAncestorContainer;b=(b=g_objNodeUtil.getLoopParentElement(l,"td"))||g_objNodeUtil.getLoopParentElement(l,"th");if(fnObjectCheckNull(b)||this.IsEditContainerLoopParentElement(b))return null;h=g_objNodeUtil.getLoopParentElement(b,"tr")}if(fnObjectCheckNull(h))return null;c=g_objNodeUtil.getLoopParentElement(h,"table");if(fnObjectCheckNull(c))return null;
d=h.rowIndex;e=b.cellIndex;return{table:c,cell:b,row:d,col:e}}catch(k){dalert(k)}return null};this.getFindNextCell=function(a,c){try{if(!a)return null;var b=g_objNodeUtil,d=b.getLoopParentElement(a,"tr"),e=b.getLoopParentElement(d,"table");if(!e)return null;var g=g_objTableUtil.getSplitTables(e);if(!g)return null;var f=g.indexOf(e);if(0>f)return null;var l=d.rowIndex,h=a.cellIndex;b=a=null;if(!1===c){h--;c=!0;for(var k=f;0<=k;k--){a=g[k].rows;c||(l=a.length-1);for(var m=l;0<=m;m--){b=a[m].cells;c||
(h=b.length-1);c=!1;for(var n=h;0<=n;n--)if(b[n])return b[n]}}}else for(h++,k=f;k<g.length;k++){a=g[k].rows;for(m=l;m<a.length;m++){b=a[m].cells;for(n=h;n<b.length;n++)if(b[n])return b[n];h=0}l=0}return null}catch(p){dalert(p)}return{nextRow:0,nextCol:0}};this.getFindUpDownCell=function(a,c){try{if(!a)return null;var b=g_objNodeUtil.getLoopParentElement(a,"table");if(!b)return null;var d=new TableMatrix(b);if(!d)return null;var e=d.getMatrixIndex(a);return!e||0>=e.length?null:d.getCell(c?e[0].row-
1:e[e.length-1].row+1,e[0].col)}catch(g){dalert(g)}return null};this.getFindCell=function(a,c,b,d){a=g_objTableUtil.getTableCellElement(a,c,b);if(!a)return null;switch(d){case ID_KEYCODE_ARROW_LEFT:return this.getFindNextCell(a,!1);case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_TAB:return this.getFindNextCell(a,!0);case ID_KEYCODE_ARROW_TOP:return this.getFindUpDownCell(a,!0);case ID_KEYCODE_ARROW_BOTTOM:return this.getFindUpDownCell(a,!1)}return null};this.setFocusNextCell=function(a,c){try{return g_objCaretUtil.moveCaret(a,
!0,c?!1:!0)}catch(b){dalert(b)}};this.setFocusSiblingNode=function(a,c,b){try{if(!a)return!1;var d=getCaretNodeWalker(a);if(!d||!d.currentNode())return!1;var e=c?d.getPrevNodeOutside(a):d.getNextNodeOutside(a);e&&this.setFocusNextCell(e,c);return!0}catch(g){dalert(g)}};this.getTableSelectedCellHTML=function(a,c){try{if(!a)return null;var b={arrHTML:[]};g_objTableSelection.doAllSelectedCell(function(a){!1===c?b.arrHTML.push(a.innerHTML):b.arrHTML.push(a.outerHTML)},a);a=g_nActiveEditNumber;b.selection=
g_objUndoRedo.getUndoRedoSelection(a);b.selectedCellCount=GetSelectedCellCount(a);b.bOuterHTML=c;return b}catch(d){dalert(d)}return null};this.setTableSelectedCellHTML=function(a,c){try{if(!a||!c)return!1;var b=c.arrHTML;if(!b||0==b.length)return!1;var d=c.bOuterHTML,e=0;g_objTableSelection.doAllSelectedCell(function(a){b[e]&&(!1===d?a.innerHTML=b[e++]:a.outerHTML=b[e++])},a);a=g_nActiveEditNumber;g_objUndoRedo.restoreSelection(c.selection,a);g_objUndoRedo.restoreCellSelection(a,c.selectedCellCount);
return!0}catch(g){dalert(g)}};this.getTableSelectedHTML=function(a){try{if(!a)return null;var c={arrHTML:[]},b=g_objTableUtil.getSplitTables(a);a=0;for(var d=b.length;a<d;a++)c.arrHTML.push(b[a].innerHTML);b=g_nActiveEditNumber;c.selection=g_objUndoRedo.getUndoRedoSelection(b);c.selectedCellCount=GetSelectedCellCount(b);return c}catch(e){dalert(e)}};this.setTableSelectedHTML=function(a,c){try{if(!a||!c)return!1;var b=c.arrHTML;if(!b||0==b.length)return!1;var d=g_objTableUtil.getSplitTables(a);a=0;
for(var e=d.length;a<e;a++)d[a]&&b[a]&&(d[a].innerHTML=b[a]);b=g_nActiveEditNumber;g_objUndoRedo.restoreSelection(c.selection,b);g_objUndoRedo.restoreCellSelection(b,c.selectedCellCount);return!0}catch(g){dalert(g)}}};

var g_objTableResize=new function(){var t=this;this.objVGuideline=this.objHGuideline=this.objResizeLine=this.objResizeLineLayer=this.objResizeTableLayer=null;this.nResizeStart_Y=this.nResizeStart_X=0;this.bPercentTable=!1;this.ptDiff=this.rcFrame=this.orgRect=null;this.nMinHeight=this.nMinWidth=10;this.bFromOffsetHeight=this.bFromOffsetWidth=this.bResizeMouseMove=!1;this.objResizeCell=this.objResizeTable=this.mouseDownTimeStamp=null;this.nCellIndex=this.nRowIndex=-1;this.objTableEnterLine=null;this.bTableEnterLine=
!1;this.ID_TABLE_LINE_NOTHING=0;this.ID_TABLE_LINE_TOP=1;this.matrix=null;this.bResizeLeft=this.bResizeTable=!1;this.func_onmouseup=this.func_onmousemove=null;this.initializeResizeLineLayer=function(){try{if(!this.objResizeLineLayer){var a='<div id="divResizeTable">';a+='<div id="divResizeLine" class="tbResizeLineContainer" style="display:none;">';dzeUiConfig.bCustomTableEnterLineYN&&(a+='<div id="divTableEnterLine" style="position:absolute;width:60px;height:12px;text-align:center;margin:0px;padding:0px;display:none;">',
a+='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_table_enter.png" alt="" border="0" />',a+="</div>");a+="</div>";a+='<div id="divResizeHGuideline" class="tbResizeHGuideline" style="display:none;"></div>';var c=g_objInsertUtil.insertLayerHTML(a+'<div id="divResizeVGuideline" class="tbResizeVGuideline" style="display:none;"></div></div>',!1);if(c){this.objResizeTableLayer=c;if(this.objResizeLineLayer=c.querySelector("#divResizeLine")){this.objResizeLineLayer.onmousedown=function(a){t.resize_onmousedown(a)};
a=0;for(var b=this.objResizeLineLayer.childNodes.length;a<b;a++){var e=this.objResizeLineLayer.childNodes[a];"tbResizeLine"===e.className&&(this.objResizeLine=e)}this.objResizeLineLayer.addEventListener("wheel",function(a){t.setTableMoveLine(!1,!1,0,0,0,0,0)},{passive:!0})}if(this.objTableEnterLine=c.querySelector("#divTableEnterLine"))this.objTableEnterLine.onclick=function(a){t.tableEnterLineClick(a,t.objResizeTable)};this.objHGuideline=c.querySelector("#divResizeHGuideline");this.objVGuideline=
c.querySelector("#divResizeVGuideline");g_objNodeUtil.initFalsePropagationEvent(this.objResizeLineLayer);g_objNodeUtil.initFalsePropagationEvent(this.objHGuideline);g_objNodeUtil.initFalsePropagationEvent(this.objVGuideline)}}}catch(d){dalert(d)}};this.unload=function(){try{var a=this.objResizeTableLayer;a&&a.parentNode&&a.parentNode.removeChild(a);this.objVGuideline=this.objHGuideline=this.objResizeLine=this.objResizeLineLayer=this.objResizeTableLayer=null}catch(c){dalert(c)}};this.getCurResizingObj=
function(){var a=g_nTableEventID;return ID_TABLE_EVENT_COL_RESIZE===a?this.objResizeCell:ID_TABLE_EVENT_ROW_RESIZE===a?this.objResizeCell:ID_TABLE_EVENT_TABLE_RESIZE===a?this.objResizeTable:null};this.tableEnterLineClick=function(a,c){try{if(dzeUiConfig.bCustomTableEnterLineYN&&!fnObjectCheckNull(c)&&this.bTableEnterLine&&ID_TABLE_EVENT_NOTHING===g_nTableEventID){TBCancelBubbleEvent(a);var b=g_objNodeUtil.getParentElement(c),e=document.createElement("p");e.innerHTML=window.attachEvent?"&nbsp;":"<br />";
b.insertBefore(e,c);this.setTableMoveLine(!1,!1,0,0,0,0,0)}}catch(d){dalert(d)}};this.resize_onmousedown=function(a,c){try{if(g_bTableResizingYN){var b=g_nActiveEditNumber;if(-1!=b){var e=g_objWrapperOutlineResize.objExtSelectedInfo;if(!e||e.nObjType!==DZE_OBJ_TD){if(this.objTableEnterLine)return this.tableEnterLineClick(a,this.objResizeTable);c===ID_TABLE_EVENT_TABLE_RESIZE&&(g_nTableEventID=ID_TABLE_EVENT_TABLE_RESIZE,this.objResizeTable=g_objTableMiniMenu.objTableNode);if(this.objResizeTable&&
ID_TABLE_EVENT_NOTHING!==g_nTableEventID&&g_objTableFunction.canTableResize(this.objResizeTable)){TBCancelBubbleEvent(a);g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[b]=!0);c=g_objPositionUtil;var d=c.GetDocumentClientPos_XY(a);this.nResizeStart_X=d.nPos_X;this.nResizeStart_Y=d.nPos_Y;this.rcFrame=c.getElementPosition(g_objEditObject[b],!1);var f=this.getCurResizingObj();this.orgRect=c.getElementPosClientRect(f);c.moveRect(this.orgRect,this.rcFrame.left,this.rcFrame.top);this.ptDiff=this.bResizeLeft?
{x:this.orgRect.left-this.nResizeStart_X,y:this.orgRect.top-this.nResizeStart_Y}:{x:this.orgRect.right-this.nResizeStart_X,y:this.orgRect.bottom-this.nResizeStart_Y};this.prepareResize(this.objResizeTable,!1);this.removeMouseListener();this.addMouseListener();g_objTransparentViewUtil.showTransparentView(!0,0);g_objTableMiniMenu.showTableMiniMenu(!1);this.bResizeMouseMove=!1;this.mouseDownTimeStamp=a.timeStamp;if("undefined"!==typeof g_objShapeFunction&&null===g_objShapeEvtMgr.getShapeTextContainer())g_objShapeFunction.onDeselectAllShapes()}else this.objResizeTable=
null,g_nTableEventID=ID_TABLE_EVENT_NOTHING}}}}catch(h){dalert(h)}};this.resize_onmousemove=function(a){try{if(EventUtil.normalize(a),a.timeStamp<this.mouseDownTimeStamp+10||-1==g_nActiveEditNumber||!EventUtil.isLeftButtonPressed(a)||g_nTableEventID===ID_TABLE_EVENT_NOTHING)this.resize_onmouseup(a);else{var c=g_nTableEventID,b=c===ID_TABLE_EVENT_COL_RESIZE,e=c===ID_TABLE_EVENT_ROW_RESIZE;c=c===ID_TABLE_EVENT_TABLE_RESIZE;if(b||e||c){this.bResizeMouseMove=!0;this.setResizeTable(DZESHORTCUT.isPressedKeyMapForOS(a,
ID_KEYCODE_CTRL)?!0:!1);var d=g_objPositionUtil,f=d.GetDocumentClientPos_XY(a),h=f.nPos_X+this.ptDiff.x,g=f.nPos_Y+this.ptDiff.y,m=this.orgRect,k=this.getCurResizingObj(),l=d.getElementPosClientRect(k);d.moveRect(l,this.rcFrame.left,this.rcFrame.top);var n=this.bResizeLeft,p=f=a=0,q=0;if(b||c)a=n?this.bResizeTable?0:m.right-h:h-m.left,p=n?this.bResizeTable?h-l.left:l.width-a:a-l.width;if(e||c)f=n?0:g-m.top,q=n?g-l.top:f-l.height;p=Math.round(p);q=Math.round(q);if(0!==p||0!==q)if(b?this.doResizeCol(this.objResizeTable,
p,this.nRowIndex,this.nCellIndex):e?this.doResizeRow(this.objResizeTable,q,this.nRowIndex,this.nCellIndex):c&&this.doResizeTable(this.objResizeTable,p,q),b||e)l=d.getElementPosClientRect(k),d.moveRect(l,this.rcFrame.left,this.rcFrame.top),b?this.showVGuideline(!0,n?l.left:l.right):e&&this.showHGuideline(!0,n?l.top:l.bottom),this.moveResizeLineLayer(h,g)}}}catch(u){dalert(u),this.resize_onmouseup()}};this.resize_onmouseup=function(a){try{a=g_nActiveEditNumber;var c=this.objResizeTable;g_bBrowserType_IE&&
(g_arrForceCancelBubbleMouseDown[a]=!1);g_objTransparentViewUtil.showTransparentView(!1,null);var b=g_objPositionUtil,e=g_nTableEventID;if(e===ID_TABLE_EVENT_COL_RESIZE||e===ID_TABLE_EVENT_ROW_RESIZE){var d=this.getCurResizingObj(),f=b.getElementPosClientRect(d);b.moveRect(f,this.rcFrame.left,this.rcFrame.top);this.moveResizeLineLayer(this.bResizeLeft?f.left:f.right,this.bResizeLeft?f.top:f.bottom)}this.showHGuideline(!1);this.showVGuideline(!1);var h=c?b.getElementPosClientRect(c):null;b.moveRect(h,
this.rcFrame.left,this.rcFrame.top);g_nTableEventID!==ID_TABLE_EVENT_TABLE_RESIZE||!1!==this.bResizeMouseMove&&!b.equalRect(h,this.orgRect)?this.bResizeMouseMove&&(this.afterResize(),commonUpdateAfterChange(a,c,{bResetOutline:!1})):(g_objLayerEventUtil.initHideDynamicLayer(),g_objTableSelection.selectTable(a));g_objTableMiniMenu.delayUpdate()}catch(g){dalert(g)}finally{this.removeMouseListener()}};this.setTableMoveLine=function(a,c,b,e,d,f,h,g){try{if(g_bTableResizingYN&&this.objResizeLineLayer){this.bTableEnterLine=
!1;var m=this.objTableEnterLine,k=this.objResizeLineLayer.style;a?(k.display="",c?this.ID_TABLE_LINE_NOTHING==h?(m&&(m.style.display="none"),k.cursor="row-resize",k.left=b+"px",k.top=e-g/2-1+"px",k.width=d-b-4+"px",k.height=g+2+"px"):this.ID_TABLE_LINE_TOP==h&&m&&(this.bTableEnterLine=!0,m.style.display="",m.style.left=d-b-60+"px",k.cursor="pointer",k.left=b+"px",k.top=e-g/2-1+"px",k.width=d-b-4+"px",k.height=g+2+"px"):(k.cursor="col-resize",k.left=b-g/2-1+"px",k.top=e+"px",k.width=g+2+"px",k.height=
f-e-4+"px")):(k.display="none",m&&(m.style.display="none"))}}catch(l){dalert(l)}};this.moveResizeLineLayer=function(a,c){try{var b=this.objResizeLineLayer;if(b){var e=g_nTableEventID,d=b.style;ID_TABLE_EVENT_ROW_RESIZE===e?d.top=parseInt(c-parseInt(d.height,10)/2,10)+"px":ID_TABLE_EVENT_COL_RESIZE===e&&(d.left=parseInt(a-parseInt(d.width,10)/2,10)+"px")}}catch(f){dalert(f)}};this.checkResizeLineLayer=function(a,c){try{var b=null;if(g_bTableResizingYN&&-1!=g_nActiveEditNumber&&g_nActiveEditNumber==
c&&ID_STRING_NAME_CONTROL!=g_strSelectionType&&!EventUtil.isLeftButtonPressed(a)&&!g_bDynamicLayer){this.initializeResizeLineLayer();var e=a.target,d=getSelectedObjectType(e);if(d!==DZE_OBJ_SHAPE&&d!==DZE_OBJ_SHAPE_TEXT){d=g_objNodeUtil;var f=d.getLoopParentElementByTagNames(e,d.arrCellTagName),h=d.getLoopParentElement(f,"tr"),g=d.getLoopParentElement(h,"table");if(g&&g_objTableFunction.canTableResize(g))if(b=this.hitTest(f,h,g,a.clientX,a.clientY,c)){var m=b.nTableEventID,k=b.bResizeLeft,l=b.rcFrame,
n=b.pos,p=b.thick;this.objResizeTable=g;this.objResizeCell=f;this.nRowIndex=h.rowIndex;this.nCellIndex=f.cellIndex;this.bResizeLeft=k;g_nTableEventID=m;m===ID_TABLE_EVENT_COL_RESIZE?this.setTableMoveLine(!0,!1,n,l.top,n,l.bottom,0,2*p):b.nTableEventID===ID_TABLE_EVENT_ROW_RESIZE?this.setTableMoveLine(!0,!0,l.left,n,l.right,n,0,2*p):m===ID_TABLE_EVENT_TABLE_ENTERLINE&&(this.setTableMoveLine(!0,!0,l.left,n,l.right,n,1,2*p),g_nTableEventID=ID_TABLE_EVENT_NOTHING)}else this.objResizeCell=this.objResizeTable=
null,this.nCellIndex=this.nRowIndex=-1,this.bResizeLeft=this.bResizeTable=!1,g_nTableEventID=ID_TABLE_EVENT_NOTHING}}}catch(q){dalert(q)}finally{null===b&&this.objResizeLineLayer&&"none"!==this.objResizeLineLayer.style.display&&this.setTableMoveLine(!1,!1,0,0,0,0,0)}};this.hitTest=function(a,c,b,e,d,f){try{if(a&&c&&b){var h=g_objPropertyUtil;b=g_objPositionUtil;var g=b.getElementPosClientRect(a),m=1*parseFloat(h.getElement_BorderWidth_With_Unit(a,"left").nValue),k=1*parseFloat(h.getElement_BorderWidth_With_Unit(a,
"right").nValue),l=1*parseFloat(h.getElement_BorderWidth_With_Unit(a,"top").nValue),n=1*parseFloat(h.getElement_BorderWidth_With_Unit(a,"bottom").nValue);m=Math.max(m/2,3);k=Math.max(k/2,3);l=Math.max(n/2,3);n=Math.max(n/2,3);a=ID_TABLE_EVENT_ROW_RESIZE;h=ID_TABLE_EVENT_COL_RESIZE;var p=null,q=!1;Math.abs(g.right-e)<=k?p=h:Math.abs(g.left-e)<=m?(p=h,q=!0):Math.abs(g.bottom-d)<=n?p=a:0!==c.rowIndex&&Math.abs(g.top-d)<=l?(p=a,q=!0):this.objTableEnterLine&&0===objTr.rowIndex&&Math.abs(g.top-d)<l&&(p=
ID_TABLE_EVENT_TABLE_ENTERLINE);if(null===p)return null;e=c=0;var u=b.getElementPosition(g_objEditObject[f],!1);p===h?(c=u.left+(q?g.left:g.right),e=q?m:k):p===a?(c=u.top+(q?g.top:g.bottom),e=q?l:n):p===ID_TABLE_EVENT_TABLE_ENTERLINE&&(c=u.top+g.top,e=l);return{nTableEventID:p,bResizeLeft:q,rcFrame:u,pos:c,thick:e}}}catch(w){dalert(w)}};this.checkMinWidth=function(a,c,b){try{Array.isArray(a)||(a=[a]);for(var e=0,d=0;d<a.length;d++)e=a[d]+b,e<c&&(e=c,b=e-a[d]);return b}catch(f){dalert(f)}};this.setResizeTable=
function(a){this.bResizeTable=a?!0:!1};this.prepareResize=function(a,c){try{if(!a||!a.ownerDocument)return!1;var b=g_objTableUtil;this.objResizeTable=a;this.bFromOffsetHeight=this.bFromOffsetWidth=!0;this.bPercentTable=b.isPercentTable(a);this.setResizeTable(c);this.matrix=g_objTableUtil.getMatrix(a);g_objNodeUtil.getLoopParentByClassName(a,"area_sign")||b.removeHeightAttr(this.matrix.tables);b.addColgroup(a,this.matrix);b.setDzeTable(a,this.matrix);b.resetTableCellPixelSize(a,this.matrix,b.RESET_WIDTH)}catch(e){dalert(e)}};
this.afterResize=function(){try{this.bPercentTable&&(this.bPercentTable=!1,g_objTableUtil.setPercentTable(this.matrix.tables))}catch(a){dalert(a)}};this.setTableSize=function(a,c,b,e){try{if(a){this.prepareResize(a,!0);var d=g_objNodeUtil,f=this.matrix,h=c-a.offsetWidth,g=b-a.offsetHeight,m=0,k=0,l=0,n=1;if(0<c)for(m=parseInt(h/f.colLength),k=parseInt(h-m*f.colLength),l=0,n=0<h?1:-1,c=0;c<f.colLength;c++)l=0,f.colLength-c<=Math.abs(k)&&(k+=-1*n,l=n),this.doResizeColFromMatrixIndex(a,m+l,0,c);if(0<
b)for(m=parseInt(g/f.trs.length),l=parseInt(g-m*f.trs.length),n=0<g?1:-1,b=0;b<f.rowLength;b++){var p=this.matrix.getCell(b,0);a=d.getLoopParentElement(p,"table");l=0;f.rowLength-b<=Math.abs(l)&&(k+=-1*n,l=n);this.doResizeRowFromMatrixIndex(a,m+l,b,0)}!0===e?this.objResizeTable=this.matrix=null:this.afterResize()}}catch(q){dalert(q)}};this.setColWidth=function(a,c,b){try{if(!a||0>c)return!1;var e=g_objTableUtil,d=g_objNodeUtil,f=a.calculateColWidth();if(c>=f.length)return!1;b=Math.max(b,this.nMinWidth);
a.arrColWidth[c]=b;f[c]=b;for(var h=a.arraySum(f),g=0;g<a.rowLength;g++)if(!a.isHideForRowspan(g,c)){var m=a.getCell(g,c),k=a.getColRange(g,c),l=e.offsetWidthToStyleWidth(a.arraySum(f,k.start,k.end),m);e.setNodeValue_Width(m,l,"px")}for(f=0;f<a.colgroups.length;f++){var n=d.getImmediateChildNodesByTagName(a.colgroups[f],"col");e.setNodeValue_Width(n[c],b,"px")}e.setTableWidth(a.tables,h);return!0}catch(p){dalert(p)}};this.setRowHeight=function(a,c,b){try{if(!a||0>c)return!1;var e=g_objTableUtil,d=
a.calculateRowHeight();if(c>=d.length)return!1;b=Math.max(b,this.nMinHeight);a.arrRowHeight[c]=b;d[c]=b;for(var f=0;f<a.colLength;f++)if(!a.isHideForColspan(c,f)){var h=a.getCell(c,f),g=a.getRowRange(c,f),m=e.offsetHeightToStyleHeight(a.arraySum(d,g.start,g.end),h);e.setNodeValue_Height(h,m,"px")}e.setNodeValue_Height(a.trs[c],b,"px");return!0}catch(k){dalert(k)}};this.doResizeTable=function(a,c,b){try{if(!c&&!b||!a||!this.matrix)return!1;var e=g_objNodeUtil,d=this.matrix,f=this.bResizeTable;this.bResizeTable=
!0;if(0!=c){var h=c/d.colLength;for(c=0;c<d.colLength;c++)this.doResizeColFromMatrixIndex(a,h,0,c)}if(0!=b){var g=b/a.rows.length;for(a=0;a<d.rowLength;a++){var m=this.matrix.getCell(a,0),k=e.getLoopParentElement(m,"table");this.doResizeRowFromMatrixIndex(k,g,a,0)}}this.bResizeTable=f}catch(l){dalert(l)}};this.doResizeRowFromCell=function(a,c){try{if(!a||!c||!this.matrix)return!1;var b=g_objNodeUtil.getLoopParentElement(a,"table"),e=g_objNodeUtil.getLoopParentElement(a,"tr");return b&&e?this.doResizeRow(b,
c,e.rowIndex,a.cellIndex):!1}catch(d){dalert(d)}};this.doResizeRow=function(a,c,b,e){try{if(!c||!this.matrix)return!1;var d=g_objTableUtil.getTableCellElement(a,b,e);if(!d)return!1;var f=this.matrix.getMatrixIndex(d);if(!f)return!1;b=this.bResizeLeft&&g_nTableEventID===ID_TABLE_EVENT_ROW_RESIZE?f[0].row-1:f[f.length-1].row;e=f[f.length-1].col;return 0>b?!1:this.doResizeRowFromMatrixIndex(a,c,b,e)}catch(h){dalert(h)}};this.doResizeRowFromMatrixIndex=function(a,c,b,e){try{if(!c||!this.matrix)return!1;
var d=this.getHeight.bind(this),f=g_objTableUtil.setNodeValue_Height.bind(g_objTableUtil),h=this.matrix;a=b;var g=h.trs[a];b=null;var m=d(g);e=[];if(0>c)for(;0===this.checkMinWidth(m,this.nMinHeight,c)&&0<=a-1&&h.isBlankRow(a);)--a,g=h.trs[a],m=d(g);c=this.checkMinWidth(m,this.nMinHeight,c);if(0==c)return!1;for(var k=0;k<h.colLength;k++)h.isHideForColspan(a,k)||(b=h.getCell(a,k),e[k]=d(b));for(k=0;k<h.colLength;k++)h.isHideForColspan(a,k)||(b=h.getCell(a,k),f(b,e[k]+c,"px"));f(g,m+c,"px");this.bFromOffsetHeight=
!1;return!0}catch(l){dalert(l)}};this.doResizeColFromCell=function(a,c){try{if(!a||!c||!this.matrix)return!1;var b=g_objNodeUtil.getLoopParentElement(a,"table"),e=g_objNodeUtil.getLoopParentElement(a,"tr");return b&&e?this.doResizeCol(b,c,e.rowIndex,a.cellIndex):!1}catch(d){dalert(d)}};this.doResizeCol=function(a,c,b,e){try{if(!c||!this.matrix)return!1;var d=g_objTableUtil.getTableCellElement(a,b,e);if(!d)return!1;var f=this.matrix.getMatrixIndex(d);if(!f)return!1;this.bResizeLeft&&g_nTableEventID===
ID_TABLE_EVENT_COL_RESIZE?(b=f[f.length-1].row,e=f[0].col-1):(b=f[f.length-1].row,e=f[f.length-1].col);return this.doResizeColFromMatrixIndex(a,c,b,e)}catch(h){dalert(h)}};this.doResizeColFromMatrixIndex=function(a,c,b,e){try{if(!c||!this.matrix)return!1;var d=this.getWidth.bind(this),f=g_objTableUtil.setNodeValue_Width.bind(g_objTableUtil),h=g_objNodeUtil.getImmediateChildNodesByTagName.bind(g_objNodeUtil),g=this.matrix,m=h(a,"colgroup")[0],k=h(m,"col");m=b=null;var l=Math.max(e,0),n=e+1,p=0,q=0,
u=0,w=[],t=[],y=n===g.colLength;if((e=-1===e)||y||this.bResizeTable){e&&(c*=-1);p=d(a);q=d(k[l]);if(0<c)for(;0===this.checkMinWidth(q,this.nMinWidth,c)&&l+1<g.colLength&&g.isBlankCol(l+1);)l+=1,q=d(k[l]);else for(;0===this.checkMinWidth(q,this.nMinWidth,c)&&0<=l-1&&g.isBlankCol(l);)--l,q=d(k[l]);c=this.checkMinWidth(q,this.nMinWidth,c);if(0==c)return!1;for(var r=0;r<g.rowLength;r++)g.isHideForRowspan(r,l)||(b=g.getCell(r,l),w[r]=d(b));for(r=0;r<g.rowLength;r++)g.isHideForRowspan(r,l)||(b=g.getCell(r,
l),f(b,w[r]+c,"px"));for(var v=0;v<g.colgroups.length;v++)k=h(g.colgroups[v],"col"),f(k[l],q+c,"px");for(v=0;v<g.tables.length;v++)f(g.tables[v],p+c,"px")}else{q=d(k[l]);u=d(k[n]);if(0<c)for(;0===this.checkMinWidth(u,this.nMinWidth,-1*c)&&n+1<g.colLength&&g.isBlankCol(n+1);)n+=1,u=d(k[n]);else for(;0===this.checkMinWidth(q,this.nMinWidth,c)&&0<=l-1&&g.isBlankCol(l);)--l,q=d(k[l]);c=this.checkMinWidth(q,this.nMinWidth,c);c=-1*this.checkMinWidth(u,this.nMinWidth,-1*c);if(0==c)return!1;for(r=0;r<g.rowLength;r++)g.equalCell(r,
l,r,n)||(g.isHideForRowspan(r,l)||(b=g.getCell(r,l),w[r]=d(b)),g.isHideForRowspan(r,n)||(m=g.getCell(r,n),t[r]=d(m)));for(r=0;r<g.rowLength;r++)g.equalCell(r,l,r,n)||(g.isHideForRowspan(r,l)||(b=g.getCell(r,l),f(b,w[r]+c,"px")),g.isHideForRowspan(r,n)||(m=g.getCell(r,n),f(m,t[r]-c,"px")));for(v=0;v<g.colgroups.length;v++)k=h(g.colgroups[v],"col"),f(k[l],q+c,"px"),f(k[n],u-c,"px")}this.bFromOffsetWidth=!1;return!0}catch(z){dalert(z)}};this.getCellWidth=function(a){try{if(!a)return 0;var c=a.offsetWidth;
return 0==c?g_objPropertyUtil.getStyleWidth(a):g_objTableUtil.offsetWidthToStyleWidth(c,a)}catch(b){dalert(b)}};this.getCellHeight=function(a){try{if(!a)return 0;var c=a.offsetHeight;return 0==c?g_objPropertyUtil.getStyleHeight(a):g_objTableUtil.offsetHeightToStyleHeight(c,a)}catch(b){dalert(b)}};this.getColWidth=function(a){try{if(!a)return 0;var c=g_objNodeUtil,b=c.getLoopParentElement(a,"colgroup");if(!b)return 0;var e=this.objResizeTable||c.getLoopParentElement(b,"table");if(!e)return 0;var d=
this.matrix||g_objTableUtil.getMatrix(e);if(!d)return 0;b=0;for(e=a;e;)c.checkTagName(e.previousSibling,"col")&&b++,e=e.previousSibling;for(e=c=0;e<d.rowLength;e++){var f=d.getCell(e,b);if(1==d.getColspan(f)&&(c=f.offsetWidth))return c}var h=g_objPropertyUtil.getStyleWidth(a);return 0<=h?h:d.calculateColWidth()[b]}catch(g){dalert(g)}};this.getWidth=function(a,c){try{if(!a)return 0;if(!c&&!this.bFromOffsetWidth){var b=g_objPropertyUtil.getStyleWidth(a);if(0<=b)return b}switch(a.nodeName){case "TD":case "TH":return this.getCellWidth(a);
case "COL":return this.getColWidth(a)}return a.offsetWidth}catch(e){dalert(e)}};this.getHeight=function(a,c){try{if(!a)return 0;if(!c&&!this.bFromOffsetHeight){var b=g_objPropertyUtil.getStyleHeight(a);if(0<=b)return b}switch(a.nodeName){case "TD":case "TH":return this.getCellHeight(a)}return a.offsetHeight}catch(e){dalert(e)}};this.showHGuideline=function(a,c){try{if(!this.objHGuideline)return!1;a?(this.objHGuideline.style.display="",this.objHGuideline.style.top=c+"px"):this.objHGuideline.style.display=
"none";return!0}catch(b){dalert(b)}};this.showVGuideline=function(a,c){try{if(!this.objVGuideline)return!1;a?(this.objVGuideline.style.display="",this.objVGuideline.style.left=c+"px"):this.objVGuideline.style.display="none";return!0}catch(b){dalert(b)}};this.addMouseListener=function(){try{this.func_onmousemove=function(a){throttle(t,t.resize_onmousemove,a)},this.func_onmouseup=function(a){throttle(t,t.resize_onmouseup,a)},window.attachEvent?(document.attachEvent("onmousemove",this.func_onmousemove),
document.attachEvent("onmouseup",this.func_onmouseup)):(document.addEventListener("mousemove",this.func_onmousemove,!1),document.addEventListener("mouseup",this.func_onmouseup,!1))}catch(a){dalert(a)}};this.removeMouseListener=function(){try{this.func_onmousemove&&this.func_onmouseup&&(window.attachEvent?(document.detachEvent("onmousemove",this.func_onmousemove),document.detachEvent("onmouseup",this.func_onmouseup)):(document.removeEventListener("mousemove",this.func_onmousemove,!1),document.removeEventListener("mouseup",
this.func_onmouseup,!1)),clearTimeout(this.func_onmousemove.tId),clearTimeout(this.func_onmouseup.tId),this.func_onmouseup=this.func_onmousemove=null)}catch(a){dalert(a)}};this.applyTableResizeKeyAction=function(a,c){try{var b=GetCurTableInfo(c);if(!b)return!1;var e=b.table,d=e.ownerDocument,f=!0,h=0;b=!(g_nTableEventID===ID_TABLE_EVENT_ROW_RESIZE||g_nTableEventID===ID_TABLE_EVENT_COL_RESIZE);if(ID_KEYCODE_ARROW_TOP==a.keyCode)h=a.shiftKey?-1:-5,g_nTableEventID=ID_TABLE_EVENT_ROW_RESIZE;else if(ID_KEYCODE_ARROW_BOTTOM==
a.keyCode)h=a.shiftKey?1:5,g_nTableEventID=ID_TABLE_EVENT_ROW_RESIZE;else if(ID_KEYCODE_ARROW_RIGHT==a.keyCode)h=a.shiftKey?1:5,f=!1,g_nTableEventID=ID_TABLE_EVENT_COL_RESIZE;else if(ID_KEYCODE_ARROW_LEFT==a.keyCode)h=a.shiftKey?-1:-5,f=!1,g_nTableEventID=ID_TABLE_EVENT_COL_RESIZE;else return!1;if(!g_objTableFunction.canTableResize(e))return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!0;var g=DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)?!0:!1;this.setResizeTable(g);if(b||null===this.matrix||this.matrix.tables&&
0>this.matrix.tables.indexOf(e)){this.prepareResize(e,g);var m=function(a){if(g_nTableEventID===ID_TABLE_EVENT_ROW_RESIZE||g_nTableEventID===ID_TABLE_EVENT_COL_RESIZE)g_nTableEventID=ID_TABLE_EVENT_NOTHING;this.afterResize();commonUpdateAfterChange(c,e);EventUtil.removeHandler(d,"keyup",m)}.bind(this);EventUtil.addHandler(d,"keyup",m)}g_objTableMiniMenu.showTableMiniMenu(!1,null,c);if(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&!a.altKey){var k=this.matrix,l=f?k.calculateRowHeight():k.calculateColWidth(),
n=[];g_objTableSelection.doAllSelectedCell(function(a){if(a=k.getMatrixIndex(a)){var b=a.length;1>b||(a=f?a[b-1].row:a[b-1].col,!isNaN(a)&&0>n.indexOf(a)&&n.push(a))}},e);n.sort();n.forEach(function(a){f?this.setRowHeight(k,a,l[a]+h):this.setColWidth(k,a,l[a]+h)}.bind(this))}else if(!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&a.altKey){var p=null,q=null;g_objTableSelection.doAllSelectedCell(function(a,b,c,d,e,f){p=a;q=f},e);if(!p)return!1;var u=p.offsetHeight;a=u;f?this.doResizeRow(q,h,
p.parentNode.rowIndex,p.cellIndex):this.doResizeCol(q,h,p.parentNode.rowIndex,p.cellIndex);a=p.offsetHeight;if(u!=a&&f){k=this.matrix;var t=k.getMatrixIndex(p),x=k.getCell(t[t.length-1].row+1,t[0].col),y=g_objNodeUtil.getLoopParentElement(x,"table");x&&this.doResizeRow(y,-1*h,x.parentNode.rowIndex,x.cellIndex)}}else return!1;return!0}catch(r){return dalert(r),!0}};this.resetTableCellPixelWidth=function(a){try{for(var c=[],b=0;b<a.rows.length;b++){c[b]=[];for(var e=g_objTableUtil.getTableCellsLength(a,
b),d=0;d<e;d++){var f=g_objTableUtil.getTableCellElement(a,b,d);c[b][d]=parseInt(f.offsetWidth)}}for(b=0;b<a.rows.length;b++)for(e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++)null!=c[b][d]&&(f=g_objTableUtil.getTableCellElement(a,b,d),g_objTableUtil.setNodeValue_Width(f,c[b][d],"px"));var h=[];for(b=0;b<a.rows.length;b++)for(h[b]=[],e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++)f=g_objTableUtil.getTableCellElement(a,b,d),h[b][d]=f.offsetWidth;for(b=0;b<a.rows.length;b++)for(e=g_objTableUtil.getTableCellsLength(a,
b),d=0;d<e;d++)if(c[b][d]<h[b][d]){var g=c[b][d]+c[b][d]-h[b][d]-1;f=g_objTableUtil.getTableCellElement(a,b,d);g_objTableUtil.setNodeValue_Width(f,g,"px")}else c[b][d]>h[b][d]&&(g=c[b][d]+c[b][d]-h[b][d]+1,f=g_objTableUtil.getTableCellElement(a,b,d),g_objTableUtil.setNodeValue_Width(f,g,"px"));for(b=0;b<a.rows.length;b++)for(e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++)f=g_objTableUtil.getTableCellElement(a,b,d),c[b][d]=parseInt(f.offsetWidth);return c}catch(m){dalert(m)}return null}};

var g_objTableMiniMenu=new function(){var f=this;this.objRowgroupControl=this.objResizeControl=this.objCommandControl=this.objTableMiniMenuLayer=null;this.bShow=!1;this.nEditNumber=0;this.rcTable=this.rcArea=this.objTableNode=null;this.arrTableRect=[];this.wheelEndTimer=this.timeoutID=null;this.strRowgroupBtnDiv="";this.initializeTableMiniMenuLayer=function(){try{if(!this.objTableMiniMenuLayer){var a='<div id="divTableMiniMenuLayer">';a+='<div id="divTableMiniMenu" class="tbResizeLineContainer" style="display:none;background-color:#FFFFFF;cursor:pointer;z-index:20008;">';
a+='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/minibar_btn_plus.gif" alt="" style="width:14px;height:14px;border:1px solid #7F7F7F;" />';a+="</div>";a+='<div id="divResizeCtrl" class="tbResizeControl" style="display:none;"></div>';a+='<div id="divRowgroupCtrl" style="position:absolute; width:60px; z-index:20007; display:none;">';a+="";var b=g_objInsertUtil.insertLayerHTML(a+"</div></div>",!1);if(b){this.objTableMiniMenuLayer=b;this.objCommandControl=b.querySelector("#divTableMiniMenu");this.objCommandControl.onmousedown=
function(a){TBCancelBubbleEvent(a)};this.objCommandControl.onclick=function(a){!1===g_objTableFunction.isEditableTable(f.objTableNode)&&!0===g_objTableFunction.isEditableTable(f.objTableNode,!1)?TBCancelBubbleEvent(a):f.tableMiniMenuClick(a,f.objTableNode)};if(this.objResizeControl=b.querySelector("#divResizeCtrl"))this.objResizeControl.onmousedown=function(a){g_objTableResize.resize_onmousedown(a,ID_TABLE_EVENT_TABLE_RESIZE);TBCancelBubbleEvent(a)};this.objRowgroupControl=b.querySelector("#divRowgroupCtrl");
g_objNodeUtil.initFalsePropagationEvent(this.objCommandControl);g_objNodeUtil.initFalsePropagationEvent(this.objResizeControl);g_objNodeUtil.initFalsePropagationEvent(this.objRowgroupControl)}}}catch(c){dalert(c)}};this.unload=function(){try{var a=this.objTableMiniMenuLayer;a&&a.parentNode&&a.parentNode.removeChild(a);this.objRowgroupControl=this.objResizeControl=this.objCommandControl=this.objTableMiniMenuLayer=null}catch(b){dalert(b)}};this.isShow=function(){return this.bShow};this.onWheel=this.onZoom=
this.onResize=function(a){try{if(!this.isShow())return!1;"undefined"==typeof a&&(a=g_nActiveEditNumber);this.showTableMiniMenu(!1,null,a);clearTimeout(this.wheelEndTimer);this.wheelEndTimer=setTimeout(function(){this.update(a)}.bind(this),120)}catch(b){dalert(b)}};this.update=function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);var b=GetCurTable(a);this.showTableMiniMenu(b?!0:!1,b,a)}catch(c){dalert(c)}};this.delayUpdate=function(a,b){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),b=
isNaN(b)?10:b,clearTimeout(this.timeoutID),this.timeoutID=setTimeout(function(){g_objTableMiniMenu.update(a)},b)}catch(c){dalert(c)}};this.showTableMiniMenu=function(a,b,c){try{if(dzeUiConfig.bUseTableMiniMenu){null!=b&&null!=b.className&&0<=b.className.indexOf("dze_tb_layout")&&(a=!1);var d=g_objWrapperOutlineResize.objExtSelectedInfo;d&&d.objElement&&"TABLE"===d.objElement.nodeName&&(a=!1);b&&b.parentNode||(b=null,a=!1);a&&!this.objTableMiniMenuLayer&&this.initializeTableMiniMenuLayer();this.bShow=
a;this.nEditNumber=c;this.objTableNode=b;var e=g_objPositionUtil;a&&(this.rcArea=e.getElementPosition(g_objEditObject[this.nEditNumber],!1),this.rcTable=null,this.arrTableRect=[],g_objTableUtil.getSplitTables(this.objTableNode).forEach(function(a){var b=e.getElementPosClientRect(a);b=e.moveRect(b,this.rcArea.left,this.rcArea.top);this.arrTableRect.push(b);a==this.objTableNode&&(this.rcTable=b)}.bind(this)),e.isEmptyRect(this.rcTable)&&(this.bShow=a=!1,this.objTableNode=b=null));this.showCommandMenu(this.bShow);
this.showResizeControl(this.bShow,g_objTableFunction.canTableResize(this.objTableNode))}}catch(g){dalert(g)}};this.showCommandMenu=function(a){try{var b=this.objCommandControl;if(b)if(a){var c=parseFloat(b.firstChild.style.height),d=this.arrTableRect[0].top-c/2;b.style.left=parseInt(this.arrTableRect[0].left-0,10)+"px";b.style.top=parseInt(d,10)+"px";b.style.display=""}else b.style.display="none"}catch(e){dalert(e)}};this.showResizeControl=function(a,b){try{var c=this.objResizeControl;if(c)if(a){var d=
this.arrTableRect[this.arrTableRect.length-1].bottom-3.5;c.style.left=parseInt(this.arrTableRect[this.arrTableRect.length-1].right-7-1,10)+"px";c.style.top=parseInt(d,10)+"px";c.style.display="";c.style.cursor=b?"":"not-allowed"}else c.style.display="none"}catch(e){dalert(e)}};this.tableMiniMenuClick=function(a,b){try{if(!fnObjectCheckNull(b)){g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);this.objCommandControl.setAttribute("pressed","");var c={nContextMenuType:g_objContextMenuWin.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU,
strSelectedTagName:""},d=b.getBoundingClientRect(),e=g_objPositionUtil.getOuterRect(g_objEditObject[g_nActiveEditNumber]),f=g_objPositionUtil.getFrameClientRect();g_objContextMenuWin.showContextMenuLayer(c,f.left+d.left+14+1,f.top+e.top+d.top-7,g_nActiveEditNumber);g_objContextMenuWin.setHideCallback(function(){this.objCommandControl&&this.objCommandControl.removeAttribute("pressed")}.bind(this))}}catch(h){dalert(h)}}};

var letterSpacingWin=function(){var f=this;this.objLetterSpacingLayer=null;this.bLetterSpacingDisplay=!1;this.arrLetterSpacing=" 1pt 2pt 4pt 6pt 8pt 10pt".split(" ");letterSpacingWin.prototype.initializeLetterSpacingLayer=function(){try{if(null==this.objLetterSpacingLayer){"undefined"!=typeof dzeUiConfig.arrCustomLetterSpacing&&0<dzeUiConfig.arrCustomLetterSpacing.length&&(this.arrLetterSpacing=dzeUiConfig.arrCustomLetterSpacing);var a='<div id="divLetterSpacingSelWin" style="position:absolute; display:none; z-index:20031">';
a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;">';for(var c=0;c<this.arrLetterSpacing.length;c++)a+='<tr><td style="line-height:normal;padding:0">',a+='<table id="ComboBoxItem_LetterSpacing_Sub_'+c+'" cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',
a=0==c?a+('<td style="line-height:normal;text-align:left;padding-left:10px"><span>'+ID_RES_COMBOBOX_REMOVE_LETTER_SPACING+"</span></td>"):a+('<td style="line-height:normal;text-align:left;padding-left:10px"><span>'+this.arrLetterSpacing[c]+"</span></td>"),a+="</tr></table>",a+="</td></tr>";a+="</table>";a+="</td></tr></table>";a+="</div>";var b=g_objLayerKit.getElementById("divLetterSpacingSelWin");b||(b=g_objInsertUtil.insertLayerHTML(a,!0));b&&(this.objLetterSpacingLayer=b,this.initLetterSpacingSubItem("ComboBoxItem_LetterSpacing"),
g_objNodeUtil.initFalsePropagationEvent(this.objLetterSpacingLayer))}}catch(d){dalert(d)}};letterSpacingWin.prototype.initLetterSpacingSubItem=function(a){try{for(var c=0;c<this.arrLetterSpacing.length;c++){var b=g_objLayerKit.getElementById(a+"_Sub_"+c);b.onmouseout=function(a){f.fnLetterSpacingCellOut(this)};b.onmousedown=TBCancelBubbleEvent;b.onmouseup=TBCancelBubbleEvent;(function(){var a=f.arrLetterSpacing[c];b.onclick=function(){!0===dzeUiConfig.bTBPreviewLetterOperation&&(f.objLetterSpacingLayer.onmouseleave=
function(){});f.fnLetterSpacingCellClick(a)};b.onmouseover=function(b){f.fnLetterSpacingCellOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&f.fnLetterSpacingCellClick(a,!1)}})()}}catch(d){dalert(d)}return null};letterSpacingWin.prototype.unload=function(){try{var a=g_objLayerKit.getElementById("divLetterSpacingSelWin");a&&a.parentNode&&a.parentNode.removeChild(a);this.objLetterSpacingLayer=null}catch(c){dalert(c)}};letterSpacingWin.prototype.initLetterSpacingLayerEvent=function(){try{null!=
this.objLetterSpacingLayer&&this.bLetterSpacingDisplay&&(this.objLetterSpacingLayer.style.display="none",this.bLetterSpacingDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objLetterSpacingLayer=null)}catch(a){dalert(a)}};letterSpacingWin.prototype.showLetterSpacingLayer=function(a,c,b){try{if(dlog("showLetterSpacingLayer"),this.initializeLetterSpacingLayer(),!fnObjectCheckNull(a)&&null!=this.objLetterSpacingLayer)if(g_nActiveEditNumber=b,this.bLetterSpacingDisplay)g_objLayerEventUtil.initHideDynamicLayer();
else{this.bLetterSpacingDisplay=!0;g_objLayerEventUtil.showLayerWin(this.objLetterSpacingLayer,a,c,dzeUiConfig.bTBPreviewLetterOperation);var d=g_objPropertyUtil.getSelectionAttributeValue(b);if("undefined"!=typeof d&&null!=d){var e=d[4];if("undefined"==typeof e||null==e)e="";var f=updateHandlerUI.getMappingIndex_LetterSpacing(e);for(a=0;a<g_objLetterSpacingWin.arrLetterSpacing.length;a++)a==f?g_objLayerKit.getElementById("ComboBoxItem_LetterSpacing_Sub_"+a).className=g_strSkin_ComboBoxItem_Down:
g_objLayerKit.getElementById("ComboBoxItem_LetterSpacing_Sub_"+a).className=g_strSkin_ComboBoxItem_Out;if(!0===dzeUiConfig.bTBPreviewLetterOperation){var h=GetCurTable(b);h?g_objLayerEventUtil.saveTableSelectedCellHTML(h):g_objUndoRedo.registerUndoRedoStack(0,b);this.objLetterSpacingLayer.onmouseleave=function(){var a=GetCurTable(b);a?g_objLayerEventUtil.restoreTableSelectedCellHTML(a):(g_objUndoRedo.registerUndoRedoStack(0,b),g_objUndoRedo.operateUndoRedoStack(!0,!0,b))}}}}}catch(g){dalert(g)}};
letterSpacingWin.prototype.fnLetterSpacingCellOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(c){dalert(c)}};letterSpacingWin.prototype.fnLetterSpacingCellOut=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(c){dalert(c)}};letterSpacingWin.prototype.fnLetterSpacingCellClick=function(a,c){try{var b=!0;"undefined"!=typeof c&&(b=c);if(GetMultiCellSelection())g_objTableMultiCell.setMultiCellCommand_LetterOperation(ID_LETTER_OPERATION_LETTER_SPACING,
a,g_nActiveEditNumber);else if(window.attachEvent){var d=g_objEditorDocument[g_nActiveEditNumber].selection;if(fnObjectCheckNull(d))return;var e=d.type;e=e.toLowerCase();if(ID_STRING_NAME_NONE==e||ID_STRING_NAME_TEXT==e){var f=d.createRange();if(fnObjectCheckNull(f))return;g_objLetterFn.setLetterOperation(ID_LETTER_OPERATION_LETTER_SPACING,a,f,g_nActiveEditNumber,!0)}}else if(e=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==e||ID_STRING_NAME_TEXT==e){d=g_objEditWindow[g_nActiveEditNumber].getSelection();
var h=d.getRangeAt(0);g_objLetterFn.setLetterOperation(ID_LETTER_OPERATION_LETTER_SPACING,a,h,g_nActiveEditNumber,!0)}GetMultiCellSelection()?setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox("",g_nActiveEditNumber)}catch(g){}},10):setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(e,g_nActiveEditNumber)}catch(g){}},10);0!=b&&g_objLayerEventUtil.initHideDynamicLayer();tranAllAnchorHrefSharp(g_nActiveEditNumber);0!=b&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}catch(g){dalert(g)}}},
g_objLetterSpacingWin=new letterSpacingWin;

var lineHeightWin=function(){var d=this;this.objLineHeightLayer=null;this.bLineHeightDisplay=!1;this.arrLineHeight=" 1 1.2 1.5 1.8 2 2.5 3".split(" ");lineHeightWin.prototype.initializeLineHeightLayer=function(){try{if(null==this.objLineHeightLayer){"undefined"!=typeof dzeUiConfig.arrCustomLineHeight&&0<dzeUiConfig.arrCustomLineHeight.length&&(this.arrLineHeight=dzeUiConfig.arrCustomLineHeight);var a='<div id="divLineHeightSelWin" style="position:absolute; display:none; z-index:20031">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+
g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;">';for(var b=0;b<this.arrLineHeight.length;b++)a+='<tr><td style="line-height:normal;padding:0;">',a+='<table id="ComboBoxItem_LineHeight_Sub_'+b+'" cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',a=0==b?a+('<td style="line-height:normal;text-align:left;cursor:default;padding-left:10px"><span>'+
ID_RES_COMBOBOX_REMOVE_LINE_HEIGHT+"</span></td>"):a+('<td style="line-height:normal;text-align:left;cursor:default;padding-left:10px"><span>'+100*parseFloat(this.arrLineHeight[b],10)+" %</span></td>"),a+="</tr></table>",a+="</td></tr>";a+="</table>";a+="</td></tr></table>";a+="</div>";var c=g_objLayerKit.getElementById("divLineHeightSelWin");c||(c=g_objInsertUtil.insertLayerHTML(a,!0));c&&(this.objLineHeightLayer=c,this.initLineHeightSubItem("ComboBoxItem_LineHeight"),g_objNodeUtil.initFalsePropagationEvent(this.objLineHeightLayer))}}catch(e){dalert(e)}};
lineHeightWin.prototype.initLineHeightSubItem=function(a){try{for(var b=0;b<this.arrLineHeight.length;b++){var c=g_objLayerKit.getElementById(a+"_Sub_"+b);c.onmouseout=function(a){d.fnLineHeightCellOut(this)};c.onmousedown=TBCancelBubbleEvent;c.onmouseup=TBCancelBubbleEvent;(function(){var a=d.arrLineHeight[b];c.onclick=function(){!0===dzeUiConfig.bTBPreviewLetterOperation&&(d.objLineHeightLayer.onmouseleave=function(){});d.fnLineHeightCellClick(a)};c.onmouseover=function(b){d.fnLineHeightCellOver(this);
!0===dzeUiConfig.bTBPreviewLetterOperation&&d.fnLineHeightCellClick(a,!1)}})()}}catch(e){dalert(e)}return null};lineHeightWin.prototype.unload=function(){try{var a=g_objLayerKit.getElementById("divLineHeightSelWin");a&&a.parentNode&&a.parentNode.removeChild(a);this.objLineHeightLayer=null}catch(b){dalert(b)}};lineHeightWin.prototype.initLineHeightLayerEvent=function(){try{null!=this.objLineHeightLayer&&this.bLineHeightDisplay&&(this.objLineHeightLayer.style.display="none",this.bLineHeightDisplay=
!1,g_objLayerEventUtil.removeLayerEvent(),this.objLineHeightLayer=null)}catch(a){dalert(a)}};lineHeightWin.prototype.showLineHeightLayer=function(a,b,c){try{if(this.initializeLineHeightLayer(),!fnObjectCheckNull(a)&&null!=this.objLineHeightLayer)if(g_nActiveEditNumber=c,this.bLineHeightDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{this.bLineHeightDisplay=!0;g_objLayerEventUtil.showLayerWin(this.objLineHeightLayer,a,b,dzeUiConfig.bTBPreviewLetterOperation);var e=g_objPropertyUtil.getSelectionAttributeValue(c);
if("undefined"!=typeof e&&null!=e){var d=e[5];if("undefined"==typeof d||null==d)d="";var g=updateHandlerUI.getMappingIndex_LineHeight(d);for(a=0;a<g_objLineHeightWin.arrLineHeight.length;a++)a==g?g_objLayerKit.getElementById("ComboBoxItem_LineHeight_Sub_"+a).className=g_strSkin_ComboBoxItem_Down:g_objLayerKit.getElementById("ComboBoxItem_LineHeight_Sub_"+a).className=g_strSkin_ComboBoxItem_Out;if(!0===dzeUiConfig.bTBPreviewLetterOperation){var f=GetCurTable(c);f?g_objLayerEventUtil.saveTableSelectedCellHTML(f):
g_objUndoRedo.registerUndoRedoStack(0,c);this.objLineHeightLayer.onmouseleave=function(){var a=GetCurTable(c);a?g_objLayerEventUtil.restoreTableSelectedCellHTML(a):(g_objUndoRedo.registerUndoRedoStack(0,c),g_objUndoRedo.operateUndoRedoStack(!0,!0,c))}}}}}catch(h){dalert(h)}};lineHeightWin.prototype.fnLineHeightCellOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(b){dalert(b)}};lineHeightWin.prototype.fnLineHeightCellOut=function(a){try{a.className!=
g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(b){dalert(b)}};lineHeightWin.prototype.fnLineHeightCellClick=function(a,b){try{var c=!0;"undefined"!=typeof b&&(c=b);b=g_nActiveEditNumber;g_objLetterFn.setParaStyle(b,{lineHeight:a});0!=c&&g_objLayerEventUtil.initHideDynamicLayer();tranAllAnchorHrefSharp(b);0!=c&&(g_objUndoRedo.registerUndoRedoStack(0,b),editor_onselectionchange(b))}catch(e){dalert(e)}}},g_objLineHeightWin=new lineHeightWin;

var ID_TABLE_INSERT_CELL_WIDTH=100,ID_TABLE_INSERT_CELL_HEIGHT=20,g_objTableSizeBoxWin=new function(){var k=this;this.nTBLimitSizeBox_Col=this.nTBLimitSizeBox_Row=this.nTBMinSizeBox_Col=this.nTBMinSizeBox_Row=15;this.nTBSizeCell_Height=this.nTBSizeCell_Width=18;this.nTBChangePos_Y=this.nTBChangePos_X=this.nTBLimitPos_Y=this.nTBLimitPos_X=this.nTBMinPos_Y=this.nTBMinPos_X=this.nTBMenuPos_Y=this.nTBMenuPos_X=0;this.objTBSizeBox={};this.objTBSizeBox.objBackWin=null;this.objTBSizeBox.objBG=null;this.objTBSizeBox.objWindow=
null;this.objTBSizeBox.objStatus=null;this.bTBSizeBoxCancel=this.bTBSizeBoxDisplay=!1;this.nTBStatusSpan_Col=this.nTBStatusSpan_Row=-1;this.initializeTableSizeBoxLayer=function(){try{if(null==this.objTBSizeBox.objBackWin){var e=this.drawTableSize(this.nTBLimitSizeBox_Row,this.nTBLimitSizeBox_Col,this.nTBMinSizeBox_Row,this.nTBMinSizeBox_Col),b=g_objLayerKit.getElementById("TB_Size_Box");b||(b=g_objInsertUtil.insertLayerHTML(e,!0));if(b){var a=this.objTBSizeBox;a.objParent=b;a.objBackWin=b.querySelector("#TB_Size_Box_Back_Win");
a.objBG=b.querySelector("#TB_Size_Box_BG");a.objWindow=b.querySelector("#TB_Size_Box_Window");a.objStatus=b.querySelector("#TB_Size_Box_Status");a.objStatus.objStatusText=g_objLayerKit.getElementById("TB_Size_Box_Status_Text");a.objBackWin.style.display="none";a.objBG.style.display="none";a.objWindow.style.display="none";a.objStatus.style.display="none";this.initTableSizeBoxSubItem();g_objNodeUtil.initFalsePropagationEvent(a.objBackWin);g_objNodeUtil.initFalsePropagationEvent(a.objBG);g_objNodeUtil.initFalsePropagationEvent(a.objWindow);
g_objNodeUtil.initFalsePropagationEvent(a.objStatus)}}}catch(c){dalert(c)}};this.unload=function(){try{if(this.objTBSizeBox){var e=this.objTBSizeBox.objParent;e&&e.parentNode&&e.parentNode.removeChild(e)}this.objTBSizeBox={}}catch(b){dalert(b)}};this.drawTableSize=function(e,b,a,c){try{var d="<div id='TB_Size_Box'>";d+="<div id='TB_Size_Box_Back_Win' class='"+g_strSkin_SizeBoxBackWin+"'>";d+="<div id='TB_Size_Box_BG' class='"+g_strSkin_SizeBoxBG+"'></div>";d+="</div>";d+="<div id='TB_Size_Box_Window' class='tbSizeBoxWindow'>";
d+="<table cellSpacing='0' cellPadding='0' border='0' style='width:270px;'>";for(var f=0;f<e;f++){d+="<tr>";d+="<td style='text-align:left;'>";d+="<table cellSpacing='0' cellPadding='0' border='0' style='width:270px;height:18px;table-layout:auto;'>";d+="<tr>";for(var h=0;h<b;h++)d=f<a&&h<c?g_bDocType_XHTML?d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0' style='border-collapse:separate;'><tr><td></td></tr></table></td>"):d+("<td><table id='tbSizeBoxCell_"+
f+"_"+h+"' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0' style='border-collapse:separate;'><tr><td><img alt='' width='1' height='1' border='0' style='vertical-align:baseline;border:none;'></td></tr></table></td>"):g_bDocType_XHTML?d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' style='display:none;border-collapse:separate;' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0'><tr><td></td></tr></table></td>"):d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' style='display:none;border-collapse:separate;' class='"+
g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0'><tr><td><img alt='' width='1' height='1' border='0' style='vertical-align:baseline;border:none;'></td></tr></table></td>");d+="</tr>";d+="</table>";d+="</td>";d+="</tr>"}d+="</table>";d+="</div>";d+="<div id='TB_Size_Box_Status' class='"+g_strSkin_SizeBoxStatus+"'>";d+="<table cellSpacing='0' cellPadding='0' style='margin-top:3' align='center' border='0'>";d+="<tr>";d+="<td align='center' class='"+g_strSkin_SizeBoxStatusText+"' style='line-height:normal;'><span id='TB_Size_Box_Status_Text'>";
d+="<span style='display:none'>"+ID_RES_TABLE_SIZE_SELECT+"</span>";for(f=0;f<e;f++)d+="<span style='display:none'>"+(f+1)+"</span>";d+="<span style='display:none'> X </span>";for(h=0;h<b;h++)d+="<span style='display:none'>"+(h+1)+"</span>";d+="<span style='display:none'>"+ID_RES_TABLE_SIZE_CANCEL+"</span>";d+="</span></td>";d+="</tr>";d+="</table>";return d+"</div></div>"}catch(g){}};this.initTableSizeBoxSubItem=function(){try{for(var e=0;e<this.nTBLimitSizeBox_Row;e++)for(var b=0;b<this.nTBLimitSizeBox_Col;b++){var a=
g_objLayerKit.getElementById("tbSizeBoxCell_"+e+"_"+b);(function(){var c=e,d=b;a.onmouseover=function(){k.changeBGSizeBox(c,d)}})();a.onmousedown=TBCancelBubbleEvent;a.onmouseup=TBCancelBubbleEvent;(function(){var c=e,d=b;a.onclick=function(){k.createNewTable(c,d)}})()}}catch(c){}};this.changeBGSizeBox=function(e,b){try{g_objTableSizeBoxWin.objTBSizeBox.objBG.style.width=(b+1)*g_objTableSizeBoxWin.nTBSizeCell_Width+"px",g_objTableSizeBoxWin.objTBSizeBox.objBG.style.height=(e+1)*g_objTableSizeBoxWin.nTBSizeCell_Height+
"px",g_objTableSizeBoxWin.setTableSizeBoxStatus(e+1,b+1,!1)}catch(a){}};this.resizeTableSizeBox=function(e){try{var b=g_objPositionUtil.GetDocumentClientPos_XY(e),a=b.nPos_X,c=b.nPos_Y,d=g_objPositionUtil.getFrameClientRect();a+=d.left;c+=d.top;var f=k.objTBSizeBox.objBackWin,h=f.offsetWidth,g=f.offsetHeight;null!=f&&g_objTableSizeBoxWin.bTBSizeBoxDisplay?f.offsetLeft<a&&f.offsetTop<c&&a<f.offsetLeft+h&&c<f.offsetTop+g?(k.bTBSizeBoxCancel=!1,k.nTBMinPos_X-k.nTBSizeCell_Width<a&&a<k.nTBLimitPos_X&&
k.changeTBSizeBox_X(a),k.nTBMinPos_Y-k.nTBSizeCell_Height<c&&c<k.nTBLimitPos_Y&&k.changeTBSizeBox_Y(c)):k.bTBSizeBoxCancel||(k.setTableSizeBoxStatus(-1,-1,!0),k.bTBSizeBoxCancel=!0):k.bTBSizeBoxCancel||(k.setTableSizeBoxStatus(-1,-1,!0),k.bTBSizeBoxCancel=!0)}catch(l){dalert(l)}};this.setTableSizeBoxStatus=function(e,b,a){try{var c=g_objNodeUtil.getChildrenCollection(this.objTBSizeBox.objStatus.objStatusText);-1!=this.nTBStatusSpan_Row&&(c[this.nTBStatusSpan_Row].style.display="none");-1!=this.nTBStatusSpan_Col&&
(c[this.nTBLimitSizeBox_Row+this.nTBStatusSpan_Col+1].style.display="none");this.nTBStatusSpan_Row=e;this.nTBStatusSpan_Col=b;-1==e&&-1==b?(a?(c[0].style.display="none",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.lineHeight="normal"):(c[0].style.display="",c[0].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="none"),c[this.nTBLimitSizeBox_Row+1].style.display="none"):
(c[0].style.display="none",c[e].style.display="",c[e].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+1].style.display="",c[this.nTBLimitSizeBox_Row+1].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+b+1].style.display="",c[this.nTBLimitSizeBox_Row+b+1].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="none")}catch(d){dalert(d)}};this.changeTBSizeBox_X=function(e){try{if(e<this.nTBChangePos_X){if(e<this.nTBChangePos_X-this.nTBSizeCell_Width){var b=
(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width;this.nTBChangePos_X=this.nTBMenuPos_X+(b-1)*this.nTBSizeCell_Width+6;this.objTBSizeBox.objBackWin.style.width=(b-1)*this.nTBSizeCell_Width+10+"px";this.objTBSizeBox.objBG.style.width=(b-1)*this.nTBSizeCell_Width+"px";this.objTBSizeBox.objStatus.style.width=(b-1)*this.nTBSizeCell_Width+10+"px";for(var a=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+c+"_"+(b-1)).style.display=
"none"}}else if(e>this.nTBChangePos_X)for(b=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,this.nTBChangePos_X=this.nTBMenuPos_X+(b+1)*this.nTBSizeCell_Width+6,this.objTBSizeBox.objBackWin.style.width=(b+1)*this.nTBSizeCell_Width+10+"px",this.objTBSizeBox.objBG.style.width=(b+1)*this.nTBSizeCell_Width+"px",this.objTBSizeBox.objStatus.style.width=(b+1)*this.nTBSizeCell_Width+10+"px",a=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+
c+"_"+b).style.display=""}catch(d){dalert(d)}};this.changeTBSizeBox_Y=function(e){try{if(e<this.nTBChangePos_Y){if(e<this.nTBChangePos_Y-this.nTBSizeCell_Height){var b=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height;this.nTBChangePos_Y=this.nTBMenuPos_Y+(b-1)*this.nTBSizeCell_Height+6;this.objTBSizeBox.objBackWin.style.height=(b-1)*this.nTBSizeCell_Height+10+"px";this.objTBSizeBox.objBG.style.height=(b-1)*this.nTBSizeCell_Height+"px";this.objTBSizeBox.objStatus.style.top=this.nTBMenuPos_Y+
(b-1)*this.nTBSizeCell_Height+6+4+"px";for(var a=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+(b-1)+"_"+c).style.display="none"}}else if(e>this.nTBChangePos_Y)for(b=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,this.nTBChangePos_Y=this.nTBMenuPos_Y+(b+1)*this.nTBSizeCell_Height+6,this.objTBSizeBox.objBackWin.style.height=(b+1)*this.nTBSizeCell_Height+10+"px",this.objTBSizeBox.objBG.style.height=(b+1)*this.nTBSizeCell_Height+
"px",this.objTBSizeBox.objStatus.style.top=this.nTBMenuPos_Y+(b+1)*this.nTBSizeCell_Height+6+4+"px",a=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+b+"_"+c).style.display=""}catch(d){dalert(d)}};this.initTableSizeLayerEvent=function(){try{if(null!=this.objTBSizeBox&&null!=this.objTBSizeBox.objBackWin){var e=this.objTBSizeBox;this.bTBSizeBoxDisplay&&(e.objBackWin.style.display="none",e.objBG.style.display="none",e.objWindow.style.display=
"none",e.objStatus.style.display="none",this.bTBSizeBoxDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objTBSizeBox.objBackWin=null,this.objTBSizeBox.objBG=null,this.objTBSizeBox.objWindow=null,this.objTBSizeBox.objStatus=null)}}catch(b){dalert(b)}};this.showTableSizeBoxLayer=function(e,b){try{if(this.initializeTableSizeBoxLayer(),!fnObjectCheckNull(e)&&null!=this.objTBSizeBox.objBackWin){g_nActiveEditNumber=b;for(b=0;b<this.nTBLimitSizeBox_Row;b++)for(var a=0;a<this.nTBLimitSizeBox_Col;a++)b<
this.nTBMinSizeBox_Row&&a<this.nTBMinSizeBox_Col||(g_objLayerKit.getElementById("tbSizeBoxCell_"+b+"_"+a).style.display="none");this.setTableSizeBoxStatus(-1,-1,!1);var c=g_objPositionUtil.getOuterRect(e),d=g_objPositionUtil.getFrameClientRect(),f=d.left+c.left,h=d.top+c.top+c.height;g_bBrowserType_FF?(f=f-g_nFireFoxLayerSetting_X+1,h=h-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(f+=2,h+=2):g_bBrowserType_OP?(f+=1,h+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(f+=2,h+=2);if(this.bTBSizeBoxDisplay)g_objLayerEventUtil.initHideDynamicLayer();
else{this.nTBMenuPos_X=f-2+g_nIframeBorderSetting;this.nTBMenuPos_Y=h-3+g_nIframeBorderSetting;var g=this.objTBSizeBox;g.objBackWin.style.left=this.nTBMenuPos_X+"px";g.objBackWin.style.top=this.nTBMenuPos_Y+"px";g.objBackWin.style.width=this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+10+"px";g.objBackWin.style.height=this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+10+"px";g.objBackWin.style.display="";g.objWindow.style.left=this.nTBMenuPos_X+6+"px";g.objWindow.style.top=this.nTBMenuPos_Y+6+"px";g.objWindow.style.display=
"";g.objBG.style.width=0;g.objBG.style.height=0;g.objBG.style.display="";g.objStatus.style.left=this.nTBMenuPos_X+"px";g.objStatus.style.top=this.nTBMenuPos_Y+this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+6+4+"px";g.objStatus.style.width=this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+10+"px";g.objStatus.style.display="";this.nTBMinPos_X=this.nTBMenuPos_X+this.nTBMinSizeBox_Row*this.nTBSizeCell_Width+6;this.nTBMinPos_Y=this.nTBMenuPos_Y+this.nTBMinSizeBox_Col*this.nTBSizeCell_Height+6;this.nTBLimitPos_X=
this.nTBMenuPos_X+this.nTBLimitSizeBox_Col*this.nTBSizeCell_Width+6;this.nTBLimitPos_Y=this.nTBMenuPos_Y+this.nTBLimitSizeBox_Row*this.nTBSizeCell_Height+6;this.nTBChangePos_X=this.nTBMenuPos_X+this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+6;this.nTBChangePos_Y=this.nTBMenuPos_Y+this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+6;this.bTBSizeBoxDisplay=!0;g_objLayerEventUtil.objCurrentLayer=g.objBackWin;duzon_dialog.animateDlg(g.objBackWin,"down");duzon_dialog.animateDlg(g.objWindow,"down");duzon_dialog.animateDlg(g.objBG,
"down");duzon_dialog.animateDlg(g.objStatus,"down");detachMouseEvent();g_objLayerEventUtil.addLayerEvent()}}}catch(l){dalert(l)}};this.createNewTable=function(e,b){try{var a=[];a[0]=e+1;a[1]=b+1;a[2]=100;a[3]="%";a[4]=null;a[5]=null;a[6]=1;a[7]="1px solid #000000";a[8]="1px solid #000000";a[9]="1px solid #000000";a[10]="1px solid #000000";a[11]="1px solid #000000";a[12]="1px solid #000000";a[13]=null;a[14]=null;a[15]=null;a[16]="";a[17]=null;a[18]=null;a[19]=null;a[20]=null;a[21]=null;a[22]=0;a[23]=
!0;e=g_nActiveEditNumber;var c=g_objTableFunction.createTable(a,e);c&&(g_objCaretUtil.moveCaret(c),commonUpdateAfterChange(e,c));g_objLayerEventUtil.initHideDynamicLayer()}catch(d){dalert(d)}}};

var g_objMenuWin=new function(){this.arrTBMenu=[];this.ID_MENU_ITEM_SEGMENT=6;this.bMenuLayerShow=this.bMenuDisplayToggle=!1;this.arrMenuMember=[];this.arrMenuMember.push([ID_COMMAND_FILE_NEW,ID_COMMAND_FILE_OPEN,-1,ID_COMMAND_FILE_DOCFORM,ID_COMMAND_FILE_LAYOUT,-1,ID_COMMAND_SAVEAS,-1,ID_COMMAND_PRINT]);this.arrMenuMember.push([ID_COMMAND_UNDO,ID_COMMAND_REDO,-1,ID_COMMAND_CUT,ID_COMMAND_COPY,ID_COMMAND_PASTE,ID_COMMAND_EDIT_PASTESPECIAL,ID_COMMAND_DELETE,-1,ID_COMMAND_SELECT_ALL,-1,ID_COMMAND_EDIT_SEARCH,
ID_COMMAND_EDIT_REPLACE,ID_COMMAND_EDIT_REPLACE_CASE]);this.arrMenuMember.push([ID_COMMAND_VIEW_EDIT,ID_COMMAND_VIEW_HTML,ID_COMMAND_PREVIEW]);this.arrMenuMember.push([ID_COMMAND_INSERT_IMAGE,ID_COMMAND_INSERT_OBJECT,-1,ID_COMMAND_INSERT_SPECIALCHARS,-1,ID_COMMAND_INSERT_BOOKMARK,ID_COMMAND_HYPERLINK_INSERT,ID_COMMAND_INIT_CURSOR,ID_COMMAND_INSERT_PARAGRAPH]);this.arrMenuMember.push([ID_COMMAND_STYLE_FONT,ID_COMMAND_STYLE_PARAGRAPH,-1,ID_COMMAND_STYLE_STYLE,-1,ID_COMMAND_STYLE_UNORDEREDLIST,ID_COMMAND_STYLE_ORDEREDLIST,
-1,ID_COMMAND_STYLE_INCREASEORDER,ID_COMMAND_STYLE_DECREASEORDER]);this.arrMenuMember.push([ID_COMMAND_TABLE_CREATE,-1,ID_COMMAND_TABLE_PROPERTY,ID_COMMAND_TABLE_CELL_PROPERTY,ID_COMMAND_TABLE_CELL_STYLE,ID_COMMAND_LOCK_EDIT_CELL,-1,ID_COMMAND_TABLE_ADD_ROW_COL,ID_COMMAND_TABLE_DELETE_ROW,ID_COMMAND_TABLE_DELETE_COL,-1,ID_COMMAND_TABLE_MERGE_CELL,ID_COMMAND_TABLE_SPLIT_CELL,-1,ID_COMMAND_TABLE_CELL_SAME_HEIGHT,ID_COMMAND_TABLE_CELL_SAME_WIDTH,-1,ID_COMMAND_TABLE_CELL_ALIGN,-1,ID_COMMAND_TABLE_CONVERT_TEXT,
ID_COMMAND_TABLE_FORMULA,ID_COMMAND_TABLE_SELECT_FORMULA]);this.arrMenuMember.push([ID_COMMAND_HELP_SHORTCUTS,ID_COMMAND_HELP,ID_COMMAND_HELP_IMAGE_TO_TABLE,ID_COMMAND_HELP_INFO]);this.twoDepthMenu=[];this.twoDepthMenu[ID_COMMAND_INSERT_OBJECT]=[ID_COMMAND_INSERT_OBJECT_MOVIE,ID_COMMAND_INSERT_OBJECT_FILE,ID_COMMAND_INSERT_OBJECT_HR];this.twoDepthMenu[ID_COMMAND_INSERT_PARAGRAPH]=[ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT];this.twoDepthMenu[ID_COMMAND_STYLE_STYLE]=
[ID_COMMAND_STYLE_STYLE_BASIC,ID_COMMAND_STYLE_STYLE_SUBJECT1,ID_COMMAND_STYLE_STYLE_SUBJECT2,ID_COMMAND_STYLE_STYLE_SUBJECT3,ID_COMMAND_STYLE_STYLE_SUBJECT4,ID_COMMAND_STYLE_STYLE_SUBJECT5];this.twoDepthMenu[ID_COMMAND_TABLE_CELL_ALIGN]=[ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM,
ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM];this.twoDepthMenu[ID_COMMAND_TABLE_FORMULA]=[ID_COMMAND_TABLE_HORIZONTAL_SUM,ID_COMMAND_TABLE_VERTICAL_SUM,ID_COMMAND_TABLE_HORIZONTAL_AVERAGE,ID_COMMAND_TABLE_VERTICAL_AVERAGE,ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY,ID_COMMAND_TABLE_VERTICAL_MULTIPLY];this.twoDepthMenu[ID_COMMAND_PASTE_CELL]=[ID_COMMAND_PASTE_CELL_OVER_CONTENT,ID_COMMAND_PASTE_CELL_OVER_ALL,ID_COMMAND_PASTE_CELL_INSERT,ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE];
this.twoDepthMenu[ID_COMMAND_TABLE_CELL_INSERT]=[ID_COMMAND_TABLE_ADD_COL,ID_COMMAND_TABLE_ADD_COL_RIGHT,ID_COMMAND_TABLE_ADD_ROW,ID_COMMAND_TABLE_ADD_ROW_DOWN];this.twoDepthMenu[ID_COMMAND_TABLE_CELL_DELETE]=[ID_COMMAND_TABLE_DELETE_COL,ID_COMMAND_TABLE_DELETE_ROW,ID_COMMAND_TABLE_DELETE_TABLE];this.twoDepthMenu[ID_COMMAND_JUSTIFY_TABLE]=[ID_COMMAND_JUSTIFY_LEFT,ID_COMMAND_JUSTIFY_CENTER,ID_COMMAND_JUSTIFY_RIGHT,ID_COMMAND_JUSTIFY_JUSTIFY];this.arrMenuLayer=[];this.objSubMenuItem=[];this.openMenuList=
[ID_COMMAND_FILE_OPEN,ID_COMMAND_FILE_DOCFORM,ID_COMMAND_FILE_LAYOUT,ID_COMMAND_SAVEAS,ID_COMMAND_PRINT,ID_COMMAND_EDIT_PASTESPECIAL,ID_COMMAND_EDIT_SEARCH,ID_COMMAND_EDIT_REPLACE,ID_COMMAND_EDIT_REPLACE_CASE,ID_COMMAND_INSERT_IMAGE,ID_COMMAND_INSERT_OBJECT_MOVIE,ID_COMMAND_INSERT_OBJECT_FILE,ID_COMMAND_INSERT_SPECIALCHARS,ID_COMMAND_INSERT_BOOKMARK,ID_COMMAND_HYPERLINK_INSERT,ID_COMMAND_STYLE_FONT,ID_COMMAND_STYLE_PARAGRAPH,ID_COMMAND_STYLE_UNORDEREDLIST,ID_COMMAND_STYLE_ORDEREDLIST,ID_COMMAND_TABLE_CREATE,
ID_COMMAND_TABLE_PROPERTY,ID_COMMAND_TABLE_CELL_PROPERTY,ID_COMMAND_TABLE_CELL_STYLE,ID_COMMAND_TABLE_ADD_ROW_COL,ID_COMMAND_TABLE_SPLIT_CELL,ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,ID_COMMAND_TABLE_CELL_VERTICALALIGN,ID_COMMAND_TABLE_SELECT_FORMULA];this.initializeMenuLayer=function(){try{dlog("initializeMenuLayer");if(dzeEnvConfig.iFrameLayer){var a=parseInt(window.frameElement.getAttribute("dzeditor_no"),10);dlog("dzeditor_frame_no:"+a)}for(var b=0,c=this.arrMenuMember.length;b<c;b++){var d=g_objLayerKit.getElementById("divMenuSelect_"+
b);if(!d){var e=null;dzeEnvConfig.iFrameLayer?(a=parseInt(window.frameElement.getAttribute("dzeditor_no"),10),isNaN(a)&&(a=0),e=this.arrTBMenu[a][b].element):e=this.arrTBMenu[0][b].element;if(null==e)break;e="";e+="<div id='divMenuSelect_"+b+"' class='MenuContainer' style='text-align:left;'>";e+="<div class='duzon_menubar_select_container'>";e+=this.buildMenuContent(b);e+="</div>";e+="</div>";d=g_objInsertUtil.insertLayerHTML(e,!0);if(!d)break}this.arrMenuLayer[b]=d;d.style.display="none";this.objSubMenuItem[b]=
[];this.setupMenuEvent(d,b)}}catch(f){dalert(f)}};this.unload=function(){try{for(var a=0,b=this.arrMenuLayer.length;a<b;a++){var c=this.arrMenuLayer[a];c&&c.parentNode&&c.parentNode.removeChild(c)}this.arrMenuLayer=[];this.objSubMenuItem=[]}catch(d){dalert(d)}};this.buildMenuContent=function(a){try{var b="";b+='<table class="MenuContent" cellpadding="0" cellspacing="0" style="border-collapse:separate;">';b+=this.buildMenuItem_Margin();for(var c=0,d=0;d<this.arrMenuMember[a].length;d++)if(g_arrMenuBar[a][d])if(-1==
this.arrMenuMember[a][d])b+=this.buildMenuItem_Garbage(),b+=this.buildMenuItem_Separator(),b+=this.buildMenuItem_Garbage();else if(this.arrMenuMember[a][d]!=ID_COMMAND_LOCK_EDIT_CELL||!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode)b+=this.buildMenuItem(this.arrMenuMember[a][d],!1),a==ID_COMMAND_MENU_TABLE_INDEX&&handlerUI.setMenuTableUpdateIndex(this.arrMenuMember[a][d],c),c++;b+=this.buildMenuItem_Margin();return b+"</table>"}catch(e){dalert(e)}};this.buildMenuItem=function(a,
b){try{var c="";c+='<tr class="MenuItem '+g_strSkin_MenuItem+'" MBCODE='+a+">";c+='<td width="8" style="line-height:1;vertical-align:middle;"></td>';c=""==g_arrIcon[a]?c+('<td width="16" style="line-height:1;vertical-align:middle;"><div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div></td>'):c+('<td width="16" style="line-height:1;vertical-align:middle;"><div style="line-height:0;" class="MenuItem_Image"><img src="'+
dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" alt="'+g_arrConst[a][1]+'" width="16" height="16" style="vertical-align:baseline;border:none;"></div></td>');c+='<td width="6" style="line-height:1;vertical-align:middle;"></td>';var d="",e;for(e in shortcutsMenuList)if(e==a){d="<span class='shortcuts_text'>("+shortcutsMenuList[e]+")</span>";break}var f=g_arrConst[a][1];inArray(a,this.openMenuList)&&(f+="...");!b||ID_COMMAND_JUSTIFY_LEFT!=a&&ID_COMMAND_JUSTIFY_CENTER!=a&&ID_COMMAND_JUSTIFY_RIGHT!=
a&&ID_COMMAND_JUSTIFY_JUSTIFY!=a&&ID_COMMAND_OUTDENT!=a&&ID_COMMAND_INDENT!=a&&ID_COMMAND_SELECT_ALL!=a||(f+=" ("+ID_RES_TOOL_STRING_MENU_TABLE+")",d="");c+='<td style="line-height:1;text-align:left;vertical-align:middle;">'+f+d+"</td>";b=!1;for(e in this.twoDepthMenu)if(a==e){b=!0;break}c=1==b?c+('<td width="3" class="MenuItem_arrow_icon" style="background-image: url('+dzeEnvConfig.strPath_Image+'toolbar/btn_sub_arrow.png)"></td>'):c+'<td width="3"></td>';return c+'<td width="6" style="line-height:1;vertical-align:middle;"></td></tr>'}catch(g){dalert(g)}};
this.buildMenuItem_Margin=function(){try{var a="";a+='<tr class="MenuItem_Garbage">';return a+'<td colspan="6" height="5"></td></tr>'}catch(b){dalert(b)}};this.buildMenuItem_Garbage=function(){try{var a="";a+='<tr class="MenuItem_Garbage">';return a+'<td colspan="6" height="2"></td></tr>'}catch(b){dalert(b)}};this.buildMenuItem_Separator=function(){try{var a="";a+='<tr class="MenuSeparator">';return a+'<td colspan="6" class="MenuItem_Separator" style="line-height:normal;"></td></tr>'}catch(b){dalert(b)}};
this.setupMenuEvent=function(a,b){try{if(a){var c=a.querySelectorAll(".MenuItem");forEach(c,function(a,c){this.setupMenuItemEvent(c,b)},this)}}catch(d){dalert(d)}};this.setupMenuItemEvent=function(a,b){try{if(g_objPropertyUtil.hasClass(a,"MenuItem")){var c=a.getAttribute("MBCODE");a.onmouseover=function(a){g_objMenuWin.setMenuItemMouseOver(this)};a.onmousedown=function(a){TBCancelBubbleEvent(a)};a.onmouseup=function(a){TBCancelBubbleEvent(a)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;
a.onselect=TBCancelBubbleEvent;window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1);var d=!1;for(idx in this.twoDepthMenu)if(c==idx){d=!0;break}1!=d&&(a.onclick=function(a){eval(g_arrConst[c][3])(a,this,-1)});a.command=g_arrConst[c][0];a.commandtype=ID_COMMAND_TYPE_MENU;a.TBSTATE=ID_STRING_NAME_UNCHECKED;a.command_id=c;a.support_type=g_arrConst[c][4];a.support_control_type=g_arrConst[c][5];this.objSubMenuItem[b][this.objSubMenuItem[b].length]=
a}}catch(e){dalert(e)}};this.initMenuLayerEvent=function(){try{this.closeMenuLayer(),g_objLayerEventUtil.removeLayerEvent()}catch(a){dalert(a)}};this.closeMenuLayer=function(a){try{for(a=0;a<this.arrMenuMember.length;a++)fnObjectCheckNull(this.arrMenuLayer[a])||(this.arrMenuLayer[a].style.display="none");duzon_menubar.hideTwoDepthMenu();duzon_menubar.closeHiddenTbContainerTool()}catch(b){dalert(b)}};this.showMenuLayer=function(a,b){try{dlog("showMenuLayer nIndex : "+a+", nEditNumber:"+b);this.initializeMenuLayer();
dlog(this.arrMenuLayer[a]);g_objWrapperOutlineResize.resetExtOutlineInfo();g_nActiveEditNumber=b;var c=this.arrTBMenu[b][a].element;null!=c&&(this.closeMenuLayer("hide"),this.update_menuItem(b),g_objLayerEventUtil.showLayerWin(this.arrMenuLayer[a],c,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,!1))}catch(d){dalert(d)}};this.update_menuItem=function(a){try{var b=g_objEditorDocument[a],c="";c=window.attachEvent?g_objEditorDocument[a].selection.type:getSelectionTypeForUpdateUI();c=c.toLowerCase();if(ID_STRING_NAME_CONTROL==
c)if(1==getSelectionControl(a).rangeLength)for(var d=0;d<this.objSubMenuItem.length;d++)for(var e=0;e<this.objSubMenuItem[d].length;e++){var f=this.objSubMenuItem[d][e];ID_SUPPORT_CONTROL_TYPE_NO==f.support_control_type&&this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY)}else for(d=0;d<this.objSubMenuItem.length;d++)for(e=0;e<this.objSubMenuItem[d].length;e++)f=this.objSubMenuItem[d][e],this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY);else if(GetMultiCellSelection())for(d=0;d<this.objSubMenuItem.length;d++)if(ID_COMMAND_MENU_TABLE_INDEX==
d)this.update_table_menuItem_queryStatus(g_objEditorDocument[a]);else for(e=0;e<this.objSubMenuItem[d].length;e++)f=this.objSubMenuItem[d][e],ID_SUPPORT_TYPE_MULTI_CELL==f.support_type?this.TBSubMenuSetState(f,ID_STRING_NAME_UNCHECKED):ID_SUPPORT_TYPE_PERSISTENCE!=f.support_type&&ID_SUPPORT_TYPE_TABLE_OPERATION!=f.support_type?this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY):ID_SUPPORT_TYPE_PERSISTENCE==f.support_type&&this.TBSubMenuSetState(f,ID_STRING_NAME_UNCHECKED);else for(d=0;d<this.objSubMenuItem.length;d++)if(ID_COMMAND_MENU_TABLE_INDEX==
d)this.update_table_menuItem_queryStatus(g_objEditorDocument[a]);else for(e=0;e<this.objSubMenuItem[d].length;e++){var g=this.objSubMenuItem[d][e],h=handlerUI.queryCommandStatus(b,this.objSubMenuItem[d][e].command_id,this.objSubMenuItem[d][e].command,a,-1,c);null==h&&g.TBSTATE==ID_STRING_NAME_UNCHECKED&&(h=ID_STRING_NAME_UNCHECKED);null!=h&&this.TBSubMenuSetState(g,h)}}catch(k){dalert(k)}};this.update_table_menuItem_queryStatus=function(a){try{updateTableHandlerUI.updateTableMenuUIHandler()}catch(b){dalert(b)}};
this.setMenuItemMouseOver=function(a){try{if(a.TBSTATE!=ID_STRING_NAME_GRAY){var b=g_objNodeUtil.getChildrenCollection(a);if(null!=b&&this.ID_MENU_ITEM_SEGMENT==b.length){b=!1;for(idx in this.twoDepthMenu)if(a.getAttribute("mbcode")==idx){b=!0;break}1==b?(setWindowResizeEvent(!1),duzon_menubar.viewTwoDepthMenu(a,a.getAttribute("mbcode"),this.twoDepthMenu[a.getAttribute("mbcode")]),setWindowResizeEvent(!0)):duzon_menubar.hideTwoDepthMenu(a.getAttribute("mbcode"))}}}catch(c){dalert(c)}};this.TBSubMenuSetState=
function(a,b){try{b=b.toLowerCase();var c=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(c=handlerUI.setDisableMenu(a.command_id));b=1==c?ID_STRING_NAME_GRAY:b;!g_objPropertyUtil.hasClass(a,"MenuItem")||b!==ID_STRING_NAME_GRAY&&b!==ID_STRING_NAME_CHECKED&&b!==ID_STRING_NAME_UNCHECKED&&b!==ID_STRING_NAME_HIDE||(b===ID_STRING_NAME_CHECKED||b===ID_STRING_NAME_UNCHECKED||b===ID_STRING_NAME_HIDE?g_objPropertyUtil.setFilterOpacityStyle(a,!1):b===ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,
!0),b===ID_STRING_NAME_CHECKED||b===ID_STRING_NAME_UNCHECKED||b===ID_STRING_NAME_GRAY?"none"===a.style.display&&(a.style.display=""):b===ID_STRING_NAME_HIDE&&(a.style.display="none"),a.TBSTATE=b)}catch(d){dalert(d)}};this.TBMenuSetState=function(a,b){try{switch(b=b.toLowerCase(),a.className){case g_strSkin_Menu_Area:case g_strSkin_Menu_AreaOver:case g_strSkin_Menu_AreaDown:case g_strSkin_Menu_AreaUp:if(b==ID_STRING_NAME_GRAY||b==ID_STRING_NAME_CHECKED||b==ID_STRING_NAME_UNCHECKED){var c=a.TBSTATE;
b!=c&&(b==ID_STRING_NAME_CHECKED?(a.className=g_strSkin_Menu_AreaUp,c==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):b==ID_STRING_NAME_UNCHECKED?(a.className=g_strSkin_Menu_Area,c==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):b==ID_STRING_NAME_GRAY&&(a.className=g_strSkin_Menu_Area,g_objPropertyUtil.setFilterOpacityStyle(a,!0)),a.TBSTATE=b)}}}catch(d){dalert(d)}};this.TBMenuSetStateAllEnable=function(a,b){try{for(var c=0;c<this.arrTBMenu[b].length;c++)a?
this.TBMenuSetState(this.arrTBMenu[b][c].element,ID_STRING_NAME_UNCHECKED):this.TBMenuSetState(this.arrTBMenu[b][c].element,ID_STRING_NAME_GRAY);!0===dzeUiConfig.bUseUiMode&&!0===dze_menu_control.ribbon_menu_created[b]&&dze_menu_control.RibbonMenuSetStateAllEnable(a,b)}catch(d){dalert(d)}};this.TBMenuShowMenuState=function(a,b,c){try{var d=this.arrTBMenu[c][a].element;if(d.TBSTATE!=ID_STRING_NAME_GRAY)if(b&&(this.bMenuDisplayToggle=!this.bMenuDisplayToggle),this.bMenuDisplayToggle)for(b=0;b<this.arrTBMenu[c].length;b++)b==
a?ID_STRING_NAME_CHECKED!=this.arrTBMenu[c][b].element.TBSTATE&&(this.TBMenuSetState(d,ID_STRING_NAME_CHECKED),this.showMenuLayer(a,c),g_bDynamicLayer=this.bMenuLayerShow=!0):ID_STRING_NAME_CHECKED==this.arrTBMenu[c][b].element.TBSTATE&&this.TBMenuSetState(this.arrTBMenu[c][b].element,ID_STRING_NAME_UNCHECKED);else this.bMenuLayerShow&&(g_objLayerEventUtil.initHideDynamicLayer(),d.className=g_strSkin_Menu_AreaOver)}catch(e){dalert(e)}};this.TBMenuCloseMenuState=function(){try{if(this.bMenuLayerShow)for(var a=
0;a<this.arrTBMenu[g_nActiveEditNumber].length;a++)ID_STRING_NAME_CHECKED==this.arrTBMenu[g_nActiveEditNumber][a].element.TBSTATE&&this.TBMenuSetState(this.arrTBMenu[g_nActiveEditNumber][a].element,ID_STRING_NAME_UNCHECKED);this.bMenuLayerShow=this.bMenuDisplayToggle=!1}catch(b){dalert(b)}};this.TBMenuButtonMouseOver=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a);var e=this.arrTBMenu[c][b].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_Menu_AreaUp:
g_strSkin_Menu_AreaOver,this.TBMenuShowMenuState(b,!1,c))}catch(f){dalert(f)}};this.TBMenuButtonMouseOut=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a);var e=this.arrTBMenu[c][b].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_Menu_AreaUp:g_strSkin_Menu_Area)}catch(f){dalert(f)}};this.TBMenuButtonMouseDown=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a);var e=this.arrTBMenu[c][b].element;if(e.TBSTATE!=ID_STRING_NAME_GRAY){if(e.TBSTATE==ID_STRING_NAME_CHECKED)e.className=
g_strSkin_Menu_AreaUp;else if(e.TBSTATE==ID_STRING_NAME_UNCHECKED){if(e.className=g_strSkin_Menu_AreaDown,g_objLayerEventUtil.forceBlurInput(),g_bDynamicLayer){g_objLayerEventUtil.initHideDynamicLayer();dlog("g_bDynamicLayer:"+g_bDynamicLayer);return}}else e.className=g_strSkin_Menu_AreaDown;this.TBMenuShowMenuState(b,!0,c)}}catch(f){dalert(f)}};this.TBMenuButtonMouseUp=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a)}catch(e){dalert(e)}};this.queryStatusMenuItem=function(a,b){try{var c={};c.element=
a;c.menuIndex=b;c.element.TBSTATE=ID_STRING_NAME_UNCHECKED;return c}catch(d){dalert(d)}return null};this.TBInitMenuButton=function(a,b){try{if(g_bMenuBar_Display){this.arrTBMenu[b][this.arrTBMenu[b].length]=this.queryStatusMenuItem(a,this.arrTBMenu[b].length);var c=this.arrTBMenu[b].length-1;a.onmouseover=function(a){g_objMenuWin.TBMenuButtonMouseOver(a,c,b,!0)};a.onmouseout=function(a){g_objMenuWin.TBMenuButtonMouseOut(a,c,b,!0)};a.onmousedown=function(a){g_objMenuWin.TBMenuButtonMouseDown(a,c,b,
!0)};a.onmouseup=function(a){g_objMenuWin.TBMenuButtonMouseUp(a,c,b,!0)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBCancelBubbleEvent;a.className=g_strSkin_Menu_Area;a.TBSTATE==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!0)}}catch(d){dalert(d)}}};

var comboBoxWin=function(){var l=this;this.objComboBoxLayer=null;this.objComboBoxLayerSub=[];this.bComboBoxDisplay=!1;this.arrFontSizeText=[];this.arrFontSize=" 8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 19pt 20pt 22pt 24pt 26pt 30pt 36pt".split(" ");this.arrHeadingText="\uae30\ubcf8;\uc81c\ubaa9 1;\uc81c\ubaa9 2;\uc81c\ubaa9 3;\uc81c\ubaa9 4;\uc81c\ubaa9 5".split(";");this.arrHeadingBlock=" h1 h2 h3 h4 h5 h6".split(" ");this.strComboBoxCommand="";comboBoxWin.prototype.initializeHeadingText=
function(){this.arrHeadingText[0]=ID_RES_CONST_STRING_STYLE_STYLE_BASIC;this.arrHeadingText[1]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT1;this.arrHeadingText[2]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT2;this.arrHeadingText[3]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT3;this.arrHeadingText[4]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT4;this.arrHeadingText[5]=ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT5};comboBoxWin.prototype.initializeFontSizeText=function(){this.arrFontSizeText[0]=ID_RES_COMBOBOX_REMOVE_FONT_SIZE;
this.arrFontSizeText[1]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[2]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[3]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[4]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[5]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[6]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[7]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[8]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8;this.arrFontSizeText[9]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_24;
this.arrFontSizeText[10]=ID_RES_COOMBOBOX_WIN_SIZE_TEXT_36};comboBoxWin.prototype.initializeComboBoxLayer=function(){try{if(null==this.objComboBoxLayer){this.initializeFontSizeText();var a='<div id="divComboBoxSelect" style="position:absolute; display:none; z-index:20031">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;table-layout:auto;" class="'+g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';for(var c='<table id="ComboBoxItem_FontName" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">',
d=0;d<g_arrFontName.length;d++)c+='<tr><td style="line-height:normal">',c+='<table id="ComboBoxItem_FontName_Sub_'+d+'"  cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',c=""==g_arrFontName[d]?c+("<td style='line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;padding-left:10px;'>"+ID_RES_COMBOBOX_REMOVE_FONT_FAMILY+"</td>"):c+("<td style='line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;padding-left:10px;font-family:"+
g_arrFontName[d]+";'>"+g_arrFontName[d].replace(/["']/g,"")+"</td>"),c+="</tr></table>",c+="</td></tr>";c+="</table>";"undefined"!=typeof dzeUiConfig.arrCustomFontSize&&0<dzeUiConfig.arrCustomFontSize.length&&(this.arrFontSize=dzeUiConfig.arrCustomFontSize);var b='<table id="ComboBoxItem_FontSize" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';for(d=0;d<this.arrFontSize.length;d++)b+='<tr><td style="line-height:normal;">',b+='<table id="ComboBoxItem_FontSize_Sub_'+
d+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',b=0==d?b+('<td style="line-height:normal;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px">'+this.arrFontSizeText[d]+"</td>"):b+('<td style="line-height:normal;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px">'+this.arrFontSize[d]+"</td>"),b+="</tr></table>",
b+="</td></tr>";b+="</table>";var e='<table id="ComboBoxItem_HeadingSize" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';this.initializeHeadingText();for(d=0;d<this.arrHeadingText.length;d++){e+='<tr><td style="line-height:normal;padding:0;">';e+='<table id="ComboBoxItem_HeadingSize_Sub_'+d+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>';var f=this.arrHeadingBlock[d];e=0==d?e+('<td style="line-height:0;text-align:left;font-family:'+
ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px">'+this.arrHeadingText[d]+"</td>"):e+('<td style="line-height:0;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:10px"><'+f+">"+this.arrHeadingText[d]+"</"+f+"></td>");e+="</tr></table>";e+="</td></tr>"}e+="</table>";a+=c;a+=b;a+=e;a+="</td></tr></table>";a+="</div>";if(g_objLayerKit.getElementById("divComboBoxSelect")||g_objInsertUtil.insertLayerHTML(a,
!0))this.objComboBoxLayer=g_objLayerKit.getElementById("divComboBoxSelect"),this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(g_objLayerKit.getElementById("ComboBoxItem_FontName"),g_arrFontName.length,0),this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(g_objLayerKit.getElementById("ComboBoxItem_FontSize"),this.arrFontSize.length,1),this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(g_objLayerKit.getElementById("ComboBoxItem_HeadingSize"),
this.arrHeadingText.length,2)}}catch(g){dalert(g)}};comboBoxWin.prototype.unload=function(){try{var a=g_objLayerKit.getElementById("divComboBoxSelect");a&&a.parentNode&&a.parentNode.removeChild(a);this.objComboBoxLayer=null;this.objComboBoxLayerSub=[]}catch(c){dalert(c)}};comboBoxWin.prototype.initComboBoxSubItem=function(a,c,d){try{var b={};b.element=a;b.subItem=[];for(var e=a.id,f=0;f<c;f++){b.subItem[f]=g_objLayerKit.getElementById(e+"_Sub_"+f);b.subItem[f].onmouseout=function(a){l.fnComboBoxItemOut(this)};
b.subItem[f].onmousedown=TBCancelBubbleEvent;b.subItem[f].onmouseup=TBCancelBubbleEvent;var g=b.subItem[f];(function(){var a="";0==d?a=g_arrFontName[f]:1==d?a=l.arrFontSize[f]:2==d&&(a=f);g.onclick=function(b){!0===dzeUiConfig.bTBPreviewLetterOperation&&(l.objComboBoxLayer.onmouseleave=function(){});if((b=document.activeElement)&&"INPUT"===b.nodeName&&startsWith(b.id,"TB_COMBOBOX_")&&(b.blur(),g_bBrowserType_IE)){b.value=a;return}l.setComboBox(a)};g.onmouseover=function(){l.fnComboBoxItemOver(this);
!0===dzeUiConfig.bTBPreviewLetterOperation&&l.setComboBox(a,!1)}})()}window.attachEvent?b.element.oncontextmenu=fnReturnFalsePropagation:b.element.addEventListener("contextmenu",fnReturnFalsePropagation,!1);return b}catch(k){dalert(k)}return null};comboBoxWin.prototype.initComboBoxLayerEvent=function(a){try{if(null!=this.objComboBoxLayer){var c=a?a.target:null;c&&"INPUT"===c.nodeName&&startsWith(c.id,"TB_COMBOBOX_")||!this.bComboBoxDisplay||(this.objComboBoxLayerSub[0].element.style.display="none",
this.objComboBoxLayerSub[1].element.style.display="none",this.objComboBoxLayerSub[2].element.style.display="none",this.objComboBoxLayer.style.display="none",this.strComboBoxCommand="",this.bComboBoxDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objComboBoxLayer=null,this.objComboBoxLayerSub=[])}}catch(d){dalert(d)}};comboBoxWin.prototype.showComboBoxLayer=function(a,c,d){try{if(this.initializeComboBoxLayer(),void 0===d&&(d=!1),null!=this.objComboBoxLayer){g_nActiveEditNumber=c;g_nLetterOperationType=
a;var b=0;if(0==a){var e=handlerUI.getCommandUpdateIndex(c,ID_COMMAND_FONT_NAME);-1!=e&&(b=e)}else if(1==a)e=handlerUI.getCommandUpdateIndex(c,ID_COMMAND_FONT_SIZE),-1!=e&&(b=e);else if(2==a)e=handlerUI.getCommandUpdateIndex(c,ID_COMMAND_HEADING_SIZE),-1!=e&&(b=e),g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE;else return;var f=g_TBComboBox[c][b].element;if(null!=f)if(!d&&this.bComboBoxDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{var g=g_objPropertyUtil.getSelectionAttributeValue(c);
if("undefined"!=typeof g&&null!=g){if(0==a){if("undefined"==typeof g[0]||null==g[0])g[0]="";for(var k=updateHandlerUI.getMappingIndex_FontName(g[0],c),h=0;h<g_arrFontName.length;h++)this.objComboBoxLayerSub[a].subItem[h].className=k==h?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out}else if(1==a){if("undefined"==typeof g[1]||null==g[1])g[1]="";k=updateHandlerUI.getMappingIndex_FontSize(g[1],c);for(h=0;h<this.arrFontSize.length;h++)this.objComboBoxLayerSub[a].subItem[h].className=k==h?g_strSkin_ComboBoxItem_Down:
g_strSkin_ComboBoxItem_Out}else if(2==a)for(k=updateHandlerUI.getMappingIndex_Heading(c),h=0;h<this.arrHeadingText.length;h++)this.objComboBoxLayerSub[a].subItem[h].className=k==h?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out;this.strComboBoxCommand=g_TBComboBox[c][b].element.command;this.bComboBoxDisplay=!0;this.objComboBoxLayerSub[a].element.style.display="";g_objLayerEventUtil.showLayerWin(this.objComboBoxLayer,f,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,dzeUiConfig.bTBPreviewLetterOperation);
if(!0===dzeUiConfig.bTBPreviewLetterOperation){var l=GetCurTable(c);l?g_objLayerEventUtil.saveTableSelectedCellHTML(l):g_objUndoRedo.setUndoSelection(c);this.objComboBoxLayer.onmouseleave=function(){var a=GetCurTable(c);a?g_objLayerEventUtil.restoreTableSelectedCellHTML(a):(g_objUndoRedo.registerUndoRedoStack(0,c),g_objUndoRedo.operateUndoRedoStack(!0,!0,c))}}}}}}catch(m){dalert(m)}};comboBoxWin.prototype.setupComboBoxLabel=function(a,c){try{this.initializeHeadingText();var d="";if(ID_COMMAND_FONT_NAME==
c){for(var b=0;b<g_arrFontName.length;b++)d+="<span style='display:none;line-height:normal;'>"+g_arrFontName[b]+"</span>";"INPUT"!==a.nodeName&&(a.innerHTML=d)}else if(ID_COMMAND_FONT_SIZE==c){for(b=0;b<g_objComboBoxWin.arrFontSize.length;b++)d+="<span style='display:none;line-height:normal;'>"+g_objComboBoxWin.arrFontSize[b]+"</span>";a.innerHTML=d}else if(ID_COMMAND_HEADING_SIZE==c){for(b=0;b<g_objComboBoxWin.arrHeadingText.length;b++)d+="<span style='display:none;line-height:normal;'>"+g_objComboBoxWin.arrHeadingText[b]+
"</span>";a.innerHTML=d}}catch(e){dalert(e)}};comboBoxWin.prototype.fnComboBoxItemOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(c){dalert(c)}};comboBoxWin.prototype.fnComboBoxItemOut=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(c){dalert(c)}};comboBoxWin.prototype.setComboBox=function(a,c){try{var d=!0;"undefined"!=typeof c&&(d=c);if(""!=g_objComboBoxWin.strComboBoxCommand){var b=
g_nActiveEditNumber;if(GetMultiCellSelection(b))g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY?g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,a,b):g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?g_objTableMultiCell.setMultiCellCommand_LetterOperation(g_nLetterOperationType,a,b):g_nLetterOperationType==ID_LETTER_OPERATION_HEADING_SIZE&&g_objLetterFn.setParaStyle(b,{head:g_objComboBoxWin.arrHeadingBlock[a]}),setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox("",
b)}catch(h){}},100);else if(window.attachEvent){var e=g_objEditorDocument[b].selection;if(fnObjectCheckNull(e))return;var f=e.type;f=f.toLowerCase();if(ID_STRING_NAME_NONE==f||ID_STRING_NAME_TEXT==f){var g=e.createRange();if(fnObjectCheckNull(g))return;g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY?g_objLetterFn.setLetterOperation(g_nLetterOperationType,a,g,b,!0):g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?g_objLetterFn.setLetterOperation(g_nLetterOperationType,a,g,b,!0):g_nLetterOperationType==
ID_LETTER_OPERATION_HEADING_SIZE&&g_objLetterFn.setParaStyle(b,{head:g_objComboBoxWin.arrHeadingBlock[a]})}setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(f,b)}catch(h){}},10)}else{f=getSelectionTypeForUpdateUI();if(ID_STRING_NAME_NONE==f||ID_STRING_NAME_TEXT==f)if(g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY){e=g_objEditWindow[b].getSelection();var k=e.getRangeAt(0);g_objLetterFn.setLetterOperation(g_nLetterOperationType,a,k,b,!0)}else g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?
(e=g_objEditWindow[b].getSelection(),k=e.getRangeAt(0),g_objLetterFn.setLetterOperation(g_nLetterOperationType,a,k,b,!0)):g_nLetterOperationType==ID_LETTER_OPERATION_HEADING_SIZE&&g_objLetterFn.setParaStyle(b,{head:g_objComboBoxWin.arrHeadingBlock[a]});setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox(f,b)}catch(h){}},10)}0!=d&&g_objLayerEventUtil.initHideDynamicLayer();tranAllAnchorHrefSharp(b);0!=d&&(g_objUndoRedo.registerUndoRedoStack(0,b),editor_onselectionchange(b))}}catch(h){dalert(h)}};
this.initComboBoxInput=function(a,c,d,b){try{b===ID_COMMAND_FONT_NAME&&c&&d&&(function(a){if(a){var b=function(a){this.hasAttribute("readonly")||(a.cancelBubble=!0)};a.onmouseover=b;a.onmouseout=b;a.onmouseup=b;a.onselectstart=b;a.onselect=b;a.onclick=b}}(d),d.onmousedown=function(b){this.hasAttribute("readonly")||c.TBSTATE===ID_STRING_NAME_GRAY||(this._caret||(this._caret=GetCurRangeProp(a)),b.cancelBubble=!0)},d.onfocus=function(){this._value=this.value;this.select()},d.onblur=function(){var b=
this._caret,d=this._value;this._caret=this._value=null;var c=this.value.trim();c=removeZeroWidthSpaceFromString(c);b&&!b.isNull()&&(b=b.getRange(),SetCurRange(b));duzon_dialog.setEditorFocus(a);c&&d!==c&&c!==ID_RES_CONST_STRING_FONT_NAME&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(c))},d.onkeydown=function(a){switch(a.keyCode){case ID_KEYCODE_ENTER:case ID_KEYCODE_ESCAPE:this.blur(),TBCancelBubbleEvent(a)}},
d.cancelValue=function(){dlog("cancel input value");var a=this._value,b=this.value;a&&a!==b&&(this.value=a)})}catch(e){dalert(e)}};this.forceBlurInput=function(){try{var a=document.activeElement;a&&"INPUT"===a.nodeName&&!a.hasAttribute("readonly")&&(a.cancelValue&&"function"===typeof a.cancelValue&&a.cancelValue(),a.blur())}catch(c){dalert(c)}}},g_objComboBoxWin=new comboBoxWin;

var g_objContextMenuWin=new function(){this.arrTBContextMenuItem=[];this.arrTBContextMenuItem[0]=[];this.arrTBContextMenuItem[1]=[];this.arrTBContextMenuItem[2]=[];this.arrTBContextMenuItem[3]=[];this.arrTBContextMenuItem[4]=[];this.arrTBContextMenuItem[5]=[];this.ID_CONTEXT_TYPE_CASE_GENERAL=0;this.ID_CONTEXT_TYPE_CASE_TABLE_ONE=1;this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI=2;this.ID_CONTEXT_TYPE_CASE_CONTROL=3;this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU=4;this.ID_CONTEXT_TYPE_CASE_CONTROL_EXTERNAL_DATA=
5;this.nActiveContextMenu=0;this.objContextMenuLayer=[];this.objContextMenuLayer[0]=null;this.objContextMenuLayer[1]=null;this.objContextMenuLayer[2]=null;this.objContextMenuLayer[3]=null;this.objContextMenuLayer[4]=null;this.objContextMenuLayer[5]=null;this.bContextMenuAttachMouseEvent=!1;this.arrContextMenu_TableMiniMenu=[ID_COMMAND_SELECT_ALL,ID_TYPE_MENU_SEPARATOR,ID_COMMAND_TABLE_DELETE_TABLE,ID_TYPE_MENU_SEPARATOR,ID_COMMAND_LOCK_EDIT_TABLE,ID_COMMAND_LOCK_EDIT_TABLE_SIZE,ID_TYPE_MENU_SEPARATOR,
ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT,ID_TYPE_MENU_SEPARATOR,ID_COMMAND_OUTDENT,ID_COMMAND_INDENT];this.arrHideCallback=null;this.bShow=!1;this.isShow=function(){return this.bShow};this.initializeContextMenuLayer=function(){try{for(var a=0,c=this.objContextMenuLayer.length;a<c&&null==this.objContextMenuLayer[a];a++){var b=g_objLayerKit.getElementById("divContextMenu_"+a);if(!b){var d="<div id='divContextMenu_"+a+"' class='ContextMenuContainer'>";d+="<table cellpadding=0 cellspacing=0 border=0 width='100%'><tr><td>";
d+="<table cellpadding=0 cellspacing=0 border=0 class='"+g_strSkin_MenuWin+"'><tr><td>";d+=this.buildContextMenuContent(a);d+="</td></tr></table>";d+="</td></tr></table>";d+="</div>";b=g_objInsertUtil.insertLayerHTML(d,!0);if(!b)continue}b.style.display="none";b.style.height="";b.style.overflowY="";b.scrollTop=0;this.objContextMenuLayer[a]=b;this.arrTBContextMenuItem[a]=[];this.setupContextMenuEvent(b,a);g_objNodeUtil.initFalsePropagationEvent(b)}}catch(g){dalert(g)}};this.unload=function(){try{for(var a=
0,c=this.objContextMenuLayer.length;a<c;a++){var b=this.objContextMenuLayer[a];b&&b.parentNode&&b.parentNode.removeChild(b)}this.divContextMenuRoot=null;this.objContextMenuLayer=[];this.arrTBContextMenuItem=[]}catch(d){dalert(d)}};this.buildContextMenuContent=function(a){try{var c=g_objMenuWin,b=dzeUiConfig,d=null;switch(a){case this.ID_CONTEXT_TYPE_CASE_GENERAL:d=b.arrContextMenu_General;break;case this.ID_CONTEXT_TYPE_CASE_TABLE_ONE:d=b.arrContextMenu_OneCell;break;case this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI:d=
b.arrContextMenu_MultiCell;break;case this.ID_CONTEXT_TYPE_CASE_CONTROL:d=b.arrContextMenu_Control;break;case this.ID_CONTEXT_TYPE_CASE_CONTROL_EXTERNAL_DATA:d=b.arrContextMenu_ControlExternalData;break;case this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU:d=this.arrContextMenu_TableMiniMenu;break;default:return""}if(!d)return"";a="";a+='<table class="MenuContent" cellpadding=0 cellspacing=0 style="border-collapse:separate;">';a+=c.buildMenuItem_Margin();for(var g=null,h=0,f=d.length;h<f;h++)if(ID_TYPE_MENU_SEPARATOR!==
g||ID_TYPE_MENU_SEPARATOR!==d[h]){if(ID_TYPE_MENU_SEPARATOR==d[h])a+=c.buildMenuItem_Garbage(),a+=c.buildMenuItem_Separator(),a+=c.buildMenuItem_Garbage();else{var e=d[h];if(e===ID_COMMAND_LOCK_EDIT_CELL&&(!1===b.bUseLockEditCellFunction||!1===g_bLockEditCellMode))continue;else if(e===ID_COMMAND_EXTERNAL_DATA_AREA&&!1===b.bUseDataBind)continue;else if((e===ID_COMMAND_LOCK_EDIT_TABLE||e===ID_COMMAND_LOCK_EDIT_TABLE_SIZE)&&!1===g_bLockEditTableMode)continue;a+=c.buildMenuItem(e,!0)}g=d[h]}a+=c.buildMenuItem_Margin();
return a+"</table>"}catch(k){dalert(k)}};this.setupContextMenuEvent=function(a,c){try{if(a){this.setupContextMenuItemEvent(a,c);var b=a.querySelectorAll(".MenuItem");forEach(b,function(a,b){this.setupContextMenuItemEvent(b,c)},this)}}catch(d){dalert(d)}};this.setupContextMenuItemEvent=function(a,c){try{if(a)if(g_objPropertyUtil.hasClass(a,"MenuItem")){var b=a.getAttribute("MBCODE");a.onmouseover=function(a){g_objMenuWin.setMenuItemMouseOver(this)};a.onmousedown=TBCancelBubbleEvent;a.onmouseup=function(a){eval(g_arrConst[b][3])(a,
this,-1)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBCancelBubbleEvent;a.command=g_arrConst[b][0];a.commandtype=ID_COMMAND_TYPE_CONTEXT_MENU;a.TBSTATE=ID_STRING_NAME_UNCHECKED;a.command_id=b;a.support_type=g_arrConst[b][4];a.support_control_type=g_arrConst[b][5];var d=this.arrTBContextMenuItem[c].length;this.arrTBContextMenuItem[c][d]=a;this.ID_CONTEXT_TYPE_CASE_TABLE_ONE==c?handlerUI.setContextUpdateIndex(c,b,d):this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI==
c&&handlerUI.setContextUpdateIndex(c,b,d)}else g_objPropertyUtil.hasClass(a,"ContextMenuContainer")&&(a.dze_add_listener||(a.dze_add_listener=[]),!0!==a.dze_add_listener.wheel&&(a.dze_add_listener.wheel=!0,EventUtil.addHandler(a,"wheel",function(a){var b=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);if(b&&"none"!==b.style.display)return TBCancelBubbleEvent(a),!1;b=a.deltaY;var c=this.scrollTop;if(c>=this.scrollHeight-this.offsetHeight&&0<b||0===c&&0>b)return TBCancelBubbleEvent(a),
!1;a.cancelBubble=!0;return!1})))}catch(g){dalert(g)}};this.initContextMenuLayerEvent=function(){try{if(dlog("initContextMenuLayerEvent"),duzon_menubar.hideTwoDepthMenu(),null!=this.objContextMenuLayer){for(var a=0;a<this.objContextMenuLayer.length;a++)fnObjectCheckNull(this.objContextMenuLayer[a])||(this.objContextMenuLayer[a].style.display="none");this.bContextMenuAttachMouseEvent&&(this.bContextMenuAttachMouseEvent=!1,g_objLayerEventUtil.removeLayerEvent());this.arrHideCallback&&forEach(this.arrHideCallback,
function(a,b){b&&b()},this);this.bShow=!1}}catch(c){dalert(c)}};this.showContextMenuLayer=function(a,c,b,d){try{if(this.initializeContextMenuLayer(),null!=this.objContextMenuLayer)if(this.bContextMenuAttachMouseEvent)g_objLayerEventUtil.initHideDynamicLayer();else for(this.display_context_menuItem(a,c,b,d),this.bContextMenuAttachMouseEvent=this.bShow=g_bDynamicLayer=!0,a=0;a<this.objContextMenuLayer.length;a++)if(""==this.objContextMenuLayer[a].style.display){g_objLayerEventUtil.objCurrentLayer=this.objContextMenuLayer[a];
g_objLayerEventUtil.addLayerEvent();break}}catch(g){dalert(g)}};this.getContextMenuType=function(a,c){try{var b={nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,strSelectedTagName:""};if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[c].selection.type.toLowerCase()){var d=g_objEditorDocument[c].selection.createRange();if(1==d.length){var g=d.item(0).tagName.toLowerCase();return"table"==g||"img"==g?{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_CONTROL,strSelectedTagName:g}:null}return null}}else{var h=
getSelectionType();dlog("objNodeInfo.nodeType:"+h.nodeType);if(ID_SELECTION_ELEMENT_NODE==h.nodeType)if(1==h.length){a=!1;var f=getSelectionElementNode(c);if(fnObjectCheckNull(f))if(g_bBrowserType_WK||g_bBrowserType_OP||g_bBrowserType_IE)a=!0;else return null;if(!a){g=f.nodeName.toLowerCase();dlog("strTagName:"+g);if("input"==g&&g_objPropertyUtil.hasClass(f,"dze_external_data_area")||"img"===g&&g_objPropertyUtil.hasClass(f,"dze_stamp"))return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_CONTROL_EXTERNAL_DATA,
strSelectedTagName:g};if("table"==g||"img"==g)return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_CONTROL,strSelectedTagName:g};if("br"!=g&&"#text"!=g&&"a"!=g)return null}}else{if("tr"!=h.nodeName.toLowerCase())return null}else if(ID_SELECTION_TEXT_NODE!=h.nodeType&&ID_SELECTION_DUPLICATE!=h.nodeType)return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,strSelectedTagName:""}}var e=GetCurTable(c);if(2==g_nFormEditMode&&(null==e||!g_objEditMode.getLoopContentEditable(e)))return{nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,
strSelectedTagName:""};dzeUiConfig.bUseLockEditCellFunction&&(g_bHasLockedCell=!g_objEditMode.checkSelectionContentEditable(c),b.bHasLockedCell=g_bHasLockedCell);if(GetMultiCellSelection(c))return 1>=GetSelectedCellCount(c)?b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TABLE_ONE:b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,b;if(e)return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TABLE_ONE,b;b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_GENERAL;return b}catch(k){dalert(k)}return-1};this.display_context_menuItem=
function(a,c,b,d){try{if(!a)return!1;c={left:c,top:b};var g=a.nContextMenuType,h=this.objContextMenuLayer[g];if(!h||!0!==this.updateContextMenu(d,a))return!1;this.nActiveContextMenu=g;h.style.display="";h.style.height="";var f=this.getContextMenuRect(h,c);g!==this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU&&(f=g_objLayerEventUtil.adjustMenuRect(h,f));this.setContextMenuRect(h,f);g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,f.left,f.top,g);return!0}catch(e){dalert(e)}};this.updateContextMenu=
function(a,c){try{var b=c.nContextMenuType,d=c.strSelectedTagName,g=this.objContextMenuLayer[b];if(b==this.ID_CONTEXT_TYPE_CASE_GENERAL){updateHandlerUI.update_context_menu(b,null,null,a);var h=g.getElementsByTagName("table");for(c=0;c<h.length;c++)if("MenuContent"==h[c].className)for(var f=h[c].getElementsByTagName("tr"),e=0;e<f.length;e++)if(f[e].getAttribute("mbcode")&&f[e].getAttribute("mbcode")==ID_COMMAND_FILE_PROPERTY){f[e].style.display="none";f[e+1].style.display="none";f[e+2].style.display=
"none";f[e+3].style.display="none";break}else f[e].getAttribute("style")&&f[e].removeAttribute("style");d=!1;for(c=0;c<this.arrTBContextMenuItem[b].length;c++)if(this.arrTBContextMenuItem[b][c].command_id==ID_COMMAND_HYPERLINK_REMOVE&&"unchecked"==this.arrTBContextMenuItem[b][c].TBSTATE){d=!0;break}if(1==d&&"dzeExtFile"==g_objPropContentLink.getPropContentParam(a).arrValue[3])for(c=0;c<h.length;c++)if("MenuContent"==h[c].className)for(f=h[c].getElementsByTagName("tr"),e=0;e<f.length;e++)if(f[e].getAttribute("mbcode")&&
f[e].getAttribute("mbcode")==ID_COMMAND_FILE_PROPERTY){f[e].getAttribute("style")&&f[e].removeAttribute("style");f[e+1].getAttribute("style")&&f[e+1].removeAttribute("style");f[e+2].getAttribute("style")&&f[e+2].removeAttribute("style");f[e+3].getAttribute("style")&&f[e+3].removeAttribute("style");break}}else if(b==this.ID_CONTEXT_TYPE_CASE_TABLE_ONE)updateHandlerUI.update_context_menu(b,null,null,a,c),updateTableHandlerUI.updateTableContextMenuUIHandler(b,this.arrTBContextMenuItem[b]);else if(b==
this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI)updateHandlerUI.update_context_menu(b,null,null,a,c),updateTableHandlerUI.updateTableContextMenuUIHandler(b,this.arrTBContextMenuItem[b]);else if(b==this.ID_CONTEXT_TYPE_CASE_CONTROL)updateHandlerUI.update_context_menu(b,ID_STRING_NAME_CONTROL,d,a);else if(b==this.ID_CONTEXT_TYPE_CASE_CONTROL_EXTERNAL_DATA)updateHandlerUI.update_context_menu(b,ID_STRING_NAME_CONTROL,d,a);else if(b==this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU){var k=GetCurTable(a),l=g_objTableFunction.isEditableTable(k),
m=g_objTableFunction.canTableResize(k);this.arrTBContextMenuItem[this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU].forEach(function(a){var b=1*a.getAttribute("mbcode");b===ID_COMMAND_LOCK_EDIT_TABLE?(g_objMenuWin.TBSubMenuSetState(a,ID_STRING_NAME_UNCHECKED),b=g_objNodeUtil.getLoopChildNodeByTagName(a.childNodes[1],"img"),!1===l?(b.src=dzeEnvConfig.strPath_Image+"toolbar/ico_table_unlock.png",a.childNodes[3].textContent=ID_RES_STRING_CLEAR_LOCK_EDIT_TABLE):(b.src=dzeEnvConfig.strPath_Image+"toolbar/ico_table_lock.png",
a.childNodes[3].textContent=ID_RES_STRING_LOCK_EDIT_TABLE)):b===ID_COMMAND_LOCK_EDIT_TABLE_SIZE?(g_objMenuWin.TBSubMenuSetState(a,ID_STRING_NAME_UNCHECKED),b=g_objNodeUtil.getLoopChildNodeByTagName(a.childNodes[1],"img"),!1===m?(b.src=dzeEnvConfig.strPath_Image+"toolbar/column_unlock.png",a.childNodes[3].textContent=ID_RES_STRING_CLEAR_LOCK_EDIT_TABLE_SIZE):(b.src=dzeEnvConfig.strPath_Image+"toolbar/column_lock.png",a.childNodes[3].textContent=ID_RES_STRING_LOCK_EDIT_TABLE_SIZE)):g_objMenuWin.TBSubMenuSetState(a,
ID_STRING_NAME_UNCHECKED)});!1===l||dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell?g_objMenuWin.TBSubMenuSetState(this.arrTBContextMenuItem[b][1],ID_STRING_NAME_GRAY):g_objMenuWin.TBSubMenuSetState(this.arrTBContextMenuItem[b][1],ID_STRING_NAME_UNCHECKED)}else return!1;return!0}catch(n){dalert(n)}};this.getContextMenuRect=function(a,c){try{var b={};b.left=c.left;b.width=a.offsetWidth;b.right=c.left+b.width;b.top=c.top;b.height=a.offsetHeight;b.bottom=c.top+b.height;return b}catch(d){dalert(d)}};
this.setContextMenuRect=function(a,c){try{if(!a||!c)return a;a.style.left=c.left+"px";a.style.top=c.top+"px";!0===c.bScroll?(a.style.height=c.height+"px",a.style.overflowY="scroll"):(a.style.height="",a.style.overflowY="");a.scrollTop=0;return a}catch(b){dalert(b)}};this.ShowContextMenuDisplayInEditArea=function(a,c,b,d){try{var g=g_objPositionUtil.getElementPosition(g_objEditObject[a],!1),h=g.right,f=g.bottom,e=this.objContextMenuLayer[d].offsetWidth,k=this.objContextMenuLayer[d].offsetHeight;c+
e>h&&(this.objContextMenuLayer[d].style.left=h-e+"px");b+k>f&&(this.objContextMenuLayer[d].style.top=f-k+"px")}catch(l){dalert(l)}};this.setHideCallback=function(a){try{a&&(this.arrHideCallback||(this.arrHideCallback=[]),this.arrHideCallback.push(a))}catch(c){dalert(c)}}};

var g_objPropForm=new function(){this.objTableInfo=this.objFormTableContainer=this.objFormTable=null;this.nDrawMaxRow=30;this.nDrawCellHeight=this.nDrawCellWidth=this.nDrawMaxCol=20;this.ID_DRAW_TYPE_20_COL=0;this.ID_DRAW_TYPE_100_COL=1;this.bShowPropForm=!1;this.bNewCreate=this.bGenerateColGroup=!0;this.buildPropForm=function(){try{var a="";a+='<table cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td colspan="3" style="height:5px"></td>';a+="</tr>";a+="<tr>";a+='<td colspan="3">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="10"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="2"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="propFormTableContainer" class="propSection_td" style="padding:10px;">';a+="</td>";a+='<td width="160" style="vertical-align:top;" class="propSection_td">';a+='<div style="margin:10px;border:0px">';a+=this.buildFormView();
a+="</div>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="2"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="10"></td>';a+="</tr>";a+="</table>";a+="</td>";return a+"</tr></table>"}catch(b){dalert(b)}};this.drawFormTable=function(a,b,c,f){try{var d="";d+='<table id="propFormTable" align="center" style="border-collapse:collapse;background-image: url('+dzeEnvConfig.strPath_Image+"dialog/bg_grid.gif);width:"+c*b+'px;" cellspacing="0" cellpadding="1">';for(var e=0;e<a;e++){d+=
"<tr>";for(var g=0;g<b;g++){var h="border-left:",k="border-top:",l="border-right:",m="border-bottom:",n=e%5,p=g%5;0==n?(k+="1px dotted #888888;",m+="1px dotted #c0c0c0;"):4==n?(k+="1px dotted #c0c0c0;",m+="1px dotted #888888;"):(k+="1px dotted #c0c0c0;",m+="1px dotted #c0c0c0;");0==p?(h+="1px dotted #888888;",l+="1px dotted #c0c0c0;"):4==p?(h+="1px dotted #c0c0c0;",l+="1px dotted #888888;"):(h+="1px dotted #c0c0c0;",l+="1px dotted #c0c0c0;");d+='<td width="'+c+'" height="'+f+'" style="'+(h+k+l+m)+
'" posRow='+e+" posCol="+g+"></td>"}d+="</tr>"}return d+"</table>"}catch(q){dalert(q)}};this.buildFormView=function(){try{var a="";a+='<div class="duzon_dialog_label_title" style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_BASE_SIZE;a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+=ID_RES_DIALOG_STRING_SIZE+" (%) : ";a+='<select id="selFormDefineWidth" style="width:40px !important;background-color:#c0c0c0;"></select>';
a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+=ID_RES_DIALOG_STRING_HEIGHT+" (px) : ";a+='<select id="selFormDefineHeight" style="width:40px !important;"></select>';a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<input id="chkKeepHeightYN" type="checkbox" value="1" />'+ID_RES_CONST_STRING_KEEP_ORG_HEIGHT+"<br />";a+=ID_RES_CONST_STRING_NEW_BLOCK_REFERENCE_HEIGHT;
a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title" style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_OUTLINE;a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_SIZE+" : </td>";a+='<td width="6" style="border:0;"></td>';
a+='<td width="76" style="vertical-align:top;border:0;">';a+=duzon_dialog.makeSpinnerInputForm("txtFormBorderWidth","",10,0,"");a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_FORM_TYPE+" : </td>";a+='<td width="6" style="border:0;"></td>';a+='<td style="vertical-align:top;border:0;">';
a+=g_objBorderComboBoxUtil.makeBorderComboBoxHTML("selFormBorderStyle",0,70,90);a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+='<td width="6" style="border:0;"></td>';a+='<td style="vertical-align:top;border:0;">';a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtFormBorderColor",
70);a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+=g_objBorderSelectionUtil.makeBorderSelectionHTML(1,10,20,!1);a+="</div>";a+='<div style="margin:0;padding:0;height:10px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<img id="btnForm_Apply_Border" src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_strBrowserLanguage+'/prop_btn_apply.gif" alt="apply" border="0">';
a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title" style="margin:0;padding:0;">';a+=ID_RES_CONST_STRING_BACKGROUND_COLOR;a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70" style="border:0;text-align:right;">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+='<td width="6" style="border:0;"></td>';a+='<td style="vertical-align:top;border:0;">';
a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtFormBgColor",70);a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div style="margin:0;padding:0;height:4px;"></div>';a+='<div style="margin:0;padding:0;text-align:right;">';a+='<img id="btnForm_Apply_bgColor" src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_strBrowserLanguage+'/prop_btn_apply.gif" alt="apply" border="0">';a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_MULTI_SELECT;
a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_MULTI_OTHER_SELECT;a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_COPY_PASTE;a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_COPY_MOVE;a+="</div>";a+='<div style="margin:0;padding:0;height:6px;"></div>';
a+='<div style="margin:0;padding:0;">';a+=ID_RES_DIALOG_STRING_FORM_RESIZE;a+="</div>";a+='<div style="margin:0;padding:0;height:50px;"></div>';a+='<div style="margin:0;padding:0;text-align:center;">';a+='<input type="button" id="btnForm_PreviewCreate" name="btnForm_PreviewCreate" value="'+ID_RES_DIALOG_STRING_FORM_PRE_APPLY+'" />';return a+"</div>"}catch(b){dalert(b)}};this.initPropForm=function(a){try{if(this.objFormTableContainer=g_objLayerKit.getElementById("propFormTableContainer"),null!=this.objFormTableContainer){duzon_dialog.modifySpinnerValue("txtFormBorderWidth",
10,0,0,"g_objPropForm.onChangeSpinnerValue");g_objBorderSelectionUtil.initBorderSelection();g_objBorderComboBoxUtil.initBorderComboBox("selFormBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a);g_objPropForm.updateBorderSelection()});g_objColorComboBoxUtil.initColorComboBox("txtFormBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a);g_objPropForm.updateBorderSelection()});g_objColorComboBoxUtil.initColorComboBox("txtFormBgColor");this.objTableInfo=null;if(a){var b=
g_objPropFormLoad.prepareLoadFormStructure(a);-1==b?(this.setFormDrawType(this.ID_DRAW_TYPE_20_COL),alert(ID_RES_CONST_STRING_CANNOT_READ_DOCUMENT_FORMAT+" - 1")):(this.setFormDrawType(b),this.objTableInfo=a,this.bNewCreate=!1)}else this.setFormDrawType(this.ID_DRAW_TYPE_20_COL);this.assignDrawFormTable(this.nDrawMaxRow,this.nDrawMaxCol,this.nDrawCellWidth,this.nDrawCellHeight);this.setPropFormEvent();null!=this.objTableInfo&&(g_objPropFormLoad.loadFormStructure(this.objTableInfo)?window.setTimeout("g_objPropFormEvent.showAllAreaRectangle()",
1E3):(this.objTableInfo=null,alert(ID_RES_CONST_STRING_CANNOT_READ_DOCUMENT_FORMAT+" - 2")));g_objPropFormSink.setupPropFormUI(null!=this.objTableInfo?!0:!1)}}catch(c){dalert(c)}};this.onChangeSpinnerValue=function(a){try{g_objBorderSelectionUtil.setBorderWidth(a),g_objPropForm.updateBorderSelection()}catch(b){dalert(b)}};this.updateBorderSelection=function(){try{g_objBorderSelectionUtil.getChecked("miniRec_v_0")&&g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0),g_objBorderSelectionUtil.getChecked("miniRec_h_0")&&
g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0),g_objBorderSelectionUtil.getChecked("miniRec_v_2")&&g_objBorderSelectionUtil.setChecked("miniRec_v_2",!0),g_objBorderSelectionUtil.getChecked("miniRec_h_2")&&g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0)}catch(a){dalert(a)}};this.setPropFormEvent=function(){try{g_objPropFormEvent.resetFormInfo(),this.objFormTable.onmousedown=function(a){g_objPropFormEvent.propForm_onmousedown(a)},this.objFormTableContainer.onmousedown=function(a){g_objPropFormEvent.propFormContainer_onmousedown(a)}}catch(a){dalert(a)}};
this.assignDrawFormTable=function(a,b,c,f){try{if(null!=this.objFormTableContainer){var d=this.drawFormTable(a,b,c,f);this.objFormTableContainer.innerHTML=d;this.objFormTable=g_objLayerKit.getElementById("propFormTable")}}catch(e){dalert(e)}};this.getFormDrawType=function(){try{if(20==this.nDrawMaxCol)return this.ID_DRAW_TYPE_20_COL;if(100==this.nDrawMaxCol)return this.ID_DRAW_TYPE_100_COL}catch(a){dalert(a)}return-1};this.setFormDrawType=function(a){try{a==this.ID_DRAW_TYPE_20_COL?(this.nDrawMaxRow=
30,this.nDrawCellHeight=this.nDrawCellWidth=this.nDrawMaxCol=20,g_objPropFormCode.nBasisHeight=25):a==this.ID_DRAW_TYPE_100_COL&&(this.nDrawMaxRow=80,this.nDrawMaxCol=100,this.nDrawCellHeight=this.nDrawCellWidth=6,g_objPropFormCode.nBasisHeight=14)}catch(b){dalert(b)}};this.applyGenerateFormCode=function(a,b,c){try{if(this.objTableInfo){g_objTableUtil.removeTableColGroupAll(this.objTableInfo);var f=g_objNodeUtil.getLoopChildNodeByTagName(this.objTableInfo,"tbody");if(f)this.objTableInfo.removeChild(f);
else for(;;)if(0<this.objTableInfo.rows.length)this.objTableInfo.deleteRow(0);else break;var d=a.codeTable,e=g_objNodeUtil.getLoopChildNodeByTagName(d,"colgroup");for(null!=e&&c&&this.objTableInfo.appendChild(e);;)if(0<d.rows.length){var g=g_objTableUtil.getTableRowElement(d,0);this.objTableInfo.appendChild(g)}else break}else if(g_objInsertUtil.insertTableCodeAtSelection(a.htmlCode,g_nActiveEditNumber),this.objTableInfo=g_objEditorDocument[g_nActiveEditNumber].getElementById(b))this.objTableInfo.removeAttribute("id"),
c||g_objTableUtil.removeTableColGroupAll(this.objTableInfo)}catch(h){dalert(h)}};this.doApplyGenerateFormCode=function(){try{var a="newFormTable_"+g_objCommonUtil.getTimeCodeString(),b=g_objPropFormCode.generateFormCode(a,this.bNewCreate);null!=b&&this.applyGenerateFormCode(b,a,this.bGenerateColGroup)}catch(c){dalert(c)}};this.hidePropForm=function(){try{g_objPropFormEvent.hideAllAreaRectangle(),this.bShowPropForm=!1}catch(a){dalert(a)}};this.dummyAnchorFocus=function(){try{var a=g_objLayerKit.getLayerDocument().createElement("a");
a.href="";this.objFormTableContainer.appendChild(a);a.style.display="";a.focus();a.style.display="none"}catch(b){dalert(b)}}};

var g_objPropFormEvent=new function(){this.arrEventPosInfo=this.objEventPosInfo=null;this.strSelectedColor="#ffffff";this.strGroupColor="#c0c0c0";this.nCurResizeIndex=this.nMoveIndex=-1;this.ID_SELECTED_COLOR=0;this.ID_GROUP_COLOR=1;this.ID_REMOVE_COLOR=2;this.resetFormInfo=function(){try{null!=this.arrEventPosInfo&&this.hideAllAreaRectangle(),this.arrEventPosInfo=[],this.objEventPosInfo=null}catch(a){dalert(a)}};this.newEventPosInfo=function(){try{var a={nStartClient_X:null,nStartClient_Y:null,bApplyEvent:!1,
nStartRow:-1,nStartCol:-1,nEndRow:-1,nEndCol:-1,objOutlineUtil:null,nDragEventRow:-1,nDragEventCol:-1,nDragStartRow:-1,nDragStartCol:-1,nDragEndRow:-1,nDragEndCol:-1,bSelectedDown:!1,bDummyCell:!1,objDataCell:{}};a.objDataCell.innerHTML="";a.objDataCell.bChangeHeight=!0;a.objDataCell.width="";a.objDataCell.height="";a.objDataCell.align="";a.objDataCell.bgcolor="";a.objDataCell.arrBorderValue=null;a.objDataCell.strStyleString="";return a}catch(b){dalert(b)}};this.addDataPosInfo=function(a,b,c,d,e,
f){try{c=a+c-1;d=b+d-1;var h=this.newEventPosInfo();h.nStartRow=a;h.nStartCol=b;h.nEndRow=c;h.nEndCol=d;h.objDataCell.innerHTML=e.innerHTML;h.objDataCell.bChangeHeight=!1;h.objDataCell.height=f;var k=e.getAttribute("align");h.objDataCell.align=null==k||""==k?"":k;var g=e.getAttribute("bgcolor");h.objDataCell.bgcolor=null==g||""==g?"":g;h.objDataCell.arrBorderValue=g_objPropertyUtil.getElementBorderStyleAttributeSet(e,g_nActiveEditNumber);h.objDataCell.strStyleString=g_objPropertyUtil.getStyleStringByOption(e,
!0,!0);this.initEventPosInfo(h,a,b,c,d);h.objOutlineUtil.setExtOutlineBorder(h.objDataCell.arrBorderValue);var l=this.getSelectedBackgroundColor(h);this.setAreaBackgroundColor(a,b,c,d,l);var p=this.arrEventPosInfo.length;this.arrEventPosInfo[p]=h;return p}catch(m){dalert(m)}return null};this.initEventPosInfo=function(a,b,c,d,e){try{a.nStartRow=b;a.nStartCol=c;a.nEndRow=d;a.nEndCol=e;var f=new outlineUtil;f.initializeExtOutline(!0);f.setZIndexExtOutline(20031);f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].onmousedown=
function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.LEFT_TOP,a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.RIGHT_TOP,a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.RIGHT_BOTTOM,a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].onmousedown=
function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.LEFT_BOTTOM,a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.TOP,a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.RIGHT,a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.BOTTOM,
a)};f.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].onmousedown=function(a){g_objPropFormEventResize.outlineRectangle_onmousedown(OUTLINE_INDICATOR.LEFT,a)};a.objOutlineUtil=f}catch(h){dalert(h)}};this.getEventPosInfo=function(a){try{var b=g_objNodeUtil.getEventSrcElement(a),c=g_objNodeUtil.getElementTagName(b).toLowerCase();if("td"!=c&&"th"!=c)return null;var d=b.getAttribute("posRow");if(fnObjectCheckNull(d))return null;var e=b.getAttribute("posCol");if(fnObjectCheckNull(e))return null;d=parseInt(d);
e=parseInt(e);return{posRow:d,posCol:e}}catch(f){dalert(f)}return null};this.propFormContainer_onmousedown=function(a){try{null==this.getEventPosInfo(a)&&g_objPropFormKeyCode.keyDownEscape(a)}catch(b){dalert(b)}};this.propForm_onmousedown=function(a){try{var b=this.getEventPosInfo(a);if(null!=b)if(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a),g_objPropFormKeyCode.bCtrlKeyDown){var c=this.checkInnerArea(b.posRow,b.posCol);if(-1!=c){if(-1!=this.nMoveIndex){var d=
this.arrEventPosInfo[this.nMoveIndex];this.displayAreaRectangle(d.nStartRow,d.nStartCol,d.nEndRow,d.nEndCol,d.objOutlineUtil,!1,!0);this.nMoveIndex=-1}d=this.arrEventPosInfo[c];if(d.bSelectedDown){d.bSelectedDown=!1;var e=this.getSelectedBackgroundColor(d);this.setAreaBackgroundColor(d.nStartRow,d.nStartCol,d.nEndRow,d.nEndCol,e)}else d.bSelectedDown=!0,this.setAreaBackgroundColor(d.nStartRow,d.nStartCol,d.nEndRow,d.nEndCol,this.strGroupColor);g_objPropFormSink.updatePropFormUI()}}else g_objPropFormKeyCode.bShiftKeyDown?
-1==this.nCurResizeIndex||this.checkGroupSelected()||(c=this.checkInnerArea(b.posRow,b.posCol),-1!=c&&(this.arrEventPosInfo[this.nCurResizeIndex].bSelectedDown=!0,this.nCurResizeIndex=-1,this.arrEventPosInfo[c].bSelectedDown=!0,this.setSelectGroupInnerArea(),g_objPropFormSink.updatePropFormUI())):(e=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,b.posRow,b.posCol).style.backgroundColor,null==e||""==e?(this.showAllAreaRectangle(),this.setGroupAreaBackgroundColor(!0,this.ID_SELECTED_COLOR,
!1),g_objPropFormEventDraw.propForm_draw_onmousedown(a)):(c=this.checkInnerArea(b.posRow,b.posCol),-1!=c&&(this.arrEventPosInfo[c].bSelectedDown?(this.setGroupAreaBackgroundColor(!1,this.ID_SELECTED_COLOR,!1),g_objPropFormEventMove.propForm_move_onmousedown(a,b,c,!0)):(this.setGroupAreaBackgroundColor(!0,this.ID_SELECTED_COLOR,!1),g_objPropFormEventMove.propForm_move_onmousedown(a,b,c,!1)))))}catch(f){dalert(f)}};this.checkSelectedArea=function(a,b,c,d,e){try{var f=this.getAdjustAreaPosRowCol(a,b,
c,d);a=f.startRow;b=f.startCol;c=f.endRow;d=f.endCol;for(f=0;f<this.arrEventPosInfo.length;f++)if(f!=e){var h=this.arrEventPosInfo[f].nStartRow,k=this.arrEventPosInfo[f].nStartCol,g=this.arrEventPosInfo[f].nEndRow,l=this.arrEventPosInfo[f].nEndCol;if(h<=c&&c<=g&&k<=d&&d<=l||h<=c&&c<=g&&k<=b&&b<=l||h<=a&&a<=g&&k<=d&&d<=l||h<=a&&a<=g&&k<=b&&b<=l||h<=c&&c<=g&&b<=k&&l<=d||h<=a&&a<=g&&b<=k&&l<=d||a<=h&&g<=c&&k<=d&&d<=l||a<=h&&g<=c&&k<=b&&b<=l||a<=h&&g<=c&&b<=k&&l<=d)return!0}return!1}catch(p){dalert(p)}return!0};
this.checkGroupSelectedArea=function(a,b){try{for(var c=0;c<this.arrEventPosInfo.length;c++)if(this.arrEventPosInfo[c].bSelectedDown){var d=this.arrEventPosInfo[c];if(this.checkCellAreaBackgroundColor(d.nStartRow+a,d.nStartCol+b,d.nEndRow+a,d.nEndCol+b))return!0}return!1}catch(e){dalert(e)}return!0};this.checkCellAreaBackgroundColor=function(a,b,c,d){try{for(;a<=c;a++)for(var e=b;e<=d;e++){var f=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,a,e).style.backgroundColor;if(null!=f&&""!=
f)return!0}return!1}catch(h){dalert(h)}return!0};this.displayGroupAreaRectangle=function(a,b){try{for(var c=0;c<this.arrEventPosInfo.length;c++)if(this.arrEventPosInfo[c].bSelectedDown){var d=this.arrEventPosInfo[c];this.displayAreaRectangle(d.nStartRow+a,d.nStartCol+b,d.nEndRow+a,d.nEndCol+b,d.objOutlineUtil,!1,!0)}}catch(e){dalert(e)}};this.displayAreaRectangle=function(a,b,c,d,e,f,h){try{if(null!=e){var k=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,a,b),g=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,
c,d),l=g_objPositionUtil.getElementPosition(k,dzeEnvConfig.iFrameLayer),p=g_objPositionUtil.getElementPosition(g,dzeEnvConfig.iFrameLayer),m=l.left<p.left?l.left:p.left,n=l.top<p.top?l.top:p.top,q=l.right<p.right?p.right:l.right,r=l.bottom<p.bottom?p.bottom:l.bottom;f?e.showExtOutline(!0,!0,!1,m,n,q,r,!0,!0):(h&&(this.nCurResizeIndex=-1),e.showExtOutline(!0,!1,!1,m,n,q,r,!1,!1))}}catch(t){dalert(t)}};this.convertAreaRectangle=function(){try{var a=this.getAreaPosRowCol();this.setAreaBackgroundColor(a.startRow,
a.startCol,a.endRow,a.endCol,this.strSelectedColor);this.objEventPosInfo.nStartRow=a.startRow;this.objEventPosInfo.nStartCol=a.startCol;this.objEventPosInfo.nEndRow=a.endRow;this.objEventPosInfo.nEndCol=a.endCol}catch(b){dalert(b)}};this.setAreaBackgroundColor=function(a,b,c,d,e){try{for(;a<=c;a++)for(var f=b;f<=d;f++)g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,a,f).style.backgroundColor=e}catch(h){dalert(h)}};this.getAreaPosRowCol=function(){try{var a=this.getAdjustAreaPosRowCol(this.objEventPosInfo.nStartRow,
this.objEventPosInfo.nStartCol,this.objEventPosInfo.nEndRow,this.objEventPosInfo.nEndCol);return{startRow:a.startRow,startCol:a.startCol,endRow:a.endRow,endCol:a.endCol}}catch(b){dalert(b)}return null};this.getAdjustAreaPosRowCol=function(a,b,c,d){try{var e=-1,f=-1,h=-1,k=-1;a<c?(e=a,h=c):(e=c,h=a);b<d?(f=b,k=d):(f=d,k=b);return{startRow:e,startCol:f,endRow:h,endCol:k}}catch(g){dalert(g)}return null};this.showAllAreaRectangle=function(){try{for(var a=0;a<this.arrEventPosInfo.length;a++)this.displayAreaRectangle(this.arrEventPosInfo[a].nStartRow,
this.arrEventPosInfo[a].nStartCol,this.arrEventPosInfo[a].nEndRow,this.arrEventPosInfo[a].nEndCol,this.arrEventPosInfo[a].objOutlineUtil,!1,!0)}catch(b){dalert(b)}};this.hideAllAreaRectangle=function(){try{if(null!=this.arrEventPosInfo)for(var a=0;a<this.arrEventPosInfo.length;a++)this.arrEventPosInfo[a].objOutlineUtil.showExtOutline(!1,!1,!1,0,0,0,0,!1,!1)}catch(b){dalert(b)}};this.setGroupAreaBackgroundColor=function(a,b,c){try{for(var d=0;d<this.arrEventPosInfo.length;d++)if(this.arrEventPosInfo[d].bSelectedDown){a&&
(this.arrEventPosInfo[d].bSelectedDown=!1);var e=this.arrEventPosInfo[d].nStartRow,f=this.arrEventPosInfo[d].nStartCol,h=this.arrEventPosInfo[d].nEndRow,k=this.arrEventPosInfo[d].nEndCol,g="";this.ID_SELECTED_COLOR==b?g=this.getSelectedBackgroundColor(this.arrEventPosInfo[d]):this.ID_GROUP_COLOR==b&&(g=this.strGroupColor);this.setAreaBackgroundColor(e,f,h,k,g);c&&(this.arrEventPosInfo[d].nDragStartRow=-1,this.arrEventPosInfo[d].nDragStartCol=-1,this.arrEventPosInfo[d].nDragEndRow=-1,this.arrEventPosInfo[d].nDragEndCol=
-1)}}catch(l){dalert(l)}};this.checkInnerArea=function(a,b){try{for(var c=0;c<this.arrEventPosInfo.length;c++){var d=this.arrEventPosInfo[c].nStartCol,e=this.arrEventPosInfo[c].nEndRow,f=this.arrEventPosInfo[c].nEndCol;if(this.arrEventPosInfo[c].nStartRow<=a&&a<=e&&d<=b&&b<=f)return c}}catch(h){dalert(h)}return-1};this.checkAvailablePasteArea=function(a,b,c,d){try{var e=c-a+1,f=a+e;for(c+=e;!(c>g_objPropForm.nDrawMaxRow-1);){if(0==this.checkCellAreaBackgroundColor(f,b,c,d))return e=f-a,{posStartRow:f,
posStartCol:b,posEndRow:c,posEndCol:d,diffRow:e};f++;c++}}catch(h){dalert(h)}return null};this.checkAreaMinMax=function(a,b,c,d){try{return 0>a||0>b||c>g_objPropForm.nDrawMaxRow-1||d>g_objPropForm.nDrawMaxCol-1?!1:!0}catch(e){dalert(e)}};this.checkGroupSelected=function(){try{for(var a=0;a<this.arrEventPosInfo.length;a++)if(this.arrEventPosInfo[a].bSelectedDown)return!0}catch(b){dalert(b)}return!1};this.setSelectGroupInnerArea=function(){try{for(var a=-1,b=-1,c=-1,d=-1,e=0;e<this.arrEventPosInfo.length;e++)if(this.arrEventPosInfo[e].bSelectedDown){var f=
this.arrEventPosInfo[e].nStartRow,h=this.arrEventPosInfo[e].nStartCol,k=this.arrEventPosInfo[e].nEndRow,g=this.arrEventPosInfo[e].nEndCol,l=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,f,h),p=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,k,g),m=g_objPositionUtil.getElementPosition(l,!1),n=g_objPositionUtil.getElementPosition(p,!1),q=m.left<n.left?m.left:n.left,r=m.top<n.top?m.top:n.top,t=m.right<n.right?n.right:m.right,u=m.bottom<n.bottom?n.bottom:m.bottom;-1==a?(a=
q,b=r,c=t,d=u):(a>q&&(a=q),b>r&&(b=r),c<t&&(c=t),d<u&&(d=u))}for(e=0;e<this.arrEventPosInfo.length;e++)this.arrEventPosInfo[e].bSelectedDown||(f=this.arrEventPosInfo[e].nStartRow,h=this.arrEventPosInfo[e].nStartCol,k=this.arrEventPosInfo[e].nEndRow,g=this.arrEventPosInfo[e].nEndCol,l=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,f,h),p=g_objTableUtil.getTableCellElement(g_objPropForm.objFormTable,k,g),m=g_objPositionUtil.getElementPosition(l,!1),n=g_objPositionUtil.getElementPosition(p,
!1),q=m.left<n.left?m.left:n.left,r=m.top<n.top?m.top:n.top,t=m.right<n.right?n.right:m.right,u=m.bottom<n.bottom?n.bottom:m.bottom,a<=q&&b<=r&&c>=t&&d>=u&&(this.arrEventPosInfo[e].bSelectedDown=!0));this.showAllAreaRectangle();this.setGroupAreaBackgroundColor(!1,this.ID_GROUP_COLOR,!1)}catch(v){dalert(v)}};this.getSelectedBackgroundColor=function(a){try{if(null==a.objDataCell)return this.strSelectedColor;var b=a.objDataCell.bgcolor;return null==b||""==b||"undefined"==b?this.strSelectedColor:b}catch(c){dalert(c)}return this.strSelectedColor};
this.getFormBackgroundColor=function(a){try{return this.arrEventPosInfo[a].objDataCell.bgcolor}catch(b){dalert(b)}return""};this.getFormGroupBackgroundColor=function(){try{for(var a=!0,b="",c=0;c<this.arrEventPosInfo.length;c++)if(this.arrEventPosInfo[c].bSelectedDown){var d=this.getFormBackgroundColor(c);a&&(a=!1,b=d);if(b!=d)return""}return b}catch(e){dalert(e)}return""};this.setFormBackgroundColor=function(a,b){try{var c=this.arrEventPosInfo[a];this.setAreaBackgroundColor(c.nStartRow,c.nStartCol,
c.nEndRow,c.nEndCol,b);c.objDataCell.bgcolor=b}catch(d){dalert(d)}};this.setFormGroupBackgroundColor=function(a){try{for(var b=0;b<this.arrEventPosInfo.length;b++)this.arrEventPosInfo[b].bSelectedDown&&this.setFormBackgroundColor(b,a)}catch(c){dalert(c)}};this.getFormBorderValue=function(a){try{var b="",c="",d="",e=!0,f=!0,h=!0,k=!0,g=this.arrEventPosInfo[a].objDataCell.arrBorderValue;g[0]==g[3]&&g[0]==g[6]&&g[0]==g[9]&&(b=g[0]);g[1]==g[4]&&g[1]==g[7]&&g[1]==g[10]&&(c=g[1]);g[2]==g[5]&&g[2]==g[8]&&
g[2]==g[11]&&(d=g[2]);""==g[0]&&(e=!1);""==g[3]&&(f=!1);""==g[6]&&(h=!1);""==g[9]&&(k=!1);return{borderWidth:b,borderStyle:c,borderColor:d,borderApplyLeft:e,borderApplyTop:f,borderApplyRight:h,borderApplyBottom:k}}catch(l){dalert(l)}return{borderWidth:"",borderStyle:"",borderColor:"",borderApplyLeft:!1,borderApplyTop:!1,borderApplyRight:!1,borderApplyBottom:!1}};this.getFormGroupBorderValue=function(){try{for(var a=!0,b=!1,c=!1,d=!1,e="",f="",h="",k=0;k<this.arrEventPosInfo.length;k++)if(this.arrEventPosInfo[k].bSelectedDown){var g=
this.getFormBorderValue(k);a&&(a=!1,e=g.borderWidth,f=g.borderStyle,h=g.borderColor);e!=g.borderWidth&&(b=!0);f!=g.borderStyle&&(c=!0);h!=g.borderColor&&(d=!0)}b&&(e="");c&&(f="");d&&(h="");return{borderWidth:e,borderStyle:f,borderColor:h}}catch(l){dalert(l)}return{borderWidth:"",borderStyle:"",borderColor:""}};this.setFormBorderValue=function(a,b){try{a.objDataCell.arrBorderValue=b,a.objOutlineUtil.setExtOutlineBorder(b)}catch(c){dalert(c)}};this.setFormGroupBorderValue=function(a){try{for(var b=
0;b<this.arrEventPosInfo.length;b++)this.arrEventPosInfo[b].bSelectedDown&&this.setFormBorderValue(this.arrEventPosInfo[b],a)}catch(c){dalert(c)}};this.copyEventPosInfo=function(a,b){try{b.objDataCell.innerHTML=a.objDataCell.innerHTML,b.objDataCell.align=a.objDataCell.align,b.objDataCell.bgcolor=a.objDataCell.bgcolor,this.setFormBorderValue(b,a.objDataCell.arrBorderValue),b.objDataCell.strStyleString=a.objDataCell.strStyleString,b.objDataCell.bChangeHeight=a.objDataCell.bChangeHeight,b.objDataCell.height=
a.objDataCell.height}catch(c){dalert(c)}}};

var g_objPropFormEventDraw=new function(){var f=this;this.propForm_draw_onmousedown=function(b){try{var a=g_objPropFormEvent.getEventPosInfo(b);if(null!=a){g_objPropFormEvent.objEventPosInfo=g_objPropFormEvent.newEventPosInfo();var c=null;c=dzeEnvConfig.iFrameLayer?g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(b):g_objPositionUtil.GetDocumentClientPos_XY(b);g_objPropFormEvent.objEventPosInfo.nStartClient_X=c.nPos_X;g_objPropFormEvent.objEventPosInfo.nStartClient_Y=c.nPos_Y;g_objPropFormEvent.initEventPosInfo(g_objPropFormEvent.objEventPosInfo,
a.posRow,a.posCol,-1,-1);var d=g_objPropFormSink.getFormUIBorderValue();g_objPropFormEvent.objEventPosInfo.objDataCell.arrBorderValue=d;g_objPropFormEvent.objEventPosInfo.objOutlineUtil.setExtOutlineBorder(d);window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousemove",this.propForm_draw_onmousemove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",this.propForm_draw_onmouseup)):(g_objLayerKit.getLayerDocument().addEventListener("mousemove",this.propForm_draw_onmousemove,
!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",this.propForm_draw_onmouseup,!1))}}catch(e){dalert(e)}};this.propForm_draw_onmousemove=function(b){try{var a=g_objPropFormEvent.getEventPosInfo(b);if(null!=a){var c=g_objPropFormEvent.objEventPosInfo.nStartRow,d=g_objPropFormEvent.objEventPosInfo.nStartCol;if(g_objPropFormEvent.checkSelectedArea(c,d,a.posRow,a.posCol,-1))g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed";else{g_objLayerKit.getLayerDocument().body.style.cursor=
"default";var e=null;e=dzeEnvConfig.iFrameLayer?g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(b):g_objPositionUtil.GetDocumentClientPos_XY(b);if(g_objPropFormEvent.objEventPosInfo.nStartClient_X!=e.nPos_X||g_objPropFormEvent.objEventPosInfo.nStartClient_Y!=e.nPos_Y)g_objPropFormEvent.objEventPosInfo.nEndRow=a.posRow,g_objPropFormEvent.objEventPosInfo.nEndCol=a.posCol,g_objPropFormEvent.displayAreaRectangle(c,d,g_objPropFormEvent.objEventPosInfo.nEndRow,g_objPropFormEvent.objEventPosInfo.nEndCol,
g_objPropFormEvent.objEventPosInfo.objOutlineUtil,!1,!0),g_objPropFormEvent.objEventPosInfo.bApplyEvent=!0}}}catch(g){dalert(g)}};this.propForm_draw_onmouseup=function(b){try{g_objLayerKit.getLayerDocument().body.style.cursor="default",window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousemove",f.propForm_draw_onmousemove),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",f.propForm_draw_onmouseup)):(g_objLayerKit.getLayerDocument().removeEventListener("mousemove",f.propForm_draw_onmousemove,
!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",f.propForm_draw_onmouseup,!1)),g_objPropFormEvent.objEventPosInfo.bApplyEvent&&(g_objPropFormEvent.convertAreaRectangle(),g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.arrEventPosInfo.length]=g_objPropFormEvent.objEventPosInfo,g_objPropFormEvent.objEventPosInfo=null),g_objPropFormSink.setAvailableButton(!1)}catch(a){dalert(a)}}};

var g_objPropFormEventMove=new function(){var f=this;this.bGroupMove=!1;this.propForm_move_onmousedown=function(e,a,b,d){try{this.bGroupMove=d;var g=g_objPropFormEvent.nMoveIndex;g_objPropFormEvent.nMoveIndex=b;if(-1!=g&&g!=g_objPropFormEvent.nMoveIndex){var c=g_objPropFormEvent.arrEventPosInfo[g];if(c){var f=c.objOutlineUtil;g_objPropFormEvent.displayAreaRectangle(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,f,!1,!0)}}if(-1!=g_objPropFormEvent.nMoveIndex){c=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex];
var k=c.nStartRow,l=c.nStartCol,m=c.nEndRow,n=c.nEndCol;c.nDragEventRow=a.posRow;c.nDragEventCol=a.posCol;c.nDragStartRow=-1;c.nDragStartCol=-1;c.nDragEndRow=-1;c.nDragEndCol=-1;f=c.objOutlineUtil;this.bGroupMove?(g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_REMOVE_COLOR,!0),g_objPropFormEvent.displayAreaRectangle(k,l,m,n,f,!1,!0)):(g_objPropFormEvent.nCurResizeIndex=b,g_objPropFormEvent.setAreaBackgroundColor(k,l,m,n,""),g_objPropFormEvent.displayAreaRectangle(k,l,m,n,
f,!0,!0));window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousemove",this.propForm_move_onmousemove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",this.propForm_move_onmouseup)):(g_objLayerKit.getLayerDocument().addEventListener("mousemove",this.propForm_move_onmousemove,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",this.propForm_move_onmouseup,!1))}}catch(p){dalert(p)}};this.propForm_move_onmousemove=function(e){try{if(-1!=g_objPropFormEvent.nMoveIndex){var a=
g_objPropFormEvent.getEventPosInfo(e);if(null!=a){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex],d=a.posRow-b.nDragEventRow,g=a.posCol-b.nDragEventCol,c=a=e=-1,h=-1;if(f.bGroupMove){if(!f.checkGroupStartEndPos(d,g))return}else if(e=b.nStartRow+d,a=b.nStartCol+g,c=b.nEndRow+d,h=b.nEndCol+g,!g_objPropFormEvent.checkAreaMinMax(e,a,c,h))return;if(f.bGroupMove){if(g_objPropFormEvent.checkGroupSelectedArea(d,g)){g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed";return}}else if(g_objPropFormEvent.checkSelectedArea(e,
a,c,h,g_objPropFormEvent.nMoveIndex)){g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed";return}g_objLayerKit.getLayerDocument().body.style.cursor="default";f.bGroupMove?(g_objPropFormEvent.displayGroupAreaRectangle(d,g),f.setGroupDragInfo_move(d,g)):(g_objPropFormEvent.displayAreaRectangle(e,a,c,h,b.objOutlineUtil,!1,!0),b.nDragStartRow=e,b.nDragStartCol=a,b.nDragEndRow=c,b.nDragEndCol=h)}}}catch(k){dalert(k)}};this.propForm_move_onmouseup=function(e){try{g_objLayerKit.getLayerDocument().body.style.cursor=
"default";window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousemove",f.propForm_move_onmousemove),g_objLayerKit.getLayerDocument().detachEvent("onmouseup",f.propForm_move_onmouseup)):(g_objLayerKit.getLayerDocument().removeEventListener("mousemove",f.propForm_move_onmousemove,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",f.propForm_move_onmouseup,!1));if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex];
-1!=a.nDragStartRow&&-1!=a.nDragStartCol&&(f.bGroupMove?f.setGroupDragInfo_up():(a.nStartRow=a.nDragStartRow,a.nStartCol=a.nDragStartCol,a.nEndRow=a.nDragEndRow,a.nEndCol=a.nDragEndCol));if(f.bGroupMove)g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_GROUP_COLOR,!1);else{var b=g_objPropFormEvent.getSelectedBackgroundColor(a);g_objPropFormEvent.setAreaBackgroundColor(a.nStartRow,a.nStartCol,a.nEndRow,a.nEndCol,b)}}g_objPropFormSink.updatePropFormUI()}catch(d){dalert(d)}};this.checkGroupStartEndPos=
function(e,a){try{for(var b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)if(g_objPropFormEvent.arrEventPosInfo[b].bSelectedDown){var d=g_objPropFormEvent.arrEventPosInfo[b];if(!g_objPropFormEvent.checkAreaMinMax(d.nStartRow+e,d.nStartCol+a,d.nEndRow+e,d.nEndCol+a))return!1}return!0}catch(g){dalert(g)}return!1};this.setGroupDragInfo_move=function(e,a){try{for(var b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)if(g_objPropFormEvent.arrEventPosInfo[b].bSelectedDown){var d=g_objPropFormEvent.arrEventPosInfo[b],
f=d.nStartCol+a,c=d.nEndRow+e,h=d.nEndCol+a;d.nDragStartRow=d.nStartRow+e;d.nDragStartCol=f;d.nDragEndRow=c;d.nDragEndCol=h}}catch(k){dalert(k)}};this.setGroupDragInfo_up=function(){try{for(var e=0;e<g_objPropFormEvent.arrEventPosInfo.length;e++)if(g_objPropFormEvent.arrEventPosInfo[e].bSelectedDown){var a=g_objPropFormEvent.arrEventPosInfo[e];a.nStartRow=a.nDragStartRow;a.nStartCol=a.nDragStartCol;a.nEndRow=a.nDragEndRow;a.nEndCol=a.nDragEndCol}}catch(b){dalert(b)}}};

var g_objPropFormEventResize=new function(){var c=this;this.nOutlineRectangleNumber=-1;this.outlineRectangle_onmousedown=function(d,a){try{dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a),-1!=g_objPropFormEvent.nMoveIndex&&(this.nOutlineRectangleNumber=d,g_objPropFormEvent.setAreaBackgroundColor(g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nStartRow,g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nStartCol,g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nEndRow,
g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex].nEndCol,""),window.attachEvent?(g_objLayerKit.getLayerDocument().attachEvent("onmousemove",c.outlineRectangle_onmousemove),g_objLayerKit.getLayerDocument().attachEvent("onmouseup",c.outlineRectangle_onmouseup)):(g_objLayerKit.getLayerDocument().addEventListener("mousemove",c.outlineRectangle_onmousemove,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",c.outlineRectangle_onmouseup,!1)))}catch(b){dalert(b)}};this.outlineRectangle_onmousemove=
function(d){try{if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.getEventPosInfo(d);if(null!=a){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex],e=b.nStartRow,h=b.nStartCol,f=b.nEndRow,g=b.nEndCol,k=d=!1;(2==c.nOutlineRectangleNumber||6==c.nOutlineRectangleNumber)&&e<a.posRow+1&&a.posRow!=b.nEndRow&&(f=a.posRow,d=!0);(2==c.nOutlineRectangleNumber||5==c.nOutlineRectangleNumber)&&h<a.posCol+1&&a.posCol!=b.nEndCol&&(g=a.posCol,k=!0);g_objPropFormEvent.checkSelectedArea(e,
h,f,g,g_objPropFormEvent.nMoveIndex)?g_objLayerKit.getLayerDocument().body.style.cursor="not-allowed":(g_objLayerKit.getLayerDocument().body.style.cursor="default",d&&(b.nEndRow=f),k&&(b.nEndCol=g),(d||k)&&g_objPropFormEvent.displayAreaRectangle(e,h,f,g,b.objOutlineUtil,!0,!0))}}}catch(l){dalert(l)}};this.outlineRectangle_onmouseup=function(d){try{g_objLayerKit.getLayerDocument().body.style.cursor="default";window.detachEvent?(g_objLayerKit.getLayerDocument().detachEvent("onmousemove",c.outlineRectangle_onmousemove),
g_objLayerKit.getLayerDocument().detachEvent("onmouseup",c.outlineRectangle_onmouseup)):(g_objLayerKit.getLayerDocument().removeEventListener("mousemove",c.outlineRectangle_onmousemove,!1),g_objLayerKit.getLayerDocument().removeEventListener("mouseup",c.outlineRectangle_onmouseup,!1));if(-1!=g_objPropFormEvent.nMoveIndex){var a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nMoveIndex];a.objDataCell.bChangeHeight=!0;var b=g_objPropFormEvent.getSelectedBackgroundColor(a);g_objPropFormEvent.setAreaBackgroundColor(a.nStartRow,
a.nStartCol,a.nEndRow,a.nEndCol,b)}g_objPropFormSink.updatePropFormUI()}catch(e){dalert(e)}}};

var g_objPropFormCode=new function(){this.indexFlagName="cusIndex";this.cusFlagName="cusFlag";this.nBasisWidth=100;this.nBasisHeight=25;this.strDummyCellClassName="dummyCell";this.generateFormCode=function(c,f){try{var a=this.getEventPosMaxRowColCount();if(null==a)return null;var d=g_objPropFormLoad.createSimpleFlag(a.maxRow+1,a.maxCol+1);if(null==d)return!1;for(var b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){var e=g_objPropFormEvent.arrEventPosInfo[b],g=e.nStartRow,k=e.nStartCol,h=e.nEndRow,
l=e.nEndCol;g_objPropFormLoad.setSimpleFlagPos(d,g,k,h-g+1,l-k+1,b)}var n=this.getDummyCellArray(d,a.maxRow+1,a.maxCol+1);if(null==n)return null;this.operateDummyCellArrayWithEventPosInfoArray(n,!0);var p=this.makeFormCode(a.maxRow+1,a.maxCol+1),m=document.createElement("div");m.innerHTML=p;a=null;"table"==m.childNodes[0].nodeName.toLowerCase()&&(a=m.childNodes[0]);if(null!=a){a.id=c;for(b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)e=g_objPropFormEvent.arrEventPosInfo[b],g=e.nStartRow,k=e.nStartCol,
h=e.nEndRow,l=e.nEndCol,this.prepareTargetCellFlag(b,a,g,k,h,l);var q=g_objPropFormSink.objCheck_KeepHeight.checked?!0:!1;for(b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++)this.convertTargetCellFlag(b,a),this.simpleMergeCell(b,a,q);this.adjustRowSpan(a);this.adjustColSpan(a);this.mappingContent(a,f);this.releaseTargetCellFlag(a);this.operateDummyCellArrayWithEventPosInfoArray(n,!1);return{htmlCode:m.innerHTML,codeTable:a}}}catch(r){dalert(r)}};this.getFormCodeWidthHeight=function(){try{return{unitWidth:parseInt(this.nBasisWidth/
g_objPropForm.nDrawMaxCol),unitHeight:this.nBasisHeight}}catch(c){dalert(c)}};this.getBasisHeight=function(){try{return this.nBasisHeight}catch(c){dalert(c)}};this.setBasisHeight=function(c){try{this.nBasisHeight=c}catch(f){dalert(f)}};this.getEventPosMaxRowColCount=function(){try{for(var c=-1,f=-1,a=0;a<g_objPropFormEvent.arrEventPosInfo.length;a++){var d=g_objPropFormEvent.arrEventPosInfo[a],b=d.nEndRow,e=d.nEndCol;b>c&&(c=b);e>f&&(f=e)}return{maxRow:c,maxCol:f}}catch(g){dalert(g)}return null};
this.getDummyCellArray=function(c,f,a){try{for(var d=[],b=!1,e=-1,g=-1,k=-1,h=-1,l=0;l<f;l++){for(var n=0;n<a;n++){var p=c[l][n];b?-1==p?n==h+1&&(h=n):(d.push([e,g,k,h]),b=!1,h=k=g=e=-1):-1==p&&(b=!0,e=l,g=n,k=l,h=n)}-1!=e&&d.push([e,g,k,h]);b=!1;h=k=g=e=-1}return this.mergeDummyCellArray(d)?d:null}catch(m){dalert(m)}return null};this.mergeDummyCellArray=function(c){try{for(var f=0;!(c.length<=f);)this.compareDummyCellArray(c,f)||f++;return!0}catch(a){dalert(a)}return!1};this.compareDummyCellArray=
function(c,f){try{for(var a=-1,d=c[f][1],b=c[f][2],e=c[f][3],g=f+1;g<c.length;g++)if(b+1==c[g][2]&&d==c[g][1]&&e==c[g][3]){a=g;break}if(-1==a)return!1;c[f][2]=b+1;c.splice(a,1);return!0}catch(k){dalert(k)}return!1};this.operateDummyCellArrayWithEventPosInfoArray=function(c,f){try{if(f)for(var a=0;a<c.length;a++){var d=c[a][0],b=c[a][1],e=c[a][2],g=c[a][3],k=g_objPropFormEvent.newEventPosInfo();k.nStartRow=d;k.nStartCol=b;k.nEndRow=e;k.nEndCol=g;k.bDummyCell=!0;g_objPropFormEvent.arrEventPosInfo.push(k)}else for(a=
0;a<g_objPropFormEvent.arrEventPosInfo.length;a++)k=g_objPropFormEvent.arrEventPosInfo[a],k.bDummyCell&&(g_objPropFormEvent.arrEventPosInfo.splice(a,1),a--)}catch(h){dalert(h)}};this.makeFormCode=function(c,f){try{var a=this.getFormCodeWidthHeight(),d=a.unitWidth+"%",b=a.unitHeight+"px";a="";a+='<table width="100%" cellpadding="0" cellspacing="0" style="font-size:9pt; border-collapse:collapse;">';a+="<colgroup>";for(var e=0;e<f;e++)a+='<col width="'+d+'" />';a+="</colgroup>";for(e=0;e<c;e++){a+="<tr>";
for(var g=0;g<f;g++)a+='<td width="'+d+'" height="'+b+'" style="border:0px;"></td>';a+="</tr>"}return a+"</table>"}catch(k){dalert(k)}};this.prepareTargetCellFlag=function(c,f,a,d,b,e){try{for(;a<=b;a++)for(var g=d;g<=e;g++){var k=g_objTableUtil.getTableCellElement(f,a,g);g_objPropertyUtil.setTargetCellFlag(k,this.indexFlagName,c)}}catch(h){dalert(h)}};this.convertTargetCellFlag=function(c,f){try{for(var a=!1,d=f.rows.length,b=0;b<d;b++)for(var e=g_objTableUtil.getTableCellsLength(f,b),g=0;g<e;g++){var k=
g_objTableUtil.getTableCellElement(f,b,g),h=g_objPropertyUtil.getTargetCellFlag(k,this.indexFlagName);null!=h&&c==h&&(a?g_objPropertyUtil.setTargetCellFlag(k,this.cusFlagName,3):(a=!0,g_objPropertyUtil.setTargetCellFlag(k,this.cusFlagName,2)))}}catch(l){dalert(l)}};this.simpleMergeCell=function(c,f,a){try{for(var d=-1,b=-1,e=0,g=0,k=f.rows.length,h=0;h<k;h++)for(var l=!0,n=g_objTableUtil.getTableCellsLength(f,h),p=0;p<n;p++){var m=g_objTableUtil.getTableCellElement(f,h,p),q=g_objPropertyUtil.getTargetCellFlag(m,
this.cusFlagName);null==q||2!=q&&3!=q&&4!=q||(2==q&&(d=h,b=p,m.removeAttribute(this.cusFlagName)),l&&h==d+e&&(l=!1,e+=m.rowSpan),h==d&&(g+=m.colSpan))}for(h=0;h<k;h++)for(p=0;p<g_objTableUtil.getTableCellsLength(f,h);p++)m=g_objTableUtil.getTableCellElement(f,h,p),q=g_objPropertyUtil.getTargetCellFlag(m,this.cusFlagName),null==q||3!=q&&4!=q||(g_objTableUtil.getTableRowElement(f,h).deleteCell(p),p=-1);var r=g_objPropFormEvent.arrEventPosInfo[c],t=this.getFormCodeWidthHeight();m=g_objTableUtil.getTableCellElement(f,
d,b);m.rowSpan=e;m.colSpan=g;m.width=t.unitWidth*g+"%";m.height=a?r.objDataCell.bChangeHeight?t.unitHeight*e:r.objDataCell.height:t.unitHeight*e;""!=r.objDataCell.strStyleString&&m.setAttribute("style",r.objDataCell.strStyleString);g_objPropertyUtil.setElementBorderStyleAttributeSet(m,r.objDataCell.arrBorderValue)}catch(u){dalert(u)}};this.adjustRowSpan=function(c){try{for(var f=g_objTableUtil.getTableMaxColSpanCount(c);;){for(var a=-1,d=c.rows.length,b=0;b<d;b++){var e=g_objTableUtil.getTableCellsLength(c,
b);if(0==e){a=b;break}}if(-1==a)break;var g=a-1,k=g_objTableUtil.getTableRowColSpanCount(c,g);if(f==k){if(1>=this.getTableRowMinRowSpanCount(c,g))break;e=g_objTableUtil.getTableCellsLength(c,g);for(var h=0;h<e;h++){var l=g_objTableUtil.getTableCellElement(c,g,h),n=l.rowSpan;l.rowSpan=n-1}}else{var p=null,m=null;e=g_objTableUtil.getTableCellsLength(c,g);for(h=0;h<e;h++)if(l=g_objTableUtil.getTableCellElement(c,g,h),p=g_objPropertyUtil.getTargetCellFlag(l,this.indexFlagName),null!=p){m=l;break}if(null==
p)break;var q=this.getRelatedPosIndexForRowSpan(p);if(null==q)break;if(0==q.length)break;var r=this.getTableCellArray(c,q);if(null==r)break;for(b=0;b<r.length;b++)if(1>=r[b].rowSpan)return;for(b=0;b<r.length;b++)n=r[b].rowSpan,r[b].rowSpan=n-1;n=m.rowSpan;m.rowSpan=n-1}c.deleteRow(a)}}catch(t){dalert(t)}};this.getTableRowMinRowSpanCount=function(c,f){try{var a=g_objTableUtil.getTableCellsLength(c,f);if(0==a)return 0;for(var d=9999,b=0;b<a;b++){var e=g_objTableUtil.getTableCellElement(c,f,b);e.rowSpan<
d&&(d=e.rowSpan)}return d}catch(g){dalert(g)}};this.releaseTargetCellFlag=function(c){try{for(var f=c.rows.length,a=0;a<f;a++)for(var d=g_objTableUtil.getTableCellsLength(c,a),b=0;b<d;b++)g_objTableUtil.getTableCellElement(c,a,b).removeAttribute(this.indexFlagName)}catch(e){dalert(e)}};this.getRelatedPosIndexForRowSpan=function(c){try{for(var f=[],a=g_objPropFormEvent.arrEventPosInfo[c].nStartRow,d=0;d<g_objPropFormEvent.arrEventPosInfo.length;d++)if(d!=c){var b=g_objPropFormEvent.arrEventPosInfo[d].nEndRow;
g_objPropFormEvent.arrEventPosInfo[d].nStartRow<=a&&a<b&&(f[f.length]=d)}return f}catch(e){dalert(e)}};this.getTableCellArray=function(c,f){try{for(var a=[],d=0;d<f.length;d++){var b=this.getTableCellByPosIndex(c,f[d]);if(null==b||1==b.rowSpan)return null;a[a.length]=b}return a}catch(e){dalert(e)}return null};this.getTableCellByPosIndex=function(c,f){try{for(var a=c.rows.length,d=0;d<a;d++)for(var b=g_objTableUtil.getTableCellsLength(c,d),e=0;e<b;e++){var g=g_objTableUtil.getTableCellElement(c,d,
e),k=g_objPropertyUtil.getTargetCellFlag(g,this.indexFlagName);if(f==k)return g}}catch(h){dalert(h)}return null};this.adjustColSpan=function(c){try{var f=c.rows.length;if(0!=f){var a=g_objNodeUtil.getLoopChildNodeByTagName(c,"colgroup");if(null!=a){for(var d=this.getFormCodeWidthHeight().unitWidth,b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){var e=g_objPropFormEvent.arrEventPosInfo[b].nStartCol,g=g_objPropFormEvent.arrEventPosInfo[b].nEndCol,k=this.getRelatedPosIndexForColSpan(!0,e,g);if(null==
k)return;if(0!=k.length){var h=this.getColNoWithinColGroup(a,d,e);if(null==h)return;var l=this.doAdjustColSpan(c,f,k,a,h,d);if(0==l)return}}for(b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){e=g_objPropFormEvent.arrEventPosInfo[b].nStartCol;g=g_objPropFormEvent.arrEventPosInfo[b].nEndCol;k=this.getRelatedPosIndexForColSpan(!1,e,g);if(null==k)break;if(0!=k.length){h=this.getColNoWithinColGroup(a,d,e);if(null==h)break;l=this.doAdjustColSpan(c,f,k,a,h,d);if(0==l)break}}}}}catch(n){dalert(n)}};
this.mappingContent=function(c,f){try{for(var a=0;a<g_objPropFormEvent.arrEventPosInfo.length;a++){var d=this.getTableCellByPosIndex(c,a);if(null!=d)if(g_objPropFormEvent.arrEventPosInfo[a].bDummyCell)d.className=this.strDummyCellClassName;else{var b=g_objPropFormEvent.arrEventPosInfo[a].objDataCell;null!=b&&(d.innerHTML=f?window.attachEvent?"<p>&nbsp;</p>":"<p><br /></p>":b.innerHTML,null!=b.align&&""!=b.align&&d.setAttribute("align",b.align),null!=b.bgcolor&&""!=b.bgcolor&&d.setAttribute("bgcolor",
b.bgcolor))}}}catch(e){dalert(e)}};this.doAdjustColSpan=function(c,f,a,d,b,e){try{for(;;){for(var g=!0,k=0,h=0;h<a.length;h++){var l=this.getTableCellByPosIndex(c,a[h]);if(null==l)return!1;if(1==l.colSpan){g=!1;break}k+=l.rowSpan}g&&k!=f&&(g=!1);if(!g)break;for(h=0;h<a.length;h++)l=this.getTableCellByPosIndex(c,a[h]),--l.colSpan;var n=g_objNodeUtil.getChildrenCollection(d),p=n[b].getAttribute("width"),m=g_objCommonUtil.extractNumberValueUnit(p);if(null==m)return!1;var q=parseInt(m.nValue)+parseInt(e)+
"%";n[b].setAttribute("width",q);d.removeChild(n[b+1])}return!0}catch(r){dalert(r)}return!1};this.getRelatedPosIndexForColSpan=function(c,f,a){try{for(var d=[],b=0;b<g_objPropFormEvent.arrEventPosInfo.length;b++){var e=g_objPropFormEvent.arrEventPosInfo[b].nStartCol,g=g_objPropFormEvent.arrEventPosInfo[b].nEndCol;c?f==e?d[d.length]=b:e<f&&a<=g&&(d[d.length]=b):e<f&&a==g?d[d.length]=b:f==e&&a==g&&(d[d.length]=b)}return d}catch(k){dalert(k)}return null};this.getColNoWithinColGroup=function(c,f,a){try{f*=
a;a=0;var d=g_objNodeUtil.getChildrenCollection(c);for(c=0;c<d.length;c++){var b=d[c].getAttribute("width"),e=g_objCommonUtil.extractNumberValueUnit(b);if(null==e)break;a+=parseInt(e.nValue);if(a>f)return c}}catch(g){dalert(g)}return null}};

var g_objPropFormLoad=new function(){this.prepareLoadFormStructure=function(a){try{if(null==a)return-1;var c=this.checkExistColGroupWidth(a);if(-1!=c){if(0==c){if(this.checkAllExistWidthPercentage(a))return this.getDrawTypeFromStructure(a);var b=this.convertLoadFormStructure(a);return b?this.getDrawTypeFromStructure(a):-1}if(1==c)return(b=this.mappingColGroupWidth(a))?this.getDrawTypeFromStructure(a):-1}}catch(e){dalert(e)}return-1};this.checkExistColGroupWidth=function(a){try{if(0==a.rows.length)return-1;
var c=g_objNodeUtil.getLoopChildNodeByTagName(a,"colgroup");if(null==c)return 0;var b=g_objTableUtil.getTableColGroupWidthValue(c);if(null==b)return-1;for(a=0;a<b.length;a++)if("%"!=b[a].strUnit)return 2;return 1}catch(e){dalert(e)}return-1};this.checkAllExistWidthPercentage=function(a){try{for(var c=a.rows.length,b=0;b<c;b++)for(var e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++){var g=g_objTableUtil.getTableCellElement(a,b,d),m=g_objNodeUtil.getNodeWidthHeight(g,!0);if(null==m.nValue||"%"!=
m.strUnit)return!1}return!0}catch(l){dalert(l)}return!1};this.mappingColGroupWidth=function(a){try{var c=a.rows.length;if(0==c)return!1;var b=g_objNodeUtil.getLoopChildNodeByTagName(a,"colgroup");if(null==b)return!1;var e=g_objTableUtil.getTableColGroupWidthValue(b);if(null==e)return!1;var d=g_objTableUtil.getTableMaxColSpanCount(a);if(0==d)return!1;var g=this.createSimpleFlag(c,d);if(null==g)return!1;for(d=b=0;d<c;d++)for(var m=g_objTableUtil.getTableCellsLength(a,d),l=0;l<m;l++){var f=g_objTableUtil.getTableCellElement(a,
d,l),h=f.rowSpan,p=f.colSpan,n=this.getSimpleFlagPos(g);this.setSimpleFlagPos(g,n.rowNo,n.colNo,h,p,b);var r=0;for(k=n.colNo;k<n.colNo+p;k++)r+=parseInt(e[k].nValue);f.style.removeAttribute?f.style.removeAttribute("width"):f.style.removeProperty&&f.style.removeProperty("width");f.setAttribute("width",r+"%");b++}return!0}catch(q){dalert(q)}return!1};this.getDrawTypeFromStructure=function(a){try{for(var c=a.rows.length,b=0;b<c;b++)for(var e=g_objTableUtil.getTableCellsLength(a,b),d=0;d<e;d++){var g=
g_objTableUtil.getTableCellElement(a,b,d),m=g_objNodeUtil.getNodeWidthHeight(g,!0);if(null==m.nValue||"%"!=m.strUnit)return-1;if(0!=m.nValue%5)return g_objPropForm.ID_DRAW_TYPE_100_COL}return g_objPropForm.ID_DRAW_TYPE_20_COL}catch(l){dalert(l)}return-1};this.convertLoadFormStructure=function(a){try{var c=this.getTablePosArrayBySort(a);if(null==c)return!1;var b=c.leftPos,e=c.topPos,d=c.rightPos,g=c.bottomPos,m=e.length,l=b.length,f=this.createSimpleFlag(m,l);if(null==f)return!1;var h=this.initSimpleRowColPos(a,
f,b,e,d,g);if(null==h||!this.calculateColOffsetWidth(h,m,l,a,f))return!1;var p=this.getSumColOffsetWidth(h,f,m,l);if(null==p||0==p.length)return!1;var n=p[0];for(c=0;c<p.length;c++)if(p[0]!=p[c])return!1;for(c=p=0;c<m;c++){var r=g_objTableUtil.getTableCellsLength(a,c);for(b=0;b<r;b++){var q=g_objTableUtil.getTableCellElement(a,c,b),t=parseInt(100*h[p][6]/n);g_objTableUtil.setNodeValue_Width(q,t,"%");p++}}return!0}catch(v){dalert(v)}return!1};this.loadFormStructure=function(a){try{if(null==a)return!1;
var c=this.getTablePosArrayBySort(a);if(null==c)return!1;var b=c.leftPos,e=c.topPos,d=c.rightPos,g=c.bottomPos,m=e.length,l=b.length,f=this.createSimpleFlag(m,l);if(null==f)return!1;var h=this.initSimpleRowColPos(a,f,b,e,d,g);if(null==h)return!1;var p=g_objPropFormCode.getFormCodeWidthHeight();if(!this.calculateRowColUnitCount(h,m,l,a,p,f))return!1;var n=this.getSumRowColUnitCount(h,f,m,l);if(null==n)return!1;var r=n.sumRowUnitCount,q=n.sumColUnitCount;if(0==r.length||0==q.length)return!1;for(c=0;c<
r.length;c++)if(r[0]!=r[c])return!1;for(c=0;c<q.length;c++)if(q[0]!=q[c])return!1;var t=r[0],v=q[0];if(t>g_objPropForm.nDrawMaxRow||v>g_objPropForm.nDrawMaxCol)return!1;var x=this.createSimpleFlag(t,v);if(null==x)return!1;for(c=r=0;c<m;c++){var y=g_objTableUtil.getTableRowElement(a,c);q=0;var u=g_objNodeUtil.getNodeWidthHeight(y,!1);null!=u.nValue&&(q=u.nValue);var B=g_objTableUtil.getTableCellsLength(a,c);for(t=0;t<B;t++){var z=g_objTableUtil.getTableCellElement(a,c,t),C=g_objNodeUtil.getNodeWidthHeight(z,
!1);null!=C.nValue&&(q=C.nValue);var D=h[r][4],w=h[r][5],A=this.getSimpleFlagPos(x);this.setSimpleFlagPos(x,A.rowNo,A.colNo,D,w,r);g_objPropertyUtil.element_hasClass(z,g_objPropFormCode.strDummyCellClassName)||g_objPropFormEvent.addDataPosInfo(A.rowNo,A.colNo,D,w,z,q);r++}}return!0}catch(E){dalert(E)}return!1};this.getTablePosArrayBySort=function(a){try{for(var c=function(a,b){return a-b},b=[],e=[],d=[],g=[],m=a.rows.length,l=0;l<m;l++)for(var f=g_objTableUtil.getTableCellsLength(a,l),h=0;h<f;h++){var p=
g_objTableUtil.getTableCellElement(a,l,h),n=g_objPositionUtil.getElementPosClientRect(p),r=n.left,q=n.top,t=n.right,v=n.bottom;inArray(r,b)||b.push(r);inArray(q,e)||e.push(q);inArray(t,d)||d.push(t);inArray(v,g)||g.push(v)}b.sort(c);e.sort(c);d.sort(c);g.sort(c);return{leftPos:b,topPos:e,rightPos:d,bottomPos:g}}catch(x){dalert(x)}return null};this.createSimpleFlag=function(a,c){try{for(var b=[],e=0;e<a;e++)b[e]=this.initArrayValue(c,-1);return b}catch(d){dalert(d)}return null};this.initArrayValue=
function(a,c){try{for(var b=[],e=0;e<a;e++)b[e]=c;return b}catch(d){dalert(d)}return null};this.getSimpleFlagPos=function(a){try{for(var c=a.length,b=0;b<c;b++)for(var e=a[b].length,d=0;d<e;d++)if(-1==a[b][d])return{rowNo:b,colNo:d}}catch(g){dalert(g)}};this.setSimpleFlagPos=function(a,c,b,e,d,g){try{for(var m=c;m<c+e;m++)for(var l=b;l<b+d;l++)a[m][l]=g}catch(f){dalert(f)}};this.initSimpleRowColPos=function(a,c,b,e,d,g){try{for(var m=[],l=0,f=a.rows.length,h=0;h<f;h++)for(var p=g_objTableUtil.getTableCellsLength(a,
h),n=0;n<p;n++){var r=g_objTableUtil.getTableCellElement(a,h,n),q=g_objPositionUtil.getElementPosClientRect(r),t=q.left,v=q.top,x=q.right,y=q.bottom,u=-1,B=-1,z=-1,C=-1;"undefined"!=typeof b.indexOf?(u=b.indexOf(t),B=e.indexOf(v),z=d.indexOf(x)+1,C=g.indexOf(y)+1):(u=inArrayIndex(t,b),B=inArrayIndex(v,e),z=inArrayIndex(x,d)+1,C=inArrayIndex(y,g)+1);if(-1==u||-1==B||0==z||0==C)return null;B=C-B;u=z-u;var D=this.getSimpleFlagPos(c);this.setSimpleFlagPos(c,D.rowNo,D.colNo,B,u,l);m[l]=[D.rowNo,D.colNo,
D.rowNo+B-1,D.colNo+u-1,-1,-1,-1];l++}return m}catch(w){dalert(w)}return null};this.calculateRowColUnitCount=function(a,c,b,e,d,g){try{for(var m=this.initArrayValue(c,-1),l=this.initArrayValue(b,-1),f=0,h=0;h<c;h++)for(var p=g_objTableUtil.getTableCellsLength(e,h),n=0;n<p;n++){var r=a[f][0],q=a[f][1],t=a[f][2],v=a[f][3];if(r==t)if(-1==m[r]){var x=g_objTableUtil.getTableCellElement(e,h,n);if(!g_objPropertyUtil.element_hasClass(x,g_objPropFormCode.strDummyCellClassName)){var y=this.calculateCellRowUnitCount(e,
h,n,d.unitHeight);if(-1==y)return!1;0==y&&(y=1);m[r]=y;a[f][4]=y}}else a[f][4]=m[r];if(q==v)if(-1==l[q]){var u=this.calculateCellColUnitCount(e,h,n,d.unitWidth);if(-1==u)return!1;l[q]=u;a[f][5]=u}else a[f][5]=l[q];f++}this.calculateOneMoreRowColUnitCount(a,m,l);if(this.findNoAssignRowCol(a)){x=[];var B=[],z=[],C=[];for(h=f=0;h<c;h++)for(p=g_objTableUtil.getTableCellsLength(e,h),n=0;n<p;n++){r=a[f][0];q=a[f][1];t=a[f][2];v=a[f][3];var D=a[f][5];if(-1==a[f][4]){for(var w=!1,A=r;A<=t;A++)if(-1==m[A]){w=
!0;break}if(w)if(w=r+"_"+t,inArray(w,x)){var E=x.indexOf(w);if(-1==E)return!1;a[f][4]=B[E]}else{y=this.calculateCellRowUnitCount(e,h,n,d.unitHeight);if(-1==y)return!1;a[f][4]=y;x.push(w);B.push(y)}}if(-1==D){w=!1;var I=0;for(A=q;A<=v;A++)if(-1==l[A]){w=!0;break}else I+=l[A];if(w)if(w=q+"_"+v,inArray(w,z)){E=z.indexOf(w);if(-1==E)return!1;a[f][5]=C[E]}else{u=this.calculateCellColUnitCount(e,h,n,d.unitWidth);if(-1==u)return!1;a[f][5]=u;z.push(w);C.push(u);this.assignSkippedColUnitCount(q,v,u,l,z,C)}else a[f][5]=
I}f++}if(this.findNoAssignRowCol(a))return!1}var H=this.getSumRowColUnitCount(a,g,c,b);if(null==H)return!1;var F=H.sumRowUnitCount,G=H.sumColUnitCount;if(0==F.length||0==G.length)return!1;for(h=0;h<F.length;h++)if(F[0]!=F[h])return!1;b=!1;for(h=0;h<G.length;h++)if(G[0]!=G[h]){b=!0;break}return b&&!this.reAssignColUnitCount(a,c,e,l)?!1:!0}catch(J){dalert(J)}return!1};this.calculateCellRowUnitCount=function(a,c,b,e){try{var d=g_objTableUtil.getTableCellElement(a,c,b).clientHeight,g=parseInt(d/e);0!=
d%e&&g++;return g}catch(m){dalert(m)}return-1};this.calculateCellColUnitCount=function(a,c,b,e){try{var d=g_objTableUtil.getTableCellElement(a,c,b),g=g_objNodeUtil.getNodeWidthHeight(d,!0);if(null==g.nValue)return!1;var m=parseInt(g.nValue/e);return 0!=g.nValue%e?-1:m}catch(l){dalert(l)}return-1};this.calculateOneMoreRowColUnitCount=function(a,c,b){try{for(var e=0;e<a.length;e++){var d=a[e][0],g=a[e][1],m=a[e][2],l=a[e][3],f=a[e][5];if(-1==a[e][4]){for(var h=!0,p=0,n=d;n<=m;n++){if(-1==c[n]){h=!1;
break}h&&(p+=c[n])}h&&(a[e][4]=p)}if(-1==f){h=!0;p=0;for(n=g;n<=l;n++){if(-1==b[n]){h=!1;break}h&&(p+=b[n])}h&&(a[e][5]=p)}}}catch(r){dalert(r)}};this.findNoAssignRowCol=function(a){try{for(var c=0;c<a.length;c++)if(-1==a[c][4]||-1==a[c][5])return!0}catch(b){dalert(b)}return!1};this.assignSkippedColUnitCount=function(a,c,b,e,d,g){try{if(!this.doAssignSkippedColUnitCount(a,c,b,e))return!1;for(a=0;a<d.length;a++){var m=d[a].split("_");this.doAssignSkippedColUnitCount(m[0],m[1],g[a],e)}return!0}catch(l){dalert(l)}return!1};
this.doAssignSkippedColUnitCount=function(a,c,b,e){try{for(var d=0,g=-1;a<=c;a++)-1==e[a]?(d++,g=a):b-=e[a];if(1!=d)return!1;e[g]=b;return!0}catch(m){dalert(m)}return!1};this.reAssignColUnitCount=function(a,c,b,e){try{for(var d=0,g=0;g<c;g++)for(var m=g_objTableUtil.getTableCellsLength(b,g),l=0;l<m;l++){for(var f=a[d][3],h=0,p=a[d][1];p<=f;p++){if(-1==e[p])return!1;h+=e[p]}a[d][5]=h;d++}return!0}catch(n){dalert(n)}return!1};this.getSumRowColUnitCount=function(a,c,b,e){try{for(var d=this.initArrayValue(e,
-1),g=this.initArrayValue(e,0),m=-1,l=this.initArrayValue(b,0),f=0;f<b;f++){for(var h=0;h<e;h++){var p=c[f][h];d[h]!=a[p][2]&&(d[h]=a[p][2],g[h]+=a[p][4]);m!=a[p][3]&&(m=a[p][3],l[f]+=a[p][5])}m=-1}return{sumRowUnitCount:g,sumColUnitCount:l}}catch(n){dalert(n)}return null};this.calculateColOffsetWidth=function(a,c,b,e,d){try{var g=this.initArrayValue(b,-1);for(d=b=0;d<c;d++)for(var m=g_objTableUtil.getTableCellsLength(e,d),l=0;l<m;l++){var f=a[b][1],h=a[b][3];if(f==h){var p=g_objTableUtil.getTableCellElement(e,
d,l),n=p.offsetWidth;-1==g[f]?(g[f]=n,a[b][6]=n):a[b][6]=g[f]}b++}this.calculateOneMoreColOffsetWidth(a,g);if(this.findNoAssignColOffsetWidth(a))for(;;){var r=!1;for(d=0;d<g.length;d++)if(-1==g[d]&&0!=d&&-1!=g[d-1]){var q=this.getTargetCellOffsetWidth(a,e,c,d-1,d);if(-1!=q){g[d]=q-g[d-1];r=!0;break}}if(!r)break;this.calculateOneMoreColOffsetWidth(a,g)}if(this.findNoAssignColOffsetWidth(a)){q=[];r=[];for(d=b=0;d<c;d++)for(m=g_objTableUtil.getTableCellsLength(e,d),l=0;l<m;l++){f=a[b][1];h=a[b][3];n=
a[b][6];if(-1==n){for(var t=!1,v=f;v<=h;v++)if(-1==g[v]){t=!0;break}if(t)if(t=f+"_"+h,inArray(t,q)){var x=q.indexOf(t);if(-1==x)return!1;a[b][6]=r[x]}else{p=g_objTableUtil.getTableCellElement(e,d,l);var y=p.offsetWidth;a[b][6]=y;q.push(t);r.push(y)}}b++}if(this.findNoAssignColOffsetWidth(a))return!1}return!0}catch(u){dalert(u)}return!1};this.calculateOneMoreColOffsetWidth=function(a,c){try{for(var b=0;b<a.length;b++){var e=a[b][1],d=a[b][3];if(-1==a[b][6]){for(var g=!0,m=0,l=e;l<=d;l++){if(-1==c[l]){g=
!1;break}g&&(m+=c[l])}g&&(a[b][6]=m)}}}catch(f){dalert(f)}};this.findNoAssignColOffsetWidth=function(a){try{for(var c=0;c<a.length;c++)if(-1==a[c][6])return!0}catch(b){dalert(b)}return!1};this.getSumColOffsetWidth=function(a,c,b,e){try{for(var d=-1,g=this.initArrayValue(b,0),m=0;m<b;m++){for(var l=0;l<e;l++){var f=c[m][l];d!=a[f][3]&&(d=a[f][3],g[m]+=a[f][6])}d=-1}return g}catch(h){dalert(h)}return null};this.getTargetCellOffsetWidth=function(a,c,b,e,d){try{for(var g=0,m=0;m<b;m++)for(var l=g_objTableUtil.getTableCellsLength(c,
m),f=0;f<l;f++){var h=a[g][3];if(a[g][1]==e&&h==d)return g_objTableUtil.getTableCellElement(c,m,f).offsetWidth;g++}}catch(p){dalert(p)}return-1};this.getValidateSumColOffsetWidth=function(a,c,b,e){try{for(var d=!0,g=-1,m=0,l=0;l<b;l++){for(var f=0;f<e;f++){var h=c[l][f];if(g!=a[h][3]){g=a[h][3];if(-1==a[h][6]){d=!1;break}m+=a[h][6]}}if(d)return m;g=-1;m=0}}catch(p){dalert(p)}return 0}};

var g_objPropFormKeyCode=new function(){this.bShiftKeyDown=this.bCtrlKeyDown=!1;this.keyDownPaste=function(d){try{if(!g_objPropFormSink.checkFocusPropFormUI()){dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d);d=0;for(var a=!0,g=0,c=g_objPropFormEvent.arrEventPosInfo,b=0;b<c.length;b++)if(c[b].bSelectedDown&&(d++,a)){a=!1;var f=c[b],h=f.nStartRow,k=f.nStartCol,l=f.nEndRow,n=f.nEndCol,m=g_objPropFormEvent.checkAvailablePasteArea(h,k,l,n);if(null==m)return;g=m.diffRow}if(0<
d){m=0;a=[];c=g_objPropFormEvent.arrEventPosInfo;for(b=0;b<c.length;b++)if(c[b].bSelectedDown){f=c[b];h=f.nStartRow+g;k=f.nStartCol;l=f.nEndRow+g;n=f.nEndCol;if(l>g_objPropForm.nDrawMaxRow-1)return;if(0==g_objPropFormEvent.checkCellAreaBackgroundColor(h,k,l,n)){m++;var e=g_objPropFormEvent.newEventPosInfo();g_objPropFormEvent.initEventPosInfo(e,h,k,l,n);g_objPropFormEvent.copyEventPosInfo(f,e);a[a.length]=e;if(d==m)break}else a=[],m=0,g++,b=-1}for(b=0;b<a.length;b++){e=a[b];var p=g_objPropFormEvent.arrEventPosInfo.length;
g_objPropFormEvent.arrEventPosInfo[p]=e;g_objPropFormEvent.displayAreaRectangle(e.nStartRow,e.nStartCol,e.nEndRow,e.nEndCol,e.objOutlineUtil,!1,!0);var q=g_objPropFormEvent.getSelectedBackgroundColor(e);g_objPropFormEvent.setAreaBackgroundColor(e.nStartRow,e.nStartCol,e.nEndRow,e.nEndCol,q)}}else-1!=g_objPropFormEvent.nCurResizeIndex&&(f=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex],h=f.nStartRow,k=f.nStartCol,l=f.nEndRow,n=f.nEndCol,m=g_objPropFormEvent.checkAvailablePasteArea(h,
k,l,n),null!=m&&(e=g_objPropFormEvent.newEventPosInfo(),g_objPropFormEvent.initEventPosInfo(e,m.posStartRow,m.posStartCol,m.posEndRow,m.posEndCol),p=g_objPropFormEvent.arrEventPosInfo.length,g_objPropFormEvent.arrEventPosInfo[p]=e,g_objPropFormEvent.copyEventPosInfo(f,e),g_objPropFormEvent.displayAreaRectangle(e.nStartRow,e.nStartCol,e.nEndRow,e.nEndCol,e.objOutlineUtil,!1,!1),q=g_objPropFormEvent.getSelectedBackgroundColor(e),g_objPropFormEvent.setAreaBackgroundColor(e.nStartRow,e.nStartCol,e.nEndRow,
e.nEndCol,q)))}}catch(r){dalert(r)}};this.keyDownResizeArrow=function(d,a){try{if(!g_objPropFormSink.checkFocusPropFormUI()&&(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a),!g_objPropFormEvent.checkGroupSelected()&&-1!=g_objPropFormEvent.nCurResizeIndex)){var g=a=0;ID_KEYCODE_ARROW_LEFT==d?g=-1:ID_KEYCODE_ARROW_RIGHT==d?g=1:ID_KEYCODE_ARROW_TOP==d?a=-1:ID_KEYCODE_ARROW_BOTTOM==d&&(a=1);var c=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];
c.objDataCell.bChangeHeight=!0;var b=c.nStartRow,f=c.nStartCol,h=c.nEndRow+a,k=c.nEndCol+g;if(!(b>h||f>k)){g_objPropFormEvent.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,"");var l=g_objPropFormEvent.getSelectedBackgroundColor(c);g_objPropFormEvent.checkAreaMinMax(b,f,h,k)?g_objPropFormEvent.checkSelectedArea(b,f,h,k,g_objPropFormEvent.nCurResizeIndex)?g_objPropFormEvent.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,l):(g_objPropFormEvent.displayAreaRectangle(b,
f,h,k,c.objOutlineUtil,!0,!1),c.nEndRow=h,c.nEndCol=k,g_objPropFormEvent.setAreaBackgroundColor(b,f,h,k,l)):g_objPropFormEvent.setAreaBackgroundColor(c.nStartRow,c.nStartCol,c.nEndRow,c.nEndCol,l)}}}catch(n){dalert(n)}};this.keyDownTab=function(d){try{if(!g_objPropFormSink.checkFocusPropFormUI()&&(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d),g_objPropFormEvent.checkGroupSelected()&&(g_objPropFormEvent.showAllAreaRectangle(),g_objPropFormEvent.setGroupAreaBackgroundColor(!0,
g_objPropFormEvent.ID_SELECTED_COLOR,!1)),0!=g_objPropFormEvent.arrEventPosInfo.length)){if(-1!=g_objPropFormEvent.nCurResizeIndex){var a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];g_objPropFormEvent.displayAreaRectangle(a.nStartRow,a.nStartCol,a.nEndRow,a.nEndCol,a.objOutlineUtil,!1,!1)}g_objPropFormEvent.nCurResizeIndex++;g_objPropFormEvent.nCurResizeIndex>=g_objPropFormEvent.arrEventPosInfo.length&&(g_objPropFormEvent.nCurResizeIndex=0);a=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];
g_objPropFormEvent.displayAreaRectangle(a.nStartRow,a.nStartCol,a.nEndRow,a.nEndCol,a.objOutlineUtil,!0,!1);g_objPropFormEvent.nMoveIndex=g_objPropFormEvent.nCurResizeIndex}}catch(g){dalert(g)}};this.keyDownEscape=function(d){try{g_objPropFormSink.checkFocusPropFormUI()||(dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d),g_objPropFormEvent.showAllAreaRectangle(),g_objPropFormEvent.setGroupAreaBackgroundColor(!0,g_objPropFormEvent.ID_SELECTED_COLOR,!1),g_objPropFormSink.updatePropFormUI())}catch(a){dalert(a)}};
this.keyDownDelete=function(d){try{if(!g_objPropFormSink.checkFocusPropFormUI()){dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(d):TBCancelBubbleEvent(d);if(!g_objPropFormEvent.checkGroupSelected()){if(-1==g_objPropFormEvent.nCurResizeIndex)return;g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex].bSelectedDown=!0}g_objPropFormEvent.nMoveIndex=-1;g_objPropFormEvent.nCurResizeIndex=-1;d=[];for(var a=0;a<g_objPropFormEvent.arrEventPosInfo.length;a++){var g=g_objPropFormEvent.arrEventPosInfo[a];
g_objPropFormEvent.arrEventPosInfo[a].bSelectedDown?(g_objPropFormEvent.setAreaBackgroundColor(g.nStartRow,g.nStartCol,g.nEndRow,g.nEndCol,""),g.objOutlineUtil.showExtOutline(!1,!1,!1,0,0,0,0,!1,!1)):d[d.length]=g}g_objPropFormEvent.arrEventPosInfo=d;g_objPropFormSink.updatePropFormUI()}}catch(c){dalert(c)}};this.keyDownMoveArrow=function(d,a){try{if(!g_objPropFormSink.checkFocusPropFormUI()){dzeEnvConfig.iFrameLayer?TBCancelBubbleEvent_iFrameLayer(a):TBCancelBubbleEvent(a);var g=g_objPropFormEvent.checkGroupSelected(),
c=a=0;ID_KEYCODE_ARROW_LEFT==d?c=-1:ID_KEYCODE_ARROW_RIGHT==d?c=1:ID_KEYCODE_ARROW_TOP==d?a=-1:ID_KEYCODE_ARROW_BOTTOM==d&&(a=1);if(g)g_objPropFormEvent.setGroupAreaBackgroundColor(!1,g_objPropFormEvent.ID_REMOVE_COLOR,!0),g_objPropFormEventMove.checkGroupStartEndPos(a,c)&&!g_objPropFormEvent.checkGroupSelectedArea(a,c)&&(g_objPropFormEvent.displayGroupAreaRectangle(a,c),g_objPropFormEventMove.setGroupDragInfo_move(a,c),g_objPropFormEventMove.setGroupDragInfo_up()),g_objPropFormEvent.setGroupAreaBackgroundColor(!1,
g_objPropFormEvent.ID_GROUP_COLOR,!1);else if(-1!=g_objPropFormEvent.nCurResizeIndex){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex],f=b.nStartRow+a,h=b.nStartCol+c,k=b.nEndRow+a,l=b.nEndCol+c;g_objPropFormEvent.setAreaBackgroundColor(b.nStartRow,b.nStartCol,b.nEndRow,b.nEndCol,"");var n=g_objPropFormEvent.getSelectedBackgroundColor(b);g_objPropFormEvent.checkAreaMinMax(f,h,k,l)?g_objPropFormEvent.checkSelectedArea(f,h,k,l,g_objPropFormEvent.nCurResizeIndex)?g_objPropFormEvent.setAreaBackgroundColor(b.nStartRow,
b.nStartCol,b.nEndRow,b.nEndCol,n):(g_objPropFormEvent.displayAreaRectangle(f,h,k,l,b.objOutlineUtil,!0,!1),b.nStartRow=f,b.nStartCol=h,b.nEndRow=k,b.nEndCol=l,g_objPropFormEvent.setAreaBackgroundColor(f,h,k,l,n)):g_objPropFormEvent.setAreaBackgroundColor(b.nStartRow,b.nStartCol,b.nEndRow,b.nEndCol,n)}}}catch(m){dalert(m)}}};

var g_objPropFormSink=new function(){var e=this;this.objButton_PreviewCreate=this.objButton_Apply_bgColor=this.objButton_Apply_Border=this.objTxtFormBorderWidth=this.objCheck_KeepHeight=this.objSelect_DefineHeight=this.objSelect_DefineWidth=null;this.bAvailableButton=!1;this.arrDefineWidth=["5","1"];this.arrDefineHeight="10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35".split(" ");this.setupPropFormUI=function(a){try{this.objSelect_DefineWidth=g_objLayerKit.getElementById("selFormDefineWidth");
for(var b=0;b<this.arrDefineWidth.length;b++)g_objNodeUtil.addOptionForSelectBox(this.objSelect_DefineWidth,b,this.arrDefineWidth[b]);this.objSelect_DefineWidth.onchange=function(a){e.applyDefineWidth()};a?this.objSelect_DefineWidth.disabled=!0:this.objSelect_DefineWidth.style.backgroundColor="";this.objSelect_DefineHeight=g_objLayerKit.getElementById("selFormDefineHeight");for(b=0;b<this.arrDefineHeight.length;b++)g_objNodeUtil.addOptionForSelectBox(this.objSelect_DefineHeight,this.arrDefineHeight[b],
this.arrDefineHeight[b]);this.objSelect_DefineHeight.onchange=function(a){e.applyDefineHeight()};this.updateDefineWidthHeight();this.objCheck_KeepHeight=g_objLayerKit.getElementById("chkKeepHeightYN");a?(this.objCheck_KeepHeight.disabled=!1,this.objCheck_KeepHeight.checked=!0):(this.objCheck_KeepHeight.disabled=!0,this.objCheck_KeepHeight.checked=!1);this.objTxtFormBorderWidth=g_objLayerKit.getElementById("txtFormBorderWidth");this.objTxtFormBorderWidth.value=1;g_objBorderComboBoxUtil.setSelectedIndex("selFormBorderStyle",
0,0);g_objColorComboBoxUtil.setColorValue("txtFormBorderColor","#000000");g_objBorderSelectionUtil.setBorderWidth(this.objTxtFormBorderWidth.value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selFormBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtFormBorderColor"));g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_v_2",
!0);g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0);this.objButton_Apply_Border=g_objLayerKit.getElementById("btnForm_Apply_Border");this.objButton_Apply_Border.onclick=function(a){e.applyFormBorderValue()};g_objColorComboBoxUtil.setColorValue("txtFormBgColor","");this.objButton_Apply_bgColor=g_objLayerKit.getElementById("btnForm_Apply_bgColor");this.objButton_Apply_bgColor.onclick=function(a){e.applyFormBackgroundColor()};this.setAvailableButton(!1);this.objButton_PreviewCreate=g_objLayerKit.getElementById("btnForm_PreviewCreate");
this.objButton_PreviewCreate.onclick=function(a){g_objPropForm.doApplyGenerateFormCode();g_objPropForm.dummyAnchorFocus()}}catch(d){dalert(d)}};this.setAvailableButton=function(a){try{a?(g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_Border,!1,-1),g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_bgColor,!1,-1),this.objButton_Apply_Border.style.cursor="pointer",this.objButton_Apply_bgColor.style.cursor="pointer",this.bAvailableButton=!0):(g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_Border,
!0,2),g_objPropertyUtil.applyFilterOpacityStyle(this.objButton_Apply_bgColor,!0,2),this.objButton_Apply_Border.style.cursor="default",this.objButton_Apply_bgColor.style.cursor="default",this.bAvailableButton=!1)}catch(b){dalert(b)}};this.getFormUIBorderValue=function(){try{var a=this.objTxtFormBorderWidth.value+"px",b=g_objBorderComboBoxUtil.getSelectedBorderValue("selFormBorderStyle",0),d=g_objColorComboBoxUtil.getColorValue("txtFormBorderColor"),c=[];g_objBorderSelectionUtil.getChecked("miniRec_v_0")?
(c[0]=a,c[1]=b,c[2]=d):(c[0]="",c[1]="",c[2]="");g_objBorderSelectionUtil.getChecked("miniRec_h_0")?(c[3]=a,c[4]=b,c[5]=d):(c[3]="",c[4]="",c[5]="");g_objBorderSelectionUtil.getChecked("miniRec_v_2")?(c[6]=a,c[7]=b,c[8]=d):(c[6]="",c[7]="",c[8]="");g_objBorderSelectionUtil.getChecked("miniRec_h_2")?(c[9]=a,c[10]=b,c[11]=d):(c[9]="",c[10]="",c[11]="");return c}catch(f){dalert(f)}};this.updatePropFormUI=function(){try{var a=!1;g_objPropFormEvent.checkGroupSelected()?a=!0:-1!=g_objPropFormEvent.nCurResizeIndex&&
(a=!0);this.setAvailableButton(a)}catch(b){dalert(b)}};this.updateDefineWidthHeight=function(){try{var a=g_objPropForm.getFormDrawType();-1!=a&&(this.objSelect_DefineWidth.selectedIndex=a);var b=g_objPropFormCode.getBasisHeight();for(a=0;a<this.arrDefineHeight.length;a++)if(b==this.arrDefineHeight[a]){this.objSelect_DefineHeight.selectedIndex=a;break}}catch(d){dalert(d)}};this.updateColorValue=function(a,b){try{a.value=g_objCommonUtil.getHexColorCode(b)}catch(d){dalert(d)}};this.updateBorderWidth=
function(a){try{if(null==a||""==a)this.objTxtFormBorderWidth.value="";else{var b=g_objCommonUtil.extractNumberValueUnit(a);this.objTxtFormBorderWidth.value=null==b?"":b.nValue}}catch(d){dalert(d)}};this.applyFormBorderValue=function(){try{if(0!=this.bAvailableButton){var a=this.getFormUIBorderValue();if(g_objPropFormEvent.checkGroupSelected())g_objPropFormEvent.setFormGroupBorderValue(a),g_objPropFormEvent.displayGroupAreaRectangle(0,0);else if(-1!=g_objPropFormEvent.nCurResizeIndex){var b=g_objPropFormEvent.arrEventPosInfo[g_objPropFormEvent.nCurResizeIndex];
g_objPropFormEvent.setFormBorderValue(b,a);g_objPropFormEvent.displayAreaRectangle(b.nStartRow,b.nStartCol,b.nEndRow,b.nEndCol,b.objOutlineUtil,!0,!1)}}}catch(d){dalert(d)}};this.applyFormBackgroundColor=function(){try{if(0!=this.bAvailableButton)if(g_objPropFormEvent.checkGroupSelected()){var a=g_objColorComboBoxUtil.getColorValue("txtFormBgColor");g_objPropFormEvent.setFormGroupBackgroundColor(a)}else-1!=g_objPropFormEvent.nCurResizeIndex&&(a=g_objColorComboBoxUtil.getColorValue("txtFormBgColor"),
g_objPropFormEvent.setFormBackgroundColor(g_objPropFormEvent.nCurResizeIndex,a))}catch(b){dalert(b)}};this.checkFocusPropFormUI=function(){try{var a=g_objLayerKit.getLayerDocument().activeElement;if(null==a)return!1;var b=g_objNodeUtil.getElementTagName(a).toLowerCase();if("input"==b||"select"==b||"checkbox"==b)return!0}catch(d){dalert(d)}return!1};this.applyDefineWidth=function(){try{if(confirm(ID_RES_CONST_STRING_LOSE_ALL_CONTINUE))0==this.objSelect_DefineWidth.value?g_objPropForm.setFormDrawType(g_objPropForm.ID_DRAW_TYPE_20_COL):
g_objPropForm.setFormDrawType(g_objPropForm.ID_DRAW_TYPE_100_COL),g_objPropForm.assignDrawFormTable(g_objPropForm.nDrawMaxRow,g_objPropForm.nDrawMaxCol,g_objPropForm.nDrawCellWidth,g_objPropForm.nDrawCellHeight),g_objPropForm.setPropFormEvent(),g_objPropForm.dummyAnchorFocus();else{var a=g_objPropForm.getFormDrawType();-1!=a&&(this.objSelect_DefineWidth.selectedIndex=a)}}catch(b){dalert(b)}};this.applyDefineHeight=function(){try{g_objPropFormCode.setBasisHeight(this.objSelect_DefineHeight.value)}catch(a){dalert(a)}}};

var g_strBackgroundImageURL=null,propTagCommon=function(){propTagCommon.prototype.buildTagTable_General=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_ROW_COL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_PROP_TAG_STRING_ROW_NUM+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableRowCount",
"",20,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_PROP_TAG_STRING_COL_NUM+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableColCount","",20,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SIZE_DEFINE+"</div>";a+=
"<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_DIALOG_STRING_WIDTH+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableWidth","%",2E3,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_PROP_TAG_STRING_WIDTH_UNIT+
" : </td>";a+='<td><input type="radio" id="rdoWidthUnit_Px" name="rdoWidthUnit" value="0" /><label for="rdoWidthUnit_Px" style="background: none;">px</label></td>';a+='<td width="10"></td>';a+='<td><input type="radio" id="rdoWidthUnit_Percentage" name="rdoWidthUnit" value="0" /><label for="rdoWidthUnit_Percentage" style="background: none;">%</label></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2" style="height:4px;"></td>';a+="</tr>";a+="<tr>";a+='<td colspan="2">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_DIALOG_STRING_HEIGHT+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableHeight","  ",3E3,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_CONST_STRING_OUTER_MARGIN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+="<td width='70'>"+ID_RES_PROP_TAG_STRING_LEFT+"</td>";a+="<td width='90'>"+duzon_dialog.makeSpinnerInputForm("txtTableLeftMargin","px",100,0)+"</td>";a+="<td width='15'></td>";a+="<td width='70'>"+ID_RES_PROP_TAG_STRING_TOP+"</td>";a+="<td width='90'>"+duzon_dialog.makeSpinnerInputForm("txtTableTopMargin","px",100,0)+"</td>";a+="</tr>";a+="<tr>";a+="<td colspan='5' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_PROP_TAG_STRING_RIGHT+"</td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableRightMargin",
"px",100,0)+"</td>";a+="<td></td>";a+="<td>"+ID_RES_PROP_TAG_STRING_BOTTOM+"</td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableBottomMargin","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_ALL_CELL_INNER_MARGIN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_CONST_STRING_INNER_MARGIN+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableCellPadding","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="70">'+ID_RES_CONST_STRING_OUTER_MARGIN+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtTableCellSpacing","px",100,0)+"</td>";a+="</tr>";
a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN+" : </td>";a+="<td>";a+='<select id="selTableAlign" name="selTableAlign" class="duzon_dialog_body_selectform">';
a+='<option value="">'+ID_RES_DIALOG_STRING_NONE+"</option>";a+='<option value="left">'+ID_RES_PROP_TAG_STRING_LEFT+"</option>";a+='<option value="center">'+ID_RES_PROP_TAG_STRING_CENTER+"</option>";a+='<option value="right">'+ID_RES_PROP_TAG_STRING_RIGHT+"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ID_CLASS_DEFINE+
"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_ID+" : </td>";a+='<td><input type="text" id= "txtTableId" name="txtTableId" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+=
'<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_CLASS+" : </td>";a+='<td><input type="text" id="txtTableClass" name="txtTableClass" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td colspan='5' height='5'></td>";a+="</tr>";a+="<tr>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_PROP_TAG_STRING_TABLE_KEY+" : </td>";a+='<td><input type="text" id= "txtTableKey" name="txtTableKey" style="width:100px;"></td>';
a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};propTagCommon.prototype.buildTagCommon_Border=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_DIALOG_TAB_BORDER+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+
ID_RES_DIALOG_STRING_SIZE+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtBorderWidth","px",10,0,"","g_objPropTagCommon.onChangeSpinnerValue")+"</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_FORM_TYPE+" : </td>";a+="<td>";a+=g_objBorderComboBoxUtil.makeBorderComboBoxHTML("selBorderStyle",0,70,90);a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<div style="height:8px;"></div>';
a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+="<td>";a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtBorderColor",70);a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2" style="padding-top:5px;"><input type="checkbox" id="dze_idx_table_bordercollapse" checked="checked"><label for="dze_idx_table_bordercollapse" style="background:none;">'+ID_RES_CONST_STRING_TABLE_COLLAPSE+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';
a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td style="text-align:center;">';a+=g_objBorderSelectionUtil.makeBorderSelectionHTML(0,16,24,!0);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};propTagCommon.prototype.buildTagCommon_Background=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_FILL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoBackgroundColorUseNo" name="rdoBackgroundColorUseYN" value="0" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_NO_COLOR_FILL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoBackgroundColorUseYes" name="rdoBackgroundColorUseYN" value="1" /></td>';
a+="<td>"+ID_RES_PROP_TAG_STRING_COLOR+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_FACE_COLOR+"</td>";a+="<td>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("txtBackgroundColor",150)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';
a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_IMAGE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="checkbox" id="chkBackgroundImageUseYN" name="chkBackgroundImageUseYN" value="0" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_USER_IMAGE+"</td>";a+="</tr>";
a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<form name="frmImageFileUpload" method="post" enctype="multipart/form-data" target="ifrmImageFileUploadTarget" action="'+dzeEnvConfig.strUploadImageURL+'">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_IMAGE_FILE+"</td>";
a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+=duzon_dialog.makeExtFileForm("dze_upimage_file","fileBackgroundImage","250px",[".png",".jpg",".gif"]);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+=
"<tr>";a+='<td width="100%">';a+='<input type="text" id="txtReadBackgroundImageURL" name="txtReadBackgroundImageURL" style="width:100% !important;" disabled value="" />';a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</form>";a+='<iframe name="ifrmImageFileUploadTarget" id="ifrmImageFileUploadTarget" style="width:;height:;display:none;"></iframe>';a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:4px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';
a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_FILL_TYPE+"</td>";a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+='<select id="selBackgroundRepeat" name="selBackgroundRepeat" style="width:100%;">';a+='<option value="repeat">'+ID_RES_PROP_TAG_STRING_REPEAT+"</option>";a+='<option value="repeat-x">'+ID_RES_PROP_TAG_STRING_REPEAT_HOR+
"</option>";a+='<option value="repeat-y">'+ID_RES_PROP_TAG_STRING_REPEAT_VER+"</option>";a+='<option value="no-repeat">'+ID_RES_PROP_TAG_STRING_REPEAT_NO+"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};propTagCommon.prototype.onChangeImgSrc=function(){try{var a=g_objLayerKit.getLayerDocument().forms.frmImageFileUpload.dze_upimage_file.files;duzon_http.showLoading();checkValidImgFile(a,
function(a,c,d,e){duzon_http.hideLoading();0<e.length?(g_strBackgroundImageURL=null,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="",duzon_dialog.showToastMessageArray(null,e,null)):this.uploadImageFile()}.bind(this))}catch(b){dalert(b)}};propTagCommon.prototype.uploadImageFile=function(){try{var a=g_objLayerKit.getLayerDocument().forms.frmImageFileUpload;g_strBackgroundImageURL=null;g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="";var b=a.dze_upimage_file.files;
!b||0>=b.length||uploadImg(g_nActiveEditNumber,a,g_objPropTagCommon.uploadImageFileDone,!0)}catch(c){dalert(c)}};propTagCommon.prototype.uploadImageFileDone=function(a){try{if(a&&"success"==a.result){g_objPropTagCommon.setSelectedTableCustomStyle();var b=a.url;if(b&&Array.isArray(b))if(0<b.length)b=b[0];else return;g_strBackgroundImageURL=b=b.replace("&amp;","&");g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=b}else alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),g_strBackgroundImageURL=
null,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=""}catch(c){g_strBackgroundImageURL=null,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="",dalert(c)}};propTagCommon.prototype.onChangeSpinnerValue=function(a){try{g_objBorderSelectionUtil.setBorderWidth(a)}catch(b){dalert(b)}};propTagCommon.prototype.getSelectedTableStyle=function(){try{var a=$_("buildTagCommonMadangMainHTML");if(!a)return null;var b=a.getElementsByTagName("td");for(a=0;a<g_objTableStyleInfoDB.length;a++)if("dze_table_style_popup_unit_down"==
b[a].className)return g_objTableStyleInfoDB[a];return null}catch(c){dalert(c)}};propTagCommon.prototype.setSelectedTableCustomStyle=function(){try{var a=$_("buildTagCommonMadang_CustomStyle");if(null!=a&&"dze_table_style_popup_unit_down"!=a.className){for(var b=a.parentNode.getElementsByTagName("td"),c=0;c<b.length;c++)b[c].className="dze_table_style_popup_unit";a.className="dze_table_style_popup_unit_down"}}catch(d){dalert(d)}}},g_objPropTagCommon=new propTagCommon;

var propTagSelect=function(){var g=this;this.objInputDisplayContainer=this.objSelectDisplayCount=this.objSelectElement=null;this.nMaxCount=50;propTagSelect.prototype.buildTagSelect=function(){try{var a="";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<div class="duzon_dialog_label_title" style="margin-top:6px;">'+ID_RES_PROP_TAG_LIST_NUM+"</div>";a+="</td>";a+='<td width="50%" style="text-align:center;">';
a+='<select id="selectDisplayCount">';a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_LIST_CONTENT+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="inputDisplayContainer" style="text-align:center;padding:0px;">';a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:280px;"></div>'}catch(c){dalert(c)}};
propTagSelect.prototype.initPropTagSelect=function(a){try{if(null!=a&&(this.objSelectElement=a,this.objSelectDisplayCount=g_objLayerKit.getElementById("selectDisplayCount"),null!=this.objSelectDisplayCount&&(this.objSelectDisplayCount.onchange=function(a){g.changeDisplayInfo()},this.objInputDisplayContainer=g_objLayerKit.getElementById("inputDisplayContainer"),null!=this.objInputDisplayContainer))){this.drawDisplayContent(this.nMaxCount,this.objSelectDisplayCount,this.objInputDisplayContainer);var c=
a.options.length;this.setupDisplayCount(c,this.objSelectDisplayCount);this.setupDisplayContent(this.nMaxCount,c);this.assignDisplayContent(this.nMaxCount,a)}}catch(b){dalert(b)}};propTagSelect.prototype.drawDisplayContent=function(a,c,b){try{for(var d=0;d<a;d++)g_objNodeUtil.addOptionForSelectBox(c,d,d+1);for(d=0;d<a;d++){var e=document.createElement("div");e.style.marginTop="4px";e.style.marginBottom="4px";e.id="inputContainer_"+d;var f=document.createElement("input");f.setAttribute("type","text");
f.style.width="90%";f.id="inputContent_"+d;e.appendChild(f);b.appendChild(e)}}catch(h){dalert(h)}};propTagSelect.prototype.setupDisplayCount=function(a,c){try{for(var b=0;b<c.options.length;b++)if(a-1==c.options[b].value){c.selectedIndex=b;break}}catch(d){dalert(d)}};propTagSelect.prototype.setupDisplayContent=function(a,c){try{for(var b=0;b<a;b++)if(b<c){var d=g_objLayerKit.getElementById("inputContainer_"+b);d.style.display=""}else d=g_objLayerKit.getElementById("inputContainer_"+b),d.style.display=
"none"}catch(e){dalert(e)}};propTagSelect.prototype.assignDisplayContent=function(a,c){try{for(var b=0;b<c.options.length;b++)if(b<a)g_objLayerKit.getElementById("inputContent_"+b).value=c.options[b].text;else break}catch(d){dalert(d)}};propTagSelect.prototype.changeDisplayInfo=function(){try{var a=this.objSelectDisplayCount.selectedIndex+1;this.setupDisplayCount(a,this.objSelectDisplayCount);this.setupDisplayContent(this.nMaxCount,a)}catch(c){dalert(c)}};propTagSelect.prototype.applyDisplayInfo=
function(){try{for(;0<this.objSelectElement.options.length;)this.objSelectElement.removeChild(this.objSelectElement.options[0]);for(var a=this.objSelectDisplayCount.selectedIndex+1,c=0;c<a;c++){var b=g_objLayerKit.getElementById("inputContent_"+c).value;g_objNodeUtil.addOptionForSelectBox(this.objSelectElement,"",b)}}catch(d){dalert(d)}}},g_objPropTagSelect=new propTagSelect;

var propTagTableCreate=function(){var c=this;this.objTxtTableKey=this.objTxtTableClass=this.objTxtTableId=this.objSelBackgroundRepeat=this.objFileBackgroundImage=this.objChkBackgroundImageUseYN=this.objRdoBackgroundColorUseYes=this.objRdoBackgroundColorUseNo=this.objTxtBorderWidth=this.objSelTableAlign=this.objChkBorderCollapse=this.objTxtTableCellSpacing=this.objTxtTableCellPadding=this.objTxtTableBottomMargin=this.objTxtTableRightMargin=this.objTxtTableTopMargin=this.objTxtTableLeftMargin=this.objRdoWidthUnit_Percentage=
this.objRdoWidthUnit_Px=this.objTxtTableHeight=this.objTxtTableWidth=this.objTxtTableColCount=this.objTxtTableRowCount=null;propTagTableCreate.prototype.buildTagTableCreate_General=function(){try{var a="";return a+=g_objPropTagCommon.buildTagTable_General()}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreate_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreate_Background=function(){try{var a=
"";return a+=g_objPropTagCommon.buildTagCommon_Background()}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreateCommon=function(){return'<div style="height:1px;width:380px;"></div>'};propTagTableCreate.prototype.initPropTagTableCreate=function(){try{g_strBackgroundImageURL=null,duzon_dialog.modifySpinnerValue("txtTableRowCount",100,1,"",""),duzon_dialog.modifySpinnerValue("txtTableColCount",100,1,"",""),duzon_dialog.modifySpinnerValue("txtTableWidth",2E3,0,"",""),duzon_dialog.modifySpinnerValue("txtTableHeight",
3E3,0,"",""),duzon_dialog.modifySpinnerValue("txtTableLeftMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableTopMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableRightMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableBottomMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableCellPadding",100,0,3,""),duzon_dialog.modifySpinnerValue("txtTableCellSpacing",100,0,"0",""),duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,"1","g_objPropTagCommon.onChangeSpinnerValue"),
this.objTxtTableRowCount=g_objLayerKit.getElementById("txtTableRowCount"),this.objTxtTableColCount=g_objLayerKit.getElementById("txtTableColCount"),this.objTxtTableRowCount.value=5,this.objTxtTableColCount.value=4,this.objTxtTableWidth=g_objLayerKit.getElementById("txtTableWidth"),this.objTxtTableHeight=g_objLayerKit.getElementById("txtTableHeight"),duzon_dialog.setEnableSpinner("txtTableHeight",!1),this.objTxtTableHeight.value="auto",this.objRdoWidthUnit_Px=g_objLayerKit.getElementById("rdoWidthUnit_Px"),
this.objRdoWidthUnit_Percentage=g_objLayerKit.getElementById("rdoWidthUnit_Percentage"),this.objRdoWidthUnit_Percentage.checked=!0,this.objRdoWidthUnit_Px.addEventListener("change",function(){var a=DzeSpinner.getSpinner("txtTableWidth");a&&a.unit&&(a.unit.innerHTML="px")}),this.objRdoWidthUnit_Percentage.addEventListener("change",function(){var a=DzeSpinner.getSpinner("txtTableWidth");a&&a.unit&&(a.unit.innerHTML="%")}),this.objTxtTableLeftMargin=g_objLayerKit.getElementById("txtTableLeftMargin"),
this.objTxtTableTopMargin=g_objLayerKit.getElementById("txtTableTopMargin"),this.objTxtTableRightMargin=g_objLayerKit.getElementById("txtTableRightMargin"),this.objTxtTableBottomMargin=g_objLayerKit.getElementById("txtTableBottomMargin"),this.objTxtTableCellPadding=g_objLayerKit.getElementById("txtTableCellPadding"),this.objTxtTableCellPadding.value=3,this.objTxtTableCellSpacing=g_objLayerKit.getElementById("txtTableCellSpacing"),this.objTxtTableCellSpacing.value=0,this.objChkBorderCollapse=g_objLayerKit.getElementById("dze_idx_table_bordercollapse"),
this.objChkBorderCollapse.checked=!0,this.objSelTableAlign=g_objLayerKit.getElementById("selTableAlign"),this.objSelTableAlign.selectedIndex=0,this.objTxtBorderWidth=g_objLayerKit.getElementById("txtBorderWidth"),this.objTxtBorderWidth.value=1,g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)}),g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,1),g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",
function(a){g_objBorderSelectionUtil.setBorderColor(a)}),g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000"),g_objBorderSelectionUtil.initBorderSelection(),g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value),g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0)),g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor")),g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0),g_objBorderSelectionUtil.setChecked("miniRec_v_1",
!0),g_objBorderSelectionUtil.setChecked("miniRec_v_2",!0),g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0),g_objBorderSelectionUtil.setChecked("miniRec_h_1",!0),g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0),g_objBorderSelectionUtil.updateSelectRec(),this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo"),this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes"),this.objRdoBackgroundColorUseNo.checked=!0,g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor"),
g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff"),this.objRdoBackgroundColorUseNo.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)},this.objRdoBackgroundColorUseYes.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)},this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN"),this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage"),
duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.onChangeImgSrc()}),duzon_dialog.disableImageUrlForm("txtReadBackgroundImageURL"),duzon_dialog.disableExtFileForm("fileBackgroundImage"),this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat"),this.objSelBackgroundRepeat.onchange=function(){g_objPropTagCommon.setSelectedTableCustomStyle()},this.objSelBackgroundRepeat.disabled=!0,this.objChkBackgroundImageUseYN.onclick=function(a){g_objPropTagCommon.setSelectedTableCustomStyle();
this.checked?(duzon_dialog.enableExtFileForm("fileBackgroundImage"),c.objSelBackgroundRepeat.disabled=!1):(duzon_dialog.disableExtFileForm("fileBackgroundImage"),c.objSelBackgroundRepeat.disabled=!0)},this.objTxtTableId=g_objLayerKit.getElementById("txtTableId"),this.objTxtTableClass=g_objLayerKit.getElementById("txtTableClass"),this.objTxtTableKey=g_objLayerKit.getElementById("txtTableKey")}catch(a){dalert(a)}};propTagTableCreate.prototype.checkValidateData=function(){try{return"%"==(this.objRdoWidthUnit_Px.checked?
"":"%")&&100<g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value)?(alert(ID_RES_PROP_TAG_ALERT_UNDER_100PER),!1):!0}catch(a){dalert(a)}};propTagTableCreate.prototype.getPropSettingData=function(){try{var a=[],b=g_objCommonUtil.getNumberValue(this.objTxtTableRowCount.value);if(null==b)return null;var c=g_objCommonUtil.getNumberValue(this.objTxtTableColCount.value);if(null==c)return null;var f=g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value),g=this.objRdoWidthUnit_Px.checked?"":"%",
h=g_objCommonUtil.getNumberValue(this.objTxtTableLeftMargin.value),k=g_objCommonUtil.getNumberValue(this.objTxtTableTopMargin.value),l=g_objCommonUtil.getNumberValue(this.objTxtTableRightMargin.value),m=g_objCommonUtil.getNumberValue(this.objTxtTableBottomMargin.value),n=g_objCommonUtil.getNumberValue(this.objTxtTableCellPadding.value),p=g_objCommonUtil.getNumberValue(this.objTxtTableCellSpacing.value),q=this.objChkBorderCollapse.checked,r=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0"),t=
g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),u=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2"),v=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0"),w=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),x=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2"),d=null;this.objRdoBackgroundColorUseYes.checked&&(d=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));var e=null;this.objChkBackgroundImageUseYN.checked&&(e=g_strBackgroundImageURL);var y=this.objSelBackgroundRepeat.value,
z=this.objSelTableAlign.value,A=g_objPropTagCommon.getSelectedTableStyle(),B=this.objTxtTableId.value,C=this.objTxtTableClass.value,D=this.objTxtTableKey.value;a[0]=b;a[1]=c;a[2]=f;a[3]=g;a[4]=null;a[5]="";a[6]=n;a[7]=r;a[8]=t;a[9]=u;a[10]=v;a[11]=w;a[12]=x;a[13]=d;a[14]=e;a[15]=y;a[16]=z;a[17]=A;a[18]=h;a[19]=k;a[20]=l;a[21]=m;a[22]=p;a[23]=q;a[24]=B;a[25]=C;a[25]=D;return a}catch(E){dalert(E)}return null}},g_objPropTagTableCreate=new propTagTableCreate;

var g_objPropTagTable=new function(){var l=this;this.objTableInfo=null;this.nEditNumber=0;this.objTxtTableHeight=this.objTxtTableWidth=this.objTxtTableColCount=this.objTxtTableRowCount=this.arrInitBorderAttribute=this.arrInitTableAttribute=null;this.nTableMaxWidth=2E3;this.nTableMaxPercentWidth=100;this.objSelBackgroundRepeat=this.objFileBackgroundImage=this.objChkBackgroundImageUseYN=this.objRdoBackgroundColorUseYes=this.objRdoBackgroundColorUseNo=this.objTxtBorderWidth=this.objTxtTableKey=this.objTxtTableClass=
this.objTxtTableId=this.objSelTableAlign=this.objChkBorderCollapse=this.objTxtTableCellSpacing=this.objTxtTableCellPadding=this.objTxtTableBottomMargin=this.objTxtTableRightMargin=this.objTxtTableTopMargin=this.objTxtTableLeftMargin=this.objRdoWidthUnit_Percentage=this.objRdoWidthUnit_Px=null;this.buildTagTable_General=function(){try{var a="";return a+=g_objPropTagCommon.buildTagTable_General()}catch(c){dalert(c)}};this.buildTagTable_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(c){dalert(c)}};
this.buildTagTable_Background=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Background()}catch(c){dalert(c)}};this.buildTagTableCommon=function(){return'<div style="height:1px;width:380px;"></div>'};this.initPropTagTable=function(a,c){try{if(g_strBackgroundImageURL=null,this.objTableInfo=a,this.nEditNumber=c,this.arrInitBorderAttribute=this.arrInitTableAttribute=null,duzon_dialog.modifySpinnerValue("txtTableRowCount",20,0,"",""),duzon_dialog.modifySpinnerValue("txtTableColCount",
20,0,"",""),this.nTableMaxWidth=2E3,this.nTableMaxPercentWidth=100,duzon_dialog.modifySpinnerValue("txtTableWidth",this.nTableMaxWidth,0,"",""),duzon_dialog.modifySpinnerValue("txtTableHeight",3E3,0,"",""),duzon_dialog.modifySpinnerValue("txtTableLeftMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableTopMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableRightMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableBottomMargin",100,-100,"0",""),duzon_dialog.modifySpinnerValue("txtTableCellPadding",
100,0,"3",""),duzon_dialog.modifySpinnerValue("txtTableCellSpacing",100,0,"0",""),duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,"1","g_objPropTagCommon.onChangeSpinnerValue"),this.objTxtTableRowCount=g_objLayerKit.getElementById("txtTableRowCount"),this.objTxtTableColCount=g_objLayerKit.getElementById("txtTableColCount"),this.objTxtTableWidth=g_objLayerKit.getElementById("txtTableWidth"),this.objTxtTableHeight=g_objLayerKit.getElementById("txtTableHeight"),this.objRdoWidthUnit_Px=g_objLayerKit.getElementById("rdoWidthUnit_Px"),
this.objRdoWidthUnit_Percentage=g_objLayerKit.getElementById("rdoWidthUnit_Percentage"),this.objRdoWidthUnit_Px.addEventListener("change",function(){l.onRadioChange(l.objRdoWidthUnit_Px)}),this.objRdoWidthUnit_Percentage.addEventListener("change",function(){l.onRadioChange(l.objRdoWidthUnit_Percentage)}),duzon_dialog.setEnableSpinner("txtTableHeight",!1),this.objTxtTableHeight.value="auto",this.objTxtTableLeftMargin=g_objLayerKit.getElementById("txtTableLeftMargin"),this.objTxtTableTopMargin=g_objLayerKit.getElementById("txtTableTopMargin"),
this.objTxtTableRightMargin=g_objLayerKit.getElementById("txtTableRightMargin"),this.objTxtTableBottomMargin=g_objLayerKit.getElementById("txtTableBottomMargin"),this.objTxtTableCellPadding=g_objLayerKit.getElementById("txtTableCellPadding"),this.objTxtTableCellSpacing=g_objLayerKit.getElementById("txtTableCellSpacing"),this.objChkBorderCollapse=g_objLayerKit.getElementById("dze_idx_table_bordercollapse"),this.objSelTableAlign=g_objLayerKit.getElementById("selTableAlign"),this.objTxtTableId=g_objLayerKit.getElementById("txtTableId"),
this.objTxtTableId.onblur=function(){var b=g_objPropTagTable.objTxtTableId.value;0<b.length&&(b=g_objEditorDocument[c].getElementById(b),!1===fnObjectCheckNull(b)&&b!==a&&(b=g_objTableUtil.getID(a),g_objPropTagTable.objTxtTableId.value=0<b.length?b:"",alert(ID_RES_DIALOG_ALERT_DUPLICATED_ID)))},this.objTxtTableClass=g_objLayerKit.getElementById("txtTableClass"),this.objTxtTableKey=g_objLayerKit.getElementById("txtTableKey"),this.objTxtBorderWidth=g_objLayerKit.getElementById("txtBorderWidth"),this.objTxtBorderWidth.value=
1,g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)}),g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,1),g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a)}),g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000"),g_objBorderSelectionUtil.initBorderSelection(),g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value),
g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0)),g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor")),this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo"),this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes"),g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor"),this.objRdoBackgroundColorUseNo.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",
!1)},this.objRdoBackgroundColorUseYes.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)},this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN"),this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage"),duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.onChangeImgSrc()}),duzon_dialog.disableImageUrlForm("txtReadBackgroundImageURL"),duzon_dialog.disableExtFileForm("fileBackgroundImage"),
this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat"),this.objSelBackgroundRepeat.onchange=function(){g_objPropTagCommon.setSelectedTableCustomStyle()},this.objChkBackgroundImageUseYN.onclick=function(a){g_objPropTagCommon.setSelectedTableCustomStyle();this.checked?(duzon_dialog.enableExtFileForm("fileBackgroundImage"),l.objSelBackgroundRepeat.disabled=!1):(duzon_dialog.disableExtFileForm("fileBackgroundImage"),l.objSelBackgroundRepeat.disabled=!0)},a){var d=a.rows.length,
f=g_objTableUtil.getTableMaxColSpanCount(a);this.objTxtTableRowCount.value=d;this.objTxtTableColCount.value=f;duzon_dialog.setEnableSpinner("txtTableRowCount",!1);duzon_dialog.setEnableSpinner("txtTableColCount",!1);var b=g_objNodeUtil.getNodeWidthHeight(a,!0);d="";var e=DzeSpinner.getSpinner("txtTableWidth");""==b.strUnit||"px"==b.strUnit?(""!=b.nValue&&null!=b.nValue&&(this.objTxtTableWidth.value=b.nValue,e&&(e.unit.innerHTML="px",e.min=0,e.max=this.nTableMaxWidth)),this.objRdoWidthUnit_Px.checked=
!0):"%"==b.strUnit?(""!=b.nValue&&null!=b.nValue&&(this.objTxtTableWidth.value=b.nValue,e&&(e.unit.innerHTML="%",e.min=0,e.max=this.nTableMaxPercentWidth)),this.objRdoWidthUnit_Percentage.checked=!0,d="%"):this.objRdoWidthUnit_Px.checked=!0;var h=g_objTableUtil.getTableMargin(a);this.objTxtTableLeftMargin.value=h.left;this.objTxtTableTopMargin.value=h.top;this.objTxtTableRightMargin.value=h.right;this.objTxtTableBottomMargin.value=h.bottom;var t=g_objTableUtil.getTableCellPadding(a);this.objTxtTableCellPadding.value=
t;var v=g_objTableUtil.getTableCellSpacing(a);this.objTxtTableCellSpacing.value=v;var g=g_objTableUtil.getTableBorderCollapse(a);this.objChkBorderCollapse&&(this.objChkBorderCollapse.checked=g);var u=g_objTableUtil.getAlignTableByStyleProperty(a);this.objSelTableAlign.selectedIndex=u;var q=g_objTableUtil.getID(a);this.objTxtTableId.value=q;var r=g_objTableUtil.getClass(a);this.objTxtTableClass.value=r;var m=a.getAttribute("mapping_key");this.objTxtTableKey.value=!1===fnObjectCheckNull(m)?m:"";var n=
g_objTableFunction.getCellBorderAttribute(a,!1,c);this.arrInitBorderAttribute=n[1].slice();g_objBorderSelectionUtil.initPropTagTableCellStyleBorder(n);var k=a.style.backgroundColor;null==k||""==k?(k=null,this.objRdoBackgroundColorUseNo.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff")):(k=g_objCommonUtil.getHexColorCode(k),this.objRdoBackgroundColorUseYes.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",
!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",k));var p=g_objPropertyUtil.getBackgroundImageURL(a);b=null;null==p||""==p?(p=null,this.objFileBackgroundImage.disabled=!0,this.objSelBackgroundRepeat.disabled=!0):(this.objChkBackgroundImageUseYN.checked=!0,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=p,b=a.style.backgroundRepeat,"repeat"==b?this.objSelBackgroundRepeat.selectedIndex=0:"repeat-x"==b?this.objSelBackgroundRepeat.selectedIndex=1:"repeat-y"==b?this.objSelBackgroundRepeat.selectedIndex=
2:"no-repeat"==b&&(this.objSelBackgroundRepeat.selectedIndex=3),duzon_dialog.enableExtFileForm("fileBackgroundImage"));this.arrInitTableAttribute=[];this.arrInitTableAttribute[ID_PROP_NODE_BORDER]=null;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]=k;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE]=[p,b];this.arrInitTableAttribute[ID_PROP_NODE_GENERAL]=[this.objTxtTableWidth.value,d,t,this.objTxtTableLeftMargin.value,this.objTxtTableTopMargin.value,this.objTxtTableRightMargin.value,
this.objTxtTableBottomMargin.value]}}catch(w){dalert(w)}};this.resetPropTagTable=function(){try{if(this.arrInitBorderAttribute=this.arrInitTableAttribute=g_strBackgroundImageURL=null,this.objTxtBorderWidth=g_objLayerKit.getElementById("txtBorderWidth"),this.objTxtBorderWidth.value=1,g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,0),g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000"),g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value),
g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0)),g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor")),this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo"),this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes"),this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN"),this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage"),
duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.uploadImageFile()}),this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat"),this.objTableInfo){var a=this.objTableInfo.rows.length,c=g_objTableUtil.getTableMaxColSpanCount(this.objTableInfo);this.objTxtTableRowCount.value=a;this.objTxtTableColCount.value=c;duzon_dialog.setEnableSpinner("txtTableRowCount",!1);duzon_dialog.setEnableSpinner("txtTableColCount",!1);var d=g_objTableFunction.getCellBorderAttribute(this.objTableInfo,
!1,this.nEditNumber);this.arrInitBorderAttribute=d[1].slice();var f=d[0][0],b=d[0][1];f||b?!f&&b?g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"):f&&!b&&g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"):(g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"),g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"));g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_h_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_2",
!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_v_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_2",!1,"");g_objBorderSelectionUtil.updateSelectRec();var e=this.objTableInfo.style.backgroundColor;null==e||""==e?(e=null,this.objRdoBackgroundColorUseNo.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",
"#ffffff")):(e=g_objCommonUtil.getHexColorCode(e),this.objRdoBackgroundColorUseYes.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",e));var h=g_objPropertyUtil.getBackgroundImageURL(this.objTableInfo);a=null;null==h||""==h?(h=null,this.objFileBackgroundImage.disabled=!0,this.objSelBackgroundRepeat.disabled=!0,this.objChkBackgroundImageUseYN.checked=!1,this.objSelBackgroundRepeat.selectedIndex=0):(this.objChkBackgroundImageUseYN.checked=
!0,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=h,a=this.objTableInfo.style.backgroundRepeat,"repeat"==a?this.objSelBackgroundRepeat.selectedIndex=0:"repeat-x"==a?this.objSelBackgroundRepeat.selectedIndex=1:"repeat-y"==a?this.objSelBackgroundRepeat.selectedIndex=2:"no-repeat"==a&&(this.objSelBackgroundRepeat.selectedIndex=3));this.arrInitTableAttribute=[];this.arrInitTableAttribute[ID_PROP_NODE_BORDER]=null;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]=e;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE]=
[h,a]}}catch(t){dalert(t)}};this.checkValidateData=function(){try{return"%"==(this.objRdoWidthUnit_Px.checked?"":"%")&&100<g_objCommonUtil.getNumberValue(this.objTxtTableWidth.value)?(alert(ID_RES_PROP_TAG_ALERT_UNDER_100PER),!1):!0}catch(a){dalert(a)}};this.getPropSettingData=function(){try{var a=[],c=parseFloat(this.objTxtTableWidth.value),d=this.objRdoWidthUnit_Px.checked?"px":"%",f=g_objCommonUtil.getNumberValue(this.objTxtTableLeftMargin.value),b=g_objCommonUtil.getNumberValue(this.objTxtTableTopMargin.value),
e=g_objCommonUtil.getNumberValue(this.objTxtTableRightMargin.value),h=g_objCommonUtil.getNumberValue(this.objTxtTableBottomMargin.value),l=g_objCommonUtil.getNumberValue(this.objTxtTableCellPadding.value),v=g_objCommonUtil.getNumberValue(this.objTxtTableCellSpacing.value);a[ID_PROP_NODE_GENERAL]=[c,d,l,this.objSelTableAlign.value,f,b,e,h,v,this.objChkBorderCollapse.checked,this.objTxtTableId.value,this.objTxtTableClass.value,this.objTxtTableKey.value];c=!0;var g=g_objBorderSelectionUtil.bHide_MiniRec_h_1?
!1:!0,u=g_objBorderSelectionUtil.bHide_MiniRec_v_1?!1:!0,q=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0");""===q&&(q=ID_PROP_BORDER_DUPLICATED);d="";g&&(d=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),""===d&&(d=ID_PROP_BORDER_DUPLICATED));var r=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2");""===r&&(r=ID_PROP_BORDER_DUPLICATED);var m=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0");""===m&&(m=ID_PROP_BORDER_DUPLICATED);f="";u&&(f=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),
""===f&&(f=ID_PROP_BORDER_DUPLICATED));var n=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2");""===n&&(n=ID_PROP_BORDER_DUPLICATED);q==this.arrInitBorderAttribute[0]&&d==this.arrInitBorderAttribute[1]&&r==this.arrInitBorderAttribute[2]&&m==this.arrInitBorderAttribute[3]&&f==this.arrInitBorderAttribute[4]&&n==this.arrInitBorderAttribute[5]&&(c=!1);a[ID_PROP_NODE_BORDER]=[c,!0,g,!0,!0,u,!0,q,d,r,m,f,n];g=null;this.objRdoBackgroundColorUseYes.checked&&(g=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));
a[ID_PROP_NODE_BACKGROUND_COLOR]=g==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?[!1,g]:[!0,g];g=null;this.objChkBackgroundImageUseYN.checked&&(g=g_objLayerKit.getElementById("txtReadBackgroundImageURL").value);var k=this.objSelBackgroundRepeat.value;a[ID_PROP_NODE_BACKGROUND_IMAGE]=g==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?k==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?[!1,g,k]:[!0,g,k]:[!0,g,k];a[ID_PROP_NODE_STYLE]=g_objPropTagCommon.getSelectedTableStyle();
return a}catch(p){dalert(p)}return null};this.onRadioChange=function(a){try{var c=DzeSpinner.getSpinner("txtTableWidth");if(a===this.objRdoWidthUnit_Px){var d=parseFloat(this.objTxtTableWidth.value)/100,f=g_objCommonUtil.convPercentToPx(this.objTableInfo,d);this.objTxtTableWidth.value=Math.floor(f);c&&(c.unit&&(c.unit.innerHTML="px"),c.min=0,c.max=this.nTableMaxWidth)}else a===this.objRdoWidthUnit_Percentage&&(f=parseFloat(this.objTxtTableWidth.value),d=100*g_objCommonUtil.convPxToPercent(this.objTableInfo,
f),this.objTxtTableWidth.value=Math.floor(d),c&&(c.unit&&(c.unit.innerHTML="%"),c.min=0,c.max=this.nTableMaxPercentWidth))}catch(b){dalert(b)}}};

var g_objPropTagTableCell=new function(){this.objTxtCellClass=this.objTxtCellId=this.objSelVerticalAlign=this.objSelTextAlign=this.objTxtCellPaddingBottom=this.objTxtCellPaddingRight=this.objTxtCellPaddingTop=this.objTxtCellPaddingLeft=this.objTableNode=null;this.bFoundDifferentClass=!1;this.buildTagTableCell=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_SET_INNER_MARGIN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_LEFT+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingLeft","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_TOP+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingTop",
"px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_RIGHT+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingRight","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_BOTTOM+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtCellPaddingBottom","px",100,0)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_CONST_STRING_ALIGN+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_ALIGN_HOR+" : </td>";a+="<td>";a+='<select id="selTextAlign" name="selTextAlign" style="width:100px;">';a+='<option value=""></option>';a+='<option value="none">'+ID_RES_DIALOG_STRING_NONE+"</option>";a+='<option value="left">'+ID_RES_CONST_STRING_JUSTIFYLEFT+"</option>";a+='<option value="center">'+ID_RES_CONST_STRING_JUSTIFYCENTER+"</option>";a+='<option value="right">'+ID_RES_CONST_STRING_JUSTIFYRIGHT+
"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_ALIGN_VER+" : </td>";a+="<td>";a+='<select id="selVerticalAlign" name="selVerticalAlign" style="width:100px;">';a+='<option value=""></option>';a+='<option value="none">'+ID_RES_DIALOG_STRING_NONE+"</option>";a+='<option value="top">'+ID_RES_PROP_TAG_STRING_ALIGN_TOP+"</option>";a+='<option value="middle">'+
ID_RES_PROP_TAG_STRING_ALIGN_MIDDLE+"</option>";a+='<option value="bottom">'+ID_RES_PROP_TAG_STRING_ALIGN_BOTTOM+"</option>";a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ID_CLASS_DEFINE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+=
'<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_TABLE_ID+" : </td>";a+='<td><input type="text" id= "txtCellId" name="txtCellId" style="width:100px;"></td>';a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="60">'+ID_RES_PROP_TAG_STRING_TABLE_CLASS+" : </td>";a+='<td><input type="text" id="txtCellClass" name="txtCellClass" style="width:100px;"></td>';
a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};this.buildTagTableCellCommon=function(){return'<div style="height:1px;width:380px;"></div>'};this.initPropTagTableCell=function(a,b){try{if(this.objTableNode=a,!fnObjectCheckNull(a)){duzon_dialog.modifySpinnerValue("txtCellPaddingLeft",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingTop",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingRight",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingBottom",
100,0,"","");this.objTxtCellPaddingLeft=g_objLayerKit.getElementById("txtCellPaddingLeft");this.objTxtCellPaddingTop=g_objLayerKit.getElementById("txtCellPaddingTop");this.objTxtCellPaddingRight=g_objLayerKit.getElementById("txtCellPaddingRight");this.objTxtCellPaddingBottom=g_objLayerKit.getElementById("txtCellPaddingBottom");this.objSelTextAlign=g_objLayerKit.getElementById("selTextAlign");this.objSelVerticalAlign=g_objLayerKit.getElementById("selVerticalAlign");this.objTxtCellId=g_objLayerKit.getElementById("txtCellId");
this.objTxtCellId.onblur=function(){var a=g_objPropTagTableCell.objTxtCellId.value;0<a.length&&(a=g_objEditorDocument[b].getElementById(a),!1===fnObjectCheckNull(a)&&a!==m&&(a=g_objTableUtil.getID(m),g_objPropTagTableCell.objTxtCellId.value=0<a.length?a:"",alert(ID_RES_DIALOG_ALERT_DUPLICATED_ID)))};GetMultiCellSelection(b)&&(this.objTxtCellId.disabled=!0);this.objTxtCellClass=g_objLayerKit.getElementById("txtCellClass");this.objWrapText=g_objLayerKit.getElementById("wrap_text");var d=[this.objTxtCellPaddingLeft,
this.objTxtCellPaddingTop,this.objTxtCellPaddingRight,this.objTxtCellPaddingBottom],c=[],f=[],g=[],n=null,m=null,h=null;this.bFoundDifferentClass=!1;for(var e=0;4>e;e++)c[e]=[];var k={},l=function(a){if(!a)return 0;if(k[a])return k[a];var b=g_objCommonUtil.extractNumberValueUnit(a);if(b)return k[a]=+parseFloat(b.nValue).toFixed(2),k[a]};g_objTableSelection.doAllSelectedCell(function(a){c[0][c[0].length]=l(a.style.paddingLeft);c[1][c[1].length]=l(a.style.paddingTop);c[2][c[2].length]=l(a.style.paddingRight);
c[3][c[3].length]=l(a.style.paddingBottom);var b=a.style.textAlign;b||(b=a.align);f[f.length]=b;g[g.length]=a.style.verticalAlign;!1===this.objTxtCellId.disabled&&(b=g_objTableUtil.getID(a),m=a,n=b);!1===this.bFoundDifferentClass&&(a=g_objTableUtil.getClass(a),!1===fnObjectCheckNull(h)&&0<h.length&&h!==a?this.bFoundDifferentClass=!0:h=a)}.bind(this),a);for(e=0;4>e;e++)a="0",c[e].every(function(a){return c[e][0]==a})?""!==c[e][0]&&(a=c[e][0]):a="",d[e].value=a;d="";f.every(function(a){return f[0]===
a})?(d=f[0].toLowerCase(),this.objSelTextAlign.selectedIndex="left"===d?2:"center"===d?3:"right"===d?4:1):this.objSelTextAlign.selectedIndex=0;d="";g.every(function(a){return g[0]===a})?(d=g[0].toLowerCase(),this.objSelVerticalAlign.selectedIndex="top"===d?2:"middle"===d?3:"bottom"===d?4:1):this.objSelVerticalAlign.selectedIndex=0;null!==n&&(this.objTxtCellId.value=n);!1===this.bFoundDifferentClass&&(this.objTxtCellClass.value=h)}}catch(p){dalert(p)}};this.applyPropTagTableCell=function(){try{fnObjectCheckNull(this.objTableNode)||
g_objTableSelection.doAllSelectedCell(function(a){var b=this.objTxtCellPaddingLeft.value;0===parseFloat(b)?a.style.paddingLeft="":""!=b&&(a.style.paddingLeft=b+"px");b=this.objTxtCellPaddingTop.value;0===parseFloat(b)?a.style.paddingTop="":""!=b&&(a.style.paddingTop=b+"px");b=this.objTxtCellPaddingRight.value;0===parseFloat(b)?a.style.paddingRight="":""!=b&&(a.style.paddingRight=b+"px");b=this.objTxtCellPaddingBottom.value;0===parseFloat(b)?a.style.paddingBottom="":""!=b&&(a.style.paddingBottom=b+
"px");b=this.objTxtCellClass.value;!1===this.bFoundDifferentClass&&g_objTableUtil.setClass(a,b);b=this.objSelTextAlign.value;""!==b&&g_objTableUtil.setCellTextAlign(a,b);b=this.objSelVerticalAlign.value;"none"===b?a.style.verticalAlign="":""!==b&&(a.style.verticalAlign=b);g_objTableUtil.setID(a,this.objTxtCellId.value)}.bind(this),this.objTableNode)}catch(a){dalert(a)}}};

var ID_PROP_NODE_BORDER=0,ID_PROP_NODE_BACKGROUND_COLOR=1,ID_PROP_NODE_BACKGROUND_IMAGE=2,ID_PROP_NODE_GENERAL=3,ID_PROP_NODE_STYLE=4,ID_PROP_BORDER_DUPLICATED="duplicated",propTagTableCellStyle=function(){var p=this;this.arrInitBorderAttribute=this.arrInitCellAttribute=null;this.objChkBorderCollapse=!0;this.objRdoApplyBackground_All=this.objRdoApplyBackground_Selected=this.objSelBackgroundRepeat=this.objFileBackgroundImage=this.objChkBackgroundImageUseYN=this.objRdoBackgroundColorUseYes=this.objRdoBackgroundColorUseNo=
this.objTxtBorderWidth=null;propTagTableCellStyle.prototype.buildTagTableCellStyle_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(b){dalert(b)}};propTagTableCellStyle.prototype.buildTagTableCellStyle_Background=function(){try{var a="";a+=g_objPropTagCommon.buildTagCommon_Background();a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_APPLY_RANGE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoApplyBackground_Selected" name="rdoApplyBackground" value="0" /></td>';a+="<td>"+ID_RES_PROP_TAG_STRING_SELECTED_CELL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"><input type="radio" id="rdoApplyBackground_All" name="rdoApplyBackground" value="1" /></td>';
a+="<td>"+ID_RES_PROP_TAG_STRING_ALL_CELL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};propTagTableCellStyle.prototype.buildTagTableCellStyleCommon=function(){return'<div style="height:1px;width:380px;"></div>'};propTagTableCellStyle.prototype.initPropTagTableCellStyle=function(a,b){try{this.arrInitBorderAttribute=this.arrInitCellAttribute=g_strBackgroundImageURL=null;this.objChkBorderCollapse=g_objLayerKit.getElementById("dze_idx_table_bordercollapse");
var d=!0;this.objChkBorderCollapse&&(d=g_objTableUtil.getTableBorderCollapse(a),this.objChkBorderCollapse.checked=d);duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,"","g_objPropTagCommon.onChangeSpinnerValue");this.objTxtBorderWidth=g_objLayerKit.getElementById("txtBorderWidth");this.objTxtBorderWidth.value=1;g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)});var f=g_objBorderComboBoxUtil.getSubArrayObject(COMBOBOX_TYPE_BORDER_STYLE);
d=0;if(f)for(var c=0;c<f.length;c++)if("solid"===f[c]){d=c;break}g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,d);g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a)});g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.initBorderSelection();g_objBorderSelectionUtil.setBorderWidth(this.objTxtBorderWidth.value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",
0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));this.objRdoBackgroundColorUseNo=g_objLayerKit.getElementById("rdoBackgroundColorUseNo");this.objRdoBackgroundColorUseYes=g_objLayerKit.getElementById("rdoBackgroundColorUseYes");g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor");this.objRdoBackgroundColorUseNo.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)};this.objRdoBackgroundColorUseYes.onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",
!0)};this.objChkBackgroundImageUseYN=g_objLayerKit.getElementById("chkBackgroundImageUseYN");this.objFileBackgroundImage=g_objLayerKit.getElementById("fileBackgroundImage");duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.onChangeImgSrc()});duzon_dialog.disableExtFileForm("fileBackgroundImage");duzon_dialog.disableImageUrlForm("txtReadBackgroundImageURL");this.objSelBackgroundRepeat=g_objLayerKit.getElementById("selBackgroundRepeat");this.objSelBackgroundRepeat.onchange=
function(){g_objPropTagCommon.setSelectedTableCustomStyle()};this.objChkBackgroundImageUseYN.onclick=function(a){g_objPropTagCommon.setSelectedTableCustomStyle();this.checked?(duzon_dialog.enableExtFileForm("fileBackgroundImage"),p.objSelBackgroundRepeat.disabled=!1):(duzon_dialog.disableExtFileForm("fileBackgroundImage"),p.objSelBackgroundRepeat.disabled=!0)};this.objRdoApplyBackground_All=g_objLayerKit.getElementById("rdoApplyBackground_All");this.objRdoApplyBackground_Selected=g_objLayerKit.getElementById("rdoApplyBackground_Selected");
this.objRdoApplyBackground_Selected.checked=!0;this.arrInitCellAttribute=g_objTableFunction.getSelectedCellAttribute(g_objEditorDocument[b],a,b);null!=this.arrInitCellAttribute&&(this.arrInitBorderAttribute=this.arrInitCellAttribute[0][1].slice(),g_objBorderSelectionUtil.initPropTagTableCellStyleBorder(this.arrInitCellAttribute[ID_PROP_NODE_BORDER]),null==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?(this.objRdoBackgroundColorUseNo.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",
!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff")):(this.objRdoBackgroundColorUseYes.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR])),null==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?(this.objFileBackgroundImage.disabled=!0,this.objSelBackgroundRepeat.disabled=!0):(this.objChkBackgroundImageUseYN.checked=!0,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=
this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0],"repeat"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?this.objSelBackgroundRepeat.selectedIndex=0:"repeat-x"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?this.objSelBackgroundRepeat.selectedIndex=1:"repeat-y"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?this.objSelBackgroundRepeat.selectedIndex=2:"no-repeat"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]&&(this.objSelBackgroundRepeat.selectedIndex=
3),duzon_dialog.enableExtFileForm("fileBackgroundImage")))}catch(e){dalert(e)}};propTagTableCellStyle.prototype.getPropSettingData=function(){try{var a=[];a[ID_PROP_NODE_GENERAL]=[null,null,null,null,null,null,null,null,null,this.objChkBorderCollapse?this.objChkBorderCollapse.checked:!1];var b=!0,d=g_objBorderSelectionUtil.bHide_MiniRec_h_1?!1:!0,f=g_objBorderSelectionUtil.bHide_MiniRec_v_1?!1:!0,c=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0");""===c&&(c=ID_PROP_BORDER_DUPLICATED);var e=
"";d&&(e=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),""===e&&(e=ID_PROP_BORDER_DUPLICATED));var l=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2");""===l&&(l=ID_PROP_BORDER_DUPLICATED);var g=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0");""===g&&(g=ID_PROP_BORDER_DUPLICATED);var h="";f&&(h=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),""===h&&(h=ID_PROP_BORDER_DUPLICATED));var n=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2");""===n&&(n=ID_PROP_BORDER_DUPLICATED);
c==this.arrInitBorderAttribute[0]&&e==this.arrInitBorderAttribute[1]&&l==this.arrInitBorderAttribute[2]&&g==this.arrInitBorderAttribute[3]&&h==this.arrInitBorderAttribute[4]&&g==this.arrInitBorderAttribute[5]&&(b=!1);a[ID_PROP_NODE_BORDER]=[b,!0,d,!0,!0,f,!0,c,e,l,g,h,n];var k=this.objRdoApplyBackground_All.checked;b=null;this.objRdoBackgroundColorUseYes.checked&&(b=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));a[ID_PROP_NODE_BACKGROUND_COLOR]=b==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?
[k,!1,b]:[k,!0,b];b=null;this.objChkBackgroundImageUseYN.checked&&(b=g_objLayerKit.getElementById("txtReadBackgroundImageURL").value);var m=this.objSelBackgroundRepeat.value;a[ID_PROP_NODE_BACKGROUND_IMAGE]=b==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?m==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?[k,!1,b,m]:[k,!0,b,m]:[k,!0,b,m];return a}catch(q){dalert(q)}return null};propTagTableCellStyle.prototype.checkBorderDuplicatedValue=function(a){}},g_objPropTagTableCellStyle=
new propTagTableCellStyle;

var propTagTableSplitCell=function(){var d=this;this.bSplitRow=!0;this.nSplitCount=-1;this.objRadioCol=this.objRadioRow=null;propTagTableSplitCell.prototype.buildTagTableSplitCell=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SPLIT_ROW_COL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="76"><input type="radio" id="rdoSplitCellRow" name="rdoSplitCell" value="0" /><label for="rdoSplitCellRow" style="background: none;">'+ID_RES_PROP_TAG_STRING_ROW_NUM+"</label></td>";a+='<td width="50"></td>';a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtPropSplitCellRow","",20,2)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;">';a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="76"><input type="radio" id="rdoSplitCellCol" name="rdoSplitCell" value="1" /><label for="rdoSplitCellCol" style="background: none;">'+ID_RES_PROP_TAG_STRING_COL_NUM+"</label></td>";a+='<td width="50"></td>';a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtPropSplitCellCol","",20,2)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:220px;"></div>'}catch(b){dalert(b)}};propTagTableSplitCell.prototype.initPropTagTableSplitCell=
function(){try{duzon_dialog.modifySpinnerValue("txtPropSplitCellRow",20,2,"","");duzon_dialog.modifySpinnerValue("txtPropSplitCellCol",20,2,"","");this.bSplitRow=!0;this.nSplitCount=-1;this.objRadioRow=g_objLayerKit.getElementById("rdoSplitCellRow");this.objRadioRow.checked=!0;this.objRadioCol=g_objLayerKit.getElementById("rdoSplitCellCol");var a=g_objLayerKit.getElementById("txtPropSplitCellRow"),b=g_objLayerKit.getElementById("txtPropSplitCellCol");a.value=2;b.value="";this.objRadioRow.onclick=
function(c){d.switchSplitCell(!0);a.value=2;b.value=""};this.objRadioCol.onclick=function(c){d.switchSplitCell(!1);a.value="";b.value=2};this.switchSplitCell(!0)}catch(c){dalert(c)}};propTagTableSplitCell.prototype.switchSplitCell=function(a){try{a?(duzon_dialog.setEnableSpinner("txtPropSplitCellRow",!0),duzon_dialog.setEnableSpinner("txtPropSplitCellCol",!1)):(duzon_dialog.setEnableSpinner("txtPropSplitCellRow",!1),duzon_dialog.setEnableSpinner("txtPropSplitCellCol",!0))}catch(b){dalert(b)}};propTagTableSplitCell.prototype.getPropSettingData=
function(){try{if(g_objLayerKit.getElementById("rdoSplitCellRow").checked){this.bSplitRow=!0;var a=g_objLayerKit.getElementById("txtPropSplitCellRow");this.nSplitCount=parseInt(a.value)}else{this.bSplitRow=!1;var b=g_objLayerKit.getElementById("txtPropSplitCellCol");this.nSplitCount=parseInt(b.value)}}catch(c){dalert(c)}}},g_objPropTagTableSplitCell=new propTagTableSplitCell;

var propTagTableAddRowCol=function(){var c=this;this.objTxtColCount=this.objTxtRowCount=this.objRadioColRight=this.objRadioColLeft=this.objRadioCol=this.objRadioRowBottom=this.objRadioRowTop=this.objRadioRow=null;this.bAddRow=!0;this.nAddCount=this.nAddDirection=-1;propTagTableAddRowCol.prototype.buildTagTableAddRowCol=function(){try{var a="";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td style="vertical-align:top;">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="24"><input type="radio" id="rdoAddRow" name="rdoAddRowCol" value="0" /></td>';a+='<td width="70">'+ID_RES_PROP_TAG_ADD_ROW+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="50"></td>';a+='<td width="24"><input type="radio" id="rdoAddRowTop" name="rdoAddRowTopBottom" value="0" /></td>';
a+='<td width="50" height="22">'+ID_RES_PROP_TAG_UP+"</td>";a+='<td width="90"></td>';a+='<td width="40" rowspan="2">'+ID_RES_PROP_TAG_STRING_ROW_NUM+"</td>";a+='<td rowspan="2">'+duzon_dialog.makeSpinnerInputForm("txtAddRowCount","",10,1)+"</td>";a+="</tr>";a+="<tr>";a+='<td width="50"></td>';a+='<td width="24"><input type="radio" id="rdoAddRowBottom" name="rdoAddRowTopBottom" value="0" /></td>';a+='<td width="50" height="22">'+ID_RES_PROP_TAG_DOWN+"</td>";a+='<td width="90"></td>';a+="</tr>";a+=
"</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:20px;">';a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="24"><input type="radio" id="rdoAddCol" name="rdoAddRowCol" value="1" /></td>';a+='<td width="70">'+ID_RES_PROP_TAG_ADD_COL+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;"></td>';a+="</tr>";a+="<tr>";
a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="24"><input type="radio" id="rdoAddColLeft" name="rdoAddColLeftRight" value="0" /></td>';a+='<td width="40">'+ID_RES_DIALOG_STRING_ALIGN_LEFT+"</td>";a+='<td width="24"><input type="radio" id="rdoAddColRight" name="rdoAddColLeftRight" value="0" /></td>';a+='<td width="40">'+ID_RES_DIALOG_STRING_ALIGN_RIGHT+"</td>";a+='<td width="56"></td>';a+='<td width="40">'+
ID_RES_PROP_TAG_STRING_COL_NUM+"</td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtAddColCount","",10,1)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:320px;"></div>'}catch(b){dalert(b)}};propTagTableAddRowCol.prototype.initPropTagTableAddRowCol=function(){try{duzon_dialog.modifySpinnerValue("txtAddRowCount",10,1,"",""),duzon_dialog.modifySpinnerValue("txtAddColCount",10,1,"",""),this.objRadioRow=g_objLayerKit.getElementById("rdoAddRow"),
this.objRadioRowTop=g_objLayerKit.getElementById("rdoAddRowTop"),this.objRadioRowBottom=g_objLayerKit.getElementById("rdoAddRowBottom"),this.objTxtRowCount=g_objLayerKit.getElementById("txtAddRowCount"),this.objRadioRow.checked=!0,this.objRadioRowTop.checked=!0,this.objTxtRowCount.value=1,this.objRadioCol=g_objLayerKit.getElementById("rdoAddCol"),this.objRadioColLeft=g_objLayerKit.getElementById("rdoAddColLeft"),this.objRadioColRight=g_objLayerKit.getElementById("rdoAddColRight"),this.objTxtColCount=
g_objLayerKit.getElementById("txtAddColCount"),this.objRadioColLeft.checked=!0,this.objTxtColCount.value=1,this.objRadioRow.onclick=function(a){c.switchAddRowCol(!0)},this.objRadioCol.onclick=function(a){c.switchAddRowCol(!1)},this.switchAddRowCol(!0)}catch(a){dalert(a)}};propTagTableAddRowCol.prototype.switchAddRowCol=function(a){try{a?(this.objRadioRowTop.disabled=!1,this.objRadioRowBottom.disabled=!1,duzon_dialog.setEnableSpinner("txtAddRowCount",!0),this.objRadioColLeft.disabled=!0,this.objRadioColRight.disabled=
!0,duzon_dialog.setEnableSpinner("txtAddColCount",!1)):(this.objRadioRowTop.disabled=!0,this.objRadioRowBottom.disabled=!0,duzon_dialog.setEnableSpinner("txtAddRowCount",!1),this.objRadioColLeft.disabled=!1,this.objRadioColRight.disabled=!1,duzon_dialog.setEnableSpinner("txtAddColCount",!0))}catch(b){dalert(b)}};propTagTableAddRowCol.prototype.getPropSettingData=function(){try{this.objRadioRow.checked?(this.bAddRow=!0,this.nAddDirection=this.objRadioRowTop.checked?0:1,this.nAddCount=parseInt(this.objTxtRowCount.value)):
(this.bAddRow=!1,this.nAddDirection=this.objRadioColLeft.checked?0:1,this.nAddCount=parseInt(this.objTxtColCount.value))}catch(a){dalert(a)}}},g_objPropTagTableAddRowCol=new propTagTableAddRowCol;

var propTagTableSelectFormula=function(){var n=this;this.objTableNode=this.objOutlineUtil=this.objTableCopyView=null;this.nSelectedCol=this.nSelectedRow=-1;this.arrRowCol=[];this.objFormulaResult=this.objFormulaData=this.objRadioMutiply=this.objRadioAverage=this.objRadioSum=null;this.strInfoString="\uc801\uc6a9\ud560 \uc140\uc744 \ud3b8\uc9d1\ucc3d\uc5d0\uc11c \uc120\ud0dd\ud558\uc138\uc694";this.strNaNString="\uacc4\uc0b0 \ubd88\uac00\ud55c \ud56d\ubaa9\uc774 \uc120\ud0dd\ub418\uc5c8\uc2b5\ub2c8\ub2e4";
this.bShowTagTableSelectFormula=!1;propTagTableSelectFormula.prototype.buildTagTableSelectFormula=function(){try{this.strInfoString=ID_RES_PROP_TAG_STRING_SELECT_CELL_EDITOR;this.strNaNString=ID_RES_PROP_TAG_STRING_NO_CALC_SELECTED_CELL;var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SELECT_CELL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="formulaData" style="height:80px;text-align:center;" class="mappingCode_preview propSection_td">';
a+=this.strInfoString;a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_CALC_TYPE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td><input type="radio" id="rdoFormulaSum" name="rdoFormula" value="0" /> '+ID_RES_PROP_TAG_STRING_CALC_SUM+"</td>";a+='<td><input type="radio" id="rdoFormulaAverage" name="rdoFormula" value="1" /> '+
ID_RES_PROP_TAG_STRING_CALC_AVG+"</td>";a+='<td><input type="radio" id="rdoFormulaMutiply" name="rdoFormula" value="2" /> '+ID_RES_PROP_TAG_STRING_CALC_MUL+"</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_CALC_RESULT+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="formulaResult" style="height:40px;text-align:center;" class="mappingCode_preview propSection_td">';
a+=this.strInfoString;a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:320px;"></div>'}catch(b){dalert(b)}};propTagTableSelectFormula.prototype.initPropTagTableSelectFormula=function(a,b,d,f){try{this.objRadioSum=g_objLayerKit.getElementById("rdoFormulaSum"),this.objRadioAverage=g_objLayerKit.getElementById("rdoFormulaAverage"),this.objRadioMutiply=g_objLayerKit.getElementById("rdoFormulaMutiply"),this.objRadioSum.checked=!0,this.objRadioSum.onclick=function(a){n.displayData()},
this.objRadioAverage.onclick=function(a){n.displayData()},this.objRadioMutiply.onclick=function(a){n.displayData()},this.objFormulaData=g_objLayerKit.getElementById("formulaData"),this.objFormulaResult=g_objLayerKit.getElementById("formulaResult"),this.objTableNode=a,this.nSelectedRow=b,this.nSelectedCol=d,this.arrRowCol=[],this.showTableCopyView(!0,a,b,d,f)}catch(c){dalert(c)}};propTagTableSelectFormula.prototype.initTableCopyView=function(){try{if(null==this.objTableCopyView){if(!g_objLayerKit.getElementById("tableCopyView")&&
!g_objInsertUtil.insertLayerHTML('<div id="tableCopyView" style="display:none;position:absolute;z-index:20028;border:0px;background-color:;filter:alpha(opacity=60);opacity:0.6;"></div>',!0))return;this.objTableCopyView=g_objLayerKit.getElementById("tableCopyView")}null==this.objOutlineUtil&&(this.objOutlineUtil=new outlineUtil,this.objOutlineUtil.initializeExtOutline(!1),this.objOutlineUtil.setZIndexExtOutline(20029))}catch(a){dalert(a)}};propTagTableSelectFormula.prototype.showTableCopyView=function(a,
b,d,f,c){try{if(a){this.bShowTagTableSelectFormula=!0;null==this.objTableCopyView&&this.initTableCopyView();var e=g_objPositionUtil.getOuterRect(b),k=g_objPositionUtil.getOuterRect(g_objEditObject[c]),m=g_objPositionUtil.getFrameClientRect(),p=m.left+k.left+e.left,q=m.top+k.top+e.top,r=p+e.width,n=q+e.height;this.objTableCopyView.style.left=p+"px";this.objTableCopyView.style.top=q+"px";this.objTableCopyView.style.width=r-p+"px";this.objTableCopyView.style.height=n-q+"px";this.objTableCopyView.style.display=
"";a=null;e="";for(var g=0;g<b.rows.length;g++)for(var u=g_objTableUtil.getTableCellsLength(b,g),h=0;h<u;h++)if(g!=d||h!=f)null===a&&(a={i:g,j:h}),e+='<input type="checkbox" id="chkFormula_'+g+"_"+h+'" style="position:absolute;" />';this.objTableCopyView.innerHTML=e;r=e=!1;var y=a?g_objLayerKit.getElementById("chkFormula_"+a.i+"_"+a.j):null,z=y?y.offsetWidth:13,A=isShowScrollBar(c);for(g=0;g<b.rows.length;g++){var B=g_objPositionUtil.getElementPosClientRect(b.rows[g]);e=0>B.top||B.top+z+2+(A.horizontal?
20:0)>=k.height?!0:!1;u=g_objTableUtil.getTableCellsLength(b,g);for(h=0;h<u;h++)if(g!=d||h!=f){var v=g_objTableUtil.getTableCellElement(b,g,h),l=g_objPositionUtil.getElementPosClientRect(v);objCheckBox=g_objLayerKit.getElementById("chkFormula_"+g+"_"+h);r=l.left<k.left||l.left+z+2+(A.vertical?20:0)>=k.width?!0:!1;if(!0===e||!0===r)objCheckBox.style.display="none";else{objCheckBox.style.display="";var w=m.left+k.left+l.left,x=m.top+k.top+l.top;objCheckBox.style.left=w-p+1+"px";objCheckBox.style.top=
x-q+1+"px";(function(){var a=g,b=h;objCheckBox.onclick=function(c){g_objPropTagTableSelectFormula.clickCheckBox(this,a,b)}})()}}}v=g_objTableUtil.getTableCellElement(b,d,f);l=g_objPositionUtil.getElementPosClientRect(v);var t=g_objPositionUtil.getElementPosition(g_objEditObject[c],!1);w=t.left+l.left;x=t.top+l.top;this.objOutlineUtil.showExtOutline(!0,!1,!1,w,x,t.left+l.right,t.top+l.bottom,!1,!1)}else this.bShowTagTableSelectFormula=!1,this.objTableCopyView.style.display="none",this.objOutlineUtil.showExtOutline(!1,
!1,!1,0,0,0,0,!1,!1)}catch(C){dalert(C)}};propTagTableSelectFormula.prototype.clickCheckBox=function(a,b,d){try{for(var f=!1,c=0;c<this.arrRowCol.length;c++)if(b==this.arrRowCol[c][0]&&d==this.arrRowCol[c][1]){f=!0;break}a.checked?f||(this.arrRowCol[this.arrRowCol.length]=[b,d]):f&&(this.arrRowCol=this.removeKeyValueInArray(this.arrRowCol,b,d));this.displayData()}catch(e){dalert(e)}};propTagTableSelectFormula.prototype.removeKeyValueInArray=function(a,b,d){try{for(var f=[];0<a.length;){var c=a.shift();
if(b!=c[0]||d!=c[1])f[f.length]=c}return f}catch(e){dalert(e)}};propTagTableSelectFormula.prototype.displayData=function(){try{this.strInfoString=ID_RES_PROP_TAG_STRING_SELECT_CELL_EDITOR;this.strNaNString=ID_RES_PROP_TAG_STRING_NO_CALC_SELECTED_CELL;for(var a="",b=[],d=0;d<this.arrRowCol.length;d++){var f=g_objTableUtil.getTableCellElement(this.objTableNode,this.arrRowCol[d][0],this.arrRowCol[d][1]),c=g_objPropertyUtil.getTextContent(f);c=c.trim().replace(/[\u200B-\u200D\uFEFF]|(\\n|\\r)+/g,"");
c=c.removeComma();if(0!=c.localeCompare("")){if(isNaN(c)){this.objFormulaData.innerHTML=this.strNaNString;this.objFormulaResult.innerHTML=this.strNaNString;return}a=""==a?c:a+(" : "+c);b[d]=parseFloat(c)}}if(""==a)this.objFormulaData.innerHTML=this.strInfoString,this.objFormulaResult.innerHTML=this.strInfoString;else{this.objFormulaData.innerHTML=a;var e=this.getFormulaCode(),k=g_objTableFunction.doFormulaData(b,e);null!=k&&(this.objFormulaResult.innerHTML=k)}}catch(m){dalert(m)}};propTagTableSelectFormula.prototype.getFormulaCode=
function(){try{return this.objRadioSum.checked?0:this.objRadioAverage.checked?1:this.objRadioMutiply.checked?2:-1}catch(a){dalert(a)}};propTagTableSelectFormula.prototype.setFormulaResultValue=function(){try{if(this.strInfoString!=this.objFormulaResult.innerHTML&&""!=this.objFormulaResult.innerHTML){var a=g_objTableUtil.getTableCellElement(this.objTableNode,this.nSelectedRow,this.nSelectedCol);g_objTableUtil.setCellInnerText(this.objFormulaResult.innerHTML,a)}}catch(b){dalert(b)}}},g_objPropTagTableSelectFormula=
new propTagTableSelectFormula;

var propContentLink=function(){propContentLink.prototype.getPropContentParam=function(b){try{var a={arrValue:[]};a.arrValue[0]="";a.arrValue[1]="";a.arrValue[2]="";a.arrValue[3]="";a.arrValue[4]="";var d=this.setLinkSelection(b);fnObjectCheckNull(d)?a.arrValue[0]="":(a.arrValue[0]=""==d[0]?"":d[0],a.arrValue[1]=d[1],a.arrValue[2]=d[2],a.arrValue[3]=d[3],a.arrValue[4]=d[4]);return a}catch(e){dalert(e)}return null};propContentLink.prototype.setLinkHTML=function(b,a,d){try{var e=b[0],f="",h="",c="";
f=b[1];h=b[2];"undefined"!=typeof b[3]&&(c=b[3]);if(!fnObjectCheckNull(g_objEditorDocument[a])){if(window.attachEvent){var k=g_objEditorDocument[a].selection;if(fnObjectCheckNull(k))return;var g=k.type;g=g.toLowerCase();if(ID_STRING_NAME_NONE==g||ID_STRING_NAME_TEXT==g){var q=k.createRange();if(fnObjectCheckNull(q))return 0;var n=new Date,r=n.getTime(),p="#"+r;g_objEditorDocument[a].execCommand("CreateLink",!1,p);for(var m=g_objEditorDocument[a].getElementsByTagName("A"),l=0;l<m.length;l++){var v=
m[l].href,w=v.indexOf(p,0);-1!=w&&(m[l].href=e,this.setLinkHTMLDetail(m[l],h,f,c))}}else if(ID_STRING_NAME_CONTROL==g){var u=k.createRange();if(fnObjectCheckNull(u)||1!=u.length)return;var x=u.item(0);g_objEditorDocument[a].execCommand(ID_STRING_COMMAND_UNLINK,!1,null);var z=x.parentElement;if(fnObjectCheckNull(z))return;var t=g_objEditorDocument[a].createElement("a");t.href=e;z.insertBefore(t,x);t.appendChild(x);this.setLinkHTMLDetail(t,h,f,c);u.select()}}else{g=getSelectionTypeForUpdateUI();if((ID_STRING_NAME_NONE==
g||ID_STRING_NAME_TEXT==g)&&g_bBrowserType_WK&&"a"!==getSelectionType().nodeName.toLowerCase()&&""==getSelectionTextValue(a))return;(t=g_objNodeUtil.getSelectionElement_Anchor("A",!0,a))&&g_objEditorDocument[a].execCommand(ID_STRING_COMMAND_UNLINK,!1,null);n=new Date;r=n.getTime();p="#"+r;b=!1;g=null;if(g_bBrowserType_IE&&g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase()){b=!0;var y=
g_objObjectSelectionInfo.objSelectionObject,A=g_objNodeUtil.getParentElement(y);g=g_objEditorDocument[a].createElement("a");g.href=p;A.insertBefore(g,y);g.appendChild(y)}b||g_objEditorDocument[a].execCommand(ID_STRING_COMMAND_CREATELINK,!1,p);m=g_objEditorDocument[a].getElementsByTagName("A");for(l=0;l<m.length;l++)v=m[l].href,w=v.indexOf(p,0),-1!=w&&(m[l].href=e,this.setLinkHTMLDetail(m[l],h,f,c));b&&(k=g_objEditWindow[a].getSelection(),k.selectAllChildren(g))}!1===d&&g_objUndoRedo.registerUndoRedoStack(0,
a)}}catch(B){dalert(B)}};propContentLink.prototype.setLinkHTMLDetail=function(b,a,d,e){try{if(!fnObjectCheckNull(b)&&("undefined"==typeof e&&(e=""),"A"==b.tagName.toUpperCase())){if(""!=a)b.title=a;else try{b.removeAttribute("title")}catch(f){}if(""!=d)b.target=d;else try{b.removeAttribute("target")}catch(f){}""!=e&&b.innerHTML!=e&&(b.innerHTML=e)}}catch(f){dalert(f)}};propContentLink.prototype.setLinkSelection=function(b){try{if(fnObjectCheckNull(g_objEditorDocument[b]))return null;if(window.attachEvent){var a=
g_objEditorDocument[b].selection;if(fnObjectCheckNull(a))return null;var d=a.type;d=d.toLowerCase();var e=null;if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var f=a.createRange();if(fnObjectCheckNull(f))return null;var h=a.createRange();if(fnObjectCheckNull(h))return null;h.setEndPoint("EndToStart",f);a=b=!0;for(d=!1;b;){a?(h.moveEnd("character",1),a=!1):(h.moveStart("character",1),h.moveEnd("character",1));if(""==h.htmlText)break;var c=null;if(f.inRange(h))for(c=h.parentElement();!fnObjectCheckNull(c);){var k=
c.tagName;if("A"==k.toUpperCase()){d=!0;b=!1;break}c=c.parentElement}else break;if(d&&(f.moveToElementText(c),f.select(),e=this.getLinkInfo(c),null==e))return null}if(!d)for(c=f.parentElement();!fnObjectCheckNull(c);){k=c.tagName;if("A"==k.toUpperCase()){f.moveToElementText(c);f.select();e=this.getLinkInfo(c);if(null==e)return null;break}c=c.parentElement}return e}if(ID_STRING_NAME_CONTROL==d){var g=a.createRange();if(fnObjectCheckNull(g)||1!=g.length)return null;var q=g.item(0);k=q.tagName;if("A"==
k.toUpperCase()){if(e=this.getLinkInfo(q),null==e)return null}else for(c=q.parentElement;!fnObjectCheckNull(c);){if("A"==c.tagName.toUpperCase()){e=this.getLinkInfo(c);if(null==e)return null;break}c=c.parentElement}return e}}else{var n=g_objNodeUtil.getSelectionElement_Anchor("A",!0,b);if(!n)return null;e=this.getLinkInfo(n);return null==e?null:e}}catch(r){dalert(r)}return null};propContentLink.prototype.getLinkInfo=function(b){try{if(fnObjectCheckNull(b))return null;var a=b.href;"http:///"==a.toLowerCase()?
a="http://":"http:"==a.toLowerCase()&&(a="http://");var d=checkAnchorHrefSharp(a);null!=d&&(a=d);var e=b.target,f=b.title;d="";b.getAttribute("type")&&(d=b.getAttribute("type"));var h=b.innerHTML,c=Array(4);c[0]=a;c[1]=e;c[2]=f;c[3]=d;c[4]=h;return c}catch(k){dalert(k)}return null}},g_objPropContentLink=new propContentLink;

var layerKit=function(){layerKit.prototype.getLayerDocument=function(){try{var a=null;return a=dzeEnvConfig.iFrameLayer?window.parent.document:document}catch(b){dalert(b)}return null};layerKit.prototype.getElementById=function(a){try{return this.getLayerDocument().getElementById(a)}catch(b){dalert(b)}return null};layerKit.prototype.getLayerWindow=function(){try{var a=null;return a=dzeEnvConfig.iFrameLayer?window.parent.window:window}catch(b){dalert(b)}return null}},g_objLayerKit=new layerKit;

var dze_menu_control={nEditNumber:0,setEditNumber:function(a){try{"undefined"!=typeof a&&(this.nEditNumber=a)}catch(c){dalert(c)}},tb_menu_list:[],setTbMenuList:function(){try{this.tb_menu_list=[ID_RES_TOOL_STRING_MENU_FILE,ID_RES_TOOL_STRING_MENU_EDIT,ID_RES_TOOL_STRING_MENU_INSERT,ID_RES_TOOL_STRING_MENU_BASIC,ID_RES_TOOL_STRING_MENU_VIEW,ID_RES_TOOL_STRING_MENU_TABLE,ID_RES_CONST_STRING_INSERT_IMAGE]}catch(a){dalert(a)}},idxDynamicMenuStart:5,idxTableMenu:5,idxImagePropertyMenu:6,tb_menu_content_left_list:[],
setTbMenuContentLeftList:function(){try{this.tb_menu_content_left_list=[[-4],[ID_CUSTOM_UNDO,ID_CUSTOM_REDO,4],[-4]]}catch(a){dalert(a)}},tb_menu_content_list:[],setTbMenuContentList:function(){try{this.tb_menu_content_list=[[[-4],[ID_CUSTOM_FILE_NEW,1],[ID_CUSTOM_FILE_OPEN,1],[-4],[1],[-4],[ID_CUSTOM_FILE_LAYOUT,1],[-4],[1],[-4],[ID_CUSTOM_SAVEAS,1],[ID_CUSTOM_PRINT,1]],[[-4],[ID_CUSTOM_PASTE_EXT,1],[-4],[1],[-4],[ID_CUSTOM_CUT,1],[ID_CUSTOM_COPY_EXT,1],[-4],[1],[-4],[ID_CUSTOM_DELETE,1],[ID_CUSTOM_SELECT_ALL,
1],[-4],[1],[-4],[ID_CUSTOM_EDIT_PRIINT_PAGE_BREAK,1],[-4],[1],[-4],[ID_CUSTOM_EDIT_SEARCH,1],[ID_CUSTOM_EDIT_REPLACE,1],[ID_CUSTOM_EDIT_REPLACE_CASE,1]],[[-4],[ID_CUSTOM_TABLE_CREATE,1],[ID_CUSTOM_DRAW_TABLE,1],[-4],[1],[-4],[ID_CUSTOM_INSERT_IMAGE,1],[ID_CUSTOM_INSERT_OBJECT_MOVIE,1],[ID_CUSTOM_INSERT_EMOTICONS,1],[ID_CUSTOM_INSERT_OBJECT_FILE,1],[-4],[1],[-4],[ID_CUSTOM_HYPERLINK_INSERT,1],[-4],[1],[-4],[ID_CUSTOM_INSERT_BOOKMARK,1],[ID_CUSTOM_INSERT_OBJECT_HR,1],[ID_CUSTOM_INSERT_SPECIALCHARS,
1],[-4],[1],[-4],[ID_CUSTOM_SELECT_PARAGRAPH,1]],[[-4],[ID_CUSTOM_STYLE_FONT,1],[-4],[1],[-4],[ID_CUSTOM_STYLE_PARAGRAPH,1],[-4],[1],[-4],[ID_CUSTOM_SUPERSCRIPT,ID_CUSTOM_SUBSCRIPT,4],[ID_CUSTOM_INDENT,ID_CUSTOM_OUTDENT,4],[-4],[1],[-4],[ID_CUSTOM_INSERT_UNORDERED_LIST,1],[ID_CUSTOM_INSERT_ORDERED_LIST,1],[ID_CUSTOM_STYLE_CASCADE_ORDERLIST,1],[ID_CUSTOM_STYLE_INCREASEORDER,ID_CUSTOM_STYLE_DECREASEORDER,4],[-4],[1],[-4],[ID_CUSTOM_JUSTIFY_LEFT,1],[ID_CUSTOM_JUSTIFY_CENTER,1],[ID_CUSTOM_JUSTIFY_RIGHT,
1],[ID_CUSTOM_JUSTIFY_JUSTIFY,1]],[[-4],[ID_CUSTOM_VIEW_EDIT,1],[-4],[1],[-4],[ID_CUSTOM_VIEW_HTML,1],[-4],[1],[-4],[ID_CUSTOM_FULLSCREEN,1],[-4],[1],[-4],[ID_CUSTOM_PREVIEW,1]],[[-4],[ID_CUSTOM_TABLE_PROPERTY,1],[ID_CUSTOM_TABLE_CELL_PROPERTY,1],[ID_CUSTOM_TABLE_CELL_STYLE,1],[-4],[1],[-4],[ID_CUSTOM_TABLE_CELL_BACKCOLOR,ID_CUSTOM_TABLE_BORDER_THICKNESS,4],[ID_CUSTOM_TABLE_BORDER_TYPE,ID_CUSTOM_TABLE_BORDER_COLOR,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_ADD_ROW,ID_CUSTOM_TABLE_ADD_COL,4],[ID_CUSTOM_TABLE_ADD_ROW_DOWN,
ID_CUSTOM_TABLE_ADD_COL_RIGHT,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_DELETE_EXT,1],[-4],[1],[-4],[ID_CUSTOM_TABLE_MERGE_CELL,ID_CUSTOM_TABLE_SPLIT_CELL,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_CELL_SAME_HEIGHT,ID_CUSTOM_TABLE_CELL_SAME_WIDTH,4],[-4],[1],[-4],[ID_CUSTOM_TABLE_CELL_ALIGN,1],[ID_CUSTOM_TABLE_STYLE,1],[ID_CUSTOM_TABLE_SELECT,1],[-4],[1],[-4],[ID_CUSTOM_TABLE_FORMULA_EXT,ID_CUSTOM_TABLE_SELECT_FORMULA,4],[ID_CUSTOM_TABLE_NUMBER_FORMAT,ID_CUSTOM_TABLE_CONVERT_TEXT,4]],[[-4],[ID_CUSTOM_IMAGE_PROPERTY,
1],[-4],[1],[-4],[ID_CUSTOM_IMAGE_BORDER_TYPE,1],[ID_CUSTOM_IMAGE_BORDER_THICKNESS,1],[ID_CUSTOM_IMAGE_BORDER_COLOR,1],[-4],[1],[-4],[ID_CUSTOM_IMAGE_HEIGHT,ID_CUSTOM_IMAGE_WIDTH,2],[-4],[1],[-4],[ID_CUSTOM_IMAGE_RESET_PICTURE,1]]]}catch(a){dalert(a)}},tb_menu_content_bottom_list:[],setTbMenuContentBottomList:function(){try{this.tb_menu_content_bottom_list=[[-4],[ID_CUSTOM_HEADING_SIZE,5],[-4],[ID_CUSTOM_FONT_NAME,5],[-4],[ID_CUSTOM_FONT_SIZE,5],[-4],[ID_CUSTOM_STYLE_INCREASE_FONTSIZE,5],[ID_CUSTOM_STYLE_DECREASE_FONTSIZE,
5],[-4],[ID_CUSTOM_LINE_HEIGHT,5],[-4],[ID_CUSTOM_LETTER_SPACING,5],[-4],[ID_CUSTOM_BOLD,5],[ID_CUSTOM_ITALIC,5],[ID_CUSTOM_UNDERLINE,5],[ID_CUSTOM_STRIKE,5],[ID_CUSTOM_FORE_COLOR,5],[ID_CUSTOM_BACK_COLOR,5]]}catch(a){dalert(a)}},tb_menu_content_help_list:[],setTbMenuContentHelpList:function(){try{this.tb_menu_content_help_list=[ID_CUSTOM_HELP_SHORTCUTS,ID_CUSTOM_HELP_INFO]}catch(a){dalert(a)}},allTbCommandIdList:[],setAllTbCommandIdList:function(){try{this.allTbCommandIdList=[];var a=this.tb_menu_content_list;
a.push(this.tb_menu_content_left_list);a.push(this.tb_menu_content_bottom_list);for(var c=0;c<a.length;c++)for(var b=a[c],d=0;d<b.length;d++)if(!(2>b[d].length))for(var e=0;e<b[d].length-1;e++)this.allTbCommandIdList.push(b[d][e])}catch(f){dalert(f)}},curr_checked_menu:[],prev_checked_menu:[],initialize:function(a){try{!0===dzeUiConfig.bUseUiMode&&(this.setEditNumber(a),this.setTbMenuList(),this.setTbMenuContentLeftList(),this.setTbMenuContentList(),this.setTbMenuContentBottomList(),this.setTbMenuContentHelpList(),
this.setAllTbCommandIdList(),this.getUiMode(),dlog("dze_menu_control.initialize, UI MODE:"+this.ui_mode),this.addRibbonUiContainer(a),this.addUiToggleBtnInBasicUi(a),this.curr_checked_menu[a]=-1,this.prev_checked_menu[a]=-1,this.showMenuUi(a),this.addEventMenuControl(a))}catch(c){dalert(c)}},addUiToggleBtnInBasicUi:function(a){try{if(this.setEditNumber(a),!0===dzeUiConfig.bUseUiMode&&"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&1<dzeUiConfig.arrCustomMenuUiType.length&&null!=document.getElementById("TB_CONTAINER_MENU_"+
a)){var c=document.getElementById("TB_CONTAINER_MENU_"+a).childNodes[0];if(null!=c){var b=c.rows[0],d=b.insertCell();d.width=20;d.align="center";d.valign="top";d.style.position="relative";d.id="TB_MENU_HELP_BTN_"+a;d.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"/toolbar/toolbar_btn_help.png'>";d=b.insertCell();d.width=20;d.align="center";d.style.position="relative";d.id="TB_MENU_UI_SWITCH_BTN_"+a;d.innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"/toolbar/toolbar_btn_adjust_doc_basic.gif'>";
this.addEventMenuUiToggleBtnInBasicUi(a)}}}catch(e){dalert(e)}},addEventMenuUiToggleBtnInBasicUi:function(a){try{this.setEditNumber(a),document.getElementById("TB_MENU_UI_SWITCH_BTN_"+a).onclick=function(c){c=c?c:window.event;dze_menu_control.showUiToggleBtnLayer(a,this);TBCancelBubbleEvent(c)},document.getElementById("TB_MENU_HELP_BTN_"+a).onclick=function(c){c=c?c:window.event;dze_menu_control.showHelpBtnLayer(a,this);TBCancelBubbleEvent(c)}}catch(c){dalert(c)}},ui_toggle_btn_layer:null,showUiToggleBtnLayer:function(a,
c){try{if("undefined"==typeof a&&(a=dze_menu_control.nEditNumber),this.removeHelpBtnLayer(),this.setEditNumber(a),null==this.ui_toggle_btn_layer){this.ui_toggle_btn_layer=document.createElement("div");this.ui_toggle_btn_layer.className="dze_ui_toggle_btn_container";var b="";b+="<table border='0' cellspacing='0' cellpadding='0' width='100%'>";b+="\t<tr><td colspan='6' height='5'></td></tr>";for(var d=ID_RES_UI_TOGGLE_STRING_RIBBON,e=0;e<dzeUiConfig.arrCustomMenuUiType.length;e++){var f="";"basic"==
dzeUiConfig.arrCustomMenuUiType[e]?(d=ID_RES_UI_TOGGLE_STRING_TOOLBAR,f="<img src='"+dzeEnvConfig.strPath_Image+"toolbar/ico_selectbox.png'>"):"ribbon"==dzeUiConfig.arrCustomMenuUiType[e]&&(d=ID_RES_UI_TOGGLE_STRING_RIBBON,f="<img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_doc_templete_black.gif'>");0<e&&(b+="\t<tr><td colspan='6' height='1'></td></tr>",b+="\t<tr><td class='dze_ui_toggle_btn_underline' colspan='6'></td></tr>",b+="\t<tr><td colspan='6' height='1'></td></tr>");b+="\t<tr class='dze_ui_toggle_btn_unit' uiType='"+
dzeUiConfig.arrCustomMenuUiType[e]+"'><td width='8'></td><td width='16'>"+f+"</td><td width='6'></td><td align='left'>"+d+"</td><td width='10'></td><td width='3'></td></tr>"}this.ui_toggle_btn_layer.innerHTML=b+"\t<tr><td colspan='6' height='5'></td></tr></table>";this.addEventUiToggleBtnLayer(a);this.setUiToggleContainerPosition(this.ui_toggle_btn_layer);c.appendChild(this.ui_toggle_btn_layer);this.ui_toggle_btn_layer.style.display="block";duzon_dialog.animateDlg(this.ui_toggle_btn_layer,"down");
g_bDynamicLayer=!0}else this.removeUiToggleBtnLayer()}catch(g){dalert(g)}},removeUiToggleBtnLayer:function(){try{null!=dze_menu_control.ui_toggle_btn_layer&&(dze_menu_control.ui_toggle_btn_layer.style.display="none",dze_menu_control.ui_toggle_btn_layer.parentNode.removeChild(dze_menu_control.ui_toggle_btn_layer),dze_menu_control.ui_toggle_btn_layer=null,g_bDynamicLayer=!1)}catch(a){dalert(a)}},addEventUiToggleBtnLayer:function(a){try{if(null!=this.ui_toggle_btn_layer){"undefined"==typeof a&&(a=dze_menu_control.nEditNumber);
for(var c=this.ui_toggle_btn_layer.getElementsByTagName("tr"),b=0;b<c.length;b++)c[b].getAttribute("uiType")&&(this.ui_mode==c[b].getAttribute("uiType")?c[b].childNodes[4].innerHTML="v":(c[b].onclick=function(b){b=b?b:window.event;dze_menu_control.setUiMode(this.getAttribute("uiType"));dze_menu_control.showMenuUi(a);dze_menu_control.removeUiToggleBtnLayer();TBCancelBubbleEvent(b)},c[b].childNodes[4].innerHTML=""),c[b].onmouseover=function(){this.className="dze_ui_toggle_btn_over"},c[b].onmouseout=
function(){this.className="dze_ui_toggle_btn_unit"},c[b].onmousedown=function(){this.className="dze_ui_toggle_btn_down"})}}catch(d){dalert(d)}},help_btn_layer:null,showHelpBtnLayer:function(a,c){try{if("undefined"==typeof a&&(a=dze_menu_control.nEditNumber),this.removeUiToggleBtnLayer(),this.setEditNumber(a),null==this.help_btn_layer){this.help_btn_layer=document.createElement("div");this.help_btn_layer.className="dze_ui_toggle_btn_container";var b="";b+="<table border='0' cellspacing='0' cellpadding='0' width='100%'>";
b+="\t<tr><td colspan='6' height='5'></td></tr>";for(var d=0;d<this.tb_menu_content_help_list.length;d++){0<d&&(b+="\t<tr><td colspan='6' height='1'></td></tr>",b+="\t<tr><td class='dze_ui_toggle_btn_underline' colspan='6'></td></tr>",b+="\t<tr><td colspan='6' height='1'></td></tr>");var e=this.tb_menu_content_help_list[d];b+="\t<tr class='dze_ui_toggle_btn_unit' commandId='"+e+"'><td width='8'></td><td width='16'>"+("<img src='"+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[e]+"'>")+"</td><td width='6'></td><td align='left'>"+
g_arrConst[e][1]+"</td><td width='10'></td><td width='3'></td></tr>"}this.help_btn_layer.innerHTML=b+"\t<tr><td colspan='6' height='5'></td></tr></table>";this.addEventHelpBtnLayer(a);this.setUiToggleContainerPosition(this.help_btn_layer);c.appendChild(this.help_btn_layer);this.help_btn_layer.style.display="block";duzon_dialog.animateDlg(this.help_btn_layer,"down");g_bDynamicLayer=!0}else this.removeHelpBtnLayer()}catch(f){dalert(f)}},removeHelpBtnLayer:function(){try{null!=dze_menu_control.help_btn_layer&&
(dze_menu_control.help_btn_layer.style.display="none",dze_menu_control.help_btn_layer.parentNode.removeChild(dze_menu_control.help_btn_layer),dze_menu_control.help_btn_layer=null,g_bDynamicLayer=!1)}catch(a){dalert(a)}},addEventHelpBtnLayer:function(a){try{if(null!=this.help_btn_layer)for(var c=this.help_btn_layer.getElementsByTagName("tr"),b=0;b<c.length;b++)if(c[b].getAttribute("commandId")){var d=c[b].getAttribute("commandId"),e=eval(g_arrConst[d][3]);(function(){var d=e;c[b].onclick=function(b){b=
b?b:window.event;d(b,this,a);dze_menu_control.removeHelpBtnLayer();TBCancelBubbleEvent(b)}})();c[b].onmouseover=function(){this.className="dze_ui_toggle_btn_over"};c[b].onmouseout=function(){this.className="dze_ui_toggle_btn_unit"};c[b].onmousedown=function(){this.className="dze_ui_toggle_btn_down"}}}catch(f){dalert(f)}},setUiToggleContainerPosition:function(a){try{a.style.top="ribbon"==this.ui_mode?"17px":"23px",a.style.left="-144px"}catch(c){dalert(c)}},addRibbonUiContainer:function(a){try{if(this.setEditNumber(a),
!0===dzeUiConfig.bUseUiMode&&"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&0<dzeUiConfig.arrCustomMenuUiType.length&&inArray("ribbon",dzeUiConfig.arrCustomMenuUiType)){var c=document.getElementById("TB_CONTAINER_"+a);if(null!=c&&!0===dzeUiConfig.bCustomize_MenuBar_Display&&0!=c.rows.length){var b=c.insertRow(1),d=b.insertCell();d.id="TB_CONTAINER_MENU_RIBBON_"+a;d.className="dze_ribbon_menu_tb_container";b.style.display="none"}}}catch(e){dalert(e)}},ui_mode:"basic",getUiMode:function(){try{this.ui_mode=
"basic";if("undefined"==typeof dzeUiConfig.arrCustomMenuUiType||0==dzeUiConfig.arrCustomMenuUiType.length||!inArray("ribbon",dzeUiConfig.arrCustomMenuUiType))return this.setUiMode(this.ui_mode),this.ui_mode;if(1==dzeUiConfig.arrCustomMenuUiType.length)return this.setUiMode(dzeUiConfig.arrCustomMenuUiType[0]),this.ui_mode;this.ui_mode=dzeUiConfig.arrCustomMenuUiType[0];if("undefined"!=typeof localStorage)try{localStorage.getItem("edtstrg_uiMode")&&(this.ui_mode=localStorage.getItem("edtstrg_uiMode"))}catch(a){dalert(a)}inArray(this.ui_mode,
dzeUiConfig.arrCustomMenuUiType)||(this.ui_mode="basic");this.setUiMode(this.ui_mode);return this.ui_mode}catch(a){dalert(a)}},setUiMode:function(a){try{if(this.ui_mode=a,"undefined"!=typeof localStorage)try{localStorage.setItem("edtstrg_uiMode",a)}catch(c){dalert(c)}}catch(c){dalert(c)}},showMenuUi:function(a){try{!0!==dzeUiConfig.bCustomize_MenuBar_Display&&this.setUiMode("basic"),"ribbon"==this.getUiMode()?dze_menu_control.showRibbonUi(a):dze_menu_control.showBasicUi(a)}catch(c){dalert(c)}},keep_check_ribbon_menu:!0,
showRibbonUi:function(a){try{this.initEditorUi(),g_bMenuBar_Display&&(document.getElementById("TB_CONTAINER_MENU_"+a).parentNode.style.display="none"),g_bToolBar1_Display&&(document.getElementById("TB_CONTAINER_TOOL_1_"+a).parentNode.style.display="none"),g_bToolBar2_Display&&(document.getElementById("TB_CONTAINER_TOOL_2_"+a).parentNode.style.display="none"),g_bToolBar3_Display&&(document.getElementById("TB_CONTAINER_TOOL_3_"+a).parentNode.style.display="none"),this.createRibbonMenu(a),document.getElementById("TB_CONTAINER_MENU_RIBBON_"+
a).parentNode.style.display="",this.moveTBIcon_BasicUi_To_TbContainer(a),this.moveTBIcon_TbContainer_To_Left_RibbonUi(a),this.moveTBIcon_TbContainer_To_Bottom_RibbonUi(a),!0!==this.keep_check_ribbon_menu&&(this.curr_checked_menu[a]=0),this.activateMenu(this.curr_checked_menu[a],a),this.setUiMode("ribbon"),g_bEditorHeightIFrameYN?this.resizeEditorHeight(a):this.resizeEditorHeight(a,g_arrEditorHeight[a]),this.addRibbonUiEvent(a),editor_onselectionchange(a)}catch(c){dalert(c)}},showBasicUi:function(a){try{if(dlog("showBasicUi"),
!0===this.ribbon_menu_created[a]||"basic"!=this.ui_mode)this.initEditorUi(),g_bMenuBar_Display&&(document.getElementById("TB_CONTAINER_MENU_"+a).parentNode.style.display=""),g_bToolBar1_Display&&(document.getElementById("TB_CONTAINER_TOOL_1_"+a).parentNode.style.display=""),g_bToolBar2_Display&&(document.getElementById("TB_CONTAINER_TOOL_2_"+a).parentNode.style.display=""),g_bToolBar3_Display&&(document.getElementById("TB_CONTAINER_TOOL_3_"+a).parentNode.style.display=""),document.getElementById("TB_CONTAINER_MENU_RIBBON_"+
a).parentNode.style.display="none",this.moveTBIcon_TbContainer_To_BasicUi(a),this.setUiMode("basic"),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,g_arrEditorHeight[a]),this.removeRibbonUiMouseEvent(a)}catch(c){dalert(c)}},resizeEditorHeight:function(a,c){try{if("undefined"==typeof a&&(a=this.nEditNumber),-1==a&&(a=this.nEditNumber),"ribbon"==this.ui_mode){200>c&&(c=200);"undefined"==typeof c?c=document.documentElement.clientHeight:dzeEnvConfig.iFrameLayer&&g_bEditorHeightIFrameYN&&
("100%"!=window.frameElement.getAttribute("height")&&(window.frameElement.style.height=c+"px"),window.frameElement.parentNode.style.height=c+"px",c=document.documentElement.clientHeight);g_nTabBarSetHeight=0;if(g_bTabBar_Display){var b=document.getElementById("TB_TABMODE_TR_CONTAINER_"+a);null!=b&&(g_nTabBarSetHeight=b.offsetHeight)}g_nToolbarSetHeight=0;var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(g_nToolbarSetHeight=d.offsetHeight);g_arrEditorHeight[a]=c;g_nEditAreaSetHeight=c-g_nToolbarSetHeight-
g_nTabBarSetHeight;if(!g_bTabBar_Display){var e=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a),f=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(e,"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=f}g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px";g_objEditSetContainer[a].setAttribute("height",g_arrEditorHeight[a]);document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a).style.height=g_nEditAreaSetHeight+"px";document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+
a).setAttribute("height",g_nEditAreaSetHeight);document.getElementById("dzeditor_Parent_"+a).style.height=g_nEditAreaSetHeight-1+"px";document.getElementById("dzeditor_"+a).style.height=g_nEditAreaSetHeight-2+"px";document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+"px";document.getElementById("TB_CONTAINER_"+a).parentNode.setAttribute("height",document.getElementById("TB_CONTAINER_"+a).offsetHeight);g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=
g_nEditAreaSetHeight-22+"px")}}catch(g){dalert(g)}},initEditorUi:function(){try{g_objLayerEventUtil.initHideDynamicLayer(),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),duzon_menubar.closeHiddenTbContainerTool(),duzon_dialog.closeExtendsDlg(),duzon_dialog.closeDialog()}catch(a){dalert(a)}},ribbon_menu_created:[],createRibbonMenu:function(a){try{if(!0!==this.ribbon_menu_created[a]){var c=document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a),b=document.getElementById("TB_CONTAINER_MENU_"+a),d=
g_objPropertyUtil.getElementStyleAttributeValue(b,"background-color",a);b='<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0" border="0">';b+='\t<tr valign="center" height="5">';b+='\t\t<td valign="center" align="center" style="background-color:'+d+'"></td>';b+="\t</tr>";b+='\t<tr valign="center">';b+='\t\t<td valign="center" align="center" style="background-color:'+d+'">';b+='\t\t\t<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0" border="0">';b+='\t\t\t\t<tr valign="center" height="24" id="TB_MENUBAR_RIBBON_'+
a+'">';b+='\t\t\t\t\t<td class="dze_ribbon_menu_left"></td>';for(d=0;d<dze_menu_control.tb_menu_list.length;d++)b=d<this.idxDynamicMenuStart?b+('\t\t\t\t\t<td id="TB_MENU_RIBBON_'+d+"_"+a+'" class="dze_ribbon_menu_off"><span>'+dze_menu_control.tb_menu_list[d]+"</span></td>"):b+('\t\t\t\t\t<td id="TB_MENU_RIBBON_'+d+"_"+a+'" class="dze_ribbon_d_menu_hide"><span>'+dze_menu_control.tb_menu_list[d]+"</span></td>");b+='\t\t\t\t\t<td class="dze_ribbon_menu_right"></td>';"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&
1<dzeUiConfig.arrCustomMenuUiType.length&&(b+='\t\t\t\t\t<td class="dze_ribbon_menu_right" width="20" valign="top" align="center" id="TB_MENU_HELP_BTN2_'+a+'"><img src="'+dzeEnvConfig.strPath_Image+'/toolbar/toolbar_btn_help.png"></td>',b+='\t\t\t\t\t<td class="dze_ribbon_menu_right" width="20" valign="top" align="center" id="TB_MENU_UI_SWITCH_BTN2_'+a+'"><img src="'+dzeEnvConfig.strPath_Image+'/toolbar/toolbar_btn_adjust_doc_basic.gif"></td>');b+="\t\t\t\t</tr>";b+="\t\t\t</table>";b+="\t\t</td>";
b+="\t</tr>";b+='\t<tr valign="center">';b+='\t\t<td id="TB_MENU_RIBBON_CONTENT_CONTAINER_'+a+'">';b+='\t\t<table border="0" width="100%" cellspacing="0" cellpadding="0">';b+="\t\t\t<tr>";b+='\t\t\t\t<td height="54" width="32" class="dze_ribbon_tb_content_left_td"><div class="dze_ribbon_tb_content_left" id="TB_MENU_RIBBON_CONTENT_LEFT_'+a+'"></div></td>';b+='\t\t\t\t<td height="54">';b+='\t\t\t\t<table border="0" width="100%" height="50" cellspacing="0" cellpadding="0">';b+="\t\t\t\t\t<tr>";b+='\t\t\t\t\t\t<td style="overflow:hidden">';
for(d=0;d<dze_menu_control.tb_menu_list.length;d++)b+='\t\t\t\t\t\t<div class="dze_ribbon_tb_content" id="TB_MENU_RIBBON_CONTENT_'+d+"_"+a+'"></div>';b+="\t\t\t\t\t\t</td>";b+="\t\t\t\t\t</tr>";b+="\t\t\t\t</table>";b+="\t\t\t\t</td>";b+="\t\t\t</tr>";b+="\t\t\t<tr>";b+='\t\t\t\t<td colspan="2" class="dze_ribbon_tb_content_bottom_td">';b+='\t\t\t\t<table border="0" width="100%" height="28" cellspacing="0" cellpadding="0">';b+="\t\t\t\t\t<tr>";b+='\t\t\t\t\t\t<td style="overflow:hidden">';b+='\t\t\t\t\t\t\t<div class="dze_ribbon_tb_content_bottom" id="TB_MENU_RIBBON_CONTENT_BOTTOM_'+
a+'"></div>';b+="\t\t\t\t\t\t</td>";b+="\t\t\t\t\t</tr>";b+="\t\t\t\t</table>";b+="\t\t\t\t</td>";b+="\t\t\t</tr>";b+="\t\t</table>";b+="\t\t</td>";c.innerHTML=b+"\t</tr></table>";dze_menu_control.addRibbonMenuEvent(a);dze_menu_control.ribbon_menu_created[a]=!0}}catch(e){dalert(e)}},addRibbonMenuEvent:function(a){try{"undefined"==typeof a&&(a=this.nEditNumber);this.setEditNumber(a);document.getElementById("TB_MENU_UI_SWITCH_BTN2_"+a).onclick=function(b){b=b?b:window.event;dze_menu_control.showUiToggleBtnLayer(a,
this);TBCancelBubbleEvent(b)};document.getElementById("TB_MENU_HELP_BTN2_"+a).onclick=function(b){b=b?b:window.event;dze_menu_control.showHelpBtnLayer(a,this);TBCancelBubbleEvent(b)};for(var c=null,b=0;b<this.tb_menu_list.length;b++)c=document.getElementById("TB_MENU_RIBBON_"+b+"_"+a),c.TBSTATE=b<this.idxDynamicMenuStart?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_HIDE,c.onclick=function(){if(this.TBSTATE!=ID_STRING_NAME_GRAY&&this.TBSTATE==ID_STRING_NAME_UNCHECKED){var b=this.id.replace("TB_MENU_RIBBON_",
"").split("_").shift();dze_menu_control.activateMenu(b,a)}},c.onmouseover=function(){this.TBSTATE!=ID_STRING_NAME_GRAY&&"dze_ribbon_menu_off"==this.className&&(this.className="dze_ribbon_menu_off_over")},c.onmouseout=function(){this.TBSTATE!=ID_STRING_NAME_GRAY&&"dze_ribbon_menu_off_over"==this.className&&(this.className="dze_ribbon_menu_off")}}catch(d){dalert(d)}},setMenuItemProperty:function(a,c,b){try{if("undefined"==typeof b&&(b=this.nEditNumber),-1!=b){var d=document.getElementById("TB_MENU_RIBBON_"+
c+"_"+b);a==ID_STRING_NAME_CHECKED?(d.className=c<this.idxDynamicMenuStart?"dze_ribbon_menu_on":"dze_ribbon_d_menu_on",d.TBSTATE=ID_STRING_NAME_CHECKED,this.setTBItemTextGray(!1,c,b)):a==ID_STRING_NAME_UNCHECKED?(d.className=c<this.idxDynamicMenuStart?"dze_ribbon_menu_off":"dze_ribbon_d_menu_off",d.TBSTATE=ID_STRING_NAME_UNCHECKED,this.setTBItemTextGray(!1,c,b)):a==ID_STRING_NAME_GRAY?(d.TBSTATE=ID_STRING_NAME_GRAY,this.setTBItemTextGray(!0,c,b)):a==ID_STRING_NAME_HIDE&&(d.TBSTATE=ID_STRING_NAME_HIDE,
d.className="dze_ribbon_d_menu_hide")}}catch(e){dalert(e)}},setTBItemTextGray:function(a,c,b){try{"undefined"==typeof b&&(b=this.nEditNumber),document.getElementById("TB_MENU_RIBBON_"+c+"_"+b).childNodes[0].className=a?"dze_ribbon_menu_text_gray":"dze_ribbon_menu_text_normal",a||document.getElementById("TB_MENU_RIBBON_CONTENT_"+c+"_"+b).getElementsByTagName("div")}catch(d){dalert(d)}},activateMenu:function(a,c){try{if("undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){0>a&&(a=0);var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+
a+"_"+c);this.curr_checked_menu[[c]]==a&&b.childNodes.length||(0<=this.curr_checked_menu[c]&&this.deactivateMenu(this.curr_checked_menu[c],c),this.curr_checked_menu[c]<this.idxDynamicMenuStart&&(this.prev_checked_menu[c]=this.curr_checked_menu[c]),this.curr_checked_menu[c]=a,this.activateMenuDetail(a,c),this.setDynamicMenu(c),this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c),a==this.idxImagePropertyMenu&&this.setMenuItemProperty(ID_STRING_NAME_GRAY,this.prev_checked_menu[c],c),this.showAllTBState(c))}}catch(d){dalert(d)}},
deactivateMenu:function(a,c){try{if("undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);b.TBSTATE!=ID_STRING_NAME_GRAY&&(b.TBSTATE=ID_STRING_NAME_UNCHECKED);a<this.idxDynamicMenuStart?this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c):a==this.idxTableMenu?this.checkTableCaret(c)&&!this.checkImageCaret(c)?this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c):this.setMenuItemProperty(ID_STRING_NAME_HIDE,a,c):this.setMenuItemProperty(ID_STRING_NAME_HIDE,
a,c);this.deactivateMenuDetail(a,c)}}catch(d){dalert(d)}},activateMenuDetail:function(a,c){try{if(-1!=c){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);"block"!=b.style.display&&(this.moveTBIcon_TbContainer_To_Main_RibbonUi(a,c),a===dze_menu_control.idxImagePropertyMenu&&this.setTBImageSizeInfo(c),b.style.display="block",dze_menu_control.setShowHideRibbonMainToolbars(a,c))}}catch(d){dalert(d)}},deactivateMenuDetail:function(a,c){try{this.moveTBIcon_Main_RibbonUi_To_TbContainer(a,
c),document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).style.display="none"}catch(b){dalert(b)}},setShowHideRibbonMainToolbars:function(a,c){try{"undefined"==typeof a&&(a=dze_menu_control.curr_checked_menu[c]),"undefined"==typeof c&&(c=g_nActiveEditNumber),0>c||0>a||(dze_menu_control.resizeTbContentDiv(a,c),dze_menu_control.removeBtnMoreRibbonTb("main","left",a,c),dze_menu_control.removeBtnMoreRibbonTb("main","right",a,c),dze_menu_control.makeBtnMoreRibbonTb("main","right",a,c),dze_menu_control.resizeTbContentDiv(a,
c))}catch(b){dalert(b)}},setShowHideRibbonBottomToolbars:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),0>a||(dze_menu_control.resizeTbContentDiv("",a),dze_menu_control.removeBtnMoreRibbonTb("bottom","left","",a),dze_menu_control.removeBtnMoreRibbonTb("bottom","right","",a),dze_menu_control.makeBtnMoreRibbonTb("bottom","right","",a),dze_menu_control.resizeTbContentDiv("",a))}catch(c){dalert(c)}},makeBtnMoreRibbonTb:function(a,c,b,d){try{"undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]);
"undefined"==typeof d&&(d=g_nActiveEditNumber);if(0>d||0>b)return null;if("main"==a)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==a)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return null;if(null==e)return null;var f=e.childNodes[0];if(null==f)return null;for(var g=0,k=f.rows[0].cells.length,l=0;l<k;l++)f.rows[0].cells[l].getAttribute("width")&&(g+=parseInt(f.rows[0].cells[l].getAttribute("width"),10));if(g<e.offsetWidth)return dze_menu_control.removeBtnMoreRibbonTb(a,
"left",b,d),dze_menu_control.removeBtnMoreRibbonTb(a,"right",b,d),e.style.marginLeft="0px",null;var m=g_objNodeUtil.getLoopParentElement(e,"table");if("right"==c){var n=m.rows[0].cells[m.rows[0].cells.length-1];if("btnMore"!=n.getAttribute("type")){if("main"==a)var h="duzon_btn_view_hidden_ribbon_toolbar_next",r="duzon_btn_view_hidden_ribbon_toolbar_next_down",p="duzon_btn_view_hidden_ribbon_toolbar_next_over";else h="duzon_btn_view_hidden_ribbon_toolbar_next_bottom",r="duzon_btn_view_hidden_ribbon_toolbar_next_down_bottom",
p="duzon_btn_view_hidden_ribbon_toolbar_next_over_bottom";n=m.rows[0].insertCell();n.setAttribute("type","btnMore");n.width=13;n.className=h;n.onmousedown=function(){this.className=r};n.onmouseup=function(){this.className=p};n.onmouseover=function(){this.className=p};n.onmouseout=function(){this.className=h}}n.onclick=function(){dze_menu_control.viewMoreRibbonTb(this,a,b,d)};return n}if("left"==c){var q=m.rows[0].cells[0];if("btnMore"!=q.getAttribute("type")){if("main"==a)var t="duzon_btn_view_hidden_ribbon_toolbar_prev",
v="duzon_btn_view_hidden_ribbon_toolbar_prev_down",u="duzon_btn_view_hidden_ribbon_toolbar_prev_over";else t="duzon_btn_view_hidden_ribbon_toolbar_prev_bottom",v="duzon_btn_view_hidden_ribbon_toolbar_prev_down_bottom",u="duzon_btn_view_hidden_ribbon_toolbar_prev_over_bottom";q=m.rows[0].insertCell(0);q.setAttribute("type","btnMore");q.width=13;q.className=t;q.onmousedown=function(){this.className=v};q.onmouseup=function(){this.className=u};q.onmouseover=function(){this.className=u};q.onmouseout=function(){this.className=
t}}q.onclick=function(){dze_menu_control.viewMoreRibbonTb(this,a,b,d)};return q}return null}catch(w){return dalert(w),null}},removeBtnMoreRibbonTb:function(a,c,b,d){try{"undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]);"undefined"==typeof d&&(d=g_nActiveEditNumber);if(0>d||0>b)return 0;if("main"==a)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==a)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return 0;var f=g_objNodeUtil.getLoopParentElement(e,
"table");if(!f)return 0;a=0;if("right"==c){var g=f.rows[0].cells[f.rows[0].cells.length-1];"btnMore"==g.getAttribute("type")&&(a=g.offsetWidth,g.parentNode.removeChild(g))}else if("left"==c){var k=f.rows[0].cells[0];"btnMore"==k.getAttribute("type")&&(a=k.offsetWidth,k.parentNode.removeChild(k));e.style.marginLeft="0px"}return a}catch(l){return dalert(l),0}},resizeTbContentDiv:function(a,c){try{if("undefined"==typeof a||""==a)a=dze_menu_control.curr_checked_menu[c];"undefined"==typeof c&&(c=g_nActiveEditNumber);
if(!(0>c||0>a)){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);if(null!=b){var d=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+c);null!=d&&(b.style.width="1px",d.style.width="1px",b.style.width=b.parentNode.offsetWidth-1+"px",d.style.width=d.parentNode.offsetWidth-1+"px")}}}catch(e){return dalert(e),null}},viewMoreRibbonTb:function(a,c,b,d){try{if(a&&("undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]),"undefined"==typeof d&&(d=g_nActiveEditNumber),!(0>d||
0>b))){if("main"==c)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==c)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return;var f=e.childNodes[0];if(null!=f){for(var g=0,k=f.rows[0].cells.length,l=0;l<k;l++)f.rows[0].cells[l].getAttribute("width")&&(g+=parseInt(f.rows[0].cells[l].getAttribute("width"),10));var m=g-e.offsetWidth;if(0<a.cellIndex){var n=dze_menu_control.makeBtnMoreRibbonTb(c,"left",b,d);dze_menu_control.removeBtnMoreRibbonTb(c,
"right",b,d);e.style.marginLeft=-n.offsetWidth+"px";dze_menu_control.slideMoveRibbonTb(e,"left",-m)}else{dze_menu_control.makeBtnMoreRibbonTb(c,"right",b,d);var h=dze_menu_control.removeBtnMoreRibbonTb(c,"left",b,d);e.style.marginLeft=-m+h+"px";dze_menu_control.slideMoveRibbonTb(e,"right",0)}}}}catch(r){dalert(r)}},slideMoveRibbonTb:function(a,c,b){try{var d=parseInt(a.style.marginLeft.replace(/px/,""),10),e=0,f="left"==c?-5:5,g=setInterval(function(){e++;1E3<e?(a.style.marginLeft=b+"px",clearInterval(g)):
(d+=f,"left"==c?d<=b&&(d=b):d>=b&&(d=b),d==b?(a.style.marginLeft=d+"px",clearInterval(g)):a.style.marginLeft=d+"px")},7)}catch(k){dalert(k)}},makeTB:function(a,c){try{if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_BUTTON)return this.makeTB_Button(a,c);if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_COMBOBOX){var b=0,d=0;if(ID_COMMAND_FONT_NAME==a)b=102,d=2;else if(ID_COMMAND_FONT_SIZE==a||ID_COMMAND_HEADING_SIZE==a)b=72,d=1;else if(ID_COMMAND_LETTER_SPACING==a||ID_COMMAND_LINE_HEIGHT==a)b=52,d=1;return this.makeTB_ComboBox(a,
b,d,c)}return g_arrConst[a][6]==ID_TYPE_TOOLBAR_DROPDOWN?this.makeTB_DropDown(a,c):g_arrConst[a][6]==ID_TYPE_TOOLBAR_SPINNER?this.makeTB_Spinner(a,c):""}catch(e){dalert(e)}},makeTB_Button:function(a,c){try{return'<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;"><div class="duzon_tb_button_image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[a][1]+
'"></div></div>'}catch(b){dalert(b)}return""},makeTB_ComboBox:function(a,c,b,d){try{var e="";e+='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+d+'" TBTYPE="toggle" style="line-height:0;width:'+c+'px;overflow:hidden;" title="'+g_arrConst[a][1]+'">';e+='<table style="width:'+c+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';e+="<tr>";g_bBrowserType_WK?g_bDocType_XHTML?(e+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',e+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(e+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',e+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):g_bDocType_XHTML?(e+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span></td>',e+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(e+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span></td>',e+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>');e+="</tr>";return e+"</table></div>"}catch(f){dalert(f)}return""},makeTB_DropDown:function(a,c){try{var b="";b+='<div orgCommandId="'+
a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';b+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" width="30">';b+="<tr>";b+='<td width="18" style="line-height:0;height:20px;border:0px;padding:0px;">';b+='<div class="tbDropDown_AreaButton"><div class="tb_DropDown_Button_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" alt="'+g_arrConst[a][1]+'" style="vertical-align:baseline;border:none;"></div></div>';
a==ID_COMMAND_FORE_COLOR&&(b+='<div id="TB_SETFORECOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');a==ID_COMMAND_BACK_COLOR&&(b+='<div id="TB_SETBACKCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');a==ID_COMMAND_TABLE_CELL_BACKCOLOR&&(b+='<div id="TB_SETCELLBACKCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>');a==
ID_COMMAND_IMAGE_BORDER_COLOR&&(b+='<div id="TB_SETIMAGEBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');a==ID_COMMAND_TABLE_BORDER_COLOR&&(b+='<div id="TB_SETTABLEBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>');b+="</td>";b+='<td width="13" style="line-height:0;height:20px;border:0px;padding:0px;vertical-align:middle;">';b+='<div id="'+g_arrConst[a][2]+"_"+c+
'_SUB" class="'+g_strSkin_DropDown_AreaArrow+'"><img src="'+dzeEnvConfig.strPath_Image+g_strBlankImageName+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div>';b+="</td>";b+="</tr>";return b+"</table></div>"}catch(d){dalert(d)}return""},makeTB_Spinner:function(a,c){try{var b=g_arrConst[a][10],d=g_arrConst[a][11],e="dze_form_"+g_arrConst[a][2]+"_"+c,f='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';
f+="<table align='' border='0' cellpadding='0' cellspacing='0'>";f+="<tr>";f+="<td width='30' class='dze_ribbon_tb_spinner_item_text'>"+g_arrConst[a][1]+": </td>";f+="<td>";f+="\t<table align='' border='1' cellpadding='0' cellspacing='0' class='dze_ribbon_tb_spinner_input_form_container'>";f+="\t\t<tr>";f+="\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t<table align='' border='0' cellpadding='0' cellspacing='0'>";f+="\t\t\t\t\t<tr>";f+="\t\t\t\t\t\t<td style='line-height:0;' height='18'><input type='text' id='"+
e+"' value='"+b+"' class='dze_ribbon_tb_spinner_input_form' size='5' /></td>";f+="\t\t\t\t\t\t<td style='line-height:0;' width='16' class='dze_ribbon_tb_spinner_unit_text'>"+d+"</td>";f+="\t\t\t\t\t</tr>";f+="\t\t\t\t</table>";f+="\t\t\t</td>";f+="\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t<table align='' border='0' cellpadding='0' cellspacing='0' class='aaaaa'>";f+="\t\t\t\t\t<tr>";f+="\t\t\t\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t\t\t\t<div class='duzon_spinner_btn_arrow_up' onmouseover=\"if(this.className == 'duzon_spinner_btn_arrow_up') this.className='duzon_spinner_btn_arrow_over';\" onmouseout=\"if(this.className =='duzon_spinner_btn_arrow_over') this.className='duzon_spinner_btn_arrow_up';\"><img src='"+
dzeEnvConfig.strPath_Image+"dialog/btn_arrow_up.png' alt='' width='5' height='3'></div>";f+="\t\t\t\t\t\t</td>";f+="\t\t\t\t\t</tr>";f+="\t\t\t\t\t<tr>";f+="\t\t\t\t\t\t<td style='line-height:0;'>";f+="\t\t\t\t\t\t\t<div class='duzon_spinner_btn_arrow_up' onmouseover=\"if(this.className == 'duzon_spinner_btn_arrow_up') this.className='duzon_spinner_btn_arrow_over';\" onmouseout=\"if(this.className =='duzon_spinner_btn_arrow_over') this.className='duzon_spinner_btn_arrow_up';\"><img src='"+dzeEnvConfig.strPath_Image+
"dialog/btn_arrow_down.png' alt='' width='5' height='3' border='0'></div>";f+="\t\t\t\t\t\t</td>";f+="\t\t\t\t\t</tr>";f+="\t\t\t\t</table>";f+="\t\t\t</td>";f+="\t\t</tr>";f+="\t</table>";f+="</td>";f+="</tr>";return f+"</table></div>"}catch(g){dalert(g)}},checkCommandIdInTbContainer:function(a,c){try{var b=this.TB_CONTAINER[c].getElementsByTagName("div");c=!1;for(var d=0;d<b.length;d++)if(b[d].getAttribute("orgCommandId")==a){c=!0;break}return c}catch(e){dalert(e)}},TB_CONTAINER:[],moveTBIcon_BasicUi_To_TbContainer:function(a){try{"undefined"==
typeof this.TB_CONTAINER[a]&&(this.TB_CONTAINER[a]=document.createElement("div"),this.TB_CONTAINER[a].id="dze_idx_ribbon_tb_container_"+a,this.TB_CONTAINER[a].style.display="none",document.body.appendChild(this.TB_CONTAINER[a]));for(var c=-1,b=0;b<this.allTbCommandIdList.length;b++)if(c=this.allTbCommandIdList[b],!(0>c)&&1!=this.checkCommandIdInTbContainer(c,a)){for(var d=0,e=!1,f=[],g=1;3>=g;g++)if(e=eval("dzeUiConfig.bCustomize_ToolBar"+g+"_Display"),f=eval("dzeUiConfig.arrCustomToolbar"+g),e){for(var k=
0;k<f.length;k++)if(c==f[k][0]){d=g;break}if(0<d)break}if(0<d){var l=document.getElementById("TB_CONTAINER_TOOL_"+d+"_"+a).getElementsByTagName("div"),m=g_arrConst[c][2]+"_"+a;for(g=0;g<l.length;g++)if(l[g].getAttribute("id")&&l[g].id==m){if(!l[g].nextSibling||!l[g].nextSibling.getAttribute("orgCommandId")){var n=document.createElement("span");n.setAttribute("orgCommandId",c);l[g].parentNode.insertBefore(n,l[g])}l[g].setAttribute("orgCommandId",c);this.TB_CONTAINER[a].appendChild(l[g]);break}}else{var h=
this.makeTB(c,a);if(""!=h){var r=document.createElement("span");r.className="dze_ribbon_tb_item";r.title=g_arrConst[c][1];r.innerHTML=h;this.TB_CONTAINER[a].appendChild(r.childNodes[0]);var p=g_arrConst[c][6];p==ID_TYPE_TOOLBAR_SPINNER?this.addEventTBSpinner(c,a):(TBInitButton(c,p,a),ID_TB_QUERY_STATUS_BUTTON==p?handlerUI.setCommandUpdateIndex(a,c,g_TBButton[a].length-1):ID_TB_QUERY_STATUS_COMBOBOX==p?handlerUI.setCommandUpdateIndex(a,c,g_TBComboBox[a].length-1):ID_TB_QUERY_STATUS_DROPDOWN==p&&handlerUI.setCommandUpdateIndex(a,
c,g_TBDropDown[a].length-1))}}}}catch(q){dalert(q)}},spinnerBtnMDownTimer1:null,spinnerBtnMDownTimer2:null,currControlObject:null,addEventTBSpinner:function(a,c){try{if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_SPINNER){for(var b=null,d=0;d<this.TB_CONTAINER[c].childNodes.length;d++)if(this.TB_CONTAINER[c].childNodes[d].getAttribute("orgCommandId")==a){b=this.TB_CONTAINER[c].childNodes[d];break}if(null!=b){b.onmouseover=function(){return!0};b.onmouseout=function(){return!0};b.onmousedown=function(){return!0};
b.onmouseup=function(){return!0};b.ondragstart=function(){return!0};b.onselectstart=function(){return!0};b.onselect=function(){return!0};b.onclick=function(){return!0};var e=g_arrConst[a][7],f=g_arrConst[a][8],g=g_arrConst[a][9],k=g_arrConst[a][3],l=b.getElementsByTagName("input")[0],m=b.getElementsByTagName("div");m[0].onmousedown=function(b){(b?b:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(b=dze_menu_control.spinnUp(l,e,f,g,k,a,c),this.className="duzon_spinner_btn_arrow_down",b&&
(dze_menu_control.spinnerBtnMDownTimer1=setTimeout(function(){dze_menu_control.spinnerBtnMDownTimer2=setInterval(function(){dze_menu_control.spinnUp(l,e,f,g,k,a,c)},70)},500)))};m[0].onmouseup=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};m[0].onmouseout=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_up"};m[0].onmouseover=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className=
"duzon_spinner_btn_arrow_over"};m[1].onmousedown=function(b){(b?b:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(b=dze_menu_control.spinnDown(l,e,f,g,k,a,c),this.className="duzon_spinner_btn_arrow_down",b&&(dze_menu_control.spinnerBtnMDownTimer1=setTimeout(function(){dze_menu_control.spinnerBtnMDownTimer2=setInterval(function(){dze_menu_control.spinnDown(l,e,f,g,k,a,c)},70)},500)))};m[1].onmouseup=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};
m[1].onmouseout=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_up"};m[1].onmouseover=function(a){dze_menu_control.clearSpinnerBtnMDownTimer();this.className="duzon_spinner_btn_arrow_over"};l.onmouseover=function(){return!0};l.onmouseout=function(){return!0};l.onmousedown=function(){return!0};l.onmouseup=function(){return!0};l.ondragstart=function(){return!0};l.onselectstart=function(){return!0};l.onselect=function(){return!0};l.onclick=function(){return!0};
l.onmousedown=function(){this.select()};l.onblur=function(){dze_menu_control.spinnValCheck(this,e,f)&&""!=k&&eval(k)(this.value,a,c)};l.onkeydown=function(b){try{var d=b?b:window.event;"undefined"==typeof d||null==d?dlog("IE8 -> Not Support"):(d.keyCode==ID_KEYCODE_ARROW_TOP&&dze_menu_control.spinnUp(l,e,f,g,k,a,c),d.keyCode==ID_KEYCODE_ARROW_BOTTOM&&dze_menu_control.spinnDown(l,e,f,g,k,a,c),d.keyCode==ID_KEYCODE_ENTER&&dze_menu_control.spinnValCheck(this,e,f)&&""!=k&&eval(k)(this.value,a,c))}catch(r){}}}}}catch(n){dalert(n)}},
spinnUp:function(a,c,b,d,e,f,g){try{if(null==a&&dze_menu_control.clearSpinnerBtnMDownTimer(),1!=a.disabled){""==a.value&&(a.value=b-1);c=parseInt(c,10);if(parseInt(a.value,10)+d<=parseInt(c,10))return a.value=parseInt(a.value,10)+d,""!=e&&eval(e)(a.value,f,g),!0;dze_menu_control.clearSpinnerBtnMDownTimer();a.value=c;alert(ID_RES_DIALOG_ALERT_MAX_VALUE+c);return!1}}catch(k){dalert(k)}},spinnDown:function(a,c,b,d,e,f,g){try{if(null==a&&dze_menu_control.clearSpinnerBtnMDownTimer(),1!=a.disabled){""==
a.value&&(a.value=b);b=parseInt(b,10);if(parseInt(a.value,10)-d>=b)return a.value=parseInt(a.value,10)-d,""!=e&&eval(e)(a.value,f,g),!0;dze_menu_control.clearSpinnerBtnMDownTimer();a.value=b;alert(ID_RES_DIALOG_ALERT_MIN_VALUE+b);return!1}}catch(k){dalert(k)}},spinnValCheck:function(a,c,b){try{if(1!=checkNumber(a.value))return alert(ID_RES_DIALOG_ALERT_NUMBER_ONLY),a.value=a.value.replace(/[^0-9]/g,""),!1;c=parseInt(c,10);b=parseInt(b,10);val=parseInt(a.value,10);return val>c?(alert(ID_RES_DIALOG_ALERT_MAX_VALUE+
c),a.value=c,!1):val<b?(alert(ID_RES_DIALOG_ALERT_MIN_VALUE+b),a.value=b,!1):!0}catch(d){return dalert(d),!1}},clearSpinnerBtnMDownTimer:function(){try{dze_menu_control.spinnerBtnMDownTimer1&&clearInterval(dze_menu_control.spinnerBtnMDownTimer1),dze_menu_control.spinnerBtnMDownTimer2&&clearInterval(dze_menu_control.spinnerBtnMDownTimer2),dze_menu_control.spinnerBtnMDownTimer1=null,dze_menu_control.spinnerBtnMDownTimer2=null}catch(a){dalert(a)}},moveTBIcon_TbContainer_To_BasicUi:function(a){try{this.moveTBIcon_Main_RibbonUi_To_TbContainer(this.curr_checked_menu[a],
a);this.moveTBIcon_Left_RibbonUi_To_TbContainer(a);this.moveTBIcon_Bottom_RibbonUi_To_TbContainer(a);this.changeTbClass(this.TB_CONTAINER[a],"basic");for(var c=1;3>=c;c++)if(toolbarDisplay=eval("dzeUiConfig.bCustomize_ToolBar"+c+"_Display")){var b=document.getElementById("TB_CONTAINER_TOOL_"+c+"_"+a).getElementsByTagName("span");for(j=b.length-1;0<=j;j--)if(b[j].getAttribute("orgCommandId"))for(var d=this.TB_CONTAINER[a].getElementsByTagName("div"),e=0;e<d.length;e++)if(d[e].getAttribute("orgCommandId")&&
d[e].getAttribute("orgCommandId")==b[j].getAttribute("orgCommandId")){b[j].parentNode.insertBefore(d[e],b[j]);break}}}catch(f){dalert(f)}},setTBStyle_Basic_To_Ribbon:function(a){try{return"duzon_tb_button"==a.className&&(a.className="duzon_tb_button_ribbon",a.onmouseover=function(){this.className="duzon_tb_button_over_ribbon"},a.onmousedown=function(){this.className="duzon_tb_button_down_ribbon"},a.onmouseout=function(){this.className="duzon_tb_button_ribbon"}),a}catch(c){dalert(c)}},setTBStyle_Ribbon_To_Basic:function(a){try{return"duzon_tb_button_ribbon"==
a.className&&(a.className="duzon_tb_button",a.onmouseover=function(){this.className="duzon_tb_button_over"},a.onmousedown=function(){this.className="duzon_tb_button_down"},a.onmouseout=function(){this.className="duzon_tb_button"}),a}catch(c){dalert(c)}},getTbObjFromTbContainer:function(a,c){try{var b=this.TB_CONTAINER[c].getElementsByTagName("div");for(c=0;c<b.length;c++)if(a==b[c].getAttribute("orgCommandId"))return b[c];return null}catch(d){return null}},changeTbClass:function(a,c){try{if("ribbon"==
c){(0==a.className.indexOf("duzon_tb_button")||0==a.className.indexOf("duzon_tb_dropdown"))&&0>a.className.indexOf("_ribbon")&&(a.className+="_ribbon");for(var b=a.getElementsByTagName("div"),d=0;d<b.length;d++){0>b[d].className.indexOf("_ribbon")&&(0==b[d].className.indexOf("duzon_tb_button")&&(b[d].className+="_ribbon"),0==b[d].className.indexOf("duzon_tb_dropdown")&&(b[d].className+="_ribbon","table"==b[d].childNodes[0].nodeName.toLowerCase()&&(b[d].childNodes[0].setAttribute("width",39),b[d].childNodes[0].setAttribute("height",
30),b[d].childNodes[0].setAttribute("align","center"),b[d].childNodes[0].style.width="39px",b[d].childNodes[0].style.margin="auto",b[d].childNodes[0].rows[0].cells[0].setAttribute("width",26),b[d].childNodes[0].rows[0].cells[0].style.textAlign="center",b[d].childNodes[0].rows[0].cells[0].style.height="30px",b[d].childNodes[0].rows[0].cells[1].setAttribute("width",13),b[d].childNodes[0].rows[0].cells[1].style.height="30px")),0==b[d].className.indexOf("tb_DropDown_Button_Image")&&(b[d].className+="_ribbon"),
0==b[d].className.indexOf("tbDropDown_AreaButton")&&(b[d].className+="_ribbon"));var e=b[d].getElementsByTagName("img");e.length&&(e[0].src=e[0].src.replace(/\/toolbar\//,"/ribbon/"))}}else if("basic"==c)for(a.className=a.className.replace(/_ribbon$/,""),b=a.getElementsByTagName("div"),d=0;d<b.length;d++)b[d].className=b[d].className.replace(/_ribbon$/,""),0==b[d].className.indexOf("duzon_tb_dropdown")&&"table"==b[d].childNodes[0].nodeName.toLowerCase()&&(b[d].childNodes[0].setAttribute("width",30),
b[d].childNodes[0].removeAttribute("height"),b[d].childNodes[0].removeAttribute("align"),b[d].childNodes[0].style.width="100%",b[d].childNodes[0].style.margin="",b[d].childNodes[0].rows[0].cells[0].setAttribute("width",18),b[d].childNodes[0].rows[0].cells[0].style.textAlign="",b[d].childNodes[0].rows[0].cells[0].style.height="20px",b[d].childNodes[0].rows[0].cells[1].setAttribute("width",13),b[d].childNodes[0].rows[0].cells[1].style.height="20px"),e=b[d].getElementsByTagName("img"),e.length&&(e[0].src=
e[0].src.replace(/\/ribbon\//,"/toolbar/"))}catch(f){dalert(f)}},makeRibbonTbUnit:function(a,c){try{var b=null;if("undefined"==typeof a||null==a||!a.length)return b;if(2>a.length){var d=Math.abs(a[0]);if(0<=a[0]){b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height="";var e=b.insertRow();h=e.insertCell();h.width=d;h.height="";h.innerHTML='<div class="dze_ribbon_tb_left_separator">'}else b=document.createElement("table"),b.cellSpacing="0",b.cellPadding=
"0",b.border="0",b.width=d,b.height="",e=b.insertRow(),h=e.insertCell(),h.width=d,h.height=""}else{var f=a[a.length-1];if(1==f){var g=d=50,k=a[0],l=g_arrConst[k][1].replace(/(\s|\/)/g,"");b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.setAttribute("orgCommandId",k);h.width=d;h.height=50;h.align="center";h.className="dze_ribbon_tb_item_box";h.title=l;var m=this.getTbObjFromTbContainer(k,c);if(null==m)return m;
m.style.margin="auto";h.appendChild(m);this.changeTbClass(h,"ribbon");var n=document.createElement("div");n.className="dze_ribbon_tb_item_text";n.id=m.id+"_RIBBON_TEXT";n.innerHTML=l;ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[k][6]&&(n.className="dze_ribbon_tb_item_text_dropbox");m.appendChild(n)}else if(2==f){var h=e=null;d=95;g=40;var r=a[0],p=this.getTbObjFromTbContainer(r,c);if(null==p)return p;p.style.marginTop="0";p.style.marginBottom="0";var q=a[1],t=this.getTbObjFromTbContainer(q,c);if(null==t)return t;
t.style.marginTop="0";t.style.marginBottom="0";b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.width=d;h.height=3;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",r);h.appendChild(p);e=b.insertRow();h=e.insertCell();h.width=d;h.height=4;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",
q);h.appendChild(t);e=b.insertRow();h=e.insertCell();h.width=d;h.height=3}else if(3!=f)if(4==f){h=e=null;d=24;g=40;if(g_arrConst[a[0]][6]==ID_TYPE_TOOLBAR_DROPDOWN||g_arrConst[a[1]][6]==ID_TYPE_TOOLBAR_DROPDOWN)d=35;r=a[0];p=this.getTbObjFromTbContainer(r,c);if(null==p)return p;p.style.marginTop="0";p.style.marginBottom="0";q=a[1];t=this.getTbObjFromTbContainer(q,c);if(null==t)return t;t.style.marginTop="0";t.style.marginBottom="0";b=document.createElement("table");b.cellSpacing="0";b.cellPadding=
"0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.width=d;h.height=3;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",r);h.appendChild(p);e=b.insertRow();h=e.insertCell();h.width=d;h.height=4;e=b.insertRow();h=e.insertCell();h.width=d;h.className="dze_ribbon_tb_item_box_left";h.setAttribute("orgCommandId",q);h.appendChild(t);e=b.insertRow();h=e.insertCell();h.width=d;h.height=3}else if(5==f){d=24;g=28;k=a[0];
if(k==ID_COMMAND_HEADING_SIZE||k==ID_COMMAND_FONT_SIZE)d="74";else if(k==ID_COMMAND_FONT_NAME)d="104";else if(k==ID_COMMAND_LINE_HEIGHT||k==ID_COMMAND_LETTER_SPACING)d="54";ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[k][6]&&(d="35");var v=this.getTbObjFromTbContainer(k,c);b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();h=e.insertCell();h.className="dze_ribbon_tb_item_box_bottom";h.width=d;h.height=g;h.setAttribute("orgCommandId",k);
h.appendChild(v)}}return b}catch(u){return dalert(u),null}},moveTBIcon_TbContainer_To_Main_RibbonUi:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c),d=document.createElement("table");d.cellSpacing="0";d.cellPadding="0";d.border="0";d.width="100%";for(var e=d.insertRow(),f=null,g=0;g<this.tb_menu_content_list[a].length;g++){var k=this.makeRibbonTbUnit(this.tb_menu_content_list[a][g],c);null!=k&&(f=e.insertCell(),f.width=k.width,f.height=k.height,f.appendChild(k))}e.insertCell();
b.appendChild(d);duzon_dialog.animateDlg(d,"right")}catch(l){dalert(l)}},moveTBIcon_TbContainer_To_Left_RibbonUi:function(a){try{var c=document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a),b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0;f<this.tb_menu_content_left_list.length;f++){var g=this.makeRibbonTbUnit(this.tb_menu_content_left_list[f],a);null!=g&&(e=d.insertCell(),e.width=g.width,e.height=g.height,e.appendChild(g))}c.appendChild(b)}catch(k){dalert(k)}},
moveTBIcon_TbContainer_To_Bottom_RibbonUi:function(a){try{var c=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a),b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0;f<this.tb_menu_content_bottom_list.length;f++){var g=this.makeRibbonTbUnit(this.tb_menu_content_bottom_list[f],a);null!=g&&(e=d.insertCell(),e.width=g.width,e.height=g.height,e.appendChild(g))}d.insertCell();c.appendChild(b);this.setShowHideRibbonBottomToolbars()}catch(k){dalert(k)}},
moveTBIcon_Main_RibbonUi_To_TbContainer:function(a,c){try{for(var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).getElementsByTagName("td"),d=b.length-1;0<=d;d--)b[d].getAttribute("orgCommandId")&&(1<b[d].childNodes[0].childNodes.length&&b[d].childNodes[0].childNodes[1].id==b[d].childNodes[0].id+"_RIBBON_TEXT"&&b[d].childNodes[0].removeChild(b[d].childNodes[0].childNodes[1]),2<b[d].childNodes[0].childNodes.length&&b[d].childNodes[0].childNodes[2].id==b[d].childNodes[0].id+"_RIBBON_TEXT"&&
b[d].childNodes[0].removeChild(b[d].childNodes[0].childNodes[2]),this.TB_CONTAINER[c].appendChild(b[d].childNodes[0]),b[d].parentNode.removeChild(b[d]));document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).innerHTML=""}catch(e){dalert(e)}},moveTBIcon_Left_RibbonUi_To_TbContainer:function(a){try{for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),
c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a).innerHTML=""}catch(d){dalert(d)}},moveTBIcon_Bottom_RibbonUi_To_TbContainer:function(a){try{for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a).innerHTML=""}catch(d){dalert(d)}},
RibbonMenuSetStateAllEnable:function(a,c){try{for(var b=0;b<this.tb_menu_list.length;b++)document.getElementById("TB_MENU_RIBBON_"+b+"_"+c),a?this.setEnableRibbonMenu(b,c):this.setDisableRibbonMenu(b,c);this.showAllTBState()}catch(d){dalert(d)}},setDisableRibbonMenu:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);this.setTBItemTextGray(!0,a,c);b.TBSTATE!=ID_STRING_NAME_HIDE&&this.setMenuItemProperty(ID_STRING_NAME_GRAY,a,c)}catch(d){dalert(d)}},setEnableRibbonMenu:function(a,
c){try{var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);this.setTBItemTextGray(!1,a,c);a==this.curr_checked_menu[c]?this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c):b.TBSTATE!=ID_STRING_NAME_HIDE&&this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c)}catch(d){dalert(d)}},addRibbonUiEvent:function(a){try{window.attachEvent?(g_objEditorDocument[a].attachEvent("onmouseup",dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditorDocument[a].attachEvent("onkeyup",dze_menu_control.evtMouseUpShowDynamicMenu),
g_objEditWindow[a].attachEvent("onresize",dze_menu_control.evtResizeShowHideTb),window.attachEvent("onresize",dze_menu_control.evtResizeShowHideTb)):(g_objEditorDocument[a].addEventListener("mouseup",dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditorDocument[a].addEventListener("keyup",dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditWindow[a].addEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1),window.addEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1))}catch(c){dalert(c)}},
removeRibbonUiMouseEvent:function(a){try{window.attachEvent?(g_objEditorDocument[a].detachEvent("onmouseup",dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditorDocument[a].detachEvent("onkeyup",dze_menu_control.evtMouseUpShowDynamicMenu),g_objEditorDocument[a].detachEvent("onreize",dze_menu_control.evtResizeShowHideTb),window.detachEvent("onreize",dze_menu_control.evtResizeShowHideTb)):(g_objEditorDocument[a].removeEventListener("mouseup",dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditorDocument[a].removeEventListener("keyup",
dze_menu_control.evtMouseUpShowDynamicMenu,!1),g_objEditorDocument[a].removeEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1),window.removeEventListener("resize",dze_menu_control.evtResizeShowHideTb,!1))}catch(c){dalert(c)}},evtMouseUpShowDynamicMenu:function(a){try{var c=g_nActiveEditNumber;-1!=c&&setTimeout(function(){if(!0===dze_menu_control.checkTableCaret()){if(!0===dze_menu_control.checkImageCaret()){if(!GetMultiCellSelection()){dze_menu_control.activateMenu(dze_menu_control.idxImagePropertyMenu);
return}}else{var a=document.getElementById("TB_MENU_RIBBON_"+dze_menu_control.idxTableMenu+"_"+c);if((a.TBSTATE==ID_STRING_NAME_UNCHECKED||a.TBSTATE==ID_STRING_NAME_CHECKED)&&document.getElementById("TB_MENU_RIBBON_"+dze_menu_control.idxImagePropertyMenu+"_"+c).TBSTATE!=ID_STRING_NAME_CHECKED)return}dze_menu_control.activateMenu(dze_menu_control.idxTableMenu)}else!0===dze_menu_control.checkImageCaret()?dze_menu_control.activateMenu(dze_menu_control.idxImagePropertyMenu):dze_menu_control.curr_checked_menu[c]>=
dze_menu_control.idxDynamicMenuStart&&dze_menu_control.activateMenu(dze_menu_control.prev_checked_menu[c]),dze_menu_control.setDynamicMenu()},0)}catch(b){dalert(b)}},setDynamicMenu:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),this.curr_checked_menu[a]<this.idxDynamicMenuStart&&!this.checkTableCaret(a)&&this.deactivateMenu(this.idxTableMenu,a),this.curr_checked_menu[a]<this.idxDynamicMenuStart&&!this.checkTableCaret(a)&&this.deactivateMenu(this.idxImagePropertyMenu,a)}catch(c){dalert(c)}},
checkTableCaret:function(a){try{return"undefined"==typeof a&&(a=g_nActiveEditNumber),GetCurTable(a)?!0:!1}catch(c){dalert(c)}},checkImageCaret:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);var c=getSelectionControl(a);return"undefined"!=typeof c.controlObject&&null!=c.controlObject&&"img"==c.controlObject.nodeName.toLowerCase()?!0:!1}catch(b){dalert(b)}},evtResizeShowHideTb:function(){try{for(var a in g_arrEditorAreaContainer){var c=a;dze_menu_control.setShowHideRibbonMainToolbars(dze_menu_control.curr_checked_menu[c],
c);dze_menu_control.setShowHideRibbonBottomToolbars(c)}}catch(b){dalert(b)}},addEventMenuControl:function(a){try{window.attachEvent?g_objEditorDocument[a].attachEvent("onmousedown",dze_menu_control.evtEditorMouseDown):g_objEditorDocument[a].addEventListener("mousedown",dze_menu_control.evtEditorMouseDown,!1)}catch(c){dalert(c)}},evtEditorMouseDown:function(a){try{dze_menu_control.removeUiToggleBtnLayer(),dze_menu_control.removeHelpBtnLayer()}catch(c){dalert(c)}},setTBImageSizeInfo:function(a){try{if(!0===
dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&(dze_menu_control.currControlObject=null,this.curr_checked_menu[a]==dze_menu_control.idxImagePropertyMenu)){var c=getSelectionControl(a);if("undefined"!=typeof c.controlObject&&null!=c.controlObject&&"img"==c.controlObject.nodeName.toLowerCase()){dze_menu_control.currControlObject=c.controlObject;var b=document.getElementById("dze_form_"+g_arrConst[ID_CUSTOM_IMAGE_HEIGHT][2]+"_"+a);b&&(b.value=dze_menu_control.currControlObject.offsetHeight);
var d=document.getElementById("dze_form_"+g_arrConst[ID_CUSTOM_IMAGE_WIDTH][2]+"_"+a);d&&(d.value=dze_menu_control.currControlObject.offsetWidth)}}}catch(e){dalert(e)}},showAllTBState:function(a){},destruct:function(){}};

var g_objCopyPaste=new function(){this.objPasteDiv=null;this.arrPasteJob=[];this.curTimeoutId=null;this.bPasting=!1;this.isPasting=function(){return this.bPasting};this.bPaused=this.bCutting=this.bCopying=this.bProcessingJob=!1;this.nEditNumber=0;this.evnt=null;this.curCaretID="";this.timerID=null;this.DZE_PASTE_CAPTURE="dze_paste_capture";this.DZE_COPY_CAPTURE="dze_copy_capture";this.PASTE_EMPTY=0;this.PASTE_TEXT=1;this.PASTE_TABLE=2;this.PASTE_HTML=3;this.PASTE_IMAGE=4;this.PASTE_LIST=5;this.PASTE_SHAPE=
6;this.nPasteType=0;this.setPasteType=function(b){this.nPasteType=b};this.ID_PASTE_CARET="dze_paste_caret";this.ID_PASTE_POS_CARET="dze_paste_pos_caret";this.bOnTable=this.bIsEditShapeText=!1;this.objCopyDiv=this.objSavedRangeForCopy=null;this.strRemoveElementsQuery="ad,address,article,aside,blockquote,fieldset,figcaption,figure,footer,header,main,nav,section,comment,center,issuetable-web-component,dashboard,dashboard-done,form,details,summary,container,caption,g-accordion-expander,google-sheets-html-origin,code,cite,time,pre";
this.strRemoveAttribute="tabindex role aria-expanded tab-stops mso-pagination mso-padding-alt text-autospace".split(" ");this.init=function(){try{this.objPasteDiv&&this.objPasteDiv.parentNode&&this.objPasteDiv.parentNode.removeChild(this.objPasteDiv),this.objPasteDiv=null,this.arrPasteJob=[],this.curTimeoutId=null,this.bPaused=this.bPasting=!1,this.evnt=null,this.curCaretID="",this.nPasteType=0,this.bProcessingJob=!1,clearTimeout(this.timerID),this.timerID=null,this.bIsEditShapeText=!1}catch(b){dalert(b)}};
this.pasteKeyDown=function(b,c){try{if(!dzeUiConfig.bUsePasteCapture||!b||b.cancelBubble||!(b.keyCode==ID_KEYCODE_V&&DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)||b.keyCode==ID_KEYCODE_INSERT&&b.shiftKey))return!1;if(this.bPasting)return TBCancelBubbleEvent(b),!1;if(SelectionUtil.isOnInput(c))return!1;if(!1===g_objCaretUtil.isContentEditable(c))return TBCancelBubbleEvent(b),!1;g_objUndoRedo.registerUndoRedoStack(0,c);this.init();this.nEditNumber=c;this.moveCaretToPasteDiv();g_objPasteOptionMenu.remove();
g_objPasteOptionMenu.init(c);return!0}catch(d){dalert(d)}};this.pasteClick=function(b){try{if(!dzeUiConfig.bUsePasteCapture)return!1;if(this.bPasting)return TBCancelBubbleEvent(evnt),!1;if(SelectionUtil.isOnInput(b))return!1;if(!1===g_objCaretUtil.isContentEditable(b))return TBCancelBubbleEvent(evnt),!1;g_objUndoRedo.registerUndoRedoStack(0,b);this.init();this.nEditNumber=b;this.moveCaretToPasteDiv();g_objPasteOptionMenu.remove();g_objPasteOptionMenu.init(b);return!0}catch(c){dalert(c)}};this.moveCaretToPasteDiv=
function(){try{if(dzeUiConfig.bUsePasteCapture){var b=g_objEditorDocument[this.nEditNumber],c=g_objEditWindow[this.nEditNumber];if(b&&c){this.curCaretID=this.ID_PASTE_CARET+"_"+g_objCommonUtil.getUniqueID();g_objCaretUtil.saveCaret(this.nEditNumber,this.curCaretID);this.objPasteDiv=this.createPasteDiv(this.nEditNumber);b.body.appendChild(this.objPasteDiv);var d=c.getSelection(),e=b.createRange();e.selectNode(this.objPasteDiv.firstChild.firstChild);d.removeAllRanges();d.addRange(e)}}}catch(a){dalert(a)}};
this.isCaretOnPasteDiv=function(b){try{if(!dzeUiConfig.bUsePasteCapture)return!1;for(var c=g_objNodeUtil,d=c.getAncestorNodeOnCaret(b);d;){if(d.id===this.DZE_PASTE_CAPTURE)return!0;if(c.isLoopBreakNode(d))break;d=d.parentNode}return!1}catch(e){dalert(e)}};this.pasteBefore=function(b,c){try{if(!dzeUiConfig.bUsePasteCapture)return!1;if(!this.isCaretOnPasteDiv(c))return this.init(),!1;this.evnt=b;this.nEditNumber=c;this.bPasting=!0;this.resume();return!0}catch(d){dalert(d)}};this.pasteAfter=function(b,
c){try{if(!dzeUiConfig.bUsePasteCapture)return!1;var d=g_objCaretUtil;d.restoreCaret(c,this.curCaretID);SelectionUtil.deleteSelection(c);var e=this.objPasteDiv;if(!e)return!1;this.resizeImg(c,e);this.adjustPasteContents(e);var a=this.guessPasteType(e);if(a===this.PASTE_EMPTY)return!1;var f=GetCurCell(c);this.bOnTable=f?!0:!1;g_objPasteOptionMenu.isOperating()||g_objPasteOptionMenu.setEditNumber(c).setPasteDiv(e).setPasteContentType(a);var g=this.extractPasteContents(e,a);if(dzeClipBoard.pasteType&&
a!=this.PASTE_TABLE)return duzon_dialog.showToastMsg(null,ID_RES_CONST_STRING_NO_CELL_COPIED,1.5),dzeClipBoard.pasteType="",!1;var h=!1;f&&f.parentNode&&a!==this.PASTE_TABLE&&GetMultiCellSelection(c)&&(h=!0,g_objTableUtil.setCellInnerText("",f),g_objCaretUtil.moveCaret(f));if(a===this.PASTE_TABLE){if(!0===dzeClipBoard.setTableObjToDzeClipData(g.firstChild))try{return b=!1,b=dzeClipBoard.pasteType==INSERT_AS_NEW_ROWS?dzeClipBoard.paste_insert(c,!1):dzeClipBoard.paste(c,!1),dzeClipBoard.pasteType="",
b}catch(x){dalert(x)}}else if(a===this.PASTE_LIST&&g_objNodeUtil.isList(g.firstChild)&&dzeClipBoard.pasteOlUl(g.firstChild,c,b))return!0;var l=e.ownerDocument,k=l?l.defaultView:null,m=k?k.getSelection():null,n=m&&0<m.rangeCount?m.getRangeAt(0):null;if(!n)return!1;var t=k.document.getElementById("dze_paste_caret_pos");null!=t&&t.parentNode.removeChild(t);var q=d.insertCaretMarker(n,this.ID_PASTE_POS_CARET,!1).end;if(!q)return!1;c=null;if(a===this.PASTE_TEXT&&(c=g.querySelectorAll("span.dze_shape_main"))&&
c.length){var v=[];forEach(c,function(a,b){b&&"absolute"===b.style.position&&v.push(b)},this);c=v;v=null}d.removeMarkerAttribute(q);var r=q.cloneNode();insertAfter(q,r);r.id="dze_paste_caret_pos";this.splitParent(g,q,r,a);n.selectNode(q);n.collapse(!0);n.insertNode(g);if(a===this.PASTE_TEXT&&c&&c.length){for(var p=n.commonAncestorContainer;p&&"P"!==p.nodeName&&"LI"!==p.nodeName&&!g_objNodeUtil.isBoundNode(p);)p=p.parentNode;if(p&&("P"===p.nodeName||"LI"===p.nodeName)){a=g_objPropertyUtil;a.addClass(p,
"dze_shape_anchor");var w=l.createDocumentFragment();forEach(c,function(a,b){w.appendChild(b)},this);for(var u=p.firstChild;u&&"SPAN"===u.nodeName&&a.hasClass(u,"dze_shape_main");)u=u.nextSibling;u?p.insertBefore(w,u):p.appendChild(w);w=null}}var y=q.parentNode;q.parentNode.removeChild(q);g_objNodeUtil.normalize(y);r.nextSibling?d.moveCaret(r.nextSibling,!1,!0):d.moveCaret(r.parentNode,!1,!1);g_objPasteOptionMenu.setPasteEndNode(r);return!0}catch(x){dalert(x)}finally{n=null,f&&f.parentNode&&h&&this.pasteAfterForMultiCell(f)}};
this.setPasteDiv=function(b){try{return this.objPasteDiv=b,this}catch(c){dalert(c)}};this.getPasteDiv=function(){try{var b=g_objEditorDocument[this.nEditNumber];if(!dzeUiConfig.bUsePasteCapture||!this.bPasting)return b.body;var c=this.objPasteDiv;c&&c.parentNode||(this.objPasteDiv=c=b.getElementById(this.DZE_PASTE_CAPTURE));return c}catch(d){dalert(d)}};this.createPasteDiv=function(b){try{if(dzeUiConfig.bUsePasteCapture){var c=this.createCaptureDiv(b);c.id=this.DZE_PASTE_CAPTURE;c.innerHTML="<p>"+
duzon_dialog.dze_bookmark_last_tag+"</p>";return c}}catch(d){dalert(d)}};this.createCopyDiv=function(b){try{var c=this.createCaptureDiv(b);c.id=this.DZE_COPY_CAPTURE;return c}catch(d){dalert(d)}};this.createCaptureDiv=function(b){try{if(dzeUiConfig.bUsePasteCapture){"undefined"==typeof b&&(b=g_nActiveEditNumber);var c=g_objEditorDocument[b],d=c.createElement("div");d.contentEditable=!0;d.style.width="100%";d.style.height="100%";g_bBrowserType_IE?(d.style.right=-1*screen.width,d.style.bottom=0,d.style.position=
"fixed"):(d.style.left="0px",d.style.top="0px",d.style.position="fixed",d.style.opacity="0",d.style.zIndex="-9999");d.style.pointerEvents="none";d.style.background=c.body.style.background;d.style.margin=c.body.style.margin;d.style.padding=c.body.style.padding;return d}}catch(e){dalert(e)}};this.runPaste=function(){try{dzeUiConfig.bUsePasteCapture&&!this.bPaused&&(this.arrPasteJob.length&&(this.bProcessingJob=!0,this.arrPasteJob.shift().func(),this.bProcessingJob=!1),!this.bPaused&&0<this.arrPasteJob.length?
this.resume():!this.bPaused&&0===this.arrPasteJob.length&&this.bPasting&&(this.pasteAfter(this.evnt,this.nEditNumber),this.init(),editor_onpaste_complete(this.evnt,this.nEditNumber)))}catch(b){dalert(b)}};this.resume=function(){try{if(dzeUiConfig.bUsePasteCapture)if(this.bProcessingJob)this.bPaused=!1;else{this.bPaused=!1;for(var b=0;b<this.arrPasteJob.length;b++)this.arrPasteJob[b].delay=0;clearTimeout(this.timerID);this.timerID=setTimeout(function(){g_objCopyPaste.runPaste()},1)}}catch(c){dalert(c)}};
this.pause=function(){try{dzeUiConfig.bUsePasteCapture&&(this.bPaused=!0)}catch(b){dalert(b)}};this.setTimeoutForPaste=function(b,c){try{if(dzeUiConfig.bUsePasteCapture&&this.bPasting){b={func:b,delay:c};for(var d=0;d<this.arrPasteJob.length;d++)if(c<this.arrPasteJob[d].delay){this.arrPasteJob.splice(d,0,b);break}d>=this.arrPasteJob.length&&this.arrPasteJob.push(b)}else setTimeout(b,c)}catch(e){dalert(e)}};this.splitParent=function(b,c,d,e){try{if(!c)return!1;var a=g_objNodeUtil;if(e===this.PASTE_TEXT)this.splitParentForPasteText(b,
c,e);else if(e===this.PASTE_IMAGE){var f=a.getClosetBound(c,function(b){return a.isBlockNode(b)}),g=c.previousSibling;a.splitOn(f,c);a.removeEmptyNode(null,g)}else{f=a.getClosetBound(c);var h=a.findSplitPosition(c,f);h.parentNode.insertBefore(c,h);var l=a.insertBrIfSplitAtLast(f,c);l&&d&&l.parentNode.insertBefore(d,l);a.splitOn(f,c)}}catch(k){dalert(k)}};this.splitParentForPasteText=function(b,c,d){try{if(!c)return!1;var e=c?c.parentNode:null;if(e&&"SPAN"===e.nodeName&&!g_objPropertyUtil.hasClass(e,
"dze_shape_text_container")){var a=b.firstChild;for(b=null;a;){b=a.nextSibling;if("SPAN"===a.nodeName||"A"===a.nodeName){var f=parseStyle(e.getAttribute("style")),g=parseStyle(a.getAttribute("style"))||{};if(f&&g)for(var h in f){var l;if(l=!g[h]&&f[h]){a:{switch(h){case "fontFamily":case "fontSize":case "color":case "backgroundColor":case "fontWeight":var k=!0;break a}k=!1}var m;if(!(m=k))a:{switch(h){case "lineHeight":case "letterSpacing":m=!0;break a}m=!1}l=m}l&&(a.style[h]=f[h])}}else if(3===a.nodeType){var n=
e.cloneNode(!1);a.parentNode.replaceChild(n,a);n.appendChild(a)}a=b}a=g_objNodeUtil;a.clean(e);e.firstChild==c?e.parentNode.insertBefore(c,e):e.lastChild==c?insertAfter(e,c):a.splitOn(e.parentNode,c)}return!0}catch(t){dalert(t)}};this.guessPasteType=function(b){try{var c=this.PASTE_HTML;this.isPasteTypeEmpty(b)?c=this.PASTE_EMPTY:this.isPasteTypeImage(b)?c=this.PASTE_IMAGE:this.isPasteTypeShape(b)?c=this.PASTE_SHAPE:this.isPasteTypeText(b)?c=this.PASTE_TEXT:this.isPasteTypeTable(b)?c=this.PASTE_TABLE:
this.isPasteTypeList(b)&&(c=this.PASTE_LIST);return c}catch(d){dalert(d)}};this.isPasteTypeEmpty=function(b){try{if(!b||!b.firstChild)return!0;if(!b.firstChild.nextSibling&&"P"===b.firstChild.nodeName){var c=b.firstChild;if(!c.firstChild||3===c.firstChild.nodeType&&!c.firstChild.nextSibling&&0==removeZeroWidthSpaceFromString(c.firstChild.nodeValue).length)return!0}return!1}catch(d){dalert(d)}};this.isPasteTypeText=function(b){try{return b&&b.firstChild?"P"===b.firstChild.nodeName&&!b.firstChild.nextSibling||
g_objNodeUtil.hasAllTextInlineChild(b)?!0:!1:!1}catch(c){dalert(c)}};this.isPasteTypeTable=function(b){try{return b.firstChild&&!b.firstChild.nextSibling&&"TABLE"===b.firstChild.nodeName?!0:!1}catch(c){dalert(c)}};this.isPasteTypeList=function(b){try{return b&&b.firstChild&&b.firstChild===b.lastChild&&g_objNodeUtil.isList(b.firstChild)?!0:!1}catch(c){dalert(c)}};this.isPasteTypeImage=function(b){try{if(!b||!b.firstChild)return!1;var c=b.firstChild;if("IMG"===c.nodeName&&!c.nextSibling)return!0;if(!c.nextSibling&&
"P"===c.nodeName){var d=c.firstChild;if(d&&"IMG"===d.nodeName){var e=d?d.nextSibling:null;if(!e)return!0;if(!e.nextSibling&&"BR"===e.nodeName)return e.parentNode.removeChild(e),!0}}return!1}catch(a){dalert(a)}};this.isPasteTypeShape=function(b){try{if(!b||!b.firstChild)return!1;var c=g_objPropertyUtil,d=b.firstChild;if("P"!==d.nodeName||d.nextSibling||!c.hasClass(d,"dze_shape_anchor"))return!1;b=!0;for(var e=d.firstChild;e;){if("BR"!==e.nodeName&&!c.hasClass(e,"dze_shape_main")){b=!1;break}e=e.nextSibling}return b}catch(a){dalert(a)}};
this.extractPasteContents=function(b,c){try{if(!b)return null;var d=b.ownerDocument.createRange();c!==this.PASTE_TEXT&&c!==this.PASTE_IMAGE&&c!==this.PASTE_SHAPE||!b.firstChild||"P"!==b.firstChild.nodeName?d.selectNodeContents(b):d.selectNodeContents(b.firstChild);return d.extractContents()}catch(e){dalert(e)}};this.adjustPasteContents=function(b){try{if(b){var c=g_objNodeUtil;this.replacePreWithPara(b);c.clean(b);!1===g_bBrowserType_IE&&setHyperlinkAuto(this.nEditNumber,b);c.removeElementsBySelector(b,
this.strRemoveElementsQuery);this.pullListInsideListItem(b);this.pullTableOutOfPara(b);this.removeBlankPara(b);g_objAdjustDoc.addParaToCell(b);g_objAdjustDoc.adjustTable(b);this.removeUselessDiv(b);g_objNodeUtil.removeElementsBySelector(b,"li>p");g_objListUtil.replaceAllParaWithListItem(b);this.removeGarbageStyle(b);this.bOnTable&&this.removeOnTable(b);g_objAdjustDoc.addClassForAnchor(b);setTabSpanInlineStyle(b);g_objAdjustDoc.arrangeSpan(b);g_objAdjustDoc.removeParaWithoutChild(this.nEditNumber);
var d=b.innerHTML;try{d=d.normalize("NFC")}catch(e){}b.innerHTML=d;return b}}catch(e){dalert(e)}};this.removeGarbageStyle=function(b){try{if(!b||!b.firstChild)return!1;var c=g_objVideoControl,d=g_objNodeUtil,e=b.querySelectorAll("*"),a=null;b=null;for(var f="",g=e.length-1;0<=g;g--)if(a=e[g],b=a.nodeName,f=a.className,!("g"===a.nodeName||a.id&&0==a.id.indexOf("dze")||("string"!==typeof f&&(f=""),f.length&&0===f.indexOf("dze")&&"dze_table"!==f&&"dze_oneffice_link_flag"!==f))){1===a.nodeType&&"BR"===
a.nodeName&&a.hasAttribute("style")&&a.removeAttribute("style");a.style.position&&(a.style.position="",a.style.top&&(a.style.top=""),a.style.right&&(a.style.right=""),a.style.bottom&&(a.style.bottom=""),a.style.left&&(a.style.left=""),dlog("remove style top,right,bottom,left.."));a.style.zIndex&&(a.style.zIndex="");a.style.float&&(a.style.float="");a.style.transform&&(a.style.transform="");a.style.overflow&&(a.style.overflow="");a.style.display&&(a.style.display="");if("inherit"===a.style.fontFamily||
"-webkit-standard"===a.style.fontFamily)a.style.fontFamily="";!d.isBlockNode(a)||"nowrap"!==a.style.whiteSpace&&"pre"!==a.style.whiteSpace||(a.style.whiteSpace="");"A"!==a.nodeName&&a.style.cursor&&(a.style.cursor="");"BR"===a.nodeName&&a.hasAttribute("clear")&&a.removeAttribute("clear");"TABLE"!==a.nodeName&&"TD"!==a.nodeName&&"TH"!==a.nodeName&&a.style.backgroundImage&&(a.style.backgroundImage="");1===a.nodeType&&a.hasAttribute&&this.strRemoveAttribute.forEach(function(b){a.hasAttribute(b)&&a.removeAttribute(b)});
switch(a.nodeName){case "P":case "LI":case "DT":case "DD":case "PRE":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":a.style.backgroundColor&&(a.style.backgroundColor="")}a.style.maxWidth&&(a.style.maxWidth="");a.style.maxHeight&&(a.style.maxHeight="");a.style.minWidth&&(a.style.minWidth="");a.style.minHeight&&(a.style.minHeight="");a.style.boxShadow&&(a.style.boxShadow="");var h=!1;switch(b){case "IMG":case "TD":case "TH":case "TR":case "TABLE":case "COL":case "VIDEO":h=!0}!h&&c.isVideo(a)&&
(h=!0);if(!h)if(!a.id||0!=a.id.indexOf("teads")&&0!=a.id.indexOf("ssp-adcontent"))if(0==f.indexOf("teads")||0==f.indexOf("ssp-adcontent"))a.parentNode.removeChild(a);else{if("IFRAME"===a.nodeName&&0<dzeUiConfig.arrRemoveAdIFrame.length){h=!1;for(var l=0;l<dzeUiConfig.arrRemoveAdIFrame.length;l++)if(0<=a.src.indexOf(dzeUiConfig.arrRemoveAdIFrame[l])){h=!0;break}if(!0===h){a.parentNode.removeChild(a);continue}}"HR"===a.nodeName&&a.getAttribute("style")&&a.removeAttribute("style");if("OL"!==a.nodeName&&
"UL"!==a.nodeName||0!=a.childNodes.length){if("SPAN"===a.nodeName||"A"===a.nodeName||0<=d.arrParaNodeName.indexOf(a.nodeName)||0<=d.arrListNodeName.indexOf(a.nodeName))a.style.border="",a.style.borderStyle="",a.style.borderWidth="",a.style.borderRadius="",a.style.borderImage="",a.style.backgroundPosition="",a.style.backgroundSize="",a.style.backgroundRepeat="",a.style.backgroundAttachment="",a.style.backgroundOrigin="",a.style.backgroundClip="";d.isInlineNode(a)&&(a.style.float="",a.style.marginTop=
"",a.style.marginRight="",a.style.marginBottom="",a.style.marginLeft="",a.style.paddingTop="",a.style.paddingRight="",a.style.paddingBottom="",a.style.paddingLeft="",a.style.lineHeight="",a.style.textAlign="",a.style.textIndent="",dzeUiConfig.bSupportNewsEditor&&a.getAttribute("style")&&a.removeAttribute("style"));!a.style.fontSize||"0"!=a.style.fontSize&&"0px"!=a.style.fontSize||(a.style.fontSize="");a.style.padding&&(a.style.padding="");a.style.margin&&0>d.arrParaNodeName.indexOf(a.nodeName)&&(a.style.margin=
"");a.style.textIndent&&0>d.arrParaNodeName.indexOf(a.nodeName)&&(a.style.textIndent="");a.style.width&&"SELECT"!==a.nodeName&&"INPUT"!==a.nodeName&&(a.style.width="");a.style.height&&(a.style.height="");a.style.maxWidth&&(a.style.maxWidth="");a.style.minWidth&&(a.style.minWidth="");a.style.maxHeight&&(a.style.maxHeight="");a.style.minHeight&&(a.style.minHeight="");a.style.boxSizing&&(a.style.boxSizing="");d.isList(a)&&(a.style.marginTop="",a.style.marginRight="",a.style.marginBottom="",a.style.marginLeft=
"",a.style.paddingTop="",a.style.paddingRight="",a.style.paddingBottom="",a.style.paddingLeft="",a.style.lineHeight="",a.style.textAlign="",a.style.textIndent="");if(1===a.nodeType){var k=a.dataset,m;for(m in k)startsWith(m,"dze")||a.removeAttribute("data-"+m.split(/(?=[A-Z])/).join("-").toLowerCase())}d.isParagraph(a)&&(a.style.marginTop&&0>parseInt(a.style.marginTop,10)&&(a.style.marginTop=""),a.style.marginBottom&&0>parseInt(a.style.marginBottom,10)&&(a.style.marginBottom=""))}else a.parentNode.removeChild(a)}else a.parentNode.removeChild(a)}}catch(n){dalert(n)}};
this.removeBlankPara=function(b){try{if(!b||!b.firstChild)return!1;var c=b.getElementsByTagName("p");c=[].slice.call(c);b=!1;for(var d=c.length-1;0<=d;d--){var e=b;a:{var a=c[d],f=a&&"P"===a.nodeName?a:null;if(!f||f.style.whiteSpace)var g=!1;else{for(var h=g_objNodeUtil,l=f.childNodes,k=0,m=l.length;k<m;k++)if(!h.isIgnorable(l[k])){g=!1;break a}f.parentNode.removeChild(f);g=!0}}b=e|g}return b}catch(n){dalert(n)}};this.removeUselessDiv=function(b){try{return g_objNodeUtil.removeElementsBySelector(b,
"div",function(b){return g_objPropertyUtil.hasClass(b,"dze_video_iframe_container_div")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}),!0}catch(c){dalert(c)}};this.removePTag=function(b){try{for(var c=null,d=null,e=null,a=0;a<b.childNodes.length;a++)if(c=b.childNodes[a],!0===g_objNodeUtil.isBlockNode(c)){e=c.parentNode;0!==a&&(d=g_objEditorDocument[this.nEditNumber].createElement("br"),e.insertBefore(d,c));for(;!0===c.hasChildNodes();)e.insertBefore(c.firstChild,c);e.removeChild(c)}}catch(f){dalert(f)}};
this.removeOnTable=function(b){try{if(this.bOnTable){var c=g_objPropertyUtil,d="undefined"!=typeof g_objPageControl?g_objPageControl:null;if(d){var e=d.DZE_PAGE_BREAK_PARA,a=b.querySelectorAll("."+e);forEach(a,function(a,b){c.removeClass(b,e)},this)}}}catch(f){dalert(f)}};this.resizeImg=function(b,c){try{if(!c)return!1;var d=getMaxBoundSize(b);if(!d)return!1;var e=c.querySelectorAll("img");b=null;c=0;for(var a=e.length;c<a;c++)b=e[c],b.complete&&setOrgImageSize(b,d);return!0}catch(f){dalert(f)}};
this.pullTableOutOfPara=function(b){try{if(b){var c=g_objNodeUtil,d=b.querySelectorAll("p>table");forEach(d,function(b,a){(b=a.parentNode)&&"P"===b.nodeName&&(c.splitOn(b.parentNode,a),(b=a.previousSibling)&&!b.firstChild&&b.parentNode.removeChild(b),a=a.nextSibling,!a||a.firstChild&&("BR"!==a.firstChild.nodeName||a.firstChild.nextSibling)||a.parentNode.removeChild(a))})}}catch(e){dalert(e)}};this.onCopyBefore=function(b){try{if(g_bBrowserType_IE||g_bBrowserType_EDGE)if(this.bCopying||this.bCutting)TBCancelBubbleEvent(b);
else{var c=b?b.nEditNumber:this.nEditNumber;this.adjustSelection(c);var d=GetCurRangeArray(c);if(!d||d.collapsed())return!1;var e=this.createCopyDiv(c);if(!e)return!1;this.objSavedRangeForCopy=d;this.objCopyDiv=e;var a=e.ownerDocument,f=a.createRange();b=null;SelectionUtil.isSelectionOnCell(c)?b=g_objTableOperation.cloneSelectionOnCell(c):(b=d.cloneContents(),this.extendCopyContents(d,b));if(!b||!b.firstChild)return!1;e.appendChild(b);a.body.appendChild(e);this.adjustCopyContents(e);f.selectNodeContents(e);
SetCurRange(f);return!0}}catch(g){dalert(g)}};this.onCutBefore=function(b){try{return this.onCopyBefore(b)}catch(c){dalert(c)}};this.onCopy=function(b){try{if(g_bBrowserType_IE||g_bBrowserType_EDGE)this.bCopying=!0,setTimeout(function(){this.bCopying=!1;this.objCopyDiv&&(this.objCopyDiv.parentNode.removeChild(this.objCopyDiv),this.objCopyDiv=null);if(this.objSavedRangeForCopy){var a=null,b=this.objSavedRangeForCopy.getDocument();b&&(a=b.body.scrollTop);this.objSavedRangeForCopy.setCurRange(c);this.objSavedRangeForCopy=
null;b&&null!==a&&(b.body.scrollTop=a)}}.bind(this),0);else{var c=b.nEditNumber;this.adjustSelection(c);var d=GetCurRangeArray(c);if(!d||d.collapsed())return!1;var e=this.createCopyDiv(c);if(!e)return!1;var a=null;SelectionUtil.isSelectionOnCell(c)?a=g_objTableOperation.cloneSelectionOnCell(c):(a=d.cloneContents(),this.extendCopyContents(d,a));if(!a||!a.firstChild)return!1;e.appendChild(a);this.adjustCopyContents(e);var f=e.innerHTML,g=g_objNodeUtil.getInnerText(e),h=b.clipboardData;h.setData("text/plain",
g);h.setData("text/html",f);b.preventDefault()}}catch(l){dalert(l)}};this.onCut=function(b){try{var c=b.nEditNumber;this.onCopy(b);var d=function(){g_objCaretUtil.isContentEditable(c)&&(SelectionUtil.deleteSelection(c),g_objCaretUtil.scrollToCaret(),g_objUndoRedo.registerUndoRedoStack(0,c));editor_onselectionchange(c)};g_bBrowserType_IE||g_bBrowserType_EDGE?(this.bCutting=!0,setTimeout(function(){this.bCutting=!1;d()}.bind(this),0)):d()}catch(e){dalert(e)}};this.extendCopyContents=function(b,c){try{if(b&&
c&&c.firstChild&&1===b.getRangeCount()){var d=g_objNodeUtil,e=g_objPropertyUtil;if(c.firstChild===c.lastChild){switch(c.firstChild.nodeName){case "IMG":case "TABLE":case "HR":case "VIDEO":return}if(e.hasClass(c.firstChild,"dze_shape_main")||g_objVideoControl.isVideoSpan(c.firstChild))return}var a=b.getRangeAt(0).commonAncestorContainer,f=b=null;if(3===a.nodeType)for(f=a=a.parentNode;f&&d.isInlineNode(f)&&!e.hasClass(f,"dze_shape_text_contents");)b=f,f=f.parentNode;if(d.isHead(a))b=a;else if(d.isList(a)){var g=
g_objListUtil.getRootList(a);b=g?g:a}if(b)for(e=null,f=a;;){e=f.cloneNode(!1);d.moveNodesTo(e,c.firstChild);c.appendChild(e);if(f===b)break;f=f.parentNode}}}catch(h){dalert(h)}finally{}};this.adjustCopyContents=function(b){try{var c=b.querySelectorAll("div.oneffice_qrcode_first_container, div.oneffice_qrcode_last_container");forEach(c,function(b,a){a.parentNode.removeChild(a)},this);g_objTableUtil.removeAllDzeTable(b);g_objAdjustDoc.arrangeSpan(b);var d=b.querySelectorAll("p.dze_hide_para");forEach(d,
function(b,a){a.parentNode.removeChild(a)},this);this.removeListStyleTypeNoneOnCopy(b);g_objCaretUtil.removeAllCaretMarker(b);this.mergeRootListForCopy(b);return!0}catch(e){dalert(e)}};this.adjustSelection=function(b){try{var c=GetCurRange(b);if(c&&!c.collapsed){var d=c.startContainer,e=c.startOffset,a=c.endContainer,f=c.endOffset;d&&"VIDEO"===d.nodeName&&(d=d.parentNode,e=g_objNodeUtil.getChildIndex(d));a&&"VIDEO"===a.nodeName&&(a=a.parentNode,f=g_objNodeUtil.getChildIndex(f)+1);if(c.startContainer!==
d||c.startOffset!==e||c.endContainer!==a||c.endOffset!==f)c.setStart(d,e),c.setEnd(a,f),SetCurRange(c)}}catch(g){dalert(g)}finally{}};this.pasteAfterForMultiCell=function(b){try{var c=null;g_objTableSelection.doAllSelectedCell(function(d){d!==b&&"false"!==d.getAttribute("contenteditable")&&(null===c?(d.innerHTML=b.innerHTML,g_objNodeUtil.removeElementsBySelector(d,"#dze_paste_caret_pos"),c=d.innerHTML):d.innerHTML=c)})}catch(d){dalert(d)}};this.removeListStyleTypeNoneOnCopy=function(b){try{if(b){var c=
b.querySelectorAll("li:first-child");forEach(c,function(b,c){"none"===c.style.listStyleType&&(c.style.listStyleType="")},this)}}catch(d){dalert(d)}};this.pullListInsideListItem=function(b){try{if(b){var c=g_objNodeUtil,d=b.querySelectorAll("li>ol, li>ul, dt>dl, dd>dl");forEach(d,function(b,a){c.isList(a)&&(b=a.parentNode,c.isListItem(b)&&(c.splitOn(b.parentNode,a),b=a.previousSibling,a=a.nextSibling,b&&c.isListItem(b)&&!b.firstChild&&b.parentNode.removeChild(b),a&&c.isListItem(a)&&!a.firstChild&&
a.parentNode.removeChild(a)))},this)}}catch(e){dalert(e)}};this.mergeRootListForCopy=function(b){try{if(!b)return!1;var c=g_objListUtil,d=[].slice.call(b.querySelectorAll("ol, ul")).filter(function(a){return a===c.getRootList(a)?!0:!1}),e=d.length;if(0>=e)return!1;for(var a=b=0;a+1<e;a++){var f=d[a],g=d[a+1];f&&g&&f.nodeName===g.nodeName&&f.nextSibling===g&&c.getListStyle(f)===c.getListStyle(g)&&c.mergeRootList(f,g,!0,!0)&&(d[a+1]=f,b++)}return 0<b?!0:!1}catch(h){dalert(h)}};this.replacePreWithPara=
function(b){try{if(!b)return!1;var c=b.ownerDocument,d=b.querySelectorAll("pre, div[style*='white-space:']");if(!d||0>=d.length)return!1;b=g_objNodeUtil;d=[].slice.call(d);for(var e=0;e<d.length;e++){var a=d[e];if("DIV"!==a.nodeName||"pre"===a.style.whiteSpace){var f=c.createTreeWalker(a,NodeFilter.SHOW_TEXT,null,!1);if(f){for(var g=f.firstChild();g;){for(var h=g.nodeValue,l=[],k=0;k<h.length;k++){var m=h.charCodeAt(k);if(32===m)0===k||k===h.length-1?m=160:1<k&&k-1<l.length&&32===l[k-1]&&(m=160);
else if(9===m&&g_objPropertyUtil.hasClass(g.parentNode,"tabSpan")){var n=g.splitText(k);n.splitText(1);var t=g_objEditMode.createTabSpan();n.parentNode.replaceChild(t,n);break}else if(10===m||13===m&&k+1<h.length&&10===h.charCodeAt(k+1)){var q=g.splitText(k);q.splitText(13===m?2:1);b.splitOn(a,q);var v=q.nextSibling;if(v){var r=a.cloneNode(!1);b.moveNodesTo(r,v);insertAfter(a,r);d.splice(e+1,0,r)}q.parentNode.removeChild(q);break}l[k]=m}h=String.fromCharCode.apply(String,l);g.nodeValue=h;g=f.nextNode()}if("PRE"===
a.nodeName){var p=c.createElement("P");b.copyAttribute(p,a);p.style.whiteSpace="";b.moveNodesTo(p,a.firstChild);a.parentNode.replaceChild(p,a)}}}}return!0}catch(w){dalert(w)}};this.removeAllCaptureDiv=function(b){try{if(b){var c=b.querySelectorAll("#"+this.DZE_PASTE_CAPTURE+", #"+this.DZE_COPY_CAPTURE);b=0;for(var d=c.length;b<d;b++)c[b]&&c[b].parentNode&&c[b].parentNode.removeChild(c[b])}}catch(e){dalert(e)}}};

function DzeContextButton(){this.fadeTimer=this.container=null;this.MIN_OPACITY=.3;this.arrTempItem=[];this.onclick=null;this.getHTML=function(){return"<div style='height: 27px;'></div>"};this.createItem=function(a){a="<div class='dze_context_btn_item'><div class='dze_context_btn_sep'></div>"+("<div class='dze_context_btn_text'>"+a+"</div>")+"<div class='dze_context_btn_sep'></div></div>";return document.createRange().createContextualFragment(a)};this.setContainer=function(a){this.container=a};this.setItemListener=
function(a){var b=this,c=null;a.onmousedown=function(a){TBCancelBubbleEvent(a)};a.onmouseover=function(){this.style.opacity="1";clearInterval(c)};a.onmouseout=function(){var a=parseFloat(this.style.opacity),e=this;c=setInterval(function(){if(!a||a-.1<=b.MIN_OPACITY)a=b.MIN_OPACITY+.1,clearInterval(c);a-=.1;g_objPropertyUtil.setOpacity(e,a)},10)};a.onclick=function(){b.onclick(a.childNodes[1].innerHTML)}};this.doItem=function(a){if(this.container)for(var b=this.container.childNodes,c=0,d=b.length;c<
d;c++)a(b[c],c)};this.doItemText=function(a){this.doItem(function(b,c){a(b.childNodes[1],c)})};this.setText=function(){if(this.container){var a=[].slice.call(arguments),b=a.length;if(!(1>b)){var c=this.container.childNodes.length,d=null;if(b<c){var e=0;for(b=c-b;e<b;e++)d=this.container.lastChild,this.container.removeChild(d),this.arrTempItem.push(d)}else if(b>c)for(e=0,b-=c;e<b;e++)d=this.arrTempItem.pop(),d||(d=this.createItem(""),this.setItemListener(d.firstChild)),this.container.appendChild(d);
this.doItemText(function(b,c){b.innerHTML=a[c]})}}}}
var g_objPasteOptionMenu=new function(){this.nEditNumber=0;this.bShow=!1;this.pasteContentsType=0;this.bOperating=!1;this.wheelEndTimer=this.showTimer=this.pasteMenuDiv=this.pasteEndNode=this.arrPasteDiv=null;this.WHEEL_DEALY=100;this.caretSelection=null;this.contextButton=new DzeContextButton;this.init=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return!1;this.nEditNumber=a;this.bShow=!1;this.pasteEndNode=this.arrPasteDiv=null;this.wheelEndTimer&&(clearTimeout(this.wheelEndTimer),this.wheelEndTimer=
null);null!==this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null);if(!this.pasteMenuDiv){var b=g_objLayerKit.getLayerDocument(),c=b.createElement("div");c.id="dze_paste_option_menu_"+a;c.className="dze_dic_search_btn_container";c.style.display="none";c.style.zIndex="1";c.innerHTML=this.contextButton.getHTML();b.body.appendChild(c);this.pasteMenuDiv=c;this.contextButton.setContainer(c.firstChild);var d=this;this.contextButton.onclick=function(a){d.doPasteOption(a)};c.addEventListener("wheel",
function(a){d.hide();clearTimeout(d.wheelEndTimer);d.wheelEndTimer=setTimeout(function(){d.show(!1)},d.WHEEL_DEALY)},!1)}}catch(e){dalert(e)}};this.unload=function(){try{this.wheelEndTimer&&(clearTimeout(this.wheelEndTimer),this.wheelEndTimer=null),null!==this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null),this.pasteMenuDiv&&this.pasteMenuDiv.parentNode&&this.pasteMenuDiv.parentNode.removeChild(this.pasteMenuDiv),this.pasteMenuDiv=null}catch(a){dalert(a)}};this.setEditNumber=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;
this.nEditNumber=a;return this}catch(b){dalert(b)}};this.setPasteContentType=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;this.pasteContentsType=a;a==g_objCopyPaste.PASTE_TABLE?this.contextButton.setText(ID_RES_CONST_STRING_INSERT_AS_NESTED_TABLE,ID_RES_CONST_STRING_PASTE_CELL_OVER_CONTENT):this.contextButton.setText(ID_RES_CONST_STRING_KEEP_TEXT_ONLY);return this}catch(b){dalert(b)}};this.setPasteDiv=function(a,b){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;this.arrPasteDiv||
(this.arrPasteDiv=[]);this.arrPasteDiv[b||0]=a.cloneNode(!0);return this}catch(c){dalert(c)}};this.setPasteEndNode=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;this.pasteEndNode=a;return this}catch(b){dalert(b)}};this.isShow=function(){return this.bShow};this.isOperating=function(){return this.bOperating};this.show=function(a){try{dzeUiConfig.bUsePasteOptionMenu&&this.arrPasteDiv&&this.pasteEndNode&&this.pasteEndNode.parentNode&&!this.bShow&&(this.bShow=!0,clearTimeout(this.showTimer),
this.showTimer=setTimeout(function(){this.pasteMenuDiv.style.display="block";this.setLayerPosition();this.showTimer=null}.bind(this),0))}catch(b){dalert(b)}};this.hide=function(){try{dzeUiConfig.bUsePasteOptionMenu&&this.bShow&&(this.bShow=!1,this.showTimer&&clearTimeout(this.showTimer),this.pasteMenuDiv&&(this.pasteMenuDiv.style.display="none",this.pasteMenuDiv.style.top="-100px",this.pasteMenuDiv.style.left=""))}catch(a){dalert(a)}};this.remove=function(){try{if(dzeUiConfig.bUsePasteOptionMenu){this.hide();
var a=this.pasteEndNode;if(a&&a.parentNode&&"SPAN"===a.nodeName)if(g_objNodeUtil.normalize(a),a.firstChild){var b=a.ownerDocument.createDocumentFragment();g_objNodeUtil.moveNodesTo(b,a.firstChild);a.parentNode.replaceChild(b,a)}else a.parentNode.removeChild(a);this.pasteEndNode=null}}catch(c){dalert(c)}};this.setLayerPosition=function(){try{if(!dzeUiConfig.bUsePasteOptionMenu||!this.pasteEndNode)return!1;if(!g_objNodeUtil.isAlive(this.pasteEndNode))return this.pasteEndNode=null,!1;var a=g_objPositionUtil.getElementPosition(g_objEditObject[this.nEditNumber],
!1),b=g_objPositionUtil.getFrameClientRect();a=g_objPositionUtil.moveRect(a,b.left,b.top);var c=g_objPositionUtil.getElementPosClientRect(this.pasteEndNode),d=a.top+c.bottom,e=a.left+c.right,f=this.pasteMenuDiv.offsetWidth;e+(f+1)>=a.right&&(e=a.right-(f+1));b=!0;if(d<=a.top||d+15>=a.bottom)b=!1;b?(this.pasteMenuDiv.style.top=d+"px",this.pasteMenuDiv.style.left=e+"px"):(this.pasteMenuDiv.style.top="-100px",this.pasteMenuDiv.style.left="")}catch(g){dalert(g)}};this.onWheel=this.onZoom=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu||
!this.bShow)return!1;this.hide();clearTimeout(this.wheelEndTimer);this.wheelEndTimer=setTimeout(function(){g_objPasteOptionMenu.show(!1)},this.WHEEL_DEALY)}catch(b){dalert(b)}};this.getPasteDiv=function(a){try{var b=this.arrPasteDiv[a];if(b)return b;var c=this.arrPasteDiv[KEEP_SOURCE_FORMMAT];if(c){if(a===KEEP_TEXT_ONLY)return b=this.createKeepTextOnlyPasteDiv(c),this.arrPasteDiv[a]=b;if(a===INSERT_AS_NESTED_TABLE||a===KEEP_ORG_TABLE_FORMMAT)return b=c.cloneNode(!0),this.arrPasteDiv[a]=b}return null}catch(d){dalert(d)}};
this.createKeepTextOnlyPasteDiv=function(a){try{var b=a.ownerDocument,c=a.cloneNode(!0);c.style.whiteSpace="nowrap";b.body.appendChild(c);var d=this.keepImgBefore(c);g_objTableOperation.convertChildTableToText(c,!1);var e=this.getInnerText(c);e=this.keepImgAfter(e,d);c.innerHTML="<p>"+e+"</p>";b.body.removeChild(c);return c}catch(f){dalert(f)}};this.getInnerText=function(a){try{if(!a)return"";var b=a.innerText;return b=escapeHtml(b)}catch(c){dalert(c)}};this.keepImgBefore=function(a){try{if(a){var b=
a.ownerDocument;if(b){var c=a.querySelectorAll("img");c=[].slice.call(c);forEach(c,function(a,c){a=b.createTextNode("{dze_keep_img_id:"+a+"}");c.parentNode.replaceChild(a,c)},this);return c}}}catch(d){dalert(d)}};this.keepImgAfter=function(a,b){try{if(a&&b)return a=a.replace(/{dze_keep_img_id:[0-9]+}/g,function(a){try{var c=a.substring(17,a.length-1);c=parseInt(c,10);var e=b[c];return e?e.outerHTML:""}catch(f){return dalert(f),""}})}catch(c){dalert(c)}};this.doPasteOption=function(a){try{if(dzeUiConfig.bUsePasteOptionMenu){var b=
0;switch(a){case ID_RES_CONST_STRING_KEEP_TEXT_ONLY:b=KEEP_TEXT_ONLY;break;case ID_RES_CONST_STRING_PASTE_CELL_OVER_CONTENT:b=KEEP_ORG_TABLE_FORMMAT;break;case ID_RES_CONST_STRING_PASTE_CELL_OVER_ALL:b=PASTE_CELL_FORMMAT;break;case ID_RES_CONST_STRING_PASTE_CELL_INSERT:b=INSERT_AS_NEW_ROWS;break;case ID_RES_CONST_STRING_INSERT_AS_NESTED_TABLE:b=INSERT_AS_NESTED_TABLE}this.doPasteFormat(b);this.hide()}}catch(c){dalert(c)}};this.doPasteFormat=function(a){try{this.bOperating=!0;var b=this.nEditNumber,
c=g_objEditorDocument[b],d=c.getElementById("dze_document_main_container"),e=d?d.scrollTop:-1;g_objUndoRedo.operateUndoRedoStack(!0,!0,b,!0);(d=c.getElementById("dze_document_main_container"))&&0<=e&&(d.scrollTop=e);var f=g_objEditWindow[b],g=f?f.getSelection():null,h=g&&0<g.rangeCount?g.getRangeAt(0):null;if(!h||!h.commonAncestorContainer)return!1;c=g_objCopyPaste;var k=this.getPasteDiv(a),l=c.objPasteDiv;c.setPasteDiv(k.cloneNode(!0));var m=dzeClipBoard.pasteType;dzeClipBoard.pasteType=a===INSERT_AS_NESTED_TABLE?
INSERT_AS_NESTED_TABLE:a===KEEP_ORG_TABLE_FORMMAT?KEEP_ORG_TABLE_FORMMAT:"";var n=c.pasteAfter(null,b);c.setPasteDiv(l);dzeClipBoard.pasteType=m;n&&g_objUndoRedo.registerUndoRedoStack(0,b);g_objPasteOptionMenu.remove()}catch(p){dalert(p)}finally{this.bOperating=!1}}};

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");var ParagraphDlg=duzon_dialog.extend();
(function(){this.idx_dze_style_paragraph_justify="idx_dze_style_paragraph_justify";this.idx_dze_style_paragraph_left="idx_dze_style_paragraph_left";this.idx_dze_style_paragraph_center="idx_dze_style_paragraph_center";this.idx_dze_style_paragraph_right="idx_dze_style_paragraph_right";this.dze_style_paragraph_align_propertys=["left","center","right","justify"];this.idx_dze_firstline_indent_normal="idx_dze_firstline_indent_normal";this.idx_dze_firstline_indent_in="idx_dze_firstline_indent_in";this.idx_dze_firstline_indent_out=
"idx_dze_firstline_indent_out";this.marginLeftMax=533;this.marginLeftMin=0;this.marginRightMax=533;this.marginRightMin=0;this.lineHeightMax=500;this.lineHeightMin=0;this.oldProp=this.defaultProp=null;this.getContents=function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_ALIGN+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td colspan='4'>";a+="<div class='dze_style_paragraph_align_title'>"+
ID_RES_DIALOG_STRING_ALIGN_TYPE+" </div>";for(var b="",c="",d="",e="",f=0;f<this.dze_style_paragraph_align_propertys.length;f++)b=this.dze_style_paragraph_align_propertys[f],c="idx_dze_style_paragraph_"+b,d=eval("ID_RES_CONST_STRING_JUSTIFY"+b.toUpperCase()),e=dzeEnvConfig.strPath_Image+"dialog/btn_style_paragraph_"+b+".png",a+="<div class='dze_style_font_propery_set' id='"+c+"'><img src='"+e+"' alt='"+b+"' title='"+d+"' width='28' height='28'></div>";a+="</td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";
a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_ALIGN_LEFT+this.makeSpinnerInputForm("dze_style_p_margin_left","px",this.marginLeftMax,this.marginLeftMin,"0");a+="</div>";a+='<div style="width:15px;"></div>';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_ALIGN_RIGHT+
this.makeSpinnerInputForm("dze_style_p_margin_right","px",this.marginRightMax,this.marginRightMin,"0");a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row" style="margin-top:10px;">';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_PARAGRAPH_TOP+this.makeSpinnerInputForm("dze_style_p_margin_top","px","876","0","0");a+="</div>";a+='<div style="width:15px;"></div>';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';
a+=ID_RES_DIALOG_STRING_PARAGRAPH_BOTTOM+this.makeSpinnerInputForm("dze_style_p_margin_bottom","px","876","0","0");a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_LIST_MARGIN+"</div>";a+='<div class="duzon_dialog_row" style="margin-top:10px;">';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_LIST_TOP+this.makeSpinnerInputForm("dze_style_list_margin_top",
"px","876","0","0");a+="</div>";a+='<div style="width:15px;"></div>';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_LIST_BOTTOM+this.makeSpinnerInputForm("dze_style_list_margin_bottom","px","876","0","0");a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIRST_PARAGRAPH+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";
a+="<tr>";a+="<td>";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_normal+"' value='normal' /><label for='"+this.idx_dze_firstline_indent_normal+"' style='background:none;'>"+ID_RES_DIALOG_STRING_NORMAL+"</label> &nbsp; &nbsp;";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_in+"' value='in' /><label for='"+this.idx_dze_firstline_indent_in+"' style='background:none;'>"+ID_RES_CONST_STRING_INDENT+"</label> &nbsp; &nbsp;";
a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_out+"' value='out' /><label for='"+this.idx_dze_firstline_indent_out+"' style='background:none;'>"+ID_RES_CONST_STRING_OUTDENT+"</label>";a+="</td>";a+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_p_firstline_indent","px","553","0","0")+"</div></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+
ID_RES_DIALOG_STRING_SPACING+"</div>";return a+='<div class="duzon_dialog_row">'+(ID_RES_DIALOG_STRING_LINEHEIGHT+this.makeSpinnerInputForm("dze_style_p_line_height","%",this.lineHeightMax,this.lineHeightMin,g_strBodyLineHeight))+"</div>"}catch(g){dalert(g)}};this.onLoad=function(a){try{if(!this.defaultProp){var b=g_objCommonUtil.toPx(g_strBodyFontSize,null,!0);this.defaultProp={textAlign:"justify",marginLeft:"0px",marginRight:"0px",marginTop:g_strPTagMarginTop,marginBottom:g_strPTagMarginBottom,
listMarginTop:b+"px",listMarginBottom:b+"px",textIndent:"0px",lineHeight:g_strBodyLineHeight}}var c=this.defaultProp;this.oldProp=cloneSimpleObject(a);a=this.removeUnit(a);var d=this.dze_style_paragraph_align_propertys;b=null;for(var e=0,f=d.length;e<f;e++)b=$_("idx_dze_style_paragraph_"+d[e]),b.onclick=this.onClickAlign,d[e]===a.textAlign&&(b.className="dze_style_font_propery_set_down");d=null;this.modifySpinnerValue("dze_style_p_margin_left",this.marginLeftMax,this.marginLeftMin,a.marginLeft);this.modifySpinnerValue("dze_style_p_margin_right",
this.marginRightMax,this.marginRightMin,a.marginRight);this.modifySpinnerValue("dze_style_p_margin_top",876,0,a.marginTop);this.modifySpinnerValue("dze_style_p_margin_bottom",876,0,a.marginBottom);this.modifySpinnerValue("dze_style_list_margin_top",876,0,a.listMarginTop);this.modifySpinnerValue("dze_style_list_margin_bottom",876,0,a.listMarginBottom);d=this.modifySpinnerValue("dze_style_p_line_height",this.lineHeightMax,this.lineHeightMin,a.lineHeight,null,null,10);d.getValue=function(){var a=this.input.value;
""===a&&(a=Math.round(100*c.lineHeight));return+parseFloat(a).toFixed(2)};d.getAmount=function(){var a=this.getValue()%this.amount;return 0!==a?a:this.amount};var g=this.modifySpinnerValue("dze_style_p_firstline_indent",533,0,""!==a.textIndent?Math.abs(a.textIndent):""),h=g_objLayerKit.getElementById(this.idx_dze_firstline_indent_normal),k=g_objLayerKit.getElementById(this.idx_dze_firstline_indent_in),l=g_objLayerKit.getElementById(this.idx_dze_firstline_indent_out);h.onchange=this.onChangeIndent;
k.onchange=this.onChangeIndent;l.onchange=this.onChangeIndent;0===a.textIndent?(h.checked=!0,g.setValue(0)):0<a.textIndent?k.checked=!0:0>a.textIndent&&(l.checked=!0);this.onChangeIndent()}catch(m){dalert(m)}};this.onClickOk=function(a){try{var b=this.oldProp,c=this.getPropFromDialog(),d=Object.keys(c);d.forEach(function(a){"undefined"!==typeof c[a]&&c[a]==b[a]&&delete c[a]}.bind(this));d=Object.keys(c);0<d.length&&(dlog("set para style: "+c),a(c))}catch(e){dalert(e)}};this.isNull=function(a){return"undefined"===
typeof a||null===a||""===a?!0:!1};this.isNotNull=function(a){return!this.isNull(a)};this.copyIfNull=function(a,b){try{Object.keys(b).forEach(function(c){"undefined"===typeof a[c]||this.isNull(b[c])||(a[c]=b[c])}.bind(this))}catch(c){dalert(c)}};this.getPropFromDialog=function(){try{for(var a={},b=this.dze_style_paragraph_align_propertys,c=0,d=b.length;c<d;c++)if(g_objPropertyUtil.hasClass($_("idx_dze_style_paragraph_"+b[c]),"dze_style_font_propery_set_down")){a.textAlign=b[c];break}b="";b=$_("dze_style_p_margin_left").value;
this.isNotNull(b)&&(a.marginLeft=b+"px");b=$_("dze_style_p_margin_right").value;this.isNotNull(b)&&(a.marginRight=b+"px");b=$_("dze_style_p_margin_top").value;this.isNotNull(b)&&(a.marginTop=b+"px");b=$_("dze_style_p_margin_bottom").value;this.isNotNull(b)&&(a.marginBottom=b+"px");b=$_("dze_style_list_margin_top").value;this.isNotNull(b)&&(a.listMarginTop=b+"px");b=$_("dze_style_list_margin_bottom").value;this.isNotNull(b)&&(a.listMarginBottom=b+"px");b=$_("dze_style_p_line_height").value;this.isNotNull(b)&&
(a.lineHeight=parseInt(b,10)/100);if(1==$_(this.idx_dze_firstline_indent_normal).checked)a.textIndent="";else if(b=$_("dze_style_p_firstline_indent").value,this.isNotNull(b)){var e=parseInt(b,10);1==$_(this.idx_dze_firstline_indent_in).checked?a.textIndent=e+"px":1==$_(this.idx_dze_firstline_indent_out).checked&&(a.textIndent=-1*e+"px")}return a}catch(f){dalert(f)}};this.removeUnit=function(a){try{return this.isNotNull(a.marginLeft)&&(a.marginLeft=g_objCommonUtil.toPx(a.marginLeft)),this.isNotNull(a.marginRight)&&
(a.marginRight=g_objCommonUtil.toPx(a.marginRight)),this.isNotNull(a.marginTop)&&(a.marginTop=g_objCommonUtil.toPx(a.marginTop)),this.isNotNull(a.marginBottom)&&(a.marginBottom=g_objCommonUtil.toPx(a.marginBottom)),this.isNotNull(a.listMarginTop)&&(a.listMarginTop=g_objCommonUtil.toPx(a.listMarginTop)),this.isNotNull(a.listMarginBottom)&&(a.listMarginBottom=g_objCommonUtil.toPx(a.listMarginBottom)),this.isNotNull(a.textIndent)&&(a.textIndent=g_objCommonUtil.toPx(a.textIndent)),this.isNotNull(a.lineHeight)&&
(a.lineHeight=Math.round(100*a.lineHeight)),a}catch(b){dalert(b)}};this.onClickAlign=function(){try{for(var a=ParagraphDlg.dze_style_paragraph_align_propertys,b=0,c=a.length;b<c;b++)$_("idx_dze_style_paragraph_"+a[b]).className="dze_style_font_propery_set";this.className="dze_style_font_propery_set_down"}catch(d){dalert(d)}};this.onChangeIndent=function(){try{var a=ParagraphDlg,b=DzeSpinner.getSpinner("dze_style_p_firstline_indent");!0===$_(a.idx_dze_firstline_indent_normal).checked?(b.enable(!1),
b.setValue(0)):!0!==$_(a.idx_dze_firstline_indent_in).checked&&!0!==$_(a.idx_dze_firstline_indent_out).checked||b.enable(!0)}catch(c){dalert(c)}}}).call(ParagraphDlg);

var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(a,c){for(var d=1;d<arguments.length;d++){var b=arguments[d];if(b)for(var f in b)$jscomp.owns(b,f)&&(a[f]=b[f])}return a};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,d,b){if(c){d=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var f=a[b];f in d||(d[f]={});d=d[f]}a=a[a.length-1];b=d[a];c=c(b);c!=b&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+c++,d)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,b={next:function(){if(d<a.length){var f=d++;return{value:c(f,a[f]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objBindData=null,g_objBindStore=null,g_nBindDataChange=0,g_objMutationObserver=null,g_objMutationConfig=null;
function reducer(a,c){try{void 0===a&&(a=g_objBindData);switch(c.type){case "CHANGE":var d=g_objNodeUtil,b=c.target;if(!b||!d.isCell(b)&&"INPUT"!==b.nodeName)break;var f=b.getAttribute("mapping_key");if(!f)break;var e=b.getAttribute("dze_bind_key");if(!e)break;var h=findItemsObject(a,"dze_bind_key",e);if(!h)break;var g=dzeEnvConfig.bDebugging,k=g?h[f]:null,l=g_objNodeUtil.isCell(b)?d.getInnerText(b):b.value;l=l.trim();h[f]=l;g&&(dlog("*** Data Binding ("+g_nBindDataChange+") ***"),dlog(" * Changed: "),
dlog("   key: "+f),dlog("   value: "+k+" -> "+l),dlog(" * Json Items:"),dlog(h),dlog(" * Target:"),dlog(b),dlog("*** End ***"),g_nBindDataChange++);break;case "UNDOREDO":a=Object.assign(a,c.new_state)}return a}catch(n){dalert(n)}}function mutationObserve(a,c,d){try{if(a&&c)return a._targetNodes||(a._targetNodes=[]),a._targetNodes.push(c),a.observe(c,d)}catch(b){dalert(b)}}function findItemsObject(a,c,d){try{return findItemsObjectHelper(a,c,d)}catch(b){dalert(b)}}
function findItemsObjectHelper(a,c,d){try{if(!a)return null;var b=null;if(a instanceof Array){for(var f in a)if(b=findItemsObjectHelper(a[f],c,d))break;return b}if(a[c]&&a[c]===d)return a;if("object"==typeof a&&null!==a){var e=Object.keys(a);if(0<e.length)for(f=0;f<e.length&&!(b=findItemsObjectHelper(a[e[f]],c,d));f++);}return b}catch(h){dalert(h)}}function removeAllItemsKey(a,c){try{return removeAllItemsKeyHelper(a,c)}catch(d){dalert(d)}}
function removeAllItemsKeyHelper(a,c){try{if(a)if(a instanceof Array)for(var d in a)removeAllItemsKeyHelper(a[d],c);else if(a[c])delete a[c];else if("object"==typeof a&&null!==a){var b=Object.keys(a);if(0<b.length)for(d=0;d<b.length;d++)removeAllItemsKeyHelper(a[b[d]],c)}}catch(f){dalert(f)}}
function removeAllBindDataAttr(a){try{if(a){var c=a.querySelectorAll("[dze_bind_key], [mapping_key]");forEach(c,function(a,b){b.removeAttribute("dze_bind_key");b.removeAttribute("mapping_key")},this)}}catch(d){dalert(d)}}
Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert first argument to object");for(var c=Object(a),d=1;d<arguments.length;d++){var b=arguments[d];if(void 0!==b&&null!==b){b=Object(b);for(var f=Object.keys(Object(b)),e=0,h=f.length;e<h;e++){var g=f[e],k=Object.getOwnPropertyDescriptor(b,g);void 0!==k&&k.enumerable&&(c[g]=b[g])}}}return c}});
function getBindExternalData(a){try{if(!dzeUiConfig.bUseDataBindTwoWay||!g_objBindStore)return null;g_objTagUtil.updateCurFormTagAttr(a);var c=g_objBindStore.getState(),d=JSON.parse(JSON.stringify(c));removeAllItemsKeyHelper(d,"dze_bind_key");return d}catch(b){dalert(b)}}
function doBindExternalDataWithOption(a,c,d){try{var b=d&&0<d.timeout?d.timeout:700,f=d&&"function"===typeof d.callback?d.callback:null;duzon_http.showLoading();setTimeout(function(){doBindExternalData(a,c);duzon_http.hideLoading();f&&f()},b);return!0}catch(e){return dalert(e),!1}}
function doBindExternalData(a,c){try{if(!0===fnObjectCheckNull(c))return!1;if(!0===dzeUiConfig.bUseDataBindTwoWay){var d=function(){try{g_objBindData="string"===typeof c?JSON.parse(c):JSON.parse(JSON.stringify(c)),g_objMutationObserver||(g_objMutationObserver=new MutationObserver(function(b){b.forEach(function(b){editor_onchange_cell(b,a)})}),g_objMutationConfig={characterData:!0,subtree:!0,childList:!0}),doBindExternalData_Sub(a,g_objBindData),g_objBindStore=Redux.createStore(reducer),g_objUndoRedo.registerInitialContentStack(a)}catch(n){dalert(n)}},
b=["../libs/redux.min.js"],f=b.length,e=function(){f--;0>=f&&d&&d()},h=g_objLayerKit.getLayerDocument();h=h||g_objEditorDocument[a];for(var g=0,k=b.length;g<k;g++){var l=b[g];endsWith(l,".css")?g_objInsertUtil.dynamicLoad_CSS(h,l,e):duzon_dialog.dynamicScriptCall(l,e)}}else"string"===typeof c&&(c=JSON.parse(c)),doBindExternalData_Sub(a,c);return!0}catch(n){return dalert(n),!1}}
function doBindExternalData_Sub(a,c){try{var d=!1;!1===fnObjectCheckNull(c.TABLE)&&(d=doBindTable(c.TABLE,a));fnObjectCheckNull(c.CHART);(!1===d&&!1===fnObjectCheckNull(c.items)||!1===fnObjectCheckNull(c.group))&&doBindTableRows(null,c,a);!1===fnObjectCheckNull(c.ITEMS)&&doBindItems(c.ITEMS,a)}catch(b){dalert(b)}}
function doBindItems(a,c){try{var d=Object.keys(a);if(0===d.length)return!1;var b=g_objEditorDocument[c].getElementsByClassName("dze_external_data_area");c=!1;b=[].slice.call(b);for(var f=0;f<b.length;f++){var e=b[f];var h=e.getAttribute("mapping_key");if(!1===fnObjectCheckNull(h)&&0!==h.length)for(var g=0;g<d.length;g++)if(d[g]===h){null!==bindToElem(e,a,h)&&(c=!0);break}}return c}catch(k){dalert(k)}}
function doBindTable(a,c){try{var d=Object.keys(a);if(0===d.length)return!1;for(var b=g_objEditorDocument[c].querySelectorAll("table[mapping_key]"),f,e,h=!1,g=0;g<b.length;g++)if(f=b[g],e=f.getAttribute("mapping_key"),!1===fnObjectCheckNull(e)&&0!==e.length)for(var k=0;k<d.length;k++)if(d[k]===e){!0===Array.isArray(a[e])?doBindTableSimple(f,a[e]):doBindTableRows(f,a[e],c);h=!0;break}return h}catch(l){dalert(l)}}
function doBindTableSimple(a,c){try{var d=new TableMatrix(a),b=a.rows,f=b.length-1,e=b[f].cells,h=c.length;a=!0;if(e.length===c[0].length){if(1!==b.length){e=b[f].cells;for(b=0;b<e.length;b++){var g=e[b];if(!1===g_objTableUtil.isBlankCell(g)){a=!1;break}}!0===a&&h--}d.insertRow(f+1,h);!1===a&&f++;var k;for(e=0;e<c.length;e++)for(h=k=0;h<d.colLength;h++)if(!1===d.isShow(e+f,h))k++;else{var l=c[e][h-k];if(!0!==fnObjectCheckNull(l)&&0!==l.length){g=d.getCell(e+f,h);var n=g_objNodeUtil.getFirstTextNode(g,
!0);if(!1===fnObjectCheckNull(n))var m=g_objNodeUtil.getParentElement(n);else m=g.firstChild,!0===fnObjectCheckNull(m)&&(m=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("p"),g.appendChild(m));m.textContent=l}}}}catch(r){dalert(r)}}
function doBindTableRows(a,c,d){try{var b=g_objEditorDocument[d],f=null!==a?a.getElementsByClassName("dze_external_data_area"):b.getElementsByClassName("dze_external_data_area"),e=null,h=null,g=null,k=null,l=Number.MAX_VALUE,n=0;f=[].slice.call(f);if(!1===fnObjectCheckNull(c.group)){var m=c.group,r=null,p=k=null;if(1<m.length&&(k=Object.keys(m[0].items),p=getCloneInfo(a,m,f),null===p))return n;for(var q=0;q<m.length;q++){r=m[q];if(!1===fnObjectCheckNull(r.items)||!1===fnObjectCheckNull(r.group))n=
doBindTableRows(a,r,d);if(q!==m.length-1){p.tableMatrix.makeMatrix();g_objTableOperation.autoInsertNewRow(p.tableMatrix,n,p.colIndex,p.cloneCells.cloneNode(!0));var u=p.tableMatrix.getCell(n,p.colIndex);b.body.scrollTop=u.offsetTop}}}if(!1===fnObjectCheckNull(c.items)){g=c.items;k=Object.keys(g);var t=b=d=null;for(m=0;m<f.length;m++)if(e=f[m],h=e.getAttribute("mapping_key"),!1===fnObjectCheckNull(h)&&0!==h.length)for(r=0;r<k.length;r++)if(k[r]===h){d=g_objNodeUtil.getLoopParentElementByTagNames(e,
["td","th"]);null===a&&(a=g_objNodeUtil.getLoopParentElement(d,DZE_HTMLOBJ_TABLE));null===t&&(t=new TableMatrix(a));b=t.getMatrixIndex(d);l=Math.min(l,b[0].row);n=Math.max(n,b[b.length-1].row);null===bindToElem(e,g,h)&&(dalert(""),e.parentNode.removeChild(e));f.splice(m,1);m--;break}}if(c.style&&t&&l<=n)for(f=a=null,e="",h=l;h<=n;h++)for(g=0;g<t.colLength;g++)t.isShow(h,g)&&(a=t.getRowRange(h,g),a.start<l||a.end>n||(f=t.getCell(h,g),e=(f.getAttribute("style")||"")+c.style,f.setAttribute("style",e)));
return n}catch(v){dalert(v)}}
function bindToElem(a,c,d){try{if(!(a&&a.parentNode&&c&&d))return null;var b=a.ownerDocument;if(!b)return null;var f=c.dze_bind_key;f||!0!==dzeUiConfig.bUseDataBindTwoWay||(f=g_objCommonUtil.getUniqueID(),c.dze_bind_key=f);var e=c[d],h="string";null!==e&&void 0!==e&&"object"===typeof e&&(h=e.type);var g=null;if("hyperlink"===h){g=b.createElement("a");g.style.fontFamily=a.style.fontFamily;g.style.fontSize=a.style.fontSize;g.appendChild(b.createTextNode(e.title));e.href&&g.setAttribute("href",e.href);
e.title&&g.setAttribute("title",e.title);g.setAttribute("target","_blank");if(e.style){var k=g.getAttribute("style")||"";k+=e.style;g.setAttribute("style",k)}var l=Object.keys(e);forEach(l,function(a,b){startsWith(b,"data-dze-")&&g.setAttribute(b,e[b])});a.parentNode.replaceChild(g,a)}else if("image"===h||"img"===h)g=a,"IMG"!==a.nodeName?g=b.createElement("img"):g_objPropertyUtil.removeClass(g,"dze_external_data_area"),e.style&&(k=g.getAttribute("style")||"",k+=e.style,g.setAttribute("style",k)),
e.src&&(g.src=e.src),e.alt&&g.setAttribute("alt",e.alt),l=Object.keys(e),forEach(l,function(a,b){startsWith(b,"data-dze-")&&g.setAttribute(b,e[b])}),a!==g&&a.parentNode.replaceChild(g,a);else if("hyperlink_image"===h){g=b.createElement("a");e.href&&g.setAttribute("href",e.href);e.title&&g.setAttribute("title",e.title);g.setAttribute("target","_blank");var n=b.createElement("img");e.src&&(n.src=e.src);var m=parseStyle(e.style);if(m){m.width&&(n.style.width=m.width,delete m.width);m.height&&(n.style.height=
m.height,delete m.height);for(var r in m)g.style[r]=m[r]}l=Object.keys(e);forEach(l,function(a,b){startsWith(b,"data-dze-")&&g.setAttribute(b,e[b])});g.appendChild(n);a.parentNode.replaceChild(g,a)}else if("currency"===h||"number"===h){g=b.createElement("span");g.style.fontFamily=a.style.fontFamily;g.style.fontSize=a.style.fontSize;var p=GetInputFormat(h);"currency"===h?(e.symbol&&(p.symbol=e.symbol),e.precision&&(p.precision=parseInt(e.precision,10))):"number"===h&&(e.separator&&(p.separator=e.separator),
e.precision&&(p.precision=parseInt(e.precision,10)));var q=e.value;q=escapeHtml(q);q=p.format(q);g.innerHTML=q;setParentAlign(a,"right");a.parentNode.insertBefore(g,a);a.parentNode.removeChild(a)}else if("string"===h&&dzeUiConfig.bUseDataBindTwoWay&&"true"===a.getAttribute("dze_two_way")){b="string"===h?!0:!1;k=g_objNodeUtil;var u=k.getLoopParentElementByTagNames(a,k.arrCellTagName);u||(b=!1);var t=b?u.querySelectorAll("input"):null;t&&1<t.length&&(b=!1);""!==(b?u.textContent.trim():"")&&(b=!1);if((t=
g_objMutationObserver)&&b){g=u;u.setAttribute("dze_bind_key",f);mutationObserve(t,u,g_objMutationConfig);d&&u.setAttribute("mapping_key",d);var v=getTitleText(c,d);g_objTableUtil.setCellInnerText(v,u)}else"string"===h&&(g=a,a.setAttribute("dze_bind_key",f),v=getTitleText(c,d),a.value=v,a.setAttribute("value",v),g_objPropertyUtil.removeClass(a,"dze_external_data_area"),a.removeAttribute("readonly"),a.style.border="none",resizeInput(a));fnObjectCheckNull(e)||setParentAlign(g,e.align)}else"slipPop"===
d||"attach"===d||"mngPop"===d||"cardName"===d||"slipCardName"===d||"etaxIssNo"===d||"etaxHometaxIssNo"===d?(g=b.createElement("a"),g.href=getHyperlinkUrl(c,d)):g=b.createElement("span"),g.style.fontFamily=a.style.fontFamily,g.style.fontSize=a.style.fontSize,p=GetInputFormat(a),q=getTitleText(c,d),q=escapeHtml(q),!p||"number"!==p.type&&"currency"!==p.type?fnObjectCheckNull(e)||setParentAlign(a,e.align):(q=p.format(q),setParentAlign(a,"right")),g.innerHTML=q,a.parentNode.insertBefore(g,a),a.parentNode.removeChild(a);
return g}catch(w){dalert(w)}}function setParentAlign(a,c){try{if(!a||fnObjectCheckNull(c))return!1;c=c||"";c=c.trim().toLowerCase();if(0>" start end left right center justify justify-all match-parent".split(" ").indexOf(c))return!1;var d=!1,b=g_objNodeUtil.getLoopParentElementByTagNames(a,["td","th"]);b&&(b.style.textAlign=c,b.removeAttribute("align"),d=!0);var f=g_objNodeUtil.getClosestParagraph(a);f&&(f.style.textAlign=c,d=!0);return d}catch(e){dalert(e)}}
function doInputArrayLoop(a,c,d){for(var b,f,e=null,h=0,g=a.length;h<g;h++)if(b=a[h],f=b.getAttribute("mapping_key"),b&&f&&!(0>=f.length))for(var k=0,l=c.length;k<l&&(!c[k]||c[k]!==f||(d&&(e=d(b,f)),!1!==e));k++);}
function calculateGroupRange(a,c,d,b,f){try{if(!a||!c||!c.length)return null;f=f||0;0===f&&(b={startRow:Number.MAX_VALUE,endRow:-1,startCol:Number.MAX_VALUE,endCol:-1});var e=c[0].items,h=c[0].group;e&&doInputArrayLoop(d,Object.keys(e),function(c,d){if(c=g_objNodeUtil.getLoopParentElementByTagNames(c,["td","th"]))d=a.getRowRangeFromCell(c),b.startRow=Math.min(b.startRow,d.start),b.endRow=Math.max(b.endRow,d.end),c=a.getColRangeFromCell(c),b.startCol=Math.min(b.startCol,c.start),b.endCol=Math.max(b.endCol,
c.end)});calculateGroupRange(a,h,d,b,++f);return b}catch(g){dalert(g)}}function getCloneInfo(a,c,d){if(!a)return null;a=new TableMatrix(a);if(!a)return null;var b=calculateGroupRange(a,c,d);if(!b||b.startRow>b.endRow||b.startCol>b.endCol)return null;c=b.startRow;d=b.endRow;b=b.startCol;var f=a.clone();d+1===f.rowLength-1?f.removeRow(d+1):f.removeRow(d+1,f.rowLength-1);0===c-1?f.removeRow(c-1):f.removeRow(0,c-1);0<b&&f.removeCol(0,b-1);return{tableMatrix:a,cloneCells:f.table,colIndex:b}}
function getTitleText(a,c){switch(c){case "attach":a="[\ucca8\ubd80\ud30c\uc77c]";break;case "slipPop":case "mngPop":a="[\uc0c1\uc138\ubcf4\uae30]";break;default:!(a=a[c])||"object"!==typeof a||fnObjectCheckNull(a.type)||"string"!==a.type||fnObjectCheckNull(a.value)||(a=a.value)}return a}
function getHyperlinkUrl(a,c){var d=null;switch(c){case "slipPop":case "attach":case "mngPop":d=a[c];break;case "cardName":d=a.cardPop;break;case "slipCardName":d=a.slipCardPop;break;case "etaxIssNo":d=a.etaxIssNoPop;break;case "etaxHometaxIssNo":d=a.etaxHometaxIssNoPop}return d}
function fnTool_ChangeModeForBind(a,c){try{if(dzeUiConfig.bUseDataBind&&dzeUiConfig.bUseDataBindTwoWay)if(c===ID_TB_TABMODE_EDIT){var d=g_objEditorDocument[a].body,b=g_objMutationObserver,f=g_objMutationConfig,e=g_objBindStore;if(d&&b&&f&&e){b.disconnect();b._targetNodes=void 0;var h=d.querySelectorAll("td[dze_bind_key], th[dze_bind_key], input[dze_bind_key]");forEach(h,function(a,c){"TD"===c.nodeName||"TH"===c.nodeName?(e.dispatch({type:"CHANGE",target:c}),mutationObserve(b,c,f)):"INPUT"===c.nodeName&&
e.dispatch({type:"CHANGE",target:c})},this)}}else c===ID_TB_TABMODE_SOURCE&&(b=g_objMutationObserver)&&(b.disconnect(),b._targetNodes=void 0)}catch(g){dalert(g)}};

var ListDlg=duzon_dialog.extend();
(function(){this.getListContainerContent=function(a,b){try{var c=parseInt(b.length/4,10);a="<div class='dze_orderedlist_container' id='"+a+"' style='height:"+(100*c+5+"px")+";'>";c=0;for(var d=b.length;c<d;c++){var f=b[c],e=f,g=c%4,h=parseInt(c/4,10);g=99*g+1*g+4+"px";var k=99*h+1*h+4+"px";a="none"==f?a+("<span class='dze_orderedlist_unit_img' value='"+e+"' style='top:"+k+"; left:"+g+";'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):a+("<span class='dze_orderedlist_unit_img' value='"+e+"' style='top:"+k+
"; left:"+g+"; background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+f+".png)'></span>")}return a+"</div>"}catch(l){dalert(l)}}}).call(ListDlg);var UListDlg=ListDlg.extend();
(function(){this.unorderlist_styles=["none","disc","circle","square"];this.unorderlist_ext_styles=["fillcircle","innercircle","diamond","triangle"];this.id_ul_container="id_ul_container";this.arrItem=[];this.getContent=function(){try{var a="";a+="<div class='duzon_dialog_content_medium' id='idx_dze_unorderedlist_content_medium'>";var b=this.unorderlist_styles;!0===dzeUiConfig.useExtUnorderedListStyleType&&(b=b.concat(this.unorderlist_ext_styles));a+=this.getListContainerContent(this.id_ul_container,
b);return a+"</div>"}catch(c){dalert(c)}};this.onLoad=function(a,b){try{var c=this;this.arrItem=[].slice.call(b.querySelectorAll("span.dze_orderedlist_unit_img"));for(var d=null,f=0,e=this.arrItem.length;f<e;f++)d=this.arrItem[f],this.convertListStyle(d.getAttribute("value"))===a&&d.setAttribute("selected",""),d.onclick=function(){c.select(this,b)}}catch(g){dalert(g)}};this.select=function(a){try{for(var b=a.hasAttribute("selected")?!0:!1,c=0,d=this.arrItem.length;c<d;c++)this.arrItem[c].removeAttribute("selected");
b?a.removeAttribute("selected"):a.setAttribute("selected","")}catch(f){dalert(f)}};this.getListStyle=function(){try{for(var a=null,b=0,c=this.arrItem.length;b<c;b++)if(a=this.arrItem[b],a.hasAttribute("selected"))return this.convertListStyle(a.getAttribute("value"));return""}catch(d){dalert(d)}};this.convertListStyle=function(a){return"innercircle"===a?"dzeExtListStyleInnerCircle":"triangle"===a?"dzeExtListStyleTriangle":"fillcircle"===a?"dzeExtListStyleFillCircle":"diamond"===a?"dzeExtListStyleDiamond":
a}}).call(UListDlg);var OListDlg=ListDlg.extend();
(function(){this.orderlist_styles="none decimal decimal-leading-zero upper-alpha lower-alpha upper-roman lower-roman lower-greek".split(" ");this.id_ol_container="id_ol_container";this.id_ol_start="id_ol_start";this.id_ol_spinner="id_ol_spinner";this.id_ol_preview="id_ol_preview";this.arrItem=[];this.getContent=function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+=this.getListContainerContent(this.id_ol_container,this.orderlist_styles);a+="</div>";a+="<table border='0' cellspacing='0' cellpadding='0' style='margin-top:7px;'>";
a+="<tr>";a+="<td style='padding-right: 7px;'><input type='checkbox' id='"+this.id_ol_start+"' value='1' ><label for='"+this.id_ol_start+"' style='background:none;'>"+ID_RES_CONST_STRING_LIST_NO_START+"</label> :</td>";a+="<td>"+this.makeSpinnerInputForm(this.id_ol_spinner,"",0,null,"",null,"","","","50px")+"</td>";a+="<td style='width:21px;'></td>";a+="<td style='padding-right: 7px;'>"+ID_RES_CONST_STRING_PREVIEW+" : </td>";a+="<td><ol id='"+this.id_ol_preview+"' class='style_dze_orderedlist_preview_num_ol'><li>&#8203;</li></ol></td>";
a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};this.onLoad=function(a,b){try{if(a&&b){var c=this,d=a.start||1,f=a.listStyle,e=$_(c.id_ol_preview);this.arrItem=[].slice.call(b.querySelectorAll("span.dze_orderedlist_unit_img"));a=null;b=0;for(var g=this.arrItem.length;b<g;b++)a=this.arrItem[b],a.getAttribute("value")===f&&(a.setAttribute("selected",""),e.style.listStyleType=f),a.onclick=function(){c.select(this)};var h=this.modifySpinnerValue(this.id_ol_spinner,null,1,d,function(a){e.setAttribute("start",
a)});e.setAttribute("start",d);h.enable(!1);$_(this.id_ol_start).onclick=function(a){h.enable(this.checked)}}}catch(k){dalert(k)}};this.select=function(a){try{for(var b=a.hasAttribute("selected")?!0:!1,c=0,d=this.arrItem.length;c<d;c++)this.arrItem[c].removeAttribute("selected");if(b)a.removeAttribute("selected");else{a.setAttribute("selected","");var f=a.getAttribute("value"),e=$_(this.id_ol_preview);e.style.listStyleType=f;e.firstChild.style.listStyleType=f}}catch(g){dalert(g)}};this.getListStyle=
function(){try{for(var a=null,b=0,c=this.arrItem.length;b<c;b++)if(a=this.arrItem[b],a.hasAttribute("selected"))return a.getAttribute("value");return""}catch(d){dalert(d)}};this.getStart=function(){try{if($_(this.id_ol_start).checked){var a=DzeSpinner.getSpinner(this.id_ol_spinner);if(a)return a.getValue()}return""}catch(b){dalert(b)}};this.getInfo=function(){return{listStyle:this.getListStyle(),start:this.getStart()}}}).call(OListDlg);var MultiLevelListDlg=duzon_dialog.extend();
(function(){this.arrListStyle=null;this.arrPreset=["decimal upper-alpha lower-alpha upper-roman lower-roman decimal-leading-zero decimal upper-alpha lower-alpha upper-roman lower-roman decimal-leading-zero".split(" "),"upper-alpha upper-roman lower-alpha lower-roman decimal decimal-leading-zero upper-alpha upper-roman lower-alpha lower-roman decimal decimal-leading-zero".split(" "),"upper-roman upper-alpha lower-roman lower-alpha decimal decimal-leading-zero upper-roman upper-alpha lower-roman lower-alpha decimal decimal-leading-zero".split(" ")];
this.getContent=function(){try{var a=dzeUiConfig.applyOListStyleDepthItems||null,b=dzeUiConfig.applyUListStyleDepthItems||null,c=[];a&&c.push(a);b&&c.push(b);for(var d=0,f=this.arrPreset.length;d<f;d++)c.push(this.arrPreset[d]);this.arrListStyle=c;c=0;var e="";e+='<table style="width:100%; border: 0px solid black;" cellspacing="0" cellpadding="0">';e+=this.getTitleRowHTML(0,ID_RES_DIALOG_STRING_CASCADE_ORDERLIST);e+="</table>";e+='<div class="dze_level_list_container">';e+='<div class="dze_level_list_row">';
e+=this.getItemHtml(a,c++);e+=this.getItemHtml(b,c++);e+="</div>";e+='<div class="dze_level_list_row">';d=0;for(f=this.arrPreset.length;d<f;d++)e+=this.getItemHtml(this.arrPreset[d],c++);return e+"</div></div>"}catch(g){dalert(g)}};this.getItemHtml=function(a,b){try{if(!a)return"";b='<div class="dze_level_list_item" index="'+b+'">';b+='<div class="dze_level_list_btn">'+this.getMultiLevelListHtml(a,3)+"</div>";b+='<div class="dze_level_list_preview">'+this.getMultiLevelListHtml(a,6)+"</div>";return b+
"</div>"}catch(c){dalert(c)}};this.getMultiLevelListHtml=function(a,b){try{if(!a)return"";for(var c=g_objListUtil,d="",f="",e="",g=[],h=0,k=Math.min(a.length,b);h<k;h++)e=a[h],f=c.isULStyle(e)?"ul":"ol",d=c.isCustomULStyle(e)?d+("<"+f+' class="'+e+'">'):d+("<"+f+' style="list-style-type: '+e+';">'),d+="<li><span>\u2015\u2015\u2015\u2015\u2015</span></li>",g.push("</"+f+">");return d+=g.join("")}catch(l){dalert(l)}};this.onLoad=function(a,b){try{var c=this,d=a.querySelectorAll("div.dze_level_list_item");
a=0;for(var f=d.length;a<f;a++)d[a].onclick=function(){var a=parseInt(this.getAttribute("index"),10);duzon_dialog.closeExtendsDlg();setMultiLevelListStyle(b,c.arrListStyle[a])}}catch(e){dalert(e)}}}).call(MultiLevelListDlg);

var g_objDragger=new function(){this.target=null;this.targetType="";this.clone=this.div=null;this.state=0;this.DETECTED=1;this.MOVING=2;this.mouseDownPos={x:0,y:0};this.cloneOrgPos={x:0,y:0};this.docDiffPos={x:0,y:0};this.scrollPos={x:0,y:0};this.initDiv=function(){try{return this.div||(this.div=g_objInsertUtil.insertLayerHTML('<div id="dze_drag" style="position:absolute; left: 0px; top: 0px; height: 0px; width: 0px; height: 0px; opacity:0.5;"></div>',!1)),this.div}catch(a){dalert(a)}};this.pointAdd=
function(a,b){return{x:a.x+b.x,y:a.y+b.y}};this.pointSubtract=function(a,b){return{x:a.x-b.x,y:a.y-b.y}};this.onMouseDown=function(a){try{if(!a||!EventUtil.isLeftButton(a))return!1;var b=this.detect(a);return b?(this.state=this.DETECTED,this.target=b.target,this.targetType=b.targetType,this.mouseDownPos={x:a.x,y:a.y},this.div&&(this.div.innerHTML=""),TBCancelBubbleEvent(a),!0):!1}catch(c){dalert(c)}};this.onMouseMove=function(a,b){try{if(!a||a.cancelBubble||!EventUtil.isLeftButtonPressed(a))return!1;
if(this.state===this.DETECTED){this.initDiv();b=g_objPositionUtil;var c=this.target.ownerDocument;this.docDiffPos=b.getDocumentPos(c.defaultView.frameElement);this.scrollPos.x=c.body.scrollLeft;this.scrollPos.y=c.body.scrollTop;this.cloneOrgPos=b.getDocumentPos(this.target);this.cloneOrgPos=this.pointAdd(this.cloneOrgPos,this.docDiffPos);this.cloneOrgPos=this.pointSubtract(this.cloneOrgPos,this.scrollPos);this.clone=this.target.cloneNode(!0);this.clone.style.left=this.cloneOrgPos.x+"px";this.clone.style.top=
this.cloneOrgPos.y+"px";this.div.innerHTML="";this.div.appendChild(this.clone);this.state=this.MOVING;TBCancelBubbleEvent(a);return!0}if(this.state===this.MOVING)return throttle(this,this.move,a,b),TBCancelBubbleEvent(a),!0}catch(d){dalert(d)}};this.onMouseUp=function(a,b){try{if(!a)return!1;if(this.state===this.MOVING){this.state=0;var c=g_objCommonUtil.toPx(this.clone.style.left),d=g_objCommonUtil.toPx(this.clone.style.top),e=c-this.cloneOrgPos.x,f=d-this.cloneOrgPos.y,g=g_objCommonUtil.toPx(this.target.style.left),
h=g_objCommonUtil.toPx(this.target.style.top);this.target.style.left=g+e+"px";this.target.style.top=h+f+"px";this.div.innerHTML="";this.clone=null;g_objNodeUtil.isAlive(this.target)&&this.moveEnd();this.target=null;this.targetType="";TBCancelBubbleEvent(a);return!0}this.state=0;return!1}catch(k){dalert(k)}};this.move=function(a,b){try{if(this.state===this.MOVING){var c=a.x-this.mouseDownPos.x,d=a.y-this.mouseDownPos.y;b||(c-=this.docDiffPos.x,d-=this.docDiffPos.y);this.clone.style.left=this.cloneOrgPos.x+
c+"px";this.clone.style.top=this.cloneOrgPos.y+d+"px"}}catch(e){dalert(e)}};this.detect=function(a){try{var b=g_objTextWrap.getAnchor(a.target||a.srcElement);return b?{targetType:"ANCHOR",target:b}:null}catch(c){dalert(c)}};this.moveEnd=function(){try{if("ANCHOR"===this.targetType){var a=g_nActiveEditNumber;g_objTextWrap.updateAnchor(this.target);showExtOutline_ObjectElement(this.target.firstChild,!0,!1,a);var b=this.target.ownerDocument.createRange();b.selectNode(this.target);SetCurRange(b);g_objUndoRedo.registerUndoRedoStack(0,
a);editor_onselectionchange(a)}}catch(c){dalert(c)}}};

var g_objTextWrap=new function(){this.IN_LINE_WITH_TEXT=0;this.IN_FRONT_OF_TEXT=1;this.setTextWrap=function(a,b){try{switch(b){case this.IN_LINE_WITH_TEXT:this.deleteAnchor(a);a.style.float="";break;case this.IN_FRONT_OF_TEXT:this.setAnchor(a)}}catch(c){dalert(c)}};this.createAnchorSpan=function(){var a=document.createElement("span");a.style.position="absolute";a.contenteditable=!1;return a};this.isAnchor=function(a){return a&&1===a.nodeType&&"absolute"===a.style.position?!0:!1};this.isAnchorParent=
function(a){return g_objNodeUtil.isBoundNode(a)||a&&1===a.nodeType&&"relative"===a.style.position?!0:!1};this.getAnchor=function(a){try{for(;a&&!this.isAnchorParent(a);){if(this.isAnchor(a))return a;a=a.parentNode}return null}catch(b){dalert(b)}};this.getLastChildAnchor=function(a){try{if(!a)return null;for(var b=null,c=a.firstChild;this.isAnchor(c);)b=c,c=c.nextSibling;return b}catch(d){dalert(d)}};this.getMaxZIndex=function(a){try{var b=9999,c=this;a.querySelectorAll("[style]").forEach(function(a){c.isAnchor(a)&&
a.style.zIndex&&(b=Math.max(b,a.style.zIndex))});return b+1}catch(d){dalert(d)}};this.setAnchor=function(a,b,c){try{if(this.getAnchor(a))return this.getAnchor(a);c=c||g_objNodeUtil.getClosetParagraph(a);if(!c)return null;!0===b?(a=this.createAnchorSpan(),elem.parentNode.replaceChild(a,elem),a.appendChild(elem)):a.style.position="absolute";this.setAnchorLeftTop(a,c);a.style.zIndex=this.getMaxZIndex(a.ownerDocument.body);this.insertAnchor(a,c);return a}catch(d){dalert(d)}};this.setAnchorLeftTop=function(a,
b){try{if(!a||!b)return null;var c=g_objPositionUtil,d=c.getDocumentPos(a),e=c.getDocumentPos(b),f={x:d.x-e.x,y:d.y-e.y};a.style.left=f.x+"px";a.style.top=f.y+"px";return f}catch(g){dalert(g)}};this.deleteAnchor=function(a){try{a=this.getAnchor(a);if(!a)return!1;var b=a.offsetParent,c=a.parentNode;c.removeChild(a);g_objNodeUtil.normalize(c);"relative"!==b.style.position||this.getLastChildAnchor(b)||(b.style.position="",""===b.style.cssText&&b.removeAttribute("style"));return!0}catch(d){dalert(d)}};
this.insertAnchor=function(a,b){try{if(!b||!a)return!1;b.style.position="relative";var c=this.getLastChildAnchor(b);c?insertAfter(c,a):b.firstChild?b.insertBefore(a,b.firstChild):b.appendChild(a);return!0}catch(d){dalert(d)}};this.findNearestPara=function(a,b){try{if(!a)return null;var c=function(a,b){var c=a.x-b.x;a=a.y-b.y;return Math.sqrt(c*c+a*a)},d=function(a){return g_objNodeUtil.isParagraph(a)?NodeFilter.FILTER_ACCEPT:g_objNodeUtil.isInlineNode(a)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_SKIP};
d.acceptNode=d;var e=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,d,!0);a=null;for(var f=Number.MAX_VALUE,g=e.firstChild(),k=d=null,h=Number.MAX_VALUE;g;){k=g_objPositionUtil.getDocumentPos(g);h=c(k,b);if(Math.abs(h)<f)f=h,a=g;else break;d=e.nextNode();if(d===g)break;g=d}return a}catch(l){dalert(l)}};this.updateAnchor=function(a){try{if(a){var b=a.ownerDocument,c=a.offsetParent;if(g_objNodeUtil.isParagraph(c)){var d=this.findNearestPara(b.body,g_objPositionUtil.getDocumentPos(a));if(d&&
c!==d)return this.setAnchorLeftTop(a,d),this.deleteAnchor(a),this.insertAnchor(a,d),!0}return!1}}catch(e){dalert(e)}};this.findPrevAnchorAtCursor=function(a,b){try{for(var c=g_objNodeUtil;a&&!c.isLoopBreakNode(a);)if(0===b)b=g_objNodeUtil.getChildIndex(a),a=a.parentNode;else{c=1;for(var d=a.firstChild;c<b&&d;)c++,d=d.nextSibling;if(this.isAnchor(d))return d;break}return null}catch(e){dalert(e)}}};
function deleteKeyAnchor(a){try{if(!a)return!1;var b=GetCurRange(a.nEditNumber);if(!b)return!1;var c=b.startContainer.childNodes[b.startOffset]||b.startContainer,d=!1;if(c===(b.endContainer.childNodes[b.endOffset-1]||b.endContainer)){var e=g_objTextWrap.getAnchor(c),f=g_objNodeUtil.getClosetParagraph(e);e&&f&&(d=g_objTextWrap.deleteAnchor(e));!0===d&&g_objCaretUtil.moveCaret(f)}return a.keyCode===ID_KEYCODE_BACKSPACE&&b.collapsed&&(e=g_objTextWrap.findPrevAnchorAtCursor(b.startContainer,b.startOffset))?
(b.selectNode(e),SetCurRange(b),!0):d}catch(g){dalert(g)}};

function GetInputFormat(a){var b="",c="";"string"===typeof a?b=a:a&&"INPUT"===a.nodeName&&(c=a,b=c.getAttribute(DZE_FORMAT_TYPE));return obj="number"===b?new DzeNumberFormat(c):"currency"===b?new DzeCurrencyFormat(c):new DzeGeneralFormat}function extendFunction(a,b){var c=function(){};c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.superclass=b.prototype;b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)}
function DzeGeneralFormat(){this.type="general";return this}
DzeGeneralFormat.prototype={clone:function(){return new DzeGeneralFormat},removeAttributeAll:function(a){a&&(a.removeAttribute(DZE_FORMAT_TYPE),a.removeAttribute(DZE_FORMAT_PRECISION),a.removeAttribute(DZE_FORMAT_SEPARATOR),a.removeAttribute(DZE_FORMAT_SYMBOL))},setAttribute:function(a){if(!a)return!1;this.removeAttributeAll();return!0},checkValid:function(a){return!0},format:function(a){return a},removeDotExceptLast:function(a){return a.replace(/[.](?=.*[.])/g,"")},removeComma:function(a){return a.replaceAll(",",
"")},getPrecision:function(a){a=a.split(".");return a[1]?a[1].length:0}};function DzeNumberFormat(a){this.type="number";this.precision=-1;this.separator="";a&&"INPUT"===a.nodeName&&(a.hasAttribute(DZE_FORMAT_PRECISION)&&(this.precision=parseInt(a.getAttribute(DZE_FORMAT_PRECISION),10)),a.getAttribute(DZE_FORMAT_SEPARATOR)&&(this.separator=a.getAttribute(DZE_FORMAT_SEPARATOR)));return this}extendFunction(DzeNumberFormat,DzeGeneralFormat);
DzeNumberFormat.prototype.clone=function(){var a=new DzeNumberFormat;a.precision=this.precision;a.separator=this.separator;return a};DzeNumberFormat.prototype.setAttribute=function(a){if(!a)return!1;this.removeAttributeAll(a);a.setAttribute(DZE_FORMAT_TYPE,this.type);0<=this.precision&&a.setAttribute(DZE_FORMAT_PRECISION,this.precision);""!==this.separator&&a.setAttribute(DZE_FORMAT_SEPARATOR,",");return!0};
DzeNumberFormat.prototype.toNumberString=function(a){try{if(fnObjectCheckNull(a)||""===a)return"";a+="";a=this.removeComma(a);return a=this.removeDotExceptLast(a)}catch(b){dalert(b)}};DzeNumberFormat.prototype.checkValid=function(a){try{return a=this.toNumberString(a),""===a||!isNaN(a)||/^(,|\.|\d)+$/.test(a)?!0:!1}catch(b){dalert(b)}};
DzeNumberFormat.prototype.format=function(a){try{if(""===a)return"";a=this.toNumberString(a);var b=0;b=0<=this.precision?this.precision:this.getPrecision(a);0>b&&(b=0);var c=currency(a,{symbol:"",precision:b,separator:this.separator}).format();dlog("DzeNumberFormat.format: oldValue("+a+"), newValue("+c+")");return c}catch(d){dalert(d)}};
function DzeCurrencyFormat(a){this.type="currency";this.precision=-1;this.symbol="";a&&"INPUT"===a.nodeName&&(a.hasAttribute(DZE_FORMAT_PRECISION)&&(this.precision=parseInt(a.getAttribute(DZE_FORMAT_PRECISION),10)),a.getAttribute(DZE_FORMAT_SYMBOL)&&(this.symbol=a.getAttribute(DZE_FORMAT_SYMBOL)));return this}extendFunction(DzeCurrencyFormat,DzeGeneralFormat);DzeCurrencyFormat.prototype.clone=function(){var a=new DzeCurrencyFormat;a.precision=this.precision;a.symbol=this.symbol;return a};
DzeCurrencyFormat.prototype.setAttribute=function(a){if(!a)return!1;this.removeAttributeAll(a);a.setAttribute(DZE_FORMAT_TYPE,this.type);0<=this.precision&&a.setAttribute(DZE_FORMAT_PRECISION,this.precision);""!==this.symbol&&a.setAttribute(DZE_FORMAT_SYMBOL,this.symbol);return!0};
DzeCurrencyFormat.prototype.toNumberString=function(a){try{if(fnObjectCheckNull(a)||""===a)return"";a+="";a=this.removeComma(a);a=this.removeDotExceptLast(a);return a=a.replaceAll("\u20a9","").replaceAll("$","").replaceAll("\u00a5","")}catch(b){dalert(b)}};DzeCurrencyFormat.prototype.checkValid=function(a){try{return a=this.toNumberString(a),""===a||!isNaN(a)||/^(\u20a9|\$|\u00a5|,|\.|\d)+$/.test(a)?!0:!1}catch(b){dalert(b)}};
DzeCurrencyFormat.prototype.format=function(a){try{if(""===a)return"";a=this.toNumberString(a);var b="";switch(this.symbol){case "won":b="\u20a9";break;case "dollar":b="$";break;case "yen":case "yuan":b="\u00a5"}var c=0;c=0<=this.precision?this.precision:this.getPrecision(a);0>c&&(c=0);var d=currency(a,{symbol:b,precision:c}).format();dlog("DzeCurrencyFormat.format: oldValue("+a+"), newValue("+d+")");return d}catch(e){dalert(e)}};

var g_objInputFormatEvent=new function(){this.isFormattedInput=function(a){return a&&"INPUT"===a.nodeName&&a.hasAttribute(DZE_FORMAT_TYPE)&&(a=a.getAttribute(DZE_FORMAT_TYPE),"number"===a||"currency"===a)?!0:!1};this.isEditing=function(a){return a&&"INPUT"===a.nodeName&&a.hasAttribute(DZE_EDIT_FORMAT)?!0:!1};this.setEditing=function(a){try{if(this.isEditing(a)||!this.isFormattedInput(a)||a.readOnly)return!1;var b=GetInputFormat(a);if(!b)return!1;var c=a.value,d=a.type;a.value="";a.type="number";a.value=
b.toNumberString(c);a.setAttribute(DZE_EDIT_FORMAT,"");a.setAttribute(DZE_OLD_TYPE,d);var e=this;a.onblur=function(a){!0===e.removeEditing(this)&&editor_onchange(a,g_nActiveEditNumber)};return!0}catch(f){dalert(f)}};this.removeEditing=function(a){try{if(!this.isEditing(a))return!1;var b=GetInputFormat(a);if(!b)return!1;var c=a.value,d=a.getAttribute(DZE_OLD_TYPE)||"text";a.value="";a.type=d;a.value=b.format(c);a.removeAttribute(DZE_EDIT_FORMAT);a.removeAttribute(DZE_OLD_TYPE);a.onblur=null;return!0}catch(e){dalert(e)}};
this.onMouseDown=function(a){try{var b=a.target||a.srcElement;this.isFormattedInput(b)&&this.setEditing(b)}catch(c){dalert(c)}};this.onChange=function(a){try{var b=a.target||a.srcElement;this.isFormattedInput(b)&&this.removeEditing(b)}catch(c){dalert(c)}};this.onInput=function(a){try{var b=g_objEditorDocument[a.nEditNumber].activeElement;this.isFormattedInput(b)&&!this.isEditing(b)&&this.setEditing(b)}catch(c){dalert(c)}};this.onKeyDown=function(a){try{var b=a.target||a.srcElement,c=a.keyCode;this.isFormattedInput(b)&&
isEditingKeyCode(c)&&c!==ID_KEYCODE_TAB&&(this.isEditing(b)?c===ID_KEYCODE_ENTER&&this.removeEditing(b):(this.setEditing(b),b.select(),TBCancelBubbleEvent(a)))}catch(d){dalert(d)}};this.forceBlurInput=function(a){try{var b=g_objEditorDocument[a].activeElement;this.isFormattedInput(b)&&this.isEditing(b)&&(this.removeEditing(b)&&g_objTagUtil.updateFormTagAttr(b),b.blur())}catch(c){dalert(c)}};this.removeAllEditingInput=function(a){try{var b=a.querySelectorAll("input["+DZE_EDIT_FORMAT+"]");for(a=0;a<
b.length;a++)this.removeEditing(b[a])}catch(c){dalert(c)}}};

/*
 currency.js - v2.0.4
 http://scurker.github.io/currency.js

 Copyright (c) 2021 Jason Wilson
 Released under MIT license
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(b,d){return Object.prototype.hasOwnProperty.call(b,d)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,d){for(var e=1;e<arguments.length;e++){var f=arguments[e];if(f)for(var g in f)$jscomp.owns(f,g)&&(b[g]=f[g])}return b};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,d,e){b!=Array.prototype&&b!=Object.prototype&&(b[d]=e.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,d,e,f){if(d){e=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var g=b[f];g in e||(e[g]={});e=e[g]}b=b[b.length-1];f=e[b];d=d(f);d!=f&&null!=d&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");
(function(b,d){"object"===typeof exports&&"undefined"!==typeof module?module.exports=d():"function"===typeof define&&define.amd?define(d):(b=b||self,b.currency=d())})(this,function(){function b(c,a){if(!(this instanceof b))return new b(c,a);a=Object.assign({},e,a);var h=Math.pow(10,a.precision);this.intValue=c=d(c,a);this.value=c.div(h);a.increment=a.increment||1/h;a.groups=a.useVedic?g:f;this.s=a;this.p=h}function d(c,a){var h=a.decimal,d=a.errorOnInvalid,e=a.fromCents;a=Math.pow(10,a.precision);
var f=c instanceof b;if(f&&e)return c.intValue;if("number"===typeof c||f)c=f?c.value:c;else if("string"===typeof c)d=new RegExp("[^-\\d"+h+"]","g"),h=new RegExp("\\"+h,"g"),c=(c=c.replace(/\((.*)\)/,"-$1").replace(d,"").replace(h,"."))||0;else{if(d)throw Error("Invalid Input");c=0}e||(c=Big(c).times(a),c=Big(c.toFixed(4)));return c}var e={symbol:"$",separator:",",decimal:".",errorOnInvalid:!1,precision:2,pattern:"!#",negativePattern:"-!#",format:function(c,a){var b=a.pattern,d=a.negativePattern,e=
a.symbol,f=a.separator,g=a.decimal;a=a.groups;var k=(""+c).replace(/^-/,"").split("."),m=k[0];k=k[1];return(c.value.gte(0)?b:d).replace("!",e).replace("#",m.replace(a,"$1"+f)+(k?g+k:""))},fromCents:!1},f=/(\d)(?=(\d{3})+\b)/g,g=/(\d)(?=(\d\d)+\d\b)/g;b.prototype={add:function(c){var a=this.s,h=this.p;return b((this.intValue+d(c,a))/(a.fromCents?1:h),a)},subtract:function(c){var a=this.s,h=this.p;return b((this.intValue-d(c,a))/(a.fromCents?1:h),a)},multiply:function(c){var a=this.s;return b(this.intValue*
c/(a.fromCents?1:Math.pow(10,a.precision)),a)},divide:function(c){var a=this.s;return b(this.intValue/d(c,a,!1),a)},distribute:function(c){var a=this.intValue,d=this.p,e=this.s,f=[],g=Math[0<=a?"floor":"ceil"](a/c),l=Math.abs(a-g*c);for(d=e.fromCents?1:d;0!==c;c--){var k=b(g/d,e);0<l--&&(k=k[0<=a?"add":"subtract"](1/d));f.push(k)}return f},dollars:function(){return~~this.value},cents:function(){return~~(this.intValue%this.p)},format:function(c){var a=this.s;return"function"===typeof c?c(this,a):a.format(this,
Object.assign({},a,c))},toString:function(){for(var c=this.s,a=this.intValue.div(this.p),b=c.increment,d=0,e=Math.abs(b);0>e;)e*=10,d++;return a.div(b).round(d,Big.roundDown).times(b).toFixed(c.precision)},toJSON:function(){return this.value}};return b});

(function(y){function x(){function a(b){if(!(this instanceof a))return void 0===b?x():new a(b);if(b instanceof a)this.s=b.s,this.e=b.e,this.c=b.c.slice();else{if("string"!==typeof b){if(!0===a.strict)throw TypeError("[big.js] Invalid number");b=0===b&&0>1/b?"-0":String(b)}var d,e;if(!z.test(b))throw Error("[big.js] Invalid number");this.s="-"==b.charAt(0)?(b=b.slice(1),-1):1;-1<(d=b.indexOf("."))&&(b=b.replace(".",""));0<(e=b.search(/e/i))?(0>d&&(d=e),d+=+b.slice(e+1),b=b.substring(0,e)):0>d&&(d=
b.length);var c=b.length;for(e=0;e<c&&"0"==b.charAt(e);)++e;if(e==c)this.c=[this.e=0];else{for(;0<c&&"0"==b.charAt(--c););this.e=d-e-1;this.c=[];for(d=0;e<=c;)this.c[d++]=+b.charAt(e++)}}this.constructor=a}a.prototype=g;a.DP=20;a.RM=1;a.NE=-7;a.PE=21;a.strict=!1;a.roundDown=0;a.roundHalfUp=1;a.roundHalfEven=2;a.roundUp=3;return a}function q(a,b,d,e){var c=a.c;void 0===d&&(d=a.constructor.RM);if(0!==d&&1!==d&&2!==d&&3!==d)throw Error("[big.js] Invalid rounding mode");if(1>b)e=3===d&&(e||!!c[0])||0===
b&&(1===d&&5<=c[0]||2===d&&(5<c[0]||5===c[0]&&(e||void 0!==c[1]))),c.length=1,e?(a.e=a.e-b+1,c[0]=1):c[0]=a.e=0;else if(b<c.length){e=1===d&&5<=c[b]||2===d&&(5<c[b]||5===c[b]&&(e||void 0!==c[b+1]||c[b-1]&1))||3===d&&(e||!!c[0]);c.length=b--;if(e)for(;9<++c[b];)c[b]=0,b--||(++a.e,c.unshift(1));for(b=c.length;!c[--b];)c.pop()}return a}function m(a,b,d){var e=a.e,c=a.c.join(""),f=c.length;if(b)c=c.charAt(0)+(1<f?"."+c.slice(1):"")+(0>e?"e":"e+")+e;else if(0>e){for(;++e;)c="0"+c;c="0."+c}else if(0<e)if(++e>
f)for(e-=f;e--;)c+="0";else e<f&&(c=c.slice(0,e)+"."+c.slice(e));else 1<f&&(c=c.charAt(0)+"."+c.slice(1));return 0>a.s&&d?"-"+c:c}var g={},z=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;g.abs=function(){var a=new this.constructor(this);a.s=1;return a};g.cmp=function(a){var b=this.c,d=(a=new this.constructor(a)).c,e=this.s,c=a.s,f=this.e,h=a.e;if(!b[0]||!d[0])return b[0]?e:d[0]?-c:0;if(e!=c)return e;a=0>e;if(f!=h)return f>h^a?1:-1;c=(f=b.length)<(h=d.length)?f:h;for(e=-1;++e<c;)if(b[e]!=d[e])return b[e]>
d[e]^a?1:-1;return f==h?0:f>h^a?1:-1};g.div=function(a){var b=this.constructor,d=this.c,e=(a=new b(a)).c,c=this.s==a.s?1:-1,f=b.DP;if(f!==~~f||0>f||1E6<f)throw Error("[big.js] Invalid decimal places");if(!e[0])throw Error("[big.js] Division by zero");if(!d[0])return a.s=c,a.c=[a.e=0],a;var h,g=e.slice(),m=h=e.length,p=d.length,k=d.slice(0,h),l=k.length,r=a,v=r.c=[],w=0,t=f+(r.e=this.e-a.e)+1;r.s=c;c=0>t?0:t;for(g.unshift(0);l++<h;)k.push(0);do{for(f=0;10>f;f++){if(h!=(l=k.length))var u=h>l?1:-1;else{var n=
-1;for(u=0;++n<h;)if(e[n]!=k[n]){u=e[n]>k[n]?1:-1;break}}if(0>u){for(a=l==h?e:g;l;){if(k[--l]<a[l]){for(n=l;n&&!k[--n];)k[n]=9;--k[n];k[l]+=10}k[l]-=a[l]}for(;!k[0];)k.shift()}else break}v[w++]=u?f:++f;k[0]&&u?k[l]=d[m]||0:k=[d[m]]}while((m++<p||void 0!==k[0])&&c--);v[0]||1==w||(v.shift(),r.e--,t--);w>t&&q(r,t,b.RM,void 0!==k[0]);return r};g.eq=function(a){return 0===this.cmp(a)};g.gt=function(a){return 0<this.cmp(a)};g.gte=function(a){return-1<this.cmp(a)};g.lt=function(a){return 0>this.cmp(a)};
g.lte=function(a){return 1>this.cmp(a)};g.minus=g.sub=function(a){var b=this.constructor;var d=this.s,e=(a=new b(a)).s;if(d!=e)return a.s=-e,this.plus(a);var c=this.c.slice();var f=this.e;var h=a.c,g=a.e;if(!c[0]||!h[0])return h[0]?a.s=-e:c[0]?a=new b(this):a.s=1,a;if(d=f-g){(b=0>d)?(d=-d,f=c):(g=f,f=h);f.reverse();for(e=d;e--;)f.push(0);f.reverse()}else for(f=((b=c.length<h.length)?c:h).length,d=e=0;e<f;e++)if(c[e]!=h[e]){b=c[e]<h[e];break}b&&(f=c,c=h,h=f,a.s=-a.s);if(0<(e=(f=h.length)-(b=c.length)))for(;e--;)c[b++]=
0;for(e=b;f>d;){if(c[--f]<h[f]){for(b=f;b&&!c[--b];)c[b]=9;--c[b];c[f]+=10}c[f]-=h[f]}for(;0===c[--e];)c.pop();for(;0===c[0];)c.shift(),--g;c[0]||(a.s=1,c=[g=0]);a.c=c;a.e=g;return a};g.mod=function(a){var b=this,d=b.constructor,e=b.s,c=(a=new d(a)).s;if(!a.c[0])throw Error("[big.js] Division by zero");b.s=a.s=1;var f=1==a.cmp(b);b.s=e;a.s=c;if(f)return new d(b);e=d.DP;c=d.RM;d.DP=d.RM=0;b=b.div(a);d.DP=e;d.RM=c;return this.minus(b.times(a))};g.plus=g.add=function(a){var b=this.constructor;a=new b(a);
if(this.s!=a.s)return a.s=-a.s,this.minus(a);var d=this.e;var e=this.c,c=a.e,f=a.c;if(!e[0]||!f[0])return f[0]||(e[0]?a=new b(this):a.s=this.s),a;e=e.slice();if(b=d-c){0<b?(c=d,d=f):(b=-b,d=e);for(d.reverse();b--;)d.push(0);d.reverse()}0>e.length-f.length&&(d=f,f=e,e=d);b=f.length;for(d=0;b;e[b]%=10)d=(e[--b]=e[b]+f[b]+d)/10|0;d&&(e.unshift(d),++c);for(b=e.length;0===e[--b];)e.pop();a.c=e;a.e=c;return a};g.pow=function(a){var b=this,d=new b.constructor("1"),e=d,c=0>a;if(a!==~~a||-1E6>a||1E6<a)throw Error("[big.js] Invalid exponent");
for(c&&(a=-a);;){a&1&&(e=e.times(b));a>>=1;if(!a)break;b=b.times(b)}return c?d.div(e):e};g.prec=function(a,b){if(a!==~~a||1>a||1E6<a)throw Error("[big.js] Invalid precision");return q(new this.constructor(this),a,b)};g.round=function(a,b){if(void 0===a)a=0;else if(a!==~~a||-1E6>a||1E6<a)throw Error("[big.js] Invalid decimal places");return q(new this.constructor(this),a+this.e+1,b)};g.sqrt=function(){var a=this.constructor;var b=this.s;var d=this.e,e=new a("0.5");if(!this.c[0])return new a(this);
if(0>b)throw Error("[big.js] No square root");b=Math.sqrt(this+"");if(0===b||b===1/0){var c=this.c.join("");c.length+d&1||(c+="0");b=Math.sqrt(c);d=((d+1)/2|0)-(0>d||d&1);c=new a((b==1/0?"5e":(b=b.toExponential()).slice(0,b.indexOf("e")+1))+d)}else c=new a(b+"");d=c.e+(a.DP+=4);do b=c,c=e.times(b.plus(this.div(b)));while(b.c.slice(0,d).join("")!==c.c.slice(0,d).join(""));return q(c,(a.DP-=4)+c.e+1,a.RM)};g.times=g.mul=function(a){var b=this.c,d=(a=new this.constructor(a)).c,e=b.length,c=d.length,
f=this.e,h=a.e;a.s=this.s==a.s?1:-1;if(!b[0]||!d[0])return a.c=[a.e=0],a;a.e=f+h;if(e<c){var g=b;b=d;d=g;h=e;e=c;c=h}for(g=Array(h=e+c);h--;)g[h]=0;for(f=c;f--;){c=0;for(h=e+f;h>f;)c=g[h]+d[f]*b[h-f-1]+c,g[h--]=c%10,c=c/10|0;g[h]=c}c?++a.e:g.shift();for(f=g.length;!g[--f];)g.pop();a.c=g;return a};g.toExponential=function(a,b){var d=this,e=d.c[0];if(void 0!==a){if(a!==~~a||0>a||1E6<a)throw Error("[big.js] Invalid decimal places");for(d=q(new d.constructor(d),++a,b);d.c.length<a;)d.c.push(0)}return m(d,
!0,!!e)};g.toFixed=function(a,b){var d=this,e=d.c[0];if(void 0!==a){if(a!==~~a||0>a||1E6<a)throw Error("[big.js] Invalid decimal places");d=q(new d.constructor(d),a+d.e+1,b);for(a=a+d.e+1;d.c.length<a;)d.c.push(0)}return m(d,!1,!!e)};g.toJSON=g.toString=function(){var a=this.constructor;return m(this,this.e<=a.NE||this.e>=a.PE,!!this.c[0])};g.toNumber=function(){var a=Number(m(this,!0,!0));if(!0===this.constructor.strict&&!this.eq(a.toString()))throw Error("[big.js] Imprecise conversion");return a};
g.toPrecision=function(a,b){var d=this,e=d.constructor,c=d.c[0];if(void 0!==a){if(a!==~~a||1>a||1E6<a)throw Error("[big.js] Invalid precision");for(d=q(new e(d),a,b);d.c.length<a;)d.c.push(0)}return m(d,a<=d.e||d.e<=e.NE||d.e>=e.PE,!!c)};g.valueOf=function(){var a=this.constructor;if(!0===a.strict)throw Error("[big.js] valueOf disallowed");return m(this,this.e<=a.NE||this.e>=a.PE,!0)};var p=x();p["default"]=p.Big=p;"function"===typeof define&&define.amd?define(function(){return p}):"undefined"!==
typeof module&&null!==module&&module.exports?module.exports=p:y.Big=p})(this);

var InputDataBinderDlg=duzon_dialog.extend();
(function(){this.createCustomInputBoxDialog=function(){try{var b=document.createElement("div");b.className="duzon_dialog_content_small";var d=document.createElement("table");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");d.setAttribute("width","100%");d.setAttribute("style","border-collapse:collapse;");var c=d.insertRow(),a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_NAME;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML="<input type='text' name='dze_input_box_name' value='' id='id_dze_input_box_name' style='width:117px;'/>";
c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.height=8;c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_TAG_NAME;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML="<input type='text' name='dze_input_box_tag_name' value='' id='id_dze_input_box_tag_name' style='width:117px;'/>";c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.height=8;c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=
ID_RES_DIALOG_STRING_TAG_FORMAT;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML="<input type='text' name='dze_input_box_tag_format' value='' id='id_dze_input_box_tag_format' style='width:117px;'/>";c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.height=8;for(var f=[],e=0;e<CONTRACTOR_TYPE.length;e++)f.push({value:CONTRACTOR_TYPE[e].name,text:CONTRACTOR_TYPE[e].name});c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_CONTRACTOR_TYPE;
a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML=this.makeComboInputForm("id_dze_input_box_contractor_type",f,120);c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.innerHTML="<div class='duzon_dialog_label_separator'></div>";c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_TEXT_LENGTH;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML="<input type='text' name='dze_input_box_text_length' value='' id='id_dze_input_box_text_length' style='width:117px;'/>";
c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.height=8;f=[];for(e=1;e<g_arrFontName.length;e++)f.push({value:g_arrFontName[e],text:g_arrFontName[e].replace(/['"]/g,"")});c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_FONT_FAMILY;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML=this.makeComboInputForm("id_dze_input_box_font_family",f,120);f=[];for(e=1;e<g_objComboBoxWin.arrFontSize.length;e++)f.push({value:g_objComboBoxWin.arrFontSize[e],
text:g_objComboBoxWin.arrFontSize[e]});c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.height=8;c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_FONT_SIZE;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML=this.makeComboInputForm("id_dze_input_box_font_size",f,120);c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.height=8;f=[];for(e=0;e<FONT_WEIGHT_TYPE.length;e++)f.push({value:FONT_WEIGHT_TYPE[e].value,
text:FONT_WEIGHT_TYPE[e].name});c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_FONT_WEIGHT;a=c.insertCell();a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML=this.makeComboInputForm("id_dze_input_box_font_weight",f,120);c=d.insertRow();a=c.insertCell();a.setAttribute("colspan","2");a.innerHTML="<div class='duzon_dialog_label_separator'></div>";c=d.insertRow();a=c.insertCell();a.style.width="40%";a.textContent=ID_RES_DIALOG_STRING_READONLY;a=c.insertCell();
a.style.width="60%";a.style.paddingLeft="20px";a.innerHTML="<input type='radio' name='dze_input_box_readonly' value='1' id='id_dze_input_box_readonly_yes'/><label for='id_dze_input_box_readonly_yes' style='background: none; margin-right: 32px;'>"+ID_RES_DIALOG_CONFIRM_YES+"</label><input type='radio' name='dze_input_box_readonly' value='2' id='id_dze_input_box_readonly_no'/><label for='id_dze_input_box_readonly_no' style='background: none;'>"+ID_RES_DIALOG_CONFIRM_NO+"</label>";b.appendChild(d);return b.outerHTML}catch(h){dalert(h)}};
this.customInputBoxDialogElements=[];this.customInputBox={name:"",tagName:"",tagFormat:"",contractCode:"",textLength:"",fontFamily:"",fontSize:"",fontWeight:"",readOnly:""};this.initCustomInputBox=function(b){try{this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME]=g_objLayerKit.getElementById("id_dze_input_box_name");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME]=g_objLayerKit.getElementById("id_dze_input_box_tag_name");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_FORMAT]=
g_objLayerKit.getElementById("id_dze_input_box_tag_format");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE]=g_objLayerKit.getElementById("id_dze_input_box_contractor_type");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TEXT_LENGTH]=g_objLayerKit.getElementById("id_dze_input_box_text_length");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_FAMILY]=g_objLayerKit.getElementById("id_dze_input_box_font_family");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_SIZE]=
g_objLayerKit.getElementById("id_dze_input_box_font_size");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_WEIGHT]=g_objLayerKit.getElementById("id_dze_input_box_font_weight");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_YES]=g_objLayerKit.getElementById("id_dze_input_box_readonly_yes");this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_NO]=g_objLayerKit.getElementById("id_dze_input_box_readonly_no");this.customInputBox.name=b.getAttribute("httl");this.customInputBox.tagName=
b.getAttribute("name");this.customInputBox.tagFormat;this.customInputBox.contractCode=b.getAttribute("id");this.customInputBox.textLength=1*b.getAttribute("size");this.customInputBox.fontFamily=b.style.fontFamily;this.customInputBox.fontSize=b.style.fontSize;this.customInputBox.fontWeight=b.style.fontWeight;this.customInputBox.readOnly=b.getAttribute("readonly");var d=b.getAttribute("general_input");!0===fnObjectCheckNull(this.customInputBox.name)&&(this.customInputBox.name="");!0===fnObjectCheckNull(this.customInputBox.tagName)&&
(this.customInputBox.tagName="");!0===fnObjectCheckNull(this.customInputBox.tagFormat)&&(this.customInputBox.tagFormat="");!0===fnObjectCheckNull(this.customInputBox.contractCode)&&(this.customInputBox.contractCode="");!0===isNaN(this.customInputBox.textLength)&&(this.customInputBox.textLength="");!0===fnObjectCheckNull(this.customInputBox.fontFamily)&&(this.customInputBox.fontFamily="");!0===fnObjectCheckNull(this.customInputBox.fontSize)&&(this.customInputBox.fontSize="9pt");!0===fnObjectCheckNull(this.customInputBox.fontWeight)&&
(this.customInputBox.fontWeight="normal");!0===fnObjectCheckNull(this.customInputBox.readOnly)&&(this.customInputBox.readOnly="");d=!1===fnObjectCheckNull(d)&&"y"===d.toLowerCase()?!0:!1;var c=this.getContractorIndex(this.customInputBox.contractCode),a="readonly"===this.customInputBox.readOnly;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME].value=this.customInputBox.name;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME].value=this.customInputBox.tagName;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_FORMAT].value=
this.customInputBox.tagFormat;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].selectedIndex=c;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TEXT_LENGTH].value=this.customInputBox.textLength;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_FAMILY].value=this.customInputBox.fontFamily;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_SIZE].value=this.customInputBox.fontSize;this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_WEIGHT].value=this.customInputBox.fontWeight;
!0===a?this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_YES].checked=!0:this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_NO].checked=!0;!1===d&&(this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME].setAttribute("disabled",""),this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME].setAttribute("disabled",""));""!==this.customInputBox.contractCode&&(this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].setAttribute("disabled",""),this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].style.background=
"#ebebe4")}catch(f){dalert(f)}};this.getContractorIndex=function(b){try{if(""===b)return 0;for(var d=0;d<CONTRACTOR_TYPE.length;d++)if(CONTRACTOR_TYPE[d].code===b)return d;return 0}catch(c){dalert(c)}};this.getContractorCode=function(b){try{return 0>b?"":CONTRACTOR_TYPE[b].code}catch(d){dalert(d)}};this.setCustomInputBox=function(b){try{var d=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.NAME].value,c=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TAG_NAME].value,a=1*this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.CONTRACTOR_TYPE].selectedIndex,
f=1*this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.TEXT_LENGTH].value,e=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_FAMILY].value,h=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_SIZE].value,l=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.FONT_WEIGHT].value,k=this.customInputBoxDialogElements[CUSTOM_INPUT_DIALOG.READONLY_YES].checked;d!==this.customInputBox.name&&b.setAttribute("httl",d);c!==this.customInputBox.tagName&&b.setAttribute("name",c);var m=this.getContractorCode(a);
m!==this.customInputBox.contractCode&&(b.setAttribute("id",m),b.setAttribute("comptype",m));f!==this.customInputBox.textLength&&b.setAttribute("size",f);d="";e!==this.customInputBox.fontFamily&&(b.style.fontFamily=e);h!==this.customInputBox.fontSize&&(b.style.fontSize=h);l!==this.customInputBox.fontWeight&&(b.style.fontWeight=l);if(e!==this.customInputBox.fontFamily||h!==this.customInputBox.fontSize||l!==this.customInputBox.fontWeight){d=b.getAttribute("ostyle");var g=d.split(";");b.setAttribute("ostyle",
"FONT-SIZE:"+h+";FONT-FAMILY:"+e+";FONT-WEIGHT:"+l+";"+g[g.length-2]+";")}k=!0===k?"readonly":"";k!==this.customInputBox.readOnly&&("readonly"===k?b.setAttribute("readonly",k):b.removeAttribute("readonly"))}catch(n){dalert(n)}};this.createExternalDataBoxDialog=function(){try{var b=function(a,b){return"<input type='text' name='"+b+"' value='' id='"+a+"' style='width: 105px; height: 17px; padding: 0px 5px;'/>"},d=function(a,b){return"<input type='checkbox' name='"+b+"' value='' id='"+a+"' style='margin: 0px 105px 0px 5px; z-index: 0;'/>"},
c="";c+="<div class='duzon_dialog_content_small' style='padding: 0 5px;'>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>title"+b("id_dze_external_data_title","dze_input_box_title")+"</div>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>id"+b("id_dze_external_data_id","dze_input_box_id")+"</div>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>key"+b("id_dze_external_data_key","dze_input_box_key")+"</div>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>"+
(ID_RES_DIALOG_STRING_WIDTH+DzeSpinner.getHTML({id:"id_dze_external_data_size",name:"dze_input_box_size",unit:"px",arrUnit:["px","%"],width:"118px",style:"border-color: #767676;"}))+"</div>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>"+(ID_RES_STRING_AUTO_RESIZE_WIDTH+d("id_dze_auto_resize_width","dze_input_box_auto_resize"))+"</div>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>"+(ID_RES_STRING_DATA_TWO_WAY_BINDING+d("id_dze_external_data_two_way",
"dze_input_box_two_way"))+"</div>";c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>"+(ID_RES_STRING_READONLY+d("id_dze_external_data_readonly","dze_input_box_readonly"))+"</div>";c+="<div class='duzon_dialog_label_separator'></div>";d=[];for(b=1;b<g_arrFontName.length;b++)d.push({value:g_arrFontName[b],text:g_arrFontName[b].replace(/['"]/g,"")});c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>"+(ID_RES_CONST_STRING_FONT_NAME+this.makeComboInputForm("id_dze_external_data_font_family",
d,120))+"</div>";d=[];for(b=1;b<g_objComboBoxWin.arrFontSize.length;b++)d.push({value:g_objComboBoxWin.arrFontSize[b],text:g_objComboBoxWin.arrFontSize[b]});c+="<div class='duzon_dialog_row' style='margin-top:8px; height:22px;'>"+(ID_RES_CONST_STRING_FONT_SIZE+this.makeComboInputForm("id_dze_external_data_font_size",d,120))+"</div>";return c+"</div>"}catch(a){dalert(a)}};this.inputBoxElement={title:"",id:"",key:"",size:"",font_family:"",font_size:""};this.initExternalDataBoxDialog=function(b){try{var d=
g_objLayerKit.getElementById("id_dze_external_data_title"),c=g_objLayerKit.getElementById("id_dze_external_data_id"),a=g_objLayerKit.getElementById("id_dze_external_data_key"),f=g_objLayerKit.getElementById("id_dze_external_data_size"),e=g_objLayerKit.getElementById("id_dze_auto_resize_width"),h=g_objLayerKit.getElementById("id_dze_external_data_two_way"),l=g_objLayerKit.getElementById("id_dze_external_data_readonly"),k=g_objLayerKit.getElementById("id_dze_external_data_font_family"),m=g_objLayerKit.getElementById("id_dze_external_data_font_size");
this.inputBoxElement.title=b.getAttribute("value");this.inputBoxElement.id=b.getAttribute("id");this.inputBoxElement.key=b.getAttribute("mapping_key");this.inputBoxElement.size=b.style.width||b.offsetWidth;this.inputBoxElement.auto_resize_width=b.hasAttribute("dze_auto_resize");this.inputBoxElement.two_way="true"===b.getAttribute("dze_two_way")?!0:!1;this.inputBoxElement.readonly=b.hasAttribute("readonly")?!0:!1;this.inputBoxElement.font_family=b.style.fontFamily;this.inputBoxElement.font_size=b.style.fontSize;
if(!0===fnObjectCheckNull(this.inputBoxElement.title)||0===this.inputBoxElement.title.length)this.inputBoxElement.title="";if(!0===fnObjectCheckNull(this.inputBoxElement.id)||0===this.inputBoxElement.id.length)this.inputBoxElement.id="";if(!0===fnObjectCheckNull(this.inputBoxElement.key)||0===this.inputBoxElement.key.length)this.inputBoxElement.key="";!0===fnObjectCheckNull(this.inputBoxElement.size)&&(this.inputBoxElement.size=0);!0===fnObjectCheckNull(this.inputBoxElement.font_family)&&(this.inputBoxElement.font_family=
"\uad74\ub9bc");!0===fnObjectCheckNull(this.inputBoxElement.font_size)&&(this.inputBoxElement.font_size="9pt");d.value=this.inputBoxElement.title;c.value=this.inputBoxElement.id;a.value=this.inputBoxElement.key;k.value=this.inputBoxElement.font_family;m.value=this.inputBoxElement.font_size;h.checked=this.inputBoxElement.two_way;l.checked=this.inputBoxElement.readonly;e.checked=this.inputBoxElement.auto_resize_width;var g=g_objCommonUtil.extractNumberValueUnit(this.inputBoxElement.size);DzeSpinner.createSpinner(f,
{min:0,value:g?g.nValue:"",unit:g?g.strUnit:"px",onunitchange:function(a){"%"===a?(a=this.getValue(),a=100*g_objCommonUtil.convPxToPercent(b,a),this.setValue(round10(a,-2))):"px"===a&&(a=this.getValue()/100,a=g_objCommonUtil.convPercentToPx(b,a),this.setValue(round10(a,-2)))}});d.select()}catch(n){dalert(n)}};this.setExternalDataBoxStyle=function(b){try{var d=g_objLayerKit.getElementById("id_dze_external_data_title"),c=g_objLayerKit.getElementById("id_dze_external_data_id"),a=g_objLayerKit.getElementById("id_dze_external_data_key"),
f=DzeSpinner.getSpinner("id_dze_external_data_size"),e=g_objLayerKit.getElementById("id_dze_auto_resize_width"),h=g_objLayerKit.getElementById("id_dze_external_data_two_way"),l=g_objLayerKit.getElementById("id_dze_external_data_readonly"),k=g_objLayerKit.getElementById("id_dze_external_data_font_family"),m=g_objLayerKit.getElementById("id_dze_external_data_font_size"),g=d.value,n=c.value,p=a.value,q=f.getValue()+f.getUnit(),r=e.checked,t=h.checked,u=l.checked,v=k.value,w=m.value;this.inputBoxElement.title!==
g&&(b.setAttribute("value",g),b.value=g);this.inputBoxElement.id!==n&&b.setAttribute("id",n);this.inputBoxElement.key!==p&&b.setAttribute("mapping_key",p);this.inputBoxElement.size!==q&&(b.removeAttribute("size"),b.style.width=q);this.inputBoxElement.auto_resize_width!==r&&(r?(b.setAttribute("dze_auto_resize",""),b.style.minWidth=b.style.width):(b.removeAttribute("dze_auto_resize"),b.style.minWidth=""));this.inputBoxElement.two_way!==t&&b.setAttribute("dze_two_way",t);this.inputBoxElement.readonly!==
u&&(u?b.setAttribute("readonly",""):b.removeAttribute("readonly"));this.inputBoxElement.font_family!==v&&(b.style.fontFamily=v);this.inputBoxElement.font_size!==w&&(b.style.fontSize=w)}catch(x){dalert(x)}}}).call(InputDataBinderDlg);

var StampDataBinderDlg=duzon_dialog.extend();
(function(){this.getContent=function(){var c=function(b){return'<input type="text" name="dze_input_box_'+b+'" value="" id="id_dze_external_data_'+b+'" style="width: 106px; padding: 0px 5px;">'},a=function(b,a,c){return DzeSpinner.getHTML({id:"id_dze_external_data_"+b,name:"dze_input_box_"+b,unit:a||"px",width:c||"118px",style:"border-color: #767676;"})};var b='<div class="duzon_dialog_content_small" style="padding: 0 10px 0 10px;"><div class="duzon_dialog_row" style="padding: 0 0 5px 0;">id'+c("id");
b=b+'</div><div class="duzon_dialog_row" style="padding: 0 0 5px 0;">key'+c("key");b=b+'</div><div class="duzon_dialog_label_separator"></div><div class="duzon_dialog_row" style="padding: 0 0 5px 0;">src'+c("src");b=b+'</div><div class="duzon_dialog_row" style="padding: 0 0 5px 0;">alt'+c("alt");b=b+'</div><div class="duzon_dialog_label_separator"></div><div class="duzon_dialog_row" style="padding: 0 0 5px 0;"><div class="duzon_dialog_row" style="padding: 0 0 5px 0; width: 118px;">'+ID_RES_PROP_TAG_STRING_LEFT;
b+=a("left",null,"65px");b=b+'</div><div class="duzon_dialog_row" style="padding: 0 0 5px 0; width: 118px;">'+ID_RES_PROP_TAG_STRING_TOP;b+=a("top",null,"65px");b=b+'</div></div><div class="duzon_dialog_row" style="padding: 0 0 5px 0;"><div class="duzon_dialog_row" style="padding: 0 0 5px 0; width: 118px;">'+ID_RES_DIALOG_STRING_WIDTH;b+=a("width",null,"65px");b=b+'</div><div class="duzon_dialog_row" style="padding: 0 0 5px 0; width: 118px;">'+ID_RES_DIALOG_STRING_HEIGHT;b+=a("height",null,"65px");
b=b+'</div></div><div class="duzon_dialog_label_separator"></div><div class="duzon_dialog_row" style="padding: 0 0 5px 0;">opacity'+a("opacity","%");return b+"</div></div>"};this.onLoad=function(c){if(c){var a=function(b,a,c){b=g_objLayerKit.getElementById("id_dze_external_data_"+b);b.value=a||"";c&&(b._value=c)};a("id",c.id);a("key",c.getAttribute("mapping_key"));var b=c.getAttribute("src");startsWith(b,"data:image")?a("src","",b):a("src",b);a("alt",c.getAttribute("alt"));a=function(b,a,c,d,h){a=
g_objCommonUtil.extractNumberValueUnit(a);a={value:a?a.nValue:"",unit:a?a.strUnit:"px"};fnObjectCheckNull(d)||(a.min=d);fnObjectCheckNull(h)||(a.max=h);fnObjectCheckNull(c)||(a.unit=c);DzeSpinner.createSpinner(g_objLayerKit.getElementById("id_dze_external_data_"+b),a)};a("left",g_objTextWrap.getAnchor(c).style.left,"px",-5E3,5E3);a("top",g_objTextWrap.getAnchor(c).style.top,"px",-5E3,5E3);a("width",c.style.width,null,0,5E3);a("height",c.style.height,null,0,5E3);a("opacity",parseInt(100*c.style.opacity,
10),"%",0,100)}};this.okClick=function(c){if(c){var a=function(a){a=g_objLayerKit.getElementById("id_dze_external_data_"+a);return a.value||a._value||""},b=a("left"),e=a("top"),f=a("width"),g=a("height");b&&(b+="px");e&&(e+="px");f&&(f+="px");g&&(g+="px");var d=a("opacity");d&&(d=(d/100).toFixed(2));c({id:a("id"),key:a("key"),src:a("src"),alt:a("alt"),left:b,top:e,width:f,height:g,opacity:d})}}}).call(StampDataBinderDlg);

var InputFormatDlg=duzon_dialog.extend();
(function(){this.getContent=function(){var a='<div style="display:flex;"><select name="dlg_number_format" id="dlg_number_format" size="5">'+('<option value="general" selected="selected">'+ID_RES_DIALOG_TAB_GENERAL+"</option>");a+='<option value="number">'+ID_RES_STRING_NUMBER+"</option>";a+='<option value="currency">'+ID_RES_STRING_CURRENCY+"</option>";return a+'</select><div id="dlg_number_format_detail"></div>'};this.getNumberFormatContent=function(){var a="<div class='duzon_dialog_row'>"+ID_RES_STRING_USE_DECIMAL_PLACES+
"<input type='checkbox' id='dlg_use_decimal_places' style='margin: 0px 45px 0px 5px; z-index: 0;'/></div>";var b=DzeSpinner.getHTML({id:"dlg_decimal_places"});a+="<div class='duzon_dialog_row'>"+ID_RES_STRING_DECIMAL_PLACES+b+"</div>";return a+="<div class='duzon_dialog_row'>"+ID_RES_STRING_1000_SEPARATOR+"<input type='checkbox' id='dlg_separator' style='margin: 0px 45px 0px 5px; z-index: 0;'/></div>"};this.getCurrencyFormatContent=function(){var a="<div class='duzon_dialog_row'>"+ID_RES_STRING_USE_DECIMAL_PLACES+
"<input type='checkbox' id='dlg_use_decimal_places' style='margin: 0px 45px 0px 5px; z-index: 0;'/></div>";var b=DzeSpinner.getHTML({id:"dlg_decimal_places"});a+="<div class='duzon_dialog_row'>"+ID_RES_STRING_DECIMAL_PLACES+b+"</div>";return a+="<div class='duzon_dialog_row'>"+ID_RES_STRING_SYMBOL+('<select name="dlg_symbol" id="dlg_symbol" style="width:80px; outline:none;">'+('<option value="none">'+ID_RES_DIALOG_STRING_NONE+"</option>")+'<option value="won">\u20a9</option><option value="dollar">$</option><option value="yen">\u00a5</option></select>')+
"</div>"};this.onLoad=function(a){try{var b=g_objLayerKit.getElementById("dlg_number_format"),e=g_objLayerKit.getElementById("dlg_number_format_detail"),c=this;b.onchange=function(){c.onChange(b,e,a)};b.value=a.type;this.onChange(b,e,a)}catch(d){dalert(d)}};this.onLoadNumberFormat=function(a){try{var b=g_objLayerKit.getElementById("dlg_decimal_places"),e=DzeSpinner.createSpinner(b);b.value=a&&0<=a.precision?a.precision:0;var c=g_objLayerKit.getElementById("dlg_use_decimal_places");a&&0<=a.precision?
(c.checked=!0,e.enable(!0)):(c.checked=!1,e.enable(!1));c.onchange=function(){e.enable(this.checked)};var d=g_objLayerKit.getElementById("dlg_separator");a&&a.separator&&(d.checked=!0)}catch(f){dalert(f)}};this.onLoadCurrencyFormat=function(a){try{var b=g_objLayerKit.getElementById("dlg_decimal_places"),e=DzeSpinner.createSpinner(b);b.value=a&&0<=a.precision?a.precision:0;var c=g_objLayerKit.getElementById("dlg_use_decimal_places");a&&0<=a.precision?(c.checked=!0,e.enable(!0)):(c.checked=!1,e.enable(!1));
c.onchange=function(){e.enable(this.checked)};var d=g_objLayerKit.getElementById("dlg_symbol");a&&a.symbol&&(d.value=a.symbol)}catch(f){dalert(f)}};this.onChange=function(a,b,e){for(var c=a.options,d=0;d<c.length;d++)c[d].removeAttribute("selected");(a=a.options[a.selectedIndex])&&a.setAttribute("selected","selected");d=c=null;switch(a?a.value:""){case "number":c=this.getNumberFormatContent;d=this.onLoadNumberFormat;break;case "currency":c=this.getCurrencyFormatContent,d=this.onLoadCurrencyFormat}b.innerHTML=
c?c():"";d&&d(e)};this.getFormatProp=function(){try{var a=g_objLayerKit.getElementById("dlg_number_format"),b=GetInputFormat(a.options[a.selectedIndex].value),e=g_objLayerKit.getElementById("dlg_use_decimal_places"),c=g_objLayerKit.getElementById("dlg_decimal_places");b.precision=c&&e&&e.checked?parseInt(c.value,10):-1;var d=g_objLayerKit.getElementById("dlg_separator");d&&(b.separator=d.checked?",":"");var f=g_objLayerKit.getElementById("dlg_symbol");f&&(b.symbol=f.options[f.selectedIndex].value);
return b}catch(g){dalert(g)}}}).call(InputFormatDlg);

