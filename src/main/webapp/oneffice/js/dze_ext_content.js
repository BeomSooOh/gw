var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,d){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(b.call(d,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function d(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var c=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){c(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(l){b.reject(l)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(l){this.reject_(l);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(k){c.reject(k)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(q){f(q)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=d;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,c){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())d(f.value).callWhenSettled_(b,
c)})};e.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?d([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,d(c.value).callWhenSettled_(f(g.length-1),e),c=b.next();while(!c.done)})};return e},"es6","es3");
var onefficeExtContent={nEditNumber:0,extCallUrlInfo:{},extLocationList:["bizbox_report"],extLocation:null,extNewDoc:!1,extSendOk:!1,reportType:"",autoSaveSec:60,bAutoSaveAction:!1,initialize:function(a){try{this.nEditNumber=a,this.setLocalTestMode(),!0!==this.setExtLocation()?cmnCtrlToast.showToastMsg(null,"\uc798\ubabb\ub41c \uc811\uadfc\uc785\ub2c8\ub2e4.",1.5):this.getData(a)}catch(b){dalert(b)}},setExtLocation:function(){try{this.extCallUrlInfo=parseURL(document.location.href);var a=this.extCallUrlInfo.searchObject.ref;
if("undefined"==typeof a||null==a||""==a||!inArray(a,this.extLocationList))return!1;this.extLocation=a;"Y"===this.extCallUrlInfo.searchObject.newYn&&(this.extNewDoc=!0);return!0}catch(b){return dalert(b),!1}},setLocalTestMode:function(){try{0<=document.location.href.indexOf("//localhost:80")&&(this.testMode=!0)}catch(a){dalert(a)}},setUiConfig:function(){"bizbox_report"===this.extLocation&&this.setBizboxReportUiConfig()},showContent:function(a,b){try{oneffice.parentFileContent={},oneffice.parentFileContent.content=
a,onefficeUtil.setSavedContent(a),oneffice.bNewFileStartSavedContent=a,setEditorHTMLCode(a,!1,b),dzeLayoutControl.getDocumentNoProperty(b),dzeLayoutControl.applyPaperSizeProperty(b),dzeLayoutControl.setDocPageColor(b),g_objZoom.setConfigDocZoomPropertyInfo(b),dzeLayoutControl.setDocWatermarkSrcFromDocProperty(b),dzeLayoutControl.setDocPrintMargin(b),changeCss(".editorContainer","opacity","1",document),g_objWrapperOutlineUtil_Improved.initWrapperOutlineUtil(),"bizbox_report"===this.extLocation&&onefficeGW.setCurrFileInfo(0,
0,"\uc5c5\ubb34\ubcf4\uace0","",""),initializeDocFocus(b),dzeLayoutControl.setEditAreaSize(b,!0),"bizbox_report"==this.extLocation&&(dzeUiConfig.bOfficeOnePageLongMode=!0),dzeUiConfig.bOfficePagingMode&&g_objPageControl.initializeMultiPageMode(b),fnHandler_viewRulerbar(null,null,b),g_objZoom.initDocZoomPropertyInfo(b),onefficeGW.showDocumentProperties({},b),g_objUndoRedo.registerInitialContentStack(b),window.addEventListener("beforeunload",function(a){if(!0!==g_browserCHK.isWebView())if(!0===onefficeExtContent.extNewDoc&&
!0!==onefficeExtContent.extSendOk)a.returnValue=ID_RES_CONST_STRING_CHANGES_NOT_SAVED;else{var c=getEditorHTMLCode(!1,b,!0,!0);onefficeUtil.checkSameContent(c)||(a.returnValue=ID_RES_CONST_STRING_CHANGES_NOT_SAVED)}}),window.addEventListener("unload",function(a){try{!0!==g_browserCHK.isWebView()&&(!0===onefficeExtContent.extNewDoc&&!0!==onefficeExtContent.extSendOk?onefficeExtContent.sendDeleteSig(function(){opener&&opener.document.location.reload()},function(){}):opener&&opener.document.location.reload())}catch(c){dalert(c)}}),
setInterval(function(){onefficeExtContent.bAutoSaveAction=!0;onefficeExtContent.saveContent(b,function(){})},1E3*onefficeExtContent.autoSaveSec),dzeUiConfig.bOfficePagingMode&&setTimeout(function(){g_objPageControl.onSetDelayedUpdatePageTimer()},500),setTimeout(function(){!0===onefficeExtContent.extNewDoc&&onefficeExtContent.showReportTypeDialog(b)},500)}catch(d){dalert(d)}},saveContent:function(a,b){try{var d=getEditorHTMLCode(!1,a,!0,!0,!0);"bizbox_report"==this.extLocation&&this.saveBizboxReportData(d,
function(){!0===onefficeExtContent.extNewDoc?onefficeExtContent.NotifyStatus(ID_RES_STRING_TEMP_SAVED+" ("+duzon_http.getCurrTime()+")",a):onefficeExtContent.NotifyStatus(ID_RES_STRING_MOD_SAVED+" ("+duzon_http.getCurrTime()+")",a);"function"===typeof b&&b()})}catch(c){dalert(c)}},updateContent:function(a,b){try{var d=getEditorHTMLCode(!1,a,!0,!0);"bizbox_report"==this.extLocation&&this.updateBizboxReportData(d,function(){onefficeExtContent.updateContentSaveStatus(3);!0!==g_browserCHK.mobile&&!0!==
onefficeExtContent.extNewDoc&&setTimeout(function(){window.close()},500);"function"===typeof b&&b()})}catch(c){dalert(c)}},contentSaveStatus:0,updateContentSaveStatus:function(a){onefficeExtContent.contentSaveStatus!=a&&(onefficeExtContent.contentSaveStatus=a,"bizbox_report"==this.extLocation&&!0===g_browserCHK.mobile&&(document.location.href="app://report/edit/state/"+a))},sendDeleteSig:function(a,b){try{var d=onefficeExtContent.extCallUrlInfo.searchObject.report_no;"undefined"!=typeof d&&null!=
d&&""!=d&&duzon_http.ajax({type:"post",url:onefficeExtContent.deleteBizboxReportDataUrl,async:!1,data:JSON.stringify({reportSeq:d}),dataType:"application/json",timeout:3E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(b){"function"===typeof a&&a(b)},error:function(a){"function"===typeof b&&b()}})}catch(c){dalert(c),"function"===typeof b&&b()}},addUploadForm:function(a){var b=document.createElement("input");b.type="hidden";b.name="ref";b.value=onefficeExtContent.extLocation;
"bizbox_report"==this.extLocation&&(a.doc_no.value=onefficeExtContent.extCallUrlInfo.searchObject.report_no);a.appendChild(b)},addFormData:function(a){"bizbox_report"==this.extLocation&&a.append("doc_no",onefficeExtContent.extCallUrlInfo.searchObject.report_no);a.append("ref",onefficeExtContent.extLocation)},testMode:!1,sendBizboxReportUrl:"/gw/onefficeApi/reportRegPop.do",getBizboxReportDataUrl:"/gw/onefficeApi/getReportInfo.do",updateBizboxReportDataUrl:"/gw/onefficeApi/reportUpdate.do",getBizboxReportListUrl:"/schedule/WebReport/SearchReportList",
viewBizboxReportUrl:"/schedule/Views/Common/report/reportInfoPop.do",deleteBizboxReportDataUrl:"/schedule/WebReport/DeleteReport.do",openNewReportEditPageUrl:"/schedule/Views/Common/report/reportEditPop.do",sendBizboxReportWindow:function(a){try{var b=getEditorHTMLCode(!1,a,!0,!0,!0);!0===onefficeExtContent.extNewDoc&&!0!==g_browserCHK.mobile?onefficeExtContent.saveContent(a,function(){onefficeExtContent.extSendOk=!0;document.location.href=onefficeExtContent.openNewReportEditPageUrl+"?reportSeq="+
onefficeExtContent.extCallUrlInfo.searchObject.report_no+"&kind=0&newYn=Y"}):!0===g_readonlyMode||onefficeUtil.checkSameContent(b)?onefficeCommon.openWindow(onefficeExtContent.sendBizboxReportUrl+"?ref=oneffice&seq="+oneffice.currFileSeq,"report","width=1084,height=707,resizable=yes,scrollbars=yes,status=yes"):onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,b,a,function(){onefficeUtil.setSavedContent(b);onefficeCommon.openWindow(onefficeExtContent.sendBizboxReportUrl+
"?ref=oneffice&seq="+oneffice.currFileSeq,"report","width=1084,height=707,resizable=yes,scrollbars=yes,status=yes")})}catch(d){dalert(d)}},getData:function(a){try{if(!0===onefficeExtContent.testMode){var b=parseInt(a,10)+DZE_IFRAME_TMP_NO;g_objEditorDocument[b].documentElement.innerHTML="<p>report test</p>";onefficeExtContent.showContent(g_objEditorDocument[b].body.innerHTML,a)}else oneffice.onErrorCheckSession(function(){var b=onefficeExtContent.extCallUrlInfo.searchObject.report_no,c="";"undefined"==
typeof b||null==b||""==b?c="<p><br /></p>":duzon_http.ajax({type:"get",url:onefficeExtContent.getBizboxReportDataUrl+"?report_no="+b,async:!0,dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(b){if("success"!==b.result)cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_GET_REPORT+" "+ID_RES_STRING_TRY_AGAIN_AFTER_CLOSE_WIN,5);else{var d=parseInt(a,10)+DZE_IFRAME_TMP_NO;"undefined"==typeof b.data||null==b.data?cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_GET_REPORT+
" "+ID_RES_STRING_TRY_AGAIN_AFTER_CLOSE_WIN,5):(g_objEditorDocument[d].documentElement.innerHTML=b.data.contents,c=1==g_objEditorDocument[d].body.childNodes.length&&"div"==g_objEditorDocument[d].body.firstChild.nodeName.toLowerCase()&&"oneffice_content"==g_objEditorDocument[d].body.firstChild.id?g_objEditorDocument[d].body.firstChild.innerHTML:g_objEditorDocument[d].body.innerHTML,onefficeExtContent.showContent(c,a))}},error:function(a){cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_GET_REPORT,
1.5)}})},dzeUiConfig.bAlwaysCheckSession)}catch(d){dalert(d)}},saveBizboxReportData:function(a,b){!0!==onefficeExtContent.extNewDoc&&onefficeUtil.checkSameContent(a)?(!0===g_browserCHK.mobile?b():!0!==onefficeExtContent.bAutoSaveAction&&cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOT_MODIFIED,1.5),onefficeExtContent.bAutoSaveAction=!1):this.updateBizboxReportData(a,b)},updateBizboxReportData:function(a,b){try{if(!0===onefficeExtContent.testMode)onefficeUtil.setSavedContent(a),b();else{var d=
onefficeExtContent.extCallUrlInfo.searchObject.report_no,c=getOnefficeDocumentFromContent(a);if("undefined"==typeof d||null==d||""==d)cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_SAVE_FOR_NO_REPORT,1.5);else{!0===g_browserCHK.isWebView()&&(dzeUiConfig.bTempSaveToLocalStorage=!1);if(!0===dzeUiConfig.bTempSaveToLocalStorage){var e={report_no:d,content:c,mod_date:duzon_http.getCurrTime()};onefficeUtil.saveTempDataToLocalStorage(d,e,"onefficeReport")}e=!0;!0===onefficeExtContent.bAutoSaveAction&&
(e=!1,onefficeExtContent.bAutoSaveAction=!1);var f=onefficeExtContent.reportType;1!=f&&2!=f&&(f=1);!0!==onefficeExtContent.extNewDoc&&(f="");duzon_http.ajax({type:"post",url:onefficeExtContent.updateBizboxReportDataUrl,async:!0,data:{report_no:d,type:f,oneffice_doc_data:c},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:e,success:function(c){"success"!==c.result?cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_SAVE_REPORT,1.5):(onefficeUtil.setSavedContent(a),
!0===dzeUiConfig.bTempSaveToLocalStorage&&onefficeUtil.removeTempDataFromLocalStorage(c.data.report_no,"onefficeReport"),"function"===typeof b&&b())},error:function(a){cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_SAVE_REPORT,1.5)}})}}}catch(g){dalert(g)}},viewBizboxReportListDialog:function(a,b){try{duzon_dialog.viewDialog(a,b,ID_RES_CONST_STRING_GET_BIZBOX_REPORT_LIST,function(){return duzon_dialog.getTabContents(4,[ID_RES_CONST_STRING_RECEIVED_REPORT,ID_RES_CONST_STRING_SENT_REPORT,ID_RES_CONST_STRING_REFERENCE_REPORT,
ID_RES_CONST_STRING_PUBLIC_REPORT],[onefficeExtContent.getBizboxReportListContainer(),"","",""],[85,85,85,85],g_objPropTagTableCreate.buildTagTableCreateCommon(),[function(){onefficeExtContent.displayBizboxReportList("1")},function(){onefficeExtContent.displayBizboxReportList("0")},function(){onefficeExtContent.displayBizboxReportList("2")},function(){onefficeExtContent.displayBizboxReportList("3")}])}(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){onefficeExtContent.mergeBizboxReportList()},
function(a){duzon_dialog.closeDialog()}],function(){onefficeExtContent.initBizboxReportListDlg();duzon_dialog.viewTabContents(0);duzon_dialog.initSelectedItemContainer([])},function(){},!1,"screen_center")}catch(d){dalert(d)}},getBizboxReportListContainer:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div>";a+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";a+="<tr>";a+="<td style='text-align: left; padding-bottom: 3px;'>";a+="<span style='padding-right: 10px;'>"+
ID_RES_STRING_REPORT_SEARCH_DATE+":</span>";a+="<span id='dze_idx_report_date_view'>";a+="<input type='date' style='min-width: 100px;'/>";a+="<div style='display: inline;'> ~ </div>";a+="<input type='date' style='min-width: 100px;'/>";a+="</span>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td style='text-align: left; padding-bottom: 10px;position: relative;'>";a+="<span style='padding-right: 10px;'>"+ID_RES_STRING_REPORT_SEARCH_TITLE+":</span>";a+="<input type='text' id='dze_idx_bizbox_report_search_title'>";
a+="<div class='bizbox_report_search_title_btn'>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+="<div id='dze_idx_bizbox_report_list_container' style='background-color:#ffffff;border:#d9d9d9 1px solid;width:auto;height:150px;overflow:auto;padding:5px;'>";a+="<div id='dze_idx_bizbox_report_list_container_0'></div>";a+="<div id='dze_idx_bizbox_report_list_container_1'></div>";a+="<div id='dze_idx_bizbox_report_list_container_2'></div>";a+="<div id='dze_idx_bizbox_report_list_container_3'></div>";a+=
'<div class="nodata">';a+='<img src="./image/bizcube/img_empty_search.png">';a+="<div>"+ID_RES_CONST_STRING_FILELIST_NO_SEARCH+"</div>";a+="</div>";a+="</div>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td style='color:#000000;font-size:9pt;'>";a+=ID_RES_STRING_MERGE_REPORT_WARNING;a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+=duzon_dialog.getSelectedItemContainer("dze_merge_doc_container",!0);return a+"</div>"}catch(b){dalert(b)}},initBizboxReportListDlg:function(){try{var a=
function(){var a=duzon_dialog.currTabIdx;0===a?a=1:1===a&&(a=0);return a.toString()},b=$_("dze_idx_report_date_view");if(!1===fnObjectCheckNull(b)){var d=function(a){var b=a.split("-");a=1*b[0];var c=1*b[1];b=1*b[2];return 1970>a||3E3<a||1>c||12<c||1>b||31<b?!1:!0},c=this.getDateTerm(!0),e=b.firstChild,f=b.lastChild;e.value=c.startDate;f.value=c.endDate;g_bBrowserType_FF?(e.style.width="115px",f.style.width="115px"):g_bBrowserType_IE&&(e.style.width="90px",f.style.width="90px");e.setAttribute("max",
c.endDate);f.setAttribute("min",c.startDate);e.onchange=function(){if(0!==this.value.length)if(!1===d(this.value))this.value=this.max;else{var b=(new Date(this.max)).getTime();(new Date(this.value)).getTime()>b?this.value=this.max:(onefficeExtContent.displayBizboxReportList(a()),$_("dze_idx_report_date_view").lastChild.setAttribute("min",this.value))}};f.onchange=function(){if(0!==this.value.length)if(!1===d(this.value))this.value=this.min;else{var b=(new Date(this.min)).getTime();(new Date(this.value)).getTime()<
b?this.value=this.min:(onefficeExtContent.displayBizboxReportList(a()),$_("dze_idx_report_date_view").firstChild.setAttribute("max",this.value))}}}var g=dzeJ("#dze_idx_bizbox_report_search_title");if(g&&1===g.length)g.off("keyup").on("keyup",function(b){13===b.keyCode&&onefficeExtContent.displayBizboxReportList(a())});var h=dzeJ(".bizbox_report_search_title_btn");if(h&&1===h.length)h.off("click").on("click",function(b){onefficeExtContent.displayBizboxReportList(a());g.focus()})}catch(l){dalert(l)}},
objListContainer:null,displayBizboxReportList:function(a){try{var b=dzeJ("#dze_idx_bizbox_report_list_container > [id^=dze_idx_bizbox_report_list_container_]");b.removeClass("showbox");var d=dzeJ(b[a]);d.addClass("showbox");for(this.objListContainer=d[0];!0===this.objListContainer.hasChildNodes();)this.objListContainer.removeChild(this.objListContainer.firstChild);this.getBizboxReportList(a,function(b){for(var c,d=!1,g=0;g<b.length;g++)d||(d=!0),c=onefficeExtContent.makeReportItem(b[g],a),onefficeExtContent.checkReportItem(c),
!1===fnObjectCheckNull(c)&&onefficeExtContent.objListContainer.appendChild(c);b=dzeJ("#dze_idx_bizbox_report_list_container .nodata");d?b.removeClass("showbox"):b.addClass("showbox")},function(){cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_GET_REPORT_LIST,1.5)})}catch(c){dalert(c)}},makeReportItem:function(a,b){try{var d=null,c=null,e=null,f=null;d=document.createElement("div");d.className="bizbox_report_item";"N"==a.readYn?(d.style.fontWeight="bold",d.style.color="#000000"):(d.style.fontWeight=
"normal",d.style.color="#515967");c=document.createElement("img");c.src="./image/cloud/ico_cloud_file.png";c.setAttribute("align","top");c.style.width="16px";c.style.height="16px";c.style.paddingRight="3px";c.style.pointerEvents="none";e=document.createElement("span");e.setAttribute("report_seq",a.reportSeq);e.setAttribute("report_emp_name",a.empName);var g=dzeJ("#dze_idx_bizbox_report_search_title"),h=void 0;g&&1===g.length&&(h=g.val().trim());e.innerHTML=h&&0<h.length?g_objCommonUtil.searchHLText(h,
a.title):a.title;f=document.createElement("span");f.innerHTML="&nbsp;["+ID_RES_STRING_SHOW_CONTENT+"]";f.title=ID_RES_STRING_SHOW_CONTENT_AT_NEW_WIN;f.style.cursor="pointer";f.setAttribute("report_seq",a.reportSeq);f.setAttribute("report_type",a.type);f.setAttribute("report_kind",b);d.appendChild(c);d.appendChild(e);d.appendChild(f);d.onmouseover=function(){this.classList.add("over")};d.onmouseout=function(){this.classList.remove("over")};e.onclick=function(){onefficeExtContent.onClickReportItem(g_objNodeUtil.getParentElement(this))};
c.onclick=function(){onefficeExtContent.onClickReportItem(g_objNodeUtil.getParentElement(this))};f.onclick=function(){var a=this.getAttribute("report_seq"),b=this.getAttribute("report_type"),c=this.getAttribute("report_kind");0!==a.length&&0!==b.length&&0!==c.length&&(window.open(onefficeExtContent.viewBizboxReportUrl+"?reportSeq="+a+"&type="+b+"&kind="+c,"","width=1366, height=768, scrollbars=yes, status=yes, resizable=yes"),"1"==c&&(this.parentNode.style.fontWeight="normal"))};return d}catch(l){dalert(l)}},
checkReportItem:function(a){try{var b=$_("dze_merge_doc_container");if(!0!==fnObjectCheckNull(b)){b=b.childNodes;for(var d=a.childNodes[1].getAttribute("report_seq"),c,e,f=0;f<b.length;f++)c=b[f],e=c.getAttribute("doc_no"),e===d&&a.classList.add("select")}}catch(g){dalert(g)}},onClickReportItem:function(a){try{if(!1===a.classList.contains("select"))onefficeExtContent.addSelectedItem(a);else{a.classList.remove("select");var b=$_("dze_merge_doc_container");if(!0===fnObjectCheckNull(b))return;var d=
b.childNodes,c=a.childNodes[1].getAttribute("report_seq");for(a=0;a<d.length;a++){var e=d[a];var f=e.getAttribute("doc_no");f===c&&b.removeChild(e)}}onefficeExtContent.checkSelectedEmpty()}catch(g){dalert(g)}},addSelectedItem:function(a){try{a.classList.add("select");var b=a.childNodes[1].getAttribute("report_seq"),d=a.childNodes[1].getAttribute("report_emp_name");duzon_dialog.addSelectedItem({seq:b,subject:a.childNodes[1].textContent,empName:d})}catch(c){dalert(c)}},removeSelectedItem:function(a){try{if(!0!==
fnObjectCheckNull(onefficeExtContent.objListContainer)&&!0!==fnObjectCheckNull(a))for(var b=onefficeExtContent.objListContainer.childNodes,d,c,e=0;e<b.length;e++)d=b[e],c=d.childNodes[1].getAttribute("report_seq"),c===a&&d.classList.remove("select")}catch(f){dalert(f)}},checkSelectedEmpty:function(){var a=dzeJ("#dze_merge_doc_container>li"),b=dzeJ("#dze_merge_doc_container+.nodata");a&&0<a.length?b.removeClass("showbox"):b.addClass("showbox")},getDateTerm:function(a){try{var b=$_("dze_idx_report_date_view");
if(!1===fnObjectCheckNull(b)&&!0!==a){var d=b.lastChild;var c=b.firstChild.value;var e=d.value}else{var f=new Date,g=new Date(f.getFullYear(),f.getMonth(),f.getDate()-29),h=f.getFullYear(),l=f.getMonth()+1,k=f.getDate();10>l&&(l="0"+l);10>k&&(k="0"+k);e=h+"-"+l+"-"+k;h=g.getFullYear();l=g.getMonth()+1;k=g.getDate();10>l&&(l="0"+l);10>k&&(k="0"+k);c=h+"-"+l+"-"+k}!0!==a&&(c=c.replace(/\-/g,""),e=e.replace(/\-/g,""));return{startDate:c,endDate:e}}catch(m){dalert(m)}},getBizboxReportList:function(a,
b,d){try{var c=this.getDateTerm();duzon_http.ajax({type:"post",url:ONEFFICE_GW_API_GET_BIZBOX_REPORT_LIST,async:!0,data:JSON.stringify({startDate:c.startDate,endDate:c.endDate,kind:a,readYn:"",searchTargetUserNm:"",searchTitle:"",state:"",type:""}),dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("0"!==a.resultCode)d();else if("function"===typeof b){a=a.result;var c=dzeJ("#dze_idx_bizbox_report_search_title");if(c&&1===c.length){var e=
c.val().trim();e&&0<e.length&&(a=a.filter(function(a){return-1<a.title.indexOf(e)}))}b(a)}},error:function(a){d(a)}})}catch(e){dalert(e)}},mergeBizboxReportList:function(){try{if(!0===g_readonlyMode)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT,1.5);else{for(var a=$_("dze_merge_doc_container").childNodes,b={report_no:[],report_subeject:[],report_emp_name:[]},d=0;d<a.length;d++)b.report_no.push(a[d].getAttribute("doc_no")),b.report_subeject.push(a[d].textContent),b.report_emp_name.push(a[d].getAttribute("emp_name"));
if(0==b.report_no.length)cmnCtrlToast.showToastMsg(null,ID_RES_STRING_SELECT_REPORT,1.5);else{var c=g_objLayerKit.getLayerDocument().getElementById("dze_idx_report_merge_0"),e=c&&c.checked;duzon_dialog.closeDialog();onefficeExtContent.getBizboxReportContentFromList(b,{subject:[],content:[],emp_name:[]},function(a){executeMergeBizboxReport(a,e,function(){cmnCtrlToast.showToastMsg(null,ID_RES_STRING_MERGE_END,1.5)})})}}}catch(f){}},getBizboxReportContentFromList:function(a,b,d){try{if(0==a.report_no.length)d(b);
else{var c=a.report_no.shift();duzon_http.ajax({type:"get",url:ONEFFICE_GW_API_GET_BIZBOX_REPORT_INFO+"?report_no="+c,async:!0,dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(c){"success"!==c.result?d(b):(b.content.push(c.data.contents),b.subject.push(a.report_subeject.shift()),b.emp_name.push(a.report_emp_name.shift()),onefficeExtContent.getBizboxReportContentFromList(a,b,d))},error:function(a){cmnCtrlToast.showToastMsg(null,ID_RES_STRING_FAIL_GET_REPORT,
1.5);d(b)}})}}catch(e){}},setBizboxReportUiConfig:function(){try{if(!0===dzeUiConfig.bIndependentEdit){var a=function(a,b){-14===a[0][0]&&a.splice(0,1);a.unshift([-2],[1],[-2]);for(var c=1,d=arguments.length;c<d;c++)for(var e=0;e<a.length;e++)a[e][0]===arguments[c]&&(a.splice(e,1),e<a.length&&-1===a[e][0]&&a.splice(e,1),e--);for(c=arguments.length-1;1<=c;c--)a.unshift([arguments[c],1]);a.unshift([-14])};if(!0===onefficeExtContent.extNewDoc){if(!g_browserCHK.isWebView()&&!g_browserCHK.mobile){var b=
dzeUiConfig.ribbon_menu_list_main;a(b[0],ID_COMMAND_SEND_BIZBOX_REPORT,ID_COMMAND_GET_BIZBOX_REPORT_LIST);for(var d=1;7>d;d++)a(b[d],ID_COMMAND_SEND_BIZBOX_REPORT)}}else dzeUiConfig.arrCustomMenuBar[0]=[ID_COMMAND_FILE_NEW,ID_COMMAND_FILE_LIST_OPEN,ID_COMMAND_FILE_SAVE_REMOTE,-1,ID_COMMAND_FILE_DOCFORM,ID_COMMAND_FILE_LAYOUT,-1,ID_COMMAND_UPDATE_BIZBOX_REPORT,ID_COMMAND_GET_BIZBOX_REPORT_LIST,-1,ID_COMMAND_PRINT],!0===g_browserCHK.isWebView()?dzeUiConfig.ribbon_menu_list_main[0]=[[-14],[ID_COMMAND_GET_BIZBOX_REPORT_LIST,
1],[-2],[1],[-2],[ID_COMMAND_FILE_DOCFORM,1]]:dzeUiConfig.ribbon_menu_list_main[0]=[[-14],[ID_COMMAND_UPDATE_BIZBOX_REPORT,1],[-1],[ID_COMMAND_GET_BIZBOX_REPORT_LIST,1],[-2],[1],[-2],[ID_COMMAND_FILE_DOCFORM,1],[-1],[ID_COMMAND_DOWNLOAD_PDF,1]],!0!==g_browserCHK.isWebView()&&a(dzeUiConfig.ribbon_menu_list_main[1],ID_COMMAND_UPDATE_BIZBOX_REPORT),!0!==g_browserCHK.isWebView()&&a(dzeUiConfig.ribbon_menu_list_main[2],ID_COMMAND_UPDATE_BIZBOX_REPORT),!0===g_browserCHK.isWebView()?dzeUiConfig.ribbon_menu_list_main[3]=
[[-14],[ID_COMMAND_FILE_LAYOUT,1]]:a(dzeUiConfig.ribbon_menu_list_main[3],ID_COMMAND_UPDATE_BIZBOX_REPORT),!0!==g_browserCHK.isWebView()&&a(dzeUiConfig.ribbon_menu_list_main[4],ID_COMMAND_UPDATE_BIZBOX_REPORT),!0!==g_browserCHK.isWebView()&&a(dzeUiConfig.ribbon_menu_list_main[5],ID_COMMAND_UPDATE_BIZBOX_REPORT),!0!==g_browserCHK.isWebView()&&a(dzeUiConfig.ribbon_menu_list_main[6],ID_COMMAND_UPDATE_BIZBOX_REPORT),dzeUiConfig.ribbon_menu_list_bottom=[[-15],[ID_COMMAND_PRINT2,5],[-4],[ID_COMMAND_UNDO,
5],[ID_COMMAND_REDO,5],[-4],[ID_COMMAND_FONT_NAME,5],[-4],[ID_COMMAND_FONT_SIZE,5],[-4],[ID_COMMAND_STYLE_INCREASE_FONTSIZE,5],[ID_COMMAND_STYLE_DECREASE_FONTSIZE,5],[-4],[ID_COMMAND_LINE_HEIGHT,5],[-4],[ID_COMMAND_LETTER_SPACING,5],[-4],[ID_COMMAND_BOLD,5],[ID_COMMAND_ITALIC,5],[ID_COMMAND_UNDERLINE,5],[ID_COMMAND_STRIKE,5],[ID_COMMAND_FORE_COLOR,5],[ID_COMMAND_BACK_COLOR,5],[ID_COMMAND_JUSTIFY_LEFT,5],[ID_COMMAND_JUSTIFY_CENTER,5],[ID_COMMAND_JUSTIFY_RIGHT,5],[ID_COMMAND_JUSTIFY_JUSTIFY,5]],!0!==
g_browserCHK.mobile&&(d=dzeUiConfig.ribbon_menu_list_bottom.shift(),dzeUiConfig.ribbon_menu_list_bottom.unshift([ID_COMMAND_FILE_SAVE_REMOTE,5]),dzeUiConfig.ribbon_menu_list_bottom.unshift(d));dzeUiConfig.bUsePropUserMenu=!0;dzeUiConfig.bUsePropFavorMenu=!1;dzeUiConfig.bUsePropShareMenu=!1;dzeUiConfig.bUsePropReadonlyMenu=!1;dzeUiConfig.bUsePropSecurityMenu=!1;!0===g_browserCHK.mobile&&(dzeUiConfig.status_right_btn_list=[]);updateHandlerUI.addDisableToolbarList(ID_COMMAND_ONEFFICE_CONNECT,ID_COMMAND_COMMENT_PANEL,
ID_COMMAND_INSERT_QRCODE,ID_COMMAND_DOCUMENT_HISTORY);!0===g_browserCHK.mobile&&(updateHandlerUI.addDisableToolbarList(ID_COMMAND_FILE_NEW),updateHandlerUI.addDisableToolbarList(ID_COMMAND_FILE_LIST_OPEN),updateHandlerUI.addDisableToolbarList(ID_COMMAND_FILE_SAVE_AS_REMOTE),updateHandlerUI.addDisableToolbarList(ID_COMMAND_SEND_BIZBOX_REPORT),updateHandlerUI.addDisableToolbarList(ID_COMMAND_FILE_SAVE_REMOTE),updateHandlerUI.addDisableToolbarList(ID_COMMAND_IMAGE_TO_TABLE),updateHandlerUI.addDisableToolbarList(ID_COMMAND_PAGE_SETTING),
updateHandlerUI.addDisableToolbarList(ID_COMMAND_SLIDE_SHOW),updateHandlerUI.addDisableToolbarList(ID_COMMAND_SLIDE_CURRENT_SHOW),updateHandlerUI.addDisableToolbarList(ID_COMMAND_PREVIEW),updateHandlerUI.addDisableToolbarList(ID_COMMAND_VIEW_RULERBAR),updateHandlerUI.addDisableToolbarList(ID_COMMAND_PRINT),updateHandlerUI.addDisableToolbarList(ID_COMMAND_PRINT2));!0===g_browserCHK.isWebView()&&updateHandlerUI.addDisableToolbarList(ID_COMMAND_DOWNLOAD_PDF)}}catch(c){dalert(c)}},showReportTypeDialog:function(a){try{duzon_dialog.viewDialog(null,
0,"\ubcf4\uace0\uc591\uc2dd",onefficeExtContent.getReportTypeDialog(),0,[],[],function(){cmnCtrlBg.m_objScr.className="duzon_backscreen";cmnCtrlBg.m_objScr.onclick=function(){};unselectEditorDocumentBody(a);onefficeExtContent.getReportTypeForm();!0===g_browserCHK.mobile&&!0!==g_browserCHK.iPad&&!0!==g_browserCHK.androidtablet&&(cmnDlg.m_Dlg.style.transformOrigin="center center",cmnDlg.m_Dlg.style.transform="scale(1.8)")},function(){},!0,"screen_center")}catch(b){dalert(b)}},getReportTypeDialog:function(){try{var a=
"";a+="<div class='dze_doc_form_report_type_box'>";return a+"<div id='dze_idx_report_type_form_container'></div></div>"}catch(b){return dalert(b),""}},getReportTypeForm:function(){try{var a=document.getElementById("idx_duzon_dialog_close_btn");a.parentNode.removeChild(a);dynamicScriptCall("js/const/file_docform_const.js",function(){for(var a=JSON.parse(JSON.stringify(docformTemplateCategory[0].data)),d=0;d<a.length;d++)a[d].categoryNo=0;try{var c=JSON.parse(JSON.stringify(docformTemplateCategory[1].data[0]));
c.categoryNo=1;a.push(c)}catch(l){}a.push({categoryNo:0,docNo:a.length,name:"\uc790\uc720\uc591\uc2dd",html:"",image:"blank.png",onePageMode:!0,paperMargin:[20,40,20,40],bodyStyle:["font-size: 12pt"]});var e=$_("dze_idx_report_type_form_container");e.innerHTML="";var f=null,g=null,h=null;for(d=c=0;d<a.length;d++)if(!0!==a[d].douzone||!1!==objOnefficeLoader.m_bDomainDuzon)c++,f=document.createElement("div"),f.className="duzon_dialog_docform_category_data",f.style.height="200px",f.style.boxShadow="none",
f.style.marginLeft="12px",f.style.marginRight="12px",g=document.createElement("div"),g.className="dze_doc_form_image_box",g.innerHTML="<img width='100px' height='140px' src='"+dzeEnvConfig.strPath_Image+"doc_form/"+a[d].image+"' style='margin-bottom:3px;'>",h=document.createElement("div"),h.className="dze_doc_form_subject_box",h.innerHTML=a[d].dialog_name?a[d].dialog_name:a[d].name,function(){var b=a[d].categoryNo,c=a[d].docNo-1,e=1;0===b&&2===c&&(e=2);dzeJ(g).on("click",function(a){""==onefficeExtContent.reportType&&
(a=$_("dze_idx_form_image_selection_ico"),a.parentNode.className="dze_doc_form_image_box",this.appendChild(a),this.className="dze_doc_form_image_box_selected",a.style.display="block",onefficeExtContent.reportType=e,setTimeout(function(){onefficeExtContent.inputSelectedReportForm(b,c)},500))})}(),f.appendChild(g),f.appendChild(h),e.appendChild(f);e=document.createElement("div");e.className="dze_doc_form_image_selection_ico";e.id="dze_idx_form_image_selection_ico";g.appendChild(e);6<c&&dzeJ(".dze_doc_form_report_type_box").width("572px")})}catch(b){dalert(b)}},
inputSelectedReportForm:function(a,b){try{""==onefficeExtContent.reportType?cmnCtrlToast.showToastMsg(null,"\uc591\uc2dd\uc744 \uc120\ud0dd\ud574 \uc8fc\uc138\uc694",1.5):"undefined"!=typeof docformTemplateCategory&&null!=docformTemplateCategory&&""!=docformTemplateCategory&&(duzon_dialog.closeDialog(),duzon_dialog.inputSelectDocFormData(a,b,g_nActiveEditNumber),setTimeout(function(){onefficeExtContent.bAutoSaveAction=!0;onefficeExtContent.saveContent(onefficeExtContent.nEditNumber,function(){});
var a=g_objPageControl.getPageMain(0);a.focus();g_objCaretUtil.moveCaret(a);g_objUndoRedo.registerUndoRedoStack(0,onefficeExtContent.nEditNumber);editor_onselectionchange(onefficeExtContent.nEditNumber)},500))}catch(d){dalert(d)}},extSaveAsRemoteOkClick:function(a,b){try{var d=document.getElementById("dze_idx_save_folder_seq_form").value,c=document.getElementById("dze_idx_file_save_remote_subject").value,e=getEditorHTMLCode(!1,a,!0),f=window.open();duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_CREATE_DOCUMENT,
async:!0,data:{folder_no:d,doc_name:c,content:e},dataType:"json",timeout:5E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_COPY_REPORT_FAIL",2,"screen_center")});else if(a.data.doc_no){var c="seq="+a.data.doc_no;"undefined"!==typeof oneffice_cloud_myInfoData.group_seq&&oneffice_cloud_myInfoData.group_seq&&(c+="&groupseq="+oneffice_cloud_myInfoData.group_seq+"&_t="+
getRandString());c=window.btoa(c);var e=objOnefficeLoader.m_bDomainBizwatch?onefficeUtil.isArticle(d)?"createNews":"createDoc":"createDoc";onefficeCommon.accessUserFunction(e);onefficeCommon.accessDocumentHistory(a.data.doc_no,CLOUD_CONST_HISTORY_ACTIONCODE_NEWDOC);f.location=oneffice.onefficePath+"?"+encodeURIComponent(c);duzon_dialog.closeDialog();"function"===typeof b&&b()}else oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_COPY_REPORT_FAIL",2,"screen_center")})},
error:function(a){dalert(a)}})}catch(g){dalert(g)}},NotifyStatus:function(a,b){try{var d=document.getElementById("STATUS_BAR_CENTER_DIV_"+b);d.style.display="";d.innerHTML="";var c=0,e=setInterval(function(){c++;3<c?clearInterval(e):d.innerHTML=c%2?a:""},500)}catch(f){dalert(f)}},getNewsListDlgContents:function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_big";var b=document.createElement("div"),d=document.createElement("div"),c=document.createElement("span"),e=document.createElement("div"),
f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("img");d.style.width="100px";d.style.height="26px";d.style.display="inline-block";c.textContent="\uae30\uc0ac \uac80\uc0c9";c.style.fontSize="11pt";c.style.fontWeight="bold";e.style.width="calc(100% - 102px)";e.style.height="26px";e.style.border="1px solid #dedede";e.style.display="inline-block";f.style.width="calc(100% - 29px)";f.style.display="inline-block";f.innerHTML="<input type='text' name='dze_news_keyword' value='' id='id_news_search_keyword' style='width: calc(100% - 14px); padding: 3px 5px; font-size: 11pt !important; border: none;'/>";
g.style.width="20px";g.style.height="26px";g.style.display="inline-block";g.style.borderLeft="1px solid #dedede";g.style.padding="0px 3px 0px 4px";h.src="./image/cloud/ico_cloud_search.png";h.style.position="relative";h.style.top="50%";h.style.transform="translateY(-50%)";b.appendChild(d);d.appendChild(c);b.appendChild(e);e.appendChild(f);e.appendChild(g);g.appendChild(h);a.appendChild(b);h.onclick=function(){try{var a=document.getElementById("id_news_search_keyword").value;onefficeExtContent.updateNewsList(a);
l.style.display="";n.style.display=""}catch(w){dalert(w)}};var l=document.createElement("div"),k=document.createElement("div"),m=document.createElement("div");l.id="id_news_list_window";k.className="duzon_dialog_label_separator";k.style.marginBottom="2px";l.appendChild(k);m.id="id_news_list_container";m.style.height="400px";m.style.overflowY="auto";k=k.cloneNode();k.style.height="2px";k.style.marginBottom="5px";l.appendChild(m);l.appendChild(k);a.appendChild(l);var n=document.createElement("div"),
r=document.createElement("div"),v=document.createElement("div"),p=document.createElement("div");n.id="id_news_option_window";n.style.height="25px";r.style.width="fit-content";r.style.display="inline-block";r.style.position="relative";r.style.top="50%";r.style.transform="translateY(-50%)";v.style.display="inline-block";v.innerHTML="<input type='radio' name='dze_insert_type' value='1' id='id_insert_title' checked/><label for='id_insert_title'>\uc81c\ubaa9\uc73c\ub85c \uc0bd\uc785</label>";p.style.display=
"inline-block";p.style.marginLeft="20px";p.innerHTML="<input type='radio' name='dze_insert_type' value='2' id='id_insert_link'/><label for='id_insert_link'>\ub9c1\ud06c\ub85c \uc0bd\uc785</label>";r.appendChild(v);r.appendChild(p);n.appendChild(r);var q=document.createElement("div");q.style.display="inline-block";q.style.float="right";q.style.position="relative";q.style.top="50%";q.style.transform="translateY(-50%)";for(b=1;6>b;b++){var t=dzeJ("<input>");t.addClass("news_move_page_btn").attr({type:"button",
value:b});1===b?t.addClass("edge current"):5===b&&t.addClass("edge");t.click(function(){if(!0!==this.classList.contains("current")){var a=document.getElementById("id_news_search_keyword").value;onefficeExtContent.updateNewsList(a,this.value,20)}});q.appendChild(t[0])}n.appendChild(q);a.appendChild(n);return a}catch(u){dalert(u)}},updateNewsList:function(a,b,d){try{for(var c=document.getElementById("id_news_list_container");!0===c.hasChildNodes();)c.removeChild(c.firstChild);var e=new Date,f=e.toISOString().split("T")[0],
g=e.getHours();10>g&&(g="0"+g);f=f.replaceAll("-","")+"  "+g;e="douzone oneffice "+f;e=CryptoJS.MD5(e).toString();onefficeExtContent.getNewsList(e,a,b,d,function(a){if(0===a.list.length)c.appendChild(onefficeExtContent.searchResultNone()),dzeJ(".news_move_page_btn").attr("disabled","");else{var b=a.list,d=document.createElement("ul"),e=document.createElement("li"),f=document.createElement("div"),g=document.createElement("span"),h=document.createElement("div"),p=document.createElement("div"),q=document.createElement("span"),
t=document.createElement("div"),u=document.createElement("span");f.className="news_title_container";g.className="news_subject";h.className="news_subinfo_container";p.style.width="200px";e.appendChild(f);e.appendChild(h);h.appendChild(p);h.appendChild(t);f.appendChild(g);p.appendChild(q);t.appendChild(u);for(p=0;p<b.length;p++)f=e.cloneNode(!0),g=b[p],h=g.subject,30<h.length&&(h=h.substring(0,30)+"..."),f.firstChild.firstChild.textContent=h,f.lastChild.firstChild.firstChild.textContent="\uc791\uc131\uc790: "+
g.reporters[0].name,f.lastChild.lastChild.firstChild.textContent="\ucd9c\uace0\uc77c: "+g.reg_date,f.addEventListener("click",function(){dzeJ("#id_news_list_container li").removeClass("selected");g_objPropertyUtil.addClass(this,"selected")},!1),f.setAttribute("news_url",g.url),d.appendChild(f);c.appendChild(d);onefficeExtContent.arrangePageNavigator(1*a.cur_page,1*a.rows_per_page,1*a.total)}},function(){c.appendChild(onefficeExtContent.searchResultNone());dzeJ(".news_move_page_btn").attr("disabled",
"")})}catch(h){dalert(h)}},arrangePageNavigator:function(a,b,d){try{var c=dzeJ(".news_move_page_btn"),e=dzeJ(".news_move_page_btn[value="+a+"]"),f=Math.ceil(d/b);c.removeAttr("disabled").show();if(5>f)for(b=f;5>b;b++)c.eq(b).hide();if(0!==e.length&&!1===e.hasClass("edge"))c.removeClass("current"),e.addClass("current");else{var g=3>a?[1,2,3,4,5]:a+2>=f?[f-4,f-3,f-2,f-1,f]:[a-2,a-1,a,a+1,a+2];c.removeClass("edge current");var h=g.indexOf(a);c.each(function(a,b){b.value=g[a];a===h?dzeJ(b).addClass("current"):
5<f&&(0===a||4===a)&&dzeJ(b).addClass("edge")})}}catch(l){dalert(l)}},initNewsListDlg:function(){try{this.updateNewsList();var a=document.getElementById("id_news_search_keyword");a.focus();a.onkeydown=function(a){a.keyCode===ID_KEYCODE_ENTER&&(onefficeExtContent.updateNewsList(this.value),document.getElementById("id_news_list_window").style.display="",document.getElementById("id_news_option_window").style.display="")}}catch(b){dalert(b)}},insertSelectedNews:function(){try{var a=dzeJ("#id_news_list_container li.selected");
if(0===a.length)return cmnCtrlToast.showToastMsg(null,"\uc120\ud0dd\ub41c \uae30\uc0ac\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR),!1;var b=!0===dzeJ("#id_insert_title").prop("checked")?a.find(".news_subject").text():a.attr("news_url");var d=[a.attr("news_url"),"_blank","",b];duzon_dialog.closeDialog();return g_objALinkMgr.setLinkHTML(d,g_objPageControl.nEditNumber)}catch(c){dalert(c)}},getPostNewsDlgContents:function(){try{var a=document.createElement("div");a.className=
"duzon_dialog_content_medium";var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("width","100%");b.setAttribute("style","border-collapse:collapse;");var d=b.insertRow(),c=d.insertCell();c.style.width="30%";c.style.paddingLeft="5px";c.style.fontSize="11pt";c.style.fontWeight="bold";c.textContent="\uc791\uc131\uc790";c=d.insertCell();c.style.width="70%";c.innerHTML="<input type='text' name='dze_news_writer' value='"+oneffice_cloud_myInfoData.name+
"' style='width: 100%; padding: 3px 0px; font-size: 11pt !important; border: none; background: none;' disabled/>";g_objPropTagCommon.makeEmptyLine(b,2,4,"height: 10px;");d=b.insertRow();c=d.insertCell();c.style.width="30%";c.style.paddingLeft="5px";c.style.fontSize="11pt";c.style.fontWeight="bold";c.textContent=ID_RES_PROP_TEMPLETE_STRING_SUBJECT;c=d.insertCell();c.style.width="70%";var e=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("bizwatch_title").cloneNode(!0);e.setAttribute("disabled",
"");e.removeAttribute("id");e.removeAttribute("placeholder");e.setAttribute("style","width: 100%; height: auto; padding: 3px 0px; font-size: 11pt !important; border: none; background: none;");c.appendChild(e);g_objPropTagCommon.makeEmptyLine(b,2,4,"height: 10px;");d=b.insertRow();c=d.insertCell();c.style.width="30%";c.style.paddingTop="3px";c.style.paddingLeft="5px";c.style.fontSize="11pt";c.style.fontWeight="bold";c.style.verticalAlign="top";c.textContent="\ubd80\uc81c\ubaa9";c=d.insertCell();c.style.width=
"70%";var f=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("bizwatch_subtitle").cloneNode(!0);f.setAttribute("disabled","");f.removeAttribute("placeholder");f.removeAttribute("placeholder");f.setAttribute("style","width: 100%; height: 90px; padding: 0px; font-size: 11pt; line-height: 1.2; resize: none; border: none; background: none; font-family: '[\ub354\uc874] \ubcf8\ubb38\uccb4 30'; -ms-overflow-style: -ms-autohiding-scrollbar;");c.appendChild(f);a.appendChild(b);return a}catch(g){dalert(g)}},
postNews:function(a){try{var b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("bizwatch_subtitle").value;if(!0===fnObjectCheckNull(b)||0===b.length)b="";var d=new Date,c=d.toISOString().split("T")[0],e=d.getHours();10>e&&(e="0"+e);c=c.replaceAll("-","")+"  "+e;d="douzone oneffice "+c;d=CryptoJS.MD5(d).toString();var f=getEditorHTMLCode(!1,g_objPageControl.nEditNumber,!0,!0);f=f.split("</dze_doc_property>")[1];var g=document.createElement("div");g.innerHTML=f;var h=g.querySelectorAll("img[chart_id]");
if(0<h.length)for(c=0;c<h.length;c++)dzeJ(h[c]).removeAttr("chart_id chart_data news_image_keyword news_image_watermark");var l=g.querySelectorAll("img");0<l.length&&onefficeExtContent.processForFigureCustomEle(l);f=g.innerHTML;h=null;var k=g.querySelectorAll("span.dze_video_iframe_container_span");dzeUiConfig.bSupportNewsEditor&&0<k.length&&(onefficeExtContent.processForVideoCustomEle(k),h=g.innerHTML);var m={channel:"douzone",key:d,act:!1===fnObjectCheckNull(dzeUiConfig.nBizwatchArticleId)?"U":
"C",uid:!1===fnObjectCheckNull(dzeUiConfig.nBizwatchArticleId)?dzeUiConfig.nBizwatchArticleId:"",subject:g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("bizwatch_title").value,sub_subject:b,content:dzeUiConfig.bSupportNewsEditor&&h?h:f,writer:oneffice_cloud_myInfoData.name};onefficeExtContent.postArticle(m,function(b){!1===fnObjectCheckNull(b.uid)?(cmnCtrlToast.showToastMsg(null,"\uae30\uc0ac\uac00 \uc804\uc1a1 \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center"),dzeUiConfig.nBizwatchArticleId=
b.uid,g_objEditorDocument[DZE_IFRAME_TMP_NO].querySelector("dze_doc_property").setAttribute("bizwatch_article_id",b.uid),onefficeCommon.accessUserFunction("postNews")):cmnCtrlToast.showToastMsg(null,"\uae30\uc0ac\uac00 \uc5c5\ub370\uc774\ud2b8 \ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center");f=getEditorHTMLCode(!1,g_objPageControl.nEditNumber,!0,!0);onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,f,g_objPageControl.nEditNumber,function(){onefficeUtil.setSavedContent(f);
onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate);onefficeUtil.updateArticleConfig(oneffice.currFileSeq,dzeUiConfig.nBizwatchArticleId,function(){fnObjectCheckNull(a)||updateHandlerUI.updateMenuNameForDocState(a.command_id,a)})},!0)});duzon_dialog.closeDialog()}catch(n){dalert(n)}},getCloudImageDlgContents:function(){try{var a=document.createElement("div"),b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding",
"0");b.setAttribute("width","100%");b.setAttribute("style","border-collapse:collapse;");var d=b.insertRow(),c=d.insertCell();c.style.textAlign="left";c.style.verticalAlign="top";var e=document.createElement("div");e.className="duzon_dialog_content_medium";e.style.marginRight="30px";var f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("span"),l=document.createElement("div"),k=document.createElement("div"),m=document.createElement("div"),n=document.createElement("img");
f.style.width="100%";f.style.height="28px";g.style.width="100px";g.style.height="26px";g.style.display="inline-block";g.style.lineHeight="2";h.textContent="\uc774\ubbf8\uc9c0 \uac80\uc0c9";h.style.fontSize="11pt";h.style.fontWeight="bold";l.style.width="calc(100% - 102px)";l.style.height="26px";l.style.border="1px solid #dedede";l.style.display="inline-block";k.style.width="calc(100% - 29px)";k.style.display="inline-block";k.innerHTML="<input type='text' name='dze_image_keyword' value='' id='id_image_search_keyword' style='width: calc(100% - 14px); padding: 3px 5px; font-size: 11pt !important; border: none;'/>";
m.style.width="20px";m.style.height="26px";m.style.display="inline-block";m.style.borderLeft="1px solid #dedede";m.style.padding="0px 3px 0px 4px";n.src="./image/cloud/ico_cloud_search.png";n.style.position="relative";n.style.top="50%";n.style.transform="translateY(-50%)";f.appendChild(g);g.appendChild(h);f.appendChild(l);l.appendChild(k);l.appendChild(m);m.appendChild(n);e.appendChild(f);n.onclick=function(){try{var a=document.getElementById("id_image_search_keyword").value;onefficeExtContent.updateImageList(a,
1,21)}catch(y){dalert(y)}};var r=document.createElement("div"),v=document.createElement("div"),p=document.createElement("div");p.className="duzon_dialog_label_separator";p.style.marginBottom="2px";r.appendChild(p);v.id="id_image_list_container";v.style.height="400px";v.style.overflowY="auto";p=p.cloneNode();p.style.height="2px";p.style.marginBottom="5px";r.appendChild(v);r.appendChild(p);e.appendChild(r);var q=document.createElement("div"),t=document.createElement("div");q.id="id_news_option_window";
q.style.height="25px";q.style.textAlign="center";t.style.display="inline-block";t.style.position="relative";t.style.top="50%";t.style.transform="translateY(-50%)";for(f=1;6>f;f++){var u=dzeJ("<input>");u.addClass("news_move_page_btn").attr({type:"button",value:f});1===f?u.addClass("edge current"):5===f&&u.addClass("edge");u.click(function(){if(!0!==this.classList.contains("current")){var a=document.getElementById("id_image_search_keyword").value;onefficeExtContent.updateImageList(a,this.value,21)}});
t.appendChild(u[0])}q.appendChild(t);e.appendChild(q);c.appendChild(e);c=d.insertCell();c.style.borderLeft="1px solid #dedede";c.style.textAlign="left";c.style.verticalAlign="top";var w=this.getPostImageDlgContents(!0);w.style.marginLeft="30px";c.appendChild(w);w=this.getPostImageInfoDlgContents(!0);w.style.marginLeft="30px";c.appendChild(w);a.appendChild(b);return a}catch(x){dalert(x)}},updateImageList:function(a,b,d){try{for(var c=document.getElementById("id_image_list_container");!0===c.hasChildNodes();)c.removeChild(c.firstChild);
var e=new Date,f=e.toISOString().split("T")[0],g=e.getHours();10>g&&(g="0"+g);f=f.replaceAll("-","")+"  "+g;e="douzone oneffice "+f;e=CryptoJS.MD5(e).toString();onefficeExtContent.getCloudImageList(e,a,b,d,function(a){if(0===a.list.length)c.appendChild(onefficeExtContent.searchResultNone()),dzeJ(".news_move_page_btn").attr("disabled","");else{var b=onefficeExtContent.createImageList(a.list);c.appendChild(b);onefficeExtContent.arrangePageNavigator(1*a.cur_page,1*a.rows_per_page,1*a.total)}},function(){c.appendChild(onefficeExtContent.searchResultNone());
dzeJ(".news_move_page_btn").attr("disabled","")})}catch(h){dalert(h)}},createImageList:function(a){try{var b=document.createElement("div"),d=document.createElement("div"),c=document.createElement("div");b.style.width="100%";d.className="dlg_grid_row";d.style.width="100%";d.style.height="115px";d.style.marginBottom="10px";c.className="dlg_grid_item";c.style.width="33%";c.style.height="100%";c.style.display="inline-block";var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("img"),
h=document.createElement("p"),l=document.createElement("p");c.appendChild(e);c.appendChild(f);e.appendChild(g);f.appendChild(h);f.appendChild(l);e.className="image_container";f.className="info_container";l.style.fontSize="7pt";for(e=0;e<a.length;e++){if(0===e%3){var k=d.cloneNode(!1);b.appendChild(k)}var m=c.cloneNode(!0);k.appendChild(m);var n=a[e];m.firstChild.firstChild.setAttribute("src",n.url);m.lastChild.firstChild.textContent=n.description;""!==n.width&&""!==n.height&&(m.lastChild.lastChild.textContent=
n.width+" x "+n.height);m.addEventListener("click",function(){dzeJ(".dlg_grid_item").removeClass("selected");g_objPropertyUtil.addClass(this,"selected");onefficeExtContent.disableImageOption(!1)},!1)}return b}catch(r){dalert(r)}},initCloudImageDlg:function(){try{this.updateImageList(void 0,1,21);document.getElementById("id_image_watermark").name="watermark";this.disableImageOption(!0);var a=document.getElementById("id_image_search_keyword");a.focus();a.onkeydown=function(a){a.keyCode===ID_KEYCODE_ENTER&&
onefficeExtContent.updateImageList(this.value,1,21)};ImageInsertDlg.addEventExtFileForm(ImageInsertDlg.idx_insertimage_upimage_txt,function(){ImageInsertDlg.onChangeImgSrc();onefficeExtContent.disableImageOption(!1)});document.getElementById("id_post_image_btn").onclick=function(){try{var a=document.getElementById("id_image_description");if(!0===fnObjectCheckNull(a.value)||""===a.value)cmnCtrlToast.showToastMsg(null,"\ud0a4\uc6cc\ub4dc/\uc124\uba85\uc744 \uc785\ub825\ud558\uc138\uc694.",2,"screen_center",
!0,TOAST_TYPE_OPTION_ERROR);else{var d=new Date,c=d.toISOString().split("T")[0],e=d.getHours();10>e&&(e="0"+e);c=c.replaceAll("-","")+"  "+e;d="douzone oneffice "+c;d=CryptoJS.MD5(d).toString();var f=onefficeExtContent.makeImgData(document.dze_insert_image_form,d);onefficeExtContent.uploadImage(f,function(b){!1!==b.result?(cmnCtrlToast.showToastMsg(null,"\uc11c\ubc84\uc5d0 \uc774\ubbf8\uc9c0\uac00 \ub4f1\ub85d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center"),onefficeExtContent.updateImageList(void 0,
1,21),b=document.getElementById("idx_insertimage_upimage_txt_view"),b.title="",b.firstChild.textContent="",a.value="",onefficeExtContent.disableImageOption(!0)):cmnCtrlToast.showToastMsg(null,"\uc11c\ubc84\uc5d0 \uc774\ubbf8\uc9c0 \ub4f1\ub85d\uc744 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR)})}}catch(g){dalert(g)}}}catch(b){dalert(b)}},insertSelectedImage:function(){try{var a=dzeJ(".dlg_grid_item.selected img");if(0===a.length)return cmnCtrlToast.showToastMsg(null,
"\uc120\ud0dd\ub41c \uc774\ubbf8\uc9c0\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR),!1;var b=g_objEditorDocument[g_objPageControl.nEditNumber],d=b.createDocumentFragment(),c=b.createElement("img");c.src=a.attr("src");c.style.margin="0px auto";c.style.display="block";var e=document.getElementById("news_img_caption").value,f=document.getElementById("news_img_alt").value;c.alt=f;var g=document.getElementById("news_img_main");c.setAttribute("main_image",parseInt(g.value)?
"true":"false");a=null;var h=HyperlinkDlg.getLinkUrl(document.getElementById("news_img_url"));h.length&&(a=b.createElement("a"),a.setAttribute("href",h),a.target="_blank",a.appendChild(c));if(e.length){var l=b.createElement("figure"),k=b.createElement("figcaption");k.innerHTML=e;l.appendChild(a?a:c);l.appendChild(k);d.appendChild(l)}else d.appendChild(a?a:c);fnAddHTMLContent(null,d,0,g_objPageControl.nEditNumber);g_objAdjustDoc.fitImageSizeToDoc(dzeJ(c));return!0}catch(m){dalert(m)}},getPostImageInfoDlgContents:function(a){try{var b=
document.createElement("div");b.className="duzon_dialog_content_medium";if(!0===a){var d=document.createElement("div"),c=document.createElement("div"),e=document.createElement("span"),f=document.createElement("div");d.style.width="100%";d.style.height="28px";d.style.marginBottom="12px";c.style.width="200px";c.style.height="26px";c.style.display="inline-block";c.style.lineHeight="2";e.textContent=ID_RES_STRING_NEWS_IMAGE_INFO;e.style.fontSize="11pt";e.style.fontWeight="bold";f.className="duzon_dialog_label_separator";
f.style.marginTop="20px";d.appendChild(c);c.appendChild(e);b.appendChild(f);b.appendChild(d)}var g=document.createElement("table");g.setAttribute("cellspacing","0");g.setAttribute("cellpadding","0");g.setAttribute("width","100%");g.setAttribute("style","border-collapse:collapse;");objPostImageRow=g.insertRow();objImageInfoCell=objPostImageRow.insertCell();objPostImageRow.className="addtional_image_option";objPostImageRow.style.opacity="0.3";objImageInfoCell.style.width="20%";objImageInfoCell.style.paddingLeft=
"5px";objImageInfoCell.style.fontSize="10pt";objImageInfoCell.textContent=ID_RES_STRING_CAPTION;objImageInfoCell=objPostImageRow.insertCell();objImageInfoCell.style.width="80%";objImageInfoCell.colSpan=2;objImageInfoCell.innerHTML="<input type='text' name='caption' value='' id='news_img_caption' style='width: calc(100% - 14px); padding: 4px 5px; font-size: 11pt !important;' disabled/>";g_objPropTagCommon.makeEmptyLine(g,3,4,"height: 10px;");objPostImageRow=g.insertRow();objImageInfoCell=objPostImageRow.insertCell();
objPostImageRow.className="addtional_image_option";objPostImageRow.style.opacity="0.3";objImageInfoCell.style.width="20%";objImageInfoCell.style.paddingLeft="5px";objImageInfoCell.style.fontSize="10pt";objImageInfoCell.textContent=ID_RES_STRING_REPLACE_TEXT;objImageInfoCell=objPostImageRow.insertCell();objImageInfoCell.style.width="80%";objImageInfoCell.colSpan=2;objImageInfoCell.innerHTML="<input type='text' name='replaceText' value='' id='news_img_alt' style='width: calc(100% - 14px); padding: 4px 5px; font-size: 11pt !important;' disabled/>";
g_objPropTagCommon.makeEmptyLine(g,3,4,"height: 10px;");objPostImageRow=g.insertRow();objImageInfoCell=objPostImageRow.insertCell();objPostImageRow.className="addtional_image_option";objPostImageRow.style.opacity="0.3";objImageInfoCell.style.width="20%";objImageInfoCell.style.paddingLeft="5px";objImageInfoCell.style.fontSize="10pt";objImageInfoCell.textContent=ID_RES_STRING_LINK_URL;objImageInfoCell=objPostImageRow.insertCell();objImageInfoCell.style.width="80%";objImageInfoCell.colSpan=2;objImageInfoCell.innerHTML=
"<input type='text' name='linkURL' value='' id='news_img_url' style='width: calc(100% - 14px); padding: 4px 5px; font-size: 11pt !important;' disabled/>";g_objPropTagCommon.makeEmptyLine(g,3,4,"height: 10px;");objPostImageRow=g.insertRow();objImageInfoCell=objPostImageRow.insertCell();objPostImageRow.className="addtional_image_option";objPostImageRow.style.opacity="0.3";objImageInfoCell.style.width="20%";objImageInfoCell.style.paddingLeft="5px";objImageInfoCell.style.fontSize="10pt";objImageInfoCell.textContent=
" ";objImageInfoCell=objPostImageRow.insertCell();objImageInfoCell.style.width="80%";objImageInfoCell.colSpan=2;objImageInfoCell.innerHTML="<input type='checkbox' name='mainImage' value='1' id='news_img_main' checked='checked' disabled/><label for='news_img_main' style='cursor: pointer;'>"+ID_RES_STRING_SET_MAIN_IMAGE+"</label>";objImageInfoCell.lastElementChild.style.float="right";g_objPropTagCommon.makeEmptyLine(g,3,4,"height: 10px;");b.appendChild(g);return b}catch(h){dalert(h)}},getPostImageDlgContents:function(a){try{var b=
document.createElement("div");b.className="duzon_dialog_content_medium";if(!0===a){var d=document.createElement("div"),c=document.createElement("div"),e=document.createElement("span"),f=document.createElement("div");d.style.width="100%";d.style.height="28px";c.style.width="100px";c.style.height="26px";c.style.display="inline-block";c.style.lineHeight="2";e.textContent=ID_RES_STRING_POST_IMAGE;e.style.fontSize="11pt";e.style.fontWeight="bold";f.className="duzon_dialog_label_separator";d.appendChild(c);
c.appendChild(e);b.appendChild(d);b.appendChild(f)}var g=document.createElement("form");g.name="dze_insert_image_form";g.method="post";g.enctype="multipart/form-data";g.target="dze_upload_iframe";g.action=dzeEnvConfig.strUploadImageURL;var h=document.createElement("table");h.setAttribute("cellspacing","0");h.setAttribute("cellpadding","0");h.setAttribute("width","100%");h.setAttribute("style","border-collapse:collapse;");var l=h.insertRow(),k=l.insertCell();k.style.width="20%";k.style.paddingLeft=
"5px";k.style.fontSize="10pt";k.textContent="\ud30c\uc77c\uacbd\ub85c";k=l.insertCell();k.className="main_image_option";k.style.width="80%";k.colSpan=2;k.innerHTML=ImageInsertDlg.makeExtFileForm("media_file",ImageInsertDlg.idx_insertimage_upimage_txt,"100%",[".png",".jpg",".gif",".jpeg"],!1);g_objPropTagCommon.makeEmptyLine(h,3,4,"height: 10px;");l=h.insertRow();k=l.insertCell();l.className="addtional_image_option";l.style.opacity="0.3";k.style.width="20%";k.style.paddingLeft="5px";k.style.fontSize=
"10pt";k.textContent="\ud0a4\uc6cc\ub4dc/\uc124\uba85";k=l.insertCell();k.style.width="80%";k.colSpan=2;k.innerHTML="<input type='text' name='description' value='' id='id_image_description' style='width: calc(100% - 14px); padding: 4px 5px; font-size: 11pt !important;' disabled/>";g_objPropTagCommon.makeEmptyLine(h,3,4,"height: 10px;");l=h.insertRow();k=l.insertCell();l.className="addtional_image_option";l.style.opacity="0.3";k.style.width="20%";k.style.paddingLeft="5px";k.style.fontSize="10pt";k.textContent=
"\uc6cc\ud130\ub9c8\ud06c";k=l.insertCell();k.style.width="40%";k.innerHTML=ImageInsertDlg.makeComboInputForm("id_image_watermark",[{value:1,text:"\uc124\uc815"},{value:0,text:"\ud574\uc81c"}],70);!0===a&&(k=l.insertCell(),k.style.width="40%",k.style.textAlign="right",k.innerHTML="<input type='button' value='"+ID_RES_STRING_POST_IMAGE+"' id='id_post_image_btn' style='width: 90px !important;' class='duzon_dialog_btn_upload' disabled>");g.appendChild(h);b.appendChild(g);return b}catch(m){dalert(m)}},
getImageSubInfoMenu:function(){try{var a=document.createElement("div");a.id="id_news_chart_image_info";a.className="duzon_dialog";a.style.top="0";a.style.left="0";a.style.display="block";a.appendChild(cmnDlg.createTitle("\ucc28\ud2b8 \uc774\ubbf8\uc9c0 \uc815\ubcf4",2));var b=document.createElement("div");b.style.width="530px";b.style.margin="30px 15px";var d=document.createElement("table");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");d.setAttribute("width","100%");d.setAttribute("style",
"border-collapse:collapse;");var c=d.insertRow(),e=c.insertCell();e.style.width="20%";e.style.fontSize="10pt";e.textContent="\ud0a4\uc6cc\ub4dc/\uc124\uba85";e=c.insertCell();e.style.width="80%";e.innerHTML="<input type='text' name='description' value='' id='id_image_description' style='width: calc(100% - 14px); padding: 4px 5px; font-size: 11pt !important;'/>";g_objPropTagCommon.makeEmptyLine(d,2,4,"height: 10px;");c=d.insertRow();e=c.insertCell();e.style.width="20%";e.style.fontSize="10pt";e.textContent=
"\uc6cc\ud130\ub9c8\ud06c";e=c.insertCell();e.style.width="80%";e.innerHTML=ImageInsertDlg.makeComboInputForm("id_image_watermark",[{value:1,text:"\uc124\uc815"},{value:0,text:"\ud574\uc81c"}],70);b.appendChild(d);a.appendChild(b);dzeJ(a).draggable({distance:15,handle:"div.duzon_dialog_title_container",containment:"parent",start:function(a,b){dzeJ(this).css("opacity",.5)},stop:function(a,b){dzeJ(this).css("opacity","")}}).css("position","");return a}catch(f){dalert(f)}},initPostImageDlg:function(a){try{document.getElementById("id_image_watermark").name=
"watermark";dzeJ(".main_image_option").css("opacity","0.3");dzeJ("#idx_insertimage_upimage_txt").attr("disabled","");this.disableImageOption(!1);var b=document.getElementById("idx_insertimage_upimage_txt_view"),d=document.createElement("div");d.style="overflow: hidden; white-space: nowrap; padding-top: 2px;";d.textContent=a.src;b.appendChild(d);var c=a.getAttribute("news_image_keyword");!1===fnObjectCheckNull(c)&&""!==c&&(document.getElementById("id_image_description").value=c);var e=1*a.getAttribute("news_image_watermark");
!1===isNaN(e)&&(document.getElementById("id_image_watermark").value=e);document.getElementById("id_image_description").focus()}catch(f){dalert(f)}},disableImageOption:function(a,b){try{if(fnObjectCheckNull(b)){var d=dzeJ(".addtional_image_option");!0===a?(d.css("opacity","0.3"),d.find("input").attr("disabled",""),d[1].childNodes[1].firstChild.style.pointerEvents="none"):(d.css("opacity",""),d.find("input").removeAttr("disabled"),d[1].childNodes[1].firstChild.style.pointerEvents="")}}catch(c){dalert(c)}},
updateImageOption:function(a){try{var b=document.getElementById("id_image_description");if(""===b.value)return cmnCtrlToast.showToastMsg(null,"\ud0a4\uc6cc\ub4dc/\uc124\uba85\uc744 \uc785\ub825\ud558\uc138\uc694.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR),!1;var d="none",c=a.getAttribute("news_image_keyword");b.value!==c&&(a.setAttribute("news_image_keyword",b.value),d="changed");var e=1*a.getAttribute("news_image_watermark"),f=document.getElementById("id_image_watermark");1*f.value!==e&&(a.setAttribute("news_image_watermark",
f.value),d="changed");return d}catch(g){dalert(g)}},postImage:function(){try{return new Promise(function(a,b){b=document.getElementById("id_image_description");if(!0===fnObjectCheckNull(b.value)||""===b.value)cmnCtrlToast.showToastMsg(null,"\ud0a4\uc6cc\ub4dc/\uc124\uba85\uc744 \uc785\ub825\ud558\uc138\uc694.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR),a(!1);var d=new Date;b=d.toISOString().split("T")[0];d=d.getHours();10>d&&(d="0"+d);b=b.replaceAll("-","")+"  "+d;b=CryptoJS.MD5("douzone oneffice "+
b).toString();b=onefficeExtContent.makeImgData(document.dze_insert_image_form,b);onefficeExtContent.uploadImage(b,function(b){!1!==b.result?cmnCtrlToast.showToastMsg(null,"\uc11c\ubc84\uc5d0 \uc774\ubbf8\uc9c0\uac00 \ub4f1\ub85d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center"):cmnCtrlToast.showToastMsg(null,"\uc11c\ubc84\uc5d0 \uc774\ubbf8\uc9c0 \ub4f1\ub85d\uc744 \uc2e4\ud328\ud558\uc600\uc2b5\ub2c8\ub2e4.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR);a(b)})})}catch(a){dalert(a)}},uploadImage:function(a,
b,d){try{var c=new FormData;c.append("channel","douzone");c.append("med_type","image");c.append("key",a.key);c.append("description",a.keyword);c.append("watermark",a.watermark);c.append("media_file",a.file);onefficeExtContent.postImage(c,function(c){b({result:c,img:a.img})},function(){b({result:!1})},d)}catch(e){dalert(e)}},uploadImageList:function(a){try{return new Promise(function(b,d){function c(a){try{var d=a.shift(),e=d.getAttribute("news_image_keyword");if(!0===fnObjectCheckNull(e)||""===e)g|=
1,0===a.length?b(g):setTimeout(function(){c(a)},800);var h=onefficeExtContent.makeImgData(d,f);onefficeExtContent.uploadImage(h,function(d){!1!==d.result?d.img.src=d.result.media_url:g|=2;0===a.length?b(g):setTimeout(function(){c(a)},800)},!1)}catch(n){dalert(n)}}var e=new Date;d=e.toISOString().split("T")[0];e=e.getHours();10>e&&(e="0"+e);d=d.replaceAll("-","")+"  "+e;var f="douzone oneffice "+d;f=CryptoJS.MD5(f).toString();var g=0;setTimeout(function(){c(a)},1E3)})}catch(b){dalert(b)}},makeImgData:function(a,
b){try{return b={key:b},"FORM"===a.nodeName?(b.keyword=a.description.value,b.watermark=a.watermark.value,!1===fnObjectCheckNull(a.media_file.files[0])?b.file=a.media_file.files[0]:b.file=onefficeExtContent.base64ToBlob(a.querySelector("#idx_insertimage_upimage_txt_view").textContent)):"IMG"===a.nodeName&&(b.keyword=a.getAttribute("news_image_keyword"),b.watermark=a.getAttribute("news_image_watermark"),b.file=onefficeExtContent.base64ToBlob(a.src),b.img=a),b}catch(d){dalert(d)}},base64ToBlob:function(a,
b){try{var d=a.split(";")[0].split(":")[1],c=a.split(";")[1].split(",")[1];d=d||"";b=b||512;var e=atob(c);a=[];for(c=0;c<e.length;c+=b){for(var f=e.slice(c,c+b),g=Array(f.length),h=0;h<f.length;h++)g[h]=f.charCodeAt(h);var l=new Uint8Array(g);a.push(l)}return new Blob(a,{type:d})}catch(k){dalert(k)}},searchResultNone:function(){try{var a=document.createElement("div");a.style.fontSize="11pt";a.style.fontWeight="bold";a.style.textAlign="center";a.style.position="relative";a.style.top="50%";a.style.transform=
"translateY(-50%)";a.textContent="\uac80\uc0c9 \uacb0\uacfc\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.";return a}catch(b){dalert(b)}}};
