var SUPPORT_THUMBPATH_MONTH=9,SUPPORT_THUMBPATH_DATE=10,PLATFORMTYPE={NONE:0,WIN32:1,WIN64:2,MAC:3,MAC_INTEL:4},BROWSERTYPE={IE:0,CR:1,SF:2,EG:3,OP:4,FF:5},DOC_SHARE_STATUS={NONE:0,SHARE:1,SHARED:2},SEARCH_TYPE={NONE:0,MYONEFFICE:1,SHAREOUT:2,SHAREIN:3,CUR:4},SHARE_TARGET={PERSON:0,DEPARTMENT:1,COMPANY:2,ALL:9},FILETYPE={IMG_PNG:"image/png",IMG_JPG:"image/jpg",DOC_TXT:"text/plain"},SHOTTYPE={PAGE_SHOT:0,OBJ_SHOT:1,SCREEN_SHOT:2,FIRSTPAGE_THUMB_SHOT:3},VIEWLAYOUT={SORT_THUMBNAIL:0,NAVIGATOR_THUMBNAIL:1,
OUTLINE_THUMBNAIL:2,DRIVE_THUMBNAIL:3},LINKINFO={URL:0,TARGET:1,TITLE:2,TYPE:3,TEXT:4},VIEWSORT={NAME:0,SIZE:1,MODDATE:2,SHAREDATE:3,OWNER:4,UPLOADDATE:5,TYPE:6,READDATE:7,SHAREBYDATE:8},VIEWFILTER={ALL:0,MY:1,BY:2},CHECKLISTINITMODE={NOT_INIT:0,MOVE_FILE:1,COPY_FILE:2,MOVE_FOLDER:3,RENAME:4,SHARED:5,SAHRE:6,CHG_BROWSERMODE:7,SET_FOLDERSELECT:8,CLK_PATHFOLDER:9,SEARCH:10},CMDMODE={NORMAL:0,INSERT_READY:1,INSERT:2,MOVE_ON_LAYER:3,MOVE_IN_TEXT:4,RESIZE:5,ROTATE:6,TEXTEDIT:7},SHAPE_TYPE={NONE:0,SQUARE_RIGHT_ANGLE:1,
SQUARE_ROUNDED:2,SQUARE_TRAPEZOID:3,SQUARE_PARALLELOGRAM:4,SQUARE_DIAMOND:5,SQUARE_TEXTBOX:6,TRIANGLE_ISOSCELES_TOP:7,TRIANGLE_ISOSCELES_RIGHT:8,TRIANGLE_RIGHT_ANGLE:9,CIRCLE:10,ELLIPSE:11,ARROW_RIGHT:12,ARROW_TOP:13,ARROW_LEFT_RIGHT:14,ARROW_TOP_BOTTOM:15,LINE_NORMAL:16,LINE_ARROW_UNI_DIRECTION:17,LINE_ARROW_BI_DIRECTION:18,POLYGON:19,POLYLINE:20},LINE_ARROW_TYPE={ARROW_NORMAL:0,ARROW_TRIANGLE:1,ARROW_CIRCLE:2,ARROW_SQUARE:3,ARROW_DIAMOND:4},LINE_ARROW_SIZE={SMALL:1,NORMAL:2,LARGE:3},LINE_ARROW_POSITION=
{HEAD:0,TAIL:1},SHAPE_LAYOUT_MODE={IN_TEXT:0,BEHIND_TEXT:1,FRONT_TEXT:2},SHAPES_MAGNET_ANGLE={DEGREES_0:0,DEGREES_90:90,DEGREES_180:180,DEGREES_270:270,DEGREES_360:360},SHAPES_LAYOUT_DIALOG={RADIO_ARRANGE_IN_TEXT:0,RADIO_ARRANGE_FRONT:1,RADIO_ARRANGE_BEHIND:2,RADIO_ARRANGE_LEFT:3,RADIO_ARRANGE_RIGHT:4,MARGIN_LEFT:5,MARGIN_RIGHT:6,MARGIN_TOP:7,MARGIN_BOTTOM:8,PX_HEIGHT:9,PX_WIDTH:10,ROTATION_ANGLE:11,PERCENT_HEIGHT:12,PERCENT_WIDTH:13,FIXED_RATIO:14,DIALOG_MENU_COUNTS:15},SEQ_TYPE={FOLDER:0,FILE:1},
DRIVE_FILE_VIEW={FILE_ITEM:0,THUMBNAIL_ITEM:1},MEM_CSS_PAGEBOX=".dze_printpreview_pagebox",MEM_CSS_PAGEBOXHEADER=".dze_printpreview_pagebox_header",MEM_CSS_PAGEBOXBODY=".dze_printpreview_pagebox_body",MEM_CSS_PAGEBOXFOOTER=".dze_printpreview_pagebox_footer",ONE_CLR_FILEBROWSER_ON="#D1EDF8",ONE_CLR_FILEBROWSER_OFF="",ONE_CLR_FILEBROWSER_TRASH_OFF="#f7f7f7",TRANSPARENCY_APPLY=0,TRANSPARENCY_REMOVE=9,THUMBNAIL_INTERVAL_TIME=50,THUMBNAIL_CMD_DELAY_TIME=80,THUMBNAIL_TIMER_TIME=100,THUMBNAIL_IMG_TIMEOUT=
500,ONE_DOC_BG_COLOR="#f2f2f2",DZE_FORMEDIT_NORMAL=0,DZE_FORMEDIT_MASTER=1,DZE_FORMEDIT_USER=2,ID_KEYCODE_NONE=0,ID_KEYCODE_BACKSPACE=8,ID_KEYCODE_TAB=9,ID_KEYCODE_LINEFEED=10,ID_KEYCODE_ENTER=13,ID_KEYCODE_SHIFT=16,ID_KEYCODE_CTRL=17,ID_KEYCODE_ALT=18,ID_KEYCODE_PAUSE=19,ID_KEYCODE_CAPSLOCK=20,ID_KEYCODE_ESCAPE=27,ID_KEYCODE_SPACE=32,ID_KEYCODE_PAGE_UP=33,ID_KEYCODE_PAGE_DOWN=34,ID_KEYCODE_END=35,ID_KEYCODE_HOME=36,ID_KEYCODE_ARROW_LEFT=37,ID_KEYCODE_ARROW_TOP=38,ID_KEYCODE_ARROW_RIGHT=39,ID_KEYCODE_ARROW_BOTTOM=
40,ID_KEYCODE_PRINTSCREEN=44,ID_KEYCODE_INSERT=45,ID_KEYCODE_DELETE=46,ID_KEYCODE_5=53,ID_KEYCODE_6=54,ID_KEYCODE_7=55,ID_KEYCODE_8=56,ID_KEYCODE_A=65,ID_KEYCODE_B=66,ID_KEYCODE_C=67,ID_KEYCODE_D=68,ID_KEYCODE_E=69,ID_KEYCODE_F=70,ID_KEYCODE_G=71,ID_KEYCODE_H=72,ID_KEYCODE_I=73,ID_KEYCODE_J=74,ID_KEYCODE_K=75,ID_KEYCODE_L=76,ID_KEYCODE_M=77,ID_KEYCODE_N=78,ID_KEYCODE_O=79,ID_KEYCODE_P=80,ID_KEYCODE_Q=81,ID_KEYCODE_R=82,ID_KEYCODE_S=83,ID_KEYCODE_T=84,ID_KEYCODE_U=85,ID_KEYCODE_V=86,ID_KEYCODE_W=87,
ID_KEYCODE_X=88,ID_KEYCODE_Y=89,ID_KEYCODE_Z=90,ID_KEYCODE_MAC_COMMAND=91,ID_KEYCODE_LEFT_WINDOW=91,ID_KEYCODE_RIGHT_WINDOW=92,ID_KEYCODE_MENU=93,ID_KEYCODE_PLUS=107,ID_KEYCODE_MINUS_R=109,ID_KEYCODE_F1=112,ID_KEYCODE_F2=113,ID_KEYCODE_F3=114,ID_KEYCODE_F4=115,ID_KEYCODE_F5=116,ID_KEYCODE_F6=117,ID_KEYCODE_F7=118,ID_KEYCODE_F8=119,ID_KEYCODE_F9=120,ID_KEYCODE_F10=121,ID_KEYCODE_F11=122,ID_KEYCODE_F12=123,ID_KEYCODE_NUM_LOCK=144,ID_KEYCODE_SCROLL_LOCK=145,ID_KEYCODE_MINUS_L=189,ID_KEYCODE_OPENSQUAREBRACKET=
219,ID_KEYCODE_CLOSESQUAREBRACKET=221;function isArrowKeyCode(a){switch(a){case 37:case 38:case 39:case 40:return!0}return!1}function isNavigationKeyCode(a){switch(a){case 33:case 34:case 36:case 35:case 27:case 9:return!0}return isArrowKeyCode(a)?!0:!1}function isModifierKeyCode(a){switch(a){case 17:case 16:case 18:case 91:case 92:return!0}return!1}function isLockKeyCode(a){switch(a){case 20:case 144:case 145:return!0}return!1}
function isContextualKeyCode(a){switch(a){case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 44:case 19:case 21:case 25:case 93:return!0}return!1}function isNonEditingKeyCode(a){return isNavigationKeyCode(a)||isModifierKeyCode(a)||isLockKeyCode(a)||isContextualKeyCode(a)?!0:!1}function isEditingKeyCode(a){return!isNonEditingKeyCode(a)}
function isUndoKeyEvent(a){if(!a)return!1;var c=a.keyCode,b=g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL;return b&&90===c&&a.metaKey&&!a.ctrlKey&&!a.altKey&&!a.shiftKey||!b&&a.ctrlKey&&!a.altKey&&!a.shiftKey&&90===c?!0:!1}function isRedoKeyEvent(a){if(!a)return!1;var c=a.keyCode,b=g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL;return b&&90===c&&a.metaKey&&!a.ctrlKey&&!a.altKey&&a.shiftKey||!b&&89===c&&a.ctrlKey&&!a.altKey&&!a.shiftKey?!0:!1}
var DZE_VARTYPE_NONE=0,DZE_VARTYPE_STRING=1,DZE_VARTYPE_NUMBER=2,DZE_VARTYPE_OBJECT=3,DZE_VARTYPE_FUNCTION=4,DZE_VARTYPE_BOOLEAN=5,DZE_VARTYPE_SYMBOL=6,DZE_IFRAME_TMP_NO=9999,DZE_OBJ_NONE=0,DZE_OBJ_IMG=1,DZE_OBJ_TABLE=2,DZE_OBJ_TR=3,DZE_OBJ_TD=4,DZE_OBJ_TEXT=5,DZE_OBJ_FILE=6,DZE_OBJ_MEDIA=7,DZE_OBJ_SHAPE=9,DZE_OBJ_SHAPE_TEXT=10,DZE_OBJ_OBJECT=11,DZE_OBJ_EMBEDE=12,DZE_OBJ_DIV=13,DZE_OBJ_VIDEO=14,DZE_OBJ_CHART=15,DZE_OBJ_HR=16,OUTLINE_INDICATOR={NONE:-1,LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3,
TOP:4,RIGHT:5,BOTTOM:6,LEFT:7,ROTATION:8,TOTAL_COUNTS:9},OUTLINE_BORDER={LEFT:0,TOP:1,RIGHT:2,BOTTOM:3,ROTATION:4,TOTAL_COUNTS:5},MOUSE_BTN={L:0,WHEEL:1,R:2},ATTNAME={SVG_FILL:"fill",SVG_STROKE:"stroke",SVG_STROKE_WIDTH:"stroke-width",SVG_STROKE_DASHARRAY:"stroke-dasharray"},DZE_TAG_FONT="font",DZE_TAG_TABLE="table",DZE_TAG_TBODY="tbody",DZE_TAG_IMG="img",DZE_TAG_TR="tr",DZE_TAG_TD="td",DZE_TAG_TH="th",DZE_TAG_TEXT="text",DZE_TAG_BODY="body",DZE_TAG_DIV="div",DZE_TAG_P="p",DZE_TAG_SPAN="span",DZE_TAG_OL=
"ol",DZE_TAG_UL="ul",DZE_TAG_LI="li",DZE_TAG_BR="br",DZE_TAG_H1="h1",DZE_TAG_H2="h2",DZE_TAG_H3="h3",DZE_TAG_H4="h4",DZE_TAG_H5="h5",DZE_TAG_H6="h6",DZE_TAG_VIDEO="video",DZE_TAG_SVG="svg",DZE_TAG_EMBED="embed",DZE_TAG_PATH="path",DZE_TAG_GRAPHIC="g",DZE_TAG_IFRAME="iframe",DZE_TAG_CANVAS="canvas",DZE_TAG_HTML="html",DZE_TAG_INPUT="input",DZE_TAG_TEXTAREA="textarea",DZE_TAG_SELECT="select",DZE_TAG_HR="hr",DZE_TAG_VIDEORESIZE="videoresize",DZETAG={A:"a",FIGURE:"figure",P:"p",DIV:"div",IMG:"img",FIGCAP:"figcaption"},
DZE_CUSTOM_ATT={MEMO:"comments",TODO:"todos"},DZE_CUSTOM_ATT_SECTION_TYPE="type",DZE_CUSTOM_ATT_PAGE_OVERFLOWVISIBLE="pgcontentsoverflowvisible",DZE_CUSTOM_ATT_PAPERSIZE="papersize",DZE_CUSTOM_ATT_PAGEMARGIN="printmargin",DZE_CUSTOM_ATT_PAGECOLOR="pagecolor",DZE_CUSTOM_ATT_PAGEZOOM="pagezoom",DZE_CUSTOM_ATT_DOCUMENT_NO="document_no",DZE_CUSTOM_ATT_WATERMARKSRC="watermarksrc",DZE_CUSTOM_ATT_WATERMARKTYPE="watermarkType",DZE_CUSTOM_ATT_WATERMARKDATA="watermarkData",DZE_CUSTOM_ATT_DIFF_FIRST_PAGE="dze_diff_first_page",
DZE_CUSTOM_ATT_DIFF_ODD_EVEN_PAGE="dze_diff_odd_even_page",DZE_CUSTOM_ATT_ODD_HEADER="dze_odd_header",DZE_CUSTOM_ATT_EVEN_HEADER="dze_even_header",DZE_CUSTOM_ATT_FIRST_HEADER="dze_first_header",DZE_CUSTOM_ATT_ODD_FOOTER="dze_odd_footer",DZE_CUSTOM_ATT_EVEN_FOOTER="dze_even_footer",DZE_CUSTOM_ATT_FIRST_FOOTER="dze_first_footer",DZE_CUSTOM_ATT_HF_HEIGHT="dze_hf_height",DZE_CUSTOM_ATT_ARTICLE_ID="bizwatch_article_id",DZE_CUSTOM_ATT_PGNUM="pgnum",DZE_CUSTOM_ATT_ONEPAGE_MODE="dze_onepage_mode",DZE_CUSTOM_ATT_THUMBNAIL_DOC=
"thumb_doc",DZE_CUSTOM_ATT_ONEFFICE_VERSION="oneffice_version",DZE_CUSTOM_ATT_ROWGROUP="dze_rowgroup",DZE_CUSTOM_ATT_PLACEHOLDER_SPAN="dze_placeholder_span",DZE_CUSTOM_ATT_PLACEHOLDER_TD="dze_placeholder_td",DZE_CUSTOM_ATT_FOCUS="dze_focus",DZE_CUSTOM_ATT_HASTEXT="dze_hastext",DZE_CUSTOM_ATT_PLACEHOLDER_IMG="dze_placeholder_img",DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO="dze_placeholder_video",DZE_CUSTOM_ATT_DESC="dze_desc",DZE_CUSTOM_ATT_PROTECT="dze_protect",DZE_CUSTOM_ATT_NEW_DOC_CREATE="newdoccreate",
DZE_CUSTOM_VALUE_BIZBOX_REPORT_1="bizbox_report",DZE_CUSTOM_VALUE_BIZBOX_REPORT_5="bizbox_report_5",DZE_CUSTOM_VALUE_BIZBOX_REPORT_6="bizbox_report_6",DZE_CUSTOM_VALUE_SCHEDULE="schedule",DZE_CUSTOM_VALUE_TASK="task",DZE_CUSTOM_VALUE_PREV_TASK="prev_task",DZE_CUSTOM_VALUE_REMARK="remark",DZE_CUSTOM_VALUE_USER_INFO="user_info",DZE_CUSTOM_VALUE_TASK_SCHEDULE="task_schedule",DZE_CUSTOM_VALUE_TASK_NOT_FINISH="task_not_finish",DZE_CUSTOM_VALUE_TASK_WILL_DO="task_will_do",DZE_CUSTOM_VALUE_SCHEDULE_HOME=
"schedule_home",DZE_CUSTOM_VALUE_TASK_HOME="task_home",DZE_CUSTOM_VALUE_PREV_TASK_HOME="prev_task_home",DZE_CUSTOM_VALUE_REMARK_HOME="remark_home",DZE_CUSTOM_VALUE_CHECKLIST="checklist",DZE_CUSTOM_VALUE_OPINION="opinion",DZE_CUSTOM_ATT_RM_BIZBOX_REPORT="dze_rm_bizbox_report",DZE_INSERT_SPECIALCHAR=0,DZE_INSERT_EMOTICON=1,DZE_EXTENDS_COLOR_PICKER=0,DZE_EXTENDS_EMOTICON=1,DZE_EXTENDS_COPY_EXT=3,DZE_EXTENDS_PASTE_EXT=4,DZE_EXTENDS_INSERT_PARAGRAPH=5,DZE_EXTENDS_TABLE_DELETE_EXT=6,DZE_EXTENDS_TABLE_SELECT=
7,DZE_EXTENDS_TABLE_FORMULA_EXT=8,DZE_EXTENDS_TABLE_NUMBER_FORMAT=9,DZE_EXTENDS_IMAGE_BORDER_TYPE=10,DZE_EXTENDS_IMAGE_BORDER_THICKNESS=11,DZE_EXTENDS_IMAGE_BORDER_COLOR=12,DZE_EXTENDS_TABLE_BORDER_THICKNESS=13,DZE_EXTENDS_TABLE_BORDER_TYPE=14,DZE_EXTENDS_TABLE_BORDER_COLOR=15,DZE_EXTENDS_TABLE_CELL_ALIGN=18,DZE_EXTENDS_TABLE_CREATE=20,DZE_EXTENDS_INSERT_TEXTBOX=21,DZE_EXTENDS_HIGHLIGHTER_COLOR=22,DZE_EXTENDS_SVG_LINE_STYLE=23,DZE_EXTENDS_SHAPES=24,DZE_EXTENDS_HEADER=25,DZE_EXTENDS_FOOTER=26,DZE_EXTENDS_HEADER_FOOTER_OPTIONS=
27,DZE_EXTENDS_BRING_FORWARD=28,DZE_EXTENDS_SEND_BACKWARD=29,DZE_EXTENDS_OBJ_TXT_LAYOUT=30,DZE_EXTENDS_OBJ_ALIGN=31,DZE_EXTENDS_OBJ_TXT_VALIGN=32,DZE_EXTENDS_ROTATION_LIST=33,DZE_EXTENDS_SHAPE_STYLE=34,DZE_EXTENDS_LINE_ARROW=35,DZE_EXTENDS_INSERT_NEW_PAGE=36,DZE_EXTENDS_PGNUM=37,DZE_EXTENDS_INSERT_FORM_CONTROL=38,DZE_DISPLAY_EXTENDS_NONE=0,DZE_DISPLAY_EXTENDS_COLOR_PICKER=1,DZE_DISPLAY_EXTENDS_EMOTICON=2,DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST=4,DZE_DISPLAY_EXTENDS_COMMON_POPUP=5,DZE_DISPLAY_EXTENDS_TABLE_CREATE=
6,DZE_DISPLAY_EXTENDS_SHAPES=7,DZE_DISPLAY_EXTENDS_CHECKED_COMMANDLIST=8,COMBOBOX_TYPE_BORDER_STYLE=0,COMBOBOX_TYPE_BORDER_WIDTH=1,TEXTBOX_GRAPHICATT_FILL_COLOR=1,TEXTBOX_GRAPHICATT_LINE_COLOR=2,TEXTBOX_GRAPHICATT_LINE_STYLE=3,TEXTBOX_TEXTATT_TEXT_COLOR=4,DZE_TEXTATT_FONTNAME=0,DZE_TEXTATT_FONTSIZE=1,DZE_TEXTATT_FORECOLOR=2,DZE_TEXTATT_BACKCOLOR=3,DZE_TEXTATT_LETTERSPACING=4,DZE_TEXTATT_BITFLAG=5,DZE_PARAATT_ALIGN=0,DZE_PARAATT_LINEHEIGHT=5,DZE_OBJATT_WIDTH=0,DZE_OBJATT_HEIGHT=1,DZE_OBJATT_INNER_MARGIN=
2,DZE_OBJATT_OUTER_MARGIN=3,DZE_OBJATT_ALIGN=4,DZE_OBJATT_VALIGN=5,DZE_GRAPHICATT_FILLCOLOR=0,DZE_GRAPHICATT_LINESTYLE=1,DZE_GRAPHICATT_LINECOLOR=2,DZE_GRAPHICATT_LINEWIDTH=3,PARAATT_ALIGN_LEFT=0,PARAATT_ALIGN_CENTER=1,PARAATT_ALIGN_RIGHT=2,PARAATT_ALIGN_JUSTIFY=3,PARAATT_ALIGN_JUSTIFY_ALL=4,PARAATT_ALIGN_START=5,PARAATT_ALIGN_END=6,PARAATT_ALIGN_MATCH_PARENT=7,OBJATT_VALIGN_TOP=0,OBJATT_VALIGN_MIDDLE=1,OBJATT_VALIGN_BOTTOM=2,OBJATT_ALIGN_BASIC=0,OBJATT_ALIGN_LEFT=1,OBJATT_ALIGN_CENTER=2,OBJATT_ALIGN_RIGHT=
3,KEEP_SOURCE_FORMMAT=0,KEEP_TEXT_ONLY=1,KEEP_ORG_TABLE_FORMMAT=2,PASTE_CELL_FORMMAT=3,INSERT_AS_NEW_ROWS=4,INSERT_AS_NESTED_TABLE=5,BORDER_STYLE_NORMAL={SOLID:"solid",DASH:"dashed",DOT:"dotted",DOUBLE:"double"},BORDER_STYLE_GRAPHIC={SOLID:"none",DASH:"10, 10",DOT:"5, 5",DASH_DOT_DOT:"20, 10, 5, 5, 5, 10"},GRAPATT_LINECAP={BUTT:"butt",ROUND:"round",SQUARE:"square"},GRAPATT_LINEJOIN={MITER:"miter",ROUND:"round",BEVEL:"bevel",INHERIT:"inherit"},DZE_DIR={NONE:0,LEFT:1,TOP:2,RIGHT:3,BOTTOM:4,HORIZONTAL:5,
VERTICAL:6,reverse:function(a){switch(a){case this.LEFT:return this.RIGHT;case this.TOP:return this.BOTTOM;case this.RIGHT:return this.LEFT;case this.BOTTOM:return this.TOP}},doAllDir:function(a){for(var c=[this.LEFT,this.TOP,this.RIGHT,this.BOTTOM],b=0;b<c.length;b++)a(c[b],this.getString(c[b]))},getString:function(a){switch(a){case this.LEFT:return"left";case this.TOP:return"top";case this.RIGHT:return"right";case this.BOTTOM:return"bottom"}}},GUIDE_LINE_TYPE={TYPE_NONE:0,OUTER_TOP:1,OUTER_BOTTOM:2,
OUTER_HORIZONTAL_CENTER:3,INNER_TOP:4,INNER_BOTTOM:5,INNER_HORIZONTAL_CENTER:6,OUTER_LEFT:10,OUTER_RIGHT:20,OUTER_VERTICAL_CENTER:30,INNER_LEFT:40,INNER_RIGHT:50,INNER_VERTICAL_CENTER:60},PANEL_MAIN_TYPE={NONE:0,CLOUD_FILE:1,DOC_OPEN_INFO:2,DOC_COMMENT:3,DOC_CHART:4,DOC_SHAPES:5,NEWS_SEND_INFO:6,DOC_WEBSEARCH:7,ETC:8},PANEL_TYPE={NONE:0,DOC_INFO:1,DOC_HISTORY:2,DOC_USER_INFO:3,DOC_COMMENT:4,CHART_ATTR_STYLE:5,CHART_COLOR_EXTRA:6,SHAPES_FORMAT:7,SHAPES_EXTRA:8,DOC_BACKUP_DATA:9,NEWS_SEND_INFO:10,WEBSEARCH_ENCYCLOPEDIA:11,
WEBSEARCH_IMAGE:12,WEBSEARCH_NEWS:13,ETC_MEMO:14,ETC_TODO:15},USER_WRITE_AUTH={PASS_TO:0,REQUEST_TO:1,REQUEST_FROM:2,RESPONSE_DENY:3,RESPONSE_DUPL:4,RESPOSNE_SUCCESS:5,RESPONSE_EDITOR_OUT:6},CUSTOM_ALERT=1,BreakException={},DZE_LETTER_COMMAND_BOLD=1,DZE_LETTER_COMMAND_ITALIC=2,DZE_LETTER_COMMAND_UNDERLINE=4,DZE_LETTER_COMMAND_STRIKE=8,DZE_LETTER_COMMAND_SUPERSCRIPT=16,DZE_LETTER_COMMAND_SUBSCRIPT=32,DZE_LETTER_COMMAND_FONT_FAMILY=64,DZE_LETTER_COMMAND_FONT_SIZE=128,DZE_LETTER_COMMAND_FONT_COLOR=256,
DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR=512,DZE_LETTER_COMMAND_LETTER_SPACE=1024,DZE_LETTER_COMMAND_REMOVE_FORMAT=2048,DZE_LETTER_COMMAND_SUBTITLE1=4096,DZE_LETTER_COMMAND_SUBTITLE2=8192,DZE_LETTER_COMMAND_LINE_HEIGHT=1,DZE_ACCESS_MANAGER_SEARCH_CONNECTOR=2E4,DZE_ACCESS_MANAGER_SEARCH_REQUEST_USER=12E3,DZE_ACCESS_MANAGER_SEARCH_RESPONSE_ANSWER_TIME=6E3,DZE_ACCESS_MANAGER_AUTO_REJECT_TIME=3E4,ACCESS_MANAGER_RESOPONSE_VALUE={INIT:0,SUECESS:1,REJECT:9},DZE_ZINDEX_TABLE_MINI_MENU=20007;
var ID_COMMAND_TOOLBAR_HANDLE=1111,ID_COMMAND_TOOLBAR_SEPARATOR=1112,ID_COMMAND_TOOLBAR_SPACE=1113,ID_COMMAND_MENU_SEPARATOR=1114,ID_COMMAND_TOOLBAR_CAPTION=1115,ID_COMMAND_BOLD=0,ID_COMMAND_ITALIC=1,ID_COMMAND_UNDERLINE=2,ID_COMMAND_JUSTIFY_LEFT=3,ID_COMMAND_JUSTIFY_CENTER=4,ID_COMMAND_JUSTIFY_RIGHT=5,ID_COMMAND_INSERT_ORDERED_LIST=6,ID_COMMAND_INSERT_UNORDERED_LIST=7,ID_COMMAND_STRIKE=8,ID_COMMAND_SUBSCRIPT=9,ID_COMMAND_SUPERSCRIPT=10,ID_COMMAND_OUTDENT=11,ID_COMMAND_INDENT=12,ID_COMMAND_UNDO=13,
ID_COMMAND_REDO=14,ID_COMMAND_CUT=15,ID_COMMAND_COPY=16,ID_COMMAND_PASTE=17,ID_COMMAND_DELETE=18,ID_COMMAND_SELECT_ALL=19,ID_COMMAND_FONT_NAME=20,ID_COMMAND_FONT_SIZE=21,ID_COMMAND_FORE_COLOR=22,ID_COMMAND_BACK_COLOR=23,ID_COMMAND_TABLE_CREATE=24,ID_COMMAND_TABLE_ADD_ROW=25,ID_COMMAND_TABLE_DELETE_ROW=26,ID_COMMAND_TABLE_ADD_COL=27,ID_COMMAND_TABLE_DELETE_COL=28,ID_COMMAND_TABLE_MERGE_CELL=29,ID_COMMAND_TABLE_SPLIT_ROW=30,ID_COMMAND_TABLE_SPLIT_COL=31,ID_COMMAND_HYPERLINK_INSERT=32,ID_COMMAND_HYPERLINK_REMOVE=
33,ID_COMMAND_IMAGE_INSERT=34,ID_COMMAND_FLASH_INSERT=35,ID_COMMAND_MEDIA_INSERT=36,ID_COMMAND_HELP=38,ID_COMMAND_HELP_INFO=39,ID_COMMAND_TABLE_CELL_PROPERTY=40,ID_COMMAND_TABLE_PROPERTY=41,ID_COMMAND_MARK_INSERT=42,ID_COMMAND_TABLE_TEMPLETE_INSERT=43,ID_COMMAND_ADJUST_HWP_BASIC=44,ID_COMMAND_ADJUST_DOC_BASIC=45,ID_COMMAND_HORIZONTAL_RULE=46,ID_COMMAND_LETTER_SPACING=47,ID_COMMAND_LINE_HEIGHT=48,ID_COMMAND_BODY_BG_COLOR=49,ID_COMMAND_BODY_BG_IMAGE=50,ID_COMMAND_DOC_TEMPLETE=51,ID_COMMAND_PREVIEW=
52,ID_COMMAND_HIDE_MINIBAR=53,ID_COMMAND_SHOW_EDITABLE_AREA=55,ID_COMMAND_EXT_FUNCTION=56,ID_COMMAND_CUSTOMER_TOOL_BUTTON_1=57,ID_COMMAND_CUSTOMER_TOOL_BUTTON_2=58,ID_COMMAND_CUSTOMER_TOOL_BUTTON_3=59,ID_COMMAND_SAVEAS=60,ID_COMMAND_PRINT=61,ID_COMMAND_CODE_INSPECT=62,ID_COMMAND_Z_INDEX_SETTING=63,ID_COMMAND_TEXT_BOX=64,ID_COMMAND_OBJECT_POSITION=65,ID_COMMAND_TABLE_ADD_ROW_DOWN=66,ID_COMMAND_TABLE_ADD_COL_RIGHT=67,ID_COMMAND_TABLE_COPY_ROW_DOWN=68,ID_COMMAND_JUSTIFY_JUSTIFY=69,ID_COMMAND_RESPONSIVE_WIDTH=
70,ID_COMMAND_DOC_LAYOUT=71,ID_COMMAND_HEADING_SIZE=72,ID_COMMAND_RESPONSIVE_SET=73,ID_COMMAND_FILE_NEW=75,ID_COMMAND_FILE_OPEN=76,ID_COMMAND_FILE_DOCFORM=77,ID_COMMAND_FILE_LAYOUT=78,ID_COMMAND_EDIT_PASTESPECIAL=79,ID_COMMAND_EDIT_SEARCH=80,ID_COMMAND_EDIT_REPLACE=81,ID_COMMAND_VIEW_EDIT=82,ID_COMMAND_VIEW_HTML=83,ID_COMMAND_INSERT_IMAGE=84,ID_COMMAND_INSERT_OBJECT=85,ID_COMMAND_INSERT_SPECIALCHARS=86,ID_COMMAND_INSERT_BOOKMARK=87,ID_COMMAND_STYLE_FONT=88,ID_COMMAND_STYLE_PARAGRAPH=89,ID_COMMAND_STYLE_STYLE=
90,ID_COMMAND_STYLE_UNORDEREDLIST=91,ID_COMMAND_STYLE_ORDEREDLIST=92,ID_COMMAND_STYLE_INCREASEORDER=93,ID_COMMAND_STYLE_DECREASEORDER=94,ID_COMMAND_TABLE_CELL_STYLE=95,ID_COMMAND_TABLE_ADD_ROW_COL=96,ID_COMMAND_TABLE_DELETE_ROW_COL=97,ID_COMMAND_TABLE_SPLIT_CELL=98,ID_COMMAND_TABLE_CELL_SAME_HEIGHT=99,ID_COMMAND_TABLE_CELL_SAME_WIDTH=100,ID_COMMAND_TABLE_CELL_ALIGN=101,ID_COMMAND_TABLE_MADANG=102,ID_COMMAND_TABLE_FORMULA=103,ID_COMMAND_TABLE_NUMBER_FORMAT=104,ID_COMMAND_TABLE_SELECT=105,ID_COMMAND_TABLE_CELL_HORIZONTALALIGN=
106,ID_COMMAND_TABLE_CELL_VERTICALALIGN=107,ID_COMMAND_TABLE_BLOCK_FORMULA=108,ID_COMMAND_TABLE_EASY_FORMULA=109,ID_COMMAND_TABLE_SELECT_FORMULA=110,ID_COMMAND_HELP_SHORTCUTS=111,ID_COMMAND_INSERT_OBJECT_MOVIE=112,ID_COMMAND_INSERT_OBJECT_FILE=113,ID_COMMAND_INSERT_OBJECT_HR=114,ID_COMMAND_TABLE_CELL_HORIZONTAL_LEFT=115,ID_COMMAND_TABLE_CELL_HORIZONTAL_CENTER=116,ID_COMMAND_TABLE_CELL_HORIZONTAL_RIGHT=117,ID_COMMAND_TABLE_CELL_VERTICAL_TOP=118,ID_COMMAND_TABLE_CELL_VERTICAL_MIDDLE=119,ID_COMMAND_TABLE_CELL_VERTICAL_BOTTOM=
120,ID_COMMAND_STYLE_STYLE_BASIC=121,ID_COMMAND_STYLE_STYLE_SUBJECT1=122,ID_COMMAND_STYLE_STYLE_SUBJECT2=123,ID_COMMAND_STYLE_STYLE_SUBJECT3=124,ID_COMMAND_STYLE_STYLE_SUBJECT4=125,ID_COMMAND_STYLE_STYLE_SUBJECT5=126,ID_COMMAND_STYLE_INCREASE_FONTSIZE=127,ID_COMMAND_STYLE_DECREASE_FONTSIZE=128,ID_COMMAND_TABLE_BLOCK_SUM=129,ID_COMMAND_TABLE_BLOCK_AVG=130,ID_COMMAND_TABLE_BLOCK_MUL=131,ID_COMMAND_TABLE_HORIZONTAL_SUM=132,ID_COMMAND_TABLE_VERTICAL_SUM=133,ID_COMMAND_TABLE_HORIZONTAL_AVERAGE=134,ID_COMMAND_TABLE_VERTICAL_AVERAGE=
135,ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY=136,ID_COMMAND_TABLE_VERTICAL_MULTIPLY=137,ID_COMMAND_TABLE_TABLE_ADD_NUMBER_FORMAT=138,ID_COMMAND_TABLE_TABLE_REMOTE_NUMBER_FORMAT=139,ID_COMMAND_FORM_TAG_SWITCH=140,ID_COMMAND_FORM_TAG_CHECKBOX=141,ID_COMMAND_FORM_TAG_SELECT=142,ID_COMMAND_MAPPING_CODE=143,ID_COMMAND_MAPPING_CSS=144,ID_COMMAND_TEMPLETE_FORM=145,ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT=146,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT=147,ID_COMMAND_TABLE_DELETE_TABLE=148,ID_COMMAND_INSERT_PARAGRAPH=
149,ID_COMMAND_TABLE_CONVERT_TEXT=150,ID_COMMAND_IMAGE_PROPERTY=151,ID_COMMAND_FILE_PROPERTY=152,ID_COMMAND_EDIT_REPLACE_CASE=153,ID_COMMAND_TABLE_CELL_BACKCOLOR=154,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP=155,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP=156,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP=157,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE=158,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE=159,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE=160,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM=161,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM=
162,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM=163,ID_COMMAND_INSERT_EMOTICONS=165,ID_COMMAND_EDIT_PRIINT_PAGE_BREAK=166,ID_COMMAND_VIEW_RULERBAR=167,ID_COMMAND_STYLE_CASCADE_ORDERLIST=168,ID_COMMAND_COPY_EXT=169,ID_COMMAND_COPY_EXT_STYLE=170,ID_COMMAND_SELECT_PARAGRAPH=171,ID_COMMAND_PASTE_EXT=172,ID_COMMAND_TABLE_DELETE_EXT=173,ID_COMMAND_TABLE_FORMULA_EXT=174,ID_COMMAND_IMAGE_BORDER_TYPE=175,ID_COMMAND_IMAGE_BORDER_THICKNESS=176,ID_COMMAND_IMAGE_BORDER_COLOR=177,ID_COMMAND_IMAGE_RESET_PICTURE=178,
ID_COMMAND_IMAGE_BORDER_NONE=179,ID_COMMAND_IMAGE_BORDER_SOLID=180,ID_COMMAND_IMAGE_BORDER_DASHED=181,ID_COMMAND_IMAGE_BORDER_DOTTED=182,ID_COMMAND_IMAGE_BORDER_DOUBLE=183,ID_COMMAND_IMAGE_BORDER_1PX=184,ID_COMMAND_IMAGE_BORDER_2PX=185,ID_COMMAND_IMAGE_BORDER_3PX=186,ID_COMMAND_IMAGE_BORDER_4PX=187,ID_COMMAND_IMAGE_BORDER_5PX=188,ID_COMMAND_IMAGE_BORDER_6PX=189,ID_COMMAND_IMAGE_BORDER_7PX=190,ID_COMMAND_IMAGE_BORDER_8PX=191,ID_COMMAND_IMAGE_BORDER_9PX=192,ID_COMMAND_IMAGE_BORDER_10PX=193,ID_COMMAND_TABLE_SELECT_CELL=
194,ID_COMMAND_TABLE_SELECT_COL=195,ID_COMMAND_TABLE_SELECT_ROW=196,ID_COMMAND_TABLE_SELECT_TABLE=197,ID_COMMAND_IMAGE_TO_TABLE=198,ID_COMMAND_TABLE_BORDER_THICKNESS=199,ID_COMMAND_TABLE_BORDER_TYPE=200,ID_COMMAND_TABLE_BORDER_COLOR=201,ID_COMMAND_TABLE_STYLE=202,ID_COMMAND_IMAGE_HEIGHT=203,ID_COMMAND_IMAGE_WIDTH=204,ID_COMMAND_INSERT_TEXTBOX=205,ID_COMMAND_WEB_SEARCH=206,ID_COMMAND_CONV_KOREAN=207,ID_COMMAND_HIGHLIGHTER=208,ID_COMMAND_FILE_OPEN_FORM=209,ID_COMMAND_TABLE_CELL_PASTE=210,ID_COMMAND_VIDEO_PROPERTY=
211,ID_COMMAND_FILE_LIST_OPEN=212,ID_COMMAND_FILE_SAVE_REMOTE=213,ID_COMMAND_FILE_SAVE_AS_REMOTE=214,ID_COMMAND_TEXTBOX_FILL_COLOR=215,ID_COMMAND_TEXTBOX_LINE_COLOR=216,ID_COMMAND_INSERT_CHART=217,ID_COMMAND_PAGE_SETTING=218,ID_COMMAND_PASTE_CELL=219,ID_COMMAND_PASTE_CELL_INSERT=220,ID_COMMAND_PASTE_CELL_OVER_ALL=221,ID_COMMAND_PASTE_CELL_OVER_CONTENT=222,ID_COMMAND_CONVERT_ELE_TO_IMG=223,ID_COMMAND_TABLE_CELL_INSERT=224,ID_COMMAND_TABLE_CELL_DELETE=225,ID_COMMAND_VIDEO_BORDER_TYPE=226,ID_COMMAND_VIDEO_BORDER_THICKNESS=
227,ID_COMMAND_VIDEO_BORDER_COLOR=228,ID_COMMAND_VIDEO_HEIGHT=229,ID_COMMAND_VIDEO_WIDTH=230,ID_COMMAND_VIDEO_RESET_PROPERTY=231,ID_COMMAND_SLIDE_SHOW=232,ID_COMMAND_DOCUMENT_SECURITY_SETTING=233,ID_COMMAND_IMAGE_REPLACE=234,ID_COMMAND_IMAGE_SAVEAS=235,ID_COMMAND_ONEFFICE_CONNECT=236,ID_COMMAND_DOWNLOAD_PDF=237,ID_COMMAND_GET_REMOTE_SITE_CONTENT=238,ID_COMMAND_DOC_SECURE_GRADE=239,ID_COMMAND_SHARE_FAX=240,ID_COMMAND_LOCK_EDIT_CELL=241,ID_COMMAND_PROTECT_PRIVACY=242,ID_COMMAND_DOCUMENT_HISTORY=243,
ID_COMMAND_DISABLE_PRIVACY=244,ID_COMMAND_HEADER=245,ID_COMMAND_FOOTER=246,ID_COMMAND_EDIT_HEADER=247,ID_COMMAND_EDIT_FOOTER=248,ID_COMMAND_EDIT_BODY=249,ID_COMMAND_REMOVE_HEADER=250,ID_COMMAND_REMOVE_FOOTER=251,ID_COMMAND_JUMP_TO_PREVIOUS_HEADER_FOOTER=252,ID_COMMAND_JUMP_TO_NEXT_HEADER_FOOTER=253,ID_COMMAND_HEADER_FOOTER_OPTIONS=254,ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_FIRST_PAGE=255,ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_ODD_EVEN_PAGES=256,ID_COMMAND_HEADER_FOOTER_OPTION_SHOW_DOCUMENT_TEXT=257,ID_COMMAND_HEADER_MARGIN_FROM_TOP=
258,ID_COMMAND_FOOTER_MARGIN_FROM_BOTTOM=259,ID_COMMAND_DELETE_IMAGE=260,ID_COMMAND_DELETE_VIDEO=261,ID_COMMAND_HELP_ONLINE=262,ID_COMMAND_FILE_SAVE_REMOTE2=263,ID_COMMAND_PRINT2=264,ID_COMMAND_GO_TO_HEADER=265,ID_COMMAND_GO_TO_FOOTER=266,ID_COMMAND_SEND_BIZBOX_REPORT=267,ID_COMMAND_UPDATE_BIZBOX_REPORT=268,ID_COMMAND_SHAPES_INSERT=269,ID_COMMAND_SHAPES_FORMAT=270,ID_COMMAND_SHAPES_CHANGE=271,ID_COMMAND_SHAPES_STYLE=272,ID_COMMAND_SHAPES_FILL=273,ID_COMMAND_SHAPES_BORDER=274,ID_COMMAND_SHAPES_TEXT_VERTICAL_ALIGN=
275,ID_COMMAND_SHAPES_LAYOUT=276,ID_COMMAND_SHAPES_MOVE_FRONT=277,ID_COMMAND_SHAPES_MOVE_BACK=278,ID_COMMAND_SHAPES_ALIGN=279,ID_COMMAND_SHAPES_ROTATE=280,ID_COMMAND_BRING_FORWARD=281,ID_COMMAND_BRING_TO_FRONT=282,ID_COMMAND_SEND_BACKWARD=283,ID_COMMAND_SEND_TO_BACK=284,ID_COMMAND_OBJ_TXT_VALIGN_TOP=285,ID_COMMAND_OBJ_TXT_VALIGN_MIDDLE=286,ID_COMMAND_OBJ_TXT_VALIGN_BOTTOM=287,ID_COMMAND_OBJ_ALIGN_LEFT=288,ID_COMMAND_OBJ_ALIGN_CENTER=289,ID_COMMAND_OBJ_ALIGN_RIGHT=290,ID_COMMAND_OBJ_ALIGN_TOP=291,
ID_COMMAND_OBJ_ALIGN_MIDDLE=292,ID_COMMAND_OBJ_ALIGN_BOTTOM=293,ID_COMMAND_ROTATE_RIGHT_90=294,ID_COMMAND_ROTATE_LEFT_90=295,ID_COMMAND_ROTATE_FLIP_VERTICAL=296,ID_COMMAND_ROTATE_FLIP_HORIZONTAL=297,ID_COMMAND_ROTATE_OTHERS=298,ID_COMMAND_TXTLAYOUT_IN_LINE_WITH_TEXT=299,ID_COMMAND_TXTLAYOUT_SQUARE=300,ID_COMMAND_TXTLAYOUT_TIGHT=301,ID_COMMAND_TXTLAYOUT_THROUGH=302,ID_COMMAND_TXTLAYOUT_TOP_AND_BOTTOM=303,ID_COMMAND_TXTLAYOUT_BEHIND_TEXT=304,ID_COMMAND_TXTLAYOUT_IN_FRONT_OF_TEXT=305,ID_COMMAND_TXTLAYOUT_LEFT_TEXT=
306,ID_COMMAND_TXTLAYOUT_RIGHT_TEXT=307,ID_COMMAND_TXTLAYOUT_OTHERS=308,ID_COMMAND_LINE_ARROW=309,ID_COMMAND_LINE_ARROW_NONE=310,ID_COMMAND_LINE_ARROW1=311,ID_COMMAND_LINE_ARROW2=312,ID_COMMAND_LINE_ARROW3=313,ID_COMMAND_LINE_ARROW4=314,ID_COMMAND_LINE_ARROW5=315,ID_COMMAND_LINE_ARROW6=316,ID_COMMAND_LINE_ARROW7=317,ID_COMMAND_LINE_ARROW8=318,ID_COMMAND_LINE_ARROW9=319,ID_COMMAND_LINE_ARROW10=320,ID_COMMAND_GET_BIZBOX_REPORT_LIST=321,ID_COMMAND_ADD_TEXT=322,ID_COMMAND_FIXED_RATIO=323,ID_COMMAND_PRIVACY_CHANGE_PASSWORD=
324,ID_COMMAND_MODIFY_CHART_TYPE=325,ID_COMMAND_INSERT_NEW_PAGE=326,ID_COMMAND_INSERT_NEW_PAGE_ABOVE=327,ID_COMMAND_INSERT_NEW_PAGE_BELOW=328,ID_COMMAND_INSERT_EMPTY_PAGE=329,ID_COMMAND_COPY_PAGE=330,ID_COMMAND_PASTE_PAGE=331,ID_COMMAND_PASTE_PAGE_ABOVE=332,ID_COMMAND_PASTE_PAGE_BELOW=333,ID_COMMAND_DELETE_PAGE=334,ID_COMMAND_INSERT_INPUTBOX=335,ID_COMMAND_SEND_REPORT_FORM=336,ID_COMMAND_GET_EXTERNAL_DATA=337,ID_COMMAND_HELP_ONEFFICE_FAQ=338,ID_COMMAND_INSERT_QRCODE=339,ID_COMMAND_COMMENT_PANEL=340,
ID_COMMAND_SLIDE_CURRENT_SHOW=341,ID_COMMAND_VIEW_ZOOM=342,ID_COMMAND_VIEW_100_ALIGN=343,ID_COMMAND_VIEW_WIDTH_ALIGN=344,ID_COMMAND_VIEW_HEIGHT_ALIGN=345,ID_COMMAND_MODIFY_CHART_ATTR=346,ID_COMMAND_MODIFY_CHART_DATA=347,ID_COMMAND_PGNUM=348,ID_COMMAND_PGNUM_FORMAT=349,ID_COMMAND_PGNUM_REMOVE=350,ID_COMMAND_PGNUM_TEMPLATE_UP=351,ID_COMMAND_PGNUM_TEMPLATE_DOWN=352,ID_COMMAND_OVERWRITE_ORG_DOC=353,ID_COMMAND_DELETE_TEMP_DOC=354,ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE=355,ID_COMMAND_REGIST_SCHEDULE=356,
ID_COMMAND_EDIT_WATERMARK=357,ID_COMMAND_IMAGE_CROPPER=358,ID_COMMAND_LAYOUT_TABLE=359,ID_COMMAND_TEXT_COUNT=360,ID_COMMAND_HELP_ONEFFICE_VOC=361,ID_COMMAND_GOBACK_ORG_DOC=362,ID_COMMAND_SHAPE_HEIGHT=363,ID_COMMAND_SHAPE_WIDTH=364,ID_COMMAND_INSERT_NEWS=365,ID_COMMAND_POST_NEWS=366,ID_COMMAND_GET_CLOUD_IMAGE=367,ID_COMMAND_POST_IMAGE=368,ID_COMMAND_SET_IMAGE_INFO=369,ID_COMMAND_STYLE_TEMPLATE=370,ID_COMMAND_STYLE_TEMPLATE_COMBO=371,ID_COMMAND_INSERT_FORM_CONTROL=372,ID_COMMAND_FORM_TAG_RADIO=373,
ID_COMMAND_SET_LIST_START_NEW=374,ID_COMMAND_SET_LIST_START_CONTINUE=375,ID_COMMAND_NEWS_SEND_INFO=376,ID_COMMAND_MEMO=377,ID_SUPPORT_TYPE_GENERAL=0,ID_SUPPORT_TYPE_MULTI_CELL=1,ID_SUPPORT_TYPE_TABLE_OPERATION=2,ID_SUPPORT_TYPE_PERSISTENCE=4,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT=0,ID_SUPPORT_CONTROL_TYPE_NO=1,ID_SUPPORT_CONTROL_TYPE_YES=2,ID_TYPE_TOOLBAR_BUTTON=1,ID_TYPE_TOOLBAR_COMBOBOX=2,ID_TYPE_TOOLBAR_DROPDOWN=3,ID_TYPE_TOOLBAR_NOTHING=4,ID_TYPE_TOOLBAR_SPINNER=5,ID_TYPE_TOOLBAR_FILE_OPEN_FORM=
6,ID_TYPE_TOOLBAR_HANDLE=1111,ID_TYPE_TOOLBAR_SEPARATOR=1112,ID_TYPE_TOOLBAR_SPACE=1113,ID_TYPE_MENU_SEPARATOR=1114,ID_TYPE_TOOLBAR_CAPTION=1115,ID_TYPE_TOOLBAR_GALLERY=1116,ID_DISPLAY_TABBAR_PREVIEW=0,ID_DISPLAY_TABBAR_EDIT=1,ID_DISPLAY_TABBAR_SOURCE=2,g_bMenuBar_Display=!0,g_bTabBar_Display=!0,g_bToolBar1_Display=!0,g_bToolBar2_Display=!0,g_bToolBar3_Display=!1,g_bRulerbar_Display=!1,g_objSupport=null,g_strBackColorCommand=g_browserCHK.ie?"BackColor":"hilitecolor",ID_COMMAND_TYPE_TOOL=1,ID_COMMAND_TYPE_MENU=
2,ID_COMMAND_TYPE_CONTEXT_MENU=3,ID_STRING_NAME_CONTROL="control",ID_STRING_NAME_GRAY="gray",ID_STRING_NAME_UNCHECKED="unchecked",ID_STRING_NAME_CHECKED="checked",ID_STRING_NAME_HIDE="hide",ID_STRING_NAME_UNDEFINED="undefined",ID_STRING_NAME_NONE="none",ID_STRING_NAME_TEXT="text",g_arrIcon=null,g_arrConst=[],g_arrConst_TabMode=[];
function setInitConst(){try{g_arrIcon=["toolbar_btn_style_bold.png","toolbar_btn_style_italic.png","toolbar_btn_style_underline.png","toolbar_btn_style_p_left.png","toolbar_btn_style_p_center.png","toolbar_btn_style_p_right.png","toolbar_btn_style_orderlist.png","toolbar_btn_style_unorderlist.png","toolbar_btn_style_strike.png","toolbar_btn_style_subscript.png","toolbar_btn_style_superscript.png","toolbar_btn_style_p_outdent.png","toolbar_btn_style_p_indent.png","toolbar_btn_edit_undo.png","toolbar_btn_edit_redo.png",
"toolbar_btn_edit_cut.png","toolbar_btn_edit_copy.png","toolbar_btn_edit_paste.png","toolbar_btn_edit_delete.png","toolbar_btn_edit_select_all.png","","","toolbar_btn_style_forecolor.png","toolbar_btn_style_backcolor.png","toolbar_btn_table_create.png","toolbar_btn_table_add_row_up.png","toolbar_btn_table_delete_row.png","toolbar_btn_table_add_col_left.png","toolbar_btn_table_delete_col.png","toolbar_btn_table_merge_cell.png","toolbar_btn_table_split_row.gif","toolbar_btn_table_split_col.gif","toolbar_btn_insert_hyperlink.png",
"toolbar_btn_link_disconnect.gif","toolbar_btn_image.gif","toolbar_btn_flash.gif","toolbar_btn_media.gif","","toolbar_btn_video_help.png","toolbar_btn_help_info.png","toolbar_btn_table_cell_property.png","toolbar_btn_table_property.png","toolbar_btn_mark.gif","toolbar_btn_table_templete_insert.gif","toolbar_btn_adjust_hwp_basic.gif","toolbar_btn_adjust_doc_basic.gif","toolbar_btn_horizontal_rule.gif",g_strBrowserLanguage+"/toolbar_btn_letter_space.gif",g_strBrowserLanguage+"/toolbar_btn_line_height.gif",
"toolbar_btn_body_bg_color.gif","toolbar_btn_body_bg_image.gif","toolbar_btn_doc_templete.gif","toolbar_btn_view_preview.png","toolbar_btn_hide_minibar.gif","","","","","","","toolbar_btn_file_save_download.png","toolbar_btn_file_print.png","toolbar_btn_code_inspect.gif","toolbar_btn_z_index.gif","toolbar_btn_text_box.gif","toolbar_btn_object_position.gif","toolbar_btn_table_add_row_down.png","toolbar_btn_table_add_col_right.png","toolbar_btn_table_copy_row_down.gif","toolbar_btn_style_p_justify.png",
"toolbar_btn_responsive_width.gif","toolbar_btn_doc_layout.gif","","toolbar_btn_responsive_set.gif","","toolbar_btn_file_new.png","toolbar_btn_file_open.png","toolbar_btn_docform.png","toolbar_btn_file_layout.png","toolbar_btn_edit_paste_special.png","toolbar_btn_edit_find.png","toolbar_btn_edit_replace.png","toolbar_btn_view_edit_view.png","toolbar_btn_view_html_view.png","toolbar_btn_insert_picture.png","","toolbar_btn_insert_specialchars.png","toolbar_btn_insert_bookmark.png","toolbar_btn_style_font.png",
"toolbar_btn_style_paragraph.png","toolbar_btn_style_style.png","toolbar_btn_style_unorderlist.png","toolbar_btn_style_orderlist.png","toolbar_btn_style_increaseorder.png","toolbar_btn_style_decreaseorder.png","toolbar_btn_table_cell_style.png","toolbar_btn_table_add_cell.png","toolbar_btn_table_delete_cell.png","toolbar_btn_table_split_cell.png","toolbar_btn_table_same_height.png","toolbar_btn_table_same_width.png","toolbar_btn_table_cell_align.png","toolbar_btn_table_madang.png","toolbar_btn_table_formula.png",
"toolbar_btn_table_number_format.png","ico_arrow_select.png","toolbar_btn_table_cell_horizontal_center.png","toolbar_btn_table_cell_align.png","toolbar_btn_table_block_formula.png","toolbar_btn_table_easy_formula.png","toolbar_btn_table_select_formula.png","toolbar_btn_help_shortcut.png","toolbar_btn_insert_video.png","toolbar_btn_insert_file.png","toolbar_btn_insert_hr.png","toolbar_btn_table_cell_horizontal_left.png","toolbar_btn_table_cell_horizontal_center.png","toolbar_btn_table_cell_horizontal_right.png",
"toolbar_btn_table_cell_vertical_top.png","toolbar_btn_table_cell_vertical_middle.png","toolbar_btn_table_cell_vertical_bottom.png","","","","","","","toolbar_btn_style_increase_font.png","toolbar_btn_style_decrease_font.png","toolbar_btn_table_block_sum.png","toolbar_btn_table_block_avg.png","toolbar_btn_table_block_mul.png","toolbar_btn_table_easy_h_sum.png","toolbar_btn_table_easy_v_sum.png","toolbar_btn_table_easy_h_avg.png","toolbar_btn_table_easy_v_avg.png","toolbar_btn_table_easy_h_mul.png",
"toolbar_btn_table_easy_v_mul.png","","","ico_tag_mode.png","ico_checkbox.png","ico_selectbox.png","ico_form_code.png","ico_form_css.png","toolbar_btn_form_template.png","toolbar_tbn_insert_paragraph_startpoint.png","toolbar_tbn_insert_paragraph_endpoint.png","toolbar_btn_table_delete.png","","toolbar_btn_table_convert_text.png","context_btn_prop_picture.png","context_btn_prop_file.png","toolbar_btn_replace_case.png","toolbar_btn_table_backcolor.png","toolbar_btn_table_cell_align_left_top.png","toolbar_btn_table_cell_align_center_top.png",
"toolbar_btn_table_cell_align_right_top.png","toolbar_btn_table_cell_align_left_middle.png","toolbar_btn_table_cell_align_center_middle.png","toolbar_btn_table_cell_align_right_middle.png","toolbar_btn_table_cell_align_left_bottom.png","toolbar_btn_table_cell_align_center_bottom.png","toolbar_btn_table_cell_align_right_bottom.png","","toolbar_btn_emoticon.png","toolbar_btn_edit_page_divide.png","toolbar_btn_view_ruler.png","toolbar_btn_style_cascade_orderlist.png","toolbar_btn_edit_copy.png","toolbar_btn_edit_copy_ext_style.png",
"ico_paragraph.png","toolbar_btn_edit_paste.png","toolbar_btn_table_delete_cell.png","toolbar_btn_table_formula.png","ico_sort_line.png","ico_thin_line.png","ico_line_color.png","ico_picture_back.png","","","","","","","","","","","","","","","","ico_cell_select.png","ico_v_select.png","ico_h_select.png","ico_table_select.png","ico_export_form.png","ico_thin_line.png","ico_sort_line.png","ico_line_color.png","ico_table_style.png","ico_height.png","ico_width.png","ico_textinput_box.png","ico_web_search.png",
"ico_transter_letter.png","ico_highlighter.png","toolbar_btn_file_open.png","toolbar_btn_edit_paste.png","ico_insert_video_set.png","toolbar_btn_file_open.png","toolbar_btn_file_save.png","toolbar_btn_file_saveas.png","toolbar_btn_table_backcolor.png","ico_line_color.png","ico_chart.png","ico_page_setting.png","ico_cell_copyoption.png","ico_cell_rownew.png","ico_cell_overwrite.png","ico_cell_copy.png","ico_picture_back.png","toolbar_btn_table_add_cell.png","toolbar_btn_table_delete_cell.png","ico_sort_line.png",
"ico_thin_line.png","ico_line_color.png","ico_height.png","ico_width.png","ico_picture_back.png","ico_slideshow.png","ico_document_lock.png","ico_imgchange.png","ico_imgsave.png","ico_connector.png","ico_download_pdf.png","ico_webdata.png","ico_docgrade.png","ico_faxsharing.png","ico_cell_lock.png","ico_security_protect.png","ico_doc_info.png","ico_security_disable.png","toolbar_btn_hf_header.png","toolbar_btn_hf_footer.png","toolbar_btn_hf_edit_header.png","toolbar_btn_hf_edit_footer.png","toolbar_btn_hf_close.png",
"toolbar_btn_hf_remove_header.png","toolbar_btn_hf_remove_footer.png","toolbar_btn_hf_prev.png","toolbar_btn_hf_next.png","toolbar_btn_hf_option.png","","","","toolbar_btn_hf_header_top.png","toolbar_btn_hf_footer_bottom.png","ico_picture_delete.png","ico_video_delete.png","toolbar_btn_online_help.png","toolbar_btn_file_save.png","toolbar_btn_file_print.png","toolbar_btn_hf_go_header.png","toolbar_btn_hf_go_footer.png","ico_work_register.png","ico_work_register.png","ico_shape.png","ico_shape_format.png",
"ico_shape_change.png","ico_shape_style.png","toolbar_btn_table_backcolor.png","ico_shape_line.png","ico_text_align.png","ico_text_linechange.png","ico_forward.png","ico_backward.png","ico_shape_align.png","ico_shape_rotate.png","ico_forward.png","ico_forward_2.png","ico_backward.png","ico_backward_2.png","ico_align_top.png","ico_align_middle.png","ico_align_bottom.png","ico_align_left.png","ico_align_center.png","ico_align_right.png","ico_align_top.png","ico_align_middle.png","ico_align_bottom.png",
"ico_rotate_right_90.png","ico_rotate_left_90.png","ico_rotate_topbottom.png","ico_rotate_leftright.png","ico_shape_rotate.png","btn_textchange_in.png","btn_textchange_square.png","btn_textchange_full.png","btn_textchange_clear.png","btn_textchange_topdown.png","btn_textchange_back.png","btn_textchange_front.png","btn_textchange_left.png","btn_textchange_right.png","btn_txtchange_etclayout.png","ico_arrow.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png",
"toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","ico_work_load.png","ico_textinput_box.png","ico_link.png","ico_security_protect.png","ico_chart.png","ico_page_add.png","ico_page_add_top.png","ico_page_add_bottom.png","ico_page_add.png","ico_copy.png","ico_paste.png","ico_page_add_top.png",
"ico_page_add_bottom.png","ico_page_del.png","ico_inputarea.png","ico_work_register.png","ico_outdata.png","toolbar_btn_help.png","ico_insert_qr_code.png","ico_doc_comment.png","ico_slideshow_play.png","ico_zoom.png","ico_100percent.png","ico_page_align_w.png","ico_page_align_h.png","ico_chart_setting.png","ico_data_edit.png","ico_pgnum.png","ico_pgnum_form.png","ico_pgnum_del.png","ico_pgnum_top.png","ico_pgnum_bottom.png","ico_overwrite_doc.png","toolbar_btn_edit_delete.png","ico_cell_nest.png",
"","ico_watermark.png","ico-picture-cut.png","ico_table_insert.png","ico_transter_letter.png","ico-help-qna.png","toolbar_btn_edit_undo.png","ico_height.png","ico_width.png","toolbar_btn_view_preview.png","toolbar_btn_edit_paste.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_insert_picture.png","toolbar_btn_style_style.png","toolbar_btn_style_style.png","","","","","context_btn_prop_file.png","ico_memo.png"];g_arrConst[ID_COMMAND_BOLD]=["Bold",ID_RES_CONST_STRING_BOLD,
"TB_BOLD","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ITALIC]=["Italic",ID_RES_CONST_STRING_ITALIC,"TB_ITALIC","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_UNDERLINE]=["Underline",ID_RES_CONST_STRING_UNDERLINE,"TB_UNDERLINE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_JUSTIFY_LEFT]=
["JustifyLeft",ID_RES_CONST_STRING_JUSTIFYLEFT,"TB_JUSTIFYLEFT","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_JUSTIFY_CENTER]=["JustifyCenter",ID_RES_CONST_STRING_JUSTIFYCENTER,"TB_JUSTIFYCENTER","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_JUSTIFY_RIGHT]=["JustifyRight",ID_RES_CONST_STRING_JUSTIFYRIGHT,"TB_JUSTIFYRIGHT","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_ORDERED_LIST]=["InsertOrderedList",ID_RES_CONST_STRING_STYLE_ORDEREDLIST,"TB_ORDERLIST","fnHandler_Tb_OrderedList",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_INSERT_UNORDERED_LIST]=["InsertUnorderedList",ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,"TB_UNORDERLIST","fnHandler_Tb_UnorderedList",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];
g_arrConst[ID_COMMAND_STRIKE]=["StrikeThrough",ID_RES_CONST_STRING_STRIKE,"TB_STRIKE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SUBSCRIPT]=["Subscript",ID_RES_CONST_STRING_SUBSCRIPT,"TB_SUBSCRIPT","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SUPERSCRIPT]=["Superscript",ID_RES_CONST_STRING_SUPERSCRIPT,"TB_SUPERSCRIPT","fnHandler_SupportCommand",
ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OUTDENT]=["Outdent",ID_RES_CONST_STRING_OUTDENT,"TB_OUTDENT","fnHandler_Outdent",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INDENT]=["Indent",ID_RES_CONST_STRING_INDENT,"TB_INDENT","fnHandler_Indent",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_UNDO]=["Undo",ID_RES_CONST_STRING_UNDO,"TB_UNDO",
"fnHandler_Undo",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_REDO]=["Redo",ID_RES_CONST_STRING_REDO,"TB_REDO","fnHandler_Redo",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CUT]=["Cut",ID_RES_CONST_STRING_CUT,"TB_CUT","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_COPY]=["Copy",ID_RES_CONST_STRING_COPY,
"TB_COPY","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE]=["Paste",ID_RES_CONST_STRING_PASTE,"TB_PASTE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DELETE]=["Delete",ID_RES_CONST_STRING_DELETE,"TB_DELETE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SELECT_ALL]=
["SelectAll",ID_RES_CONST_STRING_SELECT_ALL,"TB_SELECT_ALL","fnHandler_SupportCommand",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FONT_NAME]=["FontName",ID_RES_CONST_STRING_FONT_NAME,"TB_COMBOBOX_FONT_NAME","fnHandler_FontName",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX];g_arrConst[ID_COMMAND_FONT_SIZE]=["FontSize",ID_RES_CONST_STRING_FONT_SIZE,"TB_COMBOBOX_FONT_SIZE","fnHandler_FontSize",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX];g_arrConst[ID_COMMAND_FORE_COLOR]=["ForeColor",ID_RES_CONST_STRING_FORE_COLOR,"TB_SETFORECOLOR","fnHandler_ForeColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_BACK_COLOR]=[g_strBackColorCommand,ID_RES_CONST_STRING_BACK_COLOR,"TB_SETBACKCOLOR","fnHandler_BackColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_CREATE]=["",ID_RES_CONST_STRING_TABLE_CREATE,
"TB_TABLE_CREATE","fnHandler_TableCreate",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_ADD_ROW]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW,"TB_TABLE_ADD_ROW","fnHandler_TableAddRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_DELETE_ROW]=["",ID_RES_CONST_STRING_TABLE_DELETE_ROW,"TB_TABLE_DELETE_ROW","fnHandler_TableDeleteRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_ADD_COL]=["",ID_RES_CONST_STRING_TABLE_ADD_COL,"TB_TABLE_ADD_COL","fnHandler_TableAddCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_DELETE_COL]=["",ID_RES_CONST_STRING_TABLE_DELETE_COL,"TB_TABLE_DELETE_COL","fnHandler_TableDeleteCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_MERGE_CELL]=["",ID_RES_CONST_STRING_TABLE_MERGE_CELL,
"TB_TABLE_MERGE_CELL","fnHandler_TableMergeCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SPLIT_ROW]=["",ID_RES_CONST_STRING_TABLE_SPLIT_ROW,"TB_TABLE_SPLIT_ROW","fnHandler_TableSplitRow",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SPLIT_COL]=["",ID_RES_CONST_STRING_TABLE_SPLIT_COL,"TB_TABLE_SPLIT_COL","fnHandler_TableSplitCol",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HYPERLINK_INSERT]=["CreateLink",ID_RES_CONST_STRING_HYPERLINK_INSERT,"TB_HYPERLINK_INSERT","fnHandler_HyperLinkInsert",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HYPERLINK_REMOVE]=["Unlink",ID_RES_CONST_STRING_HYPERLINK_REMOVE,"TB_HYPERLINK_REMOVE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_INSERT]=["InsertImage",
ID_RES_CONST_STRING_IMAGE_INSERT,"TB_IMAGE_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FLASH_INSERT]=["InsertImage",ID_RES_CONST_STRING_FLASH_INSERT,"TB_FLASH_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MEDIA_INSERT]=["InsertImage",ID_RES_CONST_STRING_MEDIA_INSERT,"TB_MEDIA_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HELP]=["",ID_RES_CONST_STRING_HELP,"","fnHandler_Help",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING];g_arrConst[ID_COMMAND_HELP_INFO]=["",ID_RES_CONST_STRING_PRODUCT_INFO,"","fnHandler_ProductInfo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING];g_arrConst[ID_COMMAND_TABLE_CELL_PROPERTY]=["",ID_RES_CONST_STRING_TABLE_CELL_PROPERTY,"TB_TABLE_CELL_PROPERTY","fnHandler_TableCellProperty",
ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_PROPERTY]=["",ID_RES_CONST_STRING_TABLE_PROPERTY,"TB_TABLE_PROPERTY","fnHandler_TableProperty",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MARK_INSERT]=["",ID_RES_CONST_STRING_MARK_INSERT,"TB_MARK_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_TEMPLETE_INSERT]=
["",ID_RES_CONST_STRING_TABLE_TEMPLETE_INSERT,"TB_TABLE_TEMPLETE_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_ADJUST_HWP_BASIC]=["",ID_RES_CONST_STRING_ADJUST_HWP_BASIC,"TB_ADJUST_HWP_BASIC","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ADJUST_DOC_BASIC]=["",ID_RES_CONST_STRING_ADJUST_DOC_BASIC,"TB_ADJUST_DOC_BASIC","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HORIZONTAL_RULE]=["InsertHorizontalRule",ID_RES_CONST_STRING_HORIZONTAL_RULE,"TB_HORIZONTAL_RULE","fnHandler_SupportCommand",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LETTER_SPACING]=["",ID_RES_CONST_STRING_LETTER_SPACING,"TB_LETTER_SPACING","fnHandler_LetterSpacing",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX];g_arrConst[ID_COMMAND_LINE_HEIGHT]=
["",ID_RES_CONST_STRING_LINE_HEIGHT,"TB_LINE_HEIGHT","fnHandler_LineHeight",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX];g_arrConst[ID_COMMAND_BODY_BG_COLOR]=["",ID_RES_CONST_STRING_BODY_BG_COLOR,"TB_BODY_BG_COLOR","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_BODY_BG_IMAGE]=["",ID_RES_CONST_STRING_BODY_BG_IMAGE,"TB_BODY_BG_IMAGE","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DOC_TEMPLETE]=["",ID_RES_CONST_STRING_DOC_TEMPLETE,"TB_DOC_TEMPLETE","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PREVIEW]=["",ID_RES_CONST_STRING_PREVIEW,"TB_PREVIEW","fnHandler_Preview",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HIDE_MINIBAR]=["",ID_RES_CONST_STRING_HIDE_MINIBAR,"TB_HIDE_MINIBAR","fnHandler_HideMiniBar",
ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SHOW_EDITABLE_AREA]=["",ID_RES_CONST_STRING_SHOW_EDITABLE_AREA,"TB_SHOW_EDITABLE_AREA","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EXT_FUNCTION]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CUSTOMER_TOOL_BUTTON_1]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CUSTOMER_TOOL_BUTTON_2]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CUSTOMER_TOOL_BUTTON_3]=["","","","",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SAVEAS]=["",ID_RES_CONST_STRING_SAVEAS,"TB_SAVEAS","fnHandler_SaveAs",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PRINT]=["",ID_RES_CONST_STRING_PRINT,"TB_PRINT","fnHandler_Print",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CODE_INSPECT]=["","","TB_CODE_INSPECT","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_Z_INDEX_SETTING]=["",ID_RES_CONST_STRING_Z_INDEX_SETTING,"TB_ZINDEXSETTING","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,
ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TEXT_BOX]=["",ID_RES_CONST_STRING_TEXT_BOX,"TB_TEXT_BOX","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJECT_POSITION]=["",ID_RES_CONST_STRING_OBJECT_POSITION,"TB_OBJECT_POSITION","fnHandler_dummy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_ADD_ROW_DOWN]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW_DOWN,"TB_TABLE_ADD_ROW_DOWN",
"fnHandler_TableAddRowDown",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_ADD_COL_RIGHT]=["",ID_RES_CONST_STRING_TABLE_ADD_COL_RIGHT,"TB_TABLE_ADD_COL_RIGHT","fnHandler_TableAddColRight",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_COPY_ROW_DOWN]=["",ID_RES_CONST_STRING_TABLE_COPY_ROW_DOWN,"TB_TABLE_COPY_ROW_DOWN","fnHandler_TableCopyRow",ID_SUPPORT_TYPE_TABLE_OPERATION,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_JUSTIFY_JUSTIFY]=["JustifyJustify",ID_RES_CONST_STRING_JUSTIFYJUSTIFY,"TB_JUSTIFYJUSTIFY","fnHandler_Align",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_RESPONSIVE_WIDTH]=["",ID_RES_CONST_STRING_RESPONSIVE_WIDTH,"TB_RESPONSIVE_WIDTH","fnHandler_ResponsiveWidth",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_DOC_LAYOUT]=
["",ID_RES_CONST_STRING_DOC_LAYOUT,"TB_DOC_LAYOUT","fnHandler_dummy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HEADING_SIZE]=["formatBlock",ID_RES_CONST_STRING_HEADING_SIZE,"TB_COMBOBOX_HEADING_SIZE","fnHandler_HeadingSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_COMBOBOX];g_arrConst[ID_COMMAND_RESPONSIVE_SET]=["",ID_RES_CONST_STRING_RESPONSIVE_SET,"TB_RESPONSIVE_SET","fnHandler_ResponsiveSet",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_NEW]=["",ID_RES_CONST_STRING_FILE_NEW,"TB_FILE_NEW","fnHandler_NewFile",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_OPEN]=["",ID_RES_CONST_STRING_FILE_OPEN,"TB_FILE_OPEN","fnHandler_OpenFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_DOCFORM]=["",ID_RES_CONST_STRING_FILE_DOCFORM,"TB_FILE_DOCFORM",
"fnHandler_DocForm",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_LAYOUT]=["",ID_RES_CONST_STRING_FILE_LAYOUT,"TB_FILE_LAYOUT","fnHandler_Layout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EDIT_PASTESPECIAL]=["",ID_RES_CONST_STRING_EDIT_PASTESPECIAL,"TB_EDIT_PASTESPECIAL","fnHandler_Pastespecial",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EDIT_SEARCH]=
["",ID_RES_CONST_STRING_EDIT_SEARCH,"TB_EDIT_SEARCH","fnHandler_FindText",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EDIT_REPLACE]=["",ID_RES_CONST_STRING_EDIT_REPLACE,"TB_EDIT_REPLACE","fnHandler_ReplaceText",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_EDIT]=["",ID_RES_CONST_STRING_VIEW_EDIT,"TB_VIEW_EDIT","fnHandler_viewEdit",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_HTML]=["",ID_RES_CONST_STRING_VIEW_HTML,"TB_VIEW_HTML","fnHandler_viewHtml",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_IMAGE]=["InsertImage",ID_RES_CONST_STRING_INSERT_IMAGE,"TB_INSERT_IMAGE","fnHandler_InsertImage",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_OBJECT]=["",ID_RES_CONST_STRING_INSERT_OBJECT,"TB_INSERT_OBJECT",
"dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_SPECIALCHARS]=["",ID_RES_CONST_STRING_INSERT_SPECIALCHARS,"TB_INSERT_SPECIALCHARS","fnHandler_SpecialChars",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_BOOKMARK]=["",ID_RES_CONST_STRING_INSERT_BOOKMARK,"TB_INSERT_BOOKMARK","fnHandler_InsertBookmark",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_STYLE_FONT]=["",ID_RES_CONST_STRING_STYLE_FONT,"TB_STYLE_FONT","fnHandler_StyleFont",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_PARAGRAPH]=["",ID_RES_CONST_STRING_STYLE_PARAGRAPH,"TB_STYLE_PARAGRAPH","fnHandler_StyleParagraph",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE]=["",ID_RES_CONST_STRING_STYLE_STYLE,"TB_STYLE_STYLE","fnHandler_HeadingSizeExt",
ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_STYLE_UNORDEREDLIST]=["",ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,"TB_STYLE_UNORDEREDLIST","fnHandler_StyleUnorderedList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_ORDEREDLIST]=["",ID_RES_CONST_STRING_STYLE_ORDEREDLIST,"TB_STYLE_ORDEREDLIST","fnHandler_StyleOrderedList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_INCREASEORDER]=["",ID_RES_CONST_STRING_STYLE_INCREASEORDER,"TB_STYLE_INCREASEORDER","fnHandler_IncreaseOrder",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_DECREASEORDER]=["",ID_RES_CONST_STRING_STYLE_DECREASEORDER,"TB_STYLE_DECREASEORDER","fnHandler_DecreaseOrder",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_STYLE]=["",ID_RES_CONST_STRING_TABLE_CELL_STYLE,
"TB_TABLE_CELL_STYLE","fnHandler_TableCellStyle",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_ADD_ROW_COL]=["",ID_RES_CONST_STRING_TABLE_ADD_ROW_COL,"TB_TABLE_ADD_ROW_COL","fnHandler_TableAddRowCol",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_DELETE_ROW_COL]=["",ID_RES_CONST_STRING_TABLE_DELETE_ROW_COL,"TB_TABLE_DELETE_ROW_COL","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SPLIT_CELL]=["",ID_RES_CONST_STRING_TABLE_SPLIT_CELL,"TB_TABLE_SPLIT_CELL","fnHandler_TableSplitCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_SAME_HEIGHT]=["",ID_RES_CONST_STRING_TABLE_CELL_SAME_HEIGHT,"TB_TABLE_CELL_SAME_HEIGHT","fnHandler_TableCellSameHeight",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_SAME_WIDTH]=
["",ID_RES_CONST_STRING_TABLE_CELL_SAME_WIDTH,"TB_TABLE_CELL_SAME_WIDTH","fnHandler_TableCellSameWidth",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN]=["",ID_RES_CONST_STRING_TABLE_CELL_ALIGN,"TB_TABLE_CELL_ALIGN","fnHandler_TableCellAlign",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_MADANG]=["",ID_RES_CONST_STRING_TABLE_MADANG,"TB_TABLE_MADANG","dummyFunc",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_FORMULA]=["",ID_RES_CONST_STRING_TABLE_FORMULA,"TB_TABLE_FORMULA","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_NUMBER_FORMAT]=["",ID_RES_CONST_STRING_TABLE_NUMBER_FORMAT,"TB_TABLE_NUMBER_FORMAT","fnHandler_TableNumberFormat",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_SELECT]=
["",ID_RES_CONST_STRING_TABLE_SELECT,"TB_TABLE_SELECT","fnHandler_TableSelect",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_CELL_HORIZONTALALIGN]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTALALIGN,"TB_TABLE_CELL_HORIZONTALALIGN","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_CELL_VERTICALALIGN]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICALALIGN,"TB_TABLE_CELL_VERTICALALIGN",
"dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_BLOCK_FORMULA]=["",ID_RES_CONST_STRING_TABLE_BLOCK_FORMULA,"TB_TABLE_BLOCK_FORMULA","dummyFunc",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_EASY_FORMULA]=["",ID_RES_CONST_STRING_TABLE_EASY_FORMULA,"TB_TABLE_EASY_FORMULA","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SELECT_FORMULA]=
["",ID_RES_CONST_STRING_TABLE_SELECT_FORMULA,"TB_TABLE_SELECT_FORMULA","fnHandler_TableSelectFormula",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HELP_SHORTCUTS]=["",ID_RES_CONST_STRING_HELP_SHORTCUTS,"","fnHandler_ShortCutsInfo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING];g_arrConst[ID_COMMAND_INSERT_OBJECT_MOVIE]=["",ID_RES_CONST_STRING_INSERT_OBJECT_MOVIE,"TB_INSERT_OBJECT_MOVIE","fnHandler_InsertExtMovie",
ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_OBJECT_FILE]=["",ID_RES_CONST_STRING_INSERT_OBJECT_FILE,"TB_INSERT_OBJECT_FILE","fnHandler_InsertExtFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_OBJECT_HR]=["",ID_RES_CONST_STRING_INSERT_OBJECT_HR,"TB_INSERT_OBJECT_HR","fnHandler_InsertHr",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_HORIZONTAL_LEFT]=
["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_LEFT,"TB_TABLE_CELL_HORIZONTAL_LEFT","fnHandler_TableCellHorizontalLeft",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_HORIZONTAL_CENTER]=["",ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_CENTER,"TB_TABLE_CELL_HORIZONTAL_CENTER","fnHandler_TableCellHorizontalCenter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_HORIZONTAL_RIGHT]=["",
ID_RES_CONST_STRING_TABLE_CELL_HORIZONTAL_RIGHT,"TB_TABLE_CELL_HORIZONTAL_RIGHT","fnHandler_TableCellHorizontalRight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_VERTICAL_TOP]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_TOP,"","fnHandler_TableCellVerticalTop",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_VERTICAL_MIDDLE]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_MIDDLE,"",
"fnHandler_TableCellVerticalMiddle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_VERTICAL_BOTTOM]=["",ID_RES_CONST_STRING_TABLE_CELL_VERTICAL_BOTTOM,"","fnHandler_TableCellVerticalBottom",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE_BASIC]=["",ID_RES_CONST_STRING_STYLE_STYLE_BASIC,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE_SUBJECT1]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT1,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE_SUBJECT2]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT2,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE_SUBJECT3]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT3,
"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE_SUBJECT4]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT4,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_STYLE_SUBJECT5]=["",ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT5,"","fnHandler_StyleHeadingSize",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_INCREASE_FONTSIZE]=["",ID_RES_CONST_STRING_STYLE_INCREASE_FONTSIZE,"TB_STYLE_INCREASE_FONTSIZE","fnHandler_StyleIncreaseFontSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_DECREASE_FONTSIZE]=["",ID_RES_CONST_STRING_STYLE_DECREASE_FONTSIZE,"TB_STYLE_DECREASE_FONTSIZE","fnHandler_StyleDecreaseFontSize",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_BLOCK_SUM]=
["",ID_RES_CONST_STRING_TABLE_BLOCK_SUM,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_BLOCK_AVG]=["",ID_RES_CONST_STRING_TABLE_BLOCK_AVG,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_BLOCK_MUL]=["",ID_RES_CONST_STRING_TABLE_BLOCK_MUL,"","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_HORIZONTAL_SUM]=
["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_SUM,"","fnHandler_TableHorizontalSum",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_VERTICAL_SUM]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_SUM,"","fnHandler_TableVerticalSum",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_HORIZONTAL_AVERAGE]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_AVERAGE,"","fnHandler_TableHorizontalAverage",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_VERTICAL_AVERAGE]=["",ID_RES_CONST_STRING_TABLE_VERTICAL_AVERAGE,"","fnHandler_TableVerticalAverage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY]=["",ID_RES_CONST_STRING_TABLE_HORIZONTAL_MULTIPLY,"","fnHandler_TableHorizontalMultiply",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_VERTICAL_MULTIPLY]=
["",ID_RES_CONST_STRING_TABLE_VERTICAL_MULTIPLY,"","fnHandler_TableVerticalMultiply",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_TABLE_ADD_NUMBER_FORMAT]=["",ID_RES_CONST_STRING_TABLE_ADD_NUMBER_FORMAT,"","fnHandler_TableAddNumberFormat",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_TABLE_REMOTE_NUMBER_FORMAT]=["",ID_RES_CONST_STRING_TABLE_REMOVE_NUMBER_FORMAT,"","fnHandler_TableRemoveNumberFormat",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FORM_TAG_SWITCH]=["",ID_RES_CONST_STRING_FORM_TAG_SWITCH,"TB_FORM_TAG_SWITCH","fnHandler_FormTagSwitch",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FORM_TAG_CHECKBOX]=["",ID_RES_CONST_STRING_FORM_TAG_CHECKBOX,"TB_FORM_TAG_CHECKBOX","fnHandler_CheckBox",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FORM_TAG_SELECT]=
["",ID_RES_CONST_STRING_FORM_TAG_SELECT,"TB_FORM_TAG_SELECT","fnHandler_SelectBox",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MAPPING_CODE]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MAPPING_CSS]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TEMPLETE_FORM]=["","","","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH_STARTPOINT,"TB_INSERT_PARAGRAPH_STARTPOINT","fnHandler_InsertParagraphStartPoint",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH_ENDPOINT,"TB_INSERT_PARAGRAPH_ENDPOINT","fnHandler_InsertParagraphEndPoint",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_TABLE_DELETE_TABLE]=["",ID_RES_CONST_STRING_TABLE_DELETE_TABLE,"TB_TABLE_DELETE_TABLE","fnHandler_TableDelete",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_PARAGRAPH]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH,"TB_INSERT_PARAGRAPH","dummyFunc",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CONVERT_TEXT]=["",ID_RES_CONST_STRING_TABLE_CONVERT_TEXT,
"TB_TABLE_CONVERT_TEXT","fnHandler_TableConvertText",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_PROPERTY]=["",ID_RES_PROP_INSERT_IMAGE,"TB_PROP_INSERT_IMAGE","fnHandler_ModifyImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_PROPERTY]=["",ID_RES_PROP_INSERT_FILE,"TB_PROP_INSERT_FILE","fnHandler_InsertExtFile",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_EDIT_REPLACE_CASE]=["",ID_RES_CONST_STRING_REPLACE_CASE,"TB_EDIT_REPLACE_CASE","fnHandler_ReplaceCase",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_BACKCOLOR]=["",ID_RED_CONST_STRING_TABLE_CELL_BACKCOLOR,"TB_SETCELLBACKCOLOR","fnHandler_Table_Cell_BackColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP]=["",ID_RED_CONST_STRING_ALIGN_LEFT_TOP,
"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP]=["",ID_RED_CONST_STRING_ALIGN_CENTER_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_TOP,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE]=["",ID_RED_CONST_STRING_ALIGN_LEFT_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE]=["",ID_RED_CONST_STRING_ALIGN_CENTER_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE]=
["",ID_RED_CONST_STRING_ALIGN_RIGHT_MIDDLE,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM]=["",ID_RED_CONST_STRING_ALIGN_LEFT_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM]=["",ID_RED_CONST_STRING_ALIGN_CENTER_BOTTOM,"","fnHandler_execTableCellAlign",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM]=["",ID_RED_CONST_STRING_ALIGN_RIGHT_BOTTOM,"","fnHandler_execTableCellAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_EMOTICONS]=["",ID_RES_CONST_STRING_INSERT_EMOTICONS,"TB_INSERT_EMOTICONS","fnHandler_InsertEmoticons_Dialog",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_EDIT_PRIINT_PAGE_BREAK]=["",ID_RES_STRING_INSERT_PAGE_BREAK,"TB_EDIT_PRINT_PAGE_BREAK","fnHandler_InsertPrintPageBreak",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_RULERBAR]=["",ID_RES_CONST_STRING_VIEW_RULERBAR,"TB_VIEW_RULERBAR","fnHandler_viewRulerbar",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_CASCADE_ORDERLIST]=["MultilevelList",ID_RES_DIALOG_STRING_CASCADE_ORDERLIST,
"TB_STYLE_CASCADE_ORDERLIST","fnHandler_cascadeOrderList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_COPY_EXT]=["Copy",ID_RES_CONST_STRING_COPY,"TB_COPY_EXT","fnHandler_CopyExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_COPY_EXT_STYLE]=["Copy",ID_RES_CONST_STRING_COPY_EXT_STYLE,"TB_COPY_EXT_STYLE","fnHandler_CopyExtStyle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_SELECT_PARAGRAPH]=["",ID_RES_CONST_STRING_INSERT_PARAGRAPH,"TB_INSERT_SELECT_PARAGRAPH","fnHandler_SelectParagraphDropDown",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_PASTE_EXT]=["Paste",ID_RES_CONST_STRING_PASTE,"TB_PASTE_EXT","fnHandler_PasteExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_DELETE_EXT]=["",ID_RES_CONST_BTN_DELETE,"TB_TABLE_DELETE_EXT",
"fnHandler_TalbeDeleteExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_FORMULA_EXT]=["",ID_RES_CONST_STRING_TABLE_FORMULA,"TB_TABLE_FORMULA_EXT","fnHandler_TableFomulaExt",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_IMAGE_BORDER_TYPE]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_IMAGE_BORDER_TYPE","fnHandler_ImageBorderType",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_IMAGE_BORDER_THICKNESS]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,"TB_IMAGE_BORDER_THICKNESS","fnHandler_ImageBorderThickness",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_IMAGE_BORDER_COLOR]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETIMAGEBORDERCOLOR","fnHandler_ImageBorderColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_IMAGE_RESET_PICTURE]=
["",ID_RES_CONST_STRING_RESET_PICTURE,"TB_IMAGE_RESET_PICTURE","fnHandler_ImageResetPicture",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_NONE]=["",ID_RES_CONST_STRING_NO_LINE,"","fnHandler_ObjectBorderNoLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_SOLID]=["",ID_RES_CONST_STRING_SOLID_LINE,"","fnHandler_ObjectBorderSolidLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_DASHED]=["",ID_RES_CONST_STRING_DASHED_LINE,"","fnHandler_ObjectBorderDashedLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_DOTTED]=["",ID_RES_CONST_STRING_DOTTED_LINE,"","fnHandler_ObjectBorderDottedLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_DOUBLE]=["",ID_RES_CONST_STRING_DOUBLE_LINE,
"","fnHandler_ObjectBorderDoubleLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_1PX]=["","1px","","fnHandler_ObjectBorder1pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_2PX]=["","2px","","fnHandler_ObjectBorder2pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_3PX]=["",
"3px","","fnHandler_ObjectBorder3pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_4PX]=["","4px","","fnHandler_ObjectBorder4pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_5PX]=["","5px","","fnHandler_ObjectBorder5pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_6PX]=
["","6px","","fnHandler_ObjectBorder6pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_7PX]=["","7px","","fnHandler_ObjectBorder7pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_8PX]=["","8px","","fnHandler_ObjectBorder8pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_9PX]=
["","9px","","fnHandler_ObjectBorder9pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_BORDER_10PX]=["","10px","","fnHandler_ObjectBorder10pxLine",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SELECT_CELL]=["",ID_RES_CONST_STRING_TABLE_SELECT_CELL,"TB_TABLE_SELECT_CELL","fnHandler_TableSelectCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_TABLE_SELECT_COL]=["",ID_RES_CONST_STRING_TABLE_SELECT_COL,"TB_TABLE_SELECT_COL","fnHandler_TableSelectCol",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SELECT_ROW]=["",ID_RES_CONST_STRING_TABLE_SELECT_ROW,"TB_TABLE_SELECT_ROW","fnHandler_TableSelectRow",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_SELECT_TABLE]=["",ID_RES_CONST_STRING_TABLE_SELECT_TABLE,
"TB_TABLE_SELECT_TABLE","fnHandler_TableSelectTable",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_TO_TABLE]=["",ID_RES_CONST_STRING_IMAGE_TO_TABLE,"TB_IMAGE_TO_TABLE","fnHandler_imageToTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_BORDER_THICKNESS]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,"TB_TABLE_BORDER_THICKNESS","fnHandler_TableBorderThickness",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_BORDER_TYPE]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_TABLE_BORDER_TYPE","fnHandler_TableBorderType",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_BORDER_COLOR]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETTABLEBORDERCOLOR","fnHandler_TableBorderColor",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TABLE_STYLE]=
["",ID_RES_CONST_STRING_TABLE_MADANG,"TB_TABLE_STYLE","fnHandler_TableStyle",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_IMAGE_HEIGHT]=["",ID_RES_DIALOG_STRING_HEIGHT,"TB_IMAGE_HEIGHT","fnHandler_TBSetObjectHeight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"];g_arrConst[ID_COMMAND_IMAGE_WIDTH]=["",ID_RES_DIALOG_STRING_WIDTH,"TB_IMAGE_WIDTH","fnHandler_TBSetObjectWidth",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"];g_arrConst[ID_COMMAND_INSERT_TEXTBOX]=["",ID_RES_CONST_STRING_TEXTBOX,"TB_INSERT_TEXTBOX","fnHandler_InsertTextBox",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_WEB_SEARCH]=["",ID_RES_CONST_STRING_WEB_SEARCH,"TB_WEB_SEARCH","fnHandler_WebSearch",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CONV_KOREAN]=["",ID_RES_CONST_STRING_CONV_KOREAN,
"TB_CONV_KOREAN","fnHandler_ConvKorean",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HIGHLIGHTER]=["",ID_RES_CONST_STRING_HIGHLIGHTER,"TB_HIGHLIGHTER","fnHandler_Highlighter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_FILE_OPEN_FORM]=["",ID_RES_CONST_STRING_FILE_OPEN,"TB_FILE_OPEN_FORM","fnHandler_OpenFileForm",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_FILE_OPEN_FORM,
".html,.htm,.txt"];g_arrConst[ID_COMMAND_TABLE_CELL_PASTE]=["",ID_RES_CONST_TABLE_CELL_PASTE,"TB_TABLE_CELL_PASTE","fnHandler_pasteTableCell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIDEO_PROPERTY]=["",ID_RES_PROP_INSERT_VIDEO,"TB_PROP_INSERT_VIDEO","fnHandler_videoProperty",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];var a=oneffice.getAppEnvType(),b=ID_RES_CONST_STRING_FILE_OPEN;a==APPENV.WE&&(b=ID_RES_CONST_STRING_DOC_OPEN);
g_arrConst[ID_COMMAND_FILE_LIST_OPEN]=["",b,"TB_FILE_LIST_OPEN","fnHandler_OpenFileList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_SAVE_REMOTE]=["",ID_RES_CONST_STRING_SAVE_REMOTE,"TB_FILE_SAVE_REMOTE","fnHandler_SaveFileRemote",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FILE_SAVE_AS_REMOTE]=["",ID_RES_CONST_STRING_SAVEAS_REMOTE,"TB_FILE_SAVE_AS_REMOTE","fnHandler_SaveAsRemote",
ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TEXTBOX_FILL_COLOR]=["",ID_RES_CONST_STRING_TEXTBOX_FILL_COLOR,"TB_FILLCOLOR","fnHandler_Table_Cell_BackColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_TEXTBOX_LINE_COLOR]=["",ID_RES_CONST_STRING_TEXTBOX_BORDER_COLOR,"TB_LINECOLOR","fnHandler_ImageBorderColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_INSERT_CHART]=
["",ID_RES_CONST_STRING_INSERT_CHART,"TB_INSERT_CHART","fnHandler_Chart",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PAGE_SETTING]=["",ID_RES_CONST_STRING_PAGE_SETTING,"TB_PAGE_SETTING","fnHandler_pageSetting",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_CELL]=["",ID_RES_CONST_STRING_PASTE_CELL,"TB_PASTE_CELL","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_CELL_INSERT]=["",ID_RES_CONST_STRING_PASTE_CELL_INSERT,"TB_PASTE_CELL_INSERT","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_CELL_OVER_ALL]=["",ID_RES_CONST_STRING_PASTE_CELL_OVER_ALL,"TB_PASTE_CELL_OVER_ALL","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_CELL_OVER_CONTENT]=["",ID_RES_CONST_STRING_PASTE_CELL_OVER_CONTENT,
"TB_PASTE_CELL_OVER_CONTENT","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_CONVERT_ELE_TO_IMG]=["",ID_RES_CONST_STRING_CONVERT_ELE_TO_IMG,"TB_CONVERT_ELE_TO_IMG","fnHandler_ConvertEleToImg",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_INSERT]=["",ID_RES_TOOL_STRING_MENU_INSERT,"TB_TABLE_CELL_INSERT","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TABLE_CELL_DELETE]=["",ID_RES_CONST_BTN_DELETE,"TB_TABLE_CELL_DELETE","fnHandler_dummy",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIDEO_BORDER_TYPE]=["",ID_RES_CONST_STRING_BORDER_TYPE,"TB_VIDEO_BORDER_TYPE","fnHandler_VideoBorderType",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_VIDEO_BORDER_THICKNESS]=["",ID_RES_CONST_STRING_BORDER_THICKNESS,
"TB_VIDEO_BORDER_THICKNESS","fnHandler_VideoBorderThickness",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_VIDEO_BORDER_COLOR]=["",ID_RES_CONST_STRING_BORDER_COLOR,"TB_SETVIDEOBORDERCOLOR","fnHandler_VideoBorderColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_VIDEO_HEIGHT]=["",ID_RES_DIALOG_STRING_HEIGHT,"TB_VIDEO_HEIGHT","fnHandler_TBSetVideoHeight",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"];g_arrConst[ID_COMMAND_VIDEO_WIDTH]=["",ID_RES_DIALOG_STRING_WIDTH,"TB_VIDEO_WIDTH","fnHandler_TBSetVideoWidth",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,1E4,1,2,10,"px"];g_arrConst[ID_COMMAND_VIDEO_RESET_PROPERTY]=["",ID_RES_CONST_STRING_RESET_PICTURE,"TB_VIDEO_RESET_PICTURE","fnHandler_VideoResetPicture",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SLIDE_SHOW]=
["",ID_RES_CONST_STRING_SLIDE_SHOW,"TB_SLIDE_SHOW","fnHandler_slideShow",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DOCUMENT_SECURITY_SETTING]=["",ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING,"TB_DOCUMENT_SECURITY_SETTING","fnHandler_DocumentSecuritySetting",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_REPLACE]=["",ID_RES_CONST_STRING_IMAGE_REPLACE,"TB_IMAGE_REPLACE","fnHandler_replaceImage",
ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_IMAGE_SAVEAS]=["",ID_RES_CONST_STRING_IMAGE_SAVEAS,"TB_IMAGE_SAVEAS","fnHandler_saveAsImage",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ONEFFICE_CONNECT]=["",ID_RES_CONST_STRING_ONEFFICE_CONNECT,"TB_ONEFFICE_CONNECT","fnHandler_onefficeConnect",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DOWNLOAD_PDF]=
["",ID_RES_CONST_STRING_DOWNLOAD_PDF,"TB_FILE_DOWNLOAD_PDF","fnHandler_downloadPdf",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_GET_REMOTE_SITE_CONTENT]=["",ID_RES_CONST_STRING_GET_REMOTE_SITE_CONTENT,"TB_GET_REMOTE_SITE_CONTENT","fnHandler_getRemoteSiteContent",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DOC_SECURE_GRADE]=["",ID_RES_CONST_STRING_DOC_SECURE_GRADE,"TB_DOC_SECURE_GRADE",
"fnHandler_setSecureGrade",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SHARE_FAX]=["",ID_RES_CONST_STRING_SHARE_FAX,"TB_SHARE_FAX","fnHandler_shareFax",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LOCK_EDIT_CELL]=["",ID_RES_CONST_STRING_TABLE_LOCK_EDIT_CELL,"TB_TABLE_CELL_STYLE","fnHandler_table_lock_edit_cell",ID_SUPPORT_TYPE_TABLE_OPERATION,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_PROTECT_PRIVACY]=["",ID_RES_CONST_STRING_PROTECT_PRIVACY,"TB_PROTECT_PRIVACY","fnHandler_protect_privacy",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DOCUMENT_HISTORY]=["",ID_RES_CONST_PANEL_TITLE_DOC_INFO,"TB_FILE_DOCUMENT_HISTORY","fnHandler_showDocumentHistory",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DISABLE_PRIVACY]=["",ID_RES_CONST_STRING_DISABLE_PRIVACY,
"TB_DISABLE_PRIVACY","fnHandler_disable_privacy",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HEADER]=["Header",ID_RES_CONST_STRING_HEADER,"TB_HEADER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_FOOTER]=["Footer",ID_RES_CONST_STRING_FOOTER,"TB_FOOTER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_EDIT_HEADER]=
["EditHeader",ID_RES_CONST_STRING_EDIT_HEADER,"TB_EDIT_HEADER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EDIT_FOOTER]=["EditFooter",ID_RES_CONST_STRING_EDIT_FOOTER,"TB_EDIT_FOOTER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EDIT_BODY]=["EditBody",ID_RES_ADJUST_VIEW_CLOSE,"TB_EDIT_BODY","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_REMOVE_HEADER]=["RemoveHeader",ID_RES_CONST_STRING_REMOVE_HEADER,"TB_REMOVE_HEADER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_REMOVE_FOOTER]=["RemoveFooter",ID_RES_CONST_STRING_REMOVE_FOOTER,"TB_REMOVE_FOOTER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_JUMP_TO_PREVIOUS_HEADER_FOOTER]=
["JumpToPreviousHeaderFooter",ID_RES_CONST_STRING_PREV,"TB_JUMP_TO_PREVIOUS_HEADER_FOOTER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_JUMP_TO_NEXT_HEADER_FOOTER]=["JumpToNextHeaderFooter",ID_RES_CONST_STRING_NEXT,"TB_JUMP_TO_NEXT_HEADER_FOOTER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HEADER_FOOTER_OPTIONS]=["HeaderFooterOptions",ID_RES_CONST_STRING_OPTIONS,
"TB_HEADER_FOOTER_OPTIONS","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_FIRST_PAGE]=["DifferentFirstPage",ID_RES_CONST_STRING_DIFFERENT_FIRST_PAGE,"TB_HEADER_FOOTER_OPTION_DIFF_FIRST_PAGE","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_ODD_EVEN_PAGES]=["DifferentOddEvenPages",ID_RES_CONST_STRING_DIFFERENT_ODD_EVEN_PAGES,
"TB_HEADER_FOOTER_OPTION_DIFF_ODD_EVEN_PAGES","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HEADER_FOOTER_OPTION_SHOW_DOCUMENT_TEXT]=["ShowDocumentText",ID_RES_CONST_STRING_SHOW_DOCUMENT_TEXT,"TB_HEADER_FOOTER_OPTION_SHOW_DOCUMENT_TEXT","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HEADER_MARGIN_FROM_TOP]=["HeaderMarginFromTop",ID_RES_CONST_STRING_HEADER_MARGIN_FROM_TOP,
"TB_HEADER_MARGIN_FROM_TOP","fnHandler_HeaderFooter_Margin",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,13,0,.1,0,"cm"];g_arrConst[ID_COMMAND_FOOTER_MARGIN_FROM_BOTTOM]=["FooterMarginFromBottom",ID_RES_CONST_STRING_FOOTER_MARGIN_FROM_BOTTOM,"TB_FOOTER_MARGIN_FROM_BOTTOM","fnHandler_HeaderFooter_Margin",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,13,0,.1,0,"cm"];g_arrConst[ID_COMMAND_DELETE_IMAGE]=["DeleteImage",ID_RES_CONST_STRING_DELETE_IMAGE,
"TB_DELETE_IMAGE","fnHandler_DeleteImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DELETE_VIDEO]=["DeleteVideo",ID_RES_CONST_STRING_DELETE_VIDEO,"TB_DELETE_VIDEO","fnHandler_DeleteVideo",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HELP_ONLINE]=["",ID_RES_CONST_STRING_HELP_ONLINE,"","fnHandler_Help_Online",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING];
g_arrConst[ID_COMMAND_FILE_SAVE_REMOTE2]=["",ID_RES_CONST_STRING_SAVE_REMOTE,"TB_FILE_SAVE_REMOTE2","fnHandler_SaveFileRemote",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PRINT2]=["",ID_RES_CONST_STRING_PRINT,"TB_PRINT2","fnHandler_Print",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_GO_TO_HEADER]=["GoHeader",ID_RES_CONST_STRING_GO_TO_HEADER,"TB_GO_TO_HEADER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_GO_TO_FOOTER]=["GoFooter",ID_RES_CONST_STRING_GO_TO_FOOTER,"TB_GO_TO_FOOTER","fnHandler_HeaderFooter",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SEND_BIZBOX_REPORT]=["",ID_RES_CONST_STRING_SEND_BIZBOX_REPORT,"TB_SEND_BIZBOX_REPORT","fnHandler_SendBizboxReport",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_UPDATE_BIZBOX_REPORT]=
["",ID_RES_CONST_STRING_UPDATE_BIZBOX_REPORT,"TB_UPDATE_BIZBOX_REPORT","fnHandler_UpdateBizboxReport",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SHAPES_INSERT]=["ShapesInsert",ID_RES_CONST_STRING_SHAPES,"TB_INSERT_SHAPE","fnHandler_InsertShapes",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_FORMAT]=[ID_RES_CONST_STRING_SHAPES_FORMAT,ID_RES_CONST_STRING_SHAPES_FORMAT,"TB_SHAPE_FORMAT",
"fnHandler_showShapesPanel",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SHAPES_CHANGE]=["ShapesChange",ID_RES_CONST_STRING_SHAPES_CHANGE,"TB_SHAPE_CHANGE","fnHandler_InsertShapes",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_STYLE]=["ShapesStyle",ID_RES_CONST_STRING_SHAPES_STYLE,"TB_SHAPE_STYLE","fnHandler_ShapeStyle",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];
g_arrConst[ID_COMMAND_SHAPES_FILL]=["ShapesFaceColor",ID_RES_CONST_STRING_SHAPES_FILL,"TB_SHAPEFILLCOLOR","fnHandler_ShapeFillColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_BORDER]=["ShapesBorderColor",ID_RES_CONST_STRING_SHAPES_BORDER,"TB_SHAPELINECOLOR","fnHandler_ShapeBorderColor",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_TEXT_VERTICAL_ALIGN]=["",ID_RES_CONST_STRING_SHAPES_TEXT_ALIGN,
"TB_OBJECT_TXT_VALIGN","fnHandler_ObjTxtVAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_LAYOUT]=["",ID_RES_CONST_STRING_SHAPES_LAYOUT,"TB_TXT_LAYOUT","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_MOVE_FRONT]=["",ID_RES_CONST_STRING_SHAPES_MOVE_FRONT,"TB_MOVE_FRONT","fnHandler_BringForwardList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];
g_arrConst[ID_COMMAND_SHAPES_MOVE_BACK]=["",ID_RES_CONST_STRING_SHAPES_MOVE_BACK,"TB_MOVE_BACK","fnHandler_SendBackwardList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_ALIGN]=["",ID_RES_CONST_STRING_SHAPES_ALIGN,"TB_OBJECT_ALGIN","fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_SHAPES_ROTATE]=["",ID_RES_CONST_STRING_SHAPES_ROTATE,"TB_OBJECT_ROTATE","fnHandler_ObjRotationList",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_BRING_FORWARD]=["",ID_RES_CONST_STRING_SHAPES_MOVE_FRONT,"TB_OBJECT_ORDER1","fnHandler_BringForward",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_BRING_TO_FRONT]=["",ID_RES_CONST_STRING_SHAPES_MOVE_FRONT_EDGE,"TB_OBJECT_ORDER2","fnHandler_BringToFront",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SEND_BACKWARD]=
["",ID_RES_CONST_STRING_SHAPES_MOVE_BACK,"TB_OBJECT_ORDER3","fnHandler_SendBackward",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SEND_TO_BACK]=["",ID_RES_CONST_STRING_SHAPES_MOVE_BACK_EDGE,"TB_OBJECT_ORDER4","fnHandler_SendToBack",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_TXT_VALIGN_TOP]=["",ID_RES_CONST_STRING_OBJ_TXT_VALIGN_TOP,"TB_OBJECT_TXT_VALIGN1","fnHandler_ObjTxtVAlign",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_TXT_VALIGN_MIDDLE]=["",ID_RES_CONST_STRING_OBJ_TXT_VALIGN_MIDDLE,"TB_OBJECT_TXT_VALIGN2","fnHandler_ObjTxtVAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_TXT_VALIGN_BOTTOM]=["",ID_RES_CONST_STRING_OBJ_TXT_VALIGN_BOTTOM,"TB_OBJECT_TXT_VALIGN3","fnHandler_ObjTxtVAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_ALIGN_LEFT]=
["",ID_RES_CONST_STRING_JUSTIFYLEFT,"TB_OBJECT_ALGIN1","fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_ALIGN_CENTER]=["",ID_RES_CONST_STRING_JUSTIFYCENTER,"TB_OBJECT_ALGIN2","fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_ALIGN_RIGHT]=["",ID_RES_CONST_STRING_JUSTIFYRIGHT,"TB_OBJECT_ALGIN3","fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_ALIGN_TOP]=["",ID_RES_CONST_STRING_OBJ_ALIGN_TOP,"TB_OBJECT_ALGIN4","fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_ALIGN_MIDDLE]=["",ID_RES_CONST_STRING_OBJ_ALIGN_MIDDLE,"TB_OBJECT_ALGIN5","fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_OBJ_ALIGN_BOTTOM]=["",ID_RES_CONST_STRING_OBJ_ALIGN_BOTTOM,"TB_OBJECT_ALGIN6",
"fnHandler_ObjAlign",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ROTATE_RIGHT_90]=["",ID_RES_CONST_STRING_OBJ_ROTATE_RIGHT_90,"TB_OBJECT_ROTATE1","fnHandler_ObjRotationList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ROTATE_LEFT_90]=["",ID_RES_CONST_STRING_OBJ_ROTATE_LEFT_90,"TB_OBJECT_ROTATE2","fnHandler_ObjRotationList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_ROTATE_FLIP_VERTICAL]=["",ID_RES_CONST_STRING_OBJ_ROTATE_FLIP_VERTICAL,"TB_OBJECT_ROTATE3","fnHandler_ObjRotationList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ROTATE_FLIP_HORIZONTAL]=["",ID_RES_CONST_STRING_OBJ_ROTATE_FLIP_HORIZONTAL,"TB_OBJECT_ROTATE4","fnHandler_ObjRotationList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_ROTATE_OTHERS]=[ID_RES_CONST_STRING_OBJ_ROTATE_OTHERS,
ID_RES_CONST_STRING_OBJ_ROTATE_OTHERS,"TB_OBJECT_ROTATE5","fnHandler_ObjRotationList",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_IN_LINE_WITH_TEXT]=["",ID_RES_CONST_STRING_TXTLAYOUT_IN_LINE_WIDTH_TEXT,"TB_TXT_LAYOUT1","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_SQUARE]=["",ID_RES_CONST_STRING_TXTLAYOUT_SQUARE,"TB_TXT_LAYOUT2","fnHandler_ObjTxtLayout",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_TIGHT]=["",ID_RES_CONST_STRING_TXTLAYOUT_TIGHT,"TB_TXT_LAYOUT3","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_THROUGH]=["",ID_RES_CONST_STRING_TXTLAYOUT_THROUGH,"TB_TXT_LAYOUT4","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_TOP_AND_BOTTOM]=
["",ID_RES_CONST_STRING_TXTLAYOUT_TOPANDBOTTOM,"TB_TXT_LAYOUT5","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_BEHIND_TEXT]=["",ID_RES_CONST_STRING_TXTLAYOUT_BEHIND_TEXT,"TB_TXT_LAYOUT6","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_IN_FRONT_OF_TEXT]=["",ID_RES_CONST_STRING_TXTLAYOUT_IN_FRONT_OF_TEXT,"TB_TXT_LAYOUT7","fnHandler_ObjTxtLayout",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_LEFT_TEXT]=["",ID_RES_CONST_STRING_TXTLAYOUT_LEFT_TEXT,"TB_TXT_LAYOUT8","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_RIGHT_TEXT]=["",ID_RES_CONST_STRING_TXTLAYOUT_RIGHT_TEXT,"TB_TXT_LAYOUT9","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TXTLAYOUT_OTHERS]=
[ID_RES_CONST_STRING_TXTLAYOUT_OTHERS,ID_RES_CONST_STRING_TXTLAYOUT_OTHERS,"TB_TXT_LAYOUT10","fnHandler_ObjTxtLayout",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW]=["",ID_RES_CONST_STRING_ARROW,"TB_LINE_ARROW","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW_NONE]=["",ID_RES_CONST_STRING_ARROW_NONE,"TB_LINE_ARROW_NONE","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW1]=["",ID_RES_CONST_STRING_ARROW1,"TB_LINE_ARROW1","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW2]=["",ID_RES_CONST_STRING_ARROW2,"TB_LINE_ARROW2","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW3]=["",ID_RES_CONST_STRING_ARROW3,"TB_LINE_ARROW3","fnHandler_Arrow",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW4]=["",ID_RES_CONST_STRING_ARROW4,"TB_LINE_ARROW4","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW5]=["",ID_RES_CONST_STRING_ARROW5,"TB_LINE_ARROW5","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW6]=["",ID_RES_CONST_STRING_ARROW6,"TB_LINE_ARROW6",
"fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW7]=["",ID_RES_CONST_STRING_ARROW7,"TB_LINE_ARROW7","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW8]=["",ID_RES_CONST_STRING_ARROW8,"TB_LINE_ARROW8","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW9]=["",ID_RES_CONST_STRING_ARROW9,
"TB_LINE_ARROW9","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LINE_ARROW10]=["",ID_RES_CONST_STRING_ARROW10,"TB_LINE_ARROW10","fnHandler_Arrow",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_GET_BIZBOX_REPORT_LIST]=["",ID_RES_CONST_STRING_GET_BIZBOX_REPORT_LIST,"TB_GET_BIZBOX_REPORT_LIST","fnHandler_getBizboxReportList",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_ADD_TEXT]=["",ID_RES_CONST_STRING_SHAPES_ADD_TEXT,"TB_ADD_TEXT","fnHandler_AddText",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_FIXED_RATIO]=["",ID_RES_CONST_STRING_FIXED_RATIO,"TB_FIXED_RATIO","fnHandler_toggleFixedRatio",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PRIVACY_CHANGE_PASSWORD]=["",ID_RES_CONST_STRING_CHANGE_PROTECT_PASSWORD,"TB_PRIVACY_CHANGE_PASSWORD","fnHandler_privacyChangePassword",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MODIFY_CHART_TYPE]=["",ID_RES_CONST_STRING_MODIFY_CHART_TYPE,"TB_MODIFY_CHART_TYPE","fnHandler_ModifychartTypePanel",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_NEW_PAGE]=["insertNewPage",ID_RES_CONST_STRING_INSERT_NEW_PAGE,"TB_INSERT_NEW_PAGE","fnHandler_InsertNewPage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];
g_arrConst[ID_COMMAND_INSERT_NEW_PAGE_ABOVE]=["",ID_RES_CONST_STRING_ABOVE_PAGE,"TB_INSERT_PAGE_ABOVE","fnHandler_InsertNewPage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_NEW_PAGE_BELOW]=["",ID_RES_CONST_STRING_BELOW_PAGE,"TB_INSERT_PAGE_BELOW","fnHandler_InsertNewPage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_EMPTY_PAGE]=["insertEmptyPage",ID_RES_CONST_STRING_INSERT_EMPTY_PAGE,
"TB_INSERT_EMPTY_PAGE","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_COPY_PAGE]=["copyPage",ID_RES_CONST_STRING_COPY_PAGE,"TB_COPY_PAGE","fnHandler_CopyPage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_PAGE]=["pastePage",ID_RES_CONST_STRING_PASTE_PAGE,"TB_PASTE_PAGE","",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_PAGE_ABOVE]=["",
ID_RES_CONST_STRING_ABOVE_PAGE,"TB_PASTE_PAGE_ABOVE","fnHandler_PastePage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_PAGE_BELOW]=["",ID_RES_CONST_STRING_BELOW_PAGE,"TB_PASTE_PAGE_BELOW","fnHandler_PastePage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DELETE_PAGE]=["deletePage",ID_RES_CONST_STRING_DELETE_PAGE,"TB_DELETE_PAGE","fnHandler_DeletePage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_INSERT_INPUTBOX]=["",ID_RES_CONST_STRING_EXTERNAL_BOX,"TB_INSERT_INPUTBOX","fnHandler_insertInputBox",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SEND_REPORT_FORM]=["","\uc591\uc2dd \ubcf4\ub0b4\uae30","TB_SEND_REPORT_FORM","fnHandler_sendReportForm",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_GET_EXTERNAL_DATA]=["","\uc591\uc2dd \ub370\uc774\ud130",
"TB_GET_EXTERNAL_DATA","fnHandler_showExternalDataDialog",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HELP_ONEFFICE_FAQ]=["","ONEFFICE FAQ","","fnHandler_Help_FAQ",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING];g_arrConst[ID_COMMAND_INSERT_QRCODE]=["",ID_RES_CONST_STRING_INSERT_QRCODE,"TB_INSERT_QRCODE","fnHandler_InsertQRCode",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_COMMENT_PANEL]=["",ID_RES_CONST_PANEL_TITLE_DOC_COMMENT,"TB_COMMENT_PANEL","fnHandler_showCommentPanel",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SLIDE_CURRENT_SHOW]=["",ID_RES_CONST_STRING_CURRENT_SLIDE_SHOW,"TB_SLIDE_CURRENT_SHOW","fnHandler_slideShow",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_ZOOM]=["",ID_RES_CONST_STRING_ZOOM_INOUT,"TB_VIEW_ZOOM","fnHandler_view_zoom",
ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_100_ALIGN]=["",ID_RES_CONST_STRING_TOOLBAR_100,"TB_VIEW_ZOOM_100","fnHandler_view_zoom",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_WIDTH_ALIGN]=["",ID_RES_CONST_SLIDESHOW_ZOOM_WIDTH,"TB_VIEW_ZOOM_WIDTH","fnHandler_view_zoom",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_VIEW_HEIGHT_ALIGN]=
["",ID_RES_CONST_SLIDESHOW_ZOOM_HEIGHT,"TB_VIEW_ZOOM_HEIGHT","fnHandler_view_zoom",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MODIFY_CHART_ATTR]=["",ID_RES_CONST_PANEL_TITLE_DOC_CHART,"TB_MODIFY_CHART_ATTR","fnHandler_chartAttrPanel",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MODIFY_CHART_DATA]=["",ID_RES_CONST_STRING_MODIFY_CHART_DATA,"TB_MODIFY_CHART_DATA","fnHandler_ModifychartDataPanel",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PGNUM]=["pgnum",ID_RES_CONST_STRING_PGNUM,"TB_PGNUM","fnHandler_PageNumber",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_PGNUM_FORMAT]=["",ID_RES_CONST_STRING_PGNUM_FORMAT,"TB_PGNUM_FORMAT","fnHandler_PageNumber",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PGNUM_REMOVE]=["",ID_RES_CONST_STRING_PGNUM_REMOVE,
"TB_PGNUM_REMOVE","fnHandler_PageNumber",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PGNUM_TEMPLATE_UP]=["",ID_RES_PROP_TAG_STRING_TOP,"TB_PGNUM_TEMPLATE_UP","fnHandler_PageNumber",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PGNUM_TEMPLATE_DOWN]=["",ID_RES_PROP_TAG_STRING_BOTTOM,"TB_PGNUM_TEMPLATE_DOWN","fnHandler_PageNumber",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_OVERWRITE_ORG_DOC]=["",ID_RES_CONST_STRING_OVERWRITE_ORG_DOC,"TB_OVERWRITE_ORG_DOC","fnHandler_OverwriteTempDocToOrgDoc",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_DELETE_TEMP_DOC]=["",ID_RES_CONST_STRING_DELETE_DOC,"TB_DELETE_TEMP_DOC","fnHandler_DeleteTempDoc",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE]=["",ID_RES_STRING_PASTE_CELL_INSERT_AS_TABLE,
"TB_PASTE_CELL_INSERT_AS_TABLE","fnHandler_PasteCell",ID_SUPPORT_TYPE_MULTI_CELL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_REGIST_SCHEDULE]=["",ID_RES_CONST_STRING_REGIST_SCHEDULE,"TB_REGIST_SCHEDULE","fnHandler_RegistSchedule",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_EDIT_WATERMARK]=["",ID_RES_STRING_EDIT_WATERMARK,"TB_EDIT_WARTERMARK","fnHandler_WaterMark",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_IMAGE_CROPPER]=["",ID_RES_CONST_STRING_IMAGE_CROPPER,"TB_IMAGE_CROPPER","fnHandler_imageCropper",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_LAYOUT_TABLE]=["",ID_RES_STRING_LAYOUT_TABLE,"TB_LAYOUT_TABLE","fnHandler_LayoutTable",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_TEXT_COUNT]=["","\uae00\uc790 \uc218 \ud655\uc778","TB_TEXT_COUNT","fnHandler_getTextCount",ID_SUPPORT_TYPE_GENERAL,
ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_HELP_ONEFFICE_VOC]=["","ONEFFICE "+ID_RES_STRING_VOC,"","fnHandler_Help_VOC",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_INDEPENDENT,ID_TYPE_TOOLBAR_NOTHING];g_arrConst[ID_COMMAND_GOBACK_ORG_DOC]=["",ID_RES_CONST_STRING_RETURN_TO_ORIGIN_DOC,"TB_GOBACK_ORG_DOC","fnHandler_goBackOrgDoc",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SHAPE_HEIGHT]=["",ID_RES_DIALOG_STRING_HEIGHT,
"TB_SHAPE_HEIGHT","fnHandler_TBSetObjectHeight",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,100,0,.1,1,"cm"];g_arrConst[ID_COMMAND_SHAPE_WIDTH]=["",ID_RES_DIALOG_STRING_WIDTH,"TB_SHAPE_WIDTH","fnHandler_TBSetObjectWidth",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_SPINNER,100,0,.1,1,"cm"];g_arrConst[ID_COMMAND_INSERT_NEWS]=["",ID_RES_STRING_GET_NEWS_LIST,"TB_INSERT_NEWS","fnHandler_insertNews",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,
ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_POST_NEWS]=["",ID_RES_STRING_POST_NEWS,"TB_POST_NEWS","fnHandler_postNews",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_GET_CLOUD_IMAGE]=["",ID_RES_STRING_GET_CLOUD_IMAGE,"TB_GET_CLOUD_IMAGE","fnHandler_getCloudImage",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_POST_IMAGE]=["",ID_RES_STRING_POST_IMAGE,"TB_POST_IMAGE","fnHandler_postImage",ID_SUPPORT_TYPE_PERSISTENCE,
ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SET_IMAGE_INFO]=["",ID_RES_STRING_SET_IMAGE_INFO,"TB_POST_IMAGE","fnHandler_postImage",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_STYLE_TEMPLATE]=["",ID_RES_CONST_STRING_STYLE_STYLE,"TB_STYLE_TEMPLATE","fnHandler_setStyleTemplate",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_GALLERY];g_arrConst[ID_COMMAND_STYLE_TEMPLATE_COMBO]=["styleTemplate",
ID_RES_CONST_STRING_STYLE_STYLE,"TB_STYLE_TEMPLATE_COMBO","fnHandler_setStyleTemplate_Combo",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_COMBOBOX];g_arrConst[ID_COMMAND_INSERT_FORM_CONTROL]=["",ID_RES_STRING_INSERT_FORM_CONTROL,"TB_INSERT_FORM_CONTROL","fnHandler_insertFormControl",ID_SUPPORT_TYPE_PERSISTENCE,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_DROPDOWN];g_arrConst[ID_COMMAND_FORM_TAG_RADIO]=["",ID_RES_STRING_FORM_TAG_RADIO,"TB_FORM_TAG_RADIO","fnHandler_Radio",
ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SET_LIST_START_NEW]=["",ID_RES_STRING_SET_LIST_START_NEW,"TB_SET_LIST_START_NEW","fnHandler_ListStartNew",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_SET_LIST_START_CONTINUE]=["",ID_RES_STRING_SET_LIST_START_CONTINUE,"TB_SET_LIST_START_CONTINUE","fnHandler_ListStartContinue",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_YES,ID_TYPE_TOOLBAR_BUTTON];
g_arrConst[ID_COMMAND_NEWS_SEND_INFO]=["",ID_RES_STRING_NEWS_SEND_INFO,"TB_NEWS_SEND_INFO","fnHandler_showNewsSendInfoPanel",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst[ID_COMMAND_MEMO]=["",ID_RES_STRING_ETC_MEMO,"TB_MEMO","fnHandler_RPanel_Memo",ID_SUPPORT_TYPE_GENERAL,ID_SUPPORT_CONTROL_TYPE_NO,ID_TYPE_TOOLBAR_BUTTON];g_arrConst_TabMode[0]=[ID_TB_TABMODE_PREVIEW,"fnTool_TabMode_Preview"];g_arrConst_TabMode[1]=[ID_TB_TABMODE_EDIT,"fnTool_TabMode"];g_arrConst_TabMode[2]=
[ID_TB_TABMODE_SOURCE,"fnTool_TabMode"]}catch(c){dalert(c)}}var ID_COMMAND_MENU_TABLE_INDEX=5;function setInitUpdateVariable(a){try{g_TBButton[a]=[],g_TBComboBox[a]=[],g_TBComboBoxLabel[a]=[],g_TBDropDown[a]=[],g_objMenuWin.arrTBMenu[a]=[],g_TBTabMode[a]=[],g_bEditMode[a]=!0}catch(b){}};
var duzon_http={createRequest:function(){var a=null;try{try{a=new XMLHttpRequest}catch(b){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){}}}null==a&&alert("Request Error! Please Retry!");return a}catch(b){return a}},loading_screen:!0,loading_image_url:g_dzEditorBasePath+"image/loading-image.gif",loading_image_size:[48,48],ajax:function(a){try{var b=this.createRequest();if("undefined"!=typeof b&&null!=b){var d="undefined"!=typeof a.type?a.type.toLowerCase():
"post",c=a.url,g="undefined"!=typeof a.async?a.async:!0,f="undefined"!=typeof a.dataType?a.dataType:"html",e="undefined"!=typeof a.data?a.data:{},k="undefined"!=typeof a.success?a.success:function(){},l="undefined"!=typeof a.error?a.error:function(){},t="undefined"!=typeof a.timeout&&0<a.timeout?a.timeout:1E4;"undefined"!=typeof a.loading_screen&&(this.loading_screen=a.loading_screen);"undefined"!=typeof a.loading_image_size&&a.loading_image_size.length&&(this.loading_image_size=a.loading_image_size);
var m="undefined"!=typeof a.bShowLoading?a.bShowLoading:!0,n="undefined"!=typeof FormData&&e instanceof FormData,h=null;if(n)h=e;else if("object"===typeof e){a=[];for(var p in e)a.push(p+"="+encodeURIComponent(e[p]));h=a.join("&");"get"==d&&""!=h&&(c=0<c.indexOf("news_list")||0<c.indexOf("post_article")||0<c.indexOf("media_list")||0<c.indexOf("media_register")?c+("?"+h):c+("?"+encodeURI(h)))}else h=e,0<c.indexOf("getEmpMentionList")&&(c+="?"+h);try{if("get"==d){var q=(new Date).getTime();c=0<=c.indexOf("?")?
c+("&_t="+q):c+("?_t="+q)}}catch(r){}duzon_http.log("url : "+c);b.open(d,c,g);n||("application/json"==f?b.setRequestHeader("Content-Type","application/json; charset=UTF-8"):"json"==f&&0==h.indexOf("{")?b.setRequestHeader("Content-Type","application/json; charset=UTF-8"):"post"==d&&b.setRequestHeader("Content-type","application/x-www-form-urlencoded"));var u=setTimeout(function(){duzon_http.log("HttpReqeust Timeout!");duzon_http.hideLoading();b.abort()},t);!0===m&&this.showLoading();b.onreadystatechange=
function(){if(4==b.readyState)if(!0===m&&duzon_http.hideLoading(),duzon_http.log("HttpReqeust Complete"),clearTimeout(u),200==b.status){duzon_http.log("HttpReqeust Result : Success");var a="xml"==f?b.responseXML:b.responseText;duzon_http.log("response dataType:"+typeof a);if("json"==f){var c=duzon_http.parseJSON(a);a=null!==c?c:a}k(a)}else duzon_http.log("HttpReqeust Result : Fail"),l({status:b.status,msg:"response error"})};g_browserCHK.mobile?setTimeout(function(){"post"==d?b.send(h):b.send()},
270):"post"==d?b.send(h):b.send()}}catch(r){duzon_http.error("ajax error:",r)}},ajaxJSON:function(a,b,d){try{var c=d&&"undefined"!=typeof d.success?d.success:function(){},g=d&&"undefined"!=typeof d.error?d.error:function(){},f=d&&"undefined"!=typeof d.timeout&&0<d.timeout?d.timeout:1E4,e=this.createRequest();if("undefined"!=typeof e&&null!=e){e.open("POST",a,!0);var k=setTimeout(function(){try{duzon_http.hideLoading(),e.abort(),dlog("request timeout")}catch(l){}},f);this.showLoading();e.onreadystatechange=
function(){if(4==e.readyState)if(duzon_http.hideLoading(),duzon_http.log("HttpReqeust Complete"),clearTimeout(k),200==e.status){duzon_http.log("HttpReqeust Result : Success");var a=duzon_http.parseJSON(e.responseText);c(a)}else duzon_http.log("HttpReqeust Result : Fail"),g({status:e.status,msg:"response error"})};e.onerror=function(){clearTimeout(k);dlog("request Error")};e.setRequestHeader("Content-type","application/json; charset=UTF-8");e.send(JSON.stringify(b))}}catch(l){duzon_http.error("ajaxJSON error:",
l)}},beacon:function(a){try{var b=a.url,d="undefined"!=typeof a.dataType?a.dataType:"html",c="undefined"!=typeof a.data?a.data:{},g="undefined"!=typeof FormData&&c instanceof FormData;!0===("undefined"!=typeof a.bShowLoading?a.bShowLoading:!0)&&duzon_http.hideLoading();if(!g&&"object"===typeof c){a=[];for(var f in c)a.push(f+"="+encodeURIComponent(c[f]));c=a.join("&")}g||(c="application/json"==d?new Blob([c],{type:"application/json; charset=UTF-8"}):"json"==d&&0==c.indexOf("{")?new Blob([c],{type:"application/json; charset=UTF-8"}):
new Blob([c],{type:"application/x-www-form-urlencoded"}));return navigator.sendBeacon(b,c)}catch(e){duzon_http.error("beacon error:",e)}},readFile:function(a,b){try{var d=b&&"undefined"!=typeof b.success?b.success:function(){},c=b&&"undefined"!=typeof b.error?b.error:function(){},g=b&&"undefined"!=typeof b.timeout&&0<b.timeout?b.timeout:1E4,f=this.createRequest();if("undefined"!=typeof f&&null!=f){f.open("GET",a,!0);var e=setTimeout(function(){try{duzon_http.hideLoading(),f.abort(),dlog("request timeout")}catch(k){}},
g);this.showLoading();f.onreadystatechange=function(){4===f.readyState&&(duzon_http.hideLoading(),duzon_http.log("HttpReqeust Complete"),clearTimeout(e),200===f.status||0==f.status?(duzon_http.log("HttpReqeust Result : Success"),d(f.responseText)):(duzon_http.log("HttpReqeust Result : Fail"),c({status:f.status,msg:"response error"})))};f.onerror=function(){clearTimeout(e);dlog("request Error")};f.send(null)}}catch(k){duzon_http.error("readFile error:",k)}},parseJSON:function(a){try{return"object"===
typeof a?a:JSON.parse(a)}catch(b){try{return eval("("+a+")")}catch(d){return duzon_http.error("Json Parsing error:",d),{}}}},loading_images:[g_dzEditorBasePath+"image/oneffice_loading_00.gif",g_dzEditorBasePath+"image/oneffice_loading_01.gif",g_dzEditorBasePath+"image/oneffice_loading_02.gif",g_dzEditorBasePath+"image/oneffice_loading_03.gif",g_dzEditorBasePath+"image/oneffice_loading_04.gif",g_dzEditorBasePath+"image/oneffice_loading_05.gif"],getRandomLoadingImage:function(){return this.loading_images[Math.floor(Math.random()*
this.loading_images.length)]},loadingScreenObj:null,loadingImageObj:null,loadingImageTimer:null,loadingImageCnt:0,showLoading:function(a){try{if(!0===this.loading_screen){this.loadingScreenObj=g_objLayerKit.getLayerDocument().getElementById("dze_idx_loading_screen_obj");null==this.loadingScreenObj&&(this.loadingScreenObj=g_objLayerKit.getLayerDocument().createElement("div"),this.loadingScreenObj.id="dze_idx_loading_screen_obj",this.loadingScreenObj.style.position="absolute",this.loadingScreenObj.style.left=
"0",this.loadingScreenObj.style.top="0",this.loadingScreenObj.style.width="100%",this.loadingScreenObj.style.height="100%",this.loadingScreenObj.style.backgroundColor="gray",this.loadingScreenObj.style.opacity="0",this.loadingScreenObj.style.zIndex="30001",g_objLayerKit.getLayerDocument().body.appendChild(this.loadingScreenObj));null!=duzon_http.loadingImageTimer&&(cleaarTimeout(duzon_http.loadingImageTimer),duzon_http.loadingImageTimer=null);this.loadingScreenObj.style.display="block";this.resizeLoadingScreen();
if(g_browserCHK.mobile){this.loading_image_url=this.getRandomLoadingImage();this.loading_image_size=g_browserCHK.iPad||g_browserCHK.androidtablet?[75,75]:[150,150];var b=onefficeUtil.getRequestParameter("hybrid");b&&"hApp"==b&&(this.loading_image_size=[this.loading_image_size[0]/2,this.loading_image_size[1]/2])}""!=this.loading_image_url&&(this.loadingImageObj=g_objLayerKit.getLayerDocument().getElementById("dze_idx_loading_image_obj"),null==this.loadingImageObj&&(this.loadingImageObj=g_objLayerKit.getLayerDocument().createElement("div"),
this.loadingImageObj.id="dze_idx_loading_image_obj",this.loadingImageObj.style.backgroundImage="url("+this.loading_image_url+")",this.loadingImageObj.style.backgroundSize="auto 100%",this.loadingImageObj.style.position="fixed",this.loadingImageObj.style.width=this.loading_image_size[0]+"px",this.loadingImageObj.style.height=this.loading_image_size[1]+"px",this.loadingImageObj.style.zIndex="30002",duzon_http.loadingImageObj.style.top="50%",duzon_http.loadingImageObj.style.left="50%",duzon_http.loadingImageObj.style.transform=
"translate(-50%, -50%)",duzon_http.loadingImageObj.style.msTransform="translate(-50%, -50%)",duzon_http.loadingImageObj.style.WebkitTransform="translate(-50%, -50%)",g_objLayerKit.getLayerDocument().body.appendChild(this.loadingImageObj)),this.loadingImageObj.style.display="block",this.setPositionLoadingImage(),this.addLoadingImageEvent());var d=!0===fnObjectCheckNull(a)?3E4:a;duzon_http.loadingImageTimer=setTimeout(function(){duzon_http.hideLoading();duzon_http.loadingImageTimer=null},d);duzon_http.loadingImageCnt++}}catch(c){}},
addLoadingImageEvent:function(){try{g_objLayerKit.getLayerWindow().attachEvent?(g_objLayerKit.getLayerWindow().attachEvent("onscroll",duzon_http.resizeLoadingScreen),g_objLayerKit.getLayerWindow().attachEvent("onresize",duzon_http.resizeLoadingScreen)):(g_objLayerKit.getLayerWindow().addEventListener("scroll",duzon_http.resizeLoadingScreen,!1),g_objLayerKit.getLayerWindow().addEventListener("resize",duzon_http.resizeLoadingScreen,!1))}catch(a){}},resizeLoadingScreen:function(){try{if(duzon_http.loadingScreenObj=
g_objLayerKit.getElementById("dze_idx_loading_screen_obj"),null!=duzon_http.loadingScreenObj&&"none"!=duzon_http.loadingScreenObj.style.display){var a=0,b=0;duzon_http.loadingScreenObj.style.width=a+"px";duzon_http.loadingScreenObj.style.height=b+"px";g_objLayerKit.getLayerDocument().documentElement.scrollWidth&&(a=g_objLayerKit.getLayerDocument().documentElement.scrollWidth);g_objLayerKit.getLayerDocument().documentElement.scrollHeight&&(b=g_objLayerKit.getLayerDocument().documentElement.scrollHeight);
g_objLayerKit.getLayerWindow().innerHeight&&g_objLayerKit.getLayerWindow().innerHeight>b&&(b=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&g_objLayerKit.getLayerDocument().documentElement.clientHeight>b&&(b=g_objLayerKit.getLayerDocument().documentElement.clientHeight);g_objLayerKit.getLayerDocument().body.scrollWidth&&g_objLayerKit.getLayerDocument().body.scrollWidth>a&&(a=g_objLayerKit.getLayerDocument().body.scrollWidth);g_objLayerKit.getLayerDocument().body.scrollHeight&&
g_objLayerKit.getLayerDocument().body.scrollHeight>b&&(b=g_objLayerKit.getLayerDocument().body.scrollHeight);duzon_http.loadingScreenObj.style.width=a+"px";duzon_http.loadingScreenObj.style.height=b+"px"}}catch(d){}},setPositionLoadingImage:function(){try{duzon_http.loadingImageObj=g_objLayerKit.getElementById("dze_idx_loading_image_obj"),null!=duzon_http.loadingImageObj&&"block"==duzon_http.loadingImageObj.style.display&&(duzon_http.loadingImageObj.style.position="fixed",duzon_http.loadingImageObj.style.top=
"50%",duzon_http.loadingImageObj.style.left="50%",duzon_http.loadingImageObj.style.transform="translate(-50%, -50%)",duzon_http.loadingImageObj.style.msTransform="translate(-50%, -50%)",duzon_http.loadingImageObj.style.WebkitTransform="translate(-50%, -50%)")}catch(a){}},hideLoading:function(){try{!0===this.loading_screen&&(this.loadingImageTimer&&clearTimeout(this.loadingImageTimer),this.loadingImageTimer=null,setTimeout(function(){duzon_http.loadingImageCnt--;if(0>=duzon_http.loadingImageCnt||null===
duzon_http.loadingImageTimer)if(duzon_http.loadingImageCnt=0,duzon_http.loadingImageTimer){try{cleaarTimeout(duzon_http.loadingImageTimer)}catch(a){}duzon_http.loadingImageTimer=null}if(0>=duzon_http.loadingImageCnt||null===duzon_http.loadingImageTimer)null!=duzon_http.loadingImageObj&&dzeJ(duzon_http.loadingImageObj).fadeOut(300),null!=duzon_http.loadingScreenObj&&(duzon_http.loadingScreenObj.style.display="none")},100))}catch(a){}},unloadLoading:function(){try{var a=this.loadingScreenObj;a&&a.parentNode&&
a.parentNode.removeChild(a);this.loadingScreenObj=null;(a=this.loadingImageObj)&&a.parentNode&&a.parentNode.removeChild(a);this.loadingImageObj=null}catch(b){dalert(b)}},checkDebuggingStatus:function(){return!0===dzeEnvConfig.bDebugging?!0:!1},error:function(a,b){if(!0===this.checkDebuggingStatus()&&"undefined"!=typeof console)try{console.error(a,b)}catch(d){}},log:function(a){if(!0===this.checkDebuggingStatus()&&"undefined"!==typeof console)try{console.log("[DZE_HTTP:"+duzon_http.getCurrTime()+"] "+
a)}catch(b){duzon_http.error("Error",b)}},getCurrTime:function(){try{var a=new Date,b=a.getFullYear(),d=a.getMonth()+1;10>d&&(d="0"+d);var c=a.getDate();10>c&&(c="0"+c);var g=a.getHours();10>g&&(g="0"+g);var f=a.getMinutes();10>f&&(f="0"+f);var e=a.getSeconds();10>e&&(e="0"+e);return""+b+"-"+d+"-"+c+" "+g+":"+f+":"+e}catch(k){return""}},getCalStrWithTime:function(a){try{var b=a.split("-"),d=b[2].split(" "),c=d[1].split(":");a="";11<parseInt(c[0])?(a=ID_RES_CONST_STRING_PM+" ",12<parseInt(c[0])&&(c[0]=
parseInt(c[0])-12)):a=ID_RES_CONST_STRING_AM+" ";return b[0]+ID_RES_CONST_STRING_YEAR+" "+b[1]+ID_RES_CONST_STRING_MONTH+" "+d[0]+ID_RES_CONST_STRING_DAY+" "+a+" "+c[0]+ID_RES_CONST_STRING_HOUR+" "+c[1]+ID_RES_CONST_STRING_MINUTE}catch(g){return""}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};
$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(m){c.reject(m)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(r){f(r)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
var g_bBrowserType_IE=!1,g_bBrowserType_FF=!1,g_bBrowserType_WK=!1,g_bBrowserType_CR=!1,g_bBrowserType_OP=!1,g_bBrowserType_EDGE=!1,g_bBrowserType_SF=!1,g_bBrowserType_DCloud=!1,g_bBrowserVerInfo=0,g_bDocType_XHTML=!1,ID_SELECTION_DUPLICATE=0,ID_SELECTION_ELEMENT_NODE=1,ID_SELECTION_ATTRIBUTE_NODE=2,ID_SELECTION_TEXT_NODE=3,ID_SELECTION_CDATA_SECTION_NODE=4,ID_SELECTION_ENTITY_REFERENCE_NODE=5,ID_SELECTION_ENTITY_NODE=6,ID_SELECTION_PROCESSING_INSTRUCTION_NODE=7,ID_SELECTION_COMMENT_NODE=8,ID_SELECTION_DOCUMENT_NODE=
9,ID_SELECTION_DOCUMENT_TYPE_NODE=10,ID_SELECTION_DOCUMENT_FRAGMENT_NODE=11,ID_SELECTION_NOTATION_NODE=12,ID_EVENT_MOUSE_CLICK_LEFT=-1,ID_EVENT_MOUSE_CLICK_LEFT_STANDARD=0,ID_EVENT_MOUSE_CLICK_RIGHT=2,g_strBrowserLanguage=null,g_objFindTextRange=null,g_nFindTextCount=0,g_strBodyBackgroundColor_Retry=[],g_strBodyBackgroundImage_Retry=[],g_strBodyBackgroundRepeat_Retry=[];
g_browserCHK.ie?(g_bBrowserType_IE=!0,g_bBrowserVerInfo=g_browserCHK.verInfo):g_browserCHK.ff?(g_bBrowserType_FF=!0,g_bBrowserVerInfo=g_browserCHK.verInfo):g_browserCHK.wk?(g_bBrowserType_WK=!0,g_browserCHK.cr&&(g_bBrowserType_CR=!0),g_browserCHK.edge&&(g_bBrowserType_EDGE=!0),g_browserCHK.sf&&(g_bBrowserType_SF=!0)):g_browserCHK.op&&(g_bBrowserType_OP=!0);function fnObjectCheckNull(a){return null==a||ID_STRING_NAME_UNDEFINED==typeof a?!0:!1}
function HTMLEncode(a){a=a.replace(/&/gi,"&amp;");a=a.replace(/</gi,"&lt;");g_bEncodeEndCharacterYN&&(a=a.replace(/>/gi,"&gt;"));return a}function HTMLDecode(a){g_bEncodeEndCharacterYN&&(a=a.replace(/&gt;/gi,">"));a=a.replace(/&lt;/gi,"<");return a=a.replace(/&amp;/gi,"&")}function TBCancelBubbleEvent(a){try{a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault&&a.preventDefault())}catch(b){dalert(b)}}
function TBCancelBubbleEvent_iFrameLayer(a){try{window.attachEvent?null!=window.parent.event&&(window.parent.event.returnValue=!1,window.parent.event.cancelBubble=!0):null!=a&&(a.returnValue=!1,a.cancelBubble=!0,a.preventDefault())}catch(b){}}function getDocumentType(){try{g_bDocType_XHTML=!(null==document.compatMode||"CSS1Compat"!=document.compatMode),ID_EVENT_MOUSE_CLICK_LEFT=window.attachEvent?1:0}catch(a){}}
function getSelectionType(){try{if(!window.attachEvent){for(var a=0,b="",c=!0,d=g_objEditWindow[g_nActiveEditNumber].getSelection(),e=d.rangeCount,f=0;f<e;f++){var g=d.getRangeAt(f).startContainer;if(c)c=!1,a=g.nodeType,b=g.nodeName;else if(a!=g.nodeType&&b!=g.nodeName)return{nodeType:ID_SELECTION_DUPLICATE,nodeName:"",length:e}}1==e&&g_objObjectSelectionInfo.bSelectObject&&(a=ID_SELECTION_ELEMENT_NODE,b=g_objObjectSelectionInfo.strNodeName);return{nodeType:a,nodeName:b,length:e}}}catch(h){}}
function getSelectionTypeForUpdateUI(){try{if(window.attachEvent)return;var a=ID_STRING_NAME_NONE,b=getSelectionType();if(ID_SELECTION_ELEMENT_NODE==b.nodeType){if(g_objObjectSelectionInfo.bSelectObject)return ID_STRING_NAME_CONTROL}else ID_SELECTION_TEXT_NODE==b.nodeType&&(a=ID_STRING_NAME_TEXT);return a}catch(c){}return ID_STRING_NAME_NONE}
function getSelectionTextValue(a){var b="";try{if(window.attachEvent)ID_STRING_NAME_TEXT==g_objEditorDocument[a].selection.type.toLowerCase()&&(b=g_objEditorDocument[a].selection.createRange().text);else{var c=g_objEditWindow[a].getSelection().getRangeAt(0);c.startContainer.nodeType==ID_SELECTION_TEXT_NODE&&(b=c.toString())}return b}catch(d){}return""}
function getSelectionElement(a,b,c){try{if(window.addEventListener){var d=g_objEditWindow[c].getSelection(),e=d.getRangeAt(0);c=null;for(var f=e.startContainer;f;){if(a==f.nodeName.toUpperCase()){c=f;break}f=f.parentNode}if(!c)return null;b&&(g_bBrowserType_FF?e.selectNode(c):(g_bBrowserType_IE||g_bBrowserType_WK||g_bBrowserType_OP)&&d.selectAllChildren(c));return c}}catch(g){}finally{}return null}
function removeSpanTab(a){for(var b=0,c=0;100>c&&void 0!=a;){c++;if(void 0!=a&&"tabSpan"===a.parentNode.className){a=a.parentNode;a.parentNode.removeChild(a);b++;break}if(void 0!=a.children&&0<a.children.length)for(var d=a.children.length;0<=d;d--){var e=a.children[d];if(void 0!=e&&"tabSpan"===e.className){a.removeChild(e);b++;c=100;break}}if(void 0!=a&&"tabSpan"===a.className){a.parentNode.removeChild(a);b++;break}if("P"===a.nodeName)break;a=a.previousSibling}return b}
function removeSpanTabSelection(a){dlog("removeSpanTabSelection nEditNumber:"+a);try{if(!window.attachEvent){var b=g_objEditWindow[a].getSelection().getRangeAt(0),c=b.startOffset;a=0;if(b.collapsed){var d=b.commonAncestorContainer;"P"===d.nodeName&&(d=d.childNodes[c-1]);a+=removeSpanTab(d)}else{var e=[],f=null;g_objNodeUtil.traverseNodesInRange(b,function(a){(a=g_objNodeUtil.getLoopParentElement(a,"p"))&&f!==a&&e.push(a);f=a});for(b=0;b<e.length;b++)a+=removeSpanTab(e[b])}return a}}catch(g){dalert(g)}finally{b=
null}}
function insertHTMLCodeAtSelection(a,b,c){try{if(window.attachEvent){var d=g_objEditorDocument[c].selection.createRange();fnObjectCheckNull(d)||d.pasteHTML(a)}else{var e=g_objEditorDocument[c],f=e?e.defaultView:null,g=f?f.getSelection():null;if(!g||1!==g.rangeCount)return;d=null;if(null!==a){d=e.createRange();var h=d.createContextualFragment(a);if(null===h)return;insertHTMLCodeAtSelection_SubDetail(h,c)}else{if(null===b)return;insertHTMLCodeAtSelection_SubDetail(b,c)}}g_objInsertUtil.saveSelectionRange_IE(0,c)}catch(k){dalert(k)}}
function objRangeTabCustom(a,b,c,d){try{a.selectNode(c),a.collapse(!1),b.removeAllRanges(),void 0===d&&(d=a),b.addRange(d)}catch(e){dalert(e)}}
function insertHTMLCodeAtSelection_SubDetail(a,b){try{if(!window.attachEvent){"tabSpan"!=a.className&&SelectionUtil.deleteSelection(b);var c=g_objEditWindow[b].getSelection(),d=c.getRangeAt(0),e=d.cloneRange(),f=d.startContainer,g=d.startOffset;11===a.nodeType&&a.firstChild===a.lastChild&&(a=a.firstChild);var h=a;11===a.nodeType&&(h=a.lastChild);if(11===a.nodeType&&!g_objNodeUtil.hasAllTextInlineChild(a)||"HR"===a.nodeName||"TABLE"===a.nodeName)return g_objInsertUtil.insertTableAtSelection(a,b);if("IMG"===
a.nodeName||11===a.nodeType&&g_objNodeUtil.isAllChild(a,function(a){return 1===a.nodeType&&"IMG"===a.nodeName})||"VIDEO"===a.nodeName||"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_video_iframe_container_span"))return g_objInsertUtil.insertImgAtSelection(a,b);if(3===f.nodeType){var k=!1,m=g_objEditMode.chkRangeLineCount(b);if("tabSpan"===a.className&&"\t"===f.data)if(0!=g&&1===m)SelectionUtil.deleteSelection(b),insertAfter(f,a),objRangeTabCustom(d,c,h);else{g_objEditMode.rangeTabInsert(b,
function(a){e=d.cloneRange();h=a;objRangeTabCustom(d,c,h,e)});k=!0;return}if(!1===k){var l=f.splitText(g);if(l){d.collapsed?(l.parentNode.insertBefore(a,l),objRangeTabCustom(d,c,h)):0!=g&&1===m?(SelectionUtil.deleteSelection(b),insertAfter(f,a),objRangeTabCustom(d,c,h)):g_objEditMode.rangeTabInsert(b,function(a){e=d.cloneRange();h=a;objRangeTabCustom(d,c,h,e)});return}f?insertAfter(f,a):dalert()}}else if(k=f.childNodes[g],fnObjectCheckNull(k))"br"==g_objNodeUtil.getElementTagName(f).toLowerCase()?
g_objNodeUtil.getParentElement(f).insertBefore(a,f):f.appendChild(a);else if("tabSpan"===a.className)if(d.collapsed)f.insertBefore(a,k);else{g_objEditMode.rangeTabInsert(b,function(a){e=d.cloneRange();h=a;objRangeTabCustom(d,c,h,e)});return}else f.insertBefore(a,k);d.selectNode(h);d.collapse(!1);c.removeAllRanges();c.addRange(d)}}catch(n){dlog(n),dalert(n)}finally{d=e=null}}
function fnReturnFalsePropagation(a){try{if(window.attachEvent)return!1;TBCancelBubbleEvent(a);a.stopPropagation()}catch(b){}}
function doCommonRestoreEditWinFF(a){try{g_bBrowserType_FF&&(g_objEditContainer[a].style.visibility="hidden",g_objEditContainer[a].style.display="none",setEditModeConversion_FF(a,!1),g_objEditSourceContainer[a].style.position="relative",g_objEditSourceContainer[a].style.left="",g_objEditSourceContainer[a].style.top="",g_objEditSourceContainer[a].style.width="",g_objEditSourceContainer[a].style.height="",g_objEditSourceContainer[a].style.visibility="visible",g_objEditSourceContainer[a].style.display=
"",g_objEditObjectSource[a].focus(),g_objEditContainer[a].style.visibility="visible",g_objEditContainer[a].style.display="",setEditModeConversion_FF(a,!0),g_objEditSourceContainer[a].style.position="absolute",g_objEditSourceContainer[a].style.left="-1000px",g_objEditSourceContainer[a].style.top="-1000px",g_objEditSourceContainer[a].style.width="0px",g_objEditSourceContainer[a].style.height="0px",g_objEditSourceContainer[a].style.visibility="hidden")}catch(b){}}
function setRestoreEditWinFF(a){try{g_bBrowserType_FF&&(doCommonRestoreEditWinFF(a),window.setTimeout("setEditModeFocus("+a+")",100))}catch(b){}}
function getSelectionControl(a){try{var b=null,c=null,d=null,e=g_objEditWindow[a].getSelection();c=e.rangeCount;a=g_objObjectSelectionInfo;a.bSelectObject&&a.objSelectionObject&&g_objNodeUtil.isAlive(a.objSelectionObject)?b=a.objSelectionObject:0<c&&(d=e.getRangeAt(0))&&d.startContainer===d.endContainer&&1===Math.abs(d.endOffset-d.startOffset)&&(b=d.startContainer.childNodes[d.startOffset]||d.startContainer);return isSVG(b)?{rangeLength:c,controlObject:b.parentNode}:{rangeLength:c,controlObject:b}}catch(f){dalert(f)}finally{}return{rangeLength:0,
controlObject:null}}
function getObjType(a,b){try{if(fnObjectCheckNull(a))return DZE_OBJ_NONE;var c=g_objNodeUtil.getCheckElementTagName(a);b=DZE_OBJ_NONE;c==DZE_TAG_IMG?b=g_objVideoControl.isVideoSpan(a.parentNode)?DZE_OBJ_VIDEO:DZE_OBJ_IMG:c==DZE_TAG_TABLE?b=DZE_OBJ_TABLE:c==DZE_TAG_TR?b=DZE_OBJ_TR:c==DZE_TAG_TD||c==DZE_TAG_TH?b=DZE_OBJ_TD:c==DZE_TAG_TEXT?b=DZE_OBJ_TEXT:c==DZE_TAG_VIDEO?b=DZE_OBJ_VIDEO:c==DZE_TAG_SPAN?b=0===a.id.indexOf("dze_shape")?DZE_OBJ_SHAPE:g_objVideoControl.isVideoSpan(a)?DZE_OBJ_VIDEO:DZE_OBJ_TEXT:
c==DZE_TAG_HR?b=DZE_OBJ_HR:c==DZE_TAG_IFRAME&&g_objVideoControl.isVideoSpan(a.parentNode)&&(b=DZE_OBJ_VIDEO);return b}catch(d){dalert(d)}}function getBodyBackgroundColor(a){try{return g_objEditorDocument[a].body.style.backgroundColor}catch(b){}}function setBodyBackgroundColor(a,b){try{g_objEditorDocument[b].body.style.backgroundColor=""!=a?a:""}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundColor_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundColor("+b+")",500))}}
function retry_setBodyBackgroundColor(a){try{var b=g_strBodyBackgroundColor_Retry[a];g_objEditorDocument[a].body.style.backgroundColor=""!=b?b:""}catch(c){}}function setBodyBackgroundImage(a,b){try{"none"==a.toLowerCase()?g_objEditorDocument[b].body.style.backgroundImage=a:g_objEditorDocument[b].body.style.backgroundImage="url("+a+")"}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundImage_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundImage("+b+")",500))}}
function retry_setBodyBackgroundImage(a){try{var b=g_strBodyBackgroundImage_Retry[a];"none"==b.toLowerCase()?g_objEditorDocument[a].body.style.backgroundImage=b:g_objEditorDocument[a].body.style.backgroundImage="url("+b+")"}catch(c){}}function getBodyBackgroundRepeat(a){try{return g_objEditorDocument[a].body.style.backgroundRepeat}catch(b){}}
function setBodyBackgroundRepeat(a,b){try{g_objEditorDocument[b].body.style.backgroundRepeat=a}catch(c){fnObjectCheckNull(g_objEditorDocument[b])&&(g_strBodyBackgroundRepeat_Retry[b]=a,window.setTimeout("retry_setBodyBackgroundRepeat("+b+")",500))}}function retry_setBodyBackgroundRepeat(a){try{g_objEditorDocument[a].body.style.backgroundRepeat=g_strBodyBackgroundRepeat_Retry[a]}catch(b){}}
function addHTMLCode(a,b){try{if(window.attachEvent)ID_STRING_NAME_CONTROL!=g_objEditorDocument[b].selection.type.toLowerCase()&&g_objInsertUtil.insertTableCodeAtSelection(a,b);else{var c=getSelectionType();c.nodeType!=ID_SELECTION_ELEMENT_NODE&&c.nodeType!=ID_SELECTION_TEXT_NODE||g_objInsertUtil.insertTableCodeAtSelection(a,b)}editor_onselectionchange(b);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){}}
function getEditorHTMLCode(a,b,c,d,e){try{var f=dzeUiConfig.bOfficePagingMode;g_bEditMode[b]||syncEditorHTMLCodeFromSouceTab(b);g_objTagUtil.updateCurFormTagAttr(b);setSafariPatch(b);var g=parseInt(b,10)+DZE_IFRAME_TMP_NO,h=g_objEditorDocument[g];h.documentElement.innerHTML=g_objEditorDocument[b].documentElement.innerHTML;h.body.removeAttribute("style");h.body.style.backgroundColor=dzeUiConfig.sSettingPaperColor;h.body.removeAttribute("contenteditable");(g_bBrowserType_IE||g_bBrowserType_FF)&&g_objTagUtil.force_formTagSwitch(h.body,
!0);g_objEditMode.showBGImageForLockedCell(!1,g);g_bAnchorTargetBlankYN&&setAnchorTargetBlank(g);g_bContentPTagStyleApply&&setContentPTagStyleApply(g);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(g);g_objAdjustDoc.adjustRemoveGarbageText(g);g_objOnefficeEditor.getObjNodeCleaner().processGarbageEmptyTag(g_objAdjustDoc.getTarget(g),!1,g);g_objAdjustDoc.adjustDuplicateGarbage_P_Node(g);g_objAdjustDoc.remove_Br_Node_Inside_P_Node(g);g_objPlaceholder.removeAllPlaceholderText(h.body);
g_objTableOperation.removeAllEmpName(h.body);g_objAdjustDoc.changeTextTagFormat(h.body);g_objAdjustDoc.arrangeSpan(h.body);g_objAdjustDoc.removeImageEdit(h.body);g_objVideoControl.convToIframeAll(h.body);g_objCaretUtil.removeAllCaretMarker(h.body);g_objTableSelection.removeAllCellSelection(h.body);g_objNodeUtil.removeAllCommentNode(h.body);var k=g_objShapeEvtMgr.getShapeTextContainer();if(null!==k){var m=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(k.parentNode));
!1===fnObjectCheckNull(m)&&(g_objWrapperOutlineUtil_Improved.updateShapeText(m,!0),g_objWrapperOutlineUtil_Improved.hideTextBox(m))}!0===e&&setAbsoluteImgSrc(h.body);g_objNodeUtil.removeElementsBySelector(h.body,"li>div, li>p, span#dze_paste_caret_pos, ol>span, ul>span");g_objListUtil.replaceAllParaWithListItem(h.body);try{if("undefined"!=typeof c&&!0===c&&0<h.body.childNodes.length){var l=dzeLayoutControl.getCustomPropertyEle(g,"dze_doc_property");l&&"dze_doc_property"==l.nodeName.toLowerCase()&&
"dze_document_property"==l.className||(l=document.createElement("dze_doc_property"),l.className="dze_document_property",h.body.firstChild?h.body.insertBefore(l,h.body.firstChild):h.body.appendChild(l));l.setAttribute("dze_version",objOnefficeLoader.m_dzVersion);var n=dzeUiConfig.nSettingPaperSize.width+","+dzeUiConfig.nSettingPaperSize.height,p=dzeUiConfig.sSettingPaperColor,q=dzeUiConfig.sWatermarkImageSrc;l.setAttribute(DZE_CUSTOM_ATT_PAGEMARGIN,dzeUiConfig.nSettingPaperMargin.top+","+dzeUiConfig.nSettingPaperMargin.right+
","+dzeUiConfig.nSettingPaperMargin.bottom+","+dzeUiConfig.nSettingPaperMargin.left+","+dzeUiConfig.nSettingPaperMargin.headerTop+","+dzeUiConfig.nSettingPaperMargin.footerBottom);l.setAttribute(DZE_CUSTOM_ATT_PAPERSIZE,n);l.setAttribute(DZE_CUSTOM_ATT_PAGECOLOR,p);l.setAttribute(DZE_CUSTOM_ATT_DOCUMENT_NO,oneffice.currFileSeq);g_objZoom.saveDocZoomPropertyInfo(l);l.setAttribute(DZE_CUSTOM_ATT_WATERMARKSRC,q);l.setAttribute(DZE_CUSTOM_ATT_WATERMARKDATA,dzeUiConfig.mWatermarkData);l.setAttribute(DZE_CUSTOM_ATT_WATERMARKTYPE,
dzeUiConfig.mWatermarkType);l.setAttribute(DZE_CUSTOM_ATT_ONEPAGE_MODE,dzeUiConfig.bOfficeOnePageLongMode);l.setAttribute(DZE_CUSTOM_ATT_PAGE_OVERFLOWVISIBLE,dzeUiConfig.bOfficePgOverflowVisible);createDocInfo(DZE_CUSTOM_ATT.MEMO,l);createDocInfo(DZE_CUSTOM_ATT.TODO,l);g_objHeaderFooter.exportHeaderFooterAttribute(l,!0);g_objPageNumber.export(l);!0===objOnefficeLoader.m_bDomainBizwatch&&!0===dzeUiConfig.bSupportNewsEditor&&!1===fnObjectCheckNull(dzeUiConfig.nBizwatchArticleId)&&l.setAttribute(DZE_CUSTOM_ATT_ARTICLE_ID,
dzeUiConfig.nBizwatchArticleId)}}catch(r){dalert(r)}b="";if(a){var t=getHTMLContentCodeByXHTMLFormat(g,f);b=HTMLEncode(t)}else b=getHTMLContentCodeByXHTMLFormat(g,f);b=removeZeroWidthSpace(b);!0===dzeUiConfig.bRemoveXSS&&(b=removeXSS(b));h.body.innerHTML=b;return h.body.innerHTML}catch(r){cmnMsg.showMsg(MESSAGE_ERROR,ID_RES_CONST_STRING_SERVER_ERROR_CONTENT,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg();"undefined"!=typeof localStorage&&localStorage.setItem("getEditorHtmlCode Error",r.message)},
null,!0),dalert(r)}return""}function getEditorHTMLCodeFromId(a,b){b=getnEditNumberFromEditId(b);return null==b?"":getEditorHTMLCode(a,b)}function createDocInfo(a,b,c){try{var d=a==DZE_CUSTOM_ATT.MEMO?dzeUiConfig.objExtInfo.comments.data:dzeUiConfig.objExtInfo.todos.data;b&&d&&dzeLayoutControl.createCustomProperty(0,a,d,b).setAttribute("data",d)}catch(e){dalert(e)}}
function syncEditorHTMLCodeFromSouceTab(a){try{var b=g_objEditorDocument[a].body.innerHTML,c=g_objEditObjectSource[a].value,d=!0;if(!g_bSourceAreaScriptAllowYN){var e=c.toLowerCase().indexOf("<script",0);-1!=e&&(d=!1,g_objEditorDocument[a].body.innerHTML=b,fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT))}g_bSourceAreaIframeAllowYN||(e=c.toLowerCase().indexOf("<iframe",0),-1!=e&&(d=!1,g_objEditorDocument[a].body.innerHTML=b,fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME)));!0===dzeUiConfig.bRemoveXSS&&
(c=removeXSS(c));d&&(g_objEditorDocument[a].body.innerHTML=c);if(g_bBrowserType_IE){!g_bSourceAreaScriptAllowYN&&0<g_objEditorDocument[a].scripts.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b);if(!g_bSourceAreaIframeAllowYN){var f=g_objEditorDocument[a].getElementsByTagName("iframe");0<f.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)}g_objEditWindow[a].focus();g_objTagUtil.bFormTagSwitch=!1;
g_objTagUtil.force_formTagSwitch(g_objEditorDocument[a].body,!1)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)!g_bSourceAreaScriptAllowYN&&0<g_objEditorDocument[a].getElementsByTagName("script").length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(f=g_objEditorDocument[a].getElementsByTagName("iframe"),0<f.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=
b)),g_bBrowserType_FF&&(g_objTagUtil.bFormTagSwitch=!1,g_objTagUtil.force_formTagSwitch(g_objEditorDocument[a].body,!1));tranAllAnchorHrefSharp(a);g_objAdjustDoc.removeParaWithoutChild(a);g_objAdjustDoc.changeTableAlignToMarginStyle(a);g_objUndoRedo.registerInitialContentStack(a)}catch(g){dalert(g)}}function checkImgSrcPropertyValueAndForceRemove(a){try{var b=g_objEditorDocument[a].getElementsByTagName("img");for(a=0;a<b.length;a++)validateImgSrcPropertyValue(b[a].src)&&(b[a].src="")}catch(c){}}
function validateImgSrcPropertyValue(a){try{var b=a.toLowerCase();a=!1;var c=-1,d=b.length;c=b.indexOf(".jpg");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".gif");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".png");if(-1!=c){if(d!=c+4)return!0;a=!0}c=b.indexOf(".bmp");if(-1!=c){if(d!=c+4)return!0;a=!0}if(!a)return!0;for(d=0;d<g_arrCheckImgSrcPropertyValue.length;d++)if(-1!=b.indexOf(g_arrCheckImgSrcPropertyValue[d]))return!0;return!1}catch(e){}return!0}
function setEditorHTMLCode(a,b,c){try{g_objEditorDocument[c].body.innerHTML=b?HTMLDecode(a):a}catch(d){g_bLoadContentHTMLCode=!1;g_nLoadContentEditNumber[g_nLoadContentEditNumber.length]=c;g_bLoadContentEncode[g_bLoadContentEncode.length]=b;g_strLoadContentHTMLCode[g_strLoadContentHTMLCode.length]=a;return}try{if(tranAllAnchorHrefSharp(c),g_objEditMode.showBGImageForLockedCell(!0,c),g_objShapeFunction.replaceAnchorClass(),g_objShapeFunction.updateShapesTextFormat(),g_objAdjustDoc.removeParaWithoutChild(c),
g_objPageControl.removeOldPageBreakSpan(g_objEditorDocument[c].body),g_objAdjustDoc.changeTableAlignToMarginStyle(c),setImageLoadingLazy(g_objEditorDocument[c].body),dzeUiConfig.bOfficePagingMode||g_objUndoRedo.registerInitialContentStack(c),g_objVideoControl.adjustVideo(g_objEditorDocument[c].body),g_objVideoControl.convToImgAll(g_objEditorDocument[c].body),g_objShapeFunction.showShapeText(g_objEditorDocument[c].body),g_bBrowserType_IE||g_bBrowserType_FF)g_objTagUtil.bFormTagSwitch=!1,g_objTagUtil.force_formTagSwitch(g_objEditorDocument[c].body,
!1)}catch(d){dalert(d)}}function setEditorHTMLCodeFromId(a,b,c){c=getnEditNumberFromEditId(c);return null==c?"":setEditorHTMLCode(a,b,c)}
function retrySetEditorHTMLCode(a,b,c){try{if(g_objEditorDocument[c].body.innerHTML=b?HTMLDecode(a):a,g_bBrowserType_IE&&""==a.trim()&&(g_objEditorDocument[c].body.innerHTML=window.attachEvent?"<p></p>":"<p><br/></p>"),tranAllAnchorHrefSharp(c),g_objAdjustDoc.removeParaWithoutChild(c),g_objAdjustDoc.changeTableAlignToMarginStyle(c),setImageLoadingLazy(g_objEditorDocument[c].body),g_objUndoRedo.registerInitialContentStack(c),g_bBrowserType_IE||g_bBrowserType_FF)g_objTagUtil.bFormTagSwitch=!1,g_objTagUtil.force_formTagSwitch(g_objEditorDocument[c].body,
!1)}catch(d){dalert(d)}}function tranAllAnchorHrefSharp(a){try{var b=document.URL;b+="#";b=b.toLowerCase();var c=g_objEditorDocument[a].getElementsByTagName("A");for(a=0;a<c.length;a++){var d=c[a].href;d=d.toLowerCase();d.lastIndexOf("/")===d.length-1&&(d=d.substring(0,d.length-1));if(0==d.indexOf(b))if(b==d)c[a].href="#";else{var e=c[a].href,f=e.substring(b.length-1,e.length);c[a].href=f}else if("dze_bookmark_flag"!=c[a].className)g_objALinkMgr.onEvtProcess(c[a],1)}}catch(g){}}
function checkAnchorHrefSharp(a){try{var b=document.URL;b+="#";b=b.toLowerCase();var c=a.toLowerCase();if(0==c.indexOf(b))return b==c?"#":a.substring(b.length-1,a.length)}catch(d){}return null}function SetActiveEditorArea(a){g_objEditorDocument[a].body.setActive()}
function insertHTMLContent(a,b){try{if(window.attachEvent)g_objEditWindow[b].focus(),ID_STRING_NAME_CONTROL!=g_objEditorDocument[b].selection.type.toLowerCase()&&insertHTMLCodeAtSelection(a,null,b);else{g_objEditorDocument[b].body.focus();var c=getSelectionType();c.nodeType!=ID_SELECTION_ELEMENT_NODE&&c.nodeType!=ID_SELECTION_TEXT_NODE||insertHTMLCodeAtSelection(a,null,b)}}catch(d){}}
function addHTMLContent(a,b,c,d){try{if(0==c)if(window.attachEvent)if(null!=g_objLastRange[d]){if(""==g_objLastRange[d].htmlText)if(g_bActivate[d]){var e=g_objEditorDocument[d].selection.createRange();fnObjectCheckNull(e)||(g_strBookmark_IE=e.getBookmark(),insertHTMLCodeAtSelection(a,null,d))}else g_objLastRange[d].select(),insertHTMLCodeAtSelection(a,null,d);else g_objLastRange[d].select(),insertHTMLCodeAtSelection(a,null,d);g_objLastRange[d]=null}else if(g_bActivate[d])e=g_objEditorDocument[d].selection.createRange(),
fnObjectCheckNull(e)||(g_strBookmark_IE=e.getBookmark(),insertHTMLCodeAtSelection(a,null,d));else{var f=g_objEditorDocument[d].body.innerHTML+a;g_objEditorDocument[d].body.innerHTML=f}else{if(g_bBrowserType_IE&&null!=g_objLastRange[d]){var g=g_objEditWindow[d].getSelection();g.removeAllRanges();g.addRange(g_objLastRange[d])}var h=getSelectionType();h.nodeType!=ID_SELECTION_ELEMENT_NODE&&h.nodeType!=ID_SELECTION_TEXT_NODE||insertHTMLCodeAtSelection(a,b,d)}else 1==c?(f="",f=a+g_objEditorDocument[d].body.innerHTML,
g_objEditorDocument[d].body.innerHTML=f):2==c&&(f="",f=g_objEditorDocument[d].body.innerHTML+a,g_objEditorDocument[d].body.innerHTML=f)}catch(k){}}function replaceHTMLContent(a,b){try{g_objEditorDocument[b].body.innerHTML=a}catch(c){}}function getEditorText(a){try{return g_objPropertyUtil.getTextContent(g_objEditorDocument[a].body)}catch(b){}return""}function setEditModeConversion_FF(a,b){try{g_bBrowserType_FF&&(g_objEditorDocument[a].body.contentEditable=b)}catch(c){}}
function getEditorSelectionText(a){try{var b="";if(window.attachEvent){var c=g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return"";var d=c.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var e=c.createRange();if(fnObjectCheckNull(e))return"";b=e.text}}else if(d=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d)c=g_objEditWindow[g_nActiveEditNumber].getSelection(),b=c.getRangeAt(0).toString();return b}catch(f){}return""}
function findCountEditorText(a,b){try{if(""==b)return;var c=!0,d=0,e=fnGetEditorDocument(a);if(g_bBrowserType_IE)for(var f=e.body.createTextRange();c;){if(c=f.findText(b))d++,f.collapse(!1)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var g=fnGetEditorWindow(a),h=e.body.scrollLeft,k=e.body.scrollTop,m=g.getSelection();for(m.removeAllRanges();c;)(c=g.find(b))&&d++;m=g.getSelection();m.removeAllRanges();g.scrollTo(h,k)}return d}catch(l){}return 0}
function findEditorText(a,b){try{if(""==b)return 0;var c=-1;if(g_bBrowserType_IE){var d=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=d.body.createTextRange());var e=g_objFindTextRange.findText(b);e?(c=1,g_nFindTextCount++,g_objFindTextRange.select(),g_objFindTextRange.collapse(!1)):(c=0==g_nFindTextCount?2:3,g_nFindTextCount=0,g_objFindTextRange=d.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var f=fnGetEditorWindow(a);(e=f.find(b))?
c=1:(c=3,f.getSelection().removeAllRanges())}return c}catch(g){}return-1}
function findEditorTextDetail(a,b,c,d,e,f,g){try{if(""==b)return 0;f=-1;var h=g_objEditorDocument[a],k=h.defaultView;if(k.find){var m=k.getSelection(),l=GetCurRangeProp(a);!0===g&&m.removeAllRanges();k.find(b,d,c,!1,e)?f=1:(m.removeAllRanges(),f=k.find(b,d,c,!1,e)?3:2);1===f?(g_objCaretUtil.scrollToCaret(a),g_objPageControl.updateStatusPageNum(a)):2!==f&&3!==f||!l.isValid()||(m.removeAllRanges(),m.addRange(l.getNativeRange()))}else h.body.createTextRange&&(g_objFindTextRange&&!0!==g||(g_objFindTextRange=
h.body.createTextRange()),g=1E5,k=0,1===c&&(k|=1,g*=-1),1===e&&(k|=2),1===d&&(k|=4),g_objFindTextRange.text&&(1===d?g_objFindTextRange.text===b:g_objFindTextRange.text.toLowerCase()===b.toLowerCase())&&g_objFindTextRange.collapse(0===c?!1:!0),g_objFindTextRange.findText(b,g,k)?(f=1,g_objFindTextRange.select()):(g_objFindTextRange=h.body.createTextRange(),f=g_objFindTextRange.findText(b,g,k)?3:2),1===f&&(g_objCaretUtil.scrollToCaret(a),g_objPageControl.updateStatusPageNum(a)));return f}catch(n){dalert(n)}return-1}
function replaceTextCommon(a,b,c){try{var d=a.getRangeAt(0);a.removeAllRanges();d.deleteContents();var e=d.startContainer,f=d.startOffset;d=b.createRange();if(3===e.nodeType)e.insertData(f,c),d.setEnd(e,f+c.length),d.setStart(e,f+c.length);else{var g=e.childNodes[f],h=b.createTextNode(c);e.insertBefore(h,g);d.setEnd(g,0);d.setStart(g,0)}a.addRange(d);return!0}catch(k){}finally{}return!1}
function replaceEditorText(a,b,c){try{if(""==b)return 0;var d=-1;if(g_bBrowserType_IE){var e=fnGetEditorDocument(a);null==g_objFindTextRange&&(g_objFindTextRange=e.body.createTextRange());var f=g_objFindTextRange.findText(b);f?(d=1,g_objFindTextRange.select(),g_objFindTextRange.text=c,g_objFindTextRange.findText(c,-c.length,1),g_objFindTextRange.select()):(d=3,g_objFindTextRange=e.body.createTextRange())}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var g=fnGetEditorWindow(a);if(f=
g.find(b)){d=1;var h=g.getSelection();if(1!=h.rangeCount)return-1;e=fnGetEditorDocument(a);if(!replaceTextCommon(h,e,c))return-1;g.find(c,!1,!0)}else d=3,h=g.getSelection(),h.removeAllRanges()}return d}catch(k){}return-1}
function replaceEditorTextDetail(a,b,c,d,e,f,g,h,k){try{if(""==b)return 0;var m=-1,l=g_objEditorDocument[a],n=l.defaultView,p=null;if(n.find){var q=n.getSelection(),t=GetCurRangeProp(a);if(!0===h)q.removeAllRanges();else{var r=GetCurRange(a);r&&(r.collapse(1===d?!1:!0),q.removeAllRanges(),q.addRange(r));r=null}if(n.find(b,e,d,!1,f)){var z=GetCurRangeProp(a);t.isValid()&&z.isValid()&&t.equal(z)?m=1:(m=5,g_objCaretUtil.scrollToCaret(a))}else q.removeAllRanges(),m=n.find(b,e,d,!1,f)?3:2,t.isValid()&&
(q.removeAllRanges(),q.addRange(t.getNativeRange()));1===m&&(g_objEditMode.checkSelectionContentEditable(a)?replaceTextCommon(q,l,c)||(m=-1):m=4);p=function(){1===m&&(n.find(b,e,d,!1,f)||(m=6),dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.propagateHeaderFooter(-1),g_objCaretUtil.scrollToCaret(a),g_objPageControl.updateStatusPageNum(a))};k?setTimeout(function(){p();k(m)},100):p()}else if(l.body.createTextRange){g_objFindTextRange&&!0!==h||(g_objFindTextRange=l.body.createTextRange());var u=1E5,v=
0;1===d&&(v|=1,u*=-1);1===f&&(v|=2);1===e&&(v|=4);var w=g_objFindTextRange.duplicate();g_objFindTextRange.findText(b,u,v)?g_objFindTextRange.isEqual(w)?m=1:(m=5,g_objFindTextRange.select()):(g_objFindTextRange=l.body.createTextRange(),m=g_objFindTextRange.findText(b,u,v)?3:2);1===m&&(g_objEditMode.checkSelectionContentEditable(a)?g_objFindTextRange.text=c:m=4);p=function(){1===m&&(g_objFindTextRange.findText(b,u,v)||(m=6),g_objFindTextRange.select(),dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.propagateHeaderFooter(-1),
g_objCaretUtil.scrollToCaret(a),g_objPageControl.updateStatusPageNum(a))};k?setTimeout(function(){p();k(m)},100):p()}return m}catch(x){dalert(x)}return-1}
function replaceAllEditorText(a,b,c,d,e,f,g){try{if(""==b)return-1;var h=g_objEditorDocument[a],k=h.defaultView;g=0;if(k.find){var m=GetCurRangeProp(a),l=k.getSelection();for(l.removeAllRanges();k.find(b,e,d,!1,f);){if(1!==l.rangeCount)return-1;if(g_objEditMode.checkSelectionContentEditable(a)){if(!replaceTextCommon(l,h,c))return-1;g++}}l.removeAllRanges();m.isValid()&&l.addRange(m.getNativeRange())}else if(h.body.createTextRange){var n=h.body.createTextRange();h=1E5;k=0;1===d&&(k|=1,h*=-1);1===f&&
(k|=2);1===e&&(k|=4);for(e=g_objEditMode;n.findText(b,h,k);)e.checkSelectionContentEditable(a)&&(n.select(),n.text=c,g++,n.collapse(0===d?!1:!0))}else return-1;return g}catch(p){dalert(p)}return-1}
function resizeEditor(a,b,c){try{g_arrEditorWidth[a]=b,g_arrEditorHeight[a]=c,g_nEditAreaSetHeight=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight,g_objEditSetContainer[a].style.width=g_arrEditorWidth[a]+"px",g_objEditSetContainer[a].style.height=g_arrEditorHeight[a]+"px",g_objMainEditAreaContainer[a].style.height=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight+"px",g_bDocType_XHTML&&(g_objEditObjectSource[a].style.height=g_arrEditorHeight[a]-
g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-22+"px"),document.getElementById("TB_CONTAINER_"+a).parentNode.style.height=document.getElementById("TB_CONTAINER_"+a).offsetHeight+"px"}catch(d){}}
function resizeEditor_Height(a,b){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);200>b&&(b=200);"undefined"==typeof b?b=document.documentElement.clientHeight:dzeEnvConfig.iFrameLayer&&g_bEditorHeightIFrameYN&&("100%"!=window.frameElement.getAttribute("height")&&(window.frameElement.style.height=b+"px"),window.frameElement.parentNode.style.height=b+"px",b=document.documentElement.clientHeight);g_nTabBarSetHeight=0;if(g_bTabBar_Display){var c=document.getElementById("TB_TABMODE_TR_CONTAINER_"+
a);null!=c&&(g_nTabBarSetHeight=c.offsetHeight)}g_nToolbarSetHeight=0;var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(g_nToolbarSetHeight=d.offsetHeight);c=0;var e=document.getElementById("TB_CONTAINER_RULERBAR_"+a);e&&"none"!==e.style.display&&(c=e.offsetHeight);e=0;var f=document.getElementById("TB_CONTAINER_READONLY_NOTIBAR_"+a);f&&"none"!==f.style.display&&(e=f.offsetHeight+4);g_arrEditorHeight[a]=b;g_nEditAreaSetHeight=b-g_nToolbarSetHeight-g_nTabBarSetHeight;if(!(g_bMenuBar_Display||
g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display||g_bTabBar_Display)){var g=document.getElementById("dzeditor_Parent_"+a),h=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(g,"border-top-width",a).replace(/px/,""),10)+parseInt(g_objPropertyUtil.getElementStyleAttributeValue(g,"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=h||0}else if(!g_bTabBar_Display){var k=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a),m=parseInt(g_objPropertyUtil.getElementStyleAttributeValue(k,
"border-bottom-width",a).replace(/px/,""),10);g_nEditAreaSetHeight-=m||0}if(!0===dzeUiConfig.bUseBottomStatusBar){var l=document.getElementById("ToolbarSetBottomStatusBar_"+a);l&&(g_nEditAreaSetHeight-=l.offsetHeight)}g_nEditDocumentHeight=g_nEditAreaSetHeight-e-c;var n=g_objEditSetContainer[a];n&&(n.style.height=g_arrEditorHeight[a]+"px",n.setAttribute("height",g_arrEditorHeight[a]));var p=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a);p&&(p.style.height=g_nEditAreaSetHeight+"px",p.setAttribute("height",
g_nEditAreaSetHeight));var q=document.getElementById("MAIN_EDIT_AREA_CONTAINER_BOX_"+a);if(q&&(q.style.height=g_nEditAreaSetHeight+"px",!0===dzeUiConfig.bOfficeMode)){var t=document.documentElement.clientWidth;q.style.width=t+"px"}b=0;var r=document.getElementById("dze_idx_right_pannel_"+a);r&&(b=r.offsetWidth);if(!0!==dzeUiConfig.bOfficeMode||!0===dzeUiConfig.bOfficePagingMode){var z=document.getElementById("dzeditor_Parent_"+a);z&&(z.style.width=t-b+"px",z.style.height=g_nEditAreaSetHeight+"px",
z.childNodes[0].style.width=t-b+"px");var u=document.getElementById("dzeditor_"+a);u&&(u.style.width=t-b+"px",u.style.height=g_nEditDocumentHeight+"px");if(r){r.style.height=g_nEditAreaSetHeight+"px";var v=document.getElementsByClassName("dze_panel_body")[0];v&&(v.style.height=g_nEditAreaSetHeight-75+"px");var w=document.getElementsByClassName("dze_panel_contents")[0];w&&(w.style.height=parseFloat(v.style.height)-33+"px")}var x=g_objEditorDocument[a].getElementById("dze_document_main_container");
x&&(x.style.width=0<b?t-b+"px":"100%",x.style.height=g_nEditDocumentHeight+"px")}var y=document.getElementById("TB_CONTAINER_"+a),A=y?y.offsetHeight:0;y&&(y.parentNode.style.height=A+"px",y.parentNode.setAttribute("height",A));g_bDocType_XHTML&&g_objEditObjectSource[a]&&(g_objEditObjectSource[a].style.height=g_nEditAreaSetHeight-20+"px")}catch(B){dalert(B)}}
function resizeInput(a,b,c,d){try{if(a&&1===a.nodeType&&"INPUT"===a.nodeName&&a.hasAttribute("dze_auto_resize")&&!(0>g_objNodeUtil.arrTextInputType.indexOf(a.type))){var e=a.value;if(!e)return b&&(a.style.width=b+"px"),a;var f=a.ownerDocument.createElement("span");f.id=a.id;f.className=a.className;var g=parseStyle(a.getAttribute("style"));g&&Object.keys(g).forEach(function(a){"width"!==a&&(f.style[a]=g[a])},this);f.style.whiteSpace="pre";f.innerHTML=e;var h=null;appendBodyTemporary(f,null,function(){h=
f.offsetWidth});h&&(h+=5,c&&(h+=23,h=Math.max(h,c)),d&&(h=Math.min(h,d)),a.style.width=h+"px");return a}}catch(k){dalert(k)}}function setAnchorTargetBlank(a){try{var b=g_objEditorDocument[a].getElementsByTagName("A");for(a=0;a<b.length;a++)b[a].target="_blank"}catch(c){}}function getImageList(a){try{var b=[],c=g_objEditorDocument[a].getElementsByTagName("IMG");for(a=0;a<c.length;a++)b[a]=getImageSrcValue(c[a].src);return b}catch(d){}}
function getImageSrcValue(a){try{var b=document.location.href;if(g_bBrowserType_IE){var c=b.lastIndexOf("/");if(b.substring(0,c+1)==a)return""}else if(b==a)return"";if(null!=g_arrImgSrcRemoveDomain){var d=a.toLowerCase();for(b=0;b<g_arrImgSrcRemoveDomain.length;b++)if(0==d.indexOf(g_arrImgSrcRemoveDomain[b])){var e=d.length,f=g_arrImgSrcRemoveDomain[b].length;if(f<=e&&"/"==d.charAt(f))return a.substring(f,e)}}return a}catch(g){}}
function setContentPTagStyleApply(a){try{for(var b=g_objEditorDocument[a].getElementsByTagName("P"),c,d=0;d<b.length;d++){c=b[d];var e=c.style.marginTop;if(""==e||null==e)c.style.marginTop=g_strPTagMarginTop;var f=c.style.marginBottom;if(""==f||null==f)c.style.marginBottom=g_strPTagMarginBottom;var g=c.style.fontFamily;if(""==g||null==g)c.style.fontFamily=g_strBodyFontFamily;var h=c.style.fontSize;if(""==h||null==h)c.style.fontSize=g_strBodyFontSize;var k=c.style.lineHeight;if(""==k||null==k)c.style.lineHeight=
g_strBodyLineHeight;var m=c.style.letterSpacing;if(""==m||null==m)c.style.letterSpacing=g_strBodyLetterSpacing}var l=g_objEditorDocument[a].getElementsByTagName("BLOCKQUOTE");for(d=0;d<l.length;d++){e=l[d].style.marginTop;if(""==e||null==e)l[d].style.marginTop=g_strPTagMarginTop;f=l[d].style.marginBottom;if(""==f||null==f)l[d].style.marginBottom=g_strPTagMarginBottom;g=l[d].style.fontFamily;if(""==g||null==g)l[d].style.fontFamily=g_strBodyFontFamily;h=l[d].style.fontSize;if(""==h||null==h)l[d].style.fontSize=
g_strBodyFontSize;k=l[d].style.lineHeight;if(""==k||null==k)l[d].style.lineHeight=g_strBodyLineHeight;m=l[d].style.letterSpacing;if(""==m||null==m)l[d].style.letterSpacing=g_strBodyLetterSpacing}}catch(n){dalert(n)}}
function getHTMLContentCodeByXHTMLFormat(a,b){try{var c=!0===fnObjectCheckNull(b)?!1:b;return g_bContentXHTMLFormatYN?dzeUiConfig.bOfficePagingMode?g_objCodeParser.convertXHTMLCode(getHTMLContentCodeByPageContains(a,c)):g_objCodeParser.convertXHTMLCode(g_objEditorDocument[a].body.innerHTML):dzeUiConfig.bOfficePagingMode?getHTMLContentCodeByPageContains(a,c):g_objEditorDocument[a].body.innerHTML}catch(d){}}
function getHTMLContentCodeByPageContains(a,b){try{var c=!0===fnObjectCheckNull(b)?!1:b;b="";var d=dzeLayoutControl.getCustomPropertyEle(a,"dze_doc_property");d&&"dze_doc_property"==d.nodeName.toLowerCase()&&"dze_document_property"==d.className&&(b+=d.outerHTML);var e=g_objEditorDocument[a].getElementsByClassName("dze_page_main"),f=document.createElement("div");f.className="dze_printpagebreak";f.setAttribute("contenteditable","false");f.style.pageBreakAfter="always";for(a=0;a<e.length;a++)c&&0<a&&
(b+=f.outerHTML),b+=e[a].innerHTML;return b}catch(g){dalert(g)}}function getHTMLContentRemoveVideoControl(a){try{return g_bBrowserType_IE&&g_bContentXHTMLFormatYN?g_objCodeParser.removeVideoControl(a):a}catch(b){}}function setContentXHTMLFormat(a,b){try{g_bContentXHTMLFormatYN=a,g_bContentXHTMLTabSettingYN=b}catch(c){}}function setIFrameSrcBlankForTabMode(a){try{var b=g_objEditorDocument[a].getElementsByTagName("iframe");for(a=0;a<b.length;a++)b[a].src="about:blank"}catch(c){}}
function checkSetIFrameSrcBlankForDelete(a){try{if(!window.addEventListener){var b=g_objEditorDocument[a].getElementsByTagName("iframe");if(0!=b.length){for(var c=[],d=[],e=(new Date).getTime(),f=0;f<b.length;f++)if(null==b[f].id||""==b[f].id){var g="i_"+e+"_"+f;c[f]=g;b[f].id=g;d[f]=!1}else c[f]=b[f].id.toLowerCase(),d[f]=!0;var h=g_objEditorDocument[a].selection.createRange().htmlText.toLowerCase();for(f=0;f<c.length;f++)-1!=h.indexOf(c[f])?b[f].src="about:blank":d[f]||(b[f].id="")}}}catch(k){}}
function checkTextNodeAllWhiteCode(a){try{for(var b=0;b<a.length;b++)switch(a.charCodeAt(b)){case ID_KEYCODE_TAB:case ID_KEYCODE_LINEFEED:case ID_KEYCODE_ENTER:break;default:return!1}return!0}catch(c){}return!1}function checkTextNodeAllWhiteCode_Plus_Space(a){try{for(var b=0;b<a.length;b++)switch(a.charCodeAt(b)){case ID_KEYCODE_TAB:case ID_KEYCODE_LINEFEED:case ID_KEYCODE_ENTER:case ID_KEYCODE_SPACE:break;default:return!1}return!0}catch(c){}return!1}
var DZE_UPLOAD_EVENT={uploaded_file_list:[],initUploadedFileList:function(a){"undefined"==typeof this.uploaded_file_list[a]&&(this.uploaded_file_list[a]=[])},addUploadedFileList:function(a,b){this.initUploadedFileList(a);this.uploaded_file_list[a].push(b)},removeUploadedFileList:function(a,b){this.initUploadedFileList(a);for(var c=[],d=0;d<this.uploaded_file_list[a].length;d++)b!=this.uploaded_file_list[a][d].url&&c.push(this.uploaded_file_list[a][d]);this.uploaded_file_list[a]=c},getUploadedFileList:function(a){this.initUploadedFileList(a);
this.checkDeleted(a);return this.uploaded_file_list[a]},emptyUploadedFileList:function(a){this.initUploadedFileList(a);this.uploaded_file_list[a]=[]},checkDeleted:function(a){try{var b=this.uploaded_file_list[a];if(b&&b[0]){var c=g_objEditorDocument[a];if(c){var d=[];forEach(b,function(a,b){b&&b.url&&(d[a]=isRelativeUrl(b.url)?getFullUrlFromPath(b.url):b.url)},this);var e=[],f=c.body.querySelectorAll("img[src]");forEach(f,function(a,b){if(a=b.src)a=isRelativeUrl(a)?getFullUrlFromPath(a):a,0>e.indexOf(a)&&
e.push(a)},this);forEach(b,function(a,b){b.deleted=0>e.indexOf(d[a])?!0:!1},this);return b}}}catch(g){dalert(g)}},setComplete:function(a,b){try{if(b&&b.url){dlog("DZE_UPLOAD_EVENT. onComplete === (nEditNumber:"+a+")");this.initUploadedFileList(a);var c=b.type,d=b.filename||[];Array.isArray(b.filename)||(d=[b.filename]);var e=b.url||[];Array.isArray(b.url)||(e=[b.url]);var f=new Date,g=f&&f.toLocaleString?f.toLocaleString("en-US"):"";forEach(e,function(b,e){this.addUploadedFileList(a,{url:e,filename:d[b]||
"",type:c,time:g})},this);this.onComplete(a,b)}}catch(h){dalert(h)}},onComplete:function(a,b){},pasteInsertImageFromClipboard:function(a,b){dlog("---pasteInsertImageFromClipboard start-----");try{if(window.addEventListener)if(g_bBrowserType_IE||g_bBrowserType_FF)dlog("---IE-FF----"),g_objCopyPaste.setTimeoutForPaste(function(){for(var a=g_objCopyPaste.getPasteDiv().getElementsByTagName("img"),c=0;c<a.length;c++)if(/^data:image\/png;base64,/i.test(a[c].src)){dlog(a[c].src);duzon_http.showLoading();
var d=new XMLHttpRequest;d.open("POST",dzeEnvConfig.strSavePasteImageURL,!0);d.onload=function(){duzon_http.hideLoading();var d=this.responseText;dlog("file upload result: "+d);d=duzon_http.parseJSON(d);dlog(d);"success"==d.result&&(d.url=getFullUrlFromPath(d.url),a[c].src=d.url,DZE_UPLOAD_EVENT.setComplete(b,d),dzeUiConfig.bUsePasteCapture||g_objUndoRedo.registerUndoRedoStack(0,b));g_objCopyPaste.resume()};d.onerror=function(){duzon_http.hideLoading();g_objCopyPaste.resume()};var e=new FormData;
e.append("dze_upimage_data",a[c].src);!0===dzeUiConfig.bIndependentEdit?"function"===typeof onefficeExtContent.addUploadForm&&onefficeExtContent.addFormData(e):(oneffice.bUseOnexFile?e.append("doc_no",oneffice.currFilePath):e.append("doc_no",oneffice.currFileSeq),e.append("open_date",oneffice.currFileOpenDate));d.send(e);g_objCopyPaste.pause();break}},0);else if(g_bBrowserType_WK||g_bBrowserType_OP){var c="";a.clipboardData&&a.clipboardData.getData&&(c=a.clipboardData.getData("text/plain"));dlog("---pastedText-----");
dlog(c);if(""!==c){g_objCopyPaste.setTimeoutForPaste(function(){for(var a=g_objCopyPaste.getPasteDiv().getElementsByTagName("img"),b=0;b<a.length;b++)/^file:\/\//i.test(a[b].src)&&a[b].parentNode.removeChild(a[b])},0);return}var d=new XMLHttpRequest;d.open("POST",dzeEnvConfig.strSavePasteImageURL,!0);d.onload=function(){duzon_http.hideLoading();var a=this.responseText;dlog("file upload result: "+a);var c=duzon_http.parseJSON(a);dlog(c);if("success"==c.result){c.url=objOnefficeLoader.m_nAppEnvType==
APPENV.WE?g_onefficeWeTool&&"onex"==g_onefficeWeTool.m_IsOnex?c.relativeUrl:getFullUrlFromPath(c.url):oneffice.bUseOnexFile?c.relativeUrl:getFullUrlFromPath(c.url);addHTMLContent("<img id='dze_idx_paste_image' src='"+c.url+"' />",null,0,b);var d=g_objEditorDocument[b].getElementById("dze_idx_paste_image");d?(d.onload=function(){this.removeAttribute("id");d.width&&(d.style.width=d.width+"px");d.height&&(d.style.height=d.height+"px");d.setAttribute("dze_image_no_proportion","");DZE_UPLOAD_EVENT.setComplete(b,
c);dzeUiConfig.bUsePasteCapture||g_objUndoRedo.registerUndoRedoStack(0,b);g_objCopyPaste.resume()},d.onerror=function(){this.removeAttribute("id");g_objCopyPaste.resume()}):g_objCopyPaste.resume()}else g_objCopyPaste.resume()};d.onerror=function(){duzon_http.hideLoading();g_objCopyPaste.resume()};var e=(a.clipboardData||a.originalEvent.clipboardData).items;c=null;for(var f=0;f<e.length;f++)0===e[f].type.indexOf("image")&&(c=e[f].getAsFile());if(null!==c){dlog("blob isgood");TBCancelBubbleEvent(a);
var g=new FileReader;g.onload=function(a){duzon_http.showLoading();var b=new FormData;b.append("dze_upimage_data",a.target.result);!0===dzeUiConfig.bIndependentEdit?"function"===typeof onefficeExtContent.addUploadForm&&onefficeExtContent.addFormData(b):(oneffice.bUseOnexFile?b.append("doc_no",oneffice.currFilePath):b.append("doc_no",oneffice.currFileSeq),b.append("open_date",oneffice.currFileOpenDate));d.send(b);g_objCopyPaste.pause()};g.onerror=function(){g_objCopyPaste.resume()};g.readAsDataURL(c);
g_objCopyPaste.pause()}}dlog("---pasteInsertImageFromClipboard End-----")}catch(h){duzon_http.hideLoading(),g_objCopyPaste.resume(),dalert(h)}},allow_dnd_file_ext:["gif","jpg","jpeg","png","bmp"],dnd_upload_list:[],onUploadSuccess:null,onUploadError:null,onUploadComplete:null,dragNdropInsertImage:function(a,b){try{if(a&&a.length){this.dnd_upload_list=[];this.onUploadSuccess=function(){};this.onUploadError=function(){};this.onUploadComplete=function(){};for(var c=0;c<a.length;c++)this.dnd_upload_list.push(a[c]);
if(!0===dzeUiConfig.bUseContentExtUpload)g_objExtUploader.initWithUploadList(b,this.dnd_upload_list);else{var d=this.dnd_upload_list.length,e=!1;this.onUploadSuccess=function(){e=!0;d--;if(0>=d)this.onUploadComplete()}.bind(this);this.onUploadError=function(){d--;if(0>=d)this.onUploadComplete()}.bind(this);this.onUploadComplete=function(){if(!e)return!1;g_objUndoRedo.registerUndoRedoStack(0,b);editor_onselectionchange(b);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()}.bind(this);
this.dragNdropUpload(b)}}}catch(f){dalert(f)}},dragNdropUpload:function(a){try{dlog("\uc5c5\ub85c\ub4dc \ud560 \ud30c\uc77c \uac1c\uc218 : "+DZE_UPLOAD_EVENT.dnd_upload_list.length);var b=DZE_UPLOAD_EVENT.dnd_upload_list.length;if(0<DZE_UPLOAD_EVENT.dnd_upload_list.length){dlog("type:"+typeof DZE_UPLOAD_EVENT.dnd_upload_list);var c=DZE_UPLOAD_EVENT.dnd_upload_list.shift();dlog("destFile------------");dlog("\uc5c5\ub85c\ub4dc \ud560 \ud30c\uc77c \uac1c\uc2182 : "+DZE_UPLOAD_EVENT.dnd_upload_list.length);
var d=c.name.split(".").pop().toLowerCase(),e=DZE_UPLOAD_EVENT.allow_dnd_file_ext.concat(g_objVideoControl.getAllowPlayVideoList(!1));if(!inArray(d,e))try{alert('"'+c.name+'" '+ID_RES_CONST_STRING_CANNOT_UPLOAD_FILE_TYPE+" "+e.join(", "));DZE_UPLOAD_EVENT.onUploadError();return}catch(m){DZE_UPLOAD_EVENT.onUploadError();return}duzon_http.showLoading();var f=g_objVideoControl.canPlayVideo(d),g=new XMLHttpRequest;f?g.open("POST",dzeEnvConfig.strUploadVideoURL,!0):g.open("POST",dzeEnvConfig.strUploadImageURL,
!0);var h=setTimeout(function(){try{g.abort(),dlog("xhr timeout"),duzon_http.hideLoading(),DZE_UPLOAD_EVENT.onUploadError()}catch(m){}},6E4);g.onload=function(){clearTimeout(h);var c=this.responseText;dlog("file upload result: "+c);c=duzon_http.parseJSON(c);if("success"!=c.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),DZE_UPLOAD_EVENT.onUploadError();else{var d=null;d=f?c.url:Array.isArray(c.url)?c.url[0]:c.url;d=getFullUrlFromPath(d);objOnefficeLoader.m_nAppEnvType==APPENV.WE?g_onefficeWeTool&&
"onex"==g_onefficeWeTool.m_IsOnex&&(d=Array.isArray(c.relativeUrl)?c.relativeUrl[0]:c.relativeUrl):oneffice.bUseOnexFile&&(d=Array.isArray(c.relativeUrl)?c.relativeUrl[0]:c.relativeUrl);var e=null;e=f?g_objVideoControl.getDragNDropVideoUploadHTML(d):"<img id='dze_idx_temporary_image_"+b+"' src='"+d+"' />";dragDropInsertHTML(e,a);if(f)DZE_UPLOAD_EVENT.onUploadSuccess();else{var g=g_objEditorDocument[a].getElementById("dze_idx_temporary_image_"+b);g&&(g.style.display="none",g.onload=function(){this.removeAttribute("id");
g.width&&(g.style.width=g.width+"px");g.height&&(g.style.height=g.height+"px");g.setAttribute("dze_image_no_proportion","");g_objAdjustDoc.fitImageSizeToDoc(dzeJ(g));duzon_dialog.fade("in",g,function(){DZE_UPLOAD_EVENT.onUploadSuccess()},20)},g.onerror=function(){g.style.display="";g.style.opacity="";this.removeAttribute("id");DZE_UPLOAD_EVENT.onUploadSuccess()})}DZE_UPLOAD_EVENT.setComplete(a,c);duzon_http.hideLoading();DZE_UPLOAD_EVENT.dragNdropUpload(a)}};g.onerror=function(){clearTimeout(h);dlog("xhr Error");
duzon_http.hideLoading();DZE_UPLOAD_EVENT.onUploadError()};var k=new FormData;f?(k.append("dze_upvideo_file",c),k.append("type","dnd_upload_video")):(k.append("dze_upimage_file",c),k.append("type","dnd_upload_image"));!0===dzeUiConfig.bIndependentEdit?"function"===typeof onefficeExtContent.addUploadForm&&onefficeExtContent.addFormData(k):objOnefficeLoader.m_nAppEnvType==APPENV.WE?g_onefficeWeTool&&"onex"==g_onefficeWeTool.m_IsOnex&&k.append("open_date",g_onefficeWeTool.m_openFileDate):oneffice.bUseOnexFile?
(k.append("doc_no",oneffice.currFilePath),k.append("open_date",oneffice.currFileOpenDate)):k.append("doc_no",oneffice.currFileSeq);g.send(k)}}catch(m){duzon_http.hideLoading(),dalert(m)}},reqThumbUpload:function(a,b){try{if(!g_objThumbMgr.isThumbUploadFlag())return 0;var c=g_objThumbMgr.m_thumbObjFile,d=new XMLHttpRequest;if(objOnefficeLoader.m_bHybrid){var e=mobile_http.getProtocolUrl("P017");d.open("POST",e,b)}else d.open("POST",dzeEnvConfig.strUploadThumbImgURL,b);var f=setTimeout(function(){try{d.abort(),
dlog("xhr timeout"),duzon_http.hideLoading()}catch(h){}},6E4);d.onload=function(){clearTimeout(f);var b=this.responseText;dlog("file upload result: "+b);b=duzon_http.parseJSON(b);"success"==b.result&&(b.url=getFullUrlFromPath(b.url),g_objThumbMgr.setThumbServerPath(b.url),DZE_UPLOAD_EVENT.setComplete(a,b));duzon_http.hideLoading()};d.onerror=function(){clearTimeout(f);dlog("xhr Error");duzon_http.hideLoading()};var g=new FormData;objOnefficeLoader.m_bHybrid?(g.append("pathSeq","1600"),g.append("empSeq",
mobile_http.hybridBaseData.result.empSeq),g.append("token",mobile_http.hybridBaseData.header.token),g.append("docNo",oneffice.currFileSeq),g.append("upImgThumbImg",c),g.append("creatorID",mobile_http.hybridBaseData.result.empSeq),g.append("type","uploadThumbImg")):(g.append("upImgThumbImg",c),g.append("creatorID",oneffice_cloud_myInfoData.id),g.append("type","uploadThumbImg"),g.append("doc_no",oneffice.currFileSeq));duzon_http.showLoading();d.send(g)}catch(h){dalert(h)}},uploadImageObject:function(a,
b,c,d){try{var e=new XMLHttpRequest;if(objOnefficeLoader.m_bHybrid){var f=mobile_http.getProtocolUrl("P017");e.open("POST",f,!0)}else e.open("POST",dzeEnvConfig.strUploadImageURL,!0);"undefined"==typeof d&&(d=5);var g=setTimeout(function(){try{e.abort(),duzon_http.hideLoading(),c(),dlog("xhr timeout url : "+dzeEnvConfig.strUploadImageURL)}catch(k){}},1E3*d);e.onload=function(){clearTimeout(g);var a=this.responseText;dlog("file upload result: "+a);a=duzon_http.parseJSON(a);objOnefficeLoader.m_bHybrid&&
(a=a.result);"success"!=a.result?(alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),c()):(a=a.url[0],a=getFullUrlFromPath(a),b(a),duzon_http.hideLoading())};e.onerror=function(){clearTimeout(g);dlog("xhr Error");c();duzon_http.hideLoading()};var h=new FormData;objOnefficeLoader.m_bHybrid?(h.append("pathSeq","1600"),h.append("empSeq",mobile_http.hybridBaseData.result.empSeq),h.append("token",mobile_http.hybridBaseData.header.token),h.append("docNo",oneffice.currFileSeq),h.append("dze_upimage_file",a),h.append("creatorID",
mobile_http.hybridBaseData.result.empSeq),h.append("type","dnd_upload_image")):(h.append("dze_upimage_file",a),h.append("type","dnd_upload_image"),h.append("doc_no",oneffice.currFileSeq));objOnefficeLoader.m_nAppEnvType==APPENV.WE?g_onefficeWeTool&&"onex"==g_onefficeWeTool.m_IsOnex&&h.append("open_date",g_onefficeWeTool.m_openFileDate):oneffice.bUseOnexFile&&(h.append("open_date",oneffice.currFileOpenDate),h.append("doc_no",oneffice.currFilePath));duzon_http.showLoading();e.send(h)}catch(k){dalert(k)}}};
g_getSelectionAttribute_Absolute=!1;
function increaseFontSize(a,b){try{if("undefined"==typeof a||0!=a)a=!0;strSelectionType=window.attachEvent?g_objEditorDocument[b].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)dlog("select type is not support -> strSelectionType : "+strSelectionType);else{g_getSelectionAttribute_Absolute=!0;var c=g_objPropertyUtil.getSelectionAttributeValue(b);g_getSelectionAttribute_Absolute=
!1;duzon_dialog.initSelectionFontStyleList(c);dlog("fontSize:"+duzon_dialog.selectionFontStyleList.fontSize);if(""!=duzon_dialog.selectionFontStyleList.fontSize){dlog("curr font size : "+duzon_dialog.selectionFontStyleList.fontSize);var d=updateHandlerUI.getMappingIndex_FontSize(duzon_dialog.selectionFontStyleList.fontSize,b);dlog("fontSizeIdx:"+d);a=!0===a?d+1:d-1;dlog("increaseIdx:"+a);if("undefined"!=typeof g_objComboBoxWin.arrFontSize[a]&&""!=g_objComboBoxWin.arrFontSize[a])g_nLetterOperationType=
ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(g_objComboBoxWin.arrFontSize[a]);else{a=-1;for(b=0;b<g_objComboBoxWin.arrFontSize.length;b++)if(parseInt(duzon_dialog.selectionFontStyleList.fontSize.replace(/pt/,""),10)<=parseInt(g_objComboBoxWin.arrFontSize[b].replace(/pt/,""),10)){a=b;break}0<=a&&g_objComboBoxWin.setComboBox(g_objComboBoxWin.arrFontSize[a])}}}}catch(e){dalert(e)}}
function removeEditorTempTagsFromStrHtml(a){try{var b=document.createElement("div");b.innerHTML=a;var c=g_objPropertyUtil,d=b.querySelectorAll("table.dze_tb_layout");forEach(d,function(a,b){c.removeClass(b,"dze_tb_layout")});var e=b.querySelectorAll("td.dze_tb_layout_td, th.dze_tb_layout_td");forEach(e,function(a,b){c.removeClass(b,"dze_tb_layout_td")});var f=b.querySelectorAll("a.dze_bookmark_flag, a.dze_bookmark_start_flag, a.dze_bookmark_end_flag");for(a=0;a<f.length;a++)c.removeClass(f[a],"dze_bookmark_flag"),
c.removeClass(f[a],"dze_bookmark_start_flag"),c.removeClass(f[a],"dze_bookmark_end_flag");var g=b.getElementsByTagName("div");for(a=0;a<g.length;a++)"dze_printpagebreak_guide"==g[a].className&&(g[a].style.display="none");return b.innerHTML}catch(h){dalert(h)}}
function replaceEditorTempTagsFromEditor(a,b){try{"undefined"==typeof b&&(b=g_objEditorDocument[a]);var c=g_objPropertyUtil,d=b.body.querySelectorAll("table.dze_tb_layout");forEach(d,function(a,b){c.replaceClass(b,"dze_tb_layout","dze_tb_layout_dummy")});var e=b.body.querySelectorAll("td.dze_tb_layout_td, th.dze_tb_layout_td");forEach(e,function(a,b){c.replaceClass(b,"dze_tb_layout_td","dze_tb_layout_td_dummy")});var f=b.body.querySelectorAll("a.dze_bookmark_flag, a.dze_bookmark_start_flag, a.dze_bookmark_end_flag");
a=0;for(var g=f.length;a<g;a++)c.hasClass(f[a],"dze_bookmark_flag")?(c.removeClass(f[a],"dze_bookmark_flag"),c.addClass(f[a],"dze_bookmark_flag_dummy")):c.hasClass(f[a],"dze_bookmark_start_flag")?(c.removeClass(f[a],"dze_bookmark_start_flag"),c.addClass(f[a],"dze_bookmark_start_flag_dummy")):c.hasClass(f[a],"dze_bookmark_end_flag")&&(c.removeClass(f[a],"dze_bookmark_end_flag"),c.addClass(f[a],"dze_bookmark_end_flag_dummy"));var h=b.getElementsByTagName("div");for(a=0;a<h.length;a++)"dze_printpagebreak_guide"==
h[a].className&&(h[a].className="dze_printpagebreak_guide_dummy");g_objPlaceholder.removeAllPlaceholderText(b.body,!0)}catch(k){dalert(k)}}function removeZeroWidthSpace(a){try{return a=a.replace(/([^>])\u200B/g,"$1"),a=a.replace(/\u200B([^<])/g,"$1")}catch(b){dalert(b)}}function removeZeroWidthSpaceFromString(a){try{return a?a.replace(/[\u200B-\u200D\uFEFF]/g,""):""}catch(b){dalert(b)}}
function removeXSS(a,b){try{if(!0!==dzeUiConfig.bRemoveXSS)return a;var c=a.trim();if(""==c||"<br>"==c||"<br />"==c||"<p><br></p>"==c||"<p><br /></p>"==c||"<p>&nbsp;</p>"==c)return a;dlog("--- removeXSS START ---");dlog("--- step 1~2 result");a=a.replace(/<[^>]+/g,function(a){a=a.replace(/\bon[a-zA-Z]+="[^"]+"*/gi,"");return a=a.replace(/\bon[a-zA-Z]+=["]*[^\(]+\([^\)]+\)["]*/gi,"")});c=/<[^>]*(o:gfxdata=|data-sheets-value=)[^>]*(&#[x]*\d+|[\t\\]+[a-zA-Z0-9]+)[^>]+>/gi;var d=a.match(c);null!=d&&d.length&&
(a=a.replace(c,"__DZE_MATCH_PATTERNS__"));a=a.replace(/&#[x]*\d+;?/gi,"");a=a.replace(/<[^>]*(javascript:)[^>]+>/gi,"");if(null!=d&&d.length)for(var e=0;e<d.length;e++)a=a.replace(/__DZE_MATCH_PATTERNS__/,d[e]);d=[];dlog("--- step 3 result\n"+a);a=a.replace(/<[^>]*marquee[^>]*>/gi,"");dlog("--- step 4 result\n"+a);if(!b||!1!==b.bCheckIframe){b=!1;c="youtube.com tv.naver.com serviceapi.nmv.naver.com play-tv.kakao.com play.wecandeo.com feelmaker.co.kr news.sbs.co.kr calendar.google.com player.vimeo.com".split(" ");
if((d=a.match(/(<iframe.+?<\/iframe>)/gi))&&d.length){e=0;for(var f=d.length;e<f;e++){b=!1;for(var g=c.length-1;0<=g;g--)if(0<=d[e].indexOf(c[g])){b=!0;break}!0!==b&&(a=a.replace(d[e],""))}}if((d=a.match(/(<object.+?<\/object>)/gi))&&d.length)for(e=0,f=d.length;e<f;e++){b=!1;for(g=c.length-1;0<=g;g--)if(0<=d[e].indexOf(c[g])){b=!0;break}!0!==b&&(a=a.replace(d[e],""))}}dlog("--- removeXSS END ---");return a}catch(h){dalert(h)}}
function dragDropInsertHTML(a,b){try{g_bBrowserType_IE&&g_objInsertUtil.activeSaveRangeFocus(1,b);if(window.attachEvent){var c=g_objEditorDocument[b].selection;if(!c)return;var d=c.createRange();if(!d)return;if("endContainer"in d)var e=d.endContainer;else{var f=d.parentElement().childNodes.length;e=0==f?d.parentElement():d.parentElement().childNodes[f-1]}if(e&&"nodeType"in e)var g=e.nodeType;else return}else g=getSelectionType().nodeType;if(g==ID_SELECTION_ELEMENT_NODE||g==ID_SELECTION_TEXT_NODE)window.attachEvent?
setTimeout(function(){insertHTMLCodeAtSelection(a,null,b)},100):insertHTMLCodeAtSelection(a,null,b);else if(!window.attachEvent&&g_bBrowserType_IE&&(c=g_objEditWindow[b].getSelection(),0==c.rangeCount)){var h=g_objEditorDocument[b].body;d=g_objEditorDocument[b].createRange();d.selectNode(h);d.collapse(!0);c.addRange(d);insertHTMLCodeAtSelection(a,null,b)}}catch(k){dalert(k)}}
function getnEditNumberFromEditId(a){for(var b in g_arrEditorAreaContainer)if(g_arrEditorAreaContainer[b]==a)return b;return null}
function setEditorContainerOutline(a){try{if(!(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display)){var b=document.getElementById("dzeditor_Parent_"+a),c=document.getElementById("dze_editor_source_frame_main_"+a);g_bTabBar_Display?(null!=b&&(b.style.borderWidth="1px 1px 0px 1px",b.style.borderStyle="solid",b.style.borderColor="#a0a0a0"),null!=c&&(c.style.borderTopWidth="0px",c.style.borderBottomWidth="1px")):(null!=b&&(b.style.borderWidth="1px 1px 1px 1px",b.style.borderStyle=
"solid",b.style.borderColor="#a0a0a0"),null!=c&&(c.style.borderTopWidth="0px",c.style.borderBottomWidth="`0px"))}if(!0===dzeUiConfig.bSetCustomEditorContainerOutLine&&"undefined"!=typeof dzeUiConfig.nCustomEditorContainerOutLineValues&&4==dzeUiConfig.nCustomEditorContainerOutLineValues.length){g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display||g_bTabBar_Display||null==b||(b.style.borderTopWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[0]+"px",b.style.borderBottomWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px");var d=document.getElementById("TB_CONTAINER_"+a);null!=d&&(d.style.borderTopWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[0]+"px",d.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",d.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");b=document.getElementById("dzeditor_Parent_"+a);null!=b&&(b.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",b.style.borderRightWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");c=document.getElementById("dze_editor_source_frame_main_"+a);null!=c&&(c.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",c.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px");var e=document.getElementById("TB_TABMODE_CONTAINER_"+a);if(null!=e){var f=document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_CONTAINER_"+a);null!=f?(f.style.borderBottomWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[1]+
"px",f.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",f.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px"):(e.style.borderBottomWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px",e.style.borderLeftWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[2]+"px",e.style.borderRightWidth=dzeUiConfig.nCustomEditorContainerOutLineValues[3]+"px")}else{var g=document.getElementById("ToolbarSetTabMode_No_Bottom_"+a);null!=g&&(g.style.borderBottomWidth=
dzeUiConfig.nCustomEditorContainerOutLineValues[1]+"px")}}}catch(h){dalert(h)}}
function insertSourceSelectionSyncChars(a){try{if(!0===dzeUiConfig.bSyncSourceSelection)if(GetMultiCellSelection())dlog("Not Support MultiCellSelection!");else if(window.attachEvent){var b=g_objEditorDocument[a].selection;if(!fnObjectCheckNull(b)){var c=b.createRange();if(!fnObjectCheckNull(c))if(""==c.htmlText)c.pasteHTML("\b\b");else{var d=c.duplicate();d.collapse(!0);d.pasteHTML("\b\b");var e=c.duplicate();e.collapse(!1);e.pasteHTML("\b\b")}}}else if(b=g_objEditWindow[a].getSelection(),1==b.rangeCount){var f=
b.getRangeAt(0);if(f.collapsed)insertHTMLCodeAtSelection("\b\b",null,a);else if(c=!1,ID_SELECTION_TEXT_NODE==f.commonAncestorContainer.nodeType&&(c=!0),c){var g=g_objEditorDocument[a].createElement("span");g.appendChild(f.cloneContents());var h=g_objEditorDocument[a].createTextNode("\b\b"+g.textContent+"\b\b");insertHTMLCodeAtSelection(null,h,a)}else{var k=f.startContainer,m=f.startOffset,l=f.endContainer,n=f.endOffset,p=g_objEditorDocument[a].createTextNode("\b\b"),q=g_objEditorDocument[a].createTextNode("\b\b");
b.removeAllRanges();e=g_objEditorDocument[a].createRange();e.setStartBefore(l);e.setEnd(l,n);e.collapse(!1);b.addRange(e);insertHTMLCodeAtSelection(null,q,a);b.removeAllRanges();d=g_objEditorDocument[a].createRange();d.setStart(k,m);d.setEndAfter(k);d.collapse(!0);b.addRange(d);insertHTMLCodeAtSelection(null,p,a)}}}catch(t){dalert(t)}}
function syncSourceSelection(a){try{if(!0===dzeUiConfig.bSyncSourceSelection){var b=g_objEditObjectSource[a].value;"selectionStart"in g_objEditObjectSource[a]||(b=b.replace(/\r/g,""));var c=b.indexOf("\b\b");if(!(0>c)){var d=b.substring(0,c),e=b.indexOf("\b\b",c+2);e=0>e?c:e-2;g_objEditObjectSource[a].value=b.replace(/\b\b/g,"");g_objEditorDocument[a].body.innerHTML=g_objEditorDocument[a].body.innerHTML.replace(/\b\b/g,"");if("selectionStart"in g_objEditObjectSource[a])g_objEditObjectSource[a].selectionStart=
c,g_objEditObjectSource[a].selectionEnd=e,g_objEditObjectSource[a].focus();else{var f=g_objEditObjectSource[a].createTextRange();f.moveStart("character",c);f.collapse();f.moveEnd("character",e-c);f.select()}var g=(d.match(/\n/g)||[]).length;g_objEditObjectSource[a].scrollTop=16*g+8}}}catch(h){dalert(h)}}
function insertPrintPageBreak(a){try{if(!GetCurTable(a))if(!0===dzeUiConfig.bOfficeOnePageLongMode)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALERT_NOT_AVAILABLE_IN_ONEPAGE_MODE,1.5);else if(!0===dzeUiConfig.bOfficePagingMode)g_objPageControl.insertPageBreak(a),g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a);else{var b=document.createElement("div");b.className="dze_printpagebreak";b.setAttribute("contenteditable","false");b.innerHTML='<div class="dze_printpagebreak_guide" contenteditable="false" title="'+
ID_RES_CONST_STRING_PRINT_PAGE_BREAK+'"></div>';var c=document.createElement("p");c.innerHTML=window.attachEvent?"&nbsp;":"<br />";var d=g_objNodeUtil.getAncestorNodeOnCaret(a);if(d){if(3==d.nodeType&&(d=d.parentNode,!d))return;if("body"==d.nodeName.toLowerCase())insertHTMLCodeAtSelection(b.outerHTML+c.outerHTML,null,a);else{for(var e=0;;){e++;if(30<e)break;if(!d.parentNode)break;if("body"==d.parentNode.nodeName.toLowerCase())break;d=d.parentNode}if(!d||"body"!=d.parentNode.nodeName.toLowerCase())return;
d.nextSibling?d.parentNode.insertBefore(b,d.nextSibling):d.parentNode.appendChild(b);b.nextSibling?b.parentNode.insertBefore(c,b.nextSibling):b.parentNode.appendChild(c);duzon_dialog.setFocusElement(c,a,"start")}g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(f){dalert(f)}}
var dzeCopyPasteStyleInfo={nEditNumber:-1,pasteStyleMode:!1,isEmpty:!0,styleInfo:{},initStyleInfo:function(){try{this.styleInfo={fontFamily:"",fontSize:"",color:"",backgroundColor:"",letterSpacing:"",lineHeight:"",bold:!1,italic:!1,underline:!1,strike:!1,superScript:!1,subScript:!1,textAlign:-1,listType:[],listStyleType:[],listClassName:[],listChildClassName:[],listChildStyle:[],heading:"-1"},this.isEmpty=!0}catch(a){dalert(a)}},copy:function(a){try{if(!0===dzeUiConfig.bApplyPasteStyleMode&&(this.initStyleInfo(),
!GetMultiCellSelection())){var b=g_objPropertyUtil.getSelectionFirstStyleAttributeValue(a,!0,!0);b&&(b[0]?(this.styleInfo.fontFamily=b[0],this.isEmpty=!1):1==b[11]&&"undefined"!=typeof b[22][0]&&(this.styleInfo.fontFamily=b[22][0],this.isEmpty=!1),b[1]?(this.styleInfo.fontSize=b[1],this.isEmpty=!1):1==b[12]&&"undefined"!=typeof b[23][0]&&(this.styleInfo.fontSize=b[23][0],this.isEmpty=!1),b[2]?(this.styleInfo.color=b[2],this.isEmpty=!1):1==b[13]&&"undefined"!=typeof b[24][0]&&(this.styleInfo.color=
b[24][0],this.isEmpty=!1),b[3]?(this.styleInfo.backgroundColor=b[3],this.isEmpty=!1):1==b[14]&&"undefined"!=typeof b[25][0]&&(this.styleInfo.backgroundColor=b[25][0],this.isEmpty=!1),b[4]?(this.styleInfo.letterSpacing=b[4],this.isEmpty=!1):1==b[15]&&"undefined"!=typeof b[26][0]&&(this.styleInfo.letterSpacing=b[26][0],this.isEmpty=!1),b[5]?(this.styleInfo.lineHeight=b[5],this.isEmpty=!1):1==b[16]&&"undefined"!=typeof b[27][0]&&(this.styleInfo.lineHeight=b[27][0],this.isEmpty=!1));strSelectionType=
window.attachEvent?g_objEditorDocument[a].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();if(ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType){b="";for(var c=0,d=0;d<duzon_dialog.dze_font_propertys.length-1;d++)if("normal"!=duzon_dialog.dze_font_propertys[d]){b=duzon_dialog.dze_font_propertys[d].toUpperCase();c=eval("ID_COMMAND_"+b);"STRIKE"==b&&(b="StrikeThrough");var e=handlerUI.queryCommandStatus(g_objEditorDocument[a],c,
b,a,-1,strSelectionType,!0);if(ID_STRING_NAME_CHECKED==e)switch(b){case "StrikeThrough":this.styleInfo.strike=!0;this.isEmpty=!1;break;case "BOLD":this.styleInfo.bold=!0;this.isEmpty=!1;break;case "ITALIC":this.styleInfo.italic=!0;this.isEmpty=!1;break;case "UNDERLINE":this.styleInfo.underline=!0;this.isEmpty=!1;break;case "SUPERSCRIPT":this.styleInfo.superScript=!0;this.isEmpty=!1;break;case "SUBSCRIPT":this.styleInfo.subScript=!0,this.isEmpty=!1}}var f=g_objNodeUtil.getAncestorNodeOnCaret(a).parentNode.style.verticalAlign;
!1===fnObjectCheckNull(f)&&""!==f&&"sub"!==f&&(this.styleInfo.superScript=!0);this.styleInfo.textAlign=getAlignValueForSelectionArea(a);this.styleInfo.heading=updateHandlerUI.getMappingIndex_Heading(a);0<parseInt(this.styleInfo.heading,10)&&(this.isEmpty=!1);var g=g_objNodeUtil.getAncestorNodeOnCaret(a);if(g&&(g.nodeType==ID_SELECTION_TEXT_NODE&&(g=g.parentNode),"li"==g.nodeName.toLowerCase()&&(g=g.parentNode),"ol"==g.nodeName.toLowerCase()||"ul"==g.nodeName.toLowerCase())){for(e=0;e++,this.styleInfo.listType.push(g.nodeName.toUpperCase()),
this.styleInfo.listStyleType.push(g.style.listStyleType),this.styleInfo.listClassName.push(g.className),0<g.childNodes.length&&"li"==g.childNodes[0].nodeName.toLowerCase()&&(g.childNodes[0].className?this.styleInfo.listChildClassName.push(g.childNodes[0].className):this.styleInfo.listChildClassName.push(""),g.childNodes[0].getAttribute("style")?this.styleInfo.listChildStyle.push(g.childNodes[0].getAttribute("style")):this.styleInfo.listChildStyle.push(null)),g=g_objNodeUtil.getLoopChildNodeByTagNames(g,
["ol","ul"]),g&&!(10<e););this.isEmpty=!1}!1===this.isEmpty&&this.setPasteStyleMode(a)}}}catch(h){dalert(h)}},paste:function(a,b){try{var c=!1,d=GetCurRange(a);if(null===d||d.collapsed)return!1;if(!0===dzeUiConfig.bApplyPasteStyleMode&&(void 0===b&&(b=!1),b&&(this.pasteStyleMode=!0),!0===this.pasteStyleMode&&!0!==this.isEmpty))if(this.unsetPasteStyleModeEditArea(a),GetMultiCellSelection())this.unsetPasteStyleMode(a);else{this.nEditNumber=a;var e=window.attachEvent?g_objEditorDocument[a].selection.type:
getSelectionTypeForUpdateUI();e=e.toLowerCase();if(ID_STRING_NAME_TEXT!=e&&ID_STRING_NAME_NONE!=e)this.unsetPasteStyleMode(a);else{var f=g_objNodeUtil.getAncestorNodeOnCaret(a);if(0<parseInt(this.styleInfo.heading,10))g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(this.styleInfo.heading,!1),c=!0;else{if(this.styleInfo.listType.length){var g=g_objNodeUtil.getLoopParentElement(f,this.styleInfo.listType[0].toLowerCase());
null==g&&("UL"==this.styleInfo.listType[0]?fnHandler_SupportCommand_Main(a,"InsertUnOrderedList",!0,void 0,function(a){c=a}):fnHandler_SupportCommand_Main(a,"InsertOrderedList",!0,void 0,function(a){c=a}),f=g_objNodeUtil.getAncestorNodeOnCaret(a),g=g_objNodeUtil.getLoopParentElement(f,this.styleInfo.listType[0].toLowerCase()));if(g)for(b=0;b<this.styleInfo.listType.length&&g.nodeName.toUpperCase()==this.styleInfo.listType[b];b++){this.styleInfo.listStyleType[b]?g.style.listStyleType=this.styleInfo.listStyleType[b]:
g.getAttribute("style")&&g.removeAttribute("style");this.styleInfo.listClassName?g.className=this.styleInfo.listClassName[b]:g.getAttribute("class")&&g.removeAttribute("class");for(d=0;d<g.childNodes.length;d++)"li"==g.childNodes[d].nodeName.toLowerCase()&&(this.styleInfo.listChildClassName[b]?g.childNodes[d].className=this.styleInfo.listChildClassName[b]:g.childNodes[d].getAttribute("class")&&g.childNodes[d].removeAttribute("class"),this.styleInfo.listChildStyle[b]?g.childNodes[d].setAttribute("style",
this.styleInfo.listChildStyle[b]):g.childNodes[d].getAttribute("style")&&g.childNodes[d].removeAttribute("style"));g=g_objNodeUtil.getLoopChildNodeByTagNames(g,["ol","ul"]);if(!g)break}}c=fnHandler_SupportCommand_StyleCopyPaste(a,"bold",!0,this.styleInfo.bold);c=fnHandler_SupportCommand_StyleCopyPaste(a,"Italic",!0,this.styleInfo.italic);c=fnHandler_SupportCommand_StyleCopyPaste(a,"Underline",!0,this.styleInfo.underline);c=fnHandler_SupportCommand_StyleCopyPaste(a,"StrikeThrough",!0,this.styleInfo.strike);
this.styleInfo.subScript||(c=fnHandler_SupportCommand_StyleCopyPaste(a,"superscript",!0,this.styleInfo.superScript));this.styleInfo.superScript||(c=fnHandler_SupportCommand_StyleCopyPaste(a,"subscript",!0,this.styleInfo.subScript));this.styleInfo.fontFamily&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(this.styleInfo.fontFamily,!1,function(a){c=a}));this.styleInfo.fontSize&&!1===this.styleInfo.superScript&&
!1===this.styleInfo.subScript&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(this.styleInfo.fontSize,!1,function(a){c=a}));this.styleInfo.color&&(g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(this.styleInfo.color,!1,DZE_LETTER_COMMAND_FONT_COLOR,function(a){c=a}),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=a));g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;
fnColorCellApply(this.styleInfo.backgroundColor,!1,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR,function(a){c=a});-1==g_nActiveEditNumber&&(g_nActiveEditNumber=a);""!=this.styleInfo.letterSpacing&&g_objLetterSpacingWin.fnLetterSpacingCellClick(this.styleInfo.letterSpacing,!1,function(a){c=a});""!=this.styleInfo.lineHeight&&g_objLineHeightWin.fnLineHeightCellClick(this.styleInfo.lineHeight,!1,function(a){c=a});if(0<=this.styleInfo.textAlign){g=!1;0==this.styleInfo.textAlign&&(g=!0);var h=1==this.styleInfo.textAlign?
"Left":2==this.styleInfo.textAlign?"Center":3==this.styleInfo.textAlign?"Right":4==this.styleInfo.textAlign?"Justify":"Left",k=eval("ID_COMMAND_JUSTIFY_"+h.toUpperCase());fnHandler_Align_Main(a,"Justify"+h,g,k)}}}}}catch(m){dalert(m)}finally{if(!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer();this.unsetPasteStyleMode(a)}},setPasteStyleMode:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&(this.setPasteStyleModeEditArea(a),
this.pasteStyleMode=!0,editor_ondeactivate(a))}catch(b){this.pasteStyleMode=!1,dalert(b)}},unsetPasteStyleMode:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0===this.pasteStyleMode&&(this.pasteStyleMode=!1,this.orgContentEditable=!0,editor_onactivate(null,a),g_objMenuWin.TBMenuSetStateAllEnable(!0,a),g_bMenuEnabled=!0)}catch(b){dalert(b)}},orgContentEditable:!0,setPasteStyleModeEditArea:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&!0!==this.pasteStyleMode&&(null==g_objEditorDocument[a].body.getAttribute("contentEditable")||
""==g_objEditorDocument[a].body.getAttribute("contentEditable")?this.orgContentEditable=null:this.orgContentEditable=g_objEditorDocument[a].body.getAttribute("contentEditable"),g_objEditorDocument[a].body.contentEditable=!1,g_objEditorDocument[a].body.style.cursor="pointer",g_objEditorDocument[a].body.style.cursor="url("+dzeEnvConfig.strPath_Image+"formpaste.cur), url("+dzeEnvConfig.strPath_Image+"formpaste.gif), pointer")}catch(b){dalert(b)}},unsetPasteStyleModeEditArea:function(a){try{!0===dzeUiConfig.bApplyPasteStyleMode&&
!0===this.pasteStyleMode&&(null==this.orgContentEditable?g_objEditorDocument[a].body.removeAttribute("contentEditable"):g_objEditorDocument[a].body.contentEditable=this.orgContentEditable,g_objEditorDocument[a].body.style.cursor="")}catch(b){g_objEditorDocument[a].body.contentEditable=!0,g_objEditorDocument[a].body.style.cursor="",dalert(b)}}};
function getTextInfoFromCurrPosition(a){var b={node:null,value:""};try{if(!GetMultiCellSelection()){var c=!1;if(window.addEventListener){var d=g_objEditWindow[a].getSelection();if(fnObjectCheckNull(d))return;if(1==d.rangeCount){var e=d.getRangeAt(0);if(fnObjectCheckNull(e))return;c=e.collapsed}}else{d=g_objEditorDocument[a].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;""==e.htmlText&&(c=!0)}if(c){var f="commonAncestorContainer"in e?e.commonAncestorContainer:
e.parentElement().childNodes[0];f.nodeType==ID_SELECTION_TEXT_NODE&&(b={node:f,value:f.nodeValue})}else b={node:null,value:getSelectionTextValue(a).trim()}}return b}catch(g){dalert(g)}finally{}return b}
var dzeHighlighter={colorCode:null,orgContentEditable:null,highlightMode:!1,initialize:function(){dzeHighlighter.highlightMode=!1;dzeHighlighter.colorCode=null;dzeHighlighter.orgContentEditable=null},setHighlightMode:function(a,b){try{dzeHighlighter.highlightMode=!0,dzeHighlighter.colorCode=b,null==g_objEditorDocument[a].body.getAttribute("contentEditable")||""==g_objEditorDocument[a].body.getAttribute("contentEditable")?dzeHighlighter.orgContentEditable=null:dzeHighlighter.orgContentEditable=g_objEditorDocument[a].body.getAttribute("contentEditable"),
g_objEditorDocument[a].body.contentEditable=!1,g_objEditorDocument[a].body.style.cursor="pointer",g_objEditorDocument[a].body.style.cursor="url("+dzeEnvConfig.strPath_Image+"highlighter.cur), url("+dzeEnvConfig.strPath_Image+"highlighter.gif), pointer",setEditAreaSelectionCollapse(a,"end"),editor_ondeactivate(a),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_ALERT_HIGHLIGHTER_MODE,1.5)}catch(c){dalert(c)}},unsetHighlightMode:function(a){try{!0===this.highlightMode&&(null==dzeHighlighter.orgContentEditable?
g_objEditorDocument[a].body.removeAttribute("contentEditable"):g_objEditorDocument[a].body.contentEditable=this.orgContentEditable,g_objEditorDocument[a].body.style.cursor="",dzeHighlighter.initialize(),editor_onactivate(null,a),editor_onselectionchange(a))}catch(b){g_objEditorDocument[a].body.contentEditable=!0,g_objEditorDocument[a].body.style.cursor="",dalert(b),dzeHighlighter.initialize()}},setHighlight:function(a){try{!0===dzeHighlighter.highlightMode&&(null===dzeHighlighter.colorCode?dzeHighlighter.unsetHighlightMode(a):
(g_nActiveEditNumber=a,g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(dzeHighlighter.colorCode,!1,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR),g_objUndoRedo.registerUndoRedoStack(0,a),setEditAreaSelectionCollapse(a,"end"),editor_ondeactivate(a)))}catch(b){dalert(b)}}};
function setEditAreaSelectionCollapse(a,b){try{var c=!0;"undefined"!=typeof b&&"end"==b&&(c=!1);if(g_objEditorDocument[a].getSelection){var d=g_objEditWindow[a].getSelection();if(!fnObjectCheckNull(d)&&1==d.rangeCount){var e=d.getRangeAt(0);e.collapse(c);d.addRange(e)}}else g_objEditorDocument[a].selection&&g_objEditorDocument[a].execCommand("Unselect")}catch(f){dalert(f)}}
function isEmptyEditorContents(a){var b=!0;try{var c=getEditorHTMLCode(!1,a);c=c.trim();if(""!=c&&"<p><br /></p>"!=c&&"<p><br></p>"!=c&&"<p>&nbsp;</p>"!=c&&"<p></p>"!=c&&"<br>"!=c&&"<br />"!=c){var d=g_objEditorDocument[a].body.childNodes;for(a=0;a<d.length;a++)if("p"==d[a].nodeName.toLowerCase()){if(1<d[a].childNodes.length){b=!1;break}if(1==d[a].childNodes.length&&"br"!=d[a].childNodes[0].nodeName.toLowerCase()){b=!1;break}}else if(d[a].nodeType==ID_SELECTION_TEXT_NODE){if(""!=d[a].nodeValue.trim()){b=
!1;break}}else{b=!1;break}}return b}catch(e){return dalert(e),b}}
var dzeClipBoard={copyData:[],pasteType:"",initialize:function(){if(!this.copyData||0<this.copyData.length)this.copyData=[]},copySelectedMultiCells:function(a){try{if(!GetMultiCellSelection(a))return!1;var b=this.copyMultiCell(a);if(!b||!this.copyToNativeClipboard(a,b))return!1;this.copyData=[b];cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_CELL_CONTENTS_COPIED,1.5);return!0}catch(c){dalert(c)}},cutSelectedMultiCells:function(a){try{if(!this.copySelectedMultiCells(a))return!1;if(g_readonlyMode)return!0;
var b=GetCurTable(a);return b&&!1!==g_objEditMode.isContentEditable(b)?g_objTableOperation.deleteSelectedCell(a,GetCurTable(a)):!0}catch(c){dalert(c)}},copyMultiCell:function(a){try{if(!GetMultiCellSelection(a))return null;var b=GetCurTable(a),c=b.ownerDocument,d=g_objTableUtil.getMatrix(b);if(!d)return null;var e=d.getSelection();e=e&&e[0]?e[0]:null;if(!e)return null;var f=d.clone();g_objTableUtil.addColgroup(f.table,f);f.removeRow(e.nEndRow+1,d.rowLength-1);f.removeCol(e.nEndCol+1,d.colLength-1);
f.removeRow(0,e.nStartRow-1);f.removeCol(0,e.nStartCol-1);var g=c.createElement("DIV");a=0;for(var h=f.tables.length;a<h;a++)g.appendChild(f.tables[a]);appendBodyTemporary(g,null,function(){g_objSplitUtil.mergeAll(g);g_objSplitUtil.removeAllSplitAttr(g);g_objTableSelection.removeAllCellSelection(g)});var k=g.firstChild;return k&&"TABLE"===k.nodeName?k.outerHTML:""}catch(m){dalert(m)}},copyToNativeClipboard:function(a,b){try{if(!0===fnObjectCheckNull(b)||0===b.length)return!1;"undefined"===typeof a&&
(a=g_nActiveEditNumber);var c=g_objEditorDocument[a],d=g_objEditWindow[a].getSelection(),e=d&&0<d.rangeCount?d.getRangeAt(0):null;if(!e)return!1;var f=new RangeProp(e),g=c.createElement("div");g.innerHTML=b;appendBodyTemporary(g,null,function(){e.selectNodeContents(g);d.removeAllRanges();d.addRange(e);c.execCommand("copy",!1,null)});f.getRange(e);d.removeAllRanges();d.addRange(e);return!0}catch(h){dalert(h)}finally{e=null}},setTableObjToDzeClipData:function(a){try{if(!a||"TABLE"!==a.nodeName)return!1;
dzeClipBoard.copyData=[a.outerHTML];return!0}catch(b){return dalert(b),!1}},paste_insert:function(a,b){try{if(!this.copyData.length||g_readonlyMode)return!1;var c=GetCurTable(a);if(!c||!1===g_objEditMode.isContentEditable(c))return!1;var d=new TableMatrix(c);if(!d)return!1;var e=d.getSelection();if(!e||1<e.length)return!1;e=e[0];var f=g_objEditorDocument[a].createElement("div");f.innerHTML=dzeClipBoard.copyData[0];var g=f.firstChild;if("TABLE"!==g.nodeName)return!1;f=g_objTableOperation;var h=g_objTableUtil;
f.resetRowgroupID(g,9999);g_objTableFlag.removeFlagInfo(g);for(var k=h.getTableCellsLength(g,0),m=null,l=0,n=0;n<k;n++)m=h.getTableCellElement(g,0,n),l+=m.colSpan;var p=h.getTableCellsLength(c,0);k=null;var q=0;for(n=0;n<p;n++)k=h.getTableCellElement(c,0,n),q+=k.colSpan;var t=null;appendBodyTemporary(g,null,function(){t=new TableMatrix(g);q>l?t.insertBlankCol(t.colLength,q-l):q<l&&t.removeCol(q,l-1);l=q;g_objTableUtil.resetTableCellPixelSize(g)}.bind(this));if(!t)return!1;var r=t.removeRow(0,t.rowLength-
1);if(!r)return!1;var z=e.nEndRow,u=f.getRowgroupInfo(c,g_objNodeUtil.getAttribute(c.rows[e.nEndRow],"dze_rowgroup"));u&&(z=u.end);d.splitRow(z+1);insertAfter(d.trs[z],r);f.resetRowgroupID(c,1);g_objTableMiniMenu.delayUpdate(a);if(!1!==b)commonUpdateAfterChange(a,c);else if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(c);return!0}catch(v){dalert(v)}},setDefaultCellProperty:function(a){try{if(a)for(var b=g_objTableUtil,c={backgroundColor:"",border:"1px solid #000000",
padding:"",textAlign:"",verticalAlign:""},d=0,e=a.rows.length;d<e;d++)for(var f=b.getTableCellsLength(a,d),g=0;g<f;g++){var h=b.getTableCellElement(a,d,g),k;for(k in c)h.style[k]=c[k]}}catch(m){dalert(m)}},paste:function(a,b){try{if(!this.copyData.length)return!1;var c=GetCurTable(a),d=GetMultiCellSelection(a);d||c&&g_objTableFlag.ResetTableInfo(!1);var e=g_objEditorDocument[a].createElement("div");e.innerHTML=dzeClipBoard.copyData[0];var f=e.childNodes[0];g_objTableFlag.removeFlagInfo(f);var g=e=
!1,h=g_objTableUtil,k=h.isBizboxReportTable(c),m=h.isBizboxReportTable(f),l=k&&m&&c.getAttribute("dze_desc")!==f.getAttribute("dze_desc");if(!d&&!this.pasteType&&k&&!m||l)g=!0;e||c&&this.pasteType!==INSERT_AS_NESTED_TABLE&&!g||(k&&m&&h.removeBizboxReportTableAttr(f),e=this.pasteTableNest(a,f));var n=GetSelectedCellCount(a);!e&&d&&1<n&&(e=this.pasteTableSelect(a,f));e||(e=this.pasteTableMerge(a,f));if(!0===e)if(!1!==b&&g_objUndoRedo.registerUndoRedoStack(0,a),c){if(g_objTableMiniMenu.delayUpdate(a),
g_objPlaceholder.setAllPlaceholderText(c),dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(c)}else if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();return e}catch(p){return dalert(p),!1}},pasteTableNest:function(a,b){try{return g_objInsertUtil.insertTableAtSelection(b,a)?!0:!1}catch(c){dalert(c)}},pasteTableSelect:function(a,b){try{if(!GetMultiCellSelection(a)||!b)return!1;var c=GetCurTable(a);if(!c||!1===g_objEditMode.isContentEditable(c))return!1;
a=null;var d=new TableMatrix(c);if(!d)return!1;var e=d.getSelection();e=e&&e[0]?e[0]:null;if(!e)return!1;!0===(this.pasteType==KEEP_ORG_TABLE_FORMMAT?!0:!1)&&this.setDefaultCellProperty(b);a=new TableMatrix(b);var f=e.nStartRow,g=e.nEndRow,h=e.nStartCol,k=e.nEndCol;a.insertBlankCol(0,h);a.insertBlankRow(0,f);this.pasteCell(d,a,f,h,g,k);g_objCaretUtil.moveCaret(d.getCell(f,h));return!0}catch(m){dalert(m)}},pasteTableMerge:function(a,b){try{var c=GetCurTable(a);if(!c||!b||!1===g_objEditMode.isContentEditable(c))return!1;
var d=c.ownerDocument;if(!d)return!1;var e=null,f=new TableMatrix(c);if(!f)return!1;var g=f.getSelection();g=g&&g[0]?g[0]:null;if(!g)return!1;var h=g_objNodeUtil.getClosetBound(c);if(!h)return!1;g_objTableUtil.addColgroup(c);g_objTableUtil.addColgroup(b);var k=this.pasteType===KEEP_ORG_TABLE_FORMMAT?!0:!1,m=g.nStartRow,l=0,n=g.nStartCol,p=0,q=null,t=f.calculateColWidth(),r=d.createElement("div");r.appendChild(b);var z={width:g_objPositionUtil.getInnerWidth(h)};appendBodyTemporary(r,z,function(){!0===
k&&this.setDefaultCellProperty(b);e=new TableMatrix(b);l=m+e.rowLength-1;p=n+e.colLength-1;e.insertBlankCol(0,n);e.insertBlankCol(e.colLength,f.colLength-e.colLength);var a=0;var c=m;for(var d=0,g=f.tables.length;d<g&&0<c;d++){var h=f.tables[d].rows.length;var r=c>=h?h:c;c-=h;e.insertBlankRow(a,r);a=r}a=e.rowLength;c=f.rowLength-e.rowLength;for(d=f.tables.length-1;0<=d&&0<c;d--)h=f.tables[d].rows.length,r=c>=h?h:c,c-=h,e.insertBlankRow(a,r);q=e.calculateColWidth();e.calculateRowHeight();g_objTableUtil.resetTableCellPixelSize(b)}.bind(this));
if(!e)return!1;a=g_objNodeUtil;c=g_objTableUtil;l>=f.rowLength&&f.insertRow(f.rowLength,l-f.rowLength+1);this.pasteCell(f,e,m,n,l,p);if(p>=f.colLength){var u=e.clone();u.removeRow(f.rowLength,e.rowLength-f.rowLength);var v=u.removeCol(f.colLength,p);if(v){for(u=0;u<f.rowLength;u++){var w=d.createDocumentFragment();a.moveNodesTo(w,v.childNodes[u].firstChild);f.trs[u].appendChild(w)}var x=e.arraySum(t),y=e.arraySum(q,f.colLength,p);c.setTableWidth(f.tables,x+y);if(0<f.colgroups.length){var A=d.createDocumentFragment();
for(u=f.colLength;u<=p;u++){var B=d.createElement("col");B.style.width=q[u];A.appendChild(B)}u=0;for(var D=f.colgroups.length;u<D;u++)a.getImmediateChildNodesByTagName(f.colgroups[u],"col")[0].parentNode.appendChild(A.cloneNode(!0))}f.makeMatrix()}}dzeUiConfig.bUsePasteOptionMenu&&g_objPasteOptionMenu.setPasteEndNode(f.getCell(m,n));g_objCaretUtil.moveCaret(f.getCell(m,n));return!0}catch(C){return dalert(C),!1}},pasteCell:function(a,b,c,d,e,f){try{if(!a||!b)return!1;for(var g=this.pasteType===KEEP_ORG_TABLE_FORMMAT?
!0:!1,h=g_objNodeUtil,k=g_objTableUtil,m=g_objPropertyUtil;c<=e&&c<a.rowLength;c++)for(var l=d;l<=f&&l<a.colLength;l++)if(b.isShow(c,l)&&a.isShow(c,l)){var n=b.getCell(c,l),p=a.getCell(c,l);if(n&&p){var q=n.cloneNode(!0);if(!1===g){var t=m.getStyleWidth(p);t&&k.setNodeValue_Width(q,t,"px");(t=m.getStyleHeight(p))&&k.setNodeValue_Height(q,t,"px");k.setColspan(q,k.getColspan(p));k.setRowspan(q,k.getRowspan(p));var r=p.getAttribute("cusflag");r&&q.setAttribute("cusflag",r);p.parentNode.replaceChild(q,
p)}else h.removeAllChild(p),h.moveNodesTo(p,q.firstChild)}}return!0}catch(z){dalert(z)}},pasteOlUl:function(a,b,c){try{c=g_objNodeUtil;var d=g_objListUtil;if(!c.isList(a)||!GetCurList(b))return!1;SelectionUtil.deleteSelection(b);var e=GetCurRange(b);if(!e||!e.collapsed)return!1;var f=GetCurList(b);if(!f)return!1;for(;a.firstChild===a.lastChild&&c.isList(a.firstChild);)a=a.firstChild;d.removeFirstLastBlankLi(a);var g=f.ownerDocument,h=g.createElement("span");e.insertNode(h);c.insertBrIfSplitAtLast(f,
h);c.splitOn(f,h);var k=h.previousSibling,m=h.nextSibling;c.isBlankPara(k)&&k.parentNode.removeChild(k);var l=g.createDocumentFragment();c.moveNodesTo(l,a.firstChild);h.parentNode.replaceChild(l,h);h=g.createElement("span");m.firstChild?m.insertBefore(h,m.firstChild):m.appendChild(h);g_objPasteOptionMenu.setPasteEndNode(h);g_objCaretUtil.moveCaret(m);return!0}catch(n){dalert(n)}}};
function unselectEditorParentBody(){try{if(document.getSelection){var a=window.getSelection();if(!fnObjectCheckNull(a)&&1==a.rangeCount){var b=a.getRangeAt(0);b.collapse(!0);a.removeAllRanges();a.addRange(b)}}else document.selection&&document.execCommand("Unselect")}catch(c){dalert(c)}}
function unselectEditorDocumentBody(a){try{if(g_bBrowserType_IE)if(window.attachEvent)g_objEditorDocument[a].execCommand("Unselect");else{var b=g_objEditWindow[a].getSelection();if(!fnObjectCheckNull(b)){var c=b.getRangeAt(0);c.collapse(!0);b.addRange(c);b.removeAllRanges()}}else g_bBrowserType_WK&&(b=g_objEditWindow[a].getSelection(),fnObjectCheckNull(b)||b.removeAllRanges())}catch(d){dalert(d)}}
function makeDownloadHtmlCode(a){try{var b=getEditorPreviewHTML(a);return'<div style="width:'+(dzeUiConfig.nSettingPaperSize.width-dzeUiConfig.nSettingPaperMargin.left-dzeUiConfig.nSettingPaperMargin.right+"mm")+';height:auto;padding:0;margin:auto;">'+b+"</div>"}catch(c){dalert(c)}}String.format=function(){for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(new RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a};
function initializeDocFocus(a){try{!1===dzeUiConfig.bOfficePagingMode&&g_objEditorDocument[a].body.focus(),editor_onselectionchange(a),g_objMenuWin.TBMenuSetStateAllEnable(!0,a)}catch(b){dalert(b)}}
function applyTabKeyAction(a,b,c){try{if(!c||c.cancelBubble)return!1;if(a){var d=document.createElement("span");d.className="tabSpan";d.innerHTML="\t";insertHTMLCodeAtSelection(null,d,b);g_objUndoRedo.registerUndoRedoStack(0,b);return!0}return 0<removeSpanTabSelection(b)?(g_objUndoRedo.registerUndoRedoStack(0,b),!0):!1}catch(e){dalert(e)}finally{range=null}}
function getObjectClone(a){try{if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=getObjectClone(a[c]));return b}catch(d){dalert(d)}}function fnHandler_downloadHTML(a){try{a=!0===fnObjectCheckNull(a)?"sampleDoc":a,duzon_http.showLoading(),makeSaveHTMLContent(a,!0,function(b){duzon_http.hideLoading();b&&downloadHtmlToFile(b,a,"text/html","html")})}catch(b){dalert(b)}}
function makeSaveHTMLContent(a,b,c){try{b=!0===fnObjectCheckNull(b)?!0:b;getEditorHTMLCode(!1,g_nActiveEditNumber,!0,!0);var d=parseInt(g_nActiveEditNumber,10)+DZE_IFRAME_TMP_NO,e=g_objEditorDocument[d];replaceEditorTempTagsFromEditor(d);setFullUrlAttachFiles(e);for(var f=e.images,g=0,h=f.length,k=0;k<h;k++)(function(){var d=f[k];if(!1===b)toDataURL(d.src,function(a){d.outerHTML=d.outerHTML.replace(d.src,a);g+=1;h===g&&c(e.body.innerHTML)},"image/"+d.src.substr(d.src.lastIndexOf(".")+1),function(){c(null)});
else{var l=d.src.substr(d.src.lastIndexOf(".")+1).toLowerCase();toDataURL(d.src,function(a,b){downloadSrcToFile(a,"attachment_img_"+b,200*b)},"image/"+l,function(){c(null)},g);d.outerHTML=d.outerHTML.replace(d.src,dzeEnvConfig.strPath_Document+a+"/attachment_img_"+g+"."+l);g+=1;h===g&&c(e.body.innerHTML)}})()}catch(m){dalert(m)}}
function downloadHtmlToFile(a,b,c,d){try{var e=document.createElement("a");e.setAttribute("download",b+"."+d);e.setAttribute("href","data:"+c+";charset=utf-8,"+encodeURIComponent(a));e.click()}catch(f){dalert(f)}}function downloadSrcToFile(a,b,c){try{setTimeout(function(){var c=document.createElement("a");c.setAttribute("download",b.toLowerCase());c.setAttribute("href",a);c.click()},c)}catch(d){dalert(d)}}
function makePrintableContent(a,b){try{if("undefined"!=typeof a&&null!==a){var c=convVideoToImage(a.body,b),d=document.createElement("div");d.id="totalPrintContainer";c.firstChild?c.insertBefore(d,c.firstChild):c.appendChild(d);for(var e in dzeUiConfig.nSettingPaperSize)dzeUiConfig.nSettingPaperSize[e]=parseFloat(dzeUiConfig.nSettingPaperSize[e]);for(var f in dzeUiConfig.nSettingPaperMargin)dzeUiConfig.nSettingPaperMargin[f]=parseFloat(dzeUiConfig.nSettingPaperMargin[f]);dzeUiConfig.bUseHeaderFooter&&
g_objHeaderFooter.clearCache();if("undefined"==typeof g)var g="print";b=e=0;var h=makePageContainer(e),k=h.childNodes[1];d.appendChild(h);b++;for(f=0;2<c.childNodes.length;){f++;if(1E5<f)break;"div"==c.childNodes[2].nodeName.toLowerCase()&&"dze_printpagebreak"==c.childNodes[2].className?(d.appendChild(h),d.appendChild(c.childNodes[2]),e+=1,h=makePageContainer(e),k=h.childNodes[1],d.appendChild(h),b++):k.appendChild(c.childNodes[2])}if((h=g_objPageNumber)&&0!==h.type){e=k=0;for(var m=d.childNodes.length;k<
m;k++){var l=d.childNodes[k];l&&"DIV"===l.nodeName&&"dze_printpagebreak"!==l.className&&l.appendChild(h.createDiv(l,e++,b))}}""!=dzeUiConfig.sWatermarkImageSrc&&(changeCss(".watermarkContainer","width",dzeUiConfig.nSettingPaperSize.width+"mm",a),changeCss(".watermarkContainer","height",dzeUiConfig.nSettingPaperSize.height+-1+"mm",a),toDataURL(dzeUiConfig.sWatermarkImageSrc,function(b){var c=document.createElement("style");c.innerHTML=".watermarkContainer{background: url('"+b+"') no-repeat center center;}";
a.head.appendChild(c)},"image/png"));for(;d.childNodes.length;)c.appendChild(d.childNodes[0]);c.removeChild(d)}}catch(n){dalert(n)}}
var makePageContainer=function(a){function b(a){for(var b in a)a[b]=Math.ceil(g_objCommonUtil.convMMToPx(a[b]));return a}try{var c=g_objHeaderFooter,d=cloneSimpleObject(dzeUiConfig.nSettingPaperSize),e=cloneSimpleObject(dzeUiConfig.nSettingPaperMargin),f=dzeUiConfig.sSettingPaperColor;d=b(d);e=b(e);var g=d.width-e.left-e.right,h=d.height-e.top-e.bottom,k=c.getHeaderContainerHeight(a),m=c.getFooterContainerHeight(a),l=Math.max(e.top,k),n=d.height-(l+Math.max(e.bottom,m)),p=c.getPageHeaderContents(a),
q=c.getPageFooterContents(a),t=c.isBlankHeaderFooter(c.getHeader(a)),r=c.isBlankHeaderFooter(c.getFooter(a));t&&(e.headerTop=0);r&&(e.footerBottom=0);""==f&&(f="#FFFFFF");var z=dzeUiConfig.bOfficeOnePageLongMode,u=document.createElement("div");u.className="dze_print_page_container";u.style.position="relative";u.style.width=d.width+"px";u.style.overflow="hidden";u.style.height=!0===z?"auto":d.height+-1+"px";u.style.padding="0";u.style.backgroundColor=f;var v=document.createElement("div");v.className=
"dze_print_page_header";v.style.width=g+"px";v.style.minHeight=Math.max(e.top-e.headerTop,0)+"px";v.style.maxHeight=Math.ceil(d.height/2-10-e.headerTop)+"px";v.style.padding=e.headerTop+"px "+e.right+"px 0px "+e.left+"px";v.style.position="relative";v.style.zIndex="1";v.innerHTML=p;if(c.getHeaderContentsHeight(a)>l){var w=document.createElement("div");w.style.position="absolute";w.style.top=l+"px";w.style.left="0px";w.style.right="0px";w.style.height=n+"px";w.style.backgroundColor=f;v.appendChild(w)}var x=
document.createElement("div");x.className="dze_print_page_main";x.style.width=g+"px";!0===dzeUiConfig.bOfficeOnePageLongMode?(x.style.height="auto",x.style.overflow="visible",x.style.minHeight=h+"px"):(x.style.height=n+"px",x.style.maxHeight=h+"px");x.style.padding="0px "+e.right+"px 0px "+e.left+"px";x.style.position="relative";x.style.zIndex="2";var y=document.createElement("div");y.className="dze_print_page_footer";y.style.width=g+"px";y.style.minHeight=Math.max(e.bottom-e.footerBottom+-1,0)+"px";
y.style.maxHeight=Math.ceil(d.height/2-e.footerBottom-10)+"px";y.style.padding="0px "+e.right+"px "+e.footerBottom+"px "+e.left+"px";y.style.position="relative";y.style.zIndex="1";y.innerHTML=q;if(r)y.style.marginTop="0px",y.style.paddingBottom="0px";else{var A=c.getFooterHeight(a);y.style.marginTop=Math.max(e.bottom-A,0)+"px"}u.appendChild(v);u.appendChild(x);u.appendChild(y);a=null;""!=dzeUiConfig.sWatermarkImageSrc&&(a=document.createElement("div"),a.className="watermarkContainer",a.style.zIndex=
"3",u.appendChild(a));!0!==dzeUiConfig.bOfficeOnePageLongMode&&!0===dzeUiConfig.bUsebottomCreatorBackgroundStyle&&u.appendChild(g_objPageControl.makePageBottomCreator());return u}catch(B){dalert(B)}};
function setPositionAbsoluteForWebkitBug(a){function b(a){return e(a,1,function(a){return g_objPropertyUtil.hasClass(a,"dze_print_page_container")})}function c(a){return e(a,1,function(a){return g_objPropertyUtil.hasClass(a,["dze_print_page_main","dze_shape_anchor"])})}function d(a){return e(a,0,function(a){return g_objPropertyUtil.hasClass(a,["dze_print_page_main","dze_shape_anchor"])})}function e(a,b,c){var d=g_objCommonUtil,e=0===b?a.offsetLeft:a.offsetTop;if(!d.IS_VALID_VALUE(e))return 0;for(var f=
a.offsetParent;f&&!0!==c(f);)a=0===b?f.offsetLeft:f.offsetTop,d.IS_VALID_VALUE(a)||(a=0),e+=a,f=f.offsetParent;return e}function f(a,c){if(!a)return!1;var d=b(a);a=d+a.offsetHeight;return a>=c&&a<=c+d?!0:!1}function g(a,b){try{if(a&&""===a.style.position){var e=d(a),f=c(a),g=f+a.offsetHeight,h=g_objPropertyUtil.getMargin(a,0),l=g_objPropertyUtil.getMargin(a,1),k=a.cloneNode(!0);k.style.visibility="hidden";k.style.height=Math.max(0,b-g);a.parentNode.insertBefore(k,a);a.style.position="absolute";a.style.left=
e-h+"px";a.style.top=f-l+"px"}}catch(w){dalert(w)}}try{if(g_browserCHK.wk){var h=a.querySelector("div.dze_print_page_container");if(h){var k=h.offsetHeight,m=[].slice.call(a.getElementsByTagName("img"));a=0;for(var l=m.length;a<l;a++)f(m[a],k)&&g(m[a],k)}}}catch(n){dalert(n)}}
function waitImgLoad(a){return new Promise(function(b,c){c=a.querySelectorAll("img");var d=c.length;if(0>=d)b();else for(var e=null,f=0,g=d;f<g;f++)e=c[f],e.complete?(d--,0>=d&&b()):e.onload=e.onerror=function(){this.onload=this.onerror=null;d--;0>=d&&b()}})}
function waitCssLoad(a){return new Promise(function(b,c){c=a.head.querySelectorAll("link[rel='stylesheet']");var d=c.length;if(0>=d)b();else for(var e=null,f=0,g=d;f<g;f++)e=c[f],e.onload=e.onerror=function(){this.onload=this.onerror=null;d--;0>=d&&b()}})}
function convVideoToImage(a,b){try{if(!a||!a.firstChild)return a;var c=a.ownerDocument,d=a.getElementsByTagName("video");b=null;for(var e=d.length-1;0<=e;e--){b=c.createElement("span");b.className="dze_video_guide_box";var f=300,g=200;d[e].getAttribute("width")&&(f=parseInt(d[e].getAttribute("width"),10));d[e].style.width&&(f=parseInt(d[e].style.width.replace(/px/,""),10));d[e].getAttribute("height")&&(g=parseInt(d[e].getAttribute("height"),10));d[e].style.height&&(g=parseInt(d[e].style.height.replace(/px/,
""),10));b.style.width=f-2+"px";b.style.height=g-2+"px";d[e].parentNode.insertBefore(b,d[e]);d[e].parentNode.removeChild(d[e])}d=a.querySelectorAll("span.dze_video_iframe_container_span>iframe");forEach(d,function(a,b){(a=createYoutubeImg(b))&&b.parentNode.replaceChild(a,b)},this);return a}catch(h){return dalert(h),a}}
function createYoutubeImg(a){try{if(!a||"IFRAME"!==a.nodeName)return null;var b=a.src;if(!b||0>b.indexOf("//www.youtube.com"))return null;var c=b.split("/"),d=c.indexOf("embed");if(0>d||d+1>=c.length)return null;var e=c[d+1].split("?");if(!e||!e[0])return null;var f="https://img.youtube.com/vi/"+e[0]+"/mqdefault.jpg",g=a.ownerDocument.createElement("img");g.src=f;g.style.width=a.style.width||a.width;g.style.height=a.style.height||a.height;a.hasAttribute("allowfullscreen")&&g.setAttribute("allowfullscreen",
"");a.hasAttribute("allow")&&g.setAttribute("allow",a.getAttribute("allow"));return g}catch(h){dalert(h)}}
function createYoutubeIframe(a,b){try{if(!a||"IMG"!==a.nodeName)return null;var c=a.src;if(!c||0>c.indexOf("//img.youtube.com"))return null;var d=c.split("/"),e=d.indexOf("vi");if(0>e||e+2>=d.length)return null;var f=d[d.length-1];if(!(startsWith(f,"mqdefault.jpg")||startsWith(f,"hqdefault.jpg")||startsWith(f,"sddefault.jpg")||startsWith(f,"maxresdefault.jpg")))return null;var g="https://www.youtube.com/embed/"+d[e+1];if(!0===b){b="<iframe";var h=a.parentNode;if(h&&1===h.nodeType&&"SPAN"===h.nodeName&&
g_objPropertyUtil.hasClass(h,"dze_video_iframe_container_span")){var k=h.style.width||h.width;k&&(b+=' width="'+k+'"');var m=h.style.height||h.height;m&&(b+=' height="'+m+'"')}b+=' src="'+g+'" frameborder="0"';a.hasAttribute("allow")&&(b+=' allow="'+a.getAttribute("allow")+'"');a.hasAttribute("allowfullscreen")&&(b+=" allowfullscreen");return b+"></iframe>"}var l=a.ownerDocument.createElement("iframe");l.src=g;l.style.width=a.style.width||a.width;l.style.height=a.style.height||a.height;l.setAttribute("frameborder",
0);a.hasAttribute("allowfullscreen")&&l.setAttribute("allowfullscreen","");a.hasAttribute("allow")&&l.setAttribute("allow",a.getAttribute("allow"));return l}catch(n){dalert(n)}}
function checkDzeCellLocked(a,b){try{if(!0!==dzeUiConfig.bUseLockEditCellFunction||a.keyCode==ID_KEYCODE_ARROW_LEFT||a.keyCode==ID_KEYCODE_ARROW_TOP||a.keyCode==ID_KEYCODE_ARROW_RIGHT||a.keyCode==ID_KEYCODE_ARROW_BOTTOM||a.keyCode==ID_KEYCODE_TAB||a.ctrlKey&&!a.altKey&&!a.shiftKey&&(a.keyCode==ID_KEYCODE_Z||a.keyCode==ID_KEYCODE_Y))return!1;var c=g_objNodeUtil.getAncestorNodeOnCaret(b);if(!c)return!1;var d=g_objNodeUtil.getLoopParentElement(c,"td");return d?g_objTableFunction.isCellLocked(d):!1}catch(e){return dalert(e),
!1}}function setSelectionColor(a,b){try{if(!g_readonlyMode||"transparent"!==b){var c=g_objEditorDocument[a].head.querySelector("style#dze_selections");if(c){var d=c.getAttribute("cur_color")||"rgba(95,128,215,0.3)";a=b||"rgba(95,128,215,0.3)";d!==a&&(c.innerHTML="::-moz-selection { background-color: "+a+"} ::selection { background-color: "+a+" }",c.setAttribute("cur_color",a))}}}catch(e){return dalert(e),!1}}
function getSelectionColor(a){try{var b=g_objEditorDocument[a].head.querySelector("style#dze_selections");return b?b.getAttribute("cur_color")||"rgba(95,128,215,0.3)":"rgba(95,128,215,0.3)"}catch(c){dalert(c)}}function calculateDateDiff(a,b){try{var c=Math.abs(b.getTime()-a.getTime());return c=Math.ceil(c/864E5)}catch(d){dalert(d)}}
function getOnefficeDocumentFromContent(a,b){try{"undefined"==typeof b&&(b="bizbox_report");var c=getFullUrlFromPath(g_strContentsCSS+"?ver="+objOnefficeLoader.getVer()),d=getFullUrlFromPath(dzeEnvConfig.strPath_CSS+"editor_style_inherit.css?ver="+objOnefficeLoader.getVer()),e="<style>";e+=GetInitStyleString(!0,!1);var f=document.createElement("div");f.innerHTML=a;var g=f.querySelectorAll("div.dze_printpagebreak");forEach(g,function(a,b){b.parentNode&&b.parentNode.removeChild(b)});g=g_objSplitUtil;
g.mergeAll(f);g.removeAllSplitAttr(f);var h=f.getElementsByTagName("dze_doc_property")[0].getAttribute(DZE_CUSTOM_ATT_PAGEMARGIN).split(","),k=210-parseInt(h[1],10)-parseInt(h[3],10);f.style.width=k+"mm";f.style.padding="10px";f.style.margin="auto";f.id="oneffice_content";var m=f.getElementsByTagName("video");k=h="";for(g=0;g<m.length;g++)if(h=m[g].firstChild.src,"undefined"!=typeof h&&null!=h&&""!=h&&"bizbox_report"==b&&0<=h.indexOf(ONEFFICE_SERVER_API_GET_ATTACHMENTDATA+"?")){h=m[g].firstChild.src;
var l=h.split("/gw/onefficeApi/")[0];k=parseURL(h);var n=k.searchObject.seq;if("undefined"!=typeof n&&null!=n&&""!=n){var p=n.split("-")[0];if(0<=l.indexOf("bizboxa.com")){var q=onefficeUtil.getRequestParameter("groupseq");m[g].firstChild.src=l+"/upload/"+q+"/onefficeFile/report/"+p+"/"+n}else m[g].firstChild.src=l+"/upload/onefficeFile/report/"+p+"/"+n;m[g].firstChild.src=m[g].firstChild.src.replace("//gwa.duzon.com","//mgwa.duzon.com")}}if("bizbox_report"===b){var t=f.querySelectorAll("div.oneffice_qrcode_first_container, div.oneffice_qrcode_last_container");
forEach(t,function(a,b){b.parentNode.removeChild(b)},this)}e+="body {margin: 0}";e+=" .dze_tb_layout_td{border:0 !important; } ";e+="</style>";b="<html>";b+="<head>";b+='<meta http-equiv="content-type" content="text/html; charset=utf-8">';b+='<meta name="viewport" content="width=device-width">';b+="<title>Oneffice Document</title>";b+="<link rel='stylesheet' href='"+c+"'>";b+="<link rel='stylesheet' href='"+d+"'>";b+=e;b+="</head>";b+="<body>";b+=f.outerHTML;return b+"</body></html>"}catch(r){return dalert(r),
a}}function setEditBodyStyle(a,b){try{for(var c="body, td, th, p { ",d=0;d<b.length;d++)c+=b[d]+";",0==b[d].indexOf("font-size")&&(g_strBodyFontSize=b[d].split(":")[1].trim()),0==b[d].indexOf("font-family")&&(g_strBodyFontFamily=b[d].split(":")[1].trim());c+=" }";var e=g_objEditorDocument[a].head,f=document.createElement("style");f.innerHTML=c;e.appendChild(f)}catch(g){dalert(g)}}
function getCaretNodeWalker(a,b){try{if(!a)return null;var c=g_objNodeUtil,d=null;if(b)d=b;else for(d=a;d&&!c.isLoopBreakNode(d);)d=d.parentNode;if(!d)return null;var e=d.ownerDocument,f=c.isPageMain(d),g=function(b){return a&&a===b?NodeFilter.FILTER_ACCEPT:0===g_objSelectedShapesArray.length&&c.isNodeInShape(b)?NodeFilter.FILTER_REJECT:c.canCaretExistOn(b)};g_bBrowserType_IE||(g={acceptNode:g});var h=e.createTreeWalker(d,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,g,!1),k=h.firstChild();if(!k)return null;
for(;k!==a;)if(k=h.nextNode(),!k)return null;if(!h.currentNode)return null;var m=0;return{currentNode:function(){return h.currentNode},prevNode:function(){var a=this.currentNode(),b=h.previousNode();if(!b&&f){b=g_objPageControl;a=b.getPageNum(a);if(null===a)return null;a=b.getPageMain(a-1);if(!a)return null;h=e.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,g,!1);if(!h)return null;b=h.lastChild()}b&&m--;return b},nextNode:function(){var a=this.currentNode(),b=h.nextNode();if(!b&&
f){b=g_objPageControl;a=b.getPageNum(a);if(null===a)return null;a=b.getPageMain(a+1);if(!a)return null;h=e.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,g,!1);if(!h)return null;b=h.firstChild()}b&&m++;return b},init:function(){var a;if(0>m){var b=Math.abs(m);for(a=0;a<b;a++)this.nextNode()}if(0<m)for(b=m,a=0;a<b;a++)this.nextNode()},getNextNodeOutside:function(a){if(!a)return null;for(var b=m,c=this.nextNode();c&&1===a.nodeType&&a.contains(3===c.nodeType?c.parentNode:c);)c=this.nextNode();
a=m-b;for(b=0;b<a;b++)this.prevNode();return c},getPrevNodeOutside:function(a){if(!a)return null;for(var b=m,c=this.prevNode();c&&1===c.nodeType&&a.contains(3===c.nodeType?c.parentNode:c);)c=this.prevNode();"TABLE"===a.nodeName&&c&&c.firstChild===a&&g_objNodeUtil.isListItem(c)&&(c=this.prevNode());a=b-m;for(b=0;b<a;b++)this.nextNode();return c}}}catch(l){dalert(l)}}
function deleteAlonePara(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||a.modifierKey)return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed||!b.startContainer)return!1;var c=b.startContainer.childNodes[b.startOffset]||b.startContainer;a=g_objNodeUtil;var d=a.getLoopParentElementByTagNames(c,"p ol ul dl h1 h2 h3 h4 h5 h6".split(" "));if(!d||d.nextSibling&&(d.nodeName===d.nextSibling.nodeName||a.checkTagName(d,"p","ol","ul","dl")&&a.checkTagName(d.nextSibling,"p","ol","ul","dl")))return!1;
if(a.isList(d)){b=["li","dt","dd"];var e=a.getLoopParentElementByTagNames(c,b);if(!e||e.nextSibling&&e.nodeName===e.nextSibling.nodeName)return!1;e.previousSibling&&0<=b.indexOf(e.previousSibling.nodeName.toLowerCase())&&(d=e)}var f=g_objNodeUtil.getClosetBound(d);if(!f||!(f.firstChild!==d||d.nextSibling||g_objPropertyUtil.hasClass(f,"dze_page_main")&&0!==g_objPageControl.getPageNum(f)&&!0!==dzeUiConfig.bOfficePgOverflowVisible||a.isCell(f)&&g_objSplitUtil.getPreviousSplitSibling(f))||a.isNodeInShape(c)||
!g_objNodeUtil.isBlankPara(d))return!1;walker=getCaretNodeWalker(c);if(!walker)return!1;var g=walker.getNextNodeOutside(d);if(a.isCell(f)){var h=a.getClosetBound(g);if(f!==h){var k=walker.getPrevNodeOutside(d);k&&(g=k)}}g||(g=walker.getPrevNodeOutside(d));if(!g)return!1;dlog("delete para direct");var m=0!==(d.compareDocumentPosition(g)&Node.DOCUMENT_POSITION_PRECEDING);g_objCaretUtil.moveCaret(g,!0,!m);c=g_objPageControl;var l=c.getPageNum(d);l===c.getPageNum(g)&&(l=null);d.parentNode.removeChild(d);
if(null!==l)c.onSetDelayedUpdatePageTimer(0,l);return!0}catch(n){dalert(n)}}
function checkOnlyBlankPara(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_DELETE&&a.keyCode!==ID_KEYCODE_BACKSPACE||!0!==dzeUiConfig.bOfficePgOverflowVisible&&1<g_objPageControl.getTotalPageCount())return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed||!b.startContainer)return!1;a=g_objNodeUtil;for(var c=b.startContainer;c&&!a.isLoopBreakNode(c.parentNode);)c=c.parentNode;if(!c||"P"!==c.nodeName||!a.isLoopBreakNode(c.parentNode)||!a.isBlankPara(c))return!1;var d=c.previousSibling,
e=c.nextSibling;return d&&!a.isDocFirstNode(d)||e&&!a.isDocLastNode(e)?!1:!0}catch(f){dalert(f)}finally{}}
function setSafariPatch(a){try{var b=g_objEditorDocument[a].body.getElementsByTagName("td"),c=null;if(0<b.length)for(var d=0;d<b.length;d++)0<b[d].childNodes.length&&"table"==b[d].firstChild.nodeName.toLowerCase()&&(c=document.createElement("p"),c.className="dze_hide_para",c.innerHTML="<br />",b[d].insertBefore(c,b[d].firstChild));var e=g_objEditorDocument[a].body.getElementsByClassName("dze_hide_para");if(0<e.length)for(d=e.length-1;0<=d;d--)"td"==e[d].parentNode.nodeName.toLowerCase()&&!e[d].previousSibling&&
e[d].nextSibling&&"table"==e[d].nextSibling.nodeName.toLowerCase()||e[d].parentNode.removeChild(e[d])}catch(f){dalert(f)}}function setTabSpanInlineStyle(a){try{if(a){var b=a.querySelectorAll("span.tabSpan");forEach(b,function(a,b){b.style.whiteSpace="pre"})}}catch(c){dalert(c)}}
function pasteOnefficeLink(a,b){try{if(!0===dzeUiConfig.bApplyPasteOnefficeLink){var c="";(c=(a.clipboardData||window.clipboardData).getData("Text"))&&(c=c.trim());if(c&&isValidURL(c)){var d=c;g_objCopyPaste.setTimeoutForPaste(function(){g_objCopyPaste.pause();parseOpenGraphData(d,function(a){g_objCopyPaste.resume();var c=d;a&&a.title&&(c=a.title+" "+ID_RES_CONST_STRING_DIRECT_GO+" \u25b6");isOnefficeURL(d)?(!1===objOnefficeLoader.m_bDomainDuzon&&changeCss(".dze_oneffice_link_flag","background-image",
"url(./image/Oneffice_beta.png)",document),a='<a href="'+d+'" target="_blank" class="dze_oneffice_link_flag">'+c+"</a> "):a='<a href="'+d+'" target="_blank">'+c+"</a> ";if(g_objCopyPaste.isPasting()){if(c=g_objCopyPaste.getPasteDiv())c.innerHTML="<p>"+a+"</p>"}else insertHTMLCodeAtSelection(a,null,b)})})}}}catch(e){dalert(e)}}var webContentSearchLoopCnt=0;
function parseOpenGraphData(a,b,c){if(a&&b)if(2<webContentSearchLoopCnt)b(null);else{"undefined"==typeof c&&(c="utf-8");webContentSearchLoopCnt++;try{duzon_http.ajax({type:"get",url:dzeEnvConfig.strGetWebContentURL,async:!0,data:{url:a,charSet:c},timeout:5E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(d){var e={title:"",description:"",image:"",type:""};if(""!=d)try{var f=d.match(/[\s]*[\t]*<meta[\s]+[^>]*(charset|og:)[^>]*>[\s]*[\t]*/gi);if(null!=f&&f.length){var g=
document.createElement("head");g.innerHTML=f.join("");var h=g.getElementsByTagName("meta");d="utf-8";for(f=0;f<h.length;f++){if("utf-8"==c){if(h[f].getAttribute("charset")){d=h[f].getAttribute("charset").toLowerCase();if(d!=c){parseOpenGraphData(a,b,d);return}continue}if(h[f].getAttribute("content")&&h[f].getAttribute("content").toLowerCase().indexOf("charset")){var k=h[f].getAttribute("content").toLowerCase().split(";");g="";for(var m=[],l=0;l<k.length;l++)if(g=k[l].trim(),!(0>g.indexOf("="))&&(m=
g.split("="),"charset"==m[0]&&m[1]!=c)){parseOpenGraphData(a,b,m[1]);return}}}if(h[f].getAttribute("property")&&0==h[f].getAttribute("property").indexOf("og:")&&h[f].getAttribute("content")){var n=h[f].getAttribute("property").replace(/^og:/,"");e[n]=h[f].getAttribute("content")}}}}catch(p){webContentSearchLoopCnt=0,dalert("parseOpenGraphData mata error")}webContentSearchLoopCnt=0;b(e)},error:function(a){webContentSearchLoopCnt=0;dalert("error:parseOgData");b(null)}})}catch(d){webContentSearchLoopCnt=
0,dalert(d),b(null)}}}
function uploadCurrentDocumentImageFromElement(a,b,c){function d(a){if(!a)return null;var b=null;"TD"===a.nodeName||"TH"===a.nodeName?(a=a.style.backgroundImage,a=a.replace(/["']+/g,""),startsWith(a,"url(")&&endsWith(a,")")&&(b=a=a.slice(4,-1))):b=a.src;return b}function e(a,b){if(a&&b){var c=m;"TD"===a.nodeName||"TH"===a.nodeName?a.style.backgroundImage='url("'+b+'")':(a.hasAttribute("srcset")&&a.removeAttribute("srcset"),a.hasAttribute("sizes")&&a.removeAttribute("sizes"),a.src=b,a.onerror=function(){this.getAttribute("dzeErrCnt")||
(this.setAttribute("dzeErrCnt",1),this.src=c)})}}try{b=b||function(){};c=c||function(){};if(!a||1!==a.nodeType&&11!==a.nodeType)return c();var f=null;if("IMG"===a.nodeName)f=[a];else{f=[];var g=[].slice.call(a.querySelectorAll("img[src]"));f=f.concat(g);g=[].slice.call(a.querySelectorAll("td[style*='background-image:'],th[style*='background-image:']"));f=f.concat(g)}var h=objOnefficeLoader.m_bDomainBizwatch&&onefficeExtContent.mainDomain?"ttcdn."+onefficeExtContent.mainDomain[onefficeExtContent.indexEnv]+
".co.kr":"";for(a=0;a<f.length;a++){g=!1;var k=f[a],m=d(k);if(!0===dzeUiConfig.bSupportNewsEditor){if(m&&h.length&&-1===m.indexOf(h))return c({error:"prevent",img:k});g=!0}m&&0!=m.indexOf("data:image")||(g=!0);!g&&k.parentNode&&g_objVideoControl.isVideoSpan(k.parentNode)&&(g=!0);g&&(f.splice(a,1),a--)}if(0>=f.length)return c();var l={},n=function(){f.forEach(function(a){var b=d(a);(b=l[b])&&e(a,b)});b(f)};f.forEach(function(a){a=d(a);null!==a&&(l[a]="")});var p=Object.keys(l),q=p.length,t=0;p.forEach(function(a){uploadCurrentDocumentImage(a,
function(b){b&&(l[a]=getFullUrlFromPath(b));t++;t>=q&&n()},function(){t++;t>=q&&n()})})}catch(r){dalert(r),"function"===typeof c&&c()}}
function uploadCurrentDocumentImage(a,b,c){try{if(b=b||function(){},c=c||function(){},a)if(!0!==checkSameOrigin(a))uploadExternalImage(a,b,c);else{var d=ONEFFICE_SERVER_API_GET_ATTACHMENTDATA+"?";objOnefficeLoader.isDev()&&0<=document.location.href.indexOf("lcoalhost:80")&&(d=g_dzEditorBasePath+"server/server_get_attachfile.jsp?");if(-1<a.indexOf(d)){var e=a.split("seq=")[1];e&&0!=e.length?e.split("-")[0]!=oneffice.currFileSeq?uploadExternalImage(a,b,c):b():b()}else b()}else c()}catch(f){dalert(f),
c()}}
function uploadExternalImage(a,b,c){try{if(0==a.indexOf("data:image"))b();else if(0!==a.indexOf("http"))b();else{"undefined"===typeof b&&(b=function(){});"undefined"===typeof c&&(c=function(){});if(!0===dzeUiConfig.bIndependentEdit&&"bizbox_report"===onefficeExtContent.extLocation)var d=onefficeExtContent.extCallUrlInfo.searchObject.report_no,e=dzeEnvConfig.strGetWebImgURL+"?doc_no="+d+"&ref=bizbox_report&url="+encodeURIComponent(a);else d=onefficeUtil.getRequestParameter("seq"),e=dzeEnvConfig.strGetWebImgURL+"?doc_no="+
d+"&url="+encodeURIComponent(a);duzon_http.showLoading();duzon_http.ajax({type:"get",url:e,async:!0,dataType:"json",data:{},loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){duzon_http.hideLoading();"success"==a.result?b(a.url):c()},error:function(a){duzon_http.hideLoading();c()}})}}catch(f){dalert(f),c()}}
function appendBodyTemporary(a,b,c){try{if(a){var d={position:"fixed",left:screen.width,top:0,zIndex:99999,background:DOCUMENT_PAGE_BACKGROUND_COLOR};if(b)for(var e in d)b[e]||(b[e]=d[e]);else b=d;d={};for(e in b)d[e]=a.style[e],a.style[e]=b[e];a.ownerDocument.body.appendChild(a);c&&c();for(e in b)a.style[e]=d[e]}}catch(f){dalert(f)}finally{a.ownerDocument.body.removeChild(a)}}
function insertQRCodeElement(a,b,c){try{if(b)g_objPageControl.getPageMain(g_objPageControl.getTotalPageCount()-1).appendChild(a);else{setFirstQRPosition(c,a);var d=g_objPageControl.getPageMain(0);d.insertBefore(a,d.firstChild)}}catch(e){dalert(e)}}
function setFirstQRPosition(a,b){try{b||(b=g_objEditorDocument[a].getElementsByClassName("oneffice_qrcode_first_container")[0]);if(!b)return null;var c=dzeUiConfig.nSettingPaperMargin.top,d=Math.min(Math.max(c/2,2.5),10);b.style.position="absolute";b.style.top=-1*c+d+"mm";b.style.right=d+"mm";return b}catch(e){dalert(e)}}
function fnCommandReadOnlyMode(a,b){dzeLayoutControl.setReadonlyMode(!0,a);onefficeUtil.setReadonlyDocument(a);0<b&&cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_OPENED_READ_ONLY,1.5)}function fnCommandEditorMode(a,b){dzeLayoutControl.setReadonlyMode(!1,a);onefficeUtil.setEditModeDocument(a);if(a=document.getElementById("TB_CONTAINER_READONLY_NOTIBAR_"+a))a.style.display="none";0<b&&cmnCtrlToast.showToastMsg(null,"EditorMode \ubcc0\uacbd",5)}
function insertPara(a){try{if(g_readonlyMode||!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_ENTER||a.modifierKey)return!1;var b=a.nEditNumber,c=GetCurRange(b);if(!c)return!1;var d=g_objNodeUtil,e=SelectionUtil,f=c.startContainer,g=c.startOffset,h="undefined"!==typeof g_objShapeFunction?g_objShapeFunction:null;if(h&&h.getTextboxInShape(f)||h.getShapeObject(f))return!1;var k=d.getLoopParentElementByTagNames(f,d.arrParaTagName);if(!k)return!1;var m=d.getClosetBound(f);if(!m||!m.contains(k)||!m.contains(3===
f.nodeType?f.parentNode:f))return!1;var l=getParaProp_NotCopy(k),n=g_bBrowserType_IE&&e.existOnFirst(k,c),p=g_bBrowserType_IE&&e.existOnLast(k,c);if(!(0<Object.keys(l).length||n||p||c.collapsed&&d.isOffsetBetweenBr(c.startContainer,c.startOffset)))return!1;dlog("*** insert para!!!");!0===e.deleteSelection(b)&&(c=GetCurRange(b),f=c.startContainer,g=c.startOffset);var q=d.getClosest(f,function(a){if(a&&"A"===a.nodeName)return!0;if(a===k||a===m)throw BreakException;});e.isOnFirst(q,f,g)?(f=q.parentNode,
g=d.getChildIndex(q),c.setStart(f,g),c.setEnd(f,g)):e.isOnLast(q,f,g)&&(f=q.parentNode,g=d.getChildIndex(q)+1,c.setStart(f,g),c.setEnd(f,g));var t=k.ownerDocument.createElement("span");c.insertNode(t);var r=t.previousSibling;r&&3===r.nodeType&&0===r.textContent.length&&(t.parentNode.removeChild(r),r=t.previousSibling);for(;null!==r&&"SPAN"===r.nodeName&&!0===g_objPropertyUtil.hasClass(r,"dze_shape_main");)t.parentNode.insertBefore(t,r),r=t.previousSibling;d.splitOn(k.parentNode,t);var z=t.previousSibling,
u=t.nextSibling;t.parentNode.removeChild(t);"LI"===u.nodeName&&!0===l.bListStyleType&&(u.style.listStyleType="",""===u.style.cssText&&u.removeAttribute("style"));var v=d.findLastBr(z);v&&d.isLastBr(v,z)&&insertAfter(v,v.cloneNode());d.insertBrIntoBlankPara(z);d.insertBrIntoBlankPara(u);d.isBlankPara(z)||d.removeEmptyNode(z,r);g_objCaretUtil.moveCaret(u,!0);a.preventDefault();return!0}catch(w){dalert(w)}finally{c=null}}
function exceTagChk(a){a=a.startContainer;for(var b=a.parentNode,c=!1,d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];c&&"BR"===e.nodeName||a.isSameNode(e)&&(c=!0)}return c}
function insertParaExceTag(a){try{var b=g_objCaretUtil.getCaretNormalContainer(a);if(b){a=["h1","h2","h3","h4","h5"];var c=b.objAncestorNode,d=b.objRange;if(!d||!c)return!1;b=!1;var e=g_objNodeUtil.getLoopParentElementByTagNames(c,a);if(null===e||d.endOffset!=d.endContainer.length)return!1;if(exceTagChk(d)){var f=document.createElement("span");d.insertNode(f);var g=f.previousSibling;var h=f.nextSibling;null!=h.nextSibling&&"BR"===h.nextSibling.nodeName&&h.parentNode.removeChild(h.nextSibling);g_objPropertyUtil.element_hasClass(d.endContainer.parentNode.parentNode,
"dze_page_container")?g_objNodeUtil.splitOn(d.endContainer.parentNode,f):g_objNodeUtil.splitOn(e.parentNode,f);e=g_objNodeUtil.getLoopParentElementByTagNames(g,a);h=g_objNodeUtil.getLoopParentElementByTagNames(h,a);0===h.textContent.length&&g_objCommonUtil.contains(a,h.nodeName.toLowerCase())&&h.parentNode.removeChild(h);b=!0;f.parentNode.removeChild(f)}f=!1;e||(e=h,f=!0);if(null!=e&&(b||d.endOffset===d.endContainer.length)){var k=document.createElement("p");d=k;b=c;f&&(b=h);g_objCommonUtil.contains(a,
b.nodeName.toLowerCase())?(k.appendChild(document.createElement("br")),insertAfter(e,k)):(b=c.cloneNode(),k.appendChild(b),b.appendChild(document.createElement("br")),g=g_objNodeUtil.getLoopParentElementByTagNames(g,a),d=b,insertAfter(g,k));g_objCaretUtil.moveCaret(d,!0,!1);return!0}return!1}dlog("caretNormalData -> N/A!")}catch(m){return!1}}
function getParaProp_NotCopy(a){try{var b={};if(!a)return b;var c=g_objPropertyUtil;a.hasAttribute("dze_split")&&(b.bSplit=!0);a.hasAttribute("dze_split_child")&&(b.bSplitChild=!0);c.hasClass(a,"dze_page_break_para")&&(b.bPageBreak=!0);c.hasClass(a,"dze_shape_anchor")&&(b.bShapeAnchor=!0);c.hasClass(a,"dze_sketch_anchor")&&(b.bSketchAnchor=!0);a.hasAttribute(DZE_CUSTOM_ATT_RM_BIZBOX_REPORT)&&(b.bRmBizboxReport=!0);!0!==b.bSplit&&!0!==b.bSplitChild||"LI"!==a.nodeName||"none"!==a.style.listStyleType||
(b.bListStyleType=!0);return b}catch(d){dalert(d)}}
function pullBelowDelete(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||!g_bBrowserType_IE&&!0!==dzeUiConfig.bSupportNewsEditor)return!1;var b=g_objNodeUtil,c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed)return!1;var d=b.getLoopParentElementByTagNames(c.startContainer.childNodes[c.startOffset]||c.startContainer,b.arrParaTagName);if(!d)return!1;var e=b.getLoopParentElementByTagNames(d.nextSibling,b.arrParaTagName);if(!e)return!1;if(SelectionUtil.existOnLast(d,c)){var f=b.getLastTextNode(d);
if(f&&"BR"===f.nodeName){var g=f.parentNode;g.removeChild(f);b.removeEmptyNode(d,g)}for(b=void 0;0<e.childNodes.length;)void 0===b&&(b=e.childNodes[0]),d.appendChild(e.childNodes[0]);d.parentElement.removeChild(e);g_objCaretUtil.moveCaret(b,!1);TBCancelBubbleEvent(a);return!0}}catch(h){dlog(h)}finally{}}
function pullBelowBackspace(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_BACKSPACE||!g_bBrowserType_IE&&!0!==dzeUiConfig.bSupportNewsEditor)return!1;var b=g_objNodeUtil,c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed)return!1;var d=b.getLoopParentElementByTagNames(c.startContainer.childNodes[c.startOffset]||c.startContainer,b.arrParaTagName);if(!d)return!1;var e=b.getLoopParentElementByTagNames(d.previousSibling,b.arrParaTagName);if(!e)return!1;if(SelectionUtil.existOnFirst(d,c)){dlog("Backspace OnFirst TRUE");
var f=b.getLastTextNode(e);if(f&&"BR"===f.nodeName){var g=f.parentNode;g.removeChild(f);b.removeEmptyNode(e,g)}for(b=void 0;0<d.childNodes.length;)void 0===b&&(b=d.childNodes[0]),e.appendChild(d.childNodes[0]);d.parentElement.removeChild(d);g_objCaretUtil.moveCaret(b,!1);TBCancelBubbleEvent(a);return!0}}catch(h){dalert(h)}finally{}return!1}
function onKeyDownBesideTable(a){try{if(!a||a.cancelBubble||!isEditingKeyCode(a.keyCode))return!1;var b=a.keyCode,c=b===ID_KEYCODE_DELETE||b===ID_KEYCODE_BACKSPACE,d=b===ID_KEYCODE_ENTER,e=GetCurRange(a.nEditNumber);if(!e||!e.collapsed)return!1;var f=g_objNodeUtil,g=e.startContainer,h=e.startOffset;if(!g||!f.isBoundNode(g))return!1;f=null;var k=0,m=0,l=function(a){var b=e.createContextualFragment("<P><BR></P>"),c=b.firstChild;a?p.parentNode.insertBefore(b,p):insertAfter(p,b);g_objCaretUtil.moveCaret(c)},
n=function(a){for(var b=0,c=a.length;b<c;b++)a[b]&&a[b].parentNode.removeChild(a[b])},p=g.childNodes[h];return p&&p.parentNode&&"TABLE"===p.nodeName?(f=g_objTableUtil.getSplitTables(p),k=f.length,m=f.indexOf(p),0===m?(l(!0),b===ID_KEYCODE_DELETE&&n(f),(d||c)&&TBCancelBubbleEvent(a)):0<m&&TBCancelBubbleEvent(a),!0):(p=g.childNodes[h-1])&&p.parentNode&&"TABLE"===p.nodeName?(f=g_objTableUtil.getSplitTables(p),k=f.length,m=f.indexOf(p),m===k-1?(l(!1),b===ID_KEYCODE_BACKSPACE&&n(f),(d||c)&&TBCancelBubbleEvent(a)):
0<=m&&m<k&&TBCancelBubbleEvent(a),!0):!1}catch(q){dalert(q)}finally{e=null}}
function executeMergeBizboxReport(a,b,c){try{var d=g_nActiveEditNumber,e=g_objEditorDocument[d],f=e.createDocumentFragment(),g=g_objNodeUtil.isBlankDoc(d),h=null,k=e.createElement("P");k.appendChild(e.createElement("BR"));var m=null,l=null,n=null,p=!1;b&&(p=e.querySelector("["+DZE_CUSTOM_ATT_RM_BIZBOX_REPORT+"]")?!0:!1);for(e=0;e<a.content.length;e++){l=document.implementation.createHTMLDocument("NewDoc");l.documentElement.innerHTML=a.content[e];n=1==l.body.childNodes.length&&"div"==l.body.firstChild.nodeName.toLowerCase()&&
"oneffice_content"==l.body.firstChild.id?l.body.firstChild:l.body;var q=n.firstChild;if(!(2>n.childNodes.length||"dze_doc_property"!==q.nodeName.toLowerCase()))for(g&&q&&"dze_doc_property"===q.nodeName.toLowerCase()&&(h=h||[],h.push(q)),b&&p&&removeBizboxReportElement(n),b&&!1===p&&(p=n.querySelector("["+DZE_CUSTOM_ATT_RM_BIZBOX_REPORT+"]")?!0:!1),trimParent(n),b?setEmpName(n,a.emp_name[e]):(f.appendChild(k.cloneNode(!0)),m=k.cloneNode(!0),m.style.textAlign="center",m.innerHTML=a.subject[e]||"",f.appendChild(m),
f.appendChild(k.cloneNode(!0)));2<=n.childNodes.length;)f.appendChild(n.childNodes[1])}if(!f.firstChild)return!1;var t=markImportedTable(f);g_objCaretUtil.moveCaretToClosetPageMain(d);g_objAdjustDoc.adjustContentBeforeInsert(f);b&&removeAnotherCheckListTable(f);insertHTMLCodeAtSelection(null,f,d);a="";var r=g_objTableUtil.getBizboxReportTableQuery(),z=[].slice.call(g_objEditorDocument[d].querySelectorAll(r));e=0;for(var u=z.length;e<u;e++)if(g_objTableUtil.isBizboxReportHomeTable(z[e])){a="bizbox_report_home";
break}else g_objTableUtil.isBizboxReport2Table(z[e])?a="bizbox_report2":"bizbox_report_home"!==a&&(a="bizbox_report");r=!1;""!==a&&(r=setForceDocProperty(a));!1===r&&g&&setDocPropertyForMergeBizboxReport(h);b&&(mergeBizboxTables(),setSameColorTitleTableRow(d),trimDocument(d));unmarkImportedTable(t);g_objUndoRedo.registerUndoRedoStack(0,d);g_objPageControl.onSetDelayedUpdatePageTimer();editor_onselectionchange(d);c(0)}catch(v){dalert(v),c(1)}}
function markImportedTable(a){try{var b=g_objTableUtil.getBizboxReportTableQuery(),c=[].slice.call(a.querySelectorAll(b));a=0;for(var d=c.length;a<d;a++)c[a].setAttribute("dze_imported","");return c}catch(e){dalert(e)}}function unmarkImportedTable(a){try{for(var b=0,c=a.length;b<c;b++)a[b].removeAttribute("dze_imported")}catch(d){dalert(d)}}
function trimDocument(a){try{a=g_objPageControl;var b=a.getTotalPageCount(),c=a.getPageMain(0),d=a.getPageMain(b-1);if(!c||!d)return!1;b=g_objNodeUtil;var e=c.firstChild;for(c=null;e;){if((c=e.nextSibling)&&b.isBlankPara(e))e.parentNode.removeChild(e);else break;e=c}e=d.lastChild;for(d=null;e;){if((d=e.previousSibling)&&b.isBlankPara(e))e.parentNode.removeChild(e);else break;e=d}return!0}catch(f){dalert(f)}}
function trimParent(a){try{if(!a)return!1;for(var b=g_objNodeUtil,c=a.firstChild,d=null;c;){if((d=c.nextSibling)&&b.isBlankPara(c))c.parentNode.removeChild(c);else break;c=d}c=a.lastChild;for(a=null;c;){if((a=c.previousSibling)&&b.isBlankPara(c))c.parentNode.removeChild(c);else break;c=a}return!0}catch(e){dalert(e)}}
function setSameColorTitleTableRow(a){try{var b=g_objEditorDocument[a];if(!b)return!1;a=[];for(var c=[DZE_CUSTOM_VALUE_SCHEDULE,DZE_CUSTOM_VALUE_TASK,DZE_CUSTOM_VALUE_SCHEDULE_HOME,DZE_CUSTOM_VALUE_TASK_HOME],d="",e=null,f=0,g=c.length;f<g;f++)d=g_objTableUtil.getBizboxReportTableQuery(c[f]),e=[].slice.call(b.querySelectorAll(d)),a=a.concat(e);var h=g_objTableOperation,k=g_objTableUtil,m=g_objCommonUtil,l=m.convert_RGB_To_Hex("rgb(0, 179, 240)"),n=function(a,b){try{var c=a.querySelector("tr[dze_rowgroup]");
if(!c)return!1;var d=c.getAttribute("dze_rowgroup");if(""===d)return!1;var e=h.getRowgroupInfo(a,d);if(!e)return!1;for(c=!1;e;){var f=k.getTableCellElement(a,e.start,0);if(!f)return!1;f.style.color=b;c=!0;if(null!==e.nextID)e=h.getRowgroupInfo(a,e.nextID);else break}return c}catch(w){dalert(w)}},p=!1;forEach(a,function(a,b){if(a=b.querySelector("tr[dze_rowgroup]"))if(a=a.getAttribute("dze_rowgroup"),""!==a&&(a=h.getRowgroupInfo(b,a)))for(;a;){var c=k.getTableCellElement(b,a.start,0);if(!c)break;if(m.convert_RGB_To_Hex(c.style.color)!==
l){p=n(b,c.style.color);break}if(null!==a.nextID)a=h.getRowgroupInfo(b,a.nextID);else break}},this);return p}catch(q){dalert(q)}}function removeAnotherCheckListTable(a){try{if(!a)return!1;var b=g_objTableUtil.getBizboxReportTableQuery(DZE_CUSTOM_VALUE_CHECKLIST),c=g_objEditorDocument[g_nActiveEditNumber].querySelector(b),d=a.querySelectorAll(b);forEach(d,function(a,b){(c||0!==a)&&b.parentNode&&b.parentNode.removeChild(b)},this);return 1<d.length}catch(e){dalert(e)}}
function removeBizboxReportElement(a){try{if(!a)return!1;var b=!1,c=g_objNodeUtil,d=g_objTableUtil,e=a.querySelectorAll("["+DZE_CUSTOM_ATT_RM_BIZBOX_REPORT+"]");forEach(e,function(a,e){(a=c.getLoopParentElement(e,"table"))&&d.isBizboxReportTable(a)?e.removeAttribute(DZE_CUSTOM_ATT_RM_BIZBOX_REPORT):e.parentNode&&(e.parentNode.removeChild(e),b=!0)},this);return b}catch(f){dalert(f)}}
function setForceDocProperty(a){try{var b=null,c=!1;"bizbox_report_home"===a?(b={top:20,right:20,bottom:20,left:20,headerTop:10,footerBottom:12.5},c=!0):"bizbox_report"===a&&(b={top:20,right:40,bottom:20,left:40,headerTop:10,footerBottom:12.5},c=!0);a=!1;b&&!compareSimpleObject(b,dzeUiConfig.nSettingPaperMargin)&&(dzeLayoutControl.setDocPrintMargin(g_nActiveEditNumber,b),a=!0);!0===c&&!1===dzeUiConfig.bOfficeOnePageLongMode&&(g_objPageControl.changePageMode(!0),a=!0);return a}catch(d){dalert(d)}}
function setDocPropertyForMergeBizboxReport(a){try{if(!a||0===a.length)return!1;var b=dzeLayoutControl;if(!1===dzeUiConfig.bOfficeOnePageLongMode)try{forEach(a,function(a,c){if(!0===b.getOnePageModePropertyFromElem(c))throw g_objPageControl.changePageMode(!0),BreakException;})}catch(e){}var c=cloneSimpleObject(dzeUiConfig.nSettingPaperMargin),d={top:Number.MAX_VALUE,right:Number.MAX_VALUE,bottom:Number.MAX_VALUE,left:Number.MAX_VALUE,headerTop:10,footerBottom:12.5};forEach(a,function(a,c){(a=b.getDocPrintMarginInfoFromElem(c))&&
a.top&&a.right&&a.bottom&&a.left&&(d.top=Math.min(d.top,a.top),d.right=Math.min(d.right,a.right),d.bottom=Math.min(d.bottom,a.bottom),d.left=Math.min(d.left,a.left))});Object.keys(d).forEach(function(a){d[a]===Number.MAX_VALUE&&(d[a]=c[a])});compareSimpleObject(c,d)||b.setDocPrintMargin(g_nActiveEditNumber,d);return!0}catch(e){dalert(e)}}
function mergeBizboxTables(){try{for(var a=g_objEditorDocument[g_nActiveEditNumber],b=null,c=g_objTableOperation,d=g_objTableUtil,e=[DZE_CUSTOM_VALUE_BIZBOX_REPORT_1,DZE_CUSTOM_VALUE_BIZBOX_REPORT_5,DZE_CUSTOM_VALUE_BIZBOX_REPORT_6],f=[[DZE_CUSTOM_VALUE_SCHEDULE,DZE_CUSTOM_VALUE_SCHEDULE_HOME],[DZE_CUSTOM_VALUE_TASK,DZE_CUSTOM_VALUE_TASK_HOME],[DZE_CUSTOM_VALUE_PREV_TASK,DZE_CUSTOM_VALUE_PREV_TASK_HOME],[DZE_CUSTOM_VALUE_REMARK,DZE_CUSTOM_VALUE_REMARK_HOME],DZE_CUSTOM_VALUE_OPINION,DZE_CUSTOM_VALUE_USER_INFO,
DZE_CUSTOM_VALUE_TASK_SCHEDULE,DZE_CUSTOM_VALUE_TASK_NOT_FINISH,DZE_CUSTOM_VALUE_TASK_WILL_DO],g=function(e,f){var g="",h=f;Array.isArray(f)||(h=[f]);forEach(h,function(a,b){0<a&&(g+=", ");g+='div.dze_page_main>table[tools="'+e+'"][dze_desc="'+b+'"]'});f=h[0];h=[].slice.call(a.querySelectorAll(g));var k=h.length;if(2>k)return!1;var m=function(a,b){return b===DZE_CUSTOM_VALUE_OPINION?(a=a.textContent,a=a.trim().replace("\uc790\uc720\ub86d\uac8c \ub0b4\uc6a9\uc744 \uae30\uc7ac\ud574 \uc8fc\uc138\uc694",
""),""===a?!0:!1):d.isBlankCell(a)},l=0;for(k=h.length;l<k;l++){var n=h[l].offsetParent;n&&(n=g_objPositionUtil.getInnerWidth(n))&&(g_objTableResize.setTableSize(h[l],n,0,!0),g_objTableUtil.setNodeValue_Width(h[l],100,"%"))}n=sortTablesBeforeMerge(h).offsetTable;var v=h[0];for(l=1;l<k;l++){var w=h[l];if(w&&w.parentNode&&v!==w){removePrevEmptyPara(w===n?v:w,f);if(f===DZE_CUSTOM_VALUE_SCHEDULE||f===DZE_CUSTOM_VALUE_TASK||f===DZE_CUSTOM_VALUE_SCHEDULE_HOME||f===DZE_CUSTOM_VALUE_TASK_HOME||f===DZE_CUSTOM_VALUE_TASK_SCHEDULE||
f===DZE_CUSTOM_VALUE_USER_INFO)c.mergeTable(v,w,w===n?!1:!0);else if(f===DZE_CUSTOM_VALUE_PREV_TASK||f===DZE_CUSTOM_VALUE_REMARK||f===DZE_CUSTOM_VALUE_PREV_TASK_HOME||f===DZE_CUSTOM_VALUE_REMARK_HOME||f===DZE_CUSTOM_VALUE_OPINION||f===DZE_CUSTOM_VALUE_TASK_NOT_FINISH||f===DZE_CUSTOM_VALUE_TASK_WILL_DO){var x=0,y=0;if(e===DZE_CUSTOM_VALUE_BIZBOX_REPORT_1)x=1,y=2;else if(e===DZE_CUSTOM_VALUE_BIZBOX_REPORT_5||e===DZE_CUSTOM_VALUE_BIZBOX_REPORT_6){if(x=1,y=0,f===DZE_CUSTOM_VALUE_OPINION||f===DZE_CUSTOM_VALUE_TASK_NOT_FINISH||
f===DZE_CUSTOM_VALUE_TASK_WILL_DO)y=x=0}else continue;var A=d.getTableCellElement(v,x,y);x=d.getTableCellElement(w,x,y);if(A&&x&&!m(x,f)){for(b||(b=a.createDocumentFragment());x.firstChild;)b.appendChild(x.firstChild);A.appendChild(b)}w===n?(y=a.createDocumentFragment(),g_objNodeUtil.moveNodesTo(y,A.firstChild),x.innerHTML="",x.appendChild(y),v.parentNode.removeChild(v)):w.parentNode.removeChild(w)}w===n&&(v=w)}}return!0}.bind(this),h=!1,k=0;k<e.length;k++)for(var m=0;m<f.length;m++)h|=g(e[k],f[m]);
return h}catch(l){dalert(l)}}function sortTablesBeforeMerge(a){try{a.sort(function(a,b){a=a.hasAttribute("dze_imported")?!0:!1;b=b.hasAttribute("dze_imported")?!0:!1;return!1===a&&!0===b?-1:!0===a&&!1===b?1:0});for(var b=null,c=null,d=g_objTableUtil,e=0,f=a.length;e<f;e++)if(c=a[e],d.isBizboxReportHomeTable(c)&&!c.hasAttribute("dze_imported")){b=c;break}if(!b)for(e=0,f=a.length;e<f;e++)if(c=a[e],d.isBizboxReportHomeTable(c)){b=c;break}return{offsetTable:b,tables:a}}catch(g){dalert(g)}}
function setEmpName(a,b){try{if(a&&b){for(var c=[DZE_CUSTOM_VALUE_SCHEDULE,DZE_CUSTOM_VALUE_TASK,DZE_CUSTOM_VALUE_SCHEDULE_HOME,DZE_CUSTOM_VALUE_TASK_HOME,DZE_CUSTOM_VALUE_TASK_SCHEDULE],d=[],e=0,f=c.length;e<f;e++)d[e]=g_objTableUtil.getBizboxReportTableQuery(c[e]);c=[];e=0;for(f=d.length;e<f;e++)c=c.concat([].slice.call(a.querySelectorAll(d[e])));c.forEach(function(a){if(a){var c=g_objNodeUtil,d=Number.MAX_VALUE,e=a.rows,f=a.getAttribute("dze_desc"),g=0;for(a=a.rows.length;g<a;g++){var p=e[g];if(p.hasAttribute("dze_rowgroup")){var q=
p.getAttribute("dze_rowgroup");q!=d&&(d=q,(p=f===DZE_CUSTOM_VALUE_TASK_SCHEDULE?c.checkTagName(p.cells[1],"td","th"):c.checkTagName(p.cells[0],"td","th"))&&(p=c.checkTagName(p.firstChild,"p"))&&p.setAttribute("title",b))}}}})}}catch(g){dalert(g)}}
function removePrevEmptyPara(a,b){try{var c=g_objNodeUtil,d=3,e=null;b=b===DZE_CUSTOM_VALUE_USER_INFO?"\uc77c\uc77c\uc5c5\ubb34\ubcf4\uace0\uc11c":b===DZE_CUSTOM_VALUE_TASK_SCHEDULE?"\uae08\uc77c \uc2e4\uc2dc\uc0ac\ud56d":b===DZE_CUSTOM_VALUE_TASK_NOT_FINISH?"\ubbf8\ucc98\ub9ac\ub0b4\uc5ed":b===DZE_CUSTOM_VALUE_REMARK?"\ud2b9\uc774\uc0ac\ud56d":b===DZE_CUSTOM_VALUE_TASK_WILL_DO?"\uc608\uc815\uc0ac\ud56d":"";for(var f=a.previousSibling;f&&0<d;){e=f.previousSibling;if(f&&c.isBlankPara(f))f.parentNode.removeChild(f);
else if(f&&b&&"P"===f.nodeName&&f.textContent.trim()===b)f.parentNode.removeChild(f);else break;f=e;d--}return!0}catch(g){dalert(g)}}
function getMaxBoundSize(a,b){try{var c=DOCUMENT_MAIN_WIDTH,d=DOCUMENT_MAIN_HEIGHT;!0===dzeUiConfig.bOfficeOnePageLongMode&&(d=Number.MAX_VALUE);var e=null;b&&b.parentNode?e=b:(b=null,b=g_bBrowserType_IE&&cmnDlg.isShowDlg()?g_objLastRange[a]:GetCurRange(a),e=b.startContainer);for(a=g_objNodeUtil;e&&!(a.isBoundNode(e)||a.isCell(e)||a.isListItem(e));)e=e.parentNode;if(!e)return{width:c,height:d};var f=g_objPositionUtil.getInnerWidth(e);c=Math.max(Math.min(f,c),10);if((f=g_objHeaderFooter)&&f.getHeaderFooterEditMode()){var g=
g_objNodeUtil.getLoopBreakNode(e);if(g){var h=DOCUMENT_PAGE_HEIGHT/2-g_objCommonUtil.convMMToPx(10)-1;f.isHeader(g)?(h=Math.ceil(h-DOCUMENT_HEADER_MARGIN_TOP),d=Math.min(d,h)):f.isFooter(g)&&(h=Math.ceil(h-DOCUMENT_FOOTER_MARGIN_BOTTOM),d=Math.min(d,h))}}return{width:c,height:d}}catch(k){return dalert(k),{width:c,height:d}}}
function setOrgImageSize(a,b,c){try{if(a){var d=c?a.naturalWidth:a.width,e=c?a.naturalHeight:a.height;if(d&&e)return b&&b.width&&b.height&&(c=d/e,d>b.width&&(d=b.width,e=b.width/c),e>b.height&&(e=b.height,d=b.height*c)),a.removeAttribute("width"),a.removeAttribute("height"),a.style.width=parseInt(d,10)+"px",a.style.height=parseInt(e,10)+"px",a}}catch(f){dalert(f)}}
function setAbsoluteImgSrc(a){try{if(!a)return!1;var b=function(a){if(a&&"IMG"===a.nodeName){var b=a.getAttribute("src");b&&isRelativeUrl(b)&&(a.src=getFullUrlFromPath(b))}};if("IMG"===a.nodeName)b(a);else{var c=a.querySelectorAll("img[src]");forEach(c,function(a,c){b(c)},this)}return!0}catch(d){dalert(d)}}
function replaceFontTag(a){try{if(!a||a.cancelBubble||g_objCaretUtil.isComposing(a))return!1;var b=a.nEditNumber,c=GetCurRange(b);if(!c||!c.collapsed)return!1;var d=c.startContainer;if(!d)return!1;a=null;for(c=g_objNodeUtil;d&&!c.isBlockNode(d);){switch(d.nodeName){case "B":case "STRONG":case "I":case "EM":case "U":case "STRIKE":case "S":case "SUP":case "SUB":case "FONT":a||(a=[]),a.push(d)}d=d.parentNode}if(!a)return!1;d=g_objCaretUtil;var e="replaceFontTag_"+g_objCommonUtil.getUniqueID();d.saveCaret(b,
e);c=g_objAdjustDoc;for(var f=[],g=null,h=0,k=a.length;h<k;h++)g=c.changeTextFormat(a[h]),f.push(g);h=0;for(k=f.length;h<k;h++)c.arrangeStyleSpan(f[h]);d.restoreCaret(b,e);return!0}catch(m){dalert(m)}finally{}}
function adjustSelectionOnTripleClickCell(a,b){try{if(!g_bBrowserType_CR||!b||b.cancelBubble||3>b.detail)return!1;var c=GetCurRange(a);if(!c||c.collapsed)return!1;a=g_objNodeUtil;var d=a.arrCellTagName,e=c.startContainer,f=c.startOffset,g=c.endContainer,h=c.endOffset;if(!e||!g)return!1;var k=a.getLoopParentElementByTagNames(e,d);if(!k)return!1;b=!1;var m=a.getLoopParentElementByTagNames(g,d);m&&SelectionUtil.isOnFirst(m,g,h)&&g_objTableFunction.getFindNextCell(k)===m&&(b=!0);if(!1===b){var l=a.getLoopParentElement(k,
"table"),n=l&&l.nextSibling&&1===l.nextSibling.nodeType?l.nextSibling:null;l&&n&&n.contains(g)&&SelectionUtil.isOnFirst(n,g,h)&&(b=!0)}!0===b&&(3===e.nodeType?(g=e,h=e.nodeValue.length):(g=e,h=e.childNodes.length));return c.startContainer!==e||c.startOffset!==f||c.endContainer!==g||c.endOffset!==h?(c.setStart(e,f),c.setEnd(g,h),SetCurRange(c),!0):!1}catch(p){dalert(p)}}function createClassObj(a){function b(){}b.prototype=a;return new b}
function createExtendObj(){function a(){}a.prototype=this;return new a}function setImageLoadingLazy(a){try{if(!a||1!==a.nodeType)return!1;forEach(a.querySelectorAll("img"),function(a,c){c.hasAttribute("loading")||c.setAttribute("loading","lazy")});return!0}catch(b){dalert(b)}}function removeImageLoadingLazy(a){try{if(!a||1!==a.nodeType)return!1;forEach(a.querySelectorAll("img"),function(a,c){c.hasAttribute("loading")&&c.removeAttribute("loading")});return!0}catch(b){dalert(b)}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(b,e,g){return b==a&&"q"==e&&g==c}}));return!0===c.q}catch(b){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(b){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+c++,b)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,e){if(c){b=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var g=a[e];g in b||(b[g]={});b=b[g]}a=a[a.length-1];e=b[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var d=Object.seal({}),e=Object.seal({}),b=new a([[d,2],[e,3]]);if(2!=b.get(d)||3!=b.get(e))return!1;b.delete(d);b.set(e,4);return!b.has(d)&&4==b.get(e)}catch(l){return!1}}function b(){}function e(d){if(!$jscomp.owns(d,f)){var a=new b;$jscomp.defineProperty(d,f,{value:a})}}function g(d){var a=Object[d];a&&(Object[d]=function(d){if(d instanceof b)return d;e(d);return a(d)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var f="$jscomp_hidden_"+Math.random();g("freeze");g("preventExtensions");g("seal");var h=0,k=function(d){this.id_=(h+=Math.random()+1).toString();if(d){d=$jscomp.makeIterator(d);for(var a;!(a=d.next()).done;)a=a.value,this.set(a[0],a[1])}};k.prototype.set=function(d,a){e(d);if(!$jscomp.owns(d,f))throw Error("WeakMap key fail: "+d);d[f][this.id_]=a;return this};k.prototype.get=function(d){return $jscomp.owns(d,f)?d[f][this.id_]:void 0};k.prototype.has=
function(d){return $jscomp.owns(d,f)&&$jscomp.owns(d[f],this.id_)};k.prototype.delete=function(d){return $jscomp.owns(d,f)&&$jscomp.owns(d[f],this.id_)?delete d[f][this.id_]:!1};return k},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var d=Object.seal({x:4}),b=new a($jscomp.makeIterator([[d,"s"]]));if("s"!=b.get(d)||1!=b.size||b.get({x:4})||b.set({x:4},"t")!=b||2!=b.size)return!1;var e=b.entries(),c=e.next();if(c.done||c.value[0]!=d||"s"!=c.value[1])return!1;c=e.next();return c.done||4!=c.value[0].x||"t"!=c.value[1]||!e.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=new WeakMap,e=function(d){this.data_={};this.head_=h();this.size=0;if(d){d=$jscomp.makeIterator(d);for(var a;!(a=d.next()).done;)a=a.value,this.set(a[0],a[1])}};e.prototype.set=function(a,b){a=0===a?0:a;var d=g(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};e.prototype.delete=function(a){a=g(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};e.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=h();this.size=0};e.prototype.has=function(a){return!!g(this,a).entry};
e.prototype.get=function(a){return(a=g(this,a).entry)&&a.value};e.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};e.prototype.keys=function(){return f(this,function(a){return a.key})};e.prototype.values=function(){return f(this,function(a){return a.value})};e.prototype.forEach=function(a,b){for(var d=this.entries(),e;!(e=d.next()).done;)e=e.value,a.call(b,e[1],e[0],this)};e.prototype[Symbol.iterator]=e.prototype.entries;var g=function(a,e){var d=e&&typeof e;"object"==
d||"function"==d?b.has(e)?d=b.get(e):(d=""+ ++k,b.set(e,d)):d="p_"+e;var c=a.data_[d];if(c&&$jscomp.owns(a.data_,d))for(a=0;a<c.length;a++){var g=c[a];if(e!==e&&g.key!==g.key||e===g.key)return{id:d,list:c,index:a,entry:g}}return{id:d,list:c,index:-1,entry:void 0}},f=function(a,e){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:e(b)};b=null}return{done:!0,value:void 0}})},h=function(){var a={};return a.previous=
a.next=a.head=a},k=0;return e},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),h=f.next();if(h.done||h.value[0]!=b||h.value[1]!=b)return!1;h=f.next();return h.done||h.value[0]==b||4!=h.value[0].x||h.value[1]!=h.value[0]?!1:f.next().done}catch(k){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();
this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(e){return a.call(b,e,e,c)})};return b},"es6","es3");
$jscomp.polyfill("Array.from",function(a){return a?a:function(a,b,e){b=null!=b?b:function(a){return a};var c=[],f="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];if("function"==typeof f){a=f.call(a);for(var h=0;!(f=a.next()).done;)c.push(b.call(e,f.value,h++))}else for(f=a.length,h=0;h<f;h++)c.push(b.call(e,a[h],h));return c}},"es6","es3");
var g_strSkin_ClassName="",g_strSkin_HandleDiv="",g_strSkin_Separator="",g_strSkin_Button="",g_strSkin_Button_Over="",g_strSkin_Button_Down="",g_strSkin_Button_Up="",g_strSkin_ComboBox_Area="",g_strSkin_ComboBox_AreaOver="",g_strSkin_ComboBox_AreaDown="",g_strSkin_ComboBox_AreaUp="",g_strSkin_DropDown_Area="",g_strSkin_DropDown_AreaOver="",g_strSkin_DropDown_AreaDown="",g_strSkin_DropDown_AreaUp="",g_strSkin_DropDown_AreaArrow="",g_strSkin_DropDown_AreaArrowOver="",g_strSkin_DropDown_AreaArrowDown=
"",g_strSkin_DropDown_AreaArrowUp="",g_strSkin_Menu_Area="",g_strSkin_Menu_AreaOver="",g_strSkin_Menu_AreaDown="",g_strSkin_Menu_AreaUp="",g_strSkin_TabMode_Area="",g_strSkin_TabMode_AreaOver="",g_strSkin_TabMode_AreaDown="",g_strSkin_TabMode_AreaUp="",g_strSkin_MenuWin="",g_strSkin_MenuItem="",g_strSkin_ComboBoxWin="",g_strSkin_ComboBoxItem_Over="",g_strSkin_ComboBoxItem_Out="",g_strSkin_ComboBoxItem_Down="",g_strSkin_SizeBoxBackWin="",g_strSkin_SizeBoxStatus="",g_strSkin_SizeBoxCell="",g_arrToolbar1=
null,g_arrToolbar2=null,g_arrToolbar3=null,g_arrMenuBar=null,g_arrTabBar=[],g_strSkin_ComboBox_Caption="",g_strSkin_ComboBox_AreaArrow="",g_strSkin_SizeBoxBG="",g_strSkin_SizeBoxStatusText="",g_nIframeBorderSetting=0,g_bEnableEditHorizontalScroll=!0,g_strBodyFontFamily="",g_strBodyFontSize="",g_strBodyLineHeight="",g_strBodyLetterSpacing="",g_strPTagMarginTop="",g_strPTagMarginBottom="",g_nPreviewWindowWidth=0,g_nPreviewWindowHeight=0,g_arrFontName=[],g_strPreviewCallFunction="",g_strContentsCSS=
"",g_arrAdditionalEditAreaCSS=[],g_strAdditionalHeadContent="",g_bEditFocusYN=!0,g_bSourceAreaScriptAllowYN=!1,g_bSourceAreaIframeAllowYN=!1,g_bTableOperationYN=!0,g_bTableResizingYN=!0,g_bTableCellResizingYN=!0,g_bLockEditCellMode=!1,g_bEditSourceMode=!0,g_bAnchorTargetBlankYN=!1,g_bContentPTagStyleApply=!1,g_bContentXHTMLFormatYN=!1,g_bContentXHTMLTabSettingYN=!0,g_strAdditionalStyle="",g_strCustomAdditionalStyle="",g_bConvertPTagToBrTag=!1,g_arrImgSrcRemoveDomain=null,g_bAnchorHrefRemoveDomainYN=
!1,g_bContextMenuUseYN=!0,g_bContextMenuDisplayInEditAreaYN=!1,g_bEditorWidthPercentageYN=!1,g_bEditorHeightIFrameYN=!1,g_strTabModeEventFunction="",g_bSetTableCellBlank=!1,g_strFocusEventFunction="",g_bBottomResizeYN=!1,g_arrAdjustRemoveAttributeName=[],g_arrAdjustRemoveStyleName=[],g_nAdjustFromPtToPxRatio=60,g_bAutoAdjustHwpWordYN=!0,g_bCheckImgSrcProperty=!0,g_arrCheckImgSrcPropertyValue=[],g_bEncodeEndCharacterYN=!1,g_strDomainPageName="",g_bEditorHeightReSettingYN=!1,g_bAutoIncludeParentCSS=
!1,g_nOutdentIndentWidth=7,g_arrRemoveGarbageText=[],g_nFireFoxLayerSetting_X=0,g_nFireFoxLayerSetting_Y=0,g_arrSkinColor={},g_bFullScreenMode=!1,g_readonlyMode=!1;
function setSkinToolBar(){g_strSkin_ClassName="duzon_menubar_line";g_strSkin_ToolBarLine="duzon_toolbar_line";g_strSkin_Menu_Area="duzon_menubar_title";g_strSkin_Menu_AreaOver="duzon_menubar_title_over";g_strSkin_Menu_AreaDown="duzon_menubar_title_down";g_strSkin_Menu_AreaUp="duzon_menubar_title_up";g_strSkin_MenuItem="duzon_menubar_select_item";g_strSkin_Separator="duzon_tb_separator";g_strSkin_MenuWin="duzon_context_container";g_strSkin_Button="duzon_tb_button";g_strSkin_Button_Over="duzon_tb_button_over";
g_strSkin_Button_Down="duzon_tb_button_down";g_strSkin_Button_Up="duzon_tb_button_up";g_strSkin_DropDown_Area="duzon_tb_dropdown";g_strSkin_DropDown_AreaOver="duzon_tb_dropdown_over";g_strSkin_DropDown_AreaDown="duzon_tb_dropdown_down";g_strSkin_DropDown_AreaUp="duzon_tb_dropdown_up";g_strSkin_DropDown_AreaArrow="duzon_tb_dropdown_arrow";g_strSkin_DropDown_AreaArrowOver="duzon_tb_dropdown_arrow_over";g_strSkin_DropDown_AreaArrowDown="duzon_tb_dropdown_arrow_down";g_strSkin_DropDown_AreaArrowUp="duzon_tb_dropdown_arrow_up";
g_strSkin_TabMode_AreaDown=g_strSkin_TabMode_AreaOver=g_strSkin_TabMode_Area="duzon_btn_tabmod_area_off";g_strSkin_TabMode_AreaUp="duzon_btn_tabmod_area_on";g_strSkin_ComboBoxWin="duzon_btn_combobox";g_strSkin_ComboBoxItem_Over="duzon_btn_comboboxitem_over";g_strSkin_ComboBoxItem_Out="duzon_btn_comboboxitem_out";g_strSkin_ComboBoxItem_Down="duzon_btn_comboboxitem_down";g_strSkin_HandleDiv="dze_tbHandleDiv";g_strSkin_ComboBox_Area="dze_tbComboBox_Area";g_strSkin_ComboBox_AreaOver="dze_tbComboBox_AreaOver";
g_strSkin_ComboBox_AreaDown="dze_tbComboBox_AreaDown";g_strSkin_ComboBox_AreaUp="dze_tbComboBox_AreaUp";g_strSkin_SizeBoxBackWin="dze_tbSizeBoxBackWin";g_strSkin_SizeBoxStatus="dze_tbSizeBoxStatus";g_strSkin_SizeBoxCell="dze_tbSizeBoxCell";g_strSkin_ComboBox_Caption="tbComboBox_Caption";g_strSkin_ComboBox_AreaArrow="tbComboBox_AreaArrow";g_strSkin_SizeBoxBG="tbSizeBoxBG";g_strSkin_SizeBoxStatusText="tbSizeBoxStatusText"}
function setCustomDisplay(){try{dzeUiConfig.setCustomToolbars();dzeUiConfig.setCustomContextMenus();g_bMenuBar_Display=dzeUiConfig.bCustomize_MenuBar_Display;g_bTabBar_Display=dzeUiConfig.bCustomize_TabBar_Display;g_bRulerbar_Display=dzeUiConfig.bRulerbar;g_objSupport=dzeUiConfig.objSupport;g_bToolBar1_Display=dzeUiConfig.bCustomize_ToolBar1_Display;g_bToolBar2_Display=dzeUiConfig.bCustomize_ToolBar2_Display;g_bToolBar3_Display=dzeUiConfig.bCustomize_ToolBar3_Display;g_arrToolbar1=dzeUiConfig.arrCustomToolbar1;
g_arrToolbar2=dzeUiConfig.arrCustomToolbar2;g_arrToolbar3=dzeUiConfig.arrCustomToolbar3;null!=dzeUiConfig.arrCustomTabBar&&3==dzeUiConfig.arrCustomTabBar.length?(g_arrTabBar=dzeUiConfig.arrCustomTabBar,!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&(g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]=!0)):(g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]=!0,g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]=!0);"undefined"!=typeof dzeUiConfig.bUseImageToTableMenu&&
"undefined"!=typeof dzeUiConfig.strImageToTableURL&&1==dzeUiConfig.bUseImageToTableMenu&&""!=dzeUiConfig.strImageToTableURL&&(dzeUiConfig.arrContextMenu_Control.splice(dzeUiConfig.arrContextMenu_Control.length-4,0,ID_TYPE_MENU_SEPARATOR),dzeUiConfig.arrContextMenu_Control.splice(dzeUiConfig.arrContextMenu_Control.length-4,0,ID_COMMAND_IMAGE_TO_TABLE));g_arrMenuBar=dzeUiConfig.arrCustomMenuBar;g_nIframeBorderSetting=dzeUiConfig.nCustomIframeBorderSetting;g_nFireFoxLayerSetting_X=dzeUiConfig.nCustomFireFoxLayerSetting_X;
g_nFireFoxLayerSetting_Y=dzeUiConfig.nCustomFireFoxLayerSetting_Y;g_bEnableEditHorizontalScroll=dzeUiConfig.bCustomEnableEditHorizontalScroll;dzeUiConfig.strCustomBodyFontFamily.length?(!1===objOnefficeLoader.m_bDomainDuzon&&(dzeUiConfig.strCustomBodyFontFamily="\ub9d1\uc740 \uace0\ub515"),g_strBodyFontFamily=quoteFontFamily(dzeUiConfig.strCustomBodyFontFamily.replace(/["']/g,""))):g_strBodyFontFamily="\ub3cb\uc6c0, Dotum, \uad74\ub9bc, Gulim, sans-serif";g_strBodyFontSize=dzeUiConfig.strCustomBodyFontSize.length?
dzeUiConfig.strCustomBodyFontSize:"12px";g_strBodyLineHeight=dzeUiConfig.strCustomBodyLineHeight;if(""!=g_strBodyLineHeight&&0<=g_strBodyLineHeight.indexOf("%")){var a=parseInt(g_strBodyLineHeight.replace(/%/,""),10);g_strBodyLineHeight=a=parseFloat(a/100)}g_strBodyLetterSpacing=dzeUiConfig.strCustomBodyLetterSpacing;g_strPTagMarginTop=dzeUiConfig.strCustomPTagMarginTop.length?dzeUiConfig.strCustomPTagMarginTop:"0px";g_strPTagMarginBottom=dzeUiConfig.strCustomPTagMarginBottom.length?dzeUiConfig.strCustomPTagMarginBottom:
"0px";g_nPreviewWindowWidth=dzeUiConfig.nCustomPreviewWindowWidth;g_nPreviewWindowHeight=dzeUiConfig.nCustomPreviewWindowHeight;if(null!=dzeUiConfig.arrCustomFontName&&0<dzeUiConfig.arrCustomFontName.length){g_arrFontName=dzeUiConfig.arrCustomFontName;for(var c=0;c<g_arrFontName.length;c++)g_arrFontName[c]=quoteFontFamily(g_arrFontName[c].replace(/["']/g,""))}else g_arrFontName[g_arrFontName.length]="",""!=ID_RES_COOMBOBOX_FONT_NAME_0&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_0),
""!=ID_RES_COOMBOBOX_FONT_NAME_1&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_1),""!=ID_RES_COOMBOBOX_FONT_NAME_2&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_2),""!=ID_RES_COOMBOBOX_FONT_NAME_3&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_3),""!=ID_RES_COOMBOBOX_FONT_NAME_4&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_4),""!=ID_RES_COOMBOBOX_FONT_NAME_5&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_5),
""!=ID_RES_COOMBOBOX_FONT_NAME_6&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_6),""!=ID_RES_COOMBOBOX_FONT_NAME_7&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_7),""!=ID_RES_COOMBOBOX_FONT_NAME_8&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_8),""!=ID_RES_COOMBOBOX_FONT_NAME_9&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_9),""!=ID_RES_COOMBOBOX_FONT_NAME_10&&(g_arrFontName[g_arrFontName.length]=ID_RES_COOMBOBOX_FONT_NAME_10);
detectFontFace();g_strPreviewCallFunction=dzeUiConfig.strCustomPreviewCallFunction;g_strContentsCSS=dzeUiConfig.strContentsCSS?dzeUiConfig.strContentsCSS:dzeEnvConfig.strPath_CSS+"contents.css";g_arrAdditionalEditAreaCSS=dzeUiConfig.arrCustomAdditionalEditAreaCSS;g_strAdditionalHeadContent=dzeUiConfig.strCustomAdditionalHeadContent;g_bEditFocusYN=dzeUiConfig.bCustomEditFocusYN;g_bSourceAreaScriptAllowYN=dzeUiConfig.bCustomSourceAreaScriptAllowYN;g_bSourceAreaIframeAllowYN=dzeUiConfig.bCustomSourceAreaIframeAllowYN;
g_bTableOperationYN=dzeUiConfig.bCustomTableOperationYN;g_bTableResizingYN=dzeUiConfig.bCustomTableResizingYN;g_bLockEditCellMode=dzeUiConfig.nCustomLockEditCellMode;g_bEditSourceMode=dzeUiConfig.bCustomEditSourceMode;g_bAnchorTargetBlankYN=dzeUiConfig.bCustomAnchorTargetBlankYN;g_bContentPTagStyleApply=dzeUiConfig.bCustomContentPTagStyleApply;g_bContentXHTMLFormatYN=dzeUiConfig.bCustomContentXHTMLFormatYN;g_bContentXHTMLTabSettingYN=dzeUiConfig.bCustomContentXHTMLTabSettingYN;g_strAdditionalStyle=
g_strCustomAdditionalStyle;g_bConvertPTagToBrTag=dzeUiConfig.bCustomConvertPTagToBrTag;if(0<dzeUiConfig.arrCustomImgSrcRemoveDomain.length)for(g_arrImgSrcRemoveDomain=[],c=0;c<dzeUiConfig.arrCustomImgSrcRemoveDomain.length;c++)g_arrImgSrcRemoveDomain[c]=dzeUiConfig.arrCustomImgSrcRemoveDomain[c].toLowerCase();if(1==dzeUiConfig.autoAddImgSrcRemoveDomain){null==g_arrImgSrcRemoveDomain&&(g_arrImgSrcRemoveDomain=[]);var b=document.location.href.match(/^(https*:\/\/[a-z0-9-_\.:]*)[\/\?]/i);b&&1<b.length&&
g_arrImgSrcRemoveDomain.push(b[1])}g_bAnchorHrefRemoveDomainYN=dzeUiConfig.bCustomAnchorHrefRemoveDomainYN;g_bContextMenuUseYN=dzeUiConfig.bCustomContextMenuUseYN;g_bContextMenuDisplayInEditAreaYN=dzeUiConfig.bCustomContextMenuDisplayInEditAreaYN;g_bEditorWidthPercentageYN=dzeUiConfig.bCustomEditorWidthPercentageYN;g_bEditorHeightIFrameYN=dzeUiConfig.bCustomEditorHeightIFrameYN;g_strTabModeEventFunction=dzeUiConfig.strCustomTabModeEventFunction;g_bSetTableCellBlank=dzeUiConfig.bCustomSetTableCellBlank;
g_strFocusEventFunction=dzeUiConfig.strCustomFocusEventFunction;g_bBottomResizeYN=dzeUiConfig.bCustomBottomResizeYN;g_bTableCellResizingYN=dzeUiConfig.bCustomTableCellResizingYN;g_arrAdjustRemoveAttributeName=dzeUiConfig.arrCustomAdjustRemoveAttributeName;g_arrAdjustRemoveStyleName=dzeUiConfig.arrCustomAdjustRemoveStyleName;g_nAdjustFromPtToPxRatio=dzeUiConfig.nCustomAdjustFromPtToPxRatio;g_bAutoAdjustHwpWordYN=dzeUiConfig.bCustomAutoAdjustHwpWordYN;g_bCheckImgSrcProperty=dzeUiConfig.bCustomCheckImgSrcProperty;
g_arrCheckImgSrcPropertyValue=dzeUiConfig.arrCustomCheckImgSrcPropertyValue;g_bEncodeEndCharacterYN=dzeUiConfig.bCustomEncodeEndCharacterYN;g_strDomainPageName=dzeUiConfig.strCustomDomainPageName;g_bEditorHeightReSettingYN=dzeUiConfig.bCustomEditorHeightReSettingYN;g_bAutoIncludeParentCSS=dzeUiConfig.bCustomAutoIncludeParentCSS;g_nOutdentIndentWidth=dzeUiConfig.nCustomOutdentIndentWidth;g_arrRemoveGarbageText=dzeUiConfig.arrCustomRemoveGarbageText;"object"==typeof dzeUiConfig.arrSkinColorSet&&"blue"!=
dzeEnvConfig.skinColor&&g_objPropertyUtil.setSkinColorSet(dzeEnvConfig.skinColor)}catch(e){dalert(e)}}
function GetInitStyleString(a,c){try{var b=!0!==a?"<style id='dze_cursor'>":"";""!=g_strBodyFontFamily&&(b+="body, td, th, p, input, select {font-family:"+g_strBodyFontFamily+"}");""!=g_strBodyFontSize&&(b+="body, td, th, p, input, select {font-size:"+g_strBodyFontSize+"}");""!=g_strBodyLineHeight&&(b+="body, td, th, p {line-height:"+g_strBodyLineHeight+"}");g_browserCHK.iOS&&!1!==c?b+="body, td, th, p {letter-spacing:-0.15px}":""!=g_strBodyLetterSpacing&&(b+="body, td, th, p, input, select {letter-spacing:"+
g_strBodyLetterSpacing+"}");!0!==a&&(b+="</style>");return b}catch(e){dalert(e)}}
function detectFontFace(){function a(a,b){function c(a){var b=a.toLowerCase().charAt(0),c=a.toLowerCase().charCodeAt(0);return(""===b?"0":44032<=c&&55215>=c?"1":12592<=c&&12687>=c?"2":/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g.test(b)?"3":97<=c&&122>=c?"4":"9")+a}a=a.toLowerCase().replace(/["']/g,"");b=b.toLowerCase().replace(/["']/g,"");a=c(a);b=c(b);return a<b?-1:a>b?1:0}try{if("undefined"!==typeof document.fonts){for(var c=["\ud734\uba3c\uba85\uc870"].sort(),b=0,e=c.length;b<e;b++)c[b]=quoteFontFamily(c[b].replace(/["']/g,
""));c=new Set(c);document.fonts.ready.then(function(){var b=new Set;c.forEach(function(a){document.fonts.check("12px "+a)&&b.add(a)});if(!(0>=b.size)){var e=new Set(g_arrFontName);b.forEach(function(a){e.add(a)});g_arrFontName=Array.from(e);g_arrFontName.sort(a)}})}}catch(g){dalert(g)}};
function HeaderFooter(){this.bDiffOddEvenPage=this.bDiffFirstPage=!1;this.strFirstFooter=this.strEvenFooter=this.strOddFooter=this.strFirstHeader=this.strEvenHeader=this.strOddHeader="";this.cacheHeight={}}
HeaderFooter.prototype={nEditNumber:0,bHeaderFooterEditMode:!1,bShowDocumentText:!0,curTimeoutID:null,bDoNotPropagate:!1,isDoNotPropagate:function(){return this.bDoNotPropagate},bUseEditMode:!0,NONE:0,BODY:1,HEADER:2,FOOTER:4,ODD:16,EVEN:32,FIRST:64,ODD_HEADER:18,EVEN_HEADER:34,FIRST_HEADER:66,ODD_FOOTER:20,EVEN_FOOTER:36,FIRST_FOOTER:68,PAGE_MASK:240,HF_MASK:15,CONTAINER:256,CONTENTS:512,DZE_HF_TYPE:"dze_hf_type",DZE_ODD_HEADER:"dze_odd_header",DZE_EVEN_HEADER:"dze_even_header",DZE_FIRST_HEADER:"dze_first_header",
DZE_ODD_FOOTER:"dze_odd_footer",DZE_EVEN_FOOTER:"dze_even_footer",DZE_FIRST_FOOTER:"dze_first_footer",arrHFClassName:["dze_page_header","dze_page_footer"],init:function(){try{HeaderFooter.prototype.bShowDocumentText=!0,clearTimeout(this.curTimeoutID),HeaderFooter.prototype.curTimeoutID=null,this.bDiffOddEvenPage=this.bDiffFirstPage=!1,this.strFirstFooter=this.strEvenFooter=this.strOddFooter=this.strFirstHeader=this.strEvenHeader=this.strOddHeader="",this.cacheHeight={}}catch(a){dalert(a)}},setOption:function(a){try{void 0!==
a.bUseEditMode&&this.bUseEditMode!==a.bUseEditMode&&(this.bUseEditMode=a.bUseEditMode)}catch(b){dalert(b)}},getHeader:function(a){try{return!0===fnObjectCheckNull(a)&&(a=g_objPageControl.currentPage),this.getHeaderContainer(a).firstChild}catch(b){return null}},getFooter:function(a){try{return!0===fnObjectCheckNull(a)&&(a=g_objPageControl.currentPage),this.getFooterContainer(a).firstChild}catch(b){return null}},getHeaderContainer:function(a){try{return!0===fnObjectCheckNull(a)&&(a=g_objPageControl.currentPage),
g_objPageControl.getPageNode(a).firstChild}catch(b){return null}},getFooterContainer:function(a){try{return!0===fnObjectCheckNull(a)&&(a=g_objPageControl.currentPage),g_objPageControl.getPageNode(a).childNodes[2]}catch(b){return null}},isHeader:function(a){return g_objPropertyUtil.hasClass(a,"dze_page_header")?a:null},isFooter:function(a){return g_objPropertyUtil.hasClass(a,"dze_page_footer")?a:null},isHeaderFooter:function(a){try{return g_objPropertyUtil.hasClass(a,this.arrHFClassName)?a:null}catch(b){return dalert(b),
null}},doAllHeaderFooter:function(a){try{for(var b=g_objPageControl.getTotalPageCount(),c,d=0;d<b;d++){c=a.call(this,this.getHeader(d),this.HEADER);if(!1===c)break;c=a.call(this,this.getFooter(d),this.FOOTER);if(!1===c)break}}catch(e){dalert(e)}},doAllBody:function(a){try{for(var b=g_objPageControl,c=b.getTotalPageCount(),d,e=0;e<c&&(d=a.call(this,b.getPageMain(e)),!1!==d);e++);}catch(f){dalert(f)}},doAllPage:function(a){try{for(var b=g_objPageControl.getTotalPageCount(),c,d=0;d<b&&(c=a.call(this,
d),!1!==c);d++);}catch(e){dalert(e)}},getHeaderGuideline:function(a){try{return this.getHeaderContainer(a).childNodes[1]}catch(b){return dalert(b),null}},getFooterGuideline:function(a){try{return this.getFooterContainer(a).childNodes[1]}catch(b){return dalert(b),null}},enable:function(a,b){try{"undefined"===typeof b&&(b=!0),b?(b=g_objPropertyUtil,a.contentEditable=!0,b.element_removeClass(a,"unselectable"),b.removeStyleAttribute(a,"opacity")):this.disable(a)}catch(c){dalert(c)}},disable:function(a){try{a.contentEditable=
!1,this.bUseEditMode&&(g_objPropertyUtil.addClass(a,"unselectable"),a.style.opacity=.5)}catch(b){dalert(b)}},setEnableForFindReplace:function(){try{this.doAllBody(function(a){g_objPropertyUtil.removeClass(a,"unselectable");a.contentEditable=!0}),this.doAllHeaderFooter(function(a){a.firstChild&&(g_objPropertyUtil.removeClass(a,"unselectable"),a.contentEditable=!0)})}catch(a){dalert(a)}},restoreEnableForFindReplace:function(){try{if(this.getHeaderFooterEditMode())this.doAllBody(function(a){this.disable(a)}),
this.doAllHeaderFooter(function(a){this.enable(a)});else{var a=g_objPropertyUtil.hasClass(g_objEditorDocument[g_nActiveEditNumber].body,"unselectable");g_readonlyMode?this.doAllBody(function(a){a.contentEditable=!1;g_objPropertyUtil.addClass(a,"unselectable")}):this.doAllBody(function(a){this.enable(a)});this.doAllHeaderFooter(function(b){a?(b.contentEditable=!1,g_objPropertyUtil.addClass(b,"unselectable")):this.disable(b)})}}catch(b){dalert(b)}},contains:function(a){try{if(!a)return!1;var b=g_objPageControl.getPageNum(a);
if(null===b)return!1;var c=this.getHeader(b);if(c&&a!==c&&c.contains(3===a.nodeType?a.parentNode:a))return!0;var d=this.getFooter(b);return d&&a!==d&&d.contains(3===a.nodeType?a.parentNode:a)?!0:!1}catch(e){dalert(e)}},isHeaderFooterContainer:function(a){try{if(!a)return!1;var b=g_objPageControl.getPageNum(a);return null===b?!1:a==this.getHeaderContainer(b)||a==this.getFooterContainer(b)?!0:!1}catch(c){dalert(c)}},getHeaderFooterEditMode:function(){try{return dzeUiConfig.bUseHeaderFooter&&this.bHeaderFooterEditMode}catch(a){dalert(a)}},
initEditingState:function(a){try{g_objShapeFunction.onDeselectAllShapes(),g_objPasteOptionMenu.remove(),g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objTableSelection.deselectAllCell(GetCurTable(a))}catch(b){dalert(b)}},updateEditingState:function(a){try{if(editor_onselectionchange(a),g_objTableMiniMenu.delayUpdate(a),a=g_objSelectedShapesArray,0<a.length)for(var b=0;b<a.length;b++)g_objWrapperOutlineUtil_Improved.updateOutline(a[b])}catch(c){dalert(c)}},setHeaderFooterEditMode:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return!1;
var c=this.bHeaderFooterEditMode;HeaderFooter.prototype.bHeaderFooterEditMode=a===this.HEADER||a===this.FOOTER||!0===a?!0:!1;if(c==this.bHeaderFooterEditMode)return this.bHeaderFooterEditMode;var d=this.nEditNumber,e=b&&!1===b.bMoveCaret?!1:!0;this.initEditingState(d);if(this.bHeaderFooterEditMode)this.doAllHeaderFooter(function(a,b){a.firstChild||(a.innerHTML="<p><br></p>");a.parentNode.style.zIndex=b==this.HEADER?"0":"2";this.enable(a)}),this.doAllBody(function(a){this.disable(a);a.style.zIndex=
"1"}),this.doAllPage(function(a){g_objPageControl.setPageLayout(a)}),e&&g_objCaretUtil.moveCaret(a===this.FOOTER?this.getFooter():this.getHeader()),this.updateEditingState(d),"ribbon"===dze_menu_control.getUiMode()&&(dze_menu_control.setTBHeaderFooter(d),dze_menu_control.evtMouseUpShowDynamicMenu());else{this.doAllHeaderFooter(function(a){this.isBlankHeaderFooter(a)&&(a.innerHTML="",this.setHeaderFooterHTML(this.getHeaderFooterType(a),""));a.parentNode.style.zIndex="";this.disable(a)});this.doAllBody(function(a){this.enable(a);
a.style.zIndex=""});this.doAllPage(function(a){g_objPageControl.setPageLayout(a)});this.setShowDocumentText(!0);var f=g_objEditWindow[d].getSelection();f&&f.removeAllRanges();if(dzeUiConfig.bOfficeOnePageLongMode)this.updateEditingState(d),"ribbon"===dze_menu_control.getUiMode()&&(dze_menu_control.setTBHeaderFooter(d),dze_menu_control.evtMouseUpShowDynamicMenu());else g_objPageControl.onSetDelayedUpdatePageTimerAll(0,function(){if(e){var a=g_objPageControl.getPageMain(g_objPageControl.currentPage);
g_objCaretUtil.moveCaret(a)}else(a=GetCurRange(d))&&a.startContainer&&g_objCaretUtil.scrollTo(a.startContainer);this.updateEditingState(d);"ribbon"===dze_menu_control.getUiMode()&&(dze_menu_control.setTBHeaderFooter(d),dze_menu_control.evtMouseUpShowDynamicMenu())}.bind(this))}var g=g_objPageControl.getTotalPageCount();for(a=0;a<g;a++)this.showGuideline(a,this.bHeaderFooterEditMode);return this.bHeaderFooterEditMode}catch(h){dalert(h)}},onmousedown:function(a){try{var b=a.srcElement?a.srcElement:
a.target;if(b){a=g_objPropertyUtil;if("DIV"===b.nodeName&&a.hasClass(b,["dze_page_header","dze_page_footer"]))return!0;this.setHeaderFooterEditMode(this.contains(b)?!0:!1,{bMoveCaret:!1})}}catch(c){dalert(c)}},ondblclick:function(a){try{if(!dzeUiConfig.bUseHeaderFooter||g_readonlyMode||!1===this.bUseEditMode)return!1;var b=a.srcElement?a.srcElement:a.target,c={x:a.clientX,y:a.clientY};if(!1===fnObjectCheckNull(b.classList)&&!0===b.classList.contains("dze_page_controller"))return!1;var d=function(a,
b){return a&&b?a.left<=b.x&&b.x<=a.right&&a.top<=b.y&&b.y<=a.bottom:!1},e=null,f=null,g=null,h=null,l=null,k=g_objPageControl.getPageNum(b);null!==k&&(g_objPageControl.currentPage=k,e=g_objPageControl.getPageMain(k),f=this.getHeaderContainer(k),g=this.getFooterContainer(k),e.getBoundingClientRect(),h=f.getBoundingClientRect(),l=g.getBoundingClientRect());var m=this.NONE;!1===this.getHeaderFooterEditMode()?d(h,c)?m=this.HEADER:d(l,c)&&(m=this.FOOTER):d(h,c)||d(l,c)||(m=this.BODY);if(m===this.BODY){var n=
g_objCaretUtil.getRangeFromPoint(a.clientX,a.clientY);n?(this.setHeaderFooterEditMode(m,{bMoveCaret:!1}),SetCurRange(n.getRange())):this.setHeaderFooterEditMode(m);return!0}return m?(this.setHeaderFooterEditMode(m),!0):!1}catch(p){dalert(p)}},showGuideline:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter||!1===this.bUseEditMode)return!1;var c=g_objEditorDocument[this.nEditNumber];if(!c)return!1;var d=this.getHeaderGuideline(a),e=this.getFooterGuideline(a);d||(d=c.createElement("div"),d.className=
"dze_page_header_guideline",d.innerHTML="<div class='dze_page_header_guidetext'>"+ID_RES_CONST_STRING_HEADER+"</div>",this.getHeaderContainer(a).appendChild(d));e||(e=c.createElement("div"),e.className="dze_page_footer_guideline",e.innerHTML="<div class='dze_page_footer_guidetext'>"+ID_RES_CONST_STRING_FOOTER+"</div>",this.getFooterContainer(a).appendChild(e));"undefined"==typeof b&&(b=this.bHeaderFooterEditMode);if(b){d.style.display="";e.style.display="";var f=d.firstChild.firstChild,g=e.firstChild.firstChild;
switch(this.getPageType(a)){case this.FIRST:f.nodeValue=ID_RES_CONST_STRING_FIRST_HEADER;g.nodeValue=ID_RES_CONST_STRING_FIRST_FOOTER;break;case this.EVEN:f.nodeValue=ID_RES_CONST_STRING_EVEN_HEADER;g.nodeValue=ID_RES_CONST_STRING_EVEN_FOOTER;break;case this.ODD:this.bDiffOddEvenPage?(f.nodeValue=ID_RES_CONST_STRING_ODD_HEADER,g.nodeValue=ID_RES_CONST_STRING_ODD_FOOTER):(f.nodeValue=ID_RES_CONST_STRING_HEADER,g.nodeValue=ID_RES_CONST_STRING_FOOTER)}}else d.style.display="none",e.style.display="none";
return!0}catch(h){dalert(h)}},getCurHeaderFooter:function(){try{var a=g_objNodeUtil,b=g_objEditWindow[this.nEditNumber].getSelection(),c=b&&0<b.rangeCount?b.getRangeAt(0):null;b=null;if(c){for(b=c.commonAncestorContainer;b&&!a.isLoopBreakNode(b);)b=b.parentNode;if(this.isHeaderFooter(b))return b}var d=GetCurTable(this.nEditNumber);if(d){for(b=d;b&&!a.isLoopBreakNode(b);)b=b.parentNode;if(this.isHeaderFooter(b))return b}return null}catch(e){dalert(e)}finally{}},getHeaderFooterType:function(a){try{if(!a||
!dzeUiConfig.bUseHeaderFooter)return this.NONE;var b=g_objPropertyUtil,c=0;if(b.element_hasClass(a,"dze_page_header"))c=this.HEADER;else if(b.element_hasClass(a,"dze_page_footer"))c=this.FOOTER;else return this.NONE;var d=g_objPageControl.getPageNum(a),e=this.getPageType(d);return c|e}catch(f){dalert(f)}},getPageType:function(a){try{if("undefined"==typeof a||!dzeUiConfig.bUseHeaderFooter)return this.NONE;a=parseInt(a)+1;var b=this.NONE;return b=this.bDiffFirstPage&&1==a?this.FIRST:this.bDiffOddEvenPage&&
0==a%2?this.EVEN:this.ODD}catch(c){dalert(c)}},clearCache:function(){try{this.cacheHeight={}}catch(a){dalert(a)}},getHeaderTypeAttrValue:function(a){try{switch(this.getPageType(a)){case this.ODD:return this.DZE_ODD_HEADER;case this.EVEN:return this.DZE_EVEN_HEADER;case this.FIRST:return this.DZE_FIRST_HEADER}return""}catch(b){dalert(b)}},getFooterTypeAttrValue:function(a){try{switch(this.getPageType(a)){case this.ODD:return this.DZE_ODD_FOOTER;case this.EVEN:return this.DZE_EVEN_FOOTER;case this.FIRST:return this.DZE_FIRST_FOOTER}return""}catch(b){dalert(b)}},
getHeaderContainerHeight:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return b?dzeUiConfig.nSettingPaperMargin.top:+g_objCommonUtil.convMMToPx(dzeUiConfig.nSettingPaperMargin.top).toFixed(2);var c=this.getHeaderContainer(a),d=this.getHeader(a);if(!d||!c||!this.getHeaderFooterEditMode()&&this.isBlankHeaderFooter(d))return b?dzeUiConfig.nSettingPaperMargin.top:+g_objCommonUtil.convMMToPx(dzeUiConfig.nSettingPaperMargin.top).toFixed(2);var e=this.getPageType(a)|this.HEADER|this.CONTAINER,f=this.cacheHeight[e];
f||(f=c.offsetHeight,this.cacheHeight[e]=f);return!0===b?+g_objCommonUtil.convPxToMM(c.offsetHeight).toFixed(2):f}catch(g){dalert(g)}},getFooterContainerHeight:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return b?dzeUiConfig.nSettingPaperMargin.bottom:+g_objCommonUtil.convMMToPx(dzeUiConfig.nSettingPaperMargin.bottom).toFixed(2);var c=this.getFooterContainer(a),d=this.getFooter(a);if(!d||!c||!this.getHeaderFooterEditMode()&&this.isBlankHeaderFooter(d))return b?dzeUiConfig.nSettingPaperMargin.bottom:
+g_objCommonUtil.convMMToPx(dzeUiConfig.nSettingPaperMargin.bottom).toFixed(2);var e=this.getPageType(a)|this.FOOTER|this.CONTAINER,f=this.cacheHeight[e];f||(f=c.offsetHeight,this.cacheHeight[e]=f);return!0===b?+g_objCommonUtil.convPxToMM(f).toFixed(2):f}catch(g){dalert(g)}},getHeaderHeight:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return 0;var c=this.getHeader(a);if(!c||!this.getHeaderFooterEditMode()&&this.isBlankHeaderFooter(c))return 0;var d=this.getPageType(a)|this.HEADER,e=this.cacheHeight[d];
e||(e=c.offsetHeight,this.cacheHeight[d]=e);return!0===b?+g_objCommonUtil.convPxToMM(e).toFixed(2):e}catch(f){dalert(f)}},getFooterHeight:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return 0;var c=this.getFooter(a);if(!c||!this.getHeaderFooterEditMode()&&this.isBlankHeaderFooter(c))return 0;var d=this.getPageType(a)|this.FOOTER,e=this.cacheHeight[d];e||(e=c.offsetHeight,this.cacheHeight[d]=e);return!0===b?+g_objCommonUtil.convPxToMM(e).toFixed(2):e}catch(f){dalert(f)}},getHeaderContentsHeight:function(a,
b){try{if(!dzeUiConfig.bUseHeaderFooter)return 0;var c=this.getHeader(a);if(!c||!c.lastChild||!this.getHeaderFooterEditMode()&&this.isBlankHeaderFooter(c))return 0;var d=this.getPageType(a)|this.HEADER|this.CONTENTS,e=this.cacheHeight[d];if(!e){var f=c.lastChild;e=f.offsetTop+f.offsetHeight;this.cacheHeight[d]=e}return!0===b?+g_objCommonUtil.convPxToMM(e).toFixed(2):e}catch(g){dalert(g)}},getFooterContentsHeight:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return 0;var c=this.getFooter(a);if(!c||
!c.lastChild||!this.getHeaderFooterEditMode()&&this.isBlankHeaderFooter(c))return 0;var d=this.getPageType(a)|this.FOOTER|this.CONTENTS,e=this.cacheHeight[d];if(!e){var f=c.lastChild;e=f.offsetTop+f.offsetHeight;this.cacheHeight[d]=e}return!0===b?+g_objCommonUtil.convPxToMM(e).toFixed(2):e}catch(g){dalert(g)}},getHeaderFooterContainerHeight:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return 0;var c=a&this.HF_MASK,d=a&this.PAGE_MASK;if(!c||!d)return 0;var e=this.getFirstPageNum(a);return null===
e?0:c==this.HEADER?this.getHeaderContainerHeight(e,b):this.getFooterContainerHeight(e,b)}catch(f){dalert(f)}},getPageHeaderContents:function(a){try{return this.getHeaderFooterContents(this.getPageType(a)|this.HEADER)}catch(b){dalert(b)}},getPageFooterContents:function(a){try{return this.getHeaderFooterContents(this.getPageType(a)|this.FOOTER)}catch(b){dalert(b)}},getPageHeaderFooterContents:function(a,b){try{if("undefined"==typeof a||!dzeUiConfig.bUseHeaderFooter)return"";var c=this.getPageType(a);
c|=b?this.HEADER:this.FOOTER;return this.getHeaderFooterContents(c)}catch(d){dalert(d)}},getHeaderFooterContents:function(a){try{if(!dzeUiConfig.bUseHeaderFooter)return"";switch(a){case this.ODD_HEADER:return this.strOddHeader;case this.EVEN_HEADER:return this.strEvenHeader;case this.FIRST_HEADER:return this.strFirstHeader;case this.ODD_FOOTER:return this.strOddFooter;case this.EVEN_FOOTER:return this.strEvenFooter;case this.FIRST_FOOTER:return this.strFirstFooter}return""}catch(b){dalert(b)}},getEditingHeaderFooterContents:function(a){try{var b=
this.getHeaderFooterContents(a);return""==b&&this.getHeaderFooterEditMode()?"<p><br></p>":b}catch(c){dalert(c)}},setHeaderFooterHTML:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return!1;switch(a){case this.ODD_HEADER:this.strOddHeader=b;break;case this.EVEN_HEADER:this.strEvenHeader=b;break;case this.FIRST_HEADER:this.strFirstHeader=b;break;case this.ODD_FOOTER:this.strOddFooter=b;break;case this.EVEN_FOOTER:this.strEvenFooter=b;break;case this.FIRST_FOOTER:this.strFirstFooter=b;break;default:return!1}this.cacheHeight[a]=
null;this.cacheHeight[a|this.CONTAINER]=null;this.cacheHeight[a|this.CONTENTS]=null;return!0}catch(c){dalert(c)}},setHeaderFooterAttribute:function(a,b){try{if(!dzeUiConfig.bUseHeaderFooter)return!1;switch(a){case DZE_CUSTOM_ATT_DIFF_FIRST_PAGE:this.bDiffFirstPage="true"===b?!0:!1;break;case DZE_CUSTOM_ATT_DIFF_ODD_EVEN_PAGE:this.bDiffOddEvenPage="true"===b?!0:!1;break;case DZE_CUSTOM_ATT_ODD_HEADER:this.strOddHeader=b;break;case DZE_CUSTOM_ATT_EVEN_HEADER:this.strEvenHeader=b;break;case DZE_CUSTOM_ATT_FIRST_HEADER:this.strFirstHeader=
b;break;case DZE_CUSTOM_ATT_ODD_FOOTER:this.strOddFooter=b;break;case DZE_CUSTOM_ATT_EVEN_FOOTER:this.strEvenFooter=b;break;case DZE_CUSTOM_ATT_FIRST_FOOTER:this.strFirstFooter=b;break;default:return!1}return!0}catch(c){dalert(c)}},exportHeaderFooterAttribute:function(a,b){try{if(a&&1===a.nodeType){var c=function(b,c){c?a.setAttribute(b,c):a.removeAttribute(b)};c(DZE_CUSTOM_ATT_DIFF_FIRST_PAGE,this.bDiffFirstPage);c(DZE_CUSTOM_ATT_DIFF_ODD_EVEN_PAGE,this.bDiffOddEvenPage);c(DZE_CUSTOM_ATT_ODD_HEADER,
this.strOddHeader);c(DZE_CUSTOM_ATT_EVEN_HEADER,this.strEvenHeader);c(DZE_CUSTOM_ATT_FIRST_HEADER,this.strFirstHeader);c(DZE_CUSTOM_ATT_ODD_FOOTER,this.strOddFooter);c(DZE_CUSTOM_ATT_EVEN_FOOTER,this.strEvenFooter);c(DZE_CUSTOM_ATT_FIRST_FOOTER,this.strFirstFooter);if(!0===b){b="";var d=function(a){return this.getHeaderFooterContainerHeight(a,!0)}.bind(this);b+=d(this.ODD_HEADER)+",";b+=d(this.EVEN_HEADER)+",";b+=d(this.FIRST_HEADER)+",";b+=d(this.ODD_FOOTER)+",";b+=d(this.EVEN_FOOTER)+",";b+=d(this.FIRST_FOOTER);
a.setAttribute(DZE_CUSTOM_ATT_HF_HEIGHT,b)}}}catch(e){dalert(e)}},importHeaderFooterAttribute:function(a,b){try{if(!a||1!==a.nodeType)return!1;var c={};c.bDiffFirstPage="true"===a.getAttribute(DZE_CUSTOM_ATT_DIFF_FIRST_PAGE)?!0:!1;c.bDiffOddEvenPage="true"===a.getAttribute(DZE_CUSTOM_ATT_DIFF_ODD_EVEN_PAGE)?!0:!1;var d=function(b){return a.getAttribute(b)||""};if(!1!==b)try{var e=new DzeVer(objOnefficeLoader.m_dzVersion),f=new DzeVer(oneffice.docVersion);e&&f&&4<=e.release&&4>f.release&&(d=function(b){return g_objHeaderFooter.getMigrationHTML(a.getAttribute(b)||
"")})}catch(h){}c.strOddHeader=d(DZE_CUSTOM_ATT_ODD_HEADER);c.strEvenHeader=d(DZE_CUSTOM_ATT_EVEN_HEADER);c.strFirstHeader=d(DZE_CUSTOM_ATT_FIRST_HEADER);c.strOddFooter=d(DZE_CUSTOM_ATT_ODD_FOOTER);c.strEvenFooter=d(DZE_CUSTOM_ATT_EVEN_FOOTER);c.strFirstFooter=d(DZE_CUSTOM_ATT_FIRST_FOOTER);b=!1;for(var g in c)this[g]!==c[g]&&(this[g]=c[g],b=!0);return b?(this.cacheHeight={},clearTimeout(this.curTimeoutID),HeaderFooter.prototype.curTimeoutID=null,!0):!1}catch(h){dalert(h)}},removeHeaderFooterAttribute:function(a){try{a&&
1===a.nodeType&&(a.removeAttribute(DZE_CUSTOM_ATT_DIFF_FIRST_PAGE),a.removeAttribute(DZE_CUSTOM_ATT_DIFF_ODD_EVEN_PAGE),a.removeAttribute(DZE_CUSTOM_ATT_ODD_HEADER),a.removeAttribute(DZE_CUSTOM_ATT_EVEN_HEADER),a.removeAttribute(DZE_CUSTOM_ATT_FIRST_HEADER),a.removeAttribute(DZE_CUSTOM_ATT_ODD_FOOTER),a.removeAttribute(DZE_CUSTOM_ATT_EVEN_FOOTER),a.removeAttribute(DZE_CUSTOM_ATT_FIRST_FOOTER))}catch(b){dalert(b)}},saveInnerHTML:function(a){try{var b=this.getHeaderFooterType(a);if(b){var c=g_objPageControl,
d="",e=null;this.bHeaderFooterEditMode&&this.isBlankHeaderFooter(a)&&(a.innerHTML="<p><br></p>");c.surroundByParagraph(a);var f=GetCurTable(this.nEditNumber);a.contains(f)&&(e=g_objTableSelection.clearCellSelection(f,[]));g_objTagUtil.updateCurFormTagAttr(this.nEditNumber);d=a.innerHTML;g_objTableSelection.restoreCellSelection(e);if(this.getHeaderFooterContents(b)==d)return!1;this.setHeaderFooterHTML(b,d);c.setPageLayout(c.getPageNum(a));this.doAllHeaderFooter(function(a){b==this.getHeaderFooterType(a)&&
(a.dzeDirty=!0)});delete a.dzeDirty;return!0}}catch(g){dalert(g)}},propagateHeaderFooter:function(a,b,c,d){try{if(dzeUiConfig.bUseHeaderFooter){var e=c?c:this.getCurHeaderFooter();e&&(0>a?this.saveInnerHTML(e)&&!0!==d&&null===this.curTimeoutID&&(HeaderFooter.prototype.curTimeoutID=setTimeout(function(){this.runPropagate(0)}.bind(this),a)):!0!==d&&(clearTimeout(this.curTimeoutID),HeaderFooter.prototype.curTimeoutID=setTimeout(function(){this.saveInnerHTML(e);this.runPropagate(0)}.bind(this),a)))}}catch(f){dalert(f)}},
runPropagate:function(a,b){try{if(dzeUiConfig.bUseHeaderFooter){for(var c=g_objPageControl,d=Math.min(a+10,c.getTotalPageCount());a<d;a++)this.updateDirtyHeaderFooter(a);var e=null;if(a<c.getTotalPageCount())e=setTimeout(function(){g_objHeaderFooter.runPropagate(a,b)},0);else{var f=0;for(d=c.getTotalPageCount();f<d;f++)if(this.getHeader(f).dzeDirty||this.getFooter(f).dzeDirty){e=setTimeout(function(){g_objHeaderFooter.runPropagate(f,0)},0);break}}HeaderFooter.prototype.curTimeoutID=e}}catch(g){dalert(g)}},
updateDirtyHeaderFooter:function(a){try{if(!dzeUiConfig.bUseHeaderFooter)return!1;var b=!1,c=this.getHeader(a);c&&c.dzeDirty&&(b|=this.updateHeaderFooter(c));var d=this.getFooter(a);d&&d.dzeDirty&&(b|=this.updateHeaderFooter(d));b&&g_objPageControl.setPageLayout(a);return b}catch(e){dalert(e)}},updateHeaderFooter:function(a){try{if(!a||!dzeUiConfig.bUseHeaderFooter)return!1;var b=this.getHeaderFooterType(a),c=b&this.HF_MASK;if(c!=this.HEADER&&c!=this.FOOTER)return!1;var d=this.getHeaderFooterContents(b);
this.bHeaderFooterEditMode&&!d&&(d="<p><br></p>");a.innerHTML=d;delete a.dzeDirty;c==this.HEADER?a.setAttribute(this.DZE_HF_TYPE,this.getHeaderTypeAttrValue(g_objPageControl.getPageNum(a))):a.setAttribute(this.DZE_HF_TYPE,this.getFooterTypeAttrValue(g_objPageControl.getPageNum(a)));return!0}catch(e){dalert(e)}},isBlankHeaderFooter:function(a){try{if(!a||!a.firstChild)return!0;var b=a.firstChild;if(b&&!b.nextSibling&&"P"===b.nodeName){var c=b.firstChild;if(!c||"BR"===c.nodeName&&!c.nextSibling)return!0;
var d=c.nextSibling;if(3===c.nodeType&&0==c.nodeValue.length&&d&&"BR"===d.nodeName&&!d.nextSibling)return!0}return!1}catch(e){dalert(e)}},setDiffFirstPage:function(a){try{if(this.bDiffFirstPage!=a){var b=this.nEditNumber;this.initEditingState(b);this.bDiffFirstPage=a;this.setHeaderFooterContents(0,this.getCurHeaderFooter());this.showGuideline(0);this.clearCache();this.registerUndoRedoStack();this.updateEditingState(b)}}catch(c){dalert(c)}},setDiffOddEvenPage:function(a){try{if(this.bDiffOddEvenPage!=
a){var b=this.nEditNumber;this.initEditingState(b);this.bDiffOddEvenPage=a;var c=this.getCurHeaderFooter();this.doAllPage(function(a){0==(a+1)%2&&this.setHeaderFooterContents(a,c);this.showGuideline(a)});this.clearCache();this.registerUndoRedoStack();this.updateEditingState(b)}}catch(d){dalert(d)}},setShowDocumentText:function(a){try{var b=g_objPageControl.getPageMain(0);b&&("hidden"==b.style.visibility?!1:!0)!=a&&(HeaderFooter.prototype.bShowDocumentText=a,a=null,a=this.bShowDocumentText?function(a){g_objPropertyUtil.removeStyleAttribute(a,
"visibility")}:function(a){a.style.visibility="hidden"},this.doAllBody(a))}catch(c){dalert(c)}},setHeaderFooterContents:function(a,b){try{var c=this.getPageType(a),d=this.getHeader(a);d&&(d.innerHTML=this.getEditingHeaderFooterContents(c|this.HEADER),delete d.dzeDirty,d.setAttribute(this.DZE_HF_TYPE,this.getHeaderTypeAttrValue(a)),b==d&&g_objCaretUtil.moveCaret(b));var e=this.getFooter(a);e&&(e.innerHTML=this.getEditingHeaderFooterContents(c|this.FOOTER),delete e.dzeDirty,e.setAttribute(this.DZE_HF_TYPE,
this.getFooterTypeAttrValue(a)),b==e&&g_objCaretUtil.moveCaret(b));return!0}catch(f){dalert(f)}},removeHeaderFooter:function(a){try{var b=g_objCaretUtil.getPageNum().start;null===b&&(b=parseInt(g_objPageControl.currentPage));var c=this.nEditNumber,d=this.getCurHeaderFooter(),e=this.getPageType(b);e|=a?this.HEADER:this.FOOTER;this.initEditingState(c);var f=this.getHeaderFooterEditMode()?"<p><br></p>":"";this.setHeaderFooterHTML(e,f);this.doAllHeaderFooter(function(a){this.getHeaderFooterType(a)===
e&&(delete a.dzeDirty,a.innerHTML=f,d===a&&g_objCaretUtil.moveCaret(d))});if(!this.getHeaderFooterEditMode()){var g=g_objPageControl;this.doAllPage(function(a){g.setPageLayout(a)})}this.registerUndoRedoStack();this.updateEditingState(c);return!0}catch(h){dalert(h)}},registerUndoRedoStack:function(){try{if(this.getHeaderFooterEditMode())HeaderFooter.prototype.bDoNotPropagate=!0,g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber),HeaderFooter.prototype.bDoNotPropagate=!1;else g_objPageControl.onSetDelayedUpdatePageTimerAll(0,
function(){HeaderFooter.prototype.bDoNotPropagate=!0;g_objUndoRedo.registerUndoRedoStack(0,g_objHeaderFooter.nEditNumber);HeaderFooter.prototype.bDoNotPropagate=!1})}catch(a){dalert(a)}},moveHeaderFooter:function(a){try{var b=this.getCurHeaderFooter();if(b){var c=g_objPageControl.getPageNum(b),d=this.getHeaderFooterType(b),e=d&this.PAGE_MASK,f=d&this.HF_MASK;b=g_objCaretUtil;d=g_objPageControl;var g=this.nEditNumber,h=null,l=null;switch(a){case ID_COMMAND_GO_TO_HEADER:f===this.FOOTER&&(h=this.getHeader(c));
break;case ID_COMMAND_GO_TO_FOOTER:f===this.HEADER&&(h=this.getFooter(c));break;case ID_COMMAND_JUMP_TO_PREVIOUS_HEADER_FOOTER:if(this.bDiffOddEvenPage||this.bDiffFirstPage){for(var k=c-1;0<=k&&e===this.getPageType(k);k--);0<=k&&(f===this.HEADER?(h=this.getHeader(k),l=b.ALIGN_TO_TOP):f===this.FOOTER&&(h=this.getFooter(k),l=b.ALIGN_TO_BOTTOM))}break;case ID_COMMAND_JUMP_TO_NEXT_HEADER_FOOTER:if(this.bDiffOddEvenPage||this.bDiffFirstPage){var m=g_objPageControl.getTotalPageCount();for(k=c+1;k<m&&e===
this.getPageType(k);k++);k<m&&(f===this.HEADER?(h=this.getHeader(k),l=b.ALIGN_TO_TOP):f===this.FOOTER&&(h=this.getFooter(k),l=b.ALIGN_TO_BOTTOM))}}if(h){this.initEditingState(g);var n=d.getPageNum(h);b.moveCaret(h,l?!1:!0);null!==l&&b.scrollToPage(n,l);this.updateEditingState(g)}}}catch(p){dalert(p)}},setHeaderOverflowBlinderStyle:function(){var a=0,b="#FFFFFF";return function(){try{if(dzeUiConfig.bUseHeaderFooter){var c=g_objEditorDocument[this.nEditNumber],d=+g_objCommonUtil.convMMToPx(dzeUiConfig.nSettingPaperSize.height/
2-10).toFixed(2)+"px",e=dzeUiConfig.sSettingPaperColor;a!=d&&(a=d,changeCss(".dze_page_header_overflow[dze_hf_type='dze_odd_header']::after","top",a,c),changeCss(".dze_page_header_overflow[dze_hf_type='dze_even_header']::after","top",a,c),changeCss(".dze_page_header_overflow[dze_hf_type='dze_first_header']::after","top",a,c));b!=e&&(b=e,changeCss(".dze_page_header_overflow[dze_hf_type='dze_odd_header']::after","background-color",b,c),changeCss(".dze_page_header_overflow[dze_hf_type='dze_even_header']::after",
"background-color",b,c),changeCss(".dze_page_header_overflow[dze_hf_type='dze_first_header']::after","background-color",b,c))}}catch(f){dalert(f)}}}(),getFirstPageNum:function(a){try{var b=a&this.PAGE_MASK;if(!b)return null;a=null;this.bDiffFirstPage&&this.bDiffOddEvenPage?b==this.FIRST?a=0:b==this.EVEN?a=1:b==this.ODD&&(a=2):this.bDiffFirstPage&&!this.bDiffOddEvenPage?b==this.FIRST?a=0:b==this.ODD&&(a=1):!this.bDiffFirstPage&&this.bDiffOddEvenPage?b==this.ODD?a=0:b==this.EVEN&&(a=1):b==this.ODD&&
(a=0);return null===a||a>=g_objPageControl.getTotalPageCount()?null:a}catch(c){dalert(c)}},getMigrationHTML:function(a){function b(a){return JSON.parse('{"'+a.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(a,b){return""===a?b:decodeURIComponent(b)})}try{return a?a=a.replace(/(<(?:img|source).*?src=")(.*?)("[^>]+>)/g,function(a,d,e,f){e=e.replace(/(.*)(\/gw\/onefficeApi\/getAttachmentData\.do\?)(.*)/,function(a,c,d,e){d="/ecm/oneffice/one006A02?";a=b(e);if("bizbox_report"===a.ref&&a.seq&&!a.folder){a.folder=
a.seq.split("-")[0];e="";for(var f in a)e+=(""===e?"":"&")+(f+"="+a[f])}return c+d+e});e=e.replace(/(.*)(\/upload\/onefficeFile\/report\/)(.*)/,function(a,b,c,d){return b+"/upload/ecm/oneffice/report/"+d});e=e.replace(/(.*)(\/gw\/oneffice\/image\/)(.*)/,function(a,b,c,d){return b+"/static/klago-ui-oneffice/image/"+d});return d+e+f}):""}catch(c){return dalert(c),a}}};var g_objHeaderFooter=new HeaderFooter;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){a!=Array.prototype&&a!=Object.prototype&&(a[b]=e.value)};
$jscomp.polyfill=function(a,b,e,c){if(b){e=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var d=a[c];d in e||(e[d]={});e=e[d]}a=a[a.length-1];c=e[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function e(a){return a instanceof d?a:new d(function(g,b){g(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var g=this;this.asyncExecuteFunction(function(){g.executeBatch_()})}this.batch_.push(a)};var c=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){c(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};d.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;d.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};d.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};d.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{e(a(b))}catch(q){f(q)}}:b}var e,f,g=new d(function(a,b){e=a;f=b});this.callWhenSettled_(c(a,e),c(b,f));return g};
d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};d.resolve=e;d.reject=function(a){return new d(function(b,c){c(a)})};d.race=function(a){return new d(function(b,c){for(var d=$jscomp.makeIterator(a),f=d.next();!f.done;f=d.next())e(f.value).callWhenSettled_(b,
c)})};d.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?e([]):new d(function(a,d){function f(b){return function(c){n[b]=c;g--;0==g&&a(n)}}var n=[],g=0;do n.push(void 0),g++,e(c.value).callWhenSettled_(f(n.length-1),d),c=b.next();while(!c.done)})};return d},"es6","es3");
var PAGE_SHOT=0,OBJ_SHOT=1,SCREEN_SHOT=2,THUMBNAIL_IMG_GAP="10px",THUMBNAIL_TYPE_WEB=0,THUMBNAIL_TYPE_MESSENGER=1,onefficeThumbMgr=function(){this.m_thumbURL="";this.m_bThumbUploadFlag=!0;this.m_strThumbDocData=null;this.m_thumbPath="";this.m_lastTarget=null;this.setUpdateFlag=function(a){this.m_bThumbUploadFlag=a};this.isThumbUploadFlag=function(){return this.m_bThumbUploadFlag};this.setThumbRawData=function(a){this.m_strThumbDocData=a;this.setUpdateFlag(!0)};this.getThumbRawData=function(a){return this.m_strThumbDocData};
this.setThumbServerPath=function(a){this.m_thumbURL=a};this.getThumbServerPath=function(){return this.m_thumbURL};this.uploadCompleteCB=function(a,b,e,c){a.toDataURL("image/png");g_objThumbMgr.setThumbRawData(a);a=this.m_thumbObjFile=g_objOnefficeShot.createImgFile(this.m_strThumbDocData,oneffice.currFileSeq+"-uploadThumbImg.png",FILETYPE.IMG_PNG);DZE_UPLOAD_EVENT.dnd_upload_list.push(a);!0===dzeUiConfig.bUseContentExtUpload?g_objExtUploader.initWithUploadList(nEditNumber,this.dnd_upload_list):DZE_UPLOAD_EVENT.reqThumbUpload(e,
c)};this.uploadThumbProcess=function(a,b){try{var e=g_objOnefficeShot.getShotType();g_objOnefficeShot.setShotType(SHOTTYPE.FIRSTPAGE_THUMB_SHOT);var c=g_objPageControl.getPageContainer(0);if(c){var d="undefined"!==typeof dzeUiConfig?dzeUiConfig.bOfficeOnePageLongMode:!1,f=this.m_lastTarget;if(d||!f||!f.isEqualNode(c)){this.m_lastTarget=d?null:c.cloneNode(!0);var g=document.createElement("span"),k=document.getElementById("dzeditor_0").contentDocument.getElementsByTagName("html")[0],h=k.style.transform,
l=g_objEditorDocument[0].firstChild;g_objEditorDocument[0].getElementsByClassName("dze_document_container");k.style.transform="scale(1)";html2canvas(c).then(function(c){g_objThumbMgr.uploadCompleteCB(c,g,a,b);g_objOnefficeShot.setShotType(e);l.style.transform=h})}}}catch(m){dalert(m)}};this.sendFormUpload=function(a){try{var b=document.createElement("form");b.action=dzeEnvConfig.strUploadThumbImgURL;b.method="post";var e=document.createElement("textarea");e.name="thumbData";e.value=this.m_strThumbDocData;
b.appendChild(e);b.append("dze_upimage_file",this.m_thumbObjFile);b.append("creatorID",oneffice_cloud_myInfoData.id);b.append("type","uploadThumbImg ");b.submit()}catch(c){dalert(c)}}},g_objThumbMgr=new onefficeThumbMgr,onefficeShot=function(){this.m_Worker=null;this.m_CurTimer=new Date;this.m_nShotType=SHOTTYPE.PAGE_SHOT;this.m_nViewMode=VIEWLAYOUT.SORT_THUMBNAIL;this.m_bCreate=this.m_bShow=!1;this.m_BodyPgContainerDiv=this.m_ThumbnailLayerDiv=this.m_BgLayerDiv=null;this.m_ThumbnailWidth=150;this.m_ThumbnailHeight=
200;this.m_PortGap=10;this.m_TDBorderColor="#FFFFFF";this.m_bLandScape=!1;this.m_pxTotalMargin=this.m_nTotalPgNum=this.m_nCurPageNum=0;this.m_PageColor="white";this.m_bCopyInlineStyles=!1;this.prevScrollTop=0;this.arrSkipClassName="slidePageNumLayer watermarkContainer dze_page_controller dze_page_margin_guide dze_play_button dze_page_margin_top dze_page_margin_bottom dze_page_header_guideline dze_page_footer_guideline".split(" ");this.setShotType=function(a){this.m_nShotType!=a&&(this.m_nShotType=
a)};this.getShotType=function(){return this.m_nShotType};this.createImgFile=function(a,b,e){a=a.toDataURL("image/png");a=a.split(",")[1];a=b64toBlob(a,"image/png");g_bBrowserType_IE?(a.name=b,b=a):b=new File([a],b,{type:e});return b};this.hideViewerCtrl=function(){try{showAllPageNumLayer(!1),displaySlideShowMenu(!1)}catch(a){dalert(a)}};this.createThumbnail=function(a,b,e){try{return new Promise(function(c,d){!0===fnObjectCheckNull(e)&&(e=SHOTTYPE.PAGE_SHOT);var f=g_objOnefficeShot.getShotType();
g_objOnefficeShot.setShotType(e);html2canvas(a).then(function(a){e===SHOTTYPE.OBJ_SHOT?(a=a.toDataURL("image/png"),c(a)):g_objOnefficeShot.ThumbnailCompleteCB(a,b);g_objOnefficeShot.setShotType(f)})})}catch(c){dalert(c)}};this.setBodyPgContainer=function(a){try{g_objOnefficeShot.m_BodyPgContainerDiv=a}catch(b){dalert(b)}};this.initThumbnailTimer=function(){try{null!=g_objOnefficeShot.thumbnailTimer&&(clearTimeout(g_objOnefficeShot.thumbnailTimer),g_objOnefficeShot.thumbnailTimer=null)}catch(a){dalert(a)}};
this.setPgThumbnailSize=function(){try{var a=dzeUiConfig.nSettingPaperSize;a.height>a.width?(g_objOnefficeShot.m_bLandScape=!1,g_objOnefficeShot.m_ThumbnailWidth=150,g_objOnefficeShot.m_ThumbnailHeight=200):(g_objOnefficeShot.m_bLandScape=!0,g_objOnefficeShot.m_ThumbnailWidth=a.width,g_objOnefficeShot.m_ThumbnailHeight=a.height);g_objOnefficeShot.m_TDBorderColor="#000000"==dzeUiConfig.sSettingPaperColor?"#FFFFFF":"#D9D9D9"}catch(b){dalert(b)}};this.makeThumbnailContents=function(a,b,e){try{var c=
document.createElement("div");c.id="ThumbnailPgItem"+b;c.style.display="block";c.style.margin="10px 25px 10px 25px";c.style.height="100%";c.style["float"]="left";var d=this.appendPgItem(b,e);c.appendChild(d);a.appendChild(c)}catch(f){dalert(f)}};this.appendPgItem=function(a,b){try{var e=b[a],c=a+1,d=document.createElement("table");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");var f=d.insertRow().insertCell();f.style.backgroundColor="white";f.style.borderColor=g_objOnefficeShot.m_TDBorderColor;
f.style.borderStyle="solid";f.style.borderWidth="3px";f.style.width=g_objOnefficeShot.m_ThumbnailWidth+"px";f.style.height=g_objOnefficeShot.m_ThumbnailHeight+"px";f.setAttribute("thumb_pagenum",c);g_slideNo!=c?(f.onmouseover=function(){f.style.borderColor="#3DA4F6";f.style.borderStyle="solid";f.style.borderWidth="3px"},f.onmouseout=function(){f.style.borderColor=g_objOnefficeShot.m_TDBorderColor;f.style.borderStyle="solid";f.style.borderWidth="3px"},f.className="dze_slide_image_focus"):(f.style.borderColor=
"#F6CF3D",f.style.borderStyle="solid",f.style.borderWidth="3px",f.className="dze_slide_image_current");g_objOnefficeShot.createThumbnail(e,f);var g=d.insertRow().insertCell();g.style.backgroundColor="black";g.style.textAlign="center";g.setAttribute("pagenum",c);g.innerHTML="<span style='color:white'>"+c+"</span>";(function(){d.onclick=function(a){zoomOutList(!1,!1);g_objOnefficeShot.displayThumbnailLayer(!1);setSlidePositionInSlideList(c,!1);TBCancelBubbleEvent(a)}})();return d}catch(k){dalert(k)}};
this.displayThumbnailLayer=function(a){try{return this.prevScrollTop=document.documentElement.scrollTop,a?(g_objOnefficeShot.m_ThumbnailLayerDiv.style.display="",g_objOnefficeShot.m_ThumbnailLayerDiv.style.backgroundColor="black",g_objOnefficeShot.m_ThumbnailLayerDiv.style.textAlign="center",g_objOnefficeShot.m_ThumbnailLayerDiv.style.left=0,g_objOnefficeShot.m_ThumbnailLayerDiv.style.top=0,g_objPropertyUtil.applyFilterOpacityStyle(g_objOnefficeShot.m_BodyPgContainerDiv,!0,TRANSPARENCY_APPLY),g_objOnefficeShot.m_bShow=
!0,document.documentElement.scrollTop=0):(g_objOnefficeShot.m_ThumbnailLayerDiv.style.display="none",g_objOnefficeShot.m_BodyPgContainerDiv.style.position="static",g_objOnefficeShot.m_BodyPgContainerDiv.style.left="0px",g_objPropertyUtil.applyFilterOpacityStyle(g_objOnefficeShot.m_BodyPgContainerDiv,!1,TRANSPARENCY_REMOVE),g_objOnefficeShot.m_bShow=!1,g_bSlideMode||slideList.forEach(function(a){a.style.display="";a.style.opacity="1"}),displaySlideShowMenu(!0)),!0}catch(b){dalert(b)}return!1};this.thumbnailTimer=
null;this.getShotScreenContainerViewer=function(a){try{if(!a)return!1;var b=a.length;g_objOnefficeShot.m_nTotalPgNum=b;g_objOnefficeShot.m_PageColor=dzeUiConfig.sSettingPaperColor;var e=document;this.initThumbnailTimer();if(g_objOnefficeShot.m_bShow)return document.documentElement.scrollTop=this.prevScrollTop,g_objOnefficeShot.displayThumbnailLayer(!1);if(null==g_objOnefficeShot.m_ThumbnailLayerDiv){this.hideViewerCtrl();this.setPgThumbnailSize();duzon_http.showLoading();var c=document.createElement("div");
c.id="doc_thumbnail_viewer";c.style.backgroundColor="black";c.style.textAlign="center";c.style.position="absolute";c.style.zIndex=3*DOCUMENT_ZINDEX_BASE;c.style.width="100%";c.style.height="auto";c.style.left=0;c.style.top=0;g_objOnefficeShot.m_ThumbnailLayerDiv=c;e.body.appendChild(c);var d=document.createElement("div");d.id="thumb_HeaderPanel";d.backgroundColor="aqua";d.style.height="25px";d.style.position="relative";d.style.color="white";d.style.fontsize="100pt";d.style.zIndex=c.style.zIndex+1;
c.appendChild(d);var f=document.createElement("div");f.id="thumb_BodyPanel";f.style.width="100%";c.appendChild(f);var g=document.createElement("table");g.id="objMainThumbTable";g.setAttribute("cellspacing","0");g.setAttribute("cellpadding","0");g.align="center";g.style.height="auto";var k=g.insertRow().insertCell();k.id="objMainThumbCell";k.style.width="auto";k.style.height="auto";f.appendChild(g);var h=document.createElement("div");h.id="objMainThumbCellBody";h.width="auto";h.style.position="relative";
h.style.color="white";h.style.textAlign="center";h.style.display="inline-block";k.appendChild(h);for(e=0;e<b;e++)(function(b){g_objOnefficeShot.thumbnailTimer=setTimeout(function(){dlog("nCnt = "+b);dlog("nCnt = "+b+" slideList.Attr = "+a[b].style.display);g_objOnefficeShot.makeThumbnailContents(h,b,a)},THUMBNAIL_CMD_DELAY_TIME)})(e);g_objOnefficeShot.m_bCreate=!0}else{CellStyleInit=function(a){g_slideNo!=a.getAttribute("thumb_pagenum")?(a.onmouseover=function(){a.style.borderColor="#3DA4F6";a.style.borderStyle=
"solid";a.style.borderWidth="3px"},a.onmouseout=function(){a.style.borderColor=g_objOnefficeShot.m_TDBorderColor;a.style.borderStyle="solid";a.style.borderWidth="3px"},a.className="dze_slide_image_focus",a.style.borderColor=g_objOnefficeShot.m_TDBorderColor,a.style.borderStyle="solid",a.style.borderWidth="3px"):(styleCurrentInit=function(){a.style.borderColor="#F6CF3D";a.style.borderStyle="solid";a.style.borderWidth="3px";a.className=""},a.onmouseover=styleCurrentInit,a.onmouseout=styleCurrentInit,
styleCurrentInit())};var l=g_objOnefficeShot.m_ThumbnailLayerDiv.getElementsByTagName("td");if(l)for(var m=l.length-1;0<=m;m--){var p=l[m];0<p.getAttribute("thumb_pagenum")&&CellStyleInit(p)}a.forEach(function(a){a.style.display="none";a.style.opacity="0"})}g_objOnefficeShot.displayThumbnailLayer(!0);return!0}catch(n){dalert(n)}};this.ThumbnailCompleteCB=function(a,b){try{var e=a.toDataURL("image/png"),c=document.createElement("img");c.src=e;c.width=g_objOnefficeShot.m_ThumbnailWidth;c.height=g_objOnefficeShot.m_ThumbnailHeight;
var d=document.createElement("p");d.appendChild(c);b.innerHTML="";b.appendChild(d);g_objOnefficeShot.m_nTotalPgNum--;0==g_objOnefficeShot.m_nTotalPgNum&&(g_objOnefficeShot.m_BodyPgContainerDiv.style.position="absolute",g_objOnefficeShot.m_BodyPgContainerDiv.style.left="-5000px",g_objOnefficeShot.m_nTotalPgNum=slideList.length,duzon_http.hideLoading(),slideList.forEach(function(a){a.style.display="none";a.style.opacity="0"}),this.initThumbnailTimer())}catch(f){dalert(f)}};this.initialize=function(){};
this.getCloneStEleNode=function(a){try{for(var b=g_objPropertyUtil,e=!0,c=null,d=null;e&&a;){e=!1;c=a.id;d=a.nodeName;switch(c){case "divTableMiniMenu":case "tmpHtml2Canvas":case "doc_thumbnail_viewer":case "dze_idx_oneffice_show_menu_container":case "dze_idx_oneffice_slide_controller":case "dze_idx_loading_image_obj":case "dze_idx_loading_screen_obj":case "dze_document_main_container_custom_vertical_scroll":case "dze_document_main_container_custom_horizontal_scroll":case "dze_outline_main":case "dze_outline_image":e=
!0;break;default:case "totalPageContainer":"none"==a.style.display&&(e=!0)}e||"DIV"!==d&&"BUTTON"!==d||b.hasClass(a,this.arrSkipClassName)&&(e=!0);e||"VIDEORESIZE"!==d||(e=!0);e&&(a=a.nextSibling)}return a}catch(f){dalert(f)}};this.addCustomCSSData=function(a,b){try{var e=b.styleSheets,c=a.styleSheets,d=c.length;for(a=d-1;a>d-3;a--){var f=c[a],g=e[a],k=f.cssRules.length,h=g.cssRules.length;for(b=2;b<k;b++){var l=f.cssRules[b],m="";m="undefined"!=typeof l.selectorText?l.selectorText:l.name;var p=!1;
switch(m){case MEM_CSS_PAGEBOX:case MEM_CSS_PAGEBOXHEADER:case MEM_CSS_PAGEBOXBODY:case MEM_CSS_PAGEBOXFOOTER:p=!0}p&&(h=g.cssRules.length,g.insertRule(l.cssText,h))}}}catch(n){dalert(n)}}},g_objOnefficeShot=new onefficeShot,_slicedToArray=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var e=[],c=!0,d=!1,f=void 0;try{for(var g=a[Symbol.iterator](),k;!(c=(k=g.next()).done)&&(e.push(k.value),!b||e.length!==b);c=!0);}catch(h){d=!0,f=h}finally{try{if(!c&&
g["return"])g["return"]()}finally{if(d)throw f;}}return e}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),_createClass=function(){function a(a,e){for(var b=0;b<e.length;b++){var d=e[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,e,c){e&&a(b.prototype,e);c&&a(b,c);return b}}();
function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");}function _interopRequireDefault(a){return a&&a.__esModule?a:{"default":a}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
function PageNumber(){this.type=0;this.position=this.start=1;this.margin={left:0,top:0,right:0,bottom:0};this.endSep=this.startSep="";this.numpages=!1;this.textAtt={fontFamily:"",fontSize:"",color:"",fontWeight:"",fontStyle:""}}
PageNumber.prototype={roman:" C CC CCC CD D DC DCC DCCC CM  X XX XXX XL L LX LXX LXXX XC  I II III IV V VI VII VIII IX".split(" "),DZE_PAGE_NUM:"dze_page_num",init:function(){try{this.type=0,this.position=this.start=1,this.margin={left:0,top:0,right:0,bottom:0},this.endSep=this.startSep="",this.numpages=!1,this.textAtt={fontFamily:"",fontSize:"",color:"",fontWeight:"",fontStyle:""}}catch(a){dalert(a)}},clone:function(){try{var a=new PageNumber;a.type=this.type;a.start=this.start;a.position=this.position;
a.startSep=this.startSep;a.endSep=this.endSep;a.numpages=this.numpages;a.margin=cloneSimpleObject(this.margin);a.textAtt=cloneSimpleObject(this.textAtt);return a}catch(b){dalert(b)}},equal:function(a){try{return a.type!==this.type||a.start!==this.start||a.position!==this.position||a.startSep!==this.startSep||a.endSep!==this.endSep||a.numpages!==this.numpages||a.margin.left!==this.margin.left||a.margin.right!==this.margin.right||a.margin.top!==this.margin.top||a.margin.bottom!==this.margin.bottom||
a.textAtt.fontFamily!==this.textAtt.fontFamily||a.textAtt.fontSize!==this.textAtt.fontSize||a.textAtt.color!==this.textAtt.color||a.textAtt.fontWeight!==this.textAtt.fontWeight||a.textAtt.fontStyle!==this.textAtt.fontStyle?!1:!0}catch(b){dalert(b)}},getTemplate:function(a){try{var b=dzeUiConfig.nSettingPaperMargin,c=new PageNumber;c.type=1;switch(a){case 1:case 4:c.margin.left=b.left;c.margin.top=b.top-15;c.position=1;break;case 2:case 5:c.margin.top=b.top-15;c.position=2;break;case 3:case 6:c.margin.right=
b.right;c.margin.top=b.top-15;c.position=3;break;case 7:case 10:c.margin.left=b.left;c.margin.bottom=b.bottom-15;c.position=4;break;case 8:case 11:c.margin.bottom=b.bottom-15;c.position=5;break;case 9:case 12:c.margin.right=b.right;c.margin.bottom=b.bottom-15;c.position=6;break;default:return null}switch(a){case 4:case 5:case 6:case 10:case 11:case 12:c.numpages=!0}Object.keys(c.margin).forEach(function(a){0>c.margin[a]&&(c.margin[a]=0)});return c}catch(d){dalert(d)}},import:function(a){try{if(a){var b=
a.getAttributeNode(DZE_CUSTOM_ATT_PGNUM);b&&this.importFromAttNode(b)}}catch(c){dalert(c)}},importFromAttNode:function(a){try{if(a){var b=a.value;if(b){var c=JSON.parse(b);if(c.type){this.init();for(var d in c)this[d]=c[d];var e=this.margin.split(" ");this.margin={};this.margin.top=+parseFloat(e[0]).toFixed(2);this.margin.right=+parseFloat(e[1]).toFixed(2);this.margin.bottom=+parseFloat(e[2]).toFixed(2);this.margin.left=+parseFloat(e[3]).toFixed(2)}}}}catch(f){dalert(f)}},export:function(a){try{if(a)if(0===
this.type)a.removeAttribute("pg_num");else{var b=this.clone(),c;for(c in b)""!==b[c]&&!1!==b[c]||delete b[c];for(c in b.textAtt)""===b.textAtt[c]&&delete b.textAtt[c];0===Object.keys(b.textAtt).length&&delete b.textAtt;1===b.start&&delete b.start;b.margin=b.margin.top+" "+b.margin.right+" "+b.margin.bottom+" "+b.margin.left;var d=JSON.stringify(b);d&&a.setAttribute(DZE_CUSTOM_ATT_PGNUM,d)}}catch(e){dalert(e)}},intToRoman:function(a){try{if("number"!==typeof a)return!1;var b=String(+a).split(""),c=
this.roman;a="";for(var d=3;d--;)a=(c[+b.pop()+10*d]||"")+a;return Array(+b.join("")+1).join("M")+a}catch(e){dalert(e)}},getText:function(a,b){try{a=parseInt(a);switch(this.type){case 2:a=this.intToRoman(a).toLowerCase();b=this.intToRoman(b).toLowerCase();break;case 3:a=this.intToRoman(a),b=this.intToRoman(b)}return b&&!0===this.numpages?this.startSep+a+"/"+b+this.endSep:this.startSep+a+this.endSep}catch(c){dalert(c)}},isDiv:function(a){return a&&"DIV"===a.nodeName&&g_objPropertyUtil.element_hasClass(a,
this.DZE_PAGE_NUM)?!0:!1},createDiv:function(a,b,c){try{if(!a)return null;var d=a.ownerDocument.createElement("div");d.className=this.DZE_PAGE_NUM;d.contentEditable=!1;if(0===this.type)return d;this.setDivProperty(d,b,c);return d}catch(e){dalert(e)}},setDivProperty:function(a,b,c){try{if(!a)return null;if(0===this.type||b+1<this.start)g_objNodeUtil.removeAllChild(a);else{var d="",e="",f="",h="",k="";switch(this.position){case 1:e=d="0px";break;case 2:d="50%";e="0px";k="translateX(-50%)";break;case 3:f=
e="0px";break;case 4:h=d="0px";break;case 5:d="50%";h="0px";k="translateX(-50%)";break;case 6:h=f="0px"}var g=a.style;g.left=d;g.top=e;g.right=f;g.bottom=h;g.transform=k;g.marginLeft=this.margin.left+"mm";g.marginTop=this.margin.top+"mm";g.marginRight=this.margin.right+"mm";g.marginBottom=this.margin.bottom+"mm";for(var l in this.textAtt)a.style[l]=this.textAtt[l];a.innerHTML=this.getText(b+2-this.start,c);return a}}catch(m){dalert(m)}},setDivText:function(a,b,c){try{if(a&&!(b+1<this.start)){var d=
a.firstChild?a.firstChild.nodeValue:"",e=this.getText(b+2-this.start,c);d!==e&&(a.innerHTML=e)}}catch(f){dalert(f)}},getDiv:function(a){try{var b=g_objPageControl.getPageNode(a);if(!b)return null;var c=b.childNodes[6];return c?c:null}catch(d){dalert(d)}},updateText:function(a){try{if(0!==this.type){isNaN(a)&&(a=0);for(var b=g_objPageControl.getTotalPageCount();a<b;a++)this.setDivText(this.getDiv(a),a,b)}}catch(c){dalert(c)}},updateAll:function(){try{for(var a=g_objPageControl.getTotalPageCount(),
b=0;b<a;b++)this.setDivProperty(this.getDiv(b),b,a)}catch(c){dalert(c)}},ondblclick:function(a){try{if(0===this.type||g_readonlyMode)return null;var b=g_objPageControl.getPageNum(a.target||a.srcElement);if(null===b)return null;var c=this.getDiv(b);if(!c)return null;var d=c.getBoundingClientRect(),e={x:a.clientX,y:a.clientY};var f=d&&e?d.left<=e.x&&e.x<=d.right&&d.top<=e.y&&e.y<=d.bottom:null;return f?c:null}catch(h){dalert(h)}}};var g_objPageNumber=new PageNumber;
/*
 isForward && */
DOCUMENT_PAGE_WIDTH=794;DOCUMENT_PAGE_HEIGHT=1123;DOCUMENT_PAGE_MARGIN_LEFT=DOCUMENT_PAGE_MARGIN_BOTTOM=DOCUMENT_PAGE_MARGIN_RIGHT=DOCUMENT_PAGE_MARGIN_TOP=76;DOCUMENT_HEADER_MARGIN_TOP=38;DOCUMENT_FOOTER_MARGIN_BOTTOM=48;DOCUMENT_PAGE_BACKGROUND_COLOR="#FFFFFF";DOCUMENT_MAIN_WIDTH=DOCUMENT_PAGE_WIDTH-DOCUMENT_PAGE_MARGIN_RIGHT-DOCUMENT_PAGE_MARGIN_LEFT;DOCUMENT_MAIN_HEIGHT=DOCUMENT_PAGE_HEIGHT-DOCUMENT_PAGE_MARGIN_TOP-DOCUMENT_PAGE_MARGIN_BOTTOM;DOCUMENT_ZINDEX_BASE=1E4;ID_PAGE_CURRENT_CARET="dze_page_caret_current_position";
var g_objPageControl=new function(){this.nEditNumber=0;this.documentContainerNode=null;this.currentPage=0;this.documentPageVerticalScrollTimer=null;this.documentPageVerticalScrollDown=this.documentPageHorizontalScrollDown=!1;this.documentPageMouseOffY=this.documentPageMouseOffX=0;this.updatePageCallback=this.updatePageTimerAll=this.updatePageTimer=null;this.DZE_PAGE_BREAK="dze_page_break";this.DZE_PAGE_BREAK_PARA="dze_page_break_para";this.arrPageBreakElement="P OL UL DL H1 H2 H3 H4 H5 H6".split(" ");
this.RET_UPDATEPAGE_DONE=1;this.RET_UPDATEPAGE_NEXT=2;this.RET_UPDATEPAGE_CURRENT=3;this.RET_UPDATEPAGE_CURRENT_AFTER_A_WHILE=4;this.bDebug=this.bSaveCaret=this.bCheckSaveCaret=this.bUpdatePage=!1;this.initializeMultiPageMode=function(a){try{if(!this.documentContainerNode){this.nEditNumber=a=a||0;var b=g_objEditorDocument[a];if(b){var c=b.createDocumentFragment();g_objNodeUtil.moveNodesTo(c,b.body.firstChild);b.body.innerHTML="";b.body.style.backgroundColor="#f2f2f2";b.body.style.overflow="hidden";
var d=b.createElement("div");d.id="dze_document_main_container";d.contentEditable=!1;d.style.overflow="auto";d.style.width="100%";d.style.height=objOnefficeLoader.m_bHybrid?"100%":g_nEditDocumentHeight+"px";var e=b.createElement("div");e.id="dze_document_main_container_custom_vertical_scroll";e.contentEditable=!1;var f=b.createElement("div");f.id="dze_document_main_container_custom_horizontal_scroll";f.contentEditable=!1;f.style.opacity=.5;if(g_browserCHK.iOS||dzeUiConfig.bMobileHybridEdit)e.style.display=
"none",f.style.display="none";d.appendChild(e);d.appendChild(f);var g=b.createElement("div");g.id="dze_document_container";g.className="dze_document_container";g.contentEditable=!1;g.style.width=Math.ceil(g_objCommonUtil.convMMToPx(dzeUiConfig.nSettingPaperSize.width))+"px";g.style.margin="auto";g.style.backgroundColor="#f2f2f2";g.style.position="relative";!g_bBrowserType_CR||g_bBrowserType_EDGE||g_browserCHK.mobile||(g.style.height="100%");d.appendChild(g);b.body.appendChild(d);if(g_browserCHK.mobile){var k=
b.createElement("div");k.id="dze_document_container_wrapper";k.className="dze_document_container_wrapper";k.contentEditable=!1;g.parentNode.replaceChild(k,g);k.appendChild(g)}this.documentContainerNode=g;this.initializePageWithData(c,0);this.setDocumentCustomScrollEvent(d,e,f);this.setDocumentContainerEvent();this.setDocumentMainContainerEvent(a);(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)&&setTimeout(function(){g_objPageControl.onChangeEditAreaScrollHorizontalPositionWidth()},100);
this.currentPage=0;this.setStatusPageNum(0);if(!oneffice.isReadOnlyDoc()){var h=this.getPageMain(0);h.focus({preventScroll:!0});g_bBrowserType_IE&&(d.scrollTop=0);g_objCaretUtil.moveCaret(h,!1);editor_onselectionchange(a)}pageManager.getInstance().onReady()}}}catch(l){dalert(l)}};this.onEditAreaMoveVerticalScrollPosition=function(a){try{if(0===a.buttons)g_objPageControl.dzeEditAreaContainerScrollDown=!1;else{var b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container"),
c=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_vertical_scroll"),d=a.y-g_objPageControl.documentPageMouseOffY,e=b.offsetHeight,f=c.offsetHeight;c.style.top=parseInt(c.style.top)+d;b.scrollTop=parseInt(b.scrollTop)+b.scrollHeight/e*d;0>parseInt(c.style.top)&&(c.style.top="0");parseInt(c.style.top)+parseInt(f)>parseInt(e)&&(c.style.top=parseInt(e)-parseInt(f));g_objPageControl.documentPageMouseOffY=a.y}}catch(g){dalert(g)}};this.onEditAreaMoveHorizontalScrollPosition=
function(a){try{var b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container"),c=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_horizontal_scroll");if(0===a.buttons)c.style.opacity=.5,g_objPageControl.dzeEditAreaContainerHorizontalScrollDown=!1;else{c.style.opacity=1;var d=a.x-g_objPageControl.documentPageMouseOffX,e=parseInt(c.style.left)+d,f=b.offsetWidth;0>e&&(e=0);e+parseInt(c.style.width)+2>f&&(e=f-parseInt(c.style.width)-
2);c.style.left=e+"px";b.scrollLeft=parseInt(b.scrollLeft)+b.scrollWidth/f*d;g_objPageControl.documentPageMouseOffX=a.x}}catch(g){dalert(g)}};this.onChangeEditAreaScrollHorizontalPositionWidth=function(){try{var a=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container"),b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_horizontal_scroll"),c=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_vertical_scroll");
if(!(fnObjectCheckNull(a)||fnObjectCheckNull(b)||fnObjectCheckNull(c))){var d=a.offsetWidth,e=a.scrollWidth;b.style.visibility=d===e?"hidden":"";b.style.width=d/e*d+"px";b.style.left="0px";b.style.bottom="3px";c.style.left=parseInt(d)-12+"px"}}catch(f){dalert(f)}};this.onChangeEditAreaScrollPosition=function(a,b,c){try{c.style.opacity=1;g_objPageControl.documentPageVerticalScrollTimer&&clearTimeout(g_objPageControl.documentPageVerticalScrollTimer);var d=a.clientHeight,e=b.scrollHeight;c.style.left=
parseInt(a.clientWidth)-12+"px";c.style.height=d*b.clientHeight/e+"px";c.style.top=d*b.scrollTop/e+1+"px";g_objPageControl.documentPageVerticalScrollTimer=setTimeout(function(){g_objPageControl.setEditAreaScrollOut(c)},1E3)}catch(f){dalert(f)}};this.setEditAreaScrollOut=function(a){try{0<a.style.opacity&&(a.style.opacity-=.1,g_objPageControl.documentPageVerticalScrollTimer=setTimeout(function(){g_objPageControl.setEditAreaScrollOut(a)},30))}catch(b){dalert(b)}};this.updatePageLayoutVariables=function(a,
b){try{a=dzeUiConfig.nSettingPaperSize;b=dzeUiConfig.nSettingPaperMargin;var c=ONE_PX2MM;DOCUMENT_PAGE_WIDTH=Math.ceil(a.width/c);DOCUMENT_PAGE_HEIGHT=Math.ceil(a.height/c);DOCUMENT_PAGE_MARGIN_TOP=Math.ceil(b.top/c);DOCUMENT_PAGE_MARGIN_RIGHT=Math.ceil(b.right/c);DOCUMENT_PAGE_MARGIN_BOTTOM=Math.ceil(b.bottom/c);DOCUMENT_PAGE_MARGIN_LEFT=Math.ceil(b.left/c);DOCUMENT_HEADER_MARGIN_TOP=Math.ceil(b.headerTop/c);DOCUMENT_FOOTER_MARGIN_BOTTOM=Math.ceil(b.footerBottom/c);DOCUMENT_MAIN_WIDTH=DOCUMENT_PAGE_WIDTH-
DOCUMENT_PAGE_MARGIN_RIGHT-DOCUMENT_PAGE_MARGIN_LEFT;DOCUMENT_MAIN_HEIGHT=DOCUMENT_PAGE_HEIGHT-DOCUMENT_PAGE_MARGIN_TOP-DOCUMENT_PAGE_MARGIN_BOTTOM;DOCUMENT_PAGE_BACKGROUND_COLOR=dzeUiConfig.sSettingPaperColor}catch(d){dalert(d)}};this.setPageLayout=function(a){try{this.setHeaderFooterLayout(a),this.setPageMainHeight(a)}catch(b){dalert(b)}};this.setPageMainHeight=function(a){try{var b=dzeUiConfig,c=g_objCommonUtil,d=g_objHeaderFooter;if(b.bOfficeOnePageLongMode)return!1;var e=c.convMMToPx(b.nSettingPaperMargin.top),
f=d.getHeaderContainerHeight(a),g=Math.ceil(Math.max(e,f)),k=c.convMMToPx(b.nSettingPaperMargin.bottom),h=d.getFooterContainerHeight(a),l=Math.ceil(Math.max(k,h)),m=Math.ceil(c.convMMToPx(b.nSettingPaperSize.height))-(g+l),p=this.getPageMain(a);p&&(p.style.height=m+"px");return!0}catch(n){dalert(n)}};this.setHeaderFooterLayout=function(a){try{if(!dzeUiConfig.bUseHeaderFooter)return!1;var b=dzeUiConfig,c=g_objCommonUtil,d=g_objPropertyUtil,e=g_objHeaderFooter,f=e.getHeader(a);if(f){!e.getHeaderFooterEditMode()&&
e.isBlankHeaderFooter(f)?f.style.paddingTop="0px":f.style.paddingTop=Math.ceil(g_objCommonUtil.convMMToPx(b.nSettingPaperMargin.headerTop))+"px";var g=c.convMMToPx(b.nSettingPaperSize.height/2-10),k=e.getHeaderContentsHeight(a),h=d.element_hasClass(f,"dze_page_header_overflow");!h&&k>g?d.element_addClass(f,"dze_page_header_overflow"):h&&k<=g&&d.element_removeClass(f,"dze_page_header_overflow")}var l=e.getFooter(a);if(l)if(!e.getHeaderFooterEditMode()&&e.isBlankHeaderFooter(l))l.style.marginTop="0px",
l.style.paddingBottom="0px";else{l.style.paddingBottom=Math.ceil(g_objCommonUtil.convMMToPx(b.nSettingPaperMargin.footerBottom))+"px";var m=c.convMMToPx(b.nSettingPaperMargin.bottom),p=e.getFooterHeight(a);l.style.marginTop=Math.max(Math.ceil(m-p),0)+"px"}return!0}catch(n){dalert(n)}};this.setPageSizeUpdate=function(){try{this.updatePageLayoutVariables();var a=this.documentContainerNode;if(a){var b=g_objHeaderFooter,c=g_objCommonUtil,d=cloneSimpleObject(dzeUiConfig.nSettingPaperSize),e=cloneSimpleObject(dzeUiConfig.nSettingPaperMargin),
f=function(a){for(var b in a)a[b]=Math.ceil(c.convMMToPx(a[b]));return a};d=f(d);e=f(e);var g=d.width-e.left-e.right,k=d.height-e.top-e.bottom,h=dzeUiConfig.bOfficeOnePageLongMode,l=this.getTotalPageCount();b.clearCache();a.style.width=d.width+"px";for(a=0;a<l;a++){var m=this.getPageContainer(a);m.style.width=d.width+"px";h?(m.style.height="",m.style.minHeight=d.height+"px"):(m.style.height=d.height+"px",m.style.minHeight="");var p=b.getHeaderContainer(a);p.style.minHeight=e.top+"px";p.style.maxHeight=
Math.ceil(d.height/2-Math.ceil(c.convMMToPx(10)))+"px";var n=b.getHeader(a);n.style.width=g+"px";n.style.padding=e.headerTop+"px "+e.right+"px 0px "+e.left+"px";var q=this.getPageMain(a);q.style.width=g+"px";h?(q.style.height="",q.style.minHeight=k+"px"):(q.style.height=k+"px",q.style.minHeight="");q.style.padding="0px "+e.right+"px 0px "+e.left+"px";var r=b.getFooterContainer(a);r.style.minHeight=e.bottom+"px";r.style.maxHeight=Math.ceil(d.height/2-Math.ceil(c.convMMToPx(10)))+"px";var v=b.getFooter(a);
v.style.width=g+"px";v.style.padding="0px "+e.right+"px "+e.footerBottom+"px "+e.left+"px";r=b.getFooterContainer(a);r.style.position=h?"relative":"";this.setPageLayout(a);var t=this.getMarginIndicator(a).childNodes;t[0].style.width=e.left+"px";t[0].style.height=e.top+"px";t[1].style.width=e.right+"px";t[1].style.height=e.top+"px";t[2].style.width=e.left+"px";t[2].style.height=e.bottom+"px";t[3].style.width=e.right+"px";t[3].style.height=e.bottom+"px"}}}catch(u){dalert(u)}};this.setDocumentPageColor=
function(a,b){try{if(""==b&&(b="#FFFFFF"),DOCUMENT_PAGE_BACKGROUND_COLOR=b,this.documentContainerNode){a=0;for(var c=this.getTotalPageCount();a<c;a++)this.getPageContainer(a).style.backgroundColor=b}}catch(d){dalert(d)}};this.initializePageWithData=function(a,b){try{var c=g_objNodeUtil,d=g_objSectionUtil,e=a.ownerDocument,f=d.getSectionFromPropElem(a.firstChild);if(f){var g=this.getPageMain(b-1);g&&g.appendChild(a.firstChild)}else f=d.getFirstSection();var k=g=null;if(dzeUiConfig.bOfficeOnePageLongMode){k=
(g=this.getPageMain(0))?g.parentNode:null;g||(g=this.makePageContainer(0,!1,f),k=g.parentNode,c.removeAllChild(g),this.insertPageContainer(k,0,!1));for(var h=a.firstChild,l=null;h;)l=h.nextSibling,"dze_printpagebreak"===h.className?a.removeChild(h):(!d.isSectionNode(h)||dzeUiConfig.bUseMultipleSection||g_readonlyMode||h.setAttribute(DZE_CUSTOM_ATT_SECTION_TYPE,"none"),g.appendChild(h)),h=l}else{var m=e.createDocumentFragment(),p=e=!1;h=a.firstChild;for(l=null;h;)l=h.nextSibling,e=!1,"dze_printpagebreak"===
h.className?(e=!0,a.removeChild(h)):(d.isSectionNode(h)&&(dzeUiConfig.bUseMultipleSection||g_readonlyMode||h.setAttribute(DZE_CUSTOM_ATT_SECTION_TYPE,"none"),f=d.getSectionFromPropElem(h),!dzeUiConfig.bOfficeOnePageLongMode&&f.bOfficeOnePageLongMode&&(p=!0),e=!0),m.appendChild(h)),!m.firstChild||!e&&l||(g=this.makePageContainer(b,!1,f),k=g.parentNode,c.removeAllChild(g),g.appendChild(m),this.insertPageContainer(k,b,!1),b++),h=l;0===b&&(g=this.makePageContainer(b,!1,f),this.insertPageContainer(g.parentNode,
b,!1));if(p)this.onSetDelayedUpdatePageTimerAll()}return!0}catch(n){dalert(n)}};this.changePageMode=function(a){try{if(fnObjectCheckNull(a)||!1===dzeUiConfig.bOfficePagingMode)return!1;if(a===dzeUiConfig.bOfficeOnePageLongMode)return!0;var b=this.getPageContainer(0),c=this.getPageMain(0);if(!b||!c)return!1;dzeUiConfig.bOfficeOnePageLongMode=a;var d=g_objNodeUtil,e=g_objSplitUtil,f=g_objCaretUtil,g=b.ownerDocument.createDocumentFragment();for(f.saveCaret();b&&c;)d.moveNodesTo(g,c.firstChild),b.parentNode.removeChild(b),
b=this.getPageContainer(0),c=this.getPageMain(0);var k=this.makePageContainer(0);d.removeAllChild(k);k.appendChild(g);e.mergeAll(k);e.removeAllSplitAttr(k);f.restoreCaret();a||(this.clearUpdatePageTimer(),this.onSetDelayedUpdatePageTimerAll());var h=dzeJ(".dze_page_controller")[0];g_readonlyMode||objOnefficeLoader.m_bHybrid||a?h&&(h.style.display="none"):h&&(h.style.display="");this.changeCssPageBreakAfter(this.nEditNumber);return!0}catch(l){dalert(l)}};this.makePageContainer=function(a,b,c){try{c=
c?c:g_objSectionUtil.getFirstSection();var d=g_objEditorDocument[this.nEditNumber],e=dzeUiConfig,f=g_objCommonUtil,g=g_objHeaderFooter,k=g_objPageNumber,h=g_readonlyMode,l=cloneSimpleObject(c.pageSize),m=cloneSimpleObject(c.pageMargin),p=c.pageColor;c=function(a){for(var b in a)a[b]=Math.ceil(f.convMMToPx(a[b]));return a};l=c(l);m=c(m);var n=l.width-m.left-m.right,q=l.height-m.top-m.bottom,r=c=null,v=null,t=null,u=null,w=null;c=d.createElement("div");c.setAttribute("class","dze_page_container");c.setAttribute("dze_page_no",
a);c.style.width=l.width+"px";c.setAttribute("spellcheck","false");e.bOfficeOnePageLongMode?(c.style.height="",c.style.minHeight=l.height+"px"):(c.style.height=l.height+"px",c.style.minHeight="");c.style.backgroundColor=p;c.style.overflow="visible";v=d.createElement("div");v.setAttribute("class","dze_page_header_container");v.style.minHeight=m.top+"px";v.style.maxHeight=Math.ceil(l.height/2-Math.ceil(f.convMMToPx(10)))+"px";v.contentEditable=!1;h||v.setAttribute("title",ID_RES_STRING_TITLE_EDIT_HEADER);
t=d.createElement("div");t.setAttribute("class","dze_page_header");t.style.width=n+"px";t.style.padding=m.headerTop+"px "+m.right+"px 0px "+m.left+"px";t.innerHTML=g.getPageHeaderContents(a);t.setAttribute(g.DZE_HF_TYPE,g.getHeaderTypeAttrValue(a));g.enable(t,g.getHeaderFooterEditMode());r=d.createElement("div");r.setAttribute("class","dze_page_main");r.contentEditable=!1;r.style.width=n+"px";e.bOfficeOnePageLongMode?(r.style.height="",r.style.minHeight=q+"px"):(r.style.height=q+"px",r.style.minHeight=
"");r.style.padding="0px "+m.right+"px 0px "+m.left+"px";r.innerHTML="<p><br /></p>";g.enable(r,!g.getHeaderFooterEditMode());u=d.createElement("div");u.setAttribute("class","dze_page_footer_container");u.style.position=e.bOfficeOnePageLongMode?"relative":"";u.style.minHeight=m.bottom+"px";u.style.maxHeight=Math.ceil(l.height/2-Math.ceil(f.convMMToPx(10)))+"px";u.contentEditable=!1;h||u.setAttribute("title",ID_RES_STRING_TITLE_EDIT_FOOTER);w=d.createElement("div");w.setAttribute("class","dze_page_footer");
w.style.width=n+"px";w.style.padding="0px "+m.right+"px "+m.footerBottom+"px "+m.left+"px";w.innerHTML=g.getPageFooterContents(a);w.setAttribute(g.DZE_HF_TYPE,g.getFooterTypeAttrValue(a));g.enable(w,g.getHeaderFooterEditMode());v.appendChild(t);u.appendChild(w);c.appendChild(v);c.appendChild(r);c.appendChild(u);c.appendChild(this.makePageMarginIndicator(m));c.appendChild(this.makePageController(c,a));c.appendChild(this.makePageBottomCreator());c.appendChild(k.createDiv(c,a));c.appendChild(this.makePageMarginArea(c,
!0));c.appendChild(this.makePageMarginArea(c,!1));!1!==b&&this.insertPageContainer(c,a);return r}catch(x){dalert(x)}};this.makePageMarginIndicator=function(a){try{var b=g_objEditorDocument[this.nEditNumber],c=b.createElement("div");c.setAttribute("class","dze_page_margin_guide");c.setAttribute("contenteditable","false");var d=null,e=null;d=b.createElement("div");d.setAttribute("class","dze_page_margin_lt");d.setAttribute("contenteditable","false");d.style.width=a.left+"px";d.style.height=a.top+"px";
e=b.createElement("div");e.setAttribute("class","dze_page_margin_indicator_lt");d.appendChild(e);c.appendChild(d);d=b.createElement("div");d.setAttribute("class","dze_page_margin_rt");d.style.width=a.right+"px";d.style.height=a.top+"px";d.setAttribute("contenteditable","false");e=b.createElement("div");e.setAttribute("class","dze_page_margin_indicator_rt");d.appendChild(e);c.appendChild(d);d=b.createElement("div");d.setAttribute("class","dze_page_margin_lb");d.style.width=a.left+"px";d.style.height=
a.bottom+"px";d.setAttribute("contenteditable","false");e=b.createElement("div");e.setAttribute("class","dze_page_margin_indicator_lb");d.appendChild(e);c.appendChild(d);d=b.createElement("div");d.setAttribute("class","dze_page_margin_rb");d.style.width=a.right+"px";d.style.height=a.bottom+"px";d.setAttribute("contenteditable","false");e=b.createElement("div");e.setAttribute("class","dze_page_margin_indicator_rb");d.appendChild(e);c.appendChild(d);return c}catch(f){dalert(f)}};this.updatePageContainerNumber=
function(){try{for(var a=0,b=this.getTotalPageCount();a<b;a++){var c=this.getPageNode(a);c&&c.setAttribute("dze_page_no",a)}}catch(d){dalert(d)}};this.insertPageContainer=function(a,b){try{var c=this.getPageNode(b);c?this.documentContainerNode.insertBefore(a,c):this.documentContainerNode.appendChild(a);this.updatePageContainerNumber();g_objPageNumber.updateText(!0===g_objPageNumber.numpages?0:b);this.setStatusPageNum();this.setPageLayout(b)}catch(d){dalert(d)}};this.removePageContainer=function(a){try{if(!isNaN(a)){var b=
this.getTotalPageCount();if(2>b)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_DO_NOT_DELETE,1.5);else{b=a==b-1;var c=this.getPageNode(a);c&&c.parentNode&&c.parentNode.removeChild(c);this.updatePageContainerNumber();g_objPageNumber.updateText(!0===g_objPageNumber.numpages?0:a);this.setStatusPageNum();dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.bDiffOddEvenPage&&!b&&this.setDirtyRange(a,null,!0)}}}catch(d){dalert(d)}};this.setDirty=function(a,b){try{if(null!==a&&"undefined"!==typeof a){var c=
this.getPageMain(a);c&&(c.dzeDirty=!0);if(b){b=g_objHeaderFooter;var d=b.getHeader(a);d&&(d.dzeDirty=!0);var e=b.getFooter(a);e&&(e.dzeDirty=!0)}}}catch(f){dalert(f)}};this.setDirtyRange=function(a,b,c){try{if(null!==a&&"undefined"!==typeof a){if(null===b||"undefined"===typeof b)b=this.getTotalPageCount()-1;for(;a<=b;a++)this.setDirty(a,c)}}catch(d){dalert(d)}};this.isDirty=function(a,b){try{var c=this.getPageMain(a);if(c&&!0===c.dzeDirty)return!0;if(b){b=g_objHeaderFooter;var d=b.getHeader(a);if(d&&
!0===d.dzeDirty)return!0;var e=b.getFooter(a);if(e&&!0===e.dzeDirty)return!0}return!1}catch(f){dalert(f)}};this.removeDirty=function(a,b){try{var c=this.getPageMain(a);c&&delete c.dzeDirty;if(b){b=g_objHeaderFooter;var d=b.getHeader(a);d&&delete d.dzeDirty;var e=b.getFooter(a);e&&delete e.dzeDirty}}catch(f){dalert(f)}};this.getPageContainer=this.getPageNode=function(a){try{var b=this.documentContainerNode;return b&&b.childNodes[a]?b.childNodes[a]:null}catch(c){dalert(c)}};this.getTotalPageCount=function(){try{return this.documentContainerNode?
this.documentContainerNode.childNodes.length:0}catch(a){dalert(a)}};this.getPageMain=function(a){try{if(isNaN(a)||0>a)return null;var b=this.documentContainerNode;return b&&b.childNodes[a]&&b.childNodes[a].childNodes[1]?b.childNodes[a].childNodes[1]:null}catch(c){dalert(c)}};this.getAllPageMain=function(){try{for(var a=[],b=0,c=this.getTotalPageCount();b<c;b++)a.push(this.getPageMain(b));return a}catch(d){dalert(d)}};this.getPageNum=function(a){try{if(!a)return null;for(var b=g_objPropertyUtil;a&&
("DIV"!==a.nodeName||!b.hasClass(a,"dze_page_container"));)a=a.parentNode;return a&&a.hasAttribute("dze_page_no")?parseInt(a.getAttribute("dze_page_no"),10):null}catch(c){dalert(c)}};this.getPageNumRange=function(a){try{if(!a)return null;var b=g_objSplitUtil.getSplitNodes(a);if(!b)return null;var c=b.length;if(0>=c)return null;a={};a.start=this.getPageNum(b[0]);a.end=1===c?a.start:this.getPageNum(b[c-1]);return a}catch(d){dalert(d)}};this.getLoopPageMain=function(a){try{if(!a)return null;for(var b=
g_objNodeUtil;a&&!b.isLoopBreakNode(a);)a=a.parentNode;return g_objPropertyUtil.element_hasClass(a,"dze_page_main")?a:null}catch(c){dalert(c)}};this.getMarginIndicator=function(a){try{var b=this.documentContainerNode;return b&&b.childNodes[a]&&b.childNodes[a].childNodes[3]?b.childNodes[a].childNodes[3]:null}catch(c){dalert(c)}};this.getPageController=function(a){try{var b=this.documentContainerNode;return b&&b.childNodes[a]&&b.childNodes[a].childNodes[4]?b.childNodes[a].childNodes[4]:null}catch(c){dalert(c)}};
this.getPageTopMarginArea=function(a){try{var b=this.documentContainerNode;return b&&b.childNodes[a]&&b.childNodes[a].childNodes[7]?b.childNodes[a].childNodes[7]:null}catch(c){dalert(c)}};this.getPageBottomMarginArea=function(a){try{var b=this.documentContainerNode;return b&&b.childNodes[a]&&b.childNodes[a].childNodes[7]?b.childNodes[a].childNodes[8]:null}catch(c){dalert(c)}};this.setDocumentCustomScrollEvent=function(a,b,c){try{a.onscroll=function(c){if(objOnefficeLoader.m_bHybrid&&0<g_nPreventScrollCount&&
!fnObjectCheckNull(g_objLastScroll)){if(.1<Math.abs(this.scrollTop-g_objLastScroll.scrollTop)||.1<Math.abs(this.scrollLeft-g_objLastScroll.scrollLeft))this.scrollTop=g_objLastScroll.scrollTop,this.scrollLeft=g_objLastScroll.scrollLeft;g_nPreventScrollCount--}g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,g_objPageControl.nEditNumber);if(!1===fnObjectCheckNull(g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr)&&
0<g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.length)for(var d=0;d<g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.length;d++)g_objWrapperOutlineUtil_Improved.updateOutline(g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr[d].object);g_objTableMiniMenu.onWheel();TEXT.countsInfo.box&&"none"!==TEXT.countsInfo.box.style.display&&(TEXT.countsInfo.box.style.display="none",clearTimeout(TEXT.countsInfo.updateTimer),TEXT.countsInfo.updateTimer=setTimeout(function(){var a=
g_objTableFunction.getCurrentCell(g_objPageControl.nEditNumber);!1===fnObjectCheckNull(a)&&!1===fnObjectCheckNull(a.cell)&&(TEXT.countsInfo.updatePosition(a.cell),TEXT.countsInfo.box.style.display="")},100));if(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)g_objPageControl.onChangeEditAreaScrollPosition(a,a,b);pageManager.getInstance().hideButtonContainer();dzeWebSearch.hideWebSearchBtn();g_objPasteOptionMenu.onWheel(c);g_objRulerBar.delayUpdate(g_objPageControl.nEditNumber);c=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByClassName("dze_page_controller");
if(!1===fnObjectCheckNull(c))for(d=0;d<c.length;d++)!0===c[d].classList.contains("click")&&(g_objContextMenuWin.initContextMenuLayerEvent(),c[d].classList.remove("click"),c[d].firstChild.classList.remove("click"))};if(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)window.attachEvent?window.attachEvent("onresize",g_objPageControl.dze_page_window_onresize):window.addEventListener("resize",g_objPageControl.dze_page_window_onresize);b.onmousedown=function(a){g_objPageControl.documentPageVerticalScrollDown=
!0;g_objPageControl.documentPageMouseOffY=a.y;TBCancelBubbleEvent(a)};b.onmouseup=function(){g_objPageControl.documentPageVerticalScrollDown=!1};b.onmousemove=function(a){g_objPageControl.documentPageVerticalScrollDown&&(a.preventDefault(a),g_objPageControl.onEditAreaMoveVerticalScrollPosition(a))};b.onmouseover=function(){this.style.opacity=1;g_objPageControl.documentPageVerticalScrollTimer&&clearTimeout(g_objPageControl.documentPageVerticalScrollTimer)};b.onmouseleave=function(){g_objPageControl.documentPageVerticalScrollTimer=
setTimeout(function(){g_objPageControl.setEditAreaScrollOut(b)},500)};c.onmousedown=function(a){g_objPageControl.documentPageHorizontalScrollDown=!0;g_objPageControl.documentPageMouseOffX=a.x;TBCancelBubbleEvent(a)};c.onmouseup=function(){g_objPageControl.documentPageHorizontalScrollDown=!1;this.style.opacity=.5};c.onmousemove=function(a){g_objPageControl.documentPageHorizontalScrollDown&&(a.preventDefault(a),g_objPageControl.onEditAreaMoveHorizontalScrollPosition(a),TBCancelBubbleEvent(a))}}catch(d){dalert(d)}};
this.dze_page_window_onresize=function(a){try{!1===fnObjectCheckNull(g_objPageControl)&&g_objZoom.afterZoomDocument(g_objPageControl.nEditNumber)}catch(b){dalert(b)}};this.setDocumentContainerEvent=function(){try{if(g_browserCHK.iOS)dzeJ(g_objPageControl.documentContainerNode).on({touchmove:function(a){(a=g_objPageControl.getPageMain(g_objPageControl.currentPage))&&!0===g_objEditWindow[0].getSelection().isCollapsed&&a.blur()}});g_objPageControl.documentContainerNode.onmousemove=function(a){if(g_objPageControl.documentPageVerticalScrollDown)g_objPageControl.onEditAreaMoveVerticalScrollPosition(a);
else if(g_objPageControl.documentPageHorizontalScrollDown)g_objPageControl.onEditAreaMoveHorizontalScrollPosition(a)};g_objPageControl.documentContainerNode.onmouseup=function(a){g_objPageControl.documentPageVerticalScrollDown=!1;g_objPageControl.documentPageHorizontalScrollDown=!1;if(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)if(a=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_horizontal_scroll"))a.style.opacity=.5};g_objPageControl.documentContainerNode.onscroll=
function(a){g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,g_objPageControl.nEditNumber);g_objTableMiniMenu.onWheel()}}catch(a){dalert(a)}};this.setDocumentMainContainerEvent=function(a){try{"undefined"==typeof a&&(a=g_objPageControl.nEditNumber);var b=g_objEditorDocument[a].getElementById("dze_document_main_container");b.onmousedown=function(a){var b=a.target||
a.srcElement;if(b){var c=b.id;if("undefined"==typeof c||null==c)c="";var f=b.className;if("object"==typeof f)return;if("undefined"==typeof f||null==f)f="";("dze_document_main_container"==c||"dze_document_container"===f||f.match(/^dze_page_header_/)||f.match(/^dze_page_footer_/)||f.match(/^dze_page_.*_indicator$/))&&a.preventDefault()}dzeWebSearch.hideWebSearchBtn();g_objMenuWin.closeMenuLayer();g_objLayerEventUtil.initHideDynamicLayer(a);duzon_dialog.closeExtendsDlg();a=this.getPageNum(b);null!==
a&&(this.currentPage=a);dze_menu_control.forceBlurTitleInput()}.bind(this);b.onmousemove=function(a){if(g_objPageControl.documentPageVerticalScrollDown)g_objPageControl.onEditAreaMoveVerticalScrollPosition(a);else if(g_objPageControl.documentPageHorizontalScrollDown)g_objPageControl.onEditAreaMoveHorizontalScrollPosition(a)};b.onmouseup=function(a){var b=a.target||a.srcElement;if(b){var c=b.id;if("undefined"==typeof c||null==c)c="";b=b.className;if("object"==typeof b)return;if("undefined"==typeof b||
null==b)b="";("dze_document_main_container"==c||"dze_document_container"===b||b.match(/^dze_page_header_/)||b.match(/^dze_page_footer_/)||b.match(/^dze_page_.*_indicator$/))&&a.preventDefault()}g_objPageControl.documentPageVerticalScrollDown=!1;g_objPageControl.documentPageHorizontalScrollDown=!1;dzeWebSearch.hideWebSearchBtn();g_objMenuWin.closeMenuLayer()}.bind(this)}catch(c){dalert(c)}};this.setPageLabelButton=function(){try{for(var a=null,b=this.getTotalPageCount(),c=0;c<b;c++)a=g_objPageControl.getPageNode(c).childNodes[4],
g_objPropertyUtil.hasClass(a,"bottomCreator")||!1!==fnObjectCheckNull(a)||(!1===dzeUiConfig.bUsePageControllExtends?1===b?a.style.display="none":(a.title=ID_RES_CONST_BTN_DELETE,a.style.display=""):!0===dzeUiConfig.bOfficeOnePageLongMode||!0===g_readonlyMode?a.style.display="none":(a.title=ID_RES_CONST_STRING_PAGE_MANAGEMENT,a.style.display=""))}catch(d){dalert(d)}};this.doPageLabelBtnEvent=function(a,b){try{var c=a.target||a.srcElement,d=g_objPropertyUtil,e=null;c&&"DIV"===c.nodeName&&d.hasClass(c,
"dze_page_controller")&&(e=c);if(e)switch(a.type){case "mousedown":dze_menu_control.forceBlurTitleInput();TBCancelBubbleEvent(a);break;case "mouseover":d.addClass(e,"over");break;case "mouseout":d.removeClass(e,"over");break;case "click":if(g_objShapeFunction.onDeselectAllShapes(),!0===dzeUiConfig.bUsePageControllExtends)if(g_objContextMenuWin.initContextMenuLayerEvent(),!0===d.hasClass(e,"click"))d.removeClass(e,"click"),d.removeClass(e.firstChild,"click");else{d.addClass(e,"click");d.addClass(e.firstChild,
"click");var f=g_objNodeUtil.getParentElement(e);a=-1;!1===fnObjectCheckNull(f)&&(a=parseInt(f.getAttribute("dze_page_no"),10));pageManager.getInstance().setControlPageNumber(a);var g={nContextMenuType:g_objContextMenuWin.ID_CONTEXT_TYPE_CASE_PAGE_CONTROL,strSelectedTagName:""},k=e.getBoundingClientRect(),h=g_objEditObject[b].getBoundingClientRect();g_objContextMenuWin.showContextMenuLayer(g,k.right+2,h.top+k.top,b)}else if(2>g_objPageControl.getTotalPageCount())cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_DO_NOT_DELETE,
1.5);else{var l=e;cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_CONST_STRING_NOTI_DELETE_CONFIRM,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();var a=l.parentNode;if("undefined"!=typeof a&&null!=a){var c=a.getAttribute("dze_page_no");duzon_dialog.fade("out",a,function(){g_objPageControl.removePageContainer(c);resetSelectionObjectInfo();g_objWrapperOutlineResize.resetExtOutlineInfo();g_objUndoRedo.registerUndoRedoStack(0,b);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DELETED,
1.5);g_objPageControl.onSetDelayedUpdatePageTimer(0,c)},50)}})}}}catch(m){dalert(m)}};this.checkSaveCaret=function(a){try{var b=g_objCaretUtil.getPageNum(this.nEditNumber);return b&&g_objPositionUtil.isOverlap(a,a+1,b.start,b.end)?!0:!1}catch(c){dalert(c)}};this.saveCaret=function(){try{if(!0===this.bUpdatePage&&!0===this.bCheckSaveCaret&&!0!==this.bSaveCaret)return this.bSaveCaret=!0,g_objCaretUtil.saveCaret()}catch(a){dalert(a)}};this.restoreCaret=function(){try{if(0!=this.bSaveCaret)return this.bSaveCaret=
!1,g_objCaretUtil.restoreCaret()}catch(a){dalert(a)}};this.getPageMainTop=function(a){try{var b=0;return b+=g_objHeaderFooter.getHeaderContainer(a).offsetHeight}catch(c){dalert(c)}};this.updatePage=function(a,b){try{this.bUpdatePage=!0;if(dzeUiConfig.bOfficePgOverflowVisible)return this.RET_UPDATEPAGE_DONE;var c=this.getPageMain(a);if(null===c)return this.RET_UPDATEPAGE_DONE;if(!c.firstChild&&0==a&&1==this.getTotalPageCount())return c.innerHTML="<p><br></p>",g_objCaretUtil.moveCaret(c),this.RET_UPDATEPAGE_DONE;
for(;c&&!c.firstChild&&1<this.getTotalPageCount();)this.removePageContainer(a),c=this.getPageMain(a);if(null===c)return this.RET_UPDATEPAGE_DONE;var d=g_objNodeUtil,e=g_objCaretUtil,f=g_objSplitUtil;if(e.isComposing()&&e.exsistInPageNum(this.nEditNumber,a)){if(g_bBrowserType_IE)return this.RET_UPDATEPAGE_DONE;if(!0!==b)return this.RET_UPDATEPAGE_CURRENT_AFTER_A_WHILE}this.bCheckSaveCaret=this.checkSaveCaret(a);var g=parseInt(a)+1;b=null;var k=c.ownerDocument;e=null;f.resetSplitID(c);g_objHeaderFooter.updateDirtyHeaderFooter(a);
this.surroundByParagraph(c);var h=this.getPageMainTop(a)+c.offsetHeight,l=this.getPageBreakBottom(c);l&&(h=Math.min(l,h));!0===dzeUiConfig.bOfficeOnePageLongMode&&(h=Number.MAX_VALUE);var m=this.getNodeBottom(c.lastChild);l=m>h?!0:!1;this.pullNextNodeFirstChild(c)&&(m=this.getNodeBottom(c.lastChild),l=m>h?!0:!1);this.pullZeroHeightTr(c)&&(m=this.getNodeBottom(c.lastChild),l=m>h?!0:!1);var p=this.RET_UPDATEPAGE_DONE;if(l){var n=f.splitNode(c,h+1),q=n.nextNode;q&&q===c.firstChild&&(q=q.nextSibling);
q&&(this.saveCaret(),e=k.createDocumentFragment(),d.moveNodesTo(e,q));e&&e.firstChild&&((b=this.getPageMain(g))?(b.firstChild?b.insertBefore(e,b.firstChild):b.appendChild(e),f.mergeAll(b),f.resetSplitID(b)):(b=this.makePageContainer(g,!0),d.removeAllChild(b),b.appendChild(e)),p=this.RET_UPDATEPAGE_NEXT)}else{h-=m;for(b=this.getPageMain(g);b&&!b.firstChild;)this.removePageContainer(g),b=this.getPageMain(g);this.bCheckSaveCaret=this.checkSaveCaret(a);0<h&&b&&b.firstChild&&(n=f.splitNode(b,this.getPageMainTop(g)+
h),q=n.prevNode,n.bNodeSplit||n.prevNode||n.nextNode||(q=b.lastChild,p=this.RET_UPDATEPAGE_CURRENT),q&&(this.saveCaret(),e=k.createDocumentFragment(),d.moveNodesTo(e,b.firstChild,q)),e&&e.firstChild&&(c.appendChild(e),f.mergeAll(c),f.resetSplitID(c),b.firstChild?p=this.RET_UPDATEPAGE_NEXT:this.removePageContainer(g)))}this.bSaveCaret&&this.restoreCaret();g_objTableMiniMenu.isShow()&&g_objTableMiniMenu.delayUpdate();g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,
!0,!1,this.nEditNumber);return p}catch(r){dalert(r)}finally{this.bUpdatePage=!1,this.restoreCaret()}};this.surroundByParagraph=function(a){try{var b=!1;if(!a)return!1;for(var c=a.ownerDocument,d=null,e=null,f=a.firstChild,g=null;f;)g=f.nextSibling,3===f.nodeType?(this.saveCaret(),0<f.data.length?(d||(d=c.createDocumentFragment()),d.appendChild(f)):a.removeChild(f),b=!0):1===f.nodeType&&"BR"===f.nodeName?(this.saveCaret(),d||(d=c.createDocumentFragment()),d.appendChild(f),g&&(e=c.createElement("p"),
e.appendChild(d),a.insertBefore(e,g)),b=!0):1===f.nodeType&&"SPAN"===f.nodeName?(this.saveCaret(),d||(d=c.createDocumentFragment()),d.appendChild(f),b=!0):1===f.nodeType&&"IMG"===f.nodeName?(this.saveCaret(),d||(d=c.createDocumentFragment()),d.appendChild(f),b=!0):g&&d&&d.firstChild&&(this.saveCaret(),e=c.createElement("p"),e.appendChild(d),a.insertBefore(e,g)),f=g;d&&d.firstChild&&(e=c.createElement("p"),e.appendChild(d),a.appendChild(e));return b}catch(k){dalert(k)}};this.searchDragRangeNextSibling=
function(a){try{if(fnObjectCheckNull(a))return null;var b=null;if(3!==a.nodeType&&a.nextSibling)b=a.nextSibling;else if(a.parentNode&&g_objPropertyUtil.element_hasClass(a.parentNode,"dze_page_main")){var c=parseInt(a.parentNode.parentNode.getAttribute("dze_page_no"));c+1!==g_objPageControl.getTotalPageCount()&&(b=g_objPageControl.getPageMain(c+1).firstChild)}else{if(fnObjectCheckNull(a.parentNode))return null;b=a.parentNode&&a.parentNode.nextSibling&&3===a.parentNode.nextSibling.nodeType?a.parentNode.nextSibling:
null===a.parentNode.nextSibling?g_objPageControl.searchDragRangeNextSibling(a.parentNode):a.parentNode.nextSibling.firstChild}return b}catch(d){dalert(d)}};this.deleteIndent=function(a,b){function c(a){if(0===a.value)return a;Math.abs(a.value)>=a.remain?(a.value=0<a.value?a.value-a.remain:a.value+a.remain,a.remain=0):Math.abs(a.value)<a.remain&&(a.remain=0<a.value?a.remain-a.value:a.remain+a.value,a.value=0);return a}try{if(!a)return!1;var d=a.nEditNumber,e=GetCurRange(d);if(!e)return!1;var f=null;
if(e.collapsed){var g=e.startContainer,k=e.startOffset,h=g_objNodeUtil.getLoopParentElementByTagNames(g,g_objNodeUtil.arrParaTagName);if(!h||!SelectionUtil.isOnFirst(h,g,k))return!1;f=[h]}else{if(a.keyCode===ID_KEYCODE_BACKSPACE)return!1;f=g_objLetterFn.getSelectedParagraph(d)}if(!f||0>=f.length)return!1;a=0;h=null;for(var l=k=g=e=d=0,m=0,p=f.length;m<p;m++)if(h=f[m],e=k=g_objCommonUtil.toPx(h.style.textIndent),d=l=g_objCommonUtil.toPx(h.style.marginLeft),g=e+d,0!==g){if(0>g||!0!==b)l=k=0;else{var n=
20;0!==g%20&&(n=g%20);n={value:e,remain:n};c(n);k=n.value;n.value=d;c(n);l=n.value}if(e!==k||d!==l)h.style.textIndent=0===k?"":k,h.style.marginLeft=0===l?"":l,""===h.style.cssText&&h.removeAttribute("style"),a++}return 0<a?!0:!1}catch(q){dalert(q)}finally{e=null}};this.onProcessKeyEvent=function(a,b){try{if(null!=g_objPageControl.documentContainerNode){var c=a.keyCode,d=a.target||a.srcElement;if(d&&d.parentNode){var e=this.getPageNum(d);null===e||isNaN(e)||(g_objPageControl.currentPage=e)}switch(c){case ID_KEYCODE_BACKSPACE:this.backspaceCharOnFirstPos(a);
break;case ID_KEYCODE_DELETE:this.deleteCharOnLastPos(a);break;case ID_KEYCODE_END:DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&this.moveToPage(this.getTotalPageCount()-1,!1);return;case ID_KEYCODE_HOME:DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&this.moveToPage(0);return;case ID_KEYCODE_PAGE_UP:case ID_KEYCODE_PAGE_DOWN:case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_BOTTOM:this.onNaviKeyDown(a);return;case ID_KEYCODE_ENTER:if(!a.cancelBubble&&
DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&!a.shiftKey&&!a.altKey&&!0===this.insertPageBreak(a.nEditNumber)){TBCancelBubbleEvent(a);return}break;case ID_KEYCODE_A:if(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL))return;case ID_KEYCODE_C:if(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL))return;case ID_KEYCODE_V:if(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL))return;case ID_KEYCODE_Z:case ID_KEYCODE_Y:if(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL))return}if(isEditingKeyCode(c))g_objPageControl.onSetDelayedUpdatePageTimer(b)}}catch(f){dalert(f)}};
this.onSetDelayedUpdatePageTimer=function(a,b,c){try{if(!fnObjectCheckNull(this.documentContainerNode)){var d=g_objEditWindow[this.nEditNumber];if(d){a=a||.5;b=parseInt(b);var e=null;if("undefined"==typeof b||isNaN(b)){if(GetMultiCellSelection(this.nEditNumber)){var f=GetCurTable(this.nEditNumber),g=this.getPageNumRange(f);g&&this.setDirtyRange(g.start,g.end)}if((e=GetCurRange(this.nEditNumber))&&e.startContainer&&e.endContainer){b=this.getPageNum(e.startContainer);var k=this.getPageNum(e.endContainer);
this.setDirtyRange(b,k);e=null}else b=this.currentPage}g_objHeaderFooter.getHeaderFooterEditMode()?g_objHeaderFooter.propagateHeaderFooter(a,b):(this.clearUpdatePageTimer(),c&&null===this.updatePageCallback&&(this.updatePageCallback=c),d.clearTimeout(this.updatePageTimer),this.updatePageTimer=d.setTimeout(function(){g_objPageControl.runUpdatePage(b,0)},a))}}}catch(h){dalert(h)}finally{e=null}};this.clearUpdatePageTimer=function(){try{if(this.updatePageTimer){var a=g_objEditWindow[this.nEditNumber];
if(!a){a.clearTimeout(this.updatePageTimer);this.updatePageTimer=null;var b=this.updatePageCallback;this.updatePageCallback=null;b&&b()}}}catch(c){dalert(c)}};this.onSetDelayedUpdatePageTimerForNode=function(a,b){try{if(a){var c=null,d=this.getPageNumRange(a);d&&(c=d.start,this.setDirtyRange(d.start,d.end));this.onSetDelayedUpdatePageTimer(b,c)}}catch(e){dalert(e)}};this.onSetDelayedUpdatePageTimerRange=function(a,b,c){try{"undefined"===typeof b||isNaN(b)||"undefined"===typeof c||isNaN(c)||(this.setDirtyRange(b,
c),this.onSetDelayedUpdatePageTimer(a,b))}catch(d){dalert(d)}};this.onSetDelayedUpdatePageTimerAll=function(a,b,c){try{if(!fnObjectCheckNull(this.documentContainerNode)){var d=g_objEditWindow[this.nEditNumber];if(d){a=a||0;!1!==c&&duzon_http.showLoading();var e=function(){duzon_http.hideLoading();b&&"function"==typeof b&&b()};d.clearTimeout(this.updatePageTimerAll);this.updatePageTimerAll=d.setTimeout(function(){g_objPageControl.runUpdatePageAll(0,e)},a)}}}catch(f){dalert(f)}};this.runUpdatePage=
function(a,b,c){try{if(null===g_objShapeEvtMgr.getShapeTextContainer()&&!0!==g_readonlyMode){var d=g_objEditWindow[this.nEditNumber];if(d){var e=null,f=0===b?!0:!1;this.bDebug&&dlog("* runUpdatePage(): nCallCount: "+b+", nPageNum: "+a);b++;!0===f&&0<=a-1&&!g_objCaretUtil.isComposing()&&(e=this.updatePage(a-1),this.removeDirty(a-1),e===this.RET_UPDATEPAGE_CURRENT&&a--);e=this.updatePage(a,c);this.removeDirty(a);f=null;if(e===this.RET_UPDATEPAGE_NEXT)a+=1,a<this.getTotalPageCount()&&(this.setDirty(a),
d.clearTimeout(this.updatePageTimer),f=d.setTimeout(function(){g_objPageControl.runUpdatePage(a,b)},0));else if(e===this.RET_UPDATEPAGE_CURRENT)this.setDirty(a),d.clearTimeout(this.updatePageTimer),f=d.setTimeout(function(){g_objPageControl.runUpdatePage(a,b)},0);else if(e===this.RET_UPDATEPAGE_CURRENT_AFTER_A_WHILE)this.setDirty(a),d.clearTimeout(this.updatePageTimer),3<=b&&(c=!0),f=d.setTimeout(function(){g_objPageControl.runUpdatePage(a,b,c)},1E3);else for(var g=a+1,k=this.getTotalPageCount();g<
k;g++)if(this.isDirty(g)){d.clearTimeout(this.updatePageTimer);f=d.setTimeout(function(){g_objPageControl.runUpdatePage(g,b)},0);break}this.updatePageTimer=f;if(null===this.updatePageTimer){var h=this.updatePageCallback;this.updatePageCallback=null;h&&h()}}}}catch(l){dalert(l)}};this.syncUpdatePageAll=function(){for(var a,b=0,c=b+10;b<Math.min(c,this.getTotalPageCount());b++)a=this.updatePage(b),a===this.RET_UPDATEPAGE_CURRENT&&b--};this.updateDirtyPageAll=function(){try{if(!0!==g_readonlyMode&&null===
g_objShapeEvtMgr.getShapeTextContainer())for(var a=0,b=0;b<this.getTotalPageCount();b++)this.isDirty(b)&&(a=this.updatePage(b),a===this.RET_UPDATEPAGE_CURRENT&&b--)}catch(c){dalert(c)}};this.runUpdatePageAll=function(a,b){try{var c=g_objEditWindow[this.nEditNumber];if(c){for(var d=a+10,e=0;a<Math.min(d,this.getTotalPageCount());a++)e=this.updatePage(a),e===this.RET_UPDATEPAGE_CURRENT&&a--;this.updatePageTimerAll=null;0<=a&&a<this.getTotalPageCount()&&(c.clearTimeout(this.updatePageTimerAll),this.updatePageTimerAll=
c.setTimeout(function(){g_objPageControl.runUpdatePageAll(a,b)},0));null===this.updatePageTimerAll&&b&&"function"===typeof b&&b()}}catch(f){dalert(f)}};this.backspaceCharOnFirstPos=function(a){try{if(!(!a||a.cancelBubble||a.modifierKey||dzeUiConfig.bOfficeOnePageLongMode||dzeUiConfig.bOfficePgOverflowVisible||0<g_objSelectedShapesArray.length||g_objShapeEvtMgr.getShapeTextContainer()||g_objHeaderFooter.getHeaderFooterEditMode())){var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed)return!1;var c=
g_objNodeUtil,d=b.startContainer,e=b.startOffset,f=c.getClosest(d,function(a){return c.isPageMain(a)||c.isCell(a)?!0:!1});if(!SelectionUtil.isOnFirst(f,d,e))return!1;b=null;c.isPageMain(f)?b=this.getPageMain(this.getPageNum(f)-1):c.isCell(f)&&(b=g_objSplitUtil.getPreviousSplitSibling(f));if(!b||!f)return!1;g_objCaretUtil.moveCaret(b,!1,!1);var g=c.getClosestParagraph(d);g_objNodeUtil.isBlankPara(g)&&(g.parentNode.removeChild(g),TBCancelBubbleEvent(a));return!0}}catch(k){dalert(k)}finally{b=null}};
this.deleteCharOnLastPos=function(a){try{if(!a||a.cancelBubble||a.modifierKey||dzeUiConfig.bOfficeOnePageLongMode||dzeUiConfig.bOfficePgOverflowVisible||null!==g_objShapeEvtMgr.getShapeTextContainer()||g_objHeaderFooter.getHeaderFooterEditMode())return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed)return!1;var c=g_objNodeUtil,d=b.startContainer,e=b.startOffset,f=c.getClosest(d,function(a){return c.isPageMain(a)||c.isCell(a)?!0:!1});if(!SelectionUtil.isOnLast(f,d,e))return!1;a=null;c.isPageMain(f)?
a=this.getPageMain(this.getPageNum(f)+1):c.isCell(f)&&(a=g_objSplitUtil.getNextSplitSibling(f));if(!f||!a)return!1;g_objCaretUtil.moveCaret(a,!1);return!1}catch(g){dalert(g)}finally{b=null}};this.onNaviKeyDown=function(a){try{if(!a||a.cancelBubble||dzeUiConfig.bOfficeOnePageLongMode||0<g_objSelectedShapesArray.length||g_objShapeEvtMgr.getShapeTextContainer())return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed)return!1;var c=b.startContainer,d=b.startOffset,e=g_objNodeUtil.getLoopBreakNode(c);
if(!e)return!1;var f=this.getPageNum(e);if(null===f)return!1;var g=a.keyCode;b=!1;33===g?b=this.moveToPage(f-1):34===g&&(b=f+1>=this.getTotalPageCount()?this.moveToPage(f,!1):this.moveToPage(f+1));if(!1===b&&!g_objHeaderFooter.getHeaderFooterEditMode()&&!g_objCaretUtil.canMove(e,c,d,g))if(37===g||38===g)b=this.moveToPage(f-1,!1);else if(39===g||40===g)b=this.moveToPage(f+1);!0===b&&TBCancelBubbleEvent(a);return!1}catch(k){dalert(k)}finally{}};this.moveToPage=function(a,b,c){try{if(0<g_objSelectedShapesArray.length||
g_objShapeEvtMgr.getShapeTextContainer())return!0;var d=g_objHeaderFooter,e=null;if(d.getHeaderFooterEditMode()){var f=d.getCurHeaderFooter();e=f&&g_objPropertyUtil.hasClass(f,"dze_page_footer")?d.getFooter(a):d.getHeader(a)}else e=this.getPageMain(a);if(!e)return!1;this.currentPage=a;g_bBrowserType_IE||e.focus({preventScroll:!0});d=g_objCaretUtil;g_readonlyMode||d.moveCaret(e,!1,!1===b?!1:!0);c&&!0===c.scroll_top?d.scrollToPage(a,d.ALIGN_TO_TOP):g_readonlyMode||d.scrollToCaret();return!0}catch(g){dalert(g)}};
this.createPageBreak=function(){try{var a=g_objEditorDocument[this.nEditNumber].createElement("P");a.className=this.DZE_PAGE_BREAK_PARA;a.innerHTML="<BR>";return a}catch(b){dalert(b)}};this.insertPageBreak=function(a){try{if(!0===dzeUiConfig.bOfficeOnePageLongMode)return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALERT_NOT_AVAILABLE_IN_ONEPAGE_MODE,1.5),!1;if(!0===dzeUiConfig.bOfficePgOverflowVisible||g_readonlyMode)return!1;var b=g_objNodeUtil,c=GetCurRange(a);if(!c||b.isPageMain(c.startContainer))return!1;
var d=c.startContainer.childNodes[c.startOffset]||c.startContainer;if(!d)return!1;var e=g_objEditorDocument[a],f=SelectionUtil;caretUtil=g_objCaretUtil;for(var g=null;d&&!b.isBoundNode(d);)inArray(d.nodeName,this.arrPageBreakElement)&&(g=d),d=d.parentNode;if(!g)return!1;var k=b.getLoopHeaderFooterBody(g);if(!b.isPageMain(k)||g.parentNode!==k)return!1;!0===f.deleteSelection(a)&&(c=GetCurRange(a),d=c.startContainer.childNodes[c.startOffset]||c.startContainer);var h=e.createElement("span");c.collapse(!0);
c.insertNode(h);var l=h.previousSibling,m=h.nextSibling;b.splitOn(k,h);var p=h.previousSibling,n=h.nextSibling;h.parentNode.removeChild(h);b.removeEmptyNode(p,l);b.removeEmptyNode(n,m);b.insertBrIntoBlankPara(p);b.insertBrIntoBlankPara(n);g_objPropertyUtil.addClass(p,this.DZE_PAGE_BREAK_PARA);caretUtil.moveCaret(n);var q=this.getPageNum(n);this.onSetDelayedUpdatePageTimer(0,q,null,function(){caretUtil.scrollTo(n)});g_objWrapperOutlineResize.resetExtOutlineInfo();return!0}catch(r){dalert(r)}finally{c=
null}};this.removePageBreak=function(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_BACKSPACE&&a.keyCode!==ID_KEYCODE_DELETE)return!1;var b=GetCurRange(a.nEditNumber);if(!b||!b.collapsed)return!1;var c=b.startContainer,d=b.startOffset;if(!c)return!1;for(var e=g_objNodeUtil,f=g_objPropertyUtil,g=SelectionUtil,k=this.DZE_PAGE_BREAK_PARA,h=null,l=c;l&&!e.isBoundNode(l);)0<=this.arrPageBreakElement.indexOf(l.nodeName)&&(h=l),l=l.parentNode;if(!h)return!1;var m=this.getPageNum(c),
p=null!==m?this.getPageMain(m):null,n=null!==m?this.getPageMain(m-1):null;e=!1;l=null;m=h;a.keyCode===ID_KEYCODE_BACKSPACE?p&&n&&g.isOnFirst(p,c,d)&&g_objPropertyUtil.hasClass(n.lastChild,this.DZE_PAGE_BREAK_PARA)?(m=n.lastChild,e=!0):f.hasClass(h,k)&&g.existOnFirst(h,b)&&(h.previousSibling&&"P"===h.nodeName&&h.nodeName===h.previousSibling.nodeName?l=h.previousSibling:e=!0):a.keyCode===ID_KEYCODE_DELETE&&(f.hasClass(h,k)&&g.existOnLast(h,b)?e=!0:h.nextSibling&&"P"===h.nodeName&&h.nodeName===h.nextSibling.nodeName&&
f.hasClass(h.nextSibling,k)&&g.existOnLast(h,b)&&(l=h));e?(f.removeClass(m,k),TBCancelBubbleEvent(a)):l&&(f.removeClass(m,k),f.addClass(l,k));return e}catch(q){dalert(q)}finally{}};this.removePageBreakForBack=function(a){return!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_BACKSPACE?!1:this.removePageBreak(a)};this.removePageBreakForDel=function(a){return!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_DELETE?!1:this.removePageBreak(a)};this.changeCssPageBreakAfter=function(a){var b=
!1,c=null;return function(a){try{var d=g_objEditorDocument[a];b||(b=!0,changeCss("div.dze_page_main>.dze_page_break_para::after","font-family",g_strBodyFontFamily,d));var f=!(g_readonlyMode||dzeUiConfig.bOfficeOnePageLongMode);if(null===c||f!==c)(c=f)?changeCss("div.dze_page_main>.dze_page_break_para::after","content",'"'+ID_RES_STRING_PAGE_BREAK_GUIDE+'"',d):changeCss("div.dze_page_main>.dze_page_break_para::after","content",'""',d)}catch(g){dalert(g)}}}();this.removeOldPageBreakSpan=function(a){try{if(!a)return!1;
var b=a.querySelectorAll("span.dze_page_break");b=[].slice.call(b);b.forEach(function(a){var b=a.parentNode;b.removeChild(a);g_objNodeUtil.insertBrIntoBlankPara(b)});return 0<b.length?!0:!1}catch(c){dalert(c)}};this.getNodeBottom=function(a){try{if(!a)return 0;for(var b=g_objPositionUtil,c=b.getPageRect(a,!0).bottom();a&&0===c;)a=a.previousSibling,c=b.getPageRect(a,!0).bottom();return c}catch(d){dalert(d)}};this.getPageBreakBottom=function(a){try{if(!a||dzeUiConfig.bOfficeOnePageLongMode)return 0;
for(var b=g_objPropertyUtil,c=g_objSectionUtil,d=null,e=null,f=a.firstChild;f;){if(b.hasClass(f,this.DZE_PAGE_BREAK_PARA)){d=f;break}else if(c.isSectionNode(f)){e=f;break}f=f.nextSibling}return d?g_objPositionUtil.getPageBottom(d):e?this.getNodeBottom(e):0}catch(g){dalert(g)}};this.updateStatusPageNum=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var b=g_objCaretUtil.getPageNum(a).end;fnObjectCheckNull(b)||this.setStatusPageNum(b)}catch(c){dalert(c)}};this.setStatusPageNum=function(a,
b){try{if(!0===dzeUiConfig.bUseBottomStatusBar){var c=document.getElementById("STATUS_BAR_LEFT_TBL_"+this.nEditNumber);if(c){var d=c.rows[0];if(d){var e=d.cells[1];if(e){var f=e.textContent.match(/[0-9]+/g),g=parseInt(f[0],10),k=parseInt(f[1],10),h=fnObjectCheckNull(a)?g:parseInt(a,10)+1,l=fnObjectCheckNull(b)?this.getTotalPageCount():pareInt(b,10);h=Math.min(h,l);if(g!==h||k!==l)e.innerHTML=h+"/"+l+" "+ID_RES_CONST_STRING_PAGE}}}}}catch(m){dalert(m)}};this.pullNextNodeFirstChild=function(a){try{if(!a)return!1;
var b=g_objSplitUtil,c=g_objNodeUtil,d=null,e=c.isPageMain(a),f=parseInt(this.getPageNum(a));if(e){if(!a.dzeDirty||!b.isSplitNode(a.lastChild))return!1;d=this.getPageMain(f+1)}else if(c.isCell(a)){var g=this.getLoopPageMain(a);if(!g||!g.dzeDirty||!b.isSplitNode(a))return!1;d=b.getNextSplitSibling(a);if(1!==this.getPageNum(d)-f)return!1}if(!d||!d.firstChild)return!1;g=null;for(var k=a.lastChild;k;){if(!k||"TABLE"===k.nodeName)return!1;g=k;k=k.lastChild}if(!g||3!==g.nodeType||!c.checkTagName(g.parentNode,
"p","li","dt","dd","span","a","b","strong","u","i","em","strike","s","sub","sup"))return!1;c=null;for(k=d.firstChild;k;){if(!k||"TABLE"===k.nodeName)return!1;c=k;k=k.firstChild}if(!c||3!==c.nodeType)return!1;k=g_objPositionUtil;var h=g.nodeValue.length,l=k.getPageRect(a.lastChild).right()-k.getTextNodeRect(g,h-1,h).right;if(0>=l||k.getTextNodeRect(c,0,1).width>l)return!1;this.saveCaret();var m=a.lastChild,p=d.firstChild;a.appendChild(p);b.mergeNode(m,p);e&&!d.firstChild&&this.removePageContainer(f+
1);return!0}catch(n){dalert(n)}};this.isZeroHeightTr=function(a){try{if(!a||"TR"!==a.nodeName)return!1;var b=g_objPropertyUtil,c=b.getStyleHeight(a);if(0<c)return!1;var d=a.cells;a=null;for(var e=d.length,f=0;f<e;f++)if(c=b.getStyleHeight(d[f]),0<c)return!1;for(f=0;f<e;f++)if(a=d[f],(!a.firstChild||"TABLE"!==a.firstChild.nodeName||1!==a.firstChild.rows.length||!this.isZeroHeightTr(a.firstChild.rows[0]))&&a.firstChild)return!1;return!0}catch(g){return dalert(g),!1}};this.pullZeroHeightTr=function(a){try{if(!a)return!1;
var b=g_objNodeUtil,c=null;b.isPageMain(a)?c=this.getPageMain(this.getPageNum(a)+1):b.isCell(a)&&(c=g_objSplitUtil.getNextSplitSibling(a));if(!a||!c)return!1;var d=a.lastChild,e=c.firstChild;return d&&e&&"TABLE"===d.nodeName&&"TABLE"===e.nodeName&&e===g_objSplitUtil.getNextSplitSibling(d)?this.isZeroHeightTr(e.rows[0])?((new TableMatrix(e,!0)).divideTable(1),insertAfter(d,e),g_objSplitUtil.mergeNode(d,e),!0):!1:!1}catch(f){dalert(f)}};this.checkMatchTextByPattern=function(a,b){try{var c=null,d=g_objEditWindow[g_objPageControl.nEditNumber].getSelection(),
e=d.anchorNode,f=null,g=-1;!1===fnObjectCheckNull(b)&&b&&(e=g_objPageControl.getPageMain(0).firstChild,d.removeAllRanges());for(;null!=e;){f=e.nextSibling;if(null===f)for(b=g_objPropertyUtil,d=e;null===f;){if(d.parentNode&&b.element_hasClass(d.parentNode,"dze_page_container")){var k=parseInt(d.parentNode.getAttribute("dze_page_no")),h=g_objPageControl.getPageMain(k+1);!1===fnObjectCheckNull(h)&&!1===fnObjectCheckNull(h.firstChild)&&(f=h.firstChild);break}null===d.parentNode.nextSibling&&(d=d.parentNode);
f=d.parentNode.nextSibling}if(f&&(f.innerText||ID_SELECTION_TEXT_NODE==f.nodeType&&f.data))for(b=0;b<a.length;b++){var l=ID_SELECTION_TEXT_NODE==f.nodeType?f.data:f.innerText;if(duzon_dialog.idx_privacy_etc==a[b]){var m=document.getElementById("dze_idx_privacy_etc_input").value;var p=l.match(m)}else p=a[b].exec(l);if(p)return c=p[0],g=this.getPrivatePatternType(a[b]),findEditorTextDetail(g_objPageControl.nEditNumber,c,0,0,0,0),{text:c,type:g}}e=f}return{text:c,type:g}}catch(n){dalert(n)}};this.getPrivatePatternType=
function(a){try{var b=0;return b=a===duzon_dialog.privacy_pattern_phone?0:a===duzon_dialog.privacy_pattern_email?1:a===duzon_dialog.privacy_pattern_rrnumber?2:-1}catch(c){dalert(c)}};this.setOffCustomScrollDisplay=function(){try{var a=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_horizontal_scroll"),b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container_custom_vertical_scroll");a&&(a.style.display="none");
b&&(b.style.display="none");g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container").style.overflow="";g_objEditorDocument[g_objPageControl.nEditNumber].body.style.overflow=""}catch(c){dalert(c)}};this.setShowHidePageLabelBtns=function(a){!0===a?changeCss(".dze_page_label_container_normal","display","block",g_objEditorDocument[g_objPageControl.nEditNumber]):changeCss(".dze_page_label_container_normal","display","none",g_objEditorDocument[g_objPageControl.nEditNumber])};
this.mergeDocument=function(a){try{if(!a)return!1;for(var b=0,c=a.length;b<c;b++)if(a[b].content){var d=document.implementation.createHTMLDocument("NewDoc");d.documentElement.innerHTML=a[b].content;d=1==d.body.childNodes.length&&"div"==d.body.firstChild.nodeName.toLowerCase()&&"oneffice_content"==d.body.firstChild.id?d.body.firstChild:d.body;this.initializePageWithData(d,this.getTotalPageCount())}return!0}catch(e){dalert(e)}};this.makePageController=function(a,b){try{if(!a)return null;var c=a.ownerDocument,
d=c.createElement("div"),e=c.createElement("div");d.className="dze_page_controller normal";d.setAttribute("contenteditable","false");e.className="dze_page_controller_button";e.setAttribute("contenteditable","false");d.appendChild(e);!1===dzeUiConfig.bUsePageControllExtends&&(e.style.transform="rotate(0deg)",0==b&&(d.style.display="none"));if(g_readonlyMode||objOnefficeLoader.m_bHybrid||dzeUiConfig.bOfficeOnePageLongMode)d.style.display="none";return d}catch(f){dalert(f)}};this.makePageMarginArea=
function(a,b){try{if(!a)return null;var c=a.ownerDocument.createElement("div");c.className=b?"dze_page_margin_top unselectable":"dze_page_margin_bottom unselectable";c.contentEditable=!1;if(g_readonlyMode||objOnefficeLoader.m_bHybrid)c.style.display="none";return c}catch(d){dalert(d)}};this.makePageBottomCreator=function(){try{var a=document.createElement("div");a.className="bottomCreator";a.contentEditable=!1;dzeUiConfig.bUsebottomCreatorBackgroundStyle||(a.style.display="none");return a}catch(b){dalert(b)}};
this.setPageNumberReadonlyMode=function(a){try{if(!0===g_readonlyMode){var b=g_objEditorDocument[a].getElementsByClassName("dze_page_container");for(a=0;a<b.length;a++)b[a].onmouseenter=function(){g_objPageControl.setStatusPageNum(this.getAttribute("dze_page_no"))}}}catch(c){dalert(c)}};this.getPageRectInfo=function(a){try{var b=g_objPageControl.getPageNode(a).getBoundingClientRect(),c=dzeUiConfig.nSettingPaperMargin,d=b.top,e=b.bottom,f=d+b.height/2,g=d+dzeLayoutControl.getValueWithRatio(g_objCommonUtil.convMMToPx(c.top)),
k=e-dzeLayoutControl.getValueWithRatio(g_objCommonUtil.convMMToPx(c.bottom));a=g+(k-g)/2;var h=b.left,l=b.right,m=h+b.width/2,p=h+dzeLayoutControl.getValueWithRatio(g_objCommonUtil.convMMToPx(c.left)),n=l-dzeLayoutControl.getValueWithRatio(g_objCommonUtil.convMMToPx(c.right));return{outerTop:d,outerBottom:e,outerHorizontalCenter:f,innerTop:g,innerBottom:k,innerHorizontalCenter:a,outerLeft:h,outerRight:l,outerVerticalCenter:m,innerLeft:p,innerRight:n,innerVerticalCenter:p+(n-p)/2}}catch(q){dalert(q)}};
this.selectAllPage=function(a,b){try{if(g_bBrowserType_EDGE||g_bBrowserType_SF||g_objHeaderFooter.getHeaderFooterEditMode()||g_objPropertyUtil.hasClass(g_objEditorDocument[a].body,"unselectable"))return!1;var c=0<g_objSelectedShapesArray.length||g_objShapeEvtMgr.getShapeTextContainer();if(!b&&(c||GetCurTable(a))||SelectionUtil.isOnInput(a))return!1;if(c)g_objShapeFunction.onDeselectAllShapes();GetMultiCellSelection(a)&&g_objTableSelection.clearCellSelection(GetCurTable(a));var d=g_objEditorDocument[a],
e=d.defaultView,f=e?e.getSelection():null;if(!f)return!1;a=g_objNodeUtil;var g=this.getPageMain(0),k=this.getPageMain(this.getTotalPageCount()-1);b=0;for(var h=k.childNodes.length,l=g.firstChild;l&&a.isDocFirstNode(l);)b++,l=l.nextSibling;for(var m=k.lastChild;m&&a.isDocLastNode(m);)h=Math.max(0,h-1),m=m.previousSibling;var p=d.createRange();p.setStart(g,b);p.setEnd(k,h);f.removeAllRanges();f.addRange(p);return!0}catch(n){dalert(n)}};this.setAllPageEditMode=function(a){try{if(g_browserCHK.edge){var b=
g_objPageControl.getAllPageMain(),c=GetCurRange(g_objPageControl.nEditNumber);g_objPageControl.getPageNum(c.startContainer);for(c=0;c<b.length;c++){var d=b[c];d.setAttribute("contenteditable",a);d.contentEditable=a}}}catch(e){dalert(e)}};this.dragStartMultiPage=function(a,b){try{var c=GetCurRangeArray(a);if(!c||1>=c.getRangeCount())return!1;var d=c.cloneContents(),e=g_objEditorDocument[a].createElement("div");e.appendChild(d);var f=e.innerHTML;g_bBrowserType_IE?b.dataTransfer.setData("text","{text/dze_dragdrop:multipage}"+
f):(b.dataTransfer.setData("text/dze_dragdrop","multipage"),b.dataTransfer.setData("text/html",f));return!0}catch(g){dalert(g)}}};
var shortcutsMenuList=[];shortcutsMenuList[ID_COMMAND_FILE_NEW]="Alt+N";shortcutsMenuList[ID_COMMAND_FILE_OPEN]="Alt+O";shortcutsMenuList[ID_COMMAND_SAVEAS]="Ctrl+S";shortcutsMenuList[ID_COMMAND_PRINT]="Ctrl+P";shortcutsMenuList[ID_COMMAND_UNDO]="Ctrl+Z";shortcutsMenuList[ID_COMMAND_REDO]="Ctrl+Y";shortcutsMenuList[ID_COMMAND_CUT]="Ctrl+X";shortcutsMenuList[ID_COMMAND_COPY]="Ctrl+C";shortcutsMenuList[ID_COMMAND_COPY_EXT_STYLE]="Alt+C";shortcutsMenuList[ID_COMMAND_PASTE]="Ctrl+V";
shortcutsMenuList[ID_COMMAND_EDIT_PASTESPECIAL]="Ctrl+Alt+V";shortcutsMenuList[ID_COMMAND_DELETE]="Ctrl+E";shortcutsMenuList[ID_COMMAND_SELECT_ALL]="Ctrl+A";shortcutsMenuList[ID_COMMAND_EDIT_SEARCH]="Ctrl+F";shortcutsMenuList[ID_COMMAND_EDIT_REPLACE]="Ctrl+H";shortcutsMenuList[ID_COMMAND_INSERT_SPECIALCHARS]="Ctrl+F10";shortcutsMenuList[ID_COMMAND_INSERT_BOOKMARK]="Ctrl+K,B";shortcutsMenuList[ID_COMMAND_HYPERLINK_INSERT]="Ctrl+K,H";shortcutsMenuList[ID_COMMAND_STYLE_FONT]="Alt+L";
shortcutsMenuList[ID_COMMAND_STYLE_PARAGRAPH]="Alt+W";shortcutsMenuList[ID_COMMAND_STYLE_ORDEREDLIST]="Ctrl+Shift+[";shortcutsMenuList[ID_COMMAND_STYLE_UNORDEREDLIST]="Ctrl+Shift+]";shortcutsMenuList[ID_COMMAND_STYLE_INCREASE_FONTSIZE]="Alt+Shift+E";shortcutsMenuList[ID_COMMAND_STYLE_DECREASE_FONTSIZE]="Alt+Shift+R";shortcutsMenuList[ID_COMMAND_STYLE_INCREASEORDER]="Alt+\u2190";shortcutsMenuList[ID_COMMAND_STYLE_DECREASEORDER]="Alt+\u2192";shortcutsMenuList[ID_COMMAND_TABLE_ADD_ROW_COL]="Alt+Insert";
shortcutsMenuList[ID_COMMAND_TABLE_DELETE_ROW]="Ctrl+BackSpace";shortcutsMenuList[ID_COMMAND_TABLE_DELETE_COL]="Alt+Shift+Delete";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_SUM]="Ctrl+Shift+H";shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_SUM]="Ctrl+Shift+V";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_AVERAGE]="Ctrl+Shift+J";shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_AVERAGE]="Ctrl+Shift+B";shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY]="Ctrl+Shift+K";
shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_MULTIPLY]="Ctrl+Shift+G";shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_HEIGHT]="Ctrl+Alt+H";shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_WIDTH]="Ctrl+Alt+W";shortcutsMenuList[ID_COMMAND_TABLE_MERGE_CELL]="Ctrl+Alt+M";shortcutsMenuList[ID_COMMAND_TABLE_SPLIT_CELL]="Ctrl+Alt+S";shortcutsMenuList[ID_COMMAND_TABLE_CELL_STYLE]="Ctrl+L";shortcutsMenuList[ID_COMMAND_CONV_KOREAN]="Ctrl+Space";shortcutsMenuList[ID_COMMAND_PAGE_SETTING]="F7";
shortcutsMenuList[ID_COMMAND_PREVIEW]="Alt+Enter";shortcutsMenuList[ID_COMMAND_JUSTIFY_JUSTIFY]="Ctrl+Shift+M";shortcutsMenuList[ID_COMMAND_JUSTIFY_LEFT]="Ctrl+Shift+L";shortcutsMenuList[ID_COMMAND_JUSTIFY_CENTER]="Ctrl+Shift+C";shortcutsMenuList[ID_COMMAND_JUSTIFY_RIGHT]="Ctrl+Shift+R";shortcutsMenuList[ID_COMMAND_BOLD]="Ctrl+B";shortcutsMenuList[ID_COMMAND_ITALIC]="Ctrl+I";shortcutsMenuList[ID_COMMAND_UNDERLINE]="Ctrl+U";shortcutsMenuList[ID_COMMAND_FILE_SAVE_REMOTE]="Ctrl+S";
shortcutsMenuList[ID_COMMAND_FILE_LIST_OPEN]="Alt+O";
g_browserCHK.isMacPC()&&(shortcutsMenuList[ID_COMMAND_SAVEAS]="Cmd+S",shortcutsMenuList[ID_COMMAND_PRINT]="Cmd+P",shortcutsMenuList[ID_COMMAND_UNDO]="Cmd+Z",shortcutsMenuList[ID_COMMAND_REDO]="Cmd+Shift+Z",shortcutsMenuList[ID_COMMAND_CUT]="Cmd+X",shortcutsMenuList[ID_COMMAND_COPY]="Cmd+C",shortcutsMenuList[ID_COMMAND_PASTE]="Cmd+V",shortcutsMenuList[ID_COMMAND_DELETE]="Cmd+E",shortcutsMenuList[ID_COMMAND_SELECT_ALL]="Cmd+A",shortcutsMenuList[ID_COMMAND_EDIT_SEARCH]="Cmd+F",shortcutsMenuList[ID_COMMAND_EDIT_REPLACE]=
"Cmd+H",shortcutsMenuList[ID_COMMAND_INSERT_BOOKMARK]="Cmd+K,B",shortcutsMenuList[ID_COMMAND_HYPERLINK_INSERT]="Cmd+K,H",shortcutsMenuList[ID_COMMAND_BOLD]="Cmd+B",shortcutsMenuList[ID_COMMAND_ITALIC]="Cmd+I",shortcutsMenuList[ID_COMMAND_UNDERLINE]="Cmd+U",shortcutsMenuList[ID_COMMAND_FILE_SAVE_REMOTE]="Cmd+S",shortcutsMenuList[ID_COMMAND_PAGE_SETTING]="Cmd+F7",shortcutsMenuList[ID_COMMAND_INSERT_SPECIALCHARS]="Cmd+F10",shortcutsMenuList[ID_COMMAND_JUSTIFY_JUSTIFY]="Cmd+Shift+M",shortcutsMenuList[ID_COMMAND_JUSTIFY_LEFT]=
"Cmd+Shift+L",shortcutsMenuList[ID_COMMAND_JUSTIFY_CENTER]="Cmd+Shift+C",shortcutsMenuList[ID_COMMAND_JUSTIFY_RIGHT]="Cmd+Shift+R",shortcutsMenuList[ID_COMMAND_TABLE_DELETE_ROW]="Cmd+BackSpace",shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_SUM]="Cmd+Shift+H",shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_SUM]="Cmd+Shift+V",shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_AVERAGE]="Cmd+Shift+J",shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_AVERAGE]="Cmd+Shift+B",shortcutsMenuList[ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY]=
"Cmd+Shift+K",shortcutsMenuList[ID_COMMAND_TABLE_VERTICAL_MULTIPLY]="Cmd+Shift+G",shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_HEIGHT]="Cmd+Alt+H",shortcutsMenuList[ID_COMMAND_TABLE_CELL_SAME_WIDTH]="Cmd+Alt+W",shortcutsMenuList[ID_COMMAND_TABLE_MERGE_CELL]="Cmd+Alt+M",shortcutsMenuList[ID_COMMAND_TABLE_SPLIT_CELL]="Cmd+Alt+S",shortcutsMenuList[ID_COMMAND_TABLE_CELL_STYLE]="Cmd+L");
var DZESHORTCUT={nEditNumber:-1,evnt:null,keyCodeArray:[],isPressedKeyMapForOS:function(a,b){try{if(!1===g_browserCHK.isMacPC())switch(b){case ID_KEYCODE_CTRL:if(a.ctrlKey)return!0;break;case ID_KEYCODE_ALT:if(a.altKey)return!0}else switch(b){case ID_KEYCODE_CTRL:if(a.metaKey)return!0;break;case ID_KEYCODE_ALT:if(a.altKey)return!0}return!1}catch(c){}},setKeyCodeArray:function(a){inArray(a,this.keyCodeArray)||this.keyCodeArray.push(a)},clearKeyCodeArray:function(){this.keyCodeArray=[]},checkMatchMultiAlphaKeyCode:function(a){for(var b=
0,c=0;c<this.keyCodeArray.length;c++)for(var d=0;d<a.length;d++)a[d]==this.keyCodeArray[c]&&d==c&&b++;return b==a.length?!0:!1},construct:function(a,b){this.nEditNumber=b;this.evnt=a},setDzeShortCutEvent:function(a,b){this.construct(a,b);dzeEnvConfig.bDebugging&&dlog("=== DZESHORTCUT KeyDown (nEditNumber:"+this.nEditNumber+", keyCode:"+this.evnt.keyCode+", ctrl:"+this.evnt.ctrlKey+", alt:"+this.evnt.altKey+", shift:"+this.evnt.shiftKey+", meta:"+this.evnt.metaKey+")");!this.evnt.ctrlKey||this.evnt.altKey||
this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_E||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_H||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey&&this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==
ID_KEYCODE_DELETE&&TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_S||TBCancelBubbleEvent(this.evnt);!this.evnt.ctrlKey||this.evnt.altKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_O&&this.evnt.keyCode!=ID_KEYCODE_I&&this.evnt.keyCode!=ID_KEYCODE_W&&this.evnt.keyCode!=ID_KEYCODE_Q||TBCancelBubbleEvent(this.evnt);
!this.evnt.ctrlKey&&this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_E&&TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_W||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_L||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_N||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||
!this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_U&&this.evnt.keyCode!=ID_KEYCODE_I&&this.evnt.keyCode!=ID_KEYCODE_B||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F7||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey||this.evnt.altKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||TBCancelBubbleEvent(this.evnt);this.evnt.keyCode!=ID_KEYCODE_M&&this.evnt.keyCode!=ID_KEYCODE_H&&this.evnt.keyCode!=ID_KEYCODE_W||
!GetMultiCellSelection(this.nEditNumber)||TBCancelBubbleEvent(this.evnt);this.evnt.ctrlKey&&!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_G&&TBCancelBubbleEvent(this.evnt);!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_A&&a.keyCode!=ID_KEYCODE_F&&a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_B&&a.keyCode!=ID_KEYCODE_H||(this.setKeyCodeArray("ctrl"),this.setKeyCodeArray(a.keyCode),setTimeout(function(){0<DZESHORTCUT.keyCodeArray.length&&
DZESHORTCUT.clearKeyCodeArray()},1E3));this.setNewFile();this.setOpenFile();this.setSaveAs();this.setPrint();this.setCopyPasteStyle();this.setRedo();this.setPastespecial();this.setDelete();!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_F||this.setFindText();!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_Q&&a.keyCode!=ID_KEYCODE_A&&
a.keyCode!=ID_KEYCODE_H||this.setReplaceText();this.setSpecialChars();if(DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.altKey&&!this.evnt.shiftKey&&(a.keyCode==ID_KEYCODE_K||a.keyCode==ID_KEYCODE_B)&&3===DZESHORTCUT.keyCodeArray.length&&75===DZESHORTCUT.keyCodeArray[1])return this.setInsertBookmark(),!1;!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.altKey||this.evnt.shiftKey||a.keyCode!=ID_KEYCODE_K&&a.keyCode!=ID_KEYCODE_H||this.setHyperLinkInsert();
this.setStyleFont();this.setStyleParagraph();this.setInsertOrderedList();this.setInsertUnOrderedList();this.setIncreaseFontSize();this.setIncreaseLetterSpacing();this.setFontProperty();this.setParagraphAlign();this.setIndentParagraph();this.setLeftMargin();this.setRightMargin();this.setLineHeight();this.setAutoListStyle();this.setApplyListStyleDepth();this.tableAddRowCol();this.tableHorizontalSum();this.tableVerticalSum();this.tableHorizontalAverage();this.tableVerticalAverage();this.tableHorizontalMultiply();
this.tableVerticalMultiply();this.tableMergeCell();this.tableSplitCell();this.tableCellSameHeight();this.tableCellSameWidth();this.tableAddRow();this.tableDeleteRow();this.tableDeleteCol();this.tableSelectOneCell();this.applyEscKeyAction();this.convKorean();this.copyMutiCell();this.cutMutiCell();this.printMarginSetting();this.setSlideShow();this.setTabKeyAction();this.moveMultiCellSelection();this.setTableResizeAction();this.setSelectEntireCells();this.destruct(a);this.copyCutShapes();this.copy();
this.cut();this.selectAll();this.moveToPage();this.createTable(b,a);this.setCellStyle(b,a);!this.evnt.ctrlKey||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_L||TBCancelBubbleEvent(this.evnt)},setNewFile:function(){try{!this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_N||(fnHandler_NewFile(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setOpenFile:function(){try{!this.evnt.altKey||this.evnt.ctrlKey||
this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_O||(!0===dzeUiConfig.bOfficeMode?fnHandler_OpenFileList(this.evnt,null,this.nEditNumber):fnHandler_OpenFile(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setSaveAs:function(){try{(!this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_S&&"KeyS"!==this.evnt.code)&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.shiftKey||this.evnt.keyCode!=
ID_KEYCODE_S&&"KeyS"!==this.evnt.code)||(!0===dzeUiConfig.bOfficeMode?objOnefficeLoader.m_bHybrid?fnHandler_saveMobileFile(function(a){!0===a&&mobileToast.show(ID_RES_CONST_STRING_SAVED)}):fnHandler_SaveFileRemote(this.evnt,null,this.nEditNumber):fnHandler_SaveAs(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setPrint:function(){try{!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_ALT)||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_P||
(fnHandler_Print(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt)),!0!==dzeUiConfig.bOfficePagingMode||this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_P||(fnHandler_Print(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setCopyPasteStyle:function(){try{!0===g_readonlyMode||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_ALT)||this.evnt.keyCode!=ID_KEYCODE_C&&
this.evnt.keyCode!=ID_KEYCODE_V||(this.evnt.keyCode==ID_KEYCODE_C?letterFunction.getInstance().copyTextStyle():letterFunction.getInstance().pasteTextStyle(!0),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setRedo:function(){},setPastespecial:function(){try{!0!==g_readonlyMode&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_V&&(fnHandler_Pastespecial(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},
setDelete:function(){try{!0!==g_readonlyMode&&(!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.altKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_E||fnHandler_SupportCommand_Main(this.nEditNumber,"Delete"))}catch(a){dalert(a)}},setFindText:function(){try{if(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_Q,ID_KEYCODE_F])||DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.altKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_F)fnHandler_FindReplaceText(this.evnt,
null,this.nEditNumber,"find"),DZESHORTCUT.clearKeyCodeArray(),TBCancelBubbleEvent(this.evnt)}catch(a){dalert(a)}},setReplaceText:function(){try{!0!==g_readonlyMode&&(this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_Q,ID_KEYCODE_A])||this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_H]))&&(fnHandler_FindReplaceText(this.evnt,null,this.nEditNumber,"replace"),DZESHORTCUT.clearKeyCodeArray(),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setSpecialChars:function(){try{!0!==g_readonlyMode&&
DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_F10&&(fnHandler_SpecialChars(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setInsertBookmark:function(){try{if(!0===g_readonlyMode)return;this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_K,ID_KEYCODE_B])&&(fnHandler_InsertBookmark(this.evnt,null,this.nEditNumber),DZESHORTCUT.clearKeyCodeArray(),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}return!1},setHyperLinkInsert:function(){try{!0!==
g_readonlyMode&&this.checkMatchMultiAlphaKeyCode(["ctrl",ID_KEYCODE_K,ID_KEYCODE_H])&&(fnHandler_HyperLinkInsert(this.evnt,null,this.nEditNumber),DZESHORTCUT.clearKeyCodeArray(),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setStyleFont:function(){try{!0===g_readonlyMode||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.ctrlKey||this.evnt.keyCode!=ID_KEYCODE_L||(fnHandler_StyleFont(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setStyleParagraph:function(){try{!0===
g_readonlyMode||!this.evnt.altKey||this.evnt.shiftKey||this.evnt.ctrlKey||this.evnt.keyCode!=ID_KEYCODE_W||(fnHandler_StyleParagraph(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setInsertOrderedList:function(){try{!0!==g_readonlyMode&&!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET&&(fnHandler_SupportCommand_Main(this.nEditNumber,"InsertOrderedList"),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},
setInsertUnOrderedList:function(){try{!0!==g_readonlyMode&&!this.evnt.altKey&&this.evnt.shiftKey&&this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_CLOSESQUAREBRACKET&&(fnHandler_SupportCommand_Main(this.nEditNumber,"InsertUnorderedList"),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setIncreaseFontSize:function(){try{!0===g_readonlyMode||(!this.evnt.altKey||!this.evnt.shiftKey||this.evnt.ctrlKey||this.evnt.keyCode!=ID_KEYCODE_E&&this.evnt.keyCode!=ID_KEYCODE_R)&&(this.evnt.altKey||this.evnt.shiftKey||
!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.keyCode!=ID_KEYCODE_OPENSQUAREBRACKET&&this.evnt.keyCode!=ID_KEYCODE_CLOSESQUAREBRACKET)||(this.evnt.keyCode==ID_KEYCODE_R||this.evnt.keyCode==ID_KEYCODE_OPENSQUAREBRACKET?fnHandler_StyleDecreaseFontSize(this.evnt,null,this.nEditNumber):fnHandler_StyleIncreaseFontSize(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setIncreaseLetterSpacing:function(){try{if(!0!==g_readonlyMode&&this.evnt.altKey&&
this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_W||this.evnt.keyCode==ID_KEYCODE_N)&&(!0!==dzeUiConfig.bUseLockEditCellFunction||!0!==g_objTableFunction.hasLockedCellInSelection()&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){dlog("setIncreaseLetterSpacing start");var a=!0;this.evnt.keyCode==ID_KEYCODE_N&&(a=!1);strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI();strSelectionType=strSelectionType.toLowerCase();
if(ID_STRING_NAME_TEXT!=strSelectionType&&ID_STRING_NAME_NONE!=strSelectionType)dlog("select type is not support -> strSelectionType : "+strSelectionType);else{var b=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);duzon_dialog.initSelectionFontStyleList(b);dlog(duzon_dialog.selectionFontStyleList);""==duzon_dialog.selectionFontStyleList.letterSpacing&&(duzon_dialog.selectionFontStyleList.letterSpacing="0pt");var c=parseInt(duzon_dialog.selectionFontStyleList.letterSpacing.replace(/pt/,
""),10);dlog("org letterSpacing:"+c);a=!0===a?c+1:c-1;a<duzon_dialog.min_letterspacing||a>duzon_dialog.max_letterspacing?dlog("increaseSpacing exception - increaseSpacing : "+a):(dlog("increaseSpacing:"+a),g_objLetterSpacingWin.fnLetterSpacingCellClick(a+"pt"),TBCancelBubbleEvent(this.evnt))}}}catch(d){dalert(d)}},setFontProperty:function(){try{if(!0!==g_readonlyMode){var a=!0;dzeUiConfig.bSupportNewsEditor&&(a=!1);if(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey){if(!0===dzeUiConfig.bUseLockEditCellFunction&&
(!0===g_objTableFunction.hasLockedCellInSelection()||0==g_objEditMode.checkSelectionContentEditable(this.nEditNumber)))return;var b="";if(this.evnt.keyCode==ID_KEYCODE_U)b=g_arrConst[ID_COMMAND_UNDERLINE][0];else if(this.evnt.keyCode==ID_KEYCODE_B)b=g_arrConst[ID_COMMAND_BOLD][0];else if(this.evnt.keyCode==ID_KEYCODE_I)b=g_arrConst[ID_COMMAND_ITALIC][0];else if(this.evnt.keyCode==ID_KEYCODE_P)b=g_arrConst[ID_COMMAND_SUPERSCRIPT][0];else if(this.evnt.keyCode==ID_KEYCODE_S)b=g_arrConst[ID_COMMAND_SUBSCRIPT][0];
else return;dlog("strCommand:"+b);!1!==a&&fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,b);TBCancelBubbleEvent(this.evnt)}if(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)){b="";if(this.evnt.keyCode==ID_KEYCODE_U)b=g_arrConst[ID_COMMAND_UNDERLINE][0];else if(this.evnt.keyCode==ID_KEYCODE_B)b=g_arrConst[ID_COMMAND_BOLD][0];else if(this.evnt.keyCode==ID_KEYCODE_I)b=g_arrConst[ID_COMMAND_ITALIC][0];else return;dlog("strCommand:"+b);!1!==a&&
fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,b);TBCancelBubbleEvent(this.evnt)}else if(this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_A&&(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType)){var c=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],
ID_COMMAND_SUPERSCRIPT,g_arrConst[ID_COMMAND_SUPERSCRIPT][0],this.nEditNumber,-1,strSelectionType),d=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],ID_COMMAND_SUBSCRIPT,g_arrConst[ID_COMMAND_SUBSCRIPT][0],this.nEditNumber,-1,strSelectionType);dlog("strStateSuper:"+c);dlog("strStateSub:"+d);c==ID_STRING_NAME_CHECKED?(b=g_arrConst[ID_COMMAND_SUPERSCRIPT][0],fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,b),b=g_arrConst[ID_COMMAND_SUBSCRIPT][0]):b=d==ID_STRING_NAME_CHECKED?
g_arrConst[ID_COMMAND_SUBSCRIPT][0]:g_arrConst[ID_COMMAND_SUPERSCRIPT][0];dlog("strCommand:"+b);!1!==a&&fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,b);TBCancelBubbleEvent(this.evnt)}}}catch(e){dalert(e)}},setParagraphAlign:function(){try{if(!0!==g_readonlyMode&&!this.evnt.altKey&&this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)){var a=0;if(this.evnt.keyCode==ID_KEYCODE_M)a=ID_COMMAND_JUSTIFY_JUSTIFY;else if(this.evnt.keyCode==ID_KEYCODE_L)a=ID_COMMAND_JUSTIFY_LEFT;
else if(this.evnt.keyCode==ID_KEYCODE_R)a=ID_COMMAND_JUSTIFY_RIGHT;else if(this.evnt.keyCode==ID_KEYCODE_C)a=ID_COMMAND_JUSTIFY_CENTER;else return;fnHandler_Align_Main(this.nEditNumber,g_arrConst[a][0],!1,a);TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setIndentParagraph:function(){try{if(!0!==g_readonlyMode){if(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_F5||!this.evnt.altKey&&this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,
ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_O)fnHandler_Outdent(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt);if(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_F6||!this.evnt.altKey&&this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode==ID_KEYCODE_I)fnHandler_Indent(this.evnt,null,this.nEditNumber),TBCancelBubbleEvent(this.evnt)}}catch(a){dalert(a)}},
margin_unit_val:5,setLeftMargin:function(){try{if(!0!==g_readonlyMode&&this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&(this.evnt.keyCode==ID_KEYCODE_5||this.evnt.keyCode==ID_KEYCODE_6)&&(!0!==dzeUiConfig.bUseLockEditCellFunction||!0!==g_objTableFunction.hasLockedCellInSelection()&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);dlog("======setIndentParagraph======");
dlog(a);var b=a[6];""==b&&(b="0px");a=b=parseInt(b.replace(/px/gi,""),10);this.evnt.keyCode==ID_KEYCODE_5?b>ParagraphDlg.marginLeftMin&&(a-=this.margin_unit_val):this.evnt.keyCode==ID_KEYCODE_6&&b<ParagraphDlg.marginLeftMax&&(a+=this.margin_unit_val);a<ParagraphDlg.marginLeftMin&&(a=ParagraphDlg.marginLeftMin);a>ParagraphDlg.marginLeftMax&&(a=ParagraphDlg.marginLeftMax);g_objLetterFn.setParaStyle(this.nEditNumber,{marginLeft:a});TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},setRightMargin:function(){try{if(!0!==
g_readonlyMode&&this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&(this.evnt.keyCode==ID_KEYCODE_7||this.evnt.keyCode==ID_KEYCODE_8)&&(!0!==dzeUiConfig.bUseLockEditCellFunction||!0!==g_objTableFunction.hasLockedCellInSelection()&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);dlog("======setIndentParagraph======");dlog(a);var b=a[8];""==b&&(b="0px");a=b=parseInt(b.replace(/px/gi,
""),10);this.evnt.keyCode==ID_KEYCODE_8?a>ParagraphDlg.marginRightMin&&(a-=this.margin_unit_val):this.evnt.keyCode==ID_KEYCODE_7&&a<ParagraphDlg.marginRightMax&&(a+=this.margin_unit_val);a<ParagraphDlg.marginRightMin&&(a=ParagraphDlg.marginRightMin);a>ParagraphDlg.marginRightMax&&(a=ParagraphDlg.marginRightMax);g_objLetterFn.setParaStyle(this.nEditNumber,{marginRight:a});TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},lineheight_unit_val:.1,setLineHeight:function(){try{if(!0!==g_readonlyMode&&
(this.evnt.altKey&&this.evnt.shiftKey&&!this.evnt.ctrlKey&&(this.evnt.keyCode==ID_KEYCODE_A||this.evnt.keyCode==ID_KEYCODE_Z)||!this.evnt.altKey&&this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&(this.evnt.keyCode==ID_KEYCODE_Q||this.evnt.keyCode==ID_KEYCODE_W))&&(!0!==dzeUiConfig.bUseLockEditCellFunction||!0!==g_objTableFunction.hasLockedCellInSelection()&&0!=g_objEditMode.checkSelectionContentEditable(this.nEditNumber))){var a=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);
dlog("======setIndentParagraph======");dlog(a);var b=a[5];""==b&&(b="1.2");b=parseFloat(b,10);dlog("lineHeight:"+b);a=b;if(this.evnt.keyCode==ID_KEYCODE_A||this.evnt.keyCode==ID_KEYCODE_Q)a>ParagraphDlg.lineHeightMin&&(a-=this.lineheight_unit_val);else if(this.evnt.keyCode==ID_KEYCODE_Z||this.evnt.keyCode==ID_KEYCODE_W)a<ParagraphDlg.lineHeightMax&&(a+=this.lineheight_unit_val);else return;dlog("newLineHeight:"+a);a<ParagraphDlg.lineHeightMin&&(a=ParagraphDlg.lineHeightMin);a>ParagraphDlg.lineHeightMax&&
(a=ParagraphDlg.lineHeightMax);dlog("newLineHeight2:"+a);g_objLineHeightWin.fnLineHeightCellClick(a);TBCancelBubbleEvent(this.evnt)}}catch(c){dalert(c)}},setAutoListStyle:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_SPACE||applyAutoListStyle(this.evnt,this.nEditNumber),this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!==ID_KEYCODE_BACKSPACE||applyListStyleBackSpace(this.evnt,this.nEditNumber),this.evnt.altKey||
this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!==ID_KEYCODE_DELETE||applyListStyleDelete(this.evnt,this.nEditNumber))}catch(a){dalert(a)}},setApplyListStyleDepth:function(){try{if(!0!==g_readonlyMode&&this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&(this.evnt.keyCode==ID_KEYCODE_ARROW_RIGHT||this.evnt.keyCode==ID_KEYCODE_ARROW_LEFT)){if(this.evnt.keyCode==ID_KEYCODE_ARROW_RIGHT)var a="decrease";else if(this.evnt.keyCode==ID_KEYCODE_ARROW_LEFT)a="increase";else return;applyListStyleDepth(a,
this.nEditNumber,!0,!1)}}catch(b){dalert(b)}},tableAddRowCol:function(){try{if(!0!==g_readonlyMode&&this.evnt.altKey&&!this.evnt.ctrlKey&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_INSERT){var a=GetCurTable(this.nEditNumber);a&&!g_objTableUtil.isProtect(a)&&fnHandler_TableAddRowCol(this.evnt,null,this.nEditNumber)}}catch(b){dalert(b)}},tableHorizontalSum:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||
this.evnt.keyCode!=ID_KEYCODE_H||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedCellInSelection()||fnHandler_TableHorizontalSum(this.evnt,null,this.nEditNumber))}catch(a){dalert(a)}},tableVerticalSum:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_V||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedCellInSelection()||fnHandler_TableVerticalSum(this.evnt,
null,this.nEditNumber))}catch(a){dalert(a)}},tableHorizontalAverage:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_J||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedCellInSelection()||fnHandler_TableHorizontalAverage(this.evnt,null,this.nEditNumber))}catch(a){dalert(a)}},tableVerticalAverage:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,
ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_B||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedCellInSelection()||fnHandler_TableVerticalAverage(this.evnt,null,this.nEditNumber))}catch(a){dalert(a)}},tableHorizontalMultiply:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_K||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedCellInSelection()||
fnHandler_TableHorizontalMultiply(this.evnt,null,this.nEditNumber))}catch(a){dalert(a)}},tableVerticalMultiply:function(){try{!0!==g_readonlyMode&&(this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_G||!0===dzeUiConfig.bUseLockEditCellFunction&&!0===g_objTableFunction.hasLockedCellInSelection()||fnHandler_TableVerticalMultiply(this.evnt,null,this.nEditNumber))}catch(a){dalert(a)}},tableCellSameHeight:function(){try{!0!==
g_readonlyMode&&this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_H&&fnHandler_TableCellSameHeight(this.evnt,null,this.nEditNumber)}catch(a){dalert(a)}},tableCellSameWidth:function(){try{!0!==g_readonlyMode&&this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_W&&fnHandler_TableCellSameWidth(this.evnt,null,this.nEditNumber)}catch(a){dalert(a)}},
tableMergeCell:function(){try{!0!==g_readonlyMode&&this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_M&&GetMultiCellSelection(this.nEditNumber)&&!g_objTableUtil.isProtect()&&fnHandler_TableMergeCell(this.evnt,null,this.nEditNumber)}catch(a){dalert(a)}},tableSplitCell:function(){try{!0!==g_readonlyMode&&this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==
ID_KEYCODE_S&&!g_objTableUtil.isProtect()&&fnHandler_TableSplitCell(this.evnt,null,this.nEditNumber)}catch(a){dalert(a)}},tableAddRow:function(){try{if(!0!==g_readonlyMode&&!this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_ENTER){var a=GetCurTableInfo(this.nEditNumber);if(a){var b=a.table;if(b){var c=g_objTableUtil;if(c.isBizboxReportTable(b)){var d=a.cell.parentNode.getAttribute(DZE_CUSTOM_ATT_ROWGROUP);if(d&&g_objTableOperation.addRowgroup(b,
d,this.nEditNumber)){TBCancelBubbleEvent(this.evnt);return}}c.isProtect(b)||fnHandler_TableAddRowDown(this.evnt,null,this.nEditNumber)}}}}catch(e){dalert(e)}},tableDeleteRow:function(){try{if(!0!==g_readonlyMode&&!this.evnt.altKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&!this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_BACKSPACE){var a=this.nEditNumber,b=GetCurTable(a);b&&GetMultiCellSelection(a)&&!g_objTableUtil.isProtect(b)&&fnHandler_TableDeleteRow(this.evnt,null,a)}}catch(c){dalert(c)}},
tableDeleteCol:function(){try{!0!==g_readonlyMode&&this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.shiftKey&&this.evnt.keyCode==ID_KEYCODE_DELETE&&!g_objTableUtil.isProtect()&&fnHandler_TableDeleteCol(this.evnt,null,this.nEditNumber)}catch(a){dalert(a)}},tableSelectOneCell:function(){try{!0===g_readonlyMode||this.evnt.altKey||this.evnt.ctrlKey||!this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_F5||(g_objTableSelection.table_SelectionCaretCell(this.nEditNumber),updateTableHandlerUI.updateTableUIHandler(this.nEditNumber))}catch(a){dalert(a)}},
unsetPasteStyleMode:function(){try{letterFunction.getInstance().hasCopyedStyle()&&letterFunction.getInstance().changePasteStyleMode(!1)}catch(a){dalert(a)}},convKorean:function(){try{!0!==g_readonlyMode&&(this.evnt.cancelBubble||this.evnt.altKey||!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_SPACE||GetCurTable(this.nEditNumber)||dzeWebSearch.convKorean(this.evnt,this.nEditNumber))}catch(a){dalert(a)}},unsetHighlighterMode:function(){try{dzeHighlighter.unsetHighlightMode(this.nEditNumber)}catch(a){dalert(a)}},
copyMutiCell:function(){try{if(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_C||!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_INSERT){var a=this.nEditNumber;GetMultiCellSelection(a)&&(dzeClipBoard.copySelectedMultiCells(a),TBCancelBubbleEvent(this.evnt))}}catch(b){dalert(b)}},cutMutiCell:function(){try{if(!this.evnt.altKey&&!this.evnt.shiftKey&&
DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_X||!this.evnt.altKey&&this.evnt.shiftKey&&!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_DELETE){var a=this.nEditNumber;GetMultiCellSelection(a)&&(dzeClipBoard.cutSelectedMultiCells(a),TBCancelBubbleEvent(this.evnt))}}catch(b){dalert(b)}},applyEscKeyAction:function(){try{!0===g_readonlyMode||this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=
ID_KEYCODE_ESCAPE||(this.unsetPasteStyleMode(),this.unsetHighlighterMode(),onefficeChart.initialize(),dzeUiConfig.bUsePasteOptionMenu&&g_objPasteOptionMenu.remove())}catch(a){dalert(a)}},printMarginSetting:function(){try{0<g_objSelectedShapesArray.length||null!==g_objShapeEvtMgr.getShapeTextContainer()||!0===dzeUiConfig.bOfficeMode&&!0!==g_readonlyMode&&(this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode==ID_KEYCODE_F7&&fnHandler_pageSetting(this.evnt,null,this.nEditNumber))}catch(a){dalert(a)}},
setSlideShow:function(){try{!0!==dzeUiConfig.bOfficeMode||!this.evnt.altKey||this.evnt.ctrlKey||this.evnt.shiftKey||this.evnt.keyCode!=ID_KEYCODE_ENTER||(fnTool_TabMode_Preview(this.evnt,null,ID_TB_TABMODE_PREVIEW,this.nEditNumber),TBCancelBubbleEvent(this.evnt))}catch(a){dalert(a)}},setTabKeyAction:function(){try{if(!0!==g_readonlyMode&&!0===dzeUiConfig.bOfficeMode){var a=this.nEditNumber,b=!this.evnt.altKey&&!this.evnt.ctrlKey&&this.evnt.keyCode==ID_KEYCODE_TAB,c=this.evnt.altKey&&!this.evnt.ctrlKey&&
this.evnt.keyCode===ID_KEYCODE_T;if(b||c){var d=SelectionUtil.isOnInput(a);if(d){var e=g_objEditorDocument[a].querySelectorAll("input, textarea");e=[].slice.call(e);var g=e.indexOf(d);(!this.evnt.shiftKey&&g===e.length-1||this.evnt.shiftKey&&0===g)&&TBCancelBubbleEvent(this.evnt)}else{c=!1;if(0<g_objSelectedShapesArray.length)g_objShapeFunction.onKeyDown(this.evnt);else if(b&&GetCurTable(a))if(SelectionUtil.existOnFirst(GetCurListItem(a),GetCurRange(a)))c=applyListStyleDepth(this.evnt.shiftKey?"increase":
"decrease",a,!1);else return;else if(hasListInRange(a,!0)){var h=g_objNodeUtil.createRangeWalker(GetCurRange(a),NodeFilter.SHOW_ELEMENT,function(a){return"P"===a.nodeName||"LI"===a.nodeName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});e=d=!1;var f=h.firstChild(),k;if(!f&&(k=GetCurListItem(a))){c=SelectionUtil.existOnFirst(k,GetCurRange(a))?applyListStyleDepth(this.evnt.shiftKey?"increase":"decrease",a,!1):applyTabKeyAction(this.evnt.shiftKey?!1:!0,a,this.evnt);!0===c&&TBCancelBubbleEvent(this.evnt);
b&&this.evnt.preventDefault();return}for(;f;){var m=h.nextNode();"LI"===f.nodeName&&(e=!0);"P"===f.nodeName&&(d=!0);f=m}c=!d&&e?applyListStyleDepth(this.evnt.shiftKey?"increase":"decrease",a,!1):g_objLetterFn.setParaStyle(a,this.evnt.shiftKey?{outdent:!0}:{indent:!0})}else g_objCaretUtil.isContentEditable(a)&&(this.evnt.shiftKey?this.evnt.shiftKey&&(c=applyTabKeyAction(!1,a,this.evnt)):c=applyTabKeyAction(!0,a,this.evnt));!0===c&&TBCancelBubbleEvent(this.evnt);this.evnt.shiftKey&&!this.evnt.cancelBubble&&
g_objPageControl.deleteIndent(this.evnt,!0)&&TBCancelBubbleEvent(this.evnt);b&&this.evnt.preventDefault()}}}}catch(l){dalert(l)}},moveMultiCellSelection:function(){try{g_objTableSelection.onKeyDown_multiCellSelection(this.evnt,this.nEditNumber)&&TBCancelBubbleEvent(this.evnt)}catch(a){dalert(a)}},setTableResizeAction:function(){try{if(!g_readonlyMode&&isArrowKeyCode(this.evnt.keyCode)&&(this.evnt.altKey||DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL))){var a=this.nEditNumber;GetMultiCellSelection(a)&&
g_objTableResize.applyTableResizeKeyAction(this.evnt,a)&&TBCancelBubbleEvent(this.evnt)}}catch(b){dalert(b)}},setSelectEntireCells:function(){try{if(!this.cancelBubble&&null===g_objShapeEvtMgr.getShapeTextContainer()&&!SelectionUtil.isOnInput(this.nEditNumber)){var a=!1,b=this.nEditNumber,c=g_objTableSelection,d=this.evnt.keyCode,e=DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL),g=this.evnt.altKey,h=this.evnt.shiftKey;!e||g||h||d!==ID_KEYCODE_A?!e||g||h||d!==ID_KEYCODE_SPACE?e&&!g&&h&&
d===ID_KEYCODE_SPACE&&(a=c.table_selectRow(GetCurTable(b),b)):a=c.table_selectCol(GetCurTable(b),b):a=c.table_selectAll(GetCurTable(b),b);!0===a&&(g_objTableSelection.updateManualTableUIHandler(b),TBCancelBubbleEvent(this.evnt))}}catch(f){dalert(f)}},destruct:function(a){},copyCutShapes:function(){try{if(!1===this.evnt.altKey&&!1===this.evnt.shiftKey&&(DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_C||DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&
this.evnt.keyCode===ID_KEYCODE_X)&&!(!1===dzeUiConfig.bUseShapesFeature||1>g_objSelectedShapesArray.length||null!==g_objShapeEvtMgr.getShapeTextContainer()))g_objShapeFunction.onKeyDown(this.evnt)}catch(a){dalert(a)}},copy:function(){try{if(!this.evnt.cancelBubble&&(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_C||!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&
this.evnt.keyCode===ID_KEYCODE_INSERT))return g_objCopyPaste.onCopyBefore(this.evnt)}catch(a){dalert(a)}},cut:function(){try{if(!g_readonlyMode&&!this.evnt.cancelBubble&&(!this.evnt.altKey&&!this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_X||!this.evnt.altKey&&this.evnt.shiftKey&&!DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&this.evnt.keyCode===ID_KEYCODE_DELETE))return g_objCopyPaste.onCutBefore(this.evnt)}catch(a){dalert(a)}},
selectAll:function(){try{return!this.evnt.cancelBubble&&this.evnt.keyCode===ID_KEYCODE_A&&!1===this.evnt.altKey&&!1===this.evnt.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&(setSelectionColor(this.nEditNumber),g_objWrapperOutlineResize.resetExtOutlineInfo(this.evnt),g_objPageControl.selectAllPage(this.nEditNumber))?(TBCancelBubbleEvent(this.evnt),!0):!1}catch(a){dalert(a)}},moveToPage:function(a){try{if(a||!this.evnt.cancelBubble&&!1===this.evnt.altKey&&!1===this.evnt.shiftKey&&
this.evnt.ctrlKey&&this.evnt.keyCode===ID_KEYCODE_G){var b=function(a){1==g_objPageControl.moveToPage(a,!0,{scroll_top:!0})?(g_objPageControl.updateStatusPageNum(c),duzon_dialog.closeDialog()):(cmnCtrlToast.showToastMsg(null,"1 \uacfc "+g_objPageControl.getTotalPageCount()+" \uc0ac\uc774\uc758 \uc815\uc218\ub97c \uc785\ub825\ud558\uc2ed\uc2dc\uc624.",2),document.getElementById("dze_idx_move_page_input").focus())},c=this.nEditNumber;cmnDlg.viewBasicDlg(this.evnt,this.nEditNumber,ID_RES_CONST_STRING_PAGE_MOVE,
duzon_dialog.moveToPageContents(),[ID_RES_DIALOG_STRING_MOVE,ID_RES_ADJUST_VIEW_CLOSE],[function(a){a=document.getElementById("dze_idx_move_page_input").value;b(a-1)},function(a){duzon_dialog.closeDialog()}],function(){var a=document.getElementById("dze_idx_move_page_input");a.onkeydown=function(a){0==(48<=a.keyCode&&57>=a.keyCode||96<=a.keyCode&&105>=a.keyCode||a.keyCode==ID_KEYCODE_BACKSPACE||a.keyCode==ID_KEYCODE_DELETE||a.keyCode==ID_KEYCODE_ARROW_LEFT||a.keyCode==ID_KEYCODE_ARROW_RIGHT||a.keyCode==
ID_KEYCODE_END||a.keyCode==ID_KEYCODE_HOME||a.keyCode==ID_KEYCODE_ESCAPE?!0:!1)&&TBCancelBubbleEvent(a)};a.onkeyup=function(a){ID_KEYCODE_ENTER==a.keyCode&&b(this.value-1)}},function(){},!0);TBCancelBubbleEvent(this.evnt)}}catch(d){dalert(d)}},createTable:function(a,b){try{g_readonlyMode||g_browserCHK.mobile||!b||b.cancelBubble||!b.altKey||b.shiftKey||!DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)||b.keyCode!==ID_KEYCODE_E||fnHandler_TableCreate(b,null,a,{bCreateSimple:!0})}catch(c){dalert(c)}},
setCellStyle:function(a,b){try{g_readonlyMode||g_browserCHK.mobile||!b||b.cancelBubble||b.altKey||b.shiftKey||!DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)||b.keyCode!==ID_KEYCODE_L||!GetCurTable(a)||fnHandler_TableCellStyle(b,null,a)}catch(c){dalert(c)}}};
function DzeSpinner(){this.id="";this.max=500;this.min=0;this.amount=1;this.onunitchange=this.onmouseup=this.callback=null;this.bAlert=!0;this.timer2=this.timer1=null;this.arrListener=[];return this}DzeSpinner.arrSpinner=[];DzeSpinner.open=function(a){try{return DzeSpinner.arrSpinner.push(a)}catch(b){dalert(b)}};
DzeSpinner.close=function(a){try{for(var b=function(b){for(var c=g_objPropertyUtil;b&&"BODY"!==b.nodeName;){if(c.element_hasClass(b,a))return!0;b=b.parentNode}return!1},d=DzeSpinner.arrSpinner,c=null,f=0,e=d.length;f<e;f++)(c=d[f])&&b(c.container)&&(c.destroy(),d[f]=null);DzeSpinner.arrSpinner=DzeSpinner.arrSpinner.filter(function(a){return null!=a});return!0}catch(g){dalert(g)}};DzeSpinner.closeDialog=function(){return DzeSpinner.close("duzon_dialog_body")};DzeSpinner.closePanel=function(){return DzeSpinner.close("dze_panel_body")};
DzeSpinner.getSpinner=function(a){try{for(var b=DzeSpinner.arrSpinner,d=null,c=0,f=b.length;c<f;c++)if((d=b[c])&&(d.input&&d.input.id===a||d.container&&d.container.id===a))return d;return null}catch(e){dalert(e)}};
DzeSpinner.getHTML=function(a){try{var b=a.id,d="undefined"!==typeof a.name?a.name:b,c=a.value,f=a.unit,e=a.width,g=a.height,h=a.marginRight,k=a.style||"",l=a.arrUnit;f&&!e&&0>k.indexOf("width")&&(e=72);a="";e=e?"width:"+(parseInt(e)-2)+"px;":"";g=g?"height:"+(parseInt(g)-2)+"px;":"";h=h?"margin-right:"+parseInt(h)+"px;":"";if(k||e||g||h)a=' style="'+k+e+g+h+'"';e="";c&&(e=' value="'+c+'"');f=f||"";c="";c+='<div class="duzon_spinner_input_form_container"'+a+">";c+='<input type="text" name="'+d+'" id="'+
b+'"'+e+' class="duzon_spinner_input_form" autocomplete="off"/>';c+="<div style='font-size: 11px; margin-left: 2px; width: 15px; height: 100%; position: relative; display: flex; align-items: center; text-align: center;'>";c+=f;if(l){c+='<select style="width: 100% !important;height: 100% !important;opacity: 0 !important;position: absolute;left: 0px;top: 0px; cursor: pointer;">';b=0;for(var m=l.length;b<m;b++)c+='<option value="'+l[b]+'">'+l[b]+"</option>";c+="</select>"}c+="</div>";c+='<div style="height:100%;margin-left:1px;">';
c+='<div class="duzon_spinner_btn_arrow_up"></div>';c+='<div class="duzon_spinner_btn_arrow_down"></div>';return c+"</div></div>"}catch(n){dalert(n)}};DzeSpinner.createSpinner=function(a,b){try{if(!a)return null;var d=DzeSpinner.getSpinner(a.id);d?d.destroy():(d=new DzeSpinner,DzeSpinner.open(d));d.init(a);d.setProperty(b);d.addHandler();return d}catch(c){dalert(c)}};
DzeSpinner.prototype={init:function(a){try{if(a){this.id=a.id;this.input=a;var b=a.parentNode;this.container=b;this.unitSelect=(this.unit=b.childNodes[1])?this.unit.lastChild:null;var d=b.childNodes[2];this.btnUp=d.firstChild;this.btnDown=d.lastChild;this.selectionEnd=this.selectionStart=0;return this}}catch(c){dalert(c)}},setProperty:function(a){try{if(!a)return!1;this.setPropertyValue("max",a.max);this.setPropertyValue("min",a.min);this.setPropertyValue("amount",a.amount);this.setPropertyValue("bAlert",
a.alert);this.setValue(a.value);if(a.unit){var b=this.unit.firstChild;b&&3===b.nodeType&&(b.nodeValue=a.unit)}var d=a.callback;"function"===typeof d?this.callback=d:"string"===typeof d&&d.trim().length&&(this.callback=eval(d));var c=a.onmouseup;"function"===typeof c?this.onmouseup=c:"string"===typeof c&&c.trim().length&&(this.onmouseup=eval(c));var f=a.onkeyup;"function"===typeof f?this.onkeyup=f:"string"===typeof f&&f.trim().length&&(this.onkeyup=eval(f));var e=a.onunitchange;"function"===typeof e?
this.onunitchange=e:"string"===typeof e&&e.trim().length&&(this.onunitchange=eval(e));return this}catch(g){dalert(g)}},setPropertyValue:function(a,b){"undefined"!==typeof b&&null!==b&&(this[a]=b)},getValue:function(){try{var a=this.input.value;""===a&&(a=0);return+parseFloat(a).toFixed(2)}catch(b){dalert(b)}},setValue:function(a){try{"undefined"!==typeof a&&null!==a&&(this.input.value=a)}catch(b){dalert(b)}},getUnit:function(){try{var a=this.unit.firstChild;return a&&3===a.nodeType?a.nodeValue:""}catch(b){dalert(b)}},
getAmount:function(){return this.amount},destroy:function(){try{this.clearTimer();for(var a=0,b=this.arrListener.length;a<b;a++){var d=this.arrListener[a];d&&EventUtil.removeHandler(d.elem,d.type,d.handler)}}catch(c){dalert(c)}},clearTimer:function(){try{this.timer1&&clearTimeout(this.timer1),this.timer2&&clearInterval(this.timer2),this.timer2=this.timer1=null}catch(a){dalert(a)}},enable:function(a){try{a?(this.container.removeAttribute("disabled"),this.input.removeAttribute("disabled"),this.btnUp.removeAttribute("disabled"),
this.btnDown.removeAttribute("disabled")):(this.container.setAttribute("disabled",""),this.input.setAttribute("disabled",""),this.btnUp.setAttribute("disabled",""),this.btnDown.setAttribute("disabled",""))}catch(b){dalert(b)}},addHandler:function(){try{var a=this,b=this.input,d=this.btnUp,c=this.btnDown,f=this.unitSelect,e=function(b,c,d){b&&(EventUtil.addHandler(b,c,d),a.arrListener.push({elem:b,type:c,handler:d}))};d.hasAttribute("onclick")&&d.removeAttribute("onclick");d.onclick=null;c.hasAttribute("onclick")&&
c.removeAttribute("onclick");c.onclick=null;b.hasAttribute("onblur")&&b.removeAttribute("onblur");b.onblur=null;e(d,"mousedown",function(c){1!=b.disabled&&(c?c:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&a.spinnUp()&&(a.timer1=setTimeout(function(){a.timer2=setInterval(function(){a.spinnUp()},70)},500))});e(d,"mouseup",function(c){if(1!=b.disabled&&(a.clearTimer(),a.onmouseup))a.onmouseup(a.getValue())});e(d,"mouseout",function(c){1!=b.disabled&&a.clearTimer()});e(d,"mouseover",function(c){1!=
b.disabled&&a.clearTimer()});e(c,"mousedown",function(c){1!=b.disabled&&(c?c:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&a.spinnDown()&&(a.timer1=setTimeout(function(){a.timer2=setInterval(function(){a.spinnDown()},70)},500))});e(c,"mouseup",function(c){if(1!=b.disabled&&(a.clearTimer(),a.onmouseup))a.onmouseup(a.getValue())});e(c,"mouseout",function(c){1!=b.disabled&&a.clearTimer()});e(c,"mouseover",function(c){1!=b.disabled&&a.clearTimer()});e(b,"blur",function(){a.spinnValCheck()});
e(b,"keydown",function(b){try{var c=b?b:window.event;if("undefined"==typeof c||null==c)dlog("IE8 -> Not Support");else switch(c.keyCode){case ID_KEYCODE_ARROW_TOP:a.spinnUp();TBCancelBubbleEvent(c);break;case ID_KEYCODE_ARROW_BOTTOM:a.spinnDown();TBCancelBubbleEvent(c);break;case ID_KEYCODE_ENTER:a.spinnValCheck()}}catch(k){dalert(k)}});e(b,"keyup",function(b){try{var c=b?b:window.event;if("undefined"!=typeof c&&null!=c){b=!1;switch(c.keyCode){case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_ENTER:b=
!0,TBCancelBubbleEvent(c)}if(isUndoKeyEvent(c)||isRedoKeyEvent(c))b=!0,a.spinnValCheck();if(b&&a.onkeyup)a.onkeyup(a.getValue())}}catch(k){dalert(k)}});e(f,"change",function(b){b="";var c=a.unit.firstChild;3!==c.nodeType&&(c=null);c&&(b=c.nodeValue);if(b!==this.value){if(a.onunitchange)a.onunitchange(this.value);c&&(c.nodeValue=this.value)}});return this}catch(g){dalert(g)}},spinnUp:function(){try{var a=this.input;if(1!=a.disabled){var b=this.max,d=this.min,c=this.input.value,f=""!==c?this.getValue():
d,e=""!==c?this.getAmount():0,g=this.callback,h=+parseFloat(f+e).toFixed(2);if(fnObjectCheckNull(b)||h<=b)return f=h,g&&g.call(this,f),dlog("DzeSpinner.spinUp"),this.saveCursor(),this.spinUpDownWhileDialogOpen(a),this.setValue(f),this.restoreCursor(),!0;this.clearTimer();g&&g.call(this,b);this.saveCursor();this.setValue(b);this.restoreCursor();!0===this.bAlert&&""!==c&&alert(ID_RES_DIALOG_ALERT_MAX_VALUE+b);return!1}}catch(k){dalert(k)}},spinnDown:function(){try{var a=this.input;if(1!=a.disabled){var b=
this.min,d=this.input.value,c=""!==d?this.getValue():b,f=""!==d?this.getAmount():0,e=this.callback,g=+parseFloat(c-f).toFixed(2);if(fnObjectCheckNull(b)||g>=b)return c=g,e&&e.call(this,c),this.saveCursor(),dlog("DzeSpinner.spinnDown"),this.spinUpDownWhileDialogOpen(a),this.setValue(c),this.restoreCursor(),!0;this.clearTimer();e&&e.call(this,b);this.saveCursor();this.setValue(b);this.restoreCursor();!0===this.bAlert&&""!==d&&alert(ID_RES_DIALOG_ALERT_MIN_VALUE+b);return!1}}catch(h){dalert(h)}},spinnValCheck:function(){try{var a=
this.input;if(""===a.value)return!0;var b=this.max,d=this.min,c=this.getValue(),f=this.callback;if(1!=checkNumber(c))return a.value="",alert(ID_RES_DIALOG_ALERT_NUMBER_ONLY),a.focus(),!1;if(c>b)return this.setValue(b),alert(ID_RES_DIALOG_ALERT_MAX_VALUE+b),a.select(),!1;if(c<d)return this.setValue(d),alert(ID_RES_DIALOG_ALERT_MIN_VALUE+d),a.select(),!1;if("function"===typeof this.onmouseup)this.onmouseup(c);else"function"==typeof f&&f.call(this,c);return!0}catch(e){dalert(e)}},spinUpDownWhileDialogOpen:function(a){if(0===
a.id.indexOf("dze_form_TB_IMAGE_HEIGHT_")||0===a.id.indexOf("dze_form_TB_IMAGE_WIDTH_")||0===a.id.indexOf("dze_form_TB_VIDEO_HEIGHT_")||0===a.id.indexOf("dze_form_TB_VIDEO_WIDTH_")){var b=g_objEditorDocument[duzon_dialog.nEditNumber].getElementById("dze_idx_ImageBorderColor_TargetElement");duzon_dialog.closeExtendsDlg();if(b){var d=null;if(0===a.id.indexOf("dze_form_TB_IMAGE_HEIGHT_")||0===a.id.indexOf("dze_form_TB_IMAGE_WIDTH_"))d=b;if(0===a.id.indexOf("dze_form_TB_VIDEO_HEIGHT_")||0===a.id.indexOf("dze_form_TB_VIDEO_WIDTH_"))d=
g_objVideoControl.getVideo(b);a=d.tagName.toLowerCase();setSelectionObjectInfo(!0,a,d,!1);(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(d,!0,!1,duzon_dialog.nEditNumber)}}},saveCursor:function(){this.input&&(this.selectionStart=this.input.selectionStart,this.selectionEnd=this.input.selectionEnd)},restoreCursor:function(){this.input&&this.input.setSelectionRange(this.selectionStart,this.selectionEnd)}};
var cmnCtrlBg={m_bUseScr:!0,m_scrID:"idx_duzon_backscreen",m_objScr:null,setObj:function(a){cmnCtrlBg.m_objScr=a},createBackScr:function(){try{var a=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,b=a.createElement("div");b.id=cmnCtrlBg.m_scrID;b.className="duzon_backscreen_transparent";a.body.appendChild(b);cmnCtrlBg.setObj(b);return b}catch(d){dalert(d)}},viewBackScr:function(a){try{if(!0===cmnCtrlBg.m_bUseScr){var b=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,
d=b.getElementById(cmnMsg.messageBoxId),c=b.getElementById(cmnCtrlBg.m_scrID);fnObjectCheckNull(c)&&(c=cmnCtrlBg.createBackScr());cmnCtrlBg.addBgScrEvt();c.onclick=function(){null==cmnDlg.m_objBtn&&cmnDlg.close()};if("object"===typeof a&&null!==a)try{var f=20028;if(g_bBrowserType_IE&&!fnObjectCheckNull(a.currentStyle))f=a.currentStyle.getAttribute("z-index");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)f=window.getComputedStyle(a,null).getPropertyValue("z-index");""!=f&&(c.style.zIndex=
parseInt(f,10)-1)}catch(e){c.style.zIndex=20028,dalert(e)}else c.style.zIndex=20028;c.style.display="block";d&&"none"!=d.style.display&&(c.className="duzon_backscreen");setTimeout(function(){var a=b.getElementById(cmnDlg.m_id_dlg);cmnDlg.setDlg(a)},1E3);cmnCtrlBg.resizeBackScr()}}catch(e){dalert(e)}},resizeBackScr:function(){try{if(!0===cmnCtrlBg.m_bUseScr){var a=oneffice.isLoadEditor(),b=a?g_objLayerKit.getLayerWindow():window,d=a?g_objLayerKit.getLayerDocument():document;d.getElementById(cmnCtrlBg.m_scrID);
if(!fnObjectCheckNull(cmnCtrlBg.m_objScr)&&"none"!=cmnCtrlBg.m_objScr.style.display){var c=a=0;cmnCtrlBg.m_objScr.style.width=a+"px";cmnCtrlBg.m_objScr.style.height=c+"px";d.documentElement.scrollWidth&&(a=d.documentElement.scrollWidth);d.documentElement.scrollHeight&&(c=d.documentElement.scrollHeight);b.innerHeight&&b.innerHeight>c&&(c=b.innerHeight);d.documentElement.clientHeight&&d.documentElement.clientHeight>c&&(c=d.documentElement.clientHeight);d.body.scrollWidth&&d.body.scrollWidth>a&&(a=d.body.scrollWidth);
d.body.scrollHeight&&d.body.scrollHeight>c&&(c=d.body.scrollHeight);cmnCtrlBg.m_objScr.style.width=a+"px";cmnCtrlBg.m_objScr.style.height=c+"px"}}}catch(f){dalert(f)}},closeBackScr:function(){try{if(!0===cmnCtrlBg.m_bUseScr){var a=(oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document).getElementById(cmnCtrlBg.m_scrID);fnObjectCheckNull(a)||(a.style.width="0px",a.style.height="0px",a.style.display="none",cmnCtrlBg.removeBgScrEvt())}}catch(b){dalert(b)}},addBgScrEvt:function(){try{var a=
oneffice.isLoadEditor()?g_objLayerKit.getLayerWindow():window;window.attachEvent?a.attachEvent("onresize",cmnCtrlBg.resizeBackScr):window.addEventListener&&a.addEventListener("resize",cmnCtrlBg.resizeBackScr,!1)}catch(b){dalert(b)}},removeBgScrEvt:function(){try{var a=oneffice.isLoadEditor()?g_objLayerKit.getLayerWindow():window;window.detachEvent?a.detachEvent("onresize",cmnCtrlBg.resizeBackScr):window.removeEventListener&&a.removeEventListener("resize",cmnCtrlBg.resizeBackScr,!1)}catch(b){dalert(b)}}},
cmnCtrlToast={idx_toast_msg:"idx_toast_msg",toastObj:null,toastTimer:null,showToastMsg:function(a,b,d,c,f,e){try{var g=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,h=dzeEnvConfig.strPath_Image+"dialog/icon-toast-info.png";cmnCtrlToast.toastObj||(cmnCtrlToast.toastObj=g.createElement("div"),cmnCtrlToast.toastObj.className="duzon_toastmsg_box",cmnCtrlToast.toastObj.style.display="none",cmnCtrlToast.toastObj.onmousedown=function(a){return!1},g.body.appendChild(cmnCtrlToast.toastObj));
e==TOAST_TYPE_OPTION_OK?(h=dzeEnvConfig.strPath_Image+"dialog/icon-toast-check.png",cmnCtrlToast.toastObj.className="duzon_toastmsg_box toast_ok"):e==TOAST_TYPE_OPTION_WARN?(h=dzeEnvConfig.strPath_Image+"dialog/icon-toast-warning.png",cmnCtrlToast.toastObj.className="duzon_toastmsg_box toast_warn"):e==TOAST_TYPE_OPTION_ERROR?(h=dzeEnvConfig.strPath_Image+"dialog/icon-toast-error.png",cmnCtrlToast.toastObj.className="duzon_toastmsg_box toast_error"):(h=dzeEnvConfig.strPath_Image+"dialog/icon-toast-info.png",
cmnCtrlToast.toastObj.className="duzon_toastmsg_box toast_info");cmnCtrlToast.toastTimer&&(clearTimeout(cmnCtrlToast.toastTimer),cmnCtrlToast.toastTimer=null);cmnCtrlToast.toastObj.innerHTML="<img src='"+h+"' style='width:21px; height:21px;'/>"+("<span style='padding-left:6px;'>"+b+"</span>");if("undefined"==typeof f||null==f)f=!0;!0===f?duzon_dialog.fade("in",cmnCtrlToast.toastObj,function(){cmnCtrlToast.toastTimer=setTimeout(function(){cmnCtrlToast.hideToastMsg();cmnCtrlToast.toastTimer=null},1E3*
d)}):cmnCtrlToast.toastTimer=setTimeout(function(){cmnCtrlToast.toastObj.style.display="none";cmnCtrlToast.toastTimer=null},1E3*d);null==a&&(a={});"undefined"==typeof c&&(c="center");!0===g_browserCHK.mobile&&(c="mobile");"mobile"==c&&!0!==(g_browserCHK.iPad||g_browserCHK.androidtablet)&&(cmnCtrlToast.toastObj.style.fontSize="18px",cmnCtrlToast.toastObj.style.transform="scale(2.0)");var k=cmnCtrlToast.toastObj.offsetheight/2;cmnCtrlToast.toastObj.style.marginLeft=-(cmnCtrlToast.toastObj.offsetWidth/
2)+"px";cmnCtrlToast.toastObj.style.marginTop=-k+"px"}catch(l){dalert(l)}},hideToastMsg:function(){try{null!=cmnCtrlToast.toastObj&&duzon_dialog.fade("out",cmnCtrlToast.toastObj,function(){cmnCtrlToast.toastObj.style.display="none"})}catch(a){dalert(a)}}};CUSTOM_ALERT&&objOnefficeLoader.getEditorMode()!=EDITORMODE.MOBILE_HOME&&(window.alert=function(a,b,d,c){cmnMsg.showMsg(b,a,d,null,c,null)});
var cmnMsg={messageBoxObj:null,messageBoxId:"idx_msg_box",showMsg:function(a,b,d,c,f,e,g){try{var h=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,k=dzeEnvConfig.strPath_Image;cmnMsg.messageBoxObj||(cmnMsg.messageBoxObj=h.createElement("div"),cmnMsg.messageBoxObj.id=cmnMsg.messageBoxId,cmnMsg.messageBoxObj.className="duzon_msg_box",cmnMsg.messageBoxObj.style.display="none",cmnMsg.messageBoxObj.onmousedown=function(a){return!1},h.body.appendChild(cmnMsg.messageBoxObj));"loadbind"==
a?(cmnMsg.messageBoxObj.style.backgroundColor="#E5EFF1",cmnMsg.messageBoxObj.style.paddingBottom="0px",cmnMsg.messageBoxObj.style.paddingTop="0px"):(cmnMsg.messageBoxObj.style.backgroundColor="#ffffff",cmnMsg.messageBoxObj.style.paddingBottom="20px",cmnMsg.messageBoxObj.style.paddingTop="30px");cmnMsg.messageBoxObj.style.borderRadius="15px";c=c?c:[ID_RES_DIALOG_BTN_OK];e||(e=function(){cmnMsg.hideMsg()});f||(f=function(){cmnMsg.hideMsg()});0==fnObjectCheckNull(g)&&1==g&&cmnMsg.messageBoxObj.setAttribute("stack",
getStackTrace());k=a==MESSAGE_CHECK?k+"dialog/icon-massage-check.png":a==MESSAGE_CONFIRM?k+"dialog/icon-massage-confirm.png":a==MESSAGE_ALERT?k+"dialog/icon-massage-warning.png":a==MESSAGE_ERROR?k+"dialog/icon-massage-alert.png":"loadbind"==a?k+"dialog/bind_loading.gif":k+"dialog/icon-massage-warning.png";var l=cmnDlg.createBtnBox(c.length,c,[f,e]);l.className="duzon_msg_buttonbox";f="<div style='text-align:center;'><img src='"+k+"'></div>";"loadbind"===a&&(f="<div style='text-align:center; margin-top: 10px;'><img width='120px' height='120px' src='"+
k+"'></div>");d?(f+="<div class='duzon_msg_box_title'>"+d+"</div>",f+="<div id='idx_duzon_msg_box' class='duzon_msg_box_title_msg'>"+b+"</div>"):"loadbind"===a?(f+="<div id='idx_duzon_msg_box' class='duzon_msg_box_message' style='min-height: 45px;'>"+b,f+="<br><span class='duzon_msg_box_sub_message' style='font-size: 10pt; position: relative; top: 5px;'></span>",f+="</div>"):f+="<div id='idx_duzon_msg_box' class='duzon_msg_box_message'>"+b+"</div>";cmnMsg.messageBoxObj.innerHTML=f;cmnMsg.messageBoxObj.appendChild(l);
duzon_dialog.fade("in",cmnMsg.messageBoxObj,function(){cmnCtrlBg.viewBackScr(cmnMsg.messageBoxObj)});var m=cmnMsg.messageBoxObj.offsetHeight/2;cmnMsg.messageBoxObj.style.marginLeft=-(cmnMsg.messageBoxObj.offsetWidth/2)+"px";cmnMsg.messageBoxObj.style.marginTop=-m+"px"}catch(n){dalert(n)}},hideMsg:function(a,b){try{null!=cmnMsg.messageBoxObj&&(a||cmnCtrlBg.closeBackScr(),!1===b?cmnMsg.messageBoxObj.style.display="none":duzon_dialog.fade("out",cmnMsg.messageBoxObj,function(){cmnMsg.messageBoxObj.style.display=
"none"}))}catch(d){dalert(d)}},isShowMsg:function(){return cmnMsg.messageBoxObj&&"none"!==cmnMsg.messageBoxObj.style.display?!0:!1},showMsgArray:function(a,b,d){try{if(b&&b.length){var c=function(){if(0<b.length){var f=b.shift();cmnMsg.showMsg(a,f,d,null,function(){cmnMsg.hideMsg(!1,!1);c()},null)}};c()}}catch(f){dalert(f)}}},cmnDlg={m_id_dlg:"idx_dlg",m_tabType:!1,m_dialogStatus:!1,m_keyCode:"",m_objBody:{},m_objBtn:null,m_Dlg:null,m_nScrollX:0,m_nScrollY:0,m_nClkX:0,m_nY:0,m_unLoadCB:function(){},
m_closeDlgTimer:null,setTabType:function(a){"undefined"==typeof a&&(a=!1);cmnDlg.m_tabType=a},getTabType:function(){return cmnDlg.m_tabType},setDlg:function(a){cmnDlg.m_Dlg=a},getDlg:function(a){return cmnDlg.m_Dlg},isShowDlg:function(){return cmnDlg.m_dialogStatus},setShowDlg:function(a){cmnDlg.m_dialogStatus=a},getDlgTimer:function(){return cmnDlg.m_closeDlgTimer},setDlgTimer:function(a){cmnDlg.m_closeDlgTimer=a},releaseTimer:function(){cmnDlg.closeDlgTimer&&(clearTimeout(cmnDlg.closeDlgTimer),
cmnDlg.setDlgTimer(null))},initPosition:function(){var a=document.body.offsetHeight,b=dzeJ(cmnDlg.m_Dlg).height(),d=document.body.offsetWidth,c=dzeJ(cmnDlg.m_Dlg).width();dzeJ(cmnDlg.m_Dlg).css({top:(a-b)/2,left:(d-c)/2})},create:function(a,b,d,c,f,e,g){try{var h=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,k=cmnDlg.getDlg();k&&(h.body.removeChild(k),cmnDlg.setDlg(null),cmnDlg.releaseTimer(),k=null);var l=h.createElement("div");l.className="duzon_dialog";l.id=cmnDlg.m_id_dlg;
l.style.top="0";l.style.left="0";!0===g&&(l.style.display="none");if(""!=b){var m=cmnDlg.createTitle(b);l.appendChild(m)}cmnDlg.m_objBody=cmnDlg.createBody(d);l.appendChild(cmnDlg.m_objBody);this.wrapOkBtnFunc(f,e);0<c&&(cmnDlg.m_objBtn=cmnDlg.createBtnBox(c,f,e),l.appendChild(cmnDlg.m_objBtn));dzeJ(l).draggable({distance:15,handle:"div.duzon_dialog_title_container",containment:"parent",start:function(a,b){dzeJ(this).css("opacity",.5)},stop:function(a,b){dzeJ(this).css("opacity","")}}).css("position",
"");h.body.appendChild(l);cmnDlg.setDlg(l);return l}catch(n){dalert(n)}},closeClickEvent:function(){try{var a=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,b=dzeJ(this).parents(".duzon_dialog");if(0!==b.length&&"idx_dlg"!==b.attr("id"))a.body.removeChild(b[0]),0===[].slice.call(document.querySelectorAll(".duzon_dialog")).length&&cmnCtrlBg.closeBackScr();else{var d=document.querySelector("#idx_onefficeChartTableDiv");!1===fnObjectCheckNull(d)&&a.body.removeChild(d);var c=document.querySelector("#id_news_chart_image_info");
!1===fnObjectCheckNull(c)&&a.body.removeChild(c);cmnDlg.close()}}catch(f){dalert(f)}},createTitle:function(a,b){try{!0===fnObjectCheckNull(b)&&(b=0);var d=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,c=d.createElement("table");c.setAttribute("width","100%");c.setAttribute("height","100%");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");var f=c.insertRow(),e=f.insertCell();e.setAttribute("width",14);e=f.insertCell();e.className=
"duzon_dialog_title";e.innerHTML=a;if(0!==b){e=f.insertCell();e.setAttribute("width",28);var g=d.createElement("div");g.className="toolTipDiv";var h=d.createElement("img");h.src=dzeEnvConfig.strPath_Image+"dialog/btn-tip-click.png";h.width=16;h.height=16;h.style.verticalAlign="middle";h.style.cursor="default";g.appendChild(h);var k=d.createElement("span");k.className="toolTip-text";1===b?k.innerHTML="<b>TIP</b><br><br>MS Office Excel\uc5d0\uc11c<br>\ub370\uc774\ud130\ub97c \ubcf5\uc0ac\ud558\uc5ec \ubd99\uc5ec \ub123\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.<br>\ub2e8, \uc218\uc2dd\uc740 \ubcf5\uc0ac\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.":
2===b&&(k.innerHTML="<b>TIP</b><br><br>Business Watch \uc11c\ubc84\uc5d0<br>\uc774\ubbf8\uc9c0 \uc5c5\ub85c\ub4dc \uc2dc \ud544\uc694\ud55c \ud544\uc218 \uc815\ubcf4 \uc785\ub2c8\ub2e4.");g.appendChild(k);e.appendChild(g)}e=f.insertCell();e.setAttribute("width",14);h=d.createElement("img");h.id=b?"idx_chart_data_close_btn":"idx_duzon_dialog_close_btn";h.src=dzeEnvConfig.strPath_Image+"dialog/btn-pop-close_nomal.png";h.width=14;h.height=14;h.title=ID_RES_ADJUST_VIEW_CLOSE;h.style.verticalAlign="middle";
h.style.cursor="pointer";h.addEventListener("click",this.closeClickEvent);!0===g_browserCHK.mobile&&h.addEventListener("mouseup",this.closeClickEvent);h.onmouseover=function(){this.src=dzeEnvConfig.strPath_Image+"dialog/btn-pop-close_over.png"};h.onmousedown=function(){this.src=dzeEnvConfig.strPath_Image+"dialog/btn-pop-close_click.png";TBCancelBubbleEvent(event)};h.onmouseout=function(){this.src=dzeEnvConfig.strPath_Image+"dialog/btn-pop-close_nomal.png"};e.appendChild(h);e=f.insertCell();e.setAttribute("width",
14);var l=d.createElement("div");l.className="duzon_dialog_title_container";l.appendChild(c);return l}catch(m){dalert(m)}},createBody:function(a){try{var b=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,d=b.createElement("div");d.className="duzon_dialog_body";var c=b.createElement("div");"object"==typeof a?c.appendChild(a):"string"==typeof a&&(c.innerHTML=a);1!=cmnDlg.getTabType()&&(c.className="duzon_dialog_body_content");cmnDlg.setTabType(!1);d.appendChild(c);return d}catch(f){dalert(f)}},
createBtnBox:function(a,b,d){try{var c=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,f=c.createElement("div");f.className="duzon_dialog_buttonbox";for(var e={},g=0;g<a;g++)e={},e=c.createElement("input"),e.type="button",e.value=b[g],function(){var a=d[g],b=g;e.onclick=function(b){a(b?b:window.event)};var c="duzon_dialog_btn_normal",f="duzon_dialog_btn_up",n="duzon_dialog_btn_down";0==b&&(c="duzon_dialog_btn_ok_normal",f="duzon_dialog_btn_ok_up",n="duzon_dialog_btn_ok_down");e.className=
c;e.onmouseover=function(){this.className=f};e.onmouseout=function(){this.className=c};e.onmousedown=function(a){this.className=n;TBCancelBubbleEvent(a);return!1};e.onmouseup=function(){this.className=f}}(),f.appendChild(e);return f}catch(h){dalert(h)}},setBtnStyle:function(){try{for(var a=cmnDlg.getDlg().getElementsByTagName("*"),b="",d="",c=0;c<a.length;c++)if(b=a[c].nodeName.toLowerCase(),d=a[c].getAttribute("type"),""==a[c].className&&("input"==b||"select"==b)){if("submit"==d||"button"==d)a[c].className=
"duzon_dialog_btn_normal",a[c].onmouseover=function(){this.className="duzon_dialog_btn_up"},a[c].onmouseout=function(){this.className="duzon_dialog_btn_normal"},a[c].onmousedown=function(){this.className="duzon_dialog_btn_down"},a[c].onmouseup=function(){this.className="duzon_dialog_btn_up"};"select"==b&&(a[c].className="duzon_dialog_body_selectform")}}catch(f){dalert(f)}},viewBasicDlg:function(a,b,d,c,f,e,g,h,k,l){try{var m=oneffice.isLoadEditor();dlog("viewBasicDlg nEditNumber : "+b);cmnDlg.setShowDlg(!0);
var n=cmnDlg.getDlg();m&&(duzon_dialog.setObjLayer(),duzon_dialog.nEditNumber=b);g_nActiveEditNumber=b;cmnCtrlBg.viewBackScr(n);n=cmnDlg.create(a,d,c,f.length,f,e,l);l||duzon_dialog.fade("in",n);cmnCtrlBg.m_objScr.className=null==cmnDlg.m_objBtn?"duzon_backscreen_transparent":"duzon_backscreen";cmnDlg.setBtnStyle();cmnDlg.setBtnFocus(k);cmnDlg.addDlgEvt();"undefined"!=typeof g&&g();cmnDlg.m_unLoadCB="undefined"!=typeof h?h:function(){};"undefined"!==typeof g_objPositionUtil&&g_objPositionUtil.setObjectPosition(a,
n,"screen_center");cmnCtrlBg.resizeBackScr()}catch(p){dalert(p)}},setBtnFocus:function(a){try{"undefined"==typeof a&&(a=!0),setTimeout(function(){var b=cmnDlg.getDlg();if(b){b=b.querySelectorAll("input, select, textarea");for(var d=1,c=!1,f=b.length,e=0;e<f;e++)b[e].tabIndex=d,1==a&&0==c&&0==b[e].disabled&&(b[e].focus(),c=!0),b[e].onkeydown=function(a){9===a.keyCode&&(a.shiftKey||this.tabIndex!==f?a.shiftKey&&1===this.tabIndex&&a.preventDefault():a.preventDefault())},d++}},100)}catch(b){dalert(b)}},
wrapOkBtnFunc:function(a,b){try{if(a&&b)for(var d=0,c=a.length;d<c;d++)if(a[d]===ID_RES_DIALOG_BTN_OK){(function(){var a=b[d];b[d]=function(b){b=b?b:window.event;var c=b.target||b.srcElement;(c=(c=c?c.ownerDocument:null)?c.activeElement:null)&&"INPUT"===c.nodeName&&g_objPropertyUtil.hasClass(c,"duzon_spinner_input_form")&&!1===DzeSpinner.getSpinner(c.id).spinnValCheck()||a(b)}})();break}}catch(f){dalert(f)}},close:function(){try{if(!cmnDlg.isShowDlg())return!1;var a=cmnDlg.getDlg();if(null==a)return cmnDlg.setShowDlg(!1),
!1;var b=duzon_dialog.nEditNumber;dzeJ(".dze_panel_doc_user_request_btn.select").removeClass("select");var d=oneffice.isLoadEditor();unselectEditorParentBody();var c=[].slice.call(document.querySelectorAll(".duzon_dialog"));0>c.indexOf(a)&&c.push(a);for(var f=c.length,e=0;e<c.length;e++)duzon_dialog.fade("out",c[e],function(){f--;if(0>=f){try{for(var a=0;a<c.length;a++)c[a]&&c[a].parentNode&&c[a].parentNode.removeChild(c[a])}catch(h){}cmnDlg.setDlg(null);cmnDlg.setDlgTimer(null);cmnDlg.m_objBtn=null;
cmnDlg.setShowDlg(!1)}});DzeSpinner.closeDialog();cmnCtrlBg.closeBackScr();cmnDlg.removeDlgEvt();cmnDlg.m_unLoadCB&&cmnDlg.m_unLoadCB(a);cmnDlg.m_unLoadCB=function(){};if(d){if(duzon_dialog.resetSelection&&g_bBrowserType_IE){1==duzon_dialog.isFindDialog&&duzon_dialog.setEditorFocus();return}duzon_dialog.setEditorSelection();duzon_dialog.setEditorFocus();editor_onselectionchange(b);GetMultiCellSelection(b)&&updateTableHandlerUI.updateTableUIHandler(b)}return!0}catch(g){dalert(g)}},getDlgLayerPos:function(a){var b=
{scrollX:0,scrollY:0,mousedownX:0,mousedownY:0,top:0,right:0,bottom:0,left:0,width:0,height:0};try{"undefined"!=typeof a&&null!=a&&(document.documentElement.scrollLeft?(b.scrollX=document.documentElement.scrollLeft,b.mousedownX=document.documentElement.scrollLeft+a.clientX):(b.scrollX=document.body.scrollLeft,b.mousedownX=document.body.scrollLeft+a.clientX),document.documentElement.scrollTop?(b.scrollY=document.documentElement.scrollTop,b.mousedownY=document.documentElement.scrollTop+a.clientY):(b.scrollY=
document.body.scrollTop,b.mousedownY=document.body.scrollTop+a.clientY));var d=cmnDlg.getDlg();d&&"none"!=d.style.display&&(b.top=parseInt(d.style.top.replace(/px/,""),10),b.left=parseInt(d.style.left.replace(/px/,""),10),b.width=d.offsetWidth,b.height=d.offsetHeight,b.right=b.left+b.width,b.bottom=b.top+b.height);return b}catch(c){return dalert(c),b}},evtKeyCode:function(a){try{var b=a?a:window.event;cmnDlg.m_keyCode=b.keyCode;dlog("keycode :"+cmnDlg.m_keyCode);a=null;b&&(a=b.target||b.srcElement);
if(cmnDlg.m_keyCode==ID_KEYCODE_ESCAPE){if(null==cmnMsg.messageBoxObj||"none"==cmnMsg.messageBoxObj.style.display){var d=cmnDlg.m_objBody.firstChild.firstChild;if((!1!==fnObjectCheckNull(d)||!1!==fnObjectCheckNull(d.classList)||!0!==d.classList.contains("cloud_user_agree_dialog_container")&&!0!==d.classList.contains("dze_doc_form_report_type_box"))&&!0===cmnDlg.close())return!1}}else 65===cmnDlg.m_keyCode&&DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)&&a&&"BODY"===a.nodeName&&TBCancelBubbleEvent(b)}catch(c){dalert(c)}},
addDlgEvt:function(){try{var a=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document;window.attachEvent?a.attachEvent("onkeydown",cmnDlg.evtKeyCode):window.addEventListener&&a.addEventListener("keydown",cmnDlg.evtKeyCode,!1);if("undefined"!=typeof g_arrEditorAreaContainer)for(var b in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[b].attachEvent("onkeydown",cmnDlg.evtKeyCode):g_objEditorDocument[b].addEventListener("keydown",cmnDlg.evtKeyCode,!1)}catch(d){dalert(d)}},
removeDlgEvt:function(){try{var a=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document;window.detachEvent?a.detachEvent("onkeydown",cmnDlg.evtKeyCode):window.removeEventListener&&a.removeEventListener("keydown",cmnDlg.evtKeyCode,!1);if("undefined"!=typeof g_arrEditorAreaContainer)for(var b in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[b].detachEvent("onkeydown",cmnDlg.evtKeyCode):g_objEditorDocument[b].removeEventListener("keydown",cmnDlg.evtKeyCode,!1)}catch(d){dalert(d)}}},
dzeBtnDlg={m_nInsType:DZE_INSERT_SPECIALCHAR,m_insTypeInfo:[{},{}],m_nLeftSizeType:68,m_topInsTypeContentDiv:null,m_leftInsTypeContentDiv:null,m_rightInsTypeContentDiv:null,m_dze_idx_recent_data_area:"dze_idx_recent_data_area",m_dze_idx_instype_recent_btn_pre:"",m_dze_idx_instype_recent_btn_next:"",setInsType:function(a){this.m_nInsType=a},getInsType:function(a){return dzeBtnDlg.m_nInsType},setLeftSizeType:function(a){this.m_nLeftSizeType=a},getLeftSizeType:function(a){return dzeBtnDlg.m_nLeftSizeType},
makeInsTypeInfo:function(){try{this.m_insTypeInfo[DZE_INSERT_SPECIALCHAR]={strInsType:"specialchars",strLTitle:ID_RES_DIALOG_STRING_CHARACTER_AREA,strRTitle:ID_RES_DIALOG_STRING_CHARACTER_SELECT,strRecentTitle:ID_RES_DIALOG_STRING_RECECT_USE_CHARACTER,jsSrc:"const/insert_specialchars_const.js",refInfoDB:"dzeSpecialchars"},this.m_insTypeInfo[DZE_INSERT_EMOTICON]={strInsType:"emoticons",strLTitle:ID_RES_DIALOG_STRING_CATEGORY_AREA,strRTitle:ID_RES_DIALOG_STRING_EMOTICON_SELECT,strRecentTitle:ID_RES_DIALOG_STRING_RECECT_USE_EMOTICONS,
jsSrc:"const/insert_emoticons_const.js",refInfoDB:"dzeEmoticons"}}catch(a){}},getInsertTypeContent:function(){try{var a=this.m_insTypeInfo[this.m_nInsType].strInsType;this.m_dze_idx_instype_recent_btn_pre="dze_idx_"+a+"_recent_btn_pre";this.m_dze_idx_instype_recent_btn_next="dze_idx_"+a+"_recent_btn_next";var b=document.createElement("div");b.className="duzon_dialog_content_medium";var d=null;if(this.m_nInsType!=DZE_INSERT_EMOTICON){d=document.createElement("div");d.className="dze_"+a+"_left_container";
var c=document.createElement("div");c.className="dze_dlg_left_title";c.innerHTML=this.m_insTypeInfo[this.m_nInsType].strLTitle+":";this.m_leftInsTypeContentDiv=document.createElement("div");this.m_leftInsTypeContentDiv.className="dze_"+a+"_left_content";d.appendChild(c);d.appendChild(this.m_leftInsTypeContentDiv);this.m_nInsType==DZE_INSERT_EMOTICON&&this.addEmoticonSizeCtrl(a,d)}else if(this.m_nInsType==DZE_INSERT_EMOTICON){d=document.createElement("div");d.className="dze_"+a+"_top_container";var f=
document.createElement("div");f.className="dze_dlg_top_title";f.innerHTML=ID_RES_CONST_STRING_INSERT_EMOTICONS+" "+ID_RES_DIALOG_STRING_CATEGORY_AREA+":";this.m_topInsTypeContentDiv=document.createElement("div");this.m_topInsTypeContentDiv.className="dze_"+a+"_top_content";d.appendChild(f);d.appendChild(this.m_topInsTypeContentDiv)}var e=document.createElement("div");e.className="dze_"+a+"_right_container";var g=document.createElement("div");g.className="dze_dlg_right_title";g.innerHTML=this.m_insTypeInfo[this.m_nInsType].strRTitle+
":";this.m_rightInsTypeContentDiv=document.createElement("div");this.m_rightInsTypeContentDiv.className="dze_"+a+"_right_content";var h=document.createElement("div");h.className="dze_dlg_recent_title";h.innerHTML=this.m_insTypeInfo[this.m_nInsType].strRecentTitle+":";var k=document.createElement("div");k.className="dze_"+a+"_recent_content";c="<table width='100%' height='36' cellspacing='0' cellpadding='0' border='0'>";c+="<tr>";c+="<td width='12'><div class='dze_"+a+"_recent_btn_pre' id='"+this.m_dze_idx_instype_recent_btn_pre+
"'></div></td>";c+="<td><div class='dze_"+a+"_recent_data_container'><div class='dze_"+a+"_recent_data_area' id='"+this.m_dze_idx_recent_data_area+"'></div></div></td>";c+="<td width='12'><div class='dze_"+a+"_recent_btn_next' id='"+this.m_dze_idx_instype_recent_btn_next+"'></div></td>";k.innerHTML=c+"</tr><table>";e.appendChild(g);e.appendChild(this.m_rightInsTypeContentDiv);this.m_nInsType==DZE_INSERT_SPECIALCHAR&&(e.appendChild(h),e.appendChild(k));d&&b.appendChild(d);b.appendChild(e);this.m_nInsType==
DZE_INSERT_EMOTICON&&(b.appendChild(h),b.appendChild(k));return b}catch(l){dalert(l)}},insertTypeContent:function(a){try{if(g_objCommonUtil.IS_VALID_VALUE(a))return dlog("insertTypeContent innerHTML : "+a),duzon_dialog.closeExtendsDlg(),fnAddHTMLContent(a,null,0,duzon_dialog.nEditNumber),!0;var b=objRecentUtil.curCategoryItem[this.m_nInsType];dlog("insertTypeContent this.curCategoryItem : "+b);if(""==b)return alert(ID_RES_DIALOG_ALERT_SELECT_CHARACTER),!1;if(!g_objCommonUtil.IS_VALID_VALUE(b))return!1;
var d=duzon_dialog.nEditNumber;a=b;this.m_nInsType==DZE_INSERT_EMOTICON&&(a=b);var c=null,f=(c=g_bBrowserType_IE&&cmnDlg.isShowDlg()?g_objLastRange[d]:GetCurRange(d))?c.startContainer.childNodes[c.startOffset]||c.startContainer:null;if(g_objNodeUtil.isTextArea(f)){var e=f.selectionStart,g=f.value,h=g.substring(0,e),k=g.substring(e,g.length);f.value=h+b+k;f.focus({preventScroll:!0});f.setSelectionRange(e+1,e+1)}else g_objTableFlag.ResetTableInfo(),fnAddHTMLContent(a,null,0,duzon_dialog.nEditNumber),
duzon_dialog.setEditorSelection(),duzon_dialog.setEditorFocus(),editor_onselectionchange(duzon_dialog.nEditNumber);objRecentUtil.setRecentItemList(b);return!0}catch(l){dalert(l)}},dynamicScriptCallParamFunc:function(){try{var a=duzon_dialog.getBtnDlg(),b=a.m_nInsType,d=null,c=a.m_insTypeInfo[b].strInsType,f=eval(a.m_insTypeInfo[b].refInfoDB),e=f.length;b==DZE_INSERT_EMOTICON&&a.m_topInsTypeContentDiv&&a.addEmoticonTitleCtrl(c,a.m_topInsTypeContentDiv);for(var g=0;g<e;g++)d=null,d=g_objLayerKit.getLayerDocument().createElement("div"),
d.className="dze_dlg_left_content_unit",d.innerHTML=f[g].name,function(){var b=g;d.onclick=function(){a.selectCategoryItemList(b,f)}}(),a.m_leftInsTypeContentDiv&&a.m_leftInsTypeContentDiv.appendChild(d),a.selectCategoryItemList(objRecentUtil.curCategoryIdx[b],f);objRecentUtil.getRecentItemList();objRecentUtil.printRecentItem(0,objRecentUtil.recentItemList[b].length-1);dlog("objRecentUtil.curCategoryItem:"+objRecentUtil.curCategoryItem[b]);var h=a.selectCategoryItem(objRecentUtil.curCategoryItem[b]);
g_objLayerKit.getElementById(a.m_dze_idx_instype_recent_btn_pre).onclick=function(){objRecentUtil.prevRecentItem()};g_objLayerKit.getElementById(a.m_dze_idx_instype_recent_btn_next).onclick=function(){objRecentUtil.nextRecentItem()};var k=23*objRecentUtil.curCategoryIdx[b];a.m_leftInsTypeContentDiv&&3<objRecentUtil.curCategoryIdx[b]&&(a.m_leftInsTypeContentDiv.scrollTop=k-57);if("undefined"!=typeof h&&null!=h&&8<h){var l=Math.floor(h/9);2<l&&(a.m_rightInsTypeContentDiv.scrollTop=3+32*l-40)}}catch(m){dalert(m)}},
loadInsertTypeContent:function(){try{dynamicScriptCall("js/"+this.m_insTypeInfo[this.m_nInsType].jsSrc,this.dynamicScriptCallParamFunc)}catch(a){dalert(a)}},addEmoticonTitleCtrl:function(a,b){try{for(var d=duzon_dialog.getBtnDlg(),c=eval(this.m_insTypeInfo[this.m_nInsType].refInfoDB),f=0;f<c.length;f++){var e=null;e=g_objLayerKit.getLayerDocument().createElement("div");e.className="dze_dlg_top_content_unit";e.innerHTML=objEmoUtil.makeEmoticonItemHTML(f,0,c,64,!0);0==f&&(e.style.background="#d9d9d9");
(function(){var a=f;e.onclick=function(){d.selectCategoryItemList(a,c)}})();b.appendChild(e)}}catch(g){dalert(g)}},addEmoticonSizeCtrl:function(a,b){try{var d=duzon_dialog.getBtnDlg(),c=document.createElement("div");c.className="dze_dlg_left_title";c.innerHTML=ID_RES_DIALOG_STRING_SIZE+":";var f=document.createElement("div");f.className="dze_"+a+"_left_content";for(a=0;3>a;a++){var e=null;e=g_objLayerKit.getLayerDocument().createElement("div");e.className="dze_dlg_left_content_unit";e.innerHTML=objEmoUtil.getEmoticonSize(a);
(function(){var a=e.innerText;e.onclick=function(){d.setLeftSizeType(a);d.updateListBoxCtrl(f)}})();f.appendChild(e)}d.updateListBoxCtrl(f);d.setLeftSizeType(68);b.appendChild(c);b.appendChild(f)}catch(g){dalert(g)}},selectCategoryItemList:function(a,b){try{var d=duzon_dialog.getBtnDlg();this.m_rightInsTypeContentDiv.innerHTML="";for(var c=null,f=b[a].content.length,e=d.m_insTypeInfo[d.m_nInsType].strInsType,g=0;g<f;g++){c=null;c=document.createElement("div");c.className="dze_"+e+"_right_content_unit";
switch(this.m_nInsType){case DZE_INSERT_SPECIALCHAR:c.innerHTML=b[a].content[g];break;case DZE_INSERT_EMOTICON:c.innerHTML=objEmoUtil.makeEmoticonItemHTML(a,g,b,68,!1)}(function(){c.onclick=function(){d.selectCategoryItem(this.innerHTML)};c.ondblclick=function(){d.selectCategoryItem(this.innerHTML);d.insertTypeContent(null)&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}})();d.m_rightInsTypeContentDiv.appendChild(c);objRecentUtil.curCategoryItem[this.m_nInsType]==c.innerHTML&&this.selectCategoryItem(objRecentUtil.curCategoryItem[this.m_nInsType])}b=
null;this.m_leftInsTypeContentDiv?b=this.m_leftInsTypeContentDiv:this.m_topInsTypeContentDiv&&(b=this.m_topInsTypeContentDiv);if(b){var h=b.getElementsByTagName("div");for(g=0;g<h.length;g++)g==a?this.m_leftInsTypeContentDiv?h[g].className="dze_dlg_left_content_unit_select":h[g].style.backgroundColor="#dedede":this.m_leftInsTypeContentDiv?h[g].className="dze_dlg_left_content_unit":h[g].style.backgroundColor="#FFFFFF"}objRecentUtil.curCategoryIdx[this.m_nInsType]=a;this.m_rightInsTypeContentDiv.scrollTop=
0}catch(k){dalert(k)}},selectCategoryItem:function(a){try{if(""!=a){dlog("selectCategoryItem strInnerHTML:"+a);var b=0,d=this.m_insTypeInfo[this.m_nInsType].strInsType;objRecentUtil.curCategoryItem[this.m_nInsType]=a;rightContentList=this.m_rightInsTypeContentDiv.getElementsByTagName("div");for(var c=0;c<rightContentList.length;c++)rightContentList[c].innerHTML==a?(rightContentList[c].className="dze_"+d+"_right_content_unit_down",b=c):rightContentList[c].className="dze_"+d+"_right_content_unit";rightRecentContentList=
g_objLayerKit.getElementById(this.m_dze_idx_recent_data_area).getElementsByTagName("div");for(c=0;c<rightRecentContentList.length;c++)"dze_dlg_right_content_unit_separator"!=rightRecentContentList[c].className&&(rightRecentContentList[c].className=rightRecentContentList[c].innerHTML==a?"dze_"+d+"_right_content_unit_down":"dze_"+d+"_right_content_unit");return b}}catch(f){return dalert(f),0}},updateListBoxCtrl:function(a){try{for(var b=duzon_dialog.getBtnDlg(),d=0;3>d;d++)objEmoUtil.getEmoticonSize(d)==
b.getLeftSizeType()?a.childNodes[d].className="dze_dlg_left_content_unit_select":a.childNodes[d].className="dze_dlg_left_content_unit"}catch(c){dalert(c)}}},objRecentUtil={curCategoryIdx:[0,0],curCategoryItem:[{},{}],recentItemList:[{},{}],recentItemListMaxViewCnt:[9,5],recentItemListCurViewIdx:[0,0],recentItemListMaxCnt:[30,30],getRecentItemList:function(){try{var a=duzon_dialog.getBtnDlg().getInsType();if("undefined"!=typeof localStorage)try{0==a&&localStorage.getItem("dzeSpecialCharsRecentList")?
this.recentItemList[a]=localStorage.getItem("dzeSpecialCharsRecentList").split(","):1==a&&localStorage.getItem("dzeEmoticonsRecentList")&&(this.recentItemList[a]=localStorage.getItem("dzeEmoticonsRecentList").split(","))}catch(b){dalert("getRecentItemList localStorage error"),this.recentItemList[a]=[]}return this.recentItemList[a]}catch(b){dalert("objRecentUtil.getRecentItemList")}},setRecentItemList:function(a){try{for(var b=duzon_dialog.getBtnDlg(),d=b.getInsType(),c=[],f=0;f<this.recentItemList[d].length;f++)this.recentItemList[d][f]!=
a&&c.push(this.recentItemList[d][f]);c.unshift(a);c=duzon_dialog.getMaxArrayList(c,this.recentItemListMaxCnt[d]);this.recentItemList[b.m_nInsType]=c;if("undefined"!=typeof localStorage)try{0==d?localStorage.setItem("dzeSpecialCharsRecentList",c.join(",")):1==d&&localStorage.setItem("dzeEmoticonsRecentList",c.join(","))}catch(e){dalert("setRecentItemList localStorage error")}objRecentUtil.printRecentItem(0,objRecentUtil.recentItemList[d].length-1);this.setRecentItemBtns()}catch(e){dalert(e)}},setRecentItemBtns:function(){try{var a=
duzon_dialog.getBtnDlg(),b=a.getInsType();dlog(":::setRecentItemBtns::: recentItemListCurViewIdx: "+this.recentItemListCurViewIdx[b]);dlog(":::setRecentItemBtns::: recentItemListMaxViewCnt: "+this.recentItemListMaxViewCnt[b]);this.recentItemListCurViewIdx[b]+1>this.recentItemListMaxViewCnt[b]?($_(a.m_dze_idx_instype_recent_btn_pre).style.opacity="",$_(a.m_dze_idx_instype_recent_btn_pre).style.cursor="pointer"):($_(a.m_dze_idx_instype_recent_btn_pre).style.opacity="0.3",$_(a.m_dze_idx_instype_recent_btn_pre).style.cursor=
"default");this.recentItemListCurViewIdx[b]+this.recentItemListMaxViewCnt[b]<this.recentItemList[b].length?($_(a.m_dze_idx_instype_recent_btn_next).style.opacity="",$_(a.m_dze_idx_instype_recent_btn_next).style.cursor="pointer"):($_(a.m_dze_idx_instype_recent_btn_next).style.opacity="0.3",$_(a.m_dze_idx_instype_recent_btn_next).style.cursor="default")}catch(d){dalert(d)}},prevRecentItem:function(){try{var a=duzon_dialog.getBtnDlg(),b=a.getInsType();if(this.recentItemListCurViewIdx[b]+1>this.recentItemListMaxViewCnt[b]){var d=
this.recentItemListCurViewIdx[b]-this.recentItemListMaxViewCnt[b];this.printRecentItem(d,d+this.recentItemListMaxViewCnt[b]-1);this.setRecentItemBtns();$_(a.m_dze_idx_recent_data_area).style.marginLeft=""}}catch(c){dalert(c)}},nextRecentItem:function(){try{var a=duzon_dialog.getBtnDlg(),b=a.getInsType();if(this.recentItemListCurViewIdx[b]+this.recentItemListMaxViewCnt[b]<this.recentItemList[b].length){var d=this.recentItemListCurViewIdx[b]+this.recentItemListMaxViewCnt[b];this.printRecentItem(d,d+
this.recentItemListMaxViewCnt[b]-1);this.setRecentItemBtns();$_(a.m_dze_idx_recent_data_area).style.marginLeft="-5px"}}catch(c){dalert(c)}},printRecentItem:function(a,b){try{var d=duzon_dialog.getBtnDlg(),c=d.getInsType(),f=d.m_insTypeInfo[c].strInsType;dlog("printRecentItem firstCharNo : "+a+", lastCharNo:"+b+", strInsType : "+f);objRecentUtil.emptyRecentListBox();for(var e=null,g=a;g<=b;g++){dlog("i:"+this.recentItemList[c][g]);if("undefined"==typeof this.recentItemList[c][g]||null==this.recentItemList[c][g]||
""==this.recentItemList[c][g])break;dlog("i2:"+this.recentItemList[c][g]);e=document.createElement("div");e.className="dze_"+f+"_right_content_unit";e.innerHTML=this.recentItemList[c][g];(function(){var a=objRecentUtil.recentItemList[c][g];e.onclick=function(){d.selectCategoryItem(a)};e.ondblclick=function(){d.selectCategoryItem(a);d.insertTypeContent(null)&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}})();$_(d.m_dze_idx_recent_data_area).appendChild(e);this.recentItemListCurViewIdx[c]=
a}this.setRecentItemBtns();0<a?$_(d.m_dze_idx_recent_data_area).style.marginLeft="-5px":c||this.recentItemListCurViewIdx[c]+1!=this.recentItemListMaxViewCnt[c]?$_(d.m_dze_idx_recent_data_area).style.marginLeft="":$_(d.m_dze_idx_recent_data_area).style.marginLeft="-5px"}catch(h){dalert(h)}},emptyRecentListBox:function(){try{for(var a=0,b=duzon_dialog.getBtnDlg();$_(b.m_dze_idx_recent_data_area).childNodes.length;)$_(b.m_dze_idx_recent_data_area).removeChild($_(b.m_dze_idx_recent_data_area).childNodes[0]),
a++,dlog("emptyRecentListBox cnt:"+a)}catch(d){dalert(d)}}},objEmoUtil={getEmoticonSize:function(a){switch(a){case 0:return 28;default:case 1:return 68;case 2:return 136}},makeInsertEmoticonHTML:function(a,b){try{var d=duzon_dialog.getBtnDlg(),c="",f=eval(d.insTypeInfo[a].refInfoDB),e=b.search("src"),g=b.slice(e);g=g.split(" ",2);var h=g[0];g=h.split("=",2);h=g[1];g=h.split("/");var k=g[g.length-1];g=k.split(".");g=g[0].split("_");k=g[1];var l=g[0];g=l.split("emoti00");l=g[1];return c=objEmoUtil.makeEmoticonItemHTML(parseFloat(l,
10)-1,parseFloat(k,10)-1,f,d.getLeftSizeType(),!1)}catch(m){dalert(m)}},makeEmoticonItemHTML:function(a,b,d,c,f){try{if(f)e=0==c?28:c,g=dzeEnvConfig.strPath_Image+"emoticons/emoticon_type/"+d[a].name;else var e=0==c?28:c,g=dzeEnvConfig.strPath_Image+"emoticons/emoticon_"+(a+3)+"/"+d[a].content[b];g=getFullUrlFromPath(g);return"<img src='"+g+"' dze_image_no_proportion style='width:"+e+"px; height:"+e+"px;'>"}catch(h){dalert(h)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(u){f(u)}}:b}var d,f,g=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
var duzon_dialog={bChgTabDlgPos:!1,nEditNumber:0,objLayerDoc:document,objLayerWin:window,setObjLayer:function(){duzon_dialog.objLayerDoc=g_objLayerKit.getLayerDocument();duzon_dialog.objLayerWin=g_objLayerKit.getLayerWindow()},title:"",setTitle:function(a){this.title=a},getTitle:function(){return this.title},income_path:"child",resetSelection:!1,dze_image_align_propertys:["default","middle","top","left","right"],idx_dze_upload_iframe:"idx_dze_upload_iframe",arrAllowedFileExt:[".png",".jpg",".gif",
".jpeg"],arrExtContentsListener:null,dze_bookmark_last_tag:"&#8203;",extend:createExtendObj,chartDataDialog:function(a,b,c,d,e){try{dlog("chartDataDialog nEditNumber : "+b);dzeWebSearch.hideWebSearchBtn();g_objPasteOptionMenu.remove();this.setObjLayer();this.income_path="undefined"==typeof this.objLayerWin.event||null==this.objLayerWin.event?"child":"parent";duzon_dialog.resetSelection=!1;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objTableMiniMenu.showTableMiniMenu(!1,null,this.nEditNumber);
var f=a?a.target:null;if(!1===fnObjectCheckNull(f)&&(e=null,f.nodeName.toLowerCase()===DZE_TAG_IMG?e=f.alt:f.nodeName.toLowerCase()===DZE_TAG_TD?(f=g_objNodeUtil.getParentElement(f),e=f.command):e=f.innerText,!0===fnObjectCheckNull(e)||e!==ID_RES_CONST_STRING_SHAPES_FORMAT&&e!==ID_RES_CONST_STRING_TXTLAYOUT_OTHERS&&e!==ID_RES_CONST_STRING_OBJ_ROTATE_OTHERS))g_objShapeFunction.onDeselectAllShapes();g_nActiveEditNumber=this.nEditNumber=b;"none"!=this.color_picker_mode&&!0!==dzeUiConfig.bTBPreviewLetterOperation||
g_objInsertUtil.saveSelectionRange_IE(0,this.nEditNumber);cmnCtrlBg.viewBackScr();this.setTitle(c);cmnCtrlBg.m_objScr.className=null==cmnDlg.m_objBtn?"duzon_backscreen_transparent":"duzon_backscreen";"undefined"!=typeof d&&d();var g=oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,h=onefficeChart.chartDataDialogContainer(c);h&&(this.fade("in",h),g.body.appendChild(h),g_objPositionUtil.setObjectPosition(a,h,"center"));cmnCtrlBg.resizeBackScr()}catch(k){dalert(k)}},viewDialog:function(a,
b,c,d,e,f,g,h,k,l,m,n,p){try{dlog("viewDialog nEditNumber : "+b);cmnDlg.setShowDlg(!0);dzeWebSearch.hideWebSearchBtn();g_objPasteOptionMenu.remove();pageManager.getInstance().hideButtonContainer();this.setObjLayer();this.income_path="undefined"==typeof this.objLayerWin.event||null==this.objLayerWin.event?"child":"parent";duzon_dialog.resetSelection=!1;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objTableMiniMenu.showTableMiniMenu(!1,null,this.nEditNumber);if(0<g_objSelectedShapesArray.length){var q=
a?a.target:null;if(!fnObjectCheckNull(q)){var r=q.closest(".dze_ribbon_tb_item_box"),u;fnObjectCheckNull(r)?(r=q.closest(".duzon_menubar_select_item"),fnObjectCheckNull(r)||(u=1*r.getAttribute("mbcode"))):u=1*r.getAttribute("orgcommandid");switch(u){case ID_COMMAND_SHAPES_FORMAT:case ID_COMMAND_TXTLAYOUT_OTHERS:case ID_COMMAND_ROTATE_OTHERS:case ID_COMMAND_INSERT_IMAGE:case ID_COMMAND_IMAGE_PROPERTY:case ID_COMMAND_IMAGE_REPLACE:case ID_COMMAND_INSERT_SPECIALCHARS:case ID_COMMAND_HYPERLINK_INSERT:case ID_COMMAND_INSERT_EMOTICONS:case ID_COMMAND_STYLE_FONT:case ID_COMMAND_INSERT_ORDERED_LIST:case ID_COMMAND_INSERT_UNORDERED_LIST:case ID_COMMAND_STYLE_UNORDEREDLIST:case ID_COMMAND_STYLE_ORDEREDLIST:case ID_COMMAND_SHAPES_ROTATE:break;
default:if(!("string"===typeof d&&-1<d.indexOf("dze_idx_detail_color_picker_div")&&q.textContent===ID_RES_CONST_STRING_OTHER_COLOR))g_objShapeFunction.onDeselectAllShapes()}}}g_nActiveEditNumber=this.nEditNumber=b;"none"!=this.color_picker_mode&&!0!==dzeUiConfig.bTBPreviewLetterOperation||g_objInsertUtil.saveSelectionRange_IE(0,this.nEditNumber);p&&!1===p.viewBackScr||cmnCtrlBg.viewBackScr();this.setTitle(c);var t=cmnDlg.create(a,c,d,e,f,g);this.fade("in",t);cmnCtrlBg.m_objScr&&(cmnCtrlBg.m_objScr.className=
null==cmnDlg.m_objBtn?"duzon_backscreen_transparent":"duzon_backscreen");cmnDlg.setBtnStyle();cmnDlg.setBtnFocus(l);cmnDlg.addDlgEvt();"undefined"!=typeof h&&h(cmnDlg.m_Dlg);cmnDlg.m_unLoadCB="undefined"!=typeof k?k:function(){};if(m&&n&&"toolbar"==m){var w=document.getElementById(n.id.replace(/_SUB/,"")),y=this.getDialogElementPositionFromToolbarElement(w,t);t.style.top=y.top+"px";t.style.left=y.left+"px"}else g_objPositionUtil.setObjectPosition(a,t,m);if(c===ID_RES_CONST_STRING_INSERT_CHART){var z=
oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document,v=onefficeChart.chartDataDialogContainer(c);v&&(z.body.appendChild(v),dlog("tmpchartDataDlgDiveElv = "+v.height),v.style.top=t.offsetTop+"px",v.style.left=t.offsetLeft+v.clientWidth/2+2+"px",t.style.left=t.offsetLeft-v.clientWidth/2-2+"px",0>parseInt(v.style.top)&&(v.style.top="0px",v.style.left="0px",t.style.top="0px"),dlog("Chart.height = "+t.clientHeight),dlog("Chart.clientX = "+t.clientX+"chart.clientY= "+t.clientY));if(!0===dzeUiConfig.bSupportNewsEditor){var x=
onefficeExtContent.getImageSubInfoMenu();z.body.appendChild(x);x.style.left=v.offsetLeft+"px";x.style.top=v.offsetTop+v.clientHeight+4+"px"}}cmnCtrlBg.resizeBackScr()}catch(A){dalert(A)}},resetTableObjInfo:function(){try{g_objWrapperOutlineResize.resetExtOutlineInfo();var a=GetCurTable(this.nEditNumber);fnObjectCheckNull(a)||g_objTableSelection.deselectAllCell(a)}catch(b){dalert(b)}},createDialog:function(a,b,c,d,e,f){cmnDlg.create(a,b,c,d,e,f)},closeDialog:function(){cmnDlg.closeClickEvent()},unload:function(){try{var a=
g_objLayerKit.getElementById("idx_dlg");a&&a.parentNode&&a.parentNode.removeChild(a);var b=g_objLayerKit.getElementById("idx_duzon_backscreen");b&&b.parentNode&&b.parentNode.removeChild(b);cmnDlg.setDlg(null)}catch(c){dalert(c)}},setEditorFocus:function(){try{if(!g_bBrowserType_IE){var a=!1,b=g_objNodeUtil,c=null,d=null;dzeUiConfig.bOfficePagingMode&&(d=GetCurRangeProp(this.nEditNumber),!a&&d&&d.sc&&(c=b.getLoopHeaderFooterBody(d.sc)))&&(a=!0,b=null,!0===d.bInput&&(b=d.sc.childNodes[d.so]||d.sc,b=
g_objNodeUtil.isTextArea(b)?b:null),b?(b.focus({preventScroll:!0}),b.setSelectionRange(d.selStart,d.selEnd)):(c.focus({preventScroll:!0}),SetCurRange(d.getRange())));a||(window.attachEvent?g_objEditWindow[this.nEditNumber]&&g_objEditWindow[this.nEditNumber].focus({preventScroll:!0}):g_objEditorDocument[this.nEditNumber]&&g_objEditorDocument[this.nEditNumber].body&&g_objEditorDocument[this.nEditNumber].body.focus({preventScroll:!0}))}}catch(e){dalert(e)}},setEditorSelection:function(){if(g_bBrowserType_IE)try{if(null!=
g_objLastRange[this.nEditNumber])if(window.attachEvent)g_objLastRange[this.nEditNumber].select();else{var a=g_objEditWindow[this.nEditNumber].getSelection();a.removeAllRanges();a.addRange(g_objLastRange[this.nEditNumber])}}catch(b){dalert(b)}},setSelection:function(){this.setEditorSelection()},fade_effect:!0,fade:function(a,b,c,d){try{if(!0!==duzon_dialog.fade_effect)"out"==a?b.style.display="none":"none"===b.style.display&&(b.style.display="");else{"undefined"==typeof c&&(c=null);"undefined"==typeof d&&
(d=10);var e="out"==a?1:.1;g_objPropertyUtil.setOpacity(b,e);"none"===b.style.display&&(b.style.display="");var f=0,g=setInterval(function(){"out"==a?.1>=e&&(e=0,clearInterval(g),b.style.display="none",null!==c&&c()):.9<=e&&(e=1,clearInterval(g),null!==c&&c());g_objPropertyUtil.setOpacity(b,e);e="out"==a?e-.3*e:e+.3*e;f++},d)}}catch(h){dalert(h)}},idx_openfile_form:"idx_duzon_openfile_form",idx_openfile_input:"idx_duzon_openfile_input",idx_openfile_iframe:"idx_duzon_openfile_iframe",nm_openfile_iframe:"nm_duzon_openfile_iframe",
avail_openfile_ext:["html","htm","txt"],getOpenFileFormContent:function(){var a="<form method='post' id='"+this.idx_openfile_form+"' enctype='multipart/form-data' action=''>";a+=this.makeExtFileForm("openfile",this.idx_openfile_input,"232px",[".html",".htm",".txt"]);return a=a+"</form>"+("<iframe name='"+this.nm_openfile_iframe+"' id='"+this.idx_openfile_iframe+"' src='' style='display:none'></iframe>")},docFormLeftContent:null,docFormRightContent:null,selectedDocCategoryNo:-1,selectedDocNo:-1,getDocFormContent:function(){try{return new Promise(function(a,
b){function c(){for(var a=0;a<docformTemplateCategory.length;a++)"hidden_category"!==docformTemplateCategory[a].category&&(g=document.createElement("div"),g.className="duzon_dialog_docform_category_list",g.innerHTML=docformTemplateCategory[a].category,function(){var b=a;g.onclick=function(){duzon_dialog.selectDocFormCategory(b)}}(),duzon_dialog.docFormLeftContent.appendChild(g))}var d=document.createElement("div");d.className="duzon_dialog_docform_container";b=document.createElement("div");b.className=
"duzon_dialog_docform_left";var e=document.createElement("div");e.className="duzon_dialog_docform_left_title";e.innerHTML=ID_RES_DIALOG_LIST_TITLE_FORM_AREA;duzon_dialog.docFormLeftContent=document.createElement("div");duzon_dialog.docFormLeftContent.className="duzon_dialog_docform_left_content";b.appendChild(e);b.appendChild(duzon_dialog.docFormLeftContent);e=document.createElement("div");e.className="duzon_dialog_docform_right";var f=document.createElement("div");f.className="duzon_dialog_docform_right_title";
f.innerHTML=ID_RES_DIALOG_LIST_TITLE_FORM_SELECT;duzon_dialog.docFormRightContent=document.createElement("div");duzon_dialog.docFormRightContent.className="duzon_dialog_docform_right_content";e.appendChild(f);e.appendChild(duzon_dialog.docFormRightContent);d.appendChild(b);d.appendChild(e);var g=null;oneffice.getAppEnvType()===APPENV.WE?dynamicScriptCall("js/const/file_docform_const_we.js",function(){c();duzon_dialog.selectDocFormCategory(0);a(d)}):(c(),duzon_dialog.selectDocFormCategory(0),a(d))})}catch(a){dalert(a)}},
selectDocFormCategory:function(a){try{this.selectedDocCategoryNo=a;this.selectedDocNo=0;for(var b=this.docFormLeftContent.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"duzon_dialog_docform_category_list_select":"duzon_dialog_docform_category_list";this.docFormRightContent.innerHTML="";var d=null,e=b=null,f=null;for(c=0;c<docformTemplateCategory[a].data.length;c++)if(!0!==docformTemplateCategory[a].data[c].douzone||!1!==objOnefficeLoader.m_bDomainDuzon)f=docformTemplateCategory[a].data[c],
d=document.createElement("div"),d.className="duzon_dialog_docform_category_data",b=document.createElement("div"),b.style.width="100px",b.style.height="140px",b.style.marginBottom="6px",b.innerHTML="<img width='100px' height='140px' src='"+dzeEnvConfig.strPath_Image+"doc_form/"+f.image+"'>",e=document.createElement("p"),e.className="duzon_dialog_docform_category_data_subject",e.innerHTML=f.dialog_name?f.dialog_name:f.name,d.appendChild(b),d.appendChild(e),function(){var a=c;d.onclick=function(){duzon_dialog.selectDocFormData(a)};
d.ondblclick=function(){duzon_dialog.selectDocFormData(a);duzon_dialog.inputSelectDocFormData(duzon_dialog.selectedDocCategoryNo,duzon_dialog.selectedDocNo,g_nActiveEditNumber);g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)}}(),this.docFormRightContent.appendChild(d);0<=this.selectedDocNo&&this.selectDocFormData(this.selectedDocNo)}catch(g){dalert(g)}},selectDocFormData:function(a){try{this.selectedDocNo=a;for(var b=g_objPropertyUtil,c=this.docFormRightContent.childNodes,d=0;d<c.length;d++)d==
a?b.addClass(c[d],"duzon_dialog_docform_category_data_select"):b.removeClass(c[d],"duzon_dialog_docform_category_data_select")}catch(e){dalert(e)}},fillUserInfoTable:function(a){try{if(a){var b=a.querySelector("table[tools='"+DZE_CUSTOM_VALUE_BIZBOX_REPORT_6+"'][dze_desc='"+DZE_CUSTOM_VALUE_USER_INFO+"']");if(b&&oneffice_cloud_myInfoData){a=g_objTableUtil;var c=b.rows[0]?b.rows[0].cells[1]:null;c&&a.setCellInnerText(oneffice_cloud_myInfoData.name,c);var d=b.rows[1]?b.rows[1].cells[1]:null;d&&a.setCellInnerText(oneffice_cloud_myInfoData.duty_name,
d);var e=b.rows[1]?b.rows[1].cells[3]:null;e&&a.setCellInnerText(getDateString(),e)}}}catch(f){dalert(f)}},inputSelectDocFormDataOfContent:function(a,b,c,d){this.closeDialog();if(!0===dzeUiConfig.bOfficeMode){if(g_objCaretUtil.moveCaretToClosetPageMain(d),c){var e=g_objEditorDocument[d].createRange();c=e.createContextualFragment(c);e=null;g_objAdjustDoc.adjustContentBeforeInsert(c);this.fillUserInfoTable(c);insertHTMLCodeAtSelection(null,c,d)}}else replaceHTMLContent(c,d);e=docformTemplateCategory[a].data[b];
c=e.onePageMode;null!=c&&c!=dzeUiConfig.bOfficeOnePageLongMode&&g_objPageControl.changePageMode(c);c=e.paperMargin;null!=c&&dzeLayoutControl.setDocPrintMargin(d,{top:c[0],right:c[1],bottom:c[2],left:c[3],headerTop:c[4]||10,footerBottom:c[5]||12.5});try{var f=e.bodyStyle;null!=f&&setEditBodyStyle(d,f)}catch(m){dalert(m)}var g=g_objHeaderFooter;"undefined"!=typeof e.bDiffFirstPage&&g.setDiffFirstPage(e.bDiffFirstPage?!0:!1);"undefined"!=typeof e.bDiffOddEvenPage&&g.setDiffFirstPage(e.bDiffOddEvenPage?
!0:!1);"undefined"!=typeof e.bUseHeaderFooterEditMode&&g.setOption({bUseEditMode:e.bUseHeaderFooterEditMode});var h=[g.ODD_HEADER,g.EVEN_HEADER,g.FIRST_HEADER,g.ODD_FOOTER,g.EVEN_FOOTER,g.FIRST_FOOTER];d=[e.odd_header,e.even_header,e.first_header,e.odd_footer,e.even_footer,e.first_footer];var k=[g.strOddHeader,g.strEvenHeader,g.strFirstHeader,g.strOddFooter,g.strEvenFooter,g.strFirstFooter],l=!0;1!=a||0!=b||objOnefficeLoader.m_bDomainDuzon||objOnefficeLoader.isDev()||(l=!1);forEach(d,function(a,b){if((0!==
a||l)&&b&&""===k[a]){var c=g.getFirstPageNum(h[a]),d=null!==c?2<a?g.getFooter(c):g.getHeader(c):null;d?(d.innerHTML=b,g.propagateHeaderFooter(-1,c,d)):g_objHeaderFooter.setHeaderFooterHTML(h[a],b)}},this);this.selectedDocNo=-1;this.layoutMode=!1;1===a&&0===b&&(a=g_objEditorDocument[0].getElementById("idx_auto_date"))&&(a.textContent=getDateString(),a.id="")},inputSelectDocFormData:function(a,b,c,d){try{var e=function(e){duzon_dialog.inputSelectDocFormDataOfContent(a,b,e,c);g_objShapeFunction.updateShapesTextFormat();
if(!0!==d&&(g_objUndoRedo.registerUndoRedoStack(0,c),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()};if(0>a||0>b)alert(ID_RES_DIALOG_ALERT_SELECT_DOCFORM);else{this.resetTableObjInfo();var f=void 0;if(objOnefficeLoader.m_nAppEnvType===APPENV.GW){var g=docformTemplateCategory[a].data[b].html;if(!endsWith(g,".js"))return e(g);var h="";"ja"===CLOUD_CONST_LANG&&(h="_ja");var k="js/const/sample"+h+"/"+g;dynamicScriptCallDirect(k).then(function(){f=onefficeUtil.getDocFormContent(k);
void 0!==f?e(f):dlog("Form Bot Content Undefined")},function(){dlog("loadFail")})}else f=docformTemplateCategory[a].data[b].html,e(f)}}catch(l){dalert(l)}},selectedLayoutNo:-1,layoutContainer:null,idx_dze_file_layout_container:"idx_dze_file_layout_container",getLayoutContent:function(){try{dynamicScriptCall("js/const/file_layout_const.js",function(){dlog("file_layout_const load ok")});this.layoutContainer=document.createElement("div");this.layoutContainer.className="duzon_dialog_content_medium";this.layoutContainer.id=
this.idx_dze_file_layout_container;var a="";a+="<table cellspacing=0 cellpadding=0 border=0>";for(var b=0,c=0,d="",e="",f=0;4>f;f++){a+="<tr>";for(var g=0;4>g;g++)c++,d=c,10>c&&(d="0"+c),e=dzeEnvConfig.strPath_Image+"dialog/popup_btn_layout_"+d+".png",a+="<td width='100'>",a+="<div class='duzon_file_layout_unit'><img src='"+e+"' width='98' height='98'/></div>",a+="</td>",3>g&&(a+="<td width='4'></td>"),b++;a+="</tr>";3>f&&(a+="<tr><td colspan='7' height='4'></td></tr>")}a+="</table>";this.selectedLayoutNo=
-1;this.layoutContainer.innerHTML=a;return this.layoutContainer}catch(h){dalert(h)}},addLayoutContentEvent:function(){try{for(var a=this.layoutContainer.getElementsByTagName("div"),b=0;b<a.length;b++)(function(){var c=b;a[b].onclick=function(){duzon_dialog.selectLayoutData(c)};a[b].onmouseover=function(){"duzon_file_layout_unit_select"!=this.className&&(this.className="duzon_file_layout_unit_over")};a[b].onmouseout=function(){"duzon_file_layout_unit_select"!=this.className&&(this.className="duzon_file_layout_unit")}})()}catch(c){dalert(c)}},
selectLayoutData:function(a){try{this.selectedLayoutNo=a;dlog("this.selectedLayoutNo:"+this.selectedLayoutNo);for(var b=this.layoutContainer.getElementsByTagName("div"),c=0;c<b.length;c++)b[c].className=c==a?"duzon_file_layout_unit_select":"duzon_file_layout_unit"}catch(d){dalert(d)}},layoutMode:!1,inputSelectLayoutData:function(){try{if(0>this.selectedLayoutNo)alert(ID_RES_DIALOG_ALERT_SELECT_LAYOUT_DESIGN);else{dlog("inputSelectLayoutData this.selectedLayoutNo : "+this.selectedLayoutNo);this.resetTableObjInfo();
!0===dzeUiConfig.bOfficeMode?insertHTMLCodeAtSelection(layoutTemplate[this.selectedLayoutNo],null,this.nEditNumber):replaceHTMLContent(layoutTemplate[this.selectedLayoutNo],this.nEditNumber);this.layoutMode=!0;this.closeDialog();var a=g_objEditorDocument[this.nEditNumber].getElementById("layoutTable");g_objNodeUtil.removeAttribute(a,"id");this.setLayoutStyleToTable(this.nEditNumber,a);var b=a.getElementsByTagName("H1");null!=b&&0<b.length?g_objCaretUtil.moveCaret(b[0]):g_objCaretUtil.moveCaret(a);
dzeUiConfig.bOfficeMode||g_objEditWindow[duzon_dialog.nEditNumber].scrollTo(0,0)}}catch(c){dalert(c)}},setLayoutStyleToTable:function(a,b){try{if(1==this.layoutMode&&b){b.className="dze_tb_layout dze_table";var c=b.getElementsByTagName("*");for(a=0;a<c.length;a++)if("th"==c[a].nodeName.toLowerCase()||"td"==c[a].nodeName.toLowerCase())c[a].className="dze_tb_layout_td"}}catch(d){dalert(d)}},setFocusElement:function(a,b,c){try{if(a&&a.parentNode){b=!0;"undefined"!=typeof c&&"end"==c&&(b=!1);var d=a.ownerDocument;
if(d)if(d.createRange){var e=d.createRange();g_objNodeUtil.canSelectNodeContents(a)?e.selectNodeContents(a):e.selectNode(a);e.collapse(b);var f=d.defaultView;var g=f.getSelection();g.removeAllRanges();g.addRange(e)}else d.selection&&(e=d.body.createTextRange(),e.moveToElementText(a),e.collapse(b),e.select())}}catch(h){dalert(h)}finally{}},selectElement:function(a,b){try{if(g_objEditorDocument[b].createRange){var c=g_objEditorDocument[b].createRange();c.selectNodeContents(a);var d=g_objEditorDocument[b].getSelection();
d.removeAllRanges();d.addRange(c)}else g_objEditorDocument[b].selection&&(c=g_objEditorDocument[b].body.createTextRange(),c.moveToElementText(a),c.select())}catch(e){dalert(e)}finally{}},makeExtFileForm:function(a,b,c,d,e){d="undefined"==typeof d?"":d.join(",");"undefined"==typeof c&&(c="auto");oneffice.currFilePath||""!=oneffice.currFilePath||(oneffice.currFilePath=oneffice.currFileSeq);c="<div style='width:"+c+"'><table width='100%' border='0' cellpadding='0' cellspacing='0' style='table-layout:fixed'><tr>";
c+="<td><div class='duzon_dialog_upload_fileview_container' id='"+b+"_view'></div></td>";c+="<td width='4'></td>";c+="<td width='65' class='duzon_dialog_body_fileform_hide_td'>";c+="<input type='button' value='"+ID_RES_CONST_STRING_EDIT_SEARCH+"' style='' class='duzon_dialog_btn_upload'>";c+="<input type='file' name='"+a+"' id='"+b+"'"+(!0===e?"multiple ":" ")+"class='duzon_dialog_body_fileform_hide' accept='"+d+"' />";!0!==dzeUiConfig.bSupportNewsEditor&&(c+="<input type='hidden' id='oneffice_document_number' name='doc_no' value='"+
oneffice.currFilePath+"' />");objOnefficeLoader.m_nAppEnvType==APPENV.WE?g_onefficeWeTool&&"onex"==g_onefficeWeTool.m_IsOnex&&(c+="<input type='hidden' id='oneffice_document_opendate' name='open_date' value='"+g_onefficeWeTool.m_openFileDate+"' />"):objOnefficeLoader.m_nAppEnvType==APPENV.GW&&oneffice.bUseOnexFile&&(c+="<input type='hidden' id='oneffice_document_opendate' name='open_date' value='"+oneffice.currFileOpenDate+"' />");c+="</td>";c+="</tr>";c+="</table>";return c+="</div>"},addEventExtFileForm:function(a,
b){var c=g_objLayerKit.getElementById(a),d=g_objLayerKit.getElementById(a+"_view");fnObjectCheckNull(d)||(c.onchange=function(){for(var a="",c=0,g=this.files.length;c<g;c++){var h=this.files[c].name;-1<h.indexOf("\\")&&(h=h.split("\\").pop());-1<h.indexOf("/")&&(h=h.split("/").pop());0!=c&&(a+=" ");a+='"'+h+'"'}d.innerHTML="<div style='overflow:hidden; white-space:nowrap; padding-top:2px;'>"+a+"</div>";"undefined"!=typeof b&&b()},c.onmouseover=function(){this.previousSibling.style.backgroundColor=
"#f2f2f2"},c.onmousedown=function(){this.previousSibling.style.backgroundColor="#d9d9d9"},c.onmouseup=function(){this.previousSibling.style.backgroundColor="#f2f2f2"},c.onmouseout=function(){this.previousSibling.style.backgroundColor=""},d.onmouseover=function(){this.title=this.innerText})},disableExtFileForm:function(a){if(a=g_objLayerKit.getElementById(a))a.disabled=!0,a.style.cursor="default";if(a=g_objNodeUtil.getLoopParentElement(a,"table"))a.style.opacity="0.3"},enableExtFileForm:function(a){if(a=
g_objLayerKit.getElementById(a))a.disabled=!1,a.style.cursor="pointer";if(a=g_objNodeUtil.getLoopParentElement(a,"table"))a.style.opacity="1"},disableImageUrlForm:function(a){if(a=g_objLayerKit.getElementById(a))a.disabled=!0,a.style.opacity="0.3"},enableImageUrlForm:function(a){if(a=g_objLayerKit.getElementById(a))a.disabled=!1,a.style.opacity="1"},makeSpinnerInputForm:function(a,b,c,d,e,f,g,h){try{return DzeSpinner.getHTML({id:a,value:e,unit:b,width:f,height:g,marginRight:h})}catch(k){dalert(k)}},
setEnableSpinner:function(a,b){try{var c=DzeSpinner.getSpinner(a);c&&c.enable(b)}catch(d){dalert(d)}},modifySpinnerValue:function(a,b,c,d,e,f,g,h){try{var k=g_objLayerKit.getElementById(a);return DzeSpinner.createSpinner(k,{max:b,min:c,value:d,callback:e,onmouseup:f,amount:g,alert:h})}catch(l){dalert(l)}},checkDzeInsertType:function(a,b){try{if(a=b,"undefined"==typeof a&&(a=!1),a){var c=g_objLayerKit.getLayerDocument().dze_insert_video_form;1==c.dze_insert_type[0].checked&&(g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt).disabled=
!1,g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt).parentNode.style.color="#000000",g_objLayerKit.getElementById(this.idx_dze_ext_movie_source).disabled=!0);1==c.dze_insert_type[1].checked&&(g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt).disabled=!0,g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt).parentNode.style.color="#a0a0a0",g_objLayerKit.getElementById(this.idx_dze_ext_movie_source).disabled=!1)}}catch(d){dalert(d)}},checkDzeInsertTypeVideo:function(a,
b){try{if(a=b,"undefined"==typeof a&&(a=!1),a){var c=g_objLayerKit.getLayerDocument().dze_insert_video_form,d=g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt),e=g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt+"_view"),f=dzeJ("#idx_insertvideo_table\u00a0.duzon_dialog_body_fileform_hide_td\u00a0.duzon_dialog_btn_upload"),g=g_objLayerKit.getElementById(this.idx_dze_ext_url),h=g_objLayerKit.getElementById(this.idx_dze_ext_movie_source),k=c.querySelector(".duzon_dialog_btn_upload");
fnObjectCheckNull(k)&&(k=c.querySelector(".duzon_dialog_btn_upload_disabled"));fnObjectCheckNull(d)||(d.disabled=!0);fnObjectCheckNull(g)||(g.disabled=!0);fnObjectCheckNull(h)||(h.disabled=!0);switch(g_bBrowserType_IE?this.getRadioValue(c.dze_insert_type):c.dze_insert_type.value){default:case "1":fnObjectCheckNull(d)||(d.disabled=!1,d.parentNode.style.color="#000000",d.style.cursor="",e.className="duzon_dialog_upload_fileview_container",k.className="duzon_dialog_btn_upload");f.css("cursor","");break;
case "2":h.disabled=!1;fnObjectCheckNull(d)?fnObjectCheckNull(g)||(g.className="duzon_dialog_upload_fileview_container_disabled"):(d.parentNode.style.color="#a0a0a0",d.style.cursor="default",e.className="duzon_dialog_upload_fileview_container_disabled",k.className="duzon_dialog_btn_upload_disabled");f.css("cursor","default");break;case "3":g.disabled=!1,fnObjectCheckNull(d)||(d.style.cursor="default",e.className="duzon_dialog_upload_fileview_container_disabled"),fnObjectCheckNull(g)||(g.disabled=
!1,g.className="duzon_dialog_upload_fileview_container"),f.css("cursor","default")}}}catch(l){dalert(l)}},idx_paste_special_type_text:"idx_duzon_paste_special_type_text",idx_paste_special_type_html:"idx_duzon_paste_special_type_html",getPastespecial:function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";a+="<div style='margin-bottom:5px;'><input type='radio' name='paste_special_type' id='"+this.idx_paste_special_type_text+"' value='text' /><label for='"+this.idx_paste_special_type_text+
"'>"+ID_RES_DIALOG_STRING_NO_STYLE_TEXT+"</label></div>";a+="<div><input type='radio' name='paste_special_type' id='"+this.idx_paste_special_type_html+"' value='html' checked><label for='"+this.idx_paste_special_type_html+"'>"+ID_RES_DIALOG_STRING_HTML_STYLE_TEXT+"</label></div>";return a+"</div>"}catch(b){dalert(b)}},idxTabTitleContainer:"idxDuzonTabTitleContainer",tabTopContainer:null,tabDialogContainer:null,tabTitleContainer:null,tabBodyContainer:null,tabDefaultContainer:null,tabBottomContainer:null,
defaultTabSize:60,tabOnloadCallbacks:[],currTabIdx:0,getTabContents:function(a,b,c,d,e,f,g){try{dlog("typeof(tabSizeArray):"+typeof d);if("undefined"==typeof d){d=[];for(var h=0;h<a;h++)d[h]=this.defaultTabSize}for(h=0;h<a;h++)"undefined"==typeof d[h]&&(d[h]=this.defaultTabSize);this.tabOnloadCallbacks=[];if("undefined"==typeof f)for(h=0;h<a;h++)this.tabOnloadCallbacks.push(function(){});else for(h=0;h<a;h++)"undefined"==typeof f[h]?this.tabOnloadCallbacks.push(function(){}):this.tabOnloadCallbacks.push(f[h]);
this.tabTitleContainer=document.createElement("div");this.tabTitleContainer.className="duzon_dialog_tab_title_container";this.tabTitleContainer.id=this.idxTabTitleContainer;var k=document.createElement("div");k.className="duzon_dialog_tab_title_blank_left";this.tabTitleContainer.appendChild(k);var l=null;for(h=0;h<a;h++)l=document.createElement("div"),l.className="duzon_dialog_tab_titles off",d&&h<d.length&&0<d[h]&&(l.innerHTML=b[h]),function(){var a=h;l.onclick=function(){this.textContent===ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST||
this.textContent===ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST||this.textContent===ID_RES_CONST_STRING_RECEIVED_REPORT||this.textContent===ID_RES_CONST_STRING_SENT_REPORT||this.textContent===ID_RES_CONST_STRING_REFERENCE_REPORT||this.textContent===ID_RES_CONST_STRING_PUBLIC_REPORT?duzon_dialog.viewTabContents(a,!0):duzon_dialog.viewTabContents(a)}}(),this.tabTitleContainer.appendChild(l);var m=document.createElement("div");m.className="duzon_dialog_tab_title_blank_right";this.tabTitleContainer.appendChild(m);
this.tabBodyContainer=document.createElement("div");this.tabBodyContainer.className="duzon_dialog_tab_body_container";b=null;for(h=0;h<a;h++)"object"==typeof c[h]?(b=document.createElement("div"),b.className="duzon_dialog_tab_body_container_on",b.appendChild(c[h])):"string"==typeof c[h]&&(b=document.createElement("div"),b.className="duzon_dialog_tab_body_container_off",b.innerHTML=c[h]),this.tabBodyContainer.appendChild(b);this.tabDefaultContainer=null;"undefined"!=typeof e&&null!=e&&""!=e&&(this.tabDefaultContainer=
document.createElement("div"),this.tabDefaultContainer.className="duzon_dialog_tab_default_container","object"==typeof e?this.tabDefaultContainer.appendChild(e):"string"==typeof e&&(this.tabDefaultContainer.innerHTML=e));this.tabBottomContainer=document.createElement("div");this.tabBottomContainer.className="duzon_dialog_tab_bottom_container";this.duzon_dialog_tab_top_container=null;"undefined"!=typeof g&&null!=g&&""!=g&&(this.duzon_dialog_tab_top_container=document.createElement("div"),this.duzon_dialog_tab_top_container.className=
"duzon_dialog_tab_top_container","object"==typeof g?this.duzon_dialog_tab_top_container.appendChild(g):"string"==typeof g&&(this.duzon_dialog_tab_top_container.innerHTML=g));this.tabDialogContainer=document.createElement("div");this.tabDialogContainer.className="duzon_dialog_tab_dialog_container";null!=this.duzon_dialog_tab_top_container&&this.tabDialogContainer.appendChild(this.duzon_dialog_tab_top_container);this.tabDialogContainer.appendChild(this.tabTitleContainer);this.tabDialogContainer.appendChild(this.tabBodyContainer);
null!=this.tabDefaultContainer&&this.tabDialogContainer.appendChild(this.tabDefaultContainer);this.tabDialogContainer.appendChild(this.tabBottomContainer);cmnDlg.setTabType(!0);return this.tabDialogContainer}catch(n){dalert(n)}},viewTabContents:function(a,b){try{dlog("viewTabContents tabIdx:"+a);for(var c=this.tabTitleContainer.getElementsByTagName("div"),d,e=1;e<c.length-1;e++)d=c[e].classList,a+1==e?(d.remove("off"),d.add("on")):(d.remove("on"),d.add("off"));var f=this.tabBodyContainer.getElementsByTagName("div");
c=[];if(!0!==b)for(e=0;e<f.length;e++)"duzon_dialog_tab_body_container_on"!=f[e].className&&"duzon_dialog_tab_body_container_off"!=f[e].className||c.push(f[e]);for(e=0;e<c.length;e++)c[e].className=a==e?"duzon_dialog_tab_body_container_on":"duzon_dialog_tab_body_container_off";c.length&&(duzon_dialog.bChgTabDlgPos=g_objPositionUtil.dlgTabBodyHeight(c,a));this.currTabIdx=a;this.tabOnloadCallbacks[a]()}catch(g){dalert(g)}},idx_duzon_find_text:"idx_duzon_find_text",idx_duzon_replace_text:"idx_duzon_replace_text",
idx_find_text_box:"idx_duzon_find_text_box",idx_replace_text_box:"idx_duzon_replace_text_box",getReplaceFormText:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<table style='width: 400px;'>";a+="<tr id='"+this.idx_find_text_box+"' class='duzon_dialog_find_form_container'>";a+="<td style='min-width:65px;'><div style='padding-right:5px;white-space:nowrap;'>"+ID_RES_DIALOG_STRING_FIND_TEXT+":</div></td>";a+="<td><input type='text' name='dze_find_text' id='"+this.idx_duzon_find_text+
"' value='' size='30' class='duzon_findtext_frm' style='width:100%; padding:3px 0px 4px 0px;' autocomplete='off'/></td>";a+="</tr>";a+="<tr id='"+this.idx_replace_text_box+"' class='duzon_dialog_find_form_container' style='visibility:collapse;'>";a+="<td style='min-width:65px;'><div style='padding-right:5px;white-space:nowrap;'>"+ID_RES_DIALOG_STRING_REPLACE_TEXT+":</div></td>";a+="<td><input type='text' name='dze_replace_text' id='"+this.idx_duzon_replace_text+"' value='' size='30' class='duzon_replacetext_frm' style='width:100%; padding:3px 0px 4px 0px;' autocomplete='off'/></td>";
a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}},idx_casesensitive:"idx_casesensitive",idx_ignorespace:"idx_ignorespace",idx_findforward:"idx_findforward",idx_findbackward:"idx_findbackward",idx_completeword:"idx_completeword",isFindDialog:!1,getFindOptionFormText:function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIND_OPTION+"</div>";a+="<div class='duzon_dialog_string_divline'>";
a+="<input type='checkbox' name='dze_casesensitive' id='"+this.idx_casesensitive+"' value='1' /><label for='"+this.idx_casesensitive+"'>"+ID_RES_DIALOG_STRING_CASESENSITIVE+"</label>";a+="&nbsp;&nbsp;<input type='checkbox' name='dze_completeword' id='"+this.idx_completeword+"' value='1' /><label for='"+this.idx_completeword+"'>"+ID_RES_DIALOG_STRING_COMPLETEWORD+"</label>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIND_DERECTION+
"</div>";a+="<div>";a+="<input type='radio' name='dze_direction' id='"+this.idx_findforward+"' value='0' checked /><label for='"+this.idx_findforward+"'>"+ID_RES_DIALOG_STRING_FIND_DOWN+"</label>";a+="&nbsp;&nbsp;<input type='radio' name='dze_direction' id='"+this.idx_findbackward+"' value='1'/><label for='"+this.idx_findbackward+"'>"+ID_RES_DIALOG_STRING_FIND_UP+"</label>";return a+"</div></div>"}catch(b){dalert(b)}},strFindText:"",getFindReplaceContent:function(){try{return this.getTabContents(2,
[ID_RES_CONST_STRING_EDIT_SEARCH,ID_RES_CONST_STRING_EDIT_REPLACE],["",""],[60,60],this.getReplaceFormText()+this.getFindOptionFormText(),[function(){g_objLayerKit.getElementById(duzon_dialog.idx_replace_text_box).style.visibility="collapse";g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus();var a=cmnDlg.m_objBtn.getElementsByTagName("input");dlog("btnObj[0]:"+a[0].value);a[0].style.display="none";a[1].style.display="none"},function(){g_objLayerKit.getElementById(duzon_dialog.idx_replace_text_box).style.visibility=
"";var a=cmnDlg.m_objBtn.getElementsByTagName("input");a[0].style.display="";a[1].style.display="";""==g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value?g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus():g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).focus()}])}catch(a){dalert(a)}},idx_privacy_phone_number:"idx_privacy_phone_number",idx_privacy_e_mail:"idx_privacy_e_mail",idx_privacy_rr_number:"idx_privacy_rr_number",idx_privacy_fr_number:"idx_privacy_fr_number",
idx_privacy_credit_card:"idx_privacy_credit_card",idx_privacy_birth_date:"idx_privacy_birth_date",idx_privacy_ip_address:"idx_privacy_ip_address",idx_privacy_etc:"idx_privacy_etc",idx_privacy_type_1:"******",idx_privacy_type_2:"~~~~~~",idx_privacy_type_3:"XXXXXX",privacy_pattern_phone:/(0(10|2|3{1-3}|4{1-4}|5{1-5}|6{1-4}))-(\d{3,4})-(\d{4})/,privacy_pattern_email:/[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*@[0-9a-zA-Z]([-_.]?[0-9a-zA-Z])*.[a-zA-Z]{2,3}/i,privacy_pattern_rrnumber:/(?:[0-9]{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[1,2][0-9]|3[0,1]))-[1-4][0-9]{6}/,
privacy_pattern_frnumber:/(?:[0-9]{2}(?:0[1-9]|1[0-2])(?:0[1-9]|[1,2][0-9]|3[0,1]))-[5-8][0-9]{6}/,privacy_pattern_credit_card:/(5[1-5]\d{14})|(4\d{12})(\d{3}?)|3[47]\d{13}|(6011\d{12})/,privacy_pattern_birth_date:/\b\d{4}[-\/]d{1,2}[-\/]\d{1,2}\b/,privacy_pattern_ip_address:/(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)/,getProtectPrivacyContent:function(){try{var a="";a+="<div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_SELECT_PRIVACY+"</div>";
a+="<div class='duzon_dialog_string_divline'>";a+="<input type='checkbox' name='dze_privacy_phone_number' id='"+this.idx_privacy_phone_number+"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_phone_number+"'>"+ID_RES_CONST_STRING_PHONE_NUMBER+"</label>";a+="&nbsp;&nbsp;<input type='checkbox' name='dze_privacy_rr_number' id='"+this.idx_privacy_rr_number+"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_rr_number+"'>"+ID_RES_CONST_STRING_RESIDENT_REGISTRATION_NUMBER+
"</label>";a+="&nbsp;&nbsp;<input type='checkbox' name='dze_privacy_fr_number' id='"+this.idx_privacy_fr_number+"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_fr_number+"'>"+ID_RES_CONST_STRING_FOREIGNER_NUMBER+"</label>";a+="<br><input type='checkbox' name='dze_privacy_e_mail' id='"+this.idx_privacy_e_mail+"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_e_mail+"'>"+ID_RES_CONST_STRING_E_MAIL+"</label>";a+="&nbsp;&nbsp;<input type='checkbox' name='dze_privacy_credit_card' id='"+
this.idx_privacy_credit_card+"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_credit_card+"'>"+ID_RES_CONST_STRING_CREDITCARD_NUMBER+"</label>";a+="&nbsp;&nbsp;<input type='checkbox' name='dze_privacy_birth_date' id='"+this.idx_privacy_birth_date+"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_birth_date+"'>"+ID_RES_CONST_STRING_BIRTHDAY+"</label>";a+="<br><input type='checkbox' name='dze_privacy_ip_address' id='"+this.idx_privacy_ip_address+
"' value='1' /><label style='width:90px; margin:5px 0;' for='"+this.idx_privacy_ip_address+"'>"+ID_RES_CONST_STRING_IP_ADDRESS+"</label>";a+="&nbsp;&nbsp;<input type='checkbox' name='dze_privacy_etc' id='"+this.idx_privacy_etc+"' value='1' /><label style='width:30px; margin:5px 0;' for='"+this.idx_privacy_etc+"'>"+ID_RES_CONST_STRING_EMOTICONS_ETC+"</label>";a+="&nbsp;&nbsp;<input type='text' maxlength='100' style='width:155px; height:24px; vertical-align:middle; font-size: 14px !important; padding: 0 5px; border-width: 1px;' id='dze_idx_privacy_etc_input' value='' placeholer=''>";
a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_SELECT_PROTECT_CHAR+"</div>";a+="<div>";a+="<input type='radio' name='dze_privacy_type' id='"+this.idx_privacy_type_1+"' value='0' checked /><label for='"+this.idx_privacy_type_1+"'>"+this.idx_privacy_type_1+"</label>";a+="<br/><input type='radio' name='dze_privacy_type' id='"+this.idx_privacy_type_2+"' value='1'/><label for='"+this.idx_privacy_type_2+"'>"+this.idx_privacy_type_2+
"</label>";a+="<br/><input type='radio' name='dze_privacy_type' id='"+this.idx_privacy_type_3+"' value='1'/><label for='"+this.idx_privacy_type_3+"'>"+this.idx_privacy_type_3+"</label>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_PRIVACY_PASSWORD+"</div>";a+="<input type='password' maxlength='20' style='width:auto; font-size: 24px !important; padding: 0 5px; border-width: 1px;' id='dze_idx_privacy_password_input' value='' placeholer=''>";
return a+"</div></div>"}catch(b){dalert(b)}},getDisablePrivacyContent:function(){try{var a="";a+="<div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_PRIVACY_PASSWORD+"</div>";a+="<input type='password' maxlength='20' style='width:auto; font-size: 24px !important; padding: 0 5px; border-width: 1px;' id='dze_idx_privacy_password_input' value='' placeholer=''>";return a+"</div></div>"}catch(b){dalert(b)}},idx_insertvideo_table:"idx_insertvideo_table",idx_insertvideo_radio_type1:"idx_insertvideo_radio_type1",
idx_insertvideo_radio_type2:"idx_insertvideo_radio_type2",idx_insertvideo_radio_type3:"idx_insertvideo_radio_type3",idx_insertvideo_upvideo_txt:"idx_insertvideo_upvideo_txt",idx_dze_ext_url:"idx_dze_ext_url",idx_dze_ext_movie_source:"idx_dze_ext_movie_source",dze_video_align_propertys:["left","default","right"],dze_video_playtype_propertys:["Manual","Auto"],getInsertExtMovieContent:function(){try{var a=g_objVideoControl.getAllowPlayVideoList(!0),b="";b+="<div class='duzon_dialog_content_medium'>";
b+="<form name='dze_insert_video_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadVideoURL+"' >";b+="<table id = "+this.idx_insertvideo_table+" width='100%' border='0' celladding='0' cellspacing='0'>";b+="<tr>";b+="<td width='80'><input type='radio' name='dze_insert_type' value='1' id='"+this.idx_insertvideo_radio_type1+"' checked /><label for='"+this.idx_insertvideo_radio_type1+"' style='padding-top:0 !important;'>"+ID_RES_DIALOG_STRING_FILE_PATH+
"</label></td><td>";b+=this.makeExtFileForm("dze_upvideo_file",this.idx_insertvideo_upvideo_txt,"auto",a);b+="</td></tr>";b+="<tr><td colspan='2' height='2' /></tr>";b+="<tr>";b+="<td colspan='2'><input type='radio' name='dze_insert_type' value='2' id='"+this.idx_insertvideo_radio_type2+"' /><label for='"+this.idx_insertvideo_radio_type2+"'  style='padding-top:0 !important;'>"+ID_RES_DIALOG_STRING_INPUT_SOURCE+"</label></td>";b+="</tr>";b+="<tr><td colspan='2' height='5' /></tr>";b+="</table>";b+=
"<div class=''><textarea name='dze_ext_movie_source' id='"+this.idx_dze_ext_movie_source+"' class='dze_ext_movie_source_form' placeholder='"+ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE+"' disabled></textarea></div>";b+="<div class='duzon_dialog_label_separator'></div>";b+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";b+="<table width='100%' border='0' celladding='0' cellspacing='0'>";b+="<tr>";b+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_LEFT+"</td>";b+="<td width='28%'>"+
this.makeSpinnerInputForm("dze_movie_marginleft","px","500","0","0")+"</td>";b+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_TOP+"</td>";b+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_margintop","px","500","0","0")+"</td>";b+="</tr>";b+="<tr>";b+="<td colspan='4' height='5'></td>";b+="</tr>";b+="<tr>";b+="<td>"+ID_RES_DIALOG_STRING_MARGIN_RIGHT+"</td>";b+="<td>"+this.makeSpinnerInputForm("dze_movie_marginright","px","500","0","0")+"</td>";b+="<td>"+ID_RES_DIALOG_STRING_MARGIN_BOTTOM+
"</td>";b+="<td>"+this.makeSpinnerInputForm("dze_movie_marginbottom","px","500","0","0")+"</td>";b+="<tr>";b+="<td colspan='4' height='5'></td>";b+="</tr>";b+="</tr>";b+="<tr>";b+="<td>"+ID_RES_CONST_INSERT_IMAGE_PARAGRAPH_ALIGN+"</td>";b+="<td colspan='4' align='left'>";for(a=0;a<this.dze_video_align_propertys.length;a++)curr_id="idx_dze_align_style_"+this.dze_video_align_propertys[a],curr_icon=dzeEnvConfig.strPath_Image+"dialog/ico_ali_video_"+this.dze_video_align_propertys[a]+".png",1===a?(curr_exeName=
eval("ID_RES_DIALOG_STRING_ALIGN_BASIC"),b+="<div class='dze_image_align_propery_set dze_image_align_propery_set_selected' id='"+curr_id+"'><div><img src='"+curr_icon+"' alt='' title='"+curr_exeName+"' width='28' height='28'></div>"+curr_exeName+"</div>"):(curr_exeName=eval("ID_RES_DIALOG_STRING_ALIGN_"+this.dze_video_align_propertys[a].toUpperCase()),b+="<div class='dze_image_align_propery_set' id='"+curr_id+"'><div><img src='"+curr_icon+"' alt='' title='"+curr_exeName+"' width='28' height='28'></div>"+
curr_exeName+"</div>");b+="</td>";b+="</tr>";b+="<tr>";b+="<td colspan='4' height='5'></td>";b+="</tr>";b+="<tr>";b+="<td>"+ID_RES_DIALOG_STRING_AUTO_PLAY+"</td>";b+="<td colspan='4' align='left'>"+this.makeComboInputFormWithArray("dze_idx_video_playtype",this.dze_video_playtype_propertys)+"</td>";b+="</tr>";b+="</table>";b+="</form>";b+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+"' style='width:100%;height:100px;display:none'></iframe>";b+="</div>";g_objVideoControl.setUpVideoUrl(null);
return b}catch(c){dalert(c)}},getVideoForCheckedFormCtrl:function(a,b){try{var c=null;b=g_objVideoControl.getOption(b);switch(a.value){case "1":var d=g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt);if(!d||!d.value||0>=d.value.length)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO_EMPTY),!1;var e=g_objVideoControl.getUpVideoUrl();if(null==e||""==e)return alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),!1;c=g_objVideoControl.createVideo(b);if(!c)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO),
!1;break;case "2":c=duzon_dialog.changeCodeToIframe(this.idx_dze_ext_movie_source,!1,b);if(!c)return!1;break;case "3":if(c=duzon_dialog.changeCodeToIframe(this.idx_dze_ext_url,!0,b),!c)return!1}return c}catch(f){dalert(f)}},changeCodeToIframe:function(a,b,c){try{var d=null,e=g_objLayerKit.getElementById(a),f=e.value.trim();if(b){b=f;f="";g_objVideoControl.setVideoUrlType(b);var g=g_objVideoControl.getFormatVideoIFrame();(0==b.indexOf("http://")||0==b.indexOf("https://"))&&(a=g_objVideoControl.getVideoIDForURL(b))&&
0<a.length&&(f=g.replace(/#id#/g,a))}f&&!0===dzeUiConfig.bRemoveXSS&&(f=removeXSS(f,{bCheckIframe:!1}));if(!f)return alert(ID_RES_DIALOG_STRING_INPUT_MOVIE_SOURCE),e.focus(),!1;d=g_objVideoControl.createVideoIframe(c,f);return d?d:(alert(isURL?ID_RES_DIALOG_STRING_INPUT_YOUTUBE_URL:ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE),!1)}catch(h){dalert(h)}},insertExtMovieContent:function(a){try{var b=g_objLayerKit.getLayerDocument().dze_insert_video_form,c=this.nEditNumber,d=null;a=g_objVideoControl.getOption(a);
if(1==b.dze_insert_type[0].checked){var e=g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt);if(!e||!e.value||0>=e.value.length)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO_EMPTY),!1;var f=g_objVideoControl.getUpVideoUrl();if(null==f||""==f)return alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),!1;d=g_objVideoControl.createVideo(a);if(!d)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO),!1}else{var g=g_objLayerKit.getElementById(this.idx_dze_ext_movie_source),h=g.value.trim();!0===dzeUiConfig.bRemoveXSS&&
(h=removeXSS(h,{bCheckIframe:!1}));if(!h)return alert(ID_RES_DIALOG_STRING_INPUT_MOVIE_SOURCE),g.focus(),!1;d=g_objVideoControl.createVideoIframe(a,h);if(!d)return alert(ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE),!1}this.closeDialog();if(!d)return!1;insertHTMLCodeAtSelection(null,d,c);d.lastChild&&"VIDEORESIZE"===d.lastChild.nodeName&&g_objVideoControl.animate(d.lastChild);return!0}catch(k){dalert(k)}},getRadioValue:function(a){try{if(a){for(var b=0;b<a.length;b++)if(a[b].checked)return a[b].value;return-1}}catch(c){dalert(c)}},
idx_dze_insert_extfile_link_box:"idx_dze_insert_extfile_link_box",idx_dze_insert_extfile_text:"idx_dze_insert_extfile_text",idx_dze_up_extfile:"idx_dze_up_extfile",allow_file_ext_array:"doc docx xls xlsx ppt pptx hwp txt pdf".split(" "),getInsertExtFileContent:function(){try{for(var a=[],b=0;b<this.allow_file_ext_array.length;b++)a.push("."+this.allow_file_ext_array[b]);b="";b+="<div class='duzon_dialog_content_medium'>";b+="<form name='dze_insert_extfile_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+
dzeEnvConfig.strUploadExtFileURL+"' >";b+="<table width='100%' border='0' celladding='0' cellspacing='0'>";b+="<tr>";b+="<td width='100'>"+ID_RES_DIALOG_STRING_FILE_PATH+" : </td>";b+="<td>";b+=this.makeExtFileForm("dze_up_extfile",this.idx_dze_up_extfile,"310px",a);b+="</td>";b+="</tr>";b+="<tr>";b+="<td height='5'></td>";b+="</tr>";b+="<tr>";b+="<td>"+ID_RES_DIALOG_STRING_VIEW_TEXT+" : </td><td></label> <input type='text' name='dze_up_extfile_title' value='' size='256' id='"+this.idx_dze_insert_extfile_text+
"' class='duzon_dialog_body_urlform' style='width:308px !important' /></td>";b+="</tr>";b+="</table>";b+="</form>";b+="<div id='"+this.idx_dze_insert_extfile_link_box+"' style='display:none'></div>";b+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+"' style='width:100%;height:100px;display:none'></iframe>";return b+"</div>"}catch(c){dalert(c)}},uploadExtFile:function(){try{var a=g_objLayerKit.getLayerDocument().dze_insert_extfile_form,b=a.dze_up_extfile.value.split(".").pop().toLowerCase();
if(!0!==this.checkInsertFileExt(b))alert(this.allow_file_ext_array.join(",")+" "+ID_RES_DIALOG_ALERT_ALLOW_FORMAT),a.dze_up_extfile.value="";else if(!0===dzeUiConfig.bUseContentExtUpload)g_objExtUploader.initWithUploadItem(a,CONST_DZE_UPLOAD_TYPE_FILE);else{var c=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe);c.attachEvent?c.attachEvent("onload",duzon_dialog.onloadActionIframeInsertExtFile):c.addEventListener("load",duzon_dialog.onloadActionIframeInsertExtFile,!1);a.submit()}}catch(d){dalert(d)}},
onloadActionIframeInsertExtFile:function(){try{var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe).contentWindow.document.body.textContent,b=duzon_http.parseJSON(a);if("success"!=b.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR);else{DZE_UPLOAD_EVENT.setComplete(duzon_dialog.nEditNumber,b);b.url=getFullUrlFromPath(b.url);var c=g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).value.split(".").pop().toLowerCase(),d=duzon_dialog.setFileExtIconPath(c),e=1==dzeUiConfig.attachFileExtIconView?
"<a href='"+b.url+"' type='dzeExtFile' title=\"\" alt='"+b.filename+"' style=\"background-image: url("+d+');background-repeat: no-repeat;background-position: left top;padding:2px 0 2px 18px;margin:0 8px 0 8px;color:#000000;text-decoration:none;font-weight:bold;"  >'+b.filename+"</a>"+duzon_dialog.dze_bookmark_last_tag+" ":"<a href='"+b.url+"' type='dzeExtFile' title=\"\" alt='"+b.filename+'\' style="color:#000000;text-decoration:none;font-weight:bold;"  >'+b.filename+"</a>"+duzon_dialog.dze_bookmark_last_tag+
" ";g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_link_box).innerHTML=e;g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value=b.filename}}catch(f){dalert(f)}},insertExtFileContent:function(){try{var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_link_box);if(""==a.innerHTML.trim())alert(ID_RES_DIALOG_ALERT_SELECTFILE),g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).focus();else{var b=a.getElementsByTagName("a")[0];b.title=
g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value;b.innerHTML=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value;var c=a.innerHTML;this.closeDialog();addHTMLContent(c,null,0,this.nEditNumber)}}catch(d){dalert(d)}},checkInsertFileExt:function(a){try{a=a.toLowerCase();for(var b=!1,c=0;c<this.allow_file_ext_array.length;c++)if(this.allow_file_ext_array[c]==a){b=!0;break}return b}catch(d){dalert(d)}},setFileExtIconPath:function(a){try{a=a.toLowerCase();
var b="toolbar_btn_insert_file.png";!0===this.checkInsertFileExt(a)&&("docx"==a&&(a="doc"),"xlsx"==a&&(a="xls"),"pptx"==a&&(a="ppt"),b="ico_"+a+".png");return dzeEnvConfig.strPath_Image+"toolbar/"+b}catch(c){dalert(c)}},modifyExtFileContent:function(){try{this.setEditorSelection();var a=getSelectionParentElement(duzon_dialog.nEditNumber,"A");null!=a&&(a.innerHTML=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value,a.title=g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value);
this.closeDialog()}catch(b){dalert(b)}},m_BtnDlg:dzeBtnDlg,getBtnDlg:function(){return duzon_dialog.m_BtnDlg},makeShapeStyleItemHTML:function(a,b,c,d){a=dzeEnvConfig.strPath_Image+"shapes/"+c[a][b].content;a=getFullUrlFromPath(a);return"<img style='margin:4px;align:center;' src='"+a+"' >"},getMaxArrayList:function(a,b){try{if(a.length>b){var c=a.length-b;for(b=0;b<c;b++)a.shift()}return a}catch(d){return dalert(d),[]}},makeComboInputForm:function(a,b,c,d,e){try{var f="<select name='"+a+"' id='"+a+
"'class='classic'",g="";!1===fnObjectCheckNull(c)&&"number"===typeof c&&(g="width:"+c+"px !important;");!1===fnObjectCheckNull(d)&&"number"===typeof d&&(g+="height:"+d+"px !important;");!1===fnObjectCheckNull(e)&&"number"===typeof e&&(g+="margin-right:"+e+"px !important;");g&&0<g.length&&(f+=" style='"+g+"'");f+=">";c=function(a){return"<option value='"+b[a].value+"'>"+b[a].text+"</option>"};"dze_style_font_family"==a&&(c=function(a){return"<option value='"+b[a].value+"' style='font-family:"+b[a].value+
";'>"+b[a].text.replace(/["']/g,"")+"</option>"});for(a=0;a<b.length;a++)f+=c(a);return f+"</select>"}catch(h){dalert(h)}},makeComboInputFormWithArray:function(a,b){try{a="<select name='"+a+"' id='"+a+"'>";for(var c=0;c<b.length;c++)a+='<option value="'+b[c]+'">'+b[c]+"</option>";return a+"</select>"}catch(d){dalert(d)}},idx_dze_style_font_preview:"idx_dze_style_font_preview",dze_font_propertys:"bold italic underline strike superscript subscript normal".split(" "),max_letterspacing:10,min_letterspacing:-5,
getStyleFontContent:function(){try{for(var a=[],b=1;b<g_arrFontName.length;b++)a.push({value:g_arrFontName[b],text:g_arrFontName[b].replace(/["']/g,"","")});this.checkFontPropertyList=[];var c="";c+="<div class='duzon_dialog_content_medium'>";c+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BASIC+"</div>";c+="<table width='100%' border='0' celladding='0' cellspacing='0'>";c+="<tr>";c+="<td width='60'>"+ID_RES_CONST_STRING_FONT_NAME+" </td>";c+="<td width='170'>"+this.makeComboInputForm("dze_style_font_family",
a)+"</td>";c+="<td width='' align='right'>"+ID_RES_DIALOG_STRING_LETTERSPACING+" </td>";c+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_font_spacing","pt",this.max_letterspacing,this.min_letterspacing,0,"duzon_dialog.preveiwDzeLetterSpacing")+"</div></td>";c+="</tr>";c+="<tr>";c+="<td colspan='4' height='5'></td>";c+="</tr>";c+="<tr>";c+="<td>"+ID_RES_CONST_STRING_FONT_SIZE+" </td>";c+="<td colspan='3'>"+this.makeSpinnerInputForm("dze_style_font_size",
"pt","36","6",g_strBodyFontSize,"duzon_dialog.preveiwDzeFontSize")+"</td>";c+="</tr>";c+="</table>";c+="<div class='duzon_dialog_label_separator'></div>";c+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_PROPERTY+"</div>";c+="<table width='100%' border='0' celladding='0' cellspacing='0'>";c+="<tr>";c+="<td colspan='4'>";var d=a="",e="";for(b=0;b<this.dze_font_propertys.length;b++)a="idx_dze_style_font_"+this.dze_font_propertys[b],d=dzeEnvConfig.strPath_Image+"dialog/btn_style_font_"+
this.dze_font_propertys[b]+".png",e=eval("ID_RES_CONST_STRING_"+this.dze_font_propertys[b].toUpperCase()),c+="<div class='dze_style_font_propery_set' id='"+a+"'><img src='"+d+"' alt='' title='"+e+"' width='28' height='28'></div>";c+="</td>";c+="</tr>";c+="<tr><td colspan='4' height='10'></tr>";c+="<tr>";c+="<td width='60'>"+ID_RES_CONST_STRING_FORE_COLOR+" </td>";c+="<td width='170'>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_forecolor",90)+"</td>";c+="<td>"+ID_RES_CONST_STRING_BACK_COLOR+
" </td>";c+="<td width='90' align='right'>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_backcolor",90)+"</td>";c+="</tr>";c+="<tr><td colspan='4' height='10'></tr>";c+="</table>";c+="<div class='dze_style_font_preview_container'><div class='dze_style_font_preview'><span id='"+this.idx_dze_style_font_preview+"'>"+ID_RES_DIALOG_STRING_FONT_STYLE_PREVIEW+"</span></div></div>";return c+"</div>"}catch(f){dalert(f)}},preveiwDzeFontSize:function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.fontSize=
a+"pt"},preveiwDzeLetterSpacing:function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.letterSpacing=a+"pt"},checkFontPropertyList:[],addFontPropertyList:function(a){try{inArray(a,this.checkFontPropertyList)?this.removeFontPropertyList(a):duzon_dialog.checkFontPropertyList.push(a),"normal"!=a&&inArray("normal",this.checkFontPropertyList)&&this.removeFontPropertyList("normal"),inArray("normal",this.checkFontPropertyList)&&(this.checkFontPropertyList=["normal"]),"superscript"==a&&inArray("subscript",
this.checkFontPropertyList)&&this.removeFontPropertyList("subscript"),"subscript"==a&&inArray("superscript",this.checkFontPropertyList)&&this.removeFontPropertyList("superscript")}catch(b){dalert(b)}},removeFontPropertyList:function(a){try{for(var b=[],c=0;c<this.checkFontPropertyList.length;c++)a!=this.checkFontPropertyList[c]&&b.push(this.checkFontPropertyList[c]);this.checkFontPropertyList=b}catch(d){dalert(d)}},selectFontProperty:function(a){try{dlog("selectFontProperty"),dlog("execName:"+a),
this.addFontPropertyList(a),dlog(this.checkFontPropertyList),this.setFontPropertyButtons(),this.setFontProperysPreview()}catch(b){dalert(b)}},removeGabageSelectionFontPropertyList:function(){try{for(var a=[],b=0;b<this.selectionFontStyleList.fontPropertyList.length;b++)"normal"!=this.selectionFontStyleList.fontPropertyList[b]&&a.push(this.selectionFontStyleList.fontPropertyList[b]);this.selectionFontStyleList.fontPropertyList=a}catch(c){dalert(c)}},setFontPropertyButtons:function(){try{for(var a=
"",b=0;b<this.dze_font_propertys.length;b++)a="idx_dze_style_font_"+this.dze_font_propertys[b],inArray(this.dze_font_propertys[b],this.checkFontPropertyList)?(dlog("___ok___:"+this.dze_font_propertys[b]),$_(a).className="dze_style_font_propery_set_down"):$_(a).className="dze_style_font_propery_set"}catch(c){dalert(c)}},setFontProperysPreview:function(){try{this.unsetFontProperysPreview();for(var a="",b=0;b<this.checkFontPropertyList.length;b++){a=this.checkFontPropertyList[b];if("normal"==a){this.unsetFontProperysPreview();
break}"bold"==a&&($_(this.idx_dze_style_font_preview).style.fontWeight="bold");"italic"==a&&($_(this.idx_dze_style_font_preview).style.fontStyle="italic");"underline"==a&&($_(this.idx_dze_style_font_preview).style.textDecoration="underline");"strike"==a&&($_(this.idx_dze_style_font_preview).style.textDecoration="line-through");inArray("underline",this.checkFontPropertyList)&&inArray("strike",this.checkFontPropertyList)&&($_(this.idx_dze_style_font_preview).style.textDecoration="underline line-through");
"superscript"==a&&($_(this.idx_dze_style_font_preview).innerHTML="<sup>"+$_(this.idx_dze_style_font_preview).innerHTML+"</sup>");"subscript"==a&&($_(this.idx_dze_style_font_preview).innerHTML="<sub>"+$_(this.idx_dze_style_font_preview).innerHTML+"</sub>")}}catch(c){dalert(c)}},unsetFontProperysPreview:function(){try{$_(this.idx_dze_style_font_preview).style.fontWeight="",$_(this.idx_dze_style_font_preview).style.fontStyle="",$_(this.idx_dze_style_font_preview).style.textDecoration="",$_(this.idx_dze_style_font_preview).style.textDecoration=
"",$_(this.idx_dze_style_font_preview).innerHTML=$_(this.idx_dze_style_font_preview).innerHTML.replace(/<\/*sup>/gi,""),$_(this.idx_dze_style_font_preview).innerHTML=$_(this.idx_dze_style_font_preview).innerHTML.replace(/<\/*sub>/gi,"")}catch(a){dalert(a)}},dze_editor_default_font_size:"9",selectionFontStyleList:{fontPropertyList:[],fontFamily:"",fontSize:"",color:"",backgroundColor:"",letterSpacing:""},initSelectionFontStyleList:function(a){try{"undefined"==typeof a||null==a?(this.selectionFontStyleList.fontPropertyList=
[],this.selectionFontStyleList.fontFamily="",this.selectionFontStyleList.fontSize="",this.selectionFontStyleList.color="",this.selectionFontStyleList.backgroundColor="",this.selectionFontStyleList.letterSpacing=""):(null==a[DZE_TEXTATT_FONTNAME]&&(a[DZE_TEXTATT_FONTNAME]=""),null==a[DZE_TEXTATT_FONTSIZE]&&(a[DZE_TEXTATT_FONTSIZE]=""),null==a[DZE_TEXTATT_FORECOLOR]&&(a[DZE_TEXTATT_FORECOLOR]=""),null==a[DZE_TEXTATT_BACKCOLOR]&&(a[DZE_TEXTATT_BACKCOLOR]=""),null==a[DZE_TEXTATT_LETTERSPACING]&&(a[DZE_TEXTATT_LETTERSPACING]=
""),this.selectionFontStyleList.fontFamily=a[DZE_TEXTATT_FONTNAME],this.selectionFontStyleList.fontSize=a[DZE_TEXTATT_FONTSIZE].toLowerCase(),this.selectionFontStyleList.color=a[DZE_TEXTATT_FORECOLOR],this.selectionFontStyleList.backgroundColor=a[DZE_TEXTATT_BACKCOLOR],this.selectionFontStyleList.letterSpacing=a[DZE_TEXTATT_LETTERSPACING].toLowerCase(),0<=this.selectionFontStyleList.fontSize.indexOf("px")?(this.selectionFontStyleList.fontSize=g_objCommonUtil.convPxToPt(this.selectionFontStyleList.fontSize),
this.selectionFontStyleList.fontSize=0>this.selectionFontStyleList.fontSize?"":this.selectionFontStyleList.fontSize+"pt"):0>this.selectionFontStyleList.fontSize.indexOf("pt")&&(this.selectionFontStyleList.fontSize=""),0<=this.selectionFontStyleList.letterSpacing.indexOf("px")?(this.selectionFontStyleList.letterSpacing=g_objCommonUtil.convPxToPt(this.selectionFontStyleList.letterSpacing),this.selectionFontStyleList.letterSpacing=0>this.selectionFontStyleList.letterSpacing?"":this.selectionFontStyleList.letterSpacing+
"pt"):0>this.selectionFontStyleList.letterSpacing.indexOf("pt")&&(this.selectionFontStyleList.letterSpacing=""))}catch(b){dalert(b)}},checkSelectionFontStyle:function(){try{if(strSelectionType=window.attachEvent?g_objEditorDocument[this.nEditNumber].selection.type:getSelectionTypeForUpdateUI(),strSelectionType=strSelectionType.toLowerCase(),ID_STRING_NAME_TEXT==strSelectionType||ID_STRING_NAME_NONE==strSelectionType){this.initSelectionFontStyleList();for(var a="",b=0,c=0;c<this.dze_font_propertys.length-
1;c++)if("normal"!=this.dze_font_propertys[c]){a=this.dze_font_propertys[c].toUpperCase();b=eval("ID_COMMAND_"+a);"STRIKE"==a&&(a="StrikeThrough");var d=handlerUI.queryCommandStatus(g_objEditorDocument[this.nEditNumber],b,a,this.nEditNumber,-1,strSelectionType);ID_STRING_NAME_CHECKED==d&&(this.selectFontProperty(this.dze_font_propertys[c]),this.selectionFontStyleList.fontPropertyList.push(this.dze_font_propertys[c]))}var e=g_objPropertyUtil.getSelectionAttributeValue(this.nEditNumber);"undefined"!=
typeof e&&null!=e&&this.initSelectionFontStyleList(e);var f=this.selectionFontStyleList.fontFamily,g=$_("dze_style_font_family");if(!g.querySelector("option[value='"+f+"']")){var h=document.createElement("option");h.style.fontFamily=f;h.setAttribute("value",f);h.innerHTML=f.replace(/["']/g,"");g.firstChild?g.insertBefore(h,g.firstChild):g.appendChild(h)}g.value=f;""!=$_("dze_style_font_family").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.fontFamily=$_("dze_style_font_family").value);
$_("dze_style_font_size").value=this.selectionFontStyleList.fontSize.replace(/(pt|px)/gi,"");""!=$_("dze_style_font_size").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.fontSize=$_("dze_style_font_size").value+"pt");g_objColorComboBoxUtil.setColorValue("dze_font_forecolor",this.selectionFontStyleList.color);""!=this.selectionFontStyleList.color&&($_(duzon_dialog.idx_dze_style_font_preview).style.color=this.selectionFontStyleList.color);g_objColorComboBoxUtil.setColorValue("dze_font_backcolor",
this.selectionFontStyleList.backgroundColor);""!=this.selectionFontStyleList.backgroundColor&&($_(duzon_dialog.idx_dze_style_font_preview).style.backgroundColor=this.selectionFontStyleList.backgroundColor);$_("dze_style_font_spacing").value=checkDefaultValue(this.selectionFontStyleList.letterSpacing.replace(/(pt|px)/gi,""),"0");""!=$_("dze_style_font_spacing").value&&($_(duzon_dialog.idx_dze_style_font_preview).style.letterSpacing=$_("dze_style_font_spacing").value+"pt")}}catch(k){dalert(k)}},setStyleFont:function(){try{this.setEditorSelection();
var a=$_("dze_style_font_family").value;this.selectionFontStyleList.fontFamily!=a&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_FAMILY,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_NAME][0],g_objComboBoxWin.setComboBox(a,!1));var b=$_("dze_style_font_size").value;""!=b&&(b+="pt");this.selectionFontStyleList.fontSize!=b&&(g_nLetterOperationType=ID_LETTER_OPERATION_FONT_SIZE,g_objComboBoxWin.strComboBoxCommand=g_arrConst[ID_COMMAND_FONT_SIZE][0],g_objComboBoxWin.setComboBox(b,!1));
var c=g_objColorComboBoxUtil.getColorValue("dze_font_forecolor");if(this.selectionFontStyleList.color!=c){var d=document.getElementById("TB_SETFORECOLOR_"+duzon_dialog.nEditNumber+"_SUB");duzon_dialog.selectColorCode(c,d);g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply(c,!1,DZE_LETTER_COMMAND_FONT_COLOR)}var e=g_objColorComboBoxUtil.getColorValue("dze_font_backcolor");if(this.selectionFontStyleList.backgroundColor!=e){var f=document.getElementById("TB_SETBACKCOLOR_"+duzon_dialog.nEditNumber+
"_SUB");duzon_dialog.selectColorCode(e,f);g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber);fnColorCellApply(e,!1,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR)}var g=$_("dze_style_font_spacing").value;""!=g&&(g+="pt");this.selectionFontStyleList.letterSpacing!=g&&(-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),g_objLetterSpacingWin.fnLetterSpacingCellClick(g,!1));a=c=b="";for(d=0;d<this.dze_font_propertys.length;d++)if(c=
b=this.dze_font_propertys[d],"strike"==b.toLowerCase()&&(c="StrikeThrough"),inArray("normal",this.checkFontPropertyList)){for(var h=0;h<this.selectionFontStyleList.fontPropertyList.length;h++)a=this.selectionFontStyleList.fontPropertyList[h],"strike"==this.selectionFontStyleList.fontPropertyList[h].toLowerCase()&&(a="StrikeThrough"),fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,a);break}else{a:{e=b;try{f=!1;if(!0===inArray(e,duzon_dialog.selectionFontStyleList.fontPropertyList)&&!1===inArray(e,
duzon_dialog.checkFontPropertyList)||!1===inArray(e,duzon_dialog.selectionFontStyleList.fontPropertyList)&&!0===inArray(e,duzon_dialog.checkFontPropertyList))if("superscript"===e){if(!0===inArray(e,duzon_dialog.checkFontPropertyList)||!1===inArray("subscript",duzon_dialog.checkFontPropertyList)&&!0===inArray(e,duzon_dialog.selectionFontStyleList.fontPropertyList))f=!0}else if("subscript"===e){if(!0===inArray(e,duzon_dialog.checkFontPropertyList)||!1===inArray("superscript",duzon_dialog.checkFontPropertyList)&&
!0===inArray(e,duzon_dialog.selectionFontStyleList.fontPropertyList))f=!0}else f=!0;h=f;break a}catch(k){dalert(k)}h=void 0}!0===h&&fnHandler_SupportCommand_Main(duzon_dialog.nEditNumber,c)}duzon_dialog.resetSelection=!0}catch(k){dalert(k)}},getWebEditorInfoContent:function(){try{var a=g_browserCHK.getBrowserName();!1===objOnefficeLoader.m_bDomainDuzon&&changeCss(".dze_logo_container","background-image","url(./image/Oneffice_beta.png)",document);var b="";b+="<div class='duzon_dialog_content_medium'>";
b+="<div class='dze_logo_container'></div>";b+="<div class='dze_editor_url_info'><a href='http://www.douzone.com' target='_blank'>http://www.douzone.com</a></div>";b+="<div class='dze_editor_url_info'>"+ID_RES_DIALOG_STRING_VERSION+" : ONEFFICE "+objOnefficeLoader.getVer()+"</div>";b+="<div class='dze_editor_copyright_info'>Copyright Douzone Bizon, All right reserved.</div>";b+="<div class='dze_editor_agent_info' title='"+a+"'>Agent : "+a.substring(0,100)+"</div>";b+="<div class='dze_editor_license_info' id='dze_idx_btn_view_license_info_contentbox'>License Info \u25bc</div>";
return b+"<div class='dze_editor_license_info_contentbox' id='dze_idx_license_info_contentbox' style='display:none'></div></div>"}catch(c){dalert(c)}},getOnefficeLicenseInfo:function(){try{dynamicScriptCall("js/const/oneffice_license_info.js",function(){for(var a=document.getElementById("dze_idx_license_info_contentbox"),b=document.createElement("ul"),c,d=0;d<licenseInfo.length;d++)c=document.createElement("li"),c.innerHTML=licenseInfo[d],b.appendChild(c);a.appendChild(b)})}catch(a){dalert(a)}},dze_idx_shortcuts_content:"dze_idx_shortcuts_content",
getShortCutsInfoContent:function(){try{var a="<div class='duzon_dialog_content_large_map'>";a+="<div class='dze_shortcuts_content' id='"+this.dze_idx_shortcuts_content+"' style='-webkit-user-select: text; -ms-user-select: text; user-select: text;'></div>";return a+"</div>"}catch(b){dalert(b)}},setShortCutsInfo:function(){try{dynamicScriptCall("js/const/shortcuts_info_const.js",function(){var a="<table width='100%' border='1' bordercolor='red' cellspacing='0' cellpadding='0' class='dze_shortcuts_table' style='margin-bottom:20px;'><tr>"+
("<td width='100' class='dze_shortcuts_table_head'>"+ID_RES_DIALOG_SHORTCUTS_TITLE+"</td><td width='148' class='dze_shortcuts_table_head'>"+ID_RES_DIALOG_SHORTCUTS_MENU_PATH+"</td><td width='143' class='dze_shortcuts_table_head'>"+ID_RES_DIALOG_SHORTCUTS_FUNCTION+"</td>");a+="</tr>";for(var b,c,d=0;d<shortcutsInfo.length;d++){b=shortcutsInfo[d];a+="<tr>";a+="<td colspan='3' class='dze_shortcuts_table_title'>"+b.category+"</td>";a+="</tr>";for(var e=0;e<b.data.length;e++)c=b.data[e],a+="<tr>",a+="<td class='dze_shortcuts_table_body'>"+
c[0].replace(/\s\/\s/,"<br />")+"</td><td class='dze_shortcuts_table_body'>"+c[1]+"</td><td class='dze_shortcuts_table_body'>"+c[2]+"</td>",a+="</tr>"}a+="</table>";$_(duzon_dialog.dze_idx_shortcuts_content).innerHTML=a;g_objPositionUtil.setObjectPosition(null,cmnDlg.getDlg(),"center")})}catch(a){dalert(a)}},curr_forecolor:[],curr_backcolor:[],curr_cell_backcolor:[],curr_image_border_backcolor:[],curr_table_border_backcolor:[],curr_txbx_fillcolor:[],curr_txbx_linecolor:[],curr_highlighter_backcolor:[],
curr_video_border_backcolor:[],ext_contents_container:null,ext_contents_sub_container:null,idx_dze_ext_item_overlayer:"idx_dze_ext_item_overlayer",affectedColorPreviewSet:!1,color_picker_mode:"none",nExtendsDlgType:0,extendsDlgTypeInfo:[{},{}],onload:null,makeExtendsDlgInfo:function(){try{this.extendsDlgTypeInfo[0].length||(this.extendsDlgTypeInfo[DZE_EXTENDS_COLOR_PICKER]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list",previewLetterOperation:!0},
this.extendsDlgTypeInfo[DZE_EXTENDS_EMOTICON]={strExtendsDlgType:"emoticons",jsSrc:"const/insert_emoticons_const.js",refInfoDB:"dzeEmoticons",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_COPY_EXT]={strExtendsDlgType:"copy_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeCopyExtList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_PASTE_EXT]={strExtendsDlgType:"paste_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzePasteExtList",previewLetterOperation:!1},
this.extendsDlgTypeInfo[DZE_EXTENDS_INSERT_PARAGRAPH]={strExtendsDlgType:"insert_paragraph",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeInsertParagraphList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_DELETE_EXT]={strExtendsDlgType:"table_delete_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableDeleteExtList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_SELECT]={strExtendsDlgType:"table_select",jsSrc:"const/general_commandlist_const.js",
refInfoDB:"dzeTableSelectList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_FORMULA_EXT]={strExtendsDlgType:"table_formula_ext",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableFomulaExtList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_NUMBER_FORMAT]={strExtendsDlgType:"table_number_format",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeTableNumberFormatList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_TYPE]=
{strExtendsDlgType:"image_border_type",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderTypeList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_THICKNESS]={strExtendsDlgType:"image_border_thickness",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderThicknessList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_IMAGE_BORDER_COLOR]={strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list",
previewLetterOperation:!0},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_THICKNESS]={strExtendsDlgType:"table_border_thickness",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderThicknessList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_TYPE]={strExtendsDlgType:"table_border_type",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjectBorderTypeList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_BORDER_COLOR]={strExtendsDlgType:"color_picker",
jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list",previewLetterOperation:!0},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_CELL_ALIGN]={strExtendsDlgType:"table_cell_align",jsSrc:"const/common_popup_const.js",refInfoDB:"dzeTableCellAlignList",previewLetterOperation:!0},this.extendsDlgTypeInfo[DZE_EXTENDS_TABLE_CREATE]={strExtendsDlgType:"table_create",jsSrc:"const/create_table_info.js",refInfoDB:"dzeCreateTableInfo",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_HIGHLIGHTER_COLOR]=
{strExtendsDlgType:"color_picker",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_color_list",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_SVG_LINE_STYLE]={strExtendsDlgType:"common_border_type",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeSVGObjLineStyleList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_SHAPES]={strExtendsDlgType:"shapes",jsSrc:"const/insert_shapes_const.js",refInfoDB:"dzeShapes",previewLetterOperation:!0},this.extendsDlgTypeInfo[DZE_EXTENDS_HEADER]=
{strExtendsDlgType:"header",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeHeaderExtList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_FOOTER]={strExtendsDlgType:"footer",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeFooterExtList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_HEADER_FOOTER_OPTIONS]={strExtendsDlgType:"header_footer_options",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeHeaderFooterOptions",previewLetterOperation:!1},
this.extendsDlgTypeInfo[DZE_EXTENDS_BRING_FORWARD]={strExtendsDlgType:"forward",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeBringForwardList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_SEND_BACKWARD]={strExtendsDlgType:"backward",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeSendBackwardList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_ROTATION_LIST]={strExtendsDlgType:"RotationList",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjRotationList",
previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_OBJ_TXT_VALIGN]={strExtendsDlgType:"TxtVAlign",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjTxtVAlignList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_OBJ_ALIGN]={strExtendsDlgType:"objAttAlign",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjAlignList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_OBJ_TXT_LAYOUT]={strExtendsDlgType:"objAttTxtLayout",jsSrc:"const/general_commandlist_const.js",
refInfoDB:"dzeObjTxtLayoutList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_SHAPE_STYLE]={strExtendsDlgType:"ShapeStyle",jsSrc:"const/style_colorset_const.js",refInfoDB:"dze_shape_style",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_LINE_ARROW]={strExtendsDlgType:"line_arrow",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeLineArrowList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_INSERT_NEW_PAGE]={strExtendsDlgType:"insert_new_page",
jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeObjInsertNewPageList",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_PGNUM]={strExtendsDlgType:"pgnum",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzePgNum",previewLetterOperation:!1},this.extendsDlgTypeInfo[DZE_EXTENDS_INSERT_FORM_CONTROL]={strExtendsDlgType:"insert_form_control",jsSrc:"const/general_commandlist_const.js",refInfoDB:"dzeInsertFormControl",previewLetterOperation:!1})}catch(a){dalert(a)}},getDisplayExtendsDlgType:function(){switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_COLOR_PICKER:case DZE_EXTENDS_IMAGE_BORDER_COLOR:case DZE_EXTENDS_TABLE_BORDER_COLOR:case DZE_EXTENDS_HIGHLIGHTER_COLOR:var a=
DZE_DISPLAY_EXTENDS_COLOR_PICKER;break;case DZE_EXTENDS_SHAPE_STYLE:case DZE_EXTENDS_EMOTICON:a=DZE_DISPLAY_EXTENDS_EMOTICON;break;case DZE_EXTENDS_COPY_EXT:case DZE_EXTENDS_PASTE_EXT:case DZE_EXTENDS_INSERT_PARAGRAPH:case DZE_EXTENDS_TABLE_DELETE_EXT:case DZE_EXTENDS_TABLE_SELECT:case DZE_EXTENDS_TABLE_FORMULA_EXT:case DZE_EXTENDS_TABLE_NUMBER_FORMAT:case DZE_EXTENDS_IMAGE_BORDER_TYPE:case DZE_EXTENDS_LINE_ARROW:case DZE_EXTENDS_SVG_LINE_STYLE:case DZE_EXTENDS_IMAGE_BORDER_THICKNESS:case DZE_EXTENDS_TABLE_BORDER_THICKNESS:case DZE_EXTENDS_TABLE_BORDER_TYPE:case DZE_EXTENDS_HEADER:case DZE_EXTENDS_FOOTER:case DZE_EXTENDS_BRING_FORWARD:case DZE_EXTENDS_SEND_BACKWARD:case DZE_EXTENDS_OBJ_TXT_LAYOUT:case DZE_EXTENDS_OBJ_ALIGN:case DZE_EXTENDS_OBJ_TXT_VALIGN:case DZE_EXTENDS_ROTATION_LIST:case DZE_EXTENDS_SHAPE_STYLE:case DZE_EXTENDS_INSERT_NEW_PAGE:case DZE_EXTENDS_PGNUM:case DZE_EXTENDS_INSERT_FORM_CONTROL:a=
DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST;break;case DZE_EXTENDS_HEADER_FOOTER_OPTIONS:a=DZE_DISPLAY_EXTENDS_CHECKED_COMMANDLIST;break;case DZE_EXTENDS_TABLE_CELL_ALIGN:a=DZE_DISPLAY_EXTENDS_COMMON_POPUP;break;case DZE_EXTENDS_TABLE_CREATE:a=DZE_DISPLAY_EXTENDS_TABLE_CREATE;break;case DZE_EXTENDS_SHAPES:a=DZE_DISPLAY_EXTENDS_SHAPES;break;default:a=DZE_DISPLAY_EXTENDS_NONE}return a},createEmoticonsTable:function(a){try{var b="shapestyle"==a.toLowerCase()?!0:!1,c=document.createElement("table");c.setAttribute("cellspacing",
"0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");a=b?7:8;for(var d=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB),e=0;e<d.length;e++){b||duzon_dialog.createTitleRowCell(c,7,d[e].name);duzon_dialog.createEmptyRowCell(c,2,a);var f=c.insertRow();f.setAttribute("height","12");var g=f.insertCell();g.setAttribute("width","3");for(var h=0;h<a;h++){var k=duzon_dialog.createObjUnitDiv(e,h,d,null,null,null,null);g=f.insertCell();g.appendChild(k);3!=h||b||(g=
f.insertCell(),g.setAttribute("width","3"),f=c.insertRow(),f.setAttribute("height","12"),g=f.insertCell(),g.setAttribute("width","3"))}}return c}catch(l){dalert(l)}return null},view2DepthExtDlg:function(a,b,c){try{switch(b){case 2:duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_THICKNESS;var d=ID_COMMAND_IMAGE_BORDER_THICKNESS;break;case 3:duzon_dialog.nExtendsDlgType=DZE_EXTENDS_SVG_LINE_STYLE;d=ID_COMMAND_IMAGE_BORDER_TYPE;break;case 4:duzon_dialog.nExtendsDlgType=DZE_EXTENDS_LINE_ARROW;d=
ID_COMMAND_LINE_ARROW;break;default:d=b}duzon_menubar.twodepth_menu_container=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);if(null!=duzon_menubar.twodepth_menu_container){if(duzon_menubar.prev_command_id==d){duzon_menubar.twodepth_menu_container.style.display="block";return}duzon_menubar.hideTwoDepthMenu(d)}duzon_menubar.prev_command_id=d;duzon_menubar.twodepth_menu_container=g_objLayerKit.getLayerDocument().createElement("div");duzon_menubar.twodepth_menu_container.id=
duzon_menubar.idx_twodepth_menu_container;duzon_menubar.twodepth_menu_container.className="twodepth_extdlg_container";g_objLayerKit.getLayerDocument().body.appendChild(duzon_menubar.twodepth_menu_container);var e=a.getBoundingClientRect(),f=duzon_dialog.get2DepthExtDlg(b,e.right,e.top);duzon_menubar.twodepth_menu_container.appendChild(f);g_objPropertyUtil.setOpacity(duzon_menubar.twodepth_menu_container,0);duzon_menubar.twodepth_menu_container.style.display="block";duzon_menubar.twodepth_menu_container.borderStyle=
"none";duzon_menubar.twodepth_menu_container.borderWidth="0px"}catch(g){dalert(g)}},get2DepthExtDlg:function(a,b,c){try{var d=null;duzon_dialog.makeExtendsDlgInfo();var e=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType;d=document.createElement("div");d.className="dze_ext_dialog_container";d.id=e+"_2depth"+a;d.onclick=function(a){TBCancelBubbleEvent(a?a:window.event)};d.onmousedown=function(a){};d.onmouseover=function(a){a=a?a:window.event;g_objTableResize.setTableMoveLine(!1,
!1,0,0,0,0,0);TBCancelBubbleEvent(a)};var f=function(e){d.appendChild(e);g_objPropertyUtil.setOpacity(this.ext_contents_container,0);d.style.display="block";duzon_menubar.twodepth_menu_container.style.top=a===ID_COMMAND_PGNUM_TEMPLATE_UP||a===ID_COMMAND_PGNUM_TEMPLATE_DOWN?c-3+"px":c-1+"px";duzon_menubar.twodepth_menu_container.style.left=b+"px";duzon_dialog.animateDlg(duzon_menubar.twodepth_menu_container,"right")};a===ID_COMMAND_PGNUM_TEMPLATE_UP?f(PageNumberDlg.getTemplateContents(d,!0)):a===ID_COMMAND_PGNUM_TEMPLATE_DOWN?
f(PageNumberDlg.getTemplateContents(d,!1)):dynamicScriptCall("js/"+duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].jsSrc,function(){var a=null,b=window[duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB];switch(duzon_dialog.getDisplayExtendsDlgType()){case DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST:a=duzon_dialog.createGeneralCommandListTable(b,0)}f(a)});return d}catch(g){dalert(g)}},dialogExtStatus:!1,viewExtendsDlg:function(a,b,c,d,e,f,g,h,k,l){try{if(g_nActiveEditNumber=
this.nEditNumber=b,duzon_dialog.dialogExtStatus=!0,dzeWebSearch.hideWebSearchBtn(),g_objPasteOptionMenu.remove(),pageManager.getInstance().hideButtonContainer(),null!=duzon_dialog.ext_contents_container)duzon_dialog.closeExtendsDlg();else{duzon_dialog.color_picker_mode="basic";g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);cmnDlg.isShowDlg()||g_objInsertUtil.saveSelectionRange_IE(0,b);"undefined"==typeof f&&(f="toolbar");"undefined"==typeof g&&(g=!0);duzon_dialog.makeExtendsDlgInfo();var m=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType;
"undefined"==typeof duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation=!1);var n=document.createElement("div");duzon_dialog.ext_contents_container=n;n.className="dze_ext_dialog_container";n.id=m+"_"+a.id;n.onclick=function(a){TBCancelBubbleEvent(a?a:window.event)};n.onmouseover=function(a){TBCancelBubbleEvent(a?a:window.event)};0<=a.id.indexOf("_SUB")?document.getElementById(a.id.replace(/_SUB/,
"")).parentNode.appendChild(n):a.parentNode.appendChild(n);"toolbar"==f&&!0===dzeUiConfig.bTBPreviewLetterOperation&&duzon_dialog.getDisplayExtendsDlgType()==DZE_DISPLAY_EXTENDS_COLOR_PICKER&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&(g_objLayerEventUtil.canSaveTableSelectedCellHTML(this.nEditNumber)?g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(this.nEditNumber)):g_objUndoRedo.registerUndoRedoStack(0,this.nEditNumber));var p=function(b){n.appendChild(b);
"undefined"!=typeof d&&null!=d&&0<d.length&&(b="horizontal"===l?cmnDlg.createBtnBox(2,d,e):duzon_dialog.makeBottomBtnProcess(d,e,f),n.appendChild(b));g_objPropertyUtil.setOpacity(n,0);n.style.display="block";duzon_dialog.resizeExtContentsContainerPos(a,!0);if("toolbar"==f&&(duzon_dialog.addExtContentsEvent(),duzon_dialog.getDisplayExtendsDlgType()==DZE_DISPLAY_EXTENDS_COLOR_PICKER&&!0===dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&
duzon_dialog.addColorPreviewEventForTB(a),duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_COLOR&&dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation)){var c=GetCurTable(duzon_dialog.nEditNumber);g_objLayerEventUtil.saveTableHTML(c);n.onmouseleave=function(){g_objLayerEventUtil.restoreTableHTML(c)}}duzon_dialog.animateDlg(n,"down");k&&k(n);duzon_dialog.onload&&(duzon_dialog.onload(n),duzon_dialog.onload=null)}.bind(this);
h?this.getExtendDialogContentFromContent(p,h):this.getExtendDialogContentFromScript(p,a,f,c,g)}}catch(q){g_objPropertyUtil.setOpacity(n,1),dalert(q)}},getExtendDialogContentFromScript:function(a,b,c,d,e){try{dynamicScriptCall("js/"+duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].jsSrc,function(){var f=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType,g=duzon_dialog.nEditNumber,h=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB);
switch(duzon_dialog.getDisplayExtendsDlgType()){case DZE_DISPLAY_EXTENDS_COLOR_PICKER:!0===dzeUiConfig.showTBRecentColor&&this.updateTBRecentColorCtrl(h);f=duzon_dialog.createColorPickerTable(h,d,b,e,c);break;case DZE_DISPLAY_EXTENDS_EMOTICON:f=duzon_dialog.createEmoticonsTable(f);break;case DZE_DISPLAY_EXTENDS_GENERAL_COMMANDLIST:f=duzon_dialog.createGeneralCommandListTable(h,g);break;case DZE_DISPLAY_EXTENDS_CHECKED_COMMANDLIST:f=duzon_dialog.createCheckedCommandListTable(h,g);break;case DZE_DISPLAY_EXTENDS_COMMON_POPUP:f=
duzon_dialog.createCommonPopupTable(h,g);break;case DZE_DISPLAY_EXTENDS_TABLE_CREATE:f=duzon_dialog.createTable(h,g);break;case DZE_DISPLAY_EXTENDS_SHAPES:f=!0;1*(0<b.id.indexOf("_SUB")?document.getElementById(b.id.replace(/_SUB/,"")):b).getAttribute("orgcommandid")===ID_COMMAND_SHAPES_CHANGE&&(f=!1);f=duzon_dialog.createShapesTable(f);break;default:return}a&&a(f)}.bind(this))}catch(f){dalert(f)}},getExtendDialogContentFromContent:function(a,b){try{var c=null;if("string"===typeof b){var d=document.createDocumentFragment(),
e=document.createElement("div");e.innerHTML=b;g_objNodeUtil.moveNodesTo(d,e.firstChild);c=d}else c=b;a&&a(c)}catch(f){dalert(f)}},addColorPreviewEventForTB:function(a){try{var b=duzon_dialog.ext_contents_container;b&&(a=null,a="DIV"===b.nodeName&&g_objPropertyUtil.hasClass(b,"dze_color_picker_palettes_container")?b:b.querySelector("div.dze_color_picker_palettes_container"),a.onmouseenter=function(){g_objLayerEventUtil.canSaveTableSelectedCellHTML(duzon_dialog.nEditNumber)?(g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber)),
duzon_dialog.removeMultiCellSelectionBG()):g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)},a.onmouseleave=function(){g_objLayerEventUtil.canSaveTableSelectedCellHTML(duzon_dialog.nEditNumber)?(g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber)),duzon_dialog.recoverMultiCellSelectionBG()):g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber);duzon_dialog.affectedColorPreviewSet=!1})}catch(c){dalert(c)}},removeColorPreviewEventForTB:function(){try{var a=
duzon_dialog.ext_contents_container;if(a){var b=null;if(b="DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_color_picker_palettes_container")?a:a.querySelector("div.dze_color_picker_palettes_container"))b.onmouseenter=null,b.onmouseleave=null}}catch(c){dalert(c)}},makeBottomBtnProcess:function(a,b,c){try{var d=document.createElement("table");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");d.setAttribute("border","0");d.setAttribute("width","100%");var e=null,f=null;duzon_dialog.createEmptyRowCell(d,
8,6);duzon_dialog.createSeperateLineRowCell(d,0,6);duzon_dialog.createEmptyRowCell(d,2,6);for(var g=0;g<a.length;g++)e=d.insertRow(),e.id=g,e.className="duzon_menubar_select_item",5==a.length&&0!=g&&1!=g&&(e.onclick=function(a){a=parseInt(this.id,10);switch(a){case 2:case 3:case 4:setWindowResizeEvent(!1);duzon_dialog.view2DepthExtDlg(this,a);setWindowResizeEvent(!0);break;default:duzon_menubar.hideTwoDepthMenu()}},e.onmouseover=function(a){a=parseInt(this.id,10);switch(a){case 2:case 3:case 4:setWindowResizeEvent(!1);
duzon_dialog.view2DepthExtDlg(this,a);setWindowResizeEvent(!0);break;default:duzon_menubar.hideTwoDepthMenu()}}),f=e.insertCell(),f.setAttribute("width","8"),f=e.insertCell(),f.setAttribute("width","16"),f.style.textAlign="center",f.innerHTML=duzon_dialog.makeColorPickerItemHTML(a[g]),function(){var a=b[g];f.onclick=function(b){b=b?b:window.event;"toolbar"==c&&!0===dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&(duzon_dialog.removeColorPreviewEventForTB(),
duzon_dialog.restoreSelectionColor(),GetMultiCellSelection()&&(g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber)),duzon_dialog.recoverMultiCellSelectionBG()));a(b)}}(),f=e.insertCell(),f.setAttribute("width","6"),f=e.insertCell(),f.innerHTML=a[g],function(){var a=b[g];f.onclick=function(b){b=b?b:window.event;"toolbar"==c&&!0===dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&duzon_dialog.nExtendsDlgType!=
DZE_EXTENDS_IMAGE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_BORDER_COLOR&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_TABLE_CREATE&&duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_EMOTICON&&(duzon_dialog.removeColorPreviewEventForTB(),duzon_dialog.restoreSelectionColor(),GetMultiCellSelection()&&(g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber)),duzon_dialog.recoverMultiCellSelectionBG()));"function"===typeof a&&a(b)}}(),f=e.insertCell(),5==a.length&&
0!=g&&1!=g&&(f.innerHTML='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_sub_arrow.png" alt="view submenu" width="3" height="5" style="border:none;">'),f.setAttribute("width","3"),f=e.insertCell(),f.setAttribute("width","6");duzon_dialog.createEmptyRowCell(d,2,6);return d}catch(h){dalert(h)}},makeColorPickerItemHTML:function(a){try{switch(a){case ID_RES_DIALOG_STRING_BASIC:return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_default.png'>";case ID_RES_CONST_STRING_OTHER_COLOR:case ID_RES_CONST_STRING_LINE_OTHER_COLOR:return"<img src='"+
dzeEnvConfig.strPath_Image+"toolbar/color_other.png'>";case ID_RES_DIALOG_BTN_NOCOLOR:case ID_RES_CONST_STRING_LINE_NOCOLOR:return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/color_null.png'>";case ID_RES_CONST_STRING_TABLE_CREATE:return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_table_create.png'>";case ID_RES_CONST_STRING_INSERT_EMOTICONS:return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_emoticon.png'>";case ID_RES_CONST_STRING_LINE_WIDTH:return"<img src='"+
dzeEnvConfig.strPath_Image+"toolbar/ico_thin_line.png'>";case ID_RES_CONST_STRING_LINE_STYLE:return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/ico_sort_line.png'>";case ID_RES_CONST_STRING_CHARACTER_ARROW:return"<img src='"+dzeEnvConfig.strPath_Image+"toolbar/ico_arrow.png'>"}}catch(b){dalert(b)}},createEmptyRowCell:function(a,b,c){try{var d=a.insertRow();b&&d.setAttribute("height",b);var e=d.insertCell();c&&e.setAttribute("colspan",c)}catch(f){dalert(f)}},createTitleRowCell:function(a,b,c){try{var d=
a?a.insertRow():document.createElement("TR"),e=d.insertCell();e.setAttribute("align","left");b&&e.setAttribute("colspan",b);0===d.rowIndex&&(e.style.borderTopWidth="0px");e.className="dze_extdlg_title_container";e.innerHTML=c;return e}catch(f){dalert(f)}},getTitleRowHTML:function(a,b){return(a=this.createTitleRowCell(null,a,b))&&a.parentNode?a.parentNode.outerHTML:""},createSeperateLineRowCell:function(a,b,c){try{var d=a.insertRow();d.setAttribute("height","1");var e=null;b&&(e=d.insertCell(),e.setAttribute("width",
b));e=d.insertCell();e.className="dze_color_picker_separator_line";c&&e.setAttribute("colspan",c);b&&(e=d.insertCell(),e.setAttribute("width",b))}catch(f){dalert(f)}return a},createColorPickerTable:function(a,b,c,d,e){try{var f=document.createElement("table");f.setAttribute("cellspacing","0");f.setAttribute("cellpadding","0");f.setAttribute("border","0");for(var g=0;g<a.length;g++){switch(g){case 0:duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_COLOR_THEME);duzon_dialog.createEmptyRowCell(f,
8,21);break;case 1:duzon_dialog.createEmptyRowCell(f,6,21);break;case 6:duzon_dialog.createEmptyRowCell(f,8,21);duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_COLOR_STANDARD);duzon_dialog.createEmptyRowCell(f,8,21);break;case 8:!0===dzeUiConfig.showTBRecentColor&&(duzon_dialog.createEmptyRowCell(f,8,21),duzon_dialog.createTitleRowCell(f,21,ID_RES_CONST_STRING_RECENT_COLOR),duzon_dialog.createEmptyRowCell(f,4,21))}7<=g&&duzon_dialog.createEmptyRowCell(f,4,21);var h=f.insertRow();h.setAttribute("height",
"12");duzon_dialog.createColorPickerTableCol(a,g,h,b,c,d,e)}duzon_dialog.ext_contents_sub_container=document.createElement("div");duzon_dialog.ext_contents_sub_container.className="dze_color_picker_palettes_container";duzon_dialog.ext_contents_sub_container.appendChild(f);return duzon_dialog.ext_contents_sub_container}catch(k){dalert(k)}return null},createObjUnitDiv:function(a,b,c,d,e,f,g){try{var h=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType,k=document.createElement("div");
k.className="dze_"+h+"_unit_item";switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_COLOR_PICKER:case DZE_EXTENDS_IMAGE_BORDER_COLOR:case DZE_EXTENDS_TABLE_BORDER_COLOR:case DZE_EXTENDS_HIGHLIGHTER_COLOR:var l=c[a][b];k.style.backgroundColor=""!=l?"#"+l:"";break;case DZE_EXTENDS_SHAPE_STYLE:k.innerHTML=duzon_dialog.makeShapeStyleItemHTML(a,b,c,0);break;default:k.innerHTML=objEmoUtil.makeEmoticonItemHTML(a,b,c,0,!1)}(function(){var h=l,n=duzon_dialog.getBtnDlg().getLeftSizeType();k.innerHTML&&
duzon_dialog.nExtendsDlgType!=DZE_EXTENDS_SHAPE_STYLE?h=objEmoUtil.makeEmoticonItemHTML(a,b,c,n,!1):duzon_dialog.nExtendsDlgType==DZE_EXTENDS_SHAPE_STYLE&&(h={fillClr:c[a][b].fillClr,lineClr:c[a][b].lineClr,fontClr:c[a][b].fontClr});k.onmousedown=function(a){TBCancelBubbleEvent(a?a:window.event)};k.onmouseout=function(a){};k.onmouseover=function(a){dlog("onmouseover event call");a=duzon_dialog.ext_contents_container.getElementsByTagName("table")[0];a=duzon_menubar.calcElementPosition(a);var b=duzon_menubar.calcElementPosition(this.parentNode);
duzon_dialog.overLayerObjProcess(h,d,e,f,g,a.left+b.left-1,a.top+b.top-1,this)}})();return k}catch(m){}return null},createColorPickerTableCol:function(a,b,c,d,e,f,g){try{for(var h=0;h<a[b].length;h++){objNewCell=c.insertCell();objNewCell.setAttribute("width","4");var k=duzon_dialog.createObjUnitDiv(b,h,a,d,e,f,g);objNewCell=c.insertCell();objNewCell.setAttribute("width","12");objNewCell.appendChild(k)}objNewCell=c.insertCell();objNewCell.setAttribute("width","4")}catch(l){dalert(l)}},org_selection_color:"",
removeSelectionColor:function(){try{if(""===this.org_selection_color){var a=this.nEditNumber;this.org_selection_color=getSelectionColor(a);GetMultiCellSelection(a)&&this.removeMultiCellSelectionBG();setSelectionColor(a,"transparent")}}catch(b){dalert(b)}},restoreSelectionColor:function(){try{if(""!==this.org_selection_color){var a=this.nEditNumber,b=this.org_selection_color;this.org_selection_color="";GetMultiCellSelection(a)&&this.recoverMultiCellSelectionBG();setSelectionColor(a,b)}}catch(c){dalert(c)}},
overLayerObjProcess:function(a,b,c,d,e,f,g,h){try{var k=null,l=duzon_dialog.m_BtnDlg;k=(!1===cmnDlg.isShowDlg()?document:g_objLayerKit).getElementById(duzon_dialog.idx_dze_ext_item_overlayer);if(!k){k=document.createElement("div");k.className="dze_ext_item_over_layer";k.id=duzon_dialog.idx_dze_ext_item_overlayer;var m=document.createElement("div");m.className="dze_ext_item_over_layer_innerbox";duzon_dialog.getDisplayExtendsDlgType()==DZE_DISPLAY_EXTENDS_COLOR_PICKER?(k.style.width="12px",k.style.height=
"12px",m.style.width="10px",m.style.height="10px"):duzon_dialog.nExtendsDlgType==DZE_EXTENDS_SHAPE_STYLE?(k.style.width="38px",k.style.height="38px",m.style.width="36px",m.style.height="36px"):(k.style.width="30px",k.style.height="30px",m.style.width="28px",m.style.height="28px");k.appendChild(m)}h.appendChild(k);if(duzon_dialog.getDisplayExtendsDlgType()===DZE_DISPLAY_EXTENDS_SHAPES){var n=document.createElement("div");n.innerHTML=a;var p=n.firstChild.getAttribute("alt");!1===fnObjectCheckNull(p)&&
k.setAttribute("title",p)}(function(){dlog("cur_pos_value:"+a);k.onclick=function(f){var g=!1;if(duzon_dialog.getDisplayExtendsDlgType()!=DZE_DISPLAY_EXTENDS_COLOR_PICKER){if(duzon_dialog.getDisplayExtendsDlgType()===DZE_DISPLAY_EXTENDS_SHAPES){var h=document.createElement("span");h.innerHTML=a;h=1*h.firstChild.getAttribute("shape_type");1*g_objNodeUtil.getLoopParentByClassName(g_objNodeUtil.getEventSrcElement(f),"dze_ribbon_tb_item_box").getAttribute("orgcommandid")===ID_COMMAND_SHAPES_CHANGE?g_objShapeFunction.changeShapesType(h):
(g_objCaretUtil.saveCaret(g_objPageControl.nEditNumber,"insert_shape_position"),g_objShapeEvtMgr.setInsertMode(h));duzon_dialog.closeExtendsDlg()}else duzon_dialog.nExtendsDlgType==DZE_EXTENDS_SHAPE_STYLE?(g=g_objShapeCmd.setShapesStyle(a),!0===g&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES)):g=l.insertTypeContent(a);!0===g&&g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber)}else"toolbar"==e&&!0===dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation?
(duzon_dialog.removeColorPreviewEventForTB(),duzon_dialog.restoreSelectionColor(),duzon_dialog.affectedColorPreviewSet=!1,""!=a&&(1==d&&duzon_dialog.selectColorCode("#"+a,c),-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),b("#"+a))):""!=a&&(1==d&&duzon_dialog.selectColorCode("#"+a,c),b("#"+a)),dzeColorPallet.addRecentColorSet(a)};k.onmouseover=function(c){TBCancelBubbleEvent(c?c:window.event);duzon_dialog.getDisplayExtendsDlgType()==DZE_DISPLAY_EXTENDS_COLOR_PICKER&&(this.title=
""!=a?"#"+a:"","toolbar"==e&&!0===dzeUiConfig.bTBPreviewLetterOperation&&!0===duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].previewLetterOperation&&(-1==g_nActiveEditNumber&&(g_nActiveEditNumber=duzon_dialog.nEditNumber),b("#"+a,!1),duzon_dialog.removeSelectionColor(),duzon_dialog.affectedColorPreviewSet=!0))};k.onkeydown=function(a){TBCancelBubbleEvent(a?a:window.event)};k.onkeyup=function(a){TBCancelBubbleEvent(a?a:window.event)}})();k.style.left=f+"px";k.style.top=g+"px";k.style.display=
"block"}catch(q){dalert(q)}},updateTBRecentColorCtrl:function(a){try{8<a.length&&(a.pop(),a.pop());for(var b=dzeColorPallet.getRecentColorSet(),c=[],d=[],e=0;10>e;e++){var f="";f="undefined"==typeof b[e]?"":b[e];c.push(f)}for(e=10;20>e;e++)f="",f="undefined"==typeof b[e]?"":b[e],d.push(f);a.push(c);a.push(d)}catch(g){dalert(g)}},createGeneralCommandListTable:function(a,b){try{if(!a||!a.length)return null;var c=document.createElement("table");c.setAttribute("width","100%");c.setAttribute("cellspacing",
"0");c.setAttribute("cellpadding","0");c.setAttribute("border","0");c.setAttribute("title","");var d=c.insertRow(),e=d.insertCell();e.setAttribute("colspan",6);e.setAttribute("height",2);for(var f="",g="",h="",k=null,l=null,m=0;m<a.length;m++){0<m&&(d=c.insertRow(),e=d.insertCell(),e.setAttribute("colspan",6),e.setAttribute("class","dze_extdlg_general_btn_underline"));f=a[m];g=g_arrConst[f][1];h=g_arrIcon[f];""!=h&&(k=document.createElement("img"),k.alt=g,k.src=dzeEnvConfig.strPath_Image+"toolbar/"+
h);l=eval(g_arrConst[f][3]);var n=duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_SVG_LINE_STYLE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE?!0:!1,p=duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS?!0:!1,q=duzon_dialog.nExtendsDlgType==DZE_EXTENDS_LINE_ARROW?!0:!1;d=c.insertRow();d.setAttribute("class","dze_extdlg_general_btn_unit");d.MBCODE=f;d.TBSTATE=
ID_STRING_NAME_UNCHECKED;d.command=g_arrConst[f][0];d.command_id=f;d.support_type=g_arrConst[f][4];d.support_control_type=g_arrConst[f][5];var r=!1;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(r=handlerUI.setDisableMenu(f));if(1*f===ID_COMMAND_COPY)if(0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer())r=!1;else{var u=GetCurRange(b);if(null===u||u.collapsed)r=!0}else 1*f===ID_COMMAND_COPY_EXT_STYLE&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()&&
(r=!0);r&&(d.TBSTATE=ID_STRING_NAME_GRAY,d.style.opacity=.3);(function(){var a=l;d.onclick=function(c){this.TBSTATE!=ID_STRING_NAME_GRAY&&(c=c?c:window.event,a(c,this,b),duzon_dialog.closeExtendsDlg(),TBCancelBubbleEvent(c))}})();d.onmouseover=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className="dze_extdlg_general_btn_over",duzon_menubar.onMouseOver(this))};d.onmousedown=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(a=a?a:window.event,this.className="dze_extdlg_general_btn_down",TBCancelBubbleEvent(a))};
d.onmouseup=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(a=a?a:window.event,this.className="dze_extdlg_general_btn_over",TBCancelBubbleEvent(a))};d.onmouseout=function(a){this.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className="dze_extdlg_general_btn_unit")};n?e=duzon_dialog.makeBorderTypeCell(d,f,g):p?e=duzon_dialog.makeBorderThicknessCell(d,f,g):q?e=duzon_dialog.makeLineArrowCell(d,f,g):(e=d.insertCell(),e.setAttribute("width",8),e=d.insertCell(),k?(e.setAttribute("width",16),e.appendChild(k)):e.setAttribute("width",
4),e=d.insertCell(),e.setAttribute("width",6),e=d.insertCell(),e.setAttribute("align","left"),e.innerHTML=g,e=d.insertCell(),e.setAttribute("width",10),e.setAttribute("btn_right",""),e=d.insertCell(),e.setAttribute("width",3));f!==ID_COMMAND_PGNUM_TEMPLATE_UP&&f!==ID_COMMAND_PGNUM_TEMPLATE_DOWN||duzon_dialog.setTwoDepthButton(d,f)}d=c.insertRow();e=d.insertCell();e.setAttribute("colspan",6);e.setAttribute("height",2);var t=document.createElement("div");t.className=n||p?"dze_extdlg_general_command_short_container":
"dze_extdlg_general_command_container";t.appendChild(c);return t}catch(w){dalert(w)}},setTwoDepthButton:function(a,b){try{var c=function(a){setWindowResizeEvent(!1);duzon_dialog.view2DepthExtDlg(this,b);setWindowResizeEvent(!0)};a.onclick=c;a.onmouseover=c;a.cells[4].innerHTML='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_sub_arrow.png" alt="view submenu" width="3" height="5" style="border:none;">'}catch(d){dalert(d)}},createCheckedCommandListTable:function(a,b){try{var c=this.createGeneralCommandListTable(a,
b);if(!c)return null;var d=c.querySelectorAll("td[btn_right]");a=0;for(var e=d.length;a<e;a++)d[a].setAttribute("width",25),d[a].style.textAlign="right",d[a].innerHTML="<img src='"+dzeEnvConfig.strPath_Image+"toolbar/icon_check.png'>",d[a].firstChild.style.display="none",d[a].nextSibling&&d[a].nextSibling.setAttribute("width",10);return c}catch(f){dalert(f)}},setCheck:function(a,b){try{var c=duzon_dialog.ext_contents_container.querySelectorAll("td[btn_right]");if(!c||0==c.length)return!1;var d=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB);
if(!d||d.length!=c.length)return!1;for(var e=0,f=d.length;e<f&&d[e]!=a;e++);if(e>=f||!c[e].firstChild)return!1;c[e].firstChild.style.display=b?"":"none";return!0}catch(g){dalert(g)}},makeBorderTypeCell:function(a,b,c){var d=a.insertCell();d.setAttribute("width",10);d=a.insertCell();d.setAttribute("width",88);var e=document.createElement("hr");e.style.border="none";switch(b){case ID_COMMAND_IMAGE_BORDER_SOLID:e.style.borderBottom="solid";e.style.borderWidth="1px";break;case ID_COMMAND_IMAGE_BORDER_DASHED:e.style.borderBottom=
"dashed";e.style.borderWidth="1px";break;case ID_COMMAND_IMAGE_BORDER_DOTTED:e.style.borderBottom="dotted";e.style.borderWidth="1px";break;case ID_COMMAND_IMAGE_BORDER_DOUBLE:e.style.borderBottom="double";e.style.borderWidth="3px";break;case ID_COMMAND_IMAGE_BORDER_NONE:d.setAttribute("align","left"),d.innerHTML=c}d.appendChild(e);d=a.insertCell();d.setAttribute("width",10);return d},makeLineArrowCell:function(a,b,c){a=a.insertCell();a.setAttribute("width",88);c="";switch(b){case ID_COMMAND_LINE_ARROW1:c=
"<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_2.png' />";break;case ID_COMMAND_LINE_ARROW2:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_3.png' />";break;case ID_COMMAND_LINE_ARROW3:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_4.png' />";break;case ID_COMMAND_LINE_ARROW4:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_5.png' />";break;case ID_COMMAND_LINE_ARROW5:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_6.png' />";
break;case ID_COMMAND_LINE_ARROW6:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_7.png' />";break;case ID_COMMAND_LINE_ARROW7:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_8.png' />";break;case ID_COMMAND_LINE_ARROW8:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_9.png' />";break;case ID_COMMAND_LINE_ARROW9:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_10.png' />";break;case ID_COMMAND_LINE_ARROW10:c="<img src='"+dzeEnvConfig.strPath_Image+
"shapes/btn_menu_arrow_11.png' />";break;case ID_COMMAND_LINE_ARROW_NONE:c="<img src='"+dzeEnvConfig.strPath_Image+"shapes/btn_menu_arrow_1.png' />"}a.innerHTML=c;return a},makeBorderThicknessCell:function(a,b,c){var d=a.insertCell();d.setAttribute("width",10);if(ID_COMMAND_IMAGE_BORDER_NONE==b)return d=a.insertCell(),d.setAttribute("align","left"),d.innerHTML=c,a.insertCell(),a.insertCell(),d=a.insertCell(),d.setAttribute("width",10),d;d=a.insertCell();d.setAttribute("width",88);var e=document.createElement("hr");
e.style.border="none";e.style.borderBottom="solid";b=b-ID_COMMAND_IMAGE_BORDER_1PX+1;0>b&&(b=0);e.style.borderWidth=b+"px";d.appendChild(e);d=a.insertCell();d.setAttribute("width",5);d=a.insertCell();d.setAttribute("align","left");d.innerHTML=c;d=a.insertCell();d.setAttribute("width",10);return d},posExtContentsRightPanel:function(){try{dlog("resizeExtContentsContainerPos Call");var a=duzon_dialog.ext_contents_container.id.replace(new RegExp("^"+duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType+
"_"),"");if(null!=document.getElementById(a)){var b=duzon_dialog.ext_contents_container.parentElement.getBoundingClientRect();duzon_dialog.ext_contents_container.style.position="fixed";duzon_dialog.ext_contents_container.style.top=b.bottom+"px";duzon_dialog.ext_contents_container.style.left=b.right-(duzon_dialog.ext_contents_container.clientWidth+20)+"px"}}catch(c){dalert(c)}},resizeExtContentsContainerPos:function(a,b){try{if(dlog("resizeExtContentsContainerPos Call"),"undefined"!=typeof a&&null!=
a&&b){var c=duzon_dialog.getExtContentsPos(a,duzon_dialog.ext_contents_container,"relative");duzon_dialog.ext_contents_container.style.top=c.top+"px";duzon_dialog.ext_contents_container.style.left=c.left+"px"}else if(null!=duzon_dialog.ext_contents_container&&"none"!=duzon_dialog.ext_contents_container.style.display){var d=duzon_dialog.ext_contents_container.id.replace(new RegExp("^"+duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType+"_"),""),e=document.getElementById(d);
if(null!=e){var f=duzon_dialog.getExtContentsPos(e,duzon_dialog.ext_contents_container,"fixed");duzon_dialog.ext_contents_container.style.top=f.top+"px";duzon_dialog.ext_contents_container.style.left=f.left+"px"}}}catch(g){dalert(g)}},animateDlg:function(a,b){try{if(null!=a&&"none"!=a.style.display){var c=-10,d=0;"down"==b?a.style.marginTop=c+"px":"right"==b?a.style.marginLeft=c+"px":"left"==b&&(c=10,a.style.marginLeft=c+"px");g_objPropertyUtil.setOpacity(a,d);var e=setInterval(function(){if("down"==
b||"right"==b)c+=2,d+=.2,0<=c&&(clearInterval(e),c=0,d=1);"left"==b&&(c-=2,d+=.2,0>=c&&(clearInterval(e),c=0,d=1));if("down"==b)a.style.marginTop=c+"px";else if("right"==b||"left"==b)a.style.marginLeft=c+"px";g_objPropertyUtil.setOpacity(a,d)},30)}}catch(f){g_objPropertyUtil.setOpacity(a,1),dalert(f)}},getDialogElementPositionFromToolbarElement:function(a,b){try{for(var c=a.id.replace(/_SUB$/,""),d=document.getElementById(c).command_id,e=0,f=0;f<g_arrToolbar1.length;f++)if(g_arrToolbar1[f][0]==d){e=
1;break}if(0==e)for(f=0;f<g_arrToolbar2.length;f++)if(g_arrToolbar2[f][0]==d){e=2;break}if(0==e)for(f=0;f<g_arrToolbar3.length;f++)if(g_arrToolbar3[f][0]==d){e=3;break}dlog("tb_tr_no:"+e);dlog("main_command_id:"+d);d=!1;var g=document.getElementById("TB_CONTAINER_TOOL_"+e+"_HIDDEN_"+duzon_dialog.nEditNumber);if(null!=g){var h=g.getElementsByTagName("div");for(f=0;f<h.length;f++)if(h[f].id==c){d=!0;break}}var k=duzon_menubar.calcElementPosition(document.getElementById(c).parentNode);c={top:0,left:0,
trNo:e,isHidden:d};if(1==d){var l=duzon_menubar.calcElementPosition(g);c.left=c.left+parentToolbarObj_pos.width-l.width;c.top=c.top+l.height-2}var m=g_objPositionUtil.getNodeElementPosition(a);c.left=m.left;c.top=m.top;c.top=c.top+k.height-8;if("undefined"!=typeof b){var n=duzon_menubar.calcElementPosition(b),p=g_objPositionUtil.getActiveWinSize();c.left+n.width>p.view_window_width+p.scrollX&&(c.left=c.left-n.width+k.width-4)}0>c.top&&(c.top=0);0>c.left&&(c.left=0);return c}catch(q){dalert(q)}},getExtContentsPos:function(a,
b,c,d){try{"undefined"==typeof c&&(c="relative");"undefined"==typeof d&&(d=this.nEditNumber);var e=a.id.replace(/_SUB$/,""),f=document.getElementById("EDIT_SET_CONTAINER_"+d);parentToolbarObj_pos=g_objPositionUtil.getOuterRect(f);var g=duzon_menubar.calcElementPosition(document.getElementById(e).parentNode),h=duzon_menubar.calcElementPosition(document.getElementById(e));f={top:0,left:0};var k=g_objPositionUtil.getLayerElementPosition(document.getElementById(e),!1),l=duzon_dialog.getParentAbsoluteNodePos(document.getElementById(e),
d);f.top=k.top-l.top;f.left=k.left-l.left;f.top+=document.getElementById(e).offsetHeight;if("relative"==c){var m=duzon_menubar.calcElementPosition(b);f.left+m.width+l.left>parentToolbarObj_pos.width+parentToolbarObj_pos.left+m.scrollX&&(f.left=f.left-m.width+h.width);b=!1;for(c=0;a&&"BODY"!==a.nodeName;){if("DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_panel_body")){b=!0;break}if(50<c)break;a=a.parentNode;c++}if(b){var n=g_objPositionUtil.getLayerElementPosition(document.getElementById("dze_idx_right_pannel_td_"+
d),!1),p=n.bottom-n.top;p<f.top+m.height&&(f.top=Math.max(p-(m.height+30),0))}}0>f.left&&g.view_window_width>=l.left+m.width&&(f.left=0);dlog("getExtContentsPos result : "+f.left+" | "+f.top);return f}catch(q){dalert(q)}},getParentAbsoluteNodePos:function(a,b){try{"undefined"==typeof b&&(b=duzon_dialog.nEditNumber);for(var c={left:0,top:0},d=0;!(1E3<d)&&a.parentNode;){a=a.parentNode;if("body"==a.nodeName.toLowerCase())break;if(g_bBrowserType_IE)var e=a.currentStyle.getAttribute("position");else if(g_bBrowserType_FF||
g_bBrowserType_WK||g_bBrowserType_OP)e=g_objEditWindow[b].getComputedStyle(a,null).getPropertyValue("position");if("absolute"==e.toLowerCase()||"relative"==e.toLowerCase()){c=g_objPositionUtil.getLayerElementPosition(a,!1);"duzon_hidden_toolbar_container"==a.className&&(c.left+=1,c.top+=1);break}d++}return c}catch(f){dalert(f)}},selectColorCode:function(a,b,c){try{if("undefined"!=typeof b&&null!=b&&("undefined"==typeof c&&(c=this.nEditNumber),!(null==b||0>b.id.indexOf("LINECOLOR")&&0>b.id.indexOf("FILLCOLOR")&&
0>b.id.indexOf("SHAPELINECOLOR")&&0>b.id.indexOf("SHAPEFILLCOLOR")&&0>b.id.indexOf("FORECOLOR")&&0>b.id.indexOf("BACKCOLOR")&&0>b.id.indexOf("IMAGEBORDERCOLOR")&&0>b.id.indexOf("HIGHLIGHTER")&&0>b.id.indexOf("CELLBACKCOLOR")&&0>b.id.indexOf("TABLEBORDERCOLOR")&&0>b.id.indexOf("VIDEOBORDERCOLOR")))){0<=b.id.indexOf("FORECOLOR")?this.curr_forecolor[c]=a:0<=b.id.indexOf("CELLBACKCOLOR")?this.curr_cell_backcolor[c]=a:0<=b.id.indexOf("BACKCOLOR")?this.curr_backcolor[c]=a:0<=b.id.indexOf("IMAGEBORDERCOLOR")?
this.curr_image_border_backcolor[c]=a:0<=b.id.indexOf("TABLEBORDERCOLOR")?this.curr_table_border_backcolor[c]=a:0<=b.id.indexOf("HIGHLIGHTER")?this.curr_highlighter_backcolor[c]=a:0<=b.id.indexOf("FILLCOLOR")||0<=b.id.indexOf("SHAPEFILLCOLOR")?this.curr_txbx_fillcolor[c]=a:0<=b.id.indexOf("LINECOLOR")||0<=b.id.indexOf("SHAPELINECOLOR")?this.curr_txbx_linecolor[c]=a:0<=b.id.indexOf("VIDEOBORDERCOLOR")&&(this.curr_video_border_backcolor[c]=a);var d=document.getElementById(b.id+"_color_selector");(0<=
b.id.indexOf("FORECOLOR")||0<=b.id.indexOf("TextBoxTextColor"))&&""==a&&(a="#000000");d.style.backgroundColor=a;""==a||"#ffffff"==a.toLowerCase()?d.style.borderColor="#a0a0a0":d.style.borderColor=a}}catch(e){dalert(e)}},closeExtendsDlg:function(a){try{if(!fnObjectCheckNull(a)){var b=a.target.closest(".dze_ext_dialog_container");if(!fnObjectCheckNull(b))return}duzon_menubar.hideTwoDepthMenu();duzon_dialog.dialogExtStatus=!1;var c=g_TBDropDown[duzon_dialog.nEditNumber];if(!fnObjectCheckNull(c)){if(!0!==
g_readonlyMode)for(a=0;a<c.length;a++)c[a].element.TBSTATE!=ID_STRING_NAME_GRAY&&TBSetState(c[a].element,ID_STRING_NAME_UNCHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var d=g_objEditorDocument[duzon_dialog.nEditNumber].getElementById("dze_idx_ImageBorderColor_TargetElement");d&&d.removeAttribute("id");if(null!=duzon_dialog.ext_contents_container&&"none"!=duzon_dialog.color_picker_mode){this.color_picker_mode="none";c=!1;if(0<=duzon_dialog.ext_contents_container.parentNode.id.indexOf("TB_SETFORECOLOR_")||
0<=duzon_dialog.ext_contents_container.parentNode.id.indexOf("TB_SETBACKCOLOR_"))c=!0;duzon_dialog.ext_contents_container.style.display="none";duzon_dialog.ext_contents_container.parentNode.removeChild(duzon_dialog.ext_contents_container);duzon_dialog.ext_contents_container=null;duzon_dialog.nExtendsDlgType=0;duzon_dialog.removeExtContentsEvent();this.restoreSelectionColor();1!=c||cmnDlg.isShowDlg()||(editor_onselectionchange(duzon_dialog.nEditNumber),g_objTableMiniMenu.delayUpdate(duzon_dialog.nEditNumber))}}}catch(e){dalert(e)}},
addExtContentsEvent:function(){try{if(!this.arrExtContentsListener){this.arrExtContentsListener=[];var a=function(a,b,c){EventUtil.addHandler(a,b,c);this.arrExtContentsListener.push({elem:a,type:b,handler:c})}.bind(this),b=window;a(b,"mousedown",function(a){duzon_dialog.closeExtendsDlg(a)});a(b,"keydown",function(a){duzon_dialog.evtKeyCodeExtContents(a)});a(b,"resize",function(a){duzon_dialog.resizeExtContentsContainerPos(a)});for(var c in g_arrEditorAreaContainer){var d=g_objEditorDocument[c];a(d,
"mousedown",function(a){duzon_dialog.closeExtendsDlg(a)});a(d,"keydown",function(a){duzon_dialog.evtKeyCodeExtContents(a)})}}}catch(e){dalert(e)}},removeExtContentsEvent:function(){try{for(var a=0,b=this.arrExtContentsListener?this.arrExtContentsListener.length:0;a<b;a++){var c=this.arrExtContentsListener[a];c&&EventUtil.removeHandler(c.elem,c.type,c.handler)}this.arrExtContentsListener=null}catch(d){dalert(d)}},evtKeyCodeExtContents:function(a){try{var b=a?a:window.event;cmnDlg.m_keyCode=b.keyCode;
dlog("keycode :"+cmnDlg.m_keyCode);1==duzon_dialog.affectedColorPreviewSet&&(g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber),duzon_dialog.affectedColorPreviewSet=!1);cmnDlg.m_keyCode==ID_KEYCODE_ESCAPE&&(duzon_dialog.closeExtendsDlg(),TBCancelBubbleEvent(b))}catch(c){dalert(c)}},table_cell_align_list:"left_top center_top right_top left_middle center_middle right_middle left_bottom center_bottom right_bottom".split(" "),idx_dze_table_cell_align_container:"idx_dze_table_cell_align_container",
getTableCellAlignContent:function(){try{var a=document.createElement("div");a.className="dze_table_cell_align_container";a.id=this.idx_dze_table_cell_horizontalalign_container;for(var b=null,c="",d=0;d<this.table_cell_align_list.length;d++)b=document.createElement("div"),b.className="dze_table_cell_align_unit",c=eval("ID_RED_CONST_STRING_ALIGN_"+this.table_cell_align_list[d].toUpperCase()),c="<table border=0 cellpadding=0 cellspacing=0><tr><td width='16'><img src='"+dzeEnvConfig.strPath_Image+"toolbar/toolbar_btn_table_cell_align_"+
this.table_cell_align_list[d]+".png'></td><td width='6'></td><td>"+c+"</td></tr></table>",b.innerHTML=c,b.onmouseover=function(){this.className="dze_table_cell_align_unit_over"},b.onmouseout=function(){this.className="dze_table_cell_align_unit"},b.onmousedown=function(){this.className="dze_table_cell_align_unit_down"},b.onmouseup=function(){this.className="dze_table_cell_align_unit_over"},function(){var a=duzon_dialog.table_cell_align_list[d].split("_"),c=a[0],g=a[1];b.onclick=function(){var a=GetCurTable(duzon_dialog.nEditNumber);
a&&g_objTableOperation.table_TableCellAlign(a,c,g);duzon_dialog.closeDialog()}}(),a.appendChild(b);return a}catch(e){dalert(e)}},getTableCellAlignContentWithoutText:function(){try{var a=document.createElement("div");a.className="dze_table_cell_align_ext_container";a.id=this.idx_dze_table_cell_horizontalalign_container;for(var b=null,c="",d=dzeUiConfig.bTBPreviewLetterOperation,e=GetCurTable(duzon_dialog.nEditNumber),f=0;f<this.table_cell_align_list.length;f++)b=document.createElement("div"),b.className=
"dze_table_cell_align_ext_unit",c=eval("ID_RED_CONST_STRING_ALIGN_"+this.table_cell_align_list[f].toUpperCase()),c="<span><img title='"+c+"' src='"+dzeEnvConfig.strPath_Image+"ribbon/toolbar_btn_table_cell_align_"+this.table_cell_align_list[f]+".png'></span>",b.innerHTML=c,b.onmouseout=function(){this.className="dze_table_cell_align_ext_unit"},b.onmousedown=function(){this.className="dze_table_cell_align_ext_unit_down"},b.onmouseup=function(){this.className="dze_table_cell_align_ext_unit_over"},function(){var a=
duzon_dialog.table_cell_align_list[f].split("_"),c=a[0],k=a[1];b.onmouseover=function(){this.className="dze_table_cell_align_ext_unit_over";d&&g_objTableOperation.table_TableCellAlign(e,c,k)};b.onclick=function(){d||g_objTableOperation.table_TableCellAlign(e,c,k);duzon_dialog.closeExtendsDlg();e&&commonUpdateAfterChange(duzon_dialog.nEditNumber,e)}}(),a.appendChild(b);d&&(g_objLayerEventUtil.canSaveTableSelectedCellHTML(duzon_dialog.nEditNumber)?g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber),
!0):g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber),a.onmouseleave=function(){g_objLayerEventUtil.canSaveTableSelectedCellHTML(duzon_dialog.nEditNumber)?g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(duzon_dialog.nEditNumber),!0):(g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber),g_objUndoRedo.operateUndoRedoStack(!0,!0,duzon_dialog.nEditNumber))});return a}catch(g){dalert(g)}},viewDetailColorPicker:function(a,b){try{duzon_menubar.hideTwoDepthMenu();this.color_picker_mode=
"detail";duzon_dialog.ext_contents_container.innerHTML="";var c=document.createElement("div");c.id="dze_idx_detail_color_picker_div";duzon_dialog.ext_contents_container.appendChild(c);dzeColorPallet.initialize("dze_idx_detail_color_picker_div",a,b);duzon_dialog.ext_contents_container.style.padding="0px";duzon_dialog.ext_contents_container.style.width="auto";duzon_dialog.ext_contents_container.style.height="auto";try{window.detachEvent?window.detachEvent("onresize",duzon_dialog.resizeExtContentsContainerPos):
window.removeEventListener("resize",duzon_dialog.resizeExtContentsContainerPos,!1)}catch(d){}panelManager.getInstance()&&!0===panelManager.getInstance().isShowPanel()?(dlog("---------- objPanelManager.isShowPanel() -------------"),this.posExtContentsRightPanel()):cmnDlg.isShowDlg()||duzon_dialog.setDetailColorPickerPosition()}catch(d){dalert(d)}},setDetailColorPickerPosition:function(){try{var a=duzon_dialog.ext_contents_container.offsetWidth,b=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+
this.nEditNumber),c=g_objPositionUtil.getElementPosition(b,!1);cmnDlg.m_nClkY=c.top+10;c.width=c.right-c.left;cmnDlg.m_nClkX=c.left+(c.width-a)/2;var d=duzon_dialog.getParentAbsoluteNodePos(duzon_dialog.ext_contents_container,this.nEditNumber);cmnDlg.m_nClkY-=d.top;cmnDlg.m_nClkX-=d.left}catch(e){dalert(e)}},removeMultiCellSelectionBG:function(){try{GetMultiCellSelection()&&g_objTableSelection.doAllSelectedCell(function(a){a.hasAttribute("bg_changing")||a.setAttribute("bg_changing",a.style.backgroundColor)})}catch(a){dalert(a)}},
recoverMultiCellSelectionBG:function(){try{GetMultiCellSelection()&&g_objTableSelection.doAllSelectedCell(function(a){a.hasAttribute("bg_changing")&&(a.style.backgroundColor=a.getAttribute("bg_changing"),a.removeAttribute("bg_changing"))})}catch(a){dalert(a)}},getExtCommonPopupTitle:function(){try{var a="";switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_TABLE_CELL_ALIGN:a=ID_RES_CONST_STRING_TABLE_CELL_ALIGN}return a}catch(b){dalert(b)}},getExtCommonPopupBody:function(a,b,c){try{switch(duzon_dialog.nExtendsDlgType){case DZE_EXTENDS_TABLE_CELL_ALIGN:a=
duzon_dialog.getTableCellAlignContentWithoutText();break;default:return null}return a}catch(d){dalert(d)}},createCommonPopupTableTitle:function(a){try{a=a||duzon_dialog.getExtCommonPopupTitle();var b=document.createElement("table");b.setAttribute("width","100%");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("border","0");duzon_dialog.createTitleRowCell(b,0,a);var c=document.createElement("div");c.appendChild(b);return c}catch(d){dalert(d)}},createCommonPopupTable:function(a,
b){try{if("undefined"!=typeof a&&null!=a&&0!=a.length){var c=duzon_dialog.createCommonPopupTableTitle(),d=duzon_dialog.getExtCommonPopupBody(null,a,b);if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_CELL_ALIGN)return d;var e=document.createElement("div");e.appendChild(c);e.appendChild(d);return e}}catch(f){dalert(f)}},checkedColIndex:-1,checkedRowIndex:-1,createTable:function(a,b){this.checkedRowIndex=this.checkedColIndex=-1;var c=document.createElement("table");c.setAttribute("width","160");c.setAttribute("cellspacing",
"2");c.setAttribute("cellpadding","0");c.setAttribute("border","0");c.className="dze_extdlg_table_create_table";for(var d=null,e=null,f=0;f<a.rows;f++){d=c.insertRow();for(var g=0;g<a.cols;g++)e=d.insertCell(),e.className="dze_extdlg_table_create_td_basic",e.onmouseover=function(){var a=this.cellIndex,b=this.parentNode.rowIndex,c=g_objNodeUtil.getLoopParentElement(this,"table");duzon_dialog.checkSelectedTableCells(c,a,b)}}c.onclick=function(){0>duzon_dialog.checkedColIndex||0>duzon_dialog.checkedRowIndex||
(duzon_dialog.closeExtendsDlg(),duzon_dialog.createSelectedCellsTable(duzon_dialog.checkedRowIndex,duzon_dialog.checkedColIndex,b),duzon_dialog.checkedColIndex=-1,duzon_dialog.checkedRowIndex=-1)};c.onmouseleave=function(){duzon_dialog.checkSelectedTableCells(this,-1,-1)};a=document.createElement("table");a.setAttribute("width","100%");a.setAttribute("cellspacing","0");a.setAttribute("cellpadding","0");a.setAttribute("border","0");a.id="dze_idx_extdlg_create_table_title";duzon_dialog.createTitleRowCell(a,
0,ID_RES_CONST_STRING_TABLE_CREATE,!0);d=document.createElement("div");d.appendChild(a);d.appendChild(c);return d},checkSelectedTableCells:function(a,b,c){var d=document.getElementById("dze_idx_extdlg_create_table_title");g_objNodeUtil.getLoopChildNodeByTagName(d,"td").innerHTML=0<=b&&0<=c?b+1+" x "+(c+1):ID_RES_CONST_STRING_TABLE_CREATE;for(d=0;d<a.rows.length;d++)for(var e=0;e<a.rows[d].cells.length;e++)a.rows[d].cells[e].className=0>b||0>c?"dze_extdlg_table_create_td_basic":d<=c&&e<=b?"dze_extdlg_table_create_td_over":
"dze_extdlg_table_create_td_basic";this.checkedColIndex=b;this.checkedRowIndex=c},createSelectedCellsTable:function(a,b,c){var d=[];d[0]=a+1;d[1]=b+1;d[2]=null;d[3]="px";d[4]=null;d[5]=null;d[6]=3;d[7]="1px solid #000000";d[8]="1px solid #000000";d[9]="1px solid #000000";d[10]="1px solid #000000";d[11]="1px solid #000000";d[12]="1px solid #000000";d[13]=null;d[14]=null;d[15]=null;d[16]="";d[17]=null;d[18]=null;d[19]=null;d[20]=null;d[21]=null;d[22]=0;d[23]=!0;if(a=g_objTableFunction.createTable(d,
c))g_objTableFlag.ResetTableInfo(),g_objCaretUtil.moveCaret(a),commonUpdateAfterChange(c,a);g_objLayerEventUtil.initHideDynamicLayer()},resizeTbColorLinePostion:function(){},structShapesLayoutProperty:{place:{arrangement:"",marginLeft:"",marginRight:"",marginTop:"",marginBottom:""},size:{px_height:"",px_width:"",rotation_angle:"",percent_height:"",percent_width:"",fixed_ratio:""}},arrShapesLayoutDialogElement:[],objMarginTable:null,createShapesLayout_Place:function(){try{this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT]=
null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_FRONT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_BEHIND]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_LEFT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_LEFT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_TOP]=
null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM]=null;var a=document.createElement("div");a.className="duzon_dialog_content_medium";g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_SHAPES_ALIGN);var b=document.createElement("div"),c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");var d=c.insertRow(),e=
d.insertCell(),f=dzeEnvConfig.strPath_Image+"toolbar/dlg_textchange_in.png";e.width="25%";e.innerHTML=g_objPropTagCommon.makeRadioButtonCtrl("shapesArrangementInText","shapesArrangement","0",ID_RES_CONST_STRING_TXTLAYOUT_IN_LINE_WIDTH_TEXT,f);this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT]=e.firstChild;e=d.insertCell();e.width="25%";f=dzeEnvConfig.strPath_Image+"toolbar/dlg_textchange_front.png";e.innerHTML=g_objPropTagCommon.makeRadioButtonCtrl("shapesArrangementFront",
"shapesArrangement","1",ID_RES_CONST_STRING_TXTLAYOUT_IN_FRONT_OF_TEXT,f);this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_FRONT]=e.firstChild;e=d.insertCell();e.width="25%";f=dzeEnvConfig.strPath_Image+"toolbar/dlg_textchange_back.png";e.innerHTML=g_objPropTagCommon.makeRadioButtonCtrl("shapesArrangementBehind","shapesArrangement","2",ID_RES_CONST_STRING_TXTLAYOUT_BEHIND_TEXT,f);this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_BEHIND]=e.firstChild;e=d.insertCell();
e.width="25%";g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 10px;");d=c.insertRow();e=d.insertCell();e.width="25%";f=dzeEnvConfig.strPath_Image+"toolbar/dlg_textchange_in.png";e.innerHTML=g_objPropTagCommon.makeRadioButtonCtrl("shapesArrangementLeft","shapesArrangement","4",ID_RES_CONST_STRING_TXTLAYOUT_LEFT_TEXT,f);this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_LEFT]=e.firstChild;e=d.insertCell();e.width="25%";f=dzeEnvConfig.strPath_Image+"toolbar/dlg_textchange_in.png";e.innerHTML=
g_objPropTagCommon.makeRadioButtonCtrl("shapesArrangementRight","shapesArrangement","5",ID_RES_CONST_STRING_TXTLAYOUT_RIGHT_TEXT,f);this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT]=e.firstChild;b.appendChild(c);a.appendChild(b);g_objPropTagCommon.makeSeperateLine(a,"duzon_dialog_label_separator");g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_SHAPES_DISTANCE_WITH_TEXT);var g=document.createElement("div");c=document.createElement("table");
c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");this.objMarginTable=c;g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 4px;");d=c.insertRow();e=d.insertCell();e.width="50%";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_PROP_TAG_STRING_LEFT+" : ","MarginLeft",10,0,"",void 0,"cm");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_LEFT]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);
e.appendChild(objCtrlTable);e=d.insertCell();e.width="50%";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_PROP_TAG_STRING_RIGHT+" : ","MarginRight",10,0,"",void 0,"cm");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 4px;");d=c.insertRow();e=d.insertCell();e.width="50%";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_PROP_TAG_STRING_TOP+
" : ","MarginTop",10,0,"",void 0,"cm");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_TOP]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);e=d.insertCell();e.width="50%";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_PROP_TAG_STRING_BOTTOM+" : ","MarginBottom",10,0,"",void 0,"cm");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);g.appendChild(c);
a.appendChild(g);return a}catch(h){dalert(h)}},createShapesLayout_Size:function(){try{this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_HEIGHT]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_WIDTH]=null;this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO]=
null;var a=document.createElement("div");a.className="duzon_dialog_content_medium";g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_DIALOG_STRING_SIZE);var b=document.createElement("div"),c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 4px;");var d=c.insertRow(),e=d.insertCell();e.width="50%";
e.style.paddingLeft="3px";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_DIALOG_STRING_HEIGHT+" : ","ShapeHeightPx",100,.1,"",void 0,"cm");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);e=d.insertCell();e.width="50%";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_DIALOG_STRING_WIDTH+" : ","ShapeWidthPx",100,.1,"",void 0,"cm");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH]=
g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);b.appendChild(c);a.appendChild(b);g_objPropTagCommon.makeSeperateLine(a,"duzon_dialog_label_separator");g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_SHAPES_ROTATE);var f=document.createElement("div");c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");
g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 4px;");d=c.insertRow();e=d.insertCell();e.width="50%";e.style.paddingLeft="3px";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_SHAPES_ROTATE+" : ","ShapeRotation",360,-359,"",void 0,"\u00ba");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);f.appendChild(c);a.appendChild(f);g_objPropTagCommon.makeSeperateLine(a,"duzon_dialog_label_separator");
g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_SHAPES_RATIO);var g=document.createElement("div");c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 4px;");d=c.insertRow();e=d.insertCell();e.width="50%";e.style.paddingLeft="3px";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_DIALOG_STRING_HEIGHT+
" : ","ShapeHeightPercent",1E5,1,"",void 0,"%");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_HEIGHT]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);e=d.insertCell();e.width="50%";objCtrlTable=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_DIALOG_STRING_WIDTH+" : ","ShapeWidthPercent",1E5,1,"",void 0,"%");this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_WIDTH]=g_objPropTagCommon.getSpinnerCtrlEle(objCtrlTable);e.appendChild(objCtrlTable);
g.appendChild(c);a.appendChild(g);g_objPropTagCommon.makeEmptyLine(c,2,4,"height: 2px;");d=c.insertRow();e=d.insertCell();e.width="50%";e.style.paddingLeft="3px";e.innerHTML=g_objPropTagCommon.makeCheckboxCtrl("shapesRate","shapesRate","0",ID_RES_CONST_STRING_PAPER_ORIENTATION_GARO+" "+ID_RES_CONST_STRING_PAPER_ORIENTATION_SERO+" "+ID_RES_CONST_STRING_FIXED_RATIO);this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO]=e.firstChild;g.appendChild(c);return a}catch(h){dalert(h)}},getShapesLayoutValues:function(){try{for(var a=
{layoutIndex:-1,marginInfo:null,height:1,width:1,rotationAngle:0,fixed_ratio:!1},b,c,d,e,f=-1,g,h,k,l,m,n=0;n<g_objSelectedShapesArray.length;n++){b=g_objSelectedShapesArray[n];c=b.style.position.toLowerCase();void 0!==a.layoutIndex&&("relative"===c?(d=b.style["float"].toLowerCase(),f="left"===d?SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_LEFT:"right"===d?SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT:SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT):(e=parseInt(b.style.zIndex),3E4<e?f=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_FRONT:
-2E4>e&&(f=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_BEHIND)),0===n?a.layoutIndex=f:a.layoutIndex!==f&&(a.layoutIndex=void 0));if(void 0!==a.marginInfo){if("relative"===c)var p=g_objNodeUtil.getParentElement(b);g=g_objNodeUtil.getMargin(p);g.left=0!==g.left?g_objCommonUtil.PxToCM(g.left).toFixed(1):0;g.right=0!==g.right?g_objCommonUtil.PxToCM(g.right).toFixed(1):0;g.top=0!==g.top?g_objCommonUtil.PxToCM(g.top).toFixed(1):0;g.bottom=0!==g.bottom?g_objCommonUtil.PxToCM(g.bottom).toFixed(1):0;0===n?a.marginInfo=
g:(a.marginInfo.left!==g.left&&(a.marginInfo.left=void 0),a.marginInfo.right!==g.right&&(a.marginInfo.right=void 0),a.marginInfo.top!==g.top&&(a.marginInfo.top=void 0),a.marginInfo.bottom!==g.bottom&&(a.marginInfo.bottom=void 0),void 0===a.marginInfo.left&&void 0===a.marginInfo.right&&void 0===a.marginInfo.top&&void 0===a.marginInfo.bottom&&(a.marginInfo=void 0))}void 0!==a.height&&(h=parseFloat(b.style.height),h=g_objCommonUtil.PxToCM(h).toFixed(2),0===n?a.height=h:a.height!==h&&(a.height=void 0));
void 0!==a.width&&(k=parseFloat(b.style.width),k=g_objCommonUtil.PxToCM(k).toFixed(2),0===n?a.width=k:a.width!==k&&(a.width=void 0));void 0!==a.rotationAngle&&(l=g_objNodeUtil.getRotationAngle(b),0===n?a.rotationAngle=l:a.rotationAngle!==l&&(a.rotationAngle=void 0));void 0!==a.fixed_ratio&&(m="true"===b.getAttribute("fixed_ratio"),0===n?a.fixed_ratio=m:a.fixed_ratio!==m&&(a.fixed_ratio=void 0))}void 0===a.layoutIndex&&(a.layoutIndex=-1);void 0===a.marginInfo?a.marginInfo={left:0,right:0,top:0,bottom:0}:
(void 0===a.marginInfo.left&&(a.marginInfo.left=0),void 0===a.marginInfo.right&&(a.marginInfo.right=0),void 0===a.marginInfo.top&&(a.marginInfo.top=0),void 0===a.marginInfo.bottom&&(a.marginInfo.bottom=0));void 0===a.height&&(a.height=.1);void 0===a.width&&(a.width=.1);void 0===a.rotationAngle&&(a.rotationAngle=0);void 0===a.fixed_ratio&&(a.fixed_ratio=!1);return a}catch(q){dalert(q)}},initShapeLayoutDialog:function(){try{var a=function(){duzon_dialog.objMarginTable.style.color=g_objColorComboBoxUtil.strDisabledColor;
duzon_dialog.setEnableSpinner("MarginLeft",!1);duzon_dialog.setEnableSpinner("MarginRight",!1);duzon_dialog.setEnableSpinner("MarginTop",!1);duzon_dialog.setEnableSpinner("MarginBottom",!1);duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_LEFT].value="";duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT].value="";duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_TOP].value="";duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM].value=
""},b=this.getShapesLayoutValues();-1!==b.layoutIndex&&(this.arrShapesLayoutDialogElement[b.layoutIndex].childNodes[0].checked=!0,objImage=this.arrShapesLayoutDialogElement[b.layoutIndex].childNodes[1].firstChild.firstChild.firstChild.firstChild,objImage.className="duzon_dialog_img_radio_button_on");for(var c=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT;c<=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT;c++)this.arrShapesLayoutDialogElement[c].onclick=function(){for(var b,c,f=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT;f<=
SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT;f++)if(b=duzon_dialog.arrShapesLayoutDialogElement[f],c=b.childNodes[1].firstChild.firstChild.firstChild.firstChild,this===b)switch(b.childNodes[0].checked=!0,c.className="duzon_dialog_img_radio_button_on",f){case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT:case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_LEFT:case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT:duzon_dialog.objMarginTable.style.color="";duzon_dialog.setEnableSpinner("MarginLeft",!0);duzon_dialog.setEnableSpinner("MarginRight",
!0);duzon_dialog.setEnableSpinner("MarginTop",!0);duzon_dialog.setEnableSpinner("MarginBottom",!0);duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_LEFT].value=duzon_dialog.structShapesLayoutProperty.place.marginLeft;duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT].value=duzon_dialog.structShapesLayoutProperty.place.marginRight;duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_TOP].value=duzon_dialog.structShapesLayoutProperty.place.marginTop;
duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM].value=duzon_dialog.structShapesLayoutProperty.place.marginBottom;break;case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_FRONT:case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_BEHIND:a()}else b.childNodes[0].checked=!1,c.className="duzon_dialog_img_radio_button_off"};this.modifySpinnerValue("MarginLeft",50,0,b.marginInfo.left,void 0,void 0,.1);this.modifySpinnerValue("MarginRight",50,0,b.marginInfo.right,void 0,void 0,.1);this.modifySpinnerValue("MarginTop",
50,0,b.marginInfo.top,void 0,void 0,.1);this.modifySpinnerValue("MarginBottom",50,0,b.marginInfo.bottom,void 0,void 0,.1);switch(b.layoutIndex){case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_FRONT:case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_BEHIND:a()}this.modifySpinnerValue("ShapeHeightPx",100,.1,b.height,function(){var a=duzon_dialog.structShapesLayoutProperty.size.px_height;a=(parseFloat(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT].value)/a*100).toFixed(0);duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_HEIGHT].value=
a;!0===duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO].checked&&(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_WIDTH].value=a,a=(a/100*duzon_dialog.structShapesLayoutProperty.size.px_width).toFixed(2),duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH].value=a)},void 0,.1);this.modifySpinnerValue("ShapeWidthPx",100,.1,b.width,function(){var a=duzon_dialog.structShapesLayoutProperty.size.px_width;a=(parseFloat(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH].value)/
a*100).toFixed(0);duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_WIDTH].value=a;!0===duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO].checked&&(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_HEIGHT].value=a,a=(a/100*duzon_dialog.structShapesLayoutProperty.size.px_height).toFixed(2),duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT].value=a)},void 0,.1);this.modifySpinnerValue("ShapeRotation",360,-360,
b.rotationAngle,function(){var a=parseFloat(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE].value);if(360===a||-360===a)duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE].value=0});this.modifySpinnerValue("ShapeHeightPercent",1E5,1,100,function(){var a=duzon_dialog.structShapesLayoutProperty.size.px_height,b=parseFloat(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_HEIGHT].value);a=(b/100*a).toFixed(2);duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT].value=
a;!0===duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO].checked&&(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_WIDTH].value=b,b=(b/100*duzon_dialog.structShapesLayoutProperty.size.px_width).toFixed(2),duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH].value=b)});this.modifySpinnerValue("ShapeWidthPercent",1E5,1,100,function(){var a=duzon_dialog.structShapesLayoutProperty.size.px_width,b=parseFloat(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_WIDTH].value);
a=(b/100*a).toFixed(2);duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH].value=a;!0===duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO].checked&&(duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PERCENT_HEIGHT].value=b,b=(b/100*duzon_dialog.structShapesLayoutProperty.size.px_height).toFixed(2),duzon_dialog.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT].value=b)});this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO].checked=
b.fixed_ratio;this.structShapesLayoutProperty.place.arrangement=b.layoutIndex;this.structShapesLayoutProperty.place.marginLeft=b.marginInfo.left;this.structShapesLayoutProperty.place.marginRight=b.marginInfo.right;this.structShapesLayoutProperty.place.marginTop=b.marginInfo.top;this.structShapesLayoutProperty.place.marginBottom=b.marginInfo.bottom;this.structShapesLayoutProperty.size.px_height=b.height;this.structShapesLayoutProperty.size.px_width=b.width;this.structShapesLayoutProperty.size.rotation_angle=
b.rotationAngle;this.structShapesLayoutProperty.size.percent_height=100;this.structShapesLayoutProperty.size.percent_width=100;this.structShapesLayoutProperty.size.fixed_ratio=b.fixed_ratio}catch(d){dalert(d)}},getUpdatedShapesLayoutData:function(){try{a:{for(var a=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT;a<=SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT;a++)if(!0===duzon_dialog.arrShapesLayoutDialogElement[a].childNodes[0].checked){var b=a;break a}b=void 0}var c=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_LEFT].value),
d=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT].value),e=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_TOP].value),f=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM].value),g=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_HEIGHT].value),h=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.PX_WIDTH].value),k=parseFloat(this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE].value),
l=this.arrShapesLayoutDialogElement[SHAPES_LAYOUT_DIALOG.FIXED_RATIO].checked;a=[];for(var m=4;m<SHAPES_LAYOUT_DIALOG.DIALOG_MENU_COUNTS;m++)switch(m){case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT:this.structShapesLayoutProperty.place.arrangement!==b&&(this.structShapesLayoutProperty.place.arrangement=b,a.push(m));break;case SHAPES_LAYOUT_DIALOG.MARGIN_LEFT:!1===isNaN(c)&&this.structShapesLayoutProperty.place.marginLeft!==c&&(this.structShapesLayoutProperty.place.marginLeft=Math.round(g_objCommonUtil.CMToPx(c)),
a.push(m));break;case SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT:!1===isNaN(d)&&this.structShapesLayoutProperty.place.marginRight!==d&&(this.structShapesLayoutProperty.place.marginRight=Math.round(g_objCommonUtil.CMToPx(d)),a.push(m));break;case SHAPES_LAYOUT_DIALOG.MARGIN_TOP:!1===isNaN(e)&&this.structShapesLayoutProperty.place.marginTop!==e&&(this.structShapesLayoutProperty.place.marginTop=Math.round(g_objCommonUtil.CMToPx(e)),a.push(m));break;case SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM:!1===isNaN(f)&&this.structShapesLayoutProperty.place.marginBottom!==
f&&(this.structShapesLayoutProperty.place.marginBottom=Math.round(g_objCommonUtil.CMToPx(f)),a.push(m));break;case SHAPES_LAYOUT_DIALOG.PX_HEIGHT:!1===isNaN(g)&&this.structShapesLayoutProperty.size.px_height!==g&&(this.structShapesLayoutProperty.size.px_height=Math.round(g_objCommonUtil.CMToPx(g)),a.push(m));break;case SHAPES_LAYOUT_DIALOG.PX_WIDTH:!1===isNaN(h)&&this.structShapesLayoutProperty.size.px_width!==h&&(this.structShapesLayoutProperty.size.px_width=Math.round(g_objCommonUtil.CMToPx(h)),
a.push(m));break;case SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE:!1===isNaN(k)&&this.structShapesLayoutProperty.size.rotation_angle!==k&&(this.structShapesLayoutProperty.size.rotation_angle=k,a.push(m));break;case SHAPES_LAYOUT_DIALOG.FIXED_RATIO:this.structShapesLayoutProperty.size.fixed_ratio!==l&&(this.structShapesLayoutProperty.size.fixed_ratio=l,a.push(m))}return a}catch(n){dalert(n)}},createShapesTable:function(a){try{var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding",
"0");b.setAttribute("border","0");for(var c=eval(duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].refInfoDB),d=0;d<c.length;d++){duzon_dialog.createTitleRowCell(b,20,c[d].name);duzon_dialog.createEmptyRowCell(b,2,20);b.insertRow().setAttribute("height","5");for(var e=c[d].contents,f,g,h,k,l=0;l<e.length;l++)if(4!==l||!1!==a){2!==l&&(h=b.insertRow(),h.setAttribute("height","30px"),h.insertCell().setAttribute("width","5"));f=e[l];for(var m=0;m<f.length;m++)g=duzon_dialog.createShapesObject(f[m]),
k=h.insertCell(),k.appendChild(g),k.setAttribute("width","30px"),k.setAttribute("height","30px"),k.setAttribute("align","center"),h.insertCell().setAttribute("width","5");2!==l&&b.insertRow().setAttribute("height","5")}}return b}catch(n){dalert(n)}},createShapesObject:function(a){try{var b=duzon_dialog.extendsDlgTypeInfo[duzon_dialog.nExtendsDlgType].strExtendsDlgType,c=document.createElement("div");c.className="dze_"+b+"_unit_item";c.innerHTML=duzon_dialog.makeShapesItemHTML(a);(function(){c.onmousedown=
function(a){TBCancelBubbleEvent(a?a:window.event)};c.onmouseover=function(a){dlog("onmouseover event call");a=duzon_dialog.ext_contents_container.getElementsByTagName("table")[0];a=duzon_menubar.calcElementPosition(a);var b=duzon_menubar.calcElementPosition(this.parentNode);duzon_dialog.overLayerObjProcess(c.innerHTML,null,null,null,null,a.left+b.left-1,a.top+b.top-1,this)}})();return c}catch(d){dalert(d)}},makeShapesItemHTML:function(a){var b=dzeEnvConfig.strPath_Image+"shapes/"+a[0];b=getFullUrlFromPath(b);
var c=this.getShapeTitle(a[1]);return"<img src='"+b+"' width='28' height='28' alt='"+c+"' shape_type='"+a[1]+"'/>"},getShapeTitle:function(a){var b="";switch(a){case SHAPE_TYPE.SQUARE_RIGHT_ANGLE:b=ID_RES_CONST_STRING_SHAPES_SQUARE_RIGHT_ANGLE;break;case SHAPE_TYPE.SQUARE_ROUNDED:b=ID_RES_CONST_STRING_SHAPES_SQUARE_ROUNDED;break;case SHAPE_TYPE.SQUARE_TRAPEZOID:b=ID_RES_CONST_STRING_SHAPES_SQUARE_TRAPEZOID;break;case SHAPE_TYPE.SQUARE_PARALLELOGRAM:b=ID_RES_CONST_STRING_SHAPES_SQUARE_PARALLELOGRAM;
break;case SHAPE_TYPE.SQUARE_DIAMOND:b=ID_RES_CONST_STRING_SHAPES_SQUARE_DIAMOND;break;case SHAPE_TYPE.SQUARE_TEXTBOX:b=ID_RES_CONST_STRING_TEXTBOX;break;case SHAPE_TYPE.TRIANGLE_ISOSCELES_TOP:b=ID_RES_CONST_STRING_SHAPES_TRIANGLE_ISOSCELES_TOP;break;case SHAPE_TYPE.TRIANGLE_ISOSCELES_RIGHT:b=ID_RES_CONST_STRING_SHAPES_TRIANGLE_ISOSCELES_RIGHT;break;case SHAPE_TYPE.TRIANGLE_RIGHT_ANGLE:b=ID_RES_CONST_STRING_SHAPES_TRIANGLE_RIGHT_ANGLE;break;case SHAPE_TYPE.CIRCLE:b=ID_RES_CONST_STRING_SHAPES_CIRCLE;
break;case SHAPE_TYPE.ELLIPSE:b=ID_RES_CONST_STRING_SHAPES_ELLIPSE;break;case SHAPE_TYPE.ARROW_RIGHT:b=ID_RES_CONST_STRING_SHAPES_ARROW_RIGHT;break;case SHAPE_TYPE.ARROW_TOP:b=ID_RES_CONST_STRING_SHAPES_ARROW_TOP;break;case SHAPE_TYPE.ARROW_LEFT_RIGHT:b=ID_RES_CONST_STRING_SHAPES_ARROW_LEFT_RIGHT;break;case SHAPE_TYPE.ARROW_TOP_BOTTOM:b=ID_RES_CONST_STRING_SHAPES_ARROW_TOP_BOTTOM;break;case SHAPE_TYPE.LINE_NORMAL:b=ID_RES_CONST_STRING_SHAPES_LINE_NORMAL;break;case SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION:b=
ID_RES_CONST_STRING_SHAPES_LINE_ARROW_UNI_DIRECTION;break;case SHAPE_TYPE.LINE_ARROW_BI_DIRECTION:b=ID_RES_CONST_STRING_SHAPES_LINE_ARROW_BI_DIRECTION}return b},getFileSubjectInputFormContainer:function(){return"<div style='width:370px;height:auto;' id='dze_idx_file_save_remote'>\uc81c\ubaa9 &nbsp; <input type='text' style='width:310px' id='dze_idx_file_save_remote_subject' value='' placeholer=''></input></div>"},getFileSubjectInputFormWithFileList:function(a){try{var b=document.createElement("div"),
c=document.createElement("div"),d=document.createElement("input"),e=document.createElement("div"),f=duzon_dialog.getTabContents(3,[ID_RES_CONST_STRING_BROWSER_MY,ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST,ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST],[oneffice.getListViewMgr().getFileListContainer(!0),""],[100,90,100],g_objPropTagTableCreate.buildTagTableCreateCommon(),[function(){oneffice.getListViewMgr().openFileListOnload(a,CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE)},function(){oneffice.getListViewMgr().openFileListOnload(a,
CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST)},function(){oneffice.getListViewMgr().openFileListOnload(a,CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST)}]);c.id="dze_idx_file_save_remote";c.style.height="auto";c.style.padding="16px 14px 5px 14px";c.innerHTML=ID_RES_PROP_TEMPLETE_STRING_SUBJECT+" &nbsp;";d.type="text";d.style.width="440px";d.id="dze_idx_file_save_remote_subject";d.value="";d.placeholder="";e.className="duzon_dialog_label_separator";
b.appendChild(c);c.appendChild(d);b.appendChild(e);b.appendChild(f);return b}catch(g){dalert(g)}},getFileSubjectInputFormOnload:function(a){try{document.getElementById("dze_idx_file_save_remote_subject").onkeydown=function(b){b.keyCode==ID_KEYCODE_ENTER&&onSaveOkClick(a)},document.getElementById("dze_idx_file_save_remote_subject").select()}catch(b){dalert(b)}},getMapDialog:function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_large_map";a.id="dze_idx_map_dialog";return a}catch(b){dalert(b)}},
getSelectedItemContainer:function(a,b){try{var c="";c+="<table width='100%' border='0' cellspacing='0' cellpadding='0' class='selected_report_table'>";c+="<tr>";c+="<td style='width:95%; font-weight: bold;'>";c+=!0===b?ID_RES_STRING_SELECTED_REPORT:ID_RES_STRING_SELECTED_DOC;c+="</td>";c+="<td id='dze_item_trash_can'; style='width:5%; text-align:right;'>";c+="<img style='width:20px; height:22px;' src='"+dzeEnvConfig.strPath_Image+"cloud/ico_cloud_trashbox.png'>";c+="</td>";c+="</tr>";c+="<tr>";c+=
"<td>";c+="<div style='margin-top: 5px; background-color:#ffffff;border:#d9d9d9 1px solid;width:auto;height:150px;overflow:auto;padding:5px 10px;'>";c+="<ol id="+a+" style='padding:0; margin:0'></ol>";c+='<div class="nodata">';c+='<img src="./image/bizcube/img_empty_template.png">';c+="<div>"+(!0===b?ID_RES_STRING_SELECTED_REPORT_NODATA:ID_RES_STRING_SELECTED_DOC_NODATA)+"</div>";c+="</div>";c+="</div>";c+="</td>";c+="</tr>";!0===b&&(c+="<tr>",c+="<td>",c+="<input type='radio' name='report_merge_type' value='0' id='dze_idx_report_merge_0' checked='checked'/><label for='dze_idx_report_merge_0'>"+
ID_RES_STRING_MERGE_SAME_ITEM+"</label>&nbsp;&nbsp;",c+="<input type='radio' name='report_merge_type' value='1' id='dze_idx_report_merge_1' /><label for='dze_idx_report_merge_1'>"+ID_RES_STRING_MERGE_IN_ORDER+"</label>",c+="</td>",c+="</tr>");return c+"</table>"}catch(d){dalert(d)}},arrSelectedItem:[],bChangeOrder:!1,initSelectedItemContainer:function(a){try{var b=$_("dze_merge_doc_container");if(!0!==fnObjectCheckNull(b)){var c=b.parentNode.parentNode;dzeJ(b).sortable();dzeJ(b).multisortable({distance:15,
placeholder:"merge_doc_placeholder",start:function(a,b){duzon_dialog.bChangeOrder=!0},stop:function(a,b){duzon_dialog.bChangeOrder=!1},mouseup:function(a,b){if(!0===g_browserCHK.mobile&&!1===duzon_dialog.bChangeOrder){b=a.target;var c=b.getBoundingClientRect();if(c.left<a.clientX&&a.clientX<c.right&&c.top<a.clientY&&a.clientY<c.bottom)for(a=duzon_dialog.arrSelectedItem.indexOf(b),-1===a?(b.classList.add("selected"),duzon_dialog.arrSelectedItem.push(b)):(b.classList.remove("selected"),duzon_dialog.arrSelectedItem.splice(a,
1)),a=0;a<duzon_dialog.arrSelectedItem.length;a++)b=duzon_dialog.arrSelectedItem[a],b.classList.add("selected")}}});var d=$_("dze_item_trash_can"),e;c.setAttribute("colspan",2);b.style.lineHeight=2;this.setTrashCanEventListener(d);for(c=0;c<a.length;c++){var f=a[c];1==(void 0===f.type?f.fileType:f.type)&&(e=this.createSelectedItem(f))&&b.appendChild(e)}onefficeExtContent.checkSelectedEmpty()}}catch(g){dalert(g)}},createSelectedItem:function(a){try{var b=null,c=a?a.seq:null,d=a&&a.empName?a.empName:
"";b=!1===fnObjectCheckNull(a)?!1===fnObjectCheckNull(a.subject)?a.subject:a.docData.strTitle:null;if(!b||!c)return null;var e=document.createElement("li");e.className="merge_doc_item";e.innerHTML=b;e.setAttribute("doc_no",c);e.setAttribute("emp_name",d);return e}catch(f){dalert(f)}},setTrashCanEventListener:function(a){try{a.addEventListener("click",function(a){a=dzeJ("#dze_merge_doc_container")[0];if(!1===fnObjectCheckNull(a)){for(var b=a.childNodes,d=null,e=!1,f=0;f<b.length;f++)d=b[f],!0===g_objPropertyUtil.element_hasClass(d,
"selected")&&("undefined"!==typeof onefficeExtContent&&onefficeExtContent.removeSelectedItem(d.getAttribute("doc_no")),a.removeChild(d),f--,e=!0);if(!0===e){var g=this.firstChild,h=g.src;!0===g_browserCHK.mobile&&(h=h.substring(0,h.lastIndexOf("/")+1),h+="ico_cloud_trashbox_open.png",g.src=h);setTimeout(function(){h=h.substring(0,h.lastIndexOf("/")+1);h+="ico_cloud_trashbox.png";g.src=h},200)}onefficeExtContent.checkSelectedEmpty()}},!1),a.addEventListener("mouseenter",function(a){a=dzeJ("#dze_merge_doc_container")[0];
if(!1===fnObjectCheckNull(a)){a=a.childNodes;for(var b,d=0;d<a.length;d++)if(b=a[d],!0===g_objPropertyUtil.element_hasClass(b,"selected")){a=this.firstChild;b=a.src;b=b.substring(0,b.lastIndexOf("/")+1);b+="ico_cloud_trashbox_open.png";a.src=b;break}}},!1),a.addEventListener("mouseleave",function(a){a=this.firstChild;var b=a.src;b=b.substring(0,b.lastIndexOf("/")+1);a.src=b+"ico_cloud_trashbox.png"},!1)}catch(b){dalert(b)}},addSelectedItem:function(a){try{var b=$_("dze_merge_doc_container");if(!0!==
fnObjectCheckNull(b)){for(var c=0;c<b.childNodes.length;c++)if(a.seq===b.childNodes[c].getAttribute("doc_no"))return;var d=this.createSelectedItem(a);!1===fnObjectCheckNull(d)&&(b.appendChild(d),onefficeExtContent.checkSelectedEmpty())}}catch(e){dalert(e)}},createInputBoxDialog:function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_small";var b=document.createElement("table");b.setAttribute("cellspacing","0");b.setAttribute("cellpadding","0");b.setAttribute("width","100%");
b.setAttribute("style","border-collapse:collapse;");var c=b.insertRow(),d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent="id";d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML="<input type='text' name='dze_input_box_id' value='' id='id_dze_input_box_id' style='width: 106px; padding: 0px 5px;'/>";g_objPropTagCommon.makeEmptyLine(b,2,4,"height: 4px;");c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent="key";
d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML="<input type='text' name='dze_input_box_key' value='' id='id_dze_input_box_key' style='width: 106px; padding: 0px 5px;'/>";g_objPropTagCommon.makeEmptyLine(b,2,4,"height: 4px;");c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent=ID_RES_DIALOG_STRING_WIDTH;d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML="<input type='text' name='dze_input_box_size' value='' id='id_dze_input_box_size' style='width: 106px; padding: 0px 5px; text-align: right;'/>";
c=b.insertRow();d=c.insertCell();d.colSpan=2;g_objPropTagCommon.makeSeperateLine(d,"duzon_dialog_label_separator");c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent=ID_RES_CONST_STRING_FONT_NAME;for(var e=[],f=1;f<g_arrFontName.length;f++)e.push({value:g_arrFontName[f],text:g_arrFontName[f].replace(/['"]/g,"")});d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML=this.makeComboInputForm("id_dze_input_box_font_family",e,120);g_objPropTagCommon.makeEmptyLine(b,
2,4,"height: 4px;");c=b.insertRow();d=c.insertCell();d.style.width="30%";d.style.paddingLeft="5px";d.textContent=ID_RES_CONST_STRING_FONT_SIZE;e=[];for(f=1;f<g_objComboBoxWin.arrFontSize.length;f++)e.push({value:g_objComboBoxWin.arrFontSize[f],text:g_objComboBoxWin.arrFontSize[f]});d=c.insertCell();d.style.width="70%";d.style.textAlign="center";d.innerHTML=this.makeComboInputForm("id_dze_input_box_font_size",e,120);a.appendChild(b);return a.outerHTML}catch(g){dalert(g)}},inputBoxElement:{id:"",key:"",
size:"",font_family:"",font_size:""},initInputBoxDialog:function(a){try{var b=g_objLayerKit.getElementById("id_dze_input_box_id"),c=g_objLayerKit.getElementById("id_dze_input_box_key"),d=g_objLayerKit.getElementById("id_dze_input_box_size"),e=g_objLayerKit.getElementById("id_dze_input_box_font_family"),f=g_objLayerKit.getElementById("id_dze_input_box_font_size");this.inputBoxElement.id=a.getAttribute("id");this.inputBoxElement.key=a.getAttribute("mapping_key");this.inputBoxElement.size=parseFloat(a.getAttribute("size"));
this.inputBoxElement.font_family=a.style.fontFamily;this.inputBoxElement.font_size=a.style.fontSize;if(!0===fnObjectCheckNull(this.inputBoxElement.id)||0===this.inputBoxElement.id.length)this.inputBoxElement.id="";if(!0===fnObjectCheckNull(this.inputBoxElement.key)||0===this.inputBoxElement.key.length)this.inputBoxElement.key="";!0===isNaN(this.inputBoxElement.size)&&(this.inputBoxElement.size=0);!0===fnObjectCheckNull(this.inputBoxElement.font_family)&&(this.inputBoxElement.font_family="[\ub354\uc874] \ubcf8\ubb38\uccb4 30");
!0===fnObjectCheckNull(this.inputBoxElement.font_size)&&(this.inputBoxElement.font_size="9pt");b.value=this.inputBoxElement.id;c.value=this.inputBoxElement.key;d.value=this.inputBoxElement.size;e.value=this.inputBoxElement.font_family;f.value=this.inputBoxElement.font_size;b.select()}catch(g){dalert(g)}},setInputBoxStyle:function(a){try{var b=g_objLayerKit.getElementById("id_dze_input_box_id"),c=g_objLayerKit.getElementById("id_dze_input_box_key"),d=g_objLayerKit.getElementById("id_dze_input_box_size"),
e=g_objLayerKit.getElementById("id_dze_input_box_font_family"),f=g_objLayerKit.getElementById("id_dze_input_box_font_size"),g=b.value,h=c.value,k=parseFloat(d.value),l=e.value,m=f.value;this.inputBoxElement.id!==g&&a.setAttribute("id",g);this.inputBoxElement.key!==h&&a.setAttribute("mapping_key",h);this.inputBoxElement.size!==k&&a.setAttribute("size",k);this.inputBoxElement.font_family!==l&&(a.style.fontFamily=l);this.inputBoxElement.font_size!==m&&(a.style.fontSize=m)}catch(n){dalert(n)}},createExternalDateDialog:function(){try{var a=
document.createElement("div");a.className="duzon_dialog_content_medium";var b=document.createElement("div");b.style.width="auto";b.style.height="auto";var c=document.createElement("div");c.innerHTML=ID_RES_DIALOG_STRING_URL_INPUT;c.className="duzon_dialog_label_title";c.style.height="auto";b.appendChild(c);var d=document.createElement("input");d.type="text";d.id="dze_id_external_url";d.className="duzon_dialog_body_urlform";d.maxLength="200";d.setAttribute("style","width: 324px !important; margin-right: 4px; margin-top: 12px;");
b.appendChild(d);var e=document.createElement("input");e.type="button";e.value="\uac00\uc838\uc624\uae30";e.id="dze_id_external_button";e.className="duzon_dialog_btn_upload";b.appendChild(e);a.appendChild(b);return a.outerHTML}catch(f){dalert(f)}},initExternalDateDialog:function(){try{var a=g_objLayerKit.getElementById("dze_id_external_url"),b=g_objLayerKit.getElementById("dze_id_external_button");!1===fnObjectCheckNull(a)&&(a.onkeydown=function(a){a.keyCode==ID_KEYCODE_ENTER&&document.getElementById("dze_id_external_button").click()});
!1===fnObjectCheckNull(b)&&(b.onclick=function(){var a=document.getElementById("dze_id_external_url");fnHandler_getExternalData(a.value,g_objPageControl.nEditNumber)})}catch(c){dalert(c)}},createDocHistoryDetail:function(a){try{var b=document.createElement("div");b.className="duzon_dialog_content_small";var c=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("table"),h=g.insertRow(),k=h.insertCell();
b.appendChild(c);c.appendChild(d);c.appendChild(e);g_objPropTagCommon.makeSeperateLine(b,"duzon_dialog_label_separator");b.appendChild(f);f.appendChild(g);d.style.fontFamily="\ub9d1\uc740 \uace0\ub515";d.style.fontSize="12px";d.style.fontWeight="bold";d.style.lineHeight="1.67";d.textContent=a[0];e.style.fontFamily="\ub9d1\uc740 \uace0\ub515";e.style.fontSize="12px";e.style.fontWeight="bold";e.style.lineHeight="1.67";e.textContent=a[1];g.width="100%";g.style.fontFamily="\ub9d1\uc740 \uace0\ub515";
g.style.fontSize="12px";g.style.lineHeight="2";g.style.textAlign="left";k.style.width="60px";k.textContent=ID_RES_CONST_STRING_DOCUMENT_HISTORY_ACTION_TYPE;k=h.insertCell();k.style.width="calc(100% - 60px)";c=null;0==a[2]?c=ID_RES_CONST_PANEL_CREATE_NEW_DOC:1==a[2]?c=ID_RES_CONST_STRING_VIEWING:2==a[2]?c=ID_RES_TOOL_STRING_MENU_EDIT:3==a[2]?c=ID_RES_CONST_STRING_RENAME:4==a[2]?(c=ID_RES_CONST_STRING_SHARE_DOCUMENT,!1===fnObjectCheckNull(a[5])&&(c="w"===a[5].toLowerCase()?c+("["+ID_RES_CONST_STRING_EDITABLE.trim()+
"]"):c+("["+ID_RES_CONST_STRING_VIEWABLE.trim()+"]"))):5==a[2]?c=ID_RES_CONST_STRING_UNSHARE_DOCUMENT:6==a[2]?c=ID_RES_CONST_STRING_SET_READONLY_ON:7==a[2]?c=ID_RES_CONST_STRING_SET_READONLY_OFF:8==a[2]?c=ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING:9==a[2]?c=ID_RES_CONST_STRING_DOCUMENT_SECURITY_RESET:10==a[2]?c=ID_RES_CONST_STRING_DOCUMENT_SECURITY_RESET:14==a[2]?c=ID_RES_CONST_STRING_SAVEAS_REMOTE:15==a[2]&&(c=ID_RES_STRING_CHG_OWN,a[5]&&a[6]&&(c+=" ("+a[5]+" > "+a[6]+")"));k.textContent=c;if(4==
a[2]||5==a[2])h=g.insertRow(),k=h.insertCell(),k.style.width="60px",k.textContent=ID_RES_CONST_STRING_DOCUMENT_HISTORY_SHARE_INFO.trim(),k=h.insertCell(),k.style.width="calc(100% - 60px)",c=null,c=!1===fnObjectCheckNull(a[6])&&0!==a[6].length?ID_RES_CONST_STRING_CUSTOM_SHARE:ID_RES_CONST_STRING_OPEN_LINK,5==a[2]&&(c+=ID_RES_CONST_STRING_CLEAR),k.textContent=c;h=g.insertRow();k=h.insertCell();k.style.width="60px";k.textContent=ID_RES_CONST_STRING_DOCUMENT_HISTORY_DEVIDE_INFO;k=h.insertCell();k.style.width=
"calc(100% - 60px)";k.textContent=onefficeGW.getDeivceStringByCode(a[3]);h=g.insertRow();k=h.insertCell();k.style.width="60px";k.textContent=ID_RES_CONST_STRING_IP_ADDRESS;k=h.insertCell();k.style.width="calc(100% - 60px)";k.textContent=""!==a[4]?a[4]:ID_RES_DIALOG_STRING_NONE;return b.outerHTML}catch(l){dalert(l)}},createAuth_RequestDialog:function(a,b,c){try{var d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),
k=document.createElement("img"),l=document.createElement("div"),m=document.createElement("div"),n=document.createElement("img"),p=document.createElement("div"),q=document.createElement("img"),r=document.createElement("img");d.className="duzon_dialog_content_small";e.style.fontFamily="\ub9d1\uc740 \uace0\ub515";e.style.fontSize="12px";e.style.fontWeight="bold";e.style.color="black";e.style.textAlign="center";e.style.margin="14px 0px 15px";var u="";a===USER_WRITE_AUTH.REQUEST_TO?u+=String.format(ID_RES_CONST_PANEL_MSG_CONFIRM_WRITE_AUTH,
"<span style='color: #1c90fb;'>"+ID_RES_CONST_PANEL_REQUEST+"</span>"):(a===USER_WRITE_AUTH.REQUEST_FROM&&(u=ID_RES_CONST_PANEL_MSG_REQUEST_WRITE_AUTH_FROM+"<br>"),u+=String.format(ID_RES_CONST_PANEL_MSG_CONFIRM_WRITE_AUTH,"<span style='color: #1c90fb;'>"+ID_RES_CONST_PANEL_PASS_TO+"</span>"));e.innerHTML=u;f.style.width="270px";f.style.height=a===USER_WRITE_AUTH.REQUEST_FROM?"108px":"124px";f.style.textAlign="center";f.style.border="1px solid #dedede";f.style.borderRadius="5px";g.style.width="auto";
g.style.height="auto";g.style.position="relative";g.style.top="50%";g.style.transform="translateY(-50%)";h.style.width="60px";h.style.height="auto";h.style.display="inline-block";k.style.width="34px";k.style.height="34px";k.style.marginBottom="5px";k.style.borderRadius="17px";k.src=b[0];l.style.fontFamily="\ub9d1\uc740 \uace0\ub515";l.style.fontSize="12px";l.style.color="black";l.innerHTML=b[1].replace(" ","<br>");d.appendChild(e);d.appendChild(f);f.appendChild(g);g.appendChild(h);h.appendChild(k);
h.appendChild(l);r.style.width="15px";r.style.height="15px";r.style.position="absolute";r.style.left="88px";r.style.top="24px";r.src="./image/cloud/ico_auth_edit.png";a===USER_WRITE_AUTH.PASS_TO&&h.appendChild(r);a!==USER_WRITE_AUTH.REQUEST_FROM&&!1===fnObjectCheckNull(c)&&(q.style.width="40px",q.style.height="15px",q.style.margin="0px 5px",q.style.position="relative",q.style.top="-40px",q.src="./image/cloud/img_auth_pass_arrow.png",m.style.width="60px",m.style.height="auto",m.style.display="inline-block",
n.style.width="34px",n.style.height="34px",n.style.marginBottom="5px",n.style.borderRadius="17px",n.src=c[0],p.style.fontFamily="\ub9d1\uc740 \uace0\ub515",p.style.fontSize="12px",p.style.color="black",p.innerHTML=c[1].replace(" ","<br>"),g.appendChild(q),g.appendChild(m),m.appendChild(n),m.appendChild(p),a===USER_WRITE_AUTH.REQUEST_TO&&(r.style.left="198px",m.appendChild(r)));return d.outerHTML}catch(t){dalert(t)}},createAuthCall_ResultDialog:function(a){try{var b=document.createElement("div"),c=
document.createElement("img"),d=document.createElement("div");b.className="duzon_dialog_content_small";c.style.width="38px";c.style.height="38px";c.style.margin="14px 0px";c.style.position="relative";c.style.left="calc(50% - 19px)";c.src="./image/cloud/ico_warning.png";d.style.fontFamily="\ub9d1\uc740 \uace0\ub515";d.style.fontSize="12px";d.style.fontWeight="bold";d.style.color="black";d.style.textAlign="center";d.style.marginBottom="14px";var e="";a===USER_WRITE_AUTH.RESPONSE_DENY?e=String.format(ID_RES_CONST_PANEL_MSG_REJECT_WRITE_AUTH,
"<span style='color: #1c90fb;'>"+ID_RES_CONST_PANEL_REJECT+"</span>"):a===USER_WRITE_AUTH.RESPONSE_DUPL?e=String.format(ID_RES_CONST_PANEL_MSG_DUPLICATED_REQUEST,"<span style='color: #1c90fb;'>"+ID_RES_CONST_PANEL_REQUESTING+"</span>"):a===USER_WRITE_AUTH.RESPOSNE_SUCCESS?e=String.format(ID_RES_CONST_PANEL_REQUEST_WRITE_SUCCESS):a===USER_WRITE_AUTH.RESPONSE_EDITOR_OUT&&(e=String.format(ID_RES_CONST_PANEL_AM_EDITOR_OUT));d.innerHTML=e;b.appendChild(c);b.appendChild(d);return b.outerHTML}catch(f){dalert(f)}},
createQRInsertDialog:function(){try{var a="",b=dzeEnvConfig.strPath_Image+"dialog/icon_preview.png",c=dzeEnvConfig.strPath_Image+"dialog/qrcode_first_top_right.png",d=dzeEnvConfig.strPath_Image+"dialog/qrcode_last_bottom.png",e=dzeEnvConfig.strPath_Image+"dialog/icon_select.png";a+='<table cellpadding="0" cellspacing="0" width="370px" height="280px" style="background-color: white; padding: 14px 16px 0;">';a+="<tbody>";a+='<tr height="30px">';a+='<td colspan="2">';a+='<div class="qrcode_preview_button" id="dze_idx_qrcode_preview">';
a+='<img src="'+b+'" style="margin-right: 5px;">'+ID_RES_CONST_STRING_PREVIEW;a+="</div>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div class="qrcode_firstpage_control" id="dze_idx_qrcode_first_sel" selected="no">';a+='<img src="'+c+'" style="margin: 9px;">';a+='<img src="'+e+'" style="display: none; position: relative; top: -100px; left: 42px;">';a+="</div>";a+='<div class="qrcode_firstpage_info">'+ID_RES_CONST_STRING_QRCODE_FITST_INFO+"</div>";a+="</td>";a+="<td>";a+='<div class="qrcode_lastpage_control" id="dze_idx_qrcode_last_sel" selected="no">';
a+='<img src="'+d+'" style="margin: 9px;">';a+='<img src="'+e+'" style="display: none; position: relative; top: -100px; left: 42px;">';a+="</div>";a+='<div class="qrcode_lastpage_info">'+ID_RES_CONST_STRING_QRCODE_LAST_INFO+"</div>";a+="</td>";a+="</tr>";return a+"</tbody></table>"}catch(f){dalert(f)}},moveToPageContents:function(){try{var a="";a+=ID_RES_CONST_STRING_PAGE_NUMBER_BOX_MSG+" (1 ~ "+g_objPageControl.getTotalPageCount()+"):<br>";return a+'<input id="dze_idx_move_page_input" type="text" autocomplete="off" style="width: 200px; margin-top: 10px;" />'}catch(b){dalert(b)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var a="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};
$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in c||(c[e]={});c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function a(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;a.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){d(a,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_=function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)f.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var f=new a;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(r){g(r)}}:b}var d,g,f=new e(function(a,b){d=a;g=b});this.callWhenSettled_(c(a,d),c(b,g));return f};
e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(c)};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),g=e.next();!g.done;g=e.next())c(g.value).callWhenSettled_(b,
d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function g(b){return function(c){f[b]=c;h--;0==h&&a(f)}}var f=[],h=0;do f.push(void 0),h++,c(d.value).callWhenSettled_(g(f.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
var onefficeChart={previewChart:null,showViewCharts:[],legend_view:!0,legend_position:"bottom",legend_foreColor:"#000000",legend_fontsize:14,legend_font:"'[\ub354\uc874] \ubcf8\ubb38\uccb4 30', '\ub9d1\uc740 \uace0\ub515', '\ub457\uc6c0\uccb4', 'Arial'",data_label_view:!1,data_label_color:"#000000",data_label_padding_y:5,data_label_padding_x:0,data_label_FontSize:14,data_label_font:"'[\ub354\uc874] \ubcf8\ubb38\uccb4 30', '\ub9d1\uc740 \uace0\ub515', '\ub457\uc6c0\uccb4', 'Arial'",data_label_unit:void 0,
data_label_unit_set:[{value:"",text:"\uc5c6\uc74c"},{value:"%",text:"%"},{value:"\uc6d0",text:"\uc6d0"},{value:"\uac74",text:"\uac74"},{value:"user_custom_unit",text:"\uae30\ud0c0"}],data_graph_border:[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1],data_border_style:"solid solid solid solid solid solid solid solid solid solid solid solid solid solid solid".split(" "),chartTitle:"",chartTitleFontSize:14,chartTitleFontColor:"#FF0000",chartTitlePadding:20,chartTitleLineHeight:1.2,chartTitleFont:"'[\ub354\uc874] \ubcf8\ubb38\uccb4 30', '\ub9d1\uc740 \uace0\ub515', '\ub457\uc6c0\uccb4', 'Arial'",
chartTitleFontStyle:"bold",insertMode:!1,chartImageSrc:"",chartType:"bar",currChartSeq:0,makeDatasets:[],makeOptions:[],makeLabels:[],chartData:[],lineTension:0,colorSet:" #5B9BD5 #ED7D31 #A5A5A5 #FFC000 #4472C4 #70AD47 #1F4E79 #843C0C #525252 #7F6000 #203864 #385723 #9DC3E6 #F4B183 #C9C9C9 #FFD966 #8FAADC #A9D18E #2E75B6 #C55A11 #7C7C7C #BF9000 #2F5597 #548235 #BDD7EE #F8CBAD #DBDBDB #FFE699 #B4C7E7 #C5E0B4".split(" "),colorAlphaSet:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10,1,1,1,1,1,10,1,1,1,1,1,10,1,1],
colorBorderSet:" #5B9BD5 #ED7D31 #A5A5A5 #FFC000 #4472C4 #70AD47 #1F4E79 #843C0C #525252 #7F6000 #203864 #385723 #9DC3E6 #F4B183 #C9C9C9 #FFD966 #8FAADC #A9D18E #2E75B6 #C55A11 #7C7C7C #BF9000 #2F5597 #548235 #BDD7EE #F8CBAD #DBDBDB #FFE699 #B4C7E7 #C5E0B4".split(" "),colorBorderAlphaSet:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],defaultColorSet:" #5B9BD5 #ED7D31 #A5A5A5 #FFC000 #4472C4 #70AD47 #1F4E79 #843C0C #525252 #7F6000 #203864 #385723 #9DC3E6 #F4B183 #C9C9C9 #FFD966 #8FAADC #A9D18E #2E75B6 #C55A11 #7C7C7C #BF9000 #2F5597 #548235 #BDD7EE #F8CBAD #DBDBDB #FFE699 #B4C7E7 #C5E0B4".split(" "),
defaultFontFamily:"'[\ub354\uc874] \ubcf8\ubb38\uccb4 30', '\ub9d1\uc740 \uace0\ub515', '\ub457\uc6c0\uccb4', 'Arial'",chartResizeRepaint:!0,sampleData:[],bInsertChartTable:!0,chart_type_list:[],new_chart_data:!0,bAllowDecimal:!1,setChartTypeList:function(){this.chart_type_list=[["bar",ID_RES_CONST_STRING_CHART_TYPE_BAR,!0],["horizontalBar",ID_RES_CONST_STRING_CHART_TYPE_HBAR,!0],["line",ID_RES_CONST_STRING_CHART_TYPE_LINE,!0],["radar",ID_RES_CONST_STRING_CHART_TYPE_RADAR,!0],["pie",ID_RES_CONST_STRING_CHART_TYPE_PIE,
!1],["doughnut",ID_RES_CONST_STRING_CHART_TYPE_DOUGHNUT,!1],["polarArea",ID_RES_CONST_STRING_CHART_TYPE_POLARAREA,!1]];this.sampleData=[["",ID_RES_STRING_CHART_COLUMN+" 1",ID_RES_STRING_CHART_COLUMN+" 2",ID_RES_STRING_CHART_COLUMN+" 3"],[ID_RES_STRING_CHART_ITEM+" 1","90","85","60"],[ID_RES_STRING_CHART_ITEM+" 2","95","100","85"],[ID_RES_STRING_CHART_ITEM+" 3","60","95","100"],[ID_RES_STRING_CHART_ITEM+" 4","95","60","85"]]},getChartTypeArray:function(b){this.setChartTypeList();for(var a=0;a<this.chart_type_list.length;a++)if(this.chart_type_list[a][0]==
b)return this.chart_type_list[a];return this.chart_type_list[0]},getChartDlgContainer:function(b){try{!0===fnObjectCheckNull(b)&&(b=!1);this.setChartTypeList();var a="";a+="<div class='duzon_dialog_content_big'>";a+="<div class='oneffice_chart_table_insert_label'>";a+="<div id='idx_chart_icon_btn_01' class='chart_icon_01'></div>";a+="<div id='idx_chart_icon_btn_02' class='chart_icon_02'></div>";a+="<div id='idx_chart_icon_btn_03' class='chart_icon_03'></div>";a+="<div id='idx_chart_icon_btn_04' class='chart_icon_04'></div>";
a+="<div id='idx_chart_icon_btn_05' class='chart_icon_05'></div>";a+="<div id='idx_chart_icon_btn_06' class='chart_icon_06'></div>";a+="<div id='idx_chart_icon_btn_07' class='chart_icon_07'></div>";a+="<div id='idx_chart_icon_btn_08' class='chart_icon_08'></div>";a+="<div id='idx_onefficeChartPreview' class='oneffice_chart_preview'></div>";a+="<input type='checkbox' id='dze_idx_chart_table_insert' value='1' "+(!0===b?"disabled":"")+"/><label for='dze_idx_chart_table_insert'>"+ID_RES_CONST_STRING_INSERT_TABLE_WITH_CHART+
"</label>";!0===dzeUiConfig.bUseReportForm&&(a+="<div>",a+="<div style='width: 50%; display: inline-block;'><input type='checkbox' id='dze_idx_chart_from_external' value='1' /><label for='dze_idx_chart_from_external'>\uc678\ubd80 \ub370\uc774\ud130 \ubc14\uc778\ub529</label></div>",a+="<div style='width: 50%; display: inline-block;'>Key: <input type='text' id='dze_idx_chart_mapping_key' value='' style='display: inline-block; margin-left: 20px; width: calc(100% - 71px);'/></div>",a+="</div>");a+="</div>";
a+="</div>";var c=document.createElement("div");c.innerHTML=a;return c.childNodes[0]}catch(d){dalert(d)}},makeChartData:function(){try{this.chartData=[];var b=[],a=[];if(GetCurTable()||!0===GetMultiCellSelection()){var c=null;c=GetMultiCellSelection()?g_objTableSelection.doAllSelectedCell.bind(this):g_objTableSelection.doAllCell.bind(this);var d=-1;c(function(c,e){-1==d&&(d=e);e!=d&&(d=e,b.push(a),a=[]);e=c.innerText;e=e.removeComma().trim();e=e.replace(/\u200B/g,"");for(var g=0;g<c.colSpan;g++)a.push(e)});
b.push(a);if(1===b.length){var e=b[0][0],f=b[0],g=!0,h=f[f.length-1];!0===isNaN(h)&&(g=!1);if(g){a=[];for(var k=0;k<f.length;k++)a.push("\ud56d\ubaa9"+(k+1));b.unshift(a)}!1===isNaN(e)?b.forEach(function(a,b){0<b?a.unshift("\uacc4\uc5f4"+b):a.unshift("")}):onefficeChart.chartTitle=e}else{e=b[0][0];var l=b[1][0];f=b[0];g=!0;h=f[f.length-1];!0===isNaN(h)&&(g=!1);c=!1;0>=e.length?c=!1:!1===isNaN(l)&&(c=!0);if(g){a=[];for(k=0;k<f.length;k++)!0===c?a.push("\ud56d\ubaa9"+(k+1)):a.push("\ud56d\ubaa9"+k);
b.unshift(a)}!0===c&&b.forEach(function(a,b){0<b?a.unshift("\uacc4\uc5f4"+b):a.unshift("")});2===b.length&&(onefficeChart.chartTitle=b[1][0])}}else b=this.sampleData,onefficeChart.chartTitle=ID_RES_CONST_STRING_CHART_TITLE;this.chartData=b}catch(n){dalert(n)}},reverseData:function(){0!=onefficeChart.chartData.length&&(onefficeChart.chartData=onefficeChart.reverseRowColTableData(onefficeChart.chartData))},reverseSortData:function(){0!=onefficeChart.chartData.length&&(onefficeChart.chartData=onefficeChart.reverseRowSortTableData(onefficeChart.chartData))},
reverseRowColTableData:function(b){try{for(var a=b.length,c=b[0].length,d=[],e=[],f=0;f<c;f++){e=[];for(var g=0;g<a;g++)e.push(b[g][f]);d.push(e)}return d}catch(h){return dalert(h),b}},reverseRowSortTableData:function(b){try{var a=[],c=b.length;a.push(b[0]);for(--c;0<c;c--)a.push(b[c]);return a}catch(d){return dalert(d),b}},makeChartSeq:function(){this.currChartSeq=(new Date).getTime()},refChartWidth:null,refChartHeight:null,makeViewChart:function(b,a,c,d){try{if(0!=onefficeChart.chartData.length){"undefined"==
typeof a?this.refChartWidth=null:this.refChartWidth=a;"undefined"==typeof c?this.refChartHeight=null:this.refChartHeight=c;this.makeChartDataSet();this.makeChartOptions(!1);this.loadChartPlugins();var e={chartHandler:new Chart(b,this.getConfig()),id:d};onefficeChart.showViewCharts.push(e)}}catch(f){dalert(f)}},makeChart:function(b,a){try{if(0!=onefficeChart.chartData.length){"undefined"==typeof b?this.refChartWidth=null:this.refChartWidth=b;"undefined"==typeof a?this.refChartHeight=null:this.refChartHeight=
a;this.makeChartDataSet();this.makeChartOptions(!0);this.loadChartPlugins();b=null;this.currChartSeq&&(b=this.getCanvasObj(this.currChartSeq));if(b){var c=b.parentNode;c.getAttribute("chart_id")==onefficeChart.getChartImageId(this.currChartSeq)&&(parseInt(c.style.width.replace(/px/,""),10),c.parentNode.removeChild(c))}onefficeChart.makeChartSeq();var d=document.createElement("div");d.setAttribute("chart_id",onefficeChart.getChartImageId(this.currChartSeq));d.style.width="480px";d.style.height="240px";
var e=document.createElement("canvas");e.setAttribute("chart_id",onefficeChart.getChartImageId(this.currChartSeq));d.appendChild(e);var f=document.getElementById("idx_onefficeChartPreview");!1===fnObjectCheckNull(f)&&(f.innerHTML="",f.appendChild(d));var g=e.getContext("2d");onefficeChart.previewChart=new Chart(g,this.getConfig())}}catch(h){dalert(h)}},getConfig:function(){return{type:onefficeChart.chartType,data:{labels:onefficeChart.makeLabels,datasets:onefficeChart.makeDatasets},options:onefficeChart.makeOptions,
defaults:{global:{defaultFont:onefficeChart.defaultFontFamily}}}},makeChartDataSet:function(){try{if(0!=onefficeChart.chartData.length){var b=this.colorSet,a=this.colorBorderSet,c=this.data_graph_border,d=Chart.helpers.color,e=this.getChartTypeArray(this.chartType);onefficeChart.makeLabels=[];onefficeChart.makeDatasets=[];var f=[],g="#FF0000",h=1,k=[];onefficeChart.bAllowDecimal=!1;var l=onefficeChart.reverseRowColTableData(onefficeChart.chartData);2>=onefficeChart.chartData.length&&("radar"===this.chartType||
"pie"===this.chartType||"line"===this.chartType||"doughnut"===this.chartType||"polarArea"===this.chartType)&&(l=onefficeChart.chartData);for(var n=0;n<l.length;n++){f=[];for(var p="",m=1;m<l[n].length;m++)0==n&&onefficeChart.makeLabels.push(l[n][m]),f.push(l[n][m]);p=l[n][0];if(0<n){if(!0!==e[2]){if(currBackColor=b,g=a,h=c,"polarArea"==this.chartType||"pie"==this.chartType||"doughnut"==this.chartType)for(currBackColor=[],g=[],h=[],m=1;m<b.length-1;m++)currBackColor.push(d(b[m]).alpha(this.colorAlphaSet[m]).rgbString()),
g.push(d(a[m]).alpha(this.colorBorderAlphaSet[m]).rgbString()),h.push(c[m])}else currBackColor=d(b[n]).alpha(this.colorAlphaSet[n]).rgbString(),g=d(a[n]).alpha(this.colorBorderAlphaSet[n]).rgbString(),h=c[n];"line"==this.chartType&&(currBackColor="transparent",k="dotted"===this.data_border_style[n]?[2,2]:"dashed"===this.data_border_style[n]?[5,5]:[]);m="rect";"pie"==this.chartType||"doughnut"==this.chartType||"line"==this.chartType?m="circle":"radar"==this.chartType&&(m="rectRot");onefficeChart.bAllowDecimal||
f.some(function(a){a=parseFloat(a);isNaN(a)||Math.ceil(a)===a||(onefficeChart.bAllowDecimal=!0)});onefficeChart.makeDatasets.push({label:p,data:f,fill:!0,backgroundColor:currBackColor,borderColor:g,borderWidth:h,pointStyle:m,pointBorderColor:g,lineTension:onefficeChart.lineTension,borderDash:k});if(!0!==e[2])break}}}}catch(q){dalert(q)}},makeChartOptions:function(b){try{var a=!0;""==this.chartTitle&&(a=!1);"undefined"==typeof b&&(b=!0);this.makeOptions={maintainAspectRatio:!1,bezierCurve:!1,legend:{display:onefficeChart.legend_view,
position:onefficeChart.legend_position,labels:{fontColor:onefficeChart.legend_foreColor,fontFamily:onefficeChart.legend_font,fontSize:onefficeChart.legend_fontsize,usePointStyle:!0}},title:{display:a,text:onefficeChart.chartTitle,padding:onefficeChart.chartTitlePadding,borderThickness:0,fontColor:onefficeChart.chartTitleFontColor,fontSize:onefficeChart.chartTitleFontSize,fontFamily:onefficeChart.chartTitleFont,fontStyle:onefficeChart.chartTitleFontStyle,lineHeight:onefficeChart.chartTitleLineHeight},
tooltips:{enabled:!1}};this.makeOptions.animation=!0===b?{animateScale:!0,animateRotate:!0}:!1;b=function(a,b,e){return onefficeChart.bAllowDecimal?a:Math.ceil(a)===a?a:""};if("line"==this.chartType||"bar"===this.chartType)this.makeOptions.scales={yAxes:[{display:!0,ticks:{beginAtZero:!0,callback:b}}]};else if("horizontalBar"===this.chartType)this.makeOptions.scales={xAxes:[{display:!0,ticks:{beginAtZero:!0,callback:b}}]};else if("radar"===this.chartType||"polarArea"===this.chartType)this.makeOptions.scale=
{ticks:{beginAtZero:!0,callback:b}}}catch(c){dalert(c)}},pluginLoading:!1,afterRenderFunction:null,afterDrawFunction:null,loadChartPlugins:function(){try{!0!==this.pluginLoading&&(this.pluginLoading=!0,Chart.plugins.register({afterDatasetsDraw:function(b){var a=b.ctx;!0===onefficeChart.data_label_view&&b.data.datasets.forEach(function(c,d){d=b.getDatasetMeta(d);d.hidden||d.data.forEach(function(b,d){a.fillStyle=onefficeChart.data_label_color;var e=onefficeChart.data_label_FontSize;a.font=Chart.helpers.fontString(e,
"normal",onefficeChart.data_label_font);var f=c.data[d].toString().setComma();void 0!==onefficeChart.data_label_unit&&(f+=onefficeChart.data_label_unit);a.textAlign="center";a.textBaseline="middle";var k=onefficeChart.data_label_padding_x,l=onefficeChart.data_label_padding_y;b=b.tooltipPosition();"bar"==onefficeChart.chartType&&0>c.data[d]&&(l-=20);a.fillText(f,b.x+k,b.y-e/2-l)})})},afterRender:function(b){"function"===typeof onefficeChart.afterRenderFunction&&onefficeChart.afterRenderFunction(b)},
afterDraw:function(b){"function"===typeof onefficeChart.afterDrawFunction&&onefficeChart.afterDrawFunction(b)}}))}catch(b){dalert(b)}},getChartImageId:function(b){return"chart_"+b},getChartImageSrc:function(b){try{var a=this.getCanvasObj(b);return fnObjectCheckNull(a)?"":this.canvasToImage(a,"#ffffff")}catch(c){return dalert(c),""}},getCanvasObj:function(b){try{for(var a=null,c=document.getElementsByTagName("canvas"),d=0;d<c.length;d++)if(c[d].getAttribute("chart_id")==onefficeChart.getChartImageId(b)){a=
c[d];break}return a}catch(e){return dalert(e),a}},insertChartImageObj:null,insertchartTableObj:null,setInsertChartMode:function(b,a){try{return new Promise(function(c,d){onefficeChart.removeChartCanvasAll();d=null;onefficeChart.currChartSeq&&(d=onefficeChart.getCanvasObj(onefficeChart.currChartSeq));d&&(d=d.parentNode,d.getAttribute("chart_id")==onefficeChart.getChartImageId(onefficeChart.currChartSeq)&&d.parentNode.removeChild(d));d=document.createElement("div");d.setAttribute("chart_id",onefficeChart.getChartImageId(onefficeChart.currChartSeq));
d.style.position="absolute";d.style.top="-10000x";d.style.left="-5000px";var e=g_objPageControl.getPageNode(0);d.style.zIndex="1";d.style.width="600px";d.style.height="300px";e&&(e=e.getElementsByClassName("dze_page_main")[0],e=parseInt(e.style.width)-20,d.style.width=e+"px",d.style.height=.45*e+"px");e=document.createElement("canvas");e.setAttribute("chart_id",onefficeChart.getChartImageId(onefficeChart.currChartSeq));d.appendChild(e);document.body.appendChild(d);e=e.getContext("2d");var f=onefficeChart.makeOptions.animation;
onefficeChart.makeOptions.animation="";onefficeChart.previewChart=new Chart(e,onefficeChart.getConfig());onefficeChart.makeOptions.animation=f;onefficeChart.insertChartImageObj=document.createElement("img");onefficeChart.insertChartImageObj.setAttribute("chart_id",onefficeChart.getChartImageId(onefficeChart.currChartSeq));e=onefficeChart.convChartDataToString();onefficeChart.insertChartImageObj.setAttribute("chart_data",e);null!=onefficeChart.refChartWidth&&null!=onefficeChart.refChartHeight?(onefficeChart.insertChartImageObj.style.width=
onefficeChart.refChartWidth+"px",onefficeChart.insertChartImageObj.style.height=onefficeChart.refChartHeight+"px"):(onefficeChart.insertChartImageObj.style.width=d.style.width,onefficeChart.insertChartImageObj.style.height=d.style.height);!0===dzeUiConfig.bSupportNewsEditor&&(d=document.querySelector("#id_image_description"),e=document.querySelector("#id_image_watermark"),!1===fnObjectCheckNull(d)&&onefficeChart.insertChartImageObj.setAttribute("news_image_keyword",d.value),!1===fnObjectCheckNull(e)&&
onefficeChart.insertChartImageObj.setAttribute("news_image_watermark",e.value),onefficeChart.insertChartImageObj.style.margin="0px auto",onefficeChart.insertChartImageObj.style.display="block");onefficeChart.insertMode=!0;onefficeChart.insertchartTableObj=null;!0===onefficeChart.bInsertChartTable&&!0===$_("dze_idx_chart_table_insert").checked&&(onefficeChart.insertchartTableObj=onefficeChart.makeDocTableObjectFromDataTable());!0===dzeUiConfig.bUseReportForm&&(!1===fnObjectCheckNull($_("dze_idx_chart_from_external"))&&
!0===$_("dze_idx_chart_from_external").checked?onefficeChart.insertChartImageObj.setAttribute("mapping_key",$_("dze_idx_chart_mapping_key").value):!1===fnObjectCheckNull(a)&&""!==a.getAttribute("mapping_key")&&onefficeChart.insertChartImageObj.setAttribute("mapping_key",a.getAttribute("mapping_key")));"undefined"!=typeof a&&null!=a&&setTimeout(function(){onefficeChart.insertChart(b,a);c()},0)})}catch(c){dalert(c)}},insertChart:function(b,a){try{if(!0===onefficeChart.insertMode&&null!=onefficeChart.insertChartImageObj){if("undefined"===
typeof a){var c=parseInt(this.insertChartImageObj.style.width,10),d=parseInt(this.insertChartImageObj.style.height,10),e=c,f=d,g=e/f,h=getMaxBoundSize(b);e>h.width&&(e=h.width,f=h.width/g);f>h.height&&(f=h.height,e=h.height*g);e=Math.max(parseInt(e,10),10);f=Math.max(parseInt(f,10),10);c!==e&&(this.insertChartImageObj.style.width=e+"px");d!==f&&(this.insertChartImageObj.style.height=f+"px");onefficeChart.insertChartImageObj.src=onefficeChart.getChartImageSrc(onefficeChart.currChartSeq);insertHTMLCodeAtSelection(null,
onefficeChart.insertChartImageObj,b)}else a.src=onefficeChart.getChartImageSrc(onefficeChart.currChartSeq),a.setAttribute("style",onefficeChart.insertChartImageObj.getAttribute("style")),a.setAttribute("chart_id",onefficeChart.insertChartImageObj.getAttribute("chart_id")),a.setAttribute("chart_data",onefficeChart.insertChartImageObj.getAttribute("chart_data")),!0===dzeUiConfig.bUseReportForm&&(e=onefficeChart.insertChartImageObj.getAttribute("mapping_key"),!1===fnObjectCheckNull(e)&&""!==e?a.setAttribute("mapping_key",
e):a.removeAttribute("mapping_key"));if(!1===fnObjectCheckNull(onefficeChart.insertchartTableObj)){c=null;if(c="undefined"!=typeof a?a:onefficeChart.insertChartImageObj){var k=c.ownerDocument.createRange();k.selectNode(c);k.collapse(!0);SetCurRange(k);g_objInsertUtil.insertTableAtSelection(onefficeChart.insertchartTableObj,b);k.selectNode(c);k.collapse(!1);SetCurRange(k)}"undefined"!==typeof g_objTableOperation&&g_objTableOperation.table_SetTableStyle(onefficeChart.insertchartTableObj,refInfoDB[2]);
"undefined"!==typeof a&&dze_menu_control.setTBImageSizeInfo(b,!0)}else"undefined"!=typeof a&&dze_menu_control.setTBImageSizeInfo(b,!0);onefficeChart.initialize();onefficeChart.removeChartCanvasAll();editor_onselectionchange(b);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();g_objUndoRedo.registerUndoRedoStack(0,b)}}catch(l){onefficeChart.insertMode=!1,dalert(l)}},convChartDataToString:function(){try{return JSON.stringify({data:onefficeChart.chartData,chartType:onefficeChart.chartType,
chartTitle:onefficeChart.chartTitle,chartTitleFontSize:onefficeChart.chartTitleFontSize,chartTitleFontColor:onefficeChart.chartTitleFontColor,chartTitlePadding:onefficeChart.chartTitlePadding,chartTitleLineHeight:onefficeChart.chartTitleLineHeight,chartTitleFont:onefficeChart.chartTitleFont,chartTitleFontStyle:onefficeChart.chartTitleFontStyle,legend_view:onefficeChart.legend_view,legend_position:onefficeChart.legend_position,legend_foreColor:onefficeChart.legend_foreColor,legend_fontsize:onefficeChart.legend_fontsize,
legend_font:onefficeChart.legend_font,data_label_view:onefficeChart.data_label_view,data_label_color:onefficeChart.data_label_color,data_label_padding_x:onefficeChart.data_label_padding_x,data_label_padding_y:onefficeChart.data_label_padding_y,data_label_FontSize:onefficeChart.data_label_FontSize,data_label_font:onefficeChart.data_label_font,data_label_unit:onefficeChart.data_label_unit,data_graph_border:onefficeChart.data_graph_border,chartResizeRepaint:onefficeChart.chartResizeRepaint,colorSet:onefficeChart.colorSet,
colorAlphaSet:onefficeChart.colorAlphaSet,colorBorderSet:onefficeChart.colorBorderSet,colorBorderAlphaSet:onefficeChart.colorBorderAlphaSet,border_style:onefficeChart.data_border_style,line_tension:onefficeChart.lineTension,new_chart_data:onefficeChart.new_chart_data})}catch(b){return dalert(b),""}},convStringToChartData:function(b){try{var a=JSON.parse(b);b=0;void 0!==a.chartType&&(-1<a.chartType.indexOf("line")?(onefficeChart.chartType="line","line2"===a.chartType&&(b=.4)):onefficeChart.chartType=
a.chartType);onefficeChart.chartData=void 0===a.new_chart_data?onefficeChart.reverseRowColTableData(a.data):a.data;void 0!==a.chartTitle&&(onefficeChart.chartTitle=a.chartTitle);void 0!==a.chartTitleFontSize&&(onefficeChart.chartTitleFontSize=a.chartTitleFontSize);void 0!==a.chartTitleFontColor&&(onefficeChart.chartTitleFontColor=a.chartTitleFontColor);void 0!==a.chartTitlePadding&&(onefficeChart.chartTitlePadding=a.chartTitlePadding);void 0!==a.chartTitleLineHeight&&(onefficeChart.chartTitleLineHeight=
a.chartTitleLineHeight);void 0!==a.chartTitleFont&&(onefficeChart.chartTitleFont=a.chartTitleFont);void 0!==a.chartTitleFontStyle&&(onefficeChart.chartTitleFontStyle=a.chartTitleFontStyle);void 0!==a.legend_view&&(onefficeChart.legend_view=a.legend_view);void 0!==a.legend_position&&(onefficeChart.legend_position=a.legend_position);void 0!==a.legend_foreColor&&(onefficeChart.legend_foreColor=a.legend_foreColor);void 0!==a.legend_fontsize&&(onefficeChart.legend_fontsize=a.legend_fontsize);void 0!==
a.legend_font&&(onefficeChart.legend_font=a.legend_font);void 0!==a.data_label_view&&(onefficeChart.data_label_view=a.data_label_view);void 0!==a.data_label_color&&(onefficeChart.data_label_color=a.data_label_color);void 0!==a.data_label_padding_x&&(onefficeChart.data_label_padding_x=a.data_label_padding_x);void 0!==a.data_label_padding_y&&(onefficeChart.data_label_padding_y=a.data_label_padding_y);void 0!==a.data_label_FontSize&&(onefficeChart.data_label_FontSize=a.data_label_FontSize);void 0!==
a.data_label_font&&(onefficeChart.data_label_font=a.data_label_font);void 0!==a.data_label_unit&&(onefficeChart.data_label_unit=a.data_label_unit);!0===Array.isArray(a.data_graph_border)&&(onefficeChart.data_graph_border=a.data_graph_border);void 0!==a.chartResizeRepaint&&(onefficeChart.chartResizeRepaint=a.chartResizeRepaint);void 0!==a.colorSet&&(onefficeChart.colorSet=a.colorSet);void 0!==a.colorAlphaSet&&(onefficeChart.colorAlphaSet=a.colorAlphaSet);void 0!==a.colorBorderSet&&(onefficeChart.colorBorderSet=
a.colorBorderSet);void 0!==a.colorBorderAlphaSet&&(onefficeChart.colorBorderAlphaSet=a.colorBorderAlphaSet);void 0!==a.border_style&&(onefficeChart.data_border_style=a.border_style);onefficeChart.lineTension=void 0!==a.line_tension?a.line_tension:0!==b?b:0;onefficeChart.previewDataTable()}catch(c){dalert(c)}},makeChartContainerFromDataString:function(b,a,c,d){try{this.convStringToChartData(b);if(0==onefficeChart.chartData.length)return null;"undefined"==typeof c&&(c=480);"undefined"==typeof d&&(d=
240);this.makeChartDataSet();this.makeChartOptions(!1);this.loadChartPlugins();this.removeChartCanvasAll();this.currChartSeq=a;b=null;this.currChartSeq&&(b=this.getCanvasObj(this.currChartSeq));if(b){var e=b.parentNode;e.getAttribute("chart_id")==onefficeChart.getChartImageId(this.currChartSeq)&&e.parentNode.removeChild(e)}var f=document.createElement("div");f.setAttribute("chart_id",onefficeChart.getChartImageId(this.currChartSeq));f.style.position="absolute";f.style.top="-10000px";f.style.left=
"-10000px";f.style.zIndex="1";f.style.height=d+"px";f.style.width=c+"px";var g=document.createElement("canvas");g.setAttribute("chart_id",onefficeChart.getChartImageId(this.currChartSeq));f.appendChild(g);document.body.appendChild(f);var h=g.getContext("2d");onefficeChart.previewChart=new Chart(h,this.getConfig());return g}catch(k){return dalert(k),null}},chartTypeClickEvent:function(){try{var b=[];chartTypeBtnSelected=function(a){for(var c=0;c<b.length;c++)c===a?b[c].classList.add("selected"):b[c].classList.remove("selected")};
chartTypeClick=function(a){try{onefficeChart.lineTension=0;switch(a.target.id){case "idx_chart_icon_btn_01":onefficeChart.chartType=onefficeChart.chart_type_list[0][0];chartTypeBtnSelected(0);break;case "idx_chart_icon_btn_02":onefficeChart.chartType=onefficeChart.chart_type_list[1][0];chartTypeBtnSelected(1);break;case "idx_chart_icon_btn_03":onefficeChart.chartType=onefficeChart.chart_type_list[2][0];chartTypeBtnSelected(2);break;case "idx_chart_icon_btn_04":onefficeChart.chartType=onefficeChart.chart_type_list[2][0];
onefficeChart.lineTension=.4;chartTypeBtnSelected(3);break;case "idx_chart_icon_btn_05":onefficeChart.chartType=onefficeChart.chart_type_list[3][0];chartTypeBtnSelected(4);break;case "idx_chart_icon_btn_06":onefficeChart.chartType=onefficeChart.chart_type_list[4][0];chartTypeBtnSelected(5);break;case "idx_chart_icon_btn_07":onefficeChart.chartType=onefficeChart.chart_type_list[5][0];chartTypeBtnSelected(6);break;case "idx_chart_icon_btn_08":onefficeChart.chartType=onefficeChart.chart_type_list[6][0],
chartTypeBtnSelected(7)}onefficeChart.updateOnefficeChart()}catch(e){dalert(e)}};for(var a=1;9>a;a++){var c=$_("idx_chart_icon_btn_0"+a);c&&(c.addEventListener("click",chartTypeClick,!1),b.push(c))}switch(onefficeChart.chartType){case "bar":chartTypeBtnSelected(0);break;case "horizontalBar":chartTypeBtnSelected(1);break;case "line":.4===onefficeChart.lineTension?chartTypeBtnSelected(3):chartTypeBtnSelected(2);break;case "radar":chartTypeBtnSelected(4);break;case "pie":chartTypeBtnSelected(5);break;
case "doughnut":chartTypeBtnSelected(6);break;case "polarArea":chartTypeBtnSelected(7)}}catch(d){dalert(d)}},updateOnefficeChart:function(b){try{if(onefficeChart.previewChart.config.type!=onefficeChart.chartType)onefficeChart.makeChart(onefficeChart.refChartWidth,onefficeChart.refChartHeight);else if("line"==onefficeChart.previewChart.config.type&&"line"==onefficeChart.chartType&&onefficeChart.previewChart.data.datasets&&onefficeChart.previewChart.data.datasets[0]&&onefficeChart.previewChart.data.datasets[0].lineTension!=
onefficeChart.lineTension)onefficeChart.makeChart(onefficeChart.refChartWidth,onefficeChart.refChartHeight);else{onefficeChart.makeChartDataSet();onefficeChart.makeChartOptions(!1);onefficeChart.previewChart.type=onefficeChart.chartType;onefficeChart.previewChart.data.labels=onefficeChart.makeLabels;onefficeChart.previewChart.data.datasets=onefficeChart.makeDatasets;onefficeChart.previewChart.data.borderWidth=onefficeChart.data_graph_border;onefficeChart.previewChart.options=onefficeChart.makeOptions;
onefficeChart.previewChart.update();dze_menu_control.currControlObject&&(dze_menu_control.currControlObject.src=onefficeChart.getChartImageSrc(this.currChartSeq));var a=this.convChartDataToString();dze_menu_control.currControlObject&&dze_menu_control.currControlObject.setAttribute("chart_data",a);"boolean"===typeof b&&!0===b&&g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}}catch(c){dalert(c)}},initialize:function(b){try{onefficeChart.insertChartImageObj=null;onefficeChart.insertchartTableObj=
null;onefficeChart.insertMode=!1;onefficeChart.currChartSeq=0;onefficeChart.chartImageSrc="";onefficeChart.chartData=[];Chart.defaults.global.defaultFontColor="#000000";Chart.defaults.global.defaultFontFamily=onefficeChart.defaultFontFamily;Chart.defaults.global.defaultFontSize=12;Chart.defaults.global.defaultFontStyle="normal";onefficeChart.chartType="bar";onefficeChart.legend_view=!0;onefficeChart.data_label_view=!1;onefficeChart.data_label_color="#000000";onefficeChart.data_label_padding_x=0;onefficeChart.data_label_padding_y=
5;onefficeChart.data_label_unit=void 0;onefficeChart.legend_position="bottom";onefficeChart.afterRenderFunction=null;onefficeChart.afterDrawFunction=null;onefficeChart.chartTitle="";onefficeChart.chartTitleFontSize=14;onefficeChart.chartTitleFontColor="#000000";onefficeChart.chartTitlePadding=20;onefficeChart.chartTitleLineHeight=1.2;onefficeChart.chartTitleFont=onefficeChart.defaultFontFamily;onefficeChart.chartTitleFontStyle="bold";onefficeChart.chartResizeRepaint=!0;for(var a=0;a<onefficeChart.defaultColorSet.length;a++)onefficeChart.colorBorderSet[a]=
onefficeChart.colorSet[a]=onefficeChart.defaultColorSet[a],0==a?(onefficeChart.colorBorderAlphaSet[a]=0,onefficeChart.colorAlphaSet[a]=0,onefficeChart.data_graph_border[a]=0):(onefficeChart.colorBorderAlphaSet[a]=1,onefficeChart.colorAlphaSet[a]=1,onefficeChart.data_graph_border[a]=1,onefficeChart.data_border_style[a]="solid");if(!0===dzeUiConfig.bUseReportForm&&!1===fnObjectCheckNull(b)){var c=b.getAttribute("mapping_key"),d=$_("dze_idx_chart_from_external"),e=$_("dze_idx_chart_mapping_key");!1===
fnObjectCheckNull(c)&&""!==c?(d.checked=!0,e.value=c):(d.checked=!1,e.setAttribute("disabled",""),e.style.poinerEvents="none",e.parentNode.style.opacity="0.5")}}catch(f){dalert(f)}},previewDataTable:function(){var b=(oneffice.isLoadEditor()?g_objLayerKit.getLayerDocument():document).createElement("div");b.className="oneffice_chart_table";b.id="onefficeChartTableDiv";for(var a=this.chartData.length,c=this.chartData[0].length,d=[],e,f,g=-1;g<a;g++){e=[];for(var h=-1;h<c;h++)-1==g?-1==h?f="":(f=h+1,
1===f&&(f=ID_RES_CONST_LEGEND)):-1==h?(f=toColumnName(g+1),f="A"===f?ID_RES_STRING_CHART_ITEM:toColumnName(g)):"undefined"!=typeof this.chartData[g]&&"undefined"!=typeof this.chartData[g][h]?(f=this.chartData[g][h],0==g&&0==h&&(f="")):f="",e.push(f);d.push(e)}a=document.createElement("table");a.setAttribute("cellspacing","0");a.setAttribute("cellpadding","0");a.setAttribute("style","border-collapse:collapse;");a.className="dze_table";for(g=0;g<d.length;g++)for(c=a.insertRow(),h=0;h<d[g].length;h++)e=
c.insertCell(h),this.makeDataSourceCell(d[g][h],e,g,h);b.appendChild(a);return b},selectCellMode:!1,selectEntire:function(b,a,c){var d=$_("onefficeChartTableDiv").firstChild;if(d&&("col"==b||"row"==b||"all"==b))for(var e=d.rows.length,f=d.rows[0].cells.length,g=1;g<e;g++)for(var h=1;h<f;h++)"col"==b?h==a&&this.selectCell(d.rows[g].cells[h],c):"row"==b?g==a&&this.selectCell(d.rows[g].cells[h],c):"all"==b&&0<g&&0<h&&this.selectCell(d.rows[g].cells[h],c)},unselectAll:function(){var b=$_("onefficeChartTableDiv").firstChild;
if(b)for(var a=b.rows.length,c=b.rows[0].cells.length,d=1;d<a;d++)for(var e=1;e<c;e++)this.unselectCell(b.rows[d].cells[e])},selectCell:function(b,a){a==MOUSE_BTN.L&&b.getAttribute("bSelect")?this.unselectCell(b):(b.style.backgroundColor="#e9e9e9",b.setAttribute("bSelect","1"))},unselectCell:function(b){b.style.backgroundColor="transparent";b.getAttribute("bSelect")&&b.removeAttribute("bSelect")},goNextTableCell:function(b,a){try{if(a){if(0==a.firstChild.childNodes.length){var c=document.createTextNode("");
a.firstChild.appendChild(c)}var d=a.firstChild.innerText;/^[0-9,\.]+$/.test(d)&&(d=d.setComma());a.firstChild.innerText=d;var e=g_objNodeUtil.getLoopParentElement(a,"table"),f=g_objNodeUtil.getLoopParentElement(a,"tr"),g=e.rows.length,h=e.rows[0].cells.length,k=f.rowIndex,l=a.cellIndex;d=0;f=k-1;var n=l+1,p=l-1,m=null;if(b.keyCode==ID_KEYCODE_ENTER||b.keyCode==ID_KEYCODE_ARROW_BOTTOM)d=k+1,d>g-1&&(d=k),m=e.rows[d].cells[l];else if(b.keyCode!=ID_KEYCODE_TAB&&b.keyCode!=ID_KEYCODE_ARROW_RIGHT||b.altKey||
b.ctrlKey||b.shiftKey||b.metaKey)if((b.keyCode!=ID_KEYCODE_TAB||b.altKey||b.ctrlKey||!b.shiftKey||b.metaKey)&&(b.keyCode!=ID_KEYCODE_ARROW_LEFT||b.altKey||b.ctrlKey||b.shiftKey||b.metaKey))if(b.keyCode==ID_KEYCODE_ARROW_TOP)f=k-1,1>f&&(f=k),m=e.rows[f].cells[l];else if(b.keyCode==ID_KEYCODE_HOME)m=DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)?e.rows[1].cells[1]:e.rows[k].cells[1];else if(b.keyCode==ID_KEYCODE_END)m=DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)?e.rows[g-1].cells[h-1]:e.rows[k].cells[h-
1];else if(b.keyCode==ID_KEYCODE_PAGE_UP)m=e.rows[1].cells[l];else if(b.keyCode==ID_KEYCODE_PAGE_DOWN)m=e.rows[g-1].cells[l];else return;else p=l-1,1>p&&(p=l),m=e.rows[k].cells[p];else n=l+1,n>h-1?(d=k,n=l):d=k,m=e.rows[d].cells[n];a!=m&&(0==m.firstChild.childNodes.length&&(c=document.createTextNode(""),m.firstChild.appendChild(c)),this.focusCell(m))}}catch(q){dalert(q)}},selectCellContent:function(b){try{var a=window.getSelection(),c=document.createRange();c.selectNodeContents(b.firstChild.firstChild);
a.removeAllRanges();a.addRange(c)}catch(d){dalert(d)}},focusCell:function(b){this.selectCellContent(b);var a=$_("onefficeChartTableDiv").offsetWidth,c=$_("onefficeChartTableDiv").offsetHeight,d=b.offsetLeft+10+b.offsetWidth;b=b.offsetTop+10+b.offsetHeight;$_("onefficeChartTableDiv");a=d>a?d-a:0;$_("onefficeChartTableDiv").scrollLeft=a;b>c?$_("onefficeChartTableDiv").scrollTop=b-c:$_("onefficeChartTableDiv").scrollTop=0},setChartDataFromDataSheet:function(){try{var b=$_("onefficeChartTableDiv").firstChild;
if(b){this.chartData=[];for(var a=[],c=[],d=b.rows.length,e=b.rows[0].cells.length,f=null,g=1;g<d;g++){c=[];for(var h=1;h<e;h++){f=b.rows[g].cells[h];var k=f.innerText;k=k.removeComma().trim();k=k.replace(/\u200B/g,"");c.push(k)}0<c.length&&a.push(c)}this.chartData=a}}catch(l){dalert(l)}},setMouseClickPosition:function(b,a){try{var c={scrollX:0,scrollY:0,mousedownX:0,mousedownY:0};"undefined"!=typeof b&&null!=b&&(document.documentElement.scrollLeft?(c.scrollX=document.documentElement.scrollLeft,c.mousedownX=
document.documentElement.scrollLeft+b.clientX):(c.scrollX=document.body.scrollLeft,c.mousedownX=document.body.scrollLeft+b.clientX),document.documentElement.scrollTop?(c.scrollY=document.documentElement.scrollTop,c.mousedownY=document.documentElement.scrollTop+b.clientY):(c.scrollY=document.body.scrollTop,c.mousedownY=document.body.scrollTop+b.clientY));if(a){var d=g_objPositionUtil.getElementPosition(a,!1);c.mousedownX-=d.left;c.mousedownY-=d.top}return c}catch(e){dalert(e)}},contextMenuList:["insert_prev",
"insert_next","delete"],showDataContextMenu:function(b,a){try{var c=$_("idx_onefficeChartTableDiv");if(c){this.hideDataContextMenu(c);var d=this.setMouseClickPosition(a,c),e=document.createElement("div");e.id="dze_idx_data_context_container";e.className="dze_oneffice_chart_table_context_container";e.style.left=d.mousedownX+"px";e.style.top=d.mousedownY+"px";for(var f=null,g=0;g<this.contextMenuList.length;g++)(function(){var a=onefficeChart.contextMenuList[g];f=document.createElement("div");f.className=
"dze_oneffice_chart_table_context_unit";var c="",d="";"col"==b?"insert_prev"==a?(c=ID_RES_CONST_STRING_TABLE_ADD_COL,d="toolbar_btn_table_add_col_left.png"):"insert_next"==a?(c=ID_RES_CONST_STRING_TABLE_ADD_COL_RIGHT,d="toolbar_btn_table_add_col_right.png"):"delete"==a&&(c=ID_RES_CONST_STRING_TABLE_DELETE_COL,d="toolbar_btn_table_delete_col.png"):"row"==b&&("insert_prev"==a?(c=ID_RES_CONST_STRING_TABLE_ADD_ROW,d="toolbar_btn_table_add_row_up.png"):"insert_next"==a?(c=ID_RES_CONST_STRING_TABLE_ADD_ROW_DOWN,
d="toolbar_btn_table_add_row_down.png"):"delete"==a&&(c=ID_RES_CONST_STRING_TABLE_DELETE_ROW,d="toolbar_btn_table_delete_row.png"));d=dzeEnvConfig.strPath_Image+"toolbar/"+d;var e=document.createElement("table");e.setAttribute("width","100%");e.setAttribute("cellspacing","0");e.setAttribute("cellpadding","0");var p=e.insertRow(0),m=p.insertCell(0);m.setAttribute("width","10");m.setAttribute("height","24");m=p.insertCell(1);m.setAttribute("width","16");var q=document.createElement("img");q.src=d;m.appendChild(q);
m=p.insertCell(2);m.setAttribute("width","6");m=p.insertCell(3);m.innerHTML=c;f.appendChild(e);f.onclick=function(){onefficeChart.exeContextMenu(b,a);onefficeChart.hideDataContextMenu()}})(),e.appendChild(f);c.appendChild(e)}else dlog("ChartDataDlg No Found")}catch(h){dalert(h)}},hideDataContextMenu:function(b){try{var a=$_("dze_idx_data_context_container");if(!b&&(b=$_("idx_onefficeChartTableDiv"),!b))return;a&&b.removeChild(a)}catch(c){dalert(c)}},exeContextMenu:function(b,a){try{var c=$_("onefficeChartTableDiv").firstChild;
if(c)if("copy"==a){var d=document.createElement("table");d.setAttribute("selectType",b);a=b=null;for(var e=c.rows.length,f=c.rows[0].cells.length,g=null,h="",k=0,l=0,n=1;n<e;n++){b=d.insertRow(k);k++;l=0;for(var p=1;p<f;p++)g=c.rows[n].cells[p],g.getAttribute("bSelect")&&(h=g.innerText,h=h.removeComma().trim(),h=h.replace(/\u200B/g,""),a=b.insertCell(l),a.innerText=h,l++);0==l&&(k--,d.deleteRow(k))}}else"insert_prev"==a?(g=this.getSelectedNo(b),h=g.length,this.insertRowCell(c,b,g[0],h)):"insert_next"==
a?(g=this.getSelectedNo(b),h=g.length,this.insertRowCell(c,b,g.pop()+1,h)):"delete"==a?(g=this.getSelectedNo(b),this.deleteRowCell(c,b,g)):"insert_clipboard"==a&&this.getSelectedNo(b)}catch(m){dalert(m)}},getSelectedNo:function(b){try{for(var a=$_("onefficeChartTableDiv").firstChild,c=a.rows.length,d=a.rows[0].cells.length,e=null,f=[],g=1;g<c;g++){for(var h=1;h<d&&(e=a.rows[g].cells[h],!e.getAttribute("bSelect")||("row"==b?f.push(g):"col"==b&&f.push(h),"row"!=b));h++);if("col"==b)break}return f}catch(k){dalert(k)}},
updateRowNumber:function(b){rowCnt=b.rows.length;for(var a=1;a<rowCnt;a++)b.rows[a].cells[0].firstChild.innerText=a},updateColNumber:function(b){cellCnt=b.rows[0].cells.length;for(var a=1;a<cellCnt;a++)b.rows[0].cells[a].firstChild.innerText=toColumnName(a)},insertRowCell:function(b,a,c,d){try{var e=b.rows.length,f=b.rows[0].cells.length,g=null,h=null,k=null;if("col"==a){for(var l=0;l<e;l++)for(var n=0;n<d;n++)h=b.rows[l].insertCell(c),this.makeDataSourceCell("",h,l,c);this.updateColNumber(b);k=b.rows[1].cells[c]}else if("row"==
a){for(n=0;n<d;n++)for(g=b.insertRow(c),a=0;a<f;a++)h=g.insertCell(a),this.makeDataSourceCell("",h,c,a);this.updateRowNumber(b);k=b.rows[c].cells[1]}var p=b.rows[0].childElementCount-this.colorSet.length;if(0<p)for(l=0;l<p;l++){var m=this.defaultColorSet[(l+1)%15];this.colorSet.splice(c-1,0,m);this.colorAlphaSet.splice(c-1,0,.6);this.colorBorderSet.splice(c-1,0,m);this.colorBorderAlphaSet.splice(c-1,0,1);this.data_graph_border.splice(c-1,0,1);this.data_border_style.splice(c-1,0,"solid")}this.focusCell(k);
onefficeChart.setChartDataFromDataSheet();b=!1;document.getElementById("idx_onefficeChartPreview")||(b=!0);onefficeChart.updateOnefficeChart(b);onefficeChart.unselectAll()}catch(q){dalert(q)}},deleteRowCell:function(b,a,c){try{var d=b.rows.length,e=c.length;if(!(1>e)){if("row"==a){for(var f=e-1;0<=f;f--)b.deleteRow(c[f]);this.updateRowNumber(b)}else if("col"==a){for(f=d-1;0<=f;f--)for(a=e-1;0<=a;a--)b.rows[f].deleteCell(c[a]);this.updateColNumber(b)}onefficeChart.setChartDataFromDataSheet();onefficeChart.updateOnefficeChart();
onefficeChart.unselectAll()}}catch(g){dalert(g)}},makeDataSourceCell:function(b,a,c,d){try{a.style.borderWidth="1px";a.style.borderStyle="solid";a.style.borderColor="#b2b2b2";a.style.padding="2px";0==c||0==d?(a.style.backgroundColor="#c9c9c9",a.style.fontSize="10px",a.style.color="#000000",a.style.textAlign="center"):a.style.textAlign=1==c||1==d?"center":"right";0==c&&0==d&&(a.className="backslash",a.style.backgroundColor="#f9f9f9");0==d?(a.setAttribute("width",30),a.style.minWidth="30px"):(a.setAttribute("width",
56),a.style.minWidth="52px");0==c&&0==d&&(b="");""!=b&&/^[0-9,\.]+$/.test(b)&&(b=b.setComma());var e=document.createTextNode(b),f=document.createElement("div");f.className="oneffice_chart_table_input_div";if(0<c&&0<d)f.setAttribute("contenteditable","true"),this.makeEditableNodeEvent(f);else if(f.style.cursor="default",0!=c||0!=d)0==c&&1<d?(f.onclick=function(a){onefficeChart.selectEntire("col",this.parentNode.cellIndex,a.button);onefficeChart.hideDataContextMenu();TBCancelBubbleEvent(a)},f.oncontextmenu=
function(a){onefficeChart.selectEntire("col",this.parentNode.cellIndex,a.button);onefficeChart.showDataContextMenu("col",a);TBCancelBubbleEvent(a)}):1<c&&0==d&&(f.onclick=function(a){onefficeChart.selectEntire("row",this.parentNode.parentNode.rowIndex,a.button);onefficeChart.hideDataContextMenu();TBCancelBubbleEvent(a)},f.oncontextmenu=function(a){onefficeChart.selectEntire("row",this.parentNode.parentNode.rowIndex,a.button);onefficeChart.showDataContextMenu("row",a);TBCancelBubbleEvent(a)});f.appendChild(e);
a.appendChild(f)}catch(g){dalert(g)}},makeEditableNodeEvent:function(b){try{b.onkeydown=function(a){if(a.keyCode==ID_KEYCODE_ENTER||a.keyCode==ID_KEYCODE_ARROW_TOP||a.keyCode==ID_KEYCODE_ARROW_RIGHT||a.keyCode==ID_KEYCODE_ARROW_BOTTOM||a.keyCode==ID_KEYCODE_ARROW_LEFT||a.keyCode==ID_KEYCODE_TAB||a.keyCode==ID_KEYCODE_HOME||a.keyCode==ID_KEYCODE_END||a.keyCode==ID_KEYCODE_PAGE_UP||a.keyCode==ID_KEYCODE_PAGE_DOWN){if(0<this.childNodes.length){if(1<this.childNodes.length||this.childNodes[0].nodeType!=
ID_SELECTION_TEXT_NODE){var b=this.textContent.trim();b=document.createTextNode(b);for(var d=0;0<this.childNodes.length;){d++;if(10<d)break;this.removeChild(this.childNodes[0])}this.appendChild(b)}}else b=document.createTextNode(""),this.appendChild(b);b=g_objNodeUtil.getLoopParentElement(this,"td");null!=b&&(onefficeChart.goNextTableCell(a,b),onefficeChart.unselectAll(),onefficeChart.hideDataContextMenu(),onefficeChart.setChartDataFromDataSheet(),onefficeChart.updateOnefficeChart(),TBCancelBubbleEvent(a))}},
b.onfocus=function(a){0==this.childNodes.length&&(a=document.createTextNode(""),this.appendChild(a));onefficeChart.selectCellContent(this.parentNode)},b.onblur=function(a){0<this.childNodes.length&&(a=!1,document.getElementById("idx_onefficeChartPreview")||(a=!0),onefficeChart.setChartDataFromDataSheet(),onefficeChart.updateOnefficeChart(a))},b.onmousedown=function(a){MOUSE_BTN.L==a.button&&(onefficeChart.unselectAll(),onefficeChart.hideDataContextMenu())},b.onmouseup=function(a){onefficeChart.unselectAll();
onefficeChart.hideDataContextMenu()},b.onpaste=function(a){b.style.position="absolute";b.style.left="-10000px";b.style.top="-10000px";b.style.opacity=0;duzon_http.showLoading();setTimeout(function(){if(!0!==onefficeChart.insertPasteDataTable(b,a)){b.removeAttribute("style");var c=b.innerText.trim();c=c.removeComma();c=c.replace(/\u200B/g,"");b.innerHTML="";c=document.createTextNode(c);b.appendChild(c)}duzon_http.hideLoading()},100)}}catch(a){dalert(a)}},insertPasteDataTable:function(b,a){try{var c=
b.getElementsByTagName("table");if(0==c.length)return!1;b.style.width="500px";b.style.height="500px";b.style.overflow="auto";b.style.position="absolute";b.style.top=0;b.style.left=0;b.style.opacity=0;var d=c[0];this.chartData=[];b=[];a=[];for(var e=d.rows.length,f=c=0;f<e;f++){a=[];c=d.rows[f].cells.length;for(var g=0;g<c;g++){var h=d.rows[f].cells[g];if("undefined"==typeof h)a.push("");else{var k=h.innerText;k=k.removeComma().trim();k=k.replace(/\u200B/g,"");for(var l=0;l<h.colSpan;l++)a.push(k)}}0<
a.length&&b.push(a)}if(0==b.length)return!1;this.chartData=b;var n=this.previewDataTable(),p=$_("idx_onefficeChartTableDiv");for(d=0;d<p.childNodes.length;d++)if("onefficeChartTableDiv"==p.childNodes[d].id){p.removeChild(p.childNodes[d]);p.appendChild(n);break}$_("onefficeChartTableDiv").scrollLeft=0;$_("onefficeChartTableDiv").scrollTop=0;this.focusCell(n.firstChild.rows[1].cells[1]);onefficeChart.updateOnefficeChart();return!0}catch(m){dalert(m)}},deleteDataContent:function(){try{if(null!=$_("onefficeChartTableDiv")){var b=
$_("onefficeChartTableDiv").firstChild;if(b){for(var a=b.rows.length,c=b.rows[0].cells.length,d=null,e=1;e<a;e++)for(var f=1;f<c;f++)if(d=b.rows[e].cells[f],d.getAttribute("bSelect")){var g=document.createTextNode("");d.firstChild.innerHTML="";d.firstChild.appendChild(g)}onefficeChart.unselectAll();onefficeChart.setChartDataFromDataSheet();onefficeChart.updateOnefficeChart()}}}catch(h){dalert(h)}},addChartDialogEvent:function(){document.addEventListener("keydown",onefficeChart.chartDialogKeydownEvent,
!1);!0===dzeUiConfig.bUseReportForm&&!1===fnObjectCheckNull($_("dze_idx_chart_from_external"))&&($_("dze_idx_chart_from_external").onchange=function(){try{var b=$_("dze_idx_chart_mapping_key");!0===this.checked?(b.removeAttribute("disabled"),b.style.pointerEvents="",b.parentNode.style.opacity="",b.focus()):(b.value="",b.setAttribute("disabled",""),b.style.pointerEvents="none",b.parentNode.style.opacity="0.5")}catch(a){dalert(a)}})},removeChartDialogEvent:function(){document.removeEventListener("keydown",
onefficeChart.chartDialogKeydownEvent,!1)},chartDialogKeydownEvent:function(b){b.keyCode!=ID_KEYCODE_DELETE&&b.keyCode!=ID_KEYCODE_BACKSPACE||onefficeChart.deleteDataContent()},removeChartCanvasAll:function(){for(var b=document.getElementsByTagName("canvas"),a=0;a<b.length;a++){var c=b[a];c.hasAttribute("chart_id")&&c.parentElement.parentElement.removeChild(c.parentElement)}},makeCanvasChartToImage:function(b,a,c){var d=b.getAttribute("chart_id");if(d){var e=b.offsetWidth,f=b.offsetHeight,g=g_objPropertyUtil.getElementStyleAttributeValue(b,
"border-left-width",a).replace(/px/,"").trim(),h=g_objPropertyUtil.getElementStyleAttributeValue(b,"border-right-width",a).replace(/px/,"").trim(),k=g_objPropertyUtil.getElementStyleAttributeValue(b,"border-top-width",a).replace(/px/,"").trim();a=g_objPropertyUtil.getElementStyleAttributeValue(b,"border-bottom-width",a).replace(/px/,"").trim();var l=/[^0-9]/;l.test(g)&&(g=0);l.test(h)&&(h=0);l.test(k)&&(k=0);l.test(a)&&(a=0);e=e-parseInt(g,10)-parseInt(h,10);f=f-parseInt(k,10)-parseInt(a,10);d=d.replace(/chart_/,
"");g=b.getAttribute("chart_data");if(null==g||""==g)return dlog("no chart data"),!1;onefficeChart.initialize();e=onefficeChart.makeChartContainerFromDataString(g,d,e,f);if(null==e)return dlog("make fail canvas"),!1;!0===c&&(b.src=onefficeChart.getChartImageSrc(d),b.style.width=e.style.width,b.style.height=e.style.height);return!0}return!1},chartDataDialogContainer:function(b){var a=document.createElement("div");a.className="duzon_dialog";a.id="idx_onefficeChartTableDiv";a.style.top="0";a.style.left=
"0";a.style.display="block";""!=b&&(b=cmnDlg.createTitle(b===ID_RES_CONST_STRING_MODIFY_CHART_DATA?ID_RES_CONST_STRING_MODIFY_CHART_DATA:ID_RES_CONST_STRING_CHART_DATA_TITLE,1),a.appendChild(b));b=onefficeChart.previewDataTable();a.appendChild(b);dzeJ(a).draggable({distance:15,handle:"div.duzon_dialog_title_container",containment:"parent",start:function(a,b){dzeJ(this).css("opacity",.5)},stop:function(a,b){dzeJ(this).css("opacity","")}}).css("position","");return a},makeDocTableObjectFromDataTable:function(){try{var b=
$_("onefficeChartTableDiv").firstChild;if(!b)return null;var a=document.createElement("div");a.innerHTML=b.outerHTML;var c=a.firstChild;c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","3");b=null;a="";var d=null,e=null;c.deleteRow(0);for(var f=c.rows.length,g=0,h=0;h<f;h++){c.rows[h].deleteCell(0);g=c.rows[h].cells.length;for(var k=0;k<g;k++)b=c.rows[h].cells[k],b.getAttribute("bSelect")&&b.removeAttribute("bSelect"),b.getAttribute("style")&&b.removeAttribute("style"),b.style.border=
"1px solid #000000",0==h||0==k?b.setAttribute("align","center"):b.setAttribute("align","right"),a=b.innerText,d=document.createTextNode(a),e=document.createElement("p"),e.appendChild(d),""==e.innerHTML&&(e.innerHTML="<br />"),b.innerHTML="",b.appendChild(e)}return c}catch(l){dalert(l)}},canvasToImage:function(b,a){var c=b.width,d=b.height,e=b.getContext("2d");if(a){var f=e.getImageData(0,0,c,d);var g=e.globalCompositeOperation;e.globalCompositeOperation="destination-over";e.fillStyle=a;e.fillRect(0,
0,c,d)}b=b.toDataURL("image/png");a&&(e.clearRect(0,0,c,d),e.putImageData(f,0,0),e.globalCompositeOperation=g);return b}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var f=c++;return{value:b(f,a[f]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];f in c||(c[f]={});c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof f?a:new f(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var b=this;this.asyncExecuteFunction(function(){b.executeBatch_()})}this.batch_.push(a)};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];a[b]=null;try{c()}catch(l){this.asyncThrow_(l)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var f=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(m){b.reject(m)}};f.prototype.createResolveAndReject_=function(){function a(a){return function(f){c||(c=!0,a.call(b,f))}}var b=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};f.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof f)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};f.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(m){this.reject_(m);return}"function"==typeof b?
this.settleSameAsThenable_(b,a):this.fulfill_(a)};f.prototype.reject_=function(a){this.settle_(2,a)};f.prototype.fulfill_=function(a){this.settle_(1,a)};f.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)g.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var g=new b;f.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};f.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(l){c.reject(l)}};f.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(t){h(t)}}:b}var d,h,g=new f(function(a,b){d=a;h=b});this.callWhenSettled_(c(a,d),c(b,h));return g};
f.prototype.catch=function(a){return this.then(void 0,a)};f.prototype.callWhenSettled_=function(a,b){function c(){switch(f.state_){case 1:a(f.result_);break;case 2:b(f.result_);break;default:throw Error("Unexpected state: "+f.state_);}}var f=this;null==this.onSettledCallbacks_?g.asyncExecute(c):this.onSettledCallbacks_.push(c)};f.resolve=c;f.reject=function(a){return new f(function(b,c){c(a)})};f.race=function(a){return new f(function(b,f){for(var d=$jscomp.makeIterator(a),g=d.next();!g.done;g=d.next())c(g.value).callWhenSettled_(b,
f)})};f.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new f(function(a,f){function g(b){return function(c){h[b]=c;k--;0==k&&a(h)}}var h=[],k=0;do h.push(void 0),k++,c(d.value).callWhenSettled_(g(h.length-1),f),d=b.next();while(!d.done)})};return f},"es6","es3");
var commonUtil=function(){this.dpiValue=this.dpiDiv=null;commonUtil.prototype.contains=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return!0;return!1};commonUtil.prototype.displayErrorAlert=function(a,b){try{dzeEnvConfig.bDebugging&&alert(b+" :: "+a)}catch(c){}};commonUtil.prototype.log=function(a){try{dzeEnvConfig.bDebugging&&"undefined"!==typeof console&&console.log(a)}catch(b){}};commonUtil.prototype.dir=function(a){try{dzeEnvConfig.bDebugging&&"undefined"!==typeof console&&console.dir(a)}catch(b){}};
commonUtil.prototype.afterFocusSetting_FF=function(a){try{g_objEditorDocument[a].body.focus()}catch(b){dalert(b)}};commonUtil.prototype.openWindowCommon=function(a,b,c,d,f){try{var g,h=(screen.width-b)/2,k=(screen.height-c)/2;(g=window.open(a,f,d?"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width="+b+",height="+c+",top="+k+",left="+h:"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=yes,width="+b+",height="+c+",top="+k+
",left="+h))&&4<=parseInt(navigator.appVersion)&&g.window.focus()}catch(m){dalert(m)}};commonUtil.prototype.getTimeCodeString=function(){try{return(new Date).getTime()}catch(a){dalert(a)}};commonUtil.prototype.getUniqueID=function(){try{return Math.random().toString(36).substr(2,9)}catch(a){dalert(a)}};commonUtil.prototype.checkIsHexColorCode=function(a){try{if(null==a||""==a)return!1;if("#"==a[0])return!0}catch(b){dalert(b)}return!1};commonUtil.prototype.checkIsRGBColorCode=function(a){try{if(null==
a||""==a)return!1;if("rgb"==a.substr(0,3).toLowerCase())return!0}catch(b){dalert(b)}return!1};commonUtil.prototype.convert_RGB_To_Hex=function(a){try{var b=a.replace(/\s/g,"").match(/^rgba?\((\d+),(\d+),(\d+),?([^,\s)]+)?/i),c=(b&&b[4]||"").trim(),d=b?(b[1]|256).toString(16).slice(1)+(b[2]|256).toString(16).slice(1)+(b[3]|256).toString(16).slice(1):a;if(""!==c){var f=c;f=Math.round(100*f)/100;c=Math.round(255*f);var g=(c+65536).toString(16).substr(-2).toUpperCase();d+=g}return"#"+d}catch(h){dalert(h)}return null};
commonUtil.prototype.getHexColorCode=function(a){try{return this.checkIsRGBColorCode(a)&&(a=this.convert_RGB_To_Hex(a)),a}catch(b){dalert(b)}return""};commonUtil.prototype.getHexColorCodeByNickName=function(a){try{var b=a.toLowerCase();return"black"==b?"#000000":"red"==b?"#ff0000":"windowtext"==b?"#000000":a}catch(c){dalert(c)}return a};commonUtil.prototype.extractNumberValueUnit=function(a,b){try{if(null==a||""==a)return null;if("number"===typeof a)return{nValue:a,strUnit:""};for(var c=!0,d="",f=
"",g=0;g<a.length;g++){var h=a.charAt(g);g_objCodeLexer.isWhite(h)||(c?g_objCodeLexer.isDigit(h)?d+=h:"."==h?d+=h:"-"==h?d+=h:(c=!1,f+=h):f+=h)}f=f.toLowerCase();!0!==b&&"px"==f&&(f="");return{nValue:d,strUnit:f}}catch(k){dalert(k)}return null};commonUtil.prototype.getNumberValue=function(a){try{return/^[0-9\-]+$/.test(a)?parseInt(a):null}catch(b){dalert(b)}return null};commonUtil.prototype.toPx=function(a,b,c){try{var d=0,f=this.extractNumberValueUnit(a);f&&(d=this.convToPx(f.nValue,f.strUnit,b,
c));return d}catch(g){dalert(g)}};commonUtil.prototype.convToPx=function(a,b,c,d){try{switch(b){case "pt":a=this.convPtToPx(a,d);break;case "mm":a=this.convMMToPx(a);break;case "%":c?a=this.convPercentToPx(c,.01*a):dalert(e)}return parseFloat(a)}catch(f){dalert(f)}};commonUtil.prototype.mappingFrom_Pt_To_Px=function(a){try{if(0==a)return 0;if(20>=g_nAdjustFromPtToPxRatio)return null;var b=parseInt(100*a/g_nAdjustFromPtToPxRatio);return 0==b?1:b}catch(c){dalert(c)}return null};commonUtil.prototype.convPxToPt=
function(a){""==a&&(a=0);a=a.replace(/px/gi,"");if(!/^[0-9\.\-]+$/.test(a))return-1;a=parseInt(a,10);return Math.round(.75*a)};commonUtil.prototype.convPtToPx=function(a,b){""==a&&(a=0);if("string"==typeof a&&(a=a.replace(/pt/gi,""),!/^[0-9\.\-]+$/.test(a)))return-1;a=parseInt(a,10);return!0===b?a/.75:Math.round(a/.75)};commonUtil.prototype.convMMToPx=function(a){a=parseFloat(a);return a*this.getDPI()/25.4};commonUtil.prototype.convPxToMM=function(a){a=parseFloat(a);return 25.4*a/this.getDPI()};commonUtil.prototype.CMToPx=
function(a){return this.convMMToPx(10*parseFloat(a))};commonUtil.prototype.PxToCM=function(a){return this.convPxToMM(a)/10};commonUtil.prototype.getDPI=function(){try{if(null!==this.dpiValue)return this.dpiValue;this.dpiDiv=this.dpiDiv||document.getElementById("dpi");this.dpiDiv||(this.dpiDiv=g_objInsertUtil.insertLayerHTML('<div id="dpi" style="width: 1in; height: 1in; left: -100%; top: -100%; position: absolute;"></div>',!1));return this.dpiDiv?this.dpiValue=this.dpiDiv.offsetHeight:1}catch(a){dalert(a)}};
commonUtil.prototype.unloadDPI=function(){try{var a=this.dpiDiv||document.getElementById("dpi");a&&a.parentNode&&a.parentNode.removeChild(a);this.dpiDiv=null}catch(b){dalert(b)}};commonUtil.prototype.convPercentToPx=function(a,b){return a&&a.parentNode?(a=g_objNodeUtil.getClosetBound(a,function(a){return a&&g_objNodeUtil.isListItem(a)?!0:!1}))?g_objPositionUtil.getInnerWidth(a)*parseFloat(b):b:b};commonUtil.prototype.convPxToPercent=function(a,b){try{if(!a||!a.parentNode)return b;var c=g_objNodeUtil.getClosetBound(a,
function(a){return a&&g_objNodeUtil.isListItem(a)?!0:!1});if(!c)return b;var d=g_objPositionUtil.getInnerWidth(c);return parseFloat(b)/d}catch(f){dalert(f)}};commonUtil.prototype.getToDateStr=function(a){try{fnObjectCheckNull(a)&&(a={separator:"",numlentwo:!0,fullyear:!0});var b=new Date,c=b.getDate(),d=b.getMonth()+1,f=b.getFullYear(),g=fnObjectCheckNull(a.separator)?"":a.separator,h=fnObjectCheckNull(a.numlentwo)?!0:a.numlentwo,k=fnObjectCheckNull(a.fullyear)?!0:a.fullyear;h&&(10>c&&(c="0"+c),10>
d&&(d="0"+d));k||(f=String(f).substring(2,4))}catch(m){b=new Date,c=b.getDate(),d=b.getMonth()+1,f=b.getFullYear()}finally{return f+g+d+g+c}};commonUtil.prototype.pxToNumber=function(a){if(a)try{return parseInt((""+a).replace(/px/,""),10)}catch(b){return 0}else return 0};commonUtil.prototype.searchHLText=function(a,b){if(!a||0>=a.length||!b||0>=b.length)return b;for(var c="",d=a.length,f=0,g,h=0;-1<f;)if(f=b.indexOf(a,h),-1<f)g=f+d,c+=b.substring(h,f),c+='<span class="onefficeSearchTxt">'+b.substring(f,
g)+"</span>",h=g;else break;h<b.length&&(c+=b.substring(h));return c};this.IS_VALID_VALUE=function(a){try{return fnObjectCheckNull(a)||"object"==typeof a||"boolean"==typeof a?!1:!0}catch(b){dalert(b)}}},g_objCommonUtil=new commonUtil;String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")});String.prototype.replaceAll||(String.prototype.replaceAll=function(a,b){return this.replace(new RegExp(a,"g"),b)});
Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a,b){if(null==this)throw new TypeError('"this" is null or not defined');var c=Object(this),d=c.length>>>0;if("function"!==typeof a)throw new TypeError("predicate must be a function");for(var f=0;f<d;){var g=c[f];if(a.call(b,g,f,c))return g;f++}}});
var startsWith=function(a,b,c){try{return a&&b?a.substring(!c||0>c?0:c,b.length)===b:!1}catch(d){dalert(d)}},endsWith=function(a,b,c){try{if(!a||!b)return!1;c=!c||c>a.length?a.length:c;return a.substring(c-b.length,c)===b}catch(d){dalert(d)}};Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);
Element.prototype.closest||(Element.prototype.closest=function(a){var b=this;do{if(Element.prototype.matches.call(b,a))return b;b=b.parentElement||b.parentNode}while(null!==b&&1===b.nodeType);return null});var inArray=function(a,b){for(var c in b)if(b[c]==a)return!0;return!1},inArrayIndex=function(a,b){for(var c in b)if(b[c]==a)return parseInt(c);return-1},forEach=function(a,b,c){for(var d=0;d<a.length;d++)b.call(c,d,a[d])};
Array.prototype.forEach||(Array.prototype.forEach=function(a,b){if("function"!==typeof a)throw new TypeError(a+" is not a function");b=b||this;for(var c=0,d=this.length;c!==d;++c)a.call(b,this[c],c,this)});var pushArray=function(a,b){forEach(b,function(b,d){a.push(d)});return a};
function getSelectionParentElement(a,b){b=b.toUpperCase();var c=null;if(window.attachEvent){a=g_objEditorDocument[a].selection.createRange();if(fnObjectCheckNull(a))return null;g_strBookmark_IE=a.getBookmark();if(a.moveToBookmark(g_strBookmark_IE))for(c=a.parentElement();c&&c.nodeName.toUpperCase()!=b;)c=c.parentElement}else c=getSelectionElement(b,!1,a);return c}String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var $_=function(a){return duzon_dialog.objLayerDoc.getElementById(a)};
Number.prototype.setComma=function(){return this.toString().replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")};String.prototype.setComma=function(){return this.replace(/(\d)(?=(?:\d{3})+(?!\d))/g,"$1,")};String.prototype.removeComma=function(){return this.replace(/,/g,"")};Number.prototype.removeComma=function(){return this};function insertAfter(a,b){try{var c=null;return c=a.nextSibling?a.parentNode.insertBefore(b,a.nextSibling):a.parentNode.appendChild(b)}catch(d){dalert(d)}}
function checkDefaultValue(a,b,c){try{if(void 0===a)return!1;void 0===c&&(c=[""]);return null===a||void 0===a||0===a.length||g_objCommonUtil.contains(c,a)?b:a}catch(d){return dalert(d),!1}}function checkNumber(a){try{return/^[0-9\-]+(\.[0-9]+)*$/.test(a)?!0:!1}catch(b){return dalert(b),!1}}function getIntegerDivision(a,b){var c=Math.floor(a/b);a%=b;for(var d=[],f=0;f<b;f++)d[f]=c;for(f=b-1;0<f&&0<a;f--)d[f]+=1,a--;return d}function changeCss(a,b,c,d,f,g){return addStylesheetRules([[a,[b,c]]],d)}
function addStylesheetRules(a,b){try{var c=!1;b=b||document;var d=b.head.querySelector("#dze_stylesheet_rule");d||(d=b.createElement("style"),d.id="dze_stylesheet_rule",b.head.appendChild(d));if(!d)return!1;var f=d.sheet;for(b=0;b<a.length;b++){d=1;var g=a[b],h=g[0],k="";Array.isArray(g[1][0])&&(g=g[1],d=0);for(var m=g.length;d<m;d++){var l=g[d];k+=l[0]+": "+l[1]+(l[2]?" !important":"")+";\n"}f.insertRule(h+"{"+k+"}",f.cssRules.length);c=!0}return c}catch(p){return dalert(p),!1}}
window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""));function isAbsoluteUrl(a){return"string"!==typeof a||/^[a-zA-Z]:\\/.test(a)?!1:/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(a)}function isRelativeUrl(a){return!isAbsoluteUrl(a)}
function getFullUrlFromPath(a,b){0!=a.indexOf("http://")&&0!=a.indexOf("https://")&&0!=a.indexOf("//")&&(b||(b=0==a.indexOf("/")?document.location.origin:document.location.href.substring(0,location.href.lastIndexOf("/"))+"/"),a=b+a);return a}
function removeContentsOriginStr(){try{var a=dzeUiConfig.arrCustomImgSrcRemoveDomain;!0===dzeUiConfig.autoAddImgSrcRemoveDomain&&a.push(document.location.origin);for(var b=document.images,c=0;c<b.length;c++){var d=b[c].src;if(!(0<=d.indexOf("oneffice/image"))&&0<=d.indexOf("getAttachmentData.do?seq="))for(var f=0;f<a.length;f++)b[c].outerHTML=b[c].outerHTML.replace(a[f]+"/","/")}var g=document.getElementsByTagName("source");for(c=0;c<g.length;c++)if(0<=g[c].src.indexOf("getAttachmentData.do?seq="))for(f=
0;f<a.length;f++)g[c].outerHTML=g[c].outerHTML.replace(a[f]+"/","/");var h=document.getElementsByTagName("table");for(c=0;c<h.length;c++)if(h[c].style.backgroundImage&&0<=h[c].style.backgroundImage.indexOf("getAttachmentData.do?seq="))for(f=0;f<a.length;f++)h[c].style.backgroundImage=h[c].style.backgroundImage.replace(a[f]+"/","/");b=[];b=b.concat([].slice.call(document.getElementsByTagName("td")));b=b.concat([].slice.call(document.getElementsByTagName("th")));for(c=0;c<b.length;c++)if(b[c].style.backgroundImage&&
0<=b[c].style.backgroundImage.indexOf("getAttachmentData.do?seq="))for(f=0;f<a.length;f++)b[c].style.backgroundImage=b[c].style.backgroundImage.replace(a[f]+"/","/")}catch(k){dalert(k)}}function cloneSimpleObject(a){if(null===a||"object"!==typeof a)return a;var b=a.constructor(),c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}
function compareSimpleObject(a,b){var c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;var f=!0;try{c.forEach(function(c){if(a[c]!==b[c])throw f=!1,BreakException;})}catch(g){}return f}
function toDataURL(a,b,c,d,f){try{var g=new Image;g.crossOrigin="Anonymous";g.onload=function(){var a=document.createElement("CANVAS");document.body.appendChild(a);var d=a.getContext("2d");a.height=this.naturalHeight;a.width=this.naturalWidth;d.drawImage(this,0,0);a=a.toDataURL(c);b(a,f)};g.onerror=function(){d()};g.src=a;if(g.complete||void 0===g.complete)g.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",g.src=a}catch(h){dalert(h),d()}}
function b64toBlob(a,b,c){b=b||"";c=c||512;a=atob(a);for(var d=[],f=0;f<a.length;f+=c){for(var g=a.slice(f,f+c),h=Array(g.length),k=0;k<g.length;k++)h[k]=g.charCodeAt(k);g=new Uint8Array(h);d.push(g)}return new Blob(d,{type:b})}
function getFullDateFromTimeStamp(a){var b=new Date(a);a=b.getFullYear();var c=b.getMonth()+1;10>c&&(c="0"+c);var d=b.getDate();10>d&&(d="0"+d);var f=b.getHours();10>f&&(f="0"+f);var g=b.getMinutes();10>g&&(g="0"+g);b=b.getSeconds();10>b&&(b="0"+b);return""+a+"-"+c+"-"+d+" "+f+":"+g+":"+b}
function getDateString(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear(),f=a.getDay(),g=a.getHours();a=a.getMinutes();return d+"\ub144 "+c+"\uc6d4 "+b+"\uc77c("+"\uc77c\uc6d4\ud654\uc218\ubaa9\uae08\ud1a0".split("")[f]+") "+g+":"+a}function isEditor(){var a=location.pathname;if(a.length){a=a.split("/");var b=a.length;if(b)return a[b-1].search("view")?!1:!0}return!1}function toFloat(a,b){-1!=(a+"").indexOf(".")&&(a=a.toFixed(b),a=a.replace(/(0+$)/,""));return a}
function dynamicExtScriptCall(a,b){try{"undefined"==typeof b&&(b=function(){});for(var c=document.getElementsByTagName("head")[0],d=c.getElementsByTagName("script"),f="",g=!1,h=0;h<d.length;h++)if(f=d[h].getAttribute("src"),null!=f&&0<=f.indexOf(a)){g=!0;break}if(1==g)b();else{var k=document.createElement("script");k.setAttribute("type","text/javascript");k.setAttribute("src",a);k.onload=function(){b()};c.appendChild(k)}}catch(m){dalert(m)}}
function parseURL(a){var b=document.createElement("a"),c={},d;b.href=a;a=b.search.replace(/^\?/,"").split("&");for(d=0;d<a.length;d++){var f=a[d].split("=");c[f[0]]=f[1]}return{protocol:b.protocol,host:b.host,hostname:b.hostname,port:b.port,pathname:b.pathname,search:b.search,searchObject:c,hash:b.hash}}
function removeHash(){var a=window.location;if("pushState"in history)history.pushState("",document.title,a.pathname+a.search);else{var b=document.body.scrollTop;var c=document.body.scrollLeft;a.hash="";document.body.scrollTop=b;document.body.scrollLeft=c}}function camelCase(a){return a.replace(/-([a-z])/ig,function(a,c){return c.toUpperCase()})}
function parseStyle(a){try{if(!a||""==a)return null;var b={},c=a.split(";");a=0;for(var d=c.length;a<d;a++){var f=c[a].split(":");if(f&&""!=f&&2==f.length&&f[0]){var g=f[0].trim(),h=f[1].trim();g=camelCase(g);b[g]=h}}return b}catch(k){return dalert(k),null}}
function equalStyle(a,b){try{var c=Object.getOwnPropertyNames(a),d=Object.getOwnPropertyNames(b);if(c.length!==d.length)return!1;for(d=0;d<c.length;d++){var f=c[d],g=a[f],h=b[f];if(g&&h)if("fontFamily"===f)g=g.replace(/['"]+/g,""),h=h.replace(/['"]+/g,"");else if("letterSpacing"===f||"fontSize"===f){var k=g_objCommonUtil.extractNumberValueUnit(g),m=g_objCommonUtil.extractNumberValueUnit(h);if(k&&m){if(g.strUnit!==h.strUnit||parseFloat(k.nValue)!==parseFloat(m.nValue))return!1;continue}}if(g!==h)return!1}return!0}catch(l){dalert(l)}}
function checkKeyCodeType(a){a=a.keyCode;return 48<=a&&57>=a?1:65<=a&&90>=a||97<=a&&122>=a?2:58<=a&&64>=a||91<=a&&96>=a||123<=a&&126>=a?4:12592<=a&&12687>=a||229==a?3:8==a||9==a||46==a||32==a?5:0}function wrap(a,b,c){var d=a[b];return a[b]=function(){return c.apply(this,[d.bind(this)].concat(Array.prototype.slice.call(arguments)))}}
function checkSameOrigin(a){try{if(0==a.toLowerCase().indexOf("http")){var b=parseURL(document.location.href),c=parseURL(a);if(b.host.toLowerCase()!=c.host.toLowerCase())return!1}return!0}catch(d){return dalert(d),!0}}function toColumnName(a){for(var b="",c=1,d=26;0<=(a-=c);c=d,d*=26)b=String.fromCharCode(parseInt(a%d/c)+65)+b;return b}function isValidURL(a){return null==a.match(/^(http(s)?:\/\/.)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)?!1:!0}
function isOnefficeURL(a){return null==a.match(/\/oneffice\/oneffice.(do|html)\?.+/gi)?!1:!0}
function setFullUrlAttachFiles(a){try{if(a){var b=a.querySelectorAll("link, img, source");a=null;for(var c=0,d=b.length;c<d;c++)a=b[c],"LINK"===a.nodeName?"undefined"!==typeof a.href&&null!==a.href&&""!==a.href&&(a.href=getFullUrlFromPath(a.href)):"IMG"!==a.nodeName&&"SOURCE"!==a.nodeName||"undefined"===typeof a.src||null===a.src||""===a.src||0===a.src.indexOf("data:image")||(a.src=getFullUrlFromPath(a.src))}}catch(f){dalert(f)}}
function throttle(a,b,c){try{var d=a;c=Array.prototype.slice.call(arguments,2);clearTimeout(b.tId);b.tId=setTimeout(function(){b.apply(d,c)},1)}catch(f){dalert(f)}}function functionName(a){try{var b=a.toString();b=b.substr(9);return b=b.substr(0,b.indexOf("("))}catch(c){dalert(c)}}
function quoteFontFamily(a){try{if(""==a)return a;for(var b=/^["'].*["']$/,c=/[\t\n\f\r ]/g,d=a.split(","),f=0;f<d.length;f++){var g=d[f].trim();!b.test(g)&&c.test(g)?d[f]='"'+g+'"':d[f]=g}return d=d.join(", ")}catch(h){return dalert(h),a}}function getRandString(a){try{for(var b="",c=0;c<a;c++)b+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return b}catch(d){return dalert(d),""}}
function downloadBase64Image(a,b){var c=atob(a.split(",")[1]),d=c.length,f=new ArrayBuffer(d);f=new Uint8Array(f);var g;for(g=0;g<d;g++)f[g]=c.charCodeAt(g)&255;c=new Blob([f],{type:"application/octet-stream"});if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(c,b+".png");else{var h=document.createElement("a");h.style="display: none";h.href=a;h.download=b+".png";document.body.appendChild(h);h.click();setTimeout(function(){document.body.removeChild(h)},100)}}
function downloadRemoteImage(a,b){try{var c="png";try{var d=a.split(".").pop().toLowerCase();inArray(d,["gif","jpg","jpeg","png","bmp"])&&(c=d)}catch(k){}b+="."+c;!0!==checkSameOrigin(a)&&(a=dzeEnvConfig.strGetWebImgURL+"?url="+encodeURIComponent(a));if(g_browserCHK.ie){var f=new XMLHttpRequest;f.open("GET",a,!0);f.responseType="blob";var g=setTimeout(function(){f.abort()},5E3);f.onload=function(){clearTimeout(g);window.navigator.msSaveOrOpenBlob(this.response,b)};f.send()}else{var h=document.createElement("a");
h.setAttribute("style","display: none");h.setAttribute("href",a);h.setAttribute("download",b);document.body.appendChild(h);h.click();setTimeout(function(){document.body.removeChild(h)},1E3)}}catch(k){dalert(k)}}
function uploadImg(a,b,c,d){try{if(b)if(!0===dzeUiConfig.bUseContentExtUpload)d=d||CONST_DZE_UPLOAD_TYPE_IMAGE,g_objExtUploader.initWithUploadItem(b,d),g_objExtUploader._uploadImgCallback=function(a){g_objExtUploader._uploadImgCallback=null;a=[a];var b=[""];c&&c({result:"success",url:a,filename:b})};else{var f=new FormData(b),g=dzeEnvConfig.strUploadImageURL,h="";isRelativeUrl(g)||(h=g.substring(0,g.lastIndexOf("/"))+"/");duzon_http.ajax({type:"post",url:g,async:!0,data:f,dataType:"form-data",timeout:3E4,
loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(b){var d=duzon_http.parseJSON(b);"success"!=d.result?alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR):(d.url&&!Array.isArray(d.url)&&(d.url=[d.url]),d.filename&&!Array.isArray(d.filename)&&(d.filename=[d.filename]),d.relativeUrl&&!Array.isArray(d.relativeUrl)&&(d.relativeUrl=[d.relativeUrl]),(oneffice.bUseOnexFile||objOnefficeLoader.m_nAppEnvType===APPENV.WE&&g_onefficeWeTool&&"onex"===g_onefficeWeTool.m_IsOnex)&&
d.relativeUrl?d.url=d.relativeUrl:d.url.forEach(function(a,b){d.url[b]=getFullUrlFromPath(a,h)}),DZE_UPLOAD_EVENT.setComplete(a,d),c&&c(d))},error:function(){dalert("upload err");c&&c(null)}})}}catch(k){dalert(k)}}function textEllipsis(a,b){try{return b||(b=50),a&&a.length>b&&(a=a.substr(0,47)+"..."),a}catch(c){return dalert(c),a}}
function checkValidImgFile(a,b){try{b=b||function(){};for(var c=[],d=0,f=a.length;d<f;d++){var g=new Image;c.push(g)}checkImgFileExt({files:a,names:[],imgs:c,errMsgs:[]}).then(checkImgFileLoad).then(function(a){b(a.files,a.names,a.imgs,a.errMsgs)}).catch(function(c){dalert(c);b(a,[],[],[])})}catch(h){dalert(h)}}
function checkImgFileExt(a){return new Promise(function(b){for(var c=a.files,d=a.imgs,f=a.names,g=a.errMsgs,h=[],k=[],m=duzon_dialog.arrAllowedFileExt,l=0,p=c.length;l<p;l++){var n=c[l];if(n instanceof File){n=n.name;var q="."+n.split(".").pop().toLowerCase();inArray(q,m)||(d[l]=null,h.push(n))}else n=c[l].toLowerCase(),0!=n.indexOf("http")&&0!=n.indexOf("//")&&(c[l]="http://"+c[l]),n=c[l],q=/[.]/.exec(n)?"."+/[^.]+$/.exec(n)[0]:"",q=q.split(/&|\?/)[0],q=q.toLowerCase(),inArray(q,m)||(d[l]=null,k.push(n));
f[l]=n}0<h.length&&g.push('"'+textEllipsis(h.join('", "'))+'" '+ID_RES_CONST_STRING_CANNOT_UPLOAD_FILE_TYPE+" "+m.join(", "));0<k.length&&g.push('"'+textEllipsis(k.join('", "'))+'" '+ID_RES_CONST_STRING_INVALID_IMG_URL+" "+m.join(", "));b(a)}.bind(this))}
function checkImgFileLoad(a){return new Promise(function(b){var c=a.files,d=a.names,f=a.imgs,g=a.errMsgs,h=g_objLayerKit.getLayerDocument().defaultView,k=h.URL||h.webkitURL;h=c.length;var m=[],l=function(){0<m.length&&g.push(ID_RES_DIALOG_ALERT_SELECT_VALID_IMAGE+'\n"'+m.join('", "')+'"');b(a)};if(0===h)l();else for(var p=h,n=0;n<h;n++)f[n]?function(){var a=n,b=c[a],g=d[a],h=f[a],r="";r=b instanceof File?k.createObjectURL(b):b;h.src=r;h.onload=function(){h.onload=h.onerror=null;p--;0===p&&l()};h.onerror=
function(){h.onload=h.onerror=null;f[a]=null;m.push(textEllipsis(g));p--;0===p&&l()}}():(p--,0===p&&l())}.bind(this))}
var TEXT=new function(){this.getTextCounts=function(){try{var a=0,b=g_objEditorDocument[g_objPageControl.nEditNumber],c=b.createRange();if(0<arguments.length){var d=arguments[0];if("string"!==typeof d)if("TD"===d.nodeName)c.selectNode(d),a=c.toString().length;else if(!1===fnObjectCheckNull(d.constructor)&&"range"===d.constructor.name.toLowerCase()){if(!0===d.collapsed)return 0;var f=b.createElement("div"),g=b.createElement("div");f.appendChild(g);g.appendChild(d.cloneContents());c.selectNode(g);a=
c.toString().length;d=g}}else{d=b;for(var h=b.querySelectorAll(".dze_page_main"),k=0;k<h.length;k++)c.selectNode(h[k]),a+=c.toString().length}var m=d.querySelectorAll("p, li, h1, h2, h3, h4, h5, h6"),l=m.length;!1===fnObjectCheckNull(l)&&!1===isNaN(l)&&1<l&&(a+=l-1);var p=d.querySelectorAll("br").length,n;for(k=0;k<m.length;k++){for(n=m[k].lastChild;!1===fnObjectCheckNull(n)&&!0!==fnObjectCheckNull(n.lastChild);)n=n.lastChild;n&&"BR"===n.nodeName&&--p}!1===fnObjectCheckNull(p)&&!1===isNaN(p)&&0<p&&
(a+=p);return a}catch(q){dalert(q)}};this.getMaxTextCounts=function(a){try{if(!0===fnObjectCheckNull(a))return-1;var b=1*a.getAttribute("max_text_counts");return!1===isNaN(b)?b:-1}catch(c){dalert(c)}};this.countsInfo=new function(){this.updateTimer=this.warnTimer=this.warnInterval=this.box=null;this.bAlertToast=!1;this.show=function(a){try{if(!objOnefficeLoader.m_bHybrid&&!0!==fnObjectCheckNull(a)){var b=1*a.getAttribute("max_text_counts");if(!0!==fnObjectCheckNull(b)&&!0!==isNaN(b)){if(!0===fnObjectCheckNull(this.box)&&
!0===fnObjectCheckNull(document.getElementById("dze_text_counts_box")))try{var c=document.createElement("div"),d=document.createElement("div"),f=document.createElement("span"),g=document.createElement("span");c.id="dze_text_counts_box";c.style="width: fit-content; height: 30px; background: #eeeeee; pointer-events: none; vertical-align: middle; padding: 0px 10px; z-index: 20007; position: absolute; display: none;";d.style="font-size: 10pt; font-family: \ub9d1\uc740 \uace0\ub515; position: relative; top: 50%; transform: translateY(-50%)";
f.textContent="\uae00\uc790 \uc218: ";g.textContent="123";c.appendChild(d);d.appendChild(f);d.appendChild(g);g_objInsertUtil.insertLayerHTML(c.outerHTML,!1)}catch(k){dalert(k)}this.box=document.getElementById("dze_text_counts_box");if(!1===fnObjectCheckNull(this.box)){var h=TEXT.getTextCounts(a);this.update(h);this.updatePosition(a);h>b?this.box.classList.add("warn"):this.safe();this.box.style.display=""}}}}catch(k){dalert(k)}};this.hide=function(){try{!0===fnObjectCheckNull(this.box)&&(this.box=
document.getElementById("dze_text_counts_box")),!1===fnObjectCheckNull(this.box)&&(this.box.style.display="none")}catch(a){dalert(a)}};this.update=function(a){try{!0!==fnObjectCheckNull(this.box)&&(this.box.firstChild.lastChild.textContent=a)}catch(b){dalert(b)}};this.warn=function(a){try{if(!0!==fnObjectCheckNull(this.box)){null!==this.warnInterval&&clearInterval(this.warnInterval);null!==this.warnTimer&&clearTimeout(this.warnTimer);var b,c=TEXT.countsInfo.box;this.warnInterval=setInterval(function(){b=
c.classList;!0===b.contains("warn")?c.classList.remove("warn"):c.classList.add("warn")},500);this.warnTimer=setTimeout(function(){!1===fnObjectCheckNull(TEXT.countsInfo.warnInterval)&&(clearInterval(TEXT.countsInfo.warnInterval),TEXT.countsInfo.warnInterval=null);clearTimeout(TEXT.countsInfo.warnTimer);TEXT.countsInfo.warnTimer=null;c.classList.add("warn")},3500);!1===this.bAlertToast&&(this.bAlertToast=!0,cmnCtrlToast.showToastMsg(null,a+" \uc790\ub97c \ucd08\uacfc\ud558\uc600\uc2b5\ub2c8\ub2e4",
2,"screen_center",!0,TOAST_TYPE_OPTION_WARN))}}catch(d){dalert(d)}};this.safe=function(){try{!1===fnObjectCheckNull(this.warnInterval)&&(clearInterval(this.warnInterval),this.warnInterval=null),!1===fnObjectCheckNull(this.warnTimer)&&(clearTimeout(this.warnTimer),this.warnTimer=null),this.box.classList.remove("warn"),this.bAlertToast=!1}catch(a){dalert(a)}};this.updatePosition=function(a){try{if(!0!==fnObjectCheckNull(this.box)&&!0!==fnObjectCheckNull(a.getAttribute("max_text_counts"))){var b=g_objPositionUtil.getElementPosClientRect(a),
c=g_objPositionUtil.getElementPosition(g_objEditObject[g_objPageControl.nEditNumber],!1),d=parseInt(a.style.borderRightWidth,10),f=parseInt(a.style.borderBottomWidth,10);isNaN(d)&&(d=0);isNaN(f)&&(f=0);this.box.style.left=b.right+d/2+"px";this.box.style.top=b.bottom+c.top-30+f/2+"px"}}catch(g){dalert(g)}}}};
var g_objNodeUtil=new function(){this.arrParaTagName="p li h1 h2 h3 h4 h5 h6 dt dd pre".split(" ");this.arrParaNodeName="P LI H1 H2 H3 H4 H5 H6 DT DD PRE".split(" ");this.arrCellTagName=["td","th"];this.arrCellNodeName=["TD","TH"];this.arrListNodeName=["OL","UL","DL"];this.arrListTagName=["ol","ul","dl"];this.arrListItemNodeName=["LI","DT","DD"];this.arrListItemTagName=["li","dt","dd"];this.arrTextInputType="text password search tel url week month".split(" ");this.getRotationAngle=function(a){try{if(!0===
fnObjectCheckNull(a))return 0;var b=a.style.transform;b=b.substring(b.indexOf("rotate")+7,b.lastIndexOf("deg)"));b=parseFloat(b);!0===isNaN(b)&&(b=0);360<=b?b-=360:0>b&&(b+=360);return b}catch(c){}};this.getMargin=function(a){try{var b={left:0,top:0,right:0,bottom:0};a&&a.nodeType==ID_SELECTION_ELEMENT_NODE&&(b.left=parseFloat(a.style.marginLeft),b.right=parseFloat(a.style.marginRight),b.top=parseFloat(a.style.marginTop),b.bottom=parseFloat(a.style.marginBottom),isNaN(b.top)&&(b.top=0),isNaN(b.bottom)&&
(b.bottom=0),isNaN(b.left)&&(b.left=0),isNaN(b.right)&&(b.right=0));return b}catch(c){dalert(c)}};this.getPadding=function(a){try{var b={left:0,right:0,top:0,bottom:0};!1===fnObjectCheckNull(a)&&a.nodeType==ID_SELECTION_ELEMENT_NODE&&(b.left=parseFloat(a.style.paddingLeft),b.right=parseFloat(a.style.paddingRight),b.top=parseFloat(a.style.paddingTop),b.bottom=parseFloat(a.style.paddingBottom),isNaN(b.left)&&(b.left=0),isNaN(b.right)&&(b.right=0),isNaN(b.top)&&(b.top=0),isNaN(b.bottom)&&(b.bottom=0));
return b}catch(c){dalert(c)}};this.setAttribute=function(a,b,c){try{a&&a.hasAttribute&&a.setAttribute(b,c)}catch(d){dalert(d)}};this.getAttribute=function(a,b){try{if(a&&a.getAttribute)return a.getAttribute(b)}catch(c){dalert(c)}};this.removeAttribute=function(a,b){try{if(a&&a.removeAttribute)return a.removeAttribute(b)}catch(c){dalert(c)}};this.hasAttribute=function(a,b){try{if(a&&a.hasAttribute)return a.hasAttribute(b)}catch(c){dalert(c)}};this.copyAttribute=function(a,b){try{if(!a||!b)return!1;
for(var c=null,d=Array.prototype.slice.call(b.attributes);c=d.pop();)a.setAttribute(c.nodeName,c.nodeValue);return!0}catch(f){dalert(f)}};this.getChildrenCollection=function(a){try{var b=null;return b=window.attachEvent?a.children:a.childNodes}catch(c){dalert(c)}return null};this.getSelectionElement_Anchor=function(a,b,c){try{if(window.attachEvent)return null;var d=g_objEditWindow[c].getSelection();if(0==d.rangeCount)return;var f=d.getRangeAt(0);d=null;var e=f.startContainer;g_bBrowserType_IE&&g_objObjectSelectionInfo.bSelectObject&&
"img"==g_objObjectSelectionInfo.strNodeName&&"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase()&&(e=g_objObjectSelectionInfo.objSelectionObject);for(;e;){if(a==e.nodeName.toUpperCase()){d=e;break}e=e.parentNode}if(!d)if(g_bBrowserType_IE){if(g_objObjectSelectionInfo.bSelectObject&&"img"==g_objObjectSelectionInfo.strNodeName&&"absolute"==g_objObjectSelectionInfo.objSelectionObject.style.position.toLowerCase())return null;var g=f.commonAncestorContainer,h=g_objEditorDocument[c].createRange();
for(c=0;c<g.childNodes.length;c++){var k=g.childNodes[c];h.selectNode(k);var l=f.compareBoundaryPoints(Range.START_TO_START,h);if((0==l||-1==l)&&a==k.nodeName.toUpperCase()){d=k;break}}if(!d)return null}else return null;b&&g_objALinkMgr.selectAnchors(d);return d}catch(t){dalert(t)}finally{}return null};this.getElementTagName=function(a){try{if(window.attachEvent){if("undefined"!=typeof a.tagName)return a.tagName;if("undefined"!=typeof a.nodeName)return a.nodeName}else return a.nodeName}catch(b){dalert(b)}return null};
this.getLoopChildNodeByTagName=function(a,b){try{if(!a||!a.childNodes)return null;for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(b==this.getElementTagName(d).toLowerCase())return d;var f=this.getLoopChildNodeByTagName(d,b);if(f)return f}}}catch(e){dalert(e)}return null};this.getLoopChildNodeByTagNames=function(a,b){try{for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c];if(ID_SELECTION_ELEMENT_NODE==d.nodeType){if(inArray(this.getElementTagName(d).toLowerCase(),
b))return d;var f=this.getLoopChildNodeByTagName(d,b);if(f)return f}}}catch(e){dalert(e)}return null};this.getImmediateChildNodesByTagName=function(a,b){try{if(!a)return[];for(var c=[],d=a.childNodes.length,f=0;f<d;f++)this.checkTagName(a.childNodes[f],b)&&c.push(a.childNodes[f]);return c}catch(e){dalert(e)}};this.getParentElement=function(a){try{return!0===fnObjectCheckNull(a)?null:window.attachEvent?"undefined"!=typeof a.parentElement?a.parentElement:a.parentNode:a.parentNode}catch(b){dalert(b)}return null};
this.getCheckElementTagName=function(a){if(!a)return"";a=g_objNodeUtil.getElementTagName(a);return"undefined"==typeof a||null==a?"":a=a.toLowerCase()};this.CheckTagName=function(a,b,c){for(var d=0;d<b;d++){var f=a[d].check.toLowerCase();if("undefined"==typeof f||null==f)return null;if(f==c)return d}return-1};this.checkTagName=function(a){try{if(!a||!a.tagName)return null;for(var b=a.tagName.toLowerCase(),c=1,d=arguments.length;c<d;c++)if(b==arguments[c])return a;return null}catch(f){dalert(f)}};this.getParentElementForTargetTags=
function(a,b,c,d,f){try{if(null==a||0==c||!(a.nodeType==ID_SELECTION_TEXT_NODE||f&&this.checkTagName(a,"br"))||"undefined"==typeof b)return null;for(d=d||DZE_TAG_BODY;;){var e=g_objNodeUtil.getCheckElementTagName(a);if(!e)break;var g=g_objNodeUtil.CheckTagName(b,c,e);if(0<=g)return a;if(0>g||null===g){var h=g_objNodeUtil.getParentElement(a);if(fnObjectCheckNull(h))break;a=h}else if(e==d)break}}catch(k){dalert(k)}return null};this.getLoopParentElement=function(a,b,c){try{if(!a||!b)return null;for(var d=
b.toUpperCase();a&&(!0!==c||!this.isBoundNode(a));){if(d===a.nodeName)return a;a=a.parentNode}}catch(f){dalert(f)}return null};this.getLoopParentElementByTagNames=function(a,b,c){try{if(!0===fnObjectCheckNull(a))return null;for(var d=null;!(this.isLoopBreakNode(a)||!0===c&&this.isBoundNode(a));){if(!0===inArray(this.getElementTagName(a).toLowerCase(),b))return a;d=this.getParentElement(a);if(!0===fnObjectCheckNull(d))break;a=d}return null}catch(f){dalert(f)}};this.getLoopParentNodeOn=function(a,b){try{if(!a||
!b)return null;for(var c=null;a&&!this.isLoopBreakNode(a)&&a!==b;)c=a,a=a.parentNode;return c}catch(d){dalert(d)}};this.getLoopParentByClassName=function(a,b){try{if(!0===fnObjectCheckNull(a))return null;var c=this.getParentElement(a);if(!1===fnObjectCheckNull(c))for(var d;!1===this.isLoopBreakNode(c);){d=c.classList;if(!1===fnObjectCheckNull(d)&&d.contains(b))return c;c=this.getParentElement(c)}return null}catch(f){dalert(f)}};this.getLoopBreakNode=function(a){try{if(!a)return null;for(var b=g_objNodeUtil;a&&
!b.isLoopBreakNode(a);)a=a.parentNode;return b.isLoopBreakNode(a)?a:null}catch(c){dalert(c)}};this.addOptionForSelectBox=function(a,b,c){try{var d=document.createElement("option");d.value=b;d.text=c;window.attachEvent?a.add(d):a.add(d,null)}catch(f){dalert(f)}};this.getNodeWidthHeight=function(a,b){try{var c=!1,d=null,f="",e="";e=b?a.style.width:a.style.height;if(""!=e&&null!=e){var g=g_objCommonUtil.extractNumberValueUnit(e);null!=g&&(c=!0,d=g.nValue,f=g.strUnit)}c||(e=b?a.width:a.height,""!=e&&
null!=e&&(g=g_objCommonUtil.extractNumberValueUnit(e),null!=g&&(d=g.nValue,f=g.strUnit)));d=null!=d&&""!=d?parseInt(d):null;return{styleValue:c,nValue:d,strUnit:f}}catch(h){dalert(h)}return null};this.getEventSrcElement=function(a){try{return window.attachEvent?a.srcElement:a.target}catch(b){dalert(b)}return null};this.initFalsePropagationEvent=function(a){try{a&&(window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1))}catch(b){dalert(b)}};
this.getAncestorNodeOnCaret=function(a){try{if(null==g_objEditWindow[a])return;var b=null;if(window.addEventListener){var c=g_objEditWindow[a].getSelection();1==c.rangeCount&&(b=c.getRangeAt(0))}else{c=g_objEditorDocument[a].selection;if(fnObjectCheckNull(c))return;b=c.createRange();if(fnObjectCheckNull(b))return}if(null==b)return null;a=null;return a="commonAncestorContainer"in b?b.commonAncestorContainer:b.parentElement().childNodes[0]}catch(d){dalert(d)}finally{}return null};this.traverseNodesInRange=
function(a,b){try{var c=a.startContainer.childNodes[a.startOffset]||a.startContainer,d=a.endContainer.childNodes[a.endOffset]||a.endContainer,f=a.commonAncestorContainer;if(c!==d||c.firstChild)for(a=c,c=null;a;){c=this.getNextNode(a,!1,d);if(!1===b(a))break;if(a===d||a===f||this.isLoopBreakNode(a))break;a=c}else b(c)}catch(e){dalert(e)}};this.getNextNode=function(a,b,c){try{return c===a||this.isLoopBreakNode(a)?null:a.firstChild&&!b?a.firstChild:a.parentNode?a.nextSibling||this.getNextNode(a.parentNode,
!0,c):null}catch(d){dalert(d)}};this.moveNodesTo=function(a,b,c){try{if(a&&b){for(var d=null;b;){d=b.nextSibling;a.appendChild(b);if(b===c)break;b=d}return a}}catch(f){dalert(f)}};this.removeAllChild=function(a){try{for(;a.firstChild;)a.removeChild(a.firstChild)}catch(b){dalert(b)}};this.splitOn=function(a,b,c){try{if(!a||!b||a===b||!a.contains(3===b.nodeType?b.parentNode:b))return null;for(var d=null,f=null,e=b.parentNode;a!=e;e=f){for(d=e.cloneNode(!1);b.nextSibling;)d.appendChild(b.nextSibling);
f=e.parentNode;f.insertBefore(d,e.nextSibling);this.onSplit(e,d);f.insertBefore(b,d);c&&c(b)}return d}catch(g){dalert(g)}};this.onSplit=function(a,b){try{var c=g_objPropertyUtil,d=g_objShapeFunction,f=g_objSplitUtil,e=f.DZE_SPLIT,g=f.DZE_SPLIT_CHILD,h=g_objPageControl.DZE_PAGE_BREAK_PARA,k=function(a,b){var c=f.getNextSplitSibling(a);if(c)for(var d=g_objCommonUtil.getUniqueID();a&&c!==a;)this.setAttribute(a,b,d),a=c,c=f.getNextSplitSibling(a);else this.removeAttribute(a,b)}.bind(this);this.hasAttribute(b,
g)&&k(b,g);this.hasAttribute(b,e)&&k(b,e);c.hasClass(a,h)&&c.removeClass(a,h);e=DZE_CUSTOM_ATT_RM_BIZBOX_REPORT;this.hasAttribute(a,e)&&(a.removeAttribute(e),b.removeAttribute(e));c.hasClass(a,"dze_shape_anchor")&&(d.checkHasShapes(b)?d.checkHasShapes(a)||c.removeClass(a,"dze_shape_anchor"):c.removeClass(b,"dze_shape_anchor"));c.hasClass(a,"dze_sketch_anchor")&&(d.checkHasSketch(b)?d.checkHasSketch(a)||c.removeClass(a,"dze_sketch_anchor"):c.removeClass(b,"dze_sketch_anchor"))}catch(l){dalert(l)}};
this.isBoundNode=function(a){try{var b=a.nodeName;if("TD"===b||"TH"===b||"DIV"===b||"CENTER"===b||"SECTION"===b||"ARTICLE"===b)return!0;var c=a.style,d=c?c.position.toLowerCase():"";return c&&("absolute"===d||"fixed"===d)&&this.isBlockNodeName(a.nodeName)||"SPAN"===b&&g_objPropertyUtil.hasClass(a,"dze_shape_text_container")||"DIV"===b&&("dze_copy_capture"===a.id||"dze_paste_capture"===a.id)||this.isLoopBreakNode(a)?!0:!1}catch(f){dalert(f)}};this.getCloset=this.getClosest=function(a,b){try{if(!a||
!b)return null;for(;a;){if(b&&!0===b(a))return a;a=a.parentNode}return null}catch(c){return null}};this.getClosetBound=this.getClosestBound=function(a,b){return this.getCloset(a,function(a){if(g_objNodeUtil.isBoundNode(a)||b&&!0===b(a))return!0})};this.getClosetParagraph=this.getClosestParagraph=function(a,b){return this.getCloset(a,function(a){if(1===a.nodeType&&0<=g_objNodeUtil.arrParaNodeName.indexOf(a.nodeName)||b&&!0===b(a))return!0})};this.findSplitPosition=function(a,b){try{if(!a)return null;
for(var c=a.parentNode;c&&c!==b&&!this.isLoopBreakNode(c);){for(;a;){var d=a.previousSibling;if(!d||"BR"===d.nodeName||!this.isZeroWidthNode(d))break;a=d}if(this.isCell(a))break;if(c.firstChild!==a)break;a=c;c=a.parentNode}return a}catch(f){dalert(f)}};this.insertBrIfSplitAtLast=function(a,b){try{if(!b)return null;for(var c=b.ownerDocument,d=null,f=b.parentNode,e=null;f&&f!==a&&!this.isBoundNode(f);){for(;b;){e=b.nextSibling;if(!e)break;if("BR"===e.nodeName||3===e.nodeType&&0<e.nodeValue.length)return null;
if(!this.isZeroWidthNode(e))break;b=e}if(f.lastChild===b){var g=!1;switch(f.nodeName){case "P":case "LI":case "DD":case "DT":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":g=!0}if(g){d=c.createElement("BR");f.appendChild(d);break}}b=f;f=b.parentNode}return d}catch(h){dalert(h)}};this.isZeroWidthNode=function(a){try{if(!a)return!1;var b=g_objPropertyUtil;if("COLGROUP"===a.nodeName||"SPAN"===a.nodeName&&(b.hasClass(a,"dze_page_break")||b.hasClass(a,"dze_shape_main")))return!0;if(1===a.nodeType){if(this.isInlineNode(a)&&
0===a.offsetWidth){var c=a.getBoundingClientRect();c=g_objPositionUtil.clientRectToOffsetRect(c);if(0===c.width)return!0}}else if(3===a.nodeType&&(0===a.nodeValue.length||!this.checkTagName(a.parentNode,"p","span","li")&&this.isIgnorable(a)))return!0;return!1}catch(d){dalert(d)}};this.isNodeInShape=function(a){try{for(var b=g_objNodeUtil,c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a);){if("SPAN"===a.nodeName&&c.hasClass(a,"dze_shape_main"))return!0;a=a.parentNode}return!1}catch(d){dalert(d)}};this.isNodeInQR=
function(a){try{for(var b=g_objNodeUtil,c=g_objPropertyUtil;a&&!b.isLoopBreakNode(a);){if("DIV"===a.nodeName&&(c.hasClass(a,"oneffice_qrcode_first_container")||c.hasClass(a,"oneffice_qrcode_last_container")))return!0;a=a.parentNode}return!1}catch(d){dalert(d)}};this.canSelectNodeContents=function(a){if(1===a.nodeType)switch(a.nodeName){case "BR":case "IMG":case "VIDEO":case "SELECT":case "INPUT":return!1}return!0};this.canCaretExistOn=function(a){if(!a||!a.parentNode)return NodeFilter.FILTER_SKIP;
var b=a.nodeType,c=a.nodeName,d=a.parentNode,f=!1;if(3===b&&!g_objNodeUtil.isIgnorable(a)&&"VIDEO"!==d.nodeName)f=!0;else if(1===b)if(!g_objNodeUtil.canSelectNodeContents(a))f=!0;else if(g_bBrowserType_IE&&"P"===c&&0===a.childNodes.length&&0<a.offsetHeight)f=!0;else if(g_bBrowserType_CR&&"HR"===c)f=!0;else if("LI"===c||"DT"===c||"DD"===c)f=!0;return f?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP};this.getFirstTextNode=function(a,b){return q(!0,a,b)};this.getLastTextNode=function(a,b){return q(!1,
a,b)};var q=function(a,b,c){try{if(!b)return null;var d=b.ownerDocument;if(!d)return null;var f=this.canCaretExistOn;f.acceptNode=this.canCaretExistOn;for(var e=d.createTreeWalker(b,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,f,!1),g=a?e.firstChild():e.lastChild();g&&this.isNodeInQR(g);)g=a?e.nextNode():e.previousNode();if(!0===c&&!this.isNodeInShape(b))for(;g&&this.isNodeInShape(g);)g=a?e.nextNode():e.previousNode();return g}catch(h){dalert(h)}}.bind(this);this.getTextNodeInRange=function(a,b){try{var c=
a.ownerDocument;if(!0===fnObjectCheckNull(c))return null;3===a.nodeType&&(a=a.parentNode);var d=c.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,this.treeWalkerFilter_TextNodeInRange,!1),f=d.firstChild();a=[];c=!1;var e=g_objHeaderFooter.getHeaderFooterEditMode(),g=g_objPageNumber;do if(!1===c)f===b.start&&(c=!0);else{if(f===b.end)break;if(!1!==e||!0!==g_objHeaderFooter.contains(f))g.isDiv(f.parentNode)||a.push(f)}while(null!==(f=d.nextNode()));return a}catch(h){dalert()}};this.treeWalkerFilter_TextNodeInRange=
function(a){try{if(3===a.nodeType){if(!1===g_objNodeUtil.isIgnorable(a))return NodeFilter.FILTER_ACCEPT}else if(1===a.nodeType){if(0===g_objSelectedShapesArray.length&&g_objPropertyUtil.hasClass(a,"dze_shape_main"))return NodeFilter.FILTER_REJECT;if("BR"===a.nodeName||a.id===g_objCaretUtil.ID_CURRENT_CARET||g_bBrowserType_IE&&"P"===a.nodeName&&0===a.childNodes.length&&0<a.offsetHeight)return NodeFilter.FILTER_ACCEPT}return NodeFilter.FILTER_SKIP}catch(b){dalert()}};this.treeWalkerFilter_TextNodeInRange.acceptNode=
this.treeWalkerFilter_TextNodeInRange;this.createRangeWalker=function(a,b,c){try{if(!a)return null;var d=a.commonAncestorContainer,f=a.startContainer.childNodes[a.startOffset]||a.startContainer,e=a.endContainer.childNodes[a.endOffset-1]||a.endContainer;if(!d||!f||!e)return null;var g=this,h=function(a,b){b=g.getParents(a,b);b=b.reverse();b.push(a);a=0;for(var c=b.length;a<c;a++)b[a]=g.getChildIndex(b[a]);return b},k=c;k&&k.acceptNode&&(k=k.acceptNode);a=function(a){try{for(var b=h(f,d),c=h(e,d),g=
h(a,d),l=!1,q=!1,r=0;;){var n=b[r],p=c[r],m=g[r];r++;n=l||isNaN(n)?-1:n;p=q||isNaN(p)?Number.MAX_VALUE:p;if(isNaN(m))break;if(m<n||m>p)return NodeFilter.FILTER_REJECT;if(m>n&&m<p)break;else if(m!==n||m!==p)m===n?q=!0:m===p&&(l=!0)}return k?k(a):NodeFilter.FILTER_ACCEPT}catch(u){dalert(u)}};a.acceptNode=a;return d.ownerDocument.createTreeWalker(d,b,a,!0)}catch(l){dalert(l)}finally{a=null}};this.getNodesOnSelection=function(a,b,c){try{if(!a||1>a.rangeCount)return[];var d=3===b?NodeFilter.SHOW_TEXT:
1===b?NodeFilter.SHOW_ELEMENT:null;if(null===d)return[];var f=a.getRangeAt(0),e=this.createRangeWalker(f,d,c),g=e.firstChild();if(!g&&e.currentNode&&e.currentNode.nodeType===b&&(!c||c(e.currentNode)))return[e.currentNode];a=null;for(c=[];g;){3===g.nodeType&&3===b&&/^\s*$/.test(g.nodeValue)||c.push(g);a=e.nextNode();if(a===g)break;g=a}return c}catch(h){dalert(h)}};this.getTextNodesIn=function(a,b,c){try{var d=[];if(a)for(var f=a.childNodes,e=0,g=f.length;e<g;e++){var h=f[e],k=h?h.nodeType:0;if(k==
ID_SELECTION_TEXT_NODE)b&&!b(h,a)||d.push(h);else if(c&&this.checkTagName(h,"br"))b&&!b(h,a)||d.push(h);else if(k==ID_SELECTION_ELEMENT_NODE||k==ID_SELECTION_DOCUMENT_NODE||k==ID_SELECTION_DOCUMENT_FRAGMENT_NODE)d=d.concat(this.getTextNodesIn(h,b,c))}return d}catch(l){dalert(l)}};this.clean=function(a){try{if(a)for(var b=function(a){var c=[];a=a.childNodes;for(var d=a.length;d--;){var e=a[d];if(e){var f=e.nodeType;3===f||8===f?c.push(e):e.firstChild&&c.push.apply(c,b(e))}}return c},c=b(a),d=g_objPropertyUtil,
f=0,e=c.length;f<e;f++){var g=c[f];if(g){if(3===g.nodeType&&(a=g.parentNode)&&1===a.nodeType)if("SPAN"===a.nodeName&&d.hasClass(a,"tabSpan"))continue;else if(""!==a.style.whiteSpace)continue;this.isIgnorable(g)&&g.parentNode.removeChild(g)}}}catch(h){dalert(h)}};this.removeAllCommentNode=function(a){try{if(a){var b=function(a){var c=[];a=a.childNodes;for(var d=a.length;d--;){var e=a[d];e&&(8===e.nodeType?c.push(e):e.firstChild&&c.push.apply(c,b(e)))}return c},c=b(a);a=0;for(var d=c.length;a<d;a++){var f=
c[a];f&&this.isIgnorable(f)&&f.parentNode.removeChild(f)}}}catch(e){dalert(e)}};this.normalize=function(a){try{if(a)if(g_bBrowserType_IE){if(3===a.nodeType)for(;a.nextSibling&&3===a.nextSibling.nodeType;)a.nodeValue+=a.nextSibling.nodeValue,a.parentNode.removeChild(a.nextSibling);else this.normalize(a.firstChild);this.normalize(a.nextSibling)}else a.normalize()}catch(b){dalert(b)}};this.isAllWhiteSpace=function(a){try{return a?!/[^\t\n\r ]/.test(a.textContent):!1}catch(b){dalert(b)}};this.isIgnorable=
function(a){try{return a?8===a.nodeType||3===a.nodeType&&this.isAllWhiteSpace(a):!1}catch(b){dalert(b)}};this.isLoopBreakNode=function(a){try{if(!a)return!0;var b=this.isLoopBreakNode.arrClassName;b||(b="dze_page_main dze_page_header dze_page_footer dze_page_container dze_page_header_container dze_page_footer_container dze_document_container cloud_container dze_print_page_main dze_print_page_container".split(" "),this.isLoopBreakNode.arrClassName=b);if(1===a.nodeType){var c=a.className;if(c&&"string"===
typeof c){c=0;for(var d=b.length;c<d;c++)if(a.classList.contains(b[c]))return!0}if("BODY"===a.nodeName||"dze_copy_capture"===a.id||"dze_paste_capture"===a.id)return!0}return!1}catch(f){dalert(f)}};this.getLoopHeaderFooterBody=function(a){try{if(!0===fnObjectCheckNull(a))return null;for(var b=["dze_page_main","dze_page_header","dze_page_footer"],c=null;!1===fnObjectCheckNull(a)&&"BODY"!==a.nodeName;){c=a.classList;if(!1===fnObjectCheckNull(c))for(var d=0;d<b.length;d++)if(!0===c.contains(b[d]))return a;
a=this.getParentElement(a)}return null}catch(f){dalert(f)}};this.isInlineNode=function(a){try{return a?this.isInlineNodeName(a.nodeName):!1}catch(b){return dalert(b),!1}};this.isInlineNodeName=function(a){switch(a){case "A":case "ABBR":case "ACRONYM":case "B":case "BASEFONT":case "BDO":case "BIG":case "BR":case "BUTTON":case "CITE":case "CODE":case "DEL":case "DFN":case "EM":case "FONT":case "I":case "IFRAME":case "IMG":case "INPUT":case "INS":case "KBD":case "LABEL":case "LEGEND":case "MAP":case "PARAM":case "Q":case "RB":case "RBC":case "RP":case "RT":case "RTC":case "RUBY":case "S":case "SAMP":case "SELECT":case "SMALL":case "SPAN":case "STRIKE":case "STRONG":case "SUB":case "SUP":case "TEXTAREA":case "TT":case "Y":case "VAR":return!0}return!1};
this.getLoopParentInlineNode=function(a){try{if(this.isInlineNode(a))return a;for(var b=a.parentNode;!this.isInlineNode(b);){if(this.isBlockNode(b)||this.isLoopBreakNode(b)){b=null;break}b=b.parentNode}return b}catch(c){dalert(c)}};this.isBlockNode=function(a){try{return a?this.isBlockNodeName(a.nodeName):!1}catch(b){return dalert(b),!1}};this.isBlockNodeName=function(a){switch(a){case "ADDRESS":case "ARTICLE":case "ASIDE":case "BLOCKQUOTE":case "CANVAS":case "DD":case "DIV":case "DL":case "DT":case "FIELDSET":case "FIGCAPTION":case "FIGURE":case "FOOTER":case "FORM":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":case "HEADER":case "HR":case "LI":case "MAIN":case "NAV":case "NOSCRIPT":case "OL":case "P":case "PRE":case "SECTION":case "TABLE":case "TFOOT":case "UL":case "VIDEO":return!0}return!1};
this.getLoopParentBlockNode=function(a){try{if(this.isBlockNode(a))return a;for(var b=a.parentNode;!this.isBlockNode(b);){if(this.isLoopBreakNode(b)){b=null;break}b=b.parentNode}return b}catch(c){dalert(c)}};this.hasAllTextInlineChild=function(a){try{if(!a)return!1;for(var b=a.firstChild;b;){if(3!==b.nodeType&&!this.isInlineNode(b))return!1;b=b.nextSibling}return!0}catch(c){return dalert(c),!1}};this.isAllChild=function(a,b){try{if(!a||!b)return!1;for(var c=a.firstChild;c;){if(!b(c))return!1;c=c.nextSibling}return!0}catch(d){dalert(d)}};
this.isTextArea=function(a){var b=a&&1===a.nodeType?a.nodeName:"";return"TEXTAREA"===b||"INPUT"===b&&0<=this.arrTextInputType.indexOf(a.type)?!0:!1};this.isHead=function(a){a=a&&1===a.nodeType?a.nodeName:"";return!a||"H1"!==a&&"H2"!==a&&"H3"!==a&&"H4"!==a&&"H5"!==a&&"H6"!==a?!1:!0};this.isParagraph=function(a){return a&&1===a.nodeType&&0<=this.arrParaNodeName.indexOf(a.nodeName)?!0:!1};this.isList=function(a){return(a=a&&1===a.nodeType?a.nodeName:"")&&0<=this.arrListNodeName.indexOf(a)?!0:!1};this.isListItem=
function(a){return(a=a&&1===a.nodeType?a.nodeName:"")&&0<=this.arrListItemNodeName.indexOf(a)?!0:!1};this.isCell=function(a){return!a||1!==a.nodeType||"TD"!==a.nodeName&&"TH"!==a.nodeName?!1:!0};this.isTr=function(a){return a&&1===a.nodeType&&"TR"===a.nodeName?!0:!1};this.isPageMain=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_page_main")?!0:!1};this.isPageContainer=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,
"dze_page_container")?!0:!1};this.isDocContainer=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_document_container")?!0:!1};this.isHeaderFooter=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,["dze_page_main","dze_page_header"])?!0:!1};this.isHeaderFooterMain=function(a){return a&&1===a.nodeType&&"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,["dze_page_main","dze_page_header","dze_page_footer"])?!0:!1};this.removeElementsBySelector=
function(a,b,c){try{if(!(a&&a.firstChild&&b&&a.ownerDocument))return!1;var d=a.querySelectorAll(b);d=[].slice.call(d);d.forEach(function(b){c&&c(b)===NodeFilter.FILTER_SKIP||this.removeElementNotChild(b,a)}.bind(this));return!0}catch(f){dalert(f)}};this.removeElementNotChild=function(a,b){try{if(!a||!a.parentNode)return!1;var c=a.ownerDocument,d=c.createDocumentFragment();if(a.parentNode===b||this.isCell(a.parentNode)){for(var f=b=null,e=a.firstChild;e;)f=e.nextSibling,3===e.nodeType||this.isInlineNode(e)?
(b=b||c.createElement("p"),b.appendChild(e)):(b&&(d.appendChild(b),b=null),d.appendChild(e)),e=f;b&&d.appendChild(b);a.parentNode.replaceChild(d,a)}else!this.isListItem(a.parentNode)||"P"!==a.nodeName&&"DIV"!==a.nodeName?!this.isList(a.parentNode)||"P"!==a.nodeName&&"DIV"!==a.nodeName?(this.moveNodesTo(d,a.firstChild),a.parentNode.replaceChild(d,a)):(this.moveNodesTo(d,a.firstChild),e=null,e="DL"===a.parentNode.nodeName?a.parentNode.firstChild===a?c.createElement("dt"):c.createElement("dd"):c.createElement("li"),
e.appendChild(d),a.parentNode.replaceChild(e,a)):(this.moveNodesTo(d,a.firstChild),a.previousSibling&&"BR"!==a.previousSibling.nodeName&&"inline"!==a.style.display&&"inline-block"!==a.style.display&&d.firstChild&&d.insertBefore(c.createElement("BR"),d.firstChild),a.parentNode.replaceChild(d,a))}catch(g){dalert(g)}};this.getChildIndex=function(a){try{for(var b=0;a=a.previousSibling;)b++;return b}catch(c){dalert(c)}};this.fixWrongTextFormat=function(a){try{var b=!1,c=a.parentNode,d=a.ownerDocument;
if(g_objNodeUtil.isBlockNode(c)){var f=this.getInlineTextStyle(c);for(a=0;a<c.childNodes.length;a++){var e=c.childNodes[a];if(3===e.nodeType)if(""===e.textContent)c.removeChild(e),a--,b=!0;else{if(!dzeUiConfig.bSupportNewsEditor){var g=d.createElement("span");c.insertBefore(g,e);g.appendChild(e);this.setInlineTextStyle(g,f);b=!0}}else"SPAN"===e.nodeName&&1===e.innerText.length&&8203===e.innerHTML.charCodeAt(0)&&(c.removeChild(e),a--,b=!0)}}return b}catch(h){dalert()}};this.getInlineTextStyle=function(a){try{a=
dzeJ(a);var b={size:Math.round(.75*parseInt(a.css("font-size"))),family:a.css("font-family"),color:a.css("color"),bgColor:a.css("background-color"),bold:"700"===a.css("font-weight")||"bold"===a.css("font-weight")?"bold":"normal",italic:"italic"===a.css("font-style")?"italic":"normal",textDeco:a.css("text-decoration"),subscript:a.css("vertical-align"),letterSpace:Math.round(.75*parseInt(a.css("letter-spacing")))};if(-1<b.textDeco.indexOf("none"))b.textDeco="none";else{var c="";-1<b.textDeco.indexOf("line-through")&&
(c="line-through");-1<b.textDeco.indexOf("underline")&&(c+=(0<c.length?" ":"")+"underline");b.textDeco=c}if("baseline"!==b.subscript){var d=a.attr("origin_font_size");b.size=d;b.subscript={type:b.subscript,originSize:fnObjectCheckNull(d)?2*parseInt(b.size,10):d}}b.size=isNaN(b.size)?"":b.size+"pt";b.letterSpace=isNaN(b.letterSpace)?"":b.letterSpace+"pt";return b}catch(f){dalert(f)}};this.setInlineTextStyle=function(a,b){try{if(!a||!b)return a;dzeJ(a).css({"font-size":b.size,"font-family":b.family,
color:b.color,"background-color":b.bgColor,"font-weight":b.bold,"font-style":b.italic,"text-decoration":b.textDeco,"vertical-align":b.subscript,"letter-spacing":b.letterSpace});return a}catch(c){dalert(c)}};this.isBlankDoc=function(a){try{return a=g_objPageControl,!a||a.getPageMain(1)?!1:this.isBlankBound(a.getPageMain(0))}catch(b){dalert(b)}};this.isBlankBound=function(a){try{return!a||1<a.childNodes.length?!1:this.isBlankPara(a.firstChild)}catch(b){dalert(b)}};this.isBlankPara=function(a){try{if(!a||
!inArray(a.nodeName,this.arrParaNodeName))return!1;if(!a.firstChild)return!0;var b=function(){return NodeFilter.FILTER_ACCEPT};b.acceptNode=b;var c=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,b,!1);if(!c)return!1;a=g_objPropertyUtil;b="";for(var d=0,f=0,e=c.firstChild();e;){f=e.nodeType;if(3===f){if(b=removeZeroWidthSpaceFromString(e.nodeValue),0<b.length)return!1}else if(1===f)if("BR"===e.nodeName){if(d++,1<d)return!1}else{if("SPAN"===e.nodeName&&!0===a.hasClass(e,
"dze_shape_main"))return!1;switch(e.nodeName){case "IMG":case "INPUT":case "BUTTON":case "IFRAME":case "TEXTAREA":return!1}if(this.isBlockNode(e))return!1}e=c.nextNode()}return!0}catch(g){dalert(g)}};this.findBr=function(a,b){try{if(!a)return null;var c=function(a){return 1!==a.nodeType||"BR"!==a.nodeName||g_objNodeUtil.isNodeInShape(a)?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT};c.acceptNode=c;var d=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,c,!1);if(!d)return null;var f=d.firstChild();
if(!0===b)for(a=null;a=d.nextNode();)f=a;return f}catch(e){dalert(e)}};this.findLastBr=function(a){return this.findBr(a,!0)};this.isLastBr=function(a,b){try{if(!a)return!1;if(!b)for(var c=a;c&&!this.isLoopBreakNode(c);){if(this.isBlockNode(c)){b=c;break}c=c.parentNode}if(!b)return!1;c=a;for(a=null;c&&c!==b&&!this.isLoopBreakNode(c);){if((a=c.nextSibling)&&(3!==a.nodeType||""!==a.nodeValue))return!1;c=c.parentNode}return!0}catch(d){dalert(d)}};this.isOffsetBetweenBr=function(a,b){try{if(!a||1!==a.nodeType)return!1;
var c=a.childNodes[b-1],d=a.childNodes[b];return c&&d?"BR"!==c.nodeName||"BR"!==d.nodeName||this.isLastBr(d)?!1:!0:!1}catch(f){dalert(f)}};this.insertBr=function(a,b,c){try{if(!a||!a.parentNode)return null;for(var d=g_objPropertyUtil,f=a,e=null;f&&f.firstChild;){for(e=f.firstChild;e;)if("SPAN"===e.nodeName&&d.hasClass(e,"dze_shape_main"))e=e.nextSibling;else break;if(!e||1!==e.nodeType||!this.isInlineNode(e)||!this.canSelectNodeContents(e))break;f=e}if(!f)return null;b||(b=a.ownerDocument.createElement("BR"));
!0===c&&f.firstChild?f.insertBefore(b,f.firstChild):f.appendChild(b);this.normalize(a);return b}catch(g){dalert(g)}};this.insertBrIntoBlankPara=function(a){return a&&a.parentNode&&this.isBlankPara(a)&&!this.findBr(a)?this.insertBr(a):null};this.removeEmptyNode=function(a,b){try{var c={bDeleted:!1,offsetNode:null,offset:0};if(!b||!b.parentNode)return c;if(!a)for(a=b;a&&!this.isBlockNode(a);)a=a.parentNode;if(!a||!a.parentNode)return c;for(var d=null;b&&!this.isBoundNode(b)&&b!==a&&!(3===b.nodeType&&
0<b.nodeValue.length)&&(1!==b.nodeType||"IMG"!==b.nodeName&&"BR"!==b.nodeName&&"HR"!==b.nodeName&&"VIDEO"!==b.nodeName)&&(1!==b.nodeType||!b.firstChild||"BR"===b.firstChild.nodeName&&b.firstChild===b.lastChild||3===b.firstChild.nodeType&&0===b.firstChild.nodeValue.length&&b.firstChild===b.lastChild);)c.bDeleted=!0,c.offsetNode=b.parentNode,c.offset=this.getChildIndex(b),d=b.parentNode,d.removeChild(b),b=d;return c}catch(f){dalert(f)}};this.getInnerText=function(a,b){try{if(!a)return"";var c="",d=
g_objTableOperation,f=a.lastChild;void 0===b&&(b=0);for(var e=a.firstChild,g=null;e;){g=e.nextSibling;var h="";"TABLE"===e.nodeName?h=d.tableToText(e):"OL"===e.nodeName||"UL"===e.nodeName?h=this.getInnerText(e,b+1):"LI"===e.nodeName?(h=this.getInnerText(e,b+1))&&e!==f&&this.isBlockNode(e)&&(h+="\n"):"BR"===e.nodeName&&e!==a.lastChild?h="\n":3===e.nodeType?h=e.nodeValue:(h=e.innerText)&&e!==f&&this.isBlockNode(e)&&(h+="\n");h&&(c+=h);e=g}return c}catch(k){dalert(k)}return""};this.isDocFirstNode=function(a){try{return a?
"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"oneffice_qrcode_first_container")?!0:!1:!1}catch(b){dalert(b)}};this.isDocLastNode=function(a){try{return a?"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"oneffice_qrcode_last_container")?!0:!1:!1}catch(b){dalert(b)}};this.getDocFirstNodes=function(){try{if(!parent)return null;var a=g_objPageControl.getPageMain(0);if(!a)return null;for(var b=g_objSplitUtil,c=[],d=a.firstChild;d&&this.isDocFirstNode(d);)c.push(d),d=b.getNextSibling(d);return c}catch(f){dalert(f)}};
this.getDocLastNodes=function(){try{if(!parent)return null;var a=g_objPageControl,b=a.getTotalPageCount(),c=a.getPageMain(b-1);if(!c)return null;a=g_objSplitUtil;b=[];for(var d=c.firstChild;d&&this.isDocLastNode(d);)b.push(d),d=a.getPreviousSibling(d);return b}catch(f){dalert(f)}};this.pullDocFirstNode=function(a){try{if(!a)return null;var b=a.ownerDocument.createDocumentFragment(),c=a.querySelectorAll("div.oneffice_qrcode_first_container");forEach(c,function(a,c){b.appendChild(c)},this);return b}catch(d){dalert(d)}};
this.pullDocLastNode=function(a){try{if(!a)return null;var b=a.ownerDocument.createDocumentFragment(),c=a.querySelectorAll("div.oneffice_qrcode_last_container");forEach(c,function(a,c){b.appendChild(c)},this);return b}catch(d){dalert(d)}};this.getParents=function(a,b){try{var c=[];for(a=a.parentNode;a&&"BODY"!==a.nodeName;){c.push(a);if(b&&b===a)break;a=a.parentNode}return c}catch(d){dalert(d)}};this.isAlive=function(a){try{if(!a)return!1;for(var b=a.parentNode;b&&"BODY"!==b.nodeName;)b=b.parentNode;
return b&&"BODY"===b.nodeName?!0:!1}catch(c){dalert(c)}}};
var insertUtil=function(){insertUtil.prototype.insertTableCodeAtSelection=function(a,b){try{var c=g_objEditorDocument[b].createRange().createContextualFragment(a);return c&&c.firstChild?this.insertTableAtSelection(c,b):!1}catch(d){dalert(d)}};insertUtil.prototype.insertTableAtSelection=function(a,b){try{if(!a)return null;11===a.nodeType&&a.firstChild===a.lastChild&&(a=a.firstChild);if(!1===g_objCaretUtil.isContentEditable(b))return null;var c=GetCurRange(b);if(!c)return null;for(var d=g_objNodeUtil,
f=!0,e=a;e;){if("TABLE"!==e.nodeName){f=!1;break}e=e.nextSibling}e=null;f&&(e=function(a){return d.checkTagName(a,"li","dt","dd")?!0:!1});var l=g_objEditorDocument[b];SelectionUtil.deleteSelection(b);c=GetCurRange(b);var h=d.getClosetBound(c.startContainer,e);if(!h)return null;var k=d.pullDocFirstNode(a),m=d.pullDocLastNode(a),g=l.createElement("span");c.insertNode(g);var n=d.findSplitPosition(g,h);n.parentNode.insertBefore(g,n);var t=g.previousSibling,u=g.nextSibling;d.splitOn(h,g);var q=g.previousSibling,
p=g.nextSibling;d.insertBrIntoBlankPara(q);d.insertBrIntoBlankPara(p);d.isBlankPara(q)||d.removeEmptyNode(q,t);"TABLE"===a.nodeName&&d.checkTagName(h,"li","dt","dd")&&(d.isBlankPara(p)||d.removeEmptyNode(p,u));g.parentNode.replaceChild(a,g);this.insertFirstLastNode(k,m,b);g_objCaretUtil.moveCaret(p,!1);return a}catch(r){dalert(r)}finally{c=null}};insertUtil.prototype.insertImgAtSelection=function(a,b){try{if(!a)return!1;if(!1===g_objCaretUtil.isContentEditable(b))return null;var c=GetCurRange(b);
if(!c)return null;var d=a;11===a.nodeType&&(d=a.childNodes[a.childNodes.length-1]);var f=g_objNodeUtil;SelectionUtil.deleteSelection(b);if(0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer())g_objSelectedShapesArray[g_objSelectedShapesArray.length-1].lastChild.firstChild.lastChild.appendChild(a);else{var e=g_objEditorDocument[b];c=GetCurRange(b);var l=f.getClosetBound(c.startContainer,function(a){return f.isBlockNode(a)});if(!l)return;var h=e.createElement("span");c.insertNode(h);
var k=h.previousSibling,m=h.nextSibling;f.splitOn(l,h);f.removeEmptyNode(null,k);f.removeEmptyNode(null,m);h.parentNode.replaceChild(a,h);g_objCaretUtil.moveCaret(d,!1,!1)}return!0}catch(g){dalert(g)}finally{c=null}};insertUtil.prototype.insertFirstLastNode=function(a,b,c){try{if(!(a||a.firstChild||b||b.firstChild))return!1;c=g_objNodeUtil;var d=g_objPageControl,f=function(a,b){return a.nodeName===b.nodeName&&a.className===b.className&&a.id===b.id?!0:!1};if(a&&a.firstChild){var e=d.getPageMain(0),
l=c.getDocFirstNodes(),h=l?l.length:0;if(0===h)e.firstChild?e.insertBefore(a,e.firstChild):e.appendChild(a);else{for(var k=a.firstChild,m=null;k;){m=k.nextSibling;for(var g=0;g<h;g++)if(f(l[g],k)){k.parentNode.removeChild(k);break}k=m}a.firstChild&&insertAfter(l[l.length-1],a)}}if(b&&b.firstChild)if(e=d.getPageMain(d.getTotalPageCount()-1),h=(l=c.getDocLastNodes())?l.length:0,0===h)e.appendChild(b);else{k=b.firstChild;for(m=null;k;){m=k.nextSibling;for(g=0;g<h;g++)if(f(l[g],k)){k.parentNode.removeChild(k);
break}k=m}b.firstChild&&e.appendChild(b)}return!0}catch(n){dalert(n)}};insertUtil.prototype.getNodePosition_For_PTag=function(a){try{for(var b=[],c=g_objPropertyUtil;;){if("body"==a.nodeName.toLowerCase()||c.element_hasClass(a,"dze_page_main"))return null;if("p"==a.nodeName.toLowerCase())break;var d=this.getNodePosition_previousSibling_For_PTag(a);b[b.length]=d;a=g_objNodeUtil.getParentElement(a);if(null==a)return null}return{paramNode:a,paramPos:b}}catch(f){dalert(f)}return null};insertUtil.prototype.getNodePosition_previousSibling_For_PTag=
function(a){try{for(var b=0;null!=a.previousSibling;)b++,a=a.previousSibling;return b}catch(c){dalert(c)}};insertUtil.prototype.insertLayerHTML=function(a,b){try{var c=null;if(b){if(c=g_objLayerKit.getLayerDocument(),null==c)return null}else c=document;var d=c.createElement("div");d.innerHTML=a.trim();1===d.childNodes.length&&(d=d.firstChild);c.body.appendChild(d);return d}catch(f){return dalert(f),null}};insertUtil.prototype.saveSelectionRange_IE=function(a,b){try{if(0==a)if(window.attachEvent){var c=
g_objEditorDocument[b]?g_objEditorDocument[b].selection:null;c&&(g_objLastRange[b]=c.createRange())}else g_bBrowserType_IE&&(c=g_objEditWindow[b]?g_objEditWindow[b].getSelection():null)&&1==c.rangeCount&&(g_objLastRange[b]=c.getRangeAt(0));else 1==a&&(window.attachEvent?(c=g_objEditorDocument[b]?g_objEditorDocument[b].selection:null)&&(g_objCurrentRange[b]=c.createRange()):g_bBrowserType_IE&&(c=g_objEditWindow[b]?g_objEditWindow[b].getSelection():null)&&1==c.rangeCount&&(g_objCurrentRange[b]=c.getRangeAt(0)))}catch(d){dalert(d)}};
insertUtil.prototype.activeSaveRangeFocus=function(a,b){try{if("undefined"!=typeof a){var c=null;if(0==a)c=g_objLastRange[b];else if(1==a)c=g_objCurrentRange[b];else return;window.attachEvent?g_objEditWindow[b].focus():g_objEditorDocument[b].body.focus();if(null!=c)if(window.attachEvent)c.select();else if(g_bBrowserType_IE){var d=g_objEditWindow[b].getSelection();d.removeAllRanges();d.addRange(c)}}}catch(f){dalert(f)}};insertUtil.prototype.dynamicLoad_CSS=function(a,b,c){try{"undefined"==typeof c&&
(c=function(){});var d=a.getElementsByTagName("head")[0],f=d.getElementsByTagName("link");for(a=0;a<f.length;a++)if(f[a].getAttribute("href")==b){c();return}var e=document.createElement("link");e.setAttribute("rel","stylesheet");e.setAttribute("type","text/css");e.setAttribute("href",b+"?ver="+objOnefficeLoader.getVer());e.onload=function(){c()};d.appendChild(e)}catch(l){dalert(l)}};insertUtil.prototype.dynamicLoad_JS=function(a,b){try{var c=a.getElementsByTagName("head")[0],d=c.getElementsByTagName("script");
for(a=0;a<d.length;a++)if(d[a].getAttribute("src")==b)return;var f=document.createElement("script");f.setAttribute("type","text/javascript");f.setAttribute("src",b+"?ver="+objOnefficeLoader.getVer());c.appendChild(f)}catch(e){dalert(e)}}},g_objInsertUtil=new insertUtil;
var g_objPropertyUtil=new function(){this.arrOpacityValue="0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9".split(" ");this.arrFilterValue="alpha(opacity=0) alpha(opacity=10) alpha(opacity=20) alpha(opacity=30) alpha(opacity=40) alpha(opacity=50) alpha(opacity=60) alpha(opacity=70) alpha(opacity=80) alpha(opacity=90)".split(" ");this.LEFT=0;this.TOP=1;this.RIGHT=2;this.BOTTOM=3;this.applyFilterOpacityStyle=function(a,b,c){try{!0!==fnObjectCheckNull(a)&&(b?g_bBrowserType_IE?(a.style.opacity=this.arrOpacityValue[c],
a.style.filter=window.attachEvent?this.arrFilterValue[c]:this.arrOpacityValue[c]):a.style.opacity=this.arrOpacityValue[c]:g_bBrowserType_IE?(a.style.opacity="",a.style.filter=""):a.style.opacity="")}catch(d){dalert(d)}};this.setFilterOpacityStyle=function(a,b){try{this.applyFilterOpacityStyle(a,b,3)}catch(c){dalert(c)}};this.setOpacity=function(a,b){try{"undefined"!=typeof a&&"undefined"!=typeof a.id&&(1===b?(a.style.opacity="",a.style.filter="",a.style.MozOpacity="",a.style.KhtmlOpacity="",""===
a.style.cssText&&a.removeAttribute("style")):(a.style.opacity=b,a.style.filter="alpha(opacity="+100*b+")",a.style.MozOpacity=b,a.style.KhtmlOpacity=b))}catch(c){dalert(c)}};this.element_hasClass=this.hasClass=function(a,b){try{if(!a||1!==a.nodeType)return!1;var c=a.className;if(!c||"string"!=typeof c)return!1;Array.isArray(b)||(b=[b]);var d=a.classList;if(d&&d.contains){for(var e=0,f=b.length;e<f;e++)if(b[e]&&d.contains(b[e]))return!0;return!1}var g=c.split(" ");e=0;for(f=g.length;e<f;e++){a=0;for(var h=
b.length;a<h;a++)if(b[a]&&b[a]===g[e])return!0}}catch(k){dalert(k)}return!1};this.element_addClass=this.addClass=function(a,b){try{var c=a.className;if(""!=c)for(var d=c.split(" "),e=0;e<d.length;e++)if(d[e]==b)return;a.className=""==c?b:c+" "+b}catch(f){dalert(f)}};this.element_removeClass=this.removeClass=function(a,b){try{var c="",d=!1,e=a.className;if(""!=e){var f=e.split(" ");for(e=0;e<f.length;e++)f[e]==b?d=!0:c=""==c?c+f[e]:c+(" "+f[e])}d&&(""==c?a.removeAttribute("class"):a.className=c)}catch(g){dalert(g)}};
this.element_replaceClass=this.replaceClass=function(a,b,c){try{var d="",e=a.className;if(""!=e){var f=e.split(" ");for(e=0;e<f.length;e++)d=f[e]==b?""==d?d+c:d+(" "+c):""==d?d+f[e]:d+(" "+f[e]);a.className=d}}catch(g){dalert(g)}};this.getElementStyleAttributeValue=function(a,b){try{if(!a)return"";var c="";if(g_bBrowserType_IE&&!fnObjectCheckNull(a.currentStyle))c=a.currentStyle.getAttribute(b);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)c=a.ownerDocument.defaultView.getComputedStyle(a,
null).getPropertyValue(b);return c=null==c?"":c.toLowerCase()}catch(d){dalert(d)}return""};this.setElementStyleAttributeValue=function(a,b,c){try{a.style.setProperty?a.style.setProperty(b,c,null):a.style.setAttribute(b,c)}catch(d){dalert(d)}};this.getElementBorderStyleAttributeSet=function(a,b){try{var c=[];c[0]=this.getElementStyleAttributeValue(a,"border-left-width",b);c[1]=this.getElementStyleAttributeValue(a,"border-left-style",b);c[2]=this.getElementStyleAttributeValue(a,"border-left-color",
b);c[3]=this.getElementStyleAttributeValue(a,"border-top-width",b);c[4]=this.getElementStyleAttributeValue(a,"border-top-style",b);c[5]=this.getElementStyleAttributeValue(a,"border-top-color",b);c[6]=this.getElementStyleAttributeValue(a,"border-right-width",b);c[7]=this.getElementStyleAttributeValue(a,"border-right-style",b);c[8]=this.getElementStyleAttributeValue(a,"border-right-color",b);c[9]=this.getElementStyleAttributeValue(a,"border-bottom-width",b);c[10]=this.getElementStyleAttributeValue(a,
"border-bottom-style",b);c[11]=this.getElementStyleAttributeValue(a,"border-bottom-color",b);this.checkElementBorderWidthByNickName(c[0])&&(c[0]="1px");this.checkElementBorderWidthByNickName(c[3])&&(c[3]="1px");this.checkElementBorderWidthByNickName(c[6])&&(c[6]="1px");this.checkElementBorderWidthByNickName(c[9])&&(c[9]="1px");return c}catch(d){dalert(d)}return null};this.checkElementBorderWidthByNickName=function(a){try{var b=a.toLowerCase();if("medium"==b||"thin"==b||"thick"==b||"initial"==b)return!0}catch(c){dalert(c)}return!1};
this.setElementBorderStyleAttributeSet=function(a,b){try{null!=b&&12==b.length&&(this.setElementStyleAttributeValue(a,"border-left-width",b[0]),this.setElementStyleAttributeValue(a,"border-left-style",b[1]),this.setElementStyleAttributeValue(a,"border-left-color",b[2]),this.setElementStyleAttributeValue(a,"border-top-width",b[3]),this.setElementStyleAttributeValue(a,"border-top-style",b[4]),this.setElementStyleAttributeValue(a,"border-top-color",b[5]),this.setElementStyleAttributeValue(a,"border-right-width",
b[6]),this.setElementStyleAttributeValue(a,"border-right-style",b[7]),this.setElementStyleAttributeValue(a,"border-right-color",b[8]),this.setElementStyleAttributeValue(a,"border-bottom-width",b[9]),this.setElementStyleAttributeValue(a,"border-bottom-style",b[10]),this.setElementStyleAttributeValue(a,"border-bottom-color",b[11]))}catch(c){dalert(c)}};this.getTargetCellFlag=function(a,b){try{var c=a.getAttribute(b);return null==c||""==c?null:parseInt(c)}catch(d){dalert(d)}};this.checkStyleValues=function(a,
b){try{a[0]=this.checkStyleFontValue(a[0]);a[1]=this.checkStyleFontSize(a[1]);a[4]=this.checkStyleLetterSpacingValue(a[4]);a[5]=this.checkStyleLineHeightValue(a[5],a[16]);if(1==a[11])for(var c=0;c<a[22].length;c++)a[22][c]=this.checkStyleFontValue(a[22][c]);if(1==a[12])for(c=0;c<a[23].length;c++)a[23][c]=this.checkStyleFontSize(a[23][c]);if(1==a[15])for(c=0;c<a[26].length;c++)a[26][c]=this.checkStyleLetterSpacingValue(a[26][c]);if(1==a[16])for(c=0;c<a[27].length;c++)a[27][c]=this.checkStyleLineHeightValue(a[27][c]);
if(1==a[16])for(c=0;c<a[27].length;c++)a[27][c]=this.checkStyleLineHeightValue(a[27][c])}catch(d){dalert(d)}};this.checkStyleLineHeightValue=function(a,b,c){try{if("undefined"==typeof a||null==a)a="";if("undefined"==typeof b||1!=b)b=!1;""==a?0==b&&""!=g_strBodyLineHeight&&(a=g_strBodyLineHeight):((0<=a.toLowerCase().indexOf("px")||0<=a.toLowerCase().indexOf("pt"))&&""!=g_strBodyLineHeight&&(a=g_strBodyLineHeight),0<=a.indexOf("%")&&(a=parseInt(a.replace(/%/g,""),10)/100),"string"!=typeof a&&(a=a.toString()),
a=a.replace(/[^0-9\.]/g,""));return a}catch(d){dalert(d)}return""};this.checkStyleFontValue=function(a){try{if("undefined"==typeof a||null==a)a="";return a}catch(b){return""}};this.checkStyleFontSize=function(a){try{if("undefined"==typeof a||null==a)a="";0<=a.indexOf("px")&&(a=g_objCommonUtil.convPxToPt(a),a=0>a?"":a+"pt");return a}catch(b){return""}};this.checkStyleLetterSpacingValue=function(a){try{if("string"!=typeof a)return a;a=a.toLowerCase();0<=a.indexOf("px")&&(a=g_objCommonUtil.convPxToPt(a),
a=0>a?"":a+"pt");return a}catch(b){return""}};this.getSelectionAttributeValue=function(a,b){try{if(-1==a)return null;var c=[];b="undefined"!=typeof b&&!0===b?33:11;var d=this.doGetSelectionAttributeValue(a),e=letterFunction.getInstance().getSavedStyle();if(d&&!1===fnObjectCheckNull(e)){var f=e.style,g=f.getPropertyValue("font-family");fnObjectCheckNull(g)||""===g||(g=g_objPropertyUtil.getElementStyleAttributeFisrtValue(g),d[0]=g);g=!1===fnObjectCheckNull(e.getAttribute("origin_font_size"))?e.getAttribute("origin_font_size")+
"pt":f.getPropertyValue("font-size");fnObjectCheckNull(g)||""===g||(d[1]=g);g=f.getPropertyValue("letter-spacing");fnObjectCheckNull(g)||""===g||(d[4]=g)}if(null==d){for(var h=0;h<b;h++)c[h]="";return c}for(h=0;h<b;h++)c[h]=d[h],null==c[h]&&(c[h]="");this.checkStyleValues(c,a);return c}catch(k){dalert(k)}};this.doGetSelectionAttributeValue=function(a){try{if(-1==a)return;var b=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];
if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[a].selection.type.toLowerCase())return;var c=g_objEditorDocument[a].selection,d=c.createRange(),e=d.parentElement();if(""==d.text){var f=this.checkTargetNodeName(e);return this.getNodeAttributeValueDetail(e,!0,f,a)}var g=!1,h=!1;"p"==e.nodeName.toLowerCase()&&(e=this.getSelectionParentNode(e,c,d));for(var k=0;k<e.childNodes.length;k++){var l=e.childNodes[k];if(ID_SELECTION_ELEMENT_NODE==l.nodeType&&ID_SELECTION_ELEMENT_NODE==l.nodeType){var n=
c.createRange();n.moveToElementText(l);n.collapse(!0);var u=c.createRange();u.moveToElementText(l);u.collapse(!1);var v=d.inRange(n),w=d.inRange(u);if(g)if(v){if(p=this.getNodeAttributeValue(l,b,a),!p)return null}else{h=!0;break}else if(w&&(g=!0),v||w){var p=this.getNodeAttributeValue(l,b,a);if(!p)return null}}}if(!g||!h){f=this.checkTargetNodeName(e);var m=this.getNodeAttributeValueDetail(e,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}return b}c=g_objEditWindow[a].getSelection();
if(1!=c.rangeCount)return;d=c.getRangeAt(0);n=!1;e=d.commonAncestorContainer;d.collapsed?n=!0:ID_SELECTION_TEXT_NODE==e.nodeType&&(n=!0);if(n)return ID_SELECTION_ELEMENT_NODE!=e.nodeType&&(e=g_objNodeUtil.getParentElement(e)),this.getNodeAttributeValueDetail(e,!0,!0,a);g=!1;h=g_objEditorDocument[a].createRange();var r=[];for(k=0;k<c.rangeCount;k++)g_objNodeUtil.traverseNodesInRange(c.getRangeAt(k),function(a){a&&a.nodeType==ID_SELECTION_TEXT_NODE&&r.push(a);return!0});r=[r[0]];for(k=0;k<r.length;k++){l=
r[k];if(void 0===l)return;h.selectNode(l);if(g)if(t=d.compareBoundaryPoints(Range.START_TO_END,h),0==t||-1==t)break;else if(ID_SELECTION_ELEMENT_NODE==l.nodeType){if(p=this.getNodeAttributeValue(l,b,a),!p)return null}else{if(ID_SELECTION_TEXT_NODE==l.nodeType)if(q=g_objNodeUtil.getParentElement(l),f=this.checkTargetNodeName(q),checkTextNodeAllWhiteCode(l.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(q,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,m,!1,f)}}else{m=this.getNodeAttributeValueDetail(q,
!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}}else{var t=d.compareBoundaryPoints(Range.END_TO_START,h);if(-1==t)if(g=!0,ID_SELECTION_ELEMENT_NODE==l.nodeType){if(p=this.getNodeAttributeValue(l,b,a),!p)return null}else if(ID_SELECTION_TEXT_NODE==l.nodeType){var q=g_objNodeUtil.getParentElement(l);f=this.checkTargetNodeName(q);if(checkTextNodeAllWhiteCode(l.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(q,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,
m,!1,f)}}else if(b=this.getNodeAttributeValueDetail(q,!0,f,a),null==b)return null}}}return b}catch(x){dalert(x)}finally{d=null}return null};this.getSelectionFirstStyleAttributeValue=function(a,b,c){try{void 0===c&&(c=!1);if(-1==a)return null;var d=[];b="undefined"!=typeof b&&!0===b?33:11;var e=this.doGetSelectionFirstStyleAttributeValue(a,c);if(null==e){for(var f=0;f<b;f++)d[f]="";return d}for(f=0;f<b;f++)d[f]=e[f],null==d[f]&&(d[f]="");dlog("arrAttrValue",e);this.checkStyleValues(d,a);return d}catch(g){dalert(g)}};
this.doGetSelectionFirstStyleAttributeValue=function(a,b){try{if(-1==a)return;b=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[a].selection.type.toLowerCase())return;var c=g_objEditorDocument[a].selection,d=c.createRange(),e=d.parentElement();if(""==d.text){var f=this.checkTargetNodeName(e);return this.getNodeAttributeValueDetail(e,!0,f,a)}var g=!1,h=!1;
"p"==e.nodeName.toLowerCase()&&(e=this.getSelectionParentNode(e,c,d));for(var k=0;k<e.childNodes.length;k++){var l=e.childNodes[k];if(ID_SELECTION_ELEMENT_NODE==l.nodeType&&ID_SELECTION_ELEMENT_NODE==l.nodeType){var n=c.createRange();n.moveToElementText(l);n.collapse(!0);var u=c.createRange();u.moveToElementText(l);u.collapse(!1);var v=d.inRange(n),w=d.inRange(u);if(g)if(v){if(p=this.getNodeAttributeValue(l,b,a),!p)return null}else{h=!0;break}else if(w&&(g=!0),v||w){var p=this.getNodeAttributeValue(l,
b,a);if(!p)return null}}}if(!g||!h){f=this.checkTargetNodeName(e);var m=this.getNodeAttributeValueDetail(e,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}return b}c=g_objEditWindow[a].getSelection();if(1!=c.rangeCount)return;d=c.getRangeAt(0);n=!1;e=d.startContainer;d.collapsed?n=!0:ID_SELECTION_TEXT_NODE==e.nodeType&&(n=!0);if(n)return ID_SELECTION_ELEMENT_NODE!=e.nodeType&&(e=g_objNodeUtil.getParentElement(e)),f=this.checkTargetNodeName(e),this.getNodeAttributeValueDetail(e,
!0,f,a);g=!1;h=g_objEditorDocument[a].createRange();var r=[];for(k=0;k<c.rangeCount;k++)g_objNodeUtil.traverseNodesInRange(c.getRangeAt(k),function(a){a&&a.nodeType==ID_SELECTION_TEXT_NODE&&r.push(a);return!0});r=[r[0]];for(k=0;k<r.length;k++)if(l=r[k],h.selectNode(l),g)if(t=d.compareBoundaryPoints(Range.START_TO_END,h),0==t||-1==t)break;else if(ID_SELECTION_ELEMENT_NODE==l.nodeType){if(p=this.getNodeAttributeValue(l,b,a),!p)return null}else{if(ID_SELECTION_TEXT_NODE==l.nodeType)if(q=g_objNodeUtil.getParentElement(l),
f=this.checkTargetNodeName(q),checkTextNodeAllWhiteCode(l.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(q,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,m,!1,f)}}else{m=this.getNodeAttributeValueDetail(q,!0,f,a);if(null==m)return null;this.checkCompareAttributeValue(b,m,!0,f)}}else{var t=d.compareBoundaryPoints(Range.END_TO_START,h);if(-1==t)if(g=!0,ID_SELECTION_ELEMENT_NODE==l.nodeType){if(p=this.getNodeAttributeValue(l,b,a),!p)return null}else if(ID_SELECTION_TEXT_NODE==l.nodeType){var q=
g_objNodeUtil.getParentElement(l);f=this.checkTargetNodeName(q);if(checkTextNodeAllWhiteCode(l.nodeValue)){if(f){m=this.getNodeAttributeValueDetail(q,!1,f,a);if(null==m)return!1;this.checkCompareAttributeValue(b,m,!1,f)}}else if(b=this.getNodeAttributeValueDetail(q,!0,f,a),null==b)return null}}return b}catch(x){dalert(x)}finally{d=null}return null};this.getSelectionParentNode=function(a,b,c){try{var d=b.createRange();d.moveToElementText(a);return d.inRange(c)?a:g_objNodeUtil.getParentElement(a)}catch(e){dalert(e)}};
this.getNodeAttributeValue=function(a,b,c){try{for(var d="",e=0;e<a.childNodes.length;e++){var f=a.childNodes[e];if(ID_SELECTION_ELEMENT_NODE==f.nodeType){if(!this.getNodeAttributeValue(f,b,c))return!1}else ID_SELECTION_TEXT_NODE==f.nodeType&&(d+=f.nodeValue)}if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var g=this.checkTargetNodeName(a);if(checkTextNodeAllWhiteCode(d)){if(g){var h=this.getNodeAttributeValueDetail(a,!1,g,c);if(null==h)return!1;this.checkCompareAttributeValue(b,h,!1,g)}return!0}h=this.getNodeAttributeValueDetail(a,
!0,g,c);if(null==h)return!1;this.checkCompareAttributeValue(b,h,!0,g)}return!0}catch(k){dalert(k)}return!1};this.checkCompareAttributeValue=function(a,b,c,d){try{for(var e=0;11>e;e++)"undefined"==typeof a[e+11+11]&&(a[e+11+11]=[]),a[e+11+11].push(b[e]),a[e+11]&&!0!==g_getSelectionAttribute_Absolute?a[e]="":null==a[e]?6>e?c&&(a[e]=b[e]):d&&(a[e]=b[e]):6>e?c&&a[e]!=b[e]&&(a[e]=!0!==g_getSelectionAttribute_Absolute?"":b[e],a[e+11]=!0):d&&a[e]!=b[e]&&(a[e]=!0!==g_getSelectionAttribute_Absolute?"":b[e],
a[e+11]=!0)}catch(f){dalert(f)}};this.getNodeAttributeValueDetail=function(a,b,c,d){try{var e=[null,null,null,null,null,null,null,null,null,null,null,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,[],[],[],[],[],[],[],[],[],[],[]];if("undefined"==typeof a||null==a||"undefined"==typeof a.style||null==a.style)return e;var f=a;if(c||b){var g=g_objNodeUtil.getClosetParagraph(a);g&&(f=g)}for(g=0;11>g;g++){var h="";if(DZE_TEXTATT_FONTNAME==g)b&&(h=a.style.fontFamily,""==h&&(h=this.getElementStyleAttributeValue(a,"font-family",
d),h=this.getElementStyleAttributeFisrtValue(h)));else if(DZE_TEXTATT_FONTSIZE==g)b&&(h=!1===fnObjectCheckNull(a.getAttribute("origin_font_size"))?a.getAttribute("origin_font_size")+"pt":a.style.fontSize,""==h&&(h=this.getElementStyleAttributeValue(a,"font-size",d)));else if(DZE_TEXTATT_FORECOLOR==g)b&&(h=a.style.color,""==h&&(h=this.getElementStyleAttributeValue(a,"color",d)),h=g_objCommonUtil.getHexColorCode(h));else if(DZE_TEXTATT_BACKCOLOR==g){if(b)try{h=a.style.backgroundColor;if(""==h)for(var k=
a,l=0;"undefined"!=typeof k&&null!=k&&"body"!=k.nodeName.toLowerCase();){if(("span"==k.nodeName.toLowerCase()||"p"==k.nodeName.toLowerCase())&&k.getAttribute("style")&&k.style.backgroundColor){h=k.style.backgroundColor;break}l++;if(10<l)break;k=k.parentNode}h=g_objCommonUtil.getHexColorCode(h)}catch(n){h=""}}else DZE_TEXTATT_LETTERSPACING==g?b&&(h=a.style.letterSpacing,""==h&&(h=this.getElementStyleAttributeValue(a,"letter-spacing",d))):DZE_PARAATT_LINEHEIGHT==g?b&&(h=f.style.lineHeight,""==h&&(h=
this.getElementStyleAttributeValue(f,"line-height",d)),h=this.getUnitlessLineHeight(h,this.getElementStyleAttributeValue(f,"font-size",d))):6==g?c&&(h=f.style.marginLeft):7==g?c&&(h=f.style.marginTop):8==g?c&&(h=f.style.marginRight):9==g?c&&(h=f.style.marginBottom):10==g&&c&&(h=f.style.textIndent);e[g]=h}return e}catch(n){dalert(n)}return null};this.getUnitlessLineHeight=function(a,b){try{var c=g_objCommonUtil;if("normal"===a||"initial"===a||"inherit"===a)return g_strBodyLineHeight;var d=c.extractNumberValueUnit(a,
!0);if(!d)return a;if("%"===d.strUnit)a=parseInt(d.nValue,10)/100;else if(""!==d.strUnit&&"em"!==d.strUnit&&b&&("px"===d.strUnit||"pt"===d.strUnit)){var e=c.toPx(b,null,!0),f=c.toPx(a,null,!0);e&&f&&(b=f/e,a=b=Math.round(100*b)/100)}return a+""}catch(g){dalert(g)}};this.getElementStyleAttributeFisrtValue=function(a){try{var b=a.split(",");if(0==b.length)return"";if(1==b.length)return a;var c=b[0].trim();return c=c.replace(/(")/g,"")}catch(d){dalert(d)}};this.checkTargetNodeName=function(a){try{var b=
this.checkNodeName(a,"p");b||(b=this.checkNodeName(a,"h1"));b||(b=this.checkNodeName(a,"h2"));b||(b=this.checkNodeName(a,"h3"));b||(b=this.checkNodeName(a,"h4"));b||(b=this.checkNodeName(a,"h5"));b||(b=this.checkNodeName(a,"h6"));return b}catch(c){dalert(c)}return!1};this.checkNodeName=function(a,b){try{b=b.toLowerCase();var c=g_objNodeUtil.getElementTagName(a).toLowerCase();if(b==c)return!0}catch(d){dalert(d)}return!1};this.removeStyleAttribute=function(a,b){try{a.style.removeAttribute?a.style.removeAttribute(b):
a.style.removeProperty&&a.style.removeProperty(b)}catch(c){dalert(c)}};this.getBackgroundImageURL=function(a){try{var b=a.style.backgroundImage;""!=b&&(a=b,a.toLowerCase(),-1!=a.indexOf("url(")&&(b=a.substring(4,a.length-1)));'"'==b[0]&&'"'==b[b.length-1]&&(b=b.substring(1,b.length-1));return b}catch(c){dalert(c)}return""};this.getElement_BorderWidth_With_Unit=function(a,b){try{var c="";"left"==b?c=a.style.borderLeftWidth:"top"==b?c=a.style.borderTopWidth:"right"==b?c=a.style.borderRightWidth:"bottom"==
b&&(c=a.style.borderBottomWidth);return""==c||null==c||ID_STRING_NAME_UNDEFINED==c?{nValue:0,strUnit:""}:this.checkElementBorderWidthByNickName(c)?{nValue:1,strUnit:"px"}:g_objCommonUtil.extractNumberValueUnit(c)}catch(d){dalert(d)}return null};this.getStyleBorderWidth=function(a,b){try{if(!a)return"";switch(b){case DZE_DIR.LEFT:return a.style.borderLeftWidth;case DZE_DIR.TOP:return a.style.borderTopWidth;case DZE_DIR.RIGHT:return a.style.borderRightWidth;case DZE_DIR.BOTTOM:return a.style.borderBottomWidth;
default:return""}}catch(c){dalert(c)}};this.setElement_BorderLeftColor=function(a,b){try{"-1"==b||""==b?(a.style.borderLeftColor="",a.style.removeAttribute?a.style.removeAttribute("borderLeftColor"):a.style.removeProperty&&a.style.removeProperty("borderLeftColor")):a.style.borderLeftColor=b}catch(c){dalert(c)}};this.setElement_BorderTopColor=function(a,b){try{"-1"==b||""==b?(a.style.borderTopColor="",a.style.removeAttribute?a.style.removeAttribute("borderTopColor"):a.style.removeProperty&&a.style.removeProperty("borderTopColor")):
a.style.borderTopColor=b}catch(c){dalert(c)}};this.setElement_BorderRightColor=function(a,b){try{"-1"==b||""==b?(a.style.borderRightColor="",a.style.removeAttribute?a.style.removeAttribute("borderRightColor"):a.style.removeProperty&&a.style.removeProperty("borderRightColor")):a.style.borderRightColor=b}catch(c){dalert(c)}};this.setElement_BorderBottomColor=function(a,b){try{"-1"==b||""==b?(a.style.borderBottomColor="",a.style.removeAttribute?a.style.removeAttribute("borderBottomColor"):a.style.removeProperty&&
a.style.removeProperty("borderBottomColor")):a.style.borderBottomColor=b}catch(c){dalert(c)}};this.setElement_BorderStyle=function(a,b,c){try{fnObjectCheckNull(b)&&(b=""),"left"==c?a.style.borderLeftStyle=b:"top"==c?a.style.borderTopStyle=b:"right"==c?a.style.borderRightStyle=b:"bottom"==c&&(a.style.borderBottomStyle=b)}catch(d){dalert(d)}};this.setBorder=function(a,b,c){try{switch(c){case this.LEFT:a.style.borderLeft=b;break;case this.TOP:a.style.borderTop=b;break;case this.RIGHT:a.style.borderRight=
b;break;case this.BOTTOM:a.style.borderBottom=b;break;default:return!1}return!0}catch(d){dalert(d)}};this.getBorder=function(a,b){try{switch(b){case this.LEFT:return a.style.borderLeft;case this.TOP:return a.style.borderTop;case this.RIGHT:return a.style.borderRight;case this.BOTTOM:return a.style.borderBottom}return""}catch(c){dalert(c)}};this.getPadding=function(a,b){try{if(!a||a.nodeType!=ID_SELECTION_ELEMENT_NODE)return 0;var c=g_objCommonUtil,d=this.LEFT,e=this.BOTTOM,f=[];"undefined"!=typeof b&&
(e=d=b);for(b=d;b<=e;b++){d="";switch(b){case this.LEFT:d=a.style.paddingLeft;break;case this.TOP:d=a.style.paddingTop;break;case this.RIGHT:d=a.style.paddingRight;break;case this.BOTTOM:d=a.style.paddingBottom}var g=c.extractNumberValueUnit(d),h=g?c.convToPx(g.nValue,g.strUnit):0;f.push(parseFloat(h.toFixed(2)))}return 1==f.length?f[0]:f}catch(k){dalert(k)}};this.getMargin=function(a,b){try{if(!a||1!==a.nodeType)return 0;var c=g_objCommonUtil,d=this.LEFT,e=this.BOTTOM,f=[];"undefined"!==typeof b&&
(e=d=b);for(b=d;b<=e;b++){d="";switch(b){case this.LEFT:d=a.style.marginLeft;break;case this.TOP:d=a.style.marginTop;break;case this.RIGHT:d=a.style.marginRight;break;case this.BOTTOM:d=a.style.marginBottom}var g=c.extractNumberValueUnit(d),h=g?c.convToPx(g.nValue,g.strUnit):0;f.push(parseFloat(h.toFixed(2)))}return 1==f.length?f[0]:f}catch(k){dalert(k)}};this.getStyleStringByOption=function(a,b,c){try{var d=a.getAttribute("style");d=d.trim();var e=d.split(";");for(a=0;a<e.length;a++)if(""==e[a])e.splice(a,
1),a--;else{var f=e[a].split(":");if(2==f.length){var g=f[0].trim().toLowerCase();b&&"width"==g?(e.splice(a,1),a--):c&&"height"==g&&(e.splice(a,1),a--)}else e.splice(a,1),a--}b="";for(a=0;a<e.length;a++)b+=e[a],b+=";";return b}catch(h){dalert(h)}return""};this.getTextContent=function(a){try{var b="";a.innerText?b=a.innerText:a.textContent&&(b=a.textContent);return b}catch(c){dalert(c)}return""};this.setSkinColorSet=function(a,b){try{g_arrSkinColor=dzeUiConfig.arrSkinColorSet[a],"undefined"!=typeof g_arrSkinColor&&
(dzeEnvConfig.skinColor=a,"undefined"==typeof b&&(b=document),changeCss(".dze_ribbon_menu_title_bg","background-color",g_arrSkinColor.button_BG,b),changeCss(".duzon_menubar_title_over","background-color",g_arrSkinColor.button_BG,b),changeCss(".duzon_menubar_title_down","background-color",g_arrSkinColor.button_BG,b),changeCss(".duzon_menubar_title_up","background-color",g_arrSkinColor.button_BG,b),changeCss(".duzon_dialog_title_container","background-color",g_arrSkinColor.button_BG,b),changeCss(".duzon_dialog_btn_ok_normal",
"background-color",g_arrSkinColor.button_BG+" !important",b),changeCss(".duzon_toastmsg_box","background-color",g_arrSkinColor.button_BG,b),changeCss(".duzon_dialog_btn_ok_up","background-color",g_arrSkinColor.buttonUp_BG+" !important",b),changeCss(".duzon_dialog_btn_ok_down","background-color",g_arrSkinColor.buttonDown_BG+" !important",b),changeCss(".twodepth_menu_list_over","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_btn_comboboxitem_over","background-color",g_arrSkinColor.toolbarOver_BG,
b),changeCss(".duzon_btn_comboboxitem_down","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_button_over","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_button_up","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_dropdown_over","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_dropdown_up","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_dropdown_arrow_over","background-color",
g_arrSkinColor.toolbarOver_BG,b),changeCss(".dze_extdlg_table_create_td_over","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_button_over_ribbon","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_button_up_ribbon","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_dropdown_over_ribbon","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_dropdown_up_ribbon","background-color",g_arrSkinColor.toolbarOver_BG,b),
changeCss(".duzon_tb_dropdown_arrow_over_ribbon","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_dropdown_arrow_down_ribbon","background-color",g_arrSkinColor.toolbarOver_BG,b),changeCss(".duzon_tb_button_over","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_button_up","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_dropdown_over","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_dropdown_up","border-color",g_arrSkinColor.toolbarOver_BOR,
b),changeCss(".duzon_tb_button_over_ribbon","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_button_up_ribbon","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_dropdown_over_ribbon","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_dropdown_up_ribbon","border-color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".dze_ribbon_menu_off_over","color",g_arrSkinColor.toolbarOver_BOR,b),changeCss(".duzon_tb_button_down","background-color",g_arrSkinColor.toolbarDown_BG,
b),changeCss(".duzon_tb_dropdown_down","background-color",g_arrSkinColor.toolbarDown_BG,b),changeCss(".duzon_tb_dropdown_arrow_down","background-color",g_arrSkinColor.toolbarDown_BG,b),changeCss(".duzon_tb_button_down_ribbon","background-color",g_arrSkinColor.toolbarDown_BG,b),changeCss(".duzon_tb_dropdown_down_ribbon","background-color",g_arrSkinColor.toolbarDown_BG,b),changeCss(".duzon_tb_dropdown_arrow_down_ribbon","background-color",g_arrSkinColor.toolbarDown_BG,b),changeCss(".duzon_tb_button_down",
"border-color",g_arrSkinColor.toolbarDown_BOR,b),changeCss(".duzon_tb_dropdown_down","border-color",g_arrSkinColor.toolbarDown_BOR,b),changeCss(".duzon_tb_button_down_ribbon","border-color",g_arrSkinColor.toolbarDown_BOR,b),changeCss(".duzon_tb_dropdown_down_ribbon","border-color",g_arrSkinColor.toolbarDown_BOR,b),changeCss(".dze_extdlg_general_btn_over","background-color",g_arrSkinColor.itemOver_BG,b),changeCss(".dze_ui_toggle_btn_over","background-color",g_arrSkinColor.itemOver_BG,b),changeCss(".dze_ui_toggle_btn_down",
"background-color",g_arrSkinColor.itemOver_BG,b))}catch(c){dalert(c)}};this.getStyleWidth=function(a){try{if(!a)return 0;var b=g_objCommonUtil,c=b.extractNumberValueUnit(a.style.width||a.width),d=c?b.convToPx(c.nValue,c.strUnit,a):0;return parseFloat(d.toFixed(2))}catch(e){dalert(e)}};this.getStyleHeight=function(a){try{if(!a)return 0;var b=g_objCommonUtil,c=b.extractNumberValueUnit(a.style.height||a.height),d=c?b.convToPx(c.nValue,c.strUnit,a):0;return parseFloat(d.toFixed(2))}catch(e){dalert(e)}}};
var g_objPositionUtil=new function(){this.getNodeElementPosition=function(a){try{var b=this.getElementPosition(a,!1);if(dzeEnvConfig.iFrameLayer){var c=this.getElementPosition(window.frameElement,!0);b.left+=c.left;b.top+=c.top;b.right+=c.left;b.bottom+=c.top}return b}catch(d){dalert(d)}return{left:0,top:0,right:0,bottom:0}};this.getElementPosition=function(a,b){try{var c={left:0,top:0,right:0,bottom:0},d=this.getDocumentScrollPosition(b),f=d.nScrollLeft,e=d.nScrollTop,g=a.getBoundingClientRect();
c.left=parseInt(g.left+f);c.top=parseInt(g.top+e);c.right=parseInt(g.right+f);c.bottom=parseInt(g.bottom+e);return c}catch(h){dalert(h)}return{left:0,top:0,right:0,bottom:0}};this.getOuterRect=function(a){try{if(a&&g_objCommonUtil.IS_VALID_VALUE(a.offsetWidth)&&g_objCommonUtil.IS_VALID_VALUE(a.offsetHeight))return{left:this.getLeft(a),top:this.getTop(a),width:a.offsetWidth,height:a.offsetHeight};if(a&&a.nodeName==DZE_TAG_SVG){var b=a.width.baseVal,c=b.unitType==SVGLength.SVG_LENGTHTYPE_PERCENTAGE?
a.clientWidth*b.valueInSpecifiedUnits/100:b.value;b=a.height.baseVal;return{left:a.x.baseVal.value,top:a.y.baseVal.value,width:c,height:b.unitType==SVGLength.SVG_LENGTHTYPE_PERCENTAGE?a.clientHeight*b.valueInSpecifiedUnits/100:b.value}}return null}catch(d){dalert(d)}};this.getFrameClientRect=function(){try{var a=this.getEmptyRect();if(dzeEnvConfig.iFrameLayer){var b=window.frameElement;b&&(a=this.domRectToRect(b.getBoundingClientRect()));var c=window.parent,d=c?c.document:null;if(d&&c!==window){b=
null;var f=(((b=d.documentElement)||(b=d.body.parentNode))&&"number"==typeof b.scrollLeft?b:d.body).scrollLeft,e=(((b=d.documentElement)||(b=d.body.parentNode))&&"number"==typeof b.scrollTop?b:d.body).scrollTop;this.moveRect(a,f,e)}}return a}catch(g){dalert(g)}};this.getLeft=function(a){try{if(null==a)return 0;var b=a.offsetLeft;return g_objCommonUtil.IS_VALID_VALUE(b)?b+this.getInnerLeft(a.offsetParent):0}catch(c){dalert(c)}};this.getInnerLeft=function(a){try{if(null==a)return 0;if(g_bDocType_XHTML){if(a==
document.documentElement)return 0}else if(a==document.body)return 0;return this.getLeft(a)+this.getBorderLeft(a)}catch(b){dalert(b)}};this.getBorderLeft=function(a){try{return g_bBrowserType_IE?a.clientLeft:parseInt(window.getComputedStyle(a,null).getPropertyValue("border-left-width"))}catch(b){dalert(b)}};this.getTop=function(a){try{if(null==a)return 0;var b=a.offsetTop;return g_objCommonUtil.IS_VALID_VALUE(b)?b+this.getInnerTop(a.offsetParent):0}catch(c){dalert(c)}};this.getInnerTop=function(a){try{if(null==
a)return 0;if(g_bDocType_XHTML){if(a==document.documentElement)return 0}else if(a==document.body)return 0;return this.getTop(a)+this.getBorderTop(a)}catch(b){dalert(b)}};this.getInnerWidth=function(a){try{var b=a.offsetWidth,c=g_objPropertyUtil,d=c.getPadding(a,c.LEFT)+c.getPadding(a,c.RIGHT);b-=d;if(g_objNodeUtil.isCell(a)){var f=g_objNodeUtil.getLoopParentElement(a,"table");if(f&&f.cellPadding){var e=g_objCommonUtil.extractNumberValueUnit(f.cellPadding);a=0;e&&(a=g_objCommonUtil.convToPx(e.nValue,
e.strUnit),isNaN(a)||(b-=2*parseFloat(f.cellPadding)))}}return b}catch(g){dalert(g)}};this.getBorderTop=function(a){try{return g_bBrowserType_IE?a.clientTop:parseInt(window.getComputedStyle(a,null).getPropertyValue("border-top-width"))}catch(b){dalert(b)}};this.domRectToRect=function(a){return this.createRect(a.left,a.top,a.width,a.height)};this.createRect=function(a,b,c,d){try{var f={};f.left=a;f.top=b;f.width=c;f.height=d;f.right=a+c;f.bottom=b+d;f.x=a;f.y=b;return f}catch(e){dalert(e)}};this.getEmptyRect=
function(){return{left:0,right:0,top:0,bottom:0,x:0,y:0,width:0,height:0}};this.moveRect=function(a,b,c){if(!a)return null;a.left+=b;a.right+=b;a.top+=c;a.bottom+=c;return a};this.equalRect=function(a,b){return a&&b?a.left===b.left&&a.top===b.top&&a.right===b.right&&a.bottom===b.bottom&&a.width===b.width&&a.height===b.height?!0:!1:!1};this.isEmptyRect=function(a){return!a||a.left===a.right&&a.top===a.bottom?!0:!1};this.dist=function(a,b,c,d){a=a>c?a-c:c-a;b=b>d?b-d:d-b;return Math.sqrt(a*a+b*b)};
this.clientRectToOffsetRect=function(a){try{var b=g_objZoom.getDocZoomValue()/100,c=this.domRectToRect(a);c.left/=b;c.top/=b;c.width/=b;c.height/=b;c.right=c.left+c.width;c.bottom=c.top+c.height;c.x=c.left;c.y=c.top;return c}catch(d){dalert(d)}};this.getTextNodeRect=function(a,b,c){try{var d={left:0,top:0,right:0,bottom:0,width:0,height:0,x:0,y:0},f=null;if(!a||""===a.nodeValue)return d;var e=a.parentNode,g=a.ownerDocument;if(!e||!g)return d;f=g.createRange();f.selectNodeContents(a);var h=a.nodeValue.length;
!fnObjectCheckNull(b)&&0<=b&&b<h&&f.setStart(a,b);!fnObjectCheckNull(c)&&0<=c&&c<=h&&f.setEnd(a,c);var k=f.getBoundingClientRect(),l=e.getBoundingClientRect();k=this.clientRectToOffsetRect(k);l=this.clientRectToOffsetRect(l);d.left=k.left-l.left+this.getPageLeft(e);d.top=k.top-l.top+this.getPageTop(e);d.width=k.width;d.height=k.height;d.right=d.left+d.width;d.bottom=d.top+d.height;d.x=d.left;d.y=d.y;return d}catch(m){dalert(m)}finally{}};this.getCharRect=function(a){try{var b=[];this.forEachCharRect(a,
function(a,d){b.push(d)});return b}catch(c){dalert(c)}};this.forEachCharRect=function(a,b,c,d){try{if(!a||!b||3!==a.nodeType&&(1!==a.nodeType||"BR"!==a.nodeName))return null;c=!1===c?!1:!0;var f=a.parentNode.ownerDocument.createRange(),e=null;if(3===a.nodeType){var g=a.nodeValue.length;for(void 0===d&&(d=c?0:g-1);c?d<g:0<=d;c?d++:d--)f.setStart(a,d),f.setEnd(a,d+1),e=f.getBoundingClientRect(),b(d,e)}else f.selectNode(a),e=f.getBoundingClientRect(),b(0,e)}catch(h){h!==BreakException&&dalert(h)}finally{}};
this.getBrNodeRect=function(a,b){try{if(!a)return 0;var c=g_objPageControl;c&&c.saveCaret&&c.saveCaret();var d=a.ownerDocument.createElement("span");c=0;a.parentNode.replaceChild(d,a);d.innerHTML="&#8203;";switch(b){case "left":case "right":c=this.getPageLeft(d);break;case "top":c=this.getPageTop(d);break;default:c=this.getPageTop(d)+d.offsetHeight}d.parentNode.replaceChild(a,d);return c}catch(f){dalert(f)}};this.getPageLeft=function(a){try{if(!a)return 0;if(3===a.nodeType)return this.getTextNodeRect(a).left;
if("BR"===a.nodeName)return this.getBrNodeRect(a,"left");var b=g_objCommonUtil,c=g_objPropertyUtil,d=a.offsetLeft;if(!b.IS_VALID_VALUE(d))return 0;for(var f=a.offsetParent;f&&!c.hasClass(f,"dze_page_container");){var e=f.offsetLeft;b.IS_VALID_VALUE(e)||(e=0);d+=e;f=f.offsetParent}return d}catch(g){dalert(g)}};this.getPageTop=function(a){try{if(!a)return 0;if(3===a.nodeType)return this.getTextNodeRect(a).top;if("BR"===a.nodeName)return this.getBrNodeRect(a,"top");var b=g_objCommonUtil,c=g_objPropertyUtil,
d=a.offsetTop;if(!b.IS_VALID_VALUE(d))return 0;for(var f=a.offsetParent;f&&!c.hasClass(f,"dze_page_container");){var e=f.offsetTop;b.IS_VALID_VALUE(e)||(e=0);d+=e;f=f.offsetParent}return d}catch(g){dalert(g)}};this.getPageBottom=function(a){try{if(!a)return 0;if(3===a.nodeType)return this.getTextNodeRect(a).bottom;if("BR"===a.nodeName)return this.getBrNodeRect(a,"bottom");var b=a.offsetHeight;g_objCommonUtil.IS_VALID_VALUE(b)||(b=0);return this.getPageTop(a)+b}catch(c){dalert(c)}};this.getPageRight=
function(a){try{if(!a)return 0;if(3===a.nodeType)return this.getTextNodeRect(objNode).right;if("BR"===a.nodeName)return this.getBrNodeRect(a,"right");var b=a.offsetWidth;g_objCommonUtil.IS_VALID_VALUE(b)||(b=0);return this.getPageLeft(a)+b}catch(c){dalert(c)}};this.getPageRect=function(a,b){try{var c={left:0,top:0,right:0,bottom:0};b&&(c=g_objNodeUtil.getMargin(a));var d=this;return{left:function(){return d.getPageLeft(a)-c.left},top:function(){return d.getPageTop(a)-c.top},right:function(){return d.getPageRight(a)+
c.right},bottom:function(){return d.getPageBottom(a)+c.bottom}}}catch(f){dalert(f)}};this.getDocumentTop=function(a){try{if(!a||1!==a.nodeType)return 0;var b=g_objCommonUtil,c=g_objPropertyUtil,d=a.offsetTop;if(!b.IS_VALID_VALUE(d))return 0;for(var f=a.offsetParent;f&&"dze_document_container"!==f.id&&!c.element_hasClass(f,"dze_document_main_container");){var e=f.offsetTop;b.IS_VALID_VALUE(e)||(e=0);d+=e;f=f.offsetParent}return d}catch(g){dalert(g)}};this.getDocumentLeft=function(a){try{if(!a||1!==
a.nodeType)return 0;var b=g_objCommonUtil,c=g_objPropertyUtil,d=a.offsetLeft;if(!b.IS_VALID_VALUE(d))return 0;var f=a.offsetParent;for(a=0;f&&"dze_document_container"!==f.id&&!c.element_hasClass(f,"dze_document_main_container");)a=f.offsetLeft,b.IS_VALID_VALUE(a)||(a=0),d+=a,f=f.offsetParent;return d}catch(e){dalert(e)}};this.getDocumentScrollPosition=function(a){try{var b=this.getDocumentElementObject(a);(a=b)&&b.ownerDocument&&b.ownerDocument.scrollingElement&&(a=b.ownerDocument.scrollingElement);
if(a)return{nScrollLeft:a.scrollLeft,nScrollTop:a.scrollTop}}catch(c){dalert(c)}return{nScrollLeft:0,nScrollTop:0}};this.getDocumentElementObject=function(a){try{if(a){if(g_bBrowserType_IE||g_bBrowserType_FF||g_bBrowserType_OP)return g_bDocType_XHTML?window.parent.document.documentElement:window.parent.document.body;if(g_bBrowserType_WK)return window.parent.document.body}else{if(g_bBrowserType_IE||g_bBrowserType_FF||g_bBrowserType_OP)return g_bDocType_XHTML?document.documentElement:document.body;
if(g_bBrowserType_WK)return document.body}}catch(b){dalert(b)}return null};this.getEditorDocumentType=function(a){try{return!(null==g_objEditorDocument[a].compatMode||"CSS1Compat"!=g_objEditorDocument[a].compatMode)}catch(b){dalert(b)}};this.getElementPosClientRect=function(a){try{var b={left:0,top:0,right:0,bottom:0};if(!a||1!==a.nodeType)return b;var c=a.getBoundingClientRect();b.left=parseInt(c.left);b.top=parseInt(c.top);b.right=parseInt(c.right);b.bottom=parseInt(c.bottom);b.width=parseInt(c.width);
b.height=parseInt(c.height);return b}catch(d){dalert(d)}return{left:0,top:0,right:0,bottom:0}};this.getOuterRectByClientWidthHeight=function(a){try{return g_objCommonUtil.IS_VALID_VALUE(a.clientWidth)&&g_objCommonUtil.IS_VALID_VALUE(a.clientHeight)?a.nodeName==DZE_TAG_SVG?{left:a.x.baseVal.value,top:a.y.baseVal.value,width:a.clientWidth,height:a.clientHeight}:{left:this.getLeft(a),top:this.getTop(a),width:a.clientWidth,height:a.clientHeight}:{left:0,top:0,width:0,height:0}}catch(b){dalert(b)}};this.getElementPosInEditArea=
function(a){try{var b={left:0,top:0,right:0,bottom:0};if(g_bBrowserType_IE){var c=a.getBoundingClientRect();b.left=parseInt(c.left);b.top=parseInt(c.top);b.right=parseInt(c.right);b.bottom=parseInt(c.bottom)}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){var d=this.getOuterRectByClientWidthHeight(a);b.left=parseInt(d.left);b.top=parseInt(d.top);b.right=parseInt(d.left)+parseInt(d.width);b.bottom=parseInt(d.top)+parseInt(d.height)}return b}catch(f){dalert(f)}return{left:0,top:0,right:0,
bottom:0}};this.getElementPosInEditAreaWithScrollPos=function(a,b){try{var c=this.getEditorDocumentType(b),d=0,f=0;g_bBrowserType_IE&&(c?(d=g_objEditorDocument[b].documentElement.scrollLeft,f=g_objEditorDocument[b].documentElement.scrollTop):(d=g_objEditorDocument[b].body.scrollLeft,f=g_objEditorDocument[b].body.scrollTop));var e=this.getElementPosInEditArea_ByOffset(a);e.left+=d;e.top+=f;e.right+=d;e.bottom+=f;e.left=parseInt(e.left);e.top=parseInt(e.top);e.right=parseInt(e.right);e.bottom=parseInt(e.bottom);
e.width=e.right-e.left;e.height=e.bottom-e.top;return e}catch(g){dalert(g)}return null};this.getElementPosInEditArea_ByOffset=function(a){try{var b={left:0,top:0,right:0,bottom:0},c=this.getOuterRect(a);c&&(b.left=c.left,b.top=c.top,b.right=c.left+c.width,b.bottom=c.top+c.height);return b}catch(d){dalert(d)}return{left:0,top:0,right:0,bottom:0}};this.GetDocumentClientPos_XY=function(a){try{var b=this.getDocumentElementObject(!1);if(b&&a){if("touchstart"===a.type||"touchmove"===a.type||"touchend"===
a.type){var c=a.touches;return{nPos_X:c[0].clientX+b.scrollLeft,nPos_Y:c[0].clientY+b.scrollTop}}return{nPos_X:a.clientX+b.scrollLeft,nPos_Y:a.clientY+b.scrollTop}}}catch(d){dalert(d)}return{nPos_X:0,nPos_Y:0}};this.GetDocumentClientPos_XY_iFrameLayer=function(a){try{if(!dzeEnvConfig.iFrameLayer)return;var b=this.getDocumentElementObject(!0);if(b){if(g_bBrowserType_IE)return{nPos_X:window.parent.event.clientX+b.scrollLeft,nPos_Y:window.parent.event.clientY+b.scrollTop};if(g_bBrowserType_FF||g_bBrowserType_WK||
g_bBrowserType_OP)return{nPos_X:a.clientX+b.scrollLeft,nPos_Y:a.clientY+b.scrollTop}}}catch(c){dalert(c)}return{nPos_X:0,nPos_Y:0}};this.getDocumentClientSize=function(a){try{var b=this.getDocumentElementObject(!1);if(b)return{nClientWidth:b.clientWidth,nClientHeight:b.clientHeight}}catch(c){dalert(c)}return{nClientWidth:0,nClientHeight:0}};this.getLayerNodeElementPosition=function(a){try{var b=this.getLayerElementPosition(a,!1);if(dzeEnvConfig.iFrameLayer){var c=this.getLayerElementPosition(window.frameElement,
!0);b.left+=c.left;b.top+=c.top;b.right+=c.left;b.bottom+=c.top}return b}catch(d){dalert(d)}return{left:0,top:0,right:0,bottom:0}};this.getLayerElementPosition=function(a,b){try{b={left:0,top:0,right:0,bottom:0};var c=this.getOuterRect(a);b.left=parseInt(c.left);b.top=parseInt(c.top);b.right=parseInt(c.left)+parseInt(c.width);b.bottom=parseInt(c.top)+parseInt(c.height);return b}catch(d){dalert(d)}return{left:0,top:0,right:0,bottom:0}};this.getOverlapRange=function(a,b,c,d){a=Math.max(a,c);b=Math.min(b,
d);return a<b?b-a:0};this.isOverlap=function(a,b,c,d){try{return Math.max(a,c)<=Math.min(b,d)?!0:!1}catch(f){dalert(f)}};this.arrangeObjectPosition=function(a,b){try{for(var c,d,f=0;f<a.childNodes.length;f++)d=a.childNodes[f],d.nodeType===ID_SELECTION_ELEMENT_NODE&&"absolute"===d.style.position&&(c=parseFloat(d.style.left),d.style.left=c-b)}catch(e){dalert(e)}};this.getActiveWinSize=function(){try{var a=oneffice.isLoadEditor(),b=a?g_objLayerKit.getLayerWindow():window,c=a?g_objLayerKit.getLayerDocument():
document;a={};a.scrollX=c.documentElement.scrollLeft?c.documentElement.scrollLeft:c.body.scrollLeft;a.scrollY=c.documentElement.scrollTop?c.documentElement.scrollTop:c.body.scrollTop;b.innerWidth?(a.view_window_width=b.innerWidth,a.view_window_height=b.innerHeight):(a.view_window_width=c.documentElement.clientWidth,a.view_window_height=c.documentElement.clientHeight);return a}catch(d){return dalert(d),{}}};this.setObjectPosition=function(a,b,c){try{var d=oneffice.isLoadEditor(),f=d?g_objLayerKit.getLayerWindow():
window,e=d?g_objLayerKit.getLayerDocument():document;c||(c="screen_center");if("center"!=c||"mobile"!=c)a?0>=a.offsetX&&0>=a.offsetY&&(c="screen_center"):c="screen_center";g_objPositionUtil.setScrollPosition(a,b,c);dlog("g_objPositionUtil.clkX+:"+cmnDlg.m_nClkX);dlog("g_objPositionUtil.clkY+:"+cmnDlg.m_nClkY);dlog("g_objPositionUtil.scrollX+:"+cmnDlg.m_nScrollX);dlog("g_objPositionUtil.scrollY+:"+cmnDlg.m_nScrollY);if("relative"==c){var g=d=0;e.documentElement.scrollWidth?f.innerHeight?(d=f.innerWidth,
g=f.innerHeight):(d=e.documentElement.clientWidth,g=e.documentElement.clientHeight):(d=e.body.scrollWidth,g=e.body.scrollHeight);var h=b.offsetWidth,k=b.offsetHeight;dlog("windowHeight:"+g);cmnDlg.m_nClkX+h>d+cmnDlg.m_nScrollX&&(cmnDlg.m_nClkX=cmnDlg.m_nClkX-(cmnDlg.m_nClkX+h-(d+cmnDlg.m_nScrollX))-20);cmnDlg.m_nClkY+k>g+cmnDlg.m_nScrollY&&(cmnDlg.m_nClkY=cmnDlg.m_nClkY-(cmnDlg.m_nClkY+k-(g+cmnDlg.m_nScrollY))-10);(0>=cmnDlg.m_nClkX||0>=cmnDlg.m_nClkY)&&g_objPositionUtil.setScrollPosition(a,b,"center")}0>
cmnDlg.m_nClkX&&(cmnDlg.m_nClkX=0);0>cmnDlg.m_nClkY&&(cmnDlg.m_nClkY=0);if("mobile"==c){b.style.fontSize="18px";b.style.width="auto";var l=window.screen.height;b.style.left=window.screen.width/2-b.offsetWidth/2+"px";b.style.top=l/2-b.offsetHeight/2+"px"}else b.style.left=cmnDlg.m_nClkX+"px",b.style.top=cmnDlg.m_nClkY+"px";!0===g_objPropertyUtil.element_hasClass(b,"duzon_dialog")&&(g_objPositionUtil.dlgBodyHeight(b),duzon_dialog.bChgTabDlgPos&&0!=b.style.top&&(b.style.top=0,duzon_dialog.bChgTabDlgPos=
!1))}catch(m){dalert(m)}};this.dlgBodyHeight=function(a){try{var b=null,c=a.firstElementChild.innerText.trim(),d=a.childNodes[1].firstElementChild,f=!1;switch(c){case ID_RES_CONST_STRING_FILE_OPEN:case ID_RES_CONST_STRING_TABLE_CREATE:case ID_RES_CONST_STRING_PAGE_SETUP:case ID_RES_CONST_STRING_WEB_SEARCH:return;case ID_RES_CONST_STRING_HELP_SHORTCUTS:b=d.firstElementChild.firstElementChild;f=!0;break;case ID_RES_DIALOG_TITLE_FIND_REPLACE:b=d.firstElementChild.childNodes[2];break;default:b=d.className.length?
d:d.firstElementChild.childNodes[1]}g_objPositionUtil.dlgBodyHeightResize(a,b,f)}catch(e){dalert(e)}};this.dlgTabBodyHeight=function(a,b){try{var c=!1,d=null,f=cmnDlg.getDlg();switch(f.firstElementChild.innerText.trim()){case ID_RES_CONST_STRING_FILE_OPEN:d=a[b].parentElement;(c=g_objPositionUtil.dlgBodyHeightResize(f,d))&&document.getElementById("dze_idx_filelist_pop").style.removeProperty("height");break;case ID_RES_CONST_STRING_WEB_SEARCH:d=a[b].getElementsByClassName("dze_search_content_container")[0];
c=g_objPositionUtil.dlgBodyHeightResize(f,d);break;case ID_RES_DIALOG_TITLE_FIND_REPLACE:break;default:d=a[b].parentElement,c=g_objPositionUtil.dlgBodyHeightResize(f,d)}return c}catch(e){dalert(e)}};this.dlgBodyHeightResize=function(a,b,c){try{var d=g_objPositionUtil.getActiveWinSize(),f=a.offsetHeight,e=f-d.view_window_height;if(f>d.view_window_height){var g=parseInt(window.getComputedStyle(b,null).getPropertyValue("padding-top"),10),h=parseInt(window.getComputedStyle(b,null).getPropertyValue("padding-bottom"),
10);b.style.height=b.offsetHeight-(g+h)-e+"px";!0===c&&(b.style.overflowY="inherit");a.style.top=0;return!0}return!1}catch(k){dalert(k)}};this.setScrollPosition=function(a,b,c){try{var d=oneffice.isLoadEditor(),f=d?g_objLayerKit.getLayerWindow():window,e=d?g_objLayerKit.getLayerDocument():document;c||(c="screen_center");"center"!=c&&(a?0>=a.offsetX&&0>=a.offsetY&&(c="screen_center"):c="screen_center");if("relative"==c){if(e.documentElement.scrollLeft?(cmnDlg.m_nScrollX=e.documentElement.scrollLeft,
cmnDlg.m_nClkX=e.documentElement.scrollLeft+a.clientX):(cmnDlg.m_nScrollX=e.body.scrollLeft,cmnDlg.m_nClkX=e.body.scrollLeft+a.clientX),e.documentElement.scrollTop?(cmnDlg.m_nScrollY=e.documentElement.scrollTop,cmnDlg.m_nClkY=e.documentElement.scrollTop+a.clientY):(cmnDlg.m_nScrollY=e.body.scrollTop,cmnDlg.m_nClkY=e.body.scrollTop+a.clientY),"child"==this.income_path){var g=document.getElementById("INIT_LOAD_AREA_"+duzon_dialog.nEditNumber),h=g_objPositionUtil.getNodeElementPosition(g);cmnDlg.m_nClkX=
a.clientX+h.left;cmnDlg.m_nClkY=a.clientY+h.top}}else if("center"==c){cmnDlg.m_nScrollX=e.documentElement.scrollLeft?e.documentElement.scrollLeft:e.body.scrollLeft;cmnDlg.m_nScrollY=e.documentElement.scrollTop?e.documentElement.scrollTop:e.body.scrollTop;var k=b.offsetWidth;g=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+duzon_dialog.nEditNumber);var l=g_objPositionUtil.getNodeElementPosition(g);cmnDlg.m_nClkY=l.top+10;l.width=l.right-l.left;cmnDlg.m_nClkX=l.left+(l.width-k)/2;cmnDlg.m_nScrollX=
0;cmnDlg.m_nScrollY=0}else if("screen_center"==c){cmnDlg.m_nScrollX=e.documentElement.scrollLeft?e.documentElement.scrollLeft:e.body.scrollLeft;cmnDlg.m_nScrollY=e.documentElement.scrollTop?e.documentElement.scrollTop:e.body.scrollTop;c=a=0;e.documentElement.scrollWidth?f.innerHeight?(a=f.innerWidth,c=f.innerHeight):(a=e.documentElement.clientWidth,c=e.documentElement.clientHeight):(a=e.body.scrollWidth,c=e.body.scrollHeight);k=b.offsetWidth;var m=b.offsetHeight;cmnDlg.m_nClkX=a/2+cmnDlg.m_nScrollX-
k/2;cmnDlg.m_nClkY=c/2+cmnDlg.m_nScrollY-m/2}}catch(n){dalert(n)}}};
var layerKit=function(){layerKit.prototype.getLayerDocument=function(){try{var a=null;return a=dzeEnvConfig.iFrameLayer?window.parent.document:document}catch(b){dalert(b)}return null};layerKit.prototype.getElementById=function(a){try{return this.getLayerDocument().getElementById(a)}catch(b){dalert(b)}return null};layerKit.prototype.getLayerWindow=function(){try{var a=null;return a=dzeEnvConfig.iFrameLayer?window.parent.window:window}catch(b){dalert(b)}return null}},g_objLayerKit=new layerKit;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(c){var b=0;return function(){return b<c.length?{done:!1,value:c[b++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.makeIterator=function(c){var b="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];return b?b.call(c):$jscomp.arrayIterator(c)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,b,g){c!=Array.prototype&&c!=Object.prototype&&(c[b]=g.value)};
$jscomp.polyfill=function(c,b,g,e){if(b){g=$jscomp.global;c=c.split(".");for(e=0;e<c.length-1;e++){var f=c[e];f in g||(g[f]={});g=g[f]}c=c[c.length-1];e=g[c];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(g,c,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(c){function b(){this.batch_=null}function g(a){return a instanceof f?a:new f(function(d,b){d(a)})}if(c&&!$jscomp.FORCE_POLYFILL_PROMISE)return c;b.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var d=this;this.asyncExecuteFunction(function(){d.executeBatch_()})}this.batch_.push(a)};var e=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){e(a,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var d=0;d<a.length;++d){var b=a[d];a[d]=null;try{b()}catch(h){this.asyncThrow_(h)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var f=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var d=this.createResolveAndReject_();try{a(d.resolve,d.reject)}catch(k){d.reject(k)}};f.prototype.createResolveAndReject_=function(){function a(a){return function(h){b||(b=!0,a.call(d,h))}}var d=this,b=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};f.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof f)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var d=null!=a;break a;case "function":d=!0;break a;default:d=!1}d?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};f.prototype.resolveToNonPromiseObj_=function(a){var d=void 0;try{d=a.then}catch(k){this.reject_(k);return}"function"==typeof d?
this.settleSameAsThenable_(d,a):this.fulfill_(a)};f.prototype.reject_=function(a){this.settle_(2,a)};f.prototype.fulfill_=function(a){this.settle_(1,a)};f.prototype.settle_=function(a,d){if(0!=this.state_)throw Error("Cannot settle("+a+", "+d+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=d;this.executeOnSettledCallbacks_()};f.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)n.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var n=new b;f.prototype.settleSameAsPromise_=function(a){var d=this.createResolveAndReject_();a.callWhenSettled_(d.resolve,d.reject)};f.prototype.settleSameAsThenable_=function(a,d){var b=this.createResolveAndReject_();try{a.call(d,b.resolve,b.reject)}catch(h){b.reject(h)}};f.prototype.then=function(a,d){function b(a,b){return"function"==typeof a?function(b){try{h(a(b))}catch(r){c(r)}}:b}var h,c,e=new f(function(a,b){h=a;c=b});this.callWhenSettled_(b(a,h),b(d,c));return e};
f.prototype.catch=function(a){return this.then(void 0,a)};f.prototype.callWhenSettled_=function(a,b){function d(){switch(h.state_){case 1:a(h.result_);break;case 2:b(h.result_);break;default:throw Error("Unexpected state: "+h.state_);}}var h=this;null==this.onSettledCallbacks_?n.asyncExecute(d):this.onSettledCallbacks_.push(d)};f.resolve=g;f.reject=function(a){return new f(function(b,c){c(a)})};f.race=function(a){return new f(function(b,c){for(var d=$jscomp.makeIterator(a),e=d.next();!e.done;e=d.next())g(e.value).callWhenSettled_(b,
c)})};f.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?g([]):new f(function(a,d){function e(b){return function(c){h[b]=c;f--;0==f&&a(h)}}var h=[],f=0;do h.push(void 0),f++,g(c.value).callWhenSettled_(e(h.length-1),d),c=b.next();while(!c.done)})};return f},"es6","es3");function onefficeComment(){}
onefficeComment.createCommentPanel=function(c,b,g){try{var e=!1,f=!1,n=!1,a="",d="",k="",h="";this.getUserList(!0,function(b){1===b.length&&!0===fnObjectCheckNull(b[0].empSeq)?a+="&compFilterMen="+b[0].compSeq+";":(b.forEach(function(b){a+=b.compSeq+"_"+b.empSeq+";"}),a="&empFilterMen="+a);e=!0});this.getUserList(!1,function(a){a.forEach(function(a){!1===fnObjectCheckNull(a.empSeq)?d+=a.compSeq+"_"+a.empSeq+";":k+=a.deptSeq+";"});0<d.length&&(d="&empFilter="+d);0<k.length&&(k="&deptFilter="+k);f=
!0});this.getEventData(b.doc_seq,b.group_seq,function(a){h=a;n=!0});var q=!1,t=setInterval(function(){if(!0===e&&!0===f&&!0===n&&(clearInterval(t),!1===q)){q=!0;var m=document.createElement("div"),l=document.createElement("iframe");m.id=c;m.className="dze_panel_contents";l.id=c+"_iframe";l.style.width="100%";l.style.height="100%";l.style.marginTop="10px";l.style.border="none";var p="/gw/comment.do?moduleGbnCode=oneffice&moduleSeq="+b.doc_seq+"&commentType=&sort=D&attachYn=N&eventType=ONEFFICE&eventSubType=ONE001";
0<a.length&&(p+=a);0<d.length&&(p+=d);0<k.length&&(p+=k);0<h.length&&(p+=h);l.src=p;m.appendChild(l);g(m)}},1)}catch(m){dalert(m)}};
onefficeComment.getUserList=function(c){try{return new Promise(function(b,g){onefficeGW.getShareInfo(oneffice.currFileSeq,function(e){if(!0===fnObjectCheckNull(e)||0===e.length)b(null);else{var f=!1,g="",a=[];e.some(function(a){"9"===a.share_type&&(f=!0,g=a.share_company_id)});if(!0===c&&!0===f)!0===g_browserCHK.mobile?(e="compSeqList="+encodeURIComponent(g),onefficeGW.getEmpListForComment(e,!1,function(a){b(a)})):(a.push({compSeq:g.replace(/,/gi,";")}),b(a));else if(!1===c&&!1===f)b("sameAlpha");
else{var d=[],k=[];oneffice_cloud_myInfoData.id!==e[0].owner_id&&a.push({compSeq:e[0].owner_company_id,deptSeq:e[0].owner_org_id,empSeq:e[0].owner_id});e.forEach(function(b){switch(b.share_type){case "0":if(oneffice_cloud_myInfoData.id===b.share_id)break;a.push({compSeq:b.share_company_id,deptSeq:b.share_org_id,empSeq:b.share_id});break;case "1":d.push(b.share_id);break;case "2":k.push(b.share_id)}});0<d.length?(e=d.join(","),e="deptSeqList="+encodeURIComponent(e),onefficeGW.getEmpListForComment(e,
!1,function(c){c.some(function(a,b){oneffice_cloud_myInfoData.id===a.empSeq&&c.splice(b,1)});a=a.concat(c);b(a)})):0<k.length?(e=k.join(","),e="compSeqList="+encodeURIComponent(e),onefficeGW.getEmpListForComment(e,!1,function(c){c.some(function(a,b){oneffice_cloud_myInfoData.id===a.empSeq&&c.splice(b,1)});a=a.concat(c);b(a)})):b(a)}}},null,!1)})}catch(b){dalert(b)}};onefficeComment.getCounts=function(c){try{onefficeGW.getCommentCounts(oneffice_cloud_myInfoData,function(b){c(b)})}catch(b){dalert(b)}};
onefficeComment.getEventData=function(c,b,g){try{g({doc_url:dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(c,b,"view_comment"),user_nm:oneffice_cloud_myInfoData.name,noti_msg:"{contents}"})}catch(e){dalert(e)}};
var g_objVideoControl=new function(){this.UrlType=-1;var r=["mp4","webm","ogg"];this.m_tmpPosterPath=dzeEnvConfig.strPath_Image+"ribbon/toolbar_btn_insert_video.png";this.arrVideoNodeName=["IFRAME","IMG","EMBED","OBJECT"];var k=null;this.getUpVideoUrl=function(){return k};this.setUpVideoUrl=function(a){k=a};var y=null;this.getExtVideoSource=function(){return y};this.setExtVideoSource=function(a){y=a};var q=null;this.getFocusParentNode=function(a){return q&&q.parentNode?q:q=null};this.setFocusParentNode=
function(a){q=a};this.setReadOnly=function(a){try{var b=objOnefficeLoader&&objOnefficeLoader.getEditorMode()===EDITORMODE.EDITOR&&!g_readonlyMode,c=g_objEditorDocument[a];changeCss("videoresize","display",b?"inherit":"none",c);changeCss("videoresize:before","display",b?"inherit":"none",c)}catch(d){dalert(d)}};this.isVideo=this.getVideo=function(a){try{return a&&1===a.nodeType?"VIDEO"===a.nodeName||this.isVideoSpan(a)?a:0<=this.arrVideoNodeName.indexOf(a.nodeName)&&this.isVideoSpan(a.parentNode)?a.parentNode:
null:null}catch(b){dalert(b)}};this.isVideoSpan=function(a){return a&&1===a.nodeType&&"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_video_iframe_container_span")?a:null};this.isVideoControl=function(a){return a&&1===a.nodeType&&("VIDEORESIZE"===a.nodeName||"BUTTON"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_play_button"))?a:null};var p=this.bClickPlayBtn=!1,v=!1,w=null,x=null,t=null,u=null,l=null,m=null;this.getResizeStatus=function(){return p};this.setResizeStatus=function(a){p=a};
this.initialiseMediaPlayer=function(){};this.togglePlayPause=function(){mediaVideo.paused||mediaVideo.ended?(g_objVideoControl.changeButtonType(playPauseBtn,"pause"),mediaVideo.play()):(g_objVideoControl.changeButtonType(playPauseBtn,"play"),mediaVideo.pause())};this.stopPlayer=function(){mediaVideo.pause();mediaVideo.currentTime=0};this.changeVolume=function(a){mediaVideo.volume="+"===a?mediaVideo.volume+(1==mediaVideo.volume?0:.1):mediaVideo.volume-(0==mediaVideo.volume?0:.1);mediaVideo.volume=
parseFloat(mediaVideo.volume).toFixed(1)};this.toggleMute=function(){mediaVideo.muted?(g_objVideoControl.changeButtonType(muteBtn,"mute"),mediaVideo.muted=!1):(g_objVideoControl.changeButtonType(muteBtn,"unmute"),mediaVideo.muted=!0)};this.replayMedia=function(){g_objVideoControl.resetPlayer();mediaVideo.play()};this.updateProgressBar=function(){var a=Math.floor(100/mediaVideo.duration*mediaVideo.currentTime);progressBar.value=a;progressBar.innerHTML=a+"% played"};this.changeButtonType=function(a,
b){a.title=b;a.innerHTML=b};this.loadVideo=function(){for(var a=0;a<arguments.length;a++){var b=arguments[a].split(".");if(g_objVideoControl.canPlayVideo(b[b.length-1])){g_objVideoControl.resetPlayer();mediaVideo.src=arguments[a];mediaVideo.load();break}}};this.resetPlayer=function(){progressBar.value=0;mediaVideo.currentTime=0;g_objVideoControl.changeButtonType(playPauseBtn,"play")};this.canPlayVideo=function(a){try{return""==document.createElement("video").canPlayType("video/"+a)?!1:!0}catch(b){dalert(b)}};
this.getAllowPlayVideoList=function(a){try{var b=document.createElement("video"),c=[];if(!0===dzeUiConfig.bUseContentExtUpload&&g_objExtUploader.m_bOnefficeWe)return b.canPlayType("video/mp4")&&(a?c.push(".mp4"):c.push("mp4")),c;for(var d=0;d<r.length;d++)b.canPlayType("video/"+r[d])&&(a?c.push("."+r[d]):c.push(r[d]));return c}catch(e){dalert(e)}};this.getDragNDropVideoUploadHTML=function(a){try{if(null==a||""==a)return null;var b=g_objLayerKit.getElementById("dze_idx_video_playtype"),c=fnObjectCheckNull(b)?
"Manual":b.value,d=/[.]/.exec(a)?/[^.]+$/.exec(a)[0]:"";d=d.split(/&|\?/)[0];b="";b+="<video width=480 height=320 playtype='"+c+"' contenteditable='false' controls=''>";b+="<source src='"+a+"' type='video/"+d+"'>";return b+"Your browser does not support the video tag.</video>"}catch(e){dalert(e)}};this.getOption=function(a){try{a=a||{};var b=g_objLayerKit.getLayerDocument();if(b.dze_insert_video_form.dze_insert_type[0].checked){var c=b.getElementById("dze_idx_video_playtype");a.playType=c?"Manual":
c.value}var d,e=document.getElementsByClassName("dze_image_align_propery_set_selected");if(e)for(c=0;c<duzon_dialog.dze_image_align_propertys.length;c++)e[0].id==="idx_dze_align_style_"+duzon_dialog.dze_image_align_propertys[c]&&(d=duzon_dialog.dze_image_align_propertys[c]);d&&"default"!==d&&(a.float=d);var f=b.getElementById("dze_movie_marginleft").value;f&&"0"!==f&&(a.marginLeft=f+"px");(f=b.getElementById("dze_movie_margintop").value)&&"0"!==f&&(a.marginTop=f+"px");(f=b.getElementById("dze_movie_marginright").value)&&
"0"!==f&&(a.marginRight=f+"px");(f=b.getElementById("dze_movie_marginbottom").value)&&"0"!==f&&(a.marginBottom=f+"px");b=480;d=320;e=b/d;var g=getMaxBoundSize(g_nActiveEditNumber);b>g.width&&(b=g.width,d=g.width/e);d>g.height&&(d=g.height,b=g.height*e);b=parseInt(b,10);d=parseInt(d,10);a.width=a.width||b+"px";a.height=a.height||d+"px";return a}catch(h){dalert(h)}};this.setOption=function(a,b){try{a&&b&&(void 0!==b.float&&(a.style.float=b.float),void 0!==b.marginLeft&&(a.style.marginLeft=b.marginLeft),
void 0!==b.marginTop&&(a.style.marginTop=b.marginTop),void 0!==b.marginRight&&(a.style.marginRight=b.marginRight),void 0!==b.marginBottom&&(a.style.marginBottom=b.marginBottom),void 0!==b.playType&&a.setAttribute("playtype",b.playType),void 0!==b.width&&(a.style.width=b.width),void 0!==b.height&&(a.style.height=b.height))}catch(c){dalert(c)}};this.createVideo=function(a){try{if(null==k||""==k)return!1;var b="mp4";if("undefined"==typeof onefficeWE&&(b=k.split(".").pop().toLowerCase(),0==g_objVideoControl.canPlayVideo(b)))return!1;
var c="";c+="<video contenteditable='false' controls=''>";c+="<source src='"+k+"' type='video/"+b+"'>";c+="Your browser does not support the video tag.";c+="</video>";var d=g_objEditorDocument[g_nActiveEditNumber].createElement("div");d.innerHTML=c;var e=d.firstChild;this.setOption(e,a);return e}catch(f){dalert(f)}};this.createVideoIframe=function(a,b){try{var c=g_objEditorDocument[g_nActiveEditNumber],d=c.createElement("div");d.innerHTML=b;var e=d.firstChild;if(!e)return null;"DIV"===e.nodeName&&
(e=d.firstChild);if(!e||"IFRAME"!==e.nodeName&&"OBJECT"!==e.nodeName)return null;var f=createYoutubeImg(e);f&&(e=f);var g=this.wrapSpan(e);this.setOption(g,a);if(f){var h=c.createElement("button");h.className="dze_play_button";g.appendChild(h)}else{var n=c.createElement("videoresize");g.appendChild(n)}return g}catch(A){dalert(A)}};this.wrapSpan=function(a){try{if(!a)return null;var b=a.ownerDocument;a.removeAttribute("width");a.removeAttribute("height");a.style.width="100%";a.style.height="100%";
var c=b.createElement("span");c.className="dze_video_iframe_container_span";c.contentEditable=!1;c.style.display="inline-block";c.style.position="relative";c.appendChild(a);return c}catch(d){dalert(d)}};this.adjustVideo=function(a){try{if(!a)return!1;var b=a.ownerDocument,c=a.querySelectorAll("div.dze_video_iframe_container_div");forEach(c,function(a,c){if((a=c.firstChild)&&"P"===a.nodeName&&(a=a.firstChild)&&!(0>this.arrVideoNodeName.indexOf(a.nodeName))){a.style.zIndex="";a=this.wrapSpan(a);var d=
c.style.width||c.width,e=c.style.height||c.height;d&&(a.style.width=d);e&&(a.style.height=e);d=b.createElement("p");e=c.style.left;"50%"===e?d.style.textAlign="center":"100%"===e&&(d.style.textAlign="right");e=b.createElement("videoresize");a.appendChild(e);d.appendChild(a);c.parentNode.replaceChild(d,c)}}.bind(this));return!0}catch(d){dalert(d)}};this.initResize=function(){p=!1;m=l=null;u=t=w=x=0};this.doEvent=function(a){try{if(a)switch(a.type){case "mousedown":case "touchstart":this.onMouseDown(a);
break;case "mousemove":case "touchmove":this.onMouseMove(a);break;case "mouseup":case "touchend":this.onMouseUp(a);break;case "click":this.onClick(a)}}catch(b){dalert(b)}};this.onMouseDown=function(a){try{if(!a||!EventUtil.isLeftButtonPressed(a))return!1;var b=a.target||a.srcElement;if(!b)return!1;if("VIDEORESIZE"===b.nodeName&&!g_readonlyMode){m=b;l=m.parentNode;if(!this.isVideoSpan(l))return this.initResize(),!1;w=a.clientX;x=a.clientY;t=l.offsetWidth;u=l.offsetHeight;p=!0;v=!1;m.style.width="100%";
m.style.height="100%";m.ondragstart=function(){return!1};return!0}return!1}catch(c){dalert(c)}};this.onMouseMove=function(a){try{if(p){var b=Math.max(u+(a.clientY-x),40);l.style.width=Math.max(t+(a.clientX-w),40)+"px";l.style.height=b+"px";TBCancelBubbleEvent(a);return!0}return!1}catch(c){dalert(c)}};this.onMouseUp=function(a){try{if(p){m.style.width="";m.style.height="";m.ondragstart=null;if(l.offsetWidth!==t||l.offsetHeight!==u)if(v=!0,g_objUndoRedo.registerUndoRedoStack(0,a.nEditNumber),dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();
this.initResize();return!0}return!1}catch(b){dalert(b)}};this.onClick=function(a){try{if(!a)return!1;var b=a.target||a.srcElement;if(!b)return!1;var c=b.parentNode;if("VIDEORESIZE"===b.nodeName&&!v&&this.isVideoSpan(c)){var d=c.firstChild;if(!d||0>this.arrVideoNodeName.indexOf(d.nodeName))return;var e=c.ownerDocument.createRange();e.selectNode(c);SetCurRange(e);g_readonlyMode||objOnefficeLoader.getEditorMode()!==EDITORMODE.EDITOR||showExtOutline_ObjectElement(c,!0,!1,a.nEditNumber);return!0}return"BUTTON"===
b.nodeName&&g_objPropertyUtil.hasClass(b,"dze_play_button")&&this.isVideoSpan(c)?(this.bClickPlayBtn=!0,this.convToYoutubeIframe(c,!0),c.lastChild&&"VIDEORESIZE"===c.lastChild.nodeName&&!g_readonlyMode&&objOnefficeLoader.getEditorMode()===EDITORMODE.EDITOR&&this.animate(c.lastChild),!0):!1}catch(f){dalert(f)}};this.convToYoutubeIframe=function(a,b){try{if(!this.isVideoSpan(a))return!1;var c=a.ownerDocument,d=a.firstChild;if(!d||"IMG"!==d.nodeName)return!1;var e=createYoutubeIframe(d);if(!e)return!1;
b&&(e.src=e.src);a.innerHTML="";a.appendChild(e);var f=c.createElement("videoresize");a.appendChild(f);return!0}catch(g){dalert(g)}};this.convToYoutubeImg=function(a){try{if(!this.isVideoSpan(a))return!1;var b=a.ownerDocument,c=a.firstChild;if(!c||"IFRAME"!==c.nodeName)return!1;var d=createYoutubeImg(c);if(!d)return!1;a.innerHTML="";a.appendChild(d);var e=b.createElement("button");e.className="dze_play_button";a.appendChild(e);return!0}catch(f){dalert(f)}};this.convToImgAll=function(a){try{if(a){var b=
a.querySelectorAll("span.dze_video_iframe_container_span");forEach(b,function(a,b){(a=b.firstChild)&&"IFRAME"===a.nodeName&&this.convToYoutubeImg(b)},this)}}catch(c){dalert(c)}};this.convToIframeAll=function(a,b){try{if(a){var c=a.querySelectorAll("span.dze_video_iframe_container_span");forEach(c,function(a,c){(a=c.firstChild)&&"IMG"===a.nodeName&&this.convToYoutubeIframe(c,b)},this)}}catch(d){dalert(d)}};this.animate=function(a){try{a&&"VIDEORESIZE"===a.nodeName&&(a.style.width="40px",a.style.height=
"40px",a.style.backgroundSize="40px 40px",a.style.opacity="1",dzeJ(a).delay(100).fadeOut(1E3,function(){a.style.width="";a.style.height="";a.style.backgroundSize="";a.style.opacity="";a.style.display=""}))}catch(b){dalert(b)}};this.insertVideoForm=function(){try{var a=g_objLayerKit.getLayerDocument().dze_insert_video_form;if(!0===a.dze_insert_type[0].checked)if(!0===dzeUiConfig.bUseContentExtUpload)g_objExtUploader.initWithUploadItem(a,CONST_DZE_UPLOAD_TYPE_VIDEO);else{duzon_http.showLoading(18E4);
var b=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe);b.attachEvent?b.attachEvent("onload",g_objVideoControl.onloadActionIframeInsertVideo):b.addEventListener("load",g_objVideoControl.onloadActionIframeInsertVideo,!1);a.submit()}}catch(c){duzon_http.hideLoading(),dalert(c)}};this.onloadActionIframeInsertVideo=function(){try{duzon_http.hideLoading();var a=g_objLayerKit.getElementById(duzon_dialog.idx_dze_upload_iframe).contentWindow.document.body.innerHTML,b=duzon_http.parseJSON(a);
if("success"!=b.result)alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR);else{b.url=getFullUrlFromPath(b.url);objOnefficeLoader.m_nAppEnvType==APPENV.WE?g_onefficeWeTool&&"onex"==g_onefficeWeTool.m_IsOnex&&(b.url=b.relativeUrl):oneffice.bUseOnexFile&&(b.url=b.relativeUrl);var c=b.filename.split(".").pop().toLowerCase();0==g_objVideoControl.canPlayVideo(c)?(alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO),g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_upvideo_txt).focus(),k=null):(DZE_UPLOAD_EVENT.setComplete(duzon_dialog.nEditNumber,
b),k=b.url)}}catch(d){dalert(d)}};this.createVideoImg=function(a){try{if(void 0!=a&&(void 0!=a.webkitVideoDecodedByteCount&&0>=a.webkitVideoDecodedByteCount||void 0!=a.mozPaintedFrames&&0>=a.mozPaintedFrames))return null;var b=document.createElement("canvas"),c=b.getContext("2d"),d=a.videoWidth,e=a.videoHeight;if(0===d&&0===e)return null;var f=d/e;b.width=d;b.height=e;c.drawImage(a,0,0,d,e);var g=new Image;g.src=b.toDataURL();e=g_objCommonUtil;var h=e.toPx(a.style.width||a.width),n=e.toPx(a.style.height||
a.height);if(0===h||0===n)return null;b=h/n;c=h;d=n;var l=e.toPx(a.style.paddingLeft),z=e.toPx(a.style.paddingRight),m=e.toPx(a.style.paddingTop),k=e.toPx(a.style.paddingBottom);e=0;h<n||1<=f&&1<=b?(d=h/f,e=Math.abs(d-n)/2,m+=Math.floor(e),k+=Math.ceil(e)):h>n&&(c=n*f,e=Math.abs(c-h)/2,l+=Math.floor(e),z+=Math.ceil(e));g.style.width=parseInt(c,10)+"px";g.style.height=parseInt(d,10)+"px";g.style.paddingLeft=l+"px";g.style.paddingRight=z+"px";g.style.paddingTop=m+"px";g.style.paddingBottom=k+"px";g.style.border=
a.style.border;g.style.float=a.style.float;return g}catch(C){dalert(C)}};this.convVideoToImageForPrint=function(a,b){try{if(!a||!b)return!1;var c=[].slice.call(b.getElementsByTagName("video")),d=[].slice.call(a.getElementsByTagName("video")),e=c.length;if(e!==d.length)return!1;a=null;for(b=0;b<e;b++)(a=this.createVideoImg(c[b]))&&d[b].parentNode.replaceChild(a,d[b]);return!0}catch(f){dalert(f)}};this.setVideoUrlType=function(a){try{0<=a.indexOf("//www.youtube.com/")||0<=a.indexOf("//youtu.be/")?g_objVideoControl.UrlType=
0:0<=a.indexOf("//tv.naver.com/")?g_objVideoControl.UrlType=1:0<=a.indexOf("//tv.kakao.com/")&&(g_objVideoControl.UrlType=2)}catch(b){dalert(b)}};this.getVideoIDForURL=function(a){try{var b=null;switch(g_objVideoControl.UrlType){case 1:var c="//tv.naver.com/embed/",d=a.indexOf("//tv.naver.com/v/");if(0<d)b=a.substring(d+17);else if(d=a.indexOf(c),0<d){b=a.substring(d+c.length);var e=b.indexOf("&");-1<e&&(b=b.substring(0,e))}break;case 2:c="//tv.kakao.com/v/";d=a.indexOf(c);0<d&&(b=a.substring(d+c.length));
break;default:d=a.indexOf("//youtu.be/"),0<d?b=a.substring(d+11):(d=a.indexOf(".youtube.com/watch?v="),0<d&&(b=a.substring(d+21),e=b.indexOf("&"),-1<e&&(b=b.substring(0,e))))}return b}catch(f){return dalert(f),parent}};this.getVideoID=function(a){try{switch(g_objVideoControl.UrlType){case 1:var b=a.indexOf("embed");if(0>b||b+1>=a.length)return null;var c=a[b+1].split("?");return c&&c[0]?c[0]:null;case 2:return b=a.indexOf("embed"),0>b||b+1>=a.length?null:(c=a[b+3].split("?"))&&c[0]?c[0]:null;default:return b=
a.indexOf("embed"),0>b||b+1>=a.length?null:(c=a[b+1].split("?"))&&c[0]?c[0]:null}}catch(d){dalert(d)}};this.getFormatVideoIFrame=function(){try{var a=null;switch(g_objVideoControl.UrlType){case 0:a='<iframe width="0" height="0" src="https://www.youtube.com/embed/#id#" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';break;case 1:a='<iframe WIDTH="0" HEIGHT="0" src="https://tv.naver.com/embed/#id#?autoPlay=false" frameborder="no" scrolling="no" marginwidth="0" marginheight="0" allow="autoplay" allowfullscreen></iframe>';
break;case 2:a='<iframe title="kakaoTV video" width="0" height="0" src="https://play-tv.kakao.com/embed/player/cliplink/#id#?service=player_share" allowfullscreen frameborder="0" scrolling="no" allow="autoplay; fullscreen; encrypted-media"></iframe>';break;default:a='<iframe width="0" height="0"></iframe>'}return a}catch(b){dalert(b)}};this.createYoutubeImg=function(a){try{if(!a||"IFRAME"!==a.nodeName)return null;var b=a.src;if(!b||!(0<=b.indexOf("//www.youtube.com")||0<=b.indexOf("//tv.naver.com")||
0<=b.indexOf("//play-tv.kakao.com")))return null;var c=b.split("/"),d=g_objVideoControl.getVideoID(c);switch(g_objVideoControl.UrlType){case 0:b="https://img.youtube.com/vi/"+d+"/mqdefault.jpg";var e=a.ownerDocument.createElement("img");e.src=b;e.style.width=a.style.width||a.width;e.style.height=a.style.height||a.height;a.hasAttribute("allowfullscreen")&&e.setAttribute("allowfullscreen","");a.hasAttribute("allow")&&e.setAttribute("allow",a.getAttribute("allow"));return e}return null}catch(f){dalert(f)}};
this.createYoutubeIframe=function(a,b){try{if(!a||"IMG"!==a.nodeName)return null;var c=a.src;if(!c||0>c.indexOf("//img.youtube.com"))return null;var d=c.split("/"),e=d.indexOf("vi");if(0>e||e+2>=d.length)return null;var f=d[d.length-1];if(!(startsWith(f,"mqdefault.jpg")||startsWith(f,"hqdefault.jpg")||startsWith(f,"sddefault.jpg")||startsWith(f,"maxresdefault.jpg")))return null;var g="https://www.youtube.com/embed/"+d[e+1];if(!0===b){b="<iframe";var h=a.parentNode;if(h&&1===h.nodeType&&"SPAN"===h.nodeName&&
g_objPropertyUtil.hasClass(h,"dze_video_iframe_container_span")){var l=h.style.width||h.width;l&&(b+=' width="'+l+'"');var m=h.style.height||h.height;m&&(b+=' height="'+m+'"')}b+=' src="'+g+'" frameborder="0"';a.hasAttribute("allow")&&(b+=' allow="'+a.getAttribute("allow")+'"');a.hasAttribute("allowfullscreen")&&(b+=" allowfullscreen");return b+"></iframe>"}var k=a.ownerDocument.createElement("iframe");k.src=g;k.style.width=a.style.width||a.width;k.style.height=a.style.height||a.height;k.setAttribute("frameborder",
0);a.hasAttribute("allowfullscreen")&&k.setAttribute("allowfullscreen","");a.hasAttribute("allow")&&k.setAttribute("allow",a.getAttribute("allow"));return k}catch(B){dalert(B)}}};
var g_objWaterMarkMgr=new function(){this.m_nEditorMode=EDITORMODE.EDITOR;this.input_height=27;this.strBackgroundImageURL=void 0;this.watermarkMode=0;this.m_idx_watermark_radio_basic="idx_watermark_radio_basic";this.m_idx_watermark_radio_pic="idx_watermark_radio_pic";this.m_idx_watermark_radio_text="idx_watermark_radio_text";this.m_idx_dze_file_watermark_pic="idx_dze_file_watermark_pic";this.m_watermarkTextAttr={text:"\ub300\uc678\ube44",font_family:"\uad74\ub9bc\uccb4",font_size:44,bold:!1,italic:!1,
opacity:1};this.m_watermarkPicAttr={path:"",zoom:50,rotate:0,opacity:1};this.makeRowContent=function(c){var b=document.createElement("div");b.className="watermark_table_row";var a=document.createElement("div");a.className="watermark_text_cell_left";a.textContent=c;c=document.createElement("div");c.className="watermark_text_cell_right";b.appendChild(a);b.appendChild(c);return b};this.makeRowContent2Content=function(c){var b=document.createElement("div");b.className="watermark_table_row";var a=document.createElement("div");
a.className="watermark_text_cell_left";a.textContent=c;c=document.createElement("div");c.className="watermark_text_cell_middle";var d=document.createElement("div");c.className="watermark_text_cell_right";b.appendChild(a);b.appendChild(c);b.appendChild(d);return b};this.makeTextContentsHTML=function(c){try{var b=document.createElement("div");b.id="idx_watermark_sub_text_root";b.style.display="none";var a=document.createElement("div");a.className="watermark_table";for(var d=this.makeRowContent(ID_RES_PROP_TEXTBOX_CONTENTS),
f="\ubcf5\uc0ac \uae08\uc9c0;\ub300\uc678\ube44;\uadf9\ube44;\uae34\uae09;\ucd08\uc548;\uc608\uc81c;\uc6d0\ubcf8;\uc9c1\uc811\uc785\ub825".split(";"),g=[],e=1;e<f.length;e++)g.push({value:f[e],text:f[e].replace(/["']/g,"","")});d.lastChild.innerHTML=duzon_dialog.makeComboInputForm("idx_dze_watermark_text_content",g,null,this.input_height,0);a.appendChild(d);var h=this.makeRowContent("");h.id="idx_dze_Inputdirect_Row";h.style.display="none";var l=document.createElement("input");l.id="idx_dze_inputdirect_text";
h.lastChild.appendChild(l);a.appendChild(h);var m=this.makeRowContent(ID_RES_CONST_STRING_STYLE_FONT);d=[];for(e=1;e<g_arrFontName.length;e++)d.push({value:g_arrFontName[e],text:g_arrFontName[e].replace(/["']/g,"","")});m.lastChild.innerHTML=duzon_dialog.makeComboInputForm("idx_watermark_font_family",d,null,this.input_height,0);a.appendChild(m);var p=this.makeRowContent(ID_RES_DIALOG_STRING_SIZE);p.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("idx_watermark_font_size","pt",128,36,44,65,this.input_height,
0);a.appendChild(p);var k=this.makeRowContent("");document.createElement("div");var q=document.createElement("input");q.id="idx_wm_bold_chk";q.type="checkbox";var n=document.createElement("label");n.style.marginRight="20px";n.setAttribute("for","idx_wm_bold_chk");n.textContent=ID_RES_CONST_STRING_BOLD;var r=document.createElement("input");r.id="idx_wm_italic_chk";r.type="checkbox";var t=document.createElement("label");t.setAttribute("for","idx_wm_italic_chk");t.textContent=ID_RES_CONST_STRING_ITALIC;
k.lastChild.appendChild(q);k.lastChild.appendChild(n);k.lastChild.appendChild(r);k.lastChild.appendChild(t);a.appendChild(k);b.appendChild(a);var u=document.createElement("div");u.className="watermark_table";var v=this.makeRowContent2Content(ID_RES_CONST_STRING_SHAPES_TRANSPARENT),w=g_objPropTagCommon.makeSliderCtrl("idx_dze_watermark_text_slider",0,100);w.style.width="100px";v.children[1].appendChild(w);v.children[2].innerHTML=duzon_dialog.makeSpinnerInputForm("idx_dze_watermark_text_alpha","%",
100,0,0,60,this.input_height,0);u.appendChild(v);b.appendChild(u);c.appendChild(b)}catch(x){dlog(x)}};this.makePicContentsHTML=function(c){try{var b=document.createElement("div");b.id="idx_watermark_sub_pic_root";b.style.display="none";var a=document.createElement("div");a.className="watermark_table";var d=document.createElement("form");d.setAttribute("name","dze_insert_image_form");d.method="post";d.enctype="multipart/form-data";d.action="/oneffice_watermark/server/server_upload_image.jsp";d.target=
"ifrmImageFileUploadTarget";var f=this.makeRowContent(ID_RES_DIALOG_STRING_FILE_PATH);f.lastChild.innerHTML=duzon_dialog.makeExtFileForm("dze_upimage_file",this.m_idx_dze_file_watermark_pic,"200px",[".png",".jpg",".gif"]);var g=document.createElement("iframe");g.name="ifrmImageFileUploadTarget";g.id="ifrmImageFileUploadTarget";g.style.width="300px";g.style.height="150px";g.style.display="none";d.appendChild(f);d.appendChild(g);a.appendChild(d);var e=document.createElement("div");e.className="watermark_table";
var h=this.makeRowContent(ID_RES_CONST_STRING_SHAPES_RATIO);d=[];d.push({value:"100",text:"100%"});d.push({value:"75",text:"75%"});d.push({value:"50",text:"50%"});d.push({value:"30",text:"30%"});d.push({value:"20",text:"20%"});h.lastChild.innerHTML=duzon_dialog.makeComboInputForm("idx_dze_watermark_pic_zoom",d,136,this.input_height);e.appendChild(h);var l=this.makeRowContent(ID_RES_CONST_STRING_SHAPES_ROTATE);l.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("idx_dze_watermark_pic_rotate","\u00ba",
360,-360,0,136,this.input_height,0);e.appendChild(l);var m=document.createElement("div");m.className="watermark_table";var p=this.makeRowContent2Content(ID_RES_CONST_STRING_SHAPES_TRANSPARENT),k=g_objPropTagCommon.makeSliderCtrl("idx_dze_watermark_pic_slider",0,100);k.style.width="100px";p.children[1].appendChild(k);p.children[2].innerHTML=duzon_dialog.makeSpinnerInputForm("idx_dze_watermark_pic_alpha","%",100,0,0,60,this.input_height,0);m.appendChild(p);b.appendChild(a);b.appendChild(e);b.appendChild(m);
c.appendChild(b)}catch(q){}};this.getDlgContentsHTML=function(){try{var c=document.createElement("div");c.className="duzon_dialog_content_small";var b=document.createElement("div");b.style.marginBottom="10px";var a=document.createElement("div");a.style.marginBottom="10px";var d=document.createElement("div"),f=document.createElement("input");f.id=this.m_idx_watermark_radio_basic;f.type="radio";f.value="basic";f.name="watermark";f.checked="checked";var g=document.createElement("label");g.className=
"duzon_dialog_label_title";g.setAttribute("for",this.m_idx_watermark_radio_basic);g.textContent="\uae30\ubcf8(ONEFFICE)";b.appendChild(f);b.appendChild(g);c.appendChild(b);var e=document.createElement("input");e.id=this.m_idx_watermark_radio_pic;e.type="radio";e.value="pic";e.name="watermark";var h=document.createElement("label");h.className="duzon_dialog_label_title";h.setAttribute("for",this.m_idx_watermark_radio_pic);h.textContent=ID_RED_CONST_STRING_IMAGE;a.appendChild(e);a.appendChild(h);this.makePicContentsHTML(a);
c.appendChild(a);var l=document.createElement("input");l.id=this.m_idx_watermark_radio_text;l.type="radio";l.value="text";l.name="watermark";var m=document.createElement("label");m.className="duzon_dialog_label_title";m.setAttribute("for",this.m_idx_watermark_radio_text);m.textContent="text";d.appendChild(l);d.appendChild(m);this.makeTextContentsHTML(d);c.appendChild(d);var p=document.createElement("div");p.className="duzon_dialog_label_separator";c.appendChild(p);var k=document.createElement("div");
k.className="watermark_table";var q=this.makeRowContent(ID_RES_CONST_STRING_PREVIEW);q.children[0].className="duzon_dialog_label_title";var n=document.createElement("div");n.className="bg_watermark_preview";n.style.display="flex";n.style.justifyContent="center";n.style.alignItems="center";q.children[1].appendChild(n);k.appendChild(q);c.appendChild(k);return c}catch(r){dlog(r),dalert(r)}};this.initTextEventListener=function(){$_("idx_dze_watermark_text_content").onchange=function(a){console.log("Select watermark_text_content onChange");
"\uc9c1\uc811\uc785\ub825"===this.options[this.selectedIndex].text?($_("idx_dze_Inputdirect_Row").style.display="",g_objWaterMarkMgr.m_watermarkTextAttr.text=""):($_("idx_dze_Inputdirect_Row").style.display="none",g_objWaterMarkMgr.m_watermarkTextAttr.text=this.options[this.selectedIndex].text);g_objWaterMarkMgr.updatepreview()};$_("idx_watermark_font_family").onchange=function(a){console.log("font_familyonChange = "+this.options[this.selectedIndex].text);g_objWaterMarkMgr.m_watermarkTextAttr.font_family=
this.options[this.selectedIndex].text;g_objWaterMarkMgr.updatepreview()};duzon_dialog.modifySpinnerValue("idx_watermark_font_size",128,44,64,function(a){console.log("font_size = "+parseInt(a,10));g_objWaterMarkMgr.m_watermarkTextAttr.font_size=parseInt(a,10);g_objWaterMarkMgr.updatepreview()});dzeJ("#idx_wm_bold_chk").change(function(){dzeJ("#idx_wm_bold_chk").is(":checked")?g_objWaterMarkMgr.m_watermarkTextAttr.bold=!0:g_objWaterMarkMgr.m_watermarkTextAttr.bold=!1;g_objWaterMarkMgr.updatepreview()});
dzeJ("#idx_wm_italic_chk").change(function(){dzeJ("#idx_wm_italic_chk").is(":checked")?g_objWaterMarkMgr.m_watermarkTextAttr.italic=!0:g_objWaterMarkMgr.m_watermarkTextAttr.italic=!1;g_objWaterMarkMgr.updatepreview()});var c=dzeJ("#idx_dze_watermark_text_slider"),b=dzeJ("#idx_dze_watermark_text_alpha");c.on("change mousemove",function(){var a=1*this.value;b.val(a);a=(100-a)/100;console.log("idx_dze_watermark_text_slider input Change = "+a);g_objWaterMarkMgr.m_watermarkTextAttr.opacity=a;g_objWaterMarkMgr.updatepreview()}).click(function(){var a=
1*this.value;b.val(a);a=(100-a)/100;console.log("idx_dze_watermark_text_slider click = "+a);g_objWaterMarkMgr.m_watermarkTextAttr.opacity=a;g_objWaterMarkMgr.updatepreview()});duzon_dialog.modifySpinnerValue("idx_dze_watermark_text_alpha",100,0,0,function(a){a*=1;c.val(a);a=(100-a)/100;console.log("idx_dze_watermark_text_slider click = "+a);g_objWaterMarkMgr.m_watermarkTextAttr.opacity=a;g_objWaterMarkMgr.updatepreview()});dzeJ("#idx_dze_inputdirect_text").on("propertychange change keyup paste input",
function(){var a=dzeJ(this).val();g_objWaterMarkMgr.m_watermarkTextAttr.text!=dzeJ(this).val()&&(g_objWaterMarkMgr.m_watermarkTextAttr.text=a,g_objWaterMarkMgr.updatepreview())})};this.initPicEventListener=function(){$_("idx_dze_watermark_pic_zoom").onchange=function(a){console.log("PIC_ZOOM = "+this.options[this.selectedIndex].text);g_objWaterMarkMgr.m_watermarkPicAttr.zoom=this.options[this.selectedIndex].value;g_objWaterMarkMgr.updatepreview()};duzon_dialog.modifySpinnerValue("idx_dze_watermark_pic_rotate",
360,-360,0,function(a){a=Math.round(parseFloat(a));a=360===a||-360===a?0:a;dzeJ("#idx_dze_watermark_pic_rotate").val(a);g_objWaterMarkMgr.m_watermarkPicAttr.rotate=dzeJ("#idx_dze_watermark_pic_rotate").val();g_objWaterMarkMgr.updatepreview()},function(a){a=Math.round(parseFloat(a));a=360===a||-360===a?0:a;dzeJ("#idx_dze_watermark_pic_rotate").val(a);g_objWaterMarkMgr.m_watermarkPicAttr.rotate=dzeJ("#idx_dze_watermark_pic_rotate").val();g_objWaterMarkMgr.updatepreview()},1,!1);var c=dzeJ("#idx_dze_watermark_pic_slider"),
b=dzeJ("#idx_dze_watermark_pic_alpha");c.on("change mousemove",function(){var a=1*this.value;b.val(a);a=(100-a)/100;console.log("idx_dze_watermark_pic_slider input Change = "+a);g_objWaterMarkMgr.m_watermarkPicAttr.opacity=a;g_objWaterMarkMgr.updatepreview()}).click(function(){var a=1*this.value;b.val(a);a=(100-a)/100;console.log("idx_dze_watermark_text_slider click = "+a);g_objWaterMarkMgr.m_watermarkPicAttr.opacity=a;g_objWaterMarkMgr.updatepreview()});duzon_dialog.modifySpinnerValue("idx_dze_watermark_pic_alpha",
100,0,0,function(a){a*=1;c.val(a);a=(100-a)/100;console.log("idx_dze_watermark_text_slider click = "+a);g_objWaterMarkMgr.m_watermarkPicAttr.opacity=a;g_objWaterMarkMgr.updatepreview()});duzon_dialog.addEventExtFileForm(this.m_idx_dze_file_watermark_pic,function(){g_objWaterMarkMgr.onChangeImgSrc()})};this.onChangeImgSrc=function(){try{var c=g_objLayerKit.getLayerDocument().forms.dze_insert_image_form.dze_upimage_file.files;duzon_http.showLoading();checkValidImgFile(c,function(b,a,c,f){duzon_http.hideLoading();
0<f.length?(this.m_watermarkPicAttr.path="",this.updatepreview(),cmnMsg.showMsgArray(null,f,null)):this.uploadImageFile()}.bind(this))}catch(b){dalert(b)}};this.uploadImageFile=function(){try{var c=g_objLayerKit.getLayerDocument().forms.dze_insert_image_form,b=c.dze_upimage_file.files;!b||0>=b.length?(this.m_watermarkPicAttr.path="",this.updatepreview()):uploadImg(g_nActiveEditNumber,c,this.uploadImageFileDone)}catch(a){dalert(a)}};this.uploadImageFileDone=function(c){try{g_objWaterMarkMgr.m_watermarkPicAttr.path=
"";if(c&&"success"==c.result){var b=c.url;if(b&&Array.isArray(b))if(0<b.length)b=b[0];else{g_objWaterMarkMgr.updatepreview();return}b=b.replace("&amp;","&");g_objWaterMarkMgr.m_watermarkPicAttr.path=b}else alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR);g_objWaterMarkMgr.updatepreview()}catch(a){dalert(a)}};this.commandUI=function(){try{switch(g_objWaterMarkMgr.watermarkMode){case 0:g_objWaterMarkMgr.selectWatermarkType("idx_watermark_radio_basic");break;case 1:var c=dzeJ("#idx_watermark_radio_pic");c.prop("checked",
!0);g_objWaterMarkMgr.selectWatermarkType("idx_watermark_radio_pic");$_("idx_dze_watermark_pic_zoom").onchange=function(a){console.log("PIC_ZOOM = "+this.options[this.selectedIndex].text);g_objWaterMarkMgr.m_watermarkPicAttr.zoom=this.options[this.selectedIndex].value;g_objWaterMarkMgr.updatepreview(1)};dzeJ("#idx_dze_watermark_pic_zoom").val(g_objWaterMarkMgr.m_watermarkPicAttr.zoom);dzeJ("#idx_dze_watermark_pic_rotate").val(g_objWaterMarkMgr.m_watermarkPicAttr.rotate);var b=dzeJ("#idx_dze_watermark_pic_slider"),
a=dzeJ("#idx_dze_watermark_pic_alpha");b.val(100-100*g_objWaterMarkMgr.m_watermarkPicAttr.opacity);a.val(100-100*g_objWaterMarkMgr.m_watermarkPicAttr.opacity);break;case 2:if(g_objWaterMarkMgr.selectWatermarkType("idx_watermark_radio_text"),c=dzeJ("#idx_watermark_radio_text"),c.prop("checked",!0),!0===g_objWaterMarkMgr.m_watermarkTextAttr.bold?dzeJ("#idx_wm_bold_chk").prop("checked",!0):dzeJ("#idx_wm_bold_chk").prop("checked",!1),!0===g_objWaterMarkMgr.m_watermarkTextAttr.italic?dzeJ("#idx_wm_italic_chk").prop("checked",
!0):dzeJ("#idx_wm_italic_chk").prop("checked",!1),dzeJ("#idx_watermark_font_size").val(g_objWaterMarkMgr.m_watermarkTextAttr.font_size),dzeJ("#idx_watermark_font_family").val(g_objWaterMarkMgr.m_watermarkTextAttr.font_family).prop("selected",!0),dzeJ("#idx_dze_watermark_text_slider").val(100-100*g_objWaterMarkMgr.m_watermarkTextAttr.opacity),dzeJ("#idx_dze_watermark_text_alpha").val(100-100*g_objWaterMarkMgr.m_watermarkTextAttr.opacity),0<=dzeJ("#idx_dze_watermark_text_content").text().indexOf(g_objWaterMarkMgr.m_watermarkTextAttr.text)){dzeJ("#idx_dze_watermark_text_content").val(g_objWaterMarkMgr.m_watermarkTextAttr.text).prop("selected",
!0);var d=dzeJ("#idx_dze_Inputdirect_Row");d.attr("style","display:none;");var f=dzeJ("#idx_dze_inputdirect_text");f.val("")}else dzeJ("#idx_dze_watermark_text_content").val("\uc9c1\uc811\uc785\ub825").prop("selected",!0),d=dzeJ("#idx_dze_Inputdirect_Row"),d.attr("style","display:tabel-row;"),f=dzeJ("#idx_dze_inputdirect_text"),f.val(g_objWaterMarkMgr.m_watermarkTextAttr.text)}}catch(g){dalert(g)}};this.selectWatermarkType=function(c){switch(c){case "idx_watermark_radio_basic":dlog("this.m_idx_watermark_radio_basic");
$_("idx_watermark_sub_pic_root").style.display="none";$_("idx_watermark_sub_text_root").style.display="none";g_objWaterMarkMgr.updatepreview();break;case "idx_watermark_radio_pic":dlog("this.m_idx_watermark_radio_pic");$_("idx_watermark_sub_pic_root").style.display="";$_("idx_watermark_sub_text_root").style.display="none";g_objWaterMarkMgr.updatepreview();break;case "idx_watermark_radio_text":dlog("this.m_idx_watermark_radio_text"),$_("idx_watermark_sub_pic_root").style.display="none",$_("idx_watermark_sub_text_root").style.display=
"",g_objWaterMarkMgr.updatepreview()}};this.initEventListener=function(){clickWatermarkType=function(c){try{switch(c.target.id){case "idx_watermark_radio_pic":g_objWaterMarkMgr.watermarkMode=1;break;case "idx_watermark_radio_text":g_objWaterMarkMgr.watermarkMode=2;break;default:case "idx_watermark_radio_basic":g_objWaterMarkMgr.watermarkMode=0}g_objWaterMarkMgr.commandUI()}catch(b){dalert(b)}};$_(this.m_idx_watermark_radio_basic).addEventListener("click",clickWatermarkType);$_(this.m_idx_watermark_radio_pic).addEventListener("click",
clickWatermarkType);$_(this.m_idx_watermark_radio_text).addEventListener("click",clickWatermarkType);g_objWaterMarkMgr.initTextEventListener();g_objWaterMarkMgr.initPicEventListener()};this.updatepreview=function(){if(2===g_objWaterMarkMgr.watermarkMode){1<=dzeJ(".bg_watermark_preview").children().length&&(dzeJ(".bg_watermark_preview").children().remove(),g_objWaterMarkMgr.m_watermarkPicAttr.path="");dzeJ(".bg_watermark_preview").css({background:"url()"});var c=document.createElementNS("http://www.w3.org/2000/svg",
"svg");c.setAttribute("width","90");c.setAttribute("height","120");var b=document.createElementNS("http://www.w3.org/2000/svg","text");b.setAttribute("text-anchor","middle");b.setAttribute("dx","50%");b.setAttribute("dy","50%");b.setAttribute("alignment-baseline","middle");b.setAttribute("fill","#000");b.setAttribute("backgroud-color","#ff0");!0===this.m_watermarkTextAttr.bold?b.setAttribute("font-weight","bold"):b.setAttribute("font-weight","");!0===this.m_watermarkTextAttr.italic?b.setAttribute("transform",
"rotate(-45, 40,60)"):b.setAttribute("transform","");b.setAttribute("opacity",this.m_watermarkTextAttr.opacity);b.setAttribute("font-size",this.m_watermarkTextAttr.font_size/7+"pt");b.textContent=this.m_watermarkTextAttr.text;c.appendChild(b);dzeJ(".bg_watermark_preview").append(c)}else 1===g_objWaterMarkMgr.watermarkMode?(1<=dzeJ(".bg_watermark_preview").children().length&&dzeJ(".bg_watermark_preview").children().remove(),dzeJ(".bg_watermark_preview").css({background:"url()"}),c=g_objWaterMarkMgr.m_watermarkPicAttr.path,
""!==c&&void 0!==c&&(b=document.createElement("img"),dzeJ("#idx_dze_watermark_pic_rotate").val(),b.src=c,b.style.width=.75*g_objWaterMarkMgr.m_watermarkPicAttr.zoom+"%",b.style.transform="rotate("+g_objWaterMarkMgr.m_watermarkPicAttr.rotate+"deg)",b.style.opacity=g_objWaterMarkMgr.m_watermarkPicAttr.opacity,dzeJ(".bg_watermark_preview").append(b))):0===g_objWaterMarkMgr.watermarkMode&&(1<=dzeJ(".bg_watermark_preview").children().length&&(dzeJ(".bg_watermark_preview").children().remove(),g_objWaterMarkMgr.m_watermarkPicAttr.path=
""),c=document.createElement("div"),c.className="watermark_base_img",dzeJ(".bg_watermark_preview").append(c))};this.makeCanvas=function(){var c=Math.PI/180;if(0===g_objWaterMarkMgr.watermarkMode)dzeLayoutControl.setDocWatermarkSrc("",g_nActiveEditNumber),this.m_watermarkTextAttr={text:"\ub300\uc678\ube44",font_family:"\uad74\ub9bc\uccb4",font_size:44,bold:!1,italic:!1,opacity:1},this.m_watermarkPicAttr={path:"",zoom:50,rotate:0,opacity:1};else{var b=document.createElement("canvas");document.body.appendChild(b);
b.style.left="-1500px";b.style.top="-1000px";b.style.position="fixed";b.width=600;b.height=600;var a=b.getContext("2d");a.clearRect(0,0,b.width,b.height);if(1===g_objWaterMarkMgr.watermarkMode){var d=new Image;d.onload=function(){var f=Math.max(d.width,d.height),e=1;600<f&&(e=600/f);e*=g_objWaterMarkMgr.m_watermarkPicAttr.zoom/100;.75<e&&0!==g_objWaterMarkMgr.m_watermarkPicAttr.rotate&&(e*=.75);f=d.width*e;e*=d.height;a.save();a.globalAlpha=g_objWaterMarkMgr.m_watermarkPicAttr.opacity;a.translate((b.width-
f)/2+f/2,(b.height-e)/2+e/2);a.rotate(g_objWaterMarkMgr.m_watermarkPicAttr.rotate*c);a.drawImage(d,-(f/2),-(e/2),f,e);a.restore();e=b.toDataURL();dzeLayoutControl.setDocWatermarkSrc(e,g_nActiveEditNumber);this.m_watermarkTextAttr={text:"\ub300\uc678\ube44",font_family:"\uad74\ub9bc\uccb4",font_size:44,bold:!1,italic:!1,opacity:1}};d.src=this.m_watermarkPicAttr.path}else if(2===g_objWaterMarkMgr.watermarkMode){a.save();this.m_watermarkPicAttr={path:"",zoom:50,rotate:0,opacity:1};a.font=g_objWaterMarkMgr.m_watermarkTextAttr.font_size+
"px "+g_objWaterMarkMgr.m_watermarkTextAttr.font_family;!0===g_objWaterMarkMgr.m_watermarkTextAttr.bold&&(a.font+=" bold");a.fillStyle="black";a.globalAlpha=g_objWaterMarkMgr.m_watermarkTextAttr.opacity;var f=a.measureText(g_objWaterMarkMgr.m_watermarkTextAttr.text).width;a.translate(b.width/2,b.height/2);!0===g_objWaterMarkMgr.m_watermarkTextAttr.italic&&a.rotate(-45*c);a.fillText(g_objWaterMarkMgr.m_watermarkTextAttr.text,-f/2,0);a.restore();f=b.toDataURL();dzeLayoutControl.setDocWatermarkSrc(f,
g_nActiveEditNumber)}}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var f=0;return function(){return f<a.length?{done:!1,value:a[f++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,h){a!=Array.prototype&&a!=Object.prototype&&(a[f]=h.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,f){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:f})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(h){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(h||"")+"_"+f++,h)}var f=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,f){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var h=0,g={next:function(){if(h<a.length){var v=h++;return{value:f(v,a[v]),done:!1}}g.next=function(){return{done:!0,value:void 0}};return g.next()}};g[Symbol.iterator]=function(){return g};return g};
$jscomp.polyfill=function(a,f,h,g){if(f){h=$jscomp.global;a=a.split(".");for(g=0;g<a.length-1;g++){var v=a[g];v in h||(h[v]={});h=h[v]}a=a[a.length-1];g=h[a];f=f(g);f!=g&&null!=f&&$jscomp.defineProperty(h,a,{configurable:!0,writable:!0,value:f})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var Binder=new function(){function a(){return{openForm:function(d){try{onefficeCommon.getFileContent(d,function(c){var d=g_objCommonUtil.getToDateStr({fullyear:!1})+"_"+c.subject,a=onefficeGW.checkFileName(d,void 0,void 0,!1);d+=!0===fnObjectCheckNull(a)||0===a?"":"("+a+")";G(d,c.content)},void 0,void 0,void 0,void 0,!1)}catch(c){dalert(c)}},checkDoBind:function(){try{var d=!1;if("data_bind"===onefficeUtil.getRequestParameter("db_step")){var c=g_objEditorDocument[g_objPageControl.nEditNumber];0<c.querySelectorAll(".dze_external_data_area").length&&
(d=!0);!1===d&&0<c.querySelectorAll("table[mapping_key]").length&&(d=!0);!1===d&&0<c.querySelectorAll("img[chart_id][mapping_key]").length&&(d=!0)}return d}catch(C){dalert(C)}},getJSONData:function(){try{var d=onefficeUtil.getRequestParameter("db_server_addr"),c=onefficeUtil.getRequestParameter("db_server_param"),a={};if(!1===fnObjectCheckNull(c)){c=c.split(";");var e;for(e in c){var b=c[e];0<b.length&&(b=b.split("|"),a[b[0]]=b[1])}}d="http://dev.bizcubex.co.kr"+(0===d.indexOf("/")?"":"/")+d;duzon_http.ajax({type:"get",
url:d,async:!0,data:a,dataType:"json",timeout:3E4,loading_screen:!1,loading_image_url:"",loading_image_size:[],success:function(b){200!==b.RESULT_CODE||!0===fnObjectCheckNull(b.RESULT_DATA)||0===Object.keys(b.RESULT_DATA).length?cmnMsg.hideMsg():(dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ub370\uc774\ud130 \ubd84\uc11d \uc911"),Binder.getInstance().doBind(b.RESULT_DATA))},error:function(b){cmnMsg.hideMsg();dalert(b)}})}catch(k){dalert(k)}},doBind:function(a){try{!0===fnObjectCheckNull(a)?cmnMsg.hideMsg():
setTimeout(function(){Binder.getInstance().doBindExternalData(a,function(){var a=getEditorHTMLCode(!1,g_objPageControl.nEditNumber,!0,!0);onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,a,g_objPageControl.nEditNumber,function(){onefficeUtil.setSavedContent(a);oneffice.bNewFileStartSavedContent=a;onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate);g_objUndoRedo.registerInitialContentStack(g_objPageControl.nEditNumber)},
!0)})},1500)}catch(c){dalert(c)}},doBindExternalData:function(a,c){try{if(!0!==fnObjectCheckNull(a)){var d=!1,e=0,b=[];!1===fnObjectCheckNull(a.TABLE)&&(b.push({obj:"TABLE",delay:2E3}),dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ud45c / \ucc28\ud2b8 \uc0dd\uc131 \uc911"));!1===fnObjectCheckNull(a.CHART)&&b.push({obj:"CHART",delay:1E3});!1===fnObjectCheckNull(a.ITEMS)&&b.push({obj:"ITEMS",delay:1E3});E=setInterval(function(){if(0===b.length){if(clearInterval(E),cmnMsg.hideMsg(),!0===d)g_objPageControl.onSetDelayedUpdatePageTimerAll(.5,
function(){!1===fnObjectCheckNull(c)&&"function"===typeof c&&c()},!1)}else if(e++,b[0].delay===500*e){switch(b[0].obj){case "ITEMS":!0===f(a.ITEMS)&&(d=!0);break;case "TABLE":!0===g(a.TABLE)&&(d=!0);!1===fnObjectCheckNull(b[1])&&"ITEMS"===b[1].obj&&dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ub370\uc774\ud130 \ucc98\ub9ac \uc911");break;case "CHART":!0===H(a.CHART)&&(d=!0),!1===fnObjectCheckNull(b[1])&&"ITEMS"===b[1].obj&&dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ub370\uc774\ud130 \ucc98\ub9ac \uc911")}!1===
fnObjectCheckNull(b[1])&&(b[1].delay+=b[0].delay);b.shift()}},500)}}catch(k){dalert(k)}}}}function f(a){try{var c=Object.keys(a);if(0===c.length)return!1;for(var d=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByClassName("dze_external_data_area"),e,b,k=!1,w=0;w<d.length;w++)if(e=d[w],b=e.getAttribute("mapping_key"),!1===fnObjectCheckNull(b)&&0!==b.length)for(var l=0;l<c.length;l++)if(c[l]===b){h(e,a[b]);k=!0;w--;break}return k}catch(I){dalert(I)}}function h(a,c){try{var d=a.parentNode;
if("SPAN"===d.nodeName){var e=d.cloneNode(!1);g_objNodeUtil.splitOn(d.parentNode,a);d=d.parentNode}else e=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("span");e.style.fontFamily=a.style.fontFamily;e.style.fontSize=a.style.fontSize;e.textContent=c;d.insertBefore(e,a);d.removeChild(a)}catch(b){dalert(b)}}function g(a){try{var c=Object.keys(a);if(0===c.length)return!1;for(var d=g_objEditorDocument[g_objPageControl.nEditNumber].querySelectorAll("table[mapping_key]"),e,b,k=!1,w=0;w<
d.length;w++)if(e=d[w],b=e.getAttribute("mapping_key"),!1===fnObjectCheckNull(b)&&0!==b.length)for(var l=0;l<c.length;l++)if(c[l]===b){if(!0===Array.isArray(a[b])){var f=l=void 0,h=void 0,m=e,g=a[b];try{var n=new TableMatrix(m),p=m.rows,r=p.length-1,u=p[r].cells,z=g.length;m=!0;if(u.length===g[0].length){if(1!==p.length){u=p[r].cells;for(var q=0;q<u.length;q++)if(h=u[q],!1===g_objTableUtil.isBlankCell(h)){m=!1;break}!0===m&&z--}n.insertRow(r+1,z);!1===m&&r++;for(m=0;m<g.length;m++)for(q=f=0;q<n.colLength;q++)!1===
n.isShow(m+r,q)?f++:(l=g[m][q-f],!0!==fnObjectCheckNull(l)&&0!==l.length&&(h=n.getCell(m+r,q),g_objTableUtil.setCellInnerText(l,h)))}}catch(A){dalert(A)}}else v(e,a[b]);e.removeAttribute("mapping_key");k=!0;break}return k}catch(A){dalert(A)}}function v(a,c){try{var d=g_objEditorDocument[g_objPageControl.nEditNumber],e=null!==a?a.getElementsByClassName("dze_external_data_area"):d.getElementsByClassName("dze_external_data_area"),b=null,k=null,f=null,l=null,g=0;if(!1===fnObjectCheckNull(c.items)){f=
c.items;l=Object.keys(f);for(var t=null,m=null,x=null,n=0;n<e.length;n++)if(b=e[n],k=b.getAttribute("mapping_key"),!1===fnObjectCheckNull(k)&&0!==k.length)for(var p=0;p<l.length;p++)if(l[p]===k){t=g_objNodeUtil.getLoopParentElement(b,DZE_TAG_TD);null===a&&(a=g_objNodeUtil.getLoopParentElement(t,DZE_TAG_TABLE));x=new TableMatrix(a);m=x.getMatrixIndex(t);g=Math.max(g,m[m.length-1].row);h(b,f[k]);n--;break}}if(!1===fnObjectCheckNull(c.group)){var r=c.group;b=l=c=null;if(1<r.length){l=Object.keys(r[0].items);
a:try{x=m=t=f=k=null;n=1E4;p=0;for(var u=1E4,z=0;z<l.length;z++)for(var q=0;q<e.length;q++)if(f=e[q],t=f.getAttribute("mapping_key"),!1===fnObjectCheckNull(t)&&0!==t.length&&t===l[z]&&(m=g_objNodeUtil.getLoopParentElement(f,DZE_TAG_TD),null!==m)){if(null===k){var A=g_objNodeUtil.getLoopParentElement(f,DZE_TAG_TABLE);if(null===A){b=null;break a}k=new TableMatrix(A)}x=k.getMatrixIndex(m);n=Math.min(n,x[0].row);p=Math.max(p,x[x.length-1].row);u=Math.min(u,x[0].col)}var y=k.clone();p+1===y.rowLength-
1?y.removeRow(p+1):y.removeRow(p+1,y.rowLength-1);0===n-1?y.removeRow(n-1):y.removeRow(0,n-1);0<u&&y.removeCol(0,u-1);b={tableMatrix:k,cloneCells:y.table,colIndex:u}}catch(D){dalert(D),b=null}if(null===b)return g}for(e=0;e<r.length;e++){c=r[e];if(!1===fnObjectCheckNull(c.items)||!1===fnObjectCheckNull(c.group))g=v(a,c);if(e!==r.length-1){b.tableMatrix.makeMatrix();g_objTableOperation.autoInsertNewRow(b.tableMatrix,g,b.colIndex,b.cloneCells.cloneNode(!0));var B=b.tableMatrix.getCell(g,b.colIndex);
d.body.scrollTop=B.offsetTop}}}return g}catch(D){dalert(D)}}function H(a){try{var c=Object.keys(a);if(0===c.length)return!1;for(var d=g_objEditorDocument[g_objPageControl.nEditNumber].querySelectorAll("img[chart_id]"),e,b,f=!1,g=[],l=0;l<d.length;l++)if(e=d[l],b=e.getAttribute("mapping_key"),!1===fnObjectCheckNull(b)&&0!==b.length)for(var h=0;h<c.length;h++)if(c[h]===b){g.push({img:e,json:a[b]});f=!0;break}0<g.length&&F(g);return f}catch(t){dalert(t)}}function F(a){try{var c=a.shift(),d=c.img.offsetWidth,
e=c.img.offsetHeight,b=JSON.stringify(c.json);onefficeChart.initialize();onefficeChart.convStringToChartData(b);onefficeChart.makeChart(d,e);onefficeChart.bInsertChartTable=!1;onefficeChart.setInsertChartMode(g_objPageControl.nEditNumber,c.img).then(function(){onefficeChart.makeCanvasChartToImage(c.img,g_objPageControl.nEditNumber,!0);c.img.removeAttribute("mapping_key");0<a.length&&F(a)})}catch(k){dalert(k)}}function G(a,c){try{onefficeGW.createFileContent("",a,c,function(a){if(!1===fnObjectCheckNull(a))try{var c=
{db_step:"data_bind",db_server_addr:onefficeUtil.getRequestParameter("db_server_addr"),db_server_param:onefficeUtil.getRequestParameter("db_server_param")},b=oneffice.getBindDocPath(a,void 0,c);window.location.href=b}catch(k){dalert("oneffice.newFile-openWindow")}},void 0,!1)}catch(C){dalert(C)}}return{getInstance:function(){!0===fnObjectCheckNull(B)&&(B=a());return B}};var B,E};
function DzeVer(a,b){if("string"!==typeof a)throw new TypeError("invalid version");a=a.trim();if(!a.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/))throw new TypeError("invalid version");this.version=a;a=a.split(".");this.release=a[0];this.product=a[1];this.major=a[2];this.minor=a[3];return this}DzeVer.compare=function(a,b){a instanceof DzeVer||(a=new DzeVer(a));return a.compare(b)};
DzeVer.prototype={compare:function(a){a instanceof DzeVer||(a=new DzeVer(a));return this.version===a.version?0:this.compareIdentifiers(this.release,a.release)||this.compareIdentifiers(this.major,a.major)||this.compareIdentifiers(this.minor,a.minor)},compareIdentifiers:function(a,b){return a===b?0:a&&!b?-1:b&&!a?1:a<b?-1:1}};
var g_objPlaceholder=new function(){this.bFocus=!1;this.nEditNumber=0;this.timeoutID=null;this.DZE_CUSTOM_ATT_PLACEHOLDER=DZE_CUSTOM_ATT_PLACEHOLDER_TD;this.DZE_CUSTOM_ATT_FOCUS=DZE_CUSTOM_ATT_FOCUS;this.DZE_CUSTOM_ATT_HASTEXT=DZE_CUSTOM_ATT_HASTEXT;this.onmousedown=function(a,b){try{if(!g_readonlyMode){this.nEditNumber=b;var d=this.detectPlaceholder(a,!0);g_objPlaceholder.setPlaceholderFocus(d)}}catch(c){dalert(c)}};this.onkeyup=function(a,b){try{if(!g_readonlyMode){this.nEditNumber=b;var d=this.detectPlaceholder();
g_objPlaceholder.setPlaceholderFocus(d)}}catch(c){dalert(c)}};this.onkeydown=function(a,b){try{if(!g_readonlyMode){this.nEditNumber=b;var d=this.detectPlaceholder();g_objPlaceholder.setPlaceholderFocus(d)}}catch(c){dalert(c)}};this.setPlaceholderFocus=function(a){try{var b=this.bFocus?this.getCurPlaceholder(a):null;a?(this.bFocus=!0,a!=b&&(this.blur(b),this.focus(a))):(this.bFocus=!1,this.blur(b))}catch(d){dalert(d)}};this.detectPlaceholder=function(a,b){try{var d=null;d=a&&b?a.srcElement?a.srcElement:
a.target:g_objNodeUtil.getAncestorNodeOnCaret(this.nEditNumber);if(!d)return null;var c=this.getClosetPlaceholder(d);return c?c:null}catch(e){dalert(e)}};this.getClosetPlaceholder=function(a){try{for(var b=g_objNodeUtil;a&&!b.isLoopBreakNode(a);){if(this.isPlaceholder(a))return a;a=a.parentNode}return null}catch(d){dalert(d)}};this.isPlaceholder=function(a){try{return a&&1===a.nodeType&&"TD"===a.nodeName&&a.hasAttribute(this.DZE_CUSTOM_ATT_PLACEHOLDER)&&""!=a.getAttribute(this.DZE_CUSTOM_ATT_PLACEHOLDER)?
!0:!1}catch(b){dalert(b)}};this.getCurPlaceholder=function(a){try{return this.isPlaceholder(a)&&a.hasAttribute(this.DZE_CUSTOM_ATT_FOCUS)?a:g_objEditorDocument[this.nEditNumber].querySelector("td["+this.DZE_CUSTOM_ATT_PLACEHOLDER+"]["+this.DZE_CUSTOM_ATT_FOCUS+"]")}catch(b){dalert(b)}};this.getTextNode=function(a){return this.isPlaceholder(a)?g_objNodeUtil.getFirstTextNode(a):null};this.isBlankPlaceholder=function(a){try{if(!this.isPlaceholder(a))return!1;var b=a.getAttribute(this.DZE_CUSTOM_ATT_PLACEHOLDER);
if(!b)return!1;var d=g_objNodeUtil,c=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,g_bBrowserType_IE?d.canCaretExistOn:{acceptNode:d.canCaretExistOn},!1),e=c.firstChild(),f=c.nextNode();if(!f&&(!e||"BR"===e.nodeName||3===e.nodeType&&e.nodeValue===b)||f&&"BR"===f.nodeName&&(!e||3===e.nodeType&&e.nodeValue===b))return!0;var g=c.nextNode();return!g&&e&&f&&3===e.nodeType&&""===e.nodeValue&&"BR"===f.nodeName||(!g||"BR"===g.nodeName)&&e&&f&&g_objNodeUtil.isListItem(e)&&
(!f||"BR"===f.nodeName||3===f.nodeType&&f.nodeValue===b)?!0:!1}catch(h){dalert(h)}};this.setPlaceholderText=function(a){try{if(!this.isPlaceholder(a))return!1;var b=a.ownerDocument;if(!b)return!1;var d=a.getAttribute(this.DZE_CUSTOM_ATT_PLACEHOLDER);if(!d)return!1;var c=this.getTextNode(a);if(!c)return!1;g_objNodeUtil.isListItem(c)&&(c=c.firstChild);if("BR"!==c.nodeName&&3!==c.nodeType||"undefined"!==typeof g_objSplitUtil&&g_objSplitUtil.isSplitNode(a)&&g_objSplitUtil.getFirstSplitNode(a)!==a)return!1;
c.parentNode.replaceChild(b.createTextNode(d),c);a.removeAttribute(this.DZE_CUSTOM_ATT_HASTEXT);return!0}catch(e){dalert(e)}};this.removePlaceholderText=function(a,b){try{if(!this.isPlaceholder(a))return!1;var d=a.ownerDocument;if(!d)return!1;var c=this.getTextNode(a);if(!c)return!1;var e=null;g_objNodeUtil.isListItem(c)&&(e=c,c=c.firstChild);if("BR"!==c.nodeName&&3!==c.nodeType||"undefined"!==typeof g_objSplitUtil&&g_objSplitUtil.isSplitNode(a)&&g_objSplitUtil.getFirstSplitNode(a)!==a)return!1;c.nextSibling&&
"BR"===c.nextSibling.nodeName?c.parentNode.removeChild(c):c.parentNode.replaceChild(d.createElement("BR"),c);a.setAttribute(this.DZE_CUSTOM_ATT_HASTEXT,"true");!0===b&&e&&(e.style.listStyleType="none");return!0}catch(f){dalert(f)}};this.focus=function(a){try{this.isPlaceholder(a)&&!a.hasAttribute(this.DZE_CUSTOM_ATT_FOCUS)&&(a.setAttribute(this.DZE_CUSTOM_ATT_FOCUS,"true"),this.isBlankPlaceholder(a)&&(this.removePlaceholderText(a),g_objCaretUtil.moveCaret(a)))}catch(b){dalert(b)}};this.blur=function(a){try{this.isPlaceholder(a)&&
(a.removeAttribute(this.DZE_CUSTOM_ATT_FOCUS),this.isBlankPlaceholder(a)?this.setPlaceholderText(a):a.setAttribute(this.DZE_CUSTOM_ATT_HASTEXT,"true"))}catch(b){dalert(b)}};this.removeAllPlaceholderText=function(a,b){try{if(a&&1===a.nodeType){var d=a.querySelectorAll("td["+this.DZE_CUSTOM_ATT_PLACEHOLDER+"]");a=0;for(var c=d.length;a<c;a++)d[a].removeAttribute(this.DZE_CUSTOM_ATT_FOCUS),this.isBlankPlaceholder(d[a])&&this.removePlaceholderText(d[a],b)}}catch(e){dalert(e)}};this.setAllPlaceholderText=
function(a){try{if(a&&1===a.nodeType&&!g_readonlyMode){var b=a.querySelectorAll("td["+this.DZE_CUSTOM_ATT_PLACEHOLDER+"]");a=0;for(var d=b.length;a<d;a++)this.isBlankPlaceholder(b[a])?this.setPlaceholderText(b[a]):b[a].setAttribute(this.DZE_CUSTOM_ATT_HASTEXT,"true")}}catch(c){dalert(c)}};this.isPlaceholderSpan=function(a){try{return a&&1===a.nodeType&&"SPAN"===a.nodeName&&a.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_SPAN)?!0:!1}catch(b){dalert(b)}};this.isBlankPlaceholderSpan=function(a){try{if(!this.isPlaceholderSpan(a))return!1;
var b=a.firstChild;if(!b)return!0;if(!b.nextSibling&&3===b.nodeType){var d=removeZeroWidthSpaceFromString(b.nodeValue);if(""==d||d==a.getAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_SPAN))return!0}return!1}catch(c){dalert(c)}}};
var g_objALinkMgr=new function(){this.isBookmark=function(a){return a&&(a=a.getAttribute("name"),null!==a&&""!==a)?!0:!1};this.isStartBookmark=function(a){return this.isBookmark(a)&&g_objPropertyUtil.hasClass(a,"dze_bookmark_start_flag")};this.isEndBookmark=function(a){return this.isBookmark(a)&&g_objPropertyUtil.hasClass(a,"dze_bookmark_end_flag")};this.getPairBookmark=function(a,b){if(!a)return null;var c=a.getAttribute("name");if(!c)return null;var d=this.isStartBookmark(a)?!0:this.isEndBookmark(a)?
!1:null;if(null===d)return null;b||(b=a.ownerDocument.body);return b.querySelector("a[name='"+c+"']."+(d?"dze_bookmark_end_flag":"dze_bookmark_start_flag"))};this.getBookmarkName=function(a){return decodeURIComponent(a.replace("#",""))};this.doEvent=function(a){try{if(a&&!a.cancelBubble)switch(a.type){case "mousedown":g_bBrowserType_IE&&this.doLink(a);break;case "touchstart":!0===objOnefficeLoader.m_bHybrid&&this.doLink(a);break;case "click":g_bBrowserType_IE||this.doLink(a)}}catch(b){dalert(b)}};
this.doLink=function(a){try{if(a){var b=a.target||a.srcElement,c=a.nEditNumber,d=!a.altKey&&!a.shiftKey&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL),e=objOnefficeLoader.getEditorMode();if(e===EDITORMODE.VIEWER||e===EDITORMODE.VIEWER_SLIDESHOW||e===EDITORMODE.EDITOR&&(g_readonlyMode||d)||!0===objOnefficeLoader.m_bHybrid&&"viewerMode"===$("#one_viewer").scope().viewerMode){var g=g_objNodeUtil.getLoopParentElement(b,"a"),f=g?g_objEditMode.isContentEditable(g):!1;if(g&&(f||"_blank"!==g.target)){var h=
g.getAttribute("href");h&&0===h.indexOf("#")?this.goBookmark(this.findBookmark(c,h))&&TBCancelBubbleEvent(a):!h||g_bBrowserType_IE&&e===EDITORMODE.EDITOR&&g_readonlyMode&&d||(!0===objOnefficeLoader.m_bHybrid&&0<g.href.indexOf("/gw/oneffice/oneffice.do")?(openIn({url:g.href,mode:"r"}),TBCancelBubbleEvent(a)):(g_bBrowserType_IE&&(g.onclick=function(a){this.onclick=null;TBCancelBubbleEvent(a)}),g_browserCHK.iOS||(window.open(h,"","width=1366,height=768,left=0,top=0,resizable=yes,scrollbars=yes,noopener"),
TBCancelBubbleEvent(a))))}}}}catch(k){dalert(k)}};this.onEvtProcess=function(a,b){try{var c=a.href.toLowerCase();c.lastIndexOf("/")===c.length-1&&(c=c.substring(0,c.length-1));switch(b){case 1:case 2:b=c;var d=a.href.replace(document.location.href,"");b=d&&0===d.indexOf("#")?ID_RES_CONST_STRING_INSERT_BOOKMARK+"("+g_objALinkMgr.getBookmarkName(d)+")":a.getAttribute("href");a.title=b+" "+ID_RES_CONST_STRING_NOTI_HYPERLINK_GUIDE;a.style.cursor="pointer"}}catch(e){dalert(e)}};this.setHyperlinkAuto=function(a,
b){try{if(!g_readonlyMode){var c=!1,d=b?!0:!1;if(!0===d)var e=b;else{g_objCaretUtil.saveCaret(a);var g=g_objEditorDocument[a].getElementById(g_objCaretUtil.ID_CURRENT_CARET);if(!g)return;e=g.previousSibling}checkHyperlinkableText=function(a){if(!(!0===fnObjectCheckNull(a)||"a"===a.nodeName.toLowerCase()||1>a.childNodes.length))for(var b,c=0;c<a.childNodes.length;c++)b=a.childNodes[c],"a"!==b.nodeName.toLowerCase()&&(b.nodeType===ID_SELECTION_TEXT_NODE?(setHyperlink(1,b),setHyperlink(2,b),setHyperlink(3,
b)):checkHyperlinkableText(b))};setHyperlink=function(b,e){try{switch(b){case 1:var g=/\b(?:https?|ftp):\/\/[a-z0-9-+&@#\/%?=~_|!:,.;]*[a-z0-9-+&@#\/%=~_|]/gi;break;case 2:g=/(www\.[\S]+(\b|$))/gi;break;case 3:g=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gi}var f=e.nodeValue.match(g);if(!1===d){if(!0===fnObjectCheckNull(f)||1>f.length)b=2,g=/(www\.[\S]+(\b|$))/gi,f=e.nodeValue.match(g);if(!0===fnObjectCheckNull(f)||1>f.length)b=3,g=/[\w.]+@[a-zA-Z_-]+?(?:\.[a-zA-Z]{2,6})+/gi,f=e.nodeValue.match(g)}if(!(!0===
fnObjectCheckNull(f)||1>f.length))for(var h,k,n,r,t=f.length-1;0<=t;t--){k=f[t].trim();h=e.nodeValue;if(!1===d&&(h.length!==h.lastIndexOf(k)+k.length||t!==f.length-1))break;var u=h.lastIndexOf(k);if(0!==u){var w=h.charAt(u-1);if(!0===/^\s+$/.test(w))e.splitText(u),n=e.nextSibling;else continue}else n=e;1===b?h=n.nodeValue.replace(g,'<a href="$&" target="_blank">$&</a>'):2===b?h=n.nodeValue.replace(g,'<a href="http://$&" target="_blank">$&</a>'):3===b&&(h=n.nodeValue.replace(g,'<a href="mailto:$&">$&</a>'));
var v=g_objEditorDocument[a].createElement("a");r=g_objNodeUtil.getParentElement(n);r.insertBefore(v,n);r.removeChild(n);v.outerHTML=h;c=!0}}catch(x){dalert(x)}};if(!1===fnObjectCheckNull(e)){if(!0===d)checkHyperlinkableText(e);else if(e.nodeType===ID_SELECTION_TEXT_NODE){var f=e.nodeValue.charAt(e.nodeValue.length-1);!1===/^\s+$/.test(f)&&setHyperlink(1,e)}else checkHyperlinkableText(e);tranAllAnchorHrefSharp(a)}}}catch(h){dalert(h)}finally{!1===d&&g_objCaretUtil.restoreCaret(),!1===c&&!1===fnObjectCheckNull(e)&&
(e.nodeType===ID_SELECTION_TEXT_NODE?(b=g_objNodeUtil.getParentElement(e),!1===fnObjectCheckNull(b)&&b.normalize()):e.normalize())}};this.getPropContentParam=function(a){try{var b={arrValue:[]};b.arrValue[0]="";b.arrValue[1]="";b.arrValue[2]="";b.arrValue[3]="";b.arrValue[4]="";var c=this.setLinkSelection(a);fnObjectCheckNull(c)?b.arrValue[0]="":(b.arrValue[0]=""==c[0]?"":c[0],b.arrValue[1]=c[1],b.arrValue[2]=c[2],b.arrValue[3]=c[3],b.arrValue[4]=c[4]);return b}catch(d){dalert(d)}return null};this.setLinkHTML=
function(a,b){try{var c=a[0],d="",e="",g="",f="";d=a[1];e=a[2];"undefined"!=typeof a[3]&&(g=a[3]);if(!fnObjectCheckNull(g_objEditorDocument[b])){var h=getSelectionTypeForUpdateUI();if((ID_STRING_NAME_NONE==h||ID_STRING_NAME_TEXT==h)&&g_bBrowserType_WK&&!g_bBrowserType_CR&&""==getSelectionTextValue(b))return!1;this.selectCurrentAnchor(b)&&g_objEditorDocument[b].execCommand(ID_STRING_COMMAND_UNLINK,!1,null);var k="#"+(new Date).getTime(),l=g_objEditorDocument[b].getSelection();if(!0===fnObjectCheckNull(l))return!1;
var m=l.getRangeAt(0);if(!0===fnObjectCheckNull(m))return!1;if(!0===m.collapsed){var p=g_objEditorDocument[b].createTextNode(k);m.insertNode(p);!0===g_bBrowserType_IE&&(l.removeAllRanges(),l.addRange(m))}g_objEditorDocument[b].execCommand(ID_STRING_COMMAND_CREATELINK,!1,k);var q=g_objEditorDocument[b].querySelectorAll("a[href='"+k+"']"),n=q.length;1<n&&(g="",f=g_objCommonUtil.getUniqueID());for(a=0;a<n;a++)q[a].href=c,this.setLinkHTMLDetail(q[a],e,d,g),g_objALinkMgr.onEvtProcess(q[a],2),f&&q[a].setAttribute("dze_hyperlink_id",
f);return!0}}catch(r){dalert(r)}};this.setLinkHTMLDetail=function(a,b,c,d){try{if(!fnObjectCheckNull(a)&&("undefined"==typeof d&&(d=""),a.tagName.toLowerCase()==DZETAG.A)){if(""==b)try{a.removeAttribute("title")}catch(e){}if(""!=c)a.target=c;else try{a.removeAttribute("target")}catch(e){}""!=d&&a.innerHTML!=d&&(a.innerHTML=d)}}catch(e){dalert(e)}};this.setLinkHTMLToObject=function(a,b){try{var c=a[0],d=a[1],e=a[2],g=a[4];if(!g)return!1;var f=this.getObjectLink(g);if(!f){a=g_objCaretUtil;var h=a.createMarkerId("link_object");
a.saveCaret(b,h);f=g.ownerDocument.createElement("a");g.parentNode.replaceChild(f,g);f.appendChild(g);a.restoreCaret(b,h)}c&&(f.href=c);this.setLinkHTMLDetail(f,e,d);this.onEvtProcess(f,2);return!0}catch(k){dalert(k)}};this.getObjectLink=function(a){try{for(var b=g_objNodeUtil;a&&!b.isBlockNode(a);){if(this.isObjectLink(a))return a;a=a.parentNode}return null}catch(c){dalert(c)}};this.isObjectLink=function(a){return a&&"A"===a.nodeName&&a.firstChild&&a.firstChild===a.lastChild&&"IMG"===a.firstChild.nodeName?
!0:!1};this.removeLink=function(a){try{var b=this.getCurrentLink(a);if(!b)return!1;if(this.isObjectLink(b)&&this.removeObjectLink(b))return!0;var c=g_objCaretUtil,d=g_objNodeUtil,e=c.createMarkerId("unlink");c.saveCaret(a,e);var g=b.ownerDocument,f=null,h=b.getAttribute("dze_hyperlink_id");f=h?[].slice.call(g.querySelectorAll('a[dze_hyperlink_id="'+h+'"]')):[b];for(var k=h=b=null,l=null,m=f.length-1;0<=m;m--)b=f[m],h=b.parentNode,this.removeLinkAttribute(b),d.isBlockNode(b.parentNode)?(k=g.createElement("SPAN"),
d.copyAttribute(k,b),b.parentNode.replaceChild(k,b),d.moveNodesTo(k,b.firstChild)):(l=l||g.createDocumentFragment(),d.moveNodesTo(l,b.firstChild),b.parentNode.replaceChild(l,b)),d.normalize(h);c.restoreCaret(a,e);return!0}catch(p){dalert(p)}};this.removeObjectLink=function(a){try{if(!this.isObjectLink(a))return!1;var b=g_nActiveEditNumber,c=g_objCaretUtil,d=c.createMarkerId("unlink_object"),e=a.firstChild;c.saveCaret(b,d);a.parentNode.replaceChild(e,a);c.restoreCaret(b,d);return!0}catch(g){dalert(g)}};
this.removeLinkAttribute=function(a){try{a&&(a.removeAttribute("href"),a.removeAttribute("title"),a.removeAttribute("target"),a.removeAttribute("dze_hyperlink_id"),a.style.cursor="",""===a.style.cssText&&a.removeAttribute("style"))}catch(b){dalert(b)}};this.setLinkSelection=function(a){try{if(fnObjectCheckNull(g_objEditorDocument[a]))return null;if(window.attachEvent){var b=g_objEditorDocument[a].selection;if(fnObjectCheckNull(b))return null;var c=b.type;c=c.toLowerCase();var d=null;if(ID_STRING_NAME_NONE==
c||ID_STRING_NAME_TEXT==c){var e=b.createRange();if(fnObjectCheckNull(e))return null;var g=b.createRange();if(fnObjectCheckNull(g))return null;g.setEndPoint("EndToStart",e);b=a=!0;for(c=!1;a;){b?(g.moveEnd("character",1),b=!1):(g.moveStart("character",1),g.moveEnd("character",1));if(""==g.htmlText)break;var f=null;if(e.inRange(g))for(f=g.parentElement();!fnObjectCheckNull(f);){var h=f.tagName;if("A"==h.toUpperCase()){c=!0;a=!1;break}f=f.parentElement}else break;if(c&&(e.moveToElementText(f),e.select(),
d=this.getLinkInfo(f),null==d))return null}if(!c)for(f=e.parentElement();!fnObjectCheckNull(f);){h=f.tagName;if("A"==h.toUpperCase()){e.moveToElementText(f);e.select();d=this.getLinkInfo(f);if(null==d)return null;break}f=f.parentElement}return d}if(ID_STRING_NAME_CONTROL==c){var k=b.createRange();if(fnObjectCheckNull(k)||1!=k.length)return null;var l=k.item(0);h=l.tagName;if("A"==h.toUpperCase()){if(d=this.getLinkInfo(l),null==d)return null}else for(f=l.parentElement;!fnObjectCheckNull(f);){if("A"==
f.tagName.toUpperCase()){d=this.getLinkInfo(f);if(null==d)return null;break}f=f.parentElement}return d}}else{var m=this.getCurrentLink(a);if(!m)return null;d=this.getLinkInfo(m);return null==d?null:d}}catch(p){dalert(p)}return null};this.getLinkInfo=function(a){try{if(fnObjectCheckNull(a))return null;var b=a.href;"http:///"===b.toLowerCase()?b="http://":"http:"===b.toLowerCase()&&(b="http://");b.lastIndexOf("/")===b.length-1&&(b=b.substring(0,b.length-1));var c=checkAnchorHrefSharp(b);null!=c&&(b=
c);var d=a.target,e=a.title;c="";a.getAttribute("type")&&(c=a.getAttribute("type"));var g=a.innerText,f=Array(4);f[0]=b;f[1]=d;f[2]=e;f[3]=c;f[4]=g;return f}catch(h){dalert(h)}return null};this.getCurrentLink=function(a){try{var b=GetCurRange(a);if(!b)return null;for(var c=b.startContainer;c;){if("A"===c.nodeName)return c;c=c.parentNode}if(b.startContainer&&1===b.startContainer.nodeType&&b.startContainer===b.endContainer&&1===b.endOffset-b.startOffset&&(c=b.startContainer.childNodes[b.startOffset])&&
"A"===c.nodeName)return c}catch(d){dalert(d)}finally{}return null};this.selectCurrentAnchor=function(a){try{var b=this.getCurrentLink(a);if(!b)return null;this.selectAnchors(b);return b}catch(c){dalert(c)}};this.selectAnchors=function(a){try{var b=g_objNodeUtil;if(!a||!b.checkTagName(a,"a"))return!1;var c=g_objEditWindow[g_nActiveEditNumber],d=g_objEditorDocument[g_nActiveEditNumber];if(!c||!d)return!1;var e=[a],g=b.getAttribute(a,"dze_hyperlink_id");g&&(e=d.querySelectorAll('a[dze_hyperlink_id="'+
g+'"]'));var f=c.getSelection(),h=d.createRange();1<e.length?(h.setStartBefore(e[0]),h.setEndAfter(e[e.length-1])):h.selectNode(a);f.removeAllRanges();f.addRange(h)}catch(k){dalert(k)}};this.insertBookmark=function(a,b){try{var c=g_objEditorDocument[a];this.removeAllBookmarkWithNames(c.body,[b]);var d=GetCurRange(a);if(!d)return null;a=function(a){var d=c.createElement("a");d.setAttribute("name",b);d.className=a;d.style.textDecoration="none";return d};var e=null,g=null;if(d.collapsed)e=a("dze_bookmark_flag");
else{g=a("dze_bookmark_end_flag");var f=d.cloneRange();f.collapse(!1);f.insertNode(g);e=a("dze_bookmark_start_flag")}d.insertNode(e);return{start:e,end:g}}catch(h){dalert(h)}};this.removeBookmark=function(a){try{if(!a||!a.parentNode)return!1;var b=g_objPropertyUtil,c=g_objNodeUtil,d=a.getAttribute("name");if(null!==d&&""!==d){this.isStartBookmark(a)&&this.removeBookmark(this.getPairBookmark(a));a.removeAttribute("name");var e=a.getAttribute("href");if(null===e||""===e){a.removeAttribute("href");a.removeAttribute("title");
a.style.cursor="";""===a.style.cssText&&a.removeAttribute("style");b.removeClass(a,"dze_bookmark_flag");b.removeClass(a,"dze_bookmark_start_flag");b.removeClass(a,"dze_bookmark_end_flag");b=g_nActiveEditNumber;var g="dze_remove_bookmark_"+g_objCommonUtil.getUniqueID();g_objCaretUtil.saveCaret(b,g);if(a.firstChild){var f=a.ownerDocument.createElement("SPAN");c.copyAttribute(f,a);c.setInlineTextStyle(f,c.getInlineTextStyle(a));c.moveNodesTo(f,a.firstChild);a.parentNode.replaceChild(f,a)}else a.parentNode.removeChild(a),
c.normalize(a.parentNode);g_objCaretUtil.restoreCaret(b,g)}return!0}return!1}catch(h){dalert(h)}};this.removeAllBookmarkForPaste=function(a,b){try{var c=this.getBookmarkNameList(a);this.removeAllBookmarkWithNames(b,c)}catch(d){dalert(d)}};this.removeAllBookmarkWithNames=function(a,b){try{if(a&&b){var c=this.getBookmarkList(a);a="";for(var d=c.length-1;0<=d;d--)a=c[d].getAttribute("name"),0<=b.indexOf(a)&&this.removeBookmark(c[d])}}catch(e){dalert(e)}};this.removeAllOddBookmark=function(a){try{for(var b=
this.getBookmarkList(a),c=null,d=b.length-1;0<=d;d--)c=b[d],!this.isStartBookmark(c)&&!this.isEndBookmark(c)||this.getPairBookmark(c,a)||this.removeBookmark(c)}catch(e){dalert(e)}};this.removeAllOddEndBookmark=function(a){try{for(var b=this.getBookmarkList(a),c=null,d=b.length-1;0<=d;d--)c=b[d],this.isEndBookmark(c)&&!this.getPairBookmark(c,a)&&this.removeBookmark(c)}catch(e){dalert(e)}};this.getBookmarkList=function(a,b,c){try{a||(a=g_objEditorDocument[g_nActiveEditNumber].body);for(var d="undefined"!==
typeof c&&!0===c.bSkipEndBookmark?!0:!1,e=function(a){return d&&this.isEndBookmark(g[f])?!0:!1}.bind(this),g=[].slice.call(a.querySelectorAll("a[name]")),f=g.length-1;0<=f;f--)e(g[f])&&g.splice(f,1);"name"===b&&g.sort(function(a,b){a=a.getAttribute("name").toString().toLowerCase();b=b.getAttribute("name").toString().toLowerCase();return a<b?-1:a>b?1:0});return g}catch(h){dalert(h)}};this.getBookmarkNameList=function(a){try{var b=this.getBookmarkList(a);a=[];for(var c="",d=0,e=b.length;d<e;d++)(c=
b[d].getAttribute("name"))&&0>a.indexOf(c)&&a.push(c);return a}catch(g){dalert(g)}};this.findBookmark=function(a,b){try{var c="undefined"===typeof a?document:g_objEditorDocument[a];if(!c)return null;b=decodeURIComponent(b.replace("#",""));return c.body.querySelector("a[name='"+b+"']")}catch(d){dalert(d)}};this.goBookmark=function(a,b){try{if("undefined"!==typeof g_bSlideMode&&g_bSlideMode)return g_objShowMgr.showNSlide(this.getPageNum(a));!1!==b&&this.selectBookmark(a);return this.scrollBookmark(a)}catch(c){dalert(c)}};
this.selectBookmark=function(a){try{var b=this.getPairBookmark(a);if(b){var c=a.ownerDocument,d=c.defaultView.getSelection(),e=c.createRange();a.compareDocumentPosition(b)&Node.DOCUMENT_POSITION_PRECEDING?(e.setStartAfter(b),e.setEndBefore(a)):(e.setStartAfter(a),e.setEndBefore(b));d.removeAllRanges();d.addRange(e)}else this.selectAnchors(a)}catch(g){dalert(g)}};this.getPageNum=function(a){try{if("undefined"!==typeof g_bSlideMode&&g_bSlideMode){for(;a&&"BODY"!==a.nodeName;){if(g_objPropertyUtil.hasClass(a,
"dze_printpreview_pagebox"))return parseInt(a.getAttribute("pageNum"),10);a=a.parentNode}return 0}return g_objPageControl.getPageNum(a)}catch(b){dalert(b)}};this.scrollBookmark=function(a,b){try{if(!a)return!1;var c=a.ownerDocument.getElementById("dze_document_main_container");c||(c=a.ownerDocument.body);var d=g_objZoom.getDocZoomValue()/100,e=g_objPositionUtil.getDocumentTop(a)*d;e-=10*d;if(!1!==b){var g=c.scrollTop;a=e-g;b=5E3;0>a&&(b*=-1);.3<Math.abs(a/b)&&(b=a/.3);var f=.03*b,h=setInterval(function(){g+=
f;0<=f&&g>=e?(g=e,clearInterval(h)):0>f&&g<=e&&(g=e,clearInterval(h));c.scrollTop=g},30)}else c.scrollTop=e;return!0}catch(k){dalert(k)}}};