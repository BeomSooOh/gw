ONEFFICE_SERVER_API_BASE_PATH="http://localhost/onefficeApi/";ONEFFICE_SERVER_API_GET_CHECK_SESSION=ONEFFICE_SERVER_API_BASE_PATH+"checkSession.do";
var g_readonlyMode=!1,MAIN_DOMAIN="wehago.com",SUB_DOMAIN="",WEHAGO_MAIN_LOCATION="//dev."+MAIN_DOMAIN+"/#/login",WEDRIVE_MAIN_LOCATION="//dev."+MAIN_DOMAIN+"/#/wedrive",CLNT_ID="oneffice",WE_DRIVE_WAS_IP="dev.api.wehago.com",FileListURL="http://"+WE_DRIVE_WAS_IP+"/WeDriveServer/services/csb",WeDriveURL="http://"+WE_DRIVE_WAS_IP+"/WeDriveServer/services/login",ObjectURL="http://dev.api."+MAIN_DOMAIN+"/ObjectStorageCommon/services/common",WehagoCommonApiUrl=WE_DRIVE_WAS_IP="https://api."+MAIN_DOMAIN,
testApi="http://172.16.114.204:8080",objectStorageUrl=ObjectURL,SAVETYPE={DEFAULT:0,AUTO:1,HIDE:2},onefficeWE={m_bDevMode:objOnefficeLoader.isDev()?1:0,m_nSaveCount:0,currFileExt:"",setOnefficeWeEnv:function(){try{var a=onefficeUtil.getDomainInfo(1)+"."+onefficeUtil.getDomainInfo(2);MAIN_DOMAIN=!onefficeWE.m_bDevMode&&a&&a.length?a:MAIN_DOMAIN;onefficeWE.m_bDevMode?(WEHAGO_MAIN_LOCATION="//dev."+MAIN_DOMAIN+"/#/login",WEDRIVE_MAIN_LOCATION="//dev."+MAIN_DOMAIN+"/#/wedrive",WE_DRIVE_WAS_IP="http://dev.api."+
MAIN_DOMAIN,FileListURL=WE_DRIVE_WAS_IP+"/WeDriveStorage/services/csb",WeDriveURL=WE_DRIVE_WAS_IP+"/WeDriveStorage/services/login",objectStorageUrl=ObjectURL="http://dev.api."+MAIN_DOMAIN+"/ObjectStorageCommon/services/common",WePermissionUrl="http://dev.api."+MAIN_DOMAIN+"/WeDriveStorage/services/csb",testApi="http://172.16.114.204:8080/WeDriveStorage/services/csb"):(WEHAGO_MAIN_LOCATION="https://www."+MAIN_DOMAIN+"/#/login",WEDRIVE_MAIN_LOCATION="https://www."+MAIN_DOMAIN+"/#/wedrive",WE_DRIVE_WAS_IP=
"https://api."+("wehagot.com"===MAIN_DOMAIN?"wehago.com":MAIN_DOMAIN),FileListURL=WE_DRIVE_WAS_IP+"/WeDriveStorage/services/csb",WeDriveURL=WE_DRIVE_WAS_IP+"/WeDriveStorage/services/login",objectStorageUrl=ObjectURL=WE_DRIVE_WAS_IP+"/ObjectStorageCommon/services/common",WePermissionUrl=WE_DRIVE_WAS_IP+"/WeDriveStorage/services/csb")}catch(b){dalert(b)}},setParam2Tool:function(){try{g_onefficeWeTool.m_OrgFileName=onefficeUtil.getRequestParameter("filename"),g_onefficeWeTool.m_fid=onefficeUtil.getRequestParameter("fid"),
g_onefficeWeTool.m_did=onefficeUtil.getRequestParameter("did"),g_onefficeWeTool.m_BucketType=onefficeUtil.getRequestParameter("BucketType"),g_onefficeWeTool.m_ServiceKey=onefficeUtil.getRequestParameter("ServiceKey"),g_onefficeWeTool.m_ServiceCode=onefficeUtil.getRequestParameter("ServiceCode"),g_onefficeWeTool.m_Cno=onefficeUtil.getRequestParameter("cno"),g_onefficeWeTool.m_clCno=onefficeUtil.getRequestParameter("clCno"),g_onefficeWeTool.m_portalID=onefficeUtil.getRequestParameter("portal_id"),g_onefficeWeTool.m_userName=
onefficeUtil.getRequestParameter("user_name"),g_onefficeWeTool.m_IsWeDrive=onefficeUtil.getRequestParameter("isWedrive"),g_onefficeWeTool.m_WeDriveToken=onefficeUtil.getRequestParameter("wedriveToken"),g_onefficeWeTool.m_strHelp=onefficeUtil.getRequestParameter("help"),g_onefficeWeTool.m_langCode=onefficeUtil.getRequestParameter("lang")||"ko"}catch(a){dalert(a)}},checkDocPermission:function(a,b){try{var c=new XMLHttpRequest;c.open("POST",WePermissionUrl,!0);c.onreadystatechange=function(){if(4===
this.readyState)if(200===this.status){var c=JSON.parse(this.response);c&&"object"===typeof c.resultData?a(c.resultData):b()}else cmnCtrlToast.showToastMsg(null,"\ub85c\uadf8\uc778 \uc815\ubcf4\uac00 \ub9cc\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",1,"screen_center"),setTimeout(function(){document.location.href=WEHAGO_MAIN_LOCATION},1)};g_onefficeWeTool.reqDocPermissionCheck(c);return!0}catch(d){dalert(d)}},notAllowedPermissionCB:function(a){try{alert(ID_RES_CONST_STRING_WE_NOT_SUPPORTED),document.location.href=
a?WEHAGO_MAIN_LOCATION:WEDRIVE_MAIN_LOCATION}catch(b){dalert(b)}},allowedPermissionCB:function(){try{onefficeWE.setCurrFileInfo(!1);var a=new XMLHttpRequest;a.open("POST",objectStorageUrl,!0);a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);"string"==typeof a.resultCode&&"0000"===a.resultCode?"success"===a.serverMsg?g_onefficeWeTool.downloadFileStreamProcess({orgFileName:g_onefficeWeTool.m_OrgFileName,fileName:g_onefficeWeTool.m_OrgFileName,
s3Auth:a.resultList[0].Auth,s3Date:a.resultList[0].Date,url:a.resultList[0].url,async:!0},function(a){g_onefficeWeTool.m_bViewer?fnLoadViewModeSuccessCB({content:a,subject:g_onefficeWeTool.m_OrgFileName},g_onefficeWeTool.m_ctrlViewer):g_onefficeWeTool.openContentsSuccessCB(a,null,"download FileStream Success!");g_onefficeWeTool.reqListOpen()},function(a){g_onefficeWeTool.m_bViewer?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALREADY_DELETED_DOCUMENT,1,"screen_center"):onefficeWE.openContentsErrorCB(0,
a)}):(alert(a.serverMsg),alert("get download url failed")):(alert(a.resultCode),alert("reqOpenFileProcess failed"))}};g_onefficeWeTool.reqOpenFileProcess(a)}catch(b){dalert(b)}},openFileProcess:function(a){try{return onefficeWE.setParam2Tool(),"1"!=g_onefficeWeTool.m_strHelp?onefficeWE.checkDocPermission(function(b){g_onefficeWeTool.m_nDocPermission=b.result;switch(g_onefficeWeTool.m_nDocPermission){case 1:case 2:onefficeWE.allowedPermissionCB();break;default:return onefficeWE.notAllowedPermissionCB(!1)}"number"==
typeof a&&!0===oneffice.autoSave&&onefficeWE.autoSaveEvtProcess(a)},function(){return onefficeWE.notAllowedPermissionCB(!0)}):(g_onefficeWeTool.m_nDocPermission=1,g_onefficeWeTool.m_OrgFileName=ID_RES_STRING_VIDEO_LEARN_ONEFFICE+".one",onefficeUtil.openHTMLContent(g_onefficeWeTool.m_strHelp,"video_manual.html")),!0}catch(b){dalert(b)}},imgFileUrlList:[],saveImgFileProcess:function(a,b,c){try{if("undefined"==typeof a)return"function"===typeof c?c():!1;g_onefficeWeTool.m_IsPublic=!1;g_onefficeWeTool.m_OrgFileName=
a.name;g_onefficeWeTool.m_OrgFileType=a.type;g_onefficeWeTool.m_fid=g_onefficeWeTool.getNewFID();onefficeWE.imgFileUrlList.push(g_onefficeWeTool.m_fid);g_onefficeWeTool.m_IsWeDrive&&(g_onefficeWeTool.m_WeDrivePath=WeDriveURL);var d=new XMLHttpRequest;d.open("POST",objectStorageUrl,!0);d.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var b=JSON.parse(this.response);"string"==typeof b.resultCode&&"0000"===b.resultCode?"success"===b.serverMsg?g_onefficeWeTool.reqUploadImgFile({objFile:a,
newFileName:g_onefficeWeTool.m_OrgFileName,serviceKey:g_onefficeWeTool.m_ServiceKey,serviceCode:g_onefficeWeTool.m_ServiceCode,bucketType:g_onefficeWeTool.m_BucketType,cno:g_onefficeWeTool.m_Cno,s3Auth:b.resultList[0].Auth,s3Date:b.resultList[0].Date,url:b.resultList[0].url,hSuccess:g_onefficeWeTool.saveImgComplete,isPublic:g_onefficeWeTool.m_IsPublic,async:!0,isWedrive:void 0===g_onefficeWeTool.m_IsWeDrive?"":g_onefficeWeTool.m_IsWeDrive,wedriveToken:void 0===g_onefficeWeTool.m_WeDriveToken?"":g_onefficeWeTool.m_WeDriveToken,
wedrivePath:void 0===g_onefficeWeTool.m_WeDrivePath?"":g_onefficeWeTool.m_WeDrivePath},null,null):(alert(b.serverMsg),alert("get upload url failed")):(alert(b.resultCode),alert("reqSaveFileProcess Img failed"))}};g_onefficeWeTool.reqSaveFileProcess(d,!1)}catch(e){dalert(e)}},setSaveType:function(a){g_onefficeWeTool.m_nSaveType=a},saveFileProcess:function(a,b,c){try{var d=!0,e=g_onefficeWeTool.createContentsFile(a,g_onefficeWeTool.m_OrgFileName,"text/html");if("undefined"==typeof e)return"function"===
typeof c?c():!1;g_onefficeWeTool.m_IsPublic=!1;g_onefficeWeTool.m_OrgFileType=e.type&&e.type.length?e.type:"application/octet-stream";g_onefficeWeTool.isWedrive&&(g_onefficeWeTool.m_WeDriveToken=WeDriveURL);if(!0===dzeUiConfig.bTempSaveToLocalStorage){var f=g_onefficeWeTool.m_fid;f=f.replace("-","");var g={doc_no:g_onefficeWeTool.m_fid,doc_name:g_onefficeWeTool.m_OrgFileName,content:a,mod_date:duzon_http.getCurrTime()};onefficeUtil.saveTempDataToLocalStorage(f,g)}d=!0===oneffice.bLastSave?!1:!0;var h=
new XMLHttpRequest;h.open("POST",objectStorageUrl,d);h.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var f=JSON.parse(this.response);"string"==typeof f.resultCode&&"0000"===f.resultCode?(dlog("reqSaveFilePro_Resp = serverMsg =- "+f.serverMsg),"success"===f.serverMsg?g_onefficeWeTool.reqUploadFile({curContents:a,objFile:e,fid:g_onefficeWeTool.m_fid,newFileName:g_onefficeWeTool.m_OrgFileName,serviceKey:g_onefficeWeTool.m_ServiceKey,serviceCode:g_onefficeWeTool.m_ServiceCode,
bucketType:g_onefficeWeTool.m_BucketType,cno:g_onefficeWeTool.m_Cno,s3Auth:f.resultList[0].Auth,s3Date:f.resultList[0].Date,url:f.resultList[0].url,hSuccess:g_onefficeWeTool.saveComplete,isPublic:g_onefficeWeTool.m_IsPublic,async:d,isWedrive:void 0===g_onefficeWeTool.m_IsWeDrive?"":g_onefficeWeTool.m_IsWeDrive,wedriveToken:void 0===g_onefficeWeTool.m_WeDriveToken?"":g_onefficeWeTool.m_WeDriveToken,wedrivePath:void 0===g_onefficeWeTool.m_WeDriveToken?"":g_onefficeWeTool.m_WeDriveToken},b,c):(alert(f.serverMsg),
alert("get upload url failed"))):(alert(f.resultCode),alert("reqSaveFileProcess failed"))}};g_onefficeWeTool.reqSaveFileProcess(h,!0)}catch(k){dalert(k)}},loadOfficeLayout:function(a){try{onefficeWE.setOnefficeWeEnv(),document.cookie.length?(duzon_http.showLoading(),oneffice.setListViewMgr(),dzeLayoutControl.setOfficeLayout(a,function(a){onefficeWE.openFileProcess(a)})):(alert("wehago not connected."),document.location.href=WEHAGO_MAIN_LOCATION)}catch(b){dalert(b)}},autoSaveEvtProcess:function(a){try{try{window.attachEvent?
(window.attachEvent("beforeunload",function(b){if(!0!==g_readonlyMode&&!0===g_objOnefficeEditor.isDocumentLoaded){var c=getEditorHTMLCode(!1,a,!0,!0);onefficeUtil.checkSameContent(c)||(b.returnValue=ID_RES_CONST_STRING_CHANGES_NOT_SAVED)}}),window.attachEvent("onunload",function(){onefficeWE.exit(a)})):window.addEventListener&&(window.addEventListener("beforeunload",function(b){if(!0!==g_readonlyMode&&!0===g_objOnefficeEditor.isDocumentLoaded){var c=getEditorHTMLCode(!1,a,!0,!0);onefficeUtil.checkSameContent(c)||
(b.returnValue=ID_RES_CONST_STRING_CHANGES_NOT_SAVED)}}),window.addEventListener("unload",function(){onefficeWE.exit(a)},!1))}catch(b){}2==g_onefficeWeTool.m_nDocPermission&&setInterval(function(){dlog("------------------ AutoSave Start");var b=getEditorHTMLCode(!1,a,!0);onefficeUtil.checkSameContent(b)?dlog("auto_save :: no modify data -> not saved!"):(dlog("auto_save :: save start"),oneffice.currFolderSeq="",onefficeWE.setSaveType(SAVETYPE.AUTO),onefficeWE.saveFileProcess(b,function(){onefficeUtil.setSavedContent(b);
g_objCommonUtil.log("modify data -> auto saved ok! save finish");g_onefficeWeTool.reqListSave(!0)},function(){g_objCommonUtil.log("auto save File Process Error");onefficeWE.setSaveType(SAVETYPE.DEFAULT)}))},1E3*oneffice.autoSaveTime)}catch(b){dalert(b)}},openFileContentSuccessCB:function(a){try{if(a){onefficeWE.setCurrFileInfo(!1);onefficeUtil.setSavedContent(a);setEditorHTMLCode(a,!1,0);dzeLayoutControl.applyPaperSizeProperty(0);dzeLayoutControl.setDocPageColor(0);g_objZoom.setConfigDocZoomPropertyInfo(0);
dzeLayoutControl.setDocPrintMargin(0);changeCss(".editorContainer","opacity","1",document);switch(g_onefficeWeTool.m_nDocPermission){case 1:fnCommandReadOnlyMode(nEditNumber,1.5)}initializeDocFocus(0);dzeLayoutControl.setEditAreaSize(0,!0);dzeUiConfig.bOfficePagingMode&&g_objPageControl.initializeMultiPageMode(0);fnHandler_viewRulerbar(null,null,0);!0===g_readonlyMode&&onefficeUtil.setReadonlyNotificationBar(0);g_objZoom.initDocZoomPropertyInfo(0)}else dzeLayoutControl.setReadonlyMode(!0,0),alert("\uc798\ubabb\ub41c \ud638\ucd9c\uc785\ub2c8\ub2e4."),
document.location.href=WEHAGO_MAIN_LOCATION}catch(b){dalert(b)}},openContentsErrorCB:function(a,b){try{duzon_http.hideLoading(),dzeLayoutControl.setReadonlyMode(!0,a),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_INVALID_CALL,1,"screen_center"),!0!==g_browserCHK.mobile&&setTimeout(function(){document.location.href=WEDRIVE_MAIN_LOCATION},1E3)}catch(c){dalert(c)}},setCurrFileInfo:function(a,b){try{var c=g_onefficeWeTool.m_OrgFileName.split(".");oneffice.currFileSubject=c[0];onefficeWE.currFileExt=
c[1];oneffice.parentFileContent=oneffice;oneffice.parentFileContent.subject=oneffice.currFileSubject;"undefined"==typeof a&&(oneffice.currFileModDate="undefined"!=typeof b?"object"==typeof b?getFullDateFromTimeStamp(b.time):b:duzon_http.getCurrTime(),oneffice.parentFileContent.moddate=oneffice.currFileModDate);onefficeUtil.showDocSubject()}catch(d){dalert(d)}},exit:function(a){try{if(0!=onefficeUtil.getCookieValue("AUTH_A_TOKEN"))if(!0===g_readonlyMode)dlog("readonly mode"),g_onefficeWeTool.reqListSave(!1);
else{var b=getEditorHTMLCode(!1,a,!0);onefficeUtil.checkSameContent(b)?(dlog("no modify data -> not saved!"),g_onefficeWeTool.reqListSave(!1)):(g_onefficeWeTool.reqListSave(!0),onefficeUtil.showDocSubject(ID_RES_CONST_STRING_SAVING_DATA),duzon_http.showLoading(),oneffice.bLastSave=!0,oneffice.currFolderSeq="",onefficeWE.saveFileProcess(b,function(){},function(){duzon_http.hideLoading()}))}}catch(c){dalert(c)}}},g_onefficeWeTool=new function(){this.m_nDocPermission=this.m_ts=0;this.m_nSaveType=SAVETYPE.DEFAULT;
this.m_bViewer=!1;this.m_ctrlViewer=null;this.m_strHelp="";this.m_CancelHTTP=this.m_ErrorHTTP=this.m_SuccessHTTP=null;this.m_curContents="";this.m_FileSize=this.m_newFileName=null;this.m_createDate="";this.m_did=this.m_fid=0;this.m_WeDriveToken=this.m_IsWeDrive=this.m_clCno=this.m_Cno=this.m_BucketType=this.m_ServiceCode=this.m_ServiceKey=this.m_ModDate=this.m_OrgFileType=this.m_OrgFileName=null;this.m_portalID=0;this.m_userName="";this.m_WeDrivePath=this.m_IsPublic=null;this.m_langCode="ko";this.m_uploadImgList=
[];this.getNewFID=function(){try{var a=onefficeUtil.getNewSeq().toString(),b=WehagoUtil.getTransactionId(5);return a+b}catch(c){dalert(c)}};this.setUploadImgList=function(){try{g_onefficeWeTool.m_uploadImgList&&(delete g_onefficeWeTool.m_uploadImgList,g_onefficeWeTool.m_uploadImgList=[]);var a="";a=g_onefficeWeTool.m_bViewer?document.images:g_objEditorDocument[0].images;for(var b=a.length,c=0;c<b;c++){var d=a[c].src;if(!(0<=d.search("oneffice/image"))&&0<=d.search("wehago")){d=d.split("/");var e=
d.length-1;g_onefficeWeTool.m_uploadImgList.push(d[e])}}var f=g_objEditorDocument[0].getElementsByTagName("source");for(c=0;c<f.length;c++)d=f[c].src,0<=d.search("wehago")&&(d=d.split("/"),e=d.length-1,g_onefficeWeTool.m_uploadImgList.push(d[e]));var g=g_objEditorDocument[0].getElementsByTagName("table");for(c=0;c<g.length;c++)g[c].style.backgroundImage&&(d=g[c].style.backgroundImage,0<=d.search("wehago")&&(d=d.split("/"),e=d.length-1,g_onefficeWeTool.m_uploadImgList.push(d[e])));var h=g_objEditorDocument[0].getElementsByTagName("td");
for(c=0;c<h.length;c++)h[c].style.backgroundImage&&(d=h[c].style.backgroundImage,0<=d.search("wehago")&&(d=d.split("/"),e=d.length-1,g_onefficeWeTool.m_uploadImgList.push(d[e])))}catch(k){dalert(k)}};this.reqDocPermissionCheck=function(a){try{var b={cno:encodeURI(onefficeUtil.getCookieValue("cell_company_no")),TokenID:encodeURI(onefficeUtil.getCookieValue("AUTH_A_TOKEN")),FileUniqueKey:encodeURI(g_onefficeWeTool.m_fid)},c=JSON.stringify(b);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));
a.setRequestHeader("service","wedriveShareService");a.setRequestHeader("method","checkShareOnfficeFilePermission");var d=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",d);var e=WehagoUtil.getWehagoSig(d,WePermissionUrl);a.setRequestHeader("wehago-sign",e);a.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);a.send(c)}catch(f){dalert(f)}};this.reqOpenFileProcess=function(a){try{var b="ServiceKey="+encodeURI(g_onefficeWeTool.m_ServiceKey)+"&ServiceCode="+encodeURI(g_onefficeWeTool.m_ServiceCode)+
"&BucketType="+encodeURI(g_onefficeWeTool.m_BucketType)+"&cno="+encodeURI(g_onefficeWeTool.m_Cno)+"&FileName="+encodeURI(g_onefficeWeTool.m_fid);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));a.setRequestHeader("service","objectStorageService");a.setRequestHeader("method","getOnefficeFileDownloadSignature");a.setRequestHeader("client-id",CLNT_ID);var c=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",c);var d=WehagoUtil.getWehagoSig(c,objectStorageUrl);
a.setRequestHeader("wehago-sign",d);a.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);a.send(b)}catch(e){dalert(e)}};this.downloadFileStreamProcess=function(a,b,c){try{var d=new XMLHttpRequest;d.open("GET",a.url,a.async);d.responseType="arraybuffer";d.onreadystatechange=function(){if(4===d.readyState)if(200===d.status){var a=new Blob([d.response],{type:d.getResponseHeader("Content-Type")}),f=new FileReader;f.onload=function(){var a=document.createElement("iframe");document.body.appendChild(a);
a.contentDocument.documentElement.innerHTML=f.result;var c=a.contentDocument.body.innerHTML.trim();document.body.removeChild(a);"function"===typeof b&&b(c)};f.readAsText(a)}else"function"===typeof c&&c(this.response)};g_onefficeWeTool.reqDownloadFileStream(d,a)}catch(e){dalert(e)}};this.reqDownloadFileStream=function(a,b){try{a.setRequestHeader("x-amz-date",b.s3Date),a.setRequestHeader("Authorization",b.s3Auth),a.setRequestHeader("url",b.url),a.send()}catch(c){dalert(c)}};this.createContentsFile=
function(a,b,c){try{if(a.length){if(!c.length||typeof("undefined"==c))c="text/html";a=a.replace(/break\-after:\s*page;/gi,"page-break-after: always;");var d=null,e=new Blob(['<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /></head><body>',a,"</body></html>"],{type:c});g_bBrowserType_IE?d=e:(d=new File([e],b),g_onefficeWeTool.m_createDate=d.lastModified);return d}}catch(f){dalert(f)}};this.reqSaveFileProcess=function(a,b){try{var c="Content-Type="+encodeURI(g_onefficeWeTool.m_OrgFileType)+
"&cno="+encodeURI(g_onefficeWeTool.m_Cno)+"&ServiceKey="+encodeURI(g_onefficeWeTool.m_ServiceKey)+"&ServiceCode="+encodeURI(g_onefficeWeTool.m_ServiceCode)+"&BucketType="+encodeURI(g_onefficeWeTool.m_BucketType)+"&FileName="+encodeURI(g_onefficeWeTool.m_fid)+"&isPublicURL="+encodeURI(g_onefficeWeTool.m_IsPublic)+"&isOneffice="+encodeURI(b);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));a.setRequestHeader("service","objectStorageService");a.setRequestHeader("method",
"getUploadSignature");a.setRequestHeader("client-id",CLNT_ID);var d=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",d);var e=WehagoUtil.getWehagoSig(d,objectStorageUrl);a.setRequestHeader("wehago-sign",e);a.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);a.send(c)}catch(f){dalert(f)}};this.reqUploadImgFile=function(a,b,c){try{duzon_http.showLoading();var d=a.objFile;g_onefficeWeTool.m_OrgFileName=a.newFileName;g_onefficeWeTool.m_newFileName=a.newFileName;g_onefficeWeTool.m_FileSize=
d.size;g_onefficeWeTool.m_OrgFileType=d.type;g_onefficeWeTool.m_SuccessHTTP=a.hSuccess;var e=new XMLHttpRequest;e.open("PUT",a.url,a.async);e.onreadystatechange=function(a){4===e.readyState&&(200===e.status?0==this.response.length?g_onefficeWeTool.uploadImgCompleteListener(a,null,null):dlog("reqUploadFile[S3] -  resp_len >0 "):(dlog("reqUploadImgFile[S3] status Not 200 "),alert(e.status),alert("s3 error")),duzon_http.hideLoading())};e.setRequestHeader("Content-Type",g_onefficeWeTool.m_OrgFileType);
e.setRequestHeader("x-amz-date",a.s3Date);e.setRequestHeader("Authorization",a.s3Auth);e.send(d)}catch(f){duzon_http.hideLoading(),dalert(f)}};this.reqUploadFile=function(a,b,c){try{var d=a.objFile;g_onefficeWeTool.m_curContents=a.curContents;g_onefficeWeTool.m_OrgFileName=a.newFileName;g_onefficeWeTool.m_newFileName=a.newFileName;g_onefficeWeTool.m_FileSize=d.size;g_onefficeWeTool.m_SuccessHTTP=a.hSuccess;var e=new XMLHttpRequest;e.open("PUT",a.url,a.async);e.onreadystatechange=function(a){4===e.readyState&&
(200===e.status?0==this.response.length?"function"===typeof b&&(dlog("reqUploadFile[S3] - successCB"),g_onefficeWeTool.uploadCompleteListener(a,b,c)):dlog("reqUploadFile[S3] -  resp_len >0 "):(alert(e.status),alert("s3 error")))};e.setRequestHeader("Content-Type",g_onefficeWeTool.m_OrgFileType);e.setRequestHeader("x-amz-date",a.s3Date);e.setRequestHeader("Authorization",a.s3Auth);e.send(d)}catch(f){dalert(f)}};this.uploadCompleteListener=function(a,b,c){try{if(""===a.target.responseText){var d=new XMLHttpRequest;
d.open("POST",objectStorageUrl,!1);d.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var a=JSON.parse(this.response);if("string"==typeof a.resultCode&&"0000"===a.resultCode)if(dlog("uploadCompleteListener serverMsg = "+a.serverMsg),"success"===a.serverMsg){a={newFileName:g_onefficeWeTool.m_fid,orgFileName:g_onefficeWeTool.m_OrgFileName,thumbnail:void 0===a.resultList[0]?"":a.resultList[0],fileSize:void 0===a.resultList[2]?0:a.resultList[2],bucketType:g_onefficeWeTool.m_BucketType,
isPublic:g_onefficeWeTool.m_IsPublic};var d=ID_RES_CONST_STRING_SAVING_DATA;g_onefficeWeTool.m_nSaveType==SAVETYPE.AUTO?d=ID_RES_CONST_STRING_AUTO_SAVED:g_onefficeWeTool.m_nSaveType==SAVETYPE.HIDE&&(d="");g_onefficeWeTool.m_SuccessHTTP&&(g_onefficeWeTool.m_SuccessHTTP(a,d),b())}else alert(a.serverMsg),c(),g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP(a.serverMsg);else alert(a.resultCode),c()}else alert(this.status),c()};var e=WehagoUtil.getFileExt(g_onefficeWeTool.m_OrgFileName);g_onefficeWeTool.reqUploadComplete(d,
e)}else c(),g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP("\ud30c\uc77c \uc5c5\ub85c\ub4dc \uc911, \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}catch(f){dalert(f)}};this.uploadImgCompleteListener=function(a){try{if(""===a.target.responseText){var b=new XMLHttpRequest;b.open("POST",objectStorageUrl,!1);b.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){var a=JSON.parse(this.response);if("string"==typeof a.resultCode&&"0000"===a.resultCode)if("success"===
a.serverMsg)try{var b=new XMLHttpRequest;b.open("POST",WeDriveURL,!1);b.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);"success"===a.serverMsg&&g_onefficeWeTool.m_SuccessHTTP&&g_onefficeWeTool.m_SuccessHTTP(a,"")}};var c=onefficeWE.imgFileUrlList.length?onefficeWE.imgFileUrlList.shift():"",g=onefficeUtil.getRequestParameter("fid");a={BucketType:encodeURI(g_onefficeWeTool.m_BucketType),ServiceCode:encodeURI(g_onefficeWeTool.m_ServiceCode),TokenID:encodeURI(g_onefficeWeTool.m_WeDriveToken),
AttachFileUniqueKey:encodeURI(c),OnefficeFileUniqueKey:encodeURI(g)};var h=JSON.stringify(a);b.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));b.setRequestHeader("service","fileUploadService");b.setRequestHeader("method","setOnefficeAttachFileSuccess");var k=WehagoUtil.getTransactionId();b.setRequestHeader("transaction-id",k);var l=WehagoUtil.getWehagoSig(k,WeDriveURL);b.setRequestHeader("wehago-sign",l);b.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);
b.send(h)}catch(m){dalert("setOnefficeAttachFileSuccess called")}else alert(a.serverMsg),g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP(a.serverMsg);else alert(a.resultCode),g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP(a.serverMsg)}else alert(this.status),g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP(a.serverMsg)};var c=WehagoUtil.getFileExt(g_onefficeWeTool.m_OrgFileName);g_onefficeWeTool.reqUploadComplete(b,c)}else g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP("\ud30c\uc77c \uc5c5\ub85c\ub4dc \uc911, \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}catch(d){dalert(d)}};
this.reqListOpen=function(){try{if(!g_onefficeWeTool.m_bViewer){g_onefficeWeTool.setUploadImgList();var a=new XMLHttpRequest;a.open("POST",WeDriveURL,!0);a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);"string"==typeof a.resultCode&&"0000"===a.resultCode?"success"!==a.serverMsg&&(alert(a.serverMsg),alert("get upload url failed")):(alert(a.resultCode),alert("reqListOpen failed"))}};var b={TokenID:encodeURI(g_onefficeWeTool.m_WeDriveToken),
FileUniqueKey:encodeURI(g_onefficeWeTool.m_fid),AttachFileList:g_onefficeWeTool.m_uploadImgList},c=JSON.stringify(b);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));a.setRequestHeader("service","storageService");a.setRequestHeader("method","openOnefficeFile");var d=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",d);var e=WehagoUtil.getWehagoSig(d,WeDriveURL);a.setRequestHeader("wehago-sign",e);a.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);
a.send(c)}}catch(f){dalert(f)}};this.reqListSave=function(a){try{if(!g_onefficeWeTool.m_bViewer){g_onefficeWeTool.setUploadImgList();var b=new XMLHttpRequest;b.open("POST",WeDriveURL,!0);b.onreadystatechange=function(){4===this.readyState&&200===this.status&&JSON.parse(this.response)};var c=!1;a?c=!0:onefficeWE.m_nSaveCount&&(c=!0);var d="wehagot.com"===MAIN_DOMAIN?{TokenID:encodeURI(g_onefficeWeTool.m_WeDriveToken),FileUniqueKey:encodeURI(g_onefficeWeTool.m_fid),ViewFileName:g_onefficeWeTool.m_OrgFileName,
TargetFileUniqueKey:encodeURI(g_onefficeWeTool.m_did),isOneffice:"true",AttachFileList:g_onefficeWeTool.m_uploadImgList,isUpdate:encodeURI(c),AlCno:encodeURI(g_onefficeWeTool.m_Cno),clCno:encodeURI(g_onefficeWeTool.m_clCno)}:{TokenID:encodeURI(g_onefficeWeTool.m_WeDriveToken),FileUniqueKey:encodeURI(g_onefficeWeTool.m_fid),ViewFileName:g_onefficeWeTool.m_OrgFileName,TargetFileUniqueKey:encodeURI(g_onefficeWeTool.m_did),isOneffice:"true",AttachFileList:g_onefficeWeTool.m_uploadImgList,isUpdate:encodeURI(c)};
var e=JSON.stringify(d);b.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));g_onefficeWeTool.m_clCno?(b.setRequestHeader("service","clService"),b.setRequestHeader("method","uploadsAndCreateFolderToCl")):(b.setRequestHeader("service","fileUploadService"),b.setRequestHeader("method","uploadsAndCreateFolderToObject"));var f=WehagoUtil.getTransactionId();b.setRequestHeader("transaction-id",f);var g=WehagoUtil.getWehagoSig(f,WeDriveURL);b.setRequestHeader("wehago-sign",
g);b.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);b.send(e)}}catch(h){dalert(h)}};this.reqUploadComplete=function(a,b){try{var c="BucketType="+encodeURI(g_onefficeWeTool.m_BucketType)+"&ServiceKey="+encodeURI(g_onefficeWeTool.m_ServiceKey)+"&ServiceCode="+encodeURI(g_onefficeWeTool.m_ServiceCode)+"&cno="+encodeURI(g_onefficeWeTool.m_Cno)+"&FileName="+encodeURI(g_onefficeWeTool.m_fid)+"&Ext="+encodeURI(b)+"&isPublicURL="+encodeURI(g_onefficeWeTool.m_IsPublic)+"&realFileName="+encodeURI(g_onefficeWeTool.m_OrgFileName)+
"&isWedrive="+encodeURI(g_onefficeWeTool.m_IsWeDrive)+"&TokenID="+encodeURI(g_onefficeWeTool.m_WeDriveToken)+"&TargetFileUniqueKey="+encodeURI(g_onefficeWeTool.m_did);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));a.setRequestHeader("service","objectStorageService");a.setRequestHeader("method","setFileUploadSuccess");a.setRequestHeader("client-id",CLNT_ID);var d=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",d);var e=WehagoUtil.getWehagoSig(d,
objectStorageUrl);a.setRequestHeader("wehago-sign",e);a.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);a.send(c)}catch(f){dalert(f)}};this.uploadFailedListener=function(a){g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP("\ud30c\uc77c \uc5c5\ub85c\ub4dc \uc911, \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")};this.uploadCanceledListener=function(a){g_onefficeWeTool.m_CancelHTTP("\ud30c\uc77c \uc5c5\ub85c\ub4dc\uac00 \ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")};this.openContentsSuccessCB=
function(a,b,c){onefficeUtil.onLoadFileContent(a,0);duzon_http.hideLoading()};this.saveComplete=function(a,b){g_onefficeWeTool.m_nSaveType!=SAVETYPE.HIDE&&onefficeWE.setCurrFileInfo();b.length&&cmnCtrlToast.showToastMsg(null,b,1.5);g_onefficeWeTool.m_nSaveType!=SAVETYPE.HIDE&&(g_onefficeWeTool.m_nSaveType==SAVETYPE.AUTO?onefficeUtil.showDocSubject():onefficeUtil.showDocSubject(oneffice.currFileSubject));onefficeWE.m_nSaveCount++;onefficeWE.setSaveType(SAVETYPE.DEFAULT);!0===dzeUiConfig.bTempSaveToLocalStorage&&
(a=g_onefficeWeTool.m_fid,a=a.replace("-",""),onefficeUtil.removeTempDataFromLocalStorage(a));duzon_http.hideLoading()};this.saveImgComplete=function(a,b){try{b.length&&cmnCtrlToast.showToastMsg(null,b,1.5);var c=a.resultList["0"].attachFileURL;g_objExtUploader.m_tmpWeURL=c;g_objExtUploader.onStartUploadImage(c);onefficeWE.setParam2Tool();return c}catch(d){dalert(d)}};this.downloadFailedListener=function(a){a=a.target;4==a.readyState&&200==a.ststus&&"undefined"!=typeof g_onefficeWeTool.m_ErrorHTTP&&
g_onefficeWeTool.m_ErrorHTTP("\ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc \uc911, \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")};this.downloadCanceledListener=function(a){a=a.target;4==a.readyState&&200==a.ststus&&"undefined"!=typeof g_onefficeWeTool.m_ErrorHTTP&&g_onefficeWeTool.m_ErrorHTTP("\ud30c\uc77c \ub2e4\uc6b4\ub85c\ub4dc\uac00 \ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4.")}},weFileInfo={directory:!1,fileName:"\uc0c8 \ubb38\uc11c.docx",size:8575,mimeType:"OFFICE",path:"goatyum@duzon.com/\uc0c8 \ubb38\uc11c.docx",
lastModifyDate:"20180307103554",lastModifyUser:"goatyum@duzon.com",uploadDate:"20180307103528",uploadUser:"goatyum@duzon.com",shareFolder:!1,bizShareFolder:!1,memo:!1,favorite:!1,lock:!1,fileVersion:0,folderType:"NormalFolder",thumbNailPath:"http://dev.api."+MAIN_DOMAIN+"/DCloudStorageServer/WehagoIMG/company_dev_10051/2018/03/07/cae6ab90-21a7-11e8-a9cf-1d5a30c242de.png?ran=61",createDate:"20180307103528",level:0,folderCount:0,fileCount:0,fileUniqueKey:"cae6ab90-21a7-11e8-a9cf-1d5a30c242de",parentFileUniqueKey:"goatyum@duzon.com"},
onefficeFileListMgr={m_aFileList:[],m_paramUpdateType:0,m_BackupFolderKey:[],m_curFolderKey:"wehago@",m_ctrlDlgContainer:null,m_ctrlPathContainer:null,m_SortType:VIEWSORT.NAME,m_nSortArrowImgDegree:-90,m_nFileListItem:0,m_aFileListr_resFileUK:null,m_tmpSearchTxt:"misty",reqGetFileList:function(a,b){try{var c="";c="undefined"==typeof b?0<=g_onefficeWeTool.m_portalID.search("@")?g_onefficeWeTool.m_portalID:g_onefficeWeTool.m_portalID+"@":b;onefficeFileListMgr.m_curFolderKey=c;var d={TokenID:encodeURI(g_onefficeWeTool.m_WeDriveToken),
FileUniqueKey:encodeURI(c)},e=JSON.stringify(d);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));a.setRequestHeader("service","storageService");a.setRequestHeader("method","getFileListObject");var f=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",f);var g=WehagoUtil.getWehagoSig(f,WePermissionUrl);a.setRequestHeader("wehago-sign",g);a.setRequestHeader("timestamp",g_onefficeWeTool.m_ts);a.send(e)}catch(h){dalert(h)}},checkList:function(){try{for(var a=
[],b=onefficeFileListMgr.m_aFileList.length,c=0;c<b;c++)0==onefficeFileListMgr.m_aFileList[c].directory&&0<=onefficeFileListMgr.m_aFileList[c].fileName.search(".one")?a.push(onefficeFileListMgr.m_aFileList[c]):1==onefficeFileListMgr.m_aFileList[c].directory&&a.push(onefficeFileListMgr.m_aFileList[c]);onefficeFileListMgr.m_aFileList=a;onefficeUtil.SortFileList(onefficeFileListMgr.m_aFileList,onefficeFileListMgr.m_nSortArrowImgDegree);onefficeFileListMgr.m_ctrlPathContainer&&onefficeUtil.changeSortCtrlInfo(VIEWSORT.NAME,
onefficeFileListMgr.m_ctrlPathContainer.nextElementSibling.children[1])}catch(d){dalert(d)}},getFileListContainer:function(){try{var a=document.createElement("div");a.style.width="500px";a.ondragstart=function(){return!1};a.onselectstart=function(){return!1};onefficeFileListMgr.m_BackupFolderKey&&(delete onefficeFileListMgr.m_BackupFolderKey,onefficeFileListMgr.m_BackupFolderKey=[]);onefficeFileListMgr.getRootFiles();return onefficeFileListMgr.m_ctrlDlgContainer=a}catch(b){dalert(b)}},updateDlgCtrl:function(){try{var a=
onefficeFileListMgr.m_ctrlDlgContainer,b=document.createElement("div");b.class="dze_file_open_title";b.innerHTML="<p>WE\ub4dc\ub77c\uc774\ube0c\uc5d0\uc11c \ud30c\uc77c \ucc3e\uae30</p>";b.style.fontWeight="bold";a.appendChild(b);var c=document.createElement("div");c.className="file_search_we";c.innerHTML='<input type="text" id="dze_idx_cloud_search_input" class="search_input_we" placeholder="File \uac80\uc0c9"><span class="search_btn_form_we"><img id="dze_idx_cloud_search_btn"  onclick="onefficeFileListMgr.searchWeFiles()" width="14" height="14" src="./image/cloud/ico_cloud_search.png"></span>';
a.appendChild(c);var d=document.createElement("div");d.id="dze_idx_folderlist";d.className="file_path_we";d.style.width="auto";d.style.fontWeight="bold";d.innerHTML="<p>"+onefficeFileListMgr.m_curFolderKey+"</p>";onefficeFileListMgr.m_ctrlPathContainer=d;var e=document.createElement("div");e.id="dze_idx_folder_info";e.className="cloud_folder_info_we";var f=document.createElement("div");f.style.width="auto";f.style.height="200px";f.style.overflowX="hidden";f.style.overflowY="auto";f.className="cloud_folder_list_container_we";
f.id="dze_idx_filelist";a.appendChild(d);a.appendChild(e);a.appendChild(f);var g=document.createElement("div");g.id="dze_fileitem_list";g.style.overflowX="hidden";g.className="cloud_file_list_we";f.appendChild(g);return a}catch(h){dalert(h)}},makeListItemDivMenu:function(){try{var a=document.getElementById("dze_idx_folder_info");a.innerHTML="";for(var b=1;5>=b;b++){var c="",d="0px",e="50px",f=VIEWSORT.NAME;switch(b){case 0:c='<input type="checkbox" id="dze_idx_folder_info_main_checkbtn" class="cloud_folder_info_item_checkbtn">';
break;case 1:c="\uc885\ub958";e="50px";f=VIEWSORT.TYPE;d="3px";break;case 2:c=ID_RES_DIALOG_STRING_NAME;e="167px";f=VIEWSORT.NAME;break;case 3:f=VIEWSORT.SIZE;c=ID_RES_CONST_STRING_FILE_SIZE;e="70px";break;case 4:f=VIEWSORT.UPLOADDATE;c="\uc5c5\ub85c\ub4dc\ud55c \ub0a0\uc9dc";e="105px";break;case 5:f=VIEWSORT.MODDATE,c=ID_RES_CONST_STRING_LAST_MODIFIED_DATE,e="105px"}var g=document.createElement("div");g.style.paddingLeft=d;g.style.paddingTop="3px";g.style.float="left";g.style.width=e;g.innerHTML=
c+' <img width="10px" height="10px" src="./image/cloud/ico_cloud_arrow_right.png" style="position:relative; top:3px; transform:rotate(-90deg); ">';f!=VIEWSORT.NAME&&(g.firstElementChild.style.display="none");(function(){var a=f,b=g;b.onclick=function(c){onefficeFileListMgr.m_SortType==a?onefficeFileListMgr.m_nSortArrowImgDegree=-onefficeFileListMgr.m_nSortArrowImgDegree:onefficeUtil.changeSortCtrlInfo(a,b);b.firstElementChild.style.transform="rotate("+onefficeFileListMgr.m_nSortArrowImgDegree+"deg)";
onefficeUtil.SortFileList(onefficeFileListMgr.m_aFileList,onefficeFileListMgr.m_nSortArrowImgDegree);8!=onefficeFileListMgr.m_paramUpdateType&&1!=onefficeFileListMgr.m_paramUpdateType&&(onefficeFileListMgr.m_paramUpdateType=9);onefficeFileListMgr.updateList()};b.onmouseover=function(){b.style.fontWeight="bold";b.style.cursor="pointer"};b.onmouseout=function(){b.style.fontWeight="normal";b.style.cursor="arrow"}})();a.appendChild(g)}}catch(h){dalert(h)}},makeListItemDiv:function(a){try{var b=onefficeFileListMgr.m_aFileList,
c=document.createElement("div");c.style.width="500px";c.style.height="25px";c.style.verticalAlign="middle";c.style.paddingTop="4px";c.style.cursor="default";c.setAttribute("seq",b[a].fileUniqueKey);for(var d=0;5>d;d++){var e=document.createElement("div"),f="",g="",h="left",k="clip",l="normal",m="visible";if(0==b[a].directory)switch(d){case 0:f='<img width="16px" height="16px" src="./image/cloud/ico_cloud_file.png" ">';g="50px";h="center";break;case 1:f=b[a].fileName;g="167px";k="ellipsis";l="nowrap";
m="hidden";break;case 2:f=b[a].size;g="70px";h="center";break;case 3:f=b[a].uploadDate.substring(2,4)+"-"+b[a].uploadDate.substr(4,2)+"-"+b[a].uploadDate.substr(6,2)+" "+b[a].uploadDate.substr(8,2)+":"+b[a].uploadDate.substr(10,2);g="105px";break;case 4:f=b[a].lastModifyDate.substring(2,4)+"-"+b[a].lastModifyDate.substr(4,2)+"-"+b[a].lastModifyDate.substr(6,2)+" "+b[a].lastModifyDate.substr(8,2)+":"+b[a].lastModifyDate.substr(10,2),g="105px"}else switch(d){case 0:f='<img width="16px" height="16px" src="./image/cloud/ico_cloud_folder.png">';
g="50px";h="center";break;case 1:f=b[a].fileName;g="167px";k="ellipsis";l="nowrap";m="hidden";break;case 2:g="70px";h="center";f="&nbsp;";break;case 3:f=b[a].uploadDate.substring(2,4)+"-"+b[a].uploadDate.substr(4,2)+"-"+b[a].uploadDate.substr(6,2)+" "+b[a].uploadDate.substr(8,2)+":"+b[a].uploadDate.substr(10,2);g="105px";break;case 4:f=b[a].lastModifyDate.substring(2,4)+"-"+b[a].lastModifyDate.substr(4,2)+"-"+b[a].lastModifyDate.substr(6,2)+" "+b[a].lastModifyDate.substr(8,2)+":"+b[a].lastModifyDate.substr(10,
2),g="105px"}1==d&&function(){c.onmouseover=function(a){c.style.cursor="pointer"};c.onmouseout=function(a){c.style.cursor="default"}}();e.style.overflow=m;e.style.whiteSpace=l;e.style.textOverflow=k;e.style.textAlign=h;e.style.paddingLeft=0;e.style.width=g;e.style.float="left";e.innerHTML=f;c.appendChild(e)}(function(){c.onmouseover=function(a){c.style.backgroundColor="#F5F5F5"};c.onmouseout=function(a){c.style.backgroundColor="#ffffff"};c.ondblclick=function(){var d=c.firstElementChild.firstElementChild;
8==onefficeFileListMgr.m_paramUpdateType&&(document.getElementById("dze_idx_cloud_search_input").value="");if(0<=d.src.search("file.png"))d=WehagoUtil.makeRequestParameter(b[a].fileName,b[a].fileUniqueKey),window.open(d,"","");else{var e="0";(d=this.getAttribute("seq"))?(e="1",onefficeFileListMgr.m_BackupFolderKey.push(onefficeFileListMgr.m_curFolderKey)):(e="0",d=onefficeFileListMgr.m_BackupFolderKey[onefficeFileListMgr.m_BackupFolderKey.length-1],onefficeFileListMgr.m_BackupFolderKey.pop(),e=onefficeFileListMgr.m_BackupFolderKey.length?
"1":"0");var f=new XMLHttpRequest;f.open("POST",WePermissionUrl,!0);f.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);"success"===a.serverMsg&&(onefficeFileListMgr.makeListItemDivMenu(),onefficeFileListMgr.m_aFileList=a.resultList,onefficeFileListMgr.checkList(),onefficeFileListMgr.m_nFileListItem=onefficeFileListMgr.m_aFileList.length,onefficeFileListMgr.m_paramUpdateType=e,onefficeFileListMgr.updateList())}};onefficeFileListMgr.reqGetFileList(f,
d)}}})();return c}catch(n){dalert(n)}},makelvlListItemDiv:function(){try{var a=document.createElement("div");a.style.width="500px";a.style.height="25px";a.style.verticalAlign="middle";a.style.paddingTop="5px";a.style.cursor="default";for(var b=0;5>b;b++){var c=document.createElement("div"),d="",e="",f="left",g="clip",h="normal",k="visible",l=0;switch(b){case 0:d='<img width="16px" height="16px" src="./image/cloud/ico_cloud_folder.png">';e="50px";l=3;f="center";break;case 1:d="...";e="167px";g="ellipsis";
h="nowrap";k="hidden";break;case 2:e="70px";f="center";d="&nbsp;";break;case 3:d="&nbsp;";e="105px";break;case 4:d="&nbsp;",e="105px"}1==b&&function(){a.onmouseover=function(b){a.style.cursor="pointer"};a.onmouseout=function(b){a.style.cursor="default"}}();c.style.overflow=k;c.style.whiteSpace=h;c.style.textOverflow=g;c.style.textAlign=f;c.style.paddingTop=l;c.style.paddingLeft=0;c.style.width=e;c.style.float="left";c.innerHTML=d;a.appendChild(c)}(function(){a.onmouseover=function(b){a.style.backgroundColor=
"#F5F5F5"};a.onmouseout=function(b){a.style.backgroundColor="#ffffff"};a.ondblclick=function(){var b=a.firstElementChild.firstElementChild;8==onefficeFileListMgr.m_paramUpdateType&&(document.getElementById("dze_idx_cloud_search_input").value="");if(!(0<=b.src.search("file.png"))){var c="0";(b=this.getAttribute("seq"))?(c="1",onefficeFileListMgr.m_BackupFolderKey.push(onefficeFileListMgr.m_curFolderKey)):(b=onefficeFileListMgr.m_BackupFolderKey[onefficeFileListMgr.m_BackupFolderKey.length-1],onefficeFileListMgr.m_BackupFolderKey.pop(),
c=onefficeFileListMgr.m_BackupFolderKey.length?"1":"0");var d=new XMLHttpRequest;d.open("POST",WePermissionUrl,!0);d.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);"success"===a.serverMsg&&(onefficeFileListMgr.makeListItemDivMenu(),onefficeFileListMgr.m_aFileList=a.resultList,onefficeFileListMgr.checkList(),onefficeFileListMgr.m_nFileListItem=onefficeFileListMgr.m_aFileList.length,onefficeFileListMgr.m_paramUpdateType=c,onefficeFileListMgr.updateList())}};
onefficeFileListMgr.reqGetFileList(d,b)}}})();return a}catch(m){dalert(m)}},updateList:function(){try{var a=onefficeFileListMgr.m_aFileList,b=onefficeFileListMgr.m_ctrlDlgContainer.lastElementChild.lastElementChild;b.innerHTML="";var c=a.length,d=onefficeFileListMgr.m_paramUpdateType;if("undefined"!=typeof d&&(0>d||1==d)){var e=onefficeFileListMgr.makelvlListItemDiv();b.appendChild(e)}for(var f=0;f<c;f++)0==a[f].directory&&0>a[f].fileName.search(".one")||(e=onefficeFileListMgr.makeListItemDiv(f),
b.appendChild(e));if(8!=d&&c){var g=a[c-1].path.split(a[c-1].fileName);onefficeFileListMgr.m_ctrlPathContainer.innerHTML=g[0]}}catch(h){dalert(h)}},getRootFiles:function(){try{var a=new XMLHttpRequest;a.open("POST",WePermissionUrl,!0);a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);"success"===a.serverMsg&&(onefficeFileListMgr.makeListItemDivMenu(),onefficeFileListMgr.m_aFileList=a.resultList,onefficeFileListMgr.checkList(),onefficeFileListMgr.m_nFileListItem=
onefficeFileListMgr.m_aFileList.length,onefficeFileListMgr.m_paramUpdateType=0,onefficeFileListMgr.updateList())}};onefficeFileListMgr.reqGetFileList(a)}catch(b){dalert(b)}},searchWeFiles:function(){try{if(onefficeFileListMgr.m_tmpSearchTxt=document.getElementById("dze_idx_cloud_search_input").value.trim(),onefficeFileListMgr.m_tmpSearchTxt.length){var a=new XMLHttpRequest;a.open("POST",WePermissionUrl,!0);a.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var a=JSON.parse(this.response);
"success"===a.serverMsg&&(onefficeFileListMgr.m_aFileList=a.resultList,onefficeFileListMgr.checkList(),onefficeFileListMgr.m_nFileListItem=onefficeFileListMgr.m_aFileList.length,onefficeFileListMgr.m_ctrlPathContainer.innerHTML="<p>\uac80\uc0c9\uacb0\uacfc "+onefficeFileListMgr.m_nFileListItem+" \uac74</p>",onefficeFileListMgr.m_paramUpdateType=8,onefficeFileListMgr.updateList())}};onefficeFileListMgr.reqGetSearchFileList(a)}else onefficeFileListMgr.getRootFiles()}catch(b){dalert(b)}},reqGetSearchFileList:function(a){try{var b=
{TokenID:encodeURI(g_onefficeWeTool.m_WeDriveToken),SearchText:onefficeFileListMgr.m_tmpSearchTxt,pageFrom:"null",pageSize:"null"},c=JSON.stringify(b);a.setRequestHeader("Authorization","Bearer "+onefficeUtil.getCookieValue("AUTH_A_TOKEN"));a.setRequestHeader("service","storageService");a.setRequestHeader("method","indexSearchObject");var d=WehagoUtil.getTransactionId();a.setRequestHeader("transaction-id",d);var e=WehagoUtil.getWehagoSig(d,WePermissionUrl);a.setRequestHeader("wehago-sign",e);a.setRequestHeader("timestamp",
g_onefficeWeTool.m_ts);a.send(c)}catch(f){dalert(f)}},openFileListOnload:function(a){try{onefficeFileListMgr.updateDlgCtrl(),document.getElementById("dze_idx_cloud_search_input").onkeydown=function(a){a.keyCode==ID_KEYCODE_ENTER&&onefficeFileListMgr.searchWeFiles()}}catch(b){dalert(b)}}},WehagoUtil={makeRequestParameter:function(a,b){try{var c="";if(0<=document.location.href.indexOf("?")){var d=document.location.href.split("?"),e=d[1];c=d[0]+"?";var f=d="",g=e.split("&");for(e=0;e<g.length;e++){0!=
e&&(c+="&");var h=g[e].split("=");d=h[0];f=h[1];"filename"==d?c+=d+"="+encodeURIComponent(a):"fid"==d?c+=d+"="+encodeURIComponent(b):"help"!=d&&(c+=d+"="+f)}}return c}catch(k){return dalert(k),null}},makeReqParam:function(a){try{return"FileName="+encodeURI(a.orgFileName)+"&fid="+encodeURI(a.fid)+"&BucketType="+encodeURI(a.bucketType)+"&ServiceKey="+encodeURI(a.serviceKey)+"&ServiceCode="+encodeURI(a.serviceCode)+"&cno="+encodeURI(a.cno)+"&portal_id="+encodeURI(a.portalID)+"&user_name="+encodeURI(a.user_name)+
"&isWedrive="+encodeURI(a.isWedrive)+"&wedriveToken="+encodeURI(a.wedriveToken)}catch(b){dalert(b)}},getEncodingDataValue:function(a){try{if("object"===typeof a){var b=[],c;for(c in a)b.push(c+"="+encodeURIComponent(a[c]));var d=b.join("&");"get"==type&&""!=d&&(url+="?"+encodeURI(d))}}catch(e){dalert(e)}},getServiceCode:function(){try{var a="",b=window.location.href.split("/#/")[1];""!==b&&(a=b.split("/")[0]);a=a.toLowerCase();"m"===a&&(a=b.split("/")[1]);"account"===a&&(a=b.split("/")[1]);-1<a.indexOf("?")&&
(a=a.split("?")[0]);return a}catch(c){dalert(c)}},getTransactionId:function(a){try{var b=10;"number"==typeof a&&(b=a);a="";for(var c=0;c<b;c++){var d=Math.floor(61*Math.random());a+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(d,d+1)}return a}catch(e){dalert(e)}},getWehagoSig:function(a,b){try{var c=onefficeUtil.getCookieValue("wehago_s");if(c){var d=Math.floor(Date.now()/1E3);g_onefficeWeTool.m_ts=d;var e={};e="string"===typeof b?WehagoUtil.getLocation(b):WehagoUtil.getLocation(objectStorageUrl);
c=CryptoJS.SHA256((c+d).toString(CryptoJS.enc.Utf8),c).toString(CryptoJS.enc.Base64);return CryptoJS.enc.Base64.stringify(CryptoJS.HmacSHA256(e.pathname+e.search+d+a,c))}return null}catch(f){dalert(f)}},getFileExt:function(a){try{var b=a.lastIndexOf("."),c="";0<b&&(c=a.substring(b+1));return c}catch(d){dalert(d)}},getLocation:function(a){try{var b=a.match(/^(https?:)\/\/(([^:\/?#]*)(?::([0-9]+))?)([\/]{0,1}[^?#]*)(\?[^#]*|)(#.*|)$/);return b&&{protocol:b[1],host:b[2],hostname:b[3],port:b[4],pathname:b[5],
search:b[6],hash:b[7]}}catch(c){dalert(c)}},getCompanyCode:function(a){try{var b=9;null!==a&&void 0!==a.value&&""!==a.value&&(b=a.value);return b}catch(c){dalert(c)}}};
