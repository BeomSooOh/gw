var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,c,a){b instanceof String&&(b=String(b));for(var d=b.length,e=0;e<d;e++){var f=b[e];if(c.call(a,f,e,b))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){b!=Array.prototype&&b!=Object.prototype&&(b[c]=a.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,c,a,d){if(c){a=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var e=b[d];e in a||(a[e]={});a=a[e]}b=b[b.length-1];d=a[b];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");
var onefficeGW={contents_array:[],callEditUse:function(b){clearInterval(oneffice.editUseAlertTimer);oneffice.editUseAlertTimer=null;clearInterval(oneffice.editUseTimer);oneffice.editUseTimer=null;oneffice.editUseWork=!1;if(oneffice.editUseAuth)onefficeGW.onCheckEditUseTimer(b)},onCheckEditUseAlertTimer:function(){try{clearInterval(oneffice.editUseTimer),oneffice.editUseTimer=null,!0===g_readonlyMode?(clearInterval(oneffice.editUseAlertTimer),oneffice.editUseAlertTimer=null):oneffice.editUseAlertTimer=
setInterval(function(){clearInterval(oneffice.editUseAlertTimer);oneffice.editUseAlertTimer=null;var b=getEditorHTMLCode(!1,g_nActiveEditNumber,!0);onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,b,g_nActiveEditNumber,function(){onefficeUtil.setSavedContent(b);onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate);oneffice.editUseWorkEnd=!0;onefficeGW.setAccessDocument(oneffice.currFileSeq,
"W","0",360,function(b){"W"===b.access_perm&&(onefficeGW.setAccessDocument(oneffice.currFileSeq,"R","1",360,function(a){dlog(a)}),fnCommandReadOnlyMode(g_nActiveEditNumber),onefficeUtil.setReadonlyNotificationBar(g_nActiveEditNumber),onefficeGW.viewDocumentAccessInfo(oneffice.currFileSeq),!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO),oneffice.editUseWork=!1);clearInterval(oneffice.editUseTimer);oneffice.editUseTimer=
null;clearInterval(oneffice.editUseAlertTimer);oneffice.editUseAlertTimer=null;oneffice.editUseWork=!0;clearInterval(oneffice.requestManagerSearchInterval);oneffice.requestManagerSearchInterval=null;clearInterval(oneffice.accessManagerSearchInterval);oneffice.accessManagerSearchInterval=null;clearInterval(oneffice.accessInfoRefreshInterval);oneffice.accessInfoRefreshInterval=null;cmnMsg.showMsg(MESSAGE_CHECK,ID_RES_STRING_EDIT_TIMER_ALERT_READ,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg();
!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO)})})},!0,null,!0)},1E3*oneffice.editUseAlertTime)}catch(b){}},chkEditAuthChk:function(b,c){try{onefficeGW.getShareInfo(oneffice.currFileSeq,function(a){if(0<a.length){var c=!1;oneffice.editUseAuth=!0;for(var e=0,f="",g=0;a.length>g;g++){var k=a[g],h=k.share_login_id,l=k.share_perm;if(k.owner_login_id===oneffice_cloud_myInfoData.login_id||(h===oneffice_cloud_myInfoData.login_id||
null===h)&&"W"===l)c=!0;"W"===l&&(e=1);k.owner_login_id===oneffice_cloud_myInfoData.login_id&&(f=k.owner_login_id)}""!=f&&f===oneffice_cloud_myInfoData.login_id&&1!=e&&(c=!1);b(c)}else oneffice.editUseWork=!1,oneffice.editUseAuth=!1,clearInterval(oneffice.editUseAlertTimer),oneffice.editUseAlertTimer=null,clearInterval(oneffice.editUseTimer),oneffice.editUseTimer=null})}catch(a){}},onCheckEditUseTimer:function(b){try{var c=g_readonlyMode;"auth"===b&&(c=!1);if(c||oneffice.editUseWork||oneffice.editUseWorkEnd)clearInterval(oneffice.editUseTimer),
oneffice.editUseTimer=null;else{if(null!=oneffice.editUseTimer)return!1;oneffice.editUseTimer=setInterval(function(){clearInterval(oneffice.editUseTimer);oneffice.editUseTimer=null;onefficeGW.chkEditAuthChk(function(a){if(!a)return!1;oneffice.onErrorCheckSession(function(){if(oneffice.editUseWorkEnd)return clearInterval(oneffice.editUseTimer),oneffice.editUseTimer=null,oneffice.editUseWork=!1;oneffice.editUseWork=!0;onefficeGW.onCheckEditUseAlertTimer();cmnMsg.showMsg("alert",ID_RES_STRING_EDIT_TIMER_ALERT,
null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg();oneffice.editUseWork=!1;onefficeGW.callEditUse()})},dzeUiConfig.bAlwaysCheckSession)})},1E3*oneffice.editUseTime)}}catch(a){}},loadofficeLayout:function(b){try{duzon_http.showLoading(),oneffice.setListViewMgr(),dzeLayoutControl.setOfficeLayout(b,function(b){if(!0===dzeUiConfig.bIndependentEdit)onefficeExtContent.initialize(b),duzon_http.hideLoading();else oneffice.onErrorCheckSession(function(){if("create_form"===onefficeUtil.getRequestParameter("db_step"))Binder.getInstance().openForm(onefficeUtil.getRequestParameter("db_form_no"));
else{var a=onefficeUtil.getRequestParameter("seq"),c=onefficeUtil.getRequestParameter("folder"),e=onefficeUtil.getRequestParameter("groupseq"),f=onefficeUtil.getRequestParameter("ref");oneffice.onefficeGroupSeq=e;dlog("load = docSeq:"+a+", docFolder:"+c+", groupSeq:"+e);if(a){onefficeCommon.getSecurityInfo(a,"",function(c){0!=c?onefficeGW.checkPasswordAndOpen(a,b):onefficeGW.openFileContent(a,b)},function(){setTimeout(function(){document.location.href=oneffice.drivePath},1E3)});if(!0!==oneffice.autoSave||
onefficeCommon.isOnefficeGuideDoc(a))setInterval(function(){onefficeCommon.checkSession()},1E3*oneffice.autoSessionCheckTime);else{try{if(window.attachEvent)window.attachEvent("onunload",function(){onefficeGW.executeBeforeUnload(b)});else if(window.addEventListener){var g=function(){if(1!=oneffice.onUnloadEventFlag){oneffice.onUnloadEventFlag=!0;try{var a=null;!0===g_browserCHK.cr&&!0!==g_browserCHK.edge&&navigator&&navigator.sendBeacon&&(a=duzon_http.ajax,duzon_http.ajax=duzon_http.beacon);var b=
g_readonlyMode?"R":"W";1==dzeUiConfig.bMobileHybridEdit&&(b="M");onefficeGW.setAccessDocument(oneffice.currFileSeq,b,"0",360,function(a){});oneffice.bUseOnexFile&&oneffice.currFilePath&&""!=oneffice.currFilePath&&onefficeGW.deleteTempFileProcess();!0===objOnefficeLoader.m_bAccessManager&&onefficeGW.delAccessManager(oneffice.currFileSeq,oneffice.parentFileContent.my_id)}catch(l){dalert(l)}finally{a&&(duzon_http.ajax=a)}}};window.addEventListener("beforeunload",function(a){g();!0!==g_readonlyMode&&
!0===g_objOnefficeEditor.isDocumentLoaded&&(onefficeUtil.checkSimpleSameContent(b)?(oneffice.bUseOnexFile&&oneffice.currFilePath&&""!=oneffice.currFilePath&&onefficeGW.deleteTempFileProcess(),g()):a.returnValue=ID_RES_CONST_STRING_CHANGES_NOT_SAVED)});window.addEventListener("unload",function(){g()})}}catch(k){}0!=oneffice.autoSaveTime&&(oneffice.autoSaveTimer=setInterval(function(){onefficeGW.autoSaveFunction(b)},1E3*oneffice.autoSaveTime))}onefficeCommon.accessUserFunction("visit");f&&0<=f.indexOf("open_request")&&
onefficeUtil.openQRCodeDialog(!0);check1Day()&&0==g_browserCHK.mobile&&0==g_bBrowserType_CR&&showCompatibilityGuide()}else dzeLayoutControl.setReadonlyMode(!0,b),!0!==g_browserCHK.mobile?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_INVALID_CALL,2,"screen_center"),setTimeout(function(){document.location.href=oneffice.drivePath},1E3)):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_INVALID_CALL,2,"mobile")}},dzeUiConfig.bAlwaysCheckSession)})}catch(c){dalert(c)}},autoSaveFunction:function(b){try{if(dlog("------------------ AutoSave Start"),
!0===g_readonlyMode)clearInterval(oneffice.autoSaveTimer),oneffice.autoSaveTimer=null;else if(g_objHeaderFooter.getHeaderFooterEditMode())onefficeCommon.checkSession();else if(oneffice.editUseWork)onefficeCommon.checkSession();else{var c=getEditorHTMLCode(!1,b,!0);onefficeUtil.checkSameContent(c)?(dlog("auto_save :: no modify data -> not saved!"),onefficeCommon.checkSession()):(dlog("auto_save :: save start"),onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,
c,b,function(){onefficeUtil.setSavedContent(c);dlog("modify data -> saved ok!");dlog("save finish");cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_AUTO_SAVED,2);onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate)},!0))}}catch(a){dalert(a)}},deleteTempFileProcess:function(){try{dzeJ.ajax({url:"/oneffice/deleteTempFile.do",data:{doc_no:oneffice.currFilePath,open_date:oneffice.currFileOpenDate},dataType:"json",type:"post",contentType:"application/x-www-form-urlencoded",
success:function(b,c,a){},error:function(b,c,a){dlog(a)}})}catch(b){dalert(b)}},exchangeContentsListInfo:function(b,c){try{var a=onefficeGW.makeContentsList(c);if(!0!==g_readonlyMode){if(!1===fnObjectCheckNull(c)){var d={type:1,seq:oneffice.currFileSeq,folderSeq:oneffice.currFolderSeq,subject:oneffice.currFileSubject,content:getEditorHTMLCode(!1,g_nActiveEditNumber,!0,!0),content_size:"0",owner_id:"",keyword:"",readonly:"",regdate:"",moddate:"",accessdate:"",important:"",deleted:"0"};onefficeGW.saveFileContent(d,
function(a){oneffice.parentFileContent.content=d.content},function(a){dalert(a)},!0)}a&&!1===fnObjectCheckNull(onefficeGW.contents_array)&&0<onefficeGW.contents_array.length&&onefficeGW.updateContentsList(b)}}catch(e){dalert(e)}},makeContentsList:function(b){try{var c=!1;!1===fnObjectCheckNull(b)&&(c=!0);onefficeGW.contents_array=[];for(var a=dzeUiConfig.arrCustomImgSrcRemoveDomain,d=document.location.origin,e=g_objEditorDocument[g_nActiveEditNumber].images,f=0;f<e.length;f++){var g=e[f].src;if(!(0<=
g.indexOf("oneffice/image"))&&0<=g.indexOf("getAttachmentData.do?seq=")){for(var k=0;k<a.length;k++)0<=g.indexOf(a[k])&&(e[f].outerHTML=e[f].outerHTML.replace(a[k],d));var h=g.split("/"),l=h.length-1;if(!0===c){var q=h[l].split("-")[0].split("seq="),m=q[q.length-1];if(m===b){for(var u=0;u<l+1;u++)e[f].outerHTML=e[f].outerHTML.replace(b,oneffice.currFileSeq);h[l]=h[l].replace(b,oneffice.currFileSeq)}}var n=h[l].split("seq=");onefficeGW.contents_array.push(n[n.length-1])}}var v=g_objEditorDocument[g_nActiveEditNumber].getElementsByTagName("source");
for(f=0;f<v.length;f++){var A=v[f].src;if(0<=A.indexOf("getAttachmentData.do?seq=")){for(k=0;k<a.length;k++)0<=A.indexOf(a[k])&&(v[f].outerHTML=v[f].outerHTML.replace(a[k],d));var p=A.split("/");l=p.length-1;if(!0===c){var r=p[l].split("-")[0].split("seq=");m=r[r.length-1];m===b&&(v[f].outerHTML=v[f].outerHTML.replace(b,oneffice.currFileSeq),p[l]=p[l].replace(b,oneffice.currFileSeq))}n=p[l].split("seq=");onefficeGW.contents_array.push(n[n.length-1])}}var t=g_objEditorDocument[g_nActiveEditNumber].getElementsByTagName("table");
for(f=0;f<t.length;f++)if(t[f].style.backgroundImage){var B=t[f].style.backgroundImage;if(0<=B.indexOf("getAttachmentData.do?seq=")){for(k=0;k<a.length;k++)0<=B.indexOf(a[k])&&(t[f].outerHTML=t[f].outerHTML.replace(a[k],d));var w=B.split("/");l=w.length-1;if(!0===c){var x=w[l].split("-")[0].split("seq=");m=x[x.length-1];m===b&&(t[f].style.backgroundImage=t[f].style.backgroundImage.replace(b,oneffice.currFileSeq),w[l]=w[l].replace(b,oneffice.currFileSeq))}n=w[l].split("seq=");var y=n[n.length-1];onefficeGW.contents_array.push(y.substring(0,
y.length-2))}}e=[];e=e.concat([].slice.call(g_objEditorDocument[g_nActiveEditNumber].getElementsByTagName("td")));e=e.concat([].slice.call(g_objEditorDocument[g_nActiveEditNumber].getElementsByTagName("th")));for(f=0;f<e.length;f++)if(e[f].style.backgroundImage){var C=e[f].style.backgroundImage;if(0<=C.indexOf("getAttachmentData.do?seq=")){for(k=0;k<a.length;k++)0<=C.indexOf(a[k])&&(e[f].outerHTML=e[f].outerHTML.replace(a[k],d));var z=C.split("/");l=z.length-1;!0===c&&(x=z[l].split("-")[0].split("seq="),
m=x[x.length-1],m===b&&(e[f].style.backgroundImage=e[f].style.backgroundImage.replace(b,oneffice.currFileSeq),z[l]=z[l].replace(b,oneffice.currFileSeq)));n=z[l].split("seq=");y=n[n.length-1];onefficeGW.contents_array.push(y.substring(0,y.length-2))}}for(f=0;f<onefficeGW.contents_array.length;f++){var D=onefficeGW.contents_array[f].split("-")[0].split("seq=");D[D.length-1]!==oneffice.currFileSeq&&onefficeGW.contents_array.splice(f--,1)}return!0}catch(E){return dalert(E),!1}},updateContentsList:function(b){try{duzon_http.ajax({type:"post",
url:ONEFFICE_SERVER_API_POST_UPDATE_CONTENTS_LIST,async:b,data:{doc_no:oneffice.currFileSeq,contents_list:onefficeGW.contents_array},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_UPDATE_CONTENTS_LIST",2,"screen_center")})},error:function(b){dalert("error:ONEFFICE_SERVER_API_POST_UPDATE_CONTENTS_LIST")}})}catch(c){dalert(c)}},getFileList:function(b,
c,a,d,e,f,g,k,h){try{switch(!0===fnObjectCheckNull(k)&&(k=!0),!0===fnObjectCheckNull(h)&&(h=!0),"undefined"===typeof c&&(c=""),"undefined"==typeof a||a!==CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST&&a!==CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST||(a=CLOUD_CONST_BROWSER_MODE_SHARE),"undefined"===typeof d&&(d=""),"undefined"===typeof f&&(f="myoneffice"),"undefined"===typeof g&&(g=50),oneffice.onLoadListToServer=!0,a){case CLOUD_CONST_BROWSER_MODE_RECENT:b=
ONEFFICE_SERVER_API_GET_RECENT_DOCUMENT_LIST;g={list_count:g};1==c?g.list_my="Y":2==c&&(g.list_share="Y");switch(m_SortType){case VIEWSORT.READDATE:g.order_type="access_date";break;case VIEWSORT.MODDATE:g.order_type="mod_date";break;case VIEWSORT.SHAREBYDATE:g.order_type="share_date"}duzon_http.ajax({type:"get",url:b,async:!0,data:g,dataType:"json",timeout:3E4,loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,
"GET_RECENT_DOCUMENT_LIST_FAIL",2,"screen_center")});else a=onefficeGW.arrangNewRecentDataToContentList(a.data,c),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=!1;dalert("error:getFileList: 1 CLOUD_CONST_BROWSER_MODE_RECENT")}});break;case CLOUD_CONST_BROWSER_MODE_FAVORITE:duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_IMPORTANTDOCUMENT_LIST,async:!0,data:"",dataType:"json",timeout:3E4,loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=
!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_IMPORTANTDOCUMENT_LIST_FAIL",2,"screen_center")});else a=onefficeGW.convertDataToContentList(a.data),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=!1;dalert("error:getFileList:2 CLOUD_CONST_BROWSER_MODE_FAVORITE")}});break;case CLOUD_CONST_BROWSER_MODE_SHARE:duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_SHARE_DOCUMENT_LIST,async:!0,data:{},dataType:"json",timeout:3E4,
loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_SHARE_DOCUMENT_LIST_FAIL",2,"screen_center")});else a=onefficeGW.convertDataToContentList(a.data),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=!1;dalert("error:getFileList:3 CLOUD_CONST_BROWSER_MODE_SHARE")}});break;case CLOUD_CONST_BROWSER_MODE_SECURITY:duzon_http.ajax({type:"get",
url:ONEFFICE_SERVER_API_GET_SECURITYDOCUMENT_LIST,async:!0,data:"",dataType:"json",timeout:3E4,loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_SECUITYDOCUMENT_LIST_FAIL",2,"screen_center")});else a=onefficeGW.convertDataToContentList(a.data),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=!1;dalert("error:getFileList:4 CLOUD_CONST_BROWSER_MODE_SECURITY")}});
break;case CLOUD_CONST_BROWSER_MODE_TRASHBOX:duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_TRASH_LIST,async:!0,data:"",dataType:"json",timeout:3E4,loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_TRASH_LIST_FAIL",2,"screen_center")});else a=onefficeGW.convertDataToContentList(a.data),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=
!1;dalert("error:getFileList:9 CLOUD_CONST_BROWSER_MODE_TRASHBOX")}});break;default:d&&0<d.length?duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_SEARCH_DOCUMENT_LIST,async:k,data:{keyword:d,storage:f},dataType:"json",timeout:3E4,loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_SEARCH_DOCUMENT_LIST_FAIL",2,"screen_center")});else a=
onefficeGW.convertDataToContentList(a.data),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=!1;dalert("error:getFileList:10 - CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT")}}):duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_DOCUMENT_LIST,async:k,data:{folder_no:b},dataType:"json",timeout:!0===k?3E4:5E3,loading_screen:h,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){0<
document.location.href.indexOf(oneffice.drivePath)&&cmnCtrlToast.showToastMsg(null,"GET_DOCUMENT_LIST_FAIL",2,"screen_center")});else a=onefficeGW.convertDataToContentList(a.data,c),"function"===typeof e&&e(a)},error:function(a){oneffice.onLoadListToServer=!1;dalert("error:getFileList:0 CLOUD_CONST_BROWSER_MODE_MYONEFFICE")}})}}catch(l){dalert(l)}},newTemplateFileName:function(b){var c=ID_RES_CONST_STRING_DEFAULT_FILE_NAME;try{var a=g_objCommonUtil.getToDateStr({fullyear:!1}),d=JSON.parse("{"+b.replace("category",
'"category"').replace("data",'"data"')+"}");c=a+"_"+docformTemplateCategory[d.category].data[d.data].name}catch(e){c=ID_RES_CONST_STRING_DEFAULT_FILE_NAME}finally{return c}},newFileName:function(b){return g_objCommonUtil.getToDateStr({fullyear:!1})+"_"+b},newTemplateFile:function(b,c){try{var a=onefficeGW.newTemplateFileName(c),d=onefficeGW.checkFileName(a),e=a+(!0===fnObjectCheckNull(d)||0===d?"":"("+d+")");onefficeGW.onCreateNewFileContent(e,window.open(),c)}catch(f){dalert("newTemplateFile = "+
f)}},newFile:function(b,c){try{if(!0!==c){var a=onefficeGW.checkFileName(onefficeGW.newFileName(ID_RES_CONST_STRING_DEFAULT_FILE_NAME)),d=ID_RES_CONST_STRING_DEFAULT_FILE_NAME+(!0===fnObjectCheckNull(a)||0===a?"":"("+a+")");d=onefficeGW.newFileName(d);onefficeGW.onCreateNewFile(d,window.open(),c)}else duzon_dialog.viewDialog(null,b,ID_RES_CONST_STRING_NEW_DOCUMENT,duzon_dialog.getFileSubjectInputFormWithFileList(b),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var a=document.getElementById("dze_idx_file_save_remote_subject"),
b=a.value.trim();0===b.length?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ENTER_SUBJECT,2,"screen_center"),a.focus()):(duzon_dialog.closeDialog(),!0===dzeUiConfig.bMobileEdit&&1==g_browserCHK.mobile&&onefficeUtil.setCookieValue("edtM","1",10),onefficeGW.onCreateNewFile(b,window.open(),c))},function(){duzon_dialog.closeDialog()}],function(){var a=onefficeGW.checkFileName(ID_RES_CONST_STRING_DEFAULT_FILE_NAME);dzeJ("#dze_idx_file_save_remote_subject").attr("value",ID_RES_CONST_STRING_DEFAULT_FILE_NAME+
(!0===fnObjectCheckNull(a)||0===a?"":"("+a+")")).select().keydown(function(a){if(a.keyCode===ID_KEYCODE_ENTER){a=document.getElementById("dze_idx_file_save_remote_subject");var b=a.value.trim();0===b.length?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ENTER_SUBJECT,2,"screen_center"),a.focus()):(duzon_dialog.closeDialog(),!0===g_browserCHK.mobile&&onefficeUtil.setCookieValue("edtM","1",10),onefficeGW.onCreateNewFile(b,window.open(),c))}});duzon_dialog.viewTabContents(0);duzon_dialog.initSelectedItemContainer(oneffice_cloud_checkedItemList)},
function(){},!0,"screen_center")}catch(e){dalert(e)}},checkFileName:function(b,c,a,d){try{if(!0===fnObjectCheckNull(c))switch(1*oneffice_cloud_currFolderSeq){case 12003:case 12016:case 12017:case 12002:case 12004:case 12009:case 12010:case 12011:c="";break;case 12030:c=CLOUD_CONST_STRING_NEWSROOM_SEQ;break;default:c=oneffice_cloud_currFolderSeq}!0===fnObjectCheckNull(a)&&(a=!0);var e=this.getDocumentList(c,d);c=[];for(d=0;d<e.length;d++){var f=e[d];if(!0===a?1===1*f.type:0===1*f.type&&0===f.subject.lastIndexOf(b)){var g=
f.subject;if(g===b)c.push(0);else if(0<g.lastIndexOf("(")&&g.substring(0,g.lastIndexOf("("))===b){var k=1*g.substring(g.lastIndexOf("(")+1,g.lastIndexOf(")"));!1===isNaN(k)&&c.push(k)}}}if(0===c.length)return l;var h=[];forEach(c,function(a,b){0>h.indexOf(b)&&h.push(b)},this);c=h;c.sort(function(a,b){return a-b});for(d=0;d<c.length;d++){var l=d;if(d!==c[d])return l}return l+1}catch(q){dalert()}},getFileContentList:function(b,c,a,d,e){try{if(b&&b.length&&0!=b.length)for(var f=b.length,g=[],k=function(){--f;
0==f&&(g.every(function(a){return null===a})&&a?a(g):c&&c(g))},h=0;h<b.length;h++)(function(a,b){onefficeCommon.getFileContent(a,function(a){g[b]=a;k()},function(a){g[b]=null;k()},d&&b<d.length?d[b]:null,e)})(b[h],h)}catch(l){dalert(l)}},onCreateNewFile:function(b,c,a){try{if(!0===a){var d=$_("dze_merge_doc_container").childNodes;a=[];for(var e="",f=0;f<d.length;f++)a.push(d[f].getAttribute("doc_no"));if(0<a.length)onefficeGW.getFileContentList(a,function(a){a.forEach(function(a){if(!1===fnObjectCheckNull(a)&&
!1===fnObjectCheckNull(a.content)){var b=a.content;b=b.replace('document_no="'+a.seq+'"','document_no="'+oneffice.MERGE_DOC+'"');e+=b}});""===e&&(e=oneffice.emptyContent);onefficeGW.onCreateNewFileContent(b,c,e)});else onefficeGW.onCreateNewFileContent(b,c,oneffice.emptyContent)}else onefficeGW.onCreateNewFileContent(b,c,oneffice.emptyContent)}catch(g){}},onCreateNewFileContent:function(b,c,a){try{var d=oneffice.currFolderSeq;switch(1*oneffice.currFolderSeq){case 12003:case 12016:case 12017:case 12002:case 12004:case 12009:case 12010:case 12011:d=
"";break;case 12030:d=CLOUD_CONST_STRING_NEWSROOM_SEQ;break;default:d=oneffice.currFolderSeq}onefficeGW.createFileContent(d,b,a,function(a){if(a)try{var b=oneffice.getEditModeDocPath(a,void 0,onefficeUtil.isArticleForOpenURL(a)?"bizwatch_article":void 0);b.length?(!0===dzeUiConfig.bMobileEdit&&!0===g_browserCHK.mobile&&onefficeUtil.setCookieValue("edtM","1",10),c.location=b):cmnCtrlToast.showToastMsg(null,"OPEN FAILED",2,"screen_center")}catch(g){dalert("oneffice.newFile-openWindow")}})}catch(e){dalert(e)}},
saveAsFile:function(b,c,a,d){try{g_readonlyMode?onefficeGW.copyFileToFolder(oneffice.currFileSeq,b,function(a){onefficeGW.saveFileContent({type:1,seq:a,folderSeq:b,subject:c,content:"",readonly:"",important:""},function(a){"function"===typeof d&&d(a)},null,!0)},null):onefficeGW.saveFileContent({type:1,seq:oneffice.currFileSeq,folderSeq:oneffice.currFolderSeq,subject:oneffice.currFileSubject,content:a,readonly:"",important:""},function(a){onefficeGW.copyFileToFolder(a,b,function(a){onefficeGW.saveFileContent({type:1,
seq:a,folderSeq:b,subject:c,content:"",readonly:"",important:""},function(a){"function"===typeof d&&d(a)},null,!0)},null)},null,!0)}catch(e){dalert(e)}},openDocument:function(b){try{if(onefficeCommon.isOnefficeGuideDoc(b))window.open(oneffice.getEditModeDocPath(b,null,null,!0),"_blank");else{var c=oneffice.getEditModeDocPath(b,void 0,onefficeUtil.isArticleForOpenURL(b)?"bizwatch_article":void 0);c.length?onefficeCommon.openWindow(c,"_blank"):cmnCtrlToast.showToastMsg(null,"OPEN FAILED",2,"screen_center")}}catch(a){dalert(a)}},
getContainsImportantShareInList:function(b){try{for(var c=0,a=0,d=0,e=b.length,f=0;f<e;f++)"1"==b[f].important?a++:0<parseInt(b[f].share_count)?d++:c++;return 0<a||0<d?0===d?a===e?2:1:0===a?d===e?4:3:5:0}catch(g){dalert(g)}},deleteDocumentList:function(b,c){try{var a=oneffice.getListViewMgr();"undefined"==typeof c&&(c=!0);var d=0,e=0,f=0,g=0;if(!0===c){c=!1;for(var k=0;k<b.length;k++){var h=b[k];if(a.isFolder(h)){c=!0;break}}if(c)var l=ID_RES_CONST_STRING_CONFIRM_DELETE_SELECTED_FOLDER_FILE;else{h=
"";switch(onefficeGW.getContainsImportantShareInList(b)){case 1:h=ID_RES_CONST_STRING_CONFIRM_DELETE_CONTAINS_IMPORTANT_DOCUMENT;break;case 2:h=ID_RES_CONST_STRING_CONFIRM_DELETE_IMPORTANT_DOCUMENT;break;case 3:h=ID_RES_CONST_STRING_CONFIRM_DELETE_CONTAINS_SHARE_DOCUMENT;break;case 4:h=ID_RES_CONST_STRING_CONFIRM_DELETE_SHARE_DOCUMENT;break;case 5:h=ID_RES_CONST_STRING_CONFIRM_DELETE_CONTAINS_SHARE_IMPORTANT_DOCUMENT;break;default:h=ID_RES_CONST_STRING_CONFIRM_DELETE_SELECTED_DOCUMENT}l=String.format(h,
b.length)}cmnMsg.showMsg("alert",l,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();for(var c=0;c<b.length;c++){var k=b[c];a.isFile(k)?onefficeGW.deleteFile(b[c].seq,function(a){d++;e++;d==b.length&&(a=0,e==d&&(a=-1),onefficeGW.updateListAfterDelete(d,0,a));0<g&&d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)},function(){g++;d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)}):onefficeGW.deleteFolder(k.seq,function(a){d++;f++;d==b.length&&(a=0,f==d&&(a=1),onefficeGW.updateListAfterDelete(c,
0,a));0<g&&d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)},function(){g++;d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)})}})}else for(k=0;k<b.length;k++)h=b[k],a.isFile(h)?onefficeGW.deleteFile(b[k].seq,function(a){d++;e++;d==b.length&&(a=0,e==d&&(a=-1),onefficeGW.updateListAfterDelete(k,0,a));0<g&&d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)},function(){g++;d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)}):onefficeGW.deleteFolder(b[k].seq,function(a){d++;f++;d==b.length&&
(a=0,f==d&&(a=1),onefficeGW.updateListAfterDelete(k,0,a));0<g&&d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)},function(){g++;d+g==b.length&&onefficeGW.updateListAfterDelete(d,g)});var q=window.event;q.returnValue=!1;q.cancelBubble=!0;q.preventDefault()}catch(m){dalert(m)}},deleteDocument:function(b,c){try{var a=oneffice.getListViewMgr();"undefined"==typeof c&&(c=!0);var d=b.seq;if(!0===c){if(a.isFolder(b))var e=ID_RES_CONST_STRING_CONFIRM_DELETE_FOLDER;else c="",c="1"==b.important?ID_RES_CONST_STRING_CONFIRM_DELETE_IMPORTANT_DOCUMENT:
0<parseInt(b.share_count)?ID_RES_CONST_STRING_CONFIRM_DELETE_SHARE_DOCUMENT:ID_RES_CONST_STRING_CONFIRM_DELETE_SELECTED_DOCUMENT,e=String.format(c,1);cmnMsg.showMsg("alert",e,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();a.isFile(b)?onefficeGW.deleteFile(d,function(a){onefficeGW.updateListAfterDelete(1)},function(){onefficeGW.updateListAfterDelete(0,1)}):onefficeGW.deleteFolder(d,function(a){a=dzeJ(".folder_nav_list_item[docNo="+a+"]").prev();void 0===a.attr("docNo")&&
(a=a.prev());oneffice.getListViewMgr().updateRootFolderStack();oneffice_cloud_currFolderSeq=a.attr("docNo");onefficeGW.updateListAfterDelete(1)},function(){onefficeGW.updateListAfterDelete(0,1)})})}else a.isFile(b)?onefficeGW.deleteFile(d,function(a){onefficeGW.updateListAfterDelete(1)},function(){onefficeGW.updateListAfterDelete(0,1)}):onefficeGW.deleteFolder(d,function(a){onefficeGW.updateListAfterDelete(1)},function(){onefficeGW.updateListAfterDelete(0,1)});closeHomePopup();var f=window.event;
f.returnValue=!1;f.cancelBubble=!0;f.preventDefault()}catch(g){dalert(g)}},updateListAfterDelete:function(b,c,a){try{var d=oneffice.getListViewMgr(),e=fnObjectCheckNull(c)?0:c;a=fnObjectCheckNull(a)?0:a;d.getListViewType()&&(d.m_bChkListInit=e?!1:!0);updateFileList(oneffice_cloud_currFolderSeq,!1);0<e?alert(String.format(ID_RES_CONST_STRING_NOTI_DELETE_FAIL_DOCUMENT_LIST,e)):(c=0<a?ID_RES_CONST_STRING_NOTI_DELETED_FOLDER:ID_RES_CONST_STRING_NOTI_DELETED_DOCUMENT,0==a&&(c=ID_RES_CONST_STRING_NOTI_DELETED_FOLDER_FILE),
cmnCtrlToast.showToastMsg(null,String.format(c,b),2,"screen_center"),oneffice_cloud_checkedItemList=[]);d.m_bChkListInit=!1}catch(f){dalert(f)}},deleteFile:function(b,c,a,d){try{var e=fnObjectCheckNull(d)?!0:d;duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_DELETE_DOCUMENT,async:e,data:{doc_no:b},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,
"GET_DELETE_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof c&&c(a.data.doc_no),onefficeCommon.accessDocumentHistory(a.data.doc_no,CLOUD_CONST_HISTORY_ACTIONCODE_DELETE)},error:function(b){"function"===typeof a&&a(b);dalert(b)}})}catch(f){dalert(f)}},deleteFolder:function(b,c,a){try{duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_DELETE_FOLDER,async:!0,data:{doc_no:b},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==
a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_DELETE_FOLDER_FAIL",2,"screen_center")});else oneffice.m_bFolderChangeUpdate=!0,"function"===typeof c&&c(a.data.doc_no)},error:function(b){"function"===typeof a&&a(b);dalert(b)}})}catch(d){dalert(d)}},recoverDeletedDocument:function(b,c){try{duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_RECOVER_TRASH_DOCUMENT,async:!0,data:{doc_no:b},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],
success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_RECOVER_TRASH_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof c&&c(a),onefficeCommon.accessDocumentHistory(a.data.doc_no,CLOUD_CONST_HISTORY_ACTIONCODE_RESTORE)},error:function(a){dalert(a)}})}catch(a){dalert(a)}},deleteTrashDocument:function(b,c,a){try{"undefined"===typeof a&&(a=!0),duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_DELETE_TRASH_DOCUMENT,async:a,
data:{doc_no:b},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_DELETE_TRASH_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof c&&c(a),onefficeCommon.accessDocumentHistory(a.data.doc_no,CLOUD_CONST_HISTORY_ACTIONCODE_REMOVE)},error:function(a){dalert(a)}})}catch(d){dalert(d)}},emptyTrashbox:function(b){try{duzon_http.ajax({type:"get",
url:ONEFFICE_SERVER_API_GET_EMPTY_TRASH,async:!0,data:{},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(c){if("success"!==c.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_EMPTY_TRASH_FAIL",2,"screen_center")});else"function"===typeof b&&b(c.result)},error:function(b){dalert(b)}})}catch(c){dalert(c)}},shareDocument:function(b,c,a,d,e){try{"undefined"!=typeof updateShareBtnStatus&&(onefficeGW.showDocumentShareStatus("1",
oneffice_cloud_currNEditNumber),updateShareBtnStatus(!0));var f={doc_no:b,share_type:c,share_id:a,share_perm:d};duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_SHARE_DOCUMENT,async:!0,data:f,dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_SHARE_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof e&&e(a.data.doc_no,f),onefficeCommon.accessUserFunction("shareDoc"),
onefficeCommon.accessDocumentHistory(b,CLOUD_CONST_HISTORY_ACTIONCODE_SHARE,JSON.stringify(f))},error:function(a){dalert(a)}})}catch(g){dalert(g)}},unshareDocument:function(b,c,a,d){try{var e={doc_no:b,share_type:c,share_id:a};duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_UNSHARE_DOCUMENT,async:!0,data:e,dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,
"POST_UNSHARE_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof d&&d(),onefficeCommon.accessDocumentHistory(b,CLOUD_CONST_HISTORY_ACTIONCODE_UNSHARE,JSON.stringify(e))},error:function(a){dalert(a)}})}catch(f){dalert(f)}},getShareDocumentList:function(b,c,a,d){try{oneffice.onLoadListToServer=!0,duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_SHARE_DOCUMENT_LIST,async:!0,data:{},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){oneffice.onLoadListToServer=
!1;if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_SHARE_DOCUMENT_LIST_FAIL",2,"screen_center")});else"function"===typeof d&&d(onefficeGW.convertDataToContentList(a.data))},error:function(a){oneffice.onLoadListToServer=!1;dalert(a)}})}catch(e){dalert(e)}},sendMail:function(b,c,a){try{c||(c="[ONEFFICE]");var d=oneffice_cloud_myInfoData.mail_id+"@"+oneffice_cloud_myInfoData.mail_domain,e=new FormData;e.append("subject",c);e.append("from",d);e.append("email",
d);e.append("htmlContents",a);e.append("file_name_list","");c="";for(a=0;a<b.length;a++)c+=b[a].empName,c+=" ",c+="<"+b[a].email+">",a<b.length-1&&(c+=",");e.append("to",c);duzon_http.ajax({type:"post",url:ONEFFICE_GW_API_SEND_MAIL,async:!0,data:e,dataType:"form-data",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(a){a=JSON.parse(a);if(!a||"0"!=a.result||"0"!=a.resultCode||"success"!=a.resultMessage.toLowerCase())oneffice.onErrorCheckSession(function(){setTimeout(function(){cmnCtrlToast.showToastMsg(null,
ID_RES_SEND_MAIL_FAIL,2,"screen_center")},2E3)})},error:function(a){dalert(a)}})}catch(f){dalert(f)}},sendNoteMessage:function(b,c,a){try{var d=1==fnObjectCheckNull(a)?oneffice_cloud_myInfoData.group_seq:a.group_seq,e=1==fnObjectCheckNull(a)?oneffice_cloud_myInfoData.id:a.id;duzon_http.ajaxJSON(ONEFFICE_GW_API_SEND_NOTE,{body:{recvEmpSeq:b,content:c,contentType:"0",secuYn:"N",receiptYn:"N",fileId:"",link:[],linkMsgId:"",groupSeq:d,empSeq:e},header:{pId:"",tId:"",groupSeq:d,empSeq:e}})}catch(f){dalert(f)}},
getMyGroupList:function(b){try{var c=navigator.language||navigator.userLanguage;2<c.length&&(c=c.substr(0,2));"ko"==c&&(c="kr");duzon_http.ajaxJSON(ONEFFICE_GW_API_MYGROUP_LIST,{body:{},header:{pId:"",tId:"",langCode:c,groupSeq:oneffice_cloud_myInfoData.group_seq,empSeq:oneffice_cloud_myInfoData.id}},{timeout:3E4,success:function(a){"SUCCESS"!==a.resultMessage&&dlog(a.resultMessage);"function"===typeof b&&b(a.result.myGroupList)},error:function(a){dlog("error:getMyGroupList.Ajax")}})}catch(a){dalert(a)}},
doMyGroupInsert:function(b){try{duzon_http.ajaxJSON(ONEFFICE_GW_API_MYGROUP_INSERT,{body:{myGroupName:b},header:{pId:"",tId:"",groupSeq:oneffice_cloud_myInfoData.group_seq,empSeq:oneffice_cloud_myInfoData.id}})}catch(c){dalert(c)}},doMyGroupRemove:function(b){try{duzon_http.ajaxJSON(ONEFFICE_GW_API_MYGROUP_DELETE,{body:{myGroupId:b},header:{pId:"",tId:"",groupSeq:oneffice_cloud_myInfoData.group_seq,empSeq:oneffice_cloud_myInfoData.id}})}catch(c){dalert(c)}},doMyGroupMemberInsert:function(b,c,a){try{var d=
[];d.push({deptSeq:c,empSeq:a});duzon_http.ajaxJSON(ONEFFICE_GW_API_MYGROUP_MEMBER_INSERT,{body:{myGroupId:b,members:d},header:{pId:"",tId:"",groupSeq:oneffice_cloud_myInfoData.group_seq,empSeq:oneffice_cloud_myInfoData.id}})}catch(e){dalert(e)}},setAccessDocument:function(b,c,a,d,e){try{var f="0"===a?!1:!0;!0===g_browserCHK.sf&&(f=!0);duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_ACCESS_DOCUMENT,async:f,data:{doc_no:b,access_perm:c,access_status:a,sess_time:d},dataType:"json",timeout:3E4,
loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_ACCESS_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof e&&e(a.data)},error:function(a){dalert(a)}})}catch(g){dalert(g)}},getFolderContent:function(b,c,a){try{!0===fnObjectCheckNull(a)&&(a=!0),duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_GET_DOCUMENT,async:a,data:{doc_no:b},dataType:"json",
timeout:!0===a?3E4:5E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_FOLDER_CONTENT_FAIL",2,"screen_center")});else"function"===typeof c&&c(onefficeCommon.convertDataToContent(a.data))},error:function(a){dalert(a)}})}catch(d){dalert(d)}},arrangNewRecentDataToContentList:function(b,c){try{for(var a=[],d=0;d<b.length;d++){var e=onefficeCommon.convertDataToContent(b[d]);
1<e.security_key.length||0<parseInt(e.security_key,10)?e.security_key=1:e.security_key=0;a.find(function(a){if(a.seq!==e.seq)return a});if("1"!==c||e.owner_id==oneffice_cloud_myInfoData.id)if("2"!==c||e.owner_id!=oneffice_cloud_myInfoData.id){var f=!0,g;for(g in a)a[g].seq===e.seq&&(f=!1);f&&a.push(e)}}return a}catch(k){dalert(k)}},convertDataToContentList:function(b,c){try{for(var a=[],d=0;d<b.length;d++){var e=onefficeCommon.convertDataToContent(b[d]);if("folder"!=c||"0"==e.type)if("file"!=c||"1"==
e.type)1<e.security_key.length||0<parseInt(e.security_key,10)?e.security_key=1:e.security_key=0,"folder"==c&&"0"!=e.type||"file"==c&&"1"!=e.type||a.push(e)}return a}catch(f){dalert(f)}},checkPasswordInputValue:function(b,c){try{oneffice.currFileSecurityStatus=!1;var a=document.getElementById("dze_idx_check_password_input");onefficeCommon.getSecurityInfo(b,a.value,function(d){2!=d?(g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR,2):alert(ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR),
a.focus(),a.setSelectionRange(0,a.value.length)):(duzon_dialog.closeDialog(),updateSecurityButtonByStatus(c),onefficeGW.openFileContent(b,c,a.value))})}catch(d){dalert(d)}},checkPasswordAndOpen:function(b,c){try{cmnDlg.viewBasicDlg(null,c,ID_RES_CONST_STRING_DOCUMENT_SECURITY+" "+ID_RES_CONST_STRING_OPEN_DOCUMENT,onefficeCommon.getCheckPasswordForm(),[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){onefficeGW.checkPasswordInputValue(b,c)},function(a){duzon_dialog.closeDialog();setTimeout(function(){document.location.href=
oneffice.drivePath},500)}],function(){document.getElementById("dze_idx_check_password_input").onkeydown=function(a){ID_KEYCODE_ENTER==a.keyCode&&(0==dzeJ("#idx_msg_box").is(":visible")?onefficeGW.checkPasswordInputValue(b,c):cmnMsg.hideMsg());ID_KEYCODE_ESCAPE==a.keyCode&&setTimeout(function(){document.location.href=oneffice.drivePath},500)}},function(){},!0)}catch(a){dalert(a)}},onefficeFileReload:function(b,c){onefficeCommon.getFileContent(b,function(a){oneffice.currFileRegDate="object"==typeof a.regdate?
getFullDateFromTimeStamp(a.regdate.time):a.regdate;oneffice.currFileModDate="object"==typeof a.moddate?getFullDateFromTimeStamp(a.moddate.time):a.moddate;oneffice.currFileOwnerId=a.owner_id;updateSecurityButtonByStatus(c);resData=a.content;onefficeUtil.onReloadFileContent(a,c)},function(a){cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALREADY_DELETED_DOCUMENT,2,"screen_center");setTimeout(function(){"undefined"===typeof onefficeWE&&(document.location.href=oneffice.drivePath)},3500)})},openFileContent:function(b,
c,a){try{var d=onefficeCommon.getOnefficeGuideDoc(b);d&&d.file?onefficeUtil.openHTMLContent(b,d.file,c):onefficeCommon.getFileContent(b,function(a){"data_bind_f"===onefficeUtil.getRequestParameter("db_step")?(cmnMsg.showMsg("loadbind","ONEFFICE\ub85c \ub370\uc774\ud130\ubc14\uc778\ub529 \uc911\uc785\ub2c8\ub2e4.",null,[],function(){}),setTimeout(function(){dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ub370\uc774\ud130 \ubd84\uc11d \uc911")},1E3),setTimeout(function(){dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ud45c / \ucc28\ud2b8 \uc0dd\uc131 \uc911")},
2500),setTimeout(function(){onefficeUtil.onLoadFileContent(a,c)},3500),setTimeout(function(){dzeJ(".duzon_msg_box_sub_message").eq(0).text("\ub370\uc774\ud130 \ucc98\ub9ac \uc911")},5500),setTimeout(function(){cmnMsg.hideMsg()},6500)):(onefficeUtil.onLoadFileContent(a,c),!0===Binder.getInstance().checkDoBind()&&(cmnMsg.showMsg("loadbind","ONEFFICE\ub85c \ub370\uc774\ud130\ubc14\uc778\ub529 \uc911\uc785\ub2c8\ub2e4.",null,[],function(){}),setTimeout(function(){Binder.getInstance().getJSONData()},100)))},
function(a){dzeLayoutControl.setReadonlyMode(!0,c);!0===g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALREADY_DELETED_DOCUMENT,1E3):(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALREADY_DELETED_DOCUMENT,2,"screen_center"),setTimeout(function(){"undefined"===typeof onefficeWE&&(document.location.href=oneffice.drivePath)},3500))},a)}catch(e){dalert(e)}},viewDocumentAccessInfo:function(b){try{onefficeCommon.getDocumentAccessInfo(b,function(b){if(0!=b.length){var a=0,c=
0;for(c;c<b.length;c++)if("W"==b[c].access_perm&&"1"==b[c].access_status){setTimeout(function(){cmnCtrlToast.showToastMsg(null,"["+b[c].name+"]\ub2d8\uc774 \ud3b8\uc9d1\uc911\uc785\ub2c8\ub2e4. \uc77d\uae30\uc804\uc6a9\uc73c\ub85c \uc5f4\ub838\uc2b5\ub2c8\ub2e4.",2)},1E3);a=1;break}0==a&&(cmnCtrlToast.showToastMsg(null,"\ub2e4\ub978 \uc0ac\uc6a9\uc790\uac00 \ud3b8\uc9d1\uc911\uc785\ub2c8\ub2e4. \uc77d\uae30\uc804\uc6a9\uc73c\ub85c \uc5f4\ub838\uc2b5\ub2c8\ub2e4.",2),c=-1);onefficeUtil.setReadonlyNotificationBar(g_nActiveEditNumber,
b,c)}})}catch(c){dalert(c)}},setTimerDocumentAccessStatus:function(b,c){try{oneffice.accessInfoRefreshInterval=setInterval(function(){onefficeGW.setAccessDocument(oneffice.currFileSeq,b,"1",360,function(a){})},3E5),"W"===c.share_perm&&!0===objOnefficeLoader.m_bAccessManager&&onefficeGW.setAccessManager(c.seq,c.my_id,function(a){1<=a.result&&onefficeUtil.searchAccessManagerConnectInterval()})}catch(a){dalert(a)}},saveFile:function(b,c,a,d,e,f,g,k,h){try{if(b)if(""==d)"undefined"!=typeof localStorage&&
localStorage.setItem("SaveFile Error",arguments.callee.caller.name),"function"===typeof k&&k("");else{if(!0===g_readonlyMode)return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT,2),null;var l={type:1,seq:b,folderSeq:c,subject:a,content:d,content_size:"0",owner_id:"",keyword:"",readonly:"",regdate:"",moddate:"",accessdate:"",important:"",deleted:"0",openFileDate:oneffice.currFileOpenDate,openPath:oneffice.currFilePath};"undefined"===typeof g&&(g=!0);onefficeGW.saveFileContent(l,
function(a){oneffice.parentFileContent.content=l.content;"function"===typeof f&&f(a);a==l.seq&&(h||onefficeGW.setAccessDocument(l.seq,"W","1",360,function(a){"R"==a.access_perm&&(dzeLayoutControl.setReadonlyMode(!0,e),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_CHANGED_TO_READ_ONLY,2))}),onefficeCommon.accessDocumentHistory(a,CLOUD_CONST_HISTORY_ACTIONCODE_MODIFY))},function(a){"function"===typeof k&&k()},g)}}catch(q){dalert(q)}},getShareInfo:function(b,c,a,d){try{!0===fnObjectCheckNull(a)&&
(a=!0),duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_SHARE_INFO,async:a,data:{doc_no:b},dataType:"json",timeout:!0===a?3E4:5E3,loading_screen:d,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_SHARE_INFO_FAIL",2,"screen_center")});else"function"===typeof c&&c(a.data)},error:function(a){dalert(a)}})}catch(e){dalert(e)}},createFileContent:function(b,c,a,d,e,f){try{if(""==a||a==
oneffice.emptyContent)a=oneffice.emptyServerContent;!0===fnObjectCheckNull(f)&&(f=!0);duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_CREATE_DOCUMENT,async:!0,data:{folder_no:b,doc_name:c,content:a},dataType:"json",timeout:3E4,loading_screen:f,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_CREATE_DOCUMENT_FAIL",2,"screen_center")});else{"function"===typeof d&&d(a.data.doc_no);
var c=objOnefficeLoader.m_bDomainBizwatch?onefficeUtil.isArticle(b)?"createNews":"createDoc":"createDoc";onefficeCommon.accessUserFunction(c);onefficeCommon.accessDocumentHistory(a.data.doc_no,CLOUD_CONST_HISTORY_ACTIONCODE_NEWDOC)}},error:function(a){"function"===typeof e&&e(a);dalert(a)}})}catch(g){dalert(g)}},copyFileToFolder:function(b,c,a,d){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_COPY_DOCUMENT,async:!0,data:{doc_no:b,folder_no:c},dataType:"json",timeout:3E4,loading_screen:!0,
loading_image_url:"",loading_image_size:[],success:function(d){if("success"!==d.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_COPY_DOCUMENT_FAIL",2,"screen_center")});else{"function"===typeof a&&(d.data.new_doc_no?a(d.data.new_doc_no):d.data.doc_no&&a(d.data.doc_no));var e=objOnefficeLoader.m_bDomainBizwatch?onefficeUtil.isArticle(c)?"copyNews":"copyDoc":"copyDoc";onefficeCommon.accessUserFunction(e);d.data.new_doc_no&&onefficeCommon.accessDocumentHistory(d.data.new_doc_no,
CLOUD_CONST_HISTORY_ACTIONCODE_NEWDOC);onefficeCommon.accessDocumentHistory(b,CLOUD_CONST_HISTORY_ACTIONCODE_MAKE_COPY)}},error:function(a){"function"===typeof d&&d(a);dalert(a)}})}catch(e){dalert(e)}},getEmpListInGroup:function(b,c,a,d,e){try{!0===fnObjectCheckNull(d)&&(d=!0),duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_EMPLIST_WITNIN_DEPT,async:d,data:b,dataType:"json",timeout:!0===d?3E4:1E4,loading_screen:e,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==
a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_EMPLIST_WITNIN_DEPT_FAIL",2,"screen_center")});else"function"===typeof c&&c(a.data)},error:function(b){"function"===typeof a&&a(b);dalert(b)}})}catch(f){dalert(f)}},getEmpListForComment:function(b,c,a){try{0!==b.length&&duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_MENTION_EMP_LIST,async:!0,data:b,dataType:"json",timeout:3E4,loading_screen:c,loading_image_url:"",loading_image_size:[],success:function(b){if("success"!==
b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_MENTION_EMP_LIST",2,"screen_center")});else"function"===typeof a&&a(b.data)},error:function(a){dalert(a)}})}catch(d){dalert(d)}},saveFileContent:function(b,c,a,d){try{var e=oneffice.getListViewMgr();!0===fnObjectCheckNull(b.readonly)?b.readonly=0:!0===b.readonly||"true"===b.readonly||1===parseInt(b.readonly,10)?b.readonly=1:b.readonly=0;"undefined"===typeof d&&(d=!0);var f=!1;!0!==d&&(f=!0);var g={doc_no:b.seq,folder_no:b.folderSeq,
doc_name:b.subject,readonly:b.readonly,important:b.important,content:b.content,openFileDate:b.openFileDate,openPath:b.openPath};!1===fnObjectCheckNull(b.security_key)&&0!==parseInt(b.security_key,10)&&1!==parseInt(b.security_key,10)&&("false"===b.security_key||"true"===b.security_key?b.security_key="":g.security_key=b.security_key);!0===dzeUiConfig.bTempSaveToLocalStorage&&b.content&&onefficeUtil.saveTempDataToLocalStorage(b.seq,g);duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_UPDATE_DOCUMENT,
async:d,data:g,dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:f,success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){onefficeCommon.showServerErrorDialog();onefficeUtil.showDocSubject();onefficeUtil.updateProgressBar(!0,!0)});else!0===dzeUiConfig.bTempSaveToLocalStorage&&b.content&&onefficeUtil.removeTempDataFromLocalStorage(b.seq),oneffice.bModified=!1,g_objUndoRedo&&g_objUndoRedo.arrUndoRedoStruct&&0<g_objUndoRedo.arrUndoRedoStruct.length&&
(oneffice.bModifiedPos=g_objUndoRedo.arrUndoRedoStruct[oneffice_cloud_currNEditNumber].nUndoRedoStackPos),"function"===typeof c&&(!g.content||!g_objSupport.bThumbListView||null!=e&&e&&e.m_nChecLstInitMode||g_objThumbMgr.uploadThumbProcess(oneffice_cloud_currNEditNumber,d),c(a.data.doc_no))},error:function(b){oneffice.onErrorCheckSession(function(){onefficeCommon.showServerErrorDialog();onefficeUtil.showDocSubject();onefficeUtil.updateProgressBar(!0,!0)});"function"===typeof a&&a(b);dalert(b)}})}catch(k){dalert(k)}},
createFolderContent:function(b,c,a,d){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_CREATE_FOLDER,async:!0,data:{folder_no:b,doc_name:c},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_CREATE_FOLDER_FAIL",2,"screen_center")});else oneffice.m_bFolderChangeUpdate=!0,"function"===typeof a&&a(b.data.doc_no)},error:function(a){"function"===
typeof d&&d(a);dalert(a)}})}catch(e){dalert(e)}},saveFolderContent:function(b,c,a){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_UPDATE_FOLDER,async:!0,data:{doc_no:b.seq,folder_no:b.folderSeq,doc_name:b.subject,important:b.important},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_UPDATE_FOLDER_FAIL",2,"screen_center")});
else"function"===typeof c&&c(a.data.doc_no)},error:function(b){"function"===typeof a&&a(b);dalert(b)}})}catch(d){dalert(d)}},getDocumentHistory:function(b,c,a,d){try{!0===fnObjectCheckNull(a)&&(a=!0),duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_DOCUMENT_HISTORY,async:a,data:{doc_no:b},dataType:"json",timeout:!0===a?3E4:5E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,
"ONEFFICE_SERVER_API_GET_DOCUMENT_HISTORY",2,"screen_center")});else a=a.data,"function"===typeof c&&c(a)},error:function(a){"function"===typeof d&&d();dlog("error:getDocumentHistory")}})}catch(e){dalert(e)}},setReadonly:function(b,c){try{var a=oneffice.getListViewMgr();onefficeCommon.getFileContent(b,function(d){var e=0;!0===c&&(e=1);var f=duzon_http.getCurrTime();d={type:d.type,seq:b,folderSeq:d.folderSeq,subject:"",content:"",content_size:d.content_size,owner_id:d.owner_id,keyword:d.keyword,readonly:e,
regdate:d.regdate,moddate:f,accessdate:d.accessdate,important:d.important,deleted:d.deleted,openFileDate:d.hasOwnProperty("openFileDate")?d.openFileDate:"",openPath:d.hasOwnProperty("openPath")?d.openPath:""};onefficeGW.saveFileContent(d,function(d){d==b&&(a.getListViewType()&&(a.m_bChkListInit=!0),c?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SET_READ_ONLY,2,"screen_center",null,TOAST_TYPE_OPTION_OK),onefficeCommon.accessDocumentHistory(b,CLOUD_CONST_HISTORY_ACTIONCODE_READONLY_ON)):(cmnCtrlToast.showToastMsg(null,
ID_RES_CONST_STRING_SET_EDITABLE,2,"screen_center",null,TOAST_TYPE_OPTION_OK),onefficeCommon.accessDocumentHistory(b,CLOUD_CONST_HISTORY_ACTIONCODE_READONLY_OFF)),updateFileList(oneffice_cloud_currFolderSeq,!1),a.m_bChkListInit=!1)})},function(a){dalert(a)})}catch(d){dalert(d)}},setFavorite:function(b,c){try{var a=oneffice.getListViewMgr();onefficeCommon.getFileContent(b,function(d){var e=c?1:0,f=duzon_http.getCurrTime();d={type:d.type,seq:b,folderSeq:d.folderSeq,subject:"",content:"",content_size:d.content_size,
owner_id:d.owner_id,keyword:d.keyword,readonly:d.readonly,regdate:d.regdate,moddate:f,accessdate:d.accessdate,important:e,deleted:d.deleted,openFileDate:d.hasOwnProperty("openFileDate")?d.openFileDate:"",openPath:d.hasOwnProperty("openPath")?d.openPath:""};onefficeGW.saveFileContent(d,function(d){d==b&&(a.getListViewType()&&(a.m_bChkListInit=!0),c?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_SET_UP,2,"screen_center",null,TOAST_TYPE_OPTION_OK):cmnCtrlToast.showToastMsg(null,
ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_NOT_SET_UP,2,"screen_center",null,TOAST_TYPE_OPTION_OK),updateFileList(oneffice_cloud_currFolderSeq,!1),a.m_bChkListInit=!1)})},function(a){dalert(a)})}catch(d){dalert(d)}},setSecurityPassword:function(b,c,a,d){try{var e=oneffice.getListViewMgr();0<c&&(null===a||""===a)||(2===c&&fnObjectCheckNull(d)?alert(ID_RES_CONST_STRING_NOTI_CONFIRMATION_PASSWORD_ERROR):onefficeCommon.getFileContent(b,function(f){var g=2===c?d:a;0===c&&(g="");var k=duzon_http.getCurrTime();
f={type:f.type,seq:b,folderSeq:f.folderSeq,subject:"",content:"",content_size:f.content_size,owner_id:f.owner_id,keyword:f.keyword,readonly:f.readonly,regdate:f.regdate,moddate:k,accessdate:f.accessdate,important:f.important,deleted:f.deleted,security_key:g,openFileDate:f.hasOwnProperty("openFileDate")?f.openFileDate:"",openPath:f.hasOwnProperty("openPath")?f.openPath:""};onefficeGW.saveFileContent(f,function(a){a==b&&(e.getListViewType()&&(e.m_bChkListInit=!0),oneffice.currFileSecurityStatus=!0,
1==c?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SET_COMPLETE_PASSWORD,2,"screen_center"),onefficeCommon.accessDocumentHistory(a,CLOUD_CONST_HISTORY_ACTIONCODE_SECURITY_ON)):2==c?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_CHANGE_COMPLETE_PASSWORD,2,"screen_center"),onefficeCommon.accessDocumentHistory(a,CLOUD_CONST_HISTORY_ACTIONCODE_SECURITY_CHANGE)):(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_UNSET_COMPLETE_PASSWORD,2,"screen_center"),oneffice.currFileSecurityStatus=!1,
onefficeCommon.accessDocumentHistory(a,CLOUD_CONST_HISTORY_ACTIONCODE_SECURITY_OFF)),updateSecurityButtonByStatus(0),oneffice.isLoadEditor()||updateFileList(oneffice_cloud_currFolderSeq,!1),e.m_bChkListInit=!1)})},function(a){dalert(a)},1===c?"undefined":a))}catch(f){dalert(f)}},renameDocument:function(b,c,a,d){try{var e=oneffice.getListViewMgr(),f=e.isFolder(b);e.getListViewType()?(b.docData.strTitle=c,b=e.convertFileListData(b)):b.subject=c;f?onefficeGW.saveFolderContent(b,function(b){"function"===
typeof a&&a()},function(a){"function"===typeof d&&d()}):onefficeGW.saveFileContent(b,function(b){"function"===typeof a&&a();onefficeCommon.accessDocumentHistory(b,CLOUD_CONST_HISTORY_ACTIONCODE_RENAME)},function(a){"function"===typeof d&&d()})}catch(g){dalert(g)}},restoreDocument:function(b){try{var c=oneffice.getListViewMgr(),a=c.getListViewType(),d=!1;if(1===b.length)d=c.isFolder(b[0]),onefficeGW.recoverDeletedDocument(b[0].seq,function(b){"success"==b.result?(d&&(oneffice.m_bFolderChangeUpdate=
!0),a&&(c.m_bChkListInit=!0),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECOVERED,2,"screen_center"),updateFileList(oneffice_cloud_currFolderSeq,!1),c.m_bChkListInit=!1):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECOVERED_FAIL,2,"screen_center")});else for(var e=0,f=0,g=0;g<b.length;g++)!1===d&&(d=c.isFolder(b[0])),onefficeGW.recoverDeletedDocument(b[g].seq,function(g){++f;"fail"==g.result&&e++;d&&(oneffice.m_bFolderChangeUpdate=!0);f===b.length&&(0<e?e===b.length?cmnCtrlToast.showToastMsg(null,
ID_RES_CONST_STRING_FULL_RECOVERY_FAILED,2,"screen_center"):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SOME_RECOVERY_FAILED,2,"screen_center"):(a&&(c.m_bChkListInit=!0),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECOVERED_ALL,2,"screen_center"),updateFileList(oneffice_cloud_currFolderSeq,!1),c.m_bChkListInit=!1))})}catch(k){dalert(k)}},deleteCompleteDocument:function(b){try{var c=oneffice.getListViewMgr();if(1===b.length)cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_CONST_STRING_COMPLETE_DELETE_CONFIRM,
null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();onefficeGW.deleteTrashDocument(b[0].seq,function(a){"success"==a.result&&(c.getListViewType()&&(c.m_bChkListInit=!0),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DELETED,2,"screen_center"),updateFileList(oneffice_cloud_currFolderSeq,!1),c.m_bChkListInit=!1)})});else{var a=0,d=0;cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_CONST_STRING_COMPLETE_DELETE_CONFIRM,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();
for(var e=0;e<b.length;e++)onefficeGW.deleteTrashDocument(b[e].seq,function(e){++d;"fail"==e.result&&a++;d===b.length&&(c.getListViewType()&&(c.m_bChkListInit=a?!1:!0),0<a?a===b.length?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DELETE_ALL_FAIL,2,"screen_center"):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DELETE_SOME_FAIL,2,"screen_center"):(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DELETED_ALL,2,"screen_center"),updateFileList(oneffice_cloud_currFolderSeq,!1)),c.m_bChkListInit=
!1)})})}}catch(e){dalert(e)}},clearTrashbox:function(){var b=oneffice.getListViewMgr();try{cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_CONST_STRING_COMPLETE_DELETE_CONFIRM,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();onefficeGW.emptyTrashbox(function(c){b.getListViewType()&&(b.m_bChkListInit=!0);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_TRASH_IS_EMPTY,2,"screen_center");updateFileList(oneffice_cloud_currFolderSeq,!1);b.m_bChkListInit=!1})})}catch(c){dalert(c)}},
getSaveAsRemoteContainer:function(){try{var b=document.createElement("div");b.style.width="400px";b.ondragstart=function(){return!1};b.onselectstart=function(){return!1};var c="";c+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";c+="<tr>";c+="<td height='25' width='70' style='padding:5px'>"+ID_RES_CONST_STRING_DOCUMENT_TITLE+"</td>";c+="<td><input type='text' style='width:308px' id='dze_idx_file_save_remote_subject' value='' placeholer=''></td>";c+="</tr>";c+="<tr>";c+="<td height='25' valign='top' style='padding:5px'>"+
ID_RES_CONST_STRING_SAVE_PATH+"</td>";c+="<td valign='top'>";c+="<div id='dze_idx_folder_tree' ondragstart='return false' onselectstart='return false' style='width:327px;height:150px;overflow:auto;border:#a0a0a0 1px solid;'></div><input type='hidden' id='dze_idx_save_folder_seq_form' value='' />";c+="</td>";b.innerHTML=c+"</tr></table>";return b}catch(a){dalert(a)}},getSaveAsRemoteSubject:function(b,c,a){try{var d=onefficeGW.checkFileName(c,a);dlog("nSuffixIndex : ",d);if(0<c.indexOf("(")){var e=
1*c.substring(c.lastIndexOf("(")+1,c.lastIndexOf(")"));!1===isNaN(e)&&(c=c.substring(0,c.lastIndexOf("(")),!1===fnObjectCheckNull(d)&&0<d&&(c+="("+d+")"))}else 0<d&&(c+="("+d+")");return c}catch(f){dalert(f)}},getSaveAsRemoteDialogOnload:function(b,c){try{var a=oneffice.currFileSubject+ID_RES_STRING_COPY_SUBJECT_TEXT;if(0<a.indexOf("(")){var d=1*a.substring(a.lastIndexOf("(")+1,a.lastIndexOf(")"));!1===isNaN(d)&&(a=a.substring(0,a.lastIndexOf("(")),onefficeGW.checkFileName(a,oneffice.currFolderSeq))}dzeJ("#dze_idx_file_save_remote_subject").attr("value",
a).select().keydown(function(a){if(a.keyCode===ID_KEYCODE_ENTER)if(!0===onefficeExtContent.extNewDoc)onefficeExtContent.extSaveAsRemoteOkClick(b);else if(!0===oneffice.bTempLoadedContent)onefficeExtContent.extSaveAsRemoteOkClick(b,function(){onefficeUtil.removeTempDataFromLocalStorage(oneffice.currFileSeq);document.location.reload()});else onefficeGW.onSaveAsRemoteOkClick(b)});var e=document.getElementById("dze_idx_folder_tree");onefficeGW.viewFolderTree(e,c)}catch(f){dalert(f)}},onSaveAsRemoteOkClick:function(b){try{var c=
document.getElementById("dze_idx_file_save_remote_subject").value,a=document.getElementById("dze_idx_save_folder_seq_form").value;c=onefficeGW.getSaveAsRemoteSubject(0,c,a);if(""==c.trim())cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ENTER_SUBJECT,2),document.getElementById("dze_idx_file_save_remote_subject").focus();else{var d=getEditorHTMLCode(!1,b,!0);onefficeGW.saveAsFile(a,c,d,function(a){a&&(a="seq="+a,oneffice.onefficeGroupSeq&&"undefined"!==typeof oneffice.onefficeGroupSeq&&(a+="&groupseq="+
oneffice.onefficeGroupSeq),a=window.btoa(a),window.open(oneffice.onefficePath+"?"+encodeURIComponent(a),"_blank"))});duzon_dialog.closeDialog()}}catch(e){dalert(e)}},onSaveAsRemoteCancelClick:function(b){try{duzon_dialog.closeDialog()}catch(c){dalert(c)}},getDocumentSecuritySettingContainer:function(b){try{var c=document.createElement("div");c.style.width="400px";c.ondragstart=function(){return!1};c.onselectstart=function(){return!1};var a="";b?(a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>",
a+="<tr style='vertical-align:top;'>",a+="<td colspan='2' height='30'>",a+="<span><input type='radio' name='dze_security_status_type' checked id='dze_idx_security_status_change' tabindex='1' onclick='onefficeGW.onDocumentSecuritySettingStatusChange(this);'><label for='dze_idx_security_status_change'>"+ID_RES_CONST_STRING_CHANGE_PASSWORD+"</label></span>",a+="<span style='margin-left:15px;'><input type='radio' name='dze_security_status_type' id='dze_idx_security_status_unset' tabindex='2' onclick='onefficeGW.onDocumentSecuritySettingStatusChange(this);'><label for='dze_idx_security_status_unset'>"+
ID_RES_CONST_STRING_UNSET_PASSWORD+"</label></span>",a+="</td>",a+="</tr>",a+="<tr>",a+="<td height='25' width='60' style='padding:5px'>"+ID_RES_CONST_STRING_DOCUMENT_PASSWORD+" : </td>",a+="<td><input type='password' maxlength='20' style='width:308px; font-size: 24px !important; padding: 0 5px; border: 1px solid lightgray;' id='dze_idx_document_password_input' value='' placeholer=''></td>",a+="</tr>",a+="<tr>",a+="<td height='25' width='60' style='padding:5px'>"+ID_RES_CONST_STRING_DOCUMENT_NEW_PASSWORD+
" : </td>",a+="<td><input type='password' maxlength='20' style='width:308px; font-size: 24px !important; padding: 0 5px; border: 1px solid lightgray;' id='dze_idx_document_new_password_input' value='' placeholer=''></td>"):(a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>",a+="<tr>",a+="<td height='25' width='60' style='padding:5px'>"+ID_RES_CONST_STRING_DOCUMENT_PASSWORD+" : </td>",a+="<td><input type='password' maxlength='20' style='width:308px; font-size: 24px !important; padding: 0 5px; border: 1px solid lightgray;' id='dze_idx_document_password_input' value='' placeholer=''></td>");
a+="</tr>";a+="<tr>";a+="<td height='25' width='60' style='padding:5px'>"+ID_RES_CONST_STRING_PASSWORD_CONFIRMATION+" : </td>";a+="<td><input type='password' maxlength='20' style='width:308px; font-size: 24px !important; padding: 0 5px; border: 1px solid lightgray;' id='dze_idx_document_password_input_confirm' value='' placeholer=''></td>";a+="</tr>";a+="<tr>";a+="<td colspan='2' width='100%' height='auto' style='color:red; padding:5px; white-space:pre-wrap;'>"+ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING_NOTE+
"</td>";a+="</tr>";c.innerHTML=a+"</table>";return c}catch(d){dalert(d)}},onDocumentSecuritySettingDialogOnload:function(b){try{var c=document.getElementById("dze_idx_document_password_input"),a=document.getElementById("dze_idx_document_new_password_input"),d=document.getElementById("dze_idx_document_password_input_confirm");c&&(c.focus(),c.onkeydown=function(a){if(ID_KEYCODE_ENTER==a.keyCode)onefficeGW.onDocumentSecuritySettingOkClick(oneffice.currFileSeq,b)});a&&(a.onkeydown=function(a){if(ID_KEYCODE_ENTER==
a.keyCode)onefficeGW.onDocumentSecuritySettingOkClick(oneffice.currFileSeq,b)});d&&(d.onkeydown=function(a){if(ID_KEYCODE_ENTER==a.keyCode)onefficeGW.onDocumentSecuritySettingOkClick(oneffice.currFileSeq,b)})}catch(e){dalert(e)}},onDocumentSecuritySettingOkClick:function(b,c){try{var a=document.getElementById("dze_idx_document_password_input"),d=document.getElementById("dze_idx_document_new_password_input"),e=document.getElementById("dze_idx_document_password_input_confirm");"undefined"===a.value||
""===a.value||4>a.value.length?(alert(ID_RES_CONST_STRING_NOTI_PASSWORD_LENGTH_ERROR),a.focus()):c?d.value!==e.value?(alert(ID_RES_CONST_STRING_NOTI_CONFIRMATION_PASSWORD_ERROR),e.focus()):a.value===d.value?(alert(ID_RES_CONST_STRING_NOTI_DUPLICATE_PASSWORD_ERROR),d.focus()):onefficeCommon.getSecurityInfo(b,a.value,function(c){if(2==c){if(d.disabled)onefficeGW.setSecurityPassword(b,0,a.value);else{if("undefined"===d.value||""===d.value||4>d.value.length){alert(ID_RES_CONST_STRING_NOTI_PASSWORD_LENGTH_ERROR);
d.focus();return}onefficeGW.setSecurityPassword(b,2,a.value,d.value)}duzon_dialog.closeDialog()}else g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR,2):alert(ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR),a.focus()},function(){g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR,2):alert(ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR);a.focus()}):a.value!==e.value?(alert(ID_RES_CONST_STRING_NOTI_CONFIRMATION_PASSWORD_ERROR),
e.focus()):(onefficeGW.setSecurityPassword(b,1,a.value),duzon_dialog.closeDialog())}catch(f){dalert(f)}},onDocumentSecuritySettingStatusChange:function(b){try{document.getElementById("dze_idx_document_password_input").focus();var c=document.getElementById("dze_idx_document_new_password_input"),a=document.getElementById("dze_idx_document_password_input_confirm");1===b.tabIndex?(c.disabled=!1,a.disabled=!1):(c.disabled=!0,c.value="",a.disabled=!0,a.value="")}catch(d){dalert(d)}},viewFolderTree:function(b,
c){try{var a=document.createElement("div");a.className="viewFolderTreeItems";a.innerHTML="<div style='padding:5px;font-weight:bold;'><span><img src='./image/cloud/ico_cloud_folder.png' align='top' /> "+ID_RES_CONST_STRING_BROWSER_MY+"</span></div>";a.setAttribute("folderSeq","");a.style.cursor="pointer";a.onclick=function(a){onefficeGW.selectFolderSeq(this);TBCancelBubbleEvent(a)};b.appendChild(a);var d=oneffice_cloud_myInfoData.id==oneffice.currFileOwnerId?oneffice.currFolderSeq:"";5===oneffice_cloud_currFolderSeq.toString().length?
d="":""!==oneffice_cloud_currFolderSeq&&(d=oneffice_cloud_currFolderSeq);if(""===d)onefficeGW.viewSubFolderTree(0,"",a,!1,function(a){onefficeGW.selectFolderSeq(a)},function(a){}),onefficeGW.selectFolderSeq(a);else{var e=function(b){d=b.folderSeq;""!==d?(oneffice.arrFolderSeqList.push(d),onefficeGW.getFolderContent(d,e)):(onefficeGW.viewSubFolderTree(0,"",a,c,function(a){onefficeGW.selectFolderSeq(a)},function(a){}),onefficeGW.selectFolderSeq(a))};oneffice.arrFolderSeqList=[];onefficeGW.getFolderContent(d,
e)}}catch(f){dalert(f)}},getDepthSpacer:function(b){try{for(var c="",a=0;a<b;a++)c+="&nbsp;&nbsp;&nbsp;";return c}catch(d){dalert(d)}},makeNewFolderName:function(b,c){try{for(var a=null,d=0,e=0;e<b.length;e++)c===b[e].getAttribute("parentSeq")&&(a=b[e].innerText.trim(),a==ID_RES_CONST_STRING_NEW_FOLDER?d++:a==ID_RES_CONST_STRING_NEW_FOLDER+"("+d+")"&&d++);return 0<d?1===d?ID_RES_CONST_STRING_NEW_FOLDER+"(1)":ID_RES_CONST_STRING_NEW_FOLDER+"("+d+")":ID_RES_CONST_STRING_NEW_FOLDER}catch(f){dalert(f)}},
addNewFolderInputOnFolderTree:function(b){try{var c=document.getElementById("dze_idx_folder_tree").getElementsByClassName("viewFolderTreeItems"),a=document.getElementById("dze_idx_save_folder_seq_form").value;if(!document.getElementById("dze_idx_temp_new_folder_input_div"))for(var d=0;d<c.length;d++){var e=c[d].getAttribute("folderSeq");if(e&&e==a||""===e&&""===a){var f=c[d].getAttribute("folderDepth");null===f&&(f=-1);var g=onefficeGW.getDepthSpacer(parseInt(f)+2),k=document.createElement("div"),
h=onefficeGW.makeNewFolderName(c,e);k.id="dze_idx_temp_new_folder_input_div";k.innerHTML="<div style='padding:5px'><span>"+g+"</span><span><img src='./image/cloud/ico_cloud_folder.png' align='top' /></span>&nbsp;<span><input id='dze_idx_new_folder_input_form' value='' parentSeq='"+e+"' style='max-width:200px;height:auto;' /></span></div>";c[d].appendChild(k);setTimeout(function(){var c=parseInt(f)+1,d=document.getElementById("dze_idx_new_folder_input_form");d.value=h;d.focus();d.setSelectionRange(0,
d.value.length);d.onkeydown=function(e){var f=d.getAttribute("parentSeq"),g=document.getElementById("dze_idx_folder_tree").getElementsByTagName("div");if(ID_KEYCODE_ENTER==e.keyCode){for(var k=null,h=0;h<g.length;h++){var l=g[h].getAttribute("folderSeq");if(""===l&&""===a){k=g[h];break}l&&l==a&&(k=g[h])}var m=d.value;""==m&&cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_PLEASE_INPUT_FOLDER_NAME,2,"screen_center");onefficeGW.getFileList(a,"folder",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,"",function(a){for(var g=
0;g<a.length;g++)if(a[g].subject==m)return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_WARNING_FILE_DUPLICATE,2,"screen_center"),!1;onefficeGW.removeNewfolderInputDiv();e.preventDefault();onefficeGW.createFolderContent(f,m,function(a){onefficeGW.removeSubFolderTree(k);onefficeGW.viewSubFolderTree(c,f,k,!1,function(a){onefficeGW.selectFolderSeq(a)},function(a){dlog("viewSubFolderTree: "+a)})});subTreeArrowIconChange(f);"undefined"!=typeof b&&b(f,d.value)})}};d.onblur=function(a){onefficeGW.removeNewfolderInputDiv()}},
10)}}}catch(l){dalert(l)}},removeNewfolderInputDiv:function(){try{var b=document.getElementById("dze_idx_temp_new_folder_input_div");b&&b.parentNode&&(b.id="",b.parentNode.removeChild(b))}catch(c){dalert(c)}},removeSubFolderTree:function(b){try{for(var c=0;c<b.childNodes.length;c++)b.childNodes[c].getAttribute("folderSeq")&&b.removeChild(b.childNodes[c--])}catch(a){dalert(a)}},viewSubFolderTree:function(b,c,a,d,e,f){try{onefficeGW.getFileList(c,"folder",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,"",function(c){0==
c.length&&"function"===typeof f&&f(0);for(var g=[],h=null,l="",q=onefficeGW.getDepthSpacer(b),m=oneffice.arrFolderSeqList.pop(),u=0,n=0;u<c.length;u++)onefficeGW.getSubFolderCnt(c[u],function(f){var k=f.count,p=f.item;0<dzeJ(".viewFolderTreeItems[folderSeq="+p.seq+"]").length&&dzeJ(".viewFolderTreeItems[folderSeq="+p.seq+"]").remove();h=document.createElement("div");h.className="viewFolderTreeItems";h.setAttribute("parentSeq",p.folderSeq);h.setAttribute("folderSeq",p.seq);h.setAttribute("folderDepth",
b);h.style.backgroundColor="#FFFFFF";h.style.height="auto";!0===d&&(h.style.display="none");h.onclick=function(a){"undefined"!=typeof e&&e(this);TBCancelBubbleEvent(a)};l="\u3000";l=0<k?"<img src='./image/cloud/ico_cloud_arrow_right.png' width='14' height='14' />":"<img src='./image/blank.gif' width='14' height='14' />";h.innerHTML="<div style='width:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding:4px;position:relative;top:2px;'><span>"+q+"</span><span>"+l+"</span><span><img src='./image/cloud/ico_cloud_folder.png' align='top' /> "+
p.subject+"</span></div>";h.childNodes[0].getElementsByTagName("span")[1].style.cursor="pointer";0<k&&(function(){var a=p.seq;dzeJ(".viewFolderTreeItems[folderseq="+a+"]");h.childNodes[0].getElementsByTagName("span")[1].onclick=function(c){folderArrowClickEvent(this,b,a,e);TBCancelBubbleEvent(c)};h.childNodes[0].ondblclick=function(b){var c=this.parentNode;c.getAttribute("folderseq")===a&&c.childNodes[0].getElementsByTagName("span")[1].click();TBCancelBubbleEvent(b)}}(),h.setAttribute("open",0));
n++;g.push(h);if(n===c.length)for(g=g.sort(function(a,b){a=a.innerText;b=b.innerText;return a<b?-1:a>b?1:0}),f=0;f<n;f++)a.appendChild(g[f]);if(!0===d){var r=h;p.seq===m?onefficeGW.viewSubFolderTree(b+1,m,r,d,e,function(a){0<a?(r.setAttribute("open",1),r.childNodes[0].getElementsByTagName("span")[1].innerHTML="<img src='./image/cloud/ico_cloud_arrow_bottom.png' />"):(r.setAttribute("open",0),r.childNodes[0].getElementsByTagName("span")[1].innerHTML="\u3000")}):(""!==oneffice_cloud_currFolderSeq&&
oneffice_cloud_currFolderSeq===p.seq||p.seq===oneffice.currFolderSeq)&&setTimeout(function(){onefficeGW.selectFolderSeq(r);var a=dzeJ(".viewFolderTreeItems.active");"0"===a[0].getAttribute("open")&&a.find("> div:eq(0)").dblclick();var b=document.getElementById("dze_idx_folder_tree"),c=dzeJ("#dze_idx_folder_tree > .viewFolderTreeItems").offset().top;a=a.offset().top;b.scrollTop=a-c},100)}});"function"===typeof f&&f(c.length)},null,null,!1)}catch(g){dalert(g)}},getSubFolderCnt:function(b,c){try{onefficeGW.getFileList(b.seq,
"folder",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,"",function(a){"function"===typeof c&&c({count:a.length,item:b})},null,null,!1)}catch(a){dalert(a)}},getDocumentShareOpenURL:function(b,c,a){try{var d="";d=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(b,c,a);var e=location.protocol;if(0<=location.origin.indexOf("//localhost")||0<=location.origin.indexOf("//vip.bizboxa.com")||0<=location.origin.indexOf("//bizboxa.duzonnext.com"))e="http:";return e+"//"+location.hostname+(location.port?":"+location.port:
"")+d}catch(f){dalert(f)}},getOnefficeURL:function(b){try{var c=dzeEnvConfig.strPath_Dir;c=!0===b?c+oneffice.onefficePath:c+oneffice.drivePath;var a=location.protocol;if(0<=location.origin.indexOf("//localhost")||0<=location.origin.indexOf("//vip.bizboxa.com")||0<=location.origin.indexOf("//bizboxa.duzonnext.com"))a="http:";return a+"//"+location.hostname+(location.port?":"+location.port:"")+c}catch(d){dalert(d)}},selectFolderSeq:function(b){try{var c=b.getAttribute("folderSeq");dlog("selected folderSeq:"+
c);var a=document.getElementById("dze_idx_folder_tree").getElementsByTagName("div"),d=document.getElementById("dze_idx_save_folder_seq_form");for(b=0;b<a.length;b++)null!=a[b].getAttribute("folderSeq")&&(a[b].style.display="",c==a[b].getAttribute("folderSeq")?(a[b].classList.add("active"),a[b].childNodes[0].style.backgroundColor="#CFF1FF"):(a[b].classList.remove("active"),a[b].childNodes[0].style.backgroundColor="#ffffff"));d.value=c}catch(e){dalert(e)}},setCurrFolderInfo:function(b){try{oneffice.currFolderSeq=
b}catch(c){dalert(c)}},setCurrFileInfo:function(b,c,a,d,e){try{oneffice.currFileSeq=b,oneffice.parentFileContent.seq=b,oneffice.currFolderSeq=c,oneffice.parentFileContent.folderSeq=c,oneffice.currFileSubject=a,oneffice.parentFileContent.subject=a,oneffice.currFileRegDate="object"==typeof d?getFullDateFromTimeStamp(d.time):d,oneffice.parentFileContent.regdate=oneffice.currFileRegDate,oneffice.currFileModDate="undefined"!=typeof e?"object"==typeof e?getFullDateFromTimeStamp(e.time):e:duzon_http.getCurrTime(),
oneffice.parentFileContent.moddate=oneffice.currFileModDate,onefficeUtil.showDocSubject()}catch(f){dalert(f)}},getFolderPathInfo:function(b,c,a){try{""!=c?onefficeGW.getFolderContent(c,function(c){b.unshift([c.seq,c.subject]);""==c.folderSeq?(b.unshift(["",ID_RES_CONST_STRING_BROWSER_MY]),"function"===typeof a&&a(b)):onefficeGW.getFolderPathInfo(b,c.folderSeq,a)}):(b.push(["",ID_RES_CONST_STRING_BROWSER_MY]),"function"===typeof a&&a(b))}catch(d){dalert(d)}},executeBeforeUnload:function(b){try{if(oneffice.currFileSeq&&
(onefficeGW.setAccessDocument(oneffice.currFileSeq,g_readonlyMode?"R":"W","0",360,function(a){}),!0!==g_readonlyMode)){var c=getEditorHTMLCode(!1,b,!0,!0);if(onefficeUtil.checkSameContent(c))dlog("no modify data -> not saved!"),!0===oneffice.bMadeByCopy&&onefficeGW.exchangeContentsListInfo(!1,oneffice.strSavedDocNo);else{var a={type:1,seq:oneffice.currFileSeq,folderSeq:oneffice.currFolderSeq,subject:oneffice.currFileSubject,content:c,readonly:"",important:""};cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SAVING_DATA,
10,"center",!1);onefficeUtil.showDocSubject(ID_RES_CONST_STRING_SAVING_DATA);onefficeGW.saveFileContent(a,function(a){},null,!1);!0===oneffice.bMadeByCopy?onefficeGW.exchangeContentsListInfo(!1,oneffice.strSavedDocNo):onefficeGW.exchangeContentsListInfo(!1)}}}catch(d){dalert(d)}},checkEmptyGabageDocument:function(b){try{return""==oneffice.currFileSubject&&!0===oneffice.bNewFileStart&&b==oneffice.bNewFileStartSavedContent?!0:!1}catch(c){dalert(c)}},showDocumentProperties:function(b,c,a){try{!0===g_readonlyMode&&
onefficeGW.showDocumentReadonlyStatus("1",c);var d=document.getElementById("TB_MENU_UI_SWITCH_BTN_"+c);d&&(d.style.display="",d.nextSibling.style.display="");dze_menu_control.resizePropertyTableInfo(dze_menu_control.ui_mode,c);try{onefficeCommon.getMyInfo(function(d){"undefined"==typeof d?oneffice_cloud_myInfoData=null:(oneffice_cloud_myInfoData=d,onefficeGW.showUserInfo(c),onefficeGW.showDocumentFavorStatus(b.important,c),b.share_date?onefficeGW.showDocumentShareStatus("1",c):onefficeGW.showDocumentShareStatus("0",
c),dze_menu_control.resizePropertyTableInfo(dze_menu_control.ui_mode,c),dze_menu_control.updateTitle(),onefficeGW.showReportToolbar(c),onefficeUtil.checkLanguage(d.langCode));"function"===typeof a&&a()},!1)}catch(e){}}catch(e){dalert(e)}},showReportToolbar:function(b){try{dzeEnvConfig.bDebugging||"undefined"!=typeof oneffice_cloud_myInfoData.report_yn&&null!=oneffice_cloud_myInfoData.report_yn&&"Y"==oneffice_cloud_myInfoData.report_yn||(dze_menu_control.removeToolbar(ID_COMMAND_SEND_BIZBOX_REPORT,
b),dze_menu_control.removeToolbar(ID_COMMAND_GET_BIZBOX_REPORT_LIST,b))}catch(c){dalert(c)}},showUserInfo:function(b){try{if(!0===dzeUiConfig.bUsePropUserMenu&&oneffice_cloud_myInfoData){var c="";oneffice_cloud_myInfoData.name&&(c=oneffice_cloud_myInfoData.name,oneffice_cloud_myInfoData.duty_name&&(c+=" "+oneffice_cloud_myInfoData.duty_name));var a=document.getElementById("TB_MENU_USERINFO_BTN_IMG_"+b);a&&"undefined"!=typeof oneffice_cloud_myInfoData.pic&&""!=oneffice_cloud_myInfoData.pic&&(a.className=
"dze_property_user_pic",a.src=oneffice_cloud_myInfoData.pic,c&&(a.title=c));if(c){var d=document.getElementById("TB_MENU_USERINFO_TEXT_BTN_"+b);d&&(d.childNodes[0].innerHTML=c,d.title=c,d.style.display="block")}}}catch(e){dalert(e)}},showDocumentFavorStatus:function(b,c){try{if(!0===dzeUiConfig.bUsePropFavorMenu){"undefined"==typeof b&&(b="1");oneffice_cloud_myInfoData&&oneffice_cloud_myInfoData.id==oneffice.currFileOwnerId||(b="0");var a=document.getElementById("TB_MENU_FAVOR_BTN_IMG_"+c);null!=
a&&("1"==b?(a.src=dzeEnvConfig.strPath_Image+"ribbon/btn_favorite_click.png",a.title=ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_SET,a.parentNode.setAttribute("favor","1")):(a.src=dzeEnvConfig.strPath_Image+"ribbon/btn_favorite_normal.png",a.title=ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_NOT_SET,a.parentNode.setAttribute("favor","0")))}}catch(d){dalert(d)}},setDocumentFavorStatus:function(b,c){try{if(oneffice.bBackupLoadedContent)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT,
2,"center");else if(oneffice_cloud_myInfoData&&oneffice_cloud_myInfoData.id==oneffice.currFileOwnerId){var a="1";"1"==b.getAttribute("favor")&&(a="0");onefficeGW.saveFileContent({seq:oneffice.currFileSeq,important:a,type:"",folderSeq:oneffice.currFolderSeq,subject:"",content:"",content_size:"",owner_id:"",keyword:"",readonly:"",regdate:"",moddate:"",accessdate:"",deleted:""},function(b){b==oneffice.currFileSeq&&("1"==a?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_SET_UP,2,
"center"):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_NOT_SET_UP,2,"center"),onefficeGW.showDocumentFavorStatus(a,c))})}else cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_IMPORTANT_DOCUMENT_CAN_SET_BY_OWNER,2,"center")}catch(d){dalert(d)}},showDocumentReadonlyStatus:function(b,c){try{if(!0===dzeUiConfig.bUsePropReadonlyMenu){"undefined"==typeof b&&(b="0");var a=document.getElementById("TB_MENU_READONLY_BTN_"+c);document.getElementById("TB_MENU_READONLY_BTN_IMG_"+c);
"1"==b&&(a.style.display="",a.nextSibling.style.display="")}}catch(d){dalert(d)}},showDocumentSecurity:function(b,c){try{if(!0===dzeUiConfig.bUsePropSecurityMenu){if("1"==b){var a=document.getElementById("TB_MENU_SECURITY_BTN_"+c);a.style.display=""}else a=document.getElementById("TB_MENU_SECURITY_BTN_"+c),a.style.display="none";a.nextSibling.style.display=""}}catch(d){dalert(d)}},showDocumentShareStatus:function(b,c){try{if(!0===dzeUiConfig.bUsePropShareMenu)if("undefined"==typeof b&&(b="0"),"1"==
b&&oneffice_cloud_myInfoData){var a=document.getElementById("TB_MENU_SHARE_BTN_"+c);a&&(a.style.display="",a.style.cursor="pointer",a.nextSibling.style.display="");var d=document.getElementById("TB_MENU_SHARE_BTN_IMG_"+c);null!=d&&(oneffice_cloud_myInfoData&&oneffice_cloud_myInfoData.id==oneffice.currFileOwnerId?(d.src=dzeEnvConfig.strPath_Image+"ribbon/btn_share_out.png",d.title=ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST):(d.src=dzeEnvConfig.strPath_Image+"ribbon/btn_share_in.png",d.title=ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST),
a&&(a.onclick=function(a){this.getAttribute("emptyShareInfo")||showDialogDocumentShareInfo(a,oneffice.currFileSeq)}))}else if(a=document.getElementById("TB_MENU_SHARE_BTN_"+c))a.style.display="none",a.nextSibling.style.display="none"}catch(e){dalert(e)}},viewLoginForm:function(){try{cmnDlg.viewBasicDlg(null,0,"Login",onefficeGW.getLoginFormContainer(),[ID_RES_DIALOG_BTN_OK],[function(b){onefficeGW.executeLogin()}],function(){document.getElementById("oneffice_idx_login_id").focus();document.getElementById("oneffice_idx_login_id").onkeydown=
function(b){b.keyCode==ID_KEYCODE_ENTER&&onefficeGW.executeLogin()}},function(){},!0)}catch(b){dalert(b)}},getLoginFormContainer:function(){return"<div class='duzon_dialog_content_small' id='oneffice_idx_loginform'><p>ID: <input type='input' name='login_id' id='oneffice_idx_login_id' value='' size='30' /></p></div>"},executeLogin:function(b,c){try{b=document.getElementById("oneffice_idx_login_id"),""==b.value?(cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ENTENR_ID,2,"screen_center"),b.focus()):
duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_LOGIN,async:!0,data:{user_id:b.value},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){"success"!==a.result?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_LOGIN_FAIL_ENTER_CORRETLY,2,"screen_center"):(duzon_dialog.closeDialog(),document.location.reload())},error:function(a){dalert(a)}})}catch(a){dalert(a)}},setShareDocumentOnEditor:function(b,c){try{0<oneffice_cloud_checkedItemList.length&&
(oneffice_cloud_checkedItemList=[]),oneffice_cloud_checkedItemList.push(oneffice.parentFileContent),setShareDocument(b,c)}catch(a){dalert(a)}},viewOpenDocumentPeopleList:function(b){try{if("none"==document.getElementById("dze_idx_right_pannel_td_"+b).style.display)dzeLayoutControl.setRightPannelToobarInitialize(b);else{document.getElementById("dze_idx_right_pannel_top_title_string_"+b).innerHTML="\ubb38\uc11c \uc5f4\ub78c \uc815\ubcf4";var c=document.getElementById("dze_idx_div_right_pannel_body_"+
b);c.innerHTML="";var a=document.createElement("div");a.style.height="40px";c.appendChild(a);var d=document.createElement("img");a.appendChild(d);d.outerHTML='<img width="22px" height="22px" src="./image/cloud/btn_refresh.png" style="position:relative; top:9px;" onclick="onefficeGW.loadOpenDocumentPeopleList(\''+b+"')\"/>";onefficeGW.loadOpenDocumentPeopleList(b)}}catch(e){dalert(e)}},loadOpenDocumentPeopleList:function(b){try{for(var c=document.getElementsByClassName("pannel_content_main_title"),
a=0;a<c.length;)c[a].parentNode.removeChild(c[a]);var d=document.getElementsByClassName("pannel_content_normal_title");for(a=0;a<d.length;)d[a].parentNode.removeChild(d[a]);onefficeCommon.getDocumentAccessInfo(oneffice.currFileSeq,function(a){if(0!=a.length){var c=document.getElementById("dze_idx_div_right_pannel_body_"+b),d=document.createElement("div");d.className="pannel_content_main_title";d.innerHTML="\ud3b8\uc9d1\uc911";c.appendChild(d);for(var e=d=0;e<a.length;e++)if("W"==a[e].access_perm&&
"1"==a[e].access_status){var h=document.createElement("div");h.className="pannel_content_normal_title";h.id="dze_idx_pannel_content_string_write_body_"+b+"_"+e;h.innerHTML="\u2022 "+a[e].name;c.appendChild(h);d++}0==d&&(h=document.createElement("div"),h.className="pannel_content_normal_title",h.id="dze_idx_pannel_content_string_write_body_"+b+"_0",h.innerHTML=ID_RES_DIALOG_STRING_NONE,c.appendChild(h));d=document.createElement("div");d.className="pannel_content_main_title";d.style.marginTop="10px";
d.innerHTML="\uc5f4\ub78c\uc911";c.appendChild(d);for(e=d=0;e<a.length;e++)0==("W"==a[e].access_perm&&"1"==a[e].access_status)&&(h=document.createElement("div"),h.className="pannel_content_normal_title",h.id="dze_idx_pannel_content_string_read_body_"+b+"_"+e,h.innerHTML="\u2022 "+a[e].name,c.appendChild(h),d++);0==d&&(h=document.createElement("div"),h.className="pannel_content_normal_title",h.id="dze_idx_pannel_content_string_read_body_"+b+"_0",h.innerHTML=ID_RES_DIALOG_STRING_NONE,c.appendChild(h))}})}catch(e){dalert(e)}},
getDayContentWithRegDay:function(b){try{for(var c=document.getElementsByClassName("pannel_content_day_container"),a=0;a<c.length;a++)if(c[a].getAttribute("regDay")==b)return c[a];var d=document.getElementsByClassName("pannel_content_day_container_open");for(a=0;a<d.length;a++)if(d[a].getAttribute("regDay")==b)return d[a];return null}catch(e){dalert(e)}},checkDuplicateHistory:function(b,c,a,d){try{var e=document.getElementsByClassName("pannel_content_string_body");b=b+"|"+c+"|"+a;for(c=0;c<e.length;c++)if(e[c].getAttribute("historyCode")==
b){if(CLOUD_CONST_HISTORY_ACTIONCODE_SHARE==a){var f=d.share_type+"|"+d.share_perm;if(e[c].getAttribute("shareCode")!=f)continue}var g=d&&d.share_perm?d.share_perm:null,k=parseInt(e[c].getAttribute("duplicateCount"))+1;e[c].childNodes[0].innerHTML="\u2022 "+ID_RES_CONST_STRING_DOCUMENT_HISTORY_ACTION_TYPE+" : "+onefficeGW.getActionStringByCode(a,g)+" ("+k+ID_RES_CONST_STRING_COUNT+")";e[c].setAttribute("duplicateCount",k);return!0}return!1}catch(h){dalert(h)}},setAccessManager:function(b,c,a){try{duzon_http.ajax({type:"post",
url:ONEFFICE_SERVER_API_POST_ACCESS_MANAGER_SETTING,async:!0,data:{doc_no:b,editor_id:c,mode:"insert"},dataType:"json",timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_ACCESS_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof a&&a(b.data)},error:function(a){dalert(a)}})}catch(d){dalert(d)}onefficeCommon.accessUserFunction("accessManager")},
searchAMResponseAnswer:function(b,c,a){try{duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_SEARCH_AM_RESPONSE_ANSWER,async:!0,data:{doc_no:b,request_id:c},dataType:"json",timeout:2E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_ACCESS_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof a&&a(b.data)},error:function(a){dalert(a)}})}catch(d){dalert(d)}},
searchRequestManager:function(b,c,a){try{duzon_http.ajax({type:"get",url:ONEFFICE_SERVER_API_GET_SEARCH_AM_REQUEST_USERID,async:!0,data:{doc_no:b,editor_id:c},dataType:"json",timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"GET_ACCESS_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof a&&a(b.data)},error:function(a){dalert(a)}})}catch(d){dalert(d)}},
delAccessManager:function(b,c,a){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_ACCESS_MANAGER_SETTING,async:!0,data:{doc_no:b,editor_id:c,mode:"delete"},dataType:"json",timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_ACCESS_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof a&&a(b.data)},error:function(a){dalert(a)}})}catch(d){dalert(d)}},
cancelAccessManagerRequestID:function(b,c,a){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_UPDATE_AM_REQUEST_ID,async:!0,data:{doc_no:b,editor_id:c,request_id:a,mode:"cancel"},dataType:"json",timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_ACCESS_DOCUMENT_FAIL",2,"screen_center")})},error:function(a){dalert(a)}})}catch(d){dalert(d)}},
updateAccessManagerRequestID:function(b,c,a,d){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_UPDATE_AM_REQUEST_ID,async:!0,data:{doc_no:b,editor_id:c,request_id:a,mode:"update"},dataType:"json",timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_ACCESS_DOCUMENT_FAIL",2,"screen_center")});else"function"===typeof d&&d(a.data)},
error:function(a){dalert(a)}})}catch(e){dalert(e)}},updateReqAnswerAccessManager:function(b,c,a,d,e){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_UPDATE_AM_UPDATE_ANSWER,async:!0,data:{doc_no:b,editor_id:c,request_id:a,response_answer:d},dataType:"json",timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],bShowLoading:!1,success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"POST_ACCESS_DOCUMENT_FAIL",
2,"screen_center")});else"function"===typeof e&&e(a.data)},error:function(a){dalert(a)}})}catch(f){dalert(f)}},getFolderInfo:function(b){try{var c;onefficeGW.getFolderContent(b,function(a){c=a},!1);return c}catch(a){dalert()}},getFolderPath:function(b){try{for(var c=[],a;;){a=this.getFolderInfo(b);if(!a)break;c.unshift([a.seq,a.subject]);if(""===a.folderSeq){c.unshift(["",ID_RES_CONST_STRING_BROWSER_MY]);break}else b=a.folderSeq}return c}catch(d){dalert()}},getDocumentHistoryInfo:function(b){try{var c=
null;if(!0===fnObjectCheckNull(b)||0===b.length)b=oneffice.currFileSeq;onefficeGW.getDocumentHistory(b,function(a){c=a},!1);return c}catch(a){dalert(a)}},getDocumentAccessInfo:function(){try{var b=null;onefficeCommon.getDocumentAccessInfo(oneffice.currFileSeq,function(c){b=c},!1);return b}catch(c){dalert(c)}},getDocumentShareInfo:function(b){try{var c=null;if(!0===fnObjectCheckNull(b)||0===b.length)b=oneffice.currFileSeq;onefficeGW.getShareInfo(b,function(a){c=a},!1);return c}catch(a){dalert(a)}},
getUserInfoID:function(b){try{var c=null;onefficeCommon.getSearchUserInfoList(CLOUD_CONST_SEARCH_USER_INFO_OPTION_USER_SEQ,b,function(a){c=a},!1);return c}catch(a){dalert(a)}},getUserInfo:function(b){try{var c=null;onefficeCommon.getSearchUserInfoList(CLOUD_CONST_SEARCH_USER_INFO_OPTION_ALL,b,function(a){c=a},!1);return c}catch(a){dalert(a)}},getDocumentList:function(b,c){try{var a;onefficeGW.getFileList(b,"",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,"",function(b){a=b},"","",!1,c);return a}catch(d){dalert()}},
getDeivceStringByCode:function(b){try{var c="";switch(b){case CLOUD_CONST_DEVICE_CODE_PC:c="PC";break;case CLOUD_CONST_DEVICE_CODE_IPHONE:c="iPhone";break;case CLOUD_CONST_DEVICE_CODE_IPAD:c="iPad";break;case CLOUD_CONST_DEVICE_CODE_ANDROID_PHONE:c="Android Phone";break;case CLOUD_CONST_DEVICE_CODE_ANDROID_PAD:c="Android Tablet";break;case CLOUD_CONST_DEVICE_CODE_ETC:c="ETC"}return c}catch(a){dalert(a)}},getActionStringByCode:function(b,c){try{var a="";switch(b){case CLOUD_CONST_HISTORY_ACTIONCODE_NEWDOC:a=
ID_RES_CONST_STRING_FILE_NEW;break;case CLOUD_CONST_HISTORY_ACTIONCODE_OPEN:a=ID_RES_CONST_STRING_VIEWING;break;case CLOUD_CONST_HISTORY_ACTIONCODE_MODIFY:a=ID_RES_TOOL_STRING_MENU_EDIT;break;case CLOUD_CONST_HISTORY_ACTIONCODE_RENAME:a=ID_RES_CONST_STRING_RENAME;break;case CLOUD_CONST_HISTORY_ACTIONCODE_SHARE:a=ID_RES_CONST_STRING_SHARE_DOCUMENT;0==fnObjectCheckNull(c)&&(a="W"==c?a+(" ["+ID_RES_TOOL_STRING_MENU_EDIT+"]"):a+(" ["+ID_RES_CONST_STRING_VIEWING+"]"));break;case CLOUD_CONST_HISTORY_ACTIONCODE_UNSHARE:a=
ID_RES_CONST_STRING_UNSHARE_DOCUMENT;break;case CLOUD_CONST_HISTORY_ACTIONCODE_READONLY_ON:a=ID_RES_CONST_STRING_SET_READONLY_ON;break;case CLOUD_CONST_HISTORY_ACTIONCODE_READONLY_OFF:a=ID_RES_CONST_STRING_SET_READONLY_OFF;break;case CLOUD_CONST_HISTORY_ACTIONCODE_SECURITY_ON:a=ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING;break;case CLOUD_CONST_HISTORY_ACTIONCODE_SECURITY_CHANGE:a=ID_RES_CONST_STRING_DOCUMENT_SECURITY+" "+ID_RES_DIALOG_BTN_MODIFY;break;case CLOUD_CONST_HISTORY_ACTIONCODE_SECURITY_OFF:a=
ID_RES_CONST_STRING_DOCUMENT_SECURITY+" "+ID_RES_CONST_STRING_CLEAR;break;case CLOUD_CONST_HISTORY_ACTIONCODE_DELETE:a=ID_RES_CONST_BTN_DELETE;break;case CLOUD_CONST_HISTORY_ACTIONCODE_RESTORE:a=ID_RES_CONST_STRING_RESTORE;break;case CLOUD_CONST_HISTORY_ACTIONCODE_REMOVE:a=ID_RES_CONST_STRING_DELETE_COMPLETE;break;case CLOUD_CONST_HISTORY_ACTIONCODE_MAKE_COPY:a=ID_RES_CONST_STRING_SAVEAS_REMOTE;break;case CLOUD_CONST_HISTORY_ACTIONCODE_CHG_OWN:a=ID_RES_STRING_CHG_OWN}return a}catch(d){dalert(d)}},
viewMapDialog:function(b,c,a){try{duzon_dialog.viewDialog(a,c,"\uc5f4\ub78c \uc7a5\uc18c",duzon_dialog.getMapDialog(),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){dynamicExtScriptCall("https://openapi.map.naver.com/openapi/v3/maps.js?clientId=PSvhrJqmFwqEU441S77u",function(){var a=new naver.maps.Map("dze_idx_map_dialog",{center:new naver.maps.LatLng(b[0],b[1]),zoom:12});new naver.maps.Marker({position:new naver.maps.LatLng(b[0],b[1]),map:a})})},function(){},!0,
"screen_center")}catch(d){dalert(d)}},getTextContent:function(b){try{var c=document.createElement("div");c.innerHTML=b;return c.textContent}catch(a){return dalert(a),""}},createChangeOwnerReq:function(b,c,a,d){try{if(!b||!c||0===c.length)return!1;duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_CREATE_CHANGE_OWNER_REQ,async:!0,data:{new_owner_id:b,doc_no_list:c},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(b){if("success"===b.result&&
b.data&&b.data.req_id)"function"===typeof a&&a(b.data);else oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"CHG_OWN_FAIL0",2,"screen_center")})},error:function(a){"function"===typeof d&&d(a)}})}catch(e){dalert(e)}},changeOwner:function(b,c,a,d,e){try{if(!b||"undefined"===typeof c||"undefined"===typeof a)return!1;b={req_id:b,type:c,folder_no:a};c=oneffice_cloud_myInfoData;b.action_code=CLOUD_CONST_HISTORY_ACTIONCODE_CHG_OWN;b.action_user=c.id;b.action_user_name=c.duty_name?
c.name+" "+c.duty_name:c.name;b.device_info=onefficeCommon.getDeviceInfo().device_type;duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_CHANGE_OWNER,async:!0,data:b,dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if(a&&"success"===a.result&&a.data)"function"===typeof d&&d(a.data);else oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"CHG_OWN_FAIL1",2,"screen_center")})},error:function(a){"function"===typeof e&&
e(a)}})}catch(f){dalert(f)}},getChangeOwner:function(b,c){try{duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_GET_CHANGE_OWNER,async:!0,data:"",dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",bShowLoading:!1,loading_image_size:[],success:function(a){if(a&&"success"===a.result&&a.data)"function"===typeof b&&b(a.data);else oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"CHG_OWN_FAIL2",2,"screen_center")})},error:function(a){"function"===typeof c&&c(a)}})}catch(a){dalert(a)}},
cancelChangeOwner:function(b,c,a){try{if(!b)return!1;duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_CANCEL_CHANGE_OWNER,async:!0,data:{doc_no_list:b},dataType:"json",timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if(a&&"success"===a.result&&a.data)"function"===typeof c&&c(a.data);else oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"CHG_OWN_FAIL3",2,"screen_center")})},error:function(b){"function"===typeof a&&a(b)}})}catch(d){dalert(d)}},
getCommentCounts:function(b,c){try{duzon_http.ajax({type:"post",url:"/gw/api/SearchCommentCount.do",async:!0,data:JSON.stringify({header:{},body:{companyInfo:{compSeq:b.comp_id,deptSeq:b.org_id,empSeq:b.id,bizSeq:b.biz_seq,groupSeq:b.group_seq,emailAddr:b.mail_id,emailDomain:b.mail_domain,langCode:""},moduleGbnCode:"oneffice",moduleSeq:oneffice.currFileSeq,commentType:""}}),dataType:"json",timeout:5E3,loading_screen:!1,loading_image_url:"",loading_image_size:[],success:function(a){"success"===a.resultMessage.toLowerCase()&&
"function"===typeof c&&c(1*a.result.count)},error:function(a){dalert(a)}})}catch(a){dalert(a)}},getCommentUrl:function(b,c,a){try{!0===fnObjectCheckNull(c)&&(c=!0),duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_GET_COMMENT_ENCRYPTED_URL,async:c,data:"aesEncode="+b,dataType:"json",timeout:!0===c?3E4:5E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(b){if("success"!==b.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,"ONEFFICE_SERVER_API_GET_COMMENT_ENCRYPTED_URL_FAIL",
2,"screen_center")});else"function"===typeof a&&a(b.encode)},error:function(a){}})}catch(d){dalert(d)}},deleteRecentList:function(b,c,a,d){try{!0===fnObjectCheckNull(a)&&(a=!0),duzon_http.ajax({type:"post",url:ONEFFICE_SERVER_API_POST_DELETE_RECENT_LIST,async:a,data:{doc_no:b,owner_id:c},dataType:"json",timeout:!0===a?3E4:5E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){if("success"!==a.result)oneffice.onErrorCheckSession(function(){cmnCtrlToast.showToastMsg(null,
ID_RES_STRING_RECENT_DELETE_FAIL,2,"screen_center")});else"function"===typeof d&&d(a.encode)},error:function(a){}})}catch(e){dalert(e)}}};function makeOnefficeDocumentFromDocNo(b,c,a,d,e,f){try{onefficeCommon.getFileContent(b,function(a){a=getOnefficeDocumentFromContent(a.content,f);"function"===typeof c&&c(a)},function(){a()},d,e)}catch(g){callback(null),dalert(g)}}
function makeDailyReportOnefficeFormHtml(b){try{dynamicScriptCall("js/const/file_docform_const.js",function(){var c=docformTemplateCategory[0].data[0];c='<dze_doc_property class="dze_document_property" printmargin="'+(c.paperMargin.join(",")+",10,12.5")+'" papersize="210,297" pagecolor="#FFFFFF" watermarksrc="" dze_onepage_mode="true" pgcontentsoverflowvisible="false" dze_hf_height="20,0,0,20,0,0"></dze_doc_property>'+c.html;c=getOnefficeDocumentFromContent(c);"function"===typeof b&&b(c)})}catch(c){b(""),
dalert("makeDailyReportOnefficeFormHtml")}};
