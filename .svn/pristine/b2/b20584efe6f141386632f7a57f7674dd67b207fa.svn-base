function fnGetEditorPreviewHTML(){return getEditorPreviewHTML(g_nActiveEditNumber)}function fnAddHTMLCode(a){return addHTMLCode(a,g_nActiveEditNumber)}function fnGetEditorHTMLCode(a,b){return getEditorHTMLCode(a,b)}function fnSetEditorHTMLCode(a,b,c){return setEditorHTMLCode(a,b,c)}function fnInsertHTMLContent(a,b){insertHTMLContent(a,b)}function fnGetEditorText(a){return getEditorText(a)}function fnGetEditorSelectionText(a){return getEditorSelectionText(a)}
function fnAddHTMLContent(a,b,c,d,e){addHTMLContent(a,b,c,d,e);!0===e&&(g_objUndoRedo.registerUndoRedoStack(0,d),g_objPageControl.onSetDelayedUpdatePageTimer());return!0}function fnReplaceHTMLContent(a,b){return replaceHTMLContent(a,b)}function fnGetEditorDocument(a){try{return g_objEditorDocument[a]}catch(b){}return null}function fnGetEditorWindow(a){try{return g_objEditWindow[a]}catch(b){}return null}function fnFindCountEditorText(a,b){try{return findCountEditorText(a,b)}catch(c){}return 0}
function fnFindEditorText(a,b){try{return findEditorText(a,b)}catch(c){}return-1}function fnFindEditorTextDetail(a,b,c,d,e,f){try{return findEditorTextDetail(a,b,c,d,e,f)}catch(g){}return-1}function fnReplaceEditorText(a,b,c){try{return replaceEditorText(a,b,c)}catch(d){}return-1}function fnReplaceEditorTextDetail(a,b,c,d,e,f,g){try{return replaceEditorTextDetail(a,b,c,d,e,f,g)}catch(h){}return-1}function fnReplaceAllEditorText(a,b,c){try{return replaceAllEditorText(a,b,c)}catch(d){}return-1}
function fnResizeEditor(a,b,c){try{resizeEditor(a,b,c)}catch(d){}}function fnGetEditorMode(a){try{return g_bEditMode[a]}catch(b){}}function fnIsActiveEditorMode(a){try{return g_bEditMode[a]?g_bActivate[a]:!1}catch(b){}return!1}function fnInitWebEditor(){try{initWebEditor()}catch(a){}}function fnGetImageList(a){try{return getImageList(a)}catch(b){}return null}function fnSetContentXHTMLFormat(a,b){try{return setContentXHTMLFormat(a,b)}catch(c){}}
function fnSetPreviewPageURL(a){try{dzeEnvConfig.strPreviewPageURL=a}catch(b){}}function fnGetEditorTagCount_script(a){try{return getEditorTagCount_script(a)}catch(b){}}function fnGetEditorTagCount_iframe(a){try{return getEditorTagCount_iframe(a)}catch(b){}}function fnShowEditor(a){try{var b=getnEditNumberFromEditId(a);duzon_menubar.rebuildHiddenToolbar();duzon_dialog.nEditNumber=b;duzon_dialog.setEditorSelection();duzon_dialog.setEditorFocus();editor_onselectionchange(b)}catch(c){}};
var g_arrEditorAreaContainer=[],g_arrEditorWidth=[],g_arrEditorHeight=[],g_objEditAreaContainer=[],g_objMainEditAreaContainer=[],g_nToolbarSetHeight=0,g_nTabBarSetHeight=0,g_nBottomResizeHeight=0,g_nEditAreaSetHeight=0,g_nEditDocumentHeight=0,g_objEditContainer=[],g_objEditSourceContainer=[],g_objEditObjectSource=[],g_bMarkWinAssigned=!1;
function initEditAreaContainer(b,a){b.innerHTML='<div id="INIT_LOAD_AREA_'+a+'" class="editor_set_container"></div><div id="INIT_INFO_AREA_'+a+'"></div>';b=document.getElementById("INIT_LOAD_AREA_"+a);g_objEditAreaContainer[a]=b;var c=buildEditAreaContainer(a);b.innerHTML=c;g_objMainEditAreaContainer[a]=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+a);g_objEditContainer[a]=document.getElementById(g_strEditContainerName+"_"+a);g_objEditSourceContainer[a]=document.getElementById(g_strEditSourceContainerName+
"_"+a);g_objEditObjectSource[a]=document.getElementById(g_strEditObjectSourceName+"_"+a)}
function buildEditAreaContainer(b){var a="",c=!0;if(g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||g_bToolBar3_Display)c=!1;g_nToolbarSetHeight=113;g_bMenuBar_Display||(g_nToolbarSetHeight-=24);g_bToolBar1_Display||(g_nToolbarSetHeight-=30);g_bToolBar2_Display||(g_nToolbarSetHeight-=30);g_bToolBar3_Display||(g_nToolbarSetHeight-=30);0>=g_nToolbarSetHeight&&(g_nToolbarSetHeight=1);g_nTabBarSetHeight=30;g_bTabBar_Display||(g_nTabBarSetHeight=0);g_nBottomResizeHeight=12;g_bBottomResizeYN||
(g_nBottomResizeHeight=0);if(g_bEditorHeightIFrameYN){var e=g_objPositionUtil.getDocumentClientSize(self).nClientHeight;if(g_bBrowserType_WK){if(0==e){var f=g_objPositionUtil.getDocumentElementObject(!1);f&&(e=f.scrollHeight)}0==e&&(f=window.frameElement)&&(e=f.clientHeight)}g_bBrowserType_WK||g_bBrowserType_FF?e+=1:window.attachEvent&&--e;g_arrEditorHeight[b]=e}g_nEditAreaSetHeight=g_arrEditorHeight[b]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight;window.attachEvent&&(g_nEditAreaSetHeight+=
3);a=g_bEditorWidthPercentageYN?a+('<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="EDIT_SET_CONTAINER_'+b+'" height="'+g_arrEditorHeight[b]+'">'):a+('<table style="width:'+g_arrEditorWidth[b]+'px;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="EDIT_SET_CONTAINER_'+b+'" height="'+g_arrEditorHeight[b]+'">');a=(c?a+'<tr valign="top" style="display:none">':a+'<tr valign="top">')+('<td height="'+g_nToolbarSetHeight+'" style="line-height:normal;border:0px;padding:0px;height:'+
g_nToolbarSetHeight+'px;">');a=c?a+('<table style="width:100%;" cellSpacing="0" cellPadding="0" id="TB_CONTAINER_'+b+'">'):a+('<table style="width:100%;" cellSpacing="0" cellPadding="0" id="TB_CONTAINER_'+b+'" class="duzon_controller_container">');g_bMenuBar_Display&&(a=a+"<tr>"+('<td id="TB_CONTAINER_MENU_'+b+'" class="duzon_menubar_line">')+'<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0">',a+='<tr valign="center">',calculateStringLength(ID_RES_TOOL_STRING_MENU_FILE),a+='<td class="'+
g_strSkin_Menu_Area+'" id="TB_MENU_FILE_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_FILE+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_EDIT),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_EDIT_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_EDIT+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_VIEW),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_VIEW_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_VIEW+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_INSERT),a+=
'<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_INSERT_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_INSERT+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_BASIC),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_BASIC_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_BASIC+"</td>",calculateStringLength(ID_RES_TOOL_STRING_MENU_TABLE),a+='<td class="'+g_strSkin_Menu_Area+'" id="TB_MENU_TABLE_'+b+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_MENU_TABLE+"</td>",a+="<td id=TB_MENU_EMPTY_AREA_"+b+
'><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>',a+="</tr>",a+="</table>",a+="</td>",a+="</tr>");g_bToolBar1_Display&&(e="",g_bMenuBar_Display||(e='style="border-width:0;"'),a+="<tr>",a+='<td id="TB_CONTAINER_TOOL_1_'+b+'" class="'+g_strSkin_ToolBarLine+'" '+e+' style="border-width:0">',a+='<table cellSpacing="0" border="0" cellPadding="0" height="28" width="100%">',a+='<tr valign="center" height="28">',a+=buildEditAreaContainer_ToolbarOneLine(b,
g_arrToolbar1),a+="<td></td>",a+="<td>",a=a+('<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_1_HIDDEN_'+b+'" toolbarNo="1">')+('<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_1_HIDDEN_TBL_'+b+'"><tr>')+buildEditAreaContainer_Space(8),a+=buildEditAreaContainer_Space(8),a+="</tr></table>",a+="</div>",a+="</td>",a+='<td align="right" style="vertical-align:middle">',a=a+('<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_1_HIDDEN_'+
b+'" onclick="duzon_menubar.viewHiddenTbContainerTool(1,'+b+')"></div>')+"</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>");g_bToolBar2_Display&&(e="",g_bMenuBar_Display||g_bToolBar1_Display||(e='style="border-width:0;"'),a+='<tr style="height:24px;">',a+='<td id="TB_CONTAINER_TOOL_2_'+b+'" class="'+g_strSkin_ToolBarLine+'" '+e+">",a+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0">',a+='<tr height="24" valign="center">',a+=buildEditAreaContainer_ToolbarOneLine(b,
g_arrToolbar2),a+="<td></td>",a+="<td>",a=a+('<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_2_HIDDEN_'+b+'" toolbarNo="2">')+('<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_2_HIDDEN_TBL_'+b+'"><tr>')+buildEditAreaContainer_Space(8),a+=buildEditAreaContainer_Space(8),a+="</tr></table>",a+="</div>",a+="</td>",a+='<td align="right" style="vertical-align:middle">',a=a+('<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_2_HIDDEN_'+
b+'" onclick="duzon_menubar.viewHiddenTbContainerTool(2,'+b+')"></div>')+"</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>");g_bToolBar3_Display&&(e="",g_bMenuBar_Display||g_bToolBar1_Display||g_bToolBar2_Display||(e='style="border-width:0;"'),a+='<tr style="height:24px;">',a+='<td id="TB_CONTAINER_TOOL_3_'+b+'" class="'+g_strSkin_ToolBarLine+'" '+e+">",a+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0">',a+='<tr height="24" valign="center">',a+=buildEditAreaContainer_ToolbarOneLine(b,
g_arrToolbar3),a+="<td></td>",a+="<td>",a=a+('<div class="duzon_hidden_toolbar_container" style="display:none" id="TB_CONTAINER_TOOL_3_HIDDEN_'+b+'" toolbarNo="3">')+('<table cellpadding="0" cellspacing="0" id="TB_CONTAINER_TOOL_3_HIDDEN_TBL_'+b+'"><tr>')+buildEditAreaContainer_Space(8),a+=buildEditAreaContainer_Space(8),a+="</tr></table>",a+="</div>",a+="</td>",a+='<td align="right" style="vertical-align:middle">',a=a+('<div class="duzon_btn_view_hidden_toolbar" style="display:none" id="TB_CONTAINER_BTN_TOOL_3_HIDDEN_'+
b+'" onclick="duzon_menubar.viewHiddenTbContainerTool(3,'+b+')"></div>')+"</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>");a+="</table>";a+="</td>";a+="</tr>";a+='<tr valign="top">';!0===dzeUiConfig.bOfficeMode?(a+='<td id="MAIN_EDIT_AREA_CONTAINER_'+b+'" height="'+g_nEditAreaSetHeight+'" style="line-height:normal;border:0px;padding:0px;height:'+g_nEditAreaSetHeight+'px;background-color:#f2f2f2;">',a+='<div id="MAIN_EDIT_AREA_CONTAINER_BOX_'+b+'" style="margin:0;padding:0;line-height:0;">'):
(a+='<td id="MAIN_EDIT_AREA_CONTAINER_'+b+'" height="'+g_nEditAreaSetHeight+'" style="line-height:normal;border:0px;padding:0px;height:'+g_nEditAreaSetHeight+'px;background-color:#FFFFFF;">',a+='<div id="MAIN_EDIT_AREA_CONTAINER_BOX_'+b+'" style="margin:0;padding:0;line-height:0">');a+='<table id="'+g_strEditContainerName+"_"+b+'" style="width:100%;border:0px;" class="editorContainer" cellSpacing="0" cellPadding="0">';a+="<tr>";c?g_bBrowserType_IE&&""!=g_strDomainPageName?(a+='<td id="'+g_strEditObjectName+
"_Parent_"+b+'" class="editor_frame_nothing" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;border:1px solid #c4cad1;">',a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame_nothing" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;border:1px solid #c4cad1;">',
a+='<iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe>'):g_bBrowserType_IE&&""!=g_strDomainPageName?g_bEditorHeightReSettingYN?(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:'+(g_nEditAreaSetHeight-1)+'px;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<div class="div_style_document_box_container" id="DZE_IDX_EDITOR_EDITOR_FRAME_'+b+'"><iframe id="'+
g_strEditObjectName+"_"+b+'" frameBorder="0" style="height:'+(g_nEditAreaSetHeight-2)+'px;" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe></div>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<div class="div_style_document_box_container" id="DZE_IDX_EDITOR_EDITOR_FRAME_'+b+'"><iframe id="'+g_strEditObjectName+
"_"+b+'" frameBorder="0" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'" src="'+dzeEnvConfig.strPath_Dir+g_strDomainPageName+'"></iframe></div>'):g_bEditorHeightReSettingYN?(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:'+(g_nEditAreaSetHeight-1)+'px;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<div class="div_style_document_box_container" id="DZE_IDX_EDITOR_EDITOR_FRAME_'+b+'"><iframe id="'+g_strEditObjectName+
"_"+b+'" frameBorder="0" style="height:'+(g_nEditAreaSetHeight-2)+'px;" class="editorContainer" title="'+ID_RES_EDIT_TITLE_STRING+'"></iframe></div>'):(a+='<td id="'+g_strEditObjectName+"_Parent_"+b+'" class="editor_frame" style="height:100%;line-height:0;padding-left:0;padding-top:0;padding-right:0;padding-bottom:0;">',a+='<div class="div_style_document_box_container" id="DZE_IDX_EDITOR_EDITOR_FRAME_'+b+'"><iframe id="'+g_strEditObjectName+"_"+b+'" frameBorder="0" class="editorContainer" title="'+
ID_RES_EDIT_TITLE_STRING+'"></iframe></div>');a+="</td>";a=a+('<td class="dze_style_right_pannel_td" id="dze_idx_right_pannel_td_'+b+'" style="display:none"><div class="dze_style_right_pannel" id="dze_idx_right_pannel_'+b+'"></div></td>')+"</tr>";a+="</table>";a+='<table id="'+g_strEditSourceContainerName+"_"+b+'" style="width:100%;border:0px;display:none;" class="editorContainer" cellSpacing="0" cellPadding="0">';a+="<tr>";c?(g_bBrowserType_WK||(a+='<td class="editor_source_frame_padding_nothing" style="line-height:normal;padding:0px;"><img src="'+
g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'),a+='<td class="editor_source_frame_main_nothing" style="line-height:normal;padding:0px;"><label for="'+g_strEditObjectSourceName+"_"+b+'"></label><textarea id="'+g_strEditObjectSourceName+"_"+b+'" class="editor_source_frame" title="source" style="line-height:1.4;"></textarea></td>'):a+='<td class="editor_source_frame_main" id="dze_editor_source_frame_main_'+b+'" style="line-height:normal;padding:0px;"><label for="'+
g_strEditObjectSourceName+"_"+b+'"></label><textarea id="'+g_strEditObjectSourceName+"_"+b+'" class="editor_source_frame" title="source" style="line-height:1.4;"></textarea></td>';a+="</tr>";a+="</table>";a+="</div>";a+="</td>";a+="</tr>";if(g_bTabBar_Display)a=a+('<tr valign="top" id="TB_TABMODE_TR_CONTAINER_'+b+'">')+'<td style="width:100%;line-height:normal;height:20px;border:0px;padding:0px;">',a=a+('<table style="width:100%;border-top:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" id="TB_TABMODE_CONTAINER_'+
b+'" class="tbToolbarSetTabMode">')+"<tr>",a=a+('<td id="TB_CONTAINER_TABMODE_'+b+'" style="width:100%;line-height:normal;height:20px;border:0px;padding:0px;text-align:right;vertical-align:top;">')+'<table align="left" width="100%" cellSpacing="0" cellPadding="0">',a+="<tr>",g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&(a+='<td style="width:90px;height:24px;">',a+='<div id="TB_TABMODE_EDIT_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_EDIT+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_EDIT+"</div>",a+="</td>"),g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&
(a+='<td style="width:90px;height:24px;">',a+='<div id="TB_TABMODE_SOURCE_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_SOURCE+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_SOURCE+"</div>",a+="</td>"),g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]&&(a+='<td style="width:90px;height:24px;">',a+='<div id="TB_TABMODE_PREVIEW_'+b+'" title="'+ID_RES_TOOL_STRING_TAB_PREVIEW+'" TBTYPE="toggle">'+ID_RES_TOOL_STRING_TAB_PREVIEW+"</div>",a+="</td>"),a+='<td style="height:24px;">',a+='<div class="duzon_btn_tabmod_area_blank"></div>',
a+="</td>",dzeUiConfig.bCustomBottomResizeBtnYN&&(a+='<td style="width:15px;height:24px;">',a+='<div class="duzon_btn_tabmod_area_resizer">',a=a+('<div id="TB_CONTAINER_BOTTOM_RESIZE_BTN_'+b+'" style="height:100%;margin-left:1px;">')+'<div class="duzon_spinner_btn_arrow_up"></div>',a+='<div class="duzon_spinner_btn_arrow_down"></div>',a+="</div>",a+="</div>",a+="</td>"),a+="</tr>",a+="</table>",a+="</td>",a+="</tr>",a+="</table>",g_bBottomResizeYN&&(a=a+('<table style="width:100%;border-top:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" class="tbToolbarSetTabMode" id="TB_CONTAINER_BOTTOM_RESIZE_CONTAINER_'+
b+'">')+'<tr valign="top">',a=a+('<td id="TB_CONTAINER_BOTTOM_RESIZE_'+b+'" class="duzon_handle_resize_height">')+'<div style="display:inline-block;"></div>',a+="</td>",a+="</tr>",a+="</table>"),a+="</td>",a+="</tr>";else if(!c||g_bTabBar_Display)a+='<tr valign="top"><td style="width:100%;line-height:normal;padding:0px;"><div class="tbToolbarSetTabMode_No_Bottom" id="ToolbarSetTabMode_No_Bottom_'+b+'"></div></td></tr>';!0===dzeUiConfig.bUseBottomStatusBar&&(a+='<tr valign="top"><td style="width:100%;line-height:normal;padding:0px;"><div class="ToolbarSetBottomStatusBar" id="ToolbarSetBottomStatusBar_'+
b+'"></div></td></tr>');a+="</table>";c=parseInt(b,10)+DZE_IFRAME_TMP_NO;a+='<div id="'+g_strEditObjectName+"_Parent_"+c+'" class="dze_hiddenframe_container">';a+='<iframe id="'+g_strEditObjectName+"_"+c+'"></iframe>';return a=a+('<iframe id="dze_idx_if_filectl_'+b+'" name="dze_nm_if_filectl_'+b+'"></iframe>')+"</div>"}
function buildEditAreaContainer_ToolbarOneLine(b,a){try{for(var c="",e=0,f=a.length;e<f;e++){var d=a[e][0],g=parseInt(a[e][1],10);ID_TYPE_TOOLBAR_HANDLE==d?c+=buildEditAreaContainer_Handle(1,7,1):ID_TYPE_TOOLBAR_SEPARATOR==d?c+=buildEditAreaContainer_Separator(1):ID_TYPE_TOOLBAR_SPACE==d?c+=buildEditAreaContainer_Space(g):ID_TYPE_TOOLBAR_CAPTION==d?c+=buildEditAreaContainer_Caption(g):ID_TYPE_TOOLBAR_BUTTON==g_arrConst[d][6]?c+=buildEditAreaContainer_Button(d,b):ID_TYPE_TOOLBAR_COMBOBOX==g_arrConst[d][6]?
ID_COMMAND_FONT_NAME==d?c+=buildEditAreaContainer_ComboBox(d,110,2,g,b):ID_COMMAND_FONT_SIZE==d||ID_COMMAND_HEADING_SIZE==d?c+=buildEditAreaContainer_ComboBox(d,72,1,g,b):ID_COMMAND_LETTER_SPACING==d||ID_COMMAND_LINE_HEIGHT==d?c+=buildEditAreaContainer_ComboBox(d,60,1,g,b):ID_COMMAND_STYLE_TEMPLATE_COMBO===d&&(c+=buildEditAreaContainer_ComboBox(d,80,1,g,b)):ID_TYPE_TOOLBAR_DROPDOWN!=g_arrConst[d][6]||d===ID_COMMAND_SHAPES_INSERT&&!1===dzeUiConfig.bUseShapesFeature||(c+=buildEditAreaContainer_DropDown(d,
b))}return c}catch(h){dalert(h)}}
function buildEditAreaContainer_Handle(b,a,c){var e="";0!=b&&(e+='<td width="'+b+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"></td>');0!=a&&(e+='<td width="'+a+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"><div class="'+g_strSkin_HandleDiv+'"></div></td>');0!=c&&(e+='<td width="'+c+'" style="line-height:normal;height:20px;border:0px;padding:0px;vertical-align:middle;"></td>');return e}
function buildEditAreaContainer_ComboBox(b,a,c,e,f){var d=0;e&&(d=calculateStringLength(g_arrConst[b][1])-6);d=a+(e?d:0)+2;d='<td width="'+d+'" height="28" style="width:'+d+'px;height:16px;line-height:0;border:0px;padding:0px;vertical-align:middle;"><table style="border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0"><tr>';e&&(d+='<td style="height:16px;line-height:0;border:0px;padding-left:5px;padding-top:3px;padding-right:3px;padding-bottom:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+
'">'+g_arrConst[b][1]+"</td>");d+='<td style="width:'+a+'px;height:16px;line-height:0;border:0px;padding:0px;">';d+='<div id="'+g_arrConst[b][2]+"_"+f+'" TBTYPE="toggle" style="line-height:0;width:'+a+'px;overflow:hidden;" title="'+g_arrConst[b][1]+'">';d+='<table style="width:'+a+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';d+="<tr>";g_bBrowserType_WK?g_bDocType_XHTML?(d+='<td style="line-height:1;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
c+'"><span id="'+g_arrConst[b][2]+"_"+f+'_LABEL" style="line-height:1;"></span>&nbsp;</td>',d+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(d+='<td style="line-height:1;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
c+'"><span id="'+g_arrConst[b][2]+"_"+f+'_LABEL" style="line-height:1;"></span>&nbsp;</td>',d+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):g_bDocType_XHTML?(d+='<td style="line-height:1;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
c+'"><span id="'+g_arrConst[b][2]+"_"+f+'_LABEL" style="line-height:1;"></span></td>',d+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(d+='<td style="line-height:1;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
c+'"><span id="'+g_arrConst[b][2]+"_"+f+'_LABEL" style="line-height:1;"></span></td>',d+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>');d+="</tr>";d+="</table>";d+="</div>";d+="</td>";d+="</tr>";d+="</table>";return d+="</td>"}
function buildEditAreaContainer_Separator(b){var a="";0!=b&&(a+='<td width="'+b+'" height="28" style="line-height:normal;height:1px;border:0px;padding:0px;vertical-align:middle;"><div class="'+g_strSkin_Separator+'"></div></td>');return a}function buildEditAreaContainer_Space(b){var a="";0!=b&&(a+='<td width="'+b+'" height="28" style="line-height:normal;height:1px;border:0px;padding:0px;vertical-align:middle;"></td>');return a}
function buildEditAreaContainer_Button(b,a){var c=g_arrConst[b][1];shortcutsMenuList[b]&&(c=g_arrConst[b][1]+" ["+shortcutsMenuList[b]+"]");return'<td width="24" height="28" style="padding:0;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'" title="'+c+'" TBTYPE="toggle" style="overflow:hidden;"><div class="duzon_tb_button_image"><img src="'+g_strBlankImageData+'" _src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[b][1]+
'"></div></div>')+"</td>"}
function buildEditAreaContainer_DropDown(b,a){b==ID_COMMAND_MARK_INSERT&&(g_bMarkWinAssigned=!0);var c='<td width="35" height="28" style="line-height:0;height:24px;border:0px;padding:0px;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'" title="'+g_arrConst[b][1]+'" TBTYPE="toggle" style="overflow:hidden;">');c=c+'<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" width="26"><tr><td width="16" style="line-height:0;height:16px;border:0px;padding:0px;">'+('<div class="tbDropDown_AreaButton"><div class="tb_DropDown_Button_Image"><img src="'+
g_strBlankImageData+'" _src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[b]+'" alt="'+g_arrConst[b][1]+'" style="vertical-align:baseline;border:none;width:16px;height:16px;"></div></div>');switch(b){case ID_COMMAND_FORE_COLOR:c+='<div id="TB_SETFORECOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_BACK_COLOR:c+='<div id="TB_SETBACKCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';
break;case ID_COMMAND_TABLE_CELL_BACKCOLOR:c+='<div id="TB_SETCELLBACKCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';break;case ID_COMMAND_IMAGE_BORDER_COLOR:c+='<div id="TB_SETIMAGEBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_TABLE_BORDER_COLOR:c+='<div id="TB_SETTABLEBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';
break;case ID_COMMAND_HIGHLIGHTER:c+='<div id="TB_HIGHLIGHTER_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_TEXTBOX_FILL_COLOR:c+='<div id="TB_FILLCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';break;case ID_COMMAND_TEXTBOX_LINE_COLOR:c+='<div id="TB_LINECOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';
break;case ID_COMMAND_VIDEO_BORDER_COLOR:c+='<div id="TB_SETVIDEOBORDERCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_SHAPES_FILL:c+='<div id="TB_SHAPEFILLCOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';break;case ID_COMMAND_SHAPES_BORDER:c+='<div id="TB_SHAPELINECOLOR_'+a+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>'}c=
c+'</td><td width="10" style="line-height:0;height:16px;border:0px;padding:0px;vertical-align:middle;">'+('<div id="'+g_arrConst[b][2]+"_"+a+'_SUB" class="'+g_strSkin_DropDown_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div>');return c+"</td></tr></table></div></td>"}
function buildEditAreaContainer_Caption(b){return'<td style="width:'+(12*b.length+1)+'px;height:16px;line-height:normal;border:0px;padding:0px;vertical-align:middle;" class="'+g_strSkin_ComboBox_Caption+'">'+b+"</td>"}
function calculateStringLength(b){try{if(null==g_strBrowserLanguage)return 0;var a=0,c=b.length;if(ID_LANGUAGE_TYPE_KO==g_strBrowserLanguage)a=12*c+16;else if(ID_LANGUAGE_TYPE_EN==g_strBrowserLanguage)a=9*c+2;else if(ID_LANGUAGE_TYPE_JA==g_strBrowserLanguage)a=12*c+16;else if(ID_LANGUAGE_TYPE_ZH==g_strBrowserLanguage||ID_LANGUAGE_TYPE_ZH_CN==g_strBrowserLanguage)a=12*c+16;return a}catch(e){}return 0};
var duzon_menubar={nEditNumber:0,objLayerDoc:document,setEditNumber:function(b){this.nEditNumber=b},menuBarContainerObj:{},setMenuBarContainerObj:function(){this.menuBarContainerObj=g_objLayerKit.getElementById("TB_CONTAINER_MENU_"+this.nEditNumber)},calcElementPosition:function(b){var a={};a.scrollX=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft;a.scrollY=document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop;
a.top=b.offsetTop;a.left=b.offsetLeft;a.width=b.offsetWidth;a.height=b.offsetHeight;window.innerWidth?(a.view_window_width=window.innerWidth,a.view_window_height=window.innerHeight):(a.view_window_width=document.documentElement.clientWidth,a.view_window_height=document.documentElement.clientHeight);return a},idx_twodepth_menu_container:"idx_twodepth_menu_container",twodepth_menu_container:{},prev_command_id:"0",viewTwoDepthMenu:function(b,a,f){try{dlog("viewTwoDepthMenu:"+a);duzon_menubar.twodepth_menu_container=
g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);if(null!=duzon_menubar.twodepth_menu_container){dlog("duzon_menubar.twodepth_menu_container is not null");if(this.prev_command_id==a){dlog("viewTwoDepthMenu:1:this.prev_command_id->"+this.prev_command_id+",command_id=>"+a);duzon_menubar.twodepth_menu_container.style.display="block";return}dlog("viewTwoDepthMenu:2:this.prev_command_id->"+this.prev_command_id+",command_id=>"+a);duzon_menubar.hideTwoDepthMenu(a)}this.prev_command_id=
a;this.twodepth_menu_container=g_objLayerKit.getLayerDocument().createElement("div");this.twodepth_menu_container.id=this.idx_twodepth_menu_container;this.twodepth_menu_container.className="twodepth_menu_container";g_objLayerKit.getLayerDocument().body.appendChild(this.twodepth_menu_container);for(var d=g_objPropertyUtil,c=b;c&&"BODY"!==c.nodeName;){if("DIV"===c.nodeName)if(d.hasClass(c,"MenuContainer"))break;else if(d.hasClass(c,"ContextMenuContainer"))break;c=c.parentNode}if(c&&"BODY"!==c.nodeName){var e=
this.setTwoDetphMenuList(f,a);this.twodepth_menu_container.appendChild(e);g_objPropertyUtil.setOpacity(this.twodepth_menu_container,0);this.twodepth_menu_container.style.display="block";this.setTwoDepthMenuPosition(c,b,this.twodepth_menu_container)}}catch(g){dalert(g)}},setTwoDetphMenuList:function(b,a){a=document.createElement("div");var f=document.createElement("div");f.className="twodepth_menu_list_blank";a.appendChild(f);var d={},c=0,e=null;f=null;for(var g="",n=0;n<b.length;n++){g="";d=document.createElement("div");
d.className="twodepth_menu_list";c=b[n];"object"===typeof c&&(e=c.text,f=c.img,c=c.cmd);if(-1===c)d.className="dze_ribbon_tb_left_separator",d.style.width="100%",d.style.height="1px";else{(function(){var a=g_arrConst[c][3];d.onmousedown=function(a){if("undefined"==typeof a||null==a)if("undefined"==typeof window.event||null==window.event)a=g_objLayerKit.getLayerWindow().event;TBCancelBubbleEvent(a)};d.onclick=function(b){dlog("func:"+a);eval(a)(b,this,-1)};d.onmouseover=function(b){this.className=
"twodepth_menu_list_over";dlog("func:"+a)};d.onmouseout=function(a){this.className="twodepth_menu_list"};d.command=g_arrConst[c][0];d.commandtype=ID_COMMAND_TYPE_MENU;d.TBSTATE=ID_STRING_NAME_UNCHECKED;d.command_id=c;d.support_type=g_arrConst[c][4];d.support_control_type=g_arrConst[c][5];null!==e&&(d._title=e)})();var h="",k;for(k in shortcutsMenuList)if(k==c){h="<span class='shortcuts_text'>("+shortcutsMenuList[k]+")</span>";break}var q=g_arrConst[c][1];null!==e&&(q=e);inArray(c,g_objMenuWin.openMenuList)&&
(q+="...");g+="<table width='100%' border='0' cellspacing='0' cellpadding='0'>";g+="<tr height='22'>";g+="<td class='twodepth_menu_list_blank_10'></td>";var m=g_arrIcon[c]||"";null!==f&&(m=f);g+="<td class='twodepth_menu_list_icon'>";m&&(g+='<div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+m+'" alt="'+q+'" width="16" height="16" style="vertical-align:baseline;border:none;"></div>');g+="</td>";g+="<td class='twodepth_menu_list_blank_6'></td>";g+=
"<td class='twodepth_menu_list_text'>"+q+h+"</td>";g+="</td>";g+="</tr>";g+="</table>";d.innerHTML=g;g=!0;h=!1;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(h=handlerUI.setDisableMenu(c));g=!0===h?!1:g;0==g&&(d.TBSTATE=ID_STRING_NAME_GRAY,g_objPropertyUtil.setFilterOpacityStyle(d,!0))}a.appendChild(d)}b=document.createElement("div");b.className="twodepth_menu_list_blank";a.appendChild(b);return a},setTwoDepthMenuPosition:function(b,a,f){var d=this.calcElementPosition(b),c=this.calcElementPosition(a);
a=this.calcElementPosition(f);b=d.top-b.scrollTop+c.top+2;c=d.left+c.width;var e=g_objPositionUtil.getActiveWinSize(),g="right";c+a.width>e.view_window_width+e.scrollX&&(c=c-d.width-a.width+4,g="left");b+a.height>e.view_window_height+e.scrollY&&(b=b-a.height+20);b<e.scrollY&&(b=e.scrollY);0>b&&(b=0);0>c&&(c=0);f.style.top=b+"px";f.style.left=c+"px";duzon_dialog.animateDlg(this.twodepth_menu_container,g)},unload:function(){try{var b=g_objLayerKit.getElementById(this.idx_twodepth_menu_container);b&&
b.parentNode&&b.parentNode.removeChild(b)}catch(a){dalert(a)}},hideTwoDepthMenu:function(b){duzon_menubar.twodepth_menu_container=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);null!=duzon_menubar.twodepth_menu_container&&(duzon_menubar.twodepth_menu_container.style.display="none",g_objLayerKit.getLayerDocument().body.removeChild(duzon_menubar.twodepth_menu_container))},onMouseOver:function(b){b&&0===dzeJ(b).parents("#"+duzon_menubar.idx_twodepth_menu_container).length&&duzon_menubar.hideTwoDepthMenu()},
toolbar_line:3,viewHiddenTbContainerTool:function(b,a){dlog("===viewHiddenTbContainerTool==== toolbarNo:"+b+", nEditNumber:"+a);duzon_menubar.nEditNumber=a;g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);for(a=1;a<=duzon_menubar.toolbar_line;a++){var f=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber);null!=f&&(f.style.display=b==a?"none"==f.style.display?"block":"none":"none")}duzon_menubar.setHiddenTbContainerToolPostion();duzon_menubar.addLayerEvent()},closeHiddenTbContainerTool:function(){for(var b,
a=1;a<=duzon_menubar.toolbar_line;a++)b=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber),null!=b&&(b.style.display="none");duzon_menubar.removeLayerEvent()},setHiddenTbContainerToolPostion:function(){dlog("setHiddenTbContainerToolPostion CAll");for(var b=null,a=1;a<=duzon_menubar.toolbar_line&&(b=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber),null==b||"none"==b.style.display);a++);if(null!=b&&"none"!=b.style.display){b.style.left=
"0px";b.style.top="0px";a=b.getAttribute("toolbarNo");var f=document.getElementById("EDIT_SET_CONTAINER_"+duzon_menubar.nEditNumber);parentToolbarObj_pos=g_objPositionUtil.getOuterRect(f);var d=duzon_menubar.calcElementPosition(b);f=document.getElementById("TB_CONTAINER_"+duzon_menubar.nEditNumber);tbContainerObj_pos=duzon_menubar.calcElementPosition(f);dlog(d);dlog("--- toolbarNo:"+a);f=parentToolbarObj_pos.top;if(dzeUiConfig.bCustomize_MenuBar_Display){var c=document.getElementById("TB_CONTAINER_MENU_"+
duzon_menubar.nEditNumber);menubarObj_pos=duzon_menubar.calcElementPosition(c);f+=menubarObj_pos.height}c=0;1<=a&&dzeUiConfig.bCustomize_ToolBar1_Display&&(f+=d.height,c++);2<=a&&dzeUiConfig.bCustomize_ToolBar2_Display&&(f+=d.height,c++);3<=a&&dzeUiConfig.bCustomize_ToolBar3_Display&&(f+=d.height,c++);dlog("=== viewToolbarNum : "+c);a=parentToolbarObj_pos.left+tbContainerObj_pos.width-d.width;1<c&&(f-=c-1);d=duzon_dialog.getParentAbsoluteNodePos(b);f-=d.top;a-=d.left;b.style.top=f+"px";b.style.left=
a+"px";dlog("toolbarObj.style.top:"+b.style.top);dlog("toolbarObj.style.left:"+b.style.left);dlog("toolbarObj.id:"+b.id)}},resizeHiddenTbContainerToolPostion:function(){dlog("resizeHiddenTbContainerToolPostion call");for(var b=null,a=1;a<=duzon_menubar.toolbar_line&&(b=document.getElementById("TB_CONTAINER_TOOL_"+a+"_HIDDEN_"+duzon_menubar.nEditNumber),null==b||"none"==b.style.display);a++);null!=b&&duzon_menubar.setHiddenTbContainerToolPostion(b)},addLayerEvent:function(){try{window.attachEvent?
(window.attachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool),window.attachEvent("onresize",duzon_menubar.setHiddenTbContainerToolPostion)):(window.addEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1),window.addEventListener("resize",duzon_menubar.setHiddenTbContainerToolPostion,!1));for(var b in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[b].attachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool):g_objEditorDocument[b].addEventListener("mousedown",
duzon_menubar.closeHiddenTbContainerTool,!1)}catch(a){dalert(a)}},removeLayerEvent:function(){try{window.detachEvent?(window.detachEvent("onmousedown",duzon_menubar.closeHiddenTbContainerTool),window.detachEvent("onresize",duzon_menubar.setHiddenTbContainerToolPostion)):(window.removeEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1),window.removeEventListener("resize",duzon_menubar.setHiddenTbContainerToolPostion,!1));for(var b in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[b].detachEvent("onmousedown",
duzon_menubar.closeHiddenTbContainerTool):g_objEditorDocument[b].removeEventListener("mousedown",duzon_menubar.closeHiddenTbContainerTool,!1)}catch(a){dalert(a)}},availToolbarWidth:0,rebuildHiddenToolbar:function(){for(var b in g_arrEditorAreaContainer){var a=b;duzon_menubar.availToolbarWidth=!0===g_bEditorWidthPercentageYN?duzon_menubar.calcElementPosition(document.getElementById("INIT_LOAD_AREA_"+a)).width-2:parseInt(g_arrEditorWidth[a],10)-7;if(!(0>=duzon_menubar.availToolbarWidth))for(var f,d=
1;3>=d;d++){f=0;var c=d;if(eval("dzeUiConfig.bCustomize_ToolBar"+c+"_Display")){for(var e=document.getElementById("TB_CONTAINER_TOOL_"+c+"_"+a).childNodes[0],g=g_objTableUtil.getTableRowElement(e,0),n=g_objTableUtil.getTableCellsLength(e,0),h=0;h<n;h++){var k=g_objTableUtil.getTableCellElement(e,0,h).getAttribute("width");null!=k&&(f+=parseInt(k,10))}k=document.getElementById("TB_CONTAINER_TOOL_"+c+"_HIDDEN_TBL_"+a);var q=g_objTableUtil.getTableRowElement(k,0),m=g_objTableUtil.getTableCellsLength(k,
0);h=duzon_menubar.availToolbarWidth;"block"==document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+a).style.display&&(h-=13);if(f>h){if(e=g_objTableUtil.getTableCellElement(e,0,n-4),null!=e&&e.getAttribute("width")){var l=q.insertCell(1);e.getAttribute("width")&&l.setAttribute("width",e.getAttribute("width"));e.getAttribute("height")&&l.setAttribute("height",e.getAttribute("height"));e.getAttribute("style")&&l.setAttribute("style",e.getAttribute("style"));for(var p=0;p<e.childNodes.length;p++)l.appendChild(e.childNodes[p]);
g.deleteCell(n-4);document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+a).style.display="block";f-=parseInt(l.getAttribute("width"));f>h&&duzon_menubar.rebuildHiddenToolbar()}}else{if("none"==document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+a).style.display)continue;if(2==m){document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+a).style.display="none";continue}e=g_objTableUtil.getTableCellElement(k,0,1);f+=parseInt(e.getAttribute("width"),10);3==m&&(h+=13);if(h>f){l=
g.insertCell(n-3);e.getAttribute("width")&&l.setAttribute("width",e.getAttribute("width"));e.getAttribute("height")&&l.setAttribute("height",e.getAttribute("height"));e.getAttribute("style")&&l.setAttribute("style",e.getAttribute("style"));for(p=0;p<e.childNodes.length;p++)l.appendChild(e.childNodes[p]);q.deleteCell(1);2==m?document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+a).style.display="none":(g=g_objTableUtil.getTableCellElement(k,0,1),f+=parseInt(g.getAttribute("width"),10),h>f&&
duzon_menubar.rebuildHiddenToolbar())}}k=document.getElementById("TB_CONTAINER_TOOL_"+c+"_HIDDEN_TBL_"+a);m=g_objTableUtil.getTableCellsLength(k,0);2==m&&(document.getElementById("TB_CONTAINER_TOOL_"+c+"_HIDDEN_"+a).style.display="none",document.getElementById("TB_CONTAINER_BTN_TOOL_"+c+"_HIDDEN_"+a).style.display="none")}}}},evtKeyCode:function(b){this.keyCode=(b?b:window.event).keyCode;dlog("keycode :"+this.keyCode);27==this.keyCode&&duzon_menubar.closeHiddenTbContainerTool()}};
var dzeColorPallet={colorno_gap:8,colorRowCnt:32,color_pix:4,colorset:[],default_hexCode:"000000",gray_hexCode:"808080",layerDoc:document,layerWin:window,showButtons:!0,palletViewType:"image",initialize:function(a,b,d,c){this.setLayerDoc();"undefined"!=typeof c&&null!=c&&""!=c&&(dzeColorPallet.layerDoc=c);if("undefined"==typeof a||""==a||null==dzeColorPallet.layerDoc.getElementById(a))dlog("please set pallet container id!");else{this.createPalletContainer(a);1==this.showButtons&&this.createPalletButtonContainer(a,
d);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_box").ondragstart=function(){return!1};dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_box").onselectstart=function(){return!1};c=255;var e=0,g=0,f="";d=[];for(a=0;a<=this.colorno_gap;a++)e=256/this.colorno_gap*a,255<e&&(e=255),f=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(g),d.push(f);for(a=this.colorno_gap-1;0<=a;a--)c=256/this.colorno_gap*a,255<c&&(c=255),f=this.getDecToHex(c)+this.getDecToHex(e)+
this.getDecToHex(g),d.push(f);for(a=1;a<=this.colorno_gap;a++)g=256/this.colorno_gap*a,255<g&&(g=255),f=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(g),d.push(f);for(a=this.colorno_gap-1;0<=a;a--)e=256/this.colorno_gap*a,255<e&&(e=255),f=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(g),d.push(f);for(a=1;a<=this.colorno_gap;a++)c=256/this.colorno_gap*a,255<c&&(c=255),f=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(g),d.push(f);for(a=this.colorno_gap-1;0<=a;a--)g=256/
this.colorno_gap*a,255<g&&(g=255),f=this.getDecToHex(c)+this.getDecToHex(e)+this.getDecToHex(g),d.push(f);e=d.length;var h=f=g=0,k={};for(a=0;a<=this.colorRowCnt;a++)if(this.colorset[a]=[],0==a)for(c=0;c<e;c++)this.colorset[a].push(d[c]);else for(c=0;c<e;c++)k=this.getHexToDec(d[c]),0==c&&(g=k.R_val,f=k.G_val,h=k.B_val),128<k.R_val?(g=k.R_val-Math.ceil((k.R_val-128)/this.colorRowCnt*a),128>g&&(g=128)):(g=k.R_val+Math.ceil((128-k.R_val)/this.colorRowCnt*a),128<g&&(g=128)),128<k.G_val?(f=k.G_val-Math.ceil((k.G_val-
128)/this.colorRowCnt*a),128>f&&(f=128)):(f=k.G_val+Math.ceil((128-k.G_val)/this.colorRowCnt*a),128<f&&(f=128)),128<k.B_val?(h=k.B_val-Math.ceil((k.B_val-128)/this.colorRowCnt*a),128>h&&(h=128)):(h=k.B_val+Math.ceil((128-k.B_val)/this.colorRowCnt*a),128<h&&(h=128)),this.colorset[a].push(this.getDecToHex(g)+this.getDecToHex(f)+this.getDecToHex(h));d="";if("pixel"==this.palletViewType){d+="<table width='' height='' border='0' cellpadding='0' cellspacing='0'>";e="";for(a=0;a<this.colorset.length;a++){d+=
"<tr>";for(c=0;c<this.colorset[a].length;c++)e=this.colorset[a][c],d+="<td width='"+this.color_pix+"' height='"+this.color_pix+"'><div style=\"cursor:default;width:"+this.color_pix+"px;height:"+this.color_pix+"px;background-color:#"+e+'"></div></td>';d+="</tr>"}d+="</table>"}else"image"==this.palletViewType&&(d+="<div class='dze_color_pallet_bg'></div>");dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").innerHTML=d;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").onmousedown=
function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="pallet";dzeColorPallet.showColorSelector(a);a=dzeColorPallet.getColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.viewSubColor(a);dzeColorPallet.showCrossColorSelector("black");dlog("\npallet color mouse down color : "+a);dlog("\n")};a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_selector";a.className="dze_color_pallet_table_selector_black";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").appendChild(a);
b=this.checkHexCode(b);!0===dzeUiConfig.showAchromaticColor&&this.viewAchromatic();b==this.default_hexCode||""==b?this.viewSubColor(this.gray_hexCode):this.viewSubColor(b);this.addFormEvent();this.viewOrgColor(b);this.selectCode(b);this.viewRecentColorSet();this.viewUserColorCodeSet();this.addMouseEvent();dlog("\npallet color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.colorset);dlog("\n")}},setLayerDoc:function(){this.layerDoc=g_objLayerKit.getLayerDocument();this.layerWin=g_objLayerKit.getLayerWindow()},
color_pallet_container_obj:null,createPalletContainer:function(a){var b="<table width='309' border='0' cellpadding='0' cellspacing='0' id='dze_idx_color_pallet_table_box'>\t<tr>\t\t<td width='196'><div id='dze_idx_color_pallet_table' class='dze_color_pallet_table'></div></td>\t\t<td width='10'></td>\t\t<td width='27'><div id='dze_idx_color_pallet_table_sub' class='dze_color_pallet_table_sub'></div></td>\t\t<td width='76'>";!0===dzeUiConfig.showPalletRecentColor&&(b+="\t\t\t<div class='dze_color_pallet_table_recent_color_label'>"+
ID_RES_CONST_STRING_RECENT_COLOR+"</div><div id='dze_idx_color_pallet_table_recent' class='dze_color_pallet_table_recent'></div>");b+="\t\t</td>\t</tr>\t<tr>\t\t<td height='10' colspan='4'></td>\t</tr>";!0===dzeUiConfig.showAchromaticColor&&(b+="\t<tr>\t\t<td height='35'><div id='dze_idx_color_pallet_table_achromatic' class='dze_color_pallet_table_achromatic'></div></td>\t\t<td colspan='3'></td>\t</tr>\t<tr>\t\t<td height='5' colspan='4'></td>\t</tr>");b=b+"</table><table width='309' border='0' cellpadding='0' cellspacing='3' id='dze_idx_color_form_table_box'>\t<tr>"+
("\t\t<td width='50' align='left'>"+ID_RES_CONST_STRING_RED+"(R):</td>");b+="\t\t<td width='45' align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_R_value",width:50,height:22})+"</td>";b+="\t\t<td width='' align='right'>"+ID_RES_CONST_STRING_HUE+"(H):</td>";b+="\t\t<td width='47' align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_H_value",width:50,height:22})+"</td>";b=b+"\t\t<td width='15' rowspan='7'></td>\t\t<td width='76' rowspan='7' align='center' valign='bottom'>"+("\t\t\t<div class='dze_color_pallet_table_new_color_box_label'>"+
ID_RES_CONST_STRING_NEW_COLOR+"</div>");b=b+"\t\t\t<div id='dze_idx_new_color' class='dze_color_pallet_table_new_color_box'></div>\t\t\t<div id='dze_idx_old_color' class='dze_color_pallet_table_old_color_box'></div>"+("\t\t\t<div class='dze_color_pallet_table_old_color_box_label'>"+ID_RES_CONST_STRING_CURRENT_COLOR+"</div>");b=b+"\t\t</td>\t</tr>\t<tr>\t\t<td colspan='4' height='3'></td>\t</tr>\t<tr>"+("\t\t<td align='left'>"+ID_RES_CONST_STRING_GREEN+"(G):</td>");b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_G_value",
width:50,height:22})+"</td>";b+="\t\t<td align='right'>"+ID_RES_CONST_STRING_SATURATION+"(S): </td>";b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_S_value",width:50,height:22})+"</td>";b=b+"\t</tr>\t<tr>\t\t<td colspan='4' height='3'></td>\t</tr>\t<tr>"+("\t\t<td align='left'>"+ID_RES_CONST_STRING_BLUE+"(B):</td>");b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_B_value",width:50,height:22})+"</td>";b+="\t\t<td align='right'>"+ID_RES_CONST_STRING_LIGHTNESS+"(L):</td>";
b+="\t\t<td align='right'>"+DzeSpinner.getHTML({id:"dze_idx_color_L_value",width:50,height:22})+"</td>";b+="\t</tr>\t<tr>\t\t<td colspan='4' height='3'></td>\t</tr>\t<tr>\t\t<td align='left' colspan='2'>HTML(T):</td>\t\t<td align='right' colspan='2'> #<input type='text' size='3' class='dze_color_pallet_table_htmlcode_form' id='dze_idx_color_value' value='' /></td>\t</tr></table>";!0===dzeUiConfig.showPalletUserColor&&(b+="<table width='' border='0' cellpadding='0' cellspacing='0'>\t<tr>\t\t<td align='center'><div class='dze_color_pallet_table_hr_separator'></div></td>\t</tr>\t<tr>\t\t<td align='center'><div id='dze_idx_color_pallet_table_user' class='dze_color_pallet_table_user'></div></td>\t</tr></table>");
this.color_pallet_container_obj=dzeColorPallet.layerDoc.createElement("div");this.color_pallet_container_obj.id="dze_idx_color_pallet_container";this.color_pallet_container_obj.className="dze_color_pallet_container";this.color_pallet_container_obj.innerHTML=b;dzeColorPallet.layerDoc.getElementById(a).appendChild(this.color_pallet_container_obj)},color_pallet_button_container_obj:null,createPalletButtonContainer:function(a,b){this.color_pallet_button_container_obj=dzeColorPallet.layerDoc.createElement("div");
this.color_pallet_button_container_obj.id="dze_idx_color_pallet_button_container";this.color_pallet_button_container_obj.className="duzon_dialog_buttonbox";dzeColorPallet.layerDoc.getElementById(a).appendChild(this.color_pallet_button_container_obj);"undefined"==typeof b&&(b=function(){});if(null==b||""==b)b=function(){};a=[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE];for(var d=[function(){var a=dzeColorPallet.getColorCode("hex");b(a)},function(){duzon_dialog.closeExtendsDlg()}],c={},e=0;e<a.length;e++)c=
{},c=dzeColorPallet.layerDoc.createElement("input"),c.type="button",c.value=a[e],function(){var a=d[e],b=e;c.onclick=function(b){a(b?b:dzeColorPallet.layerWin.event)};var h="duzon_dialog_btn_normal",k="duzon_dialog_btn_up",l="duzon_dialog_btn_down";0==b&&(h="duzon_dialog_btn_ok_normal",k="duzon_dialog_btn_ok_up",l="duzon_dialog_btn_ok_down");c.className=h;c.onmouseover=function(){this.className=k};c.onmouseout=function(){this.className=h};c.onmousedown=function(){this.className=l};c.onmouseup=function(){this.className=
k}}(),this.color_pallet_button_container_obj.appendChild(c)},addFormEvent:function(){dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_R_value",255,0,0,"dzeColorPallet.evtModifyFormColorR");dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_G_value",255,0,0,"dzeColorPallet.evtModifyFormColorG");
dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").onkeyup=function(){dzeColorPallet.modifyRgbValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_B_value",255,0,0,"dzeColorPallet.evtModifyFormColorB");dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").onkeyup=function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_H_value",360,0,0,"dzeColorPallet.evtModifyFormColorH");dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").onkeyup=
function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_S_value",100,0,0,"dzeColorPallet.evtModifyFormColorS");dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").onkeyup=function(){dzeColorPallet.modifyHslValue(this)};duzon_dialog.modifySpinnerValue("dze_idx_color_L_value",100,0,0,"dzeColorPallet.evtModifyFormColorL");dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").onkeyup=function(){dzeColorPallet.modifyHexCode(this)};dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").onfocus=
function(){this.select()}},evtModifyFormColorR:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorG:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorB:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value");dzeColorPallet.modifyRgbValue(a)},evtModifyFormColorH:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value");
dzeColorPallet.modifyHslValue(a)},evtModifyFormColorS:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value");dzeColorPallet.modifyHslValue(a)},evtModifyFormColorL:function(a){a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value");dzeColorPallet.modifyHslValue(a)},addMouseEvent:function(){window.attachEvent?(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").attachEvent("onmousemove",dzeColorPallet.evtMouseMove),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").attachEvent("onmouseup",
dzeColorPallet.evtMouseUp)):window.addEventListener&&(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").addEventListener("mousemove",dzeColorPallet.evtMouseMove,!1),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").addEventListener("mouseup",dzeColorPallet.evtMouseUp,!1))},removeMouseEvent:function(){window.detachEvent?(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").detachEvent("onmousemove",dzeColorPallet.evtMouseMove),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").detachEvent("onmouseup",
dzeColorPallet.evtMouseUp)):window.removeEventListener&&(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").removeEventListener("mousemove",dzeColorPallet.evtMouseMove,!1),dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_container").removeEventListener("mouseup",dzeColorPallet.evtMouseUp,!1))},evtMouseMove:function(a){a=a?a:dzeColorPallet.layerWin.event;if("pallet"==dzeColorPallet.downPosition){dzeColorPallet.showColorSelector(a);var b=dzeColorPallet.getColorCodeFromSelector();
dzeColorPallet.selectCode(b);dzeColorPallet.viewSubColor(b)}"subColor"==dzeColorPallet.downPosition&&(dzeColorPallet.showSubColorSelector(a),b=dzeColorPallet.getSubColorCodeFromSelector(),dzeColorPallet.selectCode(b));"achromatic"==dzeColorPallet.downPosition&&(dzeColorPallet.showAchromaticSelector(a),b=dzeColorPallet.getAchromaticColorCodeFromSelector(),dzeColorPallet.selectCode(b))},evtMouseUp:function(a){dzeColorPallet.downPosition=""},maxRecentColorNum:20,recentColorCodeSet:[],viewRecentColorSet:function(){if(!0===
dzeUiConfig.showPalletRecentColor&&null!=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent")){dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent").innerHTML="";var a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_recent_color_box";a.className="dze_color_pallet_table_recent_color_box";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent").appendChild(a);for(var b="",d=this.getRecentColorSet(),c=null,
e=0,g=0,f=0;f<this.maxRecentColorNum;f++)c=dzeColorPallet.layerDoc.createElement("div"),c.className="dze_color_pallet_table_recent_color_unit","undefined"!=typeof d[f]&&(b=d[f],c.style.backgroundColor="#"+b,c.style.cursor="pointer",c.title="#"+b,function(){var a=b;c.onclick=function(){dzeColorPallet.selectRecentColor(this,a)}}()),e=parseInt(f/4,10),g=f%4,16<=f&&(g=f-16,e=parseInt(g/2,10)+4,g%=2),c.style.top=19*e+"px",c.style.left=19*g+"px",a.appendChild(c);e=dzeColorPallet.layerDoc.createElement("div");
e.className="dze_color_pallet_table_recent_color_delete";e.title=ID_RES_CONST_BTN_DELETE;e.style.left="38px";e.style.top="76px";e.onclick=function(){dzeColorPallet.removeRecentColorListConfirm()};a.appendChild(e);dlog("\nrecent color set array \u2193\u2193\u2193");g_objCommonUtil.dir(d);dlog("\n")}},selectRecentColor:function(a,b){for(var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_recent_color_box").childNodes,c=0;c<d.length;c++)d[c].style.borderColor="#ffffff";a.style.borderColor=
"#"+b;dzeColorPallet.selectCode(b);dzeColorPallet.showCrossColorSelector("white")},getRecentColorSet:function(){if("undefined"!=typeof localStorage)try{localStorage.getItem("dzeRecentHexCodeList")&&(this.recentColorCodeSet=localStorage.getItem("dzeRecentHexCodeList").split(","))}catch(a){}return this.recentColorCodeSet},setRecentColorSet:function(a){this.recentColorCodeSet=a;if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeRecentHexCodeList",a.join(","))}catch(b){}},addRecentColorSet:function(a){a=
this.checkHexCode(a);if(6==a.length){var b=this.getRecentColorSet();b=this.removeValueFromArrayList(a,b);b.unshift(a);b=this.getMaxArrayList(b,this.maxRecentColorNum);this.setRecentColorSet(b);this.viewRecentColorSet()}},removeRecentColorList:function(){this.recentColorCodeSet=[];if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeRecentHexCodeList","")}catch(a){}this.viewRecentColorSet()},removeRecentColorListConfirm:function(){if(0==this.getRecentColorSet().length)alert(ID_RES_CONST_MSG_ALERT_NO_RECENT_COLOR);
else{var a=this;cmnMsg.showMsg(MESSAGE_CONFIRM,ID_RES_CONST_MSG_ALERT_DELETE_RECENT_COLOR,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();a.removeRecentColorList()},function(){cmnMsg.hideMsg()})}},removeValueFromArrayList:function(a,b){for(var d=[],c=0;c<b.length;c++)b[c]!=a&&d.push(b[c]);return d},getMaxArrayList:function(a,b){if(a.length>b){b=a.length-b;for(var d=0;d<b;d++)a.pop()}return a},maxUserColorNum:24,userColorCodeSet:[],viewUserColorCodeSet:function(){if(!0===
dzeUiConfig.showPalletUserColor){dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").innerHTML="";var a=dzeColorPallet.layerDoc.createElement("div");a.className="dze_color_pallet_table_user_label";a.innerHTML=ID_RES_CONST_STRING_USER_SET;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").appendChild(a);a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_user_color_box";a.className="dze_color_pallet_table_user_color_box";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user").appendChild(a);
for(var b="",d=this.getUserColorCodeSet(),c=null,e=0,g=0,f=0;f<this.maxUserColorNum;f++)c=dzeColorPallet.layerDoc.createElement("div"),c.className="dze_color_pallet_table_user_color_unit","undefined"!=typeof d[f]&&(b=d[f],c.style.backgroundColor="#"+b,c.style.cursor="pointer",c.title="#"+b,function(){var a=b;c.onclick=function(){dzeColorPallet.selectUserColor(this,a)}}()),e=parseInt(f/12,10),g=f%12,c.style.top=19*e+"px",c.style.left=19*g+"px",a.appendChild(c);e=dzeColorPallet.layerDoc.createElement("div");
e.className="dze_color_pallet_table_recent_color_delete";e.title=ID_RES_CONST_BTN_DELETE;e.style.right="0px";e.onclick=function(){dzeColorPallet.removeUserColorListConfirm()};a.appendChild(e);e=dzeColorPallet.layerDoc.createElement("div");e.className="dze_color_pallet_table_user_color_add";e.title=ID_RES_CONST_STRING_ADD_USER_COLOR;e.style.right="38px";e.onclick=function(){dzeColorPallet.addUserColorCodeSet()};a.appendChild(e);dlog("\nuser color set array \u2193\u2193\u2193");g_objCommonUtil.dir(d);
dlog("\n")}},selected_user_color:"",selectUserColor:function(a,b){for(var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_user_color_box").childNodes,c=0;c<d.length;c++)d[c].style.borderColor="#ffffff";a.style.borderColor="#"+b;dzeColorPallet.selectCode(b);dzeColorPallet.showCrossColorSelector("white");dzeColorPallet.selected_user_color=b},getUserColorCodeSet:function(){if("undefined"!=typeof localStorage)try{localStorage.getItem("dzeUserHexCodeList")&&(this.userColorCodeSet=
localStorage.getItem("dzeUserHexCodeList").split(","))}catch(a){}return this.userColorCodeSet},setUserColorSet:function(a){this.userColorCodeSet=a;if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeUserHexCodeList",a.join(","))}catch(b){}},addUserColorCodeSet:function(){var a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value;a=this.checkHexCode(a);if(6==a.length){var b=this.getUserColorCodeSet();b=this.removeValueFromArrayList(a,b);b.unshift(a);b=this.getMaxArrayList(b,
this.maxUserColorNum);this.setUserColorSet(b);this.viewUserColorCodeSet()}},removeUserColorList:function(){this.userColorCodeSet=[];if("undefined"!=typeof localStorage)try{localStorage.setItem("dzeUserHexCodeList","")}catch(a){}this.viewUserColorCodeSet()},removeUserColorListConfirm:function(){var a=this.getUserColorCodeSet();0!=a.length&&""!=this.selected_user_color&&(a=this.removeValueFromArrayList(this.selected_user_color,a),this.setUserColorSet(a),this.viewUserColorCodeSet())},achromaticSet:[],
achromaticColorPix:9,viewAchromatic:function(){var a="<table border='0' cellpadding='0' cellspacing='0'><tr>";var b=255,d=255,c=255;d="FFFFFF";b=100;b={};for(var e=0;20>=e&&(b=100-5*e,b=this.hsl2rgb(0,0,b),c=d=b=b.r,d=this.getDecToHex(b)+this.getDecToHex(d)+this.getDecToHex(c),this.achromaticSet.push(d),a+="<td width='"+this.achromaticColorPix+"' height='20'><div style=\"width:"+this.achromaticColorPix+"px; height:20px;background-color:#"+d+';"></div></td>',0!=b);e++);a+="</tr></table>";dlog("\nachromatic color set array \u2193\u2193\u2193");
g_objCommonUtil.dir(this.achromaticSet);dlog("\n");dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").innerHTML=a;a=dzeColorPallet.layerDoc.createElement("div");a.id="dze_idx_color_pallet_table_achromatic_selector";a.className="dze_color_pallet_table_achromatic_selector";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").appendChild(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").onmousedown=function(a){a=
a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="achromatic";dzeColorPallet.showAchromaticSelector(a);a=dzeColorPallet.getAchromaticColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.showCrossColorSelector("white")}},subColorStep:16,subColorPix:4,subColorSet:[],viewSubColor:function(a){dlog("====== viewSubColor START ======");a=this.checkHexCode(a);6!=a.length&&(a=this.default_hexCode);dlog("==== viewSubColor:"+a);a=this.getHexToDec(a);var b="<table width='' border='0' cellpadding='0' cellspacing='0'>";
var d=255-a.R_val;d=Math.ceil(d/this.subColorStep);var c=255-a.G_val;c=Math.ceil(c/this.subColorStep);var e=255-a.B_val;e=Math.ceil(e/this.subColorStep);var g=255,f=255,h=255,k="FFFFFF";this.subColorSet=[];for(var l=0;l<=this.subColorStep;l++)l==this.subColorStep?(g=a.R_val,f=a.G_val,h=a.B_val):0<l&&(g-=d,f-=c,h-=e),g<a.R_val&&(g=a.R_val),f<a.G_val&&(f=a.G_val),h<a.B_val&&(h=a.B_val),0>g&&(g=0),0>f&&(f=0),0>h&&(h=0),k=this.getDecToHex(g)+this.getDecToHex(f)+this.getDecToHex(h),this.subColorSet.push(k),
b+="<tr>",b+="<td width='12' height='"+this.subColorPix+"'><div style=\"width:12px;height:"+this.subColorPix+"px;background-color:#"+k+'; cursor:default"></div></td>',b+="<td width='15'><div style='width:15px;'></div></td>",b+="</tr>";d=Math.ceil(g/this.subColorStep);c=Math.ceil(f/this.subColorStep);e=Math.ceil(h/this.subColorStep);for(l=1;l<=this.subColorStep;l++)l==this.subColorStep?h=f=g=0:0<l&&(g-=d,f-=c,h-=e),0>g&&(g=0),0>f&&(f=0),0>h&&(h=0),k=this.getDecToHex(g)+this.getDecToHex(f)+this.getDecToHex(h),
this.subColorSet.push(k),b+="<tr>",b+="<td width='12' height='"+this.subColorPix+"'><div style=\"width:12px;height:"+this.subColorPix+"px;background-color:#"+k+'; cursor:default"></div></td>',b+="<td width='15'><div style='width:15px;'></div></td>",b+="</tr>";b+="</table>";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").innerHTML=b;dlog("\nsub color set array \u2193\u2193\u2193");g_objCommonUtil.dir(this.subColorSet);dlog("\n");a=dzeColorPallet.layerDoc.createElement("div");
a.id="dze_idx_color_pallet_table_sub_selector";a.className="dze_color_pallet_table_sub_selector";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").appendChild(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").onmousedown=function(a){a=a?a:dzeColorPallet.layerWin.event;dzeColorPallet.downPosition="subColor";dzeColorPallet.showSubColorSelector(a);a=dzeColorPallet.getSubColorCodeFromSelector();dzeColorPallet.selectCode(a);dzeColorPallet.showCrossColorSelector("white")}},
downPosition:"",subColorUp:function(){},checkHexCode:function(a){if("undefined"==typeof a||null==a||""==a)return"";a=a.replace(/[^0-9a-fA-F]/gi,"");a=a.substring(0,6);return a=a.toUpperCase()},selectCode:function(a){dlog("====== selectCode START ===htmlCode ==="+a);a=this.checkHexCode(a);if(6==a.length){dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=a.toUpperCase();var b=this.getHexToDec(a);dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value=b.R_val;dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value=
b.G_val;dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value=b.B_val;b=this.rgbToHsl(b.R_val,b.G_val,b.B_val);dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value=b[0];dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value=b[1];dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value=b[2];this.viewNewColor(a);dlog("====== selectCode END ======");dlog("")}},modifyHexCode:function(a){dzeColorPallet.showCrossColorSelector("white");var b=this.checkHexCode(a.value);
a.value=b;6>b.length||(this.selectCode(b),this.viewSubColor(b))},modifyRgbValue:function(a){dzeColorPallet.showCrossColorSelector("white");a.value=a.value.replace(/[^0-9]/g,"");if(""!=a.value){var b=parseInt(a.value,10);if(0>b)alert(ID_RES_DIALOG_ALERT_MIN_VALUE+"0"),a.value="";else if(255<b)alert(ID_RES_DIALOG_ALERT_MAX_VALUE+"255"),a.value="";else{b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value;var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value,c=
dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value;a=this.rgbToHsl(b,d,c);b=this.getDecToHex(b)+this.getDecToHex(d)+this.getDecToHex(c);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b.toUpperCase();dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value=a[0];dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value=a[1];dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value=a[2];this.viewNewColor(b);this.viewSubColor(b)}}},
modifyHslValue:function(a){dzeColorPallet.showCrossColorSelector("white");a.value=a.value.replace(/[^0-9]/g,"");if(""!=a.value){var b=parseInt(a.value,10);if(0>b)alert(ID_RES_DIALOG_ALERT_MIN_VALUE+"0"),a.value="";else if(360<b)alert(ID_RES_DIALOG_ALERT_MAX_VALUE+"360"),a.value="";else{a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_H_value").value;b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_S_value").value;var d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_L_value").value;
a=this.hsl2rgb(a,b,d);b=this.getDecToHex(a.r)+this.getDecToHex(a.g)+this.getDecToHex(a.b);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b.toUpperCase();dzeColorPallet.layerDoc.getElementById("dze_idx_color_R_value").value=a.r;dzeColorPallet.layerDoc.getElementById("dze_idx_color_G_value").value=a.g;dzeColorPallet.layerDoc.getElementById("dze_idx_color_B_value").value=a.b;this.viewNewColor(b);this.viewSubColor(b)}}},viewOrgColor:function(a){a=this.checkHexCode(a);6==a.length&&
(dzeColorPallet.layerDoc.getElementById("dze_idx_old_color").style.backgroundColor="#"+a,dzeColorPallet.layerDoc.getElementById("dze_idx_old_color").title="#"+a.toUpperCase())},viewNewColor:function(a){dlog("======  viewNewColor START ======");dlog("viewNewColor htmlCode : "+a);dzeColorPallet.layerDoc.getElementById("dze_idx_new_color").style.backgroundColor="#"+a;dzeColorPallet.layerDoc.getElementById("dze_idx_new_color").title="#"+a.toUpperCase();dlog("======  viewNewColor END ======");dlog("")},
getColorCode:function(a){"undefined"==typeof a&&(a="hex");"hex"!=a&&"rgb"!=a&&"hsl"!=a&&(a="hex");var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value;b=this.checkHexCode(b);dzeColorPallet.layerDoc.getElementById("dze_idx_color_value").value=b;if(6!=b.length)return"";this.addRecentColorSet(b);if("hex"==a)return"#"+b;if("rgb"==a)return a=this.getHexToDec(b),[a.R_val,a.G_val,a.B_val];if("hsl"==a)return a=this.getHexToDec(b),this.rgbToHsl(a.R_val,a.G_val,a.B_val)},getDecToHex:function(a){a=
parseInt(a,10);255<a&&(a=255);a=a.toString(16);1==a.length&&(a="0"+a);return a.toString()},getHexToDec:function(a){var b=parseInt(a.substring(0,2),16),d=parseInt(a.substring(2,4),16);a=parseInt(a.substring(4,6),16);return result={R_val:b,G_val:d,B_val:a}},rgbToHsl:function(a,b,d){a/=255;b/=255;d/=255;var c=Math.max(a,b,d),e=Math.min(a,b,d),g=(c+e)/2;if(c==e)var f=e=0;else{var h=c-e;e=.5<g?h/(2-c-e):h/(c+e);switch(c){case a:f=(b-d)/h;break;case b:f=2+(d-a)/h;break;case d:f=4+(a-b)/h}f*=60;0>f&&(f+=
360)}f=Math.round(f);e=Math.round(100*e);g=Math.round(100*g);return[f,e,g]},hsl2rgb:function(a,b,d){isFinite(a)||(a=0);isFinite(b)||(b=0);isFinite(d)||(d=0);a/=60;0>a&&(a=6- -a%6);a%=6;b=Math.max(0,Math.min(1,b/100));d=Math.max(0,Math.min(1,d/100));var c=(1-Math.abs(2*d-1))*b;var e=c*(1-Math.abs(a%2-1));1>a?(a=c,b=e,e=0):2>a?(a=e,b=c,e=0):3>a?(a=0,b=c):4>a?(a=0,b=e,e=c):5>a?(a=e,b=0,e=c):(a=c,b=0);d-=c/2;a=Math.round(255*(a+d));b=Math.round(255*(b+d));e=Math.round(255*(e+d));return{r:a,g:b,b:e}},
rgbToHexa:function(a){try{-1<a.indexOf("rgb")&&(a=a.split("(")[1].split(")")[0]);var b="";a.split(",").map(function(a){return 1*a}).forEach(function(a){b+=dzeColorPallet.getDecToHex(a)});return b}catch(d){dalert(d)}},colorSelectorImageMargin:9,showColorSelector:function(a){dlog("====== showColorSelector ======");var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").getBoundingClientRect(),d=a.clientX-b.left;a=a.clientY-b.top;d-=this.colorSelectorImageMargin;a-=this.colorSelectorImageMargin;
d<-this.colorSelectorImageMargin+1&&(d=-this.colorSelectorImageMargin+1);a<-this.colorSelectorImageMargin+1&&(a=-this.colorSelectorImageMargin+1);d>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetWidth-this.colorSelectorImageMargin-2&&(d=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetWidth-this.colorSelectorImageMargin-2);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetHeight-this.colorSelectorImageMargin-2&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table").offsetHeight-
this.colorSelectorImageMargin-2);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.left=d+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.top=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.display="block";dlog("selectorX:"+d);dlog("selectorY:"+a);dlog("")},getColorCodeFromSelector:function(){var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.left.replace(/px/gi,
""),10),b=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.top.replace(/px/gi,""),10);a=Math.floor(Math.floor(a+this.colorSelectorImageMargin)/this.color_pix);b=Math.floor(Math.floor(b+this.colorSelectorImageMargin)/this.color_pix);dlog("colNum:"+a);dlog("rowNum:"+b);dlog();b=this.colorset[b][a];dlog("htmlCode:"+b);return b},showCrossColorSelector:function(a){a="dze_color_pallet_table_selector_"+a;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").className=
a;dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_selector").style.display="block"},subColorSelectorImageMargin:6,showSubColorSelector:function(a){dlog("====== showSubColorSelector START ======");if("undefined"==typeof a)dlog("event nothing");else{var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").getBoundingClientRect();a=a.clientY-b.top;a-=this.subColorSelectorImageMargin;a<-this.subColorSelectorImageMargin+2&&(a=-this.subColorSelectorImageMargin+2);
a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").offsetHeight-this.subColorSelectorImageMargin-2&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub").offsetHeight-this.subColorSelectorImageMargin-2);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.top=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.display="block";dlog("====== showSubColorSelector END ======");dlog("")}},
getSubColorCodeFromSelector:function(){var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_sub_selector").style.top.replace(/px/gi,""),10);dlog("getSubColorCodeFromSelector");dlog("selectorY:"+a);a=Math.floor(Math.floor(a+7)/this.subColorPix);dlog("rowNum:"+a);a=this.subColorSet[a];dlog("htmlCode:"+a);return a},achromaticSelectorImageMargin:4,showAchromaticSelector:function(a){dlog("====== showAchromaticSelector START ======");if("undefined"!=typeof a){var b=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").getBoundingClientRect();
a=a.clientX-b.left;a-=this.achromaticSelectorImageMargin;0>a&&(a=0);a>dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").offsetWidth-2*this.achromaticSelectorImageMargin&&(a=dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic").offsetWidth-2*this.achromaticSelectorImageMargin);dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.left=a+"px";dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.display=
"block";dlog("====== showAchromaticSelector END ======");dlog("")}},getAchromaticColorCodeFromSelector:function(){dlog("getAchromaticColorCodeFromSelector START");var a=parseInt(dzeColorPallet.layerDoc.getElementById("dze_idx_color_pallet_table_achromatic_selector").style.left.replace(/px/gi,""),10);a=Math.floor(a+7);dlog("selectorCenterX:"+a);dlog("(selectorCenterX/4):"+a/4);a=Math.floor(a/this.achromaticColorPix);dlog();a=this.achromaticSet[a];dlog("htmlCode:"+a);dlog("getAchromaticColorCodeFromSelector END");
return a}};
var ID_TB_QUERY_STATUS_BUTTON=1,ID_TB_QUERY_STATUS_COMBOBOX=2,ID_TB_QUERY_STATUS_DROPDOWN=3,g_objEditSetContainer=[],g_TBContainer=[],g_TBContainerTool=[],g_TBButton=[],g_TBComboBox=[],g_TBComboBoxLabel=[],g_TBDropDown=[],g_bMouseDown_containerBottomResize=!1,g_nContainerBottomResize_EditNumber=null,g_nContainerBottomResize_Start_Y=null,g_nContainerBottomResize_Start_Height=null,g_arrForceCancelBubbleMouseDown=[];
function TBContainerEvent(a){TBCancelBubbleEvent(a);g_objLayerEventUtil.initHideDynamicLayer()}function initEditSetContainer(a,c){g_objEditSetContainer[c]=a}
function TBInitContainer(a){a&&(g_TBContainer[g_TBContainer.length]=a,a.onmouseover=TBCancelBubbleEvent,a.onmouseout=TBCancelBubbleEvent,a.onmouseup=TBCancelBubbleEvent,a.ondragstart=TBCancelBubbleEvent,a.onselectstart=TBCancelBubbleEvent,a.onselect=TBCancelBubbleEvent,a.onclick=TBContainerEvent,a.onmousedown=function(a){var b=a.target||a.srcElement,c=document.activeElement;if(!b||"INPUT"!==b.nodeName||b.hasAttribute("readonly"))c&&"INPUT"===c.nodeName&&c.blur(),TBCancelBubbleEvent(a)},window.attachEvent?
a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1))}function TBInitContainerTool(a){a&&(g_TBContainerTool[g_TBContainerTool.length]=a,window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1))}
function QueryStatusItem(a,c,b,d,e,f){this.element=c;this.element.command=a;this.button_type=b;this.command_id=d;this.support_type=e;this.support_control_type=f;this.element.command_id=d;return this}
function TBButtonMouseOver(a,c,b,d,e){try{e&&TBCancelBubbleEvent(a);var f=null;a=null;if(ID_TB_QUERY_STATUS_BUTTON==b)f=g_TBButton[d][c].element;else if(ID_TB_QUERY_STATUS_COMBOBOX==b)f=g_TBComboBox[d][c].element;else if(ID_TB_QUERY_STATUS_DROPDOWN==b)f=g_TBDropDown[d][c].element,a=g_TBDropDown[d][c].objSubElement;else return;f.TBSTATE!=ID_STRING_NAME_GRAY&&(f.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==
b?f.className=g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaUp+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaUp,a.className=g_strSkin_DropDown_AreaArrowUp):f.TBSTATE==ID_STRING_NAME_UNCHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon",a.onmouseover=function(a){f.TBSTATE!=ID_STRING_NAME_GRAY&&(!0===dzeUiConfig.bUseUiMode&&0<=this.className.indexOf("_ribbon")?(this.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon",f.className=g_strSkin_DropDown_Area+"_ribbon"):(this.className=g_strSkin_DropDown_AreaArrowOver,
f.className=g_strSkin_DropDown_Area),TBCancelBubbleEvent(a))}):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaOver:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver,a.className=g_strSkin_DropDown_AreaArrowOver,a.onmouseover=function(a){f.TBSTATE!=ID_STRING_NAME_GRAY&&(this.className=g_strSkin_DropDown_AreaArrowOver,f.className=g_strSkin_DropDown_Area,TBCancelBubbleEvent(a))}):!0===dzeUiConfig.bUseUiMode&&
"ribbon"==dze_menu_control.ui_mode&&0<=f.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver+"_ribbon",a.className=g_strSkin_DropDown_AreaArrowOver+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?f.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?f.className=g_strSkin_ComboBox_AreaOver:ID_TB_QUERY_STATUS_DROPDOWN==b&&(f.className=g_strSkin_DropDown_AreaOver,a.className=
g_strSkin_DropDown_AreaArrowOver))}catch(h){dalert(h)}}
function TBButtonMouseOut(a,c,b,d,e){try{e&&TBCancelBubbleEvent(a),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up+
"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==
b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon",e.className=g_strSkin_DropDown_AreaArrow+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area,e.className=g_strSkin_DropDown_AreaArrow))}catch(f){dalert(f)}}
function TBButtonMouseDown(a,c,b,d,e){try{e&&(a&&a.preventDefault(),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[d]=!0)),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Down+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaDown+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowDown+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Down:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaDown:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaDown,e.className=g_strSkin_DropDown_AreaArrowDown))}catch(f){dalert(f)}}
function TBButtonMouseUp(a,c,b,d,e){try{e&&(TBCancelBubbleEvent(a),g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[d]=!1)),e=a=null,ID_TB_QUERY_STATUS_BUTTON==b?a=g_TBButton[d][c].element:ID_TB_QUERY_STATUS_COMBOBOX==b?a=g_TBComboBox[d][c].element:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a=g_TBDropDown[d][c].element,e=g_TBDropDown[d][c].objSubElement),a.TBSTATE!=ID_STRING_NAME_GRAY&&(a.TBSTATE==ID_STRING_NAME_CHECKED?!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b&&(a.className=g_strSkin_Button_Up+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp,e.className=g_strSkin_DropDown_AreaArrowUp):!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Over+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==
b&&(a.className=g_strSkin_DropDown_AreaOver+"_ribbon",e.className=g_strSkin_DropDown_AreaArrowUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Over:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaOver,e.className=g_strSkin_DropDown_AreaArrowUp))}catch(f){dalert(f)}}
function TBInitButton(a,c,b){try{var d=g_arrConst[a][0],e=document.getElementById(g_arrConst[a][2]+"_"+b);if(null!=e){var f=g_arrConst[a][3],h=g_arrConst[a][4],k=g_arrConst[a][5],g=0;if(ID_TB_QUERY_STATUS_BUTTON==c)g_TBButton[b][g_TBButton[b].length]=new QueryStatusItem(d,e,c,a,h,k),g=g_TBButton[b].length-1,e.className=g_strSkin_Button;else if(ID_TB_QUERY_STATUS_COMBOBOX==c){g_TBComboBox[b][g_TBComboBox[b].length]=new QueryStatusItem(d,e,c,a,h,k);g=g_TBComboBox[b].length-1;e.className=g_strSkin_ComboBox_Area;
var l=e.id;g_TBComboBoxLabel[b][g_TBComboBoxLabel[b].length]=new QueryStatusItem("",document.getElementById(l+"_LABEL"),0,-1,-1,-1);g_objComboBoxWin.setupComboBoxLabel(g_TBComboBoxLabel[b][g_TBComboBoxLabel[b].length-1].element,a)}else ID_TB_QUERY_STATUS_DROPDOWN==c&&(g_TBDropDown[b][g_TBDropDown[b].length]=new QueryStatusItem(d,e,c,a,h,k),g=g_TBDropDown[b].length-1,e.className=g_strSkin_DropDown_Area,l=e.id,g_TBDropDown[b][g].objSubElement=document.getElementById(l+"_SUB"),g_TBDropDown[b][g].objSubElement.onclick=
function(a){e.TBSTATE!=ID_STRING_NAME_GRAY&&eval(f+"_Detail")(a,this,b)});e.onmouseover=function(a){TBButtonMouseOver(a,g,c,b,!0)};e.onmouseout=function(a){TBButtonMouseOut(a,g,c,b,!0)};e.onmousedown=function(a){TBButtonMouseDown(a,g,c,b,!0)};e.onmouseup=function(a){TBButtonMouseUp(a,g,c,b,!0)};e.ondragstart=TBCancelBubbleEvent;e.onselectstart=TBCancelBubbleEvent;e.onselect=TBCancelBubbleEvent;e.commandtype=ID_COMMAND_TYPE_TOOL;e.onclick=function(a){eval(f)(a,this,b);dzeWebSearch.hideWebSearchBtn()};
e.TBSTATE==ID_STRING_NAME_GRAY?g_objPropertyUtil.setFilterOpacityStyle(e,!0):e.TBSTATE=ID_STRING_NAME_UNCHECKED}}catch(m){dalert(m)}}
function TBSetState(a,c,b){try{if(null!=a)switch(inArray(a.command_id,updateHandlerUI.disableToolbarList)&&(c=ID_STRING_NAME_GRAY),c=c.toLowerCase(),a.className){case g_strSkin_Button:case g_strSkin_Button_Over:case g_strSkin_Button_Down:case g_strSkin_Button_Up:case g_strSkin_ComboBox_Area:case g_strSkin_ComboBox_AreaOver:case g_strSkin_ComboBox_AreaDown:case g_strSkin_ComboBox_AreaUp:case g_strSkin_DropDown_Area:case g_strSkin_DropDown_AreaOver:case g_strSkin_DropDown_AreaDown:case g_strSkin_DropDown_AreaUp:case g_strSkin_DropDown_Area+"_ribbon":case g_strSkin_DropDown_AreaOver+
"_ribbon":case g_strSkin_DropDown_AreaDown+"_ribbon":case g_strSkin_DropDown_AreaUp+"_ribbon":case g_strSkin_Button+"_ribbon":case g_strSkin_Button_Over+"_ribbon":case g_strSkin_Button_Down+"_ribbon":case g_strSkin_Button_Up+"_ribbon":if(c==ID_STRING_NAME_GRAY||c==ID_STRING_NAME_CHECKED||c==ID_STRING_NAME_UNCHECKED){var d=a.TBSTATE;c!=d&&(c==ID_STRING_NAME_CHECKED?(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=
g_strSkin_Button_Up+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button_Up:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_AreaUp:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_AreaUp),d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):c==ID_STRING_NAME_UNCHECKED?(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&0<=a.className.indexOf("_ribbon")?
ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area),d==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):c==ID_STRING_NAME_GRAY&&(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&
0<=a.className.indexOf("_ribbon")?ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button+"_ribbon":ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area+"_ribbon"):ID_TB_QUERY_STATUS_BUTTON==b?a.className=g_strSkin_Button:ID_TB_QUERY_STATUS_COMBOBOX==b?a.className=g_strSkin_ComboBox_Area:ID_TB_QUERY_STATUS_DROPDOWN==b&&(a.className=g_strSkin_DropDown_Area),g_objPropertyUtil.setFilterOpacityStyle(a,!0)),a.TBSTATE=c)}}}catch(e){dalert(e)}}
function TBSetToolButton(a,c){try{for(var b=0;b<a.length;b++){var d=a[b][0];if(ID_TYPE_TOOLBAR_HANDLE!=d&&ID_TYPE_TOOLBAR_SEPARATOR!=d&&ID_TYPE_TOOLBAR_SPACE!=d&&ID_TYPE_TOOLBAR_CAPTION!=d){var e=g_arrConst[d][6];TBInitButton(d,e,c);ID_TB_QUERY_STATUS_BUTTON==e?handlerUI.setCommandUpdateIndex(c,d,g_TBButton[c].length-1):ID_TB_QUERY_STATUS_COMBOBOX==e?handlerUI.setCommandUpdateIndex(c,d,g_TBComboBox[c].length-1):ID_TB_QUERY_STATUS_DROPDOWN==e&&handlerUI.setCommandUpdateIndex(c,d,g_TBDropDown[c].length-
1)}}}catch(f){}}function TBInitContainerBottomResize(a,c){try{g_bBottomResizeYN&&(window.attachEvent?a.attachEvent("onmousedown",function(a){onmousedown_containerBottomResize(a,c)}):a.addEventListener("mousedown",function(a){onmousedown_containerBottomResize(a,c)},!1))}catch(b){dalert(b)}}
function onmousedown_containerBottomResize(a,c){try{if(!g_bFullScreenMode&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_bBottomResizeYN)){g_objTransparentViewUtil.showTransparentView(!0,0);g_bMouseDown_containerBottomResize=!0;g_nContainerBottomResize_EditNumber=c;var b=g_objPositionUtil.getDocumentScrollPosition(!1).nScrollTop;g_nContainerBottomResize_Start_Y=a.clientY+b;g_nContainerBottomResize_Start_Height=g_arrEditorHeight[c];window.attachEvent?
(document.attachEvent("onmousemove",onmousemove_containerBottomResize),document.attachEvent("onmouseup",onmouseup_containerBottomResize)):(document.addEventListener("mousemove",onmousemove_containerBottomResize,!1),document.addEventListener("mouseup",onmouseup_containerBottomResize,!1))}}catch(d){window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",onmousemove_containerBottomResize,
!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1))}}
function onmousemove_containerBottomResize(a){try{if(!g_bFullScreenMode&&g_bBottomResizeYN&&g_bMouseDown_containerBottomResize){TBCancelBubbleEvent(a);var c=g_objPositionUtil.getDocumentScrollPosition(!1).nScrollTop;resizeEditor_Height(g_nContainerBottomResize_EditNumber,g_nContainerBottomResize_Start_Height+(a.clientY+c-g_nContainerBottomResize_Start_Y))}}catch(b){window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):
(document.removeEventListener("mousemove",onmousemove_containerBottomResize,!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1))}}
function onmouseup_containerBottomResize(a){try{!g_bFullScreenMode&&g_bBottomResizeYN&&g_bMouseDown_containerBottomResize&&(g_bMouseDown_containerBottomResize=!1,g_nContainerBottomResize_Start_Height=g_nContainerBottomResize_Start_Y=g_nContainerBottomResize_EditNumber=null,g_objTransparentViewUtil.showTransparentView(!1,null),window.detachEvent?(document.detachEvent("onmousemove",onmousemove_containerBottomResize),document.detachEvent("onmouseup",onmouseup_containerBottomResize)):(document.removeEventListener("mousemove",
onmousemove_containerBottomResize,!1),document.removeEventListener("mouseup",onmouseup_containerBottomResize,!1)))}catch(c){}}var bottomResizeBtnIntervals=null,resizeBodyStyleInfo=null;
function TBInitContainerBottomResizeBtn(a,c){try{if(dzeUiConfig.bCustomBottomResizeBtnYN&&dzeUiConfig.bCustomize_TabBar_Display){var b=a.childNodes[0],d=a.childNodes[1];d.onmouseover=function(){clearBottomResizeBtnIntervals()};d.onmousedown=function(a){(a?a:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(bottomResizeBtnIntervals=setInterval(function(){resizeBottomResizeGuideLine("increase",c)},7))};d.onmouseup=function(){clearBottomResizeBtnIntervals();var a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+
c);a&&(a=a.offsetHeight,removeBottomResizeGuideLineObj(c),a=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetHeight+a,resizeEditor_Height(c,a));g_objLayerKit.getLayerDocument().body.style.overflow="";null!=resizeBodyStyleInfo&&(g_objLayerKit.getLayerDocument().body.style.overflow=resizeBodyStyleInfo)};d.onmouseout=function(){clearBottomResizeBtnIntervals();removeBottomResizeGuideLineObj(c);g_objLayerKit.getLayerDocument().body.style.overflow="";null!=resizeBodyStyleInfo&&(g_objLayerKit.getLayerDocument().body.style.overflow=
resizeBodyStyleInfo)};b.onmouseover=function(){clearBottomResizeBtnIntervals()};b.onmousedown=function(a){(a?a:window.event).button==ID_EVENT_MOUSE_CLICK_LEFT_STANDARD&&(bottomResizeBtnIntervals=setInterval(function(){resizeBottomResizeGuideLine("decrease",c)},7))};b.onmouseup=function(){clearBottomResizeBtnIntervals();var a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c);if(a){var b=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));a=parseInt(a.style.top.replace(/px/,
""),10)-b.bottom;a=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetHeight+a;200>a&&(a=200);resizeEditor_Height(c,a);removeBottomResizeGuideLineObj(c)}};b.onmouseout=function(){clearBottomResizeBtnIntervals();removeBottomResizeGuideLineObj(c)}}}catch(e){dalert(e)}}function clearBottomResizeBtnIntervals(){try{bottomResizeBtnIntervals&&clearInterval(bottomResizeBtnIntervals),bottomResizeBtnIntervals=null}catch(a){dalert(a)}}
function resizeBottomResizeGuideLine(a,c){try{var b=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideValue_"+c),d=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+c),e=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));if(null==d){d=g_objLayerKit.getLayerDocument().createElement("div");d.id="dzeIdxBottomResizeGuideLine_"+c;d.className="dze_bottom_resize_guideline";d.style.width=document.getElementById("EDIT_SET_CONTAINER_"+c).offsetWidth-
2+"px";d.style.height="0px";g_objLayerKit.getLayerDocument().body.appendChild(d);d.style.left=e.left+"px";d.style.top=e.bottom+"px";var f=g_objPositionUtil.getActiveWinSize(),h=!1;g_objLayerKit.getLayerDocument().body.scrollHeight>f.view_window_height&&(h=!0);"increase"==a&&0==h&&(g_objLayerKit.getLayerDocument().body.style.overflow&&(resizeBodyStyleInfo=g_objLayerKit.getLayerDocument().body.style.overflow),g_objLayerKit.getLayerDocument().body.style.overflow="hidden");b=g_objLayerKit.getLayerDocument().createElement("div");
b.id="dzeIdxBottomResizeGuideValue_"+c;b.className="dze_bottom_resize_guidevalue";g_objLayerKit.getLayerDocument().body.appendChild(b);var k=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+c).parentNode.parentNode);b.style.left=k.left-b.offsetWidth+12+"px";b.style.top=k.top-23+"px"}if("increase"==a)d.style.height=d.offsetHeight+1+"px",b.style.color="blue",b.innerText="+"+d.style.height;else if("decrease"==a){d.style.borderWidth="1px 1px 0 1px";
d.style.height="0px";var g=parseInt(d.style.top.replace(/px/,""),10)-1,l=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+c));g<l.top+100&&(g=l.top+100);d.style.top=g+"px";e=g_objPositionUtil.getLayerNodeElementPosition(document.getElementById("EDIT_SET_CONTAINER_"+c));var m=parseInt(d.style.top.replace(/px/,""),10)-e.bottom;b.style.color="red";b.innerText=m+"px"}}catch(n){dalert(n)}}
function removeBottomResizeGuideLineObj(a){var c=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideLine_"+a);null!=c&&c.parentNode.removeChild(c);a=g_objLayerKit.getElementById("dzeIdxBottomResizeGuideValue_"+a);null!=a&&a.parentNode.removeChild(a)};
var ID_TB_TABMODE_PREVIEW=0,ID_TB_TABMODE_EDIT=1,ID_TB_TABMODE_SOURCE=2,g_bEditMode=[],g_TBTabMode=[];function QueryStatusTabModeItem(b,a,e){this.element=b;this.element.TBSTATE=a;this.nTabModeID=e;return this}function TBTabModeButtonMouseOver(b,a,e,d){try{d&&TBCancelBubbleEvent(b);var c=g_TBTabMode[e][a].element;c.TBSTATE!=ID_STRING_NAME_GRAY&&(c.className=c.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_AreaOver)}catch(f){}}
function TBTabModeButtonMouseOut(b,a,e,d){try{d&&TBCancelBubbleEvent(b);var c=g_TBTabMode[e][a].element;c.TBSTATE!=ID_STRING_NAME_GRAY&&(c.className=c.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area)}catch(f){}}
function TBTabModeButtonMouseDown(b,a,e,d){try{d&&TBCancelBubbleEvent(b);var c=g_TBTabMode[e][a].element;c.TBSTATE!=ID_STRING_NAME_GRAY&&(c.TBSTATE==ID_STRING_NAME_CHECKED?c.className=g_strSkin_TabMode_AreaUp:c.TBSTATE==ID_STRING_NAME_UNCHECKED?(c.className=g_strSkin_TabMode_AreaDown,g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer()):c.className=g_strSkin_TabMode_AreaDown)}catch(f){}}
function TBTabModeButtonMouseUp(b,a,e,d){try{d&&TBCancelBubbleEvent(b);var c=g_TBTabMode[e][a].element;c.TBSTATE!=ID_STRING_NAME_GRAY&&(c.className=c.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area)}catch(f){}}
function TBInitTabModeButton(b,a,e,d){try{g_TBTabMode[d][g_TBTabMode[d].length]=new QueryStatusTabModeItem(b,e,a);var c=g_TBTabMode[d].length-1;b.onmouseover=function(a){TBTabModeButtonMouseOver(a,c,d,!0)};b.onmouseout=function(a){TBTabModeButtonMouseOut(a,c,d,!0)};b.onmousedown=function(a){TBTabModeButtonMouseDown(a,c,d,!0)};b.onmouseup=function(a){TBTabModeButtonMouseUp(a,c,d,!0)};b.ondragstart=TBCancelBubbleEvent;b.onselectstart=TBCancelBubbleEvent;b.onselect=TBCancelBubbleEvent;var f=g_arrConst_TabMode[a][1];
b.onclick=function(b){eval(f)(b,this,a,d)};b.className=e==ID_STRING_NAME_CHECKED?g_strSkin_TabMode_AreaUp:g_strSkin_TabMode_Area;b.TBSTATE==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!0)}catch(g){}}
function TBTabModeSetState(b,a){try{switch(a=a.toLowerCase(),b.className){case g_strSkin_TabMode_Area:case g_strSkin_TabMode_AreaOver:case g_strSkin_TabMode_AreaDown:case g_strSkin_TabMode_AreaUp:if(a==ID_STRING_NAME_GRAY||a==ID_STRING_NAME_CHECKED||a==ID_STRING_NAME_UNCHECKED){var e=b.TBSTATE;a!=e&&(a==ID_STRING_NAME_CHECKED?(b.className=g_strSkin_TabMode_AreaUp,e==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_UNCHECKED?(b.className=g_strSkin_TabMode_Area,
e==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(b,!1)):a==ID_STRING_NAME_GRAY&&(b.className=g_strSkin_TabMode_Area,g_objPropertyUtil.setFilterOpacityStyle(b,!0)),b.TBSTATE=a)}}}catch(d){}}
function fnTool_TabMode(b,a,e,d){TBCancelBubbleEvent(b);if(ID_STRING_NAME_CHECKED!=a.TBSTATE){!0===dzeUiConfig.bApplyPasteStyleMode&&letterFunction.getInstance().changePasteStyleMode(!1);fnTool_TabMode_Main(e,d);try{g_bBrowserType_FF&&""!=g_strFocusEventFunction&&e==ID_TB_TABMODE_SOURCE&&eval(g_strFocusEventFunction+"("+d+", 0);")}catch(c){}}}
function fnTool_TabMode_Main(b,a){try{dlog("fnTool_TabMode_Main START");dlog("nTabModeID:"+b);dlog("nEditNumber:"+a);g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);for(var e=0;e<g_TBTabMode[a].length;e++)if(ID_TB_TABMODE_EDIT==g_TBTabMode[a][e].nTabModeID||ID_TB_TABMODE_SOURCE==g_TBTabMode[a][e].nTabModeID)b==g_TBTabMode[a][e].nTabModeID?(TBTabModeSetState(g_TBTabMode[a][e].element,ID_STRING_NAME_CHECKED),fnTool_ChangeMode(b,a,!1)):TBTabModeSetState(g_TBTabMode[a][e].element,ID_STRING_NAME_UNCHECKED)}catch(d){}}
function fnTool_ChangeMode(b,a,e){resetSelectionObjectInfo();if(b==ID_TB_TABMODE_EDIT){if(!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]||!g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE])return;g_bEditMode[a]=!0;g_objEditContainer[a].style.visibility="visible";g_objEditContainer[a].style.display="";if(g_bBrowserType_IE)g_objEditSourceContainer[a].style.visibility="hidden",g_objEditSourceContainer[a].style.display="none";else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditSourceContainer[a].style.position=
"absolute",g_objEditSourceContainer[a].style.left="-1000px",g_objEditSourceContainer[a].style.top="-1000px",g_objEditSourceContainer[a].style.width="0px",g_objEditSourceContainer[a].style.height="0px",g_objEditSourceContainer[a].style.visibility="hidden";!0===dzeUiConfig.bRemoveXSS&&(g_objEditObjectSource[a].value=removeXSS(g_objEditObjectSource[a].value));b=g_objEditorDocument[a].body.innerHTML;g_objEditObjectSource[a].value=getHTMLContentRemoveVideoControl(g_objEditObjectSource[a].value);var d=
g_objEditObjectSource[a].value;if(!e){var c=!0;if(!g_bSourceAreaScriptAllowYN){var f=d.toLowerCase().indexOf("<script",0);-1!=f&&(c=!1,fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b)}g_bSourceAreaIframeAllowYN||(f=d.toLowerCase().indexOf("<iframe",0),-1!=f&&(c=!1,fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b));c&&(g_objEditorDocument[a].body.innerHTML=g_objEditObjectSource[a].value)}if(g_bBrowserType_IE)e||(!g_bSourceAreaScriptAllowYN&&
0<g_objEditorDocument[a].scripts.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(d=g_objEditorDocument[a].getElementsByTagName("iframe"),0<d.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)),g_objEditWindow[a].focus()),g_objTagUtil.bFormTagSwitch=!1,g_objTagUtil.force_formTagSwitch(g_objEditorDocument[a].body,!1),editor_onselectionchange(a),g_objMenuWin.TBMenuSetStateAllEnable(!0,
a);else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)!g_bSourceAreaScriptAllowYN&&0<g_objEditorDocument[a].getElementsByTagName("script").length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_SCRIPT),g_objEditorDocument[a].body.innerHTML=b),g_bSourceAreaIframeAllowYN||(d=g_objEditorDocument[a].getElementsByTagName("iframe"),0<d.length&&(fnUserWarningMessage(ID_USER_WARNING_MSG_NO_IFRAME),g_objEditorDocument[a].body.innerHTML=b)),g_bBrowserType_FF?(window.setTimeout("setRestoreEditWinFF("+
a+")",100),g_objTagUtil.bFormTagSwitch=!1,g_objTagUtil.force_formTagSwitch(g_objEditorDocument[a].body,!1)):g_bBrowserType_WK?window.setTimeout("setEditModeFocus("+a+")",100):g_bBrowserType_OP&&window.setTimeout("setEditModeFocus("+a+")",100);tranAllAnchorHrefSharp(a);!1===g_bBrowserType_FF&&g_objEditMode.showBGImageForLockedCell(!0,a);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(a);g_objAdjustDoc.removeParaWithoutChild(a);g_objAdjustDoc.changeTableAlignToMarginStyle(a);g_objUndoRedo.registerInitialContentStack(a);
editor_onselectionchange(a);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&dze_menu_control.evtMouseUpShowDynamicMenu();g_objVideoControl.addAllVideoResizeEvent(a)}else if(b==ID_TB_TABMODE_SOURCE){if(!g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]||!g_arrTabBar[ID_DISPLAY_TABBAR_EDIT])return;g_objTableMiniMenu.showTableMiniMenu(!1);g_objPasteOptionMenu.remove(!1);insertSourceSelectionSyncChars(a);tranAllAnchorHrefSharp(a);g_bEditMode[a]=!1;g_objEditContainer[a].style.visibility="hidden";
g_objEditContainer[a].style.display="none";if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditSourceContainer[a].style.position="relative",g_objEditSourceContainer[a].style.left="",g_objEditSourceContainer[a].style.top="",g_objEditSourceContainer[a].style.width="",g_objEditSourceContainer[a].style.height="";g_objEditSourceContainer[a].style.visibility="visible";g_objEditSourceContainer[a].style.display="";disableAllControl(a);g_objMenuWin.TBMenuSetStateAllEnable(!1,a);g_bDocType_XHTML&&
(g_objEditObjectSource[a].style.height=g_arrEditorHeight[a]-g_nToolbarSetHeight-g_nTabBarSetHeight-g_nBottomResizeHeight-20+"px");!1===g_bBrowserType_FF&&g_objEditMode.showBGImageForLockedCell(!1,a);g_bContentPTagStyleApply&&setContentPTagStyleApply(a);g_bCheckImgSrcProperty&&checkImgSrcPropertyValueAndForceRemove(a);g_objAdjustDoc.adjustRemoveGarbageText(a);g_objOnefficeEditor.getObjNodeCleaner().processGarbageEmptyTag(g_objEditorDocument[a].body,!1,a);g_objAdjustDoc.adjustDuplicateGarbage_P_Node(a);
g_objAdjustDoc.remove_Br_Node_Inside_P_Node(a);g_objAdjustDoc.arrangeSpan(g_objEditorDocument[a].body);g_objTagUtil.updateCurFormTagAttr(a);b=removeZeroWidthSpace(g_objEditorDocument[a].body.innerHTML);!0===dzeUiConfig.bRemoveXSS&&(b=removeXSS(b));g_objEditorDocument[a].body.innerHTML=b;b=getHTMLContentCodeByXHTMLFormat(a);g_bSourceAreaIframeAllowYN&&setIFrameSrcBlankForTabMode(a);g_objEditObjectSource[a].value=b;g_objEditObjectSource[a].focus();syncSourceSelection(a)}try{e||""!=g_strTabModeEventFunction&&
eval(g_strTabModeEventFunction+"("+a+");")}catch(g){dalert(g)}}function changeViewModeForRulerBar(b){try{if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode){var a=document.getElementById("TB_MENU_RIBBON_CONTENT_4_"+b).getElementsByTagName("div").TB_VIEW_RULERBAR_0;a&&TBSetState(a,ID_STRING_NAME_GRAY,g_arrConst[ID_COMMAND_VIEW_RULERBAR][6])}}catch(e){}}
function setEditModeFocus(b){try{if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)g_objEditorDocument[b].body.focus(),editor_onselectionchange(b)}catch(a){dalert(a)}}
function fnTool_TabMode_Preview(b,a,e,d,c,f){if(!0===c&&!0===dzeUiConfig.bOfficeOnePageLongMode)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALERT_NOT_AVAILABLE_IN_ONEPAGE_MODE,2);else if(a="undefined"==typeof onefficeWE?!1:!0,g_nActiveEditNumber=d,TBCancelBubbleEvent(b),g_objTableFlag.ResetTableInfo(!1),!0===dzeUiConfig.bApplyPasteStyleMode&&letterFunction.getInstance().changePasteStyleMode(!1),""!=g_strPreviewCallFunction)eval(g_strPreviewCallFunction+";"),updateTableHandlerUI.updateTableUIHandler(d);
else{var g="";objOnefficeLoader.setEditorMode(EDITORMODE.VIEWER);if(objOnefficeLoader.isEditor())g=dzeEnvConfig.strPreviewPageURL;else{var h=getEditorHTMLCode(!1,d,!0,!0);b=a?g_onefficeWeTool.m_strHelp:0;!0===c?(c=-1,1==f&&(c=g_objPageControl.currentPage+1),f={bShowMode:1,previewOk:1,currentPage:c,help:b}):f={previewOk:1,help:b};g=oneffice.getViewModeDocPath(oneffice.currFileSeq,f);if(!g)return;var k=1200,l=800;window.screen&&window.screen.availWidth&&window.screen.availHeight&&(k=window.screen.availWidth,
l=window.screen.availHeight);if(!0===dzeUiConfig.bIndependentEdit){onefficeUtil.setSavedContent(h);oneffice.parentFileContent.content=h;document.location.href.split("?");d=document.location.href.split("?")[1];if("undefined"==typeof d)return;g=dzeEnvConfig.strViewModePageURL+"?"+d;"undefined"!=typeof f.bShowMode&&(g+="&bShowMode="+f.bShowMode);"undefined"!=typeof f.previewOk&&(g+="&previewOk="+f.previewOk);window.open(g,"","width="+k+",height="+l+",left=0,top=0,resizable=yes,scrollbars=yes");return}if(!0===
g_readonlyMode||onefficeUtil.checkSameContent(h))window.open(g,"","width="+k+",height="+l+",left=0,top=0,resizable=yes,scrollbars=yes");else{if(a){onefficeWE.setSaveType(SAVETYPE.HIDE);onefficeWE.saveFileProcess(h,function(){onefficeUtil.setSavedContent(h);window.open(g,"","width="+k+",height="+l+",left=900,top=0,resizable=yes,scrollbars=yes");g_onefficeWeTool.reqListSave(!0)},function(){onefficeWE.setSaveType(SAVETYPE.DEFAULT)});return}onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,
oneffice.currFileSubject,h,d,function(){onefficeUtil.setSavedContent(h);window.open(g,"","width="+k+",height="+l+",left=0,top=0,resizable=yes,scrollbars=yes")})}}updateTableHandlerUI.updateTableUIHandler(d);objOnefficeLoader.setEditorMode(EDITORMODE.EDITOR)}}
function getEditorPreviewHTML(b){try{var a="",e=objOnefficeLoader.getVer();g_bAutoIncludeParentCSS&&(a+=getParentCSS());for(var d=0;d<g_arrAdditionalEditAreaCSS.length;d++)a+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[d]+"'>";if(g_bAutoIncludeParentCSS){var c=g_strContentsCSS;c=getFullUrlFromPath(c);a+="<link rel='stylesheet' href='"+c+"'>";c=dzeEnvConfig.strPath_CSS+"editor_style_inherit.css?ver="+e}else c=dzeEnvConfig.strPath_CSS+"editor_style.css?ver="+e;c=getFullUrlFromPath(c);
a+="<link rel='stylesheet' href='"+c+"'>";var f=dzeUiConfig.nSettingPaperMargin.top+"mm "+dzeUiConfig.nSettingPaperMargin.right+"mm "+dzeUiConfig.nSettingPaperMargin.bottom+"mm "+dzeUiConfig.nSettingPaperMargin.left+"mm";a+="<style type='text/css' media='print'>";a+="@page{ size:auto; margin : "+f+"; }";a+="</style>";a+="<style>";""!=g_strBodyFontFamily&&(a+="body,td,p{font-family:"+g_strBodyFontFamily+"}");""!=g_strBodyFontSize&&(a+="body,td,p{font-size:"+g_strBodyFontSize+"}");""!=g_strBodyLineHeight&&
(a+="body{line-height:"+g_strBodyLineHeight+"}");""!=g_strBodyLetterSpacing&&(a+="body{letter-spacing:"+g_strBodyLetterSpacing+"}");a+="</style>";a+=getEditorHTMLCode(!1,b);a=removeEditorTempTagsFromStrHtml(a);return a=a.replace(/\b\b/g,"")}catch(g){}return""}function getEditorTagCount_script(b){try{return window.attachEvent?g_objEditorDocument[b].scripts.length:g_objEditorDocument[b].getElementsByTagName("script").length}catch(a){}return-1}
function getEditorTagCount_iframe(b){try{return g_objEditorDocument[b].getElementsByTagName("iframe").length}catch(a){}return-1};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(c){var b=0;return function(){return b<c.length?{done:!1,value:c[b++]}:{done:!0}}};$jscomp.arrayIterator=function(c){return{next:$jscomp.arrayIteratorImpl(c)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,b,a){c!=Array.prototype&&c!=Object.prototype&&(c[b]=a.value)};$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(c,b){this.$jscomp$symbol$id_=c;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function c(a){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(a||"")+"_"+b++,a)}var b=0;return c}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.iterator;c||(c=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[c]&&$jscomp.defineProperty(Array.prototype,c,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var c=$jscomp.global.Symbol.asyncIterator;c||(c=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(c){$jscomp.initSymbolIterator();c={next:c};c[$jscomp.global.Symbol.iterator]=function(){return this};return c};
$jscomp.iteratorFromArray=function(c,b){$jscomp.initSymbolIterator();c instanceof String&&(c+="");var a=0,d={next:function(){if(a<c.length){var e=a++;return{value:b(e,c[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(c,b,a,d){if(b){a=$jscomp.global;c=c.split(".");for(d=0;d<c.length-1;d++){var e=c[d];e in a||(a[e]={});a=a[e]}c=c[c.length-1];d=a[c];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(c){return c?c:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
function initCommand(){if(dzeUiConfig.bOfficePagingMode&&dzeUiConfig.bUseHeaderFooter){var c=function(b){try{var a=Array.prototype.slice.call(arguments,1);g_objHeaderFooter.getHeaderFooterEditMode()?(HeaderFooter.prototype.bHeaderFooterEditMode=!1,g_objHeaderFooter.propagateHeaderFooter(-1,null,null,!0),HeaderFooter.prototype.bHeaderFooterEditMode=!0,g_objPageControl.onSetDelayedUpdatePageTimerAll(0,function(){b.apply(this,a)})):b.apply(this,a)}catch(d){dalert(d)}};wrap(this,"fnTool_TabMode_Preview",
c);wrap(this,"fnHandler_slideShow",c);wrap(this,"fnHandler_SaveFileRemote",c);wrap(this,"fnHandler_downloadPdf",c);wrap(this,"fnHandler_Print",c)}}function fnHandler_dummy(c,b,a){}
function fnHandler_CommonCheck_DynamicLayer_1(c,b,a){try{TBCancelBubbleEvent(c);if(b&&b.TBSTATE==ID_STRING_NAME_GRAY)return!1;if(b&&ID_COMMAND_TYPE_TOOL==b.commandtype){if(g_bDynamicLayer){var d=g_objContextMenuWin.isShow();g_objLayerEventUtil.initHideDynamicLayer();if(!d)return!1}}else g_objLayerEventUtil.initHideDynamicLayer();return!0}catch(e){}return!1}
function fnHandler_SupportCommand(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var e="context"===d?g_objContextMenuWin.objContextInfo:null,f=b.command;f&&(f=f.toLowerCase());"copy"!==f&&"cut"!==f||pageManager.getInstance().initValues();if("selectall"==f)ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype?GetCurTable(a)&&(g_objTableSelection.selectTable(a),editor_onselectionchange(a)):g_objPageControl.selectAllPage(a,!0)?editor_onselectionchange(a):fnHandler_SupportCommand_Main(a,
f);else if("copy"==f)fnHandler_SupportCommand_Main(a,b.command);else if("cut"==f)fnHandler_SupportCommand_Main(a,b.command,!1);else if("delete"==f)if(e&&e.objDelete&&("DIV"===e.objDelete.nodeName||"PRE"===e.objDelete.nodeName)){var g=e.objDelete;if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(g);g_objCaretUtil.saveCaret(a);for(var h=g_objSplitUtil.getSplitNodes(g),k=h.length-1;0<=k;k--)g_objNodeUtil.removeElementNotChild(h[k]);g_objCaretUtil.restoreCaret(a);g_objUndoRedo.registerUndoRedoStack(0,
a)}else fnHandler_SupportCommand_Main(a,b.command);else fnHandler_SupportCommand_Main(a,b.command)}}catch(l){dalert(l)}}
function fnHandler_SupportCommand_Main(c,b,a,d,e){try{if(""!==b){a="undefined"===typeof a?!0:a;var f=b.toLowerCase(),g=d=!1,h=0;switch(f){case "copy":0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?g_objShapeFunction.doCopyCutShapes(g_objSelectedShapesArray,!1):GetMultiCellSelection(c)?d=dzeClipBoard.copySelectedMultiCells(c):(g_objCopyPaste.onCopyBefore(),g=!0);break;case "cut":0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?g_objShapeFunction.doCopyCutShapes(g_objSelectedShapesArray,
!0):GetMultiCellSelection(c)?d=dzeClipBoard.cutSelectedMultiCells(c):(g_objCopyPaste.onCutBefore(),g=!0);break;case "paste":g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP?alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteClick(c)&&(g=!0);break;case "selectall":GetMultiCellSelection(c)&&g_objTableSelection.table_selectAll(GetCurTable(c),c);break;case "delete":0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?(g_objShapeFunction.onDeleteShape(),
d=!0):GetMultiCellSelection(c)?d=g_objTableOperation.deleteSelectedCell(c,GetCurTable(c),!1):SelectionUtil.isDeleteDirectly(c)?d=SelectionUtil.deleteSelection(c):(checkSetIFrameSrcBlankForDelete(c),g=!0);break;case "inserthorizontalrule":g=!0;break;case "bold":h=DZE_LETTER_COMMAND_BOLD;break;case "italic":h=DZE_LETTER_COMMAND_ITALIC;break;case "underline":h=DZE_LETTER_COMMAND_UNDERLINE;break;case "strikethrough":h=DZE_LETTER_COMMAND_STRIKE;break;case "superscript":h=DZE_LETTER_COMMAND_SUPERSCRIPT;
break;case "subscript":h=DZE_LETTER_COMMAND_SUBSCRIPT;break;case "none":case "insertunorderedlist":case "insertorderedlist":case "disc":case "decimal":case "upper-alpha":case "lower-alpha":case "upper-roman":case "circle":case "square":case "unlink":g=!1;break;default:g=!0}if(!0===g){var k=g_objPageControl.getPageMain(g_objPageControl.currentPage),l=k.getAttribute("contenteditable");"false"===l&&k.setAttribute("contenteditable",!0);GetMultiCellSelection(c)&&"unlink"!==f?d=g_objTableMultiCell.setMultiCellCommand_ExecCommand(b,
c):g_objEditorDocument[c].execCommand(b,!1,null);"false"===l&&k.setAttribute("contenteditable",!1);"copy"!==f&&(d=!0);"delete"===f&&g_objWrapperOutlineResize.resetExtOutlineInfo()}else switch(f){case "bold":case "italic":case "underline":case "strikethrough":case "superscript":case "subscript":d=letterFunction.getInstance().setSentenceStyle(h,f,0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer());break;case "insertorderedlist":d=toggleOL(c);break;case "insertunorderedlist":d=
toggleUL(c);break;case "none":d=removeOLUL(c);break;case "disc":case "circle":case "square":d=insertUL(c,f);break;case "decimal":case "upper-alpha":case "lower-alpha":case "upper-roman":d=insertOL(c,f);break;case "unlink":d=g_objALinkMgr.removeLink(c)}editor_onselectionchange(c);if(!1===fnObjectCheckNull(e)&&"function"===typeof e)e(d);else if(!0===d)if(GetMultiCellSelection(c))commonUpdateAfterChange(c,GetCurTable(c),{bUndoRedo:a});else if(!0===a&&g_objUndoRedo.registerUndoRedoStack(0,c),dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()}}catch(m){"copy"!==
f&&"cut"!==f&&"paste"!==f||fnUserMessage(b.toLowerCase())}}
function fnHandler_SupportCommand_StyleCopyPaste(c,b,a,d){try{if(""===b)return!1;d="undefined"===typeof d?!1:d;var e=b.toLowerCase();b=0;switch(e){case "bold":b=DZE_LETTER_COMMAND_BOLD;break;case "italic":b=DZE_LETTER_COMMAND_ITALIC;break;case "underline":b=DZE_LETTER_COMMAND_UNDERLINE;break;case "strikethrough":b=DZE_LETTER_COMMAND_STRIKE;break;case "superscript":b=DZE_LETTER_COMMAND_SUPERSCRIPT;break;case "subscript":b=DZE_LETTER_COMMAND_SUBSCRIPT}var f=letterFunction.getInstance().setSentenceStyleCopyPaste(b,
e,d);editor_onselectionchange(c);return f}catch(g){dalert(g)}}
function fnHandler_Align(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command,e=b.command_id;c=!1;ID_STRING_NAME_CHECKED==b.TBSTATE&&(c=!0);if(ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype){var f=GetCurTable(a);if(!f)return;b="";if(!c)if(e==ID_COMMAND_JUSTIFY_LEFT)b="left";else if(e==ID_COMMAND_JUSTIFY_CENTER)b="center";else if(e==ID_COMMAND_JUSTIFY_RIGHT)b="right";else if(e==ID_COMMAND_JUSTIFY_JUSTIFY)c=!0;else return;g_objTableUtil.setAlignTableByStyleProperty(f,
b,c)}else fnHandler_Align_Main(a,d,c,e),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a);GetCurTable(a)?commonUpdateAfterChange(a,GetCurTable(a)):g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(g){dalert(g)}}
function fnHandler_Align_Main(c,b,a,d){dlog("strExecCommand:"+b);dlog("bAlignRemove:"+a);dlog("nCommandID:"+d);try{var e=GetCurTable(c);g_objTableSelection.isTableSelected(e)||(b="",a?b="":d==ID_COMMAND_JUSTIFY_LEFT?b="left":d==ID_COMMAND_JUSTIFY_CENTER?b="center":d==ID_COMMAND_JUSTIFY_RIGHT?b="right":d==ID_COMMAND_JUSTIFY_JUSTIFY&&(b="justify"),g_objLetterFn.setParaStyle(c,{textAlign:b}));g_objTableUtil.setAlignTable(d,a,c);editor_onselectionchange(c)}catch(f){}}
function fnHandler_Undo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objUndoRedo.operateUndoRedoStack(!0,!1,a)}catch(d){dalert(d)}}function fnHandler_Redo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objUndoRedo.operateUndoRedoStack(!1,!1,a)}catch(d){dalert(d)}}
function fnHandler_TableAddRowDown(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_AddTableRow(d,!1)&&commonUpdateAfterChange(a,d)}}catch(e){}}function fnHandler_TableAddRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_AddTableRow(d,!0)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableCopyRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_AddTableRow(d,!1,!0)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableDeleteRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=g_objTableOperation,e=GetCurTable(a),f=d.deleteTableRow(e,a);f===d.RET_DELETE_TABLE?fnHandler_TableDelete(c,b,a):f&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),commonUpdateAfterChange(a,e))}}catch(g){}}
function fnHandler_TableAddCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_AddTableCol(d,!0)&&commonUpdateAfterChange(a,d)}}catch(e){}}function fnHandler_TableAddColRight(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_AddTableCol(d,!1)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableDeleteCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=g_objTableOperation,e=GetCurTable(a),f=d.deleteTableCol(e,a);f===d.RET_DELETE_TABLE?fnHandler_TableDelete(c,b,a):f&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),commonUpdateAfterChange(a,e))}}catch(g){}}
function fnHandler_TableMergeCell(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_MergeTableCell(d,a)&&commonUpdateAfterChange(a,d)}}catch(e){}}function fnHandler_TableSplitRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_SplitTableRow(a,d,2)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableSplitCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_SplitTableCol(a,d,2)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableSplitCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_SPLIT_CELL,g_objPropTagTableSplitCell.buildTagTableSplitCell(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableSplitCell.getPropSettingData();b=GetCurTable(a);var c=g_objPropTagTableSplitCell.nSplitCount;g_objPropTagTableSplitCell.bSplitRow?g_objTableOperation.table_SplitTableRow(a,
b,c):g_objTableOperation.table_SplitTableCol(a,b,c);commonUpdateAfterChange(a,b)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagTableSplitCell.initPropTagTableSplitCell()},function(){},!0,"screen_center")}catch(d){}}
function fnHandler_TableAddRowCol(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_ADD_ROW_COL,g_objPropTagTableAddRowCol.buildTagTableAddRowCol(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();var c=g_objPropTagTableAddRowCol;b=g_objTableOperation;c.getPropSettingData();var d=c.nAddCount,g=c.nAddDirection,h=c.bAddRow;c=GetCurTable(a);if(h)for(h=0;h<d;h++)b.table_AddTableRow(c,
0==g?!0:!1);else for(h=0;h<d;h++)b.table_AddTableCol(c,0==g?!0:!1);commonUpdateAfterChange(a,c)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagTableAddRowCol.initPropTagTableAddRowCol()},function(){},!0,"center")}catch(d){}}
function fnHandler_TableCellProperty(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_PROPERTY,duzon_dialog.getTabContents(1,[ID_RES_DIALOG_TAB_GENERAL],[g_objPropTagTableCell.buildTagTableCell()],[60],g_objPropTagTableCell.buildTagTableCellCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();g_objPropTagTableCell.applyPropTagTableCell();commonUpdateAfterChange(a,
GetCurTable(a))},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCell.initPropTagTableCell(GetCurTable(a),a)},function(){},!0)}catch(d){}}
function fnHandler_TableCellStyle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_CELL_STYLE,duzon_dialog.getTabContents(2,[ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND],[g_objPropTagTableCellStyle.buildTagTableCellStyle_Border(),g_objPropTagTableCellStyle.buildTagTableCellStyle_Background()],[60,60],g_objPropTagTableCellStyle.buildTagTableCellStyleCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
[function(b){duzon_dialog.closeDialog();b=g_objPropTagTableCellStyle.getPropSettingData();if(null!=b){var c=GetCurTable(a);if(c&&b[ID_PROP_NODE_GENERAL]&&null!==b[ID_PROP_NODE_GENERAL][9]){var d=b[ID_PROP_NODE_GENERAL][9];g_objTableSelection.doAllTable(function(a){g_objTableUtil.setTableBorderCollapse(a,d)},c)}g_objTableFunction.setSelectedCellAttribute(b,c);commonUpdateAfterChange(a,c)}},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTableCellStyle.initPropTagTableCellStyle(GetCurTable(a),
a)},function(){},!0)}catch(d){}}function fnHandler_table_lock_edit_cell(c,b,a){try{!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode&&(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objTableFunction.setLockEditCell(GetCurTable(a),a))}catch(d){dalert(d)}}
function fnHandler_TableProperty(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_PROPERTY,function(){var a=g_objTableUtil.isProtect();return duzon_dialog.getTabContents(4,[ID_RES_DIALOG_TAB_GENERAL,ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND,ID_RES_CONST_STRING_TABLE_MADANG],[g_objPropTagTable.buildTagTable_General(),g_objPropTagTable.buildTagTable_Border(),g_objPropTagTable.buildTagTable_Background(),
g_objPropTagTable.buildTagTable_Madang()],[60,a?0:60,a?0:60,a?0:60],g_objPropTagTable.buildTagTableCommon())}(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();var c=g_objPropTagTable.getPropSettingData();null!=c&&(b=GetCurTable(a),g_objTableSelection.doAllTable(function(b){g_objTableFunction.setTableAttribute(c,b.ownerDocument,b,a)},b),commonUpdateAfterChange(a,b))},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);g_objPropTagTable.initPropTagTable(GetCurTable(a),
a);if("undefined"!==typeof TableStyleDlg)TableStyleDlg.onLoad(document.querySelector("div.dze_table_style_container"))},function(){},!0)}catch(d){}}
function fnHandler_InsertTextBox(c,b,a){try{!1!==dzeUiConfig.bUseShapesFeature&&(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!1!==g_bEditMode[a]&&(g_objShapeFunction.onDeselectAllShapes(),g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objTableFlag.ResetTableInfo(!1),g_objTableMiniMenu.showTableMiniMenu(!1,null,a),g_objCaretUtil.saveCaret(g_objPageControl.nEditNumber,"insert_shape_position"),g_objShapeEvtMgr.setInsertMode(SHAPE_TYPE.SQUARE_TEXTBOX)))}catch(d){dalert(d)}}
function fnHandler_TableCreate(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))if(g_objWrapperOutlineResize.resetExtOutlineInfo(),g_objShapeFunction.onDeselectAllShapes(!0),"undefined"!==typeof d&&d.bCreateSimple)fnSub_TableCreateSimple_Menu_Command(c,a);else if(b&&ID_COMMAND_TYPE_MENU==b.commandtype)fnSub_TableCreate_Menu_Command(c,a);else{var e=document.getElementById(b.id.replace(/_SUB/,""));e.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(e,ID_STRING_NAME_CHECKED,
ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_CREATE,duzon_dialog.viewExtendsDlg(b,a,null,[ID_RES_CONST_STRING_TABLE_CREATE],[function(){fnSub_TableCreate_Menu_Command(c,a)}]))}}catch(f){dalert(f)}}function fnHandler_TableCreate_Detail(c,b,a){try{fnHandler_TableCreate(c,b,a)}catch(d){}}
function fnSub_TableCreate_Menu_Command(c,b){try{duzon_dialog.dialogExtStatus&&duzon_dialog.closeExtendsDlg(),duzon_dialog.viewDialog(c,b,ID_RES_CONST_STRING_TABLE_CREATE,duzon_dialog.getTabContents(4,[ID_RES_DIALOG_TAB_GENERAL,ID_RES_DIALOG_TAB_BORDER,ID_RES_DIALOG_TAB_BACKGROUND,ID_RES_CONST_STRING_TABLE_MADANG],[g_objPropTagTableCreate.buildTagTableCreate_General(),g_objPropTagTableCreate.buildTagTableCreate_Border(),g_objPropTagTableCreate.buildTagTableCreate_Background(),g_objPropTagTableCreate.buildTagTableCreate_Madang()],
[60,60,60,60],g_objPropTagTableCreate.buildTagTableCreateCommon()),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.closeDialog();a=g_objPropTagTableCreate.getPropSettingData();null!=a&&(g_objTableFlag.ResetTableInfo(!1),a=g_objTableFunction.createTable(a,b))&&(g_objCaretUtil.moveCaret(a),commonUpdateAfterChange(b,a))},function(a){duzon_dialog.closeDialog()}],function(){if("undefined"!==typeof TableStyleDlg)TableStyleDlg.onLoad(document.querySelector("div.dze_table_style_container"));
duzon_dialog.viewTabContents(0);g_objPropTagTableCreate.initPropTagTableCreate()},function(){},!0,"screen_center")}catch(a){}}
function fnSub_TableCreateSimple_Menu_Command(c,b){try{duzon_dialog.viewDialog(c,b,ID_RES_CONST_STRING_TABLE_CREATE,g_objPropTagCommon.buildTagTable_TableRowColCount(280,120),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.closeDialog();a=g_objPropTagTableCreate.getPropSettingDataSimple();null!=a&&(g_objTableFlag.ResetTableInfo(!1),a=g_objTableFunction.createTable(a,b))&&(g_objCaretUtil.moveCaret(a),commonUpdateAfterChange(b,a))},function(a){duzon_dialog.closeDialog()}],
function(){g_objPropTagTableCreate.initPropTagTableCreateSimple()},function(){},!0,"screen_center")}catch(a){}}
function fnHandler_TableDelete(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d||(d=g_objTableMiniMenu.objTableNode);if(!d||!d.parentNode)return!1;if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(d);g_objTableOperation.deleteTable(d);updateTableHandlerUI.updateTableUIHandler(a);duzon_dialog.closeExtendsDlg();g_objTableFlag.ResetTableInfo(!1);g_objWrapperOutlineResize.resetExtOutlineInfo();g_objTableMiniMenu.showTableMiniMenu(!1,
null,a);editor_onselectionchange(a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){dalert(e)}}function fnHandler_TableCellSameHeight(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_TableCellSameHeight(d,a)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_TableCellSameWidth(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);g_objTableOperation.table_TableCellSameWidth(d,a)&&commonUpdateAfterChange(a,d)}}catch(e){}}
function fnHandler_execTableCellAlign(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d="left_top center_top right_top left_middle center_middle right_middle left_bottom center_bottom right_bottom".split(" ")[b.command_id-155].split("_"),e=d[0],f=d[1],g=GetCurTable(a);g_objTableOperation.table_TableCellAlign(g,e,f)&&commonUpdateAfterChange(a,g)}}catch(h){}}
function fnHandler_TableCellAlign(c,b,a){try{fnHandler_TableCellAlign_Detail(c,b,a)}catch(d){}}function fnHandler_TableCellAlign_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_CELL_ALIGN,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TableCellHorizontalLeft(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellHorizontalAlign(d,"left")}}catch(e){}}function fnHandler_TableCellHorizontalCenter(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellHorizontalAlign(d,"center")}}catch(e){}}
function fnHandler_TableCellHorizontalRight(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellHorizontalAlign(d,"right")}}catch(e){}}function fnHandler_TableCellVerticalTop(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellVerticalAlign(d,"top")}}catch(e){}}
function fnHandler_TableCellVerticalMiddle(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellVerticalAlign(d,"middle")}}catch(e){}}function fnHandler_TableCellVerticalBottom(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);d&&g_objTableOperation.table_TableCellVerticalAlign(d,"bottom")}}catch(e){}}
function fnHandler_TableHorizontalSum(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_SUM)}function fnHandler_TableVerticalSum(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_SUM)}function fnHandler_TableHorizontalAverage(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_AVERAGE)}
function fnHandler_TableVerticalAverage(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_AVERAGE)}function fnHandler_TableHorizontalMultiply(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.HORIZONTAL,g_objTableOperation.FORMULA_MULTIPLY)}function fnHandler_TableVerticalMultiply(c,b,a){fnHandler_TableFormula(c,b,a,DZE_DIR.VERTICAL,g_objTableOperation.FORMULA_MULTIPLY)}
function fnHandler_TableFormula(c,b,a,d,e){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var f=GetCurTable(a);g_objTableOperation.table_TableFormula(f,d,e,a)&&commonUpdateAfterChange(a,f)}}catch(g){}}
function fnHandler_TableSelectFormula(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_TABLE_SELECT_FORMULA,g_objPropTagTableSelectFormula.buildTagTableSelectFormula(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();b=GetCurTable(a);g_objPropTagTableSelectFormula.setFormulaResultValue();commonUpdateAfterChange(a,b)},function(a){duzon_dialog.closeDialog()}],function(){var b=
GetCurTableInfo(a);b&&g_objPropTagTableSelectFormula.initPropTagTableSelectFormula(b.table,b.cell.parentNode.rowIndex,b.cell.cellIndex,a)},function(){g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1)},!0,"center")}catch(d){}}
function fnHandler_HyperLinkInsert(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=HyperlinkDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_HYPERLINK_INSERT,d.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){if(!0===d.inputHyperLink()&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),!0===dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()},function(a){duzon_dialog.closeDialog()}],
function(){d.onLoad()},function(){},!0)}}catch(e){}}function fnHandler_FontName(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objUndoRedo.registerUndoRedoStack(0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(0,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_FontSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objUndoRedo.registerUndoRedoStack(0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(1,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_HeadingSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(2,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){dalert(d)}}
function fnHandler_HeadingSizeExt(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype?fnHandler_StyleHeadingSize(c,b,a):(cmnDlg.isShowDlg()&&duzon_dialog.closeDialog(),duzon_dialog.dialogExtStatus&&duzon_dialog.closeExtendsDlg(),g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(2,a,
b),g_bDynamicLayer=!0,setWindowResizeEvent(!0)))}catch(d){dalert(d)}}function fnHandler_HeadingSizeExt_Detail(c,b,a){try{var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_HeadingSizeExt(c,d,a)}catch(e){dalert(e)}}
function fnHandler_Outdent(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){c=!1;if(b&&ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype||g_objTableSelection.isTableSelected(GetCurTable(a))){var d=GetCurTable(a);if(!d)return;c=!0;g_objTableUtil.getSplitTables(d).forEach(function(a){g_objTableUtil.setTable_Outdent_Indent(a,!0)});g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,
a)}else{var e=g_objNodeUtil.createRangeWalker(GetCurRange(a),NodeFilter.SHOW_ELEMENT,function(a){return"P"===a.nodeName||"LI"===a.nodeName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});d=b=!1;var f=e.firstChild();if(!f&&!g&&GetCurListItem(a)){c=applyListStyleDepth("increase",a,!1);return}for(;f;){var g=e.nextNode();"LI"===f.nodeName&&(d=!0);"P"===f.nodeName&&(b=!0);f=g}c=!b&&d?applyListStyleDepth("increase",a,!1):g_objLetterFn.setParaStyle(a,{outdent:!0})}if(!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,
a),editor_onselectionchange(a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}}catch(h){dalert(h)}}
function fnHandler_Indent(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){c=!1;if(b&&ID_COMMAND_TYPE_CONTEXT_MENU==b.commandtype||g_objTableSelection.isTableSelected(GetCurTable(a))){var d=GetCurTable(a);if(!d)return;c=!0;g_objTableUtil.getSplitTables(d).forEach(function(a){g_objTableUtil.setTable_Outdent_Indent(a,!1)});g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,
a)}else{var e=g_objNodeUtil.createRangeWalker(GetCurRange(a),NodeFilter.SHOW_ELEMENT,function(a){return"P"===a.nodeName||"LI"===a.nodeName?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});d=b=!1;var f=e.firstChild();if(!f&&!g&&GetCurListItem(a)){c=applyListStyleDepth("decrease",a,!1);return}for(;f;){var g=e.nextNode();"LI"===f.nodeName&&(d=!0);"P"===f.nodeName&&(b=!0);f=g}c=!b&&d?applyListStyleDepth("decrease",a,!1):g_objLetterFn.setParaStyle(a,{indent:!0})}if(!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,
a),editor_onselectionchange(a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}}catch(h){dalert(h)}}
function fnHandler_LetterSpacing(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objUndoRedo.registerUndoRedoStack(0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objLetterSpacingWin.showLetterSpacingLayer(b,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_LineHeight(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objUndoRedo.registerUndoRedoStack(0,a),g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objLineHeightWin.showLineHeightLayer(b,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(d){}}
function fnHandler_ForeColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(duzon_dialog.curr_forecolor[a],null,DZE_LETTER_COMMAND_FONT_COLOR))}catch(d){}}
function fnHandler_ForeColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objUndoRedo.registerUndoRedoStack(0,a);var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(b,c){var e=!0;"undefined"!=typeof c&&
(e=c);1==e&&duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply(b,e,DZE_LETTER_COMMAND_FONT_COLOR);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);1!=e||GetMultiCellSelection(a)||editor_onselectionchange(a)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR],[function(a){duzon_dialog.selectColorCode("",b);duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR;fnColorCellApply("",null,DZE_LETTER_COMMAND_FONT_COLOR)},
function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var a=dzeColorPallet.getColorCode("hex");""!=a&&(duzon_dialog.selectColorCode(a,b),duzon_dialog.closeDialog(),g_nLetterOperationType=ID_LETTER_OPERATION_FORE_COLOR,fnColorCellApply(a,null,DZE_LETTER_COMMAND_FONT_COLOR))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=g_objPropertyUtil.getSelectionAttributeValue(a);
"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",duzon_dialog.selectionFontStyleList.color,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0))}}catch(e){}}
function fnHandler_BackColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(duzon_dialog.curr_backcolor[a],null,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR))}catch(d){}}
function fnHandler_BackColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objUndoRedo.registerUndoRedoStack(0,a);var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(a,b){var c=!0;"undefined"!=typeof b&&
(c=b);1==c&&duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;fnColorCellApply(a,c,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);1==c&&editor_onselectionchange(duzon_dialog.nEditNumber)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(){duzon_dialog.selectColorCode("",b);duzon_dialog.closeExtendsDlg();g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR;fnColorCellApply("",null,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR)},
function(d){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var a=dzeColorPallet.getColorCode("hex");""!=a&&(duzon_dialog.selectColorCode(a,b),duzon_dialog.closeDialog(),g_nLetterOperationType=ID_LETTER_OPERATION_BACK_COLOR,fnColorCellApply(a,null,DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=
g_objPropertyUtil.getSelectionAttributeValue(a);"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",duzon_dialog.selectionFontStyleList.backgroundColor,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}]))}}catch(e){}}
function fnHandler_Help(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&onefficeCommon.openWindow(oneffice.getEditModeDocPath(CLOUD_CONST_STRING_VIDEO_MANUAL_SEQ,null,null,!0),"_blank")}catch(d){}}function fnHandler_Preview(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&fnTool_TabMode_Preview(c,b,ID_TB_TABMODE_PREVIEW,a)}catch(d){}}
function fnHandler_Print(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))if(c="portrait",dzeUiConfig.nSettingPaperSize.width>dzeUiConfig.nSettingPaperSize.height&&(c="landscape"),"landscape"==c&&g_bBrowserType_IE)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_IE_NOT_SUPPORT_LANDSCAPE_PRINT,1.5);else{"undefined"!==typeof g_objPageControl&&g_objPageControl.updateDirtyPageAll();getEditorHTMLCode(!1,a,!0,!0);var d=parseInt(a,10)+DZE_IFRAME_TMP_NO,e=g_objEditorDocument[d];
g_objEditMode.showBGImageForLockedCell(!1,d);replaceEditorTempTagsFromEditor(d);if(g_bBrowserType_WK){var f=document.createElement("style");f.innerHTML="h1, h2, h3, h4, h5, dl, dt, dd, ul, li, ol, th, td, p, blockquote, form, fieldset, legend, div, body { -webkit-print-color-adjust:exact; }";e.head.appendChild(f)}var g=e.head.getElementsByTagName("style");for(f=0;f<g.length;f++)if("print"==g[f].getAttribute("media")){g[f].innerHTML="@page{ margin : 0mm; size: A4 "+c+";}";break}g_objVideoControl.convVideoToImageForPrint(e.body,
g_objEditorDocument[a].body);removeImageLoadingLazy(e.body);makePrintableContent(e);duzon_http.showLoading();waitCssLoad(e).then(function(){return waitImgLoad(e.body)}).then(function(){g_browserCHK.wk&&setPositionAbsoluteForWebkitBug(e);setTimeout(function(){duzon_http.hideLoading();g_bBrowserType_IE?e.execCommand("print",!1,null):g_objEditWindow[d].print()},0)}).catch(function(a){duzon_dialog.hideLoading()})}}catch(h){}}
function fnHandler_FormTagSwitch(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_bBrowserType_IE||g_bBrowserType_FF)){c=g_objTagUtil;b=g_objCaretUtil;b.saveCaret(a);var d=!c.bFormTagSwitch;c.bFormTagSwitch=d;c.formTagSwitch(d,a);b.restoreCaret(a);editor_onselectionchange(a)}}catch(e){dalert(e)}}
function fnHandler_CheckBox(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=(g_bBrowserType_IE||g_bBrowserType_FF)&&!1===g_objTagUtil.bFormTagSwitch;c="";c+=d?'<span contenteditable="false">':"";insertHTMLCodeAtSelection(c+'<input type="checkbox">'+(d?"</span>":""),null,a);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a)}}catch(e){dalert(e)}}
function fnHandler_SelectBox(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))if("context"===d)duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_SELECT_WIN_TITLE,g_objPropTagSelect.buildTagSelect(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){g_objPropTagSelect.applyDisplayInfo();duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){g_objPropTagSelect.initPropTagSelect(g_objObjectSelectionInfo.objSelectionObject)},
function(){},!0);else{var e=(g_bBrowserType_IE||g_bBrowserType_FF)&&!1===g_objTagUtil.bFormTagSwitch;c="";c+=e?'<span contenteditable="false">':"";c+="<select>";c+="<option>"+ID_RES_DIALOG_FORM_LIST1+"</option>";c+="<option>"+ID_RES_DIALOG_FORM_LIST2+"</option>";c+="<option>"+ID_RES_DIALOG_FORM_LIST3+"</option>";insertHTMLCodeAtSelection(c+"</select>"+(e?"</span>":""),null,a);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a)}}catch(f){dalert(f)}}
function fnHandler_Radio(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&"context"!==d){var e=(g_bBrowserType_IE||g_bBrowserType_FF)&&!1===g_objTagUtil.bFormTagSwitch;c="";c+=e?'<span contenteditable="false">':"";insertHTMLCodeAtSelection(c+'<input type="radio">'+(e?"</span>":""),null,a);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a)}}catch(f){dalert(f)}}
function dummyFunc(c,b,a){dlog("---dummyFunc called---command_id:"+b.command_id)}function dummyFunc_Detail(c,b,a){dlog("---dummyFunc_Detail called---command_id:"+b.command_id)}
function fnHandler_NewFile(c,b,a){dlog("fnHandler_NewFile nEditNumber:"+a);try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(!0===dzeUiConfig.bOfficeMode?oneffice.newFile(a):isEmptyEditorContents(a)?replaceHTMLContent("<p><br /></p>",a):duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_NEW,ID_RES_DIALOG_CONFIRM_SAVE,3,[ID_RES_DIALOG_CONFIRM_YES,ID_RES_DIALOG_CONFIRM_NO,ID_RES_DIALOG_BTN_CANCEL],[function(b){saveEditorContentToFile(-1);duzon_dialog.closeDialog();
replaceHTMLContent("<p><br /></p>",a)},function(b){replaceHTMLContent("<p><br /></p>",a);duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}]))}catch(d){}}function fnHandler_SaveAs(c,b,a){-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(c=fnGetEditorHTMLCode(!1,a),c=c.trim(),""==c||"<p><br /></p>"==c||"<p><br></p>"==c||"<p>&nbsp;</p>"==c||"<p></p>"==c||"<br />"==c||"<br>"==c?alert(ID_RES_DIALOG_CONFIRM_EMPTY_DOC):saveEditorContentToFile(a))}
function saveEditorContentToFile(c){try{dlog("saveEditorContentToFile act");-1==c&&(c=g_nActiveEditNumber);var b=makeDownloadHtmlCode(c);dlog(b);var a=document.createElement("form");a.action=dzeEnvConfig.strSaveAsPageURL;a.method="post";var d=document.createElement("textarea");d.name="content";d.value=b;a.appendChild(d);document.body.appendChild(a);a.submit();dlog("saveEditorContentToFile submit ok");dlog(b);document.body.removeChild(a)}catch(e){}}
function fnHandler_OpenFile(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_OPEN,duzon_dialog.getOpenFileFormContent(),2,[ID_RES_CONST_STRING_FILE_OPEN,ID_RES_DIALOG_BTN_CANCEL],[function(b){if(""==g_objLayerKit.getElementById(duzon_dialog.idx_openfile_input).value)alert(ID_RES_DIALOG_ALERT_SELECTFILE);else if(isEmptyEditorContents(a)||cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_DIALOG_CONFIRM_FILE_DELETE_CONTENT,
null,[ID_RES_DIALOG_CONFIRM_YES,ID_RES_DIALOG_CONFIRM_NO],null,function(){cmnMsg.hideMsg()}),b=g_objLayerKit.getElementById(duzon_dialog.idx_openfile_input).value.split(".").pop().toLowerCase(),dlog("fileExt:"+b),inArray(b,duzon_dialog.avail_openfile_ext)){duzon_dialog.resetTableObjInfo();var c=g_objLayerKit.getElementById(duzon_dialog.idx_openfile_iframe);c.onload=function(){setEditorHTMLCode(c.contentWindow.document.body.innerHTML,!1,duzon_dialog.nEditNumber);duzon_dialog.closeDialog();fnHandler_InsertParagraph(a,
"end")};b=g_objLayerKit.getElementById(duzon_dialog.idx_openfile_form);b.target=duzon_dialog.nm_openfile_iframe;b.action=dzeEnvConfig.strOpenFilePageURL;b.submit()}else alert("'"+b+"' "+ID_RES_DIALOG_ALERT_ALLOWFILES+" : "+duzon_dialog.avail_openfile_ext.join(", "))},function(a){duzon_dialog.closeDialog()}],function(){dlog("onload callback--------");duzon_dialog.addEventExtFileForm(duzon_dialog.idx_openfile_input);setTimeout(function(){g_objLayerKit.getElementById(duzon_dialog.idx_openfile_input).parentNode.style.position=
"relative"},1E3)},function(){dlog("unload callback--------")}),document.getElementById(duzon_dialog.idx_openfile_input).value="")}catch(d){}}
function fnHandler_DocForm(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.getDocFormContent().then(function(b){duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_DOCFORM,b,2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){duzon_dialog.inputSelectDocFormData(duzon_dialog.selectedDocCategoryNo,duzon_dialog.selectedDocNo,g_nActiveEditNumber)},function(a){duzon_dialog.closeDialog()}])})}catch(d){dalert(d)}}
function fnHandler_Layout(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_FILE_LAYOUT,duzon_dialog.getLayoutContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.inputSelectLayoutData();g_objUndoRedo.registerUndoRedoStack(0,a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.addLayoutContentEvent()},
function(){},!0)}catch(d){}}function fnHandler_viewEdit(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!g_bEditMode[a]&&fnTool_TabMode_Main(ID_TB_TABMODE_EDIT,a)}catch(d){}}function fnHandler_viewHtml(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnTool_TabMode_Main(ID_TB_TABMODE_SOURCE,a)}catch(d){}}
function fnHandler_viewRulerbar(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),(fnObjectCheckNull(b)||fnObjectCheckNull(c)||fnHandler_CommonCheck_DynamicLayer_1(c,b,a))&&g_bEditMode[a]&&g_bRulerbar_Display&&(g_objRulerBar.isInit()?g_objRulerBar.show(!g_objRulerBar.isShow()):(g_objRulerBar.init(a),g_objRulerBar.show(!g_readonlyMode)),editor_onselectionchange(a),objOnefficeLoader.m_bHybrid||resizeEditor_Height(a))}catch(d){dalert(d)}}
function fnHandler_InsertImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a),e=d?d.controlObject:null;if(e&&"IMG"===e.nodeName){if(e.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_IMG))return fnHandler_replaceImage(c,b,a);if(!e.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO))return fnHandler_ModifyImage(c,b,a)}var f=ImageInsertDlg;f.type=ImageInsertDlg.IMG_INSERT;f.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_IMAGE,f.getContents(),
2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){f.onClickOk(function(b,c){for(var d=g_objEditorDocument[a].createDocumentFragment(),e=c.arrImg,g=0,h=b.length;g<h;g++){var k=e[g];k.src!==b[g]&&(k.src=b[g]);f.setImgProp(k,c,{bSetSize:1<h?!1:!0});d.appendChild(k)}fnAddHTMLContent(null,d,0,a);g_objTableFlag.ResetTableInfo();g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();f.closeDialog()})},
function(a){f.closeDialog()}],function(){f.onLoad()},function(){f.onUnload()},!0,"screen_center")}}catch(g){dalert(g)}}var g_objCropObj=null;
function fnHandler_imageCropper(c,b,a){dlog("fnHandler_imageCropper start");try{null!=g_objCropObj&&null!=g_objCropObj.cropObj&&(g_objCropObj.destroy(),g_objCropObj=null),null===g_objCropObj&&(g_objCropObj=new PictureCropper({imgNode:g_objWrapperOutlineResize.objExtSelectedInfo.objElement,initHandler:function(a,b){TBCancelBubbleEvent(a)},startHandler:function(a,b){},endHandler:function(a,b){}})),g_objCropObj.init()}catch(d){g_objCropObj||(g_objCropObj.destroy(),g_objCropObj=null)}}
function fnHandler_ModifyImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a),e=d?d.controlObject:null;if(e&&"IMG"===e.nodeName){var f=ImageInsertDlg;f.type=ImageInsertDlg.IMG_MODIFY;f.viewDialog(c,a,ID_RES_PROP_INSERT_IMAGE,f.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){f.onClickOk(function(b,c){f.setImgProp(e,c)&&commonUpdateAfterChange(a,e);f.closeDialog()})},function(a){f.closeDialog()}],
function(){f.onLoad([e])},function(){f.onUnload()},!0,"screen_center")}else dlog("fnHandler_ModifyImage :: no image")}}catch(g){dalert(g)}}
function fnHandler_replaceImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a),e=d?d.controlObject:null;if(e&&"IMG"===e.nodeName){var f=ImageInsertDlg;f.type=ImageInsertDlg.IMG_REPLACE;f.viewDialog(c,a,ID_RES_CONST_STRING_IMAGE_REPLACE,f.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){f.onClickOk(function(b,c){if(b=b[0]){var d=!1;e.src!==b&&(d=!0,e.src=b);if(d=f.setImgProp(e,c)||d)e.removeAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_IMG),
commonUpdateAfterChange(a,e);f.closeDialog()}})},function(a){f.closeDialog()}],function(a){a&&e.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_IMG)&&(a=a.querySelector("td.duzon_dialog_title"))&&(a.innerText=ID_RES_CONST_STRING_INSERT_IMAGE);f.onLoad([e])},function(){f.onUnload()},!0,"screen_center")}else dlog("no image")}}catch(g){dalert(g)}}
function fnHandler_saveAsImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=getSelectionControl(a);if(null!=d.controlObject&&"undefined"!=typeof d.controlObject&&"img"==d.controlObject.nodeName.toLowerCase()){var e=d.controlObject.src,f=oneffice.currFileSeq,g=(new Date).getTime();c="oneffice_download";d.controlObject.getAttribute("chart_id")&&(c="oneffice_chart_download");f&&(c+="_"+f);c+="_"+g;g_browserCHK.ie?-1!=e.indexOf("data:image/png;base64")?
downloadBase64Image(e,c):downloadRemoteImage(e,c):downloadRemoteImage(e,c)}}}catch(h){dalert(h)}}
function fnHandler_Pastespecial(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&((g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&b.command_id==ID_COMMAND_EDIT_PASTESPECIAL?alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_EDIT_PASTESPECIAL,duzon_dialog.getPastespecial(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){1==g_objLayerKit.getElementById(duzon_dialog.idx_paste_special_type_text).checked?
window.clipboardData&&window.clipboardData.getData?(pastedText=g_objLayerKit.getLayerWindow().clipboardData.getData("Text"),fnAddHTMLContent(pastedText,null,0,a),TBCancelBubbleEvent(b),duzon_dialog.closeDialog()):alert(ID_RES_USER_MSG_STRING_ALERT_PASTE):1==g_objLayerKit.getElementById(duzon_dialog.idx_paste_special_type_html).checked&&(duzon_dialog.closeDialog(),fnHandler_SupportCommand_Main(a,"Paste"))},function(a){duzon_dialog.closeDialog()}]))}catch(d){}}
function fnHandler_TabDialogSample(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_IMAGE,duzon_dialog.getSampleTabContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(a){},function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(1)},function(){},!0)}catch(d){}}function fnHandler_FindText(c,b,a){return fnHandler_FindReplaceText(c,b,a,"find")}
function fnHandler_ReplaceText(c,b,a){return fnHandler_FindReplaceText(c,b,a,"replace")}
function fnHandler_FindReplaceText(c,b,a,d){try{var e=function(a){var b=g_objLayerKit.getLayerDocument().getElementById("idx_duzon_find_text");b&&a&&a.keyCode===ID_KEYCODE_ENTER&&(b.focus(),setSelectionColor(g_nActiveEditNumber,l),h(g_nActiveEditNumber),TBCancelBubbleEvent(a))},f=function(a){var b=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).value,d=1;d=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?
1:0;var e=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(e=1);var f=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(f=1);if(""==b)return alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus(),!1;var g=replaceAllEditorText(a,b,c,d,e,f,0);if(-1==g)return alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR),!1;setTimeout(function(){0==g?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):alert(ID_RES_DIALOG_ALERT_REPLACEALL_COMPLETE+
"\n"+g+ID_RES_DIALOG_ALERT_REPLACE_N)},100);return 0<g?!0:!1},g=function(a,b){if(!0===k)return!1;var c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,d=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_replace_text).value,e=1;e=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var f=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(f=1);var h=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&(h=1);if(""==
c)return alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus(),!1;k=!0;return 1===replaceEditorTextDetail(a,c,d,e,f,h,0,b,function(b){k=!1;-1==b?alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR):0==b?alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT):1!=b&&5!==b&&(2==b?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):3==b?cmnMsg.showMsg(MESSAGE_CONFIRM,0==e?ID_RES_DIALOG_CONFIRM_FIND_END:ID_RES_DIALOG_CONFIRM_FIND_FIRST,null,[ID_RES_DIALOG_CONFIRM_YES,ID_RES_DIALOG_CONFIRM_NO],
function(){cmnMsg.hideMsg();setTimeout(function(){g(a,!0)},100)}):4==b?alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA):6==b&&alert(ID_RES_STRING_FIND_END))})?!0:!1},h=function(a,b){var c=g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value,d=1;d=1==g_objLayerKit.getElementById(duzon_dialog.idx_findbackward).checked?1:0;var e=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_casesensitive).checked&&(e=1);var f=0;1==g_objLayerKit.getElementById(duzon_dialog.idx_completeword).checked&&
(f=1);""==c?(alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT),g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).focus()):(b=findEditorTextDetail(a,c,d,e,f,0,b),dlog("nReturnCode:"+b),-1==b?alert(ID_RES_DIALOG_ALERT_FIND_ERROR):0==b?alert(ID_RES_DIALOG_ALERT_FIND_INPUT_TEXT):1!=b&&(2==b?alert(ID_RES_DIALOG_ALERT_FIND_NOTHING):3==b&&cmnMsg.showMsg(MESSAGE_CONFIRM,0==d?ID_RES_DIALOG_CONFIRM_FIND_END:ID_RES_DIALOG_CONFIRM_FIND_FIRST,null,[ID_RES_DIALOG_CONFIRM_YES,ID_RES_DIALOG_CONFIRM_NO],function(){cmnMsg.hideMsg();
setTimeout(function(){h(a,!0)},100)})))};-1==a&&(a=g_nActiveEditNumber);if(g_bEditMode[a]&&("find"===d||"replace"===d)){var k=!1;b=ID_RES_DIALOG_TITLE_FIND_REPLACE;!0===g_readonlyMode&&(b=ID_RES_CONST_STRING_EDIT_SEARCH);var l="rgba(255, 187, 0, 0.6)";duzon_dialog.viewDialog(c,a,b,duzon_dialog.getFindReplaceContent(),4,[ID_RES_DIALOG_BTN_REPLACEALL,ID_RES_CONST_STRING_EDIT_REPLACE,ID_RES_DIALOG_BTN_FIND_NEXT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){dlog("func : \ubaa8\ub450\ubc14\uafb8\uae30");!0===
f(a)&&g_objUndoRedo.registerUndoRedoStack(0,a)},function(b){dlog("func : \ubc14\uafb8\uae30");setSelectionColor(a,l);!0===g(a)&&g_objUndoRedo.registerUndoRedoStack(0,a)},function(b){dlog("func : \ub2e4\uc74c\ucc3e\uae30:"+duzon_dialog.idx_duzon_find_text);setSelectionColor(a,l);h(a)},function(a){dlog("func : \ub2eb\uae30");duzon_dialog.closeDialog();duzon_dialog.strFindText=""}],function(b){!0===g_readonlyMode&&($_("idxDuzonTabTitleContainer").childNodes[2].innerHTML="",$_("idxDuzonTabTitleContainer").childNodes[2].style.cursor=
"default",$_("idxDuzonTabTitleContainer").childNodes[2].onclick=function(){return!1});setTimeout(function(){!0===g_readonlyMode||"find"==d?duzon_dialog.viewTabContents(0):duzon_dialog.viewTabContents(1)},50);""!=duzon_dialog.strFindText&&(g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).value=duzon_dialog.strFindText);g_objLayerKit.getElementById(duzon_dialog.idx_duzon_find_text).onblur=function(){duzon_dialog.strFindText=this.value};var c=function(b){!cmnMsg.isShowMsg()&&b&&b.keyCode===
ID_KEYCODE_ENTER&&(setSelectionColor(a,l),h(a),TBCancelBubbleEvent(b))},f=b.querySelector("#idx_duzon_find_text");b=b.querySelector("#idx_duzon_replace_text");f&&(f.onkeydown=c);b&&(b.onkeydown=c);duzon_dialog.resetSelection=!0;duzon_dialog.isFindDialog=!0;dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.setEnableForFindReplace();if(c=(c=g_objLayerKit.getLayerDocument())?c.querySelector(".duzon_dialog_tab_body_container"):null)c=c.style,c.paddingTop="10px",c.paddingBottom="10px";g_bBrowserType_IE&&
(c=g_objEditorDocument[a].getElementById("dze_document_main_container"),EventUtil.addHandler(c,"keydown",e));g_objTableFlag.ResetTableInfo()},function(){dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.restoreEnableForFindReplace();if(dzeUiConfig.bOfficePagingMode&&(g_objPageControl.clearUpdatePageTimer(),!g_readonlyMode))g_objPageControl.onSetDelayedUpdatePageTimerAll();setSelectionColor(a);if(g_bBrowserType_IE){var b=g_objEditorDocument[a].getElementById("dze_document_main_container");EventUtil.removeHandler(b,
"keydown",e)}g_objFindTextRange=null},!0,null,null,g_objEditWindow[a].find&&!g_objPropertyUtil.hasClass(g_objEditorDocument[a].body,"unselectable")?{viewBackScr:!1}:null)}}catch(m){dalert(m)}}
function fnHandler_InsertExtMovie(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a),e=d?d.controlObject:null;b=!1;e&&"IMG"===e.nodeName&&e.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO)&&(b=!0);var f={};b&&(f.width=e.style.width||e.width,f.height=e.style.height||e.height);var g=VideoDlg;g.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_OBJECT_MOVIE,g.getContent(a),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){if(g.insertExtMovieContent(f)){g_objTableFlag.ResetTableInfo();
editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();g_objUndoRedo.registerUndoRedoStack(0,a)}},function(a){g.closeDialog()}],function(){g.onLoad(a,!1,null)},function(){},!0,"screen_center")}}catch(h){dalert(h)}}
function fnHandler_videoProperty(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){b=g_objVideoControl;var d=getSelectionControl(a),e=b.getVideo(d?d.controlObject:null);if(!e){var f=b.getFocusParentNode();e=b.getVideo(f);!e&&b.isVideoControl(f)&&(e=b.getVideo(f.parentNode))}if(e){var g=VideoDlg;g.viewDialog(c,a,ID_RES_PROP_INSERT_VIDEO,g.getContent(a),2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(b){g.modifyExtMovieContent(e)&&
g_objUndoRedo.registerUndoRedoStack(0,a);(b=g_objWrapperOutlineResize.objExtSelectedInfo)&&b.objElement===e&&showExtOutline_ObjectElement(e,!0,!1,a)},function(a){g.closeDialog()}],function(){g.onLoad(a,!0,e)},function(){},!0)}}}catch(h){dalert(h)}}
function fnHandler_InsertExtFile(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&("dzeExtFile"==g_objALinkMgr.getPropContentParam(a).arrValue[3]?fnHandler_ModifyExtFile(c,b,a):duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FILE_INSERT,duzon_dialog.getInsertExtFileContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.insertExtFileContent();g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],
function(){duzon_dialog.addEventExtFileForm(duzon_dialog.idx_dze_up_extfile,function(){duzon_dialog.uploadExtFile()})},function(){},!0))}catch(d){}}
function fnHandler_ModifyExtFile(c,b,a){dlog("fnHandler_ModifyExtFile Call");var d=g_objALinkMgr.getPropContentParam(a);if("dzeExtFile"==d.arrValue[3]){dlog("objParam.arrValue:"+d.arrValue);try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_FILE_INSERT,duzon_dialog.getInsertExtFileContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.modifyExtFileContent();g_objUndoRedo.registerUndoRedoStack(0,
a)},function(a){duzon_dialog.closeDialog()}],function(){var a=d.arrValue[4];g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile).disabled=!0;g_objLayerKit.getElementById(duzon_dialog.idx_dze_insert_extfile_text).value=a;g_objNodeUtil.getLoopParentElement(g_objLayerKit.getElementById(duzon_dialog.idx_dze_up_extfile),"table").style.opacity="0.3"},function(){},!0,"relative")}catch(e){}}}
function fnHandler_InsertHr(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){g_objShapeFunction.onDeselectAllShapes();g_objTableFlag.ResetTableInfo();g_objInsertUtil.insertTableCodeAtSelection("<hr>",a);g_objUndoRedo.registerUndoRedoStack(0,a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();editor_onselectionchange(a)}}catch(d){dalert(d)}}
function fnHandler_InsertEmoticons_Detail(c,b,a){fnHandler_InsertEmoticons(c,b,a)}
function fnHandler_InsertEmoticons(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a])if(ID_COMMAND_TYPE_MENU==b.commandtype)fnHandler_InsertEmoticons_Dialog(c,b,a);else{var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_EMOTICON,duzon_dialog.makeExtendsDlgInfo(),duzon_dialog.viewExtendsDlg(b,a,null,[ID_RES_CONST_STRING_INSERT_EMOTICONS],
[function(){fnHandler_InsertEmoticons_Dialog(c,b,a)}],"toolbar",null))}}catch(e){dalert(e)}}
function fnHandler_InsertEmoticons_Dialog(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=duzon_dialog.getBtnDlg();d.setInsType(DZE_INSERT_EMOTICON);d.makeInsTypeInfo();duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_EMOTICONS,d.getInsertTypeContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){if(d.insertTypeContent(null)){editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();
g_objUndoRedo.registerUndoRedoStack(0,a)}},function(b){editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();duzon_dialog.closeDialog()}],function(){setTimeout(function(){d.loadInsertTypeContent()},150)},function(){},!0)}}catch(e){dalert(e)}}
function fnHandler_SpecialChars(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=duzon_dialog.getBtnDlg();d.setInsType(DZE_INSERT_SPECIALCHAR);d.makeInsTypeInfo();duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_SPECIALCHARS,d.getInsertTypeContent(),2,[ID_RES_DIALOG_BTN_INSERT,ID_RES_ADJUST_VIEW_CLOSE],[function(b){if(d.insertTypeContent(null)){editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();
g_objUndoRedo.registerUndoRedoStack(0,a)}},function(b){editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();duzon_dialog.closeDialog()}],function(){setTimeout(function(){d.loadInsertTypeContent()},100)},function(){},!0)}}catch(e){}}
function fnHandler_InsertBookmark(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=BookmarkDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_BOOKMARK,d.getContent(a),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){d.closeDialog()}],function(){d.onLoad(a)},function(){},!0,"screen_center",null,g_bBrowserType_IE?null:{viewBackScr:!1})}}catch(e){dalert(e)}}
function fnHandler_InsertParagraphStartPoint(c,b,a,d,e){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnHandler_InsertParagraph(a,"start",d,e)}catch(f){dalert(f)}}function fnHandler_InsertParagraphEndPoint(c,b,a,d,e){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&fnHandler_InsertParagraph(a,"end",d,e)}catch(f){dalert(f)}}
function fnHandler_InsertParagraph(c,b,a,d){try{var e=null,f=null;b="start"===b;var g=g_objNodeUtil,h=g_objSplitUtil;if("context"===a&&5===d)e=GetCurTable(c);else{var k=GetCurRange(c);for(e=b?k.startContainer:k.endContainer;e&&!g.isBoundNode(e.parentNode)&&!g.isList(e.parentNode);)e=e.parentNode}f=h.getSplitNodes(e);e=b?f[0]:f[f.length-1];if(!e)return!1;var l=e.ownerDocument;d=a=null;if("TABLE"===e.nodeName&&g.isListItem(e.parentNode)){var m=e.previousSibling;b&&m&&(3===m.nodeType||g.isInlineNode(m)&&
"BR"!==m.nodeName&&!g.findBr(m))?(a=l.createDocumentFragment(),a.appendChild(l.createElement("BR")),d=l.createElement("BR"),a.appendChild(d)):d=a=l.createElement("BR")}else g.isListItem(e)?a=e.cloneNode(!1):(a=l.createElement("P"),a.appendChild(l.createElement("BR"))),d=a;if(!a||!d)return!1;b?e.parentNode.insertBefore(a,e):insertAfter(e,a);d&&g_objCaretUtil.moveCaret(d);g_objTableFlag.ResetTableInfo();g_objUndoRedo.registerUndoRedoStack(0,c);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(a);
editor_onselectionchange(c)}catch(n){dalert(n)}}
function fnHandler_StyleFont(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(dlog("fnHandler_StyleFont element"),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_FONT,duzon_dialog.getStyleFontContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.setStyleFont();duzon_dialog.closeDialog();if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();g_objUndoRedo.registerUndoRedoStack(0,a)},
function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.modifySpinnerValue("dze_style_font_spacing",duzon_dialog.max_letterspacing,duzon_dialog.min_letterspacing,0,"duzon_dialog.preveiwDzeLetterSpacing");duzon_dialog.modifySpinnerValue("dze_style_font_size",96,6,g_strBodyFontSize,"duzon_dialog.preveiwDzeFontSize");for(var a="",b="",c=0;c<duzon_dialog.dze_font_propertys.length;c++)a="idx_dze_style_font_"+duzon_dialog.dze_font_propertys[c],b=duzon_dialog.dze_font_propertys[c],function(){var c=
b;g_objLayerKit.getElementById(a).onclick=function(){duzon_dialog.selectFontProperty(c)}}();g_objColorComboBoxUtil.initColorComboBox("dze_font_forecolor",function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.color=a},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]);g_objColorComboBoxUtil.initColorComboBox("dze_font_backcolor",function(a){$_(duzon_dialog.idx_dze_style_font_preview).style.backgroundColor=a});$_("dze_style_font_family").onchange=function(){$_(duzon_dialog.idx_dze_style_font_preview).style.fontFamily=
this.value};g_objColorComboBoxUtil.setColorValue("dze_font_forecolor","");g_objColorComboBoxUtil.setColorValue("dze_font_backcolor","");duzon_dialog.checkSelectionFontStyle()},function(){},!0))}catch(d){}}
function fnHandler_StyleParagraph(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=ParagraphDlg,e=g_objLetterFn.getSelectedParaStyle(a);d.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_PARAGRAPH,d.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){d.setEditorSelection();d.closeDialog();d.onClickOk(function(b){g_objLetterFn.setParaStyle(a,b);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()})},
function(){d.closeDialog()}],function(){d.onLoad(e)},function(){},!0)}}catch(f){}}
function fnHandler_StyleHeadingSize(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE,g_objComboBoxWin.strComboBoxCommand="Heading",b.command_id==ID_COMMAND_STYLE_STYLE_BASIC||b.command_id==ID_COMMAND_STYLE_STYLE?g_objComboBoxWin.setComboBox(0):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT1?g_objComboBoxWin.setComboBox(1):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT2?g_objComboBoxWin.setComboBox(2):
b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT3?g_objComboBoxWin.setComboBox(3):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT4?g_objComboBoxWin.setComboBox(4):b.command_id==ID_COMMAND_STYLE_STYLE_SUBJECT5&&g_objComboBoxWin.setComboBox(5))}catch(d){}}
function fnHandler_StyleUnorderedList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){duzon_menubar.closeHiddenTbContainerTool();var d=UListDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_UNORDEREDLIST,d.getContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var b=d.getListStyle();d.closeDialog();if(b&&(b="none"===b?removeOLUL(a):insertUL(a,b),setCurListForDialog(a),!0===b&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode)))g_objPageControl.onSetDelayedUpdatePageTimer()},
function(){d.closeDialog()}],function(b){var c="",e=GetCurList(a);e&&(c=g_objListUtil.getListStyle(e));d.onLoad(c,b)},function(){},!0)}}catch(e){}}
function fnHandler_StyleOrderedList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){duzon_menubar.closeHiddenTbContainerTool();var d=OListDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_STYLE_ORDEREDLIST,d.getContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var b=d.getInfo();d.closeDialog();var c=b.listStyle;b=b.start;if(c&&(c="none"===c?removeOLUL(a):insertOL(a,c,b),setCurListForDialog(a),!0===c&&(g_objUndoRedo.registerUndoRedoStack(0,
a),dzeUiConfig.bOfficePagingMode)))g_objPageControl.onSetDelayedUpdatePageTimer()},function(){d.closeDialog()}],function(b){var c={start:1,listStyle:""},e=GetCurList(a);e&&(c.start=e.getAttribute("start")||"",c.listStyle=g_objListUtil.getListStyle(e));d.onLoad(c,b)},function(){},!0)}}catch(e){}}
function fnHandler_ProductInfo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_DIALOG_TITLE_WEBEDITOR_INFO,duzon_dialog.getWebEditorInfoContent(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.getOnefficeLicenseInfo();var a=document.getElementById("dze_idx_btn_view_license_info_contentbox");a.onclick=function(){var b=document.getElementById("dze_idx_license_info_contentbox");
"none"==b.style.display?duzon_dialog.fade("in",b,function(){a.innerHTML="License Info \u25b2"},25):duzon_dialog.fade("out",b,function(){a.innerHTML="License Info \u25bc"},25)}},function(){},!0,"center")}catch(d){}}
function fnHandler_ShortCutsInfo(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_HELP_SHORTCUTS,duzon_dialog.getShortCutsInfoContent(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){duzon_dialog.setShortCutsInfo()},function(){},!1,"center")}catch(d){}}
function fnHandler_StyleIncreaseFontSize(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(increaseFontSize(!0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){}}
function fnHandler_StyleDecreaseFontSize(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(increaseFontSize(!1,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){}}
function fnHandler_Tb_OrderedList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_SupportCommand_Main(a,b.command,!1),g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){dalert(d)}}
function fnHandler_Tb_OrderedList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_StyleOrderedList(c,b,a)}catch(d){}}
function fnHandler_Tb_UnorderedList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(fnHandler_SupportCommand_Main(a,b.command,!1),g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){dalert(d)}}
function fnHandler_Tb_UnorderedList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_StyleUnorderedList(c,b,a)}catch(d){}}
function fnHandler_ReplaceCase(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=ReplaceCaseDlg;d.viewDialog(c,a,ID_RES_CONST_STRING_REPLACE_CASE,d.getContent(),2,[ID_RES_CONST_STRING_EDIT_REPLACE,ID_RES_ADJUST_VIEW_CLOSE],[function(b){d.closeDialog();if(d.onClickOk(a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()},function(a){d.closeDialog()}],function(){d.onLoad()},
function(){},!0,"center")}}catch(e){}}function fnHandler_Table_Cell_BackColor(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=duzon_dialog.curr_cell_backcolor[a],e=GetCurTable(a);g_objTableFunction.setSelectedCellBackground(d,e)&&commonUpdateAfterChange(a,e)}}catch(f){dalert(f)}}
function fnHandler_Table_Cell_BackColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);1==d&&duzon_dialog.closeExtendsDlg();c=GetCurTable(a);g_objTableFunction.setSelectedCellBackground(b,
c)&&!0===d&&commonUpdateAfterChange(a,c)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(){duzon_dialog.closeExtendsDlg();var c=GetCurTable(a);g_objTableFunction.setSelectedCellBackground("",c)&&(duzon_dialog.selectColorCode("",b),commonUpdateAfterChange(a,c))},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");
if(""!=c){duzon_dialog.selectColorCode(c,b);duzon_dialog.closeDialog();var d=GetCurTable(a);g_objTableFunction.setSelectedCellBackground(c,d)&&commonUpdateAfterChange(a,d)}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b="",c=GetCurTable(a);c&&(c=g_objTableFunction.getSelectedCellAttribute(c.ownerDocument,c,a),null!=c[ID_PROP_NODE_BACKGROUND_COLOR]&&(b=c[ID_PROP_NODE_BACKGROUND_COLOR]));dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
b,null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0))}}catch(e){dalert(e)}}
function fnHandler_IncreaseOrder(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&applyListStyleDepth("increase",a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){}}
function fnHandler_DecreaseOrder(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&applyListStyleDepth("decrease",a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){}}
function fnHandler_TableConvertText(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurTable(a);if(d){var e=g_objPageControl.getPageNumRange(d);if(e){var f=g_objTableOperation.convertTableToFormatText(d);f&&(g_objTableFlag.ResetTableInfo(!0),editor_onselectionchange(a),g_objUndoRedo.registerUndoRedoStack(0,a),g_objPageControl.onSetDelayedUpdatePageTimerRange(0,e.start,e.end));return f}}}}catch(g){dalert(g)}}
function fnHandler_WaterMark(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_STRING_EDIT_WATERMARK,g_objWaterMarkMgr.getDlgContentsHTML(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){g_objWaterMarkMgr.makeCanvas();duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}],function(){g_objWaterMarkMgr.initEventListener();g_objWaterMarkMgr.commandUI()},function(){},!0)}catch(d){}}
function fnHandler_InsertNewPage(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=1*b.command_id;switch(d){case ID_COMMAND_INSERT_NEW_PAGE:fnHandler_InsertNewPage_Detail(c,b,a);break;case ID_COMMAND_INSERT_NEW_PAGE_ABOVE:case ID_COMMAND_INSERT_NEW_PAGE_BELOW:g_objShapeFunction.onDeselectAllShapes();g_objWrapperOutlineResize.resetExtOutlineInfo();g_objTableFlag.ResetTableInfo(!1);g_objTableMiniMenu.showTableMiniMenu(!1,null,a);var e=pageManager.getInstance(),
f=e.getControlPageNumber();if(-1===f){var g=GetCurRange(a);f=g&&g.commonAncestorContainer?d===ID_COMMAND_INSERT_NEW_PAGE_ABOVE?g_objPageControl.getPageNum(g.startContainer):g_objPageControl.getPageNum(g.endContainer):1*g_objPageControl.currentPage}var h=f;d===ID_COMMAND_INSERT_NEW_PAGE_BELOW&&h++;!0===e.doInsertNewPage(f,h)&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a))}}}catch(k){dalert(k)}finally{d=1*b.command_id,d!==ID_COMMAND_INSERT_NEW_PAGE&&pageManager.getInstance().setControlPageNumber(-1)}}
function fnHandler_InsertNewPage_Detail(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_INSERT_NEW_PAGE,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}
function fnHandler_CopyPage(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=pageManager.getInstance(),e=g_objPageControl.getPageNode(d.getControlPageNumber());!1===fnObjectCheckNull(e)&&d.doCopyPage(e)}}catch(f){dalert(f)}finally{pageManager.getInstance().setControlPageNumber(-1)}}
function fnHandler_PastePage(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=pageManager.getInstance(),e=d.getControlPageNumber();c=!1;1*b.command_id===ID_COMMAND_PASTE_PAGE_BELOW&&(c=!0,e+=1);if(!0===d.doPastePage(c,e)){var f=g_objPageControl.currentPage;g_objPageControl.currentPage=e;g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber);g_objPageControl.currentPage=f}}}catch(g){dalert(g)}finally{pageManager.getInstance().setControlPageNumber(-1)}}
function fnHandler_DeletePage(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=pageManager.getInstance().getControlPageNumber();cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_CONST_STRING_PAGE_DELETE_CONFIRM,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();var b=g_objPageControl.getPageNode(d);!1===fnObjectCheckNull(b)&&(g_objCaretUtil.moveCaretForRemovePage(d),duzon_dialog.fade("out",b,function(){g_objPageControl.removePageContainer(d);
resetSelectionObjectInfo();g_objWrapperOutlineResize.resetExtOutlineInfo();g_objUndoRedo.registerUndoRedoStack(0,a,null);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DELETED,1.5);g_objPageControl.onSetDelayedUpdatePageTimer(0,d)},50))})}}catch(e){dalert(e)}finally{pageManager.getInstance().setControlPageNumber(-1)}}
function fnHandler_InsertPrintPageBreak(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;insertPrintPageBreak(a)}catch(d){}return!1}function fnHandler_cascadeOrderList(c,b,a){try{fnHandler_cascadeOrderList_Detail(c,b,a)}catch(d){}return!1}
function fnHandler_cascadeOrderList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE==ID_STRING_NAME_GRAY)return;TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var e=MultiLevelListDlg;setCurListForDialog(a);e.viewExtendsDlg(b,a,null,null,null,c,!1,e.getContent(),function(b){e.onLoad(b,a)})}catch(f){}return!1}
function fnHandler_CopyExt(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(!fnHandler_CommonCheck_DynamicLayer_1(c,b,a))return;var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE==ID_STRING_NAME_GRAY)return;TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COPY_EXT;duzon_dialog.viewExtendsDlg(b,a)}catch(e){dalert(e)}return!1}function fnHandler_CopyExt_Detail(c,b,a){fnHandler_CopyExt(c,b,a)}
function fnHandler_CopyExtStyle(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),!fnHandler_CommonCheck_DynamicLayer_1(c,b,a)||0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()||dzeUiConfig.bApplyPasteStyleMode&&letterFunction.getInstance().copyTextStyle()}catch(d){dalert(d)}}
function fnHandler_SelectParagraphDropDown(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),g_objShapeFunction.onDeselectAllShapes(),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_INSERT_PARAGRAPH,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_SelectParagraphDropDown_Detail(c,b,a){fnHandler_SelectParagraphDropDown(c,b,a)}function fnHandler_PasteExt(c,b,a){fnHandler_SupportCommand(c,b,a)}
function fnHandler_PasteExt_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_PASTE_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_TalbeDeleteExt(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_DELETE_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TalbeDeleteExt_Detail(c,b,a){fnHandler_TalbeDeleteExt(c,b,a)}
function fnHandler_TableSelect(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_SELECT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableSelect_Detail(c,b,a){fnHandler_TableSelect(c,b,a)}
function fnHandler_TableFomulaExt(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_FORMULA_EXT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableFomulaExt_Detail(c,b,a){fnHandler_TableFomulaExt(c,b,a)}
function fnHandler_TableNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_NUMBER_FORMAT,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}function fnHandler_TableNumberFormat_Detail(c,b,a){fnHandler_TableNumberFormat(c,b,a)}
function fnHandler_ImageBorderType(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=dzeUiConfig.bUseShapesFeature&&g_objSelectedShapesArray.length?DZE_EXTENDS_SVG_LINE_STYLE:DZE_EXTENDS_IMAGE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_ImageBorderType_Detail(c,b,a){fnHandler_ImageBorderType(c,b,a)}function fnHandler_ImageBorderThickness(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_ImageBorderThickness_Detail(c,b,a){fnHandler_ImageBorderThickness(c,b,a)}
function fnHandler_ImageBorderColor(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=d.controlObject,f=duzon_dialog.curr_image_border_backcolor[a];if(""==e.style.borderWidth||0==parseInt(e.style.borderWidth))null==e.style.border||""==e.style.border?e.style.border="1px solid":e.style.borderWidth="1px";e.style.borderColor=f;commonUpdateAfterChange(a,e)}}catch(g){dalert(g)}}
function fnHandler_ImageBorderColor_Detail(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=d.controlObject;f&&(f.id="dze_idx_ImageBorderColor_TargetElement",c=[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_COLOR,duzon_dialog.viewExtendsDlg(b,
a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);if(c=g_objEditorDocument[a].getElementById("dze_idx_ImageBorderColor_TargetElement")){if(""==c.style.borderWidth||0==parseInt(c.style.borderWidth))null==c.style.border||""==c.style.border?c.style.border="1px solid":c.style.borderWidth="1px";c.style.borderColor=b}1==d&&(duzon_dialog.closeExtendsDlg(),c&&commonUpdateAfterChange(a,c))},c,[function(c){fnHandler_NoColor(c,b,a)},function(c){fnHandler_OtherColor(c,b,a,f)}],"toolbar",!0),!0===g_bBrowserType_IE&&
resetSelectionObjectInfo())}}catch(g){dalert(g)}}
function fnHandler_NoColor(c,b,a){try{duzon_dialog.selectColorCode("#FFFFFF",b);var d=g_objEditorDocument[a].getElementById("dze_idx_ImageBorderColor_TargetElement");d&&(d.style.borderColor="#FFFFFF",d.removeAttribute("id"));duzon_dialog.closeExtendsDlg();if(0<g_objSelectedShapesArray.length){duzon_dialog.selectColorCode("none",b);var e=g_objShapeCmd.setShapesStrokeColor(duzon_dialog.curr_txbx_linecolor[a]);panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES);e&&g_objUndoRedo.registerUndoRedoStack(0,
g_nActiveEditNumber)}else commonUpdateAfterChange(a,d)}catch(f){}}
function fnHandler_OtherColor(c,b,a,d){try{duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c){duzon_dialog.selectColorCode(c,b);if(!dzeUiConfig.bUseShapesFeature||!g_objSelectedShapesArray.length){if(d){if(""==d.style.borderWidth||0==parseInt(d.style.borderWidth))null==d.style.border||""==d.style.border?d.style.border="1px solid":
d.style.borderWidth="1px";d.style.borderColor=c}commonUpdateAfterChange(a,d)}duzon_dialog.closeDialog()}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div","",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}catch(e){}}
function fnHandler_Arrow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command_id;switch(d){case ID_COMMAND_LINE_ARROW_NONE:case ID_COMMAND_LINE_ARROW1:case ID_COMMAND_LINE_ARROW2:case ID_COMMAND_LINE_ARROW3:case ID_COMMAND_LINE_ARROW4:case ID_COMMAND_LINE_ARROW5:case ID_COMMAND_LINE_ARROW6:case ID_COMMAND_LINE_ARROW7:case ID_COMMAND_LINE_ARROW8:case ID_COMMAND_LINE_ARROW9:case ID_COMMAND_LINE_ARROW10:g_objShapeCmd.setArrowStyle(d),panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),
g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(e){dalert(e)}}function fnHandler_AddText(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!1===fnObjectCheckNull(g_objSelectedShapesArray)&&0<g_objSelectedShapesArray.length)g_objShapeFunction.onChangeEditTextMode(!0,g_objSelectedShapesArray[0])}catch(d){}}
function fnHandler_toggleFixedRatio(c,b,a){try{var d=document.getElementById(g_arrConst[ID_COMMAND_FIXED_RATIO][2]+"_"+a),e=d.firstChild.firstChild,f="false"!==d.getAttribute("fixed_ratio");f=!f;if(!0===f){e.src=dzeEnvConfig.strPath_Image+"toolbar/ico_link.png";var g=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_SHAPE_HEIGHT][2]+"_"+a),h=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_SHAPE_WIDTH][2]+"_"+a),k=parseFloat(g.value),l=parseFloat(h.value);d.setAttribute("ratio_value",
k/l)}else e.src=dzeEnvConfig.strPath_Image+"toolbar/ico_link_none.png";d.setAttribute("fixed_ratio",f);for(c=0;c<g_objSelectedShapesArray.length;c++){var m=g_objSelectedShapesArray[c];m.setAttribute("fixed_ratio",f)}1===g_objSelectedShapesArray.length&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES)}catch(n){dalert(n)}}
function imageExceptionCheck(c){try{return null==c||"undefined"==typeof c||"img"!=c.nodeName.toLowerCase()?(dlog("imageExceptionCheck :: no image"),!1):!0}catch(b){}}function commonExceptionCheck(c,b,a){try{return document.getElementById(b.id.replace(/_SUB/,"")).TBSTATE!=ID_STRING_NAME_GRAY&&fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]?!0:!1}catch(d){}}
function commonUpdateAfterChange(c,b,a){try{if(b){var d=null;if("IMG"===b.nodeName){if(setSelectionObjectInfo(!0,b.tagName.toLowerCase(),b,!1),(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(b,!0,!1,c),dze_menu_control.setTBImageSizeInfo(c),g_objUndoRedo.registerUndoRedoStack(0,c),editor_onselectionchange(c),dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()}else if("TABLE"===b.nodeName)editor_onselectionchange(c),updateTableHandlerUI.updateTableUIHandler(c),
g_objTableMiniMenu.update(c),g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,c),a&&!1===a.bUndoRedo||g_objUndoRedo.registerUndoRedoStack(0,c),g_objPageControl.onSetDelayedUpdatePageTimerForNode(b);else if(d=g_objVideoControl.getVideo(b))setSelectionObjectInfo(!0,d.tagName.toLowerCase(),d,!1),(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(d,!0,!1,c),dze_menu_control.setTBVideoSizeInfo(c),
g_objUndoRedo.registerUndoRedoStack(0,c),editor_onselectionchange(c)}}catch(e){dalert(e)}}function fnHandler_ImageResetPicture(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=imageExceptionCheck(d)&&0!=commonExceptionCheck(c,b,a)){var e=d.controlObject;e.removeAttribute("style");e.removeAttribute("width");e.removeAttribute("height");setOrgImageSize(e,getMaxBoundSize(a),!0);commonUpdateAfterChange(a,e)}}catch(f){dalert(f)}}
function fnHandler_ObjectBorderNoLine(c,b,a){setObjectBorderLineWithType(c,b,a,"noline")}function fnHandler_ObjectBorderSolidLine(c,b,a){setObjectBorderLineWithType(c,b,a,"solid")}function fnHandler_ObjectBorderDashedLine(c,b,a){setObjectBorderLineWithType(c,b,a,"dashed")}function fnHandler_ObjectBorderDottedLine(c,b,a){setObjectBorderLineWithType(c,b,a,"dotted")}function fnHandler_ObjectBorderDoubleLine(c,b,a){setObjectBorderLineWithType(c,b,a,"double")}
function setObjectBorderLineWithType(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a))if(0<g_objSelectedShapesArray.length&&duzon_dialog.nExtendsDlgType===DZE_EXTENDS_SVG_LINE_STYLE)!0===g_objShapeCmd.setShapesStrokeStyle(g_objPropTagCommon.getBorderStyle_Graphic(g_objPropTagCommon.getBorderStyleIndex(d)))&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a),g_objPageControl.onSetDelayedUpdatePageTimer());else if(duzon_dialog.nExtendsDlgType==
DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS){var e=getSelectionControl(a).controlObject;if("noline"==d)e.style.borderWidth="0px";else{var f=e.style.borderWidth,g=e.style.borderColor;e.style.border=d;"double"==d&&(null==f||""==f||3>parseInt(f))&&(f="3px");0<parseInt(f)&&(e.style.borderWidth=f);g&&(e.style.borderColor=g)}commonUpdateAfterChange(a,e);g_objPageControl.onSetDelayedUpdatePageTimer()}else if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS||
duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE){var h=GetCurTable(a);if(h){var k=g_objTableFunction,l=g_objPropertyUtil,m=g_objTableUtil.getMatrix(h);g_objTableSelection.doAllSelectedCell(function(a){"noline"===d?k.setCellBorderWidth(a,null,"0px",m):DZE_DIR.doAllDir(function(b,c){c=l.getElement_BorderWidth_With_Unit(a,c).nValue;c=parseFloat(c);var e="double"===d?3:1;c<e&&k.setCellBorderWidth(a,b,e+"px",m)});k.setCellBorderStyle(a,null,d,m)});commonUpdateAfterChange(a,h)}}}catch(n){dalert(n)}}
function fnHandler_ObjectBorder1pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"1px")}function fnHandler_ObjectBorder2pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"2px")}function fnHandler_ObjectBorder3pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"3px")}function fnHandler_ObjectBorder4pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"4px")}function fnHandler_ObjectBorder5pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"5px")}
function fnHandler_ObjectBorder6pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"6px")}function fnHandler_ObjectBorder7pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"7px")}function fnHandler_ObjectBorder8pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"8px")}function fnHandler_ObjectBorder9pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"9px")}function fnHandler_ObjectBorder10pxLine(c,b,a){setObjectBorderWidthLineWithValue(c,b,a,"10px")}
function setObjectBorderWidthLineWithValue(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a))if(0<g_objSelectedShapesArray.length&&duzon_dialog.nExtendsDlgType===DZE_EXTENDS_IMAGE_BORDER_THICKNESS)!0===g_objShapeCmd.setShapesStrokeWidth(d)&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a));else if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_TYPE||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_IMAGE_BORDER_THICKNESS){var e=
getSelectionControl(a).controlObject,f=e.style.borderColor;if(null==e.style.border||""==e.style.border)e.style.border="solid";e.style.borderWidth=d;e.style.borderColor=f;commonUpdateAfterChange(a,e);g_objPageControl.onSetDelayedUpdatePageTimer()}else if(duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_THICKNESS||duzon_dialog.nExtendsDlgType==DZE_EXTENDS_TABLE_BORDER_TYPE){var g=GetCurTable(a);if(g){var h=g_objTableFunction,k=g_objTableUtil.getMatrix(g);g_objTableSelection.doAllSelectedCell(function(a){DZE_DIR.doAllDir(function(b,
c){a.style["border"+c.capitalizeFirstLetter()+"Style"]||h.setCellBorderStyle(a,b,"solid",k)});h.setCellBorderWidth(a,null,d,k)});commonUpdateAfterChange(a,g)}}}catch(l){dalert(l)}}
function fnHandler_VideoBorderType(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=dzeUiConfig.bUseShapesFeature&&g_objSelectedShapesArray.length?DZE_EXTENDS_SVG_LINE_STYLE:DZE_EXTENDS_IMAGE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_VideoBorderType_Detail(c,b,a){fnHandler_ImageBorderType(c,b,a)}function fnHandler_VideoBorderThickness(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}}catch(e){}}
function fnHandler_VideoBorderThickness_Detail(c,b,a){fnHandler_ImageBorderThickness(c,b,a)}
function fnHandler_VideoBorderColor(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=commonExceptionCheck(c,b,a))if(0<g_objSelectedShapesArray.length&&g_objShapeCmd.setShapesStrokeStyle(c,b,a))g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber);else{var e=d.controlObject,f=duzon_dialog.curr_video_border_backcolor[a];if(""==e.style.borderWidth||0==parseInt(e.style.borderWidth))null==e.style.border||""==e.style.border?e.style.border="1px solid":e.style.borderWidth=
"1px";e.style.borderColor=f;commonUpdateAfterChange(a,e)}}catch(g){}}
function fnHandler_VideoBorderColor_Detail(c,b,a){try{var d=getSelectionControl(a);-1==a&&(a=g_nActiveEditNumber);if(0!=commonExceptionCheck(c,b,a)){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=d.controlObject;if(!dzeUiConfig.bUseShapesFeature||!g_objSelectedShapesArray.length)if(f)f.id="dze_idx_ImageBorderColor_TargetElement";else return;duzon_dialog.nExtendsDlgType=DZE_EXTENDS_IMAGE_BORDER_COLOR;duzon_dialog.viewExtendsDlg(b,
a,function(d,e){var f=!0;"undefined"!=typeof e&&(f=e);e=null;if(0<g_objSelectedShapesArray.length)g_objShapeCmd.setShapesStrokeStyle(c,b,a)&&g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber);else if(e=g_objEditorDocument[a].getElementById("dze_idx_ImageBorderColor_TargetElement")){if(""==e.style.borderWidth||0==parseInt(e.style.borderWidth))null==e.style.border||""==e.style.border?e.style.border="1px solid":e.style.borderWidth="1px";e.style.borderColor=d}1==f&&(duzon_dialog.closeExtendsDlg(),
e&&commonUpdateAfterChange(a,e))},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(c){duzon_dialog.selectColorCode("#FFFFFF",b);if(c=g_objEditorDocument[a].getElementById("dze_idx_ImageBorderColor_TargetElement"))c.style.borderColor="#FFFFFF",c.removeAttribute("id");duzon_dialog.closeExtendsDlg();commonUpdateAfterChange(a,c)},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],
[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c){duzon_dialog.selectColorCode(c,b);if(!dzeUiConfig.bUseShapesFeature||!g_objSelectedShapesArray.length){if(f){if(""==f.style.borderWidth||0==parseInt(f.style.borderWidth))null==f.style.border||""==f.style.border?f.style.border="1px solid":f.style.borderWidth="1px";f.style.borderColor=c}commonUpdateAfterChange(a,f)}duzon_dialog.closeDialog()}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=
!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div","",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0);!0===g_bBrowserType_IE&&resetSelectionObjectInfo()}}catch(g){}}
function fnHandler_TableSelectCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&GetCurTable(a)&&(g_objTableSelection.table_SelectionCaretCell(a),updateTableHandlerUI.updateTableUIHandler(a))}catch(d){}}function fnHandler_TableSelectCol(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);d&&(g_objTableSelection.table_selectCol(d,a),g_objTableSelection.updateManualTableUIHandler(a))}}catch(e){}}
function fnHandler_TableSelectRow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);d&&(g_objTableSelection.table_selectRow(d,a),g_objTableSelection.updateManualTableUIHandler(a))}}catch(e){}}
function fnHandler_TableSelectTable(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&GetCurTable(a)&&(g_objLayerEventUtil.initHideDynamicLayer(),g_objTableMiniMenu.showTableMiniMenu(!1,null,a),g_objTableSelection.selectTable(a),updateTableHandlerUI.updateTableUIHandler(a))}catch(d){}}
function fnHandler_imageToTable(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&"undefined"!=typeof dzeUiConfig.bUseImageToTableMenu&&0!=dzeUiConfig.bUseImageToTableMenu&&"undefined"!=typeof dzeUiConfig.strImageToTableURL&&""!=dzeUiConfig.strImageToTableURL){g_objShapeFunction.onDeselectAllShapes();var d=getSelectionControl(a);if(null!=d.controlObject&&"undefined"!=typeof d.controlObject&&"img"==d.controlObject.nodeName.toLowerCase()){g_objCommonUtil.openWindowCommon("about:blank",
1200,800,!0,"targetWin");var e=document.createElement("form");e.action=dzeUiConfig.strImageToTableURL;e.method="post";e.target="targetWin";var f=document.createElement("input");f.type="hidden";f.name="imgSrc";f.value=d.controlObject.src;e.appendChild(f);document.body.appendChild(e);e.submit();document.body.removeChild(e)}else g_objCommonUtil.openWindowCommon(dzeUiConfig.strImageToTableURL,1200,800,!0,"targetWin")}}catch(g){}}
function fnHandler_TableAddNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=GetCurTable(a)){var d=!1;g_objTableSelection.doAllSelectedCell(function(a){var b=a.getElementsByTagName("p");if(0==b.length&&a.textContent){var c=a.textContent;var e=c.setComma();c!=e&&(d=!0,a.textContent=e)}for(a=0;a<b.length;a++)c=b[a].innerHTML,e=c.setComma(),c!=e&&(d=!0,b[a].innerHTML=e)});d&&g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableRemoveNumberFormat(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)&&null!=GetCurTable(a)){var d=!1;g_objTableSelection.doAllSelectedCell(function(a){var b=a.getElementsByTagName("p");if(0==b.length&&a.textContent){var c=a.textContent;var e=c.removeComma();c!=e&&(d=!0,a.textContent=e)}for(a=0;a<b.length;a++)c=b[a].innerHTML,e=c.removeComma(),c!=e&&(d=!0,b[a].innerHTML=e)});d&&g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){}}
function fnHandler_TableBorderThickness(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_THICKNESS,duzon_dialog.viewExtendsDlg(b,a))}catch(d){}}function fnHandler_TableBorderThickness_Detail(c,b,a){fnHandler_TableBorderThickness(c,b,a)}
function fnHandler_TableBorderType(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_TYPE,duzon_dialog.viewExtendsDlg(b,a))}catch(d){}}function fnHandler_TableBorderType_Detail(c,b,a){fnHandler_TableBorderType(c,b,a)}
function fnHandler_TableBorderColor(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(null!=d){var e=duzon_dialog.curr_table_border_backcolor[a],f=g_objTableUtil.getMatrix(d);if(f){var g=g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){g.setCellBorderColor(a,null,e,f)});commonUpdateAfterChange(a,d)}}}}catch(h){}}
function fnHandler_TableBorderColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(null!=d){var e=document.getElementById(b.id.replace(/_SUB/,""));TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=g_objTableUtil.getMatrix(d);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_TABLE_BORDER_COLOR;duzon_dialog.viewExtendsDlg(b,a,function(b,c){var e=!0;"undefined"!=typeof c&&(e=c);1==e&&duzon_dialog.closeExtendsDlg();f.init();var g=
g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){g.setCellBorderColor(a,null,b,f)});1==e&&commonUpdateAfterChange(a,d)},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(c){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("#FFFFFF",b);f.init();var e=g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){e.setCellBorderColor(a,null,"#FFFFFF",f)});commonUpdateAfterChange(a,d)},function(c){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,
"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");if(""!=c){duzon_dialog.selectColorCode(c,b);duzon_dialog.closeDialog();f.init();var e=g_objTableFunction;g_objTableSelection.doAllSelectedCell(function(a){e.setCellBorderColor(a,null,c,f)});commonUpdateAfterChange(a,d)}},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div",
"",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}],"toolbar",!0)}}}catch(g){}}function fnHandler_TableStyle(c,b,a){try{fnHandler_TableStyle_Detail(c,b,a)}catch(d){}}
function fnHandler_TableStyle_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),0!=commonExceptionCheck(c,b,a)){var d=GetCurTable(a);if(d){var e=document.getElementById(b.id.replace(/_SUB/,""));if(e.TBSTATE!=ID_STRING_NAME_GRAY){TBSetState(e,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);var f=TableStyleDlg,g=function(){var b=f.getSelectedIndex();0>b?alert(ID_RES_DIALOG_ALERT_SELECT_TABLE_STYLE):(g_objTableOperation.table_SetTableStyle(d,b),commonUpdateAfterChange(a,d),duzon_dialog.closeExtendsDlg())};
f.viewExtendsDlg(b,a,null,[ID_RES_PROP_BUILDER_BLOCK_PROP_ITEM_APPLY,ID_RES_DIALOG_BTN_CANCEL],[g,function(b){duzon_dialog.closeExtendsDlg();editor_onselectionchange(a)}],"",!0,f.getContent({title:!0}),function(a){f.onLoad(a,g,d)},"horizontal")}}}}catch(h){dalert(h)}}
function fnHandler_TBSetObjectHeight(c,b,a,d){try{if(c=!1,c=b===ID_COMMAND_SHAPE_HEIGHT?TBSetShapeWidthHeight(b,a):TBSetImageWidthHeight(a),d&&c&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(e){dalert(e)}}
function fnHandler_TBSetObjectWidth(c,b,a,d){try{if(c=!1,c=b===ID_COMMAND_SHAPE_WIDTH?TBSetShapeWidthHeight(b,a):TBSetImageWidthHeight(a),d&&c&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(e){dalert(e)}}
function TBSetImageWidthHeight(c){try{var b=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_WIDTH][2]+"_"+c),a=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_HEIGHT][2]+"_"+c);if(!0===fnObjectCheckNull(b)||!0===fnObjectCheckNull(a))return!1;var d=getSelectionControl(c).controlObject;!0===fnObjectCheckNull(d)&&(d=dze_menu_control.currControlObject);if(!0===fnObjectCheckNull(d)||"img"!=d.nodeName.toLowerCase())return!1;var e=parseFloat(b.value),f=parseFloat(a.value),
g=d.style.width,h=d.style.height;d.style.width=e+"px";d.style.height=f+"px";showExtOutline_ObjectElement(d,!0,!1,c);return g!==d.style.width||h!==d.style.height?!0:!1}catch(k){dalert(k)}}
function TBSetShapeWidthHeight(c,b){try{var a=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_SHAPE_WIDTH][2]+"_"+b),d=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_SHAPE_HEIGHT][2]+"_"+b);if(!0===fnObjectCheckNull(a)||!0===fnObjectCheckNull(d))return!1;var e=parseFloat(a.value),f=parseFloat(d.value),g=document.getElementById(g_arrConst[ID_COMMAND_FIXED_RATIO][2]+"_"+b);if("true"===g.getAttribute("fixed_ratio")){var h=1*g.getAttribute("ratio_value");c===ID_COMMAND_SHAPE_HEIGHT?
(e=1*(1/h*f).toFixed(2),a.value=e):c===ID_COMMAND_SHAPE_WIDTH&&(f=1*(e*h).toFixed(2),d.value=f)}e=Math.round(g_objCommonUtil.CMToPx(e));f=Math.round(g_objCommonUtil.CMToPx(f));for(c=0;c<g_objSelectedShapesArray.length;c++){var k=g_objSelectedShapesArray[c];g_objShapeFunction.onUpdateShapeSize(k,e,f,null);if("relative"===k.style.position.toLowerCase()){var l=g_objNodeUtil.getParentElement(k);if(!1===fnObjectCheckNull(l)&&!0===l.classList.contains("dze_shape_container")){var m=g_objShapeFunction.updateShapesContainer(k);
k.style.left=m[0];k.style.top=m[1]}}g_objWrapperOutlineUtil_Improved.updateOutline(k)}1===g_objSelectedShapesArray.length&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES);return!0}catch(n){dalert(n)}}function fnHandler_TBSetVideoHeight(c,b,a,d){try{TBSetVideoWidthHeight(b,c,a,d)}catch(e){dalert(e)}}function fnHandler_TBSetVideoWidth(c,b,a,d){try{TBSetVideoWidthHeight(b,c,a,d)}catch(e){dalert(e)}}
function TBSetVideoWidthHeight(c,b,a,d){try{var e=getSelectionControl(a).controlObject;if(e){var f=g_objVideoControl.getVideo(e);if(f){c=!1;var g=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_VIDEO_WIDTH][2]+"_"+a);if(g){var h=parseInt(g.value,10),k=parseInt(f.style.width||f.width);h&&k&&h!==k&&(f.removeAttribute("width"),f.style.width=h+"px",c=!0)}var l=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_VIDEO_HEIGHT][2]+"_"+a);if(l){var m=parseInt(l.value,10),n=parseInt(f.style.height||
f.height);m&&n&&m!==n&&(f.removeAttribute("height"),f.style.height=m+"px",c=!0)}if(c){if(d&&(g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer();var p=g_objWrapperOutlineResize.objExtSelectedInfo;p&&p.objElement===f&&showExtOutline_ObjectElement(f,!0,!1,a)}}}}catch(q){dalert(q)}}
function fnHandler_WebSearch(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=!0;dzeUiConfig.bSupportNewsEditor||(d=!1);d?fnHandler_rightOpenPanel(event,b,PANEL_MAIN_TYPE.DOC_WEBSEARCH,a):(dzeWebSearch.searchText=getSelectionTextValue(a).trim(),dzeWebSearch.viewWebSearchDialog(c,a))}}catch(e){dalert(e)}}
function fnHandler_ConvKorean(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&dzeWebSearch.convKorean(c,a)}catch(d){dalert(d)}}function fnHandler_RegistSchedule(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)}catch(d){dalert(d)}}
function fnHandler_Highlighter(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=duzon_dialog.curr_highlighter_backcolor[a];setEditAreaSelectionCollapse(a,"end");dzeHighlighter.setHighlightMode(a,d)}}catch(e){dalert(e)}}
function fnHandler_Highlighter_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),setEditAreaSelectionCollapse(a,"end"),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_HIGHLIGHTER_COLOR,duzon_dialog.viewExtendsDlg(b,a,function(b,c){var d=!0;"undefined"!=typeof c&&(d=c);1==d&&duzon_dialog.closeExtendsDlg();
dzeHighlighter.setHighlightMode(a,b)},[ID_RES_CONST_STRING_OTHER_COLOR],[function(d){duzon_dialog.viewDialog(c,a,ID_RES_PROP_TAG_STRING_COLOR,"<div id='dze_idx_detail_color_picker_div'></div>",2,[ID_RES_DIALOG_BTN_OK,ID_RES_ADJUST_VIEW_CLOSE],[function(){var c=dzeColorPallet.getColorCode("hex");""!=c&&(duzon_dialog.selectColorCode(c,b),duzon_dialog.closeDialog(),dzeHighlighter.setHighlightMode(a,c))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.closeExtendsDlg();var b=g_objPropertyUtil.getSelectionAttributeValue(a);
"undefined"!=typeof b&&null!=b&&duzon_dialog.initSelectionFontStyleList(b);dzeColorPallet.showButtons=!1;dzeColorPallet.initialize("dze_idx_detail_color_picker_div","",null);dzeColorPallet.showButtons=!0;dzeColorPallet.color_pallet_container_obj.style.padding="0px"},function(){},!0,"screen_center")}]))}}catch(e){dalert(e)}}
function fnHandler_OpenFileForm(c,b,a,d){try{if("undefined"!=typeof b&&null!=b&&""!=b.value){isEmptyEditorContents(d)||cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_DIALOG_CONFIRM_FILE_DELETE_CONTENT,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],null,function(){cmnMsg.hideMsg();b.value=""});c="dze_nm_if_filectl_"+d;var e=document.getElementById("dze_idx_if_filectl_"+d),f=document.getElementById("FRM_ID_"+g_arrConst[a][2]+"_"+d);f.target=c;f.action=dzeEnvConfig.strOpenFilePageURL;e.onload=function(){setEditorHTMLCode(e.contentWindow.document.body.innerHTML,
!1,d);fnHandler_InsertParagraph(d,"end");editor_onselectionchange(d);b.value=""};f.submit()}}catch(g){dalert(g)}}function fnHandler_pasteTableCell(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&dzeClipBoard.paste(a)}catch(d){dalert(d)}}
function fnHandler_OpenFileList(c,b,a){try{var d=function(){return duzon_dialog.getTabContents(3,[ID_RES_CONST_STRING_BROWSER_MY,ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST,ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST],[g.getFileListContainer(),""],[100,90,100],g_objPropTagTableCreate.buildTagTableCreateCommon(),[function(){g.openFileListOnload(a,CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE)},function(){g.openFileListOnload(a,CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST)},
function(){g.openFileListOnload(a,CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST)}])};-1==a&&(a=g_nActiveEditNumber);if(fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var e=oneffice.getAppEnvType(),f=e==APPENV.GW?ID_RES_CONST_STRING_FILE_OPEN:ID_RES_CONST_STRING_DOC_OPEN,g=e==APPENV.GW?oneffice.getListViewMgr():onefficeFileListMgr,h=e==APPENV.GW?d():g.getFileListContainer();duzon_dialog.viewDialog(c,a,f,h,1,[ID_RES_DIALOG_BTN_OK],[function(){var b=!1,
c=null;if(APPENV.GW==oneffice.getAppEnvType()&&(b=(b=$_("dze_open_merge"))&&b.checked)){var d=$_("dze_merge_doc_container");c=[];d=d.childNodes;for(var e=0;e<d.length;e++)c.push(d[e].getAttribute("doc_no"))}if(b&&c&&0<c.length)onefficeGW.getFileContentList(c,function(b){g_objPageControl.mergeDocument(b);g_objUndoRedo.registerUndoRedoStack(0,a);duzon_dialog.closeDialog()});else onefficeUtil.onFileListCloseClick(a)}],function(){e==APPENV.GW?duzon_dialog.viewTabContents(0):g.openFileListOnload(a);duzon_dialog.initSelectedItemContainer([])},
function(){},!0,"screen_center")}}catch(k){dalert(k)}}
function fnHandler_saveRemoteSimple(){try{if(""!=oneffice.currFileSeq&&""!=oneffice.currFileSubject){var c=getEditorHTMLCode(!1,g_nActiveEditNumber,!0,!0);onefficeUtil.checkSameContent(c)?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOT_MODIFIED,1.5):(onefficeUtil.showDocSubject(ID_RES_CONST_STRING_SAVING_DATA),onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,c,g_nActiveEditNumber,function(){onefficeUtil.setSavedContent(c);onefficeGW.setCurrFileInfo(oneffice.currFileSeq,
oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate);onefficeUtil.updateProgressBar(!0)},!0))}else duzon_dialog.viewDialog(evnt,g_nActiveEditNumber,ID_RES_CONST_STRING_SAVE_REMOTE,duzon_dialog.getFileSubjectInputFormContainer(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){onSaveOkClick(g_nActiveEditNumber)},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.getFileSubjectInputFormOnload(g_nActiveEditNumber)},function(){},!0,"screen_center")}catch(b){dalert(b)}}
function fnHandler_SaveFileRemote(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a])if(!0===dzeUiConfig.bIndependentEdit)!0===onefficeExtContent.extNewDoc?fnHandler_SaveAsRemote(c,b,a):onefficeExtContent.saveContent(a,function(){});else if("undefined"!==typeof g_objPageControl&&g_objPageControl.updateDirtyPageAll(),0==(oneffice.getAppEnvType()==APPENV.GW?!1:!0))if(""!=oneffice.currFileSeq&&""!=oneffice.currFileSubject){var d=getEditorHTMLCode(!1,
a,!0,!0);onefficeUtil.checkSameContent(d)?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOT_MODIFIED,1.5):(onefficeUtil.showDocSubject(ID_RES_CONST_STRING_SAVING_DATA),onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,d,a,function(){onefficeUtil.setSavedContent(d);onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate);onefficeUtil.updateProgressBar(!0)},!0,function(){onefficeUtil.showDocSubject();
onefficeUtil.updateProgressBar(!0,!0)}))}else duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_SAVE_REMOTE,duzon_dialog.getFileSubjectInputFormContainer(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){onSaveOkClick(a)},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.getFileSubjectInputFormOnload(a)},function(){},!0,"screen_center");else d=getEditorHTMLCode(!1,a,!0,!0),onefficeUtil.checkSameContent(d)?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOT_MODIFIED,1.5):
(oneffice.currFolderSeq="",onefficeWE.saveFileProcess(d,function(){onefficeUtil.setSavedContent(d);onefficeUtil.updateProgressBar(!0);g_onefficeWeTool.reqListSave(!0)},function(){}))}catch(e){dalert(e)}}
function onSaveOkClick(c){try{var b=document.getElementById("dze_idx_file_save_remote_subject").value.trim();if(""==b)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ENTER_SUBJECT,1.5),document.getElementById("dze_idx_file_save_remote_subject").focus();else{var a=getEditorHTMLCode(!1,c,!0);duzon_dialog.closeDialog();onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,b,a,c,function(){onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,b,oneffice.currFileRegDate);
cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SAVED,1.5)})}}catch(d){dalert(d)}}
function fnHandler_SaveAsRemote(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_SAVEAS_REMOTE,onefficeGW.getSaveAsRemoteContainer(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){if(!0===onefficeExtContent.extNewDoc)onefficeExtContent.extSaveAsRemoteOkClick(a);else if(!0===oneffice.bTempLoadedContent)onefficeExtContent.extSaveAsRemoteOkClick(a,function(){onefficeUtil.removeTempDataFromLocalStorage(oneffice.currFileSeq);
if(1==oneffice.bBackupLoadedContent){var a=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(oneffice.currFileSeq,"","");document.location=a}else document.location.reload()});else onefficeGW.onSaveAsRemoteOkClick(a)},function(){onefficeGW.onSaveAsRemoteCancelClick(a)}],function(){onefficeGW.getSaveAsRemoteDialogOnload(a,!0)},function(){},!0,"screen_center")}catch(d){dalert(d)}}
function fnHandler_pageSetting(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(g_objShapeFunction.onDeselectAllShapes(),duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_PAGE_SETUP,function(){return duzon_dialog.getTabContents(2,[ID_RES_DIALOG_STRING_MARGIN,ID_RES_CONST_STRING_PAPER],[dzeLayoutControl.getPrintSettingContainer(),dzeLayoutControl.getPaperDirectionContainer()],[60,60],g_objPropTagTableCreate.buildTagTableCreateCommon(),[function(){var a=
{top:$_("dze_print_margin_top").value,left:$_("dze_print_margin_left").value,right:$_("dze_print_margin_right").value,bottom:$_("dze_print_margin_bottom").value};dzeLayoutControl.viewPreviewPrintMarginAll(a)},function(){}])}(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){duzon_dialog.closeDialog();dzeLayoutControl.applyPaperSizeProperty(a,{width:dzeLayoutControl.m_ctrlPaperDlgPreviewDiv.style.width,height:dzeLayoutControl.m_ctrlPaperDlgPreviewDiv.style.height});dzeLayoutControl.setNewPrintMargin(a);
dzeLayoutControl.setOnePageMode(a);dzeLayoutControl.setDocPgOverflow(a);dzeLayoutControl.setPaperBackground(a);dzeLayoutControl.setEditAreaSize(a,!0);g_objHeaderFooter.setHeaderOverflowBlinderStyle();g_objPageControl.changeCssPageBreakAfter(a);setFirstQRPosition(a);dzeUiConfig.bOfficePagingMode&&(g_objPageControl.clearUpdatePageTimer(),g_objPageControl.onSetDelayedUpdatePageTimerAll(0,function(){var b=g_objCaretUtil.getPageNum(a);g_objPageControl.currentPage=b.start;null!==b.start&&g_objCaretUtil.scrollToCaret()}));
g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);g_objRulerBar.update(a,!0)},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(0);dzeLayoutControl.initPrintSetting(a)},function(){},!0,"screen_center"))}catch(d){dalert(d)}}function fnHandler_ConvertEleToImg(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)}catch(d){dalert(d)}}
function fnHandler_Chart(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=!1,e=null,f=null;if(!GetMultiCellSelection(a)){var g=null,h=getSelectionControl(a);if(null!=h.controlObject&&"undefined"!=typeof h.controlObject&&"img"==h.controlObject.nodeName.toLowerCase()&&(g=h.controlObject,g.getAttribute("chart_id")&&g.getAttribute("chart_data"))){var k=g.getAttribute("chart_data");null!=k&&""!=k&&(d=!0,e=g.offsetWidth,f=g.offsetHeight)}}duzon_dialog.viewDialog(c,
a,ID_RES_CONST_STRING_INSERT_CHART,onefficeChart.getChartDlgContainer(!1),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){if(!0===dzeUiConfig.bSupportNewsEditor){var b=dzeJ("#id_image_description");if(0!==b.length&&(!0===fnObjectCheckNull(b.val())||""===b.val())){cmnCtrlToast.showToastMsg(null,"\ud0a4\uc6cc\ub4dc/\uc124\uba85\uc744 \uc785\ub825\ud558\uc138\uc694.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR);return}}onefficeChart.setInsertChartMode(a,g);!0!==d&&cmnCtrlToast.showToastMsg(null,
ID_RES_CONST_STRING_CLICK_INSERT_POSITION,1.5);duzon_dialog.closeDialog()},function(){duzon_dialog.closeDialog()}],function(){onefficeChart.initialize();!0===d?(onefficeChart.convStringToChartData(k),onefficeChart.makeChart(e,f)):(onefficeChart.makeChartData(),onefficeChart.makeChart());onefficeChart.chartTypeClickEvent();onefficeChart.addChartDialogEvent()},function(){onefficeChart.removeChartDialogEvent()},!0,"screen_center")}}catch(l){dalert(l)}}
function fnHandler_PasteCell(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){c=0;switch(b.command_id){case ID_COMMAND_PASTE_CELL_INSERT:c=INSERT_AS_NEW_ROWS;break;case ID_COMMAND_PASTE_CELL_OVER_ALL:c=PASTE_CELL_FORMMAT;break;case ID_COMMAND_PASTE_CELL_OVER_CONTENT:c=KEEP_ORG_TABLE_FORMMAT;break;case ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE:c=INSERT_AS_NESTED_TABLE;break;default:return}g_bBrowserType_IE&&dzeUiConfig.bUsePasteCapture?(dzeClipBoard.pasteType=
c,g_objCopyPaste.pasteClick(a)&&g_objEditorDocument[a].execCommand("paste",!1,null)):dzeClipBoard.copyData.length?(dzeClipBoard.pasteType=c,c==INSERT_AS_NEW_ROWS?dzeClipBoard.paste_insert(a,!0):dzeClipBoard.paste(a,!0),dzeClipBoard.pasteType=0):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NO_CELL_COPIED,1.5)}}catch(d){dalert(d)}}
function fnHandler_slideShow(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=!1;341==b.command_id&&(d=!0);fnTool_TabMode_Preview(c,b,ID_TB_TABMODE_PREVIEW,a,!0,d)}}catch(e){dalert(e)}}
function fnHandler_DocumentSecuritySetting(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a])if(""==oneffice.currFileSubject)cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SAVE_DOCUMENT_FIRST,1);else{var d=oneffice.currFileSecurityStatus;duzon_dialog.viewDialog(c,a,d?ID_RES_CONST_STRING_DOCUMENT_SECURITY_RESET:ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING,onefficeGW.getDocumentSecuritySettingContainer(d),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
[function(){onefficeGW.onDocumentSecuritySettingOkClick(oneffice.currFileSeq,d)},function(){duzon_dialog.closeDialog()}],function(){onefficeGW.onDocumentSecuritySettingDialogOnload(d)},function(){},!0,"screen_center")}}catch(e){dalert(e)}}
function fnHandler_protect_privacy(c,b,a){try{var d=function(){var a=g();if(0<a.length){var b=g_objEditWindow[g_objPageControl.nEditNumber].getSelection().anchorNode,c=null,d=0;if(b&&(b.innerText||ID_SELECTION_TEXT_NODE==b.nodeType&&b.data))for(var n=0;n<a.length;n++){var p=ID_SELECTION_TEXT_NODE==b.nodeType?b.data:b.innerText;if(duzon_dialog.idx_privacy_etc==a[n]){var q=document.getElementById("dze_idx_privacy_etc_input").value;p=p.match(q)}else p=a[n].exec(p);if(p){c=p[0];d=g_objPageControl.getPrivatePatternType(a[n]);
break}}c?(a=g_objLayerKit.getElementById("dze_idx_privacy_password_input").value,fnObjectCheckNull(a)||0===a.length?(alert(ID_RES_CONST_STRING_INPUT_PASSWORD),g_objLayerKit.getElementById("dze_idx_privacy_password_input").focus()):-1===f(b,c,a,d)&&alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR)):e()}else alert(ID_RES_CONST_STRING_ALERT_SELECT_PRIVACY)},e=function(){var a=g(),b=null,c=null;if(0<a.length){if(b=g_objPageControl.checkMatchTextByPattern(a))c=b.text;null===c&&cmnMsg.showMsg(MESSAGE_CONFIRM,ID_RES_DIALOG_CONFIRM_FIND_END,
null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();if(b=g_objPageControl.checkMatchTextByPattern(a,!0))c=b.text;null===c&&alert(ID_RES_DIALOG_ALERT_FIND_NOTHING)})}else alert(ID_RES_CONST_STRING_ALERT_SELECT_PRIVACY)},f=function(a,b,c,d){var e=0,f=0;ID_SELECTION_TEXT_NODE==a.nodeType&&(a=a.parentNode);0===d?e=b.length-4:1===d?(e=2,f=b.indexOf("@")):2===d&&(e=8);d=b.substring(0,e);e=0<f?b.length-e-(b.length-f):b.length-e;for(var g=0;g<e;g++)d=1==g_objLayerKit.getElementById(duzon_dialog.idx_privacy_type_1).checked?
d+"*":1==g_objLayerKit.getElementById(duzon_dialog.idx_privacy_type_2).checked?d+"~":d+"X";0<f&&(d+=b.substring(f,b.length));f=a.innerText;a.innerText=a.innerText.replace(b,d);if(f!==a.innerText)a.setAttribute("privacyProtect",CryptoJS.AES.encrypt(b,c)),a.setAttribute("privacyKey",CryptoJS.MD5(c).toString()),a.setAttribute("privacyMark",d),a.style.cursor="no-drop";else return-1},g=function(){var a=[],b=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_phone_number).checked,c=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_e_mail).checked,
d=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_rr_number).checked,e=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_fr_number).checked,f=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_credit_card).checked,g=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_birth_date).checked,t=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_ip_address).checked,r=g_objLayerKit.getElementById(duzon_dialog.idx_privacy_etc).checked;if(b||c||d||e||f||g||t||r)b&&a.push(duzon_dialog.privacy_pattern_phone),
c&&a.push(duzon_dialog.privacy_pattern_email),d&&a.push(duzon_dialog.privacy_pattern_rrnumber),e&&a.push(duzon_dialog.privacy_pattern_frnumber),f&&a.push(duzon_dialog.privacy_pattern_credit_card),g&&a.push(duzon_dialog.privacy_pattern_birth_date),t&&a.push(duzon_dialog.privacy_pattern_ip_address),r&&a.push(duzon_dialog.idx_privacy_etc);return a};-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&!1!==dzeUiConfig.bOfficePagingMode&&duzon_dialog.viewDialog(c,
a,ID_RES_CONST_STRING_PROTECT_PRIVACY,duzon_dialog.getProtectPrivacyContent(),4,[ID_RES_CONST_STRING_EDIT_SEARCH,ID_RES_CONST_STRING_PROTECT,ID_RES_CONST_STRING_PROTECT_ALL,ID_RES_ADJUST_VIEW_CLOSE],[function(a){dlog("func : \ucc3e\uae30");e()},function(b){dlog("func : \ubcf4\ud638\ud558\uae30");d();g_objUndoRedo.registerUndoRedoStack(0,a)},function(b){dlog("func : \ubaa8\ub450 \ubcf4\ud638");a:{b=g();var c,d=null,e=-1,h=0;if(0<b.length){var p=g_objLayerKit.getElementById("dze_idx_privacy_password_input").value;
if(fnObjectCheckNull(p)||0===p.length)alert(ID_RES_CONST_STRING_INPUT_PASSWORD),g_objLayerKit.getElementById("dze_idx_privacy_password_input").focus();else{if(c=g_objPageControl.checkMatchTextByPattern(b,!0))d=c.text,e=c.type;if(null===d)alert(ID_RES_DIALOG_ALERT_FIND_NOTHING);else{for(;c&&d;){if(-1===f(g_objEditWindow[g_objPageControl.nEditNumber].getSelection().anchorNode,d,p,e)){alert(ID_RES_DIALOG_ALERT_REPLACE_ERROR);break a}h++;if(c=g_objPageControl.checkMatchTextByPattern(b,!0))d=c.text,e=
c.type}alert(String.format(ID_RES_CONST_STRING_NOTI_MARKING_PRIVACY_COUNT,h))}}}else alert(ID_RES_CONST_STRING_ALERT_SELECT_PRIVACY)}g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){dlog("func : \ub2eb\uae30");duzon_dialog.closeDialog()}],function(){duzon_dialog.resetSelection=!0;duzon_dialog.isFindDialog=!0;g_objLayerKit.getElementById("dze_idx_privacy_password_input").onkeydown=function(b){ID_KEYCODE_ENTER==b.keyCode&&(d(),g_objUndoRedo.registerUndoRedoStack(0,a))}},function(){},!0)}catch(h){dalert(h)}}
function fnHandler_disable_privacy(c,b,a){try{var d=function(){var a=g_objEditWindow[g_objPageControl.nEditNumber].getSelection().anchorNode;ID_SELECTION_TEXT_NODE==a.nodeType&&(a=a.parentNode);var b=a.getAttribute("privacyKey"),c=a.getAttribute("privacyMark"),d=a.getAttribute("privacyProtect");if(!(0<b.length&&0<c.length&&0<d.length))return alert(ID_RES_CONST_STRING_DISABLE_PRIVACY_FAIL),!1;var k=g_objLayerKit.getElementById("dze_idx_privacy_password_input").value;if(fnObjectCheckNull(k)||0===k.length)return alert(ID_RES_CONST_STRING_INPUT_PASSWORD),
g_objLayerKit.getElementById("dze_idx_privacy_password_input").focus(),!1;if(b!==CryptoJS.MD5(k).toString())return alert(ID_RES_CONST_STRING_NOTI_CHECK_PASSWORD_ERROR),g_objLayerKit.getElementById("dze_idx_privacy_password_input").focus(),!1;b=CryptoJS.AES.decrypt(d,k).toString(CryptoJS.enc.Utf8);if(0<b.length){d=a.innerHTML;a.innerHTML=a.innerHTML.replace(c,b);if(d===a.innerHTML)return alert(ID_RES_CONST_STRING_DISABLE_PRIVACY_FAIL),!1;a.removeAttribute("privacyKey");a.removeAttribute("privacyMark");
a.removeAttribute("privacyProtect");a.style.cursor="";return!0}return!1};-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_PROTECT_PRIVACY,duzon_dialog.getDisablePrivacyContent(),2,[ID_RES_CONST_STRING_CLEAR,ID_RES_ADJUST_VIEW_CLOSE],[function(a){dlog("func : \uac1c\uc778\uc815\ubcf4 \ubcf4\ud638\ud574\uc81c");d()&&(duzon_dialog.closeDialog(),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DISABLE_PRIVACY_DONE,
1))},function(a){dlog("func : \ucde8\uc18c");duzon_dialog.closeDialog()}],function(){g_objLayerKit.getElementById("dze_idx_privacy_password_input").onkeydown=function(a){ID_KEYCODE_ENTER==a.keyCode&&d()&&(duzon_dialog.closeDialog(),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DISABLE_PRIVACY_DONE,1))}},function(){},!0,"center")}catch(e){dalert(e)}}function fnHandler_privacyChangePassword(c){}
function updateSecurityButtonByStatus(c){try{var b=g_objLayerKit.getElementById("TB_DOCUMENT_SECURITY_SETTING_"+c);if(b)if(oneffice.currFileSecurityStatus){b.title=ID_RES_CONST_STRING_DOCUMENT_SECURITY_RESET;var a=b.getElementsByTagName("img");a[0]&&(a[0].src=dzeEnvConfig.strPath_Image+"ribbon/ico_document_unlock.png");b.childNodes[1]&&(b.childNodes[1].innerHTML=ID_RES_CONST_STRING_DOCUMENT_SECURITY_RESET.replace(" ","<BR>"));var d=document.getElementById("TB_MENU_SECURITY_BTN_"+c);d&&(d.style.display=
"",d.nextSibling.style.display="",dze_menu_control.resizePropertyTableInfo(dze_menu_control.ui_mode,c))}else if(b.title=ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING,a=b.getElementsByTagName("img"),a[0]&&(a[0].src=dzeEnvConfig.strPath_Image+"ribbon/ico_document_lock.png"),b.childNodes[1]&&(b.childNodes[1].innerHTML=ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING.replace(" ","<BR>")),d=document.getElementById("TB_MENU_SECURITY_BTN_"+c))d.style.display="none",d.nextSibling.style.display="none",dze_menu_control.resizePropertyTableInfo(dze_menu_control.ui_mode,
c)}catch(e){dalert(e)}}
function fnHandler_onefficeConnect(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(""==oneffice.currFileSubject?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SAVE_DOCUMENT_FIRST,1):!fnObjectCheckNull(oneffice.parentFileContent.my_id)&&oneffice.parentFileContent.my_id==oneffice.parentFileContent.owner_id||"S"==oneffice.parentFileContent.share_perm?onefficeGW.setShareDocumentOnEditor(c,a):showDialogDocumentShareInfo(c,oneffice.currFileSeq))}catch(d){dalert(d)}}
function fnHandler_shareFax(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_SHARE_FAX,function(){try{var a="<div tsyle=\"width:424px; height:329px; overflow:auto; background-image:url('./image/temp_fax_box.png')\">";a+='\t\t<img style="width:424px; height:329px;" src="./image/temp_fax_box.png"></img>';a+='\t<div style="position:absolute; left:80px; top:130px;">';a+='\t\t<img style="width:299px; height:158px;" src="./image/fax_gif.gif"></img>';
a+='\t\t<div style="width:100%; padding:15px 0; text-align:center; color:red; font-size:large;">\ud604\uc7ac \uc900\ube44\uc911\uc778 \uae30\ub2a5\uc785\ub2c8\ub2e4.</div>';return a+"\t</div></div>"}catch(e){dalert(e)}}(),1,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0,"center")}catch(d){dalert(d)}}
function fnHandler_downloadPdf(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),1!=fnObjectCheckNull(d)&&0!=d||fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){"undefined"!==typeof g_objPageControl&&g_objPageControl.updateDirtyPageAll();var e=getEditorHTMLCode(!1,a,!0,!0),f=parseInt(a,10)+DZE_IFRAME_TMP_NO,g=g_objEditorDocument[f];replaceEditorTempTagsFromEditor(f);g_objTableUtil.removeAllDzeTable(g.body);g_objVideoControl.convVideoToImageForPrint(g.body,g_objEditorDocument[a].body);makePrintableContent(g,
!0);var h="portrait";dzeUiConfig.nSettingPaperSize.width>dzeUiConfig.nSettingPaperSize.height&&(h="landscape");setFullUrlAttachFiles(g);duzon_http.showLoading();setTimeout(function(){try{duzon_http.hideLoading();var b=g.documentElement.outerHTML;b=b.replace(/break\-after:\s*page;/gi,"page-break-after: always;");var c=document.createElement("form");c.action=dzeEnvConfig.strDownloadPdfURL;c.method="post";var m=document.createElement("textarea");m.name="content";m.value=b;c.appendChild(m);var n=document.createElement("input");
n.type="text";n.name="subject";n.value=oneffice.currFileSubject?oneffice.currFileSubject:oneffice.unTitleMsg+"_"+oneffice.currFileRegDate.replace(/:/g,"").substr(5,oneffice.currFileRegDate.length).replace(/\s/g,"_");c.appendChild(n);var p=document.createElement("input");p.type="text";p.name="printLayout";p.value=h;c.appendChild(p);var q=document.createElement("input");q.type="text";q.name="printHeader";q.value="0mm";c.appendChild(q);var t=document.createElement("input");t.type="text";t.name="printFooter";
t.value="0mm";c.appendChild(t);var r=document.createElement("input");r.type="text";r.name="printMargin";r.value="0mm";c.appendChild(r);var u=dzeUiConfig.sSettingPaperColor;""==u&&(u="#FFFFFF");var v=document.createElement("input");v.type="text";v.name="paperColor";v.value=u;c.appendChild(v);if(!0===g_browserCHK.iOS)document.body.appendChild(c),window.open("","pdfWin"),c.target="pdfWin";else{var w=document.getElementById("dze_idx_if_filectl_"+a);w.contentWindow.document.body.appendChild(c)}duzon_http.ajax({type:"post",
url:dzeEnvConfig.strDownloadPdfURL,async:!0,dataType:"json",data:dzeJ(c).serialize(),timeout:3E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){try{if(d)openWriteMailView(oneffice.currFileSubject+".pdf",a.data);else if(g_bBrowserType_IE)window.open(a.data.url,"_blank");else{var b=document.createElement("a");b.setAttribute("download",oneffice.currFileSubject+".pdf");b.setAttribute("href",a.data.url);b.setAttribute("target","_blank");b.click()}}catch(y){dalert("error:data mapping")}finally{duzon_http.hideLoading()}},
error:function(a){404===a.status?dalert(a.msg+"\nwrong address"):dalert("error:internal server error");duzon_http.hideLoading()}});!0===g_browserCHK.iOS?setTimeout(function(){document.body.removeChild(c)},2E3):w.contentWindow.document.body.removeChild(c)}catch(x){duzon_http.hideLoading(),g_objEditorDocument[f].body.innerHTML=e}},0)}}catch(k){dalert(k)}}function fnHandler_onefficeFileReload(c){try{onefficeGW.onefficeFileReload(oneffice.parentFileContent.seq,c)}catch(b){dalert(b)}}
function fnHandler_viewPageZoomDlg(c,b,a,d){try{ZoomDlg.viewDialog(c,a,ID_RES_CONST_STRING_DOC_ZOOM,ZoomDlg.getZoomDialogContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){ZoomDlg.setSelectedZoomValue(a);duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}],function(){ZoomDlg.initZoomDialogContent()},function(){},!0,d)}catch(e){dalert(e)}}
function fnHandler_getRemoteSiteContent(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_GET_REMOTE_SITE_CONTENT,dzeWebSearch.viewRemoteSiteContentDialog(a),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0,"screen_center")}catch(d){dalert(d)}}
function fnHandler_setSecureGrade(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);if(b.TBSTATE==ID_STRING_NAME_GRAY)return!1;duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_DOC_SECURE_GRADE,dzeLayoutControl.getIDocSecureGradeContainer(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){dzeLayoutControl.setSecureGradeInfo(a);duzon_dialog.closeDialog()},function(a){duzon_dialog.closeDialog()}],function(){dzeLayoutControl.initializeSecureGradeInfo(a)},function(){},!0,"screen_center")}catch(d){dalert(d)}}
function fnHandler_ObjTxtLayout(c,b,a){try{-1==a&&(a=g_nActiveEditNumber);var d=b.command_id;"string"==typeof d&&(d=parseFloat(d));if((d!==ID_COMMAND_SHAPES_LAYOUT||b.nodeName.toLowerCase()!==DZE_TAG_TR)&&fnHandler_CommonCheck_DynamicLayer_1(c,b,a))switch(d){case ID_COMMAND_SHAPES_LAYOUT:fnHandler_ObjTxtLayout_Detail(c,b,a);break;case ID_COMMAND_TXTLAYOUT_OTHERS:fnHandler_ShapesLayout_Dialog(c,b,a,!1);break;default:g_objShapeCmd.setShapesLayoutMode(d);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();
g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){dalert(e)}}
function fnHandler_ShapesLayout_Dialog(c,b,a,d){try{!1!==dzeUiConfig.bUseShapesFeature&&(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!1!==g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_TOOL_STRING_MENU_LAYOUT,duzon_dialog.getTabContents(2,[ID_RES_CONST_STRING_SHAPES_PLACING,ID_RES_DIALOG_STRING_SIZE],[duzon_dialog.createShapesLayout_Place(),duzon_dialog.createShapesLayout_Size()],[80,60],g_objPropTagTableCreate.buildTagTableCreateCommon()),2,[ID_RES_DIALOG_BTN_OK,
ID_RES_DIALOG_BTN_CANCEL],[function(){duzon_dialog.closeDialog();var b=duzon_dialog.getUpdatedShapesLayoutData();0<b.length&&(g_objShapeFunction.onUpdateChangedLayout(b),panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a))},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.viewTabContents(!0===d?1:0);duzon_dialog.initShapeLayoutDialog()},function(){},!0))}catch(e){dalert(e)}}
function fnHandler_ObjTxtLayout_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_OBJ_TXT_LAYOUT,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}
function fnHandler_ObjTxtVAlign(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command_id;switch(d){case ID_COMMAND_SHAPES_TEXT_VERTICAL_ALIGN:fnHandler_ObjTxtVAlign_Detail(c,b,a);break;default:switch(d){case ID_COMMAND_OBJ_TXT_VALIGN_TOP:var e="top";break;case ID_COMMAND_OBJ_TXT_VALIGN_MIDDLE:e="middle";break;case ID_COMMAND_OBJ_TXT_VALIGN_BOTTOM:e="bottom"}g_objShapeCmd.setShapesVerticalAlign(e);panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES);
g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(f){dalert(f)}}function fnHandler_ObjTxtVAlign_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_OBJ_TXT_VALIGN,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}
function fnHandler_ObjAlign(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command_id;switch(d){case ID_COMMAND_SHAPES_ALIGN:fnHandler_ObjAlign_Detail(c,b,a);break;default:!0===g_objShapeCmd.setShapesAlign(d)&&g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(e){dalert(e)}}
function fnHandler_ObjAlign_Detail(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_OBJ_ALIGN,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}
function fnHandler_ObjRotationList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=b.command_id;switch(d){case ID_COMMAND_SHAPES_ROTATE:fnHandler_ObjRotationList_Detail(c,b,a);break;case ID_COMMAND_ROTATE_OTHERS:fnHandler_ShapesLayout_Dialog(c,b,a,!0);break;default:g_objShapeCmd.setShapesRotation(d),panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(e){dalert(e)}}
function fnHandler_ObjRotationList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_ROTATION_LIST,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}function fnHandler_ShapeStyle(c,b,a){try{fnHandler_ShapeStyle_Detail(c,b,a)}catch(d){dalert(d)}}
function fnHandler_ShapeStyle_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_SHAPE_STYLE,duzon_dialog.makeExtendsDlgInfo(),duzon_dialog.viewExtendsDlg(b,a,null,null,null,"toolbar",null))}}catch(e){dalert(e)}}
function fnHandler_ShapeFillColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&0<g_objSelectedShapesArray.length&&!0===g_objShapeCmd.setShapesFillColor(duzon_dialog.curr_txbx_fillcolor[a])&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(d){dalert(d)}}
function fnHandler_ShapeFillColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&0!==g_objSelectedShapesArray.length){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(b,c){(c=fnObjectCheckNull(c)?!0:c)&&duzon_dialog.closeExtendsDlg();!0===
g_objShapeCmd.setShapesFillColor(b,!c)&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),c&&g_objUndoRedo.registerUndoRedoStack(0,a))},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR],[function(){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("",b);!0===g_objShapeCmd.setShapesFillColor(duzon_dialog.curr_txbx_fillcolor[a])&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a))},function(){var c=g_objShapeCmd.getShapesFillColor(g_objSelectedShapesArray[0]);
c=dzeColorPallet.rgbToHexa(c);duzon_dialog.viewDetailColorPicker(c,function(c){""!==c&&(duzon_dialog.closeExtendsDlg(),duzon_dialog.selectColorCode(c,b),!0===g_objShapeCmd.setShapesFillColor(c)&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a)))})}],"toolbar",!0))}}catch(e){dalert(e)}}
function fnHandler_ShapeBorderColor(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&g_objShapeCmd.setShapesStrokeColor(duzon_dialog.curr_txbx_linecolor[a])&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber))}catch(d){dalert(d)}}
function fnHandler_ShapeBorderColor_Detail(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&0!==g_objSelectedShapesArray.length){var d=document.getElementById(b.id.replace(/_SUB/,""));d.TBSTATE!=ID_STRING_NAME_GRAY&&(TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN),duzon_dialog.nExtendsDlgType=DZE_EXTENDS_COLOR_PICKER,duzon_dialog.viewExtendsDlg(b,a,function(a,b){(b=fnObjectCheckNull(b)?!0:b)&&duzon_dialog.closeExtendsDlg();
g_objShapeCmd.setShapesStrokeColor(a,!b)&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),b&&g_objUndoRedo.registerUndoRedoStack(0,duzon_dialog.nEditNumber))},[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR,ID_RES_CONST_STRING_LINE_WIDTH,ID_RES_CONST_STRING_LINE_STYLE,ID_RES_CONST_STRING_CHARACTER_ARROW],[function(){duzon_dialog.closeExtendsDlg();duzon_dialog.selectColorCode("",b);!0===g_objShapeCmd.setShapesStrokeColor(duzon_dialog.curr_txbx_linecolor[a])&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),
g_objUndoRedo.registerUndoRedoStack(0,a))},function(){var c=g_objShapeCmd.getShapesStrokeColor(g_objSelectedShapesArray[0]);c=dzeColorPallet.rgbToHexa(c);duzon_dialog.viewDetailColorPicker(c,function(c){""!==c&&(duzon_dialog.closeExtendsDlg(),duzon_dialog.selectColorCode(c,b),!0===g_objShapeCmd.setShapesStrokeColor(c)&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,a)))})},null,null,null],"toolbar",!0))}}catch(e){dalert(e)}}
function fnHandler_BringForwardList(c,b,a){try{fnHandler_BringForward(c,b,a)}catch(d){dalert(d)}}function fnHandler_BringForwardList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_BRING_FORWARD,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}function fnHandler_SendBackwardList(c,b,a){try{fnHandler_SendBackward(c,b,a)}catch(d){dalert(d)}}
function fnHandler_SendBackwardList_Detail(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_SEND_BACKWARD,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}function fnHandler_BringForward(c,b,a){try{g_objShapeFunction.layerController.moveToBackAndForth(g_objSelectedShapesArray[0],!0)}catch(d){dalert(d)}}
function fnHandler_BringToFront(c,b,a){try{g_objShapeFunction.layerController.moveToEdge(g_objSelectedShapesArray[0],!0)}catch(d){dalert(d)}}function fnHandler_SendBackward(c,b,a){try{g_objShapeFunction.layerController.moveToBackAndForth(g_objSelectedShapesArray[0],!1)}catch(d){dalert(d)}}function fnHandler_SendToBack(c,b,a){try{g_objShapeFunction.layerController.moveToEdge(g_objSelectedShapesArray[0],!1)}catch(d){dalert(d)}}
function fnHandler_InsertShapes_Detail(c,b,a){try{fnHandler_InsertShapes(c,b,a)}catch(d){dalert(d)}}
function fnHandler_InsertShapes(c,b,a){try{if(!1!==dzeUiConfig.bUseShapesFeature&&(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!1!==g_bEditMode[a])){var d=document.getElementById(b.id.replace(/_SUB/,""));if(d.TBSTATE!=ID_STRING_NAME_GRAY){if(1*d.getAttribute("orgcommandid")===ID_COMMAND_SHAPES_CHANGE){var e=g_objShapeEvtMgr.getShapeTextContainer();if(null!==e){var f=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(e.parentNode));
!1===fnObjectCheckNull(f)&&(g_objWrapperOutlineUtil_Improved.updateShapeText(f,!0),g_objWrapperOutlineUtil_Improved.hideTextBox(f))}}else g_objShapeFunction.onDeselectAllShapes();g_objWrapperOutlineResize.resetExtOutlineInfo();g_objTableFlag.ResetTableInfo(!1);g_objTableMiniMenu.showTableMiniMenu(!1,null,a);TBSetState(d,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_DROPDOWN);duzon_dialog.nExtendsDlgType=DZE_EXTENDS_SHAPES;duzon_dialog.makeExtendsDlgInfo();duzon_dialog.viewExtendsDlg(b,a,null,null,null,
"toolbar",null)}}}catch(g){dalert(g)}}function fnHandler_showShapesPanel(c,b,a){try{fnHandler_rightOpenPanel(c,b,PANEL_MAIN_TYPE.DOC_SHAPES,a)}catch(d){dalert(d)}}function fnHandler_showNewsSendInfoPanel(c,b,a){try{fnHandler_rightOpenPanel(c,b,PANEL_MAIN_TYPE.NEWS_SEND_INFO,a)}catch(d){dalert(d)}}function fnHandler_RPanel_Memo(c,b,a){try{fnHandler_rightOpenPanel(c,b,PANEL_MAIN_TYPE.ETC,a)}catch(d){dalert(d)}}
function fnHandler_HeaderFooter(c,b,a){try{if(0!=dzeUiConfig.bUseHeaderFooter&&(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a])){var d=g_objHeaderFooter,e=parseInt(b.command_id);switch(e){case ID_COMMAND_HEADER:case ID_COMMAND_FOOTER:"ribbon"==dze_menu_control.getUiMode()?(duzon_dialog.nExtendsDlgType=e==ID_COMMAND_HEADER?DZE_EXTENDS_HEADER:DZE_EXTENDS_FOOTER,duzon_dialog.viewExtendsDlg(b,a)):d.getHeaderFooterEditMode()?d.moveHeaderFooter(e==ID_COMMAND_HEADER?
ID_COMMAND_GO_TO_HEADER:ID_COMMAND_GO_TO_FOOTER):d.setHeaderFooterEditMode(e==ID_COMMAND_HEADER?d.HEADER:d.FOOTER);break;case ID_COMMAND_EDIT_HEADER:d.getHeaderFooterEditMode()?d.moveHeaderFooter(ID_COMMAND_GO_TO_HEADER):d.setHeaderFooterEditMode(d.HEADER);break;case ID_COMMAND_EDIT_FOOTER:d.getHeaderFooterEditMode()?d.moveHeaderFooter(ID_COMMAND_GO_TO_FOOTER):d.setHeaderFooterEditMode(d.FOOTER);break;case ID_COMMAND_EDIT_BODY:d.setHeaderFooterEditMode(d.BODY);break;case ID_COMMAND_REMOVE_HEADER:case ID_COMMAND_REMOVE_FOOTER:d.removeHeaderFooter(e==
ID_COMMAND_REMOVE_HEADER?!0:!1);break;case ID_COMMAND_HEADER_FOOTER_OPTIONS:duzon_dialog.nExtendsDlgType=DZE_EXTENDS_HEADER_FOOTER_OPTIONS;duzon_dialog.onload=function(){duzon_dialog.setCheck(ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_FIRST_PAGE,d.bDiffFirstPage);duzon_dialog.setCheck(ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_ODD_EVEN_PAGES,d.bDiffOddEvenPage);duzon_dialog.setCheck(ID_COMMAND_HEADER_FOOTER_OPTION_SHOW_DOCUMENT_TEXT,d.bShowDocumentText)};duzon_dialog.viewExtendsDlg(b,a);break;case ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_FIRST_PAGE:d.setDiffFirstPage(!d.bDiffFirstPage);
break;case ID_COMMAND_HEADER_FOOTER_OPTION_DIFF_ODD_EVEN_PAGES:d.setDiffOddEvenPage(!d.bDiffOddEvenPage);break;case ID_COMMAND_HEADER_FOOTER_OPTION_SHOW_DOCUMENT_TEXT:d.setShowDocumentText(!d.bShowDocumentText);break;case ID_COMMAND_GO_TO_HEADER:case ID_COMMAND_GO_TO_FOOTER:case ID_COMMAND_JUMP_TO_PREVIOUS_HEADER_FOOTER:case ID_COMMAND_JUMP_TO_NEXT_HEADER_FOOTER:d.moveHeaderFooter(e)}}}catch(f){dalert(f)}}function fnHandler_HeaderFooter_Detail(c,b,a){}
function fnHandler_HeaderFooter_Margin(c,b,a,d){try{if(0!=dzeUiConfig.bUseHeaderFooter&&(-1==a&&(a=g_nActiveEditNumber),g_bEditMode[a])){var e=10*parseFloat(c),f=dzeLayoutControl.getDocPrintMarginInfo(a,!1);f||(f=dzeUiConfig.nSettingPaperMargin);b==ID_COMMAND_HEADER_MARGIN_FROM_TOP?f.headerTop=e:b==ID_COMMAND_FOOTER_MARGIN_FROM_BOTTOM&&(f.footerBottom=e);g_objHeaderFooter.clearCache();dzeLayoutControl.setDocPrintMargin(a,f);g_objHeaderFooter.updateEditingState(a);d&&g_objUndoRedo.registerUndoRedoStack(0,
a)}}catch(g){dalert(g)}}function fnHandler_DeleteImage(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=getSelectionControl(a);if(0!=imageExceptionCheck(d)){var e=d.controlObject,f=g_objNodeUtil.getParentElement(e);if(!fnObjectCheckNull(f)&&(f.removeChild(e),g_objUndoRedo.registerUndoRedoStack(0,a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}}}catch(g){dalert(g)}}
function fnHandler_DeleteVideo(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]&&(c=g_objVideoControl)){var d=c.getFocusParentNode();if(d&&d.parentNode&&(b=null,"VIDEO"===d.nodeName&&(b="SPAN"===d.parentNode.nodeName&&d.parentNode.firstChild===d.parentNode.lastChild?d.parentNode:d),b||(b=c.getVideo(d)),!b&&c.isVideoControl(d)&&(b=d.parentNode),b)){var e=b.ownerDocument.createRange();e.selectNode(b);SetCurRange(e);b.parentNode.removeChild(b);
g_objUndoRedo.registerUndoRedoStack(0,a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();editor_onselectionchange(a)}}}catch(f){dalert(f)}}function fnHandler_Help_Online(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&openOnlineManualPop()}catch(d){dalert(d)}}
function fnHandler_Help_FAQ(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&onefficeCommon.openWindow(oneffice.getEditModeDocPath("ONEFFICE_CLOUD_FAQ_MANUAL_SEQ",null,null,!0),"_blank")}catch(d){dalert(d)}}
function fnHandler_Help_VOC(c,b,a){try{var d=function(){var a="",b=g_browserCHK.isMacPC()?" (MAC)":"";a=a+"[ONEFFICE \uace0\uac1d \ubb38\uc758\uc0ac\ud56d]\r\n\r\n"+("\uc0ac \uc6a9 \uc790 \uba85 : "+oneffice_cloud_myInfoData.name+"\r\n");a+="\ubb38 \uc11c \uc81c \ubaa9 : "+oneffice.currFileSubject+"\r\n";a+="\uc0ac\uc6a9\ube0c\ub77c\uc6b0\uc800 : "+g_browserCHK.getBrowserName()+b+"\r\n";a+="\uc6d0\ud53c\uc2a4 \ubc84\uc804 : "+objOnefficeLoader.getVer()+"\r\n";a+="\uc6d0\ud53c\uc2a4 URL : "+onefficeGW.getDocumentShareOpenURL(onefficeUtil.getRequestParameter("seq"),
onefficeUtil.getRequestParameter("groupseq"))+"\r\n\r\n";return a+="[\ubb38\uc758\ub0b4\uc6a9]\r\n"+document.getElementById("dze_idx_voc_comment").value+"\r\n"},e=function(a,b){var c='<div class="dialog_oneffice_news_item_title">'+a[0]+"</div>";c+='<div style="height:10px;"></div>';0==b?(c+='<div class="dialog_oneffice_news_item_body">'+a[1]+"</div>",c+='<img class="dialog_open_status_icon" src="./image/dialog/btn-open.png" />'):(c+='<div class="dialog_oneffice_news_item_body fold">'+a[1]+"</div>",
c+='<img class="dialog_open_status_icon" src="./image/dialog/btn-close.png" />');return c},f=function(a){var b=document.createElement("div");a=a.offsetHeight-2;var c='<div class="duzon_dialog_extends unselectable" style="height:'+a+'px;"><div class="dialog_oneffice_news_title_bg"><div class="dialog_oneffice_news_title">';c+='<img style="margin-right: 8px;" src="./image/dialog/icon-help-notice.png"/>';c+="ONEFFICE \uc548\ub0b4 \uc18c\uc2dd\uc9c0";c+="</div>";c+="</div>";c=c+('<div class="dialog_oneffice_news_list_container" style="height:'+
(a-47)+'px;">')+'<div id="dze_idx_oneffice_new_list" style="margin: 10px;"></div></div>';c+="</div>";c+='<div class="duzon_dialog_extends_toggle_btn">';c+='<img src="./image/dialog/btn-hide-notice.png"/>';c+="</div>";b.innerHTML=c;return b};-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.viewDialog(event,a,"ONEFFICE "+ID_RES_STRING_VOC,function(){var a="",b=g_browserCHK.isMacPC()?" (MAC)":"";a=a+'<div class="dialog_voc_main_container"><table cellpadding="0" cellspacing="0" width="100%" height="100%" style="background-color: white"><tbody><tr><td class="dialog_voc_left_title">\uc0ac \uc6a9 \uc790 \uba85</td>'+
('<td class="dialog_voc_user_info_detail" colspan="3">'+oneffice_cloud_myInfoData.name+"</td>");a=a+'</tr><tr><td class="dialog_voc_left_title">\ubb38 \uc11c \uc81c \ubaa9</td>'+('<td class="dialog_voc_user_info_detail" colspan="3">'+oneffice.currFileSubject+"</td>");a=a+'</tr><tr><td class="dialog_voc_left_title">\uc0ac\uc6a9\ube0c\ub77c\uc6b0\uc800</td>'+('<td class="dialog_voc_user_info_detail" colspan="3">'+g_browserCHK.getBrowserName()+b+"</td>");a=a+'</tr><tr><td class="dialog_voc_left_title">\uc6d0\ud53c\uc2a4 \ubc84\uc804</td>'+
('<td class="dialog_voc_user_info_detail" colspan="3">ONEFFICE v'+objOnefficeLoader.getVer()+"</td>");a=a+'</tr><tr><td colspan="4">'+('<textarea id="dze_idx_voc_comment" class="dialog_voc_comment" placeholder="'+ID_RES_STRING_VOC_PLACEHOLDER+'" spellcheck="false"></textarea>');return a+"</td></tr></tbody></table></div>"}(),2,[ID_RES_STRING_SEND,ID_RES_ADJUST_VIEW_CLOSE],[function(){if(""==document.getElementById("dze_idx_voc_comment").value)cmnCtrlToast.showToastMsg(null,ID_RES_STRING_VOC_PLACEHOLDER,
2);else{var a=[];a.push("344710419");onefficeGW.sendNoteMessage(a,d(),oneffice_cloud_myInfoData);duzon_dialog.closeDialog();cmnCtrlToast.showToastMsg(null,ID_RES_STRING_VOC_SEND_COMPLETE,2)}},function(){duzon_dialog.closeDialog()}],function(){var a=document.getElementById("idx_dlg");a.appendChild(f(a));if(a=document.getElementsByClassName("duzon_dialog_extends_toggle_btn")[0])a.onclick=function(){var a=dzeJ(".duzon_dialog_extends");a.is(":visible")?(a.hide("slide",{direction:"left"},300),this.innerHTML=
'<img src="./image/dialog/btn-view-notice.png"/>'):(a.show("slide",{direction:"left"},300),this.innerHTML='<img src="./image/dialog/btn-hide-notice.png"/>')};a=document.getElementById("dze_idx_oneffice_new_list");for(var b=0;b<dzeOnefficeNews.length;b++){var c=document.createElement("div");c.className="dialog_oneffice_news_item";c.innerHTML=e(dzeOnefficeNews[b],b);c.onclick=function(){var a=this.getElementsByClassName("dialog_oneffice_news_item_body"),b=this.getElementsByClassName("dialog_open_status_icon");
0!=a.length&&0!=b.length&&(a[0].classList.contains("fold")?(dzeJ(a[0]).removeClass("fold",300),b[0].src="./image/dialog/btn-open.png"):(dzeJ(a[0]).addClass("fold",300),b[0].src="./image/dialog/btn-close.png"))};a.appendChild(c)}setTimeout(function(){setRepositionDialogOnCenter(!0)},0)},function(){},!0,"center"),"undefined"!=typeof localStorage&&localStorage.getItem("dzeNotificationIcon")!=objOnefficeLoader.getVer()&&(localStorage.setItem("dzeNotificationIcon",objOnefficeLoader.getVer()),dzeJ("#dze_idx_noti_new").remove()))}catch(g){dalert(g)}}
function fnHandler_SendBizboxReport(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){-1==a&&(a=g_nActiveEditNumber);var d=g_objEditorDocument[a],e=d?d.querySelector("#dze_corona_survey"):null;if(e){var f=e.querySelectorAll("input[type=radio]"),g={};forEach(f,function(a,b){a=b.name;g[a]||(g[a]=[]);g[a].push(b)},this);g=Object.keys(g).map(function(a){return g[a]});var h=null;c=0;for(var k=g.length;c<k;c++){var l=g[c],m=l.length;if(0!==m){b=!1;for(d=0;d<m;d++)if(!0===
l[d].checked){b=!0;break}if(!1===b){h=l[0];break}}}if(h){cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_STRING_CHECK_ALL_CORONA,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg();g_objCaretUtil.scrollTo(h)});return}}oneffice.currFileSecurityStatus?cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_STRING_SECURITY_DOC_CANNOT_SEND_REPORT,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg()}):onefficeExtContent.sendBizboxReportWindow(a)}}catch(n){dalert(n)}}
function fnHandler_UpdateBizboxReport(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),onefficeExtContent.updateContent(a,function(){})}catch(d){dalert(d)}}function fnHandler_getBizboxReportList(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){if(b.TBSTATE==ID_STRING_NAME_GRAY)return!1;onefficeExtContent.viewBizboxReportListDialog(c,a)}}catch(d){dalert(d)}}
function fnHandler_insertInputBox(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){var d=g_objEditorDocument[a].createElement("input");d.type="text";g_objPropertyUtil.element_addClass(d,"dze_external_data_area");d.setAttribute("readonly","");d.setAttribute("size","10");d.style.background="#f7fe2e2e";d.style.border="none";d.style.borderBottom="1px solid gray";d.style.color="black";d.style.fontSize="12pt";d.style.fontFamily="'[\ub354\uc874] \ubcf8\ubb38\uccb4 30'";
d.style.textAlign="center";insertHTMLCodeAtSelection(d.outerHTML,null,a);g_objUndoRedo.registerUndoRedoStack(0,a)}}catch(e){dalert(e)}}
function fnHandler_showInputBoxDialog(c,b){try{var a=c.target;duzon_dialog.viewDialog(c,b,"\ubc15\uc2a4 \uc18d\uc131",duzon_dialog.createInputBoxDialog(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){duzon_dialog.setInputBoxStyle(a);duzon_dialog.closeDialog();g_objUndoRedo.registerUndoRedoStack(0,b)},function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.initInputBoxDialog(a)},function(){},!0,"relative")}catch(d){dalert(d)}}
function fnHandler_showExternalDataDialog(c,b,a){try{duzon_dialog.viewDialog(event,a,"\uc591\uc2dd \ub370\uc774\ud130",duzon_dialog.createExternalDateDialog(),1,[ID_RES_DIALOG_BTN_CANCEL],[function(){duzon_dialog.closeDialog()}],function(){duzon_dialog.initExternalDateDialog()},function(){},!0,"screen_center")}catch(d){dalert(d)}}
function fnHandler_getExternalData(c,b){try{duzon_http.showLoading(),duzon_http.ajax({type:"get",url:c,async:!0,dataType:"json",data:{charSet:"utf-8",url:c},timeout:1E4,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){try{Binder.getInstance().doBindExternalData(a,function(){g_objUndoRedo.registerUndoRedoStack(0,b)})}catch(d){dalert("error:data mapping")}finally{duzon_http.hideLoading(),duzon_dialog.closeDialog()}},error:function(a){404===a.status?dalert(a.msg+"\nwrong address"):
dalert("error:internal server error");duzon_http.hideLoading()}})}catch(a){dalert(a)}}
function fnHandler_sendReportForm(c,b,a){try{duzon_http.showLoading(),setTimeout(function(){try{window.open("http://localhost:8080/workspaces/DZEDITOR/dzeditor1.0/sample_init_content.jsp","document");var b=document.createElement("form");b.action="http://localhost:8080/workspaces/DZEDITOR/dzeditor1.0/sample_init_content.jsp";b.method="post";b.target="document";for(var c=g_objEditorDocument[a].getElementsByClassName("dze_page_main"),f="",g=0;g<c.length;g++)f+=c[g].innerHTML;var h=document.createElement("textarea");
h.name="content";h.value=f;b.appendChild(h);var k=g_objPageControl.getPageNode(0);if(!1===fnObjectCheckNull(k)){var l=k.style.width,m=k.style.height,n=k.childNodes[0].style.minHeight,p=k.childNodes[2].style.minHeight,q=k.childNodes[1].style.paddingLeft,t=k.childNodes[1].style.paddingRight;h=document.createElement("textarea");h.name="pageSize";h.value=l+"/"+m;b.appendChild(h);h=document.createElement("textarea");h.name="pagePadding";h.value=n+" "+t+" "+p+" "+q;b.appendChild(h)}var r=document.getElementById("dze_idx_if_filectl_"+
a);r.contentWindow.document.body.appendChild(b);b.submit();r.contentWindow.document.body.removeChild(b)}catch(u){dalert("error:create & send report form")}finally{duzon_http.hideLoading()}},500)}catch(d){dalert(d)}}
function applyFirstQRCode(c,b){try{var a=!1;document.getElementById("dze_idx_qrcode_last_sel")&&(a=document.getElementById("dze_idx_qrcode_first_sel").getAttribute("selected"));var d=!0===fnObjectCheckNull(c)?"yes"==a:c?!0:c&&"yes"==a,e=g_nActiveEditNumber;if(d){var f=g_objEditorDocument[e].getElementsByClassName("oneffice_qrcode_first_container");0==f.length?onefficeUtil.makeQRMessageBox((!0===objOnefficeLoader.m_bHybrid?onefficeMGW:onefficeGW).getDocumentShareOpenURL(oneffice.currFileSeq,oneffice.onefficeGroupSeq,
"qr_url"),!1,function(a){insertQRCodeElement(a,!1,e);b&&b(!0)}):b&&b(!1)}else{f=g_objEditorDocument[g_nActiveEditNumber].getElementsByClassName("oneffice_qrcode_first_container");var g=f.length;for(c=0;c<f.length;c++)dzeJ(f[c--]).remove();b&&b(0<g)}}catch(h){dalert(h)}}
function applyLastQRCode(c,b){try{var a=!1;document.getElementById("dze_idx_qrcode_last_sel")&&(a=document.getElementById("dze_idx_qrcode_last_sel").getAttribute("selected"));var d=!0===fnObjectCheckNull(c)?"yes"==a:c?!0:c&&"yes"==a,e=g_nActiveEditNumber;if(d){var f=g_objEditorDocument[e].getElementsByClassName("oneffice_qrcode_last_container");0==f.length?onefficeUtil.makeQRMessageBox((!0===objOnefficeLoader.m_bHybrid?onefficeMGW:onefficeGW).getDocumentShareOpenURL(oneffice.currFileSeq,oneffice.onefficeGroupSeq,
"qr_url"),!0,function(a){insertQRCodeElement(a,!0,e);b&&b(!0)}):b&&b(!1)}else{f=g_objEditorDocument[e].getElementsByClassName("oneffice_qrcode_last_container");var g=f.length;for(c=0;c<f.length;c++)dzeJ(f[c--]).remove();b&&b(0<g)}}catch(h){dalert(h)}}
function fnHandler_InsertQRCode(c,b,a){try{var d=function(){var b=!1,c=2,d=function(d){b|=d;c--;0===c&&b&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a))};applyFirstQRCode(null,d);applyLastQRCode(null,d)},e=function(a){"no"==a.getAttribute("selected")?(a.setAttribute("selected","yes"),a.style.borderColor="#1c90fb",a.getElementsByTagName("img")[1].style.display=""):(a.setAttribute("selected","no"),a.style.borderColor="",a.getElementsByTagName("img")[1].style.display="none")};
-1==a&&(a=g_nActiveEditNumber);fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_INSERT_QRCODE,duzon_dialog.createQRInsertDialog(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){d();duzon_dialog.closeDialog()},function(){duzon_dialog.closeDialog()}],function(){var f=document.getElementById("dze_idx_qrcode_first_sel"),g=document.getElementById("dze_idx_qrcode_last_sel"),h=!1,k=!1;0<g_objEditorDocument[a].getElementsByClassName("oneffice_qrcode_first_container").length&&
(h=!0,e(f));0<g_objEditorDocument[a].getElementsByClassName("oneffice_qrcode_last_container").length&&(k=!0,e(g));document.getElementById("dze_idx_qrcode_preview").onclick=function(){d();setTimeout(function(){fnHandler_Preview(c,b,a);setTimeout(function(){applyFirstQRCode(h);applyLastQRCode(k)},500)},100)};f.onclick=function(){e(this)};g.onclick=function(){e(this)}},function(){},!0,"screen_center")}catch(f){dalert(f)}}
function viewDocumentHistoryDetail(c){try{duzon_dialog.viewDialog(null,g_objPageControl.nEditNumber,"\ubb38\uc11c \uc774\ub825 \uc790\uc138\ud788 \ubcf4\uae30",duzon_dialog.createDocHistoryDetail(c),1,[ID_RES_DIALOG_BTN_OK],[function(){duzon_dialog.closeDialog()}],function(){},function(){},!0,"relative")}catch(b){dalert(b)}}
function callAuthReqeustAnswer(c,b,a,d){try{var e=-1,f=void 0;duzon_dialog.viewDialog(null,g_objPageControl.nEditNumber,ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH,duzon_dialog.createAuth_RequestDialog(c,b),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var c=getEditorHTMLCode(!1,g_nActiveEditNumber,!0);e=1;dlog("\uad8c\ud55c \uc774\uad00\uc744 \uc2dc\uc791\ud55c\ub2e4. Interval\uc744 \uba48\ucd94\uc790");clearInterval(oneffice.requestManagerSearchInterval);oneffice.requestManagerSearchInterval=
void 0;clearInterval(oneffice.accessManagerSearchInterval);oneffice.accessManagerSearchInterval=void 0;onefficeUtil.checkSameContent(c)?(cmnCtrlToast.showToastMsg(null,"\ubcc0\uacbd \ub41c \ub0b4\uc6a9\uc774 \uc5c6\ub2e4. \uad8c\ud55c\uc744 \ub118\uaca8 \uc8fc\uc790 ",2),fnCommandReadOnlyMode(g_nActiveEditNumber,3),onefficeGW.updateReqAnswerAccessManager(oneffice.currFileSeq,oneffice_cloud_myInfoData.id,d,ACCESS_MANAGER_RESOPONSE_VALUE.SUECESS,function(a){a=[];a.push({name:b[1]});onefficeUtil.setReadonlyNotificationBar(g_nActiveEditNumber,
a,0);!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO)})):onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,c,g_nActiveEditNumber,function(){onefficeUtil.setSavedContent(c);cmnCtrlToast.showToastMsg(null,"\uc800\uc7a5\uc774 \ub05d\ub0ac\ub2e4. \uad8c\ud55c\uc744 \ub118\uaca8 \uc8fc\uc790 ",2);onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,
oneffice.currFileRegDate);fnCommandReadOnlyMode(g_nActiveEditNumber,3);onefficeGW.updateReqAnswerAccessManager(oneffice.currFileSeq,a,d,ACCESS_MANAGER_RESOPONSE_VALUE.SUECESS,function(a){a=[];a.push({name:b[1]});onefficeUtil.setReadonlyNotificationBar(g_nActiveEditNumber,a,0);!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO)})},!0);duzon_dialog.closeDialog()},function(){e=0;onefficeGW.callEditUse();onefficeGW.updateReqAnswerAccessManager(oneffice.currFileSeq,
a,d,ACCESS_MANAGER_RESOPONSE_VALUE.REJECT,function(a){onefficeUtil.searchRequestInterval()});duzon_dialog.closeDialog()}],function(){},function(){-1==e&&(dlog("title Closed \ubc84\ud2bc\uc73c\ub85c \ub098\uc654\ub2e4."),onefficeGW.updateReqAnswerAccessManager(oneffice.currFileSeq,a,d,ACCESS_MANAGER_RESOPONSE_VALUE.REJECT,function(a){onefficeUtil.searchRequestInterval()}));clearTimeout(f)},!0,"relative");f=setTimeout(function(){document.getElementById("idx_dlg")&&(duzon_dialog.closeDialog(),onefficeGW.updateReqAnswerAccessManager(oneffice.currFileSeq,
a,d,ACCESS_MANAGER_RESOPONSE_VALUE.REJECT,function(a){onefficeUtil.searchRequestInterval()}))},DZE_ACCESS_MANAGER_AUTO_REJECT_TIME)}catch(g){dalert(g)}}
function callAuthFailForMobile(c){try{var b=String.format(ID_RES_STRING_TRANSFER_MOBILE_EDITOR_FAIL,c),a=document.createElement("div"),d=document.createElement("div");a.className="duzon_dialog_content_small";d.style.fontFamily="\ub9d1\uc740 \uace0\ub515";d.style.fontSize="12px";d.style.fontWeight="bold";d.style.color="black";d.style.textAlign="center";d.style.margin="14px 0px 15px";d.innerHTML=b;a.appendChild(d);duzon_dialog.viewDialog(null,g_objPageControl.nEditNumber,ID_RES_CONST_PANEL_PASS_WRITE_AUTH,
a.outerHTML,1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0,"screen_center")}catch(e){dalert(e)}}
function setChangeDocumentEditAuth(c){cmnMsg.showMsg(MESSAGE_CHECK,ID_RES_STRING_EDIT_USER_CHECK,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg();onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate);onefficeGW.setAccessDocument(oneffice.currFileSeq,"W","1",360,function(b){"W"===b.access_perm&&onefficeGW.setAccessDocument(oneffice.currFileSeq,"R","0",360,function(a){onefficeGW.setAccessManager(oneffice.currFileSeq,c,function(a){fnCommandEditorMode(g_nActiveEditNumber,
0);fnHandler_onefficeFileReload(g_nActiveEditNumber);oneffice.accessmanagerUserInfos=[];onefficeUtil.searchAccessManagerConnectInterval();!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO);oneffice.editUseWork=!1;oneffice.editUseWorkEnd=!1;onefficeGW.callEditUse()})})})})}
function chkCurrentEditUser(c){var b=!1;try{return onefficeCommon.getDocumentAccessInfo(oneffice.currFileSeq,function(a){if(0<a.length)for(var d=0;a.length>d;d++){var e=a[d],f=e.access_id;if("W"===e.access_perm&&c===f){b=!0;break}}},!1),b}catch(a){dalert(a)}}
function callAuthRequest(c,b,a){try{duzon_dialog.viewDialog(null,g_objPageControl.nEditNumber,c===USER_WRITE_AUTH.PASS_TO?ID_RES_CONST_PANEL_PASS_WRITE_AUTH:ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH,duzon_dialog.createAuth_RequestDialog(c,b,a),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){var a=dzeJ(".dze_panel_doc_user_request_btn");a.children().first().text()===ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH&&(a.addClass("request"),a.children().first().text(ID_RES_CONST_PANEL_CANCEL_REQUEST_WRITE_AUTH),
a.children().last().hide(),onefficeGW.updateAccessManagerRequestID(oneffice.currFileSeq,a[0].getAttribute("receiveid"),a[0].getAttribute("senderid"),onefficeUtil.searchResponseInterval));duzon_dialog.closeDialog()},function(){duzon_dialog.closeDialog()}],function(){},function(){},!0,"relative")}catch(d){dalert(d)}}
function viewAuthResponse(c){c===USER_WRITE_AUTH.RESPOSNE_SUCCESS&&(oneffice.editUseWorkEnd=!1,onefficeGW.callEditUse("auth"));try{duzon_dialog.viewDialog(null,g_objPageControl.nEditNumber,ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH,duzon_dialog.createAuthCall_ResultDialog(c),1,[ID_RES_DIALOG_BTN_OK],[function(){c===USER_WRITE_AUTH.RESPOSNE_SUCCESS&&(oneffice.editUseWorkEnd=!1,onefficeGW.callEditUse("auth"),!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO));
duzon_dialog.closeDialog()}],function(){},function(){},!0,"relative")}catch(b){dalert(b)}}
function fnHandler_rightOpenPanel(c,b,a,d){try{if(-1==d&&(d=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,d)){var e=panelManager.getInstance(),f=dzeJ(".dze_panel_container");if(!0===e.isShowPanel())if(e.getCurrentPanelType()!==a)f.remove();else{switch(e.getCurrentPanelType()){case PANEL_MAIN_TYPE.DOC_OPEN_INFO:case PANEL_MAIN_TYPE.DOC_COMMENT:e.hidePanel()}return}e.showPanel(a)}}catch(g){dalert(g)}}
function fnHandler_showCommentPanel(c,b,a){try{fnHandler_rightOpenPanel(c,b,PANEL_MAIN_TYPE.DOC_COMMENT,a)}catch(d){dalert(d)}}
function fnHandler_ModifychartTypePanel(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){b=!1;var d=null,e=null,f=null,g=getSelectionControl(a);if(null!=g.controlObject&&"undefined"!=typeof g.controlObject&&"img"==g.controlObject.nodeName.toLowerCase()&&(f=g.controlObject,f.getAttribute("chart_id")&&f.getAttribute("chart_data"))){var h=f.getAttribute("chart_data");null!=h&&""!=h&&(b=!0,d=f.offsetWidth,e=f.offsetHeight)}!1===b?dalert("\uc120\ud0dd\ub41c Chart\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."):
duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_MODIFY_CHART_TYPE,onefficeChart.getChartDlgContainer(!0),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){onefficeChart.setInsertChartMode(a,f);duzon_dialog.closeDialog()},function(){duzon_dialog.closeDialog()}],function(){onefficeChart.initialize(f);onefficeChart.convStringToChartData(h);onefficeChart.makeChart(d,e);onefficeChart.chartTypeClickEvent();onefficeChart.addChartDialogEvent()},function(){onefficeChart.removeChartDialogEvent()},
!0,"screen_center")}}catch(k){dalert(k)}}
function fnHandler_ModifychartDataPanel(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_bEditMode[a]){b=!1;var d=null,e=getSelectionControl(a);if(null!=e.controlObject&&"undefined"!=typeof e.controlObject&&"img"==e.controlObject.nodeName.toLowerCase()&&(d=e.controlObject,d.getAttribute("chart_id")&&d.getAttribute("chart_data"))){var f=d.getAttribute("chart_data");null!=f&&""!=f&&(b=!0)}!1===b?dalert("\uc120\ud0dd\ub41c Chart\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."):duzon_dialog.chartDataDialog(c,
a,ID_RES_CONST_STRING_MODIFY_CHART_DATA,function(){onefficeChart.initialize();onefficeChart.makeCanvasChartToImage(d,a,!0);onefficeChart.addChartDialogEvent()},function(){onefficeChart.removeChartDialogEvent()})}}catch(g){}}
function fnHandler_chartAttrPanel(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),onefficeChart.makeCanvasChartToImage(dze_menu_control.currControlObject,a),fnHandler_rightOpenPanel(c,b,PANEL_MAIN_TYPE.DOC_CHART,a),showExtOutline_ObjectElement(dze_menu_control.currControlObject,!0,!1,a)}catch(d){dalert(d)}}function fnHandler_showDocumentHistory(c,b,a){try{fnHandler_rightOpenPanel(c,b,PANEL_MAIN_TYPE.DOC_OPEN_INFO,a)}catch(d){dalert(d)}}
function fnHandler_view_zoom(c,b,a){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a))switch(dlog("element.command_id = "+b.command_id),b.command_id){case ID_COMMAND_VIEW_ZOOM:fnHandler_viewPageZoomDlg(c,b,a);break;case ID_COMMAND_VIEW_100_ALIGN:g_objZoom.zoomDocument(a,100);dze_menu_control.setSliderBtnPosition(a,g_objZoom.getDocZoomValue());break;case ID_COMMAND_VIEW_WIDTH_ALIGN:g_objZoom.setPresetZoomValue(a,0);dze_menu_control.setSliderBtnPosition(a,g_objZoom.getDocZoomValue());
break;case ID_COMMAND_VIEW_HEIGHT_ALIGN:g_objZoom.setPresetZoomValue(a,1),dze_menu_control.setSliderBtnPosition(a,g_objZoom.getDocZoomValue())}}catch(d){dalert(d)}}
function fnHandler_PageNumber(c,b,a,d){try{if(-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&g_objPageNumber){var e=parseInt(b.command_id);"ribbon"!==dze_menu_control.getUiMode()&&e===ID_COMMAND_PGNUM&&(e=ID_COMMAND_PGNUM_FORMAT);switch(e){case ID_COMMAND_PGNUM:duzon_dialog.nExtendsDlgType=DZE_EXTENDS_PGNUM;duzon_dialog.viewExtendsDlg(b,a);break;case ID_COMMAND_PGNUM_TEMPLATE_UP:case ID_COMMAND_PGNUM_TEMPLATE_DOWN:var f=g_objPageNumber.getTemplate(d);f&&(g_objPageNumber=
f,f.updateAll(),g_objUndoRedo.registerUndoRedoStack(0,a));break;case ID_COMMAND_PGNUM_FORMAT:var g=PageNumberDlg;g.initDlg();g.viewDialog(c,a,ID_RES_CONST_STRING_PGNUM_FORMAT,g.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){b=g.curPgNum;0===b.type&&b.init();g_objPageNumber&&g_objPageNumber.equal(b)||(g_objPageNumber=b,b.updateAll(),g_objUndoRedo.registerUndoRedoStack(0,a));g.closeDialog()},function(a){g.closeDialog()}],function(){g.onload()},function(){g.onunload()},
!0);break;case ID_COMMAND_PGNUM_REMOVE:g_objPageNumber.init(),g_objPageNumber.updateAll(),g_objUndoRedo.registerUndoRedoStack(0,a)}}}catch(h){dalert(h)}}function fnHandler_PageNumber_Detail(c,b,a){}function fnHandler_DeleteTempDoc(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&onefficeUtil.deleteTempSavedContentAction(a)}catch(d){dalert(d)}}
function fnHandler_OverwriteTempDocToOrgDoc(c,b,a){try{-1==a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_CONST_STRING_OVERWRITE_ORG_DOC,onefficeUtil.getOverwriteTempDocToOrgDocDialogContent(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){duzon_dialog.closeDialog();onefficeUtil.saveTempLoadedDocToOrgDoc(a)},function(a){duzon_dialog.closeDialog()}],function(){onefficeUtil.setOrgDocumentInfo()},function(){},!0,"screen_center")}catch(d){dalert(d)}}
function fnHandler_goBackOrgDoc(c,b,a){try{var d=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(oneffice.currFileSeq,"","viewback");document.location=d}catch(e){dalert(e)}}
function fnHandler_getTextCount(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=GetCurRange(a);if(!0===d.collapsed){var e=g_objTableFunction.getCurrentCell(a);!1===fnObjectCheckNull(e)&&!1===fnObjectCheckNull(e.cell)&&!1===fnObjectCheckNull(e.cell.getAttribute("cusflag"))&&(d=e.cell)}var f=TEXT.getTextCounts(d);cmnMsg.showMsg(MESSAGE_CHECK,"\uae00\uc790 \uc218: "+f,void 0,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg()})}}catch(g){dalert(g)}}
function fnHandler_LayoutTable(c,b,a){try{var d=function(){var b=LayoutTableDlg;b.viewDialog(c,a,ID_RES_STRING_LAYOUT_TABLE,b.getContents(),2,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(c){b.closeDialog();var d=b.onOkClick(c);if(d){SelectionUtil.deleteSelection(a);var e=GetCurRange(a);c=g_objNodeUtil;for(var f=e.startContainer.childNodes[e.startOffset]||e.startContainer;f&&!c.isLoopBreakNode(f.parentNode);)f=f.parentNode;e.setStartBefore(f);e.setEndBefore(f);SetCurRange(e);d=g_objInsertUtil.insertTableAtSelection(d,
a);g_objCaretUtil.moveCaret(d);d=c.getAncestorNodeOnCaret(a);d=c.getLoopParentElement(d,"td");g_objPlaceholder.isPlaceholder(d)&&g_objPlaceholder.setPlaceholderFocus(d);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);g_objPageControl.onSetDelayedUpdatePageTimer()}},function(a){b.closeDialog()}],function(a){b.onload(a)},function(a){b.onunload(a)},!1,"screen_center")};b=["js/libs/textFit.min.js","js/libs/gridstack/gridstack.all.js","js/libs/gridstack/gridstack.min.css","js/libs/gridstack/gridstack-extra-oneffice.css",
"js/libs/gridstack/gridstack-oneffice.css"];for(var e=b.length,f=function(){e--;0>=e&&d&&d()},g=g_objLayerKit.getLayerDocument(),h=0,k=b.length;h<k;h++){var l=b[h];endsWith(l,".css")?g_objInsertUtil.dynamicLoad_CSS(g,l,f):dynamicScriptCall(l,f)}}catch(m){dalert(m)}}
function fnHandler_insertNews(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&duzon_dialog.viewDialog(c,a,ID_RES_STRING_GET_NEWS_LIST,onefficeExtContent.getNewsListDlgContents(),2,[ID_RES_TOOL_STRING_MENU_INSERT,ID_RES_DIALOG_BTN_CANCEL],[function(b){!0===onefficeExtContent.insertSelectedNews()&&g_objUndoRedo.registerUndoRedoStack(0,a)},function(a){duzon_dialog.closeDialog()}],function(){onefficeExtContent.initNewsListDlg()},function(){},!1,"screen_center")}catch(d){dalert(d)}}
function fnHandler_postNews(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)){var d=g_objEditorDocument[a].getElementById("bizwatch_title").value;!0===fnObjectCheckNull(d)||""===d?cmnCtrlToast.showToastMsg(null,"\uae30\uc0ac \uc81c\ubaa9\uc774 \ub204\ub77d\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR):duzon_dialog.viewDialog(c,a,!0===fnObjectCheckNull(dzeUiConfig.nBizwatchArticleId)?ID_RES_STRING_POST_NEWS:ID_RES_STRING_UPDATE_POSTED_NEWS,
onefficeExtContent.getPostNewsDlgContents(),2,[!0===fnObjectCheckNull(dzeUiConfig.nBizwatchArticleId)?ID_RES_DIALOG_BTN_OK:"\uc5c5\ub370\uc774\ud2b8",ID_RES_DIALOG_BTN_CANCEL],[function(c){c=onefficeExtContent.checkImageContents(a);0<c.length?(duzon_http.showLoading(),cmnCtrlToast.showToastMsg(null,"\uc11c\ubc84\uc5d0 \ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \uc774\ubbf8\uc9c0\ub97c \uc5c5\ub85c\ub4dc \uc911 \uc785\ub2c8\ub2e4.",1.5,"screen_center",!0),onefficeExtContent.uploadImageList(c).then(function(a){duzon_http.hideLoading();
if(0===a)onefficeExtContent.postNews(b);else{var c="\uc11c\ubc84\uc5d0 \ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \uc774\ubbf8\uc9c0\uac00 \uc788\uc2b5\ub2c8\ub2e4.";1===a&&(c+="<br>\uc0bd\uc785\ud55c \uc774\ubbf8\uc9c0\uc758 \ud0a4\uc6cc\ub4dc/\uc124\uba85\uc744 \uc785\ub825\ud558\uc138\uc694.");cmnCtrlToast.showToastMsg(null,c,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR)}})):onefficeExtContent.postNews(b)},function(a){duzon_dialog.closeDialog()}],function(){},function(){},!1,"screen_center")}}catch(e){dalert(e)}}
function fnHandler_getCloudImage(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!1!==g_bEditMode[a]&&duzon_dialog.viewDialog(c,a,ID_RES_STRING_GET_CLOUD_IMAGE,onefficeExtContent.getCloudImageDlgContents(),2,[ID_RES_TOOL_STRING_MENU_INSERT,ID_RES_DIALOG_BTN_CANCEL],[function(b){!0===onefficeExtContent.insertSelectedImage()&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),duzon_dialog.closeDialog())},function(a){duzon_dialog.closeDialog()}],
function(){onefficeExtContent.initCloudImageDlg()},function(){},!1,"screen_center")}catch(d){dalert(d)}}
function fnHandler_postImage(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!1!==g_bEditMode[a]){var d=getSelectionControl(a);if(!0!==fnObjectCheckNull(d.controlObject)&&"IMG"===d.controlObject.nodeName){var e=1*b.command_id===ID_COMMAND_POST_IMAGE;if(!0===e){var f=ID_RES_STRING_POST_IMAGE;var g="\ub4f1\ub85d"}else f=ID_RES_STRING_SET_IMAGE_INFO,g="\ud655\uc778";duzon_dialog.viewDialog(c,a,f,onefficeExtContent.getPostImageDlgContents(!1),2,[g,ID_RES_DIALOG_BTN_CANCEL],
[function(b){!0===e?onefficeExtContent.postImage().then(function(a){!1!==a&&(duzon_dialog.closeDialog(),!1!==a.result&&(d.controlObject.src=a.result.media_url))}):(b=onefficeExtContent.updateImageOption(d.controlObject),!1!==b&&("changed"===b&&(cmnCtrlToast.showToastMsg(null,"\uc774\ubbf8\uc9c0 \uc815\ubcf4\uac00 \ubcc0\uacbd\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center",!0,TOAST_TYPE_OPTION_INFO),g_objUndoRedo.registerUndoRedoStack(0,a)),duzon_dialog.closeDialog()))},function(a){duzon_dialog.closeDialog()}],
function(){onefficeExtContent.initPostImageDlg(d.controlObject)},function(){},!1,"screen_center")}}}catch(h){dalert(h)}}
function fnHandler_setStyleTemplate_Combo(c,b,a,d){try{-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(g_objWrapperOutlineResize.resetExtOutlineInfo(),setWindowResizeEvent(!1),TBSetState(b,ID_STRING_NAME_CHECKED,ID_TB_QUERY_STATUS_COMBOBOX),g_objComboBoxWin.showComboBoxLayer(3,a),g_bDynamicLayer=!0,setWindowResizeEvent(!0))}catch(e){dalert(e)}}
function fnHandler_setStyleTemplate(c,b,a,d,e){try{if(-1===a&&(a=g_nActiveEditNumber),(!1===e||!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a))&&!1!==g_bEditMode[a]){var f=b.title;f||(f=b._title);c=g_objLetterFn;b=!0;var g=getStyleTemplateClass();switch(f){case ID_RES_STRING_DEFAULT:b=c.setParaStyle(a,{default:!0});break;case ID_RES_STRING_EMPHASIS1:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_color_navy"});break;case ID_RES_STRING_EMPHASIS2:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_color_blue"});
break;case ID_RES_STRING_EMPHASIS3:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_color_pink"});break;case ID_RES_STRING_BOX1:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_box"});break;case ID_RES_STRING_BOX2:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_box_blue"});break;case ID_RES_STRING_BOX3:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_box_pink"});break;case ID_RES_STRING_QUOTATION:b=c.setParaStyle(a,{removeClassName:g,addClassName:"bw_quote"});break;case ID_RES_STRING_FIRST_LETTER_BIG:b=
c.setParaStyle(a,{removeClassName:g,addClassName:"bw_text_first"});break;case ID_RES_STRING_REMOVE_FORMAT:b=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_REMOVE_FORMAT,"");break;case ID_RES_STRING_SUBTITLE1:b=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_SUBTITLE1,"subtitle1");break;case ID_RES_STRING_SUBTITLE2:b=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_SUBTITLE2,"subtitle2");break;default:return!1}b&&!1!==d&&(g_objUndoRedo.registerUndoRedoStack(0,
a),g_objPageControl.onSetDelayedUpdatePageTimer(),editor_onselectionchange(a))}}catch(h){dalert(h)}}
function getStyleTemplate(c){try{var b=GetCurRange(c);if(!b)return"";var a=b.startContainer;if(!a)return"";c=g_objNodeUtil;var d=getStyleTemplateName(),e=getStyleTemplateClass();b="";for(var f=null,g="";a&&!c.isLoopBreakNode(a);){var h=a.className;h&&(b+=b?" "+h:h);if(c.isBlockNode(a))break;a=a.parentNode}f=b.split(" ");forEach(f,function(a,b){a=e.indexOf(b);0<=a&&(g=""===g?d[a]:"")},this);return g}catch(k){dalert(k)}}
function getEnableStyleTemplate(c){try{return GetCurRange(c)?!0:!1}catch(b){dalert(b)}}function getStyleTemplateName(){try{return"undefined"!==typeof BizWatch?BizWatch.arrStyleTemplateName:[]}catch(c){dalert(c)}}function getStyleTemplateClass(){try{return"undefined"!==typeof BizWatch?BizWatch.arrStyleTemplateClass:[]}catch(c){dalert(c)}}function getStyleTemplateHtml(c,b){try{return"undefined"!==typeof BizWatch?BizWatch.getStyleTemplateHtml(c,b):""}catch(a){dalert(a)}}
function fnHandler_insertFormControl(c,b,a){try{-1===a&&(a=g_nActiveEditNumber),fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&(duzon_dialog.nExtendsDlgType=DZE_EXTENDS_INSERT_FORM_CONTROL,duzon_dialog.viewExtendsDlg(b,a))}catch(d){dalert(d)}}function fnHandler_insertFormControl_Detail(c,b,a){}
function getAlignValueForSelectionArea(c){try{var b="",a=GetCurTable(c);g_objTableSelection.isTableSelected(a)?b=g_objTableUtil.getTableAlign(a):(a={textAlign:""},g_objLetterFn.getSelectedParaStyle(c,a),b=a.textAlign);switch(b){case "left":case "start":return 1;case "center":return 2;case "right":case "end":return 3;case "justify":return 4}}catch(d){}return 0}
function fnHandler_ListStartNew(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!0===setListStartNew(a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){dalert(d)}}
function fnHandler_ListStartContinue(c,b,a){try{if(-1===a&&(a=g_nActiveEditNumber),!1!==fnHandler_CommonCheck_DynamicLayer_1(c,b,a)&&!0===setListStartContinue(a)&&(g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}catch(d){dalert(d)}};
var g_objEditMode=new function(){this.isLoopContentEditable=this.isContentEditable=function(a){try{if(!a)return!1;if(g_bBrowserType_IE)for(;a&&"BODY"!==a.nodeName;){if(a.getAttribute){var b=a.getAttribute("contentEditable");b=b?b.toLowerCase():b;if("true"===b)return!0;if("false"===b)break}a=a.parentNode}else return a.isContentEditable;return!1}catch(c){dalert(c)}};this.checkSelectionContentEditable=function(a){try{if(!1===dzeUiConfig.bUseLockEditCellFunction||!g_objEditWindow[a].getSelection)return!0;
var b=g_objEditWindow[a].getSelection();if(1>b.rangeCount)return!0;var c=b.getRangeAt(0);if(0==this.isLoopContentEditable(c.commonAncestorContainer))return!1;var d=!0;g_objNodeUtil.traverseNodesInRange(c,function(a){a.nodeType==ID_SELECTION_ELEMENT_NODE&&"false"==a.getAttribute("contenteditable")&&(d=!1);return d});return d}catch(e){dalert(e)}finally{c=null}};this.showBGImageForLockedCell=function(a,b){try{if(!1!==dzeUiConfig.bUseLockEditCellFunction){var c=g_objEditorDocument[b].getElementsByTagName("td");
a=!1===a;for(var d=0;d<c.length;d++){var e=c[d];!0===g_objTableFunction.isCellLocked(e)&&g_objTableFunction.controlBackgroundImage(e,b,a)}}}catch(f){dalert(f)}};this.rangeTabInsert=function(a,b){try{var c=null,d=null;g_objNodeUtil.traverseNodesInRange(GetCurRange(a),function(a){if((a=g_objNodeUtil.getLoopParentElement(a,"p"))&&c!==a){var b=g_objEditMode.createTabSpan();a.firstChild?a.insertBefore(b,a.firstChild):a.appendChild(b);null===c&&(d=b)}c=a});void 0!=b&&d&&b(d)}catch(e){alert(e)}};this.createTabSpan=
function(){var a=document.createElement("span");a.className="tabSpan";a.innerHTML="\t";return a};this.removeChild=function(a,b,c,d,e){a=g_objEditorDocument[a].getElementsByTagName(b);for(b=0;b<a.length;b++)a[b][c]===d&&e(a[b])};this.chkRangeLineCount=function(a){var b=1;g_objNodeUtil.traverseNodesInRange(GetCurRange(a),function(a){"P"===a.nodeName&&b++});return b}};
var g_objTableMultiCell=new function(){this.setMultiCellCommand_Common=function(a,e,b,q,r){try{var l=GetCurTable(a),c=g_objTableFunction.getCurrentCell(a),d=null,g=null;if(window.attachEvent){d=g_objEditorDocument[a].selection;if(fnObjectCheckNull(d))return;g=d.createRange();if(fnObjectCheckNull(g))return}else{d=g_objEditWindow[a].getSelection();if(fnObjectCheckNull(d))return;d.removeAllRanges()}var h=0,m=["Bold","Italic","Underline","StrikeThrough"],k=0,f=null;g_objTableSelection.doAllSelectedCell(function(c){h++;
window.attachEvent?(g.moveToElementText(c),g.select()):d.selectAllChildren(c);if(1==e)if(inArray(b,m))try{1==h?(f=g_objEditorDocument[a].queryCommandState(b),0==f&&(k=1),g_objEditorDocument[a].execCommand(b,!1,null)):(f=g_objEditorDocument[a].queryCommandState(b),(1==k&&0==f||0==k&&0!=f)&&g_objEditorDocument[a].execCommand(b,!1,null))}catch(t){g_objEditorDocument[a].execCommand(b,!1,null)}else g_objEditorDocument[a].execCommand(b,!1,null)},l);if(c&&c.table){var p=g_objTableUtil.getTableCellElement(c.table,
c.row,c.col);g_objCaretUtil.moveCaret(p)}return 0<h?!0:!1}catch(n){dalert(n)}};this.setMultiCellCommand_ExecCommand=function(a,e){try{return fnObjectCheckNull(g_objEditorDocument[e])||fnObjectCheckNull(a)||!GetCurTable(e)?void 0:this.setMultiCellCommand_Common(e,1,a,0,"")}catch(b){dalert(b)}}};
var g_bDynamicLayer=!1,g_bMenuEnabled=!0,g_bActivate=[],ID_STRING_COMMAND_CREATELINK="CreateLink",ID_STRING_COMMAND_UNLINK="Unlink",g_objLastRange=[],g_strBookmark_IE=null,g_objObjectSelectionInfo=null,g_objCurrentRange=[];function initSelectionObjectInfo(){this.bSelectObject=!1;this.objSelectionObject=this.strNodeName=null;return this}
function cloneObjectSelectionInfo(){var a=g_objObjectSelectionInfo;if(!a)return null;var b=new initSelectionObjectInfo,c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function resetSelectionObjectInfo(){g_objObjectSelectionInfo.bSelectObject=!1;g_objObjectSelectionInfo.strNodeName=null;g_objObjectSelectionInfo.objSelectionObject=null;onefficeChart.removeChartCanvasAll()}
function setSelectionObjectInfo(a,b,c){g_objObjectSelectionInfo.bSelectObject=a;g_objObjectSelectionInfo.strNodeName=b;g_objObjectSelectionInfo.objSelectionObject=c}
function editor_onbeforedeactivate(a){try{if(dlog("editor_onbeforedeactivate"),g_bEditMode[a]&&null==cmnDlg.getDlg())if(g_bBrowserType_IE&&g_arrForceCancelBubbleMouseDown[a])g_arrForceCancelBubbleMouseDown[a]=!1,TBCancelBubbleEvent(null);else{var b=g_objPositionUtil.GetDocumentClientPos_XY(null),c=b.nPos_X,d=b.nPos_Y;if(!fnObjectCheckNull(g_objEditAreaContainer[a])&&!fnObjectCheckNull(g_objEditSetContainer[a])){var e=g_objPositionUtil.getDocumentScrollPosition(!1),g=e.nScrollLeft,h=e.nScrollTop,k=
e=b=0,m=0,f=g_objEditAreaContainer[a].getBoundingClientRect();b=f.left+g;e=f.top+h;k=f.right+g;m=f.bottom+h;b<=c&&e<=d&&c<=k&&d<=m&&TBCancelBubbleEvent(null)}g_bDynamicLayer&&TBCancelBubbleEvent(null);if(window.attachEvent){var l=g_objEditorDocument[a].selection;g_objLastRange[a]=l.createRange()}else g_bBrowserType_IE&&(l=g_objEditWindow[a].getSelection(),g_objLastRange[a]=l.getRangeAt(0))}}catch(n){g_objLastRange[a]=null}}function editor_ondeactivate(a,b){}
function editor_onactivate(a,b){g_bActivate[b]=!0;g_nActiveEditNumber=b;try{g_bBrowserType_IE&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+b+", 1);")}catch(c){}}function editor_onselectionchange_for_iframe(a){try{var b=getSelectionControl(a);if(1==b.rangeLength){var c=b.controlObject.tagName.toLowerCase();"iframe"==c&&(setSelectionObjectInfo(!0,c,b.controlObject),editor_onselectionchange(a))}}catch(d){}}
function editor_onselectstart(a,b){try{if((b=g_objMouseEvent)&&g_browserCHK.isMacPC()&&!objOnefficeLoader.m_bHybrid&&EventUtil.isRightButton(b)){var c=g_objCaretUtil.getRangeFromPoint(b.clientX,b.clientY);c&&(SetCurRange(c.getNativeRange()),a.preventDefault())}}catch(d){dalert(d)}}var g_nUiUpdateTimer=null;
function editor_onselectionchange(a){try{g_nActiveEditNumber=a,duzon_dialog.nEditNumber=a,duzon_menubar.nEditNumber=a,g_objInsertUtil.saveSelectionRange_IE(1,a),g_nUiUpdateTimer&&clearTimeout(g_nUiUpdateTimer),g_nUiUpdateTimer=setTimeout(function(){onselectionchange_uiupdate(a)})}catch(b){dalert(b)}}
function onselectionchange_uiupdate(a){try{if(!0===g_readonlyMode)return g_objOnefficeEditor.disableAllMenuCtrl(a);if(!g_bBrowserType_IE||g_bActivate[a]){g_bMenuEnabled||(g_objMenuWin.TBMenuSetStateAllEnable(!0,a),g_bMenuEnabled=!0);var b=GetCurTable(a);dzeUiConfig.bUseLockEditCellFunction&&!b&&(g_bHasLockedCell=!g_objEditMode.checkSelectionContentEditable(a));g_objOnefficeEditor.updateAllMenuCtrl(a);updateTableHandlerUI.updateTableUIHandler(a,b);g_objRulerBar.update(a);!0===dzeUiConfig.bOfficeMode&&
dzeLayoutControl.setEditAreaSize(a);g_objTableMiniMenu.update(a);dze_menu_control.evtMouseUpShowDynamicMenu();g_objPageControl.updateStatusPageNum(a)}}catch(c){dalert(c)}}
function checkSecurityStatus(a,b){try{fnObjectCheckNull(oneffice.parentFileContent)||""==oneffice.parentFileContent||(fnObjectCheckNull(oneffice.parentFileContent.my_id)||oneffice.parentFileContent.my_id==oneffice.parentFileContent.owner_id?TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_UNCHECKED,g_TBButton[a][b].button_type):TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type))}catch(c){}}
function disableAllControl(a){try{updateTableHandlerUI.clearCache();for(var b=0,c=g_TBButton[a].length;b<c;b++){var d=g_TBButton[a][b].command_id,e=g_TBButton[a][b].element;e.isShow&&!1===e.isShow()||(ID_SUPPORT_TYPE_PERSISTENCE!=g_TBButton[a][b].support_type?TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type):((ID_COMMAND_FILE_SAVE_AS_REMOTE==d||ID_COMMAND_DOWNLOAD_PDF==d||ID_COMMAND_DOCUMENT_SECURITY_SETTING==d||ID_COMMAND_SHARE_FAX==d||ID_COMMAND_DOC_SECURE_GRADE==
d)&&oneffice.currFileSecurityStatus&&oneffice_cloud_myInfoData&&oneffice_cloud_myInfoData.id!=oneffice.currFileOwnerId&&(TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type),setDisableDocUserAction(a)),ID_COMMAND_DOCUMENT_SECURITY_SETTING==d&&(fnObjectCheckNull(oneffice.parentFileContent)||""==oneffice.parentFileContent?setTimeout(function(){checkSecurityStatus(a,b)},1E3):checkSecurityStatus(a,b)),d==ID_COMMAND_PRINT&&TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_UNCHECKED,
g_TBButton[a][b].button_type),!g_readonlyMode||d!==ID_COMMAND_PAGE_SETTING&&d!==ID_COMMAND_INSERT_QRCODE&&d!==ID_COMMAND_INSERT_CHART&&d!==ID_COMMAND_GET_REMOTE_SITE_CONTENT||TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type),(d==ID_COMMAND_DOCUMENT_HISTORY||d==ID_COMMAND_SEND_BIZBOX_REPORT||d==ID_COMMAND_UPDATE_BIZBOX_REPORT||d==ID_COMMAND_GET_BIZBOX_REPORT_LIST||d==ID_COMMAND_DOCUMENT_SECURITY_SETTING||d==ID_COMMAND_FILE_SAVE_AS_REMOTE||d==ID_COMMAND_FILE_DOCFORM||
d==ID_COMMAND_FILE_LIST_OPEN||d==ID_COMMAND_COMMENT_PANEL||d==ID_COMMAND_ONEFFICE_CONNECT)&&oneffice&&onefficeCommon&&onefficeCommon.isOnefficeGuideDoc(oneffice.currFileSeq)&&TBSetState(g_TBButton[a][b].element,ID_STRING_NAME_GRAY,g_TBButton[a][b].button_type)))}b=0;for(c=g_TBDropDown[a].length;b<c;b++)e=g_TBDropDown[a][b].element,e.isShow&&!1===e.isShow()||ID_SUPPORT_TYPE_PERSISTENCE!=g_TBDropDown[a][b].support_type&&TBSetState(g_TBDropDown[a][b].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][b].button_type);
b=0;for(c=g_TBComboBox[a].length;b<c;b++)e=g_TBComboBox[a][b].element,e.isShow&&!1===e.isShow()||ID_SUPPORT_TYPE_PERSISTENCE!=g_TBComboBox[a][b].support_type&&TBSetState(g_TBComboBox[[a]][b].element,ID_STRING_NAME_GRAY,g_TBComboBox[[a]][b].button_type);duzon_dialog.getDisplayExtendsDlgType()==DZE_DISPLAY_EXTENDS_COLOR_PICKER&&duzon_dialog.closeExtendsDlg()}catch(g){}}
function setDisableDocUserAction(a){try{!1!==g_readonlyMode&&(g_objEditorDocument[a].body.onmousedown=function(a){TBCancelBubbleEvent(a)},g_objEditorDocument[a].body.onkeydown=function(a){!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)||a.altKey||a.shiftKey||ID_KEYCODE_C!=a.keyCode||TBCancelBubbleEvent(a)})}catch(b){dalert(b)}}
var objNodeCleaner=function(){this.m_objStNode=null;this.m_nEditNum=0;this.setNodeInfo=function(a,b){try{this.m_objStNode=a,this.m_nEditNum=b}catch(c){dalert(c)}};this.processGarbageEmptyTag=function(a,b,c){try{var d=g_objLetterFn;if(d){for(var e=0,g=0;g<a.childNodes.length;g++){var h=a.childNodes[g];switch(h.nodeType){case ID_SELECTION_ELEMENT_NODE:this.processGarbageEmptyTag(h,b,c);break;case ID_SELECTION_TEXT_NODE:e++}}switch(g_objNodeUtil.getElementTagName(a).toLowerCase()){case DZE_TAG_SPAN:if(""!=
a.className)break;if(""!=a.style.whiteSpace)break;if(b&&a.id)break;case DZE_TAG_FONT:if(e==a.childNodes.length&&d.isEmptySpan(a)){var k=a.innerHTML;if(0<k.length){var m=g_objEditorDocument[c].createTextNode(k),f=g_objNodeUtil.getParentElement(a);f.replaceChild(m,a)}else f=g_objNodeUtil.getParentElement(a),f.removeChild(a)}}}}catch(l){dalert(l)}}},g_objOnefficeEditor=new function(){this.isDocumentLoaded=!1;this.m_objNodecleaner=new objNodeCleaner;this.getObjNodeCleaner=function(){return g_objOnefficeEditor.m_objNodecleaner};
this.disableAllMenuCtrl=function(a){try{disableAllControl(a),g_objMenuWin.TBMenuSetStateAllEnable(!1,a),g_bMenuEnabled=!1}catch(b){dalert(b)}};this.updateAllMenuCtrl=function(a){try{objOnefficeLoader.m_bHybrid?dzeUiConfig.bMobileHybridEdit&&setTimeout(function(){updateHandlerUI.update_mobile_menu(a)},50):(updateHandlerUI.update_toolbar_button("",a),updateHandlerUI.update_toolbar_combobox("",a),updateHandlerUI.update_toolbar_dropdown("",a),updateHandlerUI.update_toolbar_manual("",!1,a))}catch(b){dalert(b)}}};
var ID_TABLE_EVENT_NOTHING=0,ID_TABLE_EVENT_ROW_RESIZE=1,ID_TABLE_EVENT_COL_RESIZE=2,ID_TABLE_EVENT_TABLE_RESIZE=4,ID_TABLE_EVENT_TABLE_ENTERLINE=5,g_nTableEventID=0,g_arrOnFocus_FF_WK=[],g_objMouseEvent=null,g_objDrag={dragEnterStartPageNum:0,bDragging:!1,dragStartRange:null,strDragData:null},g_arrEditorListener=[],g_arrMouseListener=[],g_nPrevUpKeyCode=null,g_nPreventScrollCount=0,g_objLastScroll=null;
function saveLastScroll(a){try{if(!objOnefficeLoader.m_bHybrid||g_browserCHK.iOS)return null;g_objLastScroll=null;var b=g_objEditorDocument[a].getElementById("dze_document_main_container");b&&(g_objLastScroll={},g_objLastScroll.scrollLeft=b.scrollLeft,g_objLastScroll.scrollTop=b.scrollTop);return g_objLastScroll}catch(c){dalert(c)}}function setPreventScrollCount(a){g_nPreventScrollCount=g_browserCHK.iOS?0:a}
var EventUtil={addHandler:function(a,b,c){try{a.addEventListener?!0===g_bBrowserType_CR&&"wheel"===b?a.addEventListener(b,c,{passive:!1}):a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c}catch(d){dalert(d)}},removeHandler:function(a,b,c){try{a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent?a.detachEvent("on"+b,c):a["on"+b]=null}catch(d){dalert(d)}},normalize:function(a,b){try{a&&(a.nEditNumber=b,dzeUiConfig.bOfficePagingMode&&(a.pageNum=g_objPageControl.getPageNum(a.target||
a.srcElement)),a.modifierKey=a.altKey||a.shiftKey||a.ctrlKey||a.metaKey)}catch(c){dalert(c)}},isLeftButton:function(a){return a?1===(a.button||a.which):!1},isRightButton:function(a){return a?null!==a.button&&void 0!==a.button?2===a.button:null!==a.which&&void 0!==a.which?3===a.which:!1:!1},isLeftButtonPressed:function(a){return a?1===a.buttons:!1},isRightButtonPressed:function(a){return a?2===a.buttons:!1}};
function initGlobalEvent(){try{window.attachEvent?(window.attachEvent("onresize",window_onresize),g_objLayerKit.getLayerDocument().attachEvent("onkeydown",document_onkeydown),g_objLayerKit.getLayerDocument().attachEvent("onkeyup",document_onkeyup),document.attachEvent("onmousedown",document_onmousedown),document.attachEvent("onclick",document_onclick),g_objLayerKit.getLayerDocument().attachEvent("mouseup",document_onmouseup)):(window.addEventListener("resize",window_onresize,!1),g_objLayerKit.getLayerDocument().addEventListener("keydown",
document_onkeydown,!1),g_objLayerKit.getLayerDocument().addEventListener("keyup",document_onkeyup,!1),document.addEventListener("mousedown",document_onmousedown,!1),document.addEventListener("click",document_onclick,!1),g_objLayerKit.getLayerDocument().addEventListener("mouseup",document_onmouseup),!0===g_bBrowserType_FF?g_objLayerKit.getLayerDocument().addEventListener("wheel",function(a){onMouseWheel(a,g_nActiveEditNumber)},!1):!0===g_bBrowserType_CR?g_objLayerKit.getLayerDocument().addEventListener("wheel",
function(a){onMouseWheel(a,g_nActiveEditNumber)},{passive:!1}):g_objLayerKit.getLayerDocument().addEventListener("mousewheel",function(a){onMouseWheel(a,g_nActiveEditNumber)},!1))}catch(a){}}
function initEditorEvent(a){try{a=parseInt(a,10);var b=function(b,c,d){b&&(EventUtil.addHandler(b,c,d),g_arrEditorListener.push({nEditNumber:a,elem:b,type:c,handler:d}))},c=g_objEditorDocument[a],d=g_objEditWindow[a],e=g_objEditObject[a],f=d.top;!1===objOnefficeLoader.m_bHybrid&&b(c,"contextmenu",function(b){editor_oncontextmenu(b,a);TBCancelBubbleEvent(b);return!1});b(d,"unload",function(b){editor_onunload(b,a)});b(c,"keydown",function(b){editor_onkeydown(b,a)});b(c,"keyup",function(b){editor_onkeyup(b,
a)});b(c,"change",function(b){editor_onchange(b,a)});b(c,"compositionstart",function(b){editor_oncompositionstart(b,a)});b(c,"compositionend",function(b){editor_oncompositionend(b,a)});b(c,"copy",function(b){editor_oncopy(b,a)});b(c,"cut",function(b){editor_oncut(b,a)});b(c,"paste",function(b){editor_onpaste(b,a)});b(c,"selectstart",function(b){editor_onselectstart(b,a)});b(f,"resize",function(b){top_window_onresize(b,a)});if(g_bBrowserType_IE){g_objLastRange[a]=null;g_objCurrentRange[a]=null;b(e,
"beforedeactivate",function(b){editor_onbeforedeactivate(a)});b(e,"deactivate",function(b){editor_ondeactivate(a)});b(c,"activate",function(b){editor_onactivate(b,a)});try{b(d,"scroll",function(b){editor_onscroll(b,a)})}catch(g){try{b(c,"mousewheel",function(b){editor_onmousewheel(b,a)})}catch(h){}}window.attachEvent?b(c,"selectionchange",function(b){editor_onselectionchange(a)}):b(c,"selectionchange",function(b){editor_onselectionchange_for_iframe(a)})}else{g_arrOnFocus_FF_WK[a]=!1;if(g_bBrowserType_FF)b(c,
"focus",function(b){editor_onfocus(b,a)}),b(c,"blur",function(b){editor_onblur(b,a)});else if(g_bBrowserType_WK||g_bBrowserType_OP)b(d,"focus",function(b){editor_onfocus(b,a)}),b(d,"blur",function(b){editor_onblur(b,a)});b(d,"scroll",function(b){editor_onscroll(b,a)})}attachMouseEvent(a)}catch(g){dalert(g)}}
function setWindowResizeEvent(a){try{a?window.setTimeout("setRestoreWindowResizeEvent()",100):window.detachEvent?window.detachEvent("onresize",window_onresize):window.removeEventListener("resize",window_onresize,!1)}catch(b){dalert(b)}}function setRestoreWindowResizeEvent(){try{window.attachEvent?window.attachEvent("onresize",window_onresize):window.addEventListener("resize",window_onresize,!1)}catch(a){dalert(a)}}
function window_onresize(){g_objLayerEventUtil.initHideDynamicLayer();objOnefficeLoader.m_bHybrid||g_objWrapperOutlineResize.resetExtOutlineInfo();if(g_bEditorHeightIFrameYN){var a=document.documentElement.clientHeight,b=0;"undefined"!=typeof window.frameElement&&null!=window.frameElement&&"iFrame_viewer"!=window.frameElement.id&&(null!=window.frameElement.getAttribute("dzeditor_no")&&(b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10)),resizeEditor_Height(b,a))}"undefined"!=typeof duzon_menubar&&
(duzon_menubar.rebuildHiddenToolbar(),g_objRulerBar.delayUpdate());addParentScrollEvent()}function top_window_onresize(){try{var a=g_objContextMenuWin;a&&a.isShow()&&a.initContextMenuLayerEvent();objOnefficeLoader.m_bHybrid||resizeEditor_Height(g_nActiveEditNumber)}catch(b){dalert(b)}}
function document_onmousedown(a){try{dlog("document_onmousedown");if(!0===panelManager.getInstance().isShowPanel()){var b=dzeJ(a.target).parents("div"),c=dzeJ(a.target).parents("#TB_CONTAINER_RULERBAR_0").length?!0:!1;if(0===b.length||!0===b.hasClass("duzon_dialog")||!0===b.hasClass("compatibility_main_popup")||"dze_idx_information_panel"===a.target.id||"dze_idx_right_pannel_0"===a.target.id||!0===b.hasClass("duzon_readonly_notification_bar_container")||!0===b.hasClass("duzon_msg_box")||"TB_CONTAINER_READONLY_NOTIBAR_0"===
a.target.id||c)return;!1===b.hasClass("dze_panel_container")&&panelManager.getInstance().hidePanel();!1===g_objPropertyUtil.element_hasClass(a.target,"dze_panel_doc_history_menu")&&dzeJ("#dze_panel_doc_history_menu_container").hide();"none"!==duzon_dialog.color_picker_mode&&duzon_dialog.closeExtendsDlg(a)}!0!==g_browserCHK.mobile&&g_objALinkMgr.doEvent(a)}catch(d){dalert(d)}}function document_onmouseup(a){try{dlog("document_onmouseup")}catch(b){dalert(b)}}
function document_onclick(a){try{!0!==g_browserCHK.mobile&&g_objALinkMgr.doEvent(a)}catch(b){dalert(b)}}
function document_onkeydown(a){try{dzeWebSearch.hideWebSearchBtn();var b=a.keyCode,c=a.target||a.srcElement;if(c&&"INPUT"===c.nodeName&&83===b&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL))return TBCancelBubbleEvent(a);if(!0===panelManager.getInstance().isShowPanel()){c=!1;var d=b===ID_KEYCODE_ARROW_LEFT||b===ID_KEYCODE_ARROW_RIGHT||b===ID_KEYCODE_ARROW_TOP||b===ID_KEYCODE_ARROW_BOTTOM;if(!0===a.ctrlKey||!0===a.altKey||!0===a.shiftKey||!0===a.metaKey)c=!0;!0===d&&(c="INPUT"!==a.target.nodeName||
"text"!==a.target.type?!0:!1);if(!0===c){var e=panelManager.getInstance().getCurrentPanelType();"INPUT"===a.target.nodeName||e!==PANEL_MAIN_TYPE.DOC_SHAPES&&e!==PANEL_MAIN_TYPE.DOC_CHART||(editor_onkeydown(a,g_nActiveEditNumber),a.preventDefault())}}g_objPropTagTableSelectFormula.bShowTagTableSelectFormula&&(b=a.keyCode,ID_KEYCODE_ESCAPE==b&&(duzon_dialog.closeDialog(),g_objPropTagTableSelectFormula.showTableCopyView(!1,null,-1,-1,-1)));a.keyCode==ID_KEYCODE_F7&&isEditor()&&fnHandler_pageSetting(null,
{},g_nActiveEditNumber)}catch(f){}}function document_onkeyup(a){}function checkProtectPrivacy(a){try{var b=g_objEditWindow[a].getSelection().anchorNode;ID_SELECTION_TEXT_NODE==b.nodeType&&(b=b.parentNode);var c=b.getAttribute("privacyKey"),d=b.getAttribute("privacyMark"),e=b.getAttribute("privacyProtect");return fnObjectCheckNull(c)||fnObjectCheckNull(d)||fnObjectCheckNull(e)?!1:!0}catch(f){}}
function editor_onkeydown(a,b){try{EventUtil.normalize(a,b);dzeWebSearch.hideWebSearchBtn();var c=a.keyCode,d=!1;if(g_readonlyMode&&(c===ID_KEYCODE_ENTER||c===ID_KEYCODE_SPACE||c===ID_KEYCODE_BACKSPACE||c===ID_KEYCODE_DELETE))return!1;objOnefficeLoader.m_bHybrid||oneffice.getAppEnvType()!=APPENV.GW||"undefined"===typeof onefficeGW||onefficeGW.callEditUse("keydown");if(isEditingKeyCode(a.keyCode)){var e=GetCurRange(b);if(e&&e.collapsed&&g_objPropertyUtil.hasClass(e.startContainer,["dze_page_main",
"dze_page_header","dze_page_footer"])){var f=e.startContainer.childNodes[e.startOffset];e=void 0;if(f){e=f.nextSibling;var g=f.ownerDocument}if(f&&f.nodeType===Node.TEXT_NODE&&e&&"HR"===e.nodeName)0<f.data.length&&(h=g.createElement("p"),h.appendChild(f),f.parentNode.insertBefore(h,e));else if(f&&"HR"===f.nodeName&&e&&"HR"===e.nodeName){var h=g.createElement("p");h.innerHTML="&#8203";f.parentNode.insertBefore(h,e);var k=document.createRange();k.setStart(h,0);k.setEnd(h,0);SetCurRange(k);k=null}}}0<
g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()&&(c===ID_KEYCODE_ARROW_LEFT||c===ID_KEYCODE_ARROW_RIGHT||c===ID_KEYCODE_ARROW_TOP||c===ID_KEYCODE_ARROW_BOTTOM)&&(d=!0);"ribbon"==dze_menu_control.ui_mode&&0==dze_menu_control.bShowStatusRibbonMainMenu&&dze_menu_control.showRibbonMainMenuContainer(b,!1);isArrowKeyCode(a.keyCode)||isModifierKeyCode(a.keyCode)||g_objPasteOptionMenu.remove();if(checkProtectPrivacy(b))return TBCancelBubbleEvent(a);DZESHORTCUT.setDzeShortCutEvent(a,
b);!a.altKey||a.ctrlKey||a.shiftKey||(ID_KEYCODE_ARROW_LEFT==a.keyCode||ID_KEYCODE_ARROW_RIGHT==a.keyCode)&&TBCancelBubbleEvent(a);!a.modifierKey&&isNavigationKeyCode(a.keyCode)&&replaceFontTag(a);var m=g_objTableFunction.getCurrentCell(b),n=m?m.table:null;if(!1===d&&n){g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();!0!==g_bBrowserType_WK||!0!==g_bBrowserType_CR||a.keyCode!==ID_KEYCODE_BACKSPACE&&a.keyCode!==ID_KEYCODE_DELETE&&a.keyCode!==ID_KEYCODE_ENTER||1!==n.rows.length||1!==n.rows[0].cells.length||
g_objAdjustDoc.customDeleteEvent(a,b);if(dzeUiConfig.bUseLockEditCellFunction&&!0===checkDzeCellLocked(a,b)&&!g_objNodeUtil.isTextArea(a.srcElement||a.target)){TBCancelBubbleEvent(a);return}var t=m.cell;t&&!t.firstChild&&(!a.modifierKey&&isEditingKeyCode(a.keyCode)||a.keyCode==ID_KEYCODE_V&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)||a.keyCode==ID_KEYCODE_INSERT&&a.shiftKey)&&(t.innerHTML="<p><br></p>",g_objCaretUtil.moveCaret(t));GetMultiCellSelection(b)?a.modifierKey||(ID_KEYCODE_DELETE===
c?g_objTableOperation.deleteSelectedCellContents(n,b)&&(TBCancelBubbleEvent(a),g_objUndoRedo.bMultiCellKeyDownOP=!0):ID_KEYCODE_BACKSPACE!==c||g_browserCHK.mobile?g_objTableSelection.isTableNaviKey(c)||(g_objTableSelection.clearCellSelection(),g_objUndoRedo.bMultiCellKeyDownOP=!0):!g_browserCHK.mobile&&g_objTableOperation.deleteSelectedCell(b,n,!1)&&(TBCancelBubbleEvent(a),g_objUndoRedo.bMultiCellKeyDownOP=!0)):a.cancelBubble||(ID_KEYCODE_TAB!==c||a.altKey||DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)?
isArrowKeyCode(c)&&!a.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&g_objTableSelection.checkMoveCellForce(a)&&(c===ID_KEYCODE_ARROW_TOP||c===ID_KEYCODE_ARROW_BOTTOM?g_objTableFunction.moveFocusUpDownCell(a,b)&&TBCancelBubbleEvent(a):(c===ID_KEYCODE_ARROW_LEFT||c===ID_KEYCODE_ARROW_RIGHT)&&g_objTableFunction.moveFocusNextCell(a,b)&&TBCancelBubbleEvent(a)):g_objTableFunction.moveFocusNextCell(a,b)&&TBCancelBubbleEvent(a));if(objOnefficeLoader.m_bHybrid&&a.keyCode===ID_KEYCODE_BACKSPACE&&
(k=GetCurRange(b),!0===k.collapsed&&"TD"==k.startContainer.parentNode.nodeName)){var w=g_objNodeUtil.getLoopParentElementByTagNames(k.startContainer,["td","th"]);SelectionUtil.isOnFirst(w,k.startContainer,k.startOffset)&&TBCancelBubbleEvent(a)}}isModifierKeyCode(c)||isLockKeyCode(c)||isContextualKeyCode(c)||a.cancelBubble||c===ID_KEYCODE_C&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)||g_objWrapperOutlineResize.resetExtOutlineInfo(a);switch(c){case ID_KEYCODE_ESCAPE:if(!1===fnObjectCheckNull(g_objSelectedShapesArray)&&
0<g_objSelectedShapesArray.length||g_objWrapperOutlineUtil_Improved.getActionType())g_objShapeFunction.onKeyDown(a);return;case ID_KEYCODE_BACKSPACE:case ID_KEYCODE_DELETE:c===ID_KEYCODE_DELETE?(onDeleteListEvent(a)&&TBCancelBubbleEvent(a),g_objPageControl.removePageBreakForDel(a),!0===g_bBrowserType_IE&&checkSetIFrameSrcBlankForDelete(b),pullBelowDelete(a)&&g_objUndoRedo.registerUndoRedoStack(0,b,null)):(g_objPageControl.deleteIndent(a)&&TBCancelBubbleEvent(a),g_objPageControl.removePageBreakForBack(a),
!0===g_bBrowserType_IE&&checkSetIFrameSrcBlankForDelete(b),pullBelowBackspace(a)&&g_objUndoRedo.registerUndoRedoStack(0,b,null));if(!0===dzeUiConfig.bUseReportForm){var u=a.target;if(!1===fnObjectCheckNull(u)&&u.nodeName.toLowerCase()===DZE_TAG_INPUT){var v=g_objNodeUtil.getParentElement(u);!1===fnObjectCheckNull(v)&&(v.removeChild(u),TBCancelBubbleEvent(a))}}g_objShapeFunction.onKeyDown(a);checkOnlyBlankPara(a)&&TBCancelBubbleEvent(a);deleteAlonePara(a)&&TBCancelBubbleEvent(a);break;case ID_KEYCODE_ENTER:!1===
g_bBrowserType_IE&&g_objALinkMgr.setHyperlinkAuto(b);if(!a.shiftKey&&insertParaExceTag(b)){TBCancelBubbleEvent(a);return}if(null===g_objShapeEvtMgr.getShapeTextContainer()){if(!0===g_bBrowserType_IE){var q=GetCurRange(b);q&&0<dzeJ(q.commonAncestorContainer).parents(".dze_shape_main").length&&TBCancelBubbleEvent(a)}applyListBlankEnter(a,b);if(0<g_objSelectedShapesArray.length)g_objShapeFunction.onDeselectAllShapes(!0)}null!=g_objCropObj&&null!=g_objCropObj.getCropObj()&&(g_objCropObj.changeOrgImgView(),
g_objCropObj=null,g_objShapeFunction.onDeselectAllShapes(!0),TBCancelBubbleEvent(a));insertPara(a);updateOListAfterEnterKeydown(a,b);break;case ID_KEYCODE_SPACE:!1===g_bBrowserType_IE&&g_objALinkMgr.setHyperlinkAuto(b);if(null===g_objShapeEvtMgr.getShapeTextContainer()&&0<g_objSelectedShapesArray.length)g_objShapeFunction.onDeselectAllShapes(!1);break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();
if(c===ID_KEYCODE_ARROW_BOTTOM&&g_bBrowserType_IE){var l=g_objNodeUtil.getAncestorNodeOnCaret(b);l&&l.nodeType==ID_SELECTION_TEXT_NODE&&(l=l.parentNode);!l||"span"!=l.nodeName.toLowerCase()||"<br>"!=l.innerHTML.trim()||"p"!=l.parentNode.nodeName.toLowerCase()||l.previousSibling||l.nextSibling||(l.innerHTML="&#8203;")}if(!0===d){if(!0===g_objShapeFunction.onKeyDown(a))return;if(!0===a.shiftKey&&"relative"===g_objSelectedShapesArray[0].style.position.toLowerCase())g_objShapeFunction.onDeselectAllShapes(!1)}onKeyDownOnHR(b,
a);break;case ID_KEYCODE_C:case ID_KEYCODE_X:DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&!1===a.altKey&&!1===a.shiftKey&&pageManager.getInstance().initValues();break;case ID_KEYCODE_Y:case ID_KEYCODE_Z:g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer();var p=g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL?!0:!1;if((!p&&a.ctrlKey&&!a.altKey&&!a.shiftKey||p&&a.metaKey&&c==ID_KEYCODE_Z)&&!g_objNodeUtil.isTextArea(SelectionUtil.isOnInput(b))){TBCancelBubbleEvent(a);g_readonlyMode||
(!p&&c==ID_KEYCODE_Y||p&&a.metaKey&&c==ID_KEYCODE_Z&&a.shiftKey?g_objUndoRedo.operateUndoRedoStack(!1,!1,b):(!p&&c==ID_KEYCODE_Z||p&&a.metaKey&&c==ID_KEYCODE_Z)&&g_objUndoRedo.operateUndoRedoStack(!0,!1,b));break}default:if(g_bDynamicLayer&&g_objLayerEventUtil.initHideDynamicLayer(),!a.cancelBubble&&0<g_objSelectedShapesArray.length&&!0===fnObjectCheckNull(g_objEditorDocument[b].getElementById("dze_shape_textbox"))&&(isEditingKeyCode(c)||DZESHORTCUT.isPressedKeyMapForOS(this.evnt,ID_KEYCODE_CTRL)&&
a.keyCode===ID_KEYCODE_A))g_objShapeFunction.onDeselectAllShapes()}switch(c){case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_TAB:case ID_KEYCODE_SPACE:case ID_KEYCODE_ENTER:case ID_KEYCODE_DELETE:case ID_KEYCODE_INSERT:case ID_KEYCODE_HOME:case ID_KEYCODE_END:var r=letterFunction.getInstance();!0===r.hasSavedStyle()&&r.removeStyleSpan();break;case ID_KEYCODE_F1:case ID_KEYCODE_F2:case ID_KEYCODE_F3:case ID_KEYCODE_F4:case ID_KEYCODE_F5:case ID_KEYCODE_F6:case ID_KEYCODE_F7:case ID_KEYCODE_F8:case ID_KEYCODE_F9:case ID_KEYCODE_F10:case ID_KEYCODE_F11:case ID_KEYCODE_F12:case ID_KEYCODE_NUM_LOCK:case ID_KEYCODE_SCROLL_LOCK:case ID_KEYCODE_CAPSLOCK:case ID_KEYCODE_ALT:case ID_KEYCODE_CTRL:case ID_KEYCODE_SHIFT:break;
default:r=letterFunction.getInstance(),!0===r.hasSavedStyle()&&r.initStyleSpan(),!0===g_bBrowserType_IE&&(q=GetCurRange(b),!1===fnObjectCheckNull(q)&&0<dzeJ(q.commonAncestorContainer).parents(".dze_shape_main").length&&TBCancelBubbleEvent(a))}g_objPlaceholder.onkeydown(a,b);dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteKeyDown(a,b);!g_readonlyMode&&a&&!a.cancelBubble&&isEditingKeyCode(c)&&!a.modifierKey&&SelectionUtil.isDeleteDirectly(b)&&SelectionUtil.deleteSelection(b)&&(g_objUndoRedo.bMarkingKeyDownOP=
!0,c===ID_KEYCODE_BACKSPACE||c===ID_KEYCODE_DELETE)&&(g_objCaretUtil.scrollToCaret(),TBCancelBubbleEvent(a));g_bBrowserType_CR&&!g_bBrowserType_EDGE&&!0===onKeyDownBesideTable(a)&&(g_objUndoRedo.bMultiCellKeyDownOP=!0);c=null;g_readonlyMode||!(c=SelectionUtil.isOnInput(b))||c.hasAttribute("readonly")||resizeInput(c);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onProcessKeyEvent(a)}catch(x){dalert(x)}}
function editor_onkeyup(a,b){try{EventUtil.normalize(a,b);var c=a.keyCode,d=null;g_objObjectSelectionInfo.bSelectObject&&(d=cloneObjectSelectionInfo());g_objPlaceholder.onkeyup(a,b);var e=null;g_readonlyMode||!(e=SelectionUtil.isOnInput(b))||e.hasAttribute("readonly")||resizeInput(e);var f=g_objTableFunction.getCurrentCell(b);if(!1===fnObjectCheckNull(f)&&!1===fnObjectCheckNull(f.cell)&&!1===fnObjectCheckNull(f.cell.getAttribute("max_text_counts"))){TEXT.countsInfo.show(f.cell);var g=1*f.cell.getAttribute("max_text_counts");
!1===fnObjectCheckNull(g)&&!1===isNaN(g)&&(TEXT.getTextCounts(f.cell)>g?TEXT.countsInfo.warn(g):TEXT.countsInfo.safe())}else TEXT.countsInfo.box&&"none"!==TEXT.countsInfo.box.style.display&&TEXT.countsInfo.hide();if(window.addEventListener&&229!=a.keyCode){if(ID_KEYCODE_CTRL==c)return;if(ID_KEYCODE_ALT==c){TBCancelBubbleEvent(a);return}if(ID_KEYCODE_CAPSLOCK==c)return;resetSelectionObjectInfo();editor_onselectionchange(b)}if(ID_KEYCODE_V!=c&&(e=g_nPrevUpKeyCode,!(e===ID_KEYCODE_CTRL&&c===ID_KEYCODE_A||
e===ID_KEYCODE_CTRL&&c===ID_KEYCODE_C||ID_KEYCODE_CAPSLOCK==c||DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&(ID_KEYCODE_V==c||ID_KEYCODE_Z==c||ID_KEYCODE_A==c||ID_KEYCODE_X==c))))if(onKeyUpOnHR(b,a,d),!a.modifierKey&&isEditingKeyCode(a.keyCode)&&replaceFontTag(a),g_readonlyMode||g_objUndoRedo.checkKeyCodeInput(a,b),0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()){if(0<g_objShapeFunction.nContinuousInput&&(c===ID_KEYCODE_ARROW_LEFT||c===ID_KEYCODE_ARROW_RIGHT||
c===ID_KEYCODE_ARROW_TOP||c===ID_KEYCODE_ARROW_BOTTOM)){for(a=0;a<g_objSelectedShapesArray.length;a++){var h=g_objSelectedShapesArray[a];if("absolute"===h.style.position.toLowerCase())g_objShapeFunction.onUpdateShapesAnchor(h)}g_objShapeFunction.nContinuousInput=0;g_objUndoRedo.registerUndoRedoStack(0,b)}}else g_objTableSelection.onKeyUp(a,b)}catch(k){dalert(k)}finally{g_nPrevUpKeyCode=c}}
function editor_onchange(a,b){try{if(a){var c=a.target||a.srcElement;a=!1;!g_readonlyMode&&g_objTagUtil.updateFormTagAttr(c)&&(a=!0);a&&g_objUndoRedo.registerUndoRedoStack(0,b)}}catch(d){dalert(d)}}function editor_oncompositionstart(a,b){try{g_objCaretUtil.bComposing=!0}catch(c){dalert(c)}}function editor_oncompositionend(a,b){try{g_objCaretUtil.bComposing=!1}catch(c){dalert(c)}}
function editor_onfocus(a,b){try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&!g_arrOnFocus_FF_WK[b]&&(g_arrOnFocus_FF_WK[b]=!0,g_bActivate[b]=!0,g_nActiveEditNumber=b)}catch(c){}try{(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&""!=g_strFocusEventFunction&&eval(g_strFocusEventFunction+"("+b+", 1);")}catch(c){dalert(c)}}function editor_onblur(a,b){}
function editor_onunload(a,b){b=parseInt(b,10);try{var c=g_objEditorDocument[b],d=g_objEditorDocument[DZE_IFRAME_TMP_NO+b];g_objEditorDocument[b]=null;g_objEditorDocument[DZE_IFRAME_TMP_NO+b]=null;g_bBrowserType_IE?(c.execCommand("Unselect"),c.body.contentEditable=!1,c.body.innerHTML="",d.body.contentEditable=!1):c.body.innerHTML="";d.body.innerHTML=""}catch(f){dalert(f)}try{detachMouseEvent(b);window.detachEvent?window.detachEvent("onresize",window_onresize):window.removeEventListener("resize",window_onresize,
!1);a=g_arrEditorListener;c=null;d=0;for(var e=a.length;d<e;d++)(c=a[d])&&c.nEditNumber===b&&(EventUtil.removeHandler(c.elem,c.type,c.handler),a[d]=null);g_arrEditorListener=a.filter(function(a){return null!==a});g_objPasteOptionMenu.unload();g_objTransparentViewUtil.unload();g_objContextMenuWin.unload();duzon_menubar.unload();g_objComboBoxWin.unload();g_objMenuWin.unload();duzon_dialog.unload();g_objTableSizeBoxWin.unload();g_objLineHeightWin.unload();g_objLetterSpacingWin.unload();duzon_http.unloadLoading();
g_objCommonUtil.unloadDPI();g_objTableResize.unload();g_objTableMiniMenu.unload();pageManager.getInstance().unload();g_objZoom.unload();g_objWrapperOutlineUtil.unload()}catch(f){dalert(f)}}
function attachMouseEvent(a){try{a=parseInt(a,10);var b=function(b,c,d){EventUtil.addHandler(b,c,d);g_arrMouseListener.push({nEditNumber:a,elem:b,type:c,handler:d})},c=function(a){return objOnefficeLoader.m_bHybrid&&(a&&!a.sourceCapabilities||a&&a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents)?!0:!1},d=g_objEditorDocument[a];b(d,"mousedown",function(b){c(b)||editor_onmousedown(b,a)});b(d,"mousemove",function(b){c(b)||editor_onmousemove(b,a)});b(d,"mouseup",function(b){c(b)||editor_onmouseup(b,
a)});b(d,"mouseover",function(b){editor_onmouseover(b,a)});b(d,"mouseout",function(b){editor_onmouseout(b,a)});b(d,"click",function(b){editor_onclick(b,a)});b(d,"dblclick",function(b){editor_ondblclick(b,a)});objOnefficeLoader.m_bHybrid&&(b(d,"touchstart",function(b){editor_ontouchstart(b,a)}),b(d,"touchmove",function(b){editor_ontouchmove(b,a)}),b(d,"touchend",function(b){editor_ontouchend(b,a)}));window.attachEvent||(!0===g_bBrowserType_FF||!0===g_bBrowserType_CR?b(d,"wheel",function(b){onMouseWheel(b,
a)}):b(d,"mousewheel",function(b){onMouseWheel(b,a)}));return!0}catch(e){dalert(e)}}function detachMouseEvent(a){try{a=parseInt(a,10);for(var b=g_arrMouseListener,c=null,d=0,e=b.length;d<e;d++)(c=b[d])&&c.nEditNumber===a&&(EventUtil.removeHandler(c.elem,c.type,c.handler),b[d]=null);g_arrMouseListener=b.filter(function(a){return null!==a});return!0}catch(f){dalert(f)}}
function editor_oncontextmenu(a,b){try{if(g_bContextMenuUseYN&&g_nActiveEditNumber==b){var c=g_objContextMenuWin.getContextMenuType(a,b);g_objContextMenuWin.objContextInfo=c;if(null!=c){g_objWrapperOutlineResize.resetExtOutlineInfo();var d=g_objPositionUtil.getNodeElementPosition(g_objEditObject[b]),e=d.left,f=d.top;d=null;d=window.attachEvent?g_objEditorDocument[b].parentWindow.event:a;var g=e+d.clientX,h=f+d.clientY;if(g_bBrowserType_IE){if(0===g&&0===h){var k=GetCurRange(b);if(k&&k.getBoundingClientRect){var m=
k.getBoundingClientRect();g=e+m.left;h=f+m.top}}dzeEnvConfig.iFrameLayer&&(g+=8,h+=8)}g_objContextMenuWin.showContextMenuLayer(c,g,h,b)}}}catch(n){dalert(n)}}
function getSelectedObjectType(a){try{if(!0===fnObjectCheckNull(a))return DZE_OBJ_NONE;var b=g_objShapeFunction.getShapeObject(a),c=a.nodeName.toLowerCase(),d=g_objNodeUtil,e=g_objVideoControl,f=DZE_OBJ_NONE;!1===fnObjectCheckNull(b)?f=DZE_OBJ_SHAPE:!1===fnObjectCheckNull(g_objShapeFunction.getTextboxInShape(a))?f=DZE_OBJ_SHAPE_TEXT:c===DZE_TAG_IMG?f=!1===fnObjectCheckNull(a.getAttribute("chart_data"))?DZE_OBJ_CHART:e.isVideoSpan(a.parentNode)?DZE_OBJ_VIDEO:DZE_OBJ_IMG:e.isVideo(a)||e.isVideoControl(a)?
f=DZE_OBJ_VIDEO:d.getLoopParentElementByTagNames(a,d.arrCellTagName)&&(f=DZE_OBJ_TABLE);return f}catch(g){dalert(g)}}
function onMouseWheel(a,b){try{if(setPreventScrollCount(0),!0===a.ctrlKey)g_objZoom.onMouseWheel(a,b),TBCancelBubbleEvent(a);else{var c=dzeJ(a.target).parents("div.dze_panel_contents")[0],d=dzeJ(a.target).parents("div.dze_panel_body")[0];if(!1===fnObjectCheckNull(c)||!1===fnObjectCheckNull(d)){var e=a.wheelDelta;!0===fnObjectCheckNull(e)&&(e=-40*a.deltaY);c=dzeJ(".dze_panel_contents.activate");c.scrollTop(c.scrollTop()-e/3);TBCancelBubbleEvent(a)}dzeJ("#dze_panel_doc_history_menu_container").hide()}}catch(f){dalert(f)}}
function editor_onmousedown(a,b){try{saveLastScroll(b);if(!0===fnObjectCheckNull(a))return;objOnefficeLoader.m_bHybrid||oneffice.getAppEnvType()!=APPENV.GW||onefficeGW.callEditUse("mousedown");EventUtil.normalize(a,b);g_objMouseEvent=a;g_nActiveEditNumber=b;g_objUndoRedo.setKeyCodeContinue(!1,b);var c=a.srcElement?a.srcElement:a.target;g_objPageEditable.doEvent(a);var d=g_objPageControl;if(!g_readonlyMode&&dzeUiConfig.bOfficePagingMode&&!g_objHeaderFooter.getHeaderFooterEditMode()){var e=d.getPageMain(d.getPageNum(c));
e&&"false"===e.contentEditable&&(e.contentEditable=!0)}dzeWebSearch.hideWebSearchBtn();"ribbon"==dze_menu_control.ui_mode&&0==dze_menu_control.bShowStatusRibbonMainMenu&&dze_menu_control.showRibbonMainMenuContainer(b,!1);g_objPageControl.doPageLabelBtnEvent(a,b);if("dze_printpagebreak_guide"==c.className){TBCancelBubbleEvent(a);return}if("HR"===c.nodeName&&g_bBrowserType_IE){TBCancelBubbleEvent(a);return}if("dze_idx_qr_container"==c.id||"dze_idx_qr_image"==c.id||"dze_idx_qr_border"==c.id){TBCancelBubbleEvent(a);
return}d=g_objHeaderFooter;if(!g_readonlyMode&&d){if(!d.bUseEditMode&&!0===d.onmousedown(a)){TBCancelBubbleEvent(a);return}if(d.bUseEditMode&&d.getHeaderFooterEditMode()!==d.contains(c)){TBCancelBubbleEvent(a);return}}if(!0===dzeUiConfig.bSupportNewsEditor&&!g_readonlyMode&&d&&d.contains(c)&&"INPUT"!==c.nodeName&&"TEXTAREA"!==c.nodeName){TBCancelBubbleEvent(a);return}setSelectionColor(b);g_objWrapperOutlineResize.resetExtOutlineInfo();if(-1==b)return g_nTableEventID=ID_TABLE_EVENT_NOTHING,!1;var f=
a.target,g=getSelectedObjectType(f);c=null;g_readonlyMode||g!==DZE_OBJ_NONE||(c=g_objShapeFunction.getShapeBehindText(f,a))&&(g=!0===c.classList.contains("dze_shape_main")?DZE_OBJ_SHAPE:DZE_OBJ_SHAPE_TEXT);g!==DZE_OBJ_TABLE&&(g_objTableFlag.ResetTableInfo(!1),TEXT.countsInfo.hide());if(!g_readonlyMode&&g!==DZE_OBJ_SHAPE&&g!==DZE_OBJ_SHAPE_TEXT)g_objShapeFunction.onDeselectAllShapes();switch(g){case DZE_OBJ_SHAPE:g_readonlyMode||null!==c||(c=g_objShapeFunction.getShapeObject(f));if(null!==c&&!1===
objOnefficeLoader.m_bHybrid)g_objShapeFunction.onMouseDown(c,a);break;case DZE_OBJ_TABLE:g_objTableSelection.doEvent(a,b);var h=g_objNodeUtil.getLoopParentElement(f,"TD");h&&h.hasAttribute("max_text_counts")?TEXT.countsInfo.show(h):TEXT.countsInfo.hide();break;case DZE_OBJ_VIDEO:g_objVideoControl.doEvent(a)}g_objALinkMgr.doEvent(a);g_objPlaceholder.onmousedown(a,b);dzeJ("#dze_panel_doc_history_menu_container").hide();return!0}catch(k){dalert(k)}return!1}
function editor_onmousemove(a,b){try{var c=a.srcElement?a.srcElement:a.target,d=g_objHeaderFooter.getHeaderFooterEditMode();EventUtil.normalize(a,b);g_objPageEditable.doEvent(a);objOnefficeLoader.m_bHybrid||oneffice.getAppEnvType()!=APPENV.GW||onefficeGW.callEditUse("mousemove");g_readonlyMode||!1!==dzeUiConfig.bOfficeOnePageLongMode||1===a.buttons||d||g_bDynamicLayer||pageManager.getInstance().updatePageAddButton(a);g_readonlyMode||d===g_objHeaderFooter.contains(c)?(g_objTableSelection.doEvent(a,
b)||g_readonlyMode||g_objTableResize.checkResizeLineLayer(a,b),g_objVideoControl.doEvent(a)):TBCancelBubbleEvent(a)}catch(e){dalert(e)}}function editor_onmouseover(a,b){try{g_objPageControl.doPageLabelBtnEvent(a,b)}catch(c){dalert(c)}}function editor_onmouseout(a,b){try{g_objPageControl.doPageLabelBtnEvent(a,b)}catch(c){dalert(c)}}var timeoutfocus=null;
function editor_onmouseup(a,b){try{g_browserCHK.iOS&&objOnefficeLoader.m_bHybrid&&(clearTimeout(timeoutfocus),timeoutfocus=setTimeout(function(){var c=g_objEditWindow[0];c&&c.getSelection();var d=a.changedTouches;c=d[0];d=d[d.length-1];c=g_objCaretUtil.getRangeFromPoint(c.clientX,c.clientY);d=g_objCaretUtil.getRangeFromPoint(d.clientX,d.clientY);c&&d&&(c=c.clone(),c.ec=d.ec,c.eo=d.eo,c=g_objPageEditable.correctRangeOrder(c),d=g_objEditorDocument[b].createRange(),d.setStart(c.sc,c.so),d.setEnd(c.ec,
c.eo),SetCurRange(d))},0));EventUtil.normalize(a,b);g_objPageEditable.doEvent(a);var c=a.srcElement?a.srcElement:a.target;if("dze_printpagebreak_guide"==c.className){TBCancelBubbleEvent(a);return}if("dze_idx_qr_container"==c.id||"dze_idx_qr_image"==c.id||"dze_idx_qr_border"==c.id){TBCancelBubbleEvent(a);return}var d=g_objHeaderFooter;if(!g_readonlyMode&&d&&d.getHeaderFooterEditMode()!==d.contains(c)){TBCancelBubbleEvent(a);return}if(!0===dzeUiConfig.bSupportNewsEditor&&!g_readonlyMode&&d&&d.contains(c)&&
"INPUT"!==c.nodeName&&"TEXTAREA"!==c.nodeName){TBCancelBubbleEvent(a);return}if(!0!==g_readonlyMode&&a.button===MOUSE_BTN.L){var e=g_objShapeFunction.getTextboxInShape(a.target);if(null!==e)if(e=g_objNodeUtil.getLoopParentByClassName(e,"dze_shape_main"),null===g_objShapeEvtMgr.getShapeTextContainer())g_objCaretUtil.saveCaret(),g_objShapeFunction.onChangeEditTextMode(!0,e,!0);else{var f=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(0);null!==e&&e!==f&&(g_objWrapperOutlineUtil_Improved.updateShapeText(f),
g_objWrapperOutlineUtil_Improved.hideTextBox(f),g_objWrapperOutlineUtil_Improved.hideOutline(f),g_objCaretUtil.saveCaret(),g_objShapeFunction.onChangeEditTextMode(!0,e,!0))}else if(getSelectedObjectType(a.target)!==DZE_OBJ_SHAPE)g_objShapeFunction.onDeselectAllShapes()}"dze_shape_main"==c.className&&TBCancelBubbleEvent(a);g_objTableSelection.doEvent(a,b)&&(c=null,!objOnefficeLoader.m_bHybrid&&g_bTableCellResizingYN&&!GetMultiCellSelection(b)&&(c=GetCurCell(b))&&(g_objWrapperOutlineResize.newExtSelectedInfo(DZE_OBJ_TD,
c),g_objWrapperOutlineUtil.showExtOutline(c,!0,!0,!1,b)),updateHandlerUI.update_toolbar_combobox("",b),dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&updateHandlerUI.update_toolbar_for_locked_cell_option(b));g_nTableEventID=ID_TABLE_EVENT_NOTHING;onefficeChart.insertChart(b);checkObjectElemetMouseUp(a,b,g_objMouseEvent);editor_onselectionchange(b);var g=panelManager.getInstance();!0!==g.isShowPanel()||g.getCurrentPanelType()===PANEL_MAIN_TYPE.DOC_OPEN_INFO||g.getCurrentPanelType()===PANEL_MAIN_TYPE.DOC_COMMENT||
0!==g_objSelectedShapesArray.length||"img"===g_objObjectSelectionInfo.strNodeName&&!0!==fnObjectCheckNull(g_objObjectSelectionInfo.objSelectionObject.getAttribute("chart_id"))||panelManager.getInstance().hidePanel();dzeUiConfig.bApplyPasteStyleMode&&letterFunction.getInstance().pasteTextStyle(a.button===MOUSE_BTN.L);dzeHighlighter.setHighlight(b);dzeWebSearch.viewWebSearchBtn(b,a);g_objVideoControl.doEvent(a);g_browserCHK.mobile&&g_objALinkMgr.doEvent(a);return!0}catch(h){dalert(h)}finally{g_objMouseEvent=
null}return!1}function editor_ontouchstart(a,b){try{editor_onmousedown(a,b)}catch(c){dalert(c)}}function editor_ontouchmove(a,b){}function editor_ontouchend(a,b){try{editor_onmouseup(a,b)}catch(c){dalert(c)}}
function editor_onpaste(a,b){try{if(dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.isPasting())a.preventDefault();else if(!SelectionUtil.isOnInput(b)){g_objAdjustDoc.setTarget(null,b);dzeUiConfig.bUsePasteCapture&&g_objCopyPaste.pasteBefore(a,b)&&(g_objAdjustDoc.setTarget(g_objCopyPaste.getPasteDiv(),b),dzeUiConfig.bRemoveXSS&&g_objCopyPaste.setTimeoutForPaste(function(){var a=g_objCopyPaste.getPasteDiv();a&&(a.innerHTML=removeXSS(a.innerHTML))},0));if(!g_readonlyMode&&g_bAutoAdjustHwpWordYN){if(g_bBrowserType_WK&&
g_objAdjustDoc.checkPasteCode_Excel_WK(a)){!0===dzeUiConfig.bUseContentExtUpload?g_objExtUploader.pasteImageFromClipboard(a,b):DZE_UPLOAD_EVENT.pasteInsertImageFromClipboard(a,b);g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.adjustPasteCode_WK(b)},0);g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.doAdjustDocProcess(b)},0);return}g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.adjustDocProcess(b)},0)}g_readonlyMode||(!0===dzeUiConfig.bUseContentExtUpload?g_objExtUploader.pasteImageFromClipboard(a,
b):DZE_UPLOAD_EVENT.pasteInsertImageFromClipboard(a,b),g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.pasteRangeImageAutoUpload(b)},0));g_readonlyMode||!0!==dzeUiConfig.bApplyPasteOnefficeLink||pasteOnefficeLink(a,b)}}catch(c){dalert(c)}}
function editor_onpaste_complete(a,b){try{if(dzeUiConfig.bUsePasteCapture){g_objAdjustDoc.setTarget(null);a=g_objPasteOptionMenu;var c=a.pasteEndNode;a.pasteEndNode=null;g_objUndoRedo.registerUndoRedoStack(0,b);a.pasteEndNode=c;switch(a.pasteContentsType){case g_objCopyPaste.PASTE_IMAGE:break;default:a.hide(),a.show(!0)}if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer(0,null,function(){g_objCaretUtil.scrollToCaret();g_objPasteOptionMenu.onWheel();editor_onselectionchange(b)})}}catch(d){dalert(d)}}
function editor_oncopy(a,b){try{if(SelectionUtil.isOnInput(b))return!1;EventUtil.normalize(a,b);dzeClipBoard.initialize();if(!1===objOnefficeLoader.m_bHybrid)g_objCopyPaste.onCopy(a)}catch(c){dalert(c)}}function editor_oncut(a,b){try{if(g_readonlyMode||!1===g_objCaretUtil.isContentEditable(b))return editor_oncopy(a,b);if(SelectionUtil.isOnInput(b))return!1;EventUtil.normalize(a,b);dzeClipBoard.initialize();if(!1===objOnefficeLoader.m_bHybrid)g_objCopyPaste.onCut(a)}catch(c){dalert(c)}}
function editor_onclick(a,b){try{EventUtil.normalize(a,b);var c=a.target||a.srcElement;g_objPageControl.doPageLabelBtnEvent(a,b);if(g_readonlyMode||g_objHeaderFooter.getHeaderFooterEditMode()==g_objHeaderFooter.contains(c)){g_objVideoControl.doEvent(a);if(!a.cancelBubble&&g_objNodeUtil.isCell(c)){var d=c.firstChild;g_bBrowserType_IE&&(d=c.firstChild&&"SPAN"===c.firstChild.nodeName&&c.firstChild===c.lastChild?c.firstChild.firstChild:null);var e=d&&"INPUT"===d.nodeName?d:null,f=e&&e.nextSibling&&"LABEL"===
e.nextSibling.nodeName?e.nextSibling:null;e&&f&&!f.nextSibling&&("checkbox"===e.type||"radio"===e.type)&&e.click()}g_objALinkMgr.doEvent(a);adjustSelectionOnTripleClickCell(b,a);g_objTableSelection.doEvent(a,b);setPreventScrollCount(3)}else TBCancelBubbleEvent(a)}catch(g){dalert(g)}}
function editor_ondblclick(a,b){try{if(!0!==g_readonlyMode){var c=a.target||a.srcElement,d=null;if(g_objHeaderFooter.getHeaderFooterEditMode()!=g_objHeaderFooter.contains(c)&&g_objHeaderFooter.ondblclick(a))TBCancelBubbleEvent(a);else if("input"===c.nodeName.toLowerCase()&&"text"===c.type.toLowerCase()&&!0===g_objPropertyUtil.element_hasClass(c,"dze_external_data_area"))fnHandler_showInputBoxDialog(a,b);else if("img"===c.nodeName.toLowerCase())if("dze_idx_qr_container"==c.id||"dze_idx_qr_image"==
c.id||"dze_idx_qr_border"==c.id)TBCancelBubbleEvent(a);else if(c.getAttribute("chart_id")){if(!1===panelManager.getInstance().isShowPanel()){var e=document.getElementById("TB_INSERT_CHART_"+b);fnHandler_chartAttrPanel(a,e,b)}}else c.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_IMG)?(e=document.getElementById("TB_INSERT_IMAGE_"+b),fnHandler_replaceImage(a,e,b)):c.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO)?(e=document.getElementById("TB_INSERT_OBJECT_MOVIE_"+b),fnHandler_InsertExtMovie(a,e,b)):g_objVideoControl.isVideo(c.parentNode)?
(e=document.getElementById("TB_INSERT_OBJECT_MOVIE_"+b),fnHandler_videoProperty(a,e,b)):(e=document.getElementById("TB_PROP_INSERT_IMAGE_"+b),fnHandler_ModifyImage(a,e,b));else if("VIDEO"===c.nodeName)e=document.getElementById("TB_INSERT_OBJECT_MOVIE_"+b),fnHandler_videoProperty(a,e,b);else if(d=g_objPageNumber.ondblclick(a))TBCancelBubbleEvent(a),d.command_id=ID_COMMAND_PGNUM_FORMAT,fnHandler_PageNumber(a,d,b);else g_objHeaderFooter.ondblclick(a)}}catch(f){}}
function editor_onscroll(a,b){try{g_objContextMenuWin.bContextMenuAttachMouseEvent&&g_objLayerEventUtil.initHideDynamicLayer(),g_objWrapperOutlineResize.resetExtOutlineInfo()}catch(c){}}function editor_onmousewheel(){try{setPreventScrollCount(0),editor_onscroll(null,g_nActiveEditNumber)}catch(a){}}
function attachMouseDragDropEvent(a){try{if(window.addEventListener){a=parseInt(a);var b=g_objEditorDocument[a],c=function(a){(a=a||window.event)&&a.preventDefault()};document.addEventListener("dragenter",c,!1);document.addEventListener("dragover",c,!1);document.addEventListener("drop",c,!1);document.addEventListener("dragleave",c,!1);document.addEventListener("dragstart",c,!1);b.addEventListener("dragenter",function(b){b=b||window.event;editor_ondragenter(b,a)},!1);b.addEventListener("dragover",
function(b){b=b||window.event;editor_ondragover(b,a)},!1);b.addEventListener("drop",function(b){b=b||window.event;editor_ondrop(b,a)},!1);b.addEventListener("dragleave",function(b){b=b||window.event;editor_ondragleave(b,a)},!1);b.addEventListener("dragstart",function(b){b=b||window.event;editor_ondragstart(b,a)},!1);b.addEventListener("dragend",function(b){b=b||window.event;editor_ondragend(b,a)},!1)}}catch(d){dalert(d)}}
function editor_ondragenter(a,b){try{dlog("editor_ondragenter nEditNumber : "+b),g_nActiveEditNumber=b,g_bBrowserType_IE||dzeUiConfig.bOfficePagingMode||g_objEditorDocument[b].body.focus()}catch(c){dalert(c)}}
function editor_ondragover(a,b){try{if(dzeUiConfig.bOfficePagingMode||g_objEditorDocument[b].body.focus(),g_bBrowserType_IE&&("Files"==a.dataTransfer.types[0]&&TBCancelBubbleEvent(a),!0===dzeUiConfig.bUseLockEditCellFunction)){var c=g_objNodeUtil.getLoopParentElement(a.target,"td");c&&c.contentEditable&&"false"==c.contentEditable.toLowerCase()&&TBCancelBubbleEvent(a)}}catch(d){dalert(d)}}
function editor_ondrop(a,b){try{dlog("editor_ondrop Call nEditNumber : "+b);if(g_readonlyMode)return TBCancelBubbleEvent(a);if(!g_objDrag.bDragging){var c=g_objCaretUtil.getRangeFromPoint(a.clientX,a.clientY);c&&SetCurRange(c.getRange())}var d=a.dataTransfer;if(objOnefficeLoader.m_bHybrid&&-1!=d.getData("text/uri-list").indexOf("intent:#Intent;action"))TBCancelBubbleEvent(a);else if("undefined"!=typeof d.files&&null!=d.files&&d.files.length)TBCancelBubbleEvent(a),DZE_UPLOAD_EVENT.dragNdropInsertImage(a.dataTransfer.files,
b);else{if(g_bBrowserType_IE&&!0===dzeUiConfig.bUseLockEditCellFunction){var e=g_objNodeUtil.getLoopParentElement(a.target,"td");if(e&&e.contentEditable&&"false"==e.contentEditable.toLowerCase()){TBCancelBubbleEvent(a);return}}if(dzeUiConfig.bOfficePagingMode){c="";try{c=d.getData("text/dze_dragdrop"),"multipage"===c&&SelectionUtil.deleteSelection(b)}catch(f){(c=d.getData("text"))&&startsWith(c,"{text/dze_dragdrop:multipage}")&&(g_objDrag.strDragData=c.substring(29,c.length),a.preventDefault())}g_objPageControl.onSetDelayedUpdatePageTimer();
setTimeout(function(){try{if(!0===dzeUiConfig.bUsePasteRangeImageAutoUpload){var a=g_objEditWindow[b],c=a?a.getSelection():null,d=c?c.getRangeAt(0):null;if(d){var e=d.commonAncestorContainer;d=null;null!=e&&uploadCurrentDocumentImageFromElement(e,function(a){0<a.length&&g_objAdjustDoc.fitImageSizeToDoc(dzeJ(a),function(){if(!0===dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()})},function(a){!1===fnObjectCheckNull(a)&&"prevent"===a.error&&cmnMsg.showMsg(MESSAGE_ALERT,"\uc11c\ubc84\uc5d0 \ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \uc774\ubbf8\uc9c0\ub294 \uc0bd\uc785\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",
null,["\ud655\uc778"],function(){a.img.parentNode.removeChild(a.img);cmnMsg.hideMsg()})})}}}catch(m){dalert("error:image auto upload fail")}window.setTimeout(function(){g_objEditMode.removeChild(b,"a","className","dze_bookmark_flag",function(a){a.style.backgroundImage=""})},100);g_objUndoRedo.registerUndoRedoStack(0,b);g_objPageControl.onSetDelayedUpdatePageTimer()},100)}else g_objUndoRedo.registerUndoRedoStack(0,b),g_objPageControl.onSetDelayedUpdatePageTimer()}}catch(f){dalert(f)}}
function editor_ondragleave(a,b){dlog("editor_ondragleave nEditNumber: "+b)}
function editor_ondragstart(a,b){try{if(g_objPropertyUtil.hasClass(g_objEditorDocument[b].body,"unselectable"))return TBCancelBubbleEvent(a),!1;EventUtil.normalize(a,b);g_objDrag.dragEnterStartPageNum=a.pageNum;g_objDrag.bDragging=!0;if(g_objPageControl.dragStartMultiPage(b,a)){var c=GetCurRange(b);g_objDrag.dragStartRange=new RangeProp(c);var d=g_objCaretUtil.getPageNum(a.nEditNumber);g_objPageEditable.setPageEditable(!0,d.start,d.end);SetCurRange(c)}}catch(e){dalert(e)}}
function editor_ondragend(a,b){try{var c=g_objDrag.bDragging,d=g_objDrag.dragStartRange,e=g_objDrag.strDragData;g_objDrag.bDragging=!1;g_objDrag.dragStartRange=null;g_objDrag.strDragData=null;if(c&&e&&d&&!g_readonlyMode){var f=GetCurRangeProp(b);SetCurRange(d.getRange());SelectionUtil.deleteSelection(b);SetCurRange(f.getRange());var g=g_objEditorDocument[b].createRange(),h=g.createContextualFragment(e);g=null;var k=h.firstChild,m=h.lastChild;insertHTMLCodeAtSelection(null,h,b);setTimeout(function(){var a=
g_objEditorDocument[b].createRange();a.setStartBefore(k);a.setEndAfter(m);SetCurRange(a)},0);a.preventDefault()}g_objPageEditable.restorePageEditable()}catch(n){dalert(n)}}function setDragNDropBg(a,b){try{1==b?(g_objEditorDocument[a].body.style.opacity="0.3",document.getElementById("dzeditor_Parent_"+a).className="editor_drag_frame"):(g_objEditorDocument[a].body.style.opacity="",document.getElementById("dzeditor_Parent_"+a).className="editor_frame")}catch(c){dalert(c)}}
function addParentScrollEvent(){try{var a=null,b;for(b in g_objEditorDocument)b>=DZE_IFRAME_TMP_NO||(a=dzeEnvConfig.iFrameLayer?window.frameElement:document.getElementById("INIT_LOAD_AREA_"+b),addEventParentScrollElement(a,b))}catch(c){dalert(c)}}
function addEventParentScrollElement(a,b){try{if(a){var c=a;for(a=0;!(1E3<a)&&c.parentNode;){c=c.parentNode;if("body"==c.nodeName.toLowerCase())break;if(g_bBrowserType_IE)var d=c.currentStyle.getAttribute("overflow");else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)d=g_objEditWindow[b].getComputedStyle(c,null).getPropertyValue("overflow");"auto"!=d.toLowerCase()&&"scroll"!=d.toLowerCase()||function(){var a=c;window.attachEvent?a.attachEvent("onscroll",function(){g_objMenuWin.closeMenuLayer()}):
a.addEventListener("scroll",function(){g_objMenuWin.closeMenuLayer()},!1)}();a++}return null}}catch(e){dalert(e)}}var MobileEventUtil={listenHybridEvent:function(){},sendHybridMessage:function(a,b){try{1!=fnObjectCheckNull(a)&&(a={uiEvent:a,uiEventData:b},$("#one_viewer").scope().resiveEventMessage(a))}catch(c){dalert(c)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,e){a!=Array.prototype&&a!=Object.prototype&&(a[b]=e.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(e){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(e||"")+"_"+b++,e)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var e=0,d={next:function(){if(e<a.length){var c=e++;return{value:b(c,a[c]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,e,d){if(b){e=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var c=a[d];c in e||(e[c]={});e=e[c]}a=a[a.length-1];d=e[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_nLetterOperationType=-1,ID_LETTER_OPERATION_FONT_FAMILY=0,ID_LETTER_OPERATION_FONT_SIZE=1,ID_LETTER_OPERATION_FORE_COLOR=2,ID_LETTER_OPERATION_BACK_COLOR=3,ID_LETTER_OPERATION_LETTER_SPACING=4,ID_LETTER_OPERATION_LINE_HEIGHT=5,ID_LETTER_OPERATION_HEADING_SIZE=6,g_objLetterFn=new function(){this.doLoopRemove_LetterOperation=function(a,b){try{if(!a)return!1;var e=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,null,!1),d=e.firstChild();a=null;for(var c=!1;d;)a=e.nextNode(),c=this.removeSpanStyle(d,
b)||c,d=a;return c}catch(f){dalert(f)}};this.removeSpanStyle=function(a,b){try{return a&&a.nodeName.toLowerCase()===DZE_TAG_SPAN?this.removeNodeStyle(a,b):!1}catch(e){dalert(e)}};this.removeNodeStyle=function(a,b){try{if(!a)return!1;var e="";if(b==ID_LETTER_OPERATION_FONT_FAMILY)e=a.style.fontFamily,a.style.fontFamily="",g_bBrowserType_IE?a.style.removeAttribute("fontFamily"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontFamily");else if(b==ID_LETTER_OPERATION_FONT_SIZE)e=
a.style.fontSize,a.style.fontSize="",g_bBrowserType_IE?a.style.removeAttribute("fontSize"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("fontSize");else if(b==ID_LETTER_OPERATION_FORE_COLOR)e=a.style.color,a.style.color="",g_bBrowserType_IE?a.style.removeAttribute("color"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("color");else if(b==ID_LETTER_OPERATION_BACK_COLOR)e=a.style.backgroundColor,a.style.backgroundColor="",g_bBrowserType_IE?
a.style.removeAttribute("backgroundColor"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("backgroundColor");else if(b==ID_LETTER_OPERATION_LETTER_SPACING)e=a.style.letterSpacing,a.style.letterSpacing="",g_bBrowserType_IE?a.style.removeAttribute("letterSpacing"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("letterSpacing");else if(b==ID_LETTER_OPERATION_LINE_HEIGHT){for(b=g_objPropertyUtil;a.tagName&&"p"!=a.tagName.toLowerCase();){if(fnObjectCheckNull(a.parentNode)||
b.hasClass(a,["dze_page_main","dze_page_header_container","dze_page_footer_container"]))return!1;a=a.parentNode}e=a.style.lineHeight;a.style.lineHeight="";g_bBrowserType_IE?a.style.removeAttribute("lineHeight"):(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&a.style.removeProperty("lineHeight")}return""!==e?!0:!1}catch(d){dalert(d)}};this.removeEmptyChildTextNode=function(a){try{if("span"==a.nodeName.toLowerCase())for(var b=0;b<a.childNodes.length;b++){var e=a.childNodes[b];ID_SELECTION_TEXT_NODE==
e.nodeType&&""==e.nodeValue&&(a.removeChild(e),b=-1)}}catch(d){dalert(d)}};this.getHeadingFontSize=function(a){var b="";a=a.toUpperCase();switch(a){case "H1":b="21pt";break;case "H2":b="18pt";break;case "H3":b="15pt";break;case "H4":b="12pt";break;case "H5":b="10pt"}return b};this.setParaStyle=function(a,b){try{var e=b.arrPara||this.getSelectedParagraph(a);if(!e||0>e.length)return!1;for(var d=!1,c=!1,f=null,k=0,l=e.length;k<l;k++){f=e[k];"textAlign"in b&&(c=this.setAlign(f,b.textAlign)||c);if("marginLeft"in
b||"marginRight"in b||"marginTop"in b||"marginBottom"in b)c=this.setMargin(f,b)||c;"outdent"in b&&(c=this.setOutdentIndent(f,!0)||c);"indent"in b&&(c=this.setOutdentIndent(f,!1)||c);"textIndent"in b&&(c="secondLine"in b?this.setTextIndent(f,b.textIndent,b.secondLine)||c:this.setTextIndent(f,b.textIndent)||c);"lineHeight"in b&&(c=this.setLineHeight(f,b.lineHeight)||c);"default"in b&&(c=this.setDefault(f)||c);if("addClassName"in b||"removeClassName"in b)c=this.setClass(f,b)||c;"head"in b&&(c=this.setNodeHeadingValue(f,
b.head,a)||c);!0===c&&(d=!0)}return d}catch(y){dalert(y)}};this.setNodeHeadingValue=function(a,b,e){try{if(!a)return!1;var d=!1;switch(a.nodeName){case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":case "P":case "PRE":case "LI":case "DT":case "DD":d=!0}if(!d)return!1;var c=d=!1;b||(c=!0);var f=a.nodeName.toLowerCase(),k=b.toLowerCase();b=g_objCaretUtil;var l="dze_replace_head_"+g_objCommonUtil.getUniqueID();c?"p"!==f&&(b.saveCaret(e,l),this.replaceHeadingBlockNode(k,a),d=!0):k!==f&&(b.saveCaret(e,
l),this.doLoopRemove_LetterOperation(a,ID_LETTER_OPERATION_FONT_SIZE),this.replaceHeadingBlockNode(k,a),d=!0);!0===d&&b.restoreCaret(e,l);return d}catch(y){dalert(y)}};this.replaceHeadingBlockNode=function(a,b){try{if(b){var e=a;e||(e="p");if(g_objNodeUtil.isListItem(b))b.style.fontSize=this.getHeadingFontSize(a),b.style.fontWeight="p"===e?"":"bold";else{var d=b.ownerDocument.createElement(e);g_objNodeUtil.copyAttribute(d,b);g_objNodeUtil.moveNodesTo(d,b.firstChild);b.parentNode.replaceChild(d,b)}}}catch(c){dalert(c)}};
this.isParagraph=function(a){return 0<=g_objNodeUtil.arrParaNodeName.indexOf(a.nodeName)||g_objPropertyUtil.hasClass(a,"dze_shape_text_contents")&&g_objPropertyUtil.hasClass(a,"paragraph")?!0:!1};this.getSelectedParagraph=function(a){try{var b=[];this.traverseSelectedParagraph(a,function(a){b.push(a)});return b}catch(e){dalert(e)}};this.getChildParagraph=function(a){try{for(var b=[],e=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,function(a){return!0===g_objLetterFn.isParagraph(a)?NodeFilter.FILTER_ACCEPT:
NodeFilter.FILTER_SKIP},!0),d=e.firstChild();d;)b.push(d),d=e.nextNode();return b}catch(c){dalert(c)}};this.traverseSelectedParagraph=function(a,b){function e(a){return a&&1===a.nodeType?!g_objHeaderFooter.getHeaderFooterEditMode()&&g_objHeaderFooter.isHeaderFooterContainer(a)||!(0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer())&&g_objPropertyUtil.hasClass(a,"dze_shape_main")?NodeFilter.FILTER_REJECT:g_objLetterFn.isParagraph(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:
NodeFilter.FILTER_SKIP}function d(a){for(var b=g_objNodeUtil;a&&!b.isBoundNode(a);){if(g_objLetterFn.isParagraph(a))return a;a=a.parentNode}return null}function c(a){if(a&&b){a=g_objSplitUtil.getPrevSplitNodes(a);for(var c=0,e=a.length;c<e;c++)b(a[c])}}function f(a){if(a&&b){a=g_objSplitUtil.getNextSplitNodes(a);for(var c=0,e=a.length;c<e;c++)b(a[c])}}if(!b)return!1;a=function(a){var b=[];if(GetMultiCellSelection(a))g_objTableSelection.doAllSelectedCell(function(a){var g=a.ownerDocument.createRange();
g.setStart(a,0);g.setEnd(a,a.childNodes.length);b.push(g)});else if(1<g_objSelectedShapesArray.length){a=0;for(var c=g_objSelectedShapesArray.length;a<c;a++){var e=g_objSelectedShapesArray[a].childNodes[1].firstChild;if(e){var d=e.ownerDocument.createRange();d.setStart(e,0);d.setEnd(e,e.childNodes.length);b.push(d)}}}else(a=GetCurRange(a))&&b.push(a);return b}(a);for(var k=null,l=null,y=l=null,G=0,B=a.length;G<B;G++)if(range=a[G],k=g_objNodeUtil.createRangeWalker(range,NodeFilter.SHOW_ELEMENT,e))if(l=
k.firstChild()){for(c(l);l;)y=l,b(l),l=k.nextNode();f(y)}else if(l=d(range.commonAncestorContainer))c(l),b(l),f(l);return!0};this.getSelectedParaStyle=function(a,b,e){function d(a,b){var c=a.style[b];c||(k||(k=a.ownerDocument.defaultView.getComputedStyle(a,null)),c=k[b]);"lineHeight"===b?c=g_objPropertyUtil.getUnitlessLineHeight(c,d(a,"fontSize")):"textAlign"===b&&(c=c.replace("-webkit-",""),c="start"===c?"left":"end"===c?"right":c);return c?c:""}function c(a,b,c){var e=a,l=b;("listMarginTop"===b||
"listMarginBottom"===b)&&g_objNodeUtil.isListItem(a)&&g_objNodeUtil.isList(a.parentNode)&&(e=a.parentNode,l="listMarginTop"===b?"marginTop":"marginBottom");a!==e&&(k=null);b in c&&!1===c.objMultiple[b]&&(""===c[b]?c[b]=d(e,l):c[b]!==d(e,l)&&(c[b]="",c.objMultiple[b]=!0))}function f(a){a||(a={textAlign:"",marginTop:"",marginLeft:"",marginRight:"",marginBottom:"",textIndent:"",lineHeight:""});a.objMultiple=cloneSimpleObject(a);Object.keys(a.objMultiple).forEach(function(b){a.objMultiple[b]=!1});return a}
var k=null;try{b=f(b);try{this.traverseSelectedParagraph(a,function(a){k=null;c(a,"textAlign",b);c(a,"marginLeft",b);c(a,"marginRight",b);c(a,"marginTop",b);c(a,"marginBottom",b);c(a,"textIndent",b);c(a,"lineHeight",b);if(!0===e)throw BreakException;a:{a=b.objMultiple;for(d in a)if(!0!==a[d]){var d=!1;break a}d=!0}if(!0===d)throw BreakException;})}catch(l){}return b}catch(l){dalert(l)}};this.setAlign=function(a,b){try{if(!a)return!1;b=b||"";return a.style.textAlign!==b?(a.style.textAlign=b,g_objNodeUtil.isListItem(a)&&
(a.style.listStylePosition="center"===b||"right"===b?"inside":""),a.hasAttribute("align")&&a.removeAttribute("align"),""===b&&""===a.style.cssText&&a.removeAttribute("style"),!0):!1}catch(e){dalert(e)}};this.setOutdentIndent=function(a,b){try{var e=g_nOutdentIndentWidth,d=g_objPropertyUtil.getElementStyleAttributeValue(a,"margin-left"),c=g_objCommonUtil.toPx(d);d=null;!1===b&&(d=parseInt(c+a.offsetWidth-g_objCommonUtil.toPx("2.5mm"),0));if(b){c=parseInt(c)-parseInt(e);var f=c%e;0!=f&&(c=parseInt(c)-
parseInt(f))}else c=parseInt(c)+parseInt(e),f=c%e,0!=f&&(c=parseInt(c)+parseInt(f));0>c&&(c=0);null!==d&&c>d&&(c=d);var k=g_objCommonUtil.toPx(a.style.marginLeft);!0===isNaN(k)&&(k=0);if(k===c)return!1;g_objPositionUtil.arrangeObjectPosition(a,c-k);a.style.marginLeft=c+"px";return!0}catch(l){dalert(l)}};this.setMargin=function(a,b){function e(a,b,c){var e=a.style[b];""!==e&&(e=g_objCommonUtil.toPx(e));""!==c&&(c=g_objCommonUtil.toPx(c));return e!==c?(c=""!==c?c+"px":"",a.style[b]=c,""===c&&""===a.style.cssText&&
a.removeAttribute("style"),!0):!1}try{var d=!1;if("marginLeft"in b){var c=g_objCommonUtil.toPx(b.marginLeft),f=g_objCommonUtil.toPx(a.style.marginLeft)-c;e(a,"marginLeft",b.marginLeft)&&(g_objPositionUtil.arrangeObjectPosition(a,f),d=!0)}"marginTop"in b&&e(a,"marginTop",b.marginTop)&&(a.style.paddingTop="",d=!0);"marginRight"in b&&e(a,"marginRight",b.marginRight)&&(d=!0);"marginBottom"in b&&e(a,"marginBottom",b.marginBottom)&&(a.style.paddingBottom="",d=!0);return d}catch(k){dalert(k)}};this.setTextIndent=
function(a,b,e){try{var d=a.style.textIndent;""!==d&&(d=g_objCommonUtil.toPx(d));""===b||g_objNodeUtil.isListItem(a)||(b=g_objCommonUtil.toPx(b));if(d!==b){b=""!==b?b:"";a.style.textIndent=b+"px";if(g_objNodeUtil.isListItem(a))if(0===b)a.style.listStylePosition="";else{a.style.listStylePosition="inside";if(0!==b&&e)return!0;if(!a.parentNode)return!1;if(a.parentNode&&a.parentNode.className)a.style.textIndent=b+"px";else{var c=dzeJ(a).index();a.style.textIndent="OL"===a.parentNode.nodeName&&c&&8<c?
b-27+"px":b-18+"px"}}""===b&&""===a.style.cssText&&a.removeAttribute("style");return!0}return!1}catch(f){dalert(f)}};this.setLineHeight=function(a,b){try{return a.style.lineHeight!==b?(a.style.lineHeight=b,!0):!1}catch(e){dalert(e)}};this.setDefault=function(a){try{if(!a||1!==a.nodeType)return!1;if("P"===a.nodeName||g_objNodeUtil.isHead(a))if(a.hasAttribute("style")||a.hasAttribute("class"))return a.removeAttribute("style"),a.removeAttribute("class"),!0;return!1}catch(b){dalert(b)}};this.setClass=
function(a,b){try{var e=!1;if(("P"===a.nodeName||g_objNodeUtil.isHead(a))&&b){var d=g_objPropertyUtil,c=b.removeClassName;c&&(c=Array.isArray(c)?c:[c],forEach(c,function(b,c){d.hasClass(a,c)&&(d.removeClass(a,c),e|=1)},this));var f=b.addClassName;f&&(f=Array.isArray(f)?f:[f],forEach(f,function(b,c){d.hasClass(a,c)||(d.addClass(a,c),e|=1)},this));return e}return!1}catch(k){dalert(k)}};this.isEmptySpan=function(a){try{if(!a)return!1;if(1===a.nodeType&&("SPAN"===a.nodeName||"FONT"===a.nodeName)&&1===
a.childNodes.length){var b=a.childNodes[0];if(3===b.nodeType&&!b.nodeValue.replace(/\u200B/g,""))return!0}else if(3===a.nodeType&&!0===!a.nodeValue.replace(/\u200B/g,""))return!0;return!1}catch(e){dalert(e)}}};function TextAtt(){}TextAtt.attName="font-family font-size font-style font-weight color background-color letter-spacing text-decoration-line".split(" ");
TextAtt.getPath=function(a,b){try{var e=[],d=g_objNodeUtil;if(!0===b)for(;a&&!d.isBlockNode(a)&&!d.isCell(a);)e.push(a),a=a.parentNode;else{for(;a;)e.push(a),a=a.firstChild;e.reverse()}return e}catch(c){dalert(c)}};
TextAtt.getAtt=function(a){try{var b=new TextAtt;if(!a)return b;var e=!0;3!==a.nodeType&&"BR"!==a.nodeName&&(e=!1);var d=TextAtt.getPath(a,e);e=0;for(var c=d.length;e<c;e++){a=d[e];var f=a.style;if(f){TextAtt.attName.forEach(function(a){a=camelCase(a);b[a]||f[a]&&(b[a]=f[a])});var k=a.tagName;k=k?k.toLowerCase():"";switch(k){case "b":case "strong":case "u":case "i":case "em":case "strike":case "s":case "sup":case "sub":b[k]=!0}}}return b}catch(l){dalert(l)}};
TextAtt.setAtt=function(a,b){try{if(!a||!b||3!==a.nodeType&&"BR"!==a.nodeName)return!1;var e=Object.keys(b);if(0>=e.length)return!1;var d=function(a,b){b=a.ownerDocument.createElement(b);a.parentNode.replaceChild(b,a);b.appendChild(a);return b};e.forEach(function(c){switch(c){case "b":case "strong":case "u":case "i":case "em":case "strike":case "s":case "sup":case "sub":a=d(a,c);return}"SPAN"!==a.nodeName&&(a=d(a,"span"));c=camelCase(c);b[c]&&(a.style[c]=b[c])});return!0}catch(c){dalert(c)}};
function ParaAtt(){}ParaAtt.attName="text-align margin-left margin-right padding-top padding-bottom text-indent line-height color font-family font-size".split(" ");ParaAtt.getPath=function(a,b){try{var e=[],d=g_objNodeUtil;if(!0===b)for(;a&&!d.isCell(a);){if(d.isBlockNode(a)){e.push(a);break}a=a.parentNode}else for(;a;){if(d.isBlockNode(a)){e.push(a);break}a=a.firstChild}return e}catch(c){dalert(c)}};
ParaAtt.getAtt=function(a){try{var b=new ParaAtt;if(!a)return b;var e=!0;3!==a.nodeType&&"BR"!==a.nodeName&&(e=!1);var d=(a=ParaAtt.getPath(a,e)[0])?a.style:null;if(!d)return b;ParaAtt.attName.forEach(function(a){a=camelCase(a);b[a]||d[a]&&(b[a]=d[a])});return b}catch(c){dalert(c)}};ParaAtt.setAtt=function(a,b){try{if(!a||!b||0>=Object.keys(b).length)return!1;ParaAtt.attName.forEach(function(e){e=camelCase(e);b[e]&&(a.style[e]=b[e])});return!0}catch(e){dalert(e)}};
var letterFunction=new function(){var a;function b(){return{hasSavedStyle:function(){return!1===fnObjectCheckNull(p)},getSavedStyle:function(){return p},getSavedCommand:function(){return m},initStyleSpan:function(){m=0;p=null;dzeJ(g_objEditorDocument[0].querySelectorAll(".style_span")).removeAttr("class")},removeStyleSpan:function(){try{p.parentNode&&p.parentNode.removeChild(p),this.initStyleSpan()}catch(g){dalert(g)}},hasCopyedStyle:function(){try{return fnObjectCheckNull(a)||0===Object.keys(a).length?
!1:!0}catch(g){dalert(g)}},removeCopyedStyle:function(){try{a=null}catch(g){dalert(g)}},insertStyleSpan:function(){try{var a=g_objCaretUtil.saveCaret(1*g_objPageControl.nEditNumber,"dze_caret_position_for_letterfn");if(!1===fnObjectCheckNull(a)){var b=a.end.parentNode;(!1===fnObjectCheckNull(a.end.previousSibling)&&3===a.end.previousSibling.nodeType||!1===fnObjectCheckNull(a.end.nextSibling)&&3===a.end.nextSibling.nodeType)&&!0===g_objNodeUtil.fixWrongTextFormat(a.end)&&(b=a.end.parentNode);d(b,a.end);
"SPAN"===b.nodeName&&2===b.childNodes.length&&("BR"===b.lastChild.nodeName||3===b.lastChild.nodeType&&0===removeZeroWidthSpaceFromString(b.lastChild.nodeValue).length)?(a.end.parentNode.parentNode.insertBefore(p,a.end.parentNode),a.end.parentNode.parentNode.removeChild(a.end.parentNode)):a.end.parentNode.insertBefore(p,a.end);!1===fnObjectCheckNull(a)&&(!1===fnObjectCheckNull(a.start)&&!1===fnObjectCheckNull(a.start.parentNode)&&a.start.parentNode.removeChild(a.start),!1===fnObjectCheckNull(a.end)&&
!1===fnObjectCheckNull(a.end.parentNode)&&a.end.parentNode.removeChild(a.end));g_objCaretUtil.moveCaret(p,!1,!1)}}catch(q){dalert()}finally{}},setSentenceStyle:function(a,b,c){try{c="undefined"===typeof c?!1:c;var g=1*g_objPageControl.nEditNumber,q=g_objNodeUtil,z=g_objEditorDocument[g],d=z.getSelection().getRangeAt(0),h=!1;if(GetMultiCellSelection(g)){var l=g_objCaretUtil.saveCaret(),w=[],x=[];g_objTableSelection.doAllSelectedCell(function(a){q.normalize(a);pushArray(w,q.getTextNodesIn(a,q.treeWalkerFilter_TextNodeInRange,
!0));pushArray(x,a.querySelectorAll("li"))});var A=y(w,a,b,c);pushArray(w,x);var u=null,t=null,r=null;c=null;for(var n=0,I=w.length;n<I;n++)if(u=w[n],t=u.parentNode){if(q.isListItem(u)){t=u;if(A&&(a==DZE_LETTER_COMMAND_STRIKE||a===DZE_LETTER_COMMAND_UNDERLINE||a===DZE_LETTER_COMMAND_LETTER_SPACE))continue;if(""!==b&&a===DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR)continue}else if("SPAN"!==t.nodeName)r=this.createSpan(t),t.insertBefore(r,u),r.appendChild(u),t=r;else if("SPAN"===t.nodeName&&1<t.childNodes.length){r=
t.cloneNode(!1);l&&u.previousSibling&&(u.previousSibling===l.start||u.previousSibling===l.end)&&(c=u.previousSibling);t.replaceChild(r,u);c&&(r.appendChild(c),c=null);r.appendChild(u);q.splitOn(t.parentNode,r);var C=r.previousSibling;C&&"SPAN"===C.nodeName&&(!C.firstChild||3===C.firstChild.nodeType&&""===C.firstChild.nodeValue)&&C.parentNode.removeChild(C);var D=r.nextSibling;D&&"SPAN"===D.nodeName&&(!D.firstChild||3===D.firstChild.nodeType&&""===D.firstChild.nodeValue)&&D.parentNode.removeChild(D);
t=r}k(a,b,t,!0,A)&&(h=!0)}if(h){g_objCaretUtil.restoreCaret();var J=GetCurCell(g);J&&SelectionUtil.isOnFirst(J,d.startContainer,d.startOffset)&&g_objCaretUtil.moveCaret(J)}return h}if(!0===d.collapsed&&!1===c)return!0===fnObjectCheckNull(p)&&(f(),this.insertStyleSpan()),k(a,b,p,!1,G(a,b))?(m|=a,a===DZE_LETTER_COMMAND_SUPERSCRIPT&&(m&DZE_LETTER_COMMAND_SUBSCRIPT)===DZE_LETTER_COMMAND_SUBSCRIPT?m^=DZE_LETTER_COMMAND_SUBSCRIPT:a===DZE_LETTER_COMMAND_SUBSCRIPT&&(m&DZE_LETTER_COMMAND_SUPERSCRIPT)===DZE_LETTER_COMMAND_SUPERSCRIPT&&
(m^=DZE_LETTER_COMMAND_SUPERSCRIPT)):m^=a,h;if(!0===c)for(n=0;n<g_objSelectedShapesArray.length;n++){var F=z.getElementById(g_objSelectedShapesArray[n].id).lastChild.firstChild;var B=[].slice.call(F.querySelectorAll(".dze_shape_text_contents.sentence"));0<B.length&&(A=y(B,a,b,c),B.forEach(function(c){k(a,b,c,!0,A)}))}else{x=null;if(a===DZE_LETTER_COMMAND_BOLD||a===DZE_LETTER_COMMAND_ITALIC||a===DZE_LETTER_COMMAND_FONT_SIZE||a===DZE_LETTER_COMMAND_FONT_FAMILY||a===DZE_LETTER_COMMAND_FONT_COLOR)x=g_objListUtil.getCurListItemsInRange(g,
{bExceptSomeSelect:!0});var K=d.commonAncestorContainer;K.normalize();l=g_objCaretUtil.saveCaret();w=g_objNodeUtil.getTextNodeInRange(K,l);if(!1===fnObjectCheckNull(l)&&0<w.length){d=e(l);A=y(w,a,b,c);for(n=0;n<w.length;n++){u=w[n];t=u.parentNode;if("SPAN"!==t.nodeName||"SPAN"===t.nodeName&&1<t.childNodes.length)r=this.createSpan(t),t.insertBefore(r,u),r.appendChild(u),t=r;k(a,b,t,!0,A);h=!0}if(x)for(n=0;n<x.length;n++)k(a,b,x[n],!0,A)}return h}}catch(O){dalert(O)}finally{g_objCaretUtil.restoreCaret(),
d=null}},createSpan:function(a){try{var b=g_objEditorDocument[g_nActiveEditNumber].createElement("SPAN");if(dzeUiConfig.bSupportNewsEditor)return b;for(;a&&1!==a.nodeType;)a=a.parentNode;if(!a)return b;var c=g_objNodeUtil;c.setInlineTextStyle(b,c.getInlineTextStyle(a));return b}catch(E){dalert(E)}},removeSentenceStyle:function(a){try{var b=p;try{b=dzeJ(b);bAllStyle="undefined"===typeof bAllStyle?!1:bAllStyle;var c="";switch(a){case DZE_LETTER_COMMAND_BOLD:c="font-weight";break;case DZE_LETTER_COMMAND_ITALIC:c=
"font-style";break;case DZE_LETTER_COMMAND_STRIKE:case DZE_LETTER_COMMAND_UNDERLINE:c=!0===g_bBrowserType_IE?"text-decoration":"text-decoration-line";break;case DZE_LETTER_COMMAND_SUPERSCRIPT:c="font-size";break;case DZE_LETTER_COMMAND_SUBSCRIPT:c="font-size";break;case DZE_LETTER_COMMAND_FONT_FAMILY:c="font-family";break;case DZE_LETTER_COMMAND_FONT_SIZE:c="font-size";break;case DZE_LETTER_COMMAND_FONT_COLOR:c="color";break;case DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR:c="background-color";break;
case DZE_LETTER_COMMAND_LETTER_SPACE:c="letter-spacing"}0<c.length&&b.css(c,"")}catch(E){dalert(E)}}catch(E){dalert(E)}},copyTextStyle:function(){try{var b=g_objEditorDocument[1*g_objPageControl.nEditNumber].getSelection().getRangeAt(0),c=b.commonAncestorContainer,e=null,d=null;if(b.collapsed)d=g_objNodeUtil.getLoopParentInlineNode(c),e=g_objNodeUtil.getLoopParentBlockNode(null!==d?d:c);else{c.normalize();var v=g_objCaretUtil.saveCaret(),f=g_objNodeUtil.getTextNodeInRange(c,v);!1===fnObjectCheckNull(v)&&
0<f.length&&(d=g_objNodeUtil.getLoopParentInlineNode(f[0]),e=g_objNodeUtil.getLoopParentBlockNode(null!==d?d:f[0]))}a={};if(null!==e){var k={type:e.nodeName};if("LI"===k.type){var h=e.parentNode;for(k.listStyle=[];("OL"===h.nodeName||"UL"===h.nodeName)&&(k.listStyle.push(B(h)),h=h.parentNode,!g_objNodeUtil.isLoopBreakNode(h)););}k.textAlign=e.style.textAlign;k.lineHeight=e.style.lineHeight;a.block=k}a.inline=g_objNodeUtil.getInlineTextStyle(null!==d?d:e)}catch(N){dalert(N)}finally{g_objCaretUtil.restoreCaret(),
this.changePasteStyleMode(0<Object.keys(a).length?!0:!1)}},pasteTextStyle:function(b){try{var c=!1;if(b&&!fnObjectCheckNull(a)&&0!==Object.keys(a).length){var d=g_objEditorDocument[1*g_objPageControl.nEditNumber],g=d.getSelection().getRangeAt(0),v=g.commonAncestorContainer,f=g.collapsed;if(f){var k=g_objNodeUtil.getLoopParentBlockNode(v);g_objCaretUtil.saveCaret(void 0,"caret_restore_point");var h=d.getSelection();g=d.createRange();h.removeAllRanges();g.setStartBefore(k.firstChild);g.setEndAfter(k.lastChild);
h.addRange(g);v=g.commonAncestorContainer}v.normalize();var l=g_objCaretUtil.saveCaret(),w=g_objNodeUtil.getTextNodeInRange(v,l);if(!1===fnObjectCheckNull(l)&&0<w.length)for(g=e(l),b=0;b<w.length;b++){var p=w[b];var m=p.parentNode;if("SPAN"!==m.nodeName){var u=d.createElement("span");m.insertBefore(u,p);u.appendChild(p);m=u}m=dzeJ(m);m.removeAttr("style");m.css({"font-size":a.inline.size,"font-family":a.inline.family,color:a.inline.color,"background-color":a.inline.bgColor,"font-weight":a.inline.bold,
"font-style":a.inline.italic,"text-decoration":a.inline.textDeco,"vertical-align":"string"===typeof a.inline.subscript?a.inline.subscript:a.inline.subscript.type,"letter-spacing":a.inline.letterSpace});"object"===typeof a.inline.subscript&&m.attr("origin_font_size",a.inline.subscript.originSize);c=!0}var t=L(g,l);if(0<t.length){var r=a.block,n;t.forEach(function(b){"LI"===b.nodeName&&M(b);if("LI"===r.type||b.nodeName!==r.type){n=d.createElement(r.type.toLowerCase());n.style.textAlign=r.textAlign;
n.style.lineHeight=r.lineHeight;for("LI"===r.type&&dzeJ(n).css({"font-size":a.inline.size,"font-family":a.inline.family,color:a.inline.color,"font-weight":a.inline.bold,"font-style":a.inline.italic});b.hasChildNodes();)n.appendChild(b.firstChild);g_objPropertyUtil.hasClass(b,"dze_shape_anchor")&&g_objPropertyUtil.addClass(n,"dze_shape_anchor");b.parentNode.insertBefore(n,b);b.parentNode.removeChild(b);if("LI"===r.type){var c;r.listStyle.forEach(function(a){c=d.createElement(a.listType.toLowerCase());
fnObjectCheckNull(a.class)?fnObjectCheckNull(a.styleType)||(c.style.listStyleType=a.styleType):c.className=a.class;n.parentNode.insertBefore(c,n);c.appendChild(n);n=c});b=n.previousSibling;var e=n.nextSibling;fnObjectCheckNull(b)||b.nodeName!==n.nodeName||g_objListUtil.arrangeList(b,n)&&(n=b);fnObjectCheckNull(e)||n.nodeName!==e.nodeName||g_objListUtil.arrangeList(n,e)}}else b.style.textAlign!==r.textAlign&&(b.style.textAlign=r.textAlign),b.style.lineHeight!==r.lineHeight&&(b.style.lineHeight=r.lineHeight)});
c=!0}}}catch(I){dalert(I)}finally{if(g=a=null,g_objCaretUtil.restoreCaret(),f&&g_objCaretUtil.restoreCaret(void 0,"caret_restore_point"),this.changePasteStyleMode(!1),c&&(g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber),dzeUiConfig.bOfficePagingMode))g_objPageControl.onSetDelayedUpdatePageTimer()}},changePasteStyleMode:function(a){try{var b=g_objEditorDocument[g_objPageControl.nEditNumber].querySelector(".dze_document_container");fnObjectCheckNull(b)||(a?g_objPropertyUtil.addClass(b,
"paste_style_mode"):g_objPropertyUtil.removeClass(b,"paste_style_mode"))}catch(q){dalert(q)}},setSentenceStyleCopyPaste:function(a,b,c){try{var d=g_objEditorDocument[1*g_objPageControl.nEditNumber],g=d.getSelection().getRangeAt(0),z=!1;if(!g.collapsed){var q=g_objCaretUtil.saveCaret(),h=g_objNodeUtil.getTextNodeInRange(g.commonAncestorContainer,q);if(!1===fnObjectCheckNull(q)&&0<h.length)for(e(q),g=0;g<h.length;g++){var k=h[g];var l=k.parentNode;if("SPAN"!==l.nodeName||"SPAN"===l.nodeName&&1<l.childNodes.length){var x=
d.createElement("span");l.insertBefore(x,k);x.appendChild(k);l=x}setTextStyleCopyPaste(a,b,l,c);z=!0}}else if(!1!==fnObjectCheckNull(p)||m!==a)!0===fnObjectCheckNull(p)&&f(),!0===setTextStyleCopyPaste(a,b,l,c)?(m|=a,a===DZE_LETTER_COMMAND_SUPERSCRIPT&&(m&DZE_LETTER_COMMAND_SUBSCRIPT)===DZE_LETTER_COMMAND_SUBSCRIPT?m^=DZE_LETTER_COMMAND_SUBSCRIPT:a===DZE_LETTER_COMMAND_SUBSCRIPT&&(m&DZE_LETTER_COMMAND_SUPERSCRIPT)===DZE_LETTER_COMMAND_SUPERSCRIPT&&(m^=DZE_LETTER_COMMAND_SUPERSCRIPT)):m^=a;return z}catch(A){dalert()}finally{g_objCaretUtil.restoreCaret()}}}}
function e(a){try{var b=g_objEditorDocument[1*g_objPageControl.nEditNumber],c=b.getSelection(),e=b.createRange(),g=a.start.parentNode;(!1===fnObjectCheckNull(a.start.previousSibling)&&3===a.start.previousSibling.nodeType||!1===fnObjectCheckNull(a.start.nextSibling)&&3===a.start.nextSibling.nodeType)&&!0===g_objNodeUtil.fixWrongTextFormat(a.start)&&(g=a.start.parentNode);g_objNodeUtil.isInlineNode(g)&&d(g,a.start);g=a.end.parentNode;(!1===fnObjectCheckNull(a.end.previousSibling)&&3===a.end.previousSibling.nodeType||
!1===fnObjectCheckNull(a.end.nextSibling)&&3===a.end.nextSibling.nodeType)&&!0===g_objNodeUtil.fixWrongTextFormat(a.end)&&(g=a.end.parentNode);g_objNodeUtil.isInlineNode(g)&&d(g,a.end);c.removeAllRanges();e.setStartAfter(a.start);e.setEndBefore(a.end);c.addRange(e);return e}catch(H){dalert()}}function d(a,b){try{!0!==g_objPropertyUtil.element_hasClass(a,"dze_page_main")&&!g_objNodeUtil.isBlockNode(a)&&!0!==dzeJ(a).hasClass("dze_shape_text_container")&&(!1===fnObjectCheckNull(b.previousSibling)&&3===
b.previousSibling.nodeType||!1===fnObjectCheckNull(b.nextSibling)&&3===b.nextSibling.nodeType)&&(g_objNodeUtil.splitOn(a.parentNode,b),c(b.previousSibling),c(b.nextSibling))}catch(q){dalert()}}function c(a){try{var b=!1;if(!1===fnObjectCheckNull(a)){if(3===a.nodeType)0===a.textContent.length&&(b=!0);else if(!0===fnObjectCheckNull(a.childNodes)||0===a.childNodes.length)b=!0;else for(var c=0;c<a.childNodes.length;c++)if(1===a.childNodes[c].nodeType){b=!1;break}else if(3===a.childNodes[c].nodeType)if(0===
a.childNodes[c].textContent.length)b=!0;else{b=!1;break}!0===b&&a.parentNode.removeChild(a)}return b}catch(E){dalert()}}function f(){try{var a=1*g_objPageControl.nEditNumber,b=g_objNodeUtil.getAncestorNodeOnCaret(a);3===b.nodeType&&(b=b.parentNode);p="SPAN"===b.nodeName?b.cloneNode(!1):g_objEditorDocument[a].createElement("span");!1===fnObjectCheckNull(p.id)&&p.removeAttribute("id");!1===fnObjectCheckNull(p.className)&&p.removeAttribute("class");!1===fnObjectCheckNull(p.getAttribute("contenteditable"))&&
p.removeAttribute("contenteditable");p.className="style_span";p.innerHTML="&#8203;";var c=p.style;if("bold"===c["font-weight"]||700===c["font-weight"])m|=DZE_LETTER_COMMAND_BOLD;"italic"===c["font-style"]&&(m|=DZE_LETTER_COMMAND_ITALIC);!0===g_bBrowserType_IE?(-1<c["text-decoration"].indexOf("underline")&&(m|=DZE_LETTER_COMMAND_UNDERLINE),-1<c["text-decoration"].indexOf("line-through")&&(m|=DZE_LETTER_COMMAND_STRIKE)):(-1<c["text-decoration-line"].indexOf("underline")&&(m|=DZE_LETTER_COMMAND_UNDERLINE),
-1<c["text-decoration-line"].indexOf("line-through")&&(m|=DZE_LETTER_COMMAND_STRIKE));var e=c["vertical-align"];""!==e&&("sub"===e?m|=DZE_LETTER_COMMAND_SUBSCRIPT:!1===isNaN(parseInt(e,10))&&(m|=DZE_LETTER_COMMAND_SUPERSCRIPT))}catch(v){dalert()}}function k(a,b,c,e,d){try{e=fnObjectCheckNull(e)?!1:e;d=fnObjectCheckNull(d)?!0:d;c=dzeJ(c);var g="",f="",h=[];switch(a){case DZE_LETTER_COMMAND_BOLD:g="font-weight";break;case DZE_LETTER_COMMAND_ITALIC:g="font-style";break;case DZE_LETTER_COMMAND_STRIKE:b=
"line-through";case DZE_LETTER_COMMAND_UNDERLINE:g="text-decoration";break;case DZE_LETTER_COMMAND_SUPERSCRIPT:g="vertical-align";break;case DZE_LETTER_COMMAND_SUBSCRIPT:g="vertical-align";break;case DZE_LETTER_COMMAND_FONT_FAMILY:g="font-family";break;case DZE_LETTER_COMMAND_FONT_SIZE:g="font-size";break;case DZE_LETTER_COMMAND_FONT_COLOR:g="color";break;case DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR:g="background-color";break;case DZE_LETTER_COMMAND_LETTER_SPACE:g="letter-spacing"}switch(a){case DZE_LETTER_COMMAND_BOLD:case DZE_LETTER_COMMAND_ITALIC:!1===
d&&(b="normal");h.push({style:g,command:b});break;case DZE_LETTER_COMMAND_UNDERLINE:case DZE_LETTER_COMMAND_STRIKE:var k=c.css(g);-1<k.indexOf("none")?f="":(-1<k.indexOf("line-through")&&(f="line-through"),-1<k.indexOf("underline")&&(f+=(0<f.length?" ":"")+"underline"));!0===d?""!==f&&(b+=" "+f):(b=f,b=a===DZE_LETTER_COMMAND_UNDERLINE?b.replace("underline",""):b.replace("line-through",""),""===b&&(b="none"));h.push({style:g,command:b});break;case DZE_LETTER_COMMAND_SUPERSCRIPT:case DZE_LETTER_COMMAND_SUBSCRIPT:f=
c[0].style[g];var q=l(!0===e?c[0]:null);q=Math.round(q);if(!1!==fnObjectCheckNull(f)||!1!==isNaN(parseInt(f,10))&&"sub"!=f)d&&(h.push({attr:"origin_font_size",command:q}),q=Math.round(.5*q),h.push({style:"vertical-align",command:a===DZE_LETTER_COMMAND_SUPERSCRIPT?q+"px":"sub"}),h.push({style:"font-size",command:q+"pt"}));else{var v=c.attr("origin_font_size");v=!1===fnObjectCheckNull(v)?1*v:2*q;8>v&&(v=8);"sub"===f?a===DZE_LETTER_COMMAND_SUPERSCRIPT?d&&h.push({style:g,command:q+"px"}):d||(h.push({style:"vertical-align",
command:"baseline"}),h.push({style:"font-size",command:v+"pt"}),h.push({attr:"origin_font_size",command:void 0})):a===DZE_LETTER_COMMAND_SUPERSCRIPT?d||(h.push({style:"vertical-align",command:"baseline"}),h.push({style:"font-size",command:v+"pt"}),h.push({attr:"origin_font_size",command:void 0})):d&&h.push({style:g,command:"sub"})}break;case DZE_LETTER_COMMAND_FONT_SIZE:a={style:g,command:b};var z=c[0].style["vertical-align"];!1!==fnObjectCheckNull(z)||!1!==isNaN(parseInt(z,10))&&"sub"!==z||!d||(b=
parseInt(b,10),h.push({attr:"origin_font_size",command:b}),b=Math.round(.5*b),h.push({style:"vertical-align",command:"sub"!==z?b+"px":"sub"}),a.command=b+"pt");h.push(a);break;case DZE_LETTER_COMMAND_FONT_FAMILY:case DZE_LETTER_COMMAND_FONT_COLOR:case DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR:case DZE_LETTER_COMMAND_LETTER_SPACE:h.push({style:g,command:b});break;case DZE_LETTER_COMMAND_REMOVE_FORMAT:if(!c.is("[style]")||c.is("[class]")){var m=c.parent()[0];m.insertBefore(c[0].firstChild,c[0]);m.removeChild(c[0]);
return!0}return!1;case DZE_LETTER_COMMAND_SUBTITLE1:return c.hasClass("bw_subtitle1")?!1:(c.removeClass("bw_subtitle2").addClass("bw_subtitle1"),!0);case DZE_LETTER_COMMAND_SUBTITLE2:return c.hasClass("bw_subtitle2")?!1:(c.removeClass("bw_subtitle1").addClass("bw_subtitle2"),!0)}h.forEach(function(a){fnObjectCheckNull(a.style)?fnObjectCheckNull(a.attr)||(fnObjectCheckNull(a.command)?c.removeAttr(a.attr):c.attr(a.attr,a.command)):c.css(a.style,a.command)});return d}catch(t){dalert()}}function l(a){try{!0===
fnObjectCheckNull(a)&&(a=g_objNodeUtil.getAncestorNodeOnCaret(1*g_objPageControl.nEditNumber).parentNode);var b=""!==a.style.fontSize?a.style.fontSize:dzeJ(a).css("font-size");return b=0<b.indexOf("pt")?parseFloat(b):.75*parseFloat(b)}catch(q){dalert(q)}}function y(a,b,c,e){try{var d="",g=!1;switch(b){case DZE_LETTER_COMMAND_BOLD:d="font-weight";break;case DZE_LETTER_COMMAND_ITALIC:d="font-style";break;case DZE_LETTER_COMMAND_STRIKE:c="line-through";case DZE_LETTER_COMMAND_UNDERLINE:d=!0===g_bBrowserType_IE?
"text-decoration":"text-decoration-line";break;case DZE_LETTER_COMMAND_SUPERSCRIPT:d="vertical-align";break;case DZE_LETTER_COMMAND_SUBSCRIPT:d="vertical-align";break;case DZE_LETTER_COMMAND_FONT_FAMILY:d="font-family";break;case DZE_LETTER_COMMAND_FONT_SIZE:d="font-size";break;case DZE_LETTER_COMMAND_FONT_COLOR:d="color";break;case DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR:d="background-color";break;case DZE_LETTER_COMMAND_LETTER_SPACE:d="letter-spacing";break;case DZE_LETTER_COMMAND_REMOVE_FORMAT:d=
""}var f=!0===e?a[0]:a[0].parentNode,h=d?dzeJ(f).css(d):"";switch(b){case DZE_LETTER_COMMAND_BOLD:h="700"===h||"bold"===h?"bold":h;break;case DZE_LETTER_COMMAND_SUPERSCRIPT:h=!1===isNaN(parseInt(h,10))?"superscript":h;break;case DZE_LETTER_COMMAND_SUBSCRIPT:h="sub"===h?"subscript":h}g=0>h.indexOf(c)||""===c?!0:!1;if(!0===g)return g;for(var k=1;k<a.length;k++){f=!0===e?a[k]:a[k].parentNode;h=d?dzeJ(f).css(d):"";switch(b){case DZE_LETTER_COMMAND_BOLD:h="700"===h||"bold"===h?"bold":h;break;case DZE_LETTER_COMMAND_SUPERSCRIPT:h=
!1===isNaN(parseInt(h,10))?"superscript":h;break;case DZE_LETTER_COMMAND_SUBSCRIPT:h="sub"===h?"subscript":h}if(0>h.indexOf(c)||""===c){g=!0;break}}return g}catch(w){dalert(w)}}function G(a,b){try{if(fnObjectCheckNull(p))return!0;var c="",e=!1;switch(a){case DZE_LETTER_COMMAND_BOLD:c="font-weight";break;case DZE_LETTER_COMMAND_ITALIC:c="font-style";break;case DZE_LETTER_COMMAND_STRIKE:b="line-through";case DZE_LETTER_COMMAND_UNDERLINE:c=!0===g_bBrowserType_IE?"text-decoration":"text-decoration-line";
break;case DZE_LETTER_COMMAND_SUPERSCRIPT:c="vertical-align";break;case DZE_LETTER_COMMAND_SUBSCRIPT:c="vertical-align";break;case DZE_LETTER_COMMAND_FONT_FAMILY:c="font-family";break;case DZE_LETTER_COMMAND_FONT_SIZE:c="font-size";break;case DZE_LETTER_COMMAND_FONT_COLOR:c="color";break;case DZE_LETTER_COMMAND_FONT_BACKGROUND_COLOR:c="background-color";break;case DZE_LETTER_COMMAND_LETTER_SPACE:c="letter-spacing";break;case DZE_LETTER_COMMAND_REMOVE_FORMAT:c=""}var d=c?dzeJ(p).css(c):"";switch(a){case DZE_LETTER_COMMAND_BOLD:d=
"700"===d||"bold"===d?"bold":d;break;case DZE_LETTER_COMMAND_SUPERSCRIPT:d=!1===isNaN(parseInt(d,10))?"superscript":d;break;case DZE_LETTER_COMMAND_SUBSCRIPT:d="sub"===d?"subscript":d}return e=0>d.indexOf(b)||""===b?!0:!1}catch(H){dalert(H)}}function B(a){try{var b={listType:"OL"===a.nodeName?"OL":"UL"};a=dzeJ(a);"UL"!==b.listType||fnObjectCheckNull(a.attr("class"))?b.styleType=dzeJ(a).css("list-style-type"):b.class=a.attr("class");return b}catch(q){dalert(q)}}function L(a,b){try{var c=[],d;if(b.start.parentNode===
b.end.parentNode)fnObjectCheckNull(b.start.previousSibling)&&fnObjectCheckNull(b.end.nextSibling)&&c.push(b.start.parentNode);else{var e=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_ELEMENT,function(a){if(g_objHeaderFooter.getHeaderFooterEditMode()!==g_objHeaderFooter.contains(a))return NodeFilter.FILTER_REJECT;if(g_objPropertyUtil.hasClass(a,["dze_page_container","dze_page_main"]))return NodeFilter.FILTER_SKIP;switch(a.nodeName){case "P":if(g_objPropertyUtil.hasClass(a,"dze_page_break_para"))return NodeFilter.FILTER_REJECT;
case "LI":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":break;case "OL":case "UL":return NodeFilter.FILTER_SKIP;default:return NodeFilter.FILTER_REJECT}return NodeFilter.FILTER_ACCEPT});if(!e)return c;for(d=e.firstChild();null!==d;)c.push(d),d=e.nextNode()}return c}catch(H){dalert(H)}}function M(a){try{for(var b=a.parentNode;("OL"===b.nodeName||"UL"===b.nodeName)&&(b=b.parentNode,!g_objNodeUtil.isLoopBreakNode(b)););g_objNodeUtil.splitOn(b,a);fnObjectCheckNull(a.previousSibling.querySelector("li"))&&
a.parentNode.removeChild(a.previousSibling);fnObjectCheckNull(a.nextSibling.querySelector("li"))&&a.parentNode.removeChild(a.nextSibling)}catch(q){dalert(q)}}return{getInstance:function(){!0===fnObjectCheckNull(F)&&(F=b());return F}};var F,m,p};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(b,d,e){return b==a&&"q"==d&&e==c}}));return!0===c.q}catch(b){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(b){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+c++,b)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),d=Object.seal({}),c=new a([[b,2],[d,3]]);if(2!=c.get(b)||3!=c.get(d))return!1;c.delete(b);c.set(d,4);return!c.has(b)&&4==c.get(d)}catch(n){return!1}}function b(){}function d(a){if(!$jscomp.owns(a,f)){var d=new b;$jscomp.defineProperty(a,f,{value:d})}}function e(a){var c=Object[a];c&&(Object[a]=function(a){if(a instanceof b)return a;d(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var g=0,h=function(a){this.id_=(g+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),e=c.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=c.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!c.next().done?!1:!0}catch(m){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=new WeakMap,d=function(a){this.data_={};this.head_=g();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=g();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var d=this.entries(),c;!(c=d.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,d){var c=d&&typeof d;"object"==
c||"function"==c?b.has(d)?c=b.get(d):(c=""+ ++h,b.set(d,c)):c="p_"+d;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var f=e[a];if(d!==d&&f.key!==f.key||d===f.key)return{id:c,list:e,index:a,entry:f}}return{id:c,list:e,index:-1,entry:void 0}},f=function(a,d){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:d(b)};b=null}return{done:!0,value:void 0}})},g=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),g=f.next();if(g.done||g.value[0]!=b||g.value[1]!=b)return!1;g=f.next();return g.done||g.value[0]==b||4!=g.value[0].x||g.value[1]!=g.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();
this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");
$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objAdjustDoc=new function(){this.arrReservedClassName="dze_tb_layout dze_tb_layout_td dze_bookmark_flag dze_document_container dze_page_container dze_page_header_container dze_page_header dze_page_main dze_page_footer_container dze_page_footer dze_printpagebreak dze_page_margin_lt dze_page_margin_rt dze_page_margin_lb dze_page_margin_rb dze_page_margin_indicator_lt dze_page_margin_indicator_rt dze_page_margin_indicator_lb dze_page_margin_indicator_rb dze_caret_marker dze_caret_marker_start dze_caret_marker_end dze_shape_anchor dze_shape_main dze_shape_text_contents dze_video_iframe_container_span dze_play_button dze_video_iframe_container_div tabSpan dze_table dze_shape_container dze_shape_text_container paragraph sentence dze_shape dzeExtListStyleTriangle dzeExtListStyleInnerCircle dzeExtListStyleFillCircle dzeExtListStyleDiamond dzeExtListStyleHypon dze_page_break_para dze_hide_para dze_external_data_area link2news audio-news align-left align-right text-align-left text-align-right text-align-center bw_color_navy bw_color_blue bw_color_pink bw_box bw_box_blue bw_box_pink bw_subtitle bw_subtitle1 bw_subtitle2 bw_bold bw_italic bw_quote bw_text_first img-align-center img-align-left img-align-right youtube-embed-wrapper".split(" ");
this.objPasteCssStruct_WK=null;this.nPasteType_WK=-1;this.ID_PASTE_TYPE_EXCEL=0;this.ID_PASTE_TYPE_WORD=1;this.ID_PASTE_TYPE_SLIDE=2;this.objAdjustTarget=null;this.nEditNumber=0;this.setTarget=function(a,c){try{this.objAdjustTarget=a,"undefined"!=typeof c&&(this.nEditNumber=c)}catch(b){dalert(b)}};this.getTarget=function(a){try{return"undefined"==typeof a&&(a=this.nEditNumber),this.objAdjustTarget?this.objAdjustTarget:g_objEditorDocument[a].body}catch(c){dalert(c)}};this.adjustDocProcess=function(a){try{this.remove_Br_Node_Inside_P_Node(a),
g_objCopyPaste.setTimeoutForPaste(function(){g_objAdjustDoc.doAdjustDocProcess(a)},100)}catch(c){dalert(c)}};this.doAdjustDocProcess=function(a){try{var c=dzeUiConfig.bUsePasteCapture;c||g_objCaretUtil.saveCaret();var b=dzeUiConfig.bOfficePagingMode,d=null,e=0;b&&!c&&(d=g_objEditorDocument[a].getElementById("dze_document_main_container"),e=d.scrollTop);var f=this.adjustGarbageAttribute(a);this.updateHTMLCode(f,b,a);this.adjustRemoveGarbageText(a);g_objOnefficeEditor.getObjNodeCleaner().processGarbageEmptyTag(g_objAdjustDoc.getTarget(a),
!0,a);if(g_bBrowserType_IE){this.adjustDuplicateGarbage_P_Node(a);var g=this.getTarget(a).innerHTML;this.getTarget(a).innerHTML=g}this.replaceDeprecatedTag(a);this.setFixedTable(this.getTarget(a));g_bContentPTagStyleApply&&this.setParaInlineStyle(a,this.getTarget(a));this.adjustStyleUnit(a);b&&!c&&(d=g_objEditorDocument[a].getElementById("dze_document_main_container"),d.scrollTop=e);c||(g_objCaretUtil.restoreCaret(),g_objUndoRedo.registerUndoRedoStack(0,a))}catch(h){dalert(h)}};this.isExistRemoveGarbageCommentText=
function(a){try{if(-1!=this.getTarget(a).innerHTML.toLowerCase().indexOf("\x3c!--[if"))return!0}catch(c){dalert(c)}return!1};this.isExistRemoveGarbageText=function(a){try{var c=this.getTarget(a).innerHTML.toLowerCase();if(null!=g_arrRemoveGarbageText)for(a=0;a<g_arrRemoveGarbageText.length;a++)if(-1!=c.indexOf(g_arrRemoveGarbageText[a]))return!0}catch(b){dalert(b)}return!1};this.isExistGarbageStyleAttribute=function(a){try{var c=this.getParserStruct(a);return c?this.checkTree(c.stDocRoot):!1}catch(b){dalert(b)}return!1};
this.getParserStruct=function(a){try{var c=this.getTarget(a).innerHTML,b=g_objCodeParser.initParserStruct(c);if(!b)return null;g_objCodeParser.parseBody(b.stDocRoot,b);return b}catch(d){dalert(d)}return null};this.checkTree=function(a){try{for(var c=a.content;null!=c;c=c.next)if(this.checkTree(c)||"font"==c.tagName||this.checkTreeAttribute(c))return!0}catch(b){dalert(b)}return!1};this.checkTreeAttribute=function(a){try{if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++){var b=a.arrAttribute[c];
if(g_objCodeDefine.ID_ATTR_STYLE==b.attributeID&&this.checkTreeAttributeStyle(b))return!0}}catch(d){dalert(d)}return!1};this.checkTreeAttributeStyle=function(a){try{var c=a.arrStyleAttribute;if(null==c)return!1;for(a=0;a<c.length;a++)if(/mso-/gi.test(c[a].styleName))return!0}catch(b){dalert(b)}return!1};this.adjustRemoveGarbageText=function(a){try{null!=g_arrRemoveGarbageText&&this.processRemoveGarbageText(this.getTarget(a))}catch(c){dalert(c)}};this.processRemoveGarbageText=function(a){try{for(var c=
a.innerHTML,b=!1,d=0;d<g_arrRemoveGarbageText.length;d++)null!=g_arrRemoveGarbageText[d]&&""!=g_arrRemoveGarbageText[d]&&-1!=c.indexOf(g_arrRemoveGarbageText[d])&&(c=c.replace(g_arrRemoveGarbageText[d],""),b=!0,d--);b&&(a.innerHTML=c)}catch(e){dalert(e)}};this.adjustDuplicateGarbage_P_Node=function(a){try{if(!g_bBrowserType_IE)return!1;this.processDuplicateGarbage_P_Node(this.getTarget(a))}catch(c){dalert(c)}};this.processDuplicateGarbage_P_Node=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){for(var c=
0;c<a.childNodes.length;c++){var b=a.childNodes[c];ID_SELECTION_ELEMENT_NODE==b.nodeType&&this.processDuplicateGarbage_P_Node(b)}if("p"==g_objNodeUtil.getElementTagName(a).toLowerCase()){var d=a.outerHTML,e=d.length;if(4<=e){var f=d.substring(e-4);f=f.toLowerCase();"</p>"!=f&&(a.outerHTML=d+"</p>")}else 3==e&&"<p>"==d.toLowerCase()&&(a.outerHTML=window.attachEvent?d+"</p>":d+"<br></p>")}}}catch(g){dalert(g)}};this.removeParaWithoutChild=function(a){try{for(var c=function(a){try{if(!a||1!=a.nodeType)return!1;
for(var b=["height","paddingTop","paddingBottom","marginTop","marginBottom"],c=0,d=b.length;c<d;c++){var e=a.style[b[c]];if(e&&parseFloat(e))return!0}return!1}catch(m){dalert(m)}},b=function(a){try{if(!a||1!==a.nodeType)return!1;var b=a.childNodes;a=null;for(var c=0,d=b.length;c<d;c++)if(a=b[c],3!==a.nodeType||!g_objNodeUtil.isAllWhiteSpace(a))return!1;return!0}catch(n){dalert(n)}},d=this.getTarget(a),e=d?d.querySelectorAll("p, h1, h2, h3, h4, h5, h6, ol, ul"):[],f=e.length-1;0<=f;f--){var g=e[f];
g.firstChild&&(!b(g)||""!==g.style.whiteSpace)||c(g)||g.parentNode.removeChild(g)}}catch(h){dalert(h)}};this.adjustGarbageAttribute=function(a){try{var c=this.getParserStruct(a);if(!c)return!1;this.adjustTree(c.stDocRoot,c);return c}catch(b){dalert(b)}};this.adjustTree=function(a,c){try{for(var b=a.content;null!=b;b=b.next)this.adjustTree(b,c),g_objCodeLexer.NODE_TYPE_COMMENT==b.type?0==c.stDocStreamIn.htmlCode.substring(b.textStartPos,b.textEndPos+1).indexOf("[if")&&(b.type=g_objCodeLexer.NODE_TYPE_TEXT,
b.textEndPos=b.textStartPos-1):(-1!=b.tagName.indexOf(":")&&(b.print=!1,b.arrAttribute=null),this.adjustTreeAttribute(b,c))}catch(d){dalert(d)}};this.adjustTreeAttribute=function(a,c){try{if(null!=a.arrAttribute)for(var b=0;b<a.arrAttribute.length;b++){var d=a.arrAttribute[b];if(g_objCodeDefine.ID_ATTR_STYLE==d.attributeID)this.adjustTreeAttributeStyle(d);else{var e=d.attributeName.toLowerCase(),f=this.adjustTreeAttributeValue(a,d,c);this.adjustRemoveAttributeName(e,f)&&(a.arrAttribute[b]=null)}}}catch(g){dalert(g)}};
this.adjustTreeAttributeValue=function(a,c,b){try{return b.stDocStreamIn.htmlCode.substring(c.attributeStartPos,c.attributeEndPos+1)}catch(d){dalert(d)}};this.adjustTreeAttributeStyle=function(a){try{var c=a.arrStyleAttribute;if(null!=c)for(a=0;a<c.length;a++){var b=c[a].styleName.trim(),d=c[a].styleValue.trim();/mso-/gi.test(b)?c[a]=null:"background-color"==b?"transparent"==d&&(c[a]=null):(b=b.toLowerCase(),this.adjustRemoveAttributeStyleName(b)&&(c[a]=null))}}catch(e){dalert(e)}};this.adjustRemoveAttributeName=
function(a,c){try{if(null==g_arrAdjustRemoveAttributeName)return!1;for(var b=0;b<g_arrAdjustRemoveAttributeName.length;b++){var d=g_arrAdjustRemoveAttributeName[b].toLowerCase();if(a==d){if("class"==d||"classname"==d){if(startsWith(c,"dze"))break;var e=c.split(" ");b=0;for(var f=e.length;b<f;b++){a=0;for(var g=this.arrReservedClassName.length;a<g;a++)if(this.arrReservedClassName[a]&&this.arrReservedClassName[a]===e[b])return!1}}return!0}}}catch(h){dalert(h)}return!1};this.adjustRemoveAttributeStyleName=
function(a){try{if(null==g_arrAdjustRemoveStyleName)return!1;for(var c=0;c<g_arrAdjustRemoveStyleName.length;c++){var b=g_arrAdjustRemoveStyleName[c].toLowerCase();if(a==b)return!0}}catch(d){dalert(d)}return!1};this.updateHTMLCode=function(a,c,b){try{g_objCodePrint.printTree(a.stDocRoot,0,a);0<a.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,a);for(var d="",e="",f=0;f<a.stDocStreamOut.lineString.length;f++)e=a.stDocStreamOut.lineString[f],checkTextNodeAllWhiteCode_Plus_Space(e)||
(d+=e,c||(d+="\r\n"));this.getTarget(b).innerHTML=d}catch(g){dalert(g)}};this.replaceDeprecatedTag=function(a){try{for(;;){var c=this.getTarget(a).getElementsByTagName("font"),b=c.length;if(0==b)break;var d=c[b-1],e=g_objNodeUtil.getParentElement(d),f=g_objEditorDocument[a].createElement("span");null!=d.face&&""!=d.face&&(f.style.fontFamily=d.face);null!=d.color&&""!=d.color&&(f.style.color=d.color);null!=d.size&&""!=d.size&&("1"==d.size?f.style.fontSize="10px":"2"==d.size?f.style.fontSize="12px":
"3"==d.size?f.style.fontSize="15px":"4"==d.size?f.style.fontSize="17px":"5"==d.size?f.style.fontSize="22px":"6"==d.size&&(f.style.fontSize="32px"));for(;0<d.childNodes.length;)f.appendChild(d.childNodes[0]);e.replaceChild(f,d);var g=g_objEditorDocument[a].createElement("div");g.appendChild(d);var h=g_objCodeParser.initParserStruct(g.innerHTML);if(!h)break;g_objCodeParser.parseBody(h.stDocRoot,h);var k=h.stDocRoot.content;if(null!=k&&"font"==k.tagName&&null!=k.arrAttribute)for(var l=0;l<k.arrAttribute.length;l++){var p=
k.arrAttribute[l];if(g_objCodeDefine.ID_ATTR_STYLE==p.attributeID)for(var n=0;n<p.arrStyleAttribute.length;n++){var m=p.arrStyleAttribute[n].styleName,q=p.arrStyleAttribute[n].styleValue.trim();g_objPropertyUtil.setElementStyleAttributeValue(f,m,q)}}}}catch(r){dalert(r)}};this.adjustStyleUnit=function(a){try{this.processStyleUnit(this.getTarget(a))}catch(c){dalert(c)}};this.processStyleUnit=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){for(var c=0;c<a.childNodes.length;c++){var b=a.childNodes[c];
ID_SELECTION_ELEMENT_NODE==b.nodeType&&this.processStyleUnit(b)}this.doProcessStyleUnit(a)}}catch(d){dalert(d)}};this.doProcessStyleUnit=function(a){try{if(ID_SELECTION_ELEMENT_NODE==a.nodeType){var c=g_objNodeUtil.getElementTagName(a).toLowerCase();if("table"==c||"col"==c||"tr"==c||"td"==c||"th"==c||"div"==c||"p"==c||"h1"==c||"h2"==c||"h3"==c||"h4"==c||"h5"==c||"h6"==c){var b=g_objCommonUtil.extractNumberValueUnit(a.width),d=g_objCommonUtil.extractNumberValueUnit(a.style.width);this.doProcessStyleUnit_Common(a,
c,0,b,d);var e=g_objCommonUtil.extractNumberValueUnit(a.height),f=g_objCommonUtil.extractNumberValueUnit(a.style.height);this.doProcessStyleUnit_Common(a,c,1,e,f);var g=g_objCommonUtil.extractNumberValueUnit(a.style.marginLeft);this.doProcessStyleUnit_Common(a,c,2,null,g);var h=g_objCommonUtil.extractNumberValueUnit(a.style.marginTop);this.doProcessStyleUnit_Common(a,c,3,null,h);var k=g_objCommonUtil.extractNumberValueUnit(a.style.marginRight);this.doProcessStyleUnit_Common(a,c,4,null,k);var l=g_objCommonUtil.extractNumberValueUnit(a.style.marginBottom);
this.doProcessStyleUnit_Common(a,c,5,null,l);var p=g_objCommonUtil.extractNumberValueUnit(a.style.paddingLeft);this.doProcessStyleUnit_Common(a,c,6,null,p);var n=g_objCommonUtil.extractNumberValueUnit(a.style.paddingTop);this.doProcessStyleUnit_Common(a,c,7,null,n);var m=g_objCommonUtil.extractNumberValueUnit(a.style.paddingRight);this.doProcessStyleUnit_Common(a,c,8,null,m);var q=g_objCommonUtil.extractNumberValueUnit(a.style.paddingBottom);this.doProcessStyleUnit_Common(a,c,9,null,q);if("table"==
c||"td"==c||"th"==c||"div"==c){var r=g_objCommonUtil.extractNumberValueUnit(a.style.borderLeftWidth);this.doProcessStyleUnit_Common(a,c,10,null,r);var t=g_objCommonUtil.extractNumberValueUnit(a.style.borderTopWidth);this.doProcessStyleUnit_Common(a,c,11,null,t);var v=g_objCommonUtil.extractNumberValueUnit(a.style.borderRightWidth);this.doProcessStyleUnit_Common(a,c,12,null,v);var u=g_objCommonUtil.extractNumberValueUnit(a.style.borderBottomWidth);this.doProcessStyleUnit_Common(a,c,13,null,u);this.doProcessStyleUnit_Color(a,
0,a.style.borderLeftColor);this.doProcessStyleUnit_Color(a,1,a.style.borderTopColor);this.doProcessStyleUnit_Color(a,2,a.style.borderRightColor);this.doProcessStyleUnit_Color(a,3,a.style.borderBottomColor)}}}}catch(w){dalert(w)}};this.doProcessStyleUnit_Common=function(a,c,b,d,e){try{if(null!=d||null!=e)if(null==d&&null!=e)if("pt"==e.strUnit)if(0==b)a.style.width=a.offsetWidth;else if(1==b)a.style.height=a.offsetHeight;else if(2==b||3==b||4==b||5==b){var f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue);
null!=f&&(2==b?a.style.marginLeft=f+"px":3==b?a.style.marginTop=f+"px":4==b?a.style.marginRight=f+"px":5==b&&(a.style.marginBottom=f+"px"))}else if(6==b||7==b||8==b||9==b)f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue),null!=f&&(6==b?a.style.paddingLeft=f+"px":7==b?a.style.paddingTop=f+"px":8==b?a.style.paddingRight=f+"px":9==b&&(a.style.paddingBottom=f+"px"));else{if(10==b||11==b||12==b||13==b)f=g_objCommonUtil.mappingFrom_Pt_To_Px(e.nValue),null!=f&&(10==b?a.style.borderLeftWidth=f+"px":11==b?
a.style.borderTopWidth=f+"px":12==b?a.style.borderRightWidth=f+"px":13==b&&(a.style.borderBottomWidth=f+"px"))}else 2==b||3==b||4==b||5==b?0==e.nValue&&"auto"!==e.strUnit&&(2==b?a.style.marginLeft=0:3==b?a.style.marginTop=0:4==b?a.style.marginRight=0:5==b&&(a.style.marginBottom=0)):6!=b&&7!=b&&8!=b&&9!=b||0!=e.nValue||(6==b?a.style.paddingLeft=0:7==b?a.style.paddingTop=0:8==b?a.style.paddingRight=0:9==b&&(a.style.paddingBottom=0));else null!=d&&null==e||null==d||null==e||""!=d.strUnit||"pt"!=e.strUnit||
(0==b?a.style.width="":1==b&&"tr"!=c&&(a.style.height=a.offsetHeight))}catch(g){dalert(g)}};this.doProcessStyleUnit_Color=function(a,c,b){try{if(null!=b&&""!=b){var d=g_objCommonUtil.getHexColorCodeByNickName(b);d!=b&&(0==c?a.style.borderLeftColor=d:1==c?a.style.borderTopColor=d:2==c?a.style.borderRightColor=d:3==c&&(a.style.borderBottomColor=d))}}catch(e){dalert(e)}};this.checkPasteCode_Excel_WK=function(a){try{var c=a.clipboardData.getData("text/html"),b=g_objCodeParser.initParserStruct(c);if(!b)return!1;
g_objCodeParser.parseBody(b.stDocRoot,b);var d=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_HTML);if(null==d)return!1;this.nPasteType_WK=-1;var e=this.findNodeAttributeValue(b,d,"xmlns:x");null!=e&&"urn:schemas-microsoft-com:office:excel"==e&&(this.nPasteType_WK=this.ID_PASTE_TYPE_EXCEL);-1==this.nPasteType_WK&&(e=this.findNodeAttributeValue(b,d,"xmlns:w"),null!=e&&"urn:schemas-microsoft-com:office:word"==e&&(this.nPasteType_WK=this.ID_PASTE_TYPE_WORD));if(-1==this.nPasteType_WK){var f=this.findTagNode(b.stDocRoot,
g_objCodeDefine.ID_TAG_HEAD);if(null!=f){var g=this.findTagNodeAttr(b,f,g_objCodeDefine.ID_TAG_META,"name","generator");if(null!=g){var h=g.arrAttribute;a=0;for(var k=h.length;a<k;a++)if("content"===h[a].attributeName){var l=b.stDocStreamIn.htmlCode.substring(h[a].attributeStartPos,h[a].attributeEndPos+1).toLowerCase();if(startsWith(l,"microsoft powerpoint")){this.nPasteType_WK=this.ID_PASTE_TYPE_SLIDE;break}}}}}if(-1==this.nPasteType_WK)return!1;var p=this.findTagNode(b.stDocRoot,g_objCodeDefine.ID_TAG_STYLE);
if(null==p)return!1;var n=this.getNodeContent(b,p);if(null==n||""==n)return!1;this.objPasteCssStruct_WK=null;this.objPasteCssStruct_WK=g_objCssParser.initCssParserStruct(n);if(!this.objPasteCssStruct_WK)return!1;g_objCssParser.parseCss(this.objPasteCssStruct_WK.stDocRoot,this.objPasteCssStruct_WK);return!0}catch(m){dalert(m)}this.objPasteCssStruct_WK=null;return!1};this.findTagNode=function(a,c){try{if(null==a)return null;for(var b=a.content;null!=b;b=b.next)if(g_objCodeDefine.ID_TAG_UNKNOWN!=b.tagID){if(c==
b.tagID)return b;var d=this.findTagNode(b,c);if(null!=d)return d}}catch(e){dalert(e)}return null};this.findTagNodeAttr=function(a,c,b,d,e){try{if(null==c)return null;for(var f=c.content;null!=f;f=f.next)if(g_objCodeDefine.ID_TAG_UNKNOWN!==f.tagID){if(b===f.tagID){var g=f.arrAttribute;c=0;for(var h=g.length;c<h;c++)if(d===g[c].attributeName&&a.stDocStreamIn.htmlCode.substring(g[c].attributeStartPos,g[c].attributeEndPos+1).toLowerCase()===e)return f}var k=this.findTagNodeAttr(a,f,b,d,e);if(null!=k)return k}}catch(l){dalert(l)}return null};
this.findNodeAttributeValue=function(a,c,b){try{if(g_objCodeDefine.ID_TAG_UNKNOWN==c.tagID)return null;if(null!=c.arrAttribute)for(var d=0;d<c.arrAttribute.length;d++){var e=c.arrAttribute[d];if(b==e.attributeName)return a.stDocStreamIn.htmlCode.substring(e.attributeStartPos,e.attributeEndPos+1).toLowerCase()}}catch(f){dalert(f)}return null};this.getNodeContent=function(a,c){try{if(null==c)return null;for(var b="",d=c.content;null!=d;d=d.next)b+=a.stDocStreamIn.htmlCode.substring(d.textStartPos,d.textEndPos+
1);return b}catch(e){dalert(e)}return null};this.adjustPasteCode_WK=function(a){try{if(g_bBrowserType_WK&&-1!=this.nPasteType_WK){for(var c=new Set,b=this.objPasteCssStruct_WK.stDocRoot.content;null!=b;b=b.next)if(null!=b.arrCssClassName)for(var d=0;d<b.arrCssClassName.length;d++){var e=b.arrCssClassName[d];if(null!=e&&""!=e)if(-1!=e.indexOf(".")){var f=e.split(".");if(2==f.length){e=f[1];var g=this.getTarget(a).getElementsByClassName(e);if(null!=g&&0!=g.length){var h=this.makeStyleString_WK(b);if(null!=
h&&""!=h){for(var k=0;k<g.length;k++){var l=g[k];"undefined"==typeof l.paste_style&&(l.paste_style="");l.paste_style+=h;c.add(l)}for(;;)if(g=this.getTarget(a).getElementsByClassName(e),0<g.length)g[0].removeAttribute("class");else break}}}}else{var p=g_objCodeLexer.findTagDefineID(e);if(g_objCodeDefine.ID_TAG_UNKNOWN!=p&&g_objCodeDefine.ID_TAG_TD==p&&(g=this.getTarget(a).getElementsByTagName(e),null!=g&&0!=g.length)){var n=this.makeStyleString_WK_Filter(b);if(null!=n&&""!=n)for(k=0;k<g.length;k++)l=
g[k],"undefined"==typeof l.paste_style&&(l.paste_style=""),l.paste_style+=n,c.add(l)}}}c.forEach(function(a){var b=a.getAttribute("style")||"";a.setAttribute("style",a.paste_style+b);a.paste_style=null;a.removeAttribute("paste_style")})}}catch(m){dalert(m)}};this.makeStyleString_WK=function(a){try{if(null==a)return null;for(var c="",b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b];if(!/mso-/gi.test(d.styleName)){var e=d.styleValue;-1!=d.styleName.indexOf("border")&&(e=e.replace(/dot-dot-dash/gi,
"dotted"),e=e.replace(/dot-dash-slanted/gi,"dotted"),e=e.replace(/dot-dash/gi,"dotted"),e=e.replace(/hairline/gi,"dotted"));c+=d.styleName+":"+e+";"}}return c}catch(f){dalert(f)}return null};this.makeStyleString_WK_Filter=function(a){try{if(null==a)return null;for(var c="",b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b],e=!1;switch(d.styleName){case "font-family":case "white-space":e=!1;break;default:e=!0}e||(c+=d.styleName+":"+d.styleValue+";")}return c}catch(f){dalert(f)}return null};
this.setStyleString_With_Compare_WK=function(a,c){try{if(null!=a)for(var b=0;b<a.arrCssClassAttribute.length;b++){var d=a.arrCssClassAttribute[b];"font-family"==d.styleName?this.setStyleString_With_Compare_Process_WK("font-family",d.styleValue,c):"white-space"==d.styleName&&this.setStyleString_With_Compare_Process_WK("white-space",d.styleValue,c)}}catch(e){dalert(e)}};this.setStyleString_With_Compare_Process_WK=function(a,c,b){try{for(var d=0;d<b.length;d++){var e=b[d],f=e.getAttribute("style");null==
f&&(f="");for(var g=!1,h=f.split(";"),k=0;k<h.length;k++)-1!=h[k].trim().indexOf(a)&&(g=!0);g||e.setAttribute("style",f+";"+a+":"+c+";")}}catch(l){dalert(l)}};this.addParaToCell=function(a){try{if(!a)return!1;var c=a.ownerDocument,b=c.defaultView;if(!c||!b)return!1;var d=g_objNodeUtil,e=null,f=[camelCase("font-family"),camelCase("font-size"),camelCase("color"),camelCase("text-align")],g=[null,g_objPropertyUtil.checkStyleFontSize,null,null],h=a.querySelectorAll("td, th");forEach(h,function(a,h){if(d.hasAllTextInlineChild(h)){a=
c.createElement("p");e=null;for(var k=0;k<f.length;k++){var l=f[k];var m=l;var q=h.style[m];m=q?q:(m=(e=e||b.getComputedStyle(h,null))?e[m]:null)?m:null;m&&(g[k]&&(m=g[k](m)),m&&(a.style[l]=m))}h.firstChild?d.moveNodesTo(a,h.firstChild):a.appendChild(c.createElement("BR"));h.appendChild(a)}},this)}catch(k){dalert(k)}};this.setParaInlineStyle=function(a,c,b){try{if(!c||!dzeUiConfig.bUsePasteCapture)return!1;var d=g_objEditWindow[a];if(!g_objEditorDocument[a]||!d)return!1;var e=[camelCase("font-family"),
camelCase("font-size"),camelCase("color"),camelCase("margin-top"),camelCase("margin-bottom")],f=[null,g_objPropertyUtil.checkStyleFontSize,null,null,null],g=c.getElementsByTagName("p");g=[].slice.call(g);if(b){var h=c.getElementsByTagName("li");g=g.concat([].slice.call(h))}g.forEach(function(a){for(var b=null,c=0,g=e.length;c<g;c++){var h=e[c],k=a.style[h];!k&&(b=b||d.getComputedStyle(a,null),k=b[h])&&(f[c]&&(k=f[c](k)),k&&(a.style[h]=k))}});return!0}catch(k){dalert(k)}};this.adjustTable=function(a){try{if(!a)return!1;
var c=a.querySelectorAll("table[height], table[style*='height:'], table[style*='min-height:'], table[style*='max-height:']");g_objTableUtil.removeHeightAttr(c);c=a.querySelectorAll("td[style*='white-space:'], th[style*='white-space:'], td *[style*='white-space:'], th *[style*='white-space:']");forEach(c,function(a,b){a=b.style.whiteSpace.toLowerCase();if("nowrap"===a||"pre"===a)b.style.whiteSpace=""});c=a.querySelectorAll("td[style*='display:'], th[style*='display:']");forEach(c,function(a,b){"none"===
b.style.display.toLowerCase()&&(b.style.display="")});c=a.querySelectorAll("table");a=null;for(var b=0,d=c.length;b<d;b++)a=new TableMatrix(c[b]),a.removeBlankCol(),a.removeBlankRow(),a.removeZeroWidthCol(),a.removeZeroHeightRow();return!0}catch(e){dalert(e)}};this.setFixedTable=function(a){try{if(!a)return!1;var c=g_objTableUtil,b=a.querySelectorAll("table:not(.dze_table)");b=Array.prototype.slice.call(b);b.forEach(function(a){c.setDzeTable(a)});return!0}catch(d){dalert(d)}};this.remove_Br_Node_Inside_P_Node=
function(a){try{if(g_bBrowserType_IE){var c=this.getTarget(a).getElementsByTagName("p");for(a=0;a<c.length;a++){var b=c[a],d=b.childNodes.length;if(!(1>=d)){var e=b.childNodes[d-1];"br"==e.nodeName.toLowerCase()&&this.isAllTextNodeExceptLastOne(b)&&b.removeChild(e)}}}}catch(f){dalert(f)}};this.isAllTextNodeExceptLastOne=function(a){try{for(var c=0;c<a.childNodes.length-1;c++)if(ID_SELECTION_ELEMENT_NODE==a.childNodes[c].nodeType)return!1;return!0}catch(b){dalert(b)}return!1};this.changeTableAlignToMarginStyle=
function(a){try{if(g_bBrowserType_IE){var c=this.getTarget(a).getElementsByTagName("table");for(a=0;a<c.length;a++){var b=c[a],d=b.getAttribute("align");""!=d&&null!=d&&(d=d.toLowerCase(),"left"==d?(b.removeAttribute("align"),b.style.marginLeft="0px",b.style.marginRight="auto"):"right"==d&&(b.removeAttribute("align"),b.style.marginLeft="auto",b.style.marginRight="0px"))}}}catch(e){dalert(e)}};this.customDeleteEvent=function(a,c){try{var b=g_objEditorDocument[c].getSelection(),d=null;if(!1===fnObjectCheckNull(b)&&
(d=b.getRangeAt(0),!g_objPropertyUtil.hasClass(d.startContainer,["dze_page_main","dze_page_header","dze_page_footer"])&&!g_objPropertyUtil.hasClass(d.endContainer,["dze_page_main","dze_page_header","dze_page_footer"]))){var e=d.commonAncestorContainer;if(e&&g_objNodeUtil.getLoopParentElement(e,"td")){var f=g_objNodeUtil.getLoopParentElement(e,"td").cloneNode(!0);b=!0;var g=!1,h=d.cloneRange();h.setStart(f,0);h.setEnd(f,f.childNodes.length);if(!1===d.collapsed||a.keyCode===ID_KEYCODE_ENTER&&!1===d.collapsed)d.toString()!==
h.toString()&&(b=!1);else{var k=h.toString(),l=k.replace(/\u200B/g,"").length;1<l?b=!1:1===l&&(a.keyCode===ID_KEYCODE_BACKSPACE&&1!==d.startOffset||a.keyCode===ID_KEYCODE_DELETE&&0!==d.startOffset)&&(b=!1);if(!0===b){var p=f.getElementsByTagName("p");if(2<p.length)b=!1;else if(2===p.length){if(e.nodeType===ID_SELECTION_TEXT_NODE||"span"===e.nodeName.toLowerCase())e=g_objNodeUtil.getLoopParentElement(e,"p");if(!1===fnObjectCheckNull(e)){if(a.keyCode===ID_KEYCODE_BACKSPACE)var n=e.previousSibling;else a.keyCode===
ID_KEYCODE_DELETE&&(n=e.nextSibling);!1===fnObjectCheckNull(n)&&(g=!0)}}else if(0===k.length||1===k.length&&l!==k.length)b=!1,a.keyCode!==ID_KEYCODE_ENTER&&a.preventDefault()}}if(!0===b){if(!0===g){var m=g_objNodeUtil.getParentElement(e);a.keyCode===ID_KEYCODE_BACKSPACE?n=e.previousSibling:a.keyCode===ID_KEYCODE_DELETE&&(n=e.nextSibling);d.setStart(n,0);d.setEnd(n,0);g_objCaretUtil.insertCaretMarker(d,ID_PAGE_CURRENT_CARET,!0);m.removeChild(e);var q=g_objEditorDocument[c].getElementById(ID_PAGE_CURRENT_CARET);
n.removeChild(q)}else{e.nodeType===ID_SELECTION_TEXT_NODE?e.nodeValue="":e.innerHTML="";g_objCaretUtil.insertCaretMarker(d,ID_PAGE_CURRENT_CARET,!0);q=g_objEditorDocument[c].getElementById(ID_PAGE_CURRENT_CARET);f=e.nodeType===ID_SELECTION_TEXT_NODE?g_objNodeUtil.getParentElement(e):e;if("td"===f.nodeName.toLowerCase()||"p"===f.nodeName.toLowerCase()){if("td"===f.nodeName.toLowerCase()){var r=g_objEditorDocument[c].createElement("p");f.appendChild(r);r.appendChild(q);d.setStart(q,0);d.setEnd(q,0);
f=r}d=!1;for(e=0;e<f.childNodes.length;e++)"br"===f.childNodes[e].nodeName.toLowerCase()&&(d=!0);if(!1===d){var t=g_objEditorDocument[c].createElement("br");f.appendChild(t)}if(a.keyCode===ID_KEYCODE_ENTER){var v=f.cloneNode(!1);m=g_objNodeUtil.getParentElement(f);t=g_objEditorDocument[c].createElement("br");v.appendChild(t);m.insertBefore(v,f)}}else if("span"===f.nodeName.toLowerCase()){var u=f.innerHTML;u.length===u.replace(/\u200B/g,"").length&&(f.innerHTML=u+"&#8203;")}q=g_objEditorDocument[c].getElementById(ID_PAGE_CURRENT_CARET);
g_objNodeUtil.getParentElement(q).removeChild(q)}TBCancelBubbleEvent(a)}}}}catch(w){dalert(w)}finally{}};this.pasteRangeImageAutoUpload=function(a){!0===dzeUiConfig.bUsePasteRangeImageAutoUpload&&(g_objCopyPaste.pause(),uploadCurrentDocumentImageFromElement(g_objAdjustDoc.getTarget(a),function(){g_objCopyPaste.resume()},function(a){g_objCopyPaste.resume()}))};this.fitImageSizeToDoc=function(a,c){try{var b=DOCUMENT_MAIN_WIDTH,d=DOCUMENT_MAIN_HEIGHT;if(!0===a.get(0).complete){for(var e,f,g,h,k=null,
l=0;l<a.length;l++)if(e=a.eq(l),f=e.width(),g=e.height(),h=f/g,k=getMaxBoundSize(0,e.get(0)),b=k.width,d=k.height,b<f&&(g=parseInt(b/h,10),e.width(b),e.height(g)),d<g&&(f=parseInt(d*h,10),e.width(f),e.height(d)),0===f||0===g)e.width(parseInt(.9*b,10)),e.height(parseInt(.9*d,10));!1===fnObjectCheckNull(c)&&"function"===typeof c&&c()}else a.css("visibility","hidden"),a.removeAttr("loading"),a.on("load",function(){this.style.visibility="";var a=this.offsetWidth,c=this.offsetHeight,e=a/c,f=getMaxBoundSize(0,
this);b=f.width;d=f.height;b<a&&(c=parseInt(b/e,10),this.style.width=b,this.style.height=c);d<c&&(a=parseInt(d*e,10),this.style.width=a,this.style.height=d);if(0===a||0===c)this.style.width=parseInt(.9*b,10),this.style.height=parseInt(.9*d,10);if(!0===dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer(0,g_objPageControl.getPageNum(this))}),a.on("error",function(){this.style.visibility=""})}catch(p){dalert()}};this.adjustContentBeforeInsert=function(a){try{g_objAdjustDoc.changeTextTagFormat(a);
g_objTagUtil.force_formTagSwitch(a,!((g_bBrowserType_IE||g_bBrowserType_FF)&&!1===g_objTagUtil.bFormTagSwitch));var c=a.querySelectorAll("div.oneffice_qrcode_first_container, div.oneffice_qrcode_last_container");forEach(c,function(a,c){c.parentNode.removeChild(c)},this);g_objNodeUtil.removeElementsBySelector(a,"li>div, li>p");g_objListUtil.replaceAllParaWithListItem(a);g_objPlaceholder.setAllPlaceholderText(a)}catch(b){dalert(b)}};this.changeTextTagFormat=function(a){try{var c=function(b){try{var c=
a.find(b);for(b=0;b<c.length;b++)g_objAdjustDoc.changeTextFormat(c.get(b))}catch(e){dalert()}};a=dzeJ(a);c("b, strong");c("i, em");c("u");c("strike, s");c("sup");c("sub");c("font")}catch(b){dalert()}};this.changeTextFormat=function(a){try{for(var c=a.ownerDocument,b=a.nodeName,d=c.createElement("span"),e=a.getAttribute("style");!0===a.hasChildNodes();)d.appendChild(a.firstChild);!1===fnObjectCheckNull(e)&&0<e.length&&d.setAttribute("style",d.getAttribute("style")+e);switch(b){case "B":case "STRONG":d.style.fontWeight=
"bold";break;case "I":case "EM":d.style.fontStyle="italic";break;case "U":!0===g_bBrowserType_IE?d.style.textDecoration="underline":d.style.textDecorationLine="underline";break;case "STRIKE":case "S":!0===g_bBrowserType_IE?d.style.textDecoration="line-through":d.style.textDecorationLine="line-through";break;case "SUP":case "SUB":if(1===d.childNodes.length&&"SPAN"===d.firstChild.nodeName){var f=c.createElement("div");f.appendChild(d);this.arrangeSpan(f);d=f.firstChild}var g=d.style["font-size"];if(!0===
fnObjectCheckNull(g)||""===g)g=a.parentNode.style["font-size"];!0===fnObjectCheckNull(g)||""===g?(g="SUP"===a.nodeName?parseFloat(dzeJ(a.parentNode).css("font-size")):parseFloat(dzeJ(a).css("font-size")),g*=.75):g=0<g.indexOf("pt")?parseFloat(g):.75*parseFloat(g);g=Math.round(g);var h=Math.round(.5*g);dzeJ(d).css({"font-size":h+"pt","vertical-align":"SUP"===b?h:"sub"}).attr("origin_font_size",g);break;case "FONT":if(void 0!==a.size&&""!==a.size){var k=dzeJ(a).css("fontSize");0<k.indexOf("px")&&(k=
.75*parseFloat(k)+"pt");d.style.fontSize=k}void 0!==a.face&&""!==a.face&&(d.style.fontFamily=a.face);void 0!==a.color&&""!==a.color&&(d.style.color=a.color)}a.parentNode.insertBefore(d,a);a.parentNode.removeChild(a);return d}catch(l){dalert()}};this.imgEditClassList=["cropper-mode"];this.removeImageEdit=function(a){try{var c=this.imgEditClassList;if(a)for(var b=a.querySelectorAll(".dze_img_edit_mode"),d=0;d<b.length;d++){b[d].classList.remove("dze_img_edit_mode");for(var e=0;e<c.length;e++)for(var f=
a.querySelectorAll("."+c[e]),g=0;g<f.length;g++)f[g].parentNode.removeChild(f[g])}}catch(h){dalert(h)}};this.arrangeSpan=function(a){try{if(a){var c=function(a){return!a||!a.parentNode||a.id||startsWith(a.className,"dze")||g_objPropertyUtil.hasClass(a,["dze_shape_text_container","dze_shape_text_contents","paragraph","dze_shape_container","tabSpan"])?!0:!1},b=a.querySelectorAll("span");forEach(b,function(a,b){!1===c(b)&&this.arrangeStyleSpan(b)},this);b=a.querySelectorAll("span");forEach(b,function(a,
b){!1===c(b)&&this.mergeSpan(b)},this);b=a.querySelectorAll("span");forEach(b,function(a,b){if(!1===c(b))if(b.parentNode&&!b.firstChild)b.parentNode.removeChild(b);else{if(a=b.parentNode&&b.firstChild===b.lastChild)a=(a=b.firstChild)?8===a.nodeType||3===a.nodeType&&""===a.nodeValue:!1;a&&b.parentNode.removeChild(b)}},this);dzeUiConfig.bSupportNewsEditor||(b=a.querySelectorAll("span"),forEach(b,function(a,b){c(b)||this.arrangeSpanStyleForm(b)},this))}}catch(d){dalert(d)}};this.arrangeStyleSpan=function(a){try{var c=
function(a,b){try{if(a&&b){var c=parseStyle(b.getAttribute("style"));if(c){var d=a.style;Object.keys(c).forEach(function(a){var b=d[a];b&&""!==b||(d[a]=c[a])})}}}catch(p){dalert(p)}};if(a&&a.parentNode&&"SPAN"===a.nodeName&&!a.style.border&&a.ownerDocument)for(var b=g_objNodeUtil,d=a.firstChild,e=a=null,f=null;d;)a=d.nextSibling,e=d.parentNode,1===d.nodeType&&"SPAN"===d.nodeName&&(c(d,e),insertAfter(e,d),a&&(f=e.cloneNode(),b.moveNodesTo(f,a),insertAfter(d,f),b.onSplit(e,f)),this.removeSpan(e)),d=
a}catch(g){dalert(g)}};this.removeSpan=function(a){try{if(a&&!a.id&&!a.className){var c=a.parentNode;if(c&&a.ownerDocument){var b=g_objNodeUtil;a.firstChild?""===b.getAttribute(a,"style")&&b.removeAttribute(a,"style"):(c.removeChild(a),b.normalize(c))}}}catch(d){dalert(d)}};this.mergeSpan=function(a){try{if(a&&a.parentNode&&"SPAN"===a.nodeName){var c=a.ownerDocument;if(c){for(var b=g_objNodeUtil,d=null,e=null;a;){e=a.nextSibling;if(!e)break;if(1!==e.nodeType||"SPAN"!==e.nodeName)break;var f=e,g=a.cloneNode(!1),
h=f.cloneNode(!1),k=parseStyle(g.getAttribute("style")),l=parseStyle(h.getAttribute("style"));g.removeAttribute("style");h.removeAttribute("style");if(!g.isEqualNode(h)||(k||l)&&(!k&&l||k&&!l||!equalStyle(k,l)))break;d||(d=c.createDocumentFragment());b.moveNodesTo(d,e.firstChild);a.appendChild(d);b.normalize(a);e.parentNode.removeChild(e)}this.removeSpan(a)}}}catch(p){dalert(p)}};this.arrangeSpanStyleForm=function(a){try{var c=dzeJ(a);""===a.style.fontSize&&(a.style.fontSize=Math.round(.75*parseInt(c.css("font-size"),
10))+"pt");""===a.style.fontFamily&&(a.style.fontFamily=c.css("font-family"));""===a.style.fontWeight&&(a.style.fontWeight="700"===c.css("font-weight")||"bold"===c.css("font-weight")?"bold":"normal");""===a.style.fontStyle&&(a.style.fontStyle="italic"===c.css("font-style")?"italic":"normal");if(""===a.style.textDecoration){var b=c.css("text-decoration"),d="";-1<b.indexOf("underline")&&(d="underline");-1<b.indexOf("line-through")&&(d=(""!==d?" ":"")+"line-through");""===d&&(d="none");a.style.textDecoration=
d}""===a.style.letterSpacing&&(a.style.letterSpacing=Math.round(.75*parseInt(c.css("letter-spacing"),10))+"pt");""===a.style.color&&(a.style.color=c.css("color"));""===a.style.backgroundColor&&(a.style.backgroundColor=c.css("background-color"))}catch(e){dalert(e)}};this.arrangeList=function(a){try{var c=a.querySelectorAll("li");for(a=0;a<c.length;a++)""===c[a].style.color&&(c[a].style.color="rgb(0, 0, 0)")}catch(b){alert(b)}};this.addClassForAnchor=function(a){try{if(!0!==fnObjectCheckNull(a)){var c=
a.querySelectorAll("p, li, h1, h2, h3, h4, h5, h6");for(a=0;a<c.length;a++){var b=c[a];0<b.querySelectorAll("span.dze_shape_main").length&&(b.style.position="",g_objPropertyUtil.addClass(b,"dze_shape_anchor"))}}}catch(d){dalert(d)}};this.addStyleForAnchor=function(a){try{if(!0!==fnObjectCheckNull(a)){var c=a.querySelectorAll("p, li, h1, h2, h3, h4, h5, h6");for(a=0;a<c.length;a++){var b=c[a];0<b.querySelectorAll("span.dze_shape_main").length&&(b.style.position="relative");g_objPropertyUtil.removeClass(b,
"dze_shape_anchor")}}}catch(d){dalert(d)}}};
var g_objCodeDefine=new function(){this.arrTagDefine=null;this.ID_TAG_A=0;this.ID_TAG_ABBR=1;this.ID_TAG_ACRONYM=2;this.ID_TAG_ADDRESS=3;this.ID_TAG_APPLET=4;this.ID_TAG_AREA=5;this.ID_TAG_B=6;this.ID_TAG_BASE=7;this.ID_TAG_BASEFONT=8;this.ID_TAG_BDO=9;this.ID_TAG_BIG=10;this.ID_TAG_BLOCKQUOTE=11;this.ID_TAG_BODY=12;this.ID_TAG_BR=13;this.ID_TAG_BUTTON=14;this.ID_TAG_CAPTION=15;this.ID_TAG_CENTER=16;this.ID_TAG_CITE=17;this.ID_TAG_CODE=18;this.ID_TAG_COL=19;this.ID_TAG_COLGROUP=20;this.ID_TAG_DD=
21;this.ID_TAG_DEL=22;this.ID_TAG_DFN=23;this.ID_TAG_DIR=24;this.ID_TAG_DIV=25;this.ID_TAG_DL=26;this.ID_TAG_DT=27;this.ID_TAG_EM=28;this.ID_TAG_FIELDSET=29;this.ID_TAG_FONT=30;this.ID_TAG_FORM=31;this.ID_TAG_FRAME=32;this.ID_TAG_FRAMESET=33;this.ID_TAG_H1=34;this.ID_TAG_H2=35;this.ID_TAG_H3=36;this.ID_TAG_H4=37;this.ID_TAG_H5=38;this.ID_TAG_H6=39;this.ID_TAG_HEAD=40;this.ID_TAG_HR=41;this.ID_TAG_HTML=42;this.ID_TAG_I=43;this.ID_TAG_IFRAME=44;this.ID_TAG_IMG=45;this.ID_TAG_INPUT=46;this.ID_TAG_INS=
47;this.ID_TAG_ISINDEX=48;this.ID_TAG_KBD=49;this.ID_TAG_LABEL=50;this.ID_TAG_LEGEND=51;this.ID_TAG_LI=52;this.ID_TAG_LINK=53;this.ID_TAG_LISTING=54;this.ID_TAG_MAP=55;this.ID_TAG_MENU=56;this.ID_TAG_META=57;this.ID_TAG_NEXTID=58;this.ID_TAG_NOFRAMES=59;this.ID_TAG_NOSCRIPT=60;this.ID_TAG_OBJECT=61;this.ID_TAG_OL=62;this.ID_TAG_OPTGROUP=63;this.ID_TAG_OPTION=64;this.ID_TAG_P=65;this.ID_TAG_PARAM=66;this.ID_TAG_PLAINTEXT=67;this.ID_TAG_PRE=68;this.ID_TAG_Q=69;this.ID_TAG_RB=70;this.ID_TAG_RBC=71;this.ID_TAG_RP=
72;this.ID_TAG_RT=73;this.ID_TAG_RTC=74;this.ID_TAG_RUBY=75;this.ID_TAG_S=76;this.ID_TAG_SAMP=77;this.ID_TAG_SCRIPT=78;this.ID_TAG_SELECT=79;this.ID_TAG_SMALL=80;this.ID_TAG_SPAN=81;this.ID_TAG_STRIKE=82;this.ID_TAG_STRONG=83;this.ID_TAG_STYLE=84;this.ID_TAG_SUB=85;this.ID_TAG_SUP=86;this.ID_TAG_TABLE=87;this.ID_TAG_TBODY=88;this.ID_TAG_TD=89;this.ID_TAG_TEXTAREA=90;this.ID_TAG_TFOOT=91;this.ID_TAG_TH=92;this.ID_TAG_THEAD=93;this.ID_TAG_TITLE=94;this.ID_TAG_TR=95;this.ID_TAG_TT=96;this.ID_TAG_U=97;
this.ID_TAG_UL=98;this.ID_TAG_VAR=99;this.ID_TAG_XMP=100;this.ID_TAG_VIDEO=101;this.ID_TAG_UNKNOWN=102;this.CM_EMPTY=1;this.CM_HTML=2;this.CM_HEAD=4;this.CM_BLOCK=8;this.CM_INLINE=16;this.CM_LIST=32;this.CM_DEFLIST=64;this.CM_TABLE=128;this.CM_ROWGRP=256;this.CM_ROW=512;this.CM_FIELD=1024;this.CM_OBJECT=2048;this.CM_PARAM=4096;this.CM_FRAMES=8192;this.CM_HEADING=16384;this.CM_OPT=32768;this.CM_IMG=65536;this.CM_MIXED=131072;this.CM_NO_INDENT=262144;this.CM_OBSOLETE=524288;this.CM_NEW=1048576;this.CM_OMITST=
2097152;this.CM_VIDEO=4194304;this.arrAttrDefine=null;this.ID_ATTR_ABBR=0;this.ID_ATTR_ACCEPT=1;this.ID_ATTR_ACCEPT_CHARSET=2;this.ID_ATTR_ACCESSKEY=3;this.ID_ATTR_ACTION=4;this.ID_ATTR_ALIGN=5;this.ID_ATTR_ALINK=6;this.ID_ATTR_ALT=7;this.ID_ATTR_ARCHIVE=8;this.ID_ATTR_AXIS=9;this.ID_ATTR_BACKGROUND=10;this.ID_ATTR_BGCOLOR=11;this.ID_ATTR_BORDER=12;this.ID_ATTR_CELLPADDING=13;this.ID_ATTR_CELLSPACING=14;this.ID_ATTR_CHAR=15;this.ID_ATTR_CHAROFF=16;this.ID_ATTR_CHARSET=17;this.ID_ATTR_CHECKED=18;this.ID_ATTR_CITE=
19;this.ID_ATTR_CLASS=20;this.ID_ATTR_CLASSID=21;this.ID_ATTR_CLEAR=22;this.ID_ATTR_CODE=23;this.ID_ATTR_CODEBASE=24;this.ID_ATTR_CODETYPE=25;this.ID_ATTR_COLOR=26;this.ID_ATTR_COLS=27;this.ID_ATTR_COLSPAN=28;this.ID_ATTR_COMPACT=29;this.ID_ATTR_CONTENT=30;this.ID_ATTR_COORDS=31;this.ID_ATTR_DATA=32;this.ID_ATTR_DATETIME=33;this.ID_ATTR_DECLARE=34;this.ID_ATTR_DEFER=35;this.ID_ATTR_DIR=36;this.ID_ATTR_DISABLED=37;this.ID_ATTR_ENCODING=38;this.ID_ATTR_ENCTYPE=39;this.ID_ATTR_EVENT=40;this.ID_ATTR_FACE=
41;this.ID_ATTR_FOR=42;this.ID_ATTR_FRAME=43;this.ID_ATTR_FRAMEBORDER=44;this.ID_ATTR_HEADERS=45;this.ID_ATTR_HEIGHT=46;this.ID_ATTR_HREF=47;this.ID_ATTR_HREFLANG=48;this.ID_ATTR_HSPACE=49;this.ID_ATTR_HTTP_EQUIV=50;this.ID_ATTR_ID=51;this.ID_ATTR_ISMAP=52;this.ID_ATTR_LABEL=53;this.ID_ATTR_LANG=54;this.ID_ATTR_LANGUAGE=55;this.ID_ATTR_LINK=56;this.ID_ATTR_LONGDESC=57;this.ID_ATTR_MARGINHEIGHT=58;this.ID_ATTR_MARGINWIDTH=59;this.ID_ATTR_MAXLENGTH=60;this.ID_ATTR_MEDIA=61;this.ID_ATTR_METHOD=62;this.ID_ATTR_METHODS=
63;this.ID_ATTR_MULTIPLE=64;this.ID_ATTR_N=65;this.ID_ATTR_NAME=66;this.ID_ATTR_NOHREF=67;this.ID_ATTR_NORESIZE=68;this.ID_ATTR_NOSHADE=69;this.ID_ATTR_NOWRAP=70;this.ID_ATTR_OBJECT=71;this.ID_ATTR_ONBLUR=72;this.ID_ATTR_ONCHANGE=73;this.ID_ATTR_ONCLICK=74;this.ID_ATTR_ONDBLCLICK=75;this.ID_ATTR_ONFOCUS=76;this.ID_ATTR_ONKEYDOWN=77;this.ID_ATTR_ONKEYPRESS=78;this.ID_ATTR_ONKEYUP=79;this.ID_ATTR_ONLOAD=80;this.ID_ATTR_ONMOUSEDOWN=81;this.ID_ATTR_ONMOUSEMOVE=82;this.ID_ATTR_ONMOUSEOUT=83;this.ID_ATTR_ONMOUSEOVER=
84;this.ID_ATTR_ONMOUSEUP=85;this.ID_ATTR_ONRESET=86;this.ID_ATTR_ONSELECT=87;this.ID_ATTR_ONSUBMIT=88;this.ID_ATTR_ONUNLOAD=89;this.ID_ATTR_PROFILE=90;this.ID_ATTR_PROMPT=91;this.ID_ATTR_RBSPAN=92;this.ID_ATTR_READONLY=93;this.ID_ATTR_REL=94;this.ID_ATTR_REV=95;this.ID_ATTR_ROWS=96;this.ID_ATTR_ROWSPAN=97;this.ID_ATTR_RULES=98;this.ID_ATTR_SCHEME=99;this.ID_ATTR_SCOPE=100;this.ID_ATTR_SCROLLING=101;this.ID_ATTR_SDAFORM=102;this.ID_ATTR_SDAPREF=103;this.ID_ATTR_SDASUFF=104;this.ID_ATTR_SELECTED=105;
this.ID_ATTR_SHAPE=106;this.ID_ATTR_SIZE=107;this.ID_ATTR_SPAN=108;this.ID_ATTR_SRC=109;this.ID_ATTR_STANDBY=110;this.ID_ATTR_START=111;this.ID_ATTR_STYLE=112;this.ID_ATTR_SUMMARY=113;this.ID_ATTR_TABINDEX=114;this.ID_ATTR_TARGET=115;this.ID_ATTR_TEXT=116;this.ID_ATTR_TITLE=117;this.ID_ATTR_TYPE=118;this.ID_ATTR_URN=119;this.ID_ATTR_USEMAP=120;this.ID_ATTR_VALIGN=121;this.ID_ATTR_VALUE=122;this.ID_ATTR_VALUETYPE=123;this.ID_ATTR_VERSION=124;this.ID_ATTR_VLINK=125;this.ID_ATTR_VSPACE=126;this.ID_ATTR_WIDTH=
127;this.ID_ATTR_XML_LANG=128;this.ID_ATTR_XML_SPACE=129;this.ID_ATTR_XMLNS=130;this.ID_ATTR_UNKNOWN=131;this.initTagDefine=function(){try{this.arrTagDefine||(this.arrTagDefine=[],this.arrTagDefine[this.ID_TAG_A]=["a",16,0],this.arrTagDefine[this.ID_TAG_ABBR]=["abbr",16,0],this.arrTagDefine[this.ID_TAG_ACRONYM]=["acronym",16,0],this.arrTagDefine[this.ID_TAG_ADDRESS]=["address",8,0],this.arrTagDefine[this.ID_TAG_APPLET]=["applet",71696,0],this.arrTagDefine[this.ID_TAG_AREA]=["area",9,1],this.arrTagDefine[this.ID_TAG_B]=
["b",16,0],this.arrTagDefine[this.ID_TAG_BASE]=["base",5,0],this.arrTagDefine[this.ID_TAG_BASEFONT]=["basefont",17,1],this.arrTagDefine[this.ID_TAG_BDO]=["bdo",16,0],this.arrTagDefine[this.ID_TAG_BIG]=["big",16,0],this.arrTagDefine[this.ID_TAG_BLOCKQUOTE]=["blockquote",8,0],this.arrTagDefine[this.ID_TAG_BODY]=["body",2129922,0],this.arrTagDefine[this.ID_TAG_BR]=["br",17,0],this.arrTagDefine[this.ID_TAG_BUTTON]=["button",16,0],this.arrTagDefine[this.ID_TAG_CAPTION]=["caption",128,0],this.arrTagDefine[this.ID_TAG_CENTER]=
["center",8,0],this.arrTagDefine[this.ID_TAG_CITE]=["cite",16,0],this.arrTagDefine[this.ID_TAG_CODE]=["code",16,0],this.arrTagDefine[this.ID_TAG_COL]=["col",129,0],this.arrTagDefine[this.ID_TAG_COLGROUP]=["colgroup",32896,0],this.arrTagDefine[this.ID_TAG_DD]=["dd",294976,0],this.arrTagDefine[this.ID_TAG_DEL]=["del",131096,0],this.arrTagDefine[this.ID_TAG_DFN]=["dfn",16,0],this.arrTagDefine[this.ID_TAG_DIR]=["dir",524296,0],this.arrTagDefine[this.ID_TAG_DIV]=["div",8,0],this.arrTagDefine[this.ID_TAG_DL]=
["dl",8,0],this.arrTagDefine[this.ID_TAG_DT]=["dt",294976,0],this.arrTagDefine[this.ID_TAG_EM]=["em",16,0],this.arrTagDefine[this.ID_TAG_FIELDSET]=["fieldset",8,0],this.arrTagDefine[this.ID_TAG_FONT]=["font",16,0],this.arrTagDefine[this.ID_TAG_FORM]=["form",8,1],this.arrTagDefine[this.ID_TAG_FRAME]=["frame",8193,0],this.arrTagDefine[this.ID_TAG_FRAMESET]=["frameset",8194,0],this.arrTagDefine[this.ID_TAG_H1]=["h1",16392,0],this.arrTagDefine[this.ID_TAG_H2]=["h2",16392,0],this.arrTagDefine[this.ID_TAG_H3]=
["h3",16392,0],this.arrTagDefine[this.ID_TAG_H4]=["h4",16392,0],this.arrTagDefine[this.ID_TAG_H5]=["h5",16392,0],this.arrTagDefine[this.ID_TAG_H6]=["h6",16392,0],this.arrTagDefine[this.ID_TAG_HEAD]=["head",2129922,0],this.arrTagDefine[this.ID_TAG_HR]=["hr",9,0],this.arrTagDefine[this.ID_TAG_HTML]=["html",2129922,0],this.arrTagDefine[this.ID_TAG_I]=["i",16,0],this.arrTagDefine[this.ID_TAG_IFRAME]=["iframe",16,0],this.arrTagDefine[this.ID_TAG_IMG]=["img",65553,1],this.arrTagDefine[this.ID_TAG_INPUT]=
["input",65553,0],this.arrTagDefine[this.ID_TAG_INS]=["ins",131096,0],this.arrTagDefine[this.ID_TAG_ISINDEX]=["isindex",9,0],this.arrTagDefine[this.ID_TAG_KBD]=["kbd",16,0],this.arrTagDefine[this.ID_TAG_LABEL]=["label",16,0],this.arrTagDefine[this.ID_TAG_LEGEND]=["legend",16,0],this.arrTagDefine[this.ID_TAG_LI]=["li",294944,0],this.arrTagDefine[this.ID_TAG_LINK]=["link",5,1],this.arrTagDefine[this.ID_TAG_LISTING]=["listing",524296,0],this.arrTagDefine[this.ID_TAG_MAP]=["map",16,1],this.arrTagDefine[this.ID_TAG_MENU]=
["menu",524296,0],this.arrTagDefine[this.ID_TAG_META]=["meta",5,1],this.arrTagDefine[this.ID_TAG_NEXTID]=["nextid",5,0],this.arrTagDefine[this.ID_TAG_NOFRAMES]=["noframes",8200,0],this.arrTagDefine[this.ID_TAG_NOSCRIPT]=["noscript",131096,0],this.arrTagDefine[this.ID_TAG_OBJECT]=["object",71700,0],this.arrTagDefine[this.ID_TAG_OL]=["ol",8,0],this.arrTagDefine[this.ID_TAG_OPTGROUP]=["optgroup",33792,0],this.arrTagDefine[this.ID_TAG_OPTION]=["option",33792,0],this.arrTagDefine[this.ID_TAG_P]=["p",32776,
0],this.arrTagDefine[this.ID_TAG_PARAM]=["param",17,1],this.arrTagDefine[this.ID_TAG_PLAINTEXT]=["plaintext",524296,0],this.arrTagDefine[this.ID_TAG_PRE]=["pre",8,0],this.arrTagDefine[this.ID_TAG_Q]=["q",16,0],this.arrTagDefine[this.ID_TAG_RB]=["rb",16,0],this.arrTagDefine[this.ID_TAG_RBC]=["rbc",16,0],this.arrTagDefine[this.ID_TAG_RP]=["rp",16,0],this.arrTagDefine[this.ID_TAG_RT]=["rt",16,0],this.arrTagDefine[this.ID_TAG_RTC]=["rtc",16,0],this.arrTagDefine[this.ID_TAG_RUBY]=["ruby",16,0],this.arrTagDefine[this.ID_TAG_S]=
["s",16,0],this.arrTagDefine[this.ID_TAG_SAMP]=["samp",16,0],this.arrTagDefine[this.ID_TAG_SCRIPT]=["script",131100,1],this.arrTagDefine[this.ID_TAG_SELECT]=["select",1040,0],this.arrTagDefine[this.ID_TAG_SMALL]=["small",16,0],this.arrTagDefine[this.ID_TAG_SPAN]=["span",16,0],this.arrTagDefine[this.ID_TAG_STRIKE]=["strike",16,0],this.arrTagDefine[this.ID_TAG_STRONG]=["strong",16,0],this.arrTagDefine[this.ID_TAG_STYLE]=["style",4,1],this.arrTagDefine[this.ID_TAG_SUB]=["sub",16,0],this.arrTagDefine[this.ID_TAG_SUP]=
["sup",16,0],this.arrTagDefine[this.ID_TAG_TABLE]=["table",8,1],this.arrTagDefine[this.ID_TAG_TBODY]=["tbody",33152,0],this.arrTagDefine[this.ID_TAG_TD]=["td",295424,0],this.arrTagDefine[this.ID_TAG_TEXTAREA]=["textarea",1040,0],this.arrTagDefine[this.ID_TAG_TFOOT]=["tfoot",33152,0],this.arrTagDefine[this.ID_TAG_TH]=["th",295424,0],this.arrTagDefine[this.ID_TAG_THEAD]=["thead",33152,0],this.arrTagDefine[this.ID_TAG_TITLE]=["title",4,0],this.arrTagDefine[this.ID_TAG_TR]=["tr",32896,0],this.arrTagDefine[this.ID_TAG_TT]=
["tt",16,0],this.arrTagDefine[this.ID_TAG_U]=["u",16,0],this.arrTagDefine[this.ID_TAG_UL]=["ul",8,0],this.arrTagDefine[this.ID_TAG_VAR]=["var",16,0],this.arrTagDefine[this.ID_TAG_XMP]=["xmp",524296,0],this.arrTagDefine[this.ID_TAG_VIDEO]=["video",4194304,0])}catch(b){dalert(b)}};this.getTagDefineID=function(b,a){try{for(var c=this.ID_TAG_UNKNOWN;a<c;a++)if(this.arrTagDefine[a][0]==b)return a}catch(d){dalert(d)}return this.ID_TAG_UNKNOWN};this.nodeHasCM=function(b,a){try{return this.ID_TAG_UNKNOWN==
b.tagID?!1:0!=(this.arrTagDefine[b.tagID][1]&a)?!0:!1}catch(c){dalert(c)}return!1};this.initAttrDefine=function(){try{this.arrAttrDefine||(this.arrAttrDefine=[],this.arrAttrDefine[this.ID_ATTR_ABBR]=["abbr",0],this.arrAttrDefine[this.ID_ATTR_ACCEPT]=["accept",0],this.arrAttrDefine[this.ID_ATTR_ACCEPT_CHARSET]=["accept-charset",0],this.arrAttrDefine[this.ID_ATTR_ACCESSKEY]=["accesskey",0],this.arrAttrDefine[this.ID_ATTR_ACTION]=["action",0],this.arrAttrDefine[this.ID_ATTR_ALIGN]=["align",1],this.arrAttrDefine[this.ID_ATTR_ALINK]=
["alink",1],this.arrAttrDefine[this.ID_ATTR_ALT]=["alt",0],this.arrAttrDefine[this.ID_ATTR_ARCHIVE]=["archive",0],this.arrAttrDefine[this.ID_ATTR_AXIS]=["axis",0],this.arrAttrDefine[this.ID_ATTR_BACKGROUND]=["background",0],this.arrAttrDefine[this.ID_ATTR_BGCOLOR]=["bgcolor",1],this.arrAttrDefine[this.ID_ATTR_BORDER]=["border",1],this.arrAttrDefine[this.ID_ATTR_CELLPADDING]=["cellpadding",0],this.arrAttrDefine[this.ID_ATTR_CELLSPACING]=["cellspacing",0],this.arrAttrDefine[this.ID_ATTR_CHAR]=["char",
0],this.arrAttrDefine[this.ID_ATTR_CHAROFF]=["charoff",0],this.arrAttrDefine[this.ID_ATTR_CHARSET]=["charset",1],this.arrAttrDefine[this.ID_ATTR_CHECKED]=["checked",1],this.arrAttrDefine[this.ID_ATTR_CITE]=["cite",0],this.arrAttrDefine[this.ID_ATTR_CLASS]=["class",0],this.arrAttrDefine[this.ID_ATTR_CLASSID]=["classid",0],this.arrAttrDefine[this.ID_ATTR_CLEAR]=["clear",1],this.arrAttrDefine[this.ID_ATTR_CODE]=["code",0],this.arrAttrDefine[this.ID_ATTR_CODEBASE]=["codebase",0],this.arrAttrDefine[this.ID_ATTR_CODETYPE]=
["codetype",0],this.arrAttrDefine[this.ID_ATTR_COLOR]=["color",1],this.arrAttrDefine[this.ID_ATTR_COLS]=["cols",0],this.arrAttrDefine[this.ID_ATTR_COLSPAN]=["colspan",0],this.arrAttrDefine[this.ID_ATTR_COMPACT]=["compact",1],this.arrAttrDefine[this.ID_ATTR_CONTENT]=["content",0],this.arrAttrDefine[this.ID_ATTR_COORDS]=["coords",0],this.arrAttrDefine[this.ID_ATTR_DATA]=["data",0],this.arrAttrDefine[this.ID_ATTR_DATETIME]=["datetime",0],this.arrAttrDefine[this.ID_ATTR_DECLARE]=["declare",1],this.arrAttrDefine[this.ID_ATTR_DEFER]=
["defer",1],this.arrAttrDefine[this.ID_ATTR_DIR]=["dir",1],this.arrAttrDefine[this.ID_ATTR_DISABLED]=["disabled",1],this.arrAttrDefine[this.ID_ATTR_ENCODING]=["encoding",0],this.arrAttrDefine[this.ID_ATTR_ENCTYPE]=["enctype",1],this.arrAttrDefine[this.ID_ATTR_EVENT]=["event",0],this.arrAttrDefine[this.ID_ATTR_FACE]=["face",1],this.arrAttrDefine[this.ID_ATTR_FOR]=["for",0],this.arrAttrDefine[this.ID_ATTR_FRAME]=["frame",1],this.arrAttrDefine[this.ID_ATTR_FRAMEBORDER]=["frameborder",0],this.arrAttrDefine[this.ID_ATTR_HEADERS]=
["headers",0],this.arrAttrDefine[this.ID_ATTR_HEIGHT]=["height",0],this.arrAttrDefine[this.ID_ATTR_HREF]=["href",0],this.arrAttrDefine[this.ID_ATTR_HREFLANG]=["hreflang",0],this.arrAttrDefine[this.ID_ATTR_HSPACE]=["hspace",0],this.arrAttrDefine[this.ID_ATTR_HTTP_EQUIV]=["http-equiv",0],this.arrAttrDefine[this.ID_ATTR_ID]=["id",0],this.arrAttrDefine[this.ID_ATTR_ISMAP]=["ismap",1],this.arrAttrDefine[this.ID_ATTR_LABEL]=["label",0],this.arrAttrDefine[this.ID_ATTR_LANG]=["lang",1],this.arrAttrDefine[this.ID_ATTR_LANGUAGE]=
["language",1],this.arrAttrDefine[this.ID_ATTR_LINK]=["link",0],this.arrAttrDefine[this.ID_ATTR_LONGDESC]=["longdesc",0],this.arrAttrDefine[this.ID_ATTR_MARGINHEIGHT]=["marginheight",0],this.arrAttrDefine[this.ID_ATTR_MARGINWIDTH]=["marginwidth",0],this.arrAttrDefine[this.ID_ATTR_MAXLENGTH]=["maxlength",0],this.arrAttrDefine[this.ID_ATTR_MEDIA]=["media",0],this.arrAttrDefine[this.ID_ATTR_METHOD]=["method",1],this.arrAttrDefine[this.ID_ATTR_METHODS]=["methods",0],this.arrAttrDefine[this.ID_ATTR_MULTIPLE]=
["multiple",1],this.arrAttrDefine[this.ID_ATTR_N]=["n",0],this.arrAttrDefine[this.ID_ATTR_NAME]=["name",0],this.arrAttrDefine[this.ID_ATTR_NOHREF]=["nohref",1],this.arrAttrDefine[this.ID_ATTR_NORESIZE]=["noresize",1],this.arrAttrDefine[this.ID_ATTR_NOSHADE]=["noshade",1],this.arrAttrDefine[this.ID_ATTR_NOWRAP]=["nowrap",1],this.arrAttrDefine[this.ID_ATTR_OBJECT]=["object",0],this.arrAttrDefine[this.ID_ATTR_ONBLUR]=["onblur",0],this.arrAttrDefine[this.ID_ATTR_ONCHANGE]=["onchange",0],this.arrAttrDefine[this.ID_ATTR_ONCLICK]=
["onclick",0],this.arrAttrDefine[this.ID_ATTR_ONDBLCLICK]=["ondblclick",0],this.arrAttrDefine[this.ID_ATTR_ONFOCUS]=["onfocus",0],this.arrAttrDefine[this.ID_ATTR_ONKEYDOWN]=["onkeydown",0],this.arrAttrDefine[this.ID_ATTR_ONKEYPRESS]=["onkeypress",0],this.arrAttrDefine[this.ID_ATTR_ONKEYUP]=["onkeyup",0],this.arrAttrDefine[this.ID_ATTR_ONLOAD]=["onload",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEDOWN]=["onmousedown",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEMOVE]=["onmousemove",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEOUT]=
["onmouseout",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEOVER]=["onmouseover",0],this.arrAttrDefine[this.ID_ATTR_ONMOUSEUP]=["onmouseup",0],this.arrAttrDefine[this.ID_ATTR_ONRESET]=["onreset",0],this.arrAttrDefine[this.ID_ATTR_ONSELECT]=["onselect",0],this.arrAttrDefine[this.ID_ATTR_ONSUBMIT]=["onsubmit",0],this.arrAttrDefine[this.ID_ATTR_ONUNLOAD]=["onunload",0],this.arrAttrDefine[this.ID_ATTR_PROFILE]=["profile",0],this.arrAttrDefine[this.ID_ATTR_PROMPT]=["prompt",0],this.arrAttrDefine[this.ID_ATTR_RBSPAN]=
["rbspan",0],this.arrAttrDefine[this.ID_ATTR_READONLY]=["readonly",1],this.arrAttrDefine[this.ID_ATTR_REL]=["rel",0],this.arrAttrDefine[this.ID_ATTR_REV]=["rev",0],this.arrAttrDefine[this.ID_ATTR_ROWS]=["rows",0],this.arrAttrDefine[this.ID_ATTR_ROWSPAN]=["rowspan",0],this.arrAttrDefine[this.ID_ATTR_RULES]=["rules",0],this.arrAttrDefine[this.ID_ATTR_SCHEME]=["scheme",0],this.arrAttrDefine[this.ID_ATTR_SCOPE]=["scope",1],this.arrAttrDefine[this.ID_ATTR_SCROLLING]=["scrolling",1],this.arrAttrDefine[this.ID_ATTR_SDAFORM]=
["sdaform",0],this.arrAttrDefine[this.ID_ATTR_SDAPREF]=["sdapref",0],this.arrAttrDefine[this.ID_ATTR_SDASUFF]=["sdasuff",0],this.arrAttrDefine[this.ID_ATTR_SELECTED]=["selected",1],this.arrAttrDefine[this.ID_ATTR_SHAPE]=["shape",1],this.arrAttrDefine[this.ID_ATTR_SIZE]=["size",0],this.arrAttrDefine[this.ID_ATTR_SPAN]=["span",0],this.arrAttrDefine[this.ID_ATTR_SRC]=["src",0],this.arrAttrDefine[this.ID_ATTR_STANDBY]=["standby",0],this.arrAttrDefine[this.ID_ATTR_START]=["start",0],this.arrAttrDefine[this.ID_ATTR_STYLE]=
["style",1],this.arrAttrDefine[this.ID_ATTR_SUMMARY]=["summary",0],this.arrAttrDefine[this.ID_ATTR_TABINDEX]=["tabindex",0],this.arrAttrDefine[this.ID_ATTR_TARGET]=["target",1],this.arrAttrDefine[this.ID_ATTR_TEXT]=["text",0],this.arrAttrDefine[this.ID_ATTR_TITLE]=["title",0],this.arrAttrDefine[this.ID_ATTR_TYPE]=["type",0],this.arrAttrDefine[this.ID_ATTR_URN]=["urn",0],this.arrAttrDefine[this.ID_ATTR_USEMAP]=["usemap",0],this.arrAttrDefine[this.ID_ATTR_VALIGN]=["valign",1],this.arrAttrDefine[this.ID_ATTR_VALUE]=
["value",0],this.arrAttrDefine[this.ID_ATTR_VALUETYPE]=["valuetype",1],this.arrAttrDefine[this.ID_ATTR_VERSION]=["version",0],this.arrAttrDefine[this.ID_ATTR_VLINK]=["vlink",0],this.arrAttrDefine[this.ID_ATTR_VSPACE]=["vspace",0],this.arrAttrDefine[this.ID_ATTR_WIDTH]=["width",0],this.arrAttrDefine[this.ID_ATTR_XML_LANG]=["xml:lang",0],this.arrAttrDefine[this.ID_ATTR_XML_SPACE]=["xml:space",0],this.arrAttrDefine[this.ID_ATTR_XMLNS]=["xmlns",0])}catch(b){dalert(b)}};this.getAttrDefineID=function(b,
a){try{for(var c=this.ID_ATTR_UNKNOWN;a<c;a++)if(this.arrAttrDefine[a][0]==b)return a}catch(d){dalert(d)}return this.ID_ATTR_UNKNOWN};this.getAttrDefineOption=function(b){try{return this.arrAttrDefine[b][1]}catch(a){dalert(a)}return 0}};
var g_objCodeStream=new function(){this.initStreamIn=function(a){try{var b={};b.htmlCode=a;b.next=0;b.size=a.length;return b}catch(c){dalert(c)}return null};this.initStreamOut=function(){return{lineString:[],lineBuffer:"",tabApply:!0,convertPTagToBrTag:!1,imgSrcRemoveDomain:null,anchorHrefRemoveDomainYN:!1}};this.endOfStreamIn=function(a){try{return a.stDocStreamIn.next>=a.stDocStreamIn.size}catch(b){dalert(b)}return!0};this.readChar=function(a){try{if(!g_objCodeStream.endOfStreamIn(a))return a.stDocStreamIn.htmlCode.charAt(a.stDocStreamIn.next++)}catch(b){dalert(b)}return null};
this.ungetChar=function(a){try{0<a.stDocStreamIn.next?a.stDocStreamIn.next--:a.stDocStreamIn.next=0}catch(b){dalert(b)}};this.getCharPos=function(a){try{return a.stDocStreamIn.next}catch(b){dalert(b)}};this.setCharPos=function(a,b){try{b.stDocStreamIn.next=a}catch(c){dalert(c)}}};
var g_objCodeLexer=new function(){this.LEX_CONTENT=0;this.LEX_GT=1;this.LEX_STARTTAG=2;this.LEX_ENDTAG=3;this.LEX_COMMENT=4;this.LEX_SECTION=5;this.LEX_CDATA=6;this.LEX_XML_DECLARE_START=7;this.NODE_TYPE_ROOT=0;this.NODE_TYPE_TEXT=1;this.NODE_TYPE_START=2;this.NODE_TYPE_START_END=3;this.NODE_TYPE_END=4;this.NODE_TYPE_COMMENT=5;this.NODE_TYPE_XML_DECLARE_START=6;this.NODE_TYPE_XML_DECLARE_START_END=7;this.NODE_TYPE_XML_DECLARE_END=8;this.ID_COMMENT_END_TAG="--\x3e";this.ID_SCRIPT_END_TAG="\x3c/script>";
this.ID_STYLE_END_TAG="</style>";this.ID_LOWER_CASE_LETTER_A=97;this.ID_LOWER_CASE_LETTER_B=98;this.ID_LOWER_CASE_LETTER_C=99;this.ID_LOWER_CASE_LETTER_D=100;this.ID_LOWER_CASE_LETTER_E=101;this.ID_LOWER_CASE_LETTER_F=102;this.ID_LOWER_CASE_LETTER_G=103;this.ID_LOWER_CASE_LETTER_H=104;this.ID_LOWER_CASE_LETTER_I=105;this.ID_LOWER_CASE_LETTER_J=106;this.ID_LOWER_CASE_LETTER_K=107;this.ID_LOWER_CASE_LETTER_L=108;this.ID_LOWER_CASE_LETTER_M=109;this.ID_LOWER_CASE_LETTER_N=110;this.ID_LOWER_CASE_LETTER_O=
111;this.ID_LOWER_CASE_LETTER_P=112;this.ID_LOWER_CASE_LETTER_Q=113;this.ID_LOWER_CASE_LETTER_R=114;this.ID_LOWER_CASE_LETTER_S=115;this.ID_LOWER_CASE_LETTER_T=116;this.ID_LOWER_CASE_LETTER_U=117;this.ID_LOWER_CASE_LETTER_V=118;this.ID_LOWER_CASE_LETTER_W=119;this.ID_LOWER_CASE_LETTER_X=120;this.ID_LOWER_CASE_LETTER_Y=121;this.ID_LOWER_CASE_LETTER_Z=122;this.initLexer=function(){try{var a={};a.state=this.LEX_CONTENT;a.sequence=-1;a.tagID=g_objCodeDefine.ID_TAG_UNKNOWN;a.tagName="";a.textStartPos=
-1;a.textEndPos=-1;a.attributeDelimiter=null;a.attributeStartPos=-1;a.attributeEndPos=-1;a.pushed=!1;a.emptyClosed=!1;a.compareEndTag="";a.token=null;return a}catch(b){dalert(b)}return null};this.newNode=function(a){try{var b={};b.sequence=a.stDocLexer.sequence++;b.type=this.NODE_TYPE_TEXT;b.closed=!1;b.tagID=g_objCodeDefine.ID_TAG_UNKNOWN;b.tagName="";b.textStartPos=-1;b.textEndPos=-1;b.parent=null;b.next=null;b.content=null;b.last=null;b.arrAttribute=null;b.print=!0;return b}catch(d){dalert(d)}return null};
this.newAttribute=function(a){try{var b={};b.sequence=a.stDocLexer.sequence++;b.attributeID=g_objCodeDefine.ID_ATTR_UNKNOWN;b.attributeName=null;b.delimiter=null;b.attributeStartPos=-1;b.attributeEndPos=-1;b.arrStyleAttribute=null;return b}catch(d){dalert(d)}return null};this.newStyleAttribute=function(){return{styleName:"",styleValue:""}};this.isWhite=function(a){try{var b=a.charCodeAt(0);if(10==b||13==b||32==b)return!0}catch(d){dalert(d)}return!1};this.isSpace=function(a){try{if(32==a.charCodeAt(0))return!0}catch(b){dalert(b)}return!1};
this.isLetter=function(a){try{var b=a.charCodeAt(0);if(65<=b&&90>=b||97<=b&&122>=b)return!0}catch(d){dalert(d)}return!1};this.isDigit=function(a){try{var b=a.charCodeAt(0);if(48<=b&&57>=b)return!0}catch(d){dalert(d)}return!1};this.isNamechar=function(a){try{if(this.isLetter(a)||this.isDigit(a))return!0;var b=a.charCodeAt(0);if(45==b||46==b||58==b||95==b)return!0}catch(d){dalert(d)}return!1};this.getToken=function(a){try{if(a.stDocLexer.pushed)return a.stDocLexer.pushed=!1,a.stDocLexer.token;a.stDocLexer.textStartPos=
-1;a.stDocLexer.textEndPos=-1;a.stDocLexer.emptyClosed=!1;a.stDocLexer.compareEndTag="";for(var b=null;null!=(b=g_objCodeStream.readChar(a));)switch(a.stDocLexer.state){case this.LEX_CONTENT:if(this.isWhite(b)){if(ID_KEYCODE_SPACE==b.charCodeAt(0)||10==b.charCodeAt(0)||13==b.charCodeAt(0))-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1;continue}if(ID_KEYCODE_TAB==
b.charCodeAt(0)&&a.stDocLexer.tagID!=g_objCodeDefine.ID_TAG_SPAN)continue;if("<"==b){a.stDocLexer.state=this.LEX_GT;continue}-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1;continue;case this.LEX_GT:if("/"==b){if(null==(b=g_objCodeStream.readChar(a))){g_objCodeStream.ungetChar(a);continue}if(this.isLetter(b)){a.stDocLexer.state=this.LEX_ENDTAG;g_objCodeStream.setCharPos(g_objCodeStream.getCharPos(a)-
2,a);if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}a.stDocLexer.state=this.LEX_CONTENT;continue}if("!"==b){if(null==(b=g_objCodeStream.readChar(a)))g_objCodeStream.ungetChar(a);else if("-"==b)if(null==(b=g_objCodeStream.readChar(a)))g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a);
else if("-"==b){if(-1!=a.stDocLexer.textStartPos)return g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a),a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;a.stDocLexer.state=this.LEX_COMMENT;continue}else g_objCodeStream.ungetChar(a),g_objCodeStream.ungetChar(a);else if("["==b){a.stDocLexer.state=this.LEX_SECTION;
continue}else g_objCodeStream.ungetChar(a);g_objCodeStream.ungetChar(a);a.stDocLexer.state=this.LEX_CONTENT;continue}if("?"==b){g_objCodeStream.ungetChar(a);a.stDocLexer.state=this.LEX_XML_DECLARE_START;if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}if(this.isLetter(b)){a.stDocLexer.state=
this.LEX_STARTTAG;g_objCodeStream.setCharPos(g_objCodeStream.getCharPos(a)-2,a);if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token;continue}a.stDocLexer.state=this.LEX_CONTENT;continue;case this.LEX_XML_DECLARE_START:var d=null;b=this.parseTagName(!1,a);">"!=b&&("/"==b&&g_objCodeStream.ungetChar(a),d=
this.parseAttribute(!1,a));a.stDocLexer.token=this.newNode(a);a.stDocLexer.token.tagID=a.stDocLexer.tagID;a.stDocLexer.token.tagName=a.stDocLexer.tagName;a.stDocLexer.token.type=a.stDocLexer.emptyClosed?this.NODE_TYPE_XML_DECLARE_START_END:this.NODE_TYPE_XML_DECLARE_START;a.stDocLexer.token.arrAttribute=d;a.stDocLexer.state=this.LEX_CONTENT;return a.stDocLexer.token;case this.LEX_STARTTAG:return d=null,b=this.parseTagName(!0,a),">"!=b&&("/"==b&&g_objCodeStream.ungetChar(a),d=this.parseAttribute(!0,
a)),a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.tagID=a.stDocLexer.tagID,a.stDocLexer.token.tagName=a.stDocLexer.tagName,a.stDocLexer.token.type=g_objCodeDefine.ID_TAG_UNKNOWN==a.stDocLexer.tagID?"embed"==a.stDocLexer.tagName?this.NODE_TYPE_START_END:a.stDocLexer.emptyClosed?this.NODE_TYPE_START_END:this.NODE_TYPE_START:a.stDocLexer.emptyClosed?this.NODE_TYPE_START_END:this.NODE_TYPE_START,a.stDocLexer.token.arrAttribute=d,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token;case this.LEX_ENDTAG:b=
this.parseTagName(!0,a);a.stDocLexer.token=this.newNode(a);a.stDocLexer.token.tagID=a.stDocLexer.tagID;a.stDocLexer.token.tagName=a.stDocLexer.tagName;for(a.stDocLexer.token.type=this.NODE_TYPE_END;">"!=b&&null!=b;)b=g_objCodeStream.readChar(a);a.stDocLexer.state=this.LEX_CONTENT;return a.stDocLexer.token;case this.LEX_COMMENT:this.replaceCommentEndTag(b,a);if(this.ID_COMMENT_END_TAG==a.stDocLexer.compareEndTag)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_COMMENT,
a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos-2,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token;-1==a.stDocLexer.textStartPos?(a.stDocLexer.textStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.textEndPos=a.stDocLexer.textStartPos):a.stDocLexer.textEndPos=g_objCodeStream.getCharPos(a)-1}if(this.LEX_CONTENT==a.stDocLexer.state){if(-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=
this.NODE_TYPE_TEXT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.token}else if(this.LEX_COMMENT==a.stDocLexer.state&&-1!=a.stDocLexer.textStartPos)return a.stDocLexer.token=this.newNode(a),a.stDocLexer.token.type=this.NODE_TYPE_COMMENT,a.stDocLexer.token.textStartPos=a.stDocLexer.textStartPos,a.stDocLexer.token.textEndPos=a.stDocLexer.textEndPos,a.stDocLexer.state=this.LEX_CONTENT,a.stDocLexer.token}catch(e){dalert(e)}return null};
this.getCDATAToken=function(a,b){try{if(g_objCodeDefine.ID_TAG_SCRIPT!=a&&g_objCodeDefine.ID_TAG_STYLE!=a)return;b.stDocLexer.compareEndTag="";for(var d=null;null!=(d=g_objCodeStream.readChar(b));){this.replaceScriptStyleEndTag(d,a,b);if(g_objCodeDefine.ID_TAG_SCRIPT==a){if(this.ID_SCRIPT_END_TAG==b.stDocLexer.compareEndTag)return b.stDocLexer.token=this.newNode(b),b.stDocLexer.token.type=this.NODE_TYPE_TEXT,b.stDocLexer.token.textStartPos=b.stDocLexer.textStartPos,b.stDocLexer.token.textEndPos=b.stDocLexer.textEndPos-
8,b.stDocLexer.state=this.LEX_CONTENT,b.stDocLexer.token}else if(g_objCodeDefine.ID_TAG_STYLE==a&&this.ID_STYLE_END_TAG==b.stDocLexer.compareEndTag)return b.stDocLexer.token=this.newNode(b),b.stDocLexer.token.type=this.NODE_TYPE_TEXT,b.stDocLexer.token.textStartPos=b.stDocLexer.textStartPos,b.stDocLexer.token.textEndPos=b.stDocLexer.textEndPos-7,b.stDocLexer.state=this.LEX_CONTENT,b.stDocLexer.token;-1==b.stDocLexer.textStartPos?(b.stDocLexer.textStartPos=g_objCodeStream.getCharPos(b)-1,b.stDocLexer.textEndPos=
b.stDocLexer.textStartPos):b.stDocLexer.textEndPos=g_objCodeStream.getCharPos(b)-1}}catch(e){dalert(e)}return null};this.replaceCommentEndTag=function(a,b){try{3>b.stDocLexer.compareEndTag.length||(b.stDocLexer.compareEndTag=b.stDocLexer.compareEndTag.substring(1,3)),b.stDocLexer.compareEndTag+=a}catch(d){dalert(d)}};this.replaceScriptStyleEndTag=function(a,b,d){try{if(g_objCodeDefine.ID_TAG_SCRIPT==b||g_objCodeDefine.ID_TAG_STYLE==b){var e=0,g=d.stDocLexer.compareEndTag.length;g_objCodeDefine.ID_TAG_SCRIPT==
b?e=9:g_objCodeDefine.ID_TAG_STYLE==b&&(e=8);g<e||(d.stDocLexer.compareEndTag=d.stDocLexer.compareEndTag.substring(1,e));d.stDocLexer.compareEndTag+=a.toLowerCase()}}catch(h){dalert(h)}};this.ungetToken=function(a){try{a.stDocLexer.pushed=!0}catch(b){dalert(b)}};this.parseTagName=function(a,b){try{b.stDocLexer.tagName="";for(var d=null;null!=(d=g_objCodeStream.readChar(b))&&this.isNamechar(d);)b.stDocLexer.tagName+=d.toLowerCase();b.stDocLexer.tagID=a?this.findTagDefineID(b.stDocLexer.tagName):g_objCodeDefine.ID_TAG_UNKNOWN;
return d}catch(e){dalert(e)}return null};this.parseAttribute=function(a,b){try{for(var d=null;!g_objCodeStream.endOfStreamIn(b);){b.stDocLexer.attributeDelimiter=null;b.stDocLexer.attributeStartPos=-1;b.stDocLexer.attributeEndPos=-1;var e=this.parseAttributeName(b);if(null==e)break;null==d&&(d=[]);var g=d.length;d[g]=this.newAttribute(b);d[g].attributeName=e;d[g].attributeID=a?this.findAttrDefineID(e):g_objCodeDefine.ID_ATTR_UNKNOWN;this.parseAttributeValue(b);d[g].delimiter=b.stDocLexer.attributeDelimiter;
d[g].attributeStartPos=b.stDocLexer.attributeStartPos;d[g].attributeEndPos=b.stDocLexer.attributeEndPos;g_objCodeDefine.ID_ATTR_STYLE==d[g].attributeID&&b.bStyleAttribute&&this.parseStyleAttribute(b,d[g])}return d}catch(h){dalert(h)}return null};this.parseAttributeName=function(a){try{for(var b="",d=null;;){d=g_objCodeStream.readChar(a);if(null==d)return g_objCodeStream.ungetChar(a),null;if("/"==d){d=g_objCodeStream.readChar(a);if(">"==d)return a.stDocLexer.emptyClosed=!0,null;g_objCodeStream.ungetChar(a);
d="/";break}if(">"==d)return null;if(!this.isWhite(d))break}for(;;){if(null==d){g_objCodeStream.ungetChar(a);break}if("="==d||">"==d){g_objCodeStream.ungetChar(a);break}if(this.isWhite(d))break;b+=d.toLowerCase();d=g_objCodeStream.readChar(a)}return""==b?null:b}catch(e){dalert(e)}return null};this.parseAttributeValue=function(a){try{for(var b=null,d=null;;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(!this.isWhite(d))break}if("="!=d&&'"'!=d&&"'"!=d)g_objCodeStream.ungetChar(a);
else{for(;;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(!this.isWhite(d))break}for('"'==d||"'"==d?b=d:g_objCodeStream.ungetChar(a);;){d=g_objCodeStream.readChar(a);if(null==d){g_objCodeStream.ungetChar(a);break}if(null==b){if(">"==d){g_objCodeStream.ungetChar(a);break}if("/"==d){d=g_objCodeStream.readChar(a);if(">"==d){a.stDocLexer.emptyClosed=!0;g_objCodeStream.ungetChar(a);break}g_objCodeStream.ungetChar(a);c="/"}}else if(d==b)break;if(this.isWhite(d)&&null==
b)break;-1==a.stDocLexer.attributeStartPos?(a.stDocLexer.attributeStartPos=g_objCodeStream.getCharPos(a)-1,a.stDocLexer.attributeEndPos=a.stDocLexer.attributeStartPos):a.stDocLexer.attributeEndPos=g_objCodeStream.getCharPos(a)-1}a.stDocLexer.attributeDelimiter=b}}catch(e){dalert(e)}};this.parseStyleAttribute=function(a,b){try{var d=g_objCodeStream.getCharPos(a),e=b.attributeStartPos,g=b.attributeEndPos;g_objCodeStream.setCharPos(e,a);for(var h=null,l=!1,m=!1,n="",f="";e<=g;e++){var k=g_objCodeStream.readChar(a);
if(null==k)break;if(this.isWhite(k)){if(!l)continue;if(!this.isSpace(k))continue}":"==k?l?"background-image"==n.toLowerCase()||"background"==n.toLowerCase()?f+=k:-1!=f.toLowerCase().indexOf("url(")&&(f+=k):l=!0:"'"==k||'"'==k?l&&(f+=k,m=!m):";"==k?-1!=f.indexOf("&quot")?(f=f.replace("&quot","'"),m=!m):-1!=f.indexOf("&amp")?f=f.replace("&amp","&"):!0===m?f+=k:(l=!1,null==h&&(h=[]),h[h.length]=this.addStyleAttribute(a,n,f),f=n="",m=!1):l?f+=k:n+=k}l&&(null==h&&(h=[]),h[h.length]=this.addStyleAttribute(a,
n,f));b.arrStyleAttribute=h;g_objCodeStream.setCharPos(d,a)}catch(p){dalert(p)}};this.addStyleAttribute=function(a,b,d){try{var e=this.newStyleAttribute();e.styleName=b.toLowerCase();e.styleValue=d;return e}catch(g){dalert(g)}};this.findTagDefineID=function(a){try{switch(a.charCodeAt(0)){case this.ID_LOWER_CASE_LETTER_A:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_A);case this.ID_LOWER_CASE_LETTER_B:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_B);case this.ID_LOWER_CASE_LETTER_C:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_CAPTION);case this.ID_LOWER_CASE_LETTER_D:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_DD);case this.ID_LOWER_CASE_LETTER_E:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_EM);case this.ID_LOWER_CASE_LETTER_F:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_FIELDSET);case this.ID_LOWER_CASE_LETTER_H:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_H1);case this.ID_LOWER_CASE_LETTER_I:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_I);case this.ID_LOWER_CASE_LETTER_K:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_KBD);case this.ID_LOWER_CASE_LETTER_L:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_LABEL);case this.ID_LOWER_CASE_LETTER_M:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_MAP);case this.ID_LOWER_CASE_LETTER_N:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_NEXTID);case this.ID_LOWER_CASE_LETTER_O:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_OBJECT);case this.ID_LOWER_CASE_LETTER_P:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_P);case this.ID_LOWER_CASE_LETTER_Q:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_Q);case this.ID_LOWER_CASE_LETTER_R:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_RB);case this.ID_LOWER_CASE_LETTER_S:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_S);case this.ID_LOWER_CASE_LETTER_T:return g_objCodeDefine.getTagDefineID(a,
g_objCodeDefine.ID_TAG_TABLE);case this.ID_LOWER_CASE_LETTER_U:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_U);case this.ID_LOWER_CASE_LETTER_V:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_VAR);case this.ID_LOWER_CASE_LETTER_X:return g_objCodeDefine.getTagDefineID(a,g_objCodeDefine.ID_TAG_XMP)}}catch(b){dalert(b)}return g_objCodeDefine.ID_TAG_UNKNOWN};this.findAttrDefineID=function(a){try{switch(a.charCodeAt(0)){case this.ID_LOWER_CASE_LETTER_A:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_ABBR);case this.ID_LOWER_CASE_LETTER_B:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_BACKGROUND);case this.ID_LOWER_CASE_LETTER_C:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_CELLPADDING);case this.ID_LOWER_CASE_LETTER_D:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_DATA);case this.ID_LOWER_CASE_LETTER_E:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_ENCODING);case this.ID_LOWER_CASE_LETTER_F:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_FACE);case this.ID_LOWER_CASE_LETTER_H:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_HEADERS);case this.ID_LOWER_CASE_LETTER_I:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_ID);case this.ID_LOWER_CASE_LETTER_L:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_LABEL);case this.ID_LOWER_CASE_LETTER_M:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_MARGINHEIGHT);case this.ID_LOWER_CASE_LETTER_N:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_N);case this.ID_LOWER_CASE_LETTER_O:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_OBJECT);case this.ID_LOWER_CASE_LETTER_P:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_PROFILE);case this.ID_LOWER_CASE_LETTER_R:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_RBSPAN);case this.ID_LOWER_CASE_LETTER_S:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_SCHEME);case this.ID_LOWER_CASE_LETTER_T:return g_objCodeDefine.getAttrDefineID(a,
g_objCodeDefine.ID_ATTR_TABINDEX);case this.ID_LOWER_CASE_LETTER_U:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_URN);case this.ID_LOWER_CASE_LETTER_V:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_VALIGN);case this.ID_LOWER_CASE_LETTER_W:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_WIDTH);case this.ID_LOWER_CASE_LETTER_X:return g_objCodeDefine.getAttrDefineID(a,g_objCodeDefine.ID_ATTR_XML_LANG)}}catch(b){dalert(b)}return g_objCodeDefine.ID_ATTR_UNKNOWN}};
var g_objCodeParser=new function(){this.bTrim=!0;this.convertXHTMLCode=function(c){try{var b=this.initParserStruct(c);if(!b)return c;this.parseBody(b.stDocRoot,b);g_objCodePrint.printTree(b.stDocRoot,0,b);0<b.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,b);for(var a="",d=0;d<b.stDocStreamOut.lineString.length;d++)checkTextNodeAllWhiteCode_Plus_Space(b.stDocStreamOut.lineString[d])||(b.stDocStreamOut.lineString[d]=b.stDocStreamOut.lineString[d].replace(/<span class="tabSpan"><\/span>/g,
'<span class="tabSpan">\t</span>'),a+=this.getConvertPreViewLineString(b.stDocStreamOut.lineString[d]),this.bTrim||(a+="\r\n"));return a}catch(e){dalert(e)}return c};this.removeVideoControl=function(c){try{var b=this.initParserStruct(c);if(!b)return c;this.parseBody(b.stDocRoot,b);g_objCodePrint.printTree(b.stDocRoot,0,b);0<b.stDocStreamOut.lineBuffer.length&&g_objCodePrint.addLineString(0,b);for(var a="",d=0;d<b.stDocStreamOut.lineString.length;d++)checkTextNodeAllWhiteCode_Plus_Space(b.stDocStreamOut.lineString[d])||
(a+=this.getConvertEditViewLineString(b.stDocStreamOut.lineString[d]),this.bTrim||(a+="\r\n"));return a}catch(e){dalert(e)}return c};this.getConvertPreViewLineString=function(c){try{return g_bBrowserType_IE&&0<=c.search("<video")&&(c=c.replace(">"," controls>")),c}catch(b){dalert(b)}};this.getConvertEditViewLineString=function(c){try{return g_bBrowserType_IE&&0<=c.search("<video")&&(c=c.replace('controls=""',""),c=c.replace("controls","")),c}catch(b){dalert(b)}};this.initParserStruct=function(c){try{var b=
{stDocRoot:null,stDocStreamIn:null,stDocStreamOut:null,stDocLexer:null,bStyleAttribute:!0};g_objCodeDefine.initTagDefine();g_objCodeDefine.initAttrDefine();b.stDocStreamIn=g_objCodeStream.initStreamIn(c);if(!b.stDocStreamIn)return null;b.stDocStreamOut=g_objCodeStream.initStreamOut();if(b.stDocStreamOut)b.stDocStreamOut.tabApply=g_bContentXHTMLTabSettingYN,b.stDocStreamOut.convertPTagToBrTag=g_bConvertPTagToBrTag,null!=g_arrImgSrcRemoveDomain&&0<g_arrImgSrcRemoveDomain.length&&(b.stDocStreamOut.imgSrcRemoveDomain=
g_arrImgSrcRemoveDomain,b.stDocStreamOut.anchorHrefRemoveDomainYN=g_bAnchorHrefRemoveDomainYN);else return null;b.stDocLexer=g_objCodeLexer.initLexer();if(!b.stDocLexer)return null;b.stDocRoot=g_objCodeLexer.newNode(b);b.stDocRoot.type=g_objCodeLexer.NODE_TYPE_ROOT;return b}catch(a){dalert(a)}return null};this.parseBody=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));)g_objCodeLexer.NODE_TYPE_START==a.type?(this.insertNodeAtEnd(c,a),g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY)?
this.parseEmpty(a,b):g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID?this.parseScriptStyle(a,b):g_objCodeDefine.ID_TAG_COLGROUP==a.tagID?this.parseColGroup(a,b):g_objCodeDefine.ID_TAG_TBODY==a.tagID||g_objCodeDefine.ID_TAG_TFOOT==a.tagID||g_objCodeDefine.ID_TAG_THEAD==a.tagID?this.parseRowGroup(a,b):this.parseTag(a,b)):g_objCodeLexer.NODE_TYPE_START_END==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_TEXT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_COMMENT==
a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type&&this.insertNodeAtEnd(c,a)}catch(d){dalert(d)}};this.parseTag=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}if(g_objCodeLexer.NODE_TYPE_END==a.type)for(var d=c.parent;null!=d;d=d.parent)if(a.tagID==d.tagID){g_objCodeLexer.ungetToken(b);return}g_objCodeLexer.NODE_TYPE_START==
a.type?(this.insertNodeAtEnd(c,a),g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY)?this.parseEmpty(a,b):g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID?this.parseScriptStyle(a,b):g_objCodeDefine.ID_TAG_COLGROUP==a.tagID?this.parseColGroup(a,b):g_objCodeDefine.ID_TAG_TBODY==a.tagID||g_objCodeDefine.ID_TAG_TFOOT==a.tagID||g_objCodeDefine.ID_TAG_THEAD==a.tagID?this.parseRowGroup(a,b):this.parseTag(a,b)):g_objCodeLexer.NODE_TYPE_START_END==a.type?this.insertNodeAtEnd(c,
a):g_objCodeLexer.NODE_TYPE_TEXT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_COMMENT==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type?this.insertNodeAtEnd(c,a):g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type&&this.insertNodeAtEnd(c,a)}}catch(e){dalert(e)}};this.parseEmpty=function(c,b){try{var a=g_objCodeLexer.getToken(b);a&&(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type?c.closed=!0:g_objCodeLexer.ungetToken(b))}catch(d){dalert(d)}};
this.parseScriptStyle=function(c,b){try{var a=g_objCodeLexer.getCDATAToken(c.tagID,b);a&&(this.insertNodeAtEnd(c,a),a=g_objCodeLexer.getToken(b))&&(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type?c.closed=!0:g_objCodeLexer.ungetToken(b))}catch(d){dalert(d)}};this.parseColGroup=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_TEXT==
a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_END!=a.type&&(g_objCodeLexer.NODE_TYPE_START==a.type||g_objCodeLexer.NODE_TYPE_START_END==a.type))if(g_objCodeDefine.ID_TAG_COL==a.tagID)this.insertNodeAtEnd(c,a);else{g_objCodeLexer.ungetToken(b);break}}}catch(d){dalert(d)}};this.parseRowGroup=function(c,b){try{for(var a;null!=(a=g_objCodeLexer.getToken(b));){if(c.tagID==a.tagID){if(g_objCodeLexer.NODE_TYPE_END==a.type){c.closed=!0;break}g_objCodeLexer.ungetToken(b);break}if(g_objCodeDefine.ID_TAG_TABLE==
a.tagID&&g_objCodeLexer.NODE_TYPE_END==a.type){g_objCodeLexer.ungetToken(b);break}if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_TEXT==a.type)this.insertNodeAtEnd(c,a);else if(g_objCodeLexer.NODE_TYPE_END!=a.type){if((g_objCodeLexer.NODE_TYPE_START==a.type||g_objCodeLexer.NODE_TYPE_START_END==a.type)&&g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_ROWGRP)){g_objCodeLexer.ungetToken(b);break}this.insertNodeAtEnd(c,a);this.parseTag(a,b)}}}catch(d){dalert(d)}};
this.insertNodeAtEnd=function(c,b){try{b.parent=c,null!=c.last?c.last.next=b:c.content=b,c.last=b}catch(a){dalert(a)}}};
var g_objCodePrint=new function(){this.bTrim=!0;this.printTree=function(a,b,c){try{if(null!=a)if(g_objCodeLexer.NODE_TYPE_ROOT==a.type)for(var d=a.content;null!=d;d=d.next)this.printTree(d,b,c);else if(g_objCodeLexer.NODE_TYPE_TEXT==a.type)this.printText(a,c);else if(g_objCodeLexer.NODE_TYPE_COMMENT==a.type)this.printComment(a,c);else if(g_objCodeLexer.NODE_TYPE_XML_DECLARE_START==a.type)this.printXMLDeclareStartTag(a,c);else if(g_objCodeLexer.NODE_TYPE_XML_DECLARE_START_END==a.type)this.printXMLDeclareStartEndTag(a,
c);else if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_EMPTY))g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)||this.addLineString(b-1,c),this.printStartEndTag(a,c),null!=a.next&&(g_objCodeDefine.ID_TAG_PARAM==a.tagID||g_objCodeDefine.ID_TAG_AREA==a.tagID?this.addLineString(b,c):(g_objCodeDefine.ID_TAG_BR==a.tagID||g_objCodeDefine.ID_TAG_HR==a.tagID)&&this.addLineString(b,c));else if(g_objCodeDefine.ID_TAG_LISTING==a.tagID||g_objCodeDefine.ID_TAG_PLAINTEXT==a.tagID||g_objCodeDefine.ID_TAG_PRE==
a.tagID||g_objCodeDefine.ID_TAG_XMP==a.tagID||g_objCodeDefine.ID_TAG_TEXTAREA==a.tagID){this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c);this.addLineString(b,c)}else if(g_objCodeDefine.ID_TAG_SCRIPT==a.tagID||g_objCodeDefine.ID_TAG_STYLE==a.tagID){this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c);this.addLineString(b,c)}else if(g_objCodeDefine.ID_TAG_UNKNOWN==
a.tagID&&"embed"==a.tagName)this.printStartEndTag(a,c);else if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)){this.printStartTag(a,c);if(g_objCodeDefine.ID_TAG_OBJECT==a.tagID){var e=[];for(d=a.content;null!=d;d=d.next)if(g_objCodeDefine.ID_TAG_PARAM==d.tagID){var f=this.getParamAttributeNameValue(d,c);this.addArrayParamAttributeNameValue(e,f)||this.printTree(d,b,c)}else this.printTree(d,b,c)}else for(d=a.content;null!=d;d=d.next)this.printTree(d,b,c);this.printEndTag(a,c)}else{e=b;this.checkTabApply(a,
c)&&e++;this.addLineString(b-1,c);this.printStartTag(a,c);for(d=a.content;null!=d;d=d.next)this.printTree(d,e,c);this.checkTabApply(a,c)&&this.addLineString(b,c);this.printEndTag(a,c);this.addLineString(b,c)}}catch(g){dalert(g)}};this.printText=function(a,b){try{b.stDocStreamOut.lineBuffer+=b.stDocStreamIn.htmlCode.substring(a.textStartPos,a.textEndPos+1)}catch(c){dalert(c)}};this.printComment=function(a,b){try{b.stDocStreamOut.lineBuffer+="\x3c!--",b.stDocStreamOut.lineBuffer+=b.stDocStreamIn.htmlCode.substring(a.textStartPos,
a.textEndPos+1),b.stDocStreamOut.lineBuffer+="--\x3e"}catch(c){dalert(c)}};this.printStartTag=function(a,b){try{if(a.print&&(g_objCodeDefine.ID_TAG_P!=a.tagID||!b.stDocStreamOut.convertPTagToBrTag||null!=a.arrAttribute)){b.stDocStreamOut.lineBuffer+="<"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=">"}}catch(d){dalert(d)}};this.getParamAttributeNameValue=function(a,b){try{if(g_objCodeDefine.ID_TAG_PARAM!=
a.tagID||null==a.arrAttribute)return null;for(var c=0;c<a.arrAttribute.length;c++){var d=a.arrAttribute[c];if(g_objCodeDefine.ID_ATTR_NAME==d.attributeID){var e=b.stDocStreamIn.htmlCode.substring(d.attributeStartPos,d.attributeEndPos+1);return e=e.toLowerCase()}}}catch(f){dalert(f)}return null};this.addArrayParamAttributeNameValue=function(a,b){try{for(var c=0;c<a.length;c++)if(a[c]==b)return!0;a[a.length]=b}catch(d){dalert(d)}return!1};this.printStartEndTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+=
"<"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" />"}}catch(d){dalert(d)}};this.printEndTag=function(a,b){try{a.print&&(g_objCodeDefine.ID_TAG_P==a.tagID&&b.stDocStreamOut.convertPTagToBrTag&&null==a.arrAttribute?-1==b.stDocStreamOut.lineBuffer.indexOf("<br />")&&(b.stDocStreamOut.lineBuffer+="<br",b.stDocStreamOut.lineBuffer+=" />"):b.stDocStreamOut.lineBuffer+="</"+a.tagName+">")}catch(c){dalert(c)}};
this.printAttribute=function(a,b,c){try{if(null!=b){var d=null==b.delimiter?'"':b.delimiter,e="";-1!=b.attributeStartPos&&(g_objCodeDefine.ID_ATTR_UNKNOWN==b.attributeID?e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1):g_objCodeDefine.ID_TAG_IMG==a.tagID&&g_objCodeDefine.ID_ATTR_SRC==b.attributeID&&null!=c.stDocStreamOut.imgSrcRemoveDomain?e=this.getAttributeValueByRemoveDomain(c,b):g_objCodeDefine.ID_TAG_A==a.tagID&&g_objCodeDefine.ID_ATTR_HREF==b.attributeID&&null!=
c.stDocStreamOut.imgSrcRemoveDomain&&1==c.stDocStreamOut.anchorHrefRemoveDomainYN?e=this.getAttributeValueByRemoveDomain(c,b):g_objCodeDefine.ID_TAG_TD==a.tagID&&g_objCodeDefine.ID_ATTR_VALIGN==b.attributeID?(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase(),"center"==e&&(e="middle")):g_objCodeDefine.ID_ATTR_STYLE==b.attributeID?c.bStyleAttribute?e=this.printStyleAttribute(b.arrStyleAttribute):(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+
1).toLowerCase(),-1!=e.indexOf("background")&&(e=c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1))):e=g_objCodeDefine.getAttrDefineOption(b.attributeID)?c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1).toLowerCase():c.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+1));c.stDocStreamOut.lineBuffer+=" "+b.attributeName+"="+d+e+d}}catch(f){dalert(f)}};this.printStyleAttribute=function(a){try{if(null==a)return"";for(var b="",
c=0;c<a.length;c++){var d=a[c];if(null!=d){var e=d.styleValue.trim();if(0>d.styleName.indexOf("background-image")&&(e=e.toLowerCase(),"border-image"==d.styleName&&"none"==e))continue;b+=d.styleName+":"+e+";"}}return b}catch(f){dalert(f)}return""};this.printXMLDeclareStartTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<?"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" ?>"}}catch(d){dalert(d)}};
this.printXMLDeclareStartEndTag=function(a,b){try{if(a.print){b.stDocStreamOut.lineBuffer+="<?"+a.tagName;if(null!=a.arrAttribute)for(var c=0;c<a.arrAttribute.length;c++)this.printAttribute(a,a.arrAttribute[c],b);b.stDocStreamOut.lineBuffer+=" />"}}catch(d){dalert(d)}};this.addLineString=function(a,b){try{0<b.stDocStreamOut.lineBuffer.length&&(b.stDocStreamOut.lineString[b.stDocStreamOut.lineString.length]=this.getTabString(a)+b.stDocStreamOut.lineBuffer,b.stDocStreamOut.lineBuffer="")}catch(c){dalert(c)}};
this.checkTabApply=function(a,b){try{if(!b.stDocStreamOut.tabApply||g_objCodeDefine.ID_TAG_UNKNOWN==a.tagID||g_objCodeDefine.ID_TAG_HTML==a.tagID||g_objCodeDefine.ID_TAG_TITLE==a.tagID||g_objCodeDefine.ID_TAG_P==a.tagID||g_objCodeDefine.ID_TAG_TEXTAREA==a.tagID||g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_HEADING))return!1;if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_FIELD|g_objCodeDefine.CM_OBJECT)||g_objCodeDefine.ID_TAG_MAP==a.tagID)return!0;if(null!=a.content&&g_objCodeDefine.nodeHasCM(a,
g_objCodeDefine.CM_NO_INDENT)){for(a=a.content;null!=a;a=a.next)if(g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_BLOCK))return!0;return!1}return!g_objCodeDefine.nodeHasCM(a,g_objCodeDefine.CM_INLINE)&&null!=a.content}catch(c){dalert(c)}return!1};this.getTabString=function(a){try{if(0>=a||this.bTrim)return"";for(var b="",c=0;c<a;c++)b+="\t";return b}catch(d){dalert(d)}return""};this.getAttributeValueByRemoveDomain=function(a,b){try{return a.stDocStreamIn.htmlCode.substring(b.attributeStartPos,b.attributeEndPos+
1)}catch(c){dalert(c)}return""}};
var g_objCssParser=new function(){this.LEX_START_CSS=11;this.LEX_CSS_COMMENT=12;this.initCssParserStruct=function(b){try{var a={stDocRoot:null,stDocStreamIn:null,stDocStreamOut:null,stDocLexer:null};a.stDocStreamIn=g_objCodeStream.initStreamIn(b);if(!a.stDocStreamIn)return null;a.stDocStreamOut=g_objCodeStream.initStreamOut();if(!a.stDocStreamOut)return null;a.stDocLexer=this.initCssLexer();if(!a.stDocLexer)return null;a.stDocRoot=this.newCssNode(a);a.stDocRoot.type=g_objCodeLexer.NODE_TYPE_ROOT;
return a}catch(c){dalert(c)}return null};this.initCssLexer=function(){try{var b={};b.state=g_objCodeLexer.LEX_CONTENT;b.sequence=-1;b.rowCssClassName="";b.rowCssClassContent="";b.token=null;return b}catch(a){dalert(a)}return null};this.newCssNode=function(b){try{var a={};a.sequence=b.stDocLexer.sequence++;a.type=g_objCodeLexer.NODE_TYPE_TEXT;a.arrCssClassName=null;a.arrCssClassAttribute=null;a.parent=null;a.next=null;a.content=null;a.last=null;return a}catch(c){dalert(c)}return null};this.parseCss=
function(b,a){try{for(var c;null!=(c=this.getCssToken(a));)g_objCodeLexer.NODE_TYPE_TEXT==c.type&&g_objCodeParser.insertNodeAtEnd(b,c)}catch(e){dalert(e)}};this.getCssToken=function(b){try{b.stDocLexer.rowCssClassName="";b.stDocLexer.rowCssClassContent="";for(var a=null;null!=(a=g_objCodeStream.readChar(b));)switch(b.stDocLexer.state){case g_objCodeLexer.LEX_CONTENT:if(this.isCheckWhite_Plus_Space(a))continue;if("<"==a){null!=(a=g_objCodeStream.readChar(b))&&("!"==a?null!=(a=g_objCodeStream.readChar(b))&&
("-"==a?null!=(a=g_objCodeStream.readChar(b))&&"-"!=a&&g_objCodeStream.ungetChar(b):g_objCodeStream.ungetChar(b)):g_objCodeStream.ungetChar(b));continue}if("/"==a){null!=(a=g_objCodeStream.readChar(b))&&("*"==a?null!=(a=g_objCodeStream.readChar(b))&&(b.stDocLexer.state=this.LEX_CSS_COMMENT):g_objCodeStream.ungetChar(b));continue}if("{"==a){b.stDocLexer.state=this.LEX_START_CSS;continue}else b.stDocLexer.rowCssClassName+=a;continue;case this.LEX_START_CSS:if("}"!=a)b.stDocLexer.rowCssClassContent+=
a;else return b.stDocLexer.token=this.newCssNode(b),b.stDocLexer.token.type=g_objCodeLexer.NODE_TYPE_TEXT,b.stDocLexer.token.arrCssClassName=this.getCssClassName(b.stDocLexer.rowCssClassName),b.stDocLexer.token.arrCssClassAttribute=this.getCssClassAttribute(b.stDocLexer.rowCssClassContent),b.stDocLexer.state=g_objCodeLexer.LEX_CONTENT,b.stDocLexer.token;continue;case this.LEX_CSS_COMMENT:if("*"==a&&null!=(a=g_objCodeStream.readChar(b))){if("/"==a)return b.stDocLexer.token=this.newCssNode(b),b.stDocLexer.token.type=
g_objCodeLexer.NODE_TYPE_COMMENT,b.stDocLexer.token.arrCssClassName=null,b.stDocLexer.token.arrCssClassAttribute=null,b.stDocLexer.state=g_objCodeLexer.LEX_CONTENT,b.stDocLexer.token;g_objCodeStream.ungetChar(b)}}}catch(c){dalert(c)}return null};this.getCssClassName=function(b){try{for(var a=[],c="",e=0;e<b.length;e++){var f=b.charAt(e);this.isCheckWhite_Plus_Space(f)||(","==f?(a.push(c),c=""):c+=f)}""!=c&&a.push(c);return a}catch(g){dalert(g)}return""};this.getCssClassAttribute=function(b){try{for(var a=
[],c=!1,e="",f="",g=!1,h=0;h<b.length;h++){var d=b.charAt(h);if(null==d)break;if(c){if(this.isCheckWhite(d))continue}else if(this.isCheckWhite_Plus_Space(d))continue;if('"'==d||"'"==d)g=g?!1:!0;":"==d?g?c?f+=d:e+=d:c=!0:";"==d?g?c?f+=d:e+=d:(c=!1,a[a.length]=g_objCodeLexer.addStyleAttribute(null,e,f),f=e=""):c?f+=d:e+=d}c&&(a[a.length]=g_objCodeLexer.addStyleAttribute(null,e,f));return a}catch(k){dalert(k)}return null};this.isCheckWhite=function(b){try{var a=b.charCodeAt(0);if(9==a||10==a||13==a)return!0}catch(c){dalert(c)}return!1};
this.isCheckWhite_Plus_Space=function(b){try{var a=b.charCodeAt(0);if(9==a||10==a||13==a||32==a)return!0}catch(c){dalert(c)}return!1}};
var g_strEditObjectName="dzeditor",g_strEditObjectSourceName="dzeditorSource",g_strEditContainerName="dzeditorContainer",g_strEditSourceContainerName="dzeditorSourceContainer",g_bInitWebEditor=!1,g_objEditObject=[],g_objEditWindow=[],g_objEditorDocument=[],g_objParent_EditObject=[],g_nActiveEditNumber=0,g_bLoadContentHTMLCode=!0,g_nLoadContentEditNumber=[],g_bLoadContentEncode=[],g_strLoadContentHTMLCode=[];function returnTrue(){return!0}function returnFalse(){return!1}
var g_nDomainAccessViolationCount=0;g_browserCHK.ie?document.attachEvent?document.attachEvent("onreadystatechange",fnLoadingEventFired):window.addEventListener("DOMContentLoaded",fnLoadingEventFired,!0):window.addEventListener("DOMContentLoaded",fnLoadingEventFired,!0);
function fnLoadingEventFired(){try{g_bBrowserType_IE?document.attachEvent?"complete"==document.readyState&&fnLoadEditor():"complete"==document.readyState?fnLoadEditor():window.setTimeout("fnLoadingEventFired()",100):fnLoadEditor()}catch(a){}}function fnLoadEditor(){try{g_bInitWebEditor||(g_bInitWebEditor=!0,initWebEditor())}catch(a){}}
function initWebEditor(){try{setBuildEditorArea();setInitConst();getDocumentType();setCustomVariable();setCustomDisplay();setSkinToolBar();g_objObjectSelectionInfo=new initSelectionObjectInfo;if(g_bBrowserType_IE){var a=!1,b;for(b in g_arrEditorAreaContainer)initEditAreaContainer(document.getElementById(g_arrEditorAreaContainer[b]),b);for(b in g_arrEditorAreaContainer)try{if(!fnSetEditObject(b))return}catch(d){a=!0}if(a){window.setTimeout("initWebEditor_Domain()",100);return}}else for(b in g_arrEditorAreaContainer)if(initEditAreaContainer(document.getElementById(g_arrEditorAreaContainer[b]),
b),!fnSetEditObject(b))return;for(b in g_arrEditorAreaContainer)if(!fnSetEditorMode(b))return;fnInitialize();if(!g_bLoadContentHTMLCode)for(b=0;b<g_nLoadContentEditNumber.length;b++)retrySetEditorHTMLCode(g_strLoadContentHTMLCode[b],g_bLoadContentEncode[b],g_nLoadContentEditNumber[b]);duzon_menubar.rebuildHiddenToolbar();window.setTimeout("fnSubInitializeLayer()",0);window.setTimeout("initializeLastSetting()",0)}catch(d){dalert(d)}}
function initWebEditor_Domain(){try{if(g_bBrowserType_IE&&!(5<g_nDomainAccessViolationCount)){var a=!1,b;for(b in g_arrEditorAreaContainer)try{if(!fnSetEditObject(b))return}catch(d){a=!0}if(a)g_nDomainAccessViolationCount++,window.setTimeout("initWebEditor_Domain()",100);else{for(b in g_arrEditorAreaContainer)if(!fnSetEditorMode(b))return;fnInitialize();if(!g_bLoadContentHTMLCode)for(b=0;b<g_nLoadContentEditNumber.length;b++)retrySetEditorHTMLCode(g_strLoadContentHTMLCode[b],g_bLoadContentEncode[b],
g_nLoadContentEditNumber[b]);duzon_menubar.rebuildHiddenToolbar();window.setTimeout("fnSubInitializeLayer()",0);window.setTimeout("initializeLastSetting()",0)}}}catch(d){dalert(d)}}
function setBuildEditorArea(){for(var a=document.getElementsByTagName("div"),b=0,d=-1,e=0;e<a.length;e++)a[e].getAttribute("dzeditor")&&"true"==a[e].getAttribute("dzeditor")&&(d++,a[e].removeAttribute("style"),dzeEnvConfig.iFrameLayer?(null!=window.frameElement.getAttribute("dzeditor_no")?b=parseInt(window.frameElement.getAttribute("dzeditor_no"),10):window.frameElement.setAttribute("dzeditor_no",b),a[e].id="DZEDITOR_CONTAINER_"+b,a[e].setAttribute("dzeload","true"),g_arrEditorAreaContainer[b]=a[e].id):
(a[e].getAttribute("id")||(a[e].id="DZEDITOR_CONTAINER_"+d),a[e].setAttribute("dzeload","true"),g_arrEditorAreaContainer.push(a[e].id)))}function setCustomVariable(){for(var a in g_arrEditorAreaContainer)g_arrEditorWidth[a]=dzeUiConfig.nEditorWidth,g_arrEditorHeight[a]=dzeUiConfig.nEditorHeight}
function fnSetEditObject(a){var b=parseInt(a,10)+DZE_IFRAME_TMP_NO;return g_bBrowserType_IE?(eval("g_objEditWindow["+a+"] = "+g_strEditObjectName+"_"+a),g_objEditorDocument[a]=g_objEditWindow[a].document,g_objEditObject[a]=document.getElementById(g_strEditObjectName+"_"+a),g_objParent_EditObject[a]=document.getElementById(g_strEditObjectName+"_Parent_"+a),eval("g_objEditWindow["+b+"] = "+g_strEditObjectName+"_"+b),g_objEditorDocument[b]=g_objEditWindow[b].document,g_objEditObject[b]=document.getElementById(g_strEditObjectName+
"_"+b),g_objParent_EditObject[b]=document.getElementById(g_strEditObjectName+"_Parent_"+b),!0):g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP?(g_objEditWindow[a]=document.getElementById(g_strEditObjectName+"_"+a).contentWindow,g_objEditorDocument[a]=document.getElementById(g_strEditObjectName+"_"+a).contentDocument,g_objEditObject[a]=document.getElementById(g_strEditObjectName+"_"+a),g_objParent_EditObject[a]=document.getElementById(g_strEditObjectName+"_Parent_"+a),g_objEditWindow[b]=document.getElementById(g_strEditObjectName+
"_"+b).contentWindow,g_objEditorDocument[b]=document.getElementById(g_strEditObjectName+"_"+b).contentDocument,g_objEditObject[b]=document.getElementById(g_strEditObjectName+"_"+b),g_objParent_EditObject[b]=document.getElementById(g_strEditObjectName+"_Parent_"+b),!0):!1}
function fnSetEditorMode(a){var b="",d="",e=objOnefficeLoader.getVer();g_bEnableEditHorizontalScroll||(b+="overflow-x:hidden;word-wrap:break-word;");!0===dzeUiConfig.bSetCustomEditorBodyMargin&&"undefined"!=typeof dzeUiConfig.nCustomEditorBodyMarginValues&&4==dzeUiConfig.nCustomEditorBodyMarginValues.length&&(b+="margin-top:"+dzeUiConfig.nCustomEditorBodyMarginValues[0]+"px;",b+="margin-bottom:"+dzeUiConfig.nCustomEditorBodyMarginValues[1]+"px;",b+="margin-left:"+dzeUiConfig.nCustomEditorBodyMarginValues[2]+
"px;",b+="margin-right:"+dzeUiConfig.nCustomEditorBodyMarginValues[3]+"px;");if(g_bBrowserType_IE){var c='<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><title></title>';g_bAutoIncludeParentCSS&&(c+=getParentCSS());for(var f=0;f<g_arrAdditionalEditAreaCSS.length;f++)c+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[f]+"'>";""!=g_strAdditionalHeadContent&&(c+=g_strAdditionalHeadContent);g_bAutoIncludeParentCSS?(c+="<link rel='stylesheet' href='"+g_strContentsCSS+
"?ver="+e+"'>",d=dzeEnvConfig.strPath_CSS+"editor_style_inherit.css?ver="+e):d=dzeEnvConfig.strPath_CSS+"editor_style.css?ver="+e;e=dzeUiConfig.nSettingPaperMargin.top+"mm "+dzeUiConfig.nSettingPaperMargin.right+"mm "+dzeUiConfig.nSettingPaperMargin.bottom+"mm "+dzeUiConfig.nSettingPaperMargin.left+"mm";c=c+("<link rel='stylesheet' href='"+d+"'>")+"<style type='text/css' media='print'>"+("@page{ size:auto; margin : "+e+"; }")+"</style>";c+="<style type='text/css' id='dze_selections'>";c+="::-moz-selection { background-color: rgba(95,128,215,0.3); } ::selection { background-color: rgba(95,128,215,0.3); }";
c+="</style>";c+=GetInitStyleString();c+="</head>";c+="<body style='"+b+"' contentEditable='false'>";c=window.attachEvent?c+"<p></p>":c+"<p><br/></p>";c+="</body>";c+="</html>";g_objEditorDocument[a].open();g_objEditorDocument[a].write(c);g_objEditorDocument[a].close()}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){c="<html><head>";c+='<meta http-equiv="content-type" content="text/html; charset=utf-8">';c+="<title></title>";g_bAutoIncludeParentCSS&&(c+=getParentCSS());for(f=0;f<
g_arrAdditionalEditAreaCSS.length;f++)c+="<link rel='stylesheet' href='"+g_arrAdditionalEditAreaCSS[f]+"'>";""!=g_strAdditionalHeadContent&&(c+=g_strAdditionalHeadContent);g_bAutoIncludeParentCSS?(c+="<link rel='stylesheet' href='"+g_strContentsCSS+"?ver="+e+"'>",d=dzeEnvConfig.strPath_CSS+"editor_style_inherit.css?ver="+e):d=dzeEnvConfig.strPath_CSS+"editor_style.css";e=dzeUiConfig.nSettingPaperMargin.top+"mm "+dzeUiConfig.nSettingPaperMargin.right+"mm "+dzeUiConfig.nSettingPaperMargin.bottom+"mm "+
dzeUiConfig.nSettingPaperMargin.left+"mm";c=c+("<link rel='stylesheet' href='"+d+"'>")+"<style type='text/css' media='print'>";c=c+("@page{ size:auto; margin : "+e+"; }")+"</style>";c+="<style type='text/css' id='dze_selections'>";c+="::-moz-selection { background-color: rgba(95,128,215,0.3); } ::selection { background-color: rgba(95,128,215,0.3); }";c+="</style>";c+=GetInitStyleString();c+="</head>";c+="<body style='"+b+"' contentEditable='false'>";c+="<p><br/></p>";c+="</body>";c+="</html>";g_objEditorDocument[a].open();
g_objEditorDocument[a].write(c);g_objEditorDocument[a].close()}else return!1;d&&("break-all"==dzeUiConfig.strEditorStyleBodyWordBreak||"keep-all"==dzeUiConfig.strEditorStyleBodyWordBreak)&&(b=g_objEditorDocument[a].querySelector("link[href='"+d+"']"))&&(b.onload=function(){changeCss("body","word-break",dzeUiConfig.strEditorStyleBodyWordBreak,g_objEditorDocument[a],d)});return!0}
function initToolbar(a){try{g_arrForceCancelBubbleMouseDown[a]=!1}catch(b){}TBInitContainer(document.getElementById("TB_CONTAINER_"+a));g_bTabBar_Display&&TBInitContainer(document.getElementById("TB_TABMODE_CONTAINER_"+a));!0===dzeUiConfig.bUseBottomStatusBar&&TBInitContainer(document.getElementById("ToolbarSetBottomStatusBar_"+a));g_bMenuBar_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_MENU_"+a));g_bToolBar1_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_1_"+
a));g_bToolBar2_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_2_"+a));g_bToolBar3_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TOOL_3_"+a));g_bTabBar_Display&&TBInitContainerTool(document.getElementById("TB_CONTAINER_TABMODE_"+a));g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_FILE_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_EDIT_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_VIEW_"+
a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_INSERT_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_BASIC_"+a),a);g_objMenuWin.TBInitMenuButton(document.getElementById("TB_MENU_TABLE_"+a),a);g_bToolBar1_Display&&TBSetToolButton(g_arrToolbar1,a);g_bToolBar2_Display&&TBSetToolButton(g_arrToolbar2,a);g_bToolBar3_Display&&TBSetToolButton(g_arrToolbar3,a);g_bTabBar_Display&&(g_arrTabBar[ID_DISPLAY_TABBAR_PREVIEW]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_PREVIEW_"+
a),ID_TB_TABMODE_PREVIEW,ID_STRING_NAME_UNCHECKED,a),g_arrTabBar[ID_DISPLAY_TABBAR_EDIT]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_EDIT_"+a),ID_TB_TABMODE_EDIT,ID_STRING_NAME_CHECKED,a),g_arrTabBar[ID_DISPLAY_TABBAR_SOURCE]&&TBInitTabModeButton(document.getElementById("TB_TABMODE_SOURCE_"+a),ID_TB_TABMODE_SOURCE,ID_STRING_NAME_UNCHECKED,a));g_bBottomResizeYN&&TBInitContainerBottomResize(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_"+a),a);dzeUiConfig.bCustomBottomResizeBtnYN&&
TBInitContainerBottomResizeBtn(document.getElementById("TB_CONTAINER_BOTTOM_RESIZE_BTN_"+a),a)}function initBranchEvent(a){initEditorEvent(a)}
function fnInitialize(){try{for(var a in g_arrEditorAreaContainer)setInitUpdateVariable(a),initEditSetContainer(document.getElementById("EDIT_SET_CONTAINER_"+a),a),initToolbar(a),initBranchEvent(a),setEditorContainerOutline(a),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,dzeUiConfig.nEditorHeight),!0===dzeUiConfig.bUseUiMode&&dze_menu_control.initialize(a),attachMouseDragDropEvent(a),initMenuImageLoad(a);initGlobalEvent();initCommand();fnMobileEditInit();initializeAnotherOption()}catch(b){}}
function fnMobileEditInit(){try{if(0!=dzeUiConfig.bMobileHybridEdit){var a=document.getElementById("EDIT_SET_CONTAINER_0");a&&a.rows.length&&(a.rows[a.rows.length-1].style.display="none")}}catch(b){dalert(b)}}
function fnSubInitializeLayer(){try{g_objCodeDefine.initTagDefine();if(g_bEditFocusYN){var a=0,b=-1,d;for(d in g_arrEditorAreaContainer)0==a&&(b=d),0<d&&window.setTimeout("editor_ondeactivate("+d+")",100),a++;0==b&&(g_bBrowserType_WK||g_bBrowserType_OP?(g_arrOnFocus_FF_WK[0]=!0,window.setTimeout("setEditModeFocus(0)",100)):(g_bBrowserType_FF&&(g_arrOnFocus_FF_WK[0]=!0,editor_onselectionchange(0)),setFirstEditWindowFocus(),g_bBrowserType_IE&&editor_onselectionchange(0)))}if(!dzeUiConfig||!dzeUiConfig.bOfficePagingMode)for(d in g_arrEditorAreaContainer)g_objUndoRedo.registerInitialContentStack(d)}catch(e){dalert(e)}}
function setFirstEditWindowFocus(){try{window.attachEvent?g_objEditWindow[0].focus():g_objEditorDocument[0].body.focus()}catch(a){}}
function initializeAnotherOption(){try{if(!g_bEditSourceMode)for(var a in g_arrEditorAreaContainer)fnTool_TabMode_Main(ID_TB_TABMODE_SOURCE,a);for(a in g_arrEditorAreaContainer){var b=document.getElementById("TB_SETFORECOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",b,a);var d=document.getElementById("TB_SETBACKCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#FFFFFF",d,a);var e=document.getElementById("TB_SETCELLBACKCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("",e,a);var c=document.getElementById("TB_SETIMAGEBORDERCOLOR_"+
a+"_SUB");duzon_dialog.selectColorCode("#000000",c,a);var f=document.getElementById("TB_SETTABLEBORDERCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",f,a);var g=document.getElementById("TB_HIGHLIGHTER_"+a+"_SUB");duzon_dialog.selectColorCode("#FFFFFF",g,a);var h=document.getElementById("TB_FILLCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#FFFFFF",h,a);var k=document.getElementById("TB_LINECOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#000000",k,a);var l=document.getElementById("TB_SETVIDEOBORDERCOLOR_"+
a+"_SUB");duzon_dialog.selectColorCode("#000000",l,a);var m=document.getElementById("TB_SHAPEFILLCOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#5B9BD5",m,a);var n=document.getElementById("TB_SHAPELINECOLOR_"+a+"_SUB");duzon_dialog.selectColorCode("#41719C",n,a)}}catch(p){}}
function initMenuImageLoad(a){try{var b=document.getElementById("TB_CONTAINER_"+a);if(b)if("undefined"==typeof IntersectionObserver){var d=b.querySelectorAll("img[_src]");forEach(d,function(a,b){if(a=b.getAttribute("_src"))b.removeAttribute("_src"),b.src=a})}else{var e=new IntersectionObserver(function(a,b){a.forEach(function(a){if(a.isIntersecting&&(a=a.target)){b.unobserve(a);var c=a.getAttribute("_src");c&&(a.removeAttribute("_src"),a.src=c)}})});d=b.querySelectorAll("img[_src]");forEach(d,function(a,
b){e.observe(b)})}}catch(c){dalert(c)}}
function initializeLastSetting(){try{if(0<=navigator.userAgent.toLowerCase().indexOf("dcloudbrowser")){g_bBrowserType_DCloud=!0;for(var a in g_arrEditorAreaContainer)0!=g_objParent_EditObject[a].clientHeight&&(g_objEditorDocument[a].body.style.minheight=g_objParent_EditObject[a].clientHeight-10+"px")}if(dzeEnvConfig.iFrameLayer){var b=g_objLayerKit.getLayerDocument();g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"menuwin.css",function(){"blue"!=dzeEnvConfig.skinColor&&g_objPropertyUtil.setSkinColorSet(dzeEnvConfig.skinColor,
b)});g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"dialog.css");g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"proplayer.css");g_objInsertUtil.dynamicLoad_CSS(b,dzeEnvConfig.strPath_CSS+"webeditor.css");g_objInsertUtil.dynamicLoad_JS(b,dzeEnvConfig.strPath_JS+"dze_iframe_function.js")}addParentScrollEvent();if(""!=dzeUiConfig.strLoadingDoneFunction)for(a in g_arrEditorAreaContainer)try{eval(dzeUiConfig.strLoadingDoneFunction+"("+a+");")}catch(d){}}catch(d){dalert(d)}}
function getParentCSS(){try{for(var a="",b=document.getElementsByTagName("link"),d=0,e=b.length;d<e;d++){var c=b[d];if("stylesheet"==c.rel.toLowerCase()){var f=!0,g=c.href;if(-1!=g.indexOf(dzeEnvConfig.strPath_CSS)||-1!=g.indexOf("oneffice_cloud.css"))f=!1;f&&getParentCSS_is_arrAdditionalEditAreaCSS(g)&&(f=!1);f&&(a+='<link rel="stylesheet" type="text/css" href="'+g+'" />')}}return a}catch(h){}return""}
function getParentCSS_is_arrAdditionalEditAreaCSS(a){try{for(var b=0;b<g_arrAdditionalEditAreaCSS.length;b++)if(-1!=a.indexOf(g_arrAdditionalEditAreaCSS[b]))return!0}catch(d){}return!1};
var g_objWrapperOutlineResize=new function(){this.objExtDragPosInfo=this.objExtSelectedInfo=null;this.resetExtOutlineInfo=function(a){try{"undefined"===typeof a&&(a=null),g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0),a&&a.shiftKey&&g_objWrapperOutlineResize.objExtSelectedInfo&&g_objWrapperOutlineResize.objExtSelectedInfo.nObjType===DZE_OBJ_IMG||this.resetExtOutlineInfo_call(),g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM]=!0,g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT]=
!0}catch(b){dalert(b)}};this.resetExtOutlineInfo_call=function(){try{this.objExtDragPosInfo=this.objExtSelectedInfo=null,g_objWrapperOutlineUtil.nExtOutlineRectPressedType=OUTLINE_INDICATOR.NONE,g_objWrapperOutlineUtil.showExtOutline(null,!1,!1,!1,-1),null!=g_objCropObj&&null!=g_objCropObj.cropObj&&(g_objCropObj.destroy(),g_objCropObj=null)}catch(a){dalert(a)}};this.newExtSelectedInfo=function(a,b){try{this.objExtSelectedInfo={};this.objExtSelectedInfo.nObjType=a;this.objExtSelectedInfo.objElement=
b;return}catch(c){dalert(c)}this.objExtSelectedInfo=null};this.newExtDragPosInfo=function(a,b,c){try{if(null==a)return null;this.objExtDragPosInfo={};this.objExtDragPosInfo.startPosXY=g_objPositionUtil.GetDocumentClientPos_XY(b);var f=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(a,c);this.objExtDragPosInfo.rcOrgArea=f;var h=a.style.width,k=a.style.height,g=a.offsetWidth,m=a.offsetHeight;a.style.width=f.right-f.left+"px";a.style.height=f.bottom-f.top+"px";var l=a.offsetWidth-g,e=a.offsetHeight-
m;a.style.width=h;a.style.height=k;this.objExtDragPosInfo.nDiff_X=l;this.objExtDragPosInfo.nDiff_Y=e;return}catch(d){dalert(d)}this.objExtDragPosInfo=null};this.resizePositionByDragForExtMode=function(a,b,c,f,h){try{if(OUTLINE_INDICATOR.NONE!=f&&null!=this.objExtDragPosInfo&&null!=b){var k=this.objExtDragPosInfo.startPosXY,g=g_objPositionUtil.GetDocumentClientPos_XY(c),m=g.nPos_X-k.nPos_X,l=g.nPos_Y-k.nPos_Y,e=g_objZoom.getDocZoomValue()/100;1!==e&&(m/=e,l/=e);var d=this.objExtDragPosInfo.rcOrgArea,
p=d.right-d.left,q=d.bottom-d.top;g=null;e=p;d=q;var n=c.shiftKey||b.hasAttribute("dze_image_no_proportion");switch(f){case OUTLINE_INDICATOR.LEFT:e-=m;n=!1;break;case OUTLINE_INDICATOR.RIGHT:e+=m;n=!1;break;case OUTLINE_INDICATOR.TOP:d-=l;n=!1;break;case OUTLINE_INDICATOR.BOTTOM:d+=l;n=!1;break;case OUTLINE_INDICATOR.LEFT_TOP:e-=m;d-=l;break;case OUTLINE_INDICATOR.RIGHT_BOTTOM:e+=m;d+=l;break;case OUTLINE_INDICATOR.RIGHT_TOP:e+=m;d-=l;break;case OUTLINE_INDICATOR.LEFT_BOTTOM:e-=m,d+=l}e=Math.max(parseInt(e,
10),0);d=Math.max(parseInt(d,10),0);c=e-p;f=d-q;var r=n?this.getRatioSize(k.nPos_X,k.nPos_Y,p,q,e,d):null;r&&(e=r.width,d=r.height,c=e-p,f=d-q);DZE_OBJ_TABLE===a?(g=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(b,h),c=e-g.width,f=d-g.height,g_objTableResize.doResizeTable(b,c,f)):DZE_OBJ_TD===a?(g=g_objPositionUtil.getElementPosInEditAreaWithScrollPos(b,h),c=e-g.width,f=d-g.height,c&&g_objTableResize.doResizeColFromCell(b,c),f&&g_objTableResize.doResizeRowFromCell(b,f)):this.resizeStyleWidthHeight(b,
0===c?!1:!0,e,0===f?!1:!0,d);g_objWrapperOutlineUtil.showExtOutline(b,!0,!0,!1,h)}}catch(t){dalert(t)}};this.resizeStyleWidthHeight=function(a,b,c,f,h){try{b&&0<=c&&(this.removeAttributeWidthHeight(a,!1,!0),a.style.width=c+"px"),f&&0<=h&&(this.removeAttributeWidthHeight(a,!0,!1),a.style.height=h+"px"),null!=g_objCropObj&&g_objCropObj.resize()}catch(k){dalert(k)}};this.removeAttributeWidthHeight=function(a,b,c){try{b&&a.removeAttribute("width"),c&&a.removeAttribute("height")}catch(f){dalert(f)}};this.afterResizeTargetElement=
function(a,b){try{null!=this.objExtSelectedInfo&&g_objUndoRedo.registerUndoRedoStack(0,b)}catch(c){dalert(c)}};this.getRatioSize=function(a,b,c,f,h,k){try{c/=f;var g=parseInt(h/c,10),m=g_objPositionUtil.dist(a,b,a+h,b+g),l=parseInt(k*c,10),e=g_objPositionUtil.dist(a,b,a+l,b+k);a={width:h,height:k};m>=e?(a.width=h,a.height=g):(a.width=l,a.height=k);a.width=Math.max(parseInt(a.width,10),0);a.height=Math.max(parseInt(a.height,10),0);return a}catch(d){dalert(d)}}};
var g_objUndoRedo=new function(){this.arrUndoRedoStruct=[];this.getRootNode=function(b){return g_objEditorDocument[b].body.querySelector("div.dze_document_container")};this.newUndoRedoStack=function(){try{var b={bKeyCodeContinue:!1};b.nLastKeyCode=ID_KEYCODE_NONE;b.nUndoRedoStackPos=-1;b.nUndoRedoStack_LastEventPos=-1;b.arrUndoRedoStack=[];return b}catch(a){dalert(a)}return null};this.initUndoRedoStack=function(b){try{var a=this.newUndoRedoStack();return a?this.arrUndoRedoStruct[b]=a:null}catch(c){dalert(c)}return null};
this.registerInitialContentStack=function(b){try{var a=null,c=this.initUndoRedoStack(b);c.nUndoRedoStackPos++;c.nUndoRedoStack_LastEventPos=c.nUndoRedoStackPos;var d=this.getUndoRedoData(b);a=this.getContentStack(b);c.arrUndoRedoStack[c.nUndoRedoStackPos]=[a,d]}catch(e){dalert(e)}};this.beforeRegister=function(b){try{oneffice.bModified=!0,g_objHeaderFooter.getHeaderFooterEditMode()&&!g_objHeaderFooter.isDoNotPropagate()&&g_objHeaderFooter.propagateHeaderFooter(-1,g_objPageControl.currentPage),g_objPasteOptionMenu.remove()}catch(a){dalert(a)}};
this.registerUndoRedoStack=function(b,a,c){try{var d=this.arrUndoRedoStruct[a];if(null!=d){var e=g_objShapeEvtMgr.getShapeTextContainer();if(null!==e){var f=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(e.parentNode));!1===fnObjectCheckNull(f)&&g_objWrapperOutlineUtil_Improved.updateShapeText(f,!1)}e=null;"undefined"!=typeof c&&null!=c&&(e=c);this.beforeRegister(a);d.nUndoRedoStackPos++;d.nUndoRedoStack_LastEventPos=
d.nUndoRedoStackPos;d.bKeyCodeContinue=!1;d.nLastKeyCode=ID_KEYCODE_NONE;var g=this.makeUndoRedoItem(a,e,b);d.arrUndoRedoStack[d.nUndoRedoStackPos]=g}}catch(h){dalert(h)}};this.registerUndoRedoItem=function(b,a){try{if(a){var c=this.arrUndoRedoStruct[b];null!=c&&(this.beforeRegister(b),c.nUndoRedoStackPos++,c.nUndoRedoStack_LastEventPos=c.nUndoRedoStackPos,c.bKeyCodeContinue=!1,c.nLastKeyCode=ID_KEYCODE_NONE,c.arrUndoRedoStack[c.nUndoRedoStackPos]=a)}}catch(d){dalert(d)}};this.makeUndoRedoItem=function(b,
a,c){try{var d=this.getContentStack(b),e=this.getUndoRedoData(b,a,c);return[d,e,a]}catch(f){dalert(f)}};this.getUndoRedoData=function(b,a,c){try{return a={},a.nCaseID=c||0,a.selection=this.getUndoRedoSelection(b),a.zoom=this.getUndoRedoZoomScroll(b),a.bCellSelected=GetMultiCellSelection(b),a.bg=this.getUndoRedoBG(b),a.hf=this.getUndoRedoHF(b),a.pageLayout=this.getUndoRedoPageLayout(b),a.pgNum=this.getPgNum(b),a.totalPageCount=g_objPageControl.getTotalPageCount(),a}catch(d){dalert(d)}};this.restoreUndoRedoData=
function(b,a){try{a&&(this.restoreHF(b,a.hf),this.restoreSelection(a.selection,b),this.restoreZoomScroll(b,a.zoom),this.restoreBG(b,a.bg),this.restoreCellSelection(b,a.bCellSelected),this.restorePageLayout(b,a.pageLayout),this.restorePgNum(b,a.pgNum),this.restoreOutLineSelection(b))}catch(c){dalert(c)}};this.getUndoRedoSelection=function(b){try{var a={};if(window.attachEvent){var c=g_objEditorDocument[b].selection,d=c.type;d=d.toLowerCase();if(ID_STRING_NAME_NONE==d||ID_STRING_NAME_TEXT==d){var e=
c.createRange(),f=e.parentElement(),g=this.getSelectionPos_IE(e,f,c);a.arrStartContainerPos=this.getNodePosition(b,f);a.arrEndContainerPos=null;a.posStartOffset=g.nStartRangePos;a.posEndOffset=g.nEndRangePos}}else{c=g_objEditWindow[b].getSelection();if(null==c)return a;1==c.rangeCount&&(e=c.getRangeAt(0),a.arrStartContainerPos=this.getNodePosition(b,e.startContainer),a.arrEndContainerPos=this.getNodePosition(b,e.endContainer),a.posStartOffset=this.getNodeOffset(e.startContainer,e.startOffset),a.posEndOffset=
this.getNodeOffset(e.endContainer,e.endOffset),g_bBrowserType_IE&&1===Math.abs(a.posEndOffset-a.posStartOffset)&&g_objCaretUtil.isComposing()&&(a.posStartOffset=a.posEndOffset))}return a}catch(h){dalert(h)}};this.getUndoRedoZoomScroll=function(b){try{var a={},c=0,d=g_objEditorDocument[b].getElementById("dze_document_main_container");c=d?d.scrollTop:0;a.scrollTop=c;a.docZoomValue=g_objZoom.getDocZoomValue();return a}catch(e){dalert(e)}};this.getUndoRedoBG=function(b){try{var a={};a.strBackgroundColor=
getBodyBackgroundColor(b);a.strBackgroundImageURL=g_objPropertyUtil.getBackgroundImageURL(g_objEditorDocument[b].body);a.strBackgroundImageRepeat=getBodyBackgroundRepeat(b);return a}catch(c){dalert(c)}};this.getUndoRedoHF=function(b){try{var a={};a.bHeaderFooterEditMode=g_objHeaderFooter.getHeaderFooterEditMode();a.headerfooter=g_objEditorDocument[b].createElement("dze_header_footer");g_objHeaderFooter.exportHeaderFooterAttribute(a.headerfooter);return a}catch(c){dalert(c)}};this.getUndoRedoPageLayout=
function(b){try{return b={},b.nSettingPaperSize=cloneSimpleObject(dzeUiConfig.nSettingPaperSize),b.nSettingPaperMargin=cloneSimpleObject(dzeUiConfig.nSettingPaperMargin),b.sSettingPaperColor=dzeUiConfig.sSettingPaperColor,b.bOfficeOnePageLongMode=dzeUiConfig.bOfficeOnePageLongMode,b}catch(a){dalert(a)}};this.getPgNum=function(b){try{return g_objPageNumber.clone()}catch(a){dalert(a)}};this.getContentStack=function(b){try{return this.getRootNode(b).innerHTML}catch(a){dalert(a)}return""};this.getPageContentsStack=
function(b,a){try{var c=g_objEditorDocument[b].getElementsByClassName("dze_page_container");b=[];if(-1==a)for(a=0;a<c.length;a++){var d={html:c[a].innerHTML,pageNum:a};b.push(d)}else{var e="";"undefined"!==typeof c[a]&&(e=c[a].innerHTML);d={html:e,pageNum:a};b.push(d)}return b}catch(f){dalert(f)}};this.operateUndoRedoStack=function(b,a,c,d){try{var e=this.arrUndoRedoStruct[c];if(!(null==e||-1>=e.nUndoRedoStackPos)){g_objWrapperOutlineResize.resetExtOutlineInfo();if(b){if(0==e.nUndoRedoStackPos)return;
e.nUndoRedoStackPos--;this.assignContentStack(b,e,c);a&&(e.nUndoRedoStack_LastEventPos=e.nUndoRedoStackPos)}else{if(e.nUndoRedoStack_LastEventPos<=e.nUndoRedoStackPos)return;e.nUndoRedoStackPos++;this.assignContentStack(b,e,c)}duzon_dialog.setEditorFocus();editor_onselectionchange(c);g_objShapeFunction.updateSelection(d);letterFunction.getInstance().changePasteStyleMode(!1);dzeUiConfig.bUseHeaderFooter&&(g_objHeaderFooter.setShowDocumentText(g_objHeaderFooter.bShowDocumentText),dze_menu_control.isShowMenu(dze_menu_control.idxHeaderFooterMenu)&&
dze_menu_control.setTBHeaderFooter(c));g_objPasteOptionMenu.remove();if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();0<g_objSelectedShapesArray.length&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES);b=g_objVideoControl;b.bClickPlayBtn&&b.convToImgAll(g_objEditorDocument[c].body);3!==checkKeyCodeType({keyCode:e.nLastKeyCode})&&(e.bKeyCodeContinue=!1,this.spliceArrUndoRedoStack(e))}}catch(f){dalert(f)}};this.assignContentStack=function(b,a,c){try{if(!(0>
a.nUndoRedoStackPos)){var d=a.arrUndoRedoStack[a.nUndoRedoStackPos],e=d[0],f=d[1];f.zoom&&(f.zoom.docZoomValueBeforeSetHTML=g_objZoom.getDocZoomValue());this.getRootNode(c).innerHTML=e;this.restoreUndoRedoData(c,f)}}catch(g){window.attachEvent?g_objEditorDocument[c].selection.empty():g_objEditWindow[c].getSelection().removeAllRanges(),dalert(g)}};this.restoreSelection=function(b,a){try{if(null==b.arrStartContainerPos){if(!window.attachEvent){var c=g_objEditWindow[a].getSelection();c.removeAllRanges()}}else if(window.attachEvent){c=
g_objEditorDocument[a].selection;var d=this.setNodePosition(a,b.arrStartContainerPos),e=c.createRange();e.moveToElementText(d);e.collapse(!0);e.moveStart("character",b.posStartOffset);e.moveEnd("character",b.posEndOffset-b.posStartOffset);e.select()}else{c=g_objEditWindow[a].getSelection();c.removeAllRanges();e=g_objEditorDocument[a].createRange();var f=this.setNodePosition(a,b.arrStartContainerPos);if(null!=f&&(dzeUiConfig.bOfficePagingMode&&g_objNodeUtil.getLoopHeaderFooterBody(f)||null!==g_objShapeEvtMgr.getShapeTextContainer())){var g=
this.setNodePosition(a,b.arrEndContainerPos);if(null!=g&&(dzeUiConfig.bOfficePagingMode&&g_objNodeUtil.getLoopHeaderFooterBody(g)||null!==g_objShapeEvtMgr.getShapeTextContainer())){if(f===g&&"BR"===f.nodeName)dalert(""),e.selectNode(f),e.collapse(!0);else try{e.setStart(f,b.posStartOffset),e.setEnd(g,b.posEndOffset)}catch(h){return}c.addRange(e)}}}}catch(h){dalert(h)}};this.restoreZoomScroll=function(b,a){try{if(a&&dzeUiConfig.bOfficePagingMode){var c=g_objZoom,d=c.getDocZoomValue();d===a.docZoomValue&&
d===a.docZoomValueBeforeSetHTML||c.zoomDocument(b,a.docZoomValue);var e=c.findElement("scroll",b);e&&(e.scrollTop=a.scrollTop)}}catch(f){dalert(f)}};this.restoreBG=function(b,a){try{if(a){var c=getBodyBackgroundColor(b);a.strBackgroundColor!=c&&setBodyBackgroundColor(docProperty.strBackgroundColor,b);var d=g_objPropertyUtil.getBackgroundImageURL(g_objEditorDocument[b].body);a.strBackgroundImageURL!=d&&setBodyBackgroundImage(docProperty.strBackgroundImageURL,b);var e=getBodyBackgroundRepeat(b);a.strBackgroundImageRepeat!=
e&&setBodyBackgroundRepeat(docProperty.strBackgroundImageRepeat,b)}}catch(f){dalert(f)}};this.restoreOutLineSelection=function(b){try{g_objWrapperOutlineUtil.initializeExtOutline(!1)}catch(a){dalert(a)}};this.restoreCellSelection=function(b,a){try{if(a){var c=g_objTableSelection,d=GetCurCell(b);if(!d||!c.isCellSelected(d)){var e=g_objEditorDocument[b].querySelectorAll("td[cusflag], th[cusflag]");forEach(e,function(a,b){c.deselectCell(b)})}}}catch(f){dalert(f)}};this.restoreHF=function(b,a){try{if(a){b=
g_objHeaderFooter;b.importHeaderFooterAttribute(a.headerfooter,!1);var c=a.bHeaderFooterEditMode;b.getHeaderFooterEditMode()!==c&&b.setHeaderFooterEditMode(c)}}catch(d){dalert(d)}};this.restorePageLayout=function(b,a){try{if(a){var c=!1,d=dzeUiConfig.nSettingPaperSize,e=a.nSettingPaperSize;if(d.width!==e.width||d.height!==e.height)dzeUiConfig.nSettingPaperSize=cloneSimpleObject(a.nSettingPaperSize),c=!0;var f=dzeUiConfig.nSettingPaperMargin,g=a.nSettingPaperMargin;if(f.top!==g.top||f.right!==g.right||
f.bottom!==g.bottom||f.left!==g.left||f.headerTop!==g.headerTop||f.footerBottom!==g.footerBottom)dzeUiConfig.nSettingPaperMargin=cloneSimpleObject(a.nSettingPaperMargin),c=!0;dzeUiConfig.bOfficeOnePageLongMode!==a.bOfficeOnePageLongMode&&(dzeUiConfig.bOfficeOnePageLongMode=a.bOfficeOnePageLongMode,c=!0);dzeUiConfig.sSettingPaperColor!==a.sSettingPaperColor&&(dzeUiConfig.sSettingPaperColor=a.sSettingPaperColor);c&&(g_objPageControl.updatePageLayoutVariables(),g_objHeaderFooter.setHeaderOverflowBlinderStyle(),
g_objPageControl.changeCssPageBreakAfter(b),setFirstQRPosition(b))}}catch(h){dalert(h)}};this.restorePgNum=function(b,a){try{a&&(b=g_objPageNumber,g_objPageNumber=a.clone(),b.equal(a)||g_objPageNumber.updateAll())}catch(c){dalert(c)}};this.getNodePosition=function(b,a){try{var c=[],d=this.getRootNode(b);for(b=-1;500>b;){b++;if(d===a)break;if(0===b&&3===a.nodeType&&0===a.nodeValue.length)a=g_objNodeUtil.getParentElement(a);else{var e=this.getNodePosition_previousSibling_By_textNode_Check(a);c.push(e);
a=g_objNodeUtil.getParentElement(a);if(!a)return null}}return c}catch(f){dalert(f)}};this.getNodePosition_previousSibling_By_textNode_Check=function(b){try{for(var a=0,c=b.nodeType;b.previousSibling;)if(b=b.previousSibling,c!==b.nodeType||3!==b.nodeType)a++,c=b.nodeType;return a}catch(d){dalert(d)}};this.getNodeOffset=function(b,a){try{if(!b||3!==b.nodeType)return a;for(var c=b.previousSibling;c&&3===c.nodeType;)a+=c.nodeValue.length,c=c.previousSibling;return a}catch(d){dalert(d)}};this.setNodePosition=
function(b,a){try{if(!a||!a.length)return null;for(var c=this.getRootNode(b),d=a.length;0<d;d--){c=c.firstChild;if(null==c)return null;for(b=0;b<a[d-1];)b++,c.nextSibling&&(c=c.nextSibling)}return c}catch(e){dalert(e)}};this.getSelectionPos_IE=function(b,a,c){try{var d=c.createRange();d.moveToElementText(a);if(!d.inRange(b))return{nStartRangePos:0,nEndRangePos:0};a=!0;""==b.text&&(a=!1);var e=b=0,f=!1,g=c.createRange();g.collapse(!0);g.moveEnd("character",1);var h=c.createRange();h.collapse(!1);h.moveStart("character",
-1);var k=c=0;d.collapse(!0);k=d.moveEnd("character",1);e+=k;if(0==k)return{nStartRangePos:0,nEndRangePos:0};for(;;){if(!f){var l=d.inRange(g),m=g.inRange(d);if(l||m)if(f=!0,!a)return{nStartRangePos:b,nEndRangePos:b}}if(f){l=d.inRange(h);var n=h.inRange(d);if(l||n)break}c=d.moveStart("character",1);f||(b+=c);k=d.moveEnd("character",1);e+=k;if(0==k)break}return{nStartRangePos:b,nEndRangePos:e}}catch(p){dalert(p)}return{nStartRangePos:0,nEndRangePos:0}};this.checkKeyCodeInput=function(b,a){try{var c=
this.arrUndoRedoStruct[a];if(null!=c){var d=function(b){var c=g_objUndoRedo.getUndoRedoData(a),d=g_objUndoRedo.getContentStack(a);b.arrUndoRedoStack[b.nUndoRedoStackPos]=[d,c]},e=document.getElementsByClassName("duzon_dialog");if(!(!1===fnObjectCheckNull(e)&&0<e.length)){var f=b.keyCode;isNavigationKeyCode(f)?(!0===c.bKeyCodeContinue&&d(c),c.bKeyCodeContinue=!1):DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)&&!1===b.altKey&&!1===b.shiftKey&&(ID_KEYCODE_V==f||ID_KEYCODE_Z==f||ID_KEYCODE_A==f||
ID_KEYCODE_C==f||ID_KEYCODE_Y==f||ID_KEYCODE_S==f)||b&&b.metaKey&&b.shiftKey&&f==ID_KEYCODE_Z&&g_browserCHK.m_AgentInfo.platform==PLATFORMTYPE.MAC_INTEL||91===f||92===f||93===f||(c.nLastKeyCode==f||f!=ID_KEYCODE_ENTER&&f!=ID_KEYCODE_SPACE&&f!=ID_KEYCODE_DELETE||(c.bKeyCodeContinue=!1),c.bKeyCodeContinue?d(c):g_objUndoRedo.getContentStack(a)!==c.arrUndoRedoStack[c.nUndoRedoStackPos][0]&&(g_objUndoRedo.registerUndoRedoStack(0,a),c.bKeyCodeContinue=!0),c.nLastKeyCode=f)}}}catch(g){dalert(g)}};this.setKeyCodeContinue=
function(b,a){try{var c=this.arrUndoRedoStruct[a];null!=c&&(c.bKeyCodeContinue=b)}catch(d){dalert(d)}};this.isKeyCodeContinue=function(b){try{var a=this.arrUndoRedoStruct[b];return null==a?void 0:a.bKeyCodeContinue}catch(c){dalert(c)}};this.setUndoSelection=function(b){var a=this.arrUndoRedoStruct[b];b=this.getUndoRedoSelection(b);a.arrUndoRedoStack[a.nUndoRedoStackPos][1].selection=b};this.spliceArrUndoRedoStack=function(b){if(b&&b.arrUndoRedoStack){var a=b.nUndoRedoStack_LastEventPos+1;b.arrUndoRedoStack.length>
a&&b.arrUndoRedoStack.splice(a)}}};
var g_strBlankImageName="blank.gif",g_strBlankImageData="data:image/gif;base64,R0lGODlhAQABAID/AMDAwAAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==",ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT=1,ID_DROPDOWN_LAYER_POSITION_TYPE_RIGHT=2;
function fnColorCellApply(b,c,e,a){try{var h=!0,f=!1,g=g_nActiveEditNumber;!1===fnObjectCheckNull(c)&&(h=c);if(window.attachEvent){SetActiveEditorArea(g);var d=g_objEditorDocument[g].selection;if(fnObjectCheckNull(d))return null;var k=d.type;k=k.toLowerCase();if(ID_STRING_NAME_NONE==k||ID_STRING_NAME_TEXT==k){var l=d.createRange();if(fnObjectCheckNull(l))return;f=letterFunction.getInstance().setSentenceStyle(e,b)}}else if(k=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==k||ID_STRING_NAME_TEXT==
k)f=letterFunction.getInstance().setSentenceStyle(e,b,0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer());!1!==h&&!0===f&&(!1===fnObjectCheckNull(a)&&"function"===typeof a?a(f):GetMultiCellSelection(g)?commonUpdateAfterChange(g,GetCurTable(g)):g_objUndoRedo.registerUndoRedoStack(0,g))}catch(m){dalert(m)}}
function checkObjectElemetMouseUp(b,c,e){try{if(!window.attachEvent){var a=g_objNodeUtil.getEventSrcElement(b),h=fnObjectCheckNull(e)?null:g_objNodeUtil.getEventSrcElement(e),f=a.ownerDocument;if(f){var g=f.defaultView;if(g){e=b=null;if(!fnObjectCheckNull(a)){var d=g_objNodeUtil.getElementTagName(a).toLowerCase();f=a.ownerDocument;g=f.defaultView;if(h&&a!=h)return;h=!0;if(dzeUiConfig.bUseLockEditCellFunction){var k=g_objNodeUtil.getLoopParentElement(a,"td");k&&k.contentEditable&&"false"==k.contentEditable.toLowerCase()&&
(h=!1)}k=g_objVideoControl;if(k.isVideo(a)||k.isVideoControl(a)){k.isVideoSpan(a.parentNode)&&(a=a.parentNode,d="span");setSelectionObjectInfo(!0,d,a);showExtOutline_ObjectElement(a,h,!1,c);e=f.createRange();e.selectNode(a);b=g.getSelection();b.removeAllRanges();b.addRange(e);setSelectionColor(c,"transparent");return}if("img"==d){setSelectionObjectInfo(!0,d,a);(g_bBrowserType_WK||g_bBrowserType_OP||g_bBrowserType_IE||g_bBrowserType_FF)&&showExtOutline_ObjectElement(a,h,!1,c);if(g_bBrowserType_WK||
g_bBrowserType_IE||g_bBrowserType_FF)b=g.getSelection(),b.removeAllRanges(),e=f.createRange(),e.selectNode(a),b.addRange(e),"img"==d&&setSelectionColor(c,"transparent");"img"===d&&!1===fnObjectCheckNull(a.getAttribute("chart_id"))&&!0===panelManager.getInstance().isShowPanel()&&(onefficeChart.makeCanvasChartToImage(a,c),panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_CHART));return}if("embed"==d||"object"==d){setSelectionObjectInfo(!0,d,a);(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)&&
showExtOutline_ObjectElement(a,h,!1,c);return}if("div"==d){if(g_bBrowserType_IE&&!g_objEditorDocument[c].queryCommandEnabled("Bold")){setSelectionObjectInfo(!0,d,a);return}}else{if("iframe"==d){setSelectionObjectInfo(!0,d,a);(g_bBrowserType_WK||g_bBrowserType_OP)&&showExtOutline_ObjectElement(a,h,!1,c);return}if("hr"==d){setSelectionObjectInfo(!0,d,a);showExtOutline_ObjectElement(a,!1,!1,c);b=g.getSelection();b.removeAllRanges();e=f.createRange();e.selectNode(a);b.addRange(e);return}if("input"==d){var l=
a.getAttribute("type");l=l?l.toLowerCase():"";"checkbox"==l&&setSelectionObjectInfo(!0,d,a);return}if("select"==d){setSelectionObjectInfo(!0,d,a);return}}}resetSelectionObjectInfo()}}}}catch(m){dalert(m)}finally{}}
function onKeyDownOnHR(b,c){try{var e=c?c.keyCode:0;if(isNavigationKeyCode(e)&&!DZESHORTCUT.isPressedKeyMapForOS(c,ID_KEYCODE_CTRL)&&!c.shiftKey&&!c.altKey){var a=g_objEditWindow[b],h=a?a.getSelection():null,f=h&&0<h.rangeCount?h.getRangeAt(0):null;if(f){var g=f.startContainer.childNodes[f.startOffset]||f.startContainer;if(!f.collapsed&&1===f.endOffset-f.startOffset&&g&&f.startContainer===f.endContainer&&"HR"===g.nodeName){b=!1;switch(e){case 33:case 34:case 36:case 37:case 38:b=!0}e=g_objNodeUtil;
var d=b?e.checkTagName(g.previousSibling,"hr"):e.checkTagName(g.nextSibling,"hr");if(d)dlog("selection change for hr"),f.selectNode(d),h.removeAllRanges(),h.addRange(f),TBCancelBubbleEvent(c);else{var k=getCaretNodeWalker(g),l=b?k.prevNode():k.nextNode();l||(l=b?k.nextNode():k.prevNode());l&&(g_objCaretUtil.moveCaret(l,!0,!b),TBCancelBubbleEvent(c))}}}}}catch(m){dalert(m)}finally{}}
function onKeyUpOnHR(b,c,e){try{var a=c?c.keyCode:0;if(c&&(isNavigationKeyCode(a)||a===ID_KEYCODE_DELETE||a===ID_KEYCODE_BACKSPACE)&&!c.modifierKey){var h=g_objEditWindow[b],f=h?h.getSelection():null,g=f&&0<f.rangeCount?f.getRangeAt(0):null;if(g){var d=g.startContainer.childNodes[g.startOffset]||g.startContainer,k=g.endOffset-g.startOffset;d&&(a=null,"HR"!==d.nodeName||0!==k&&1!==k?!g.collapsed||!d.previousSibling||"HR"!==d.previousSibling.nodeName||e&&"hr"===e.strNodeName||(a=d.previousSibling):
a=d,a&&(setSelectionObjectInfo(!0,"hr",a),showExtOutline_ObjectElement(a,!1,!1,b),dlog("selection change for hr"),g.selectNode(a),f.removeAllRanges(),f.addRange(g),TBCancelBubbleEvent(c)))}}}catch(l){dalert(l)}finally{}}function setSelectionObjectElemet(b,c){try{var e=g_objEditWindow[c].getSelection();e.removeAllRanges();var a=g_objEditorDocument[c].createRange();a.selectNode(b);e.addRange(a)}catch(h){}}
function showExtOutline_ObjectElement(b,c,e,a){try{var h=getObjType(b,a);DZE_OBJ_HR===h?c=!1:DZE_OBJ_VIDEO===h&&b&&("IMG"===b.nodeName||0<=g_objVideoControl.arrVideoNodeName.indexOf(b.nodeName))&&g_objVideoControl.isVideoSpan(b.parentNode)&&(b=b.parentNode);g_objWrapperOutlineResize.newExtSelectedInfo(h,b);g_objWrapperOutlineUtil.showExtOutline(b,!0,c,e,a)}catch(f){dalert(f)}}
function getSelectionElementNode(b){try{if(window.attachEvent)return null;var c=null;if(g_objObjectSelectionInfo.bSelectObject)c=g_objObjectSelectionInfo.objSelectionObject;else{var e=g_objEditWindow[b].getSelection().getRangeAt(0);c=e.startContainer.childNodes[e.startOffset]}return c}catch(a){}return null}var ID_USER_WARNING_MSG_SCRIPT=1,ID_USER_WARNING_MSG_NO_IFRAME=3,ID_USER_WARNING_MSG_NO_SOURCE_EDIT=4;
function fnUserMessage(b){"cut"==b?alert(ID_RES_USER_MSG_STRING_ALERT_CUT):"copy"==b?alert(ID_RES_USER_MSG_STRING_ALERT_COPY):"paste"==b&&alert(ID_RES_USER_MSG_STRING_ALERT_PASTE)}function fnUserWarningMessage(b){ID_USER_WARNING_MSG_SCRIPT==b?alert(ID_RES_USER_MSG_STRING_WARNING_SCRIPT):ID_USER_WARNING_MSG_NO_IFRAME==b?alert(ID_RES_USER_MSG_STRING_WARNING_NO_IFRAME):ID_USER_WARNING_MSG_NO_SOURCE_EDIT==b&&alert(ID_RES_USER_MSG_STRING_WARNING_NO_SOURCE_EDIT)};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objPageEditable=new function(){this.orgPageEditable={};this.startRange=this.startPageNum=null;this.bInitFunc=this.bMouseDownOnSelection=this.bRangeControl=!1;this.onMouseUp=this.onMouseMove=null;this.initFunc=function(){this.bInitFunc||(g_bBrowserType_IE?(this.onMouseMove=this.onMouseMoveForIE,this.onMouseUp=this.onMouseUpForIE):g_bBrowserType_CR&&(this.onMouseMove=this.onMouseMoveForCR,this.onMouseUp=this.onMouseUpForCR),this.bInitFunc=!0)};this.init=function(){this.startRange=this.startPageNum=
null;this.bMouseDownOnSelection=this.bRangeControl=!1};this.setPageEditable=function(a,b,c){try{var d=g_objPageControl;null!==b&&"undefined"!==typeof b||null!==c&&"undefined"!==typeof c||(b=0,c=d.getTotalPageCount()-1);if(null===c||"undefined"===typeof c)c=b;if(b>c){var e=b;b=c;c=e}for(d=g_objPageControl;b<=c;b++){var g=d.getPageMain(b);if(!g)break;var f=g.isContentEditable;f!==a&&(this.orgPageEditable[b]||(this.orgPageEditable[b]={bEditable:f,strEditable:g.contentEditable}),dlog("set "+b+" page editable: "+
a),g.contentEditable=a)}}catch(h){dalert(h)}};this.restorePageEditable=function(){try{var a=g_objPageControl;Object.keys(this.orgPageEditable).forEach(function(b){var c=this.orgPageEditable[b];delete this.orgPageEditable[b];var d=a.getPageMain(b);d&&c.bEditable!==d.isContentEditable&&(d.contentEditable=c.strEditable,dlog("restore "+b+" page editable: "+c.strEditable))}.bind(this))}catch(b){dalert(b)}};this.doEvent=function(a){try{if((g_bBrowserType_IE||g_bBrowserType_CR)&&a&&!g_objHeaderFooter.getHeaderFooterEditMode()&&
!g_readonlyMode&&!dzeUiConfig.bOfficeOnePageLongMode)switch(this.bInitFunc||this.initFunc(),a.type){case "mousedown":case "touchstart":this.onMouseDown(a);break;case "mousemove":case "touchmove":this.onMouseMove(a);break;case "mouseup":case "touchend":this.onMouseUp(a)}}catch(b){dalert(b)}};this.onMouseDown=function(a){try{if(a&&g_objPageControl.getLoopPageMain(a.target||a.srcElement))if(this.startPageNum=a.pageNum,a.shiftKey)this.onShiftMouseDown(a);else this.onMouseDownOnSelection(a)}catch(b){dalert(b)}};
this.onMouseMoveForCR=function(a){try{a&&1==a.buttons&&g_objPageControl.getLoopPageMain(a.target||a.srcElement)&&(null===a.pageNum||this.startPageNum!==a.pageNum)&&this.setPageEditable(!1,this.startPageNum,a.pageNum)}catch(b){dalert(b)}};this.onMouseUpForCR=function(a){try{if(this.bMouseDownOnSelection)this.restorePageEditable(),a.shiftKey||1!==a.which||g_objCaretUtil.moveCaretFromPoint(a.clientX,a.clientY);else{var b=null;0<Object.keys(this.orgPageEditable).length&&(b=GetCurRangeArray(a.nEditNumber));
this.restorePageEditable();b&&(SetCurRange(b.getOneRange()),a.preventDefault())}this.init()}catch(c){dalert(c)}};this.onMouseMoveForIE=function(a){try{if(a&&1==a.buttons){null===this.startRange&&(this.startRange=new RangeProp(GetCurRange(a.nEditNumber)));var b=g_objPageControl;if(!this.bRangeControl){var c=g_objEditorDocument[a.nEditNumber];if(!c)return;var d=c.elementFromPoint(a.clientX,a.clientY);if(!d||!b.getLoopPageMain(d))return;var e=b.getPageNum(d);if(null!==a.pageNum&&(null===this.startPageNum||
this.startPageNum===e))return}var g=this.startRange;if(g&&g.sc&&g.ec){var f=g_objCaretUtil.getRangeFromPoint(a.clientX,a.clientY);if(f&&f.sc&&f.ec&&b.getLoopPageMain(f.sc)){f.sc=g.sc;f.so=g.so;var h=this.correctRangeOrder(f);if(h){this.setPageEditable(!1,this.startPageNum,e);try{SetCurRange(h.getRange())}catch(k){}a.preventDefault();this.bRangeControl=!0}}}}}catch(k){dalert(k)}};this.onMouseUpForIE=function(a){try{this.restorePageEditable(),this.bMouseDownOnSelection&&!a.shiftKey&&1===a.which&&g_objCaretUtil.moveCaretFromPoint(a.clientX,
a.clientY),this.init()}catch(b){dalert(b)}};this.correctRangeOrder=function(a){try{if(!a)return null;a=a.clone();return 3===a.sc.nodeType&&a.sc===a.ec?a.so<a.eo?a:a.reverse():a.sc.compareDocumentPosition(a.ec)&Node.DOCUMENT_POSITION_PRECEDING?a.reverse():a}catch(b){dalert(b)}};this.onMouseDownOnSelection=function(a){try{if(a){var b=GetCurRange(a.nEditNumber);if(b&&!b.collapsed){var c=g_objNodeUtil;if(c.getLoopHeaderFooterBody(b.startContainer)!==c.getLoopHeaderFooterBody(b.endContainer)){var d=g_objCaretUtil.getRangeFromPoint(a.x,
a.y);d&&(d=d.getRange(),0>=b.compareBoundaryPoints(Range.START_TO_START,d)&&0<=b.compareBoundaryPoints(Range.START_TO_END,d)&&(a=g_objPageControl,this.setPageEditable(!1,a.getPageNum(b.startContainer),a.getPageNum(b.endContainer)),this.bMouseDownOnSelection=!0))}}}}catch(e){dalert(e)}finally{}};this.onShiftMouseDown=function(a){try{var b=new RangeProp(GetCurRange(a.nEditNumber));if(b&&b.sc&&b.ec){var c=g_objCaretUtil.getRangeFromPoint(a.clientX,a.clientY);if(c&&c.sc&&c.ec){if(!SelectionUtil.isMultiSelected(a.nEditNumber)){var d=
g_objNodeUtil,e=d.getLoopHeaderFooterBody(b.sc),g=d.getLoopHeaderFooterBody(c.sc);if(e===g)return}var f=g_objEditWindow[a.nEditNumber].getSelection();if(f&&f.extend)f.extend(c.sc,c.so);else{var h=new RangeProp;h.sc=b.sc;h.so=b.so;h.ec=c.sc;h.eo=c.so;h=this.correctRangeOrder(h);SetCurRange(h.getRange())}a.preventDefault()}}}catch(k){dalert(k)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,d){a instanceof String&&(a=String(a));for(var e=a.length,b=0;b<e;b++){var f=a[b];if(c.call(d,f,b,a))return{i:b,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,d){a!=Array.prototype&&a!=Object.prototype&&(a[c]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,d,e){if(c){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var b=a[e];b in d||(d[b]={});d=d[b]}a=a[a.length-1];e=d[a];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,d){return $jscomp.findInternal(this,a,d).v}},"es6","es3");
var g_objCopyPaste=new function(){this.objPasteDiv=null;this.arrPasteJob=[];this.curTimeoutId=null;this.bPasting=!1;this.isPasting=function(){return this.bPasting};this.bPaused=this.bCutting=this.bCopying=this.bProcessingJob=!1;this.nEditNumber=0;this.evnt=null;this.curCaretID="";this.timerID=null;this.DZE_PASTE_CAPTURE="dze_paste_capture";this.DZE_COPY_CAPTURE="dze_copy_capture";this.PASTE_EMPTY=0;this.PASTE_TEXT=1;this.PASTE_TABLE=2;this.PASTE_HTML=3;this.PASTE_IMAGE=4;this.PASTE_LIST=5;this.PASTE_SHAPE=
6;this.nPasteType=0;this.setPasteType=function(a){this.nPasteType=a};this.ID_PASTE_CARET="dze_paste_caret";this.ID_PASTE_POS_CARET="dze_paste_pos_caret";this.bOnTable=this.bIsEditShapeText=!1;this.objCopyDiv=this.objSavedRangeForCopy=null;this.strRemoveElementsQuery="ad,address,article,aside,blockquote,fieldset,figcaption,figure,footer,header,main,nav,section,comment,center,issuetable-web-component,dashboard,dashboard-done,form,details,summary,container,caption,g-accordion-expander,google-sheets-html-origin,code,cite,time,pre";
this.strRemoveAttribute="tabindex role aria-expanded tab-stops mso-pagination mso-padding-alt text-autospace".split(" ");this.init=function(){try{this.objPasteDiv&&this.objPasteDiv.parentNode&&this.objPasteDiv.parentNode.removeChild(this.objPasteDiv),this.objPasteDiv=null,this.arrPasteJob=[],this.curTimeoutId=null,this.bPaused=this.bPasting=!1,this.evnt=null,this.curCaretID="",this.nPasteType=0,this.bProcessingJob=!1,clearTimeout(this.timerID),this.timerID=null,this.bIsEditShapeText=!1}catch(a){dalert(a)}};
this.pasteKeyDown=function(a,c){try{if(g_readonlyMode||!dzeUiConfig.bUsePasteCapture||!a||a.cancelBubble||!(a.keyCode==ID_KEYCODE_V&&DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)||a.keyCode==ID_KEYCODE_INSERT&&a.shiftKey))return!1;if(this.bPasting)return TBCancelBubbleEvent(a),!1;if(SelectionUtil.isOnInput(c))return!1;if(!1===g_objCaretUtil.isContentEditable(c))return TBCancelBubbleEvent(a),!1;g_objUndoRedo.registerUndoRedoStack(0,c);this.init();this.nEditNumber=c;null!==g_objShapeEvtMgr.getShapeTextContainer()&&
(this.bIsEditShapeText=!0);this.moveCaretToPasteDiv();g_objPasteOptionMenu.remove();g_objPasteOptionMenu.init(c);return!0}catch(d){dalert(d)}};this.pasteClick=function(a){try{if(g_readonlyMode||!dzeUiConfig.bUsePasteCapture)return!1;if(this.bPasting)return TBCancelBubbleEvent(evnt),!1;if(SelectionUtil.isOnInput(a))return!1;if(!1===g_objCaretUtil.isContentEditable(a))return TBCancelBubbleEvent(evnt),!1;g_objUndoRedo.registerUndoRedoStack(0,a);this.init();this.nEditNumber=a;this.moveCaretToPasteDiv();
g_objPasteOptionMenu.remove();g_objPasteOptionMenu.init(a);return!0}catch(c){dalert(c)}};this.moveCaretToPasteDiv=function(){try{if(dzeUiConfig.bUsePasteCapture){var a=g_objEditorDocument[this.nEditNumber],c=g_objEditWindow[this.nEditNumber];if(a&&c){this.curCaretID=this.ID_PASTE_CARET+"_"+g_objCommonUtil.getUniqueID();g_objCaretUtil.saveCaret(this.nEditNumber,this.curCaretID);this.objPasteDiv=this.createPasteDiv(this.nEditNumber);a.body.appendChild(this.objPasteDiv);var d=c.getSelection(),e=a.createRange();
e.selectNode(this.objPasteDiv.firstChild.firstChild);d.removeAllRanges();d.addRange(e)}}}catch(b){dalert(b)}};this.isCaretOnPasteDiv=function(a){try{if(!dzeUiConfig.bUsePasteCapture)return!1;for(var c=g_objNodeUtil,d=c.getAncestorNodeOnCaret(a);d;){if(d.id===this.DZE_PASTE_CAPTURE)return!0;if(c.isLoopBreakNode(d))break;d=d.parentNode}return!1}catch(e){dalert(e)}};this.pasteBefore=function(a,c){try{if(!dzeUiConfig.bUsePasteCapture)return!1;if(!this.isCaretOnPasteDiv(c))return this.init(),!1;this.evnt=
a;this.nEditNumber=c;this.bPasting=!0;this.resume();return!0}catch(d){dalert(d)}};this.pasteAfter=function(a,c){try{if(!dzeUiConfig.bUsePasteCapture)return!1;var d=g_objCaretUtil;d.restoreCaret(c,this.curCaretID);SelectionUtil.deleteSelection(c);var e=this.objPasteDiv;if(!e)return!1;dzeUiConfig.bSupportNewsEditor&&(e=g_objPasteOptionMenu.createKeepTextOnlyPasteDiv(e));var b=GetCurCell(c);this.bOnTable=b?!0:!1;this.adjustPasteContents(e);var f=this.guessPasteType(e);if(f===this.PASTE_EMPTY)return!1;
var g=dzeJ(e).find("img");g_objPasteOptionMenu.isOperating()||g_objPasteOptionMenu.setEditNumber(c).setPasteDiv(e).setPasteContentType(f);var h=this.extractPasteContents(e,f);if(dzeClipBoard.pasteType&&f!=this.PASTE_TABLE)return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NO_CELL_COPIED,1.5),dzeClipBoard.pasteType="",!1;var l=!1;b&&b.parentNode&&f!==this.PASTE_TABLE&&GetMultiCellSelection(c)&&(l=!0,g_objTableUtil.setCellInnerText("",b),g_objCaretUtil.moveCaret(b));if(f===this.PASTE_TABLE){if(!0===
dzeClipBoard.setTableObjToDzeClipData(h.firstChild))try{var k=!1;k=dzeClipBoard.pasteType==INSERT_AS_NEW_ROWS?dzeClipBoard.paste_insert(c,!1):dzeClipBoard.paste(c,!1);dzeClipBoard.pasteType="";return k}catch(y){dalert(y)}}else if(f===this.PASTE_LIST){if(g_objNodeUtil.isList(h.firstChild)&&dzeClipBoard.pasteOlUl(h.firstChild,c,a))return!0}else if(f===this.PASTE_SHAPE)try{c=[];k=h.firstChild;for(a=null;k;)a=k.nextSibling,g_objPropertyUtil.hasClass(k,"dze_shape_main")&&c.push(k),k=a;g_objShapeFunction.doPasteShapes(c);
return}catch(y){dalert(y)}var m=e.ownerDocument,n=m?m.defaultView:null,v=n?n.getSelection():null,p=v&&0<v.rangeCount?v.getRangeAt(0):null;if(!p)return!1;var x=n.document.getElementById("dze_paste_caret_pos");null!=x&&x.parentNode.removeChild(x);var q=d.insertCaretMarker(p,this.ID_PASTE_POS_CARET,!1).end;if(!q)return!1;e=null;if(f===this.PASTE_TEXT&&(e=h.querySelectorAll("span.dze_shape_main"))&&e.length){var u=[];forEach(e,function(b,a){a&&"absolute"===a.style.position&&u.push(a)},this);e=u;u=null}d.removeMarkerAttribute(q);
var t=q.cloneNode();insertAfter(q,t);t.id="dze_paste_caret_pos";this.splitParent(h,q,t,f);p.selectNode(q);p.collapse(!0);p.insertNode(h);if(f===this.PASTE_TEXT&&e&&e.length){for(var r=p.commonAncestorContainer;r&&"P"!==r.nodeName&&"LI"!==r.nodeName&&!g_objNodeUtil.isBoundNode(r);)r=r.parentNode;if(r&&("P"===r.nodeName||"LI"===r.nodeName)){f=g_objPropertyUtil;f.addClass(r,"dze_shape_anchor");var z=m.createDocumentFragment();forEach(e,function(b,a){z.appendChild(a)},this);for(var w=r.firstChild;w&&
"SPAN"===w.nodeName&&f.hasClass(w,"dze_shape_main");)w=w.nextSibling;w?r.insertBefore(z,w):r.appendChild(z);z=null}}var A=q.parentNode;q.parentNode.removeChild(q);g_objNodeUtil.normalize(A);t.nextSibling?d.moveCaret(t.nextSibling,!1,!0):d.moveCaret(t.parentNode,!1,!1);g_objPasteOptionMenu.setPasteEndNode(t);return!0}catch(y){dalert(y)}finally{p=null,b&&b.parentNode&&l&&this.pasteAfterForMultiCell(b),this.resizeImg(g)}};this.setPasteDiv=function(a){try{return this.objPasteDiv=a,this}catch(c){dalert(c)}};
this.getPasteDiv=function(){try{var a=g_objEditorDocument[this.nEditNumber];if(!dzeUiConfig.bUsePasteCapture||!this.bPasting)return a.body;var c=this.objPasteDiv;c&&c.parentNode||(this.objPasteDiv=c=a.getElementById(this.DZE_PASTE_CAPTURE));return c}catch(d){dalert(d)}};this.createPasteDiv=function(a){try{if(dzeUiConfig.bUsePasteCapture){var c=this.createCaptureDiv(a);c.id=this.DZE_PASTE_CAPTURE;c.innerHTML="<p>"+duzon_dialog.dze_bookmark_last_tag+"</p>";return c}}catch(d){dalert(d)}};this.createCopyDiv=
function(a){try{var c=this.createCaptureDiv(a);c.id=this.DZE_COPY_CAPTURE;return c}catch(d){dalert(d)}};this.createCaptureDiv=function(a){try{if(dzeUiConfig.bUsePasteCapture){"undefined"==typeof a&&(a=g_nActiveEditNumber);var c=g_objEditorDocument[a].createElement("div");c.contentEditable=!0;c.style.width=DOCUMENT_MAIN_WIDTH;c.style.height="100%";g_bBrowserType_IE?(c.style.right=-1*screen.width,c.style.bottom=0,c.style.position="fixed"):(c.style.left="0px",c.style.top="0px",c.style.position="fixed",
c.style.opacity="0",c.style.zIndex="-9999");c.style.pointerEvents="none";c.style.background=DOCUMENT_PAGE_BACKGROUND_COLOR;return c}}catch(d){dalert(d)}};this.runPaste=function(){try{dzeUiConfig.bUsePasteCapture&&!this.bPaused&&(this.arrPasteJob.length&&(this.bProcessingJob=!0,this.arrPasteJob.shift().func(),this.bProcessingJob=!1),!this.bPaused&&0<this.arrPasteJob.length?this.resume():!this.bPaused&&0===this.arrPasteJob.length&&this.bPasting&&(this.pasteAfter(this.evnt,this.nEditNumber),this.init(),
editor_onpaste_complete(this.evnt,this.nEditNumber)))}catch(a){dalert(a)}};this.resume=function(){try{if(dzeUiConfig.bUsePasteCapture)if(this.bProcessingJob)this.bPaused=!1;else{this.bPaused=!1;for(var a=0;a<this.arrPasteJob.length;a++)this.arrPasteJob[a].delay=0;clearTimeout(this.timerID);this.timerID=setTimeout(function(){g_objCopyPaste.runPaste()},1)}}catch(c){dalert(c)}};this.pause=function(){try{dzeUiConfig.bUsePasteCapture&&(this.bPaused=!0)}catch(a){dalert(a)}};this.setTimeoutForPaste=function(a,
c){try{if(dzeUiConfig.bUsePasteCapture&&this.bPasting){a={func:a,delay:c};for(var d=0;d<this.arrPasteJob.length;d++)if(c<this.arrPasteJob[d].delay){this.arrPasteJob.splice(d,0,a);break}d>=this.arrPasteJob.length&&this.arrPasteJob.push(a)}else setTimeout(a,c)}catch(e){dalert(e)}};this.splitParent=function(a,c,d,e){try{if(!c)return!1;var b=g_objNodeUtil;if(e===this.PASTE_TEXT)this.splitParentForPasteText(a,c,e);else if(e===this.PASTE_IMAGE){var f=b.getClosetBound(c,function(a){return b.isBlockNode(a)}),
g=c.previousSibling;b.splitOn(f,c);b.removeEmptyNode(null,g)}else{f=b.getClosetBound(c);var h=b.findSplitPosition(c,f);h.parentNode.insertBefore(c,h);var l=b.insertBrIfSplitAtLast(f,c);l&&d&&l.parentNode.insertBefore(d,l);b.splitOn(f,c)}}catch(k){dalert(k)}};this.splitParentForPasteText=function(a,c,d){try{if(!c)return!1;var e=c?c.parentNode:null;if(e&&"SPAN"===e.nodeName&&!g_objPropertyUtil.hasClass(e,"dze_shape_text_container")){var b=a.firstChild;for(a=null;b;){a=b.nextSibling;if("SPAN"===b.nodeName||
"A"===b.nodeName){var f=parseStyle(e.getAttribute("style")),g=parseStyle(b.getAttribute("style"))||{};if(f&&g)for(var h in f){var l;if(l=!g[h]&&f[h]){a:{switch(h){case "fontFamily":case "fontSize":case "color":case "backgroundColor":case "fontWeight":var k=!0;break a}k=!1}var m;if(!(m=k))a:{switch(h){case "lineHeight":case "letterSpacing":m=!0;break a}m=!1}l=m}l&&(b.style[h]=f[h])}}else if(3===b.nodeType){var n=e.cloneNode(!1);b.parentNode.replaceChild(n,b);n.appendChild(b)}b=a}b=g_objNodeUtil;b.clean(e);
e.firstChild==c?e.parentNode.insertBefore(c,e):e.lastChild==c?insertAfter(e,c):b.splitOn(e.parentNode,c)}return!0}catch(v){dalert(v)}};this.guessPasteType=function(a){try{var c=this.PASTE_HTML;this.isPasteTypeEmpty(a)?c=this.PASTE_EMPTY:this.isPasteTypeImage(a)?c=this.PASTE_IMAGE:this.isPasteTypeShape(a)?c=this.PASTE_SHAPE:this.isPasteTypeText(a)?c=this.PASTE_TEXT:this.isPasteTypeTable(a)?c=this.PASTE_TABLE:this.isPasteTypeList(a)&&(c=this.PASTE_LIST);return c}catch(d){dalert(d)}};this.isPasteTypeEmpty=
function(a){try{if(!a||!a.firstChild)return!0;if(!a.firstChild.nextSibling&&"P"===a.firstChild.nodeName){var c=a.firstChild;if(!c.firstChild||3===c.firstChild.nodeType&&!c.firstChild.nextSibling&&0==removeZeroWidthSpaceFromString(c.firstChild.nodeValue).length)return!0}return!1}catch(d){dalert(d)}};this.isPasteTypeText=function(a){try{return a&&a.firstChild?"P"===a.firstChild.nodeName&&!a.firstChild.nextSibling||g_objNodeUtil.hasAllTextInlineChild(a)?!0:!1:!1}catch(c){dalert(c)}};this.isPasteTypeTable=
function(a){try{return a.firstChild&&!a.firstChild.nextSibling&&"TABLE"===a.firstChild.nodeName?!0:!1}catch(c){dalert(c)}};this.isPasteTypeList=function(a){try{return a&&a.firstChild&&a.firstChild===a.lastChild&&g_objNodeUtil.isList(a.firstChild)?!0:!1}catch(c){dalert(c)}};this.isPasteTypeImage=function(a){try{if(!a||!a.firstChild)return!1;var c=a.firstChild;if("IMG"===c.nodeName&&!c.nextSibling)return!0;if(!c.nextSibling&&"P"===c.nodeName){var d=c.firstChild;if(d&&"IMG"===d.nodeName){var e=d?d.nextSibling:
null;if(!e)return!0;if(!e.nextSibling&&"BR"===e.nodeName)return e.parentNode.removeChild(e),!0}}return!1}catch(b){dalert(b)}};this.isPasteTypeShape=function(a){try{if(!a||!a.firstChild)return!1;var c=g_objPropertyUtil,d=a.firstChild;if("P"!==d.nodeName||d.nextSibling||!c.hasClass(d,"dze_shape_anchor"))return!1;a=!0;for(var e=d.firstChild;e;){if("BR"!==e.nodeName&&!c.hasClass(e,"dze_shape_main")){a=!1;break}e=e.nextSibling}return a}catch(b){dalert(b)}};this.extractPasteContents=function(a,c){try{if(!a)return null;
var d=a.ownerDocument.createRange();c!==this.PASTE_TEXT&&c!==this.PASTE_IMAGE&&c!==this.PASTE_SHAPE||!a.firstChild||"P"!==a.firstChild.nodeName?d.selectNodeContents(a):d.selectNodeContents(a.firstChild);return d.extractContents()}catch(e){dalert(e)}};this.adjustPasteContents=function(a){try{if(a){var c=g_objNodeUtil;this.replacePreWithPara(a);c.clean(a);!1===g_bBrowserType_IE&&g_objALinkMgr.setHyperlinkAuto(this.nEditNumber,a);c.removeElementsBySelector(a,this.strRemoveElementsQuery);this.pullListInsideListItem(a);
this.pullTableOutOfPara(a);this.removeBlankPara(a);g_objAdjustDoc.addParaToCell(a);g_objAdjustDoc.adjustTable(a);this.removeUselessDiv(a);g_objNodeUtil.removeElementsBySelector(a,"li>p");g_objListUtil.replaceAllParaWithListItem(a);g_objALinkMgr.removeAllBookmarkForPaste(g_objEditorDocument[this.nEditNumber].getElementById("dze_document_container"),a);g_objAdjustDoc.changeTextTagFormat(a);this.removeGarbageStyle(a);this.bOnTable&&this.removeOnTable(a);!0===dzeUiConfig.bSupportNewsEditor&&this.checkImageForNews(a);
var d=a.querySelectorAll("span.dze_shape_main");0<g_objSelectedShapesArray.length||g_objShapeEvtMgr.getShapeTextContainer()?(forEach(d,function(b,a){a&&a.parentNode&&a.parentNode.removeChild(a)},this),null!==g_objShapeEvtMgr.getShapeTextContainer()&&g_objAdjustDoc.arrangeList(a)):d&&d.length&&forEach(d,function(b,a){g_objShapeFunction.updateShapeId(a)},this);g_objAdjustDoc.addClassForAnchor(a);d=c=null;(c=a.querySelectorAll("span.dze_sketch_main"))&&c.length&&forEach(c,function(b,a){a&&a.parentNode.removeChild(a)},
this);(d=a.querySelectorAll(".dze_sketch_anchor"))&&d.length&&forEach(d,function(b,a){a&&g_objPropertyUtil.removeClass(a,"dze_sketch_anchor")},this);this.removeAttributes(a);g_objAdjustDoc.arrangeSpan(a);g_objAdjustDoc.removeParaWithoutChild(this.nEditNumber);g_objVideoControl.convToImgAll(a);g_objTagUtil.force_formTagSwitch(a,!((g_bBrowserType_IE||g_bBrowserType_FF)&&!1===g_objTagUtil.bFormTagSwitch));g_objPlaceholder.setAllPlaceholderText(a);var e=a.innerHTML;try{e=e.normalize("NFC")}catch(b){}a.innerHTML=
e;return a}}catch(b){dalert(b)}};this.removeGarbageStyle=function(a){try{if(!a||!a.firstChild)return!1;var c=g_objVideoControl,d=g_objNodeUtil,e=a.querySelectorAll("*"),b=null;a=null;for(var f="",g=e.length-1;0<=g;g--)if(b=e[g],a=b.nodeName,f=b.className,!("g"===b.nodeName||b.id&&0==b.id.indexOf("dze")||("string"!==typeof f&&(f=""),f.length&&0===f.indexOf("dze")&&"dze_table"!==f&&"dze_oneffice_link_flag"!==f))){1===b.nodeType&&"BR"===b.nodeName&&b.hasAttribute("style")&&b.removeAttribute("style");
b.style.position&&(b.style.position="",b.style.top&&(b.style.top=""),b.style.right&&(b.style.right=""),b.style.bottom&&(b.style.bottom=""),b.style.left&&(b.style.left=""),dlog("remove style top,right,bottom,left.."));b.style.zIndex&&(b.style.zIndex="");b.style.float&&(b.style.float="");b.style.transform&&(b.style.transform="");b.style.overflow&&(b.style.overflow="");b.style.display&&(b.style.display="");if("inherit"===b.style.fontFamily||"-webkit-standard"===b.style.fontFamily)b.style.fontFamily=
"";!d.isBlockNode(b)||"nowrap"!==b.style.whiteSpace&&"pre"!==b.style.whiteSpace||(b.style.whiteSpace="");"A"!==b.nodeName&&b.style.cursor&&(b.style.cursor="");"BR"===b.nodeName&&b.hasAttribute("clear")&&b.removeAttribute("clear");"TABLE"!==b.nodeName&&"TD"!==b.nodeName&&"TH"!==b.nodeName&&b.style.backgroundImage&&(b.style.backgroundImage="");1===b.nodeType&&b.hasAttribute&&this.strRemoveAttribute.forEach(function(a){b.hasAttribute(a)&&b.removeAttribute(a)});switch(b.nodeName){case "P":case "LI":case "DT":case "DD":case "PRE":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":b.style.backgroundColor&&
(b.style.backgroundColor="")}b.style.maxWidth&&(b.style.maxWidth="");b.style.maxHeight&&(b.style.maxHeight="");b.style.minWidth&&(b.style.minWidth="");b.style.minHeight&&(b.style.minHeight="");b.style.boxShadow&&(b.style.boxShadow="");var h=!1;switch(a){case "IMG":case "TD":case "TH":case "TR":case "TABLE":case "COL":case "VIDEO":h=!0}!h&&c.isVideo(b)&&(h=!0);if(!h)if(!b.id||0!=b.id.indexOf("teads")&&0!=b.id.indexOf("ssp-adcontent"))if(0==f.indexOf("teads")||0==f.indexOf("ssp-adcontent"))b.parentNode.removeChild(b);
else{if("IFRAME"===b.nodeName&&0<dzeUiConfig.arrRemoveAdIFrame.length){h=!1;for(var l=0;l<dzeUiConfig.arrRemoveAdIFrame.length;l++)if(0<=b.src.indexOf(dzeUiConfig.arrRemoveAdIFrame[l])){h=!0;break}if(!0===h){b.parentNode.removeChild(b);continue}}"HR"===b.nodeName&&b.getAttribute("style")&&b.removeAttribute("style");if("OL"!==b.nodeName&&"UL"!==b.nodeName||0!=b.childNodes.length){if("SPAN"===b.nodeName||"A"===b.nodeName||0<=d.arrParaNodeName.indexOf(b.nodeName)||0<=d.arrListNodeName.indexOf(b.nodeName))b.style.border=
"",b.style.borderStyle="",b.style.borderWidth="",b.style.borderRadius="",b.style.borderImage="",b.style.backgroundPosition="",b.style.backgroundSize="",b.style.backgroundRepeat="",b.style.backgroundAttachment="",b.style.backgroundOrigin="",b.style.backgroundClip="";d.isInlineNode(b)&&(b.style.float="",b.style.marginTop="",b.style.marginRight="",b.style.marginBottom="",b.style.marginLeft="",b.style.paddingTop="",b.style.paddingRight="",b.style.paddingBottom="",b.style.paddingLeft="",b.style.lineHeight=
"",b.style.textAlign="",b.style.textIndent="",dzeUiConfig.bSupportNewsEditor&&b.getAttribute("style")&&b.removeAttribute("style"));!b.style.fontSize||"0"!=b.style.fontSize&&"0px"!=b.style.fontSize||(b.style.fontSize="");b.style.padding&&(b.style.padding="");b.style.margin&&0>d.arrParaNodeName.indexOf(b.nodeName)&&(b.style.margin="");b.style.textIndent&&0>d.arrParaNodeName.indexOf(b.nodeName)&&(b.style.textIndent="");b.style.width&&"SELECT"!==b.nodeName&&"INPUT"!==b.nodeName&&(b.style.width="");b.style.height&&
(b.style.height="");b.style.maxWidth&&(b.style.maxWidth="");b.style.minWidth&&(b.style.minWidth="");b.style.maxHeight&&(b.style.maxHeight="");b.style.minHeight&&(b.style.minHeight="");b.style.boxSizing&&(b.style.boxSizing="");d.isList(b)&&(b.style.marginTop="",b.style.marginRight="",b.style.marginBottom="",b.style.marginLeft="",b.style.paddingTop="",b.style.paddingRight="",b.style.paddingBottom="",b.style.paddingLeft="",b.style.lineHeight="",b.style.textAlign="",b.style.textIndent="");if(1===b.nodeType){var k=
b.dataset,m;for(m in k)startsWith(m,"dze")||b.removeAttribute("data-"+m.split(/(?=[A-Z])/).join("-").toLowerCase())}d.isParagraph(b)&&(b.style.marginTop&&0>parseInt(b.style.marginTop,10)&&(b.style.marginTop=""),b.style.marginBottom&&0>parseInt(b.style.marginBottom,10)&&(b.style.marginBottom=""))}else b.parentNode.removeChild(b)}else b.parentNode.removeChild(b)}}catch(n){dalert(n)}};this.removeBlankPara=function(a){try{if(!a||!a.firstChild)return!1;var c=a.getElementsByTagName("p");c=[].slice.call(c);
a=!1;for(var d=c.length-1;0<=d;d--){var e=a;a:{var b=c[d],f=b&&"P"===b.nodeName?b:null;if(!f||f.style.whiteSpace)var g=!1;else{for(var h=g_objNodeUtil,l=f.childNodes,k=0,m=l.length;k<m;k++)if(!h.isIgnorable(l[k])){g=!1;break a}f.parentNode.removeChild(f);g=!0}}a=e|g}return a}catch(n){dalert(n)}};this.removeUselessDiv=function(a){try{return g_objNodeUtil.removeElementsBySelector(a,"div",function(a){return g_objPropertyUtil.hasClass(a,"dze_video_iframe_container_div")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT}),
!0}catch(c){dalert(c)}};this.removePTag=function(a){try{for(var c=null,d=null,e=null,b=0;b<a.childNodes.length;b++)if(c=a.childNodes[b],!0===g_objNodeUtil.isBlockNode(c)){e=c.parentNode;0!==b&&(d=g_objEditorDocument[this.nEditNumber].createElement("br"),e.insertBefore(d,c));for(;!0===c.hasChildNodes();)e.insertBefore(c.firstChild,c);e.removeChild(c)}}catch(f){dalert(f)}};this.removeOnTable=function(a){try{if(this.bOnTable){var c=g_objPropertyUtil,d="undefined"!=typeof g_objPageControl?g_objPageControl:
null;if(d){var e=d.DZE_PAGE_BREAK_PARA,b=a.querySelectorAll("."+e);forEach(b,function(b,a){c.removeClass(a,e)},this)}}}catch(f){dalert(f)}};this.checkImageForNews=function(a){try{if(dzeUiConfig.bSupportNewsEditor){var c=a.querySelectorAll("img"),d=!1,e="ttcdn."+onefficeExtContent.mainDomain[onefficeExtContent.indexEnv]+".co.kr";forEach(c,function(b,a){-1===a.src.indexOf(e)&&(a.parentNode.removeChild(a),d=!0)});!0===d&&cmnMsg.showMsg(MESSAGE_ALERT,"\uc11c\ubc84\uc5d0 \ub4f1\ub85d\ub418\uc9c0 \uc54a\uc740 \uc774\ubbf8\uc9c0\ub294 \uc0bd\uc785\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4.",
null,["\ud655\uc778"])}}catch(b){dalert(b)}};this.resizeImg=function(a){try{a&&0<a.length&&g_objAdjustDoc.fitImageSizeToDoc(a)}catch(c){dalert()}};this.pullTableOutOfPara=function(a){try{if(a){var c=g_objNodeUtil,d=a.querySelectorAll("p>table");forEach(d,function(a,b){(a=b.parentNode)&&"P"===a.nodeName&&(c.splitOn(a.parentNode,b),(a=b.previousSibling)&&!a.firstChild&&a.parentNode.removeChild(a),b=b.nextSibling,!b||b.firstChild&&("BR"!==b.firstChild.nodeName||b.firstChild.nextSibling)||b.parentNode.removeChild(b))})}}catch(e){dalert(e)}};
this.onCopyBefore=function(a){try{if(g_bBrowserType_IE||g_bBrowserType_EDGE)if(this.bCopying||this.bCutting)TBCancelBubbleEvent(a);else{var c=a?a.nEditNumber:this.nEditNumber;this.adjustSelection(c);var d=GetCurRangeArray(c);if(!d||d.collapsed())return!1;var e=this.createCopyDiv(c);if(!e)return!1;this.objSavedRangeForCopy=d;this.objCopyDiv=e;var b=e.ownerDocument,f=b.createRange();a=null;SelectionUtil.isSelectionOnCell(c)?a=g_objTableOperation.cloneSelectionOnCell(c):(a=d.cloneContents(),this.extendCopyContents(d,
a));if(!a||!a.firstChild)return!1;e.appendChild(a);b.body.appendChild(e);this.adjustCopyContents(e);f.selectNodeContents(e);SetCurRange(f);return!0}}catch(g){dalert(g)}};this.onCutBefore=function(a){try{return this.onCopyBefore(a)}catch(c){dalert(c)}};this.onCopy=function(a){try{if(g_bBrowserType_IE||g_bBrowserType_EDGE)this.bCopying=!0,setTimeout(function(){this.bCopying=!1;this.objCopyDiv&&(this.objCopyDiv.parentNode.removeChild(this.objCopyDiv),this.objCopyDiv=null);this.objSavedRangeForCopy&&
(this.objSavedRangeForCopy.setCurRange(c),this.objSavedRangeForCopy=null)}.bind(this),0);else{var c=a.nEditNumber;this.adjustSelection(c);var d=GetCurRangeArray(c);if(!d||d.collapsed())return!1;var e=this.createCopyDiv(c);if(!e)return!1;var b=null;SelectionUtil.isSelectionOnCell(c)?b=g_objTableOperation.cloneSelectionOnCell(c):(b=d.cloneContents(),this.extendCopyContents(d,b));if(!b||!b.firstChild)return!1;e.appendChild(b);this.adjustCopyContents(e);var f=e.innerHTML,g=g_objNodeUtil.getInnerText(e),
h=a.clipboardData;h.setData("text/plain",g);h.setData("text/html",f);a.preventDefault()}}catch(l){dalert(l)}};this.onCut=function(a){try{var c=a.nEditNumber;this.onCopy(a);var d=function(){g_objCaretUtil.isContentEditable(c)&&(SelectionUtil.deleteSelection(c),g_objCaretUtil.scrollToCaret(),g_objUndoRedo.registerUndoRedoStack(0,c),g_objPageControl.onSetDelayedUpdatePageTimer());editor_onselectionchange(c)};g_bBrowserType_IE||g_bBrowserType_EDGE?(this.bCutting=!0,setTimeout(function(){this.bCutting=
!1;d()}.bind(this),0)):d()}catch(e){dalert(e)}};this.extendCopyContents=function(a,c){try{if(a&&c&&c.firstChild&&1===a.getRangeCount()){var d=g_objNodeUtil,e=g_objPropertyUtil;if(c.firstChild===c.lastChild){switch(c.firstChild.nodeName){case "IMG":case "TABLE":case "HR":case "VIDEO":return}if(e.hasClass(c.firstChild,"dze_shape_main")||g_objVideoControl.isVideoSpan(c.firstChild))return}var b=a.getRangeAt(0),f=b.commonAncestorContainer,g=a=null;if(3===f.nodeType)for(g=f=f.parentNode;g&&d.isInlineNode(g)&&
!e.hasClass(g,"dze_shape_text_contents");)a=g,g=g.parentNode;if(d.isHead(f))a=f;else if(d.isList(f)){var h=g_objListUtil.getRootList(f);a=h?h:f}if(a)for(e=null,g=f;;){e=g.cloneNode(!1);d.moveNodesTo(e,c.firstChild);c.appendChild(e);if(g===a)break;g=g.parentNode}if(3===b.commonAncestorContainer.nodeType&&3===c.firstChild.nodeType){var l=b.commonAncestorContainer.parentNode;if(!fnObjectCheckNull(l)){var k=d.getInlineTextStyle(l),m=dzeJ("<span>").css({"font-size":k.size,"font-family":k.family,color:k.color,
"background-color":k.bgColor,"font-weight":k.bold,"font-style":k.italic,"text-decoration":k.textDeco,"vertical-align":k.subscript,"letter-spacing":k.letterSpace});m.append(c.firstChild);c.appendChild(m[0])}}}}catch(n){dalert(n)}finally{}};this.adjustCopyContents=function(a){try{var c=g_objSplitUtil;c.mergeAll(a);c.removeAllSplitAttr(a);this.removeUselessDiv(a);var d=a.querySelectorAll("div.oneffice_qrcode_first_container, div.oneffice_qrcode_last_container");forEach(d,function(a,c){c.parentNode.removeChild(c)},
this);g_objTableUtil.removeAllDzeTable(a);g_objAdjustDoc.changeTextTagFormat(a);g_objAdjustDoc.arrangeSpan(a);var e=a.querySelectorAll("p.dze_hide_para");forEach(e,function(a,c){c.parentNode.removeChild(c)},this);g_objVideoControl.convToIframeAll(a,!1);setTabSpanInlineStyle(a);g_objAdjustDoc.addStyleForAnchor(a);g_objTagUtil.force_formTagSwitch(a,!0);this.removeListStyleTypeNoneOnCopy(a);g_objCaretUtil.removeAllCaretMarker(a);g_objALinkMgr.removeAllOddBookmark(a);d=c=null;(c=a.querySelectorAll("span.dze_sketch_main"))&&
c.length&&forEach(c,function(a,c){c&&c.parentNode.removeChild(c)},this);(d=a.querySelectorAll(".dze_sketch_anchor"))&&d.length&&forEach(d,function(a,c){c&&g_objPropertyUtil.removeClass(c,"dze_sketch_anchor")},this);this.mergeRootListForCopy(a);return!0}catch(b){dalert(b)}};this.adjustSelection=function(a){try{var c=GetCurRange(a);if(c&&!c.collapsed){var d=c.startContainer,e=c.startOffset,b=c.endContainer,f=c.endOffset;d&&"VIDEO"===d.nodeName&&(d=d.parentNode,e=g_objNodeUtil.getChildIndex(d));b&&"VIDEO"===
b.nodeName&&(b=b.parentNode,f=g_objNodeUtil.getChildIndex(f)+1);if(c.startContainer!==d||c.startOffset!==e||c.endContainer!==b||c.endOffset!==f)c.setStart(d,e),c.setEnd(b,f),SetCurRange(c)}}catch(g){dalert(g)}finally{}};this.pasteAfterForMultiCell=function(a){try{var c=null;g_objTableSelection.doAllSelectedCell(function(d){d!==a&&(null===c?(d.innerHTML=a.innerHTML,g_objNodeUtil.removeElementsBySelector(d,"#dze_paste_caret_pos"),c=d.innerHTML):d.innerHTML=c,(d=d.querySelectorAll("span.dze_shape_main"))&&
d.length&&forEach(d,function(a,b){g_objShapeFunction.updateShapeId(b)},this))})}catch(d){dalert(d)}};this.removeListStyleTypeNoneOnCopy=function(a){try{if(a){var c=a.querySelectorAll("li:first-child");forEach(c,function(a,c){"none"===c.style.listStyleType&&g_objSplitUtil.isSplitNode(c)&&(c.style.listStyleType="")},this)}}catch(d){dalert(d)}};this.removeAttributes=function(a,c){try{if(!0===dzeUiConfig.bSupportNewsEditor&&a&&a.parentNode&&1===a.nodeType){var d=g_objNodeUtil;"undefined"===typeof c&&
(c=d.arrParaTagName.join(","),c+=", span, ol, ul, dl");var e=a.querySelectorAll(c);forEach(e,function(a,c){a=c.attributes;for(var b=a.length-1;0<=b;b--)"class"!==a[b].name&&c.removeAttribute(a[b].name)},this)}}catch(b){dalert(b)}};this.pullListInsideListItem=function(a){try{if(a){var c=g_objNodeUtil,d=a.querySelectorAll("li>ol, li>ul, dt>dl, dd>dl");forEach(d,function(a,b){c.isList(b)&&(a=b.parentNode,c.isListItem(a)&&(c.splitOn(a.parentNode,b),a=b.previousSibling,b=b.nextSibling,a&&c.isListItem(a)&&
!a.firstChild&&a.parentNode.removeChild(a),b&&c.isListItem(b)&&!b.firstChild&&b.parentNode.removeChild(b)))},this)}}catch(e){dalert(e)}};this.mergeRootListForCopy=function(a){try{if(!a)return!1;var c=g_objListUtil,d=[].slice.call(a.querySelectorAll("ol, ul")).filter(function(a){return a===c.getRootList(a)?!0:!1}),e=d.length;if(0>=e)return!1;for(var b=a=0;b+1<e;b++){var f=d[b],g=d[b+1];f&&g&&f.nodeName===g.nodeName&&f.nextSibling===g&&c.getListStyle(f)===c.getListStyle(g)&&c.mergeRootList(f,g,!0,!0)&&
(d[b+1]=f,a++)}return 0<a?!0:!1}catch(h){dalert(h)}};this.replacePreWithPara=function(a){try{if(!a)return!1;var c=a.ownerDocument,d=a.querySelectorAll("pre, div[style*='white-space:']");if(!d||0>=d.length)return!1;a=g_objNodeUtil;d=[].slice.call(d);for(var e=0;e<d.length;e++){var b=d[e];if("DIV"!==b.nodeName||"pre"===b.style.whiteSpace){var f=c.createTreeWalker(b,NodeFilter.SHOW_TEXT,null,!1);if(f){for(var g=f.firstChild();g;){for(var h=g.nodeValue,l=[],k=0;k<h.length;k++){var m=h.charCodeAt(k);if(32===
m)0===k||k===h.length-1?m=160:1<k&&k-1<l.length&&32===l[k-1]&&(m=160);else if(9===m&&g_objPropertyUtil.hasClass(g.parentNode,"tabSpan")){var n=g.splitText(k);n.splitText(1);var v=g_objEditMode.createTabSpan();n.parentNode.replaceChild(v,n);break}else if(10===m||13===m&&k+1<h.length&&10===h.charCodeAt(k+1)){var p=g.splitText(k);p.splitText(13===m?2:1);a.splitOn(b,p);var x=p.nextSibling;if(x){var q=b.cloneNode(!1);a.moveNodesTo(q,x);insertAfter(b,q);d.splice(e+1,0,q)}p.parentNode.removeChild(p);break}l[k]=
m}h=String.fromCharCode.apply(String,l);g.nodeValue=h;g=f.nextNode()}if("PRE"===b.nodeName){var u=c.createElement("P");a.copyAttribute(u,b);u.style.whiteSpace="";a.moveNodesTo(u,b.firstChild);b.parentNode.replaceChild(u,b)}}}}return!0}catch(t){dalert(t)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,b,a){d!=Array.prototype&&d!=Object.prototype&&(d[b]=a.value)};$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(d,b,a,c){if(b){a=$jscomp.global;d=d.split(".");for(c=0;c<d.length-1;c++){var e=d[c];e in a||(a[e]={});a=a[e]}d=d[d.length-1];c=a[d];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(a,d,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.fill",function(d){return d?d:function(b,a,c){var e=this.length||0;0>a&&(a=Math.max(0,e+a));if(null==c||c>e)c=e;c=Number(c);0>c&&(c=Math.max(0,e+c));for(a=Number(a||0);a<c;a++)this[a]=b;return this}},"es6","es3");
$jscomp.findInternal=function(d,b,a){d instanceof String&&(d=String(d));for(var c=d.length,e=0;e<c;e++){var f=d[e];if(b.call(a,f,e,d))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");
var shapesLayerController=function(){this.FOREFRONT_LEVEL=3E4;this.arrShapesAll=[];this.setIndex=function(d,b){try{this.FOREFRONT_LEVEL+=1,d.style.zIndex=!0===b?this.FOREFRONT_LEVEL:this.FOREFRONT_LEVEL-5E4}catch(a){dalert(a)}};this.getShapeLayoutMode=function(d){try{return"relative"===d.style.position?SHAPE_LAYOUT_MODE.IN_TEXT:0<1*d.style.zIndex?SHAPE_LAYOUT_MODE.FRONT_TEXT:SHAPE_LAYOUT_MODE.BEHIND_TEXT}catch(b){dalert(b)}};this.arrangeOrder=function(){try{var d=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByClassName("dze_shape_main");
if(!0===fnObjectCheckNull(d)||1>d.length)this.FOREFRONT_LEVEL=3E4;else{this.arrShapesAll=[];for(var b=0;b<d.length;b++)this.arrShapesAll.push(d[b]);this.arrShapesAll.sort(function(a,b){a=a.style.zIndex;b=b.style.zIndex;a=!1===fnObjectCheckNull(a)?1*a:0;b=!1===fnObjectCheckNull(b)?1*b:0;0>a&&(a+=5E4);0>b&&(b+=5E4);return a-b});var a=this.arrShapesAll[this.arrShapesAll.length-1].style.zIndex;this.FOREFRONT_LEVEL=a=!0===fnObjectCheckNull(a)||0===a.length?3E4:1*a;0>this.FOREFRONT_LEVEL&&(this.FOREFRONT_LEVEL+=
5E4)}}catch(c){dalert(c)}};this.moveToBackAndForth=function(d,b){try{this.arrangeOrder();var a=this.getShapeLayoutMode(d);if(a!==SHAPE_LAYOUT_MODE.IN_TEXT){var c=this.arrShapesAll.indexOf(d);if(!0===b){if(c===this.arrShapesAll.length-1)return;var e=this.arrShapesAll[c+1]}else{if(0===c)return;e=this.arrShapesAll[c-1]}var f=1*d.style.zIndex,g=1*e.style.zIndex,m=this.getShapeLayoutMode(e);if(!1!==b||m!==SHAPE_LAYOUT_MODE.IN_TEXT)a===SHAPE_LAYOUT_MODE.FRONT_TEXT?m===SHAPE_LAYOUT_MODE.FRONT_TEXT?(d.style.zIndex=
g,e.style.zIndex=f):m===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(d.style.zIndex=g+5E4,e.style.zIndex=f-5E4):a===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(m===SHAPE_LAYOUT_MODE.FRONT_TEXT?(d.style.zIndex=g-5E4,e.style.zIndex=f+5E4):m===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(d.style.zIndex=g,e.style.zIndex=f))}}catch(h){dalert(h)}};this.moveToEdge=function(d,b){try{this.arrangeOrder();var a=this.getShapeLayoutMode(d);if(a!==SHAPE_LAYOUT_MODE.IN_TEXT){var c=this.arrShapesAll.indexOf(d);if(!0===b){if(c!==this.arrShapesAll.length-
1)for(var e,f,g=this.arrShapesAll.length-1;g>=c;g--)f=this.getShapeLayoutMode(this.arrShapesAll[g]),f!==SHAPE_LAYOUT_MODE.IN_TEXT&&(g===c?a===SHAPE_LAYOUT_MODE.FRONT_TEXT?d.style.zIndex=this.FOREFRONT_LEVEL:a===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(d.style.zIndex=this.FOREFRONT_LEVEL-5E4):(e=1*this.arrShapesAll[g].style.zIndex,f===SHAPE_LAYOUT_MODE.FRONT_TEXT?this.arrShapesAll[g].style.zIndex=e-1:f===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(e+=5E4,--e,e-=5E4,this.arrShapesAll[g].style.zIndex=e)))}else if(0!==c){for(g=
0;g<this.arrShapesAll.length;g++)if(this.getShapeLayoutMode(this.arrShapesAll[g])!==SHAPE_LAYOUT_MODE.IN_TEXT){var m=g;break}if(!0!==fnObjectCheckNull(m))for(g=m;g<c;g++)f=this.getShapeLayoutMode(this.arrShapesAll[g]),e=1*this.arrShapesAll[g].style.zIndex,g===m&&(a===SHAPE_LAYOUT_MODE.FRONT_TEXT?f===SHAPE_LAYOUT_MODE.FRONT_TEXT?d.style.zIndex=e:f===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(d.style.zIndex=e+5E4):a===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(f===SHAPE_LAYOUT_MODE.FRONT_TEXT?d.style.zIndex=e-5E4:f===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&
(d.style.zIndex=e))),f===SHAPE_LAYOUT_MODE.FRONT_TEXT?this.arrShapesAll[g].style.zIndex=e+1:f===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(e+=5E4,e+=1,e-=5E4,this.arrShapesAll[g].style.zIndex=e)}}}catch(h){dalert(h)}};this.setShapeLayoutMode=function(d,b){try{if(this.arrangeOrder(),b===SHAPE_LAYOUT_MODE.IN_TEXT){if(!1===fnObjectCheckNull(d)&&"absolute"===d.style.position){var a=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("span"),c=g_objNodeUtil.getParentElement(d);c.insertBefore(a,d);a.appendChild(d);
a.setAttribute("contenteditable",!1);a.classList.add("dze_shape_container");var e=g_objShapeFunction.updateShapesContainer(d);d.style.position="relative";d.style.left=e[0]+"px";d.style.top=e[1]+"px";d.style.display="inline-block";var f=this.arrShapesAll.indexOf(d);for(d=f;d<this.arrShapesAll.length;d++)if(d===f)this.arrShapesAll[d].style.zIndex="";else{var g=1*this.arrShapesAll[d].style.zIndex,m=this.getShapeLayoutMode(this.arrShapesAll[d]);m===SHAPE_LAYOUT_MODE.FRONT_TEXT?this.arrShapesAll[d].style.zIndex=
g-1:m===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&(g+=5E4,--g,g-=5E4,this.arrShapesAll[d].style.zIndex=g)}g_objShapeFunction.setShapesAnchorStyle(null,c)}}else{var h=this.getShapeLayoutMode(d),k=d.style.position;if(!1===fnObjectCheckNull(d)&&("relative"===k||b===SHAPE_LAYOUT_MODE.FRONT_TEXT&&h===SHAPE_LAYOUT_MODE.BEHIND_TEXT)||b===SHAPE_LAYOUT_MODE.BEHIND_TEXT&&h===SHAPE_LAYOUT_MODE.FRONT_TEXT)"relative"===k?(b===SHAPE_LAYOUT_MODE.FRONT_TEXT?this.setIndex(d,!0):this.setIndex(d,!1),a=g_objNodeUtil.getParentElement(d),
!1===fnObjectCheckNull(a)&&!0===a.classList.contains("dze_shape_container")&&(c=g_objNodeUtil.getParentElement(a),c.insertBefore(d,a),c.removeChild(a),d.style.left="",d.style.top="")):d.style.zIndex=b===SHAPE_LAYOUT_MODE.FRONT_TEXT?1*d.style.zIndex+5E4:1*d.style.zIndex-5E4,g_objShapeFunction.onUpdateShapesAnchor(d,!0),d.style.position="absolute",d.style.display="block"}}catch(l){dalert(l)}}},shapeLineFunction=function(){this.createLineArrowDefines=function(d,b,a,c,e){try{var f=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("marker"),
g=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("path"),m="arrow_"+(b===LINE_ARROW_POSITION.HEAD?"head_":"tail_")+a;a=4;if(d===LINE_ARROW_TYPE.ARROW_NORMAL||d===LINE_ARROW_TYPE.ARROW_TRIANGLE)a=4*a/3;g.setAttribute("style","fill: "+c+"; fill-opacity: "+e+"; stroke: none;");g.setAttribute("d",this.getArrowHeadPath(d,a,4));f.id=m;f.setAttribute("orient","auto-start-reverse");this.setMarkerProperties(f,a,4,d,b);f.appendChild(g);return f}catch(h){dalert(h)}};this.updateLineArrowDefines=
function(d,b){try{if(!0!==fnObjectCheckNull(b)){for(var a=d.firstChild.firstChild;a.hasChildNodes();)a.removeChild(a.firstChild);var c=d.id.substring(d.id.lastIndexOf("_")+1),e=d.childNodes[0].childNodes[1].childNodes[1],f=e.style.stroke,g=e.style.strokeOpacity;for(d=0;d<b.length;d++){var m=this.createLineArrowDefines(b[d].nArrowType,b[d].nPosition,c,f,g);a.appendChild(m)}return a}}catch(h){dalert(h)}};this.updateHeadAngle=function(d){try{var b=d.firstChild.firstChild,a=parseInt(d.style.width,10),
c=parseInt(d.style.height,10),e=180*Math.atan(c/a)/Math.PI;for(d=0;d<b.childNodes.length;d++){var f=b.childNodes[d];f.setAttribute("orient",0<f.id.indexOf("tail")?e+180:e+"deg")}}catch(g){dalert(g)}};this.setLineArrow=function(d,b){try{if(d.style.markerStart="",d.style.markerEnd="",!0===fnObjectCheckNull(b)||1>b.childNodes.length)d.style.strokeWidth=0;else for(var a=null,c=null,e=0;e<b.childNodes.length;e++)a=b.childNodes[e],c=1*a.getAttribute("arrow_position"),c===LINE_ARROW_POSITION.HEAD?d.style.markerEnd=
"url(#"+a.id+")":c===LINE_ARROW_POSITION.TAIL&&(d.style.markerStart="url(#"+a.id+")")}catch(f){dalert(f)}};this.setMarkerProperties=function(d,b,a,c,e){try{d.setAttribute("viewBox","0 0 "+b+" "+a),d.setAttribute("refX",.75*b),d.setAttribute("refY",a/2),d.setAttribute("markerWidth",b),d.setAttribute("marketHeight",a),d.setAttribute("fill","none"),d.setAttribute("arrow_type",c),d.setAttribute("arrow_position",e)}catch(f){dalert(f)}};this.getScaleSize=function(d,b){try{switch(b){case LINE_ARROW_SIZE.SMALL:var a=
d+1;break;case LINE_ARROW_SIZE.NORMAL:a=d+3;break;case LINE_ARROW_SIZE.LARGE:a=d+5}return a}catch(c){dalert(c)}};this.getArrowHeadPath=function(d,b,a){try{switch(d){case LINE_ARROW_TYPE.ARROW_NORMAL:var c=g_objShapeFunction.getArrowLineHeadVertex(b,a);var e=g_objShapeFunction.getPolygonPath(c);break;case LINE_ARROW_TYPE.ARROW_TRIANGLE:c=g_objShapeFunction.getTriangleVertex(SHAPE_TYPE.TRIANGLE_ISOSCELES_RIGHT,0,0,b,a);e=g_objShapeFunction.getPolygonPath(c);break;case LINE_ARROW_TYPE.ARROW_CIRCLE:e=
g_objShapeFunction.getCirclePath(b/2,a/2,b/2);break;case LINE_ARROW_TYPE.ARROW_SQUARE:c=g_objShapeFunction.getSquareVertex(SHAPE_TYPE.SQUARE_RIGHT_ANGLE,0,0,b,a);e=g_objShapeFunction.getPolygonPath(c);break;case LINE_ARROW_TYPE.ARROW_DIAMOND:c=g_objShapeFunction.getSquareVertex(SHAPE_TYPE.SQUARE_DIAMOND,0,0,b,a),e=g_objShapeFunction.getPolygonPath(c)}return e}catch(f){dalert(f)}};this.getArrowInfo=function(d){try{if(d===ID_COMMAND_LINE_ARROW_NONE)return null;var b=[],a={nArrowType:"",nPosition:""};
switch(d){case ID_COMMAND_LINE_ARROW1:a.nArrowType=LINE_ARROW_TYPE.ARROW_NORMAL;a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);break;case ID_COMMAND_LINE_ARROW2:a.nArrowType=LINE_ARROW_TYPE.ARROW_NORMAL;a.nPosition=LINE_ARROW_POSITION.TAIL;b.push(a);break;case ID_COMMAND_LINE_ARROW3:a.nArrowType=LINE_ARROW_TYPE.ARROW_NORMAL;a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);var c={nArrowType:"",nPosition:""};c.nArrowType=LINE_ARROW_TYPE.ARROW_NORMAL;c.nPosition=LINE_ARROW_POSITION.TAIL;b.push(c);break;
case ID_COMMAND_LINE_ARROW4:a.nArrowType=LINE_ARROW_TYPE.ARROW_TRIANGLE;a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);break;case ID_COMMAND_LINE_ARROW5:a.nArrowType=LINE_ARROW_TYPE.ARROW_TRIANGLE;a.nPosition=LINE_ARROW_POSITION.TAIL;b.push(a);break;case ID_COMMAND_LINE_ARROW6:a.nArrowType=LINE_ARROW_TYPE.ARROW_TRIANGLE;a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);c={nArrowType:"",nPosition:""};c.nArrowType=LINE_ARROW_TYPE.ARROW_TRIANGLE;c.nPosition=LINE_ARROW_POSITION.TAIL;b.push(c);break;case ID_COMMAND_LINE_ARROW7:a.nArrowType=
LINE_ARROW_TYPE.ARROW_TRIANGLE;a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);c={nArrowType:"",nPosition:""};c.nArrowType=LINE_ARROW_TYPE.ARROW_DIAMOND;c.nPosition=LINE_ARROW_POSITION.TAIL;b.push(c);break;case ID_COMMAND_LINE_ARROW8:a.nArrowType=LINE_ARROW_TYPE.ARROW_TRIANGLE;a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);c={nArrowType:"",nPosition:""};c.nArrowType=LINE_ARROW_TYPE.ARROW_CIRCLE;c.nPosition=LINE_ARROW_POSITION.TAIL;b.push(c);break;case ID_COMMAND_LINE_ARROW9:a.nArrowType=LINE_ARROW_TYPE.ARROW_DIAMOND;
a.nPosition=LINE_ARROW_POSITION.HEAD;b.push(a);c={nArrowType:"",nPosition:""};c.nArrowType=LINE_ARROW_TYPE.ARROW_DIAMOND;c.nPosition=LINE_ARROW_POSITION.TAIL;b.push(c);break;case ID_COMMAND_LINE_ARROW10:a.nArrowType=LINE_ARROW_TYPE.ARROW_CIRCLE,a.nPosition=LINE_ARROW_POSITION.HEAD,b.push(a),c={nArrowType:"",nPosition:""},c.nArrowType=LINE_ARROW_TYPE.ARROW_CIRCLE,c.nPosition=LINE_ARROW_POSITION.TAIL,b.push(c)}return b}catch(e){dalert(e)}}},g_objSelectedShapesArray=[],MIN_SHAPE_WIDTH=0,MIN_SHAPE_HEIGHT=
0,DEFAULTS_INSERT_SHAPE_MINIMUM_SIZE=20,DEFAULT_SHAPE_WIDTH=100,DEFAULT_SHAPE_HEIGHT=100,DEFAULT_SHAPE_POSITION="absolute",DEFAULT_FILL_COLOR="#5B9BD5",DEFAULTS_TEXTBOX_FILL_COLOR="#FFFFFF",DEFAULT_FILL_TRANS=1,DEFAULT_LINE_COLOR="#41719C",DEFAULTS_TEXTBOX_BORDER_COLOR="#000000",DEFAULT_LINE_TRANS=1,DEFAULT_LINE_WIDTH=1,DEFAULT_LINE_MITER_LIMIT=10,DEFAULT_OBJATT_VALGN="bottom",DEFAULTS_SHAPE_TEXTBOX_FONT_SIZE="11pt",DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1="#FFFFFF",DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2=
"#000000",DEFAULTS_SHAPE_TEXTBOX_FONT_FAMILY="[\ub354\uc874] \ubcf8\ubb38\uccb4 30",DEFAULTS_SHAPE_TEXTBOX_MARGIN=2,DEFAULT_SHAPE_ANGLE_RADIUS=20,DEFAULT_SHAPE_TEXTBOX_EMPTY_SPACE="&nbsp;&nbsp;&nbsp;",DEFAULTS_MAGNET_ANGLE_GAP=5,DEFAULTS_ARROW_ACTION_DISTANCE=5,DEFAULTS_ARROW_ACTION_DISTANCE_DETAIL=1,DEFAULTS_ARROW_ACTION_ANGLE=15,DEFAULTS_ARROW_ACTION_ANGLE_DETAIL=1,shapeFunction=function(){function d(){}this.layerController=new shapesLayerController;this.lineFunction=new shapeLineFunction;this.nContinuousInput=
0;this.arrPreviewInfo=[];this.setPreviewInfo=function(b,a,c,e,f){try{var g=new d;g.id=b;g.shape_type=a;g.curr_width=c;g.curr_height=e;g.base_angle=f;this.arrPreviewInfo.push(g)}catch(m){dalert(m)}};this.getPreviewInfoById=function(b){try{for(var a=0;a<this.arrPreviewInfo.length;a++)if(b===this.arrPreviewInfo[a].id)return this.arrPreviewInfo[a]}catch(c){dalert(c)}};this.setTextBoxFrameSize=function(b,a,c,e,f){try{var g=e,d=f,h=0,k=0,l=g_objShapeEvtMgr.getCmdShapeType();switch(l){case SHAPE_TYPE.SQUARE_RIGHT_ANGLE:case SHAPE_TYPE.SQUARE_ROUNDED:case SHAPE_TYPE.SQUARE_TEXTBOX:g=
e;d=f;break;case SHAPE_TYPE.SQUARE_TRAPEZOID:h=e/5;k=f/5;g=.6*e;d=.8*f;break;case SHAPE_TYPE.SQUARE_PARALLELOGRAM:h=e/4;g=e/2;d=f;break;case SHAPE_TYPE.SQUARE_DIAMOND:h=e/4;k=f/4;g=e/2;d=f/2;break;case SHAPE_TYPE.TRIANGLE_ISOSCELES_TOP:case SHAPE_TYPE.TRIANGLE_ISOSCELES_RIGHT:case SHAPE_TYPE.TRIANGLE_RIGHT_ANGLE:l===SHAPE_TYPE.TRIANGLE_ISOSCELES_TOP?(h=e/4,k=f/2):l===SHAPE_TYPE.TRIANGLE_ISOSCELES_RIGHT?k=f/4:l===SHAPE_TYPE.TRIANGLE_RIGHT_ANGLE&&(k=f/2);g=e/2;d=f/2;break;case SHAPE_TYPE.CIRCLE:case SHAPE_TYPE.ELLIPSE:e/=
2;f/=2;h=e/3;k=f/3;g=4/3*e;d=4/3*f;break;case SHAPE_TYPE.ARROW_RIGHT:case SHAPE_TYPE.ARROW_LEFT_RIGHT:l===SHAPE_TYPE.ARROW_LEFT_RIGHT&&(h=e/10);k=f/4;g=.8*e;d=f/2;break;case SHAPE_TYPE.ARROW_TOP:case SHAPE_TYPE.ARROW_TOP_BOTTOM:h=e/4,k=l===SHAPE_TYPE.ARROW_TOP?.2*f:f/10,g=e/2,d=.8*f}g-=2*DEFAULTS_SHAPE_TEXTBOX_MARGIN;d-=2*DEFAULTS_SHAPE_TEXTBOX_MARGIN;0<g&&0<d?(b.style.display="",b.style.width=g+"px",b.style.height=d+"px",b.firstChild.style.width=g+"px",b.firstChild.style.height=d+"px"):b.style.display=
"none";1===a?(b.style.left=h+"px",b.style.right=""):(b.style.right=h+"px",b.style.left="");1===c?(b.style.top=k+"px",b.style.bottom=""):(b.style.bottom=k+"px",b.style.top="")}catch(r){dalert(r)}};this.createPreviewPath=function(b,a,c){try{var e=g_objWrapperOutlineUtil_Improved.getActionType(),f="",g=0,d=0,h=0,k="",l=0,r=0;if(e===CMDMODE.INSERT)f=g_objCommonUtil.getUniqueID(),g=MIN_SHAPE_WIDTH,nShapeHEIGHT=MIN_SHAPE_HEIGHT,k=this.makeTransformString(a,c,1,1);else{f=b.id.substring(b.id.lastIndexOf("_")+
1);g_objShapeEvtMgr.setCmdShapeType(1*b.getAttribute("shape_type"));g=dzeLayoutControl.getValueWithRatio(parseFloat(b.style.width));d=dzeLayoutControl.getValueWithRatio(parseFloat(b.style.height));h=g_objNodeUtil.getRotationAngle(b);0!==h&&(b.style.transform="");var p=b.firstChild;if(!0===fnObjectCheckNull(p))return;var n=g_objShapeEvtMgr.getTransformInfo(p.childNodes[1]),t=b.getBoundingClientRect(),w=dzeLayoutControl.getValueWithRatio(n.translate.x)+t.left,v=dzeLayoutControl.getValueWithRatio(n.translate.y)+
t.top,q=n.scale.x,u=n.scale.y;0!==h?(b.style.transform="rotate("+h+"deg)",0>q&&(h*=-1),0>u&&(h*=-1),k=this.makeTransformString(w,v,q,u,h,g/2,d/2)):k=this.makeTransformString(w,v,q,u);if(e===CMDMODE.MOVE_ON_LAYER){var A=g_objWrapperOutlineUtil_Improved.guideLineManager.getGroupRectInfo();l=t.left-A.left;r=t.top-A.top}}var x=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("path");x.id=f;x.style.fill="#FFFFFF";x.style.fillOpacity="0";x.style.stroke="#000000";x.style.strokeOpacity="1";
x.style.strokeWidth=.5;x.style.strokeLinecap=GRAPATT_LINECAP.BUTT;x.style.strokeLinejoin=GRAPATT_LINEJOIN.MITER;x.style.strokeDasharray="2, 2";var y=this.getShapesPath(g,d);x.setAttribute("d",y);x.setAttribute("transform",k);x.setAttribute("distance_x_from_group",l);x.setAttribute("distance_y_from_group",r);g_objShapeFunction.setPreviewInfo(f,g_objShapeEvtMgr.getCmdShapeType(),g,d,h);return x}catch(z){dalert(z)}};this.createShapeGuideLine=function(){try{var b=g_objWrapperOutlineUtil_Improved.getActionType(),
a=0,c=0;g_objShapeFunction.arrPreviewInfo=[];if(b===CMDMODE.INSERT){g_objWrapperOutlineUtil_Improved.setPressedIndicator(OUTLINE_INDICATOR.RIGHT_BOTTOM);a=g_objShapeEvtMgr.structInsertPoint.x;c=g_objShapeEvtMgr.structInsertPoint.y;var e=g_objShapeFunction.createPreviewPath(null,a,c);g_objWrapperOutlineUtil_Improved.updatePreviewField(e)}else{var f=g_objWrapperOutlineUtil_Improved.getStartPositionInfo();a=f.x;c=f.y;for(f=0;f<g_objSelectedShapesArray.length;f++){var g=g_objSelectedShapesArray[f];if(b!==
CMDMODE.ROTATE||!0!==g_objShapeEvtMgr.isLine(1*g.getAttribute("shape_type")))e=g_objShapeFunction.createPreviewPath(g,a,c),g_objWrapperOutlineUtil_Improved.updatePreviewField(e)}}}catch(m){dalert(m)}};this.createShapeSpan=function(b){try{var a=g_objShapeEvtMgr.getCmdShapeType(),c=DEFAULT_LINE_WIDTH,e=c/2,f=g_objWrapperOutlineUtil_Improved.getStartPositionInfo(),g=g_objWrapperOutlineUtil_Improved.getEndPositionInfo(),d=dzeLayoutControl.getValueWithoutRatio(g.x-f.x),h=dzeLayoutControl.getValueWithoutRatio(g.y-
f.y),k=0>d?b.offsetX:g_objShapeEvtMgr.structInsertPoint.x,l=0>h?b.offsetY:g_objShapeEvtMgr.structInsertPoint.y;k-=e;l-=e;var r=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("insert_shape_position"),p=g_objPageControl.getPageNode(g_objPageControl.getPageNum(r)).getBoundingClientRect();k-=p.left;l-=p.top;var n=g_objShapeEvtMgr.isLine(a),t=Math.abs(d),w=Math.abs(h);if(!1===n&&(t<DEFAULTS_INSERT_SHAPE_MINIMUM_SIZE||w<DEFAULTS_INSERT_SHAPE_MINIMUM_SIZE)||!0===n&&t<DEFAULTS_INSERT_SHAPE_MINIMUM_SIZE&&
w<DEFAULTS_INSERT_SHAPE_MINIMUM_SIZE)t=DEFAULT_SHAPE_WIDTH,w=DEFAULT_SHAPE_HEIGHT,d=DEFAULT_SHAPE_WIDTH,h=DEFAULT_SHAPE_HEIGHT;var v=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("span"),q=g_objCommonUtil.getUniqueID();v.id="dze_shape_"+q;v.className="dze_shape_main";v.style.width=t+"px";v.style.height=w+"px";v.style.margin=e+"px";v.style.position=DEFAULT_SHAPE_POSITION;v.style.left=k+"px";v.style.top=l+"px";v.style.display="block";v.setAttribute("shape_width",d);v.setAttribute("shape_height",
h);this.layerController.arrangeOrder();this.layerController.setIndex(v,!0);v.setAttribute("contenteditable",!1);v.setAttribute("shape_type",g_objShapeEvtMgr.getCmdShapeType());v.setAttribute("fixed_ratio",!1);var u=this.createShapeSVG(q);!0===g_objShapeEvtMgr.isLine(a)?this.updateShapesSVG(u,d,h,c):this.updateShapesSVG(u,t,w,c);v.appendChild(u);if(b&&!1===g_objShapeEvtMgr.isLine(a)){var A=this.createShapeTextBox(q,t,w);v.appendChild(A)}return v}catch(x){dalert(x)}};this.createShapeSVG=function(b){try{var a=
g_objEditorDocument[g_objPageControl.nEditNumber].createElement("svg");a.id="dze_shape_svg_"+b;a.setAttribute("xmlns","http://www.w3.org/2000/svg");a.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");a.setAttribute("version","1.1");a.style.position="absolute";a.style.overflow="visible";var c=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("defs"),e=g_objShapeEvtMgr.getCmdShapeType();if(e===SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION){var f=this.lineFunction.createLineArrowDefines(LINE_ARROW_TYPE.ARROW_NORMAL,
LINE_ARROW_POSITION.HEAD,b,DEFAULT_LINE_COLOR,DEFAULT_LINE_TRANS);c.appendChild(f)}else e===SHAPE_TYPE.LINE_ARROW_BI_DIRECTION&&(f=this.lineFunction.createLineArrowDefines(LINE_ARROW_TYPE.ARROW_NORMAL,LINE_ARROW_POSITION.HEAD,b,DEFAULT_LINE_COLOR,DEFAULT_LINE_TRANS),c.appendChild(f),f=this.lineFunction.createLineArrowDefines(LINE_ARROW_TYPE.ARROW_NORMAL,LINE_ARROW_POSITION.TAIL,b,DEFAULT_LINE_COLOR,DEFAULT_LINE_TRANS),c.appendChild(f));a.appendChild(c);var g=this.createShapesGraphic(c);a.appendChild(g);
return a}catch(m){dalert(m)}};this.createShapesGraphic=function(b){try{var a=g_objShapeEvtMgr.getCmdShapeType(),c=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("g");c.style.pointerEvents="auto";c.style.cursor="move";var e=this.makeTransformString(0,0,1,1);c.setAttribute("transform",e);var f=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("g"),g=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("path");e="";!0===g_objShapeEvtMgr.isLine(a)?(e+="fill: none;",
e+=" fill-opacity: 0;"):(e=a===SHAPE_TYPE.SQUARE_TEXTBOX?e+("fill: "+DEFAULTS_TEXTBOX_FILL_COLOR+";"):e+("fill: "+DEFAULT_FILL_COLOR+";"),e+=" fill-opacity: "+DEFAULT_FILL_TRANS+";");f.setAttribute("style",e);c.appendChild(f);f.appendChild(g);var d=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("g"),h=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("path");e="fill: none; fill-opacity: 0;";e=a===SHAPE_TYPE.SQUARE_TEXTBOX?e+(" stroke: "+DEFAULTS_TEXTBOX_BORDER_COLOR+
";"):e+(" stroke: "+DEFAULT_LINE_COLOR+";");e+=" stroke-opacity: "+DEFAULT_LINE_TRANS+"; stroke-width: "+DEFAULT_LINE_WIDTH+"; stroke-linecap: "+GRAPATT_LINECAP.BUTT+"; stroke-linejoin: "+GRAPATT_LINEJOIN.MITER+"; stroke-miterlimit: "+DEFAULT_LINE_MITER_LIMIT+"; stroke-dasharray: "+BORDER_STYLE_GRAPHIC.SOLID+";";d.setAttribute("style",e);c.appendChild(d);d.appendChild(h);var k=d.cloneNode(!0);k.style.stroke="#FFFFFF";k.style.strokeOpacity=0;k.style.strokeWidth=10;c.appendChild(k);if(!0===g_objShapeEvtMgr.isLine(a)){var l=
d.cloneNode(!0);l.style.stroke="#FFFFFF";l.style.strokeOpacity=0;l.style.strokeWidth=0;if(a===SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION||a===SHAPE_TYPE.LINE_ARROW_BI_DIRECTION)l.style.strokeWidth=this.lineFunction.getScaleSize(DEFAULT_LINE_WIDTH,LINE_ARROW_SIZE.NORMAL),this.lineFunction.setLineArrow(l,b);c.appendChild(l)}return c}catch(r){dalert(r)}};this.createShapeTextBox=function(b,a,c){try{var e=g_objEditorDocument[g_objPageControl.nEditNumber],f=e.createElement("span"),g=e.createElement("span"),d=
e.createElement("span"),h=e.createElement("span");d.appendChild(h);g.appendChild(d);f.appendChild(g);f.id="dze_shape_text_"+b;f.style.position="absolute";f.style.margin=DEFAULTS_SHAPE_TEXTBOX_MARGIN;f.style.overflow="hidden";f.setAttribute("contenteditable",!1);this.setTextBoxFrameSize(f,1,1,a,c);g.className="dze_shape_text_container";g.style.width=f.style.width;g.style.height=f.style.height;g.style.display="table-cell";g.style.wordBreak="break-all";g.style.verticalAlign="middle";g_objShapeEvtMgr.getCmdShapeType()===
SHAPE_TYPE.SQUARE_TEXTBOX?g.style.color=DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2:g.style.color=DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1;d.className="dze_shape_text_contents paragraph";d.style.textAlign="center";h.innerHTML="&#8203;";h.className="dze_shape_text_contents sentence";h.style.fontFamily=DEFAULTS_SHAPE_TEXTBOX_FONT_FAMILY;h.style.fontSize=DEFAULTS_SHAPE_TEXTBOX_FONT_SIZE;return f}catch(k){dalert(k)}};this.getShapesPath=function(b,a){try{var c="",e=g_objShapeEvtMgr.getCmdShapeType();switch(e){case SHAPE_TYPE.SQUARE_RIGHT_ANGLE:case SHAPE_TYPE.SQUARE_TRAPEZOID:case SHAPE_TYPE.SQUARE_PARALLELOGRAM:case SHAPE_TYPE.SQUARE_DIAMOND:case SHAPE_TYPE.SQUARE_TEXTBOX:var f=
this.getSquareVertex(e,0,0,b,a);c=this.getPolygonPath(f);break;case SHAPE_TYPE.SQUARE_ROUNDED:c=this.getRoundedSquarePath(b,a,DEFAULT_SHAPE_ANGLE_RADIUS);break;case SHAPE_TYPE.TRIANGLE_ISOSCELES_TOP:case SHAPE_TYPE.TRIANGLE_ISOSCELES_RIGHT:case SHAPE_TYPE.TRIANGLE_RIGHT_ANGLE:f=this.getTriangleVertex(e,0,0,b,a);c=this.getPolygonPath(f);break;case SHAPE_TYPE.CIRCLE:case SHAPE_TYPE.ELLIPSE:b/=2;a/=2;c=a===b?this.getCirclePath(b,a,b):this.getEllipsePath(b,a,b,a);break;case SHAPE_TYPE.ARROW_RIGHT:case SHAPE_TYPE.ARROW_TOP:case SHAPE_TYPE.ARROW_LEFT_RIGHT:case SHAPE_TYPE.ARROW_TOP_BOTTOM:f=
this.getArrowVertex(e,0,0,b,a);c=this.getPolygonPath(f);break;case SHAPE_TYPE.LINE_NORMAL:case SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION:case SHAPE_TYPE.LINE_ARROW_BI_DIRECTION:f=this.getLineVertex(0,0,b,a),c=this.getLinePath(f)}return c}catch(g){dalert(g)}};this.getSquareVertex=function(b,a,c,e,f){try{var g=[a,c],d=[a+e,c],h=[a+e,c+f];a=[a,c+f];switch(b){case SHAPE_TYPE.SQUARE_TRAPEZOID:g[0]+=e/4;d[0]-=e/4;break;case SHAPE_TYPE.SQUARE_PARALLELOGRAM:g[0]+=e/4;h[0]-=e/4;break;case SHAPE_TYPE.SQUARE_DIAMOND:g[0]+=
e/2,d[1]+=f/2,h[0]-=e/2,a[1]-=f/2}return[g,d,h,a]}catch(k){dalert(k)}};this.getTriangleVertex=function(b,a,c,e,f){try{var g=[a,c+f],d=[a+e,c+f];a=[a+e/2,c];switch(b){case SHAPE_TYPE.TRIANGLE_ISOSCELES_RIGHT:d[1]-=f/2;a[0]-=e/2;break;case SHAPE_TYPE.TRIANGLE_RIGHT_ANGLE:a[0]-=e/2}return[g,d,a]}catch(h){dalert(h)}};this.getArrowVertex=function(b,a,c,e,f){try{var g="";switch(b){case SHAPE_TYPE.ARROW_RIGHT:g=[[a,c+f/4],[a+2*e/3,c+f/4],[a+2*e/3,c],[a+e,c+f/2],[a+2*e/3,c+f],[a+2*e/3,c+3*f/4],[a,c+3*f/4]];
break;case SHAPE_TYPE.ARROW_TOP:g=[[a+e/4,c+f],[a+e/4,c+f/3],[a,c+f/3],[a+e/2,c],[a+e,c+f/3],[a+3*e/4,c+f/3],[a+3*e/4,c+f]];break;case SHAPE_TYPE.ARROW_LEFT_RIGHT:g=[[a+e/4,c+f/4],[a+3*e/4,c+f/4],[a+3*e/4,c],[a+e,c+f/2],[a+3*e/4,c+f],[a+3*e/4,c+3*f/4],[a+e/4,c+3*f/4],[a+e/4,c+f],[a,c+f/2],[a+e/4,c]];break;case SHAPE_TYPE.ARROW_TOP_BOTTOM:g=[[a+e/4,c+3*f/4],[a+e/4,c+f/4],[a,c+f/4],[a+e/2,c],[a+e,c+f/4],[a+3*e/4,c+f/4],[a+3*e/4,c+3*f/4],[a+e,c+3*f/4],[a+e/2,c+f],[a,c+3*f/4]]}return g}catch(m){dalert(m)}};
this.getLineVertex=function(b,a,c,e){return[[b,a],[b+c,a+e]]};this.getArrowLineHeadVertex=function(b,a){return[[0,0],[b,a/2],[0,a],[b/3,a/2]]};this.getPolygonPath=function(b){try{for(var a="M "+b[0][0]+" "+b[0][1],c=1;c<b.length;c++)a+=" L "+b[c][0]+" "+b[c][1];return a+" Z"}catch(e){dalert(e)}};this.getLinePath=function(b){try{for(var a="M "+b[0][0]+" "+b[0][1],c=1;c<b.length;c++)a+=" L "+b[c][0]+" "+b[c][1];a+=" M "+b[b.length-1][0]+" "+b[b.length-1][1];for(c=b.length-2;-1<c;c--)a+=" L "+b[c][0]+
" "+b[c][1];return a+" Z"}catch(e){dalert(e)}};this.getRoundedSquarePath=function(b,a,c){try{if(10>Math.abs(b)||10>Math.abs(a))c=2;else if(20>Math.abs(b)||20>Math.abs(a))c-=15;else if(30>Math.abs(b)||30>Math.abs(a))c-=10;else if(40>Math.abs(b)||40>Math.abs(a))c-=5;0>b&&0>a&&(c*=-1);return"M 0 "+c+" A "+c+" "+c+" 0 0 1 "+c+" 0 L "+(b-c)+" 0 A "+c+" "+c+" 0 0 1 "+b+" "+c+" L "+b+" "+(a-c)+" A "+c+" "+c+" 0 0 1 "+(b-c)+" "+a+" L "+c+" "+a+" A "+c+" "+c+" 0 0 1 0 "+(a-c)+" Z"}catch(e){dalert(e)}};this.getCirclePath=
function(b,a,c){return"M "+b+", "+a+" m "+-c+", 0 a "+c+", "+c+" 0 1, 0 "+2*c+", 0 a "+c+", "+c+" 0 1, 0 "+-(2*c)+", 0 Z"};this.getEllipsePath=function(b,a,c,e){return"M "+(b-c)+", "+a+" a "+c+", "+e+" 0 1, 0 "+2*c+", 0 a "+c+", "+e+" 0 1, 0 "+-(2*c)+", 0 Z"};this.getShapeObject=function(b){try{if(!0===fnObjectCheckNull(b)||b.nodeName.toLowerCase()!==DZE_TAG_PATH)return null;var a=g_objNodeUtil.getLoopParentElementByTagNames(b,[DZE_TAG_SPAN]);return!1===fnObjectCheckNull(a)&&!0===a.classList.contains("dze_shape_main")?
a:null}catch(c){dalert(c)}};this.getTextboxInShape=function(b){try{if(!0===fnObjectCheckNull(b))return null;var a=b.classList;if(!0===fnObjectCheckNull(a)||!1===a.contains("dze_shape_text_contents"))b=g_objNodeUtil.getLoopParentByClassName(b,"dze_shape_text_contents"),!1===fnObjectCheckNull(b)&&(a=b.classList);return!1===fnObjectCheckNull(a)&&!0===a.contains("dze_shape_text_contents")?b:null}catch(c){dalert(c)}};this.getShapeBehindText=function(b,a){try{var c=null;if(!0===g_objNodeUtil.isBlockNode(b)){var e=
g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByClassName("dze_shape_main");if(!1===fnObjectCheckNull(e)&&0<e.length){var f=a.clientX,g=a.clientY;c=g_objEditorDocument[g_objPageControl.nEditNumber].createRange();var d=[];a=null;for(var h=!0,k=0;k<e.length;k++){var l=e[k];var r=1*l.style.zIndex;if(l.firstChild&&!(1>=l.firstChild.childNodes.length)&&l.firstChild.childNodes[1].firstChild&&(a=l.firstChild.childNodes[1].firstChild.style.fill,!(0<r||"relative"===l.style.position.toLowerCase())||
"none"===a)){var p=l.getBoundingClientRect();if(p.left<=f&&f<=p.right&&p.top<=g&&g<=p.bottom){c.selectNode(b);g_objNodeUtil.traverseNodesInRange(c,function(a){!1===fnObjectCheckNull(a)&&a.nodeType===ID_SELECTION_TEXT_NODE&&d.push(a)});for(var n=0;n<d.length;n++){var t=d[n];c.selectNode(t);var w=c.getBoundingClientRect();if(w.left<=f&&f<=w.right&&w.top<=g&&g<=w.bottom){h=!1;break}}if(!0===h)return l}}}}}return null}catch(v){dalert(v)}finally{c=null}};this.onSelectShape=function(b,a){try{b&&(this.addSelectedShapesToArray(b),
g_objShapeEvtMgr.setCmdShapeType(1*b.getAttribute("shape_type")),g_objWrapperOutlineUtil_Improved.showOutline(b),this.updateRange(b),!0!==a&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES))}catch(c){dalert(c)}};this.onDeselectShape=function(b){try{g_objWrapperOutlineUtil_Improved.hideOutline(b),this.removeSelectedShapesInArray(b)}catch(a){dalert(a)}};this.onSelectAllShapes=function(){try{var b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByClassName("dze_shape_main");
g_objSelectedShapesArray=[];for(var a=0;a<b.length;a++)this.onSelectShape(b[a],!0);panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES)}catch(c){dalert(c)}};this.onDeselectAllShapes=function(b){try{if(null!==g_objShapeEvtMgr.getShapeTextContainer()){var a=g_objSelectedShapesArray[0];this.onChangeEditTextMode(!1)}else a=g_objSelectedShapesArray[g_objSelectedShapesArray.length-1];g_objWrapperOutlineUtil_Improved.hideOutline(null);if(!1===fnObjectCheckNull(a)){a=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById(a.id);
"relative"===a.style.position.toLowerCase()&&(a=a.parentNode);var c=g_objEditorDocument[g_objPageControl.nEditNumber].getSelection(),e=g_objEditorDocument[g_objPageControl.nEditNumber].createRange();!0===b?e.setStartBefore(a):e.setStartAfter(a);e.collapse(!0);c.removeAllRanges();c.addRange(e)}null!=g_objCropObj&&null!=g_objCropObj.cropObj&&(g_objCropObj.destroy(),g_objCropObj=null);g_objSelectedShapesArray=[]}catch(f){dalert(f)}};this.updateSelection=function(b){try{var a=g_objEditorDocument[g_objPageControl.nEditNumber];
if(!0===b){var c=g_objShapeEvtMgr.getShapeTextContainer();if(null!==c){var e=c.parentNode.getAttribute("object_id");if(!0!==fnObjectCheckNull(e)&&""!==e){var f=a.getElementById(e);if(!1===fnObjectCheckNull(f)){g_objSelectedShapesArray=[];g_objSelectedShapesArray.push(f);var g={object:f,outline_set:c.parentNode};g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr=[];g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.push(g)}}}}else for(g_objWrapperOutlineUtil_Improved.hideOutline(null),
b=g_objSelectedShapesArray,g_objSelectedShapesArray=[],c=0;c<b.length;c++)if(f=a.getElementById(b[c].id),!1===fnObjectCheckNull(b))this.onSelectShape(f,!0)}catch(m){dalert(m)}};this.updateRange=function(b){try{if(!0===g_bBrowserType_IE){var a=g_objEditorDocument[g_objPageControl.nEditNumber].getSelection(),c=g_objEditorDocument[g_objPageControl.nEditNumber].createRange();a.removeAllRanges();c.selectNode(b);a.addRange(c)}else!1===g_objShapeEvtMgr.isLine(g_objShapeEvtMgr.getCmdShapeType())&&g_objCaretUtil.moveCaret(b.childNodes[1].firstChild.firstChild,
!0,!0)}catch(e){dalert(e)}};this.onMouseDown=function(b,a){try{dlog("shapeFunction.onMouseDown");var c=DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL);if(!0===this.isSelectedShape(b))!0===c&&1<g_objSelectedShapesArray.length&&(this.onDeselectShape(b),panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES));else{resetSelectionObjectInfo();if(!0===c){if(!1===fnObjectCheckNull(g_objSelectedShapesArray)&&0<g_objSelectedShapesArray.length){var e=g_objSelectedShapesArray[0];if(b.style.position!==
e.style.position||"relative"===e.style.position)return;var f=g_objShapeEvtMgr.getShapeTextContainer();if(null!==f){var g=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(f.parentNode));!1===fnObjectCheckNull(g)&&g_objWrapperOutlineUtil_Improved.hideTextBox(g)}}}else this.onDeselectAllShapes();this.onSelectShape(b)}if(!1===g_objShapeEvtMgr.isLine(g_objShapeEvtMgr.getCmdShapeType())&&!0===this.checkDoubleClick(a))this.onChangeEditTextMode(!0,
b);else{var d="absolute"===b.style.position.toLowerCase();g_objWrapperOutlineUtil_Improved.onMouseDown(a,d)}TBCancelBubbleEvent(a)}catch(h){dalert(h)}};this.nPreviousEvent=null;this.checkDoubleClick=function(b){try{if(b.button!==MOUSE_BTN.L)return!1;var a=Date.now(),c=this.nPreviousEvent;this.nPreviousEvent=a;return null!==c&&250>a-c?!0:!1}catch(e){dalert(e)}};this.onKeyDown=function(b){try{dlog("shapeFunction.onKeyDown");var a=g_objWrapperOutlineUtil_Improved.getActionType();switch(b.keyCode){case ID_KEYCODE_ESCAPE:a!==
CMDMODE.NORMAL&&(a===CMDMODE.MOVE_IN_TEXT&&(g_objWrapperOutlineUtil_Improved.outlineManager.removeEventListener(),g_objWrapperOutlineUtil_Improved.outlineManager.showFakeCaret(!1)),g_objWrapperOutlineUtil_Improved.guideLineManager.onRelease(),g_objWrapperOutlineUtil_Improved.hidePreviewField(),g_objWrapperOutlineUtil_Improved.initEventManager(),g_objShapeFunction.arrPreviewInfo=[],TBCancelBubbleEvent(b));break;case ID_KEYCODE_BACKSPACE:case ID_KEYCODE_DELETE:var c=g_objEditorDocument[g_objPageControl.nEditNumber],
e=c.getSelection(),f=0<e.rangeCount?e.getRangeAt(0):null;if(0<g_objSelectedShapesArray.length){var g=g_objShapeEvtMgr.getShapeTextContainer();if(null!==g){if(f.toString()===g.textContent){var d=c.createElement("p"),h=c.createElement("span"),k=g.querySelector("p");d.className="dze_shape_text_contents paragraph";h.className="dze_shape_text_contents sentence";h.innerHTML="&#8203;";if(null!==k){d.setAttribute("style",k.getAttribute("style"));var l=k.querySelector("span");null!==l?h.setAttribute("style",
l.getAttribute("style")):(h.style.fontFamily=DEFAULTS_SHAPE_TEXTBOX_FONT_FAMILY,h.style.fontSize=DEFAULTS_SHAPE_TEXTBOX_FONT_SIZE,g_objShapeEvtMgr.getCmdShapeType()===SHAPE_TYPE.SQUARE_TEXTBOX?h.style.color=DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2:h.style.color=DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1)}else d.style.textAlign="center",h.style.fontFamily=DEFAULTS_SHAPE_TEXTBOX_FONT_FAMILY,h.style.fontSize=DEFAULTS_SHAPE_TEXTBOX_FONT_SIZE,g_objShapeEvtMgr.getCmdShapeType()===SHAPE_TYPE.SQUARE_TEXTBOX?h.style.color=
DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2:h.style.color=DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1;for(var r=g.firstChild;!0===r.hasChildNodes();)r.removeChild(r.firstChild);d.appendChild(h);r.appendChild(d);g_objCaretUtil.moveCaret(h,!0,!1);TBCancelBubbleEvent(b)}}else this.onDeleteShape(),g_objWrapperOutlineUtil_Improved.hidePreviewField(),g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber),TBCancelBubbleEvent(b)}else{var p=f?f.commonAncestorContainer:null,n=null;if(f&&!1!==f.collapsed)switch(b.keyCode){case ID_KEYCODE_BACKSPACE:if(0===
f.startOffset)n=this.checkPrevious(p);else if(1===f.startOffset){var t=p.nodeName;if("P"===t||"LI"===t||"H1"===t||"H2"===t||"H3"===t||"H4"===t||"H5"===t||"H6"===t)n=this.checkPrevious(p.childNodes[1])}if(!1===fnObjectCheckNull(n))if(null===n.container){var w=g_objNodeUtil.getParentElement(n.arrShapes[0]);w.removeChild(n.arrShapes[n.arrShapes.length-1]);1===n.arrShapes.length&&this.setShapesAnchorStyle(null,w);TBCancelBubbleEvent(b)}else if(!0===g_objNodeUtil.isBlankPara(n.container))n.container.parentNode.removeChild(n.container),
TBCancelBubbleEvent(b);else{for(var v=this.getInsertPointNode(n.container),q,u=0;u<n.arrShapes.length;u++)q=n.arrShapes[u],null===v?n.container.appendChild(q):n.container.insertBefore(q,v);this.setShapesAnchorStyle(n.container,null)}break;case ID_KEYCODE_DELETE:if(p.nodeType===ID_SELECTION_TEXT_NODE&&f.startOffset===p.nodeValue.length||p.nodeType===ID_SELECTION_ELEMENT_NODE&&0===f.startOffset)n=this.checkNext(p);if(!1===fnObjectCheckNull(n)){v=this.getInsertPointNode(n.container);for(u=0;u<n.arrShapes.length;u++)q=
n.arrShapes[u],null===v?n.container.appendChild(q):n.container.insertBefore(q,v);this.setShapesAnchorStyle(n.container,null)}}}break;case ID_KEYCODE_ENTER:if(!0===b.ctrlKey||!0===b.altKey||!0===b.shiftKey||!0===b.metaKey)break;if(!f)break;if(!0===f.collapsed){var A=g_objShapeEvtMgr.getShapeTextContainer();if(!0!==fnObjectCheckNull(A)){var x=f.startContainer.childNodes[f.startOffset]||f.startContainer;if(A===x||A.contains(3===x.nodeType?x.parentNode:x)){var y=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("br");
f.insertNode(y);f=null;g_objNodeUtil.splitOn(A,y);g_objCaretUtil.moveCaret(y,!0,!1);TBCancelBubbleEvent(b)}}}else setTimeout(function(){var a=g_objShapeEvtMgr.getShapeTextContainer();if(!0!==fnObjectCheckNull(a))for(var b,c,e=0;e<a.childNodes.length;e++)if(b=a.childNodes[e],b.nodeName.toLowerCase()===DZE_TAG_P){for(;!0===b.hasChildNodes();)c=b.firstChild,a.insertBefore(c,b);a.removeChild(b);e--}},0);break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:if("relative"===
g_objSelectedShapesArray[0].style.position.toLowerCase()&&!1===b.altKey||!0===b.altKey&&!0===b.shiftKey||!0===b.altKey&&(b.keyCode===ID_KEYCODE_ARROW_TOP||b.keyCode===ID_KEYCODE_ARROW_BOTTOM))return!1;n=null;p=f=1;v=w=t=0;var z=!1===DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)?DEFAULTS_ARROW_ACTION_DISTANCE:DEFAULTS_ARROW_ACTION_DISTANCE_DETAIL;!1===DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)&&(10>this.nContinuousInput&&this.nContinuousInput++,5<this.nContinuousInput&&10>=this.nContinuousInput&&
(z=this.nContinuousInput));q=!1;for(u=0;u<g_objSelectedShapesArray.length;u++){n=g_objSelectedShapesArray[u];!0===b.shiftKey?(f=parseFloat(n.style.width),p=parseFloat(n.style.height)):!0===b.altKey&&(v=g_objNodeUtil.getRotationAngle(n));switch(b.keyCode){case ID_KEYCODE_ARROW_LEFT:if(!0===b.shiftKey){if(1>f)break;f<2*z?f--:f=f<3*z?f-2:f-z;this.onUpdateShapeSize(n,f,p,null)}else!0===b.altKey?(v-=!1===DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)?DEFAULTS_ARROW_ACTION_ANGLE:DEFAULTS_ARROW_ACTION_ANGLE_DETAIL,
g_objShapeFunction.setRotationAngle(n,v)):(t=parseFloat(n.style.left),n.style.left=t-z+"px");q=!0;break;case ID_KEYCODE_ARROW_RIGHT:!0===b.shiftKey?(f+=z,this.onUpdateShapeSize(n,f,p,null)):!0===b.altKey?(v+=!1===DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)?DEFAULTS_ARROW_ACTION_ANGLE:DEFAULTS_ARROW_ACTION_ANGLE_DETAIL,g_objShapeFunction.setRotationAngle(n,v)):(t=parseFloat(n.style.left),n.style.left=t+z+"px");q=!0;break;case ID_KEYCODE_ARROW_TOP:if(!0===b.shiftKey){if(1>p)break;p<2*z?p--:
p=p<3*z?p-2:p-z;this.onUpdateShapeSize(n,f,p,null)}else w=parseFloat(n.style.top),n.style.top=w-z+"px";q=!0;break;case ID_KEYCODE_ARROW_BOTTOM:!0===b.shiftKey?(p+=z,this.onUpdateShapeSize(n,f,p,null)):(w=parseFloat(n.style.top),n.style.top=w+z+"px"),q=!0}if(!0===q){if("relative"===n.style.position.toLowerCase()&&!0===b.altKey){var B=this.updateShapesContainer(n);n.style.left=B[0]+"px";n.style.top=B[1]+"px"}g_objWrapperOutlineUtil_Improved.updateOutline(n)}}return!0===q?(TBCancelBubbleEvent(b),!0):
!1;case ID_KEYCODE_TAB:if(null!==g_objShapeEvtMgr.getShapeTextContainer())break;n=g_objSelectedShapesArray[g_objSelectedShapesArray.length-1];var E=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByClassName("dze_shape_main");z=-1;for(u=0;u<E.length;u++)if(n===E[u]){z=!1===b.shiftKey?u===E.length-1?0:u+1:0===u?E.length-1:u-1;break}-1<z&&(this.onDeselectAllShapes(),this.onSelectShape(E[z]),TBCancelBubbleEvent(b));break;case ID_KEYCODE_C:case ID_KEYCODE_X:0<g_objSelectedShapesArray.length&&
this.doCopyCutShapes(g_objSelectedShapesArray,b.keyCode===ID_KEYCODE_X,b);break;case ID_KEYCODE_V:null!==g_objShapeEvtMgr.getShapeTextContainer()&&TBCancelBubbleEvent(b)}}catch(F){dalert(F)}finally{f=null}};this.getInsertPointNode=function(b){try{for(var a=null,c,e=0;e<b.childNodes.length;e++){a=b.childNodes[e];c=a.classList;if(!0===fnObjectCheckNull(c)||!1===c.contains("dze_shape_main")||!1===c&&!0===c.contains("dze_shape_main")&&"relative"===a.style.position.toLowerCase())break;a=null}return a}catch(f){dalert(f)}};
this.checkPrevious=function(b){try{if(!b)return null;var a=b.previousSibling,c=g_objNodeUtil.getParentElement(b);if(!0===fnObjectCheckNull(a))return!0===fnObjectCheckNull(c)||c.nodeName.toLowerCase()===DZE_TAG_P||c.nodeName.toLowerCase()===DZE_TAG_LI||c.nodeName.toLowerCase()===DZE_TAG_OL?null:this.checkPrevious(c);if(!1===fnObjectCheckNull(a.classList)&&!0===a.classList.contains("dze_shape_main")){b={arrShapes:null,container:null};a=[];for(var e=0;e<c.childNodes.length;e++){var f=c.childNodes[e];
!1===fnObjectCheckNull(f.classList)&&!0===f.classList.contains("dze_shape_main")&&a.push(f)}b.arrShapes=a;var g=c.previousSibling;!1===fnObjectCheckNull(g)&&(b.container=g);return b}return null}catch(m){dalert(m)}};this.checkNext=function(b){try{if(b&&!0===fnObjectCheckNull(b.nextElementSibling)){var a=g_objNodeUtil.getParentElement(b);if(!1===fnObjectCheckNull(a)&&a.nodeName.toLowerCase()!==DZE_TAG_P&&a.nodeName.toLowerCase()!==DZE_TAG_LI&&a.nodeName.toLowerCase()!==DZE_TAG_OL)return this.checkNext(a);
b={arrShapes:null,container:null};var c=a.nextElementSibling;if(!1===fnObjectCheckNull(c)){for(var e,f=[],g=0;g<c.childNodes.length;g++)e=c.childNodes[g],!1===fnObjectCheckNull(e.classList)&&!0===e.classList.contains("dze_shape_main")&&f.push(e);0<f.length&&(b.arrShapes=f)}if(null!==b.arrShapes)return b.container=a,b}return null}catch(m){dalert(m)}};this.doCopyCutShapes=function(b,a,c){try{if(!b||0===b.length)return!1;for(var e=g_objPageControl.nEditNumber,f="",g=0,d=b.length;g<d;g++)f+=b[g].outerHTML;
dzeClipBoard.copyToNativeClipboard(e,f);!0===a&&(this.onDeleteShape(),g_objUndoRedo.registerUndoRedoStack(0,e));cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_COPIED,1.5);fnObjectCheckNull(c)||TBCancelBubbleEvent(c)}catch(h){dalert(h)}};this.doPasteShapes=function(b){try{if(b&&0!==b.length){var a=[],c=null;!1===fnObjectCheckNull(g_objSelectedShapesArray)&&0<g_objSelectedShapesArray.length?c=g_objSelectedShapesArray[g_objSelectedShapesArray.length-1]:(g_objCaretUtil.saveCaret(g_objPageControl.nEditNumber,
"shape_paste_position"),c=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("shape_paste_position"));for(var e=0;e<b.length;e++){var f=b[e].cloneNode(!0);this.updateShapeId(f);if("relative"===f.style.position){var g=g_objNodeUtil.getParentElement(c);"shape_paste_position"!==c.id&&(c=this.getInsertPointNode(g));null!==c?g.insertBefore(f,c):g.appendChild(f)}else{this.layerController.arrangeOrder();this.layerController.getShapeLayoutMode(f)===SHAPE_LAYOUT_MODE.FRONT_TEXT?this.layerController.setIndex(f,
!0):this.layerController.setIndex(f,!1);if("shape_paste_position"===c.id){var d=g_objNodeUtil.getLoopParentElementByTagNames(c,[DZE_TAG_P,DZE_TAG_LI,DZE_TAG_H1,DZE_TAG_H2,DZE_TAG_H3,DZE_TAG_H4,DZE_TAG_H5,DZE_TAG_H6]);if(!0===fnObjectCheckNull(d)){var h=g_objPageControl.getPageMain(g_objPageControl.currentPage);d=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("p");d.appendChild(g_objEditorDocument[g_objPageControl.nEditNumber].createElement("br"));h.appendChild(d)}}else d=g_objNodeUtil.getParentElement(c);
var k=d.childNodes.length,l=null;if(0<k)for(var r,p=0;p<k;p++)if(r=d.childNodes[p],"dze_shape_main"!==r.className||"dze_shape_main"===r.className&&"relative"===r.style.position.toLowerCase()){l=r;break}g_objPropertyUtil.addClass(d,"dze_shape_anchor");!1===fnObjectCheckNull(l)?d.insertBefore(f,l):d.appendChild(f);this.setNewPositionForPaste(f);this.onUpdateShapesAnchor(f)}a.push(f)}return a}}catch(n){dalert(n)}finally{null!==c&&"shape_paste_position"===c.id&&g_objCaretUtil.restoreCaret(g_objPageControl.nEditNumber,
"shape_paste_position")}};this.getAllShapeClientRects=function(b,a){try{if(!b)return[];var c=b.querySelectorAll("span.dze_shape_main"),e=[];forEach(c,function(b,c){a&&!0===a(c)||e.push(c.getBoundingClientRect())},this);return e}catch(f){dalert(f)}};this.setNewPositionForPaste=function(b){try{if(b){var a=this.getAllShapeClientRects(b.ownerDocument,function(a){return a.id===b.id?!0:!1});if(a&&0!==a.length){a.sort(function(a,b){var c=a.top-b.top;if(0!==c)return c;a=a.left-b.left;return 0!==a?a:0});var c=
b.getBoundingClientRect();c=g_objPositionUtil.domRectToRect(c);var e=0;forEach(a,function(a,b){1>Math.abs(b.left-c.left)&&1>Math.abs(b.top-c.top)&&(c.left+=20,c.top+=20,e+=20)},this);if(0!==e){var f=1*g_objCommonUtil.extractNumberValueUnit(b.style.left).nValue,d=1*g_objCommonUtil.extractNumberValueUnit(b.style.top).nValue;b.style.left=f+e+"px";b.style.top=d+e+"px"}}}}catch(m){dalert(m)}};this.updateShapeId=function(b){try{var a=g_objCommonUtil.getUniqueID(),c=1*b.getAttribute("shape_type");b.id="dze_shape_"+
a;b.firstChild.id="dze_shape_svg_"+a;if(!1===g_objShapeEvtMgr.isLine(c))b.lastChild.id="dze_shape_text_"+a;else if(c===SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION||c===SHAPE_TYPE.LINE_ARROW_BI_DIRECTION){b.firstChild.querySelector("defs").childNodes.forEach(function(b){var c=b.id;b.id=c.substring(0,c.lastIndexOf("_")+1)+a});var e=b.firstChild.lastChild.lastChild,f=e.style.markerStart;0<f.length&&(e.style.markerStart=f.substring(0,f.lastIndexOf("_")+1)+a+'")');f=e.style.markerEnd;0<f.length&&(e.style.markerEnd=
f.substring(0,f.lastIndexOf("_")+1)+a+'")')}}catch(g){dalert(g)}};this.onUpdateShapesPreview=function(b,a){try{var c=g_objPositionUtil.GetDocumentClientPos_XY(b);b=null;if(g_objWrapperOutlineUtil_Improved.getActionType()===CMDMODE.ROTATE){var e=g_objWrapperOutlineUtil_Improved.baseObject.id.substring(g_objWrapperOutlineUtil_Improved.baseObject.id.lastIndexOf("_")+1);var f=this.getPreviewInfoById(e);var d=g_objWrapperOutlineUtil_Improved.baseObject.getBoundingClientRect(),m=g_objWrapperOutlineUtil_Improved.getStartPositionInfo();
b=this.getRotationAngle({x:d.left+d.width/2,y:d.top+d.height/2},{x:m.x,y:m.y},{x:c.nPos_X,y:c.nPos_Y})}for(e=0;e<this.arrPreviewInfo.length;e++)f=this.arrPreviewInfo[e],this.onUpdatePreview(f,c,b,a)}catch(h){dalert(h)}};this.onUpdatePreview=function(b,a,c,e){try{var f=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById(b.id);if(!0!==fnObjectCheckNull(f)){var d=g_objShapeEvtMgr.getTransformInfo(f),m=g_objWrapperOutlineUtil_Improved.getActionType(),h=g_objWrapperOutlineUtil_Improved.getEndPositionInfo(),
k=a.nPos_X-h.x,l=a.nPos_Y-h.y,r=d.translate.x,p=d.translate.y,n=d.scale.x,t=d.scale.y,w=b.curr_width,v=b.curr_height;h="";switch(m){case CMDMODE.INSERT:case CMDMODE.RESIZE:e=w/2;var q=v/2,u=0>n,A=0>t;if(m===CMDMODE.RESIZE){var x=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_shape_"+b.id);e=dzeLayoutControl.getValueWithRatio(parseFloat(x.style.width))/2;q=dzeLayoutControl.getValueWithRatio(parseFloat(x.style.height))/2}var y=this.getUpdatedPreviewInfo(u,A,w,v,e,q,r,p,k,l);m===
CMDMODE.INSERT&&!1===g_objShapeEvtMgr.isLine(g_objShapeEvtMgr.getCmdShapeType())?(0>y.nNewWidth?(r=g_objShapeEvtMgr.structInsertPoint.x+y.nNewWidth,n=-1):(r=g_objShapeEvtMgr.structInsertPoint.x,n=1),0>y.nNewHeight?(p=g_objShapeEvtMgr.structInsertPoint.y+y.nNewHeight,t=-1):(p=g_objShapeEvtMgr.structInsertPoint.y,t=1)):(r=y.nNewTransX,p=y.nNewTransY);h=this.makeTransformString(r,p,n,t,d.rotate,y.nCenterX,y.nCenterY);g_objShapeEvtMgr.setCmdShapeType(b.shape_type);var z=this.getShapesPath(y.nNewWidth,
y.nNewHeight);f.setAttribute("d",z);b.curr_width=y.nNewWidth;b.curr_height=y.nNewHeight;break;case CMDMODE.MOVE_ON_LAYER:r+=k;p+=l;if(0<e){q=g_objWrapperOutlineUtil_Improved.guideLineManager.getPageRectInfo();var B=g_objWrapperOutlineUtil_Improved.guideLineManager.getGroupRectInfo();u=g_objWrapperOutlineUtil_Improved.guideLineManager.MAGNET_POWER;var E=a.nPos_X-g_objWrapperOutlineUtil_Improved.getStartPositionInfo().x,F=a.nPos_Y-g_objWrapperOutlineUtil_Improved.getStartPositionInfo().y;A=1*f.getAttribute("distance_x_from_group");
var G=1*f.getAttribute("distance_y_from_group"),C=B.top+F,D=B.bottom+F,J=B.horizontalCenter+F,H=B.left+E,I=B.right+E,K=B.verticalCenter+E;b=e%10;if(0<b){switch(b){case GUIDE_LINE_TYPE.OUTER_TOP:Math.abs(q.outerTop-C)<=u&&(p=q.outerTop);break;case GUIDE_LINE_TYPE.OUTER_BOTTOM:Math.abs(q.outerBottom-D)<=u&&(p=q.outerBottom-(D-C));break;case GUIDE_LINE_TYPE.INNER_TOP:Math.abs(q.innerTop-C)<=u?p=q.innerTop:Math.abs(q.innerTop-D)<=u&&(p=q.innerTop-(D-C));break;case GUIDE_LINE_TYPE.INNER_BOTTOM:Math.abs(q.innerBottom-
D)<=u?p=q.innerBottom-(D-C):Math.abs(q.innerBottom-C)<=u&&(p=q.innerBottom);break;case GUIDE_LINE_TYPE.OUTER_HORIZONTAL_CENTER:Math.abs(q.outerHorizontalCenter-J)<=u&&(p=q.outerHorizontalCenter-(D-C)/2);break;case GUIDE_LINE_TYPE.INNER_HORIZONTAL_CENTER:Math.abs(q.innerHorizontalCenter-J)<=u&&(p=q.innerHorizontalCenter-(D-C)/2)}p+=G;0>t&&(p+=v)}if(9<e){switch(e-b){case GUIDE_LINE_TYPE.OUTER_LEFT:Math.abs(q.outerLeft-H)<=u&&(r=q.outerLeft);break;case GUIDE_LINE_TYPE.OUTER_RIGHT:Math.abs(q.outerRight-
I)<=u&&(r=q.outerRight-(I-H));break;case GUIDE_LINE_TYPE.INNER_LEFT:Math.abs(q.innerLeft-H)<=u?r=q.innerLeft:Math.abs(q.innerLeft-I)<=u&&(r=q.innerLeft-(I-H));break;case GUIDE_LINE_TYPE.INNER_RIGHT:Math.abs(q.innerRight-I)<=u?r=q.innerRight-(I-H):Math.abs(q.innerRight-H)<=u&&(r=q.innerRight);break;case GUIDE_LINE_TYPE.OUTER_VERTICAL_CENTER:Math.abs(q.outerVerticalCenter-K)<=u&&(r=q.outerVerticalCenter-(I-H)/2);break;case GUIDE_LINE_TYPE.INNER_VERTICAL_CENTER:Math.abs(q.innerVerticalCenter-K)<=u&&
(r=q.innerVerticalCenter-(I-H)/2)}r+=A;0>n&&(r+=w)}}h=this.makeTransformString(r,p,d.scale.x,d.scale.y,d.rotate,w/2,v/2);break;case CMDMODE.ROTATE:c=!1===(0>n&&0>t)&&(0>n||0>t)?b.base_angle-c:c+b.base_angle,0>c?c+=360*Math.ceil(Math.abs(c/360)):360<c&&(c-=360*Math.floor(Math.abs(c/360))),SHAPES_MAGNET_ANGLE.DEGREES_0-DEFAULTS_MAGNET_ANGLE_GAP<c&&c<SHAPES_MAGNET_ANGLE.DEGREES_0+DEFAULTS_MAGNET_ANGLE_GAP||SHAPES_MAGNET_ANGLE.DEGREES_360-DEFAULTS_MAGNET_ANGLE_GAP<c&&c<SHAPES_MAGNET_ANGLE.DEGREES_360+
DEFAULTS_MAGNET_ANGLE_GAP?c=SHAPES_MAGNET_ANGLE.DEGREES_0:SHAPES_MAGNET_ANGLE.DEGREES_90-DEFAULTS_MAGNET_ANGLE_GAP<c&&c<SHAPES_MAGNET_ANGLE.DEGREES_90+DEFAULTS_MAGNET_ANGLE_GAP?c=SHAPES_MAGNET_ANGLE.DEGREES_90:SHAPES_MAGNET_ANGLE.DEGREES_180-DEFAULTS_MAGNET_ANGLE_GAP<c&&c<SHAPES_MAGNET_ANGLE.DEGREES_180+DEFAULTS_MAGNET_ANGLE_GAP?c=SHAPES_MAGNET_ANGLE.DEGREES_180:SHAPES_MAGNET_ANGLE.DEGREES_270-DEFAULTS_MAGNET_ANGLE_GAP<c&&c<SHAPES_MAGNET_ANGLE.DEGREES_270+DEFAULTS_MAGNET_ANGLE_GAP&&(c=SHAPES_MAGNET_ANGLE.DEGREES_270),
h=this.makeTransformString(d.translate.x,d.translate.y,d.scale.x,d.scale.y,c,w/2,v/2)}f.setAttribute("transform",h)}}catch(L){dalert(L)}};this.getUpdatedPreviewInfo=function(b,a,c,e,f,d,m,h,k,l){try{switch(g_objWrapperOutlineUtil_Improved.getPressedIndicator()){case OUTLINE_INDICATOR.LEFT_TOP:c-=k;e-=l;if(!0!==b||!0!==a)!0===b?(h+=l,d=e-d):!0===a?(m+=k,f=c-f):(m+=k,h+=l,f=c-f,d=e-d);break;case OUTLINE_INDICATOR.RIGHT_TOP:c+=k;e-=l;!0===b&&!0===a?(m+=k,f=c-f):!0===b?(m+=k,h+=l,f=c-f,d=e-d):!0!==a&&
(h+=l,d=e-d);break;case OUTLINE_INDICATOR.RIGHT_BOTTOM:c+=k;e+=l;!0===b&&!0===a?(m+=k,h+=l,f=c-f,d=e-d):!0===b?(m+=k,f=c-f):!0===a&&(h+=l,d=e-d);break;case OUTLINE_INDICATOR.LEFT_BOTTOM:c-=k;e+=l;!0===b&&!0===a?(h+=l,d=e-d):!0!==b&&(!0===a?(m+=k,h+=l,f=c-f,d=e-d):(m+=k,f=c-f));break;case OUTLINE_INDICATOR.TOP:e-=l;!0!==a&&(h+=l,d=e-d);break;case OUTLINE_INDICATOR.RIGHT:c+=k;!0===b&&(m+=k,f=c-f);break;case OUTLINE_INDICATOR.BOTTOM:e+=l;!0===a&&(h+=l,d=e-d);break;case OUTLINE_INDICATOR.LEFT:c-=k,!0!==
b&&(m+=k,f=c-f)}return{nNewWidth:c,nNewHeight:e,nNewTransX:m,nNewTransY:h,nCenterX:f,nCenterY:d}}catch(r){dalert(r)}};this.onChangeEditTextMode=function(b,a,c){try{if(!0===b)a&&(this.onDeselectAllShapes(),this.onSelectShape(a),!0===fnObjectCheckNull(c)&&(c=!1),g_objWrapperOutlineUtil_Improved.showTextBox(a,c));else{var e=g_objShapeEvtMgr.getShapeTextContainer();if(null!==e){var f=1<g_objSelectedShapesArray.length?g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(e.parentNode)):
g_objSelectedShapesArray[0];null!==f&&(g_objWrapperOutlineUtil_Improved.updateShapeText(f,!0),g_objWrapperOutlineUtil_Improved.hideTextBox(f))}}}catch(g){dalert(g)}};this.onUpdateShapes=function(b){try{dlog("shapeFunction.onUpdateShapes");var a=g_objWrapperOutlineUtil_Improved.getStartPositionInfo(),c=g_objWrapperOutlineUtil_Improved.getEndPositionInfo(),e=c.y-a.y,f=!1;if(0!==c.x-a.x||0!==e)f=!0;var d=g_objWrapperOutlineUtil_Improved.getActionType();if(d!==CMDMODE.INSERT&&!1===f)return f;if(d===CMDMODE.MOVE_IN_TEXT){var m=
g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.insertPoint.node;if(!0===fnObjectCheckNull(m))return!1;var h=g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.insertPoint.startOffset,k=g_objNodeUtil.getParentElement(m),l=m.splitText(h),r=g_objSelectedShapesArray[0],p=g_objNodeUtil.getParentElement(r),n=g_objNodeUtil.getParentElement(p);k.insertBefore(p,l);g_objNodeUtil.normalize(n);g_objWrapperOutlineUtil_Improved.updateOutline(r);return f}for(a=0;a<this.arrPreviewInfo.length;a++){var t=
this.arrPreviewInfo[a];var w=dzeLayoutControl.getValueWithoutRatio(t.curr_width);var v=dzeLayoutControl.getValueWithoutRatio(t.curr_height);a:{for(c=0;c<g_objSelectedShapesArray.length;c++)if(g_objSelectedShapesArray[c].id==="dze_shape_"+t.id){var q=g_objSelectedShapesArray[c];break a}q=null}nStartPageNum=g_objPageControl.getPageNum(q);switch(d){case CMDMODE.INSERT:q=g_objShapeFunction.onInsertShape(b);break;case CMDMODE.RESIZE:this.onUpdateShapeSize(q,w,v,t.id);break;case CMDMODE.MOVE_ON_LAYER:var u=
1*g_objCommonUtil.extractNumberValueUnit(q.style.left).nValue,A=1*g_objCommonUtil.extractNumberValueUnit(q.style.top).nValue;if(!0===fnObjectCheckNull(z)||!0===fnObjectCheckNull(B)){var x=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById(t.id).getBoundingClientRect(),y=q.getBoundingClientRect();var z=dzeLayoutControl.getValueWithoutRatio(x.left-y.left);var B=dzeLayoutControl.getValueWithoutRatio(x.top-y.top)}q.style.left=u+z+"px";q.style.top=A+B+"px";break;case CMDMODE.ROTATE:var E=
g_objEditorDocument[g_objPageControl.nEditNumber].getElementById(t.id),F=g_objShapeEvtMgr.getTransformInfo(E),G=F.rotate;0>F.scale.x&&(G*=-1);0>F.scale.y&&(G*=-1);this.setRotationAngle(q,G)}if("absolute"===q.style.position.toLowerCase())this.onUpdateShapesAnchor(q);else if(p=g_objNodeUtil.getParentElement(q),!1===fnObjectCheckNull(p)&&!0===p.classList.contains("dze_shape_container")){var C=this.updateShapesContainer(q);q.style.left=C[0]+"px";q.style.top=C[1]+"px"}if(d===CMDMODE.INSERT)this.onSelectShape(q);
else g_objWrapperOutlineUtil_Improved.updateOutline(q),this.updateRange(q);if(d===CMDMODE.INSERT||d===CMDMODE.RESIZE){var D=g_objShapeEvtMgr.getCmdShapeType();D!==SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION&&D!==SHAPE_TYPE.LINE_ARROW_BI_DIRECTION||this.lineFunction.updateHeadAngle(q)}}return f}catch(J){dalert(J)}};this.onUpdateShapesAnchor=function(b,a){try{var c=function(a,b,e,f,d){for(var g,h,k,l,m,n=null,q=null,r=!1,t=!1,u=0;u<a.childNodes.length;u++){g=a.childNodes[u];h=g.nodeName.toLowerCase();switch(h){case DZE_TAG_OL:case DZE_TAG_UL:case DZE_TAG_TABLE:!1===
fnObjectCheckNull(a.classList)&&!0===a.classList.contains("dze_page_main")?(0===u&&(r=!0),u===a.childNodes.length-1&&(t=!0)):!0===d&&u===a.childNodes.length-1&&(t=!0);if(h===DZE_TAG_TABLE)for(n=0;n<g.childNodes.length;n++)if(g.childNodes[n].nodeName.toLowerCase()===DZE_TAG_TBODY){g=g.childNodes[n];break}n=c(g,b,e,r,t);break;case DZE_TAG_P:case DZE_TAG_LI:case DZE_TAG_TR:case DZE_TAG_H1:case DZE_TAG_H2:case DZE_TAG_H3:case DZE_TAG_H4:case DZE_TAG_H5:case DZE_TAG_H6:k=g.getBoundingClientRect();l=k.top-
p.top;m=l+k.height;a.nodeName.toLowerCase()===DZE_TAG_TD&&(d=f=!0);!0===f&&0===u&&e<l?q=g:!0===d&&u===a.childNodes.length-1&&e>m?q=g:l<=e&&e<m&&(q=g);null!==q&&(n=h===DZE_TAG_TR?c(g,b,e,f,d):{anchor:q,left:k.left,top:k.top});break;case DZE_TAG_TD:case DZE_TAG_TH:if(k=g.getBoundingClientRect(),h=k.left-p.left,k=h+k.width,0===u&&b<h||u===a.childNodes.length-1&&b>k||h<b&&b<k)n=c(g,b,e,f,d)}if(null!==n)return n}return null},e=g_objWrapperOutlineUtil_Improved.getActionType(),f=g_objNodeUtil.getParentElement(b),
d=!1;e===CMDMODE.INSERT&&!1===fnObjectCheckNull(f.classList)&&!0===f.classList.contains("dze_shape_anchor")&&(g_objPropertyUtil.removeClass(f,"dze_shape_anchor"),d=!0);var m=g_objNodeUtil.getRotationAngle(b);0!==m&&(b.style.transform="");var h=b.getBoundingClientRect();0!==m&&(b.style.transform="rotate("+m+"deg)");!0===d&&f.classList.add("dze_shape_anchor");var k=g_objNodeUtil.getLoopHeaderFooterBody(b);g_objPropertyUtil.hasClass(k,["dze_page_main","dze_page_header","dze_page_footer"])||(k=g_objPageControl.getPageMain(g_objPageControl.currentPage));
var l=g_objNodeUtil.getParentElement(k),r=l.getBoundingClientRect();r.top>h.top?0<g_objPageControl.getPageNum(k)&&(l=l.previousSibling,k=l.childNodes[1]):r.bottom<h.top&&g_objPageControl.getPageNum(k)<g_objPageControl.getTotalPageCount()-1&&(l=l.nextSibling,k=l.childNodes[1]);var p=k.getBoundingClientRect(),n=h.top-p.top;d=null;var t=c(k,h.left-p.left,n,!0,!0);null!==t&&(d=t.anchor);if(!1===fnObjectCheckNull(d)&&(d!==f||e===CMDMODE.INSERT||!0===a)){a=g_objPlaceholder;var w=a.getClosetPlaceholder(d);
w&&a.setPlaceholderFocus(w);var v=d.childNodes.length;w=null;if(0<v)for(a=0;a<v;a++){var q=d.childNodes[a];if("dze_shape_main"!==q.className||"dze_shape_main"===q.className&&"relative"===q.style.position.toLowerCase()){w=q;break}}!1===fnObjectCheckNull(w)?d.insertBefore(b,w):d.appendChild(b);this.setShapesAnchorStyle(d,f);b.style.left=dzeLayoutControl.getValueWithoutRatio(h.left-t.left)+"px";b.style.top=dzeLayoutControl.getValueWithoutRatio(n-(t.top-p.top))+"px"}}catch(u){dalert(u)}};this.setShapesAnchorStyle=
function(b,a){try{if(!1===fnObjectCheckNull(a)){for(var c=!1,e=0;e<a.childNodes.length;e++)if("dze_shape_main"===a.childNodes[e].className&&"relative"!==a.childNodes[e].style.position){c=!0;break}!1===c&&!1===fnObjectCheckNull(a.classList)&&g_objPropertyUtil.removeClass(a,"dze_shape_anchor")}!1===fnObjectCheckNull(b)&&b.classList.add("dze_shape_anchor")}catch(f){dalert(f)}};this.onUpdateShapeSize=function(b,a,c,e){try{var f=b.firstChild,d=f.childNodes[1],m=d.childNodes[1];g_objShapeEvtMgr.setCmdShapeType(1*
b.getAttribute("shape_type"));var h=parseFloat(m.style.strokeWidth),k="relative"===b.style.position.toLowerCase(),l=g_objNodeUtil.getRotationAngle(b),r=parseFloat(b.style.width),p=parseFloat(b.style.height),n=Math.abs(a),t=Math.abs(c);if(!1===k){var w=parseFloat(b.style.left),v=parseFloat(b.style.top),q=this.getUpdatedShapePosition(w,v,r,p,n,t);!1===fnObjectCheckNull(q.left)&&"number"===typeof q.left&&(b.style.left=q.left+"px");!1===fnObjectCheckNull(q.top)&&"number"===typeof q.top&&(b.style.top=
q.top+"px");if(0!==l&&!1===fnObjectCheckNull(e)){var u=dzeLayoutControl.getValueWithRatio(a)/2,A=dzeLayoutControl.getValueWithRatio(c)/2,x=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById(e),y=x.getAttribute("transform"),z=g_objShapeEvtMgr.getTransformInfo(x).rotate;y+=" rotate("+-z+", "+u+", "+A+")";x.setAttribute("transform",y);var B=x.getBoundingClientRect();y=y.substring(0,y.indexOf("rotate")-1);x.setAttribute("transform",y);var E=x.getBoundingClientRect();var F=[B.left-E.left,
B.top-E.top];b.style.left=parseFloat(b.style.left)+dzeLayoutControl.getValueWithoutRatio(F[0])+"px";b.style.top=parseFloat(b.style.top)+dzeLayoutControl.getValueWithoutRatio(F[1])+"px"}}b.style.width=n+"px";b.style.height=t+"px";b.setAttribute("shape_width",a);b.setAttribute("shape_height",c);this.updateShapesSVG(f,a,c,h);if(!1===g_objShapeEvtMgr.isLine(g_objShapeEvtMgr.getCmdShapeType())){var G=b.lastChild,C=G.firstChild,D=g_objShapeEvtMgr.getTransformInfo(d);this.setTextBoxFrameSize(G,D.scale.x,
D.scale.y,n,t);C.style.width=G.style.width;C.style.height=G.style.height}}catch(J){dalert(J)}};this.getUpdatedShapePosition=function(b,a,c,e,f,d){try{var g=g_objWrapperOutlineUtil_Improved.getPressedIndicator(),h=g_objWrapperOutlineUtil_Improved.getStartPositionInfo(),k=g_objWrapperOutlineUtil_Improved.getEndPositionInfo(),l=dzeLayoutControl.getValueWithoutRatio(k.x-h.x),r=dzeLayoutControl.getValueWithoutRatio(k.y-h.y);h=0<l;k=0<r;var p={left:"",top:""};switch(g){case OUTLINE_INDICATOR.LEFT_TOP:p.left=
!0===h?c<Math.abs(l)?b+c:b+l:b+l;p.top=!0===k?e<Math.abs(r)?a+e:a+r:a+r;break;case OUTLINE_INDICATOR.RIGHT_TOP:!0!==h&&c<Math.abs(l)&&(p.left=b-f);p.top=!0===k?e<Math.abs(r)?a+e:a+r:a+r;break;case OUTLINE_INDICATOR.RIGHT_BOTTOM:!0!==h&&c<Math.abs(l)&&(p.left=b-f);!0!==k&&e<Math.abs(r)&&(p.top=a-d);break;case OUTLINE_INDICATOR.LEFT_BOTTOM:p.left=!0===h?c<Math.abs(l)?b+c:b+l:b+l;!0!==k&&e<Math.abs(r)&&(p.top=a-d);break;case OUTLINE_INDICATOR.TOP:p.top=!0===k?e<Math.abs(r)?a+e:a+r:a+r;break;case OUTLINE_INDICATOR.RIGHT:!0!==
h&&c<Math.abs(l)&&(p.left=b-f);break;case OUTLINE_INDICATOR.BOTTOM:!0!==k&&e<Math.abs(r)&&(p.top=a-d);break;case OUTLINE_INDICATOR.LEFT:p.left=!0===h?c<Math.abs(l)?b+c:b+l:b+l}return p}catch(n){dalert(n)}};this.updateShapesSVG=function(b,a,c,e){try{var f=Math.abs(a),d=Math.abs(c),m=f+e,h=d+e;e=e/2*-1;b.style.width=m+"px";b.style.height=h+"px";b.style.left=e+"px";b.style.top=e+"px";b.setAttribute("viewBox",e+" "+e+" "+m+" "+h);var k=b.childNodes[1],l=g_objShapeEvtMgr.getTransformInfo(k);m=b=0;var r=
l.scale.x,p=l.scale.y;c=0>c?-1:1;r*=0>a?-1:1;p*=c;-1===r&&(b+=f);-1===p&&(m+=d);var n=this.makeTransformString(b,m,r,p);k.setAttribute("transform",n);var t=this.getShapesPath(f,d);k.childNodes[0].firstChild.setAttribute("d",t);k.childNodes[1].firstChild.setAttribute("d",t);var w=k.childNodes[2];!1===fnObjectCheckNull(w)&&w.firstChild.setAttribute("d",t);var v=k.childNodes[3];!1===fnObjectCheckNull(v)&&v.firstChild.setAttribute("d",t)}catch(q){dalert(q)}};this.updateShapesContainer=function(b){try{var a=
g_objNodeUtil.getParentElement(b),c=b.getBoundingClientRect(),e=parseFloat(b.style.width),d=parseFloat(b.style.height),g=parseFloat(b.style.margin),m=(dzeLayoutControl.getValueWithoutRatio(c.width)-e)/2,h=(dzeLayoutControl.getValueWithoutRatio(c.height)-d)/2;a.style.width=dzeLayoutControl.getValueWithoutRatio(c.width+2*g)+"px";a.style.height=dzeLayoutControl.getValueWithoutRatio(c.height+2*g)+"px";return[m,h]}catch(k){dalert(k)}};this.updateArrowStyle=function(b,a,c,e){try{for(var d=b.firstChild.childNodes[0],
g,m=0;m<d.childNodes.length;m++)g=d.childNodes[m].firstChild,g.style.fill=c,g.style.fillOpacity=e;b.firstChild.childNodes[1].childNodes[3].style.strokeWidth=this.lineFunction.getScaleSize(a,LINE_ARROW_SIZE.NORMAL)}catch(h){dalert(h)}};this.onDeleteShape=function(){try{for(var b,a,c,e,d=0;d<g_objSelectedShapesArray.length;d++)b=g_objSelectedShapesArray[d],!1===fnObjectCheckNull(b)&&(e=b.style.position.toLowerCase(),"relative"===e?(a=g_objNodeUtil.getParentElement(b),c=g_objNodeUtil.getParentElement(a)):
c=g_objNodeUtil.getParentElement(b)),!1===fnObjectCheckNull(c)&&(this.onDeselectShape(b),"relative"===e?c.removeChild(a):c.removeChild(b),this.setShapesAnchorStyle(null,c),d--)}catch(g){dalert(g)}};this.addSelectedShapesToArray=function(b){try{-1<g_objSelectedShapesArray.indexOf(b)||g_objSelectedShapesArray.push(b)}catch(a){dalert(a)}};this.removeSelectedShapesInArray=function(b){try{if(-1!==g_objSelectedShapesArray.indexOf(b)){var a=g_objSelectedShapesArray.indexOf(b);g_objSelectedShapesArray.splice(a,
1)}}catch(c){dalert(c)}};this.isSelectedShape=function(b){try{return-1<g_objSelectedShapesArray.indexOf(b)}catch(a){dalert(a)}};this.getShapeRectInfo=function(b){try{var a={left:"",top:"",width:"",height:"",rotate:0,horReverse:null,verReverse:null},c=g_objNodeUtil.getRotationAngle(b);0!==c&&(a.rotate=c,b.style.transform="");var e=b.getBoundingClientRect();a.left=e.left;a.top=e.top;a.width=dzeLayoutControl.getValueWithRatio(parseFloat(b.style.width));a.height=dzeLayoutControl.getValueWithRatio(parseFloat(b.style.height));
0!==a.rotate&&(b.style.transform="rotate("+a.rotate+"deg)");var d=1*b.getAttribute("shape_type");if(d===SHAPE_TYPE.LINE_NORMAL||d===SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION||d===SHAPE_TYPE.LINE_ARROW_BI_DIRECTION){var g=g_objShapeEvtMgr.getTransformInfo(b.firstChild.childNodes[1]);a.horReverse=0>g.scale.x;a.verReverse=0>g.scale.y}return a}catch(m){dalert(m)}};this.onUpdateChangedLayout=function(b){try{for(var a,c=duzon_dialog.structShapesLayoutProperty,e,d=[],g,m=0;m<g_objSelectedShapesArray.length;m++){a=
g_objSelectedShapesArray[m];d=[];for(var h=0;h<b.length;h++)switch(b[h]){case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT:switch(c.place.arrangement){case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_IN_TEXT:this.layerController.setShapeLayoutMode(a,SHAPE_LAYOUT_MODE.IN_TEXT);e=g_objNodeUtil.getParentElement(a);!1===fnObjectCheckNull(e)&&!0===e.classList.contains("dze_shape_container")&&(e.style["float"]="");break;case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_LEFT:this.layerController.setShapeLayoutMode(a,SHAPE_LAYOUT_MODE.IN_TEXT);
e=g_objNodeUtil.getParentElement(a);!1===fnObjectCheckNull(e)&&!0===e.classList.contains("dze_shape_container")&&(e.style["float"]="left");break;case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_RIGHT:this.layerController.setShapeLayoutMode(a,SHAPE_LAYOUT_MODE.IN_TEXT);e=g_objNodeUtil.getParentElement(a);!1===fnObjectCheckNull(e)&&!0===e.classList.contains("dze_shape_container")&&(e.style["float"]="right");break;case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_FRONT:this.layerController.setShapeLayoutMode(a,SHAPE_LAYOUT_MODE.FRONT_TEXT);
break;case SHAPES_LAYOUT_DIALOG.RADIO_ARRANGE_BEHIND:this.layerController.setShapeLayoutMode(a,SHAPE_LAYOUT_MODE.BEHIND_TEXT)}break;case SHAPES_LAYOUT_DIALOG.MARGIN_LEFT:g=parseInt(c.place.marginLeft.toFixed(0));d.push([SHAPES_LAYOUT_DIALOG.MARGIN_LEFT,g]);break;case SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT:g=parseInt(c.place.marginRight.toFixed(0));d.push([SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT,g]);break;case SHAPES_LAYOUT_DIALOG.MARGIN_TOP:g=parseInt(c.place.marginTop.toFixed(0));d.push([SHAPES_LAYOUT_DIALOG.MARGIN_TOP,
g]);break;case SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM:g=parseInt(c.place.marginBottom.toFixed(0));d.push([SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM,g]);break;case SHAPES_LAYOUT_DIALOG.PX_HEIGHT:case SHAPES_LAYOUT_DIALOG.PX_WIDTH:var k=parseFloat(c.size.px_width.toFixed(3)),l=parseFloat(c.size.px_height.toFixed(3));this.onUpdateShapeSize(a,k,l,null);break;case SHAPES_LAYOUT_DIALOG.ROTATION_ANGLE:this.setRotationAngle(a,c.size.rotation_angle);break;case SHAPES_LAYOUT_DIALOG.FIXED_RATIO:a.setAttribute("fixed_ratio",
c.size.fixed_ratio)}if("relative"===a.style.position.toLowerCase()&&(e=g_objNodeUtil.getParentElement(a),!1===fnObjectCheckNull(e)&&!0===e.classList.contains("dze_shape_container"))){0<d.length&&g_objShapeCmd.setShapesOuterMargin(e,d);var r=this.updateShapesContainer(a);a.style.left=r[0]+"px";a.style.top=r[1]+"px"}g_objWrapperOutlineUtil_Improved.updateOutline(a)}}catch(p){dalert(p)}};this.onInsertShape=function(b){try{dlog("shapeFunction.onInsertShape");var a=this.createShapeSpan(b);if(!fnObjectCheckNull(a)){var c=
g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("insert_shape_position"),e=g_objNodeUtil.getLoopParentElementByTagNames(c,[DZE_TAG_LI,DZE_TAG_P,DZE_TAG_H1,DZE_TAG_H2,DZE_TAG_H3,DZE_TAG_H4,DZE_TAG_H5,DZE_TAG_H6]);if(!0===fnObjectCheckNull(e)){var d=g_objPageControl.getPageMain(g_objPageControl.currentPage);e=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("p");e.appendChild(g_objEditorDocument[g_objPageControl.nEditNumber].createElement("br"));d.appendChild(e)}var g=
g_objNodeUtil.getLoopHeaderFooterBody(e),m=g_objPageControl.getPageNode(g_objPageControl.currentPage),h=g.getBoundingClientRect(),k=m.getBoundingClientRect(),l=h.top-k.top,r=parseFloat(a.style.left),p=parseFloat(a.style.top);a.style.left=dzeLayoutControl.getValueWithoutRatio(r);a.style.top=dzeLayoutControl.getValueWithoutRatio(p-l);var n=e.childNodes.length;b=null;if(0<n)for(c=0;c<n;c++){var t=e.childNodes[c];if("dze_shape_main"!==t.className||"dze_shape_main"===t.className&&"relative"===t.style.position.toLowerCase()){b=
t;break}}!1===fnObjectCheckNull(b)?e.insertBefore(a,b):e.appendChild(a);a.innerHTML=a.innerHTML.trim();return a}}catch(w){dalert(w)}finally{g_objCaretUtil.restoreCaret(g_objPageControl.nEditNumber,"insert_shape_position")}};this.changeShapesType=function(b){try{for(var a,c,e,d,g,m,h,k,l,r,p=0;p<g_objSelectedShapesArray.length;p++)a=g_objSelectedShapesArray[p],c=1*a.getAttribute("shape_type"),!0!==g_objShapeEvtMgr.isLine(c)&&(e=a.firstChild.childNodes[1],d=e.childNodes[0].firstChild,g=e.childNodes[1].firstChild,
m=parseFloat(a.style.width),h=parseFloat(a.style.height),a.setAttribute("shape_type",b),g_objShapeEvtMgr.setCmdShapeType(b),k=this.getShapesPath(m,h),d.setAttribute("d",k),g.setAttribute("d",k),l=a.childNodes[1],r=g_objShapeEvtMgr.getTransformInfo(e),this.setTextBoxFrameSize(l,r.scale.x,r.scale.y,m,h));g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber)}catch(n){dalert(n)}};this.getRotationAngle=function(b,a,c){try{return a.x-=b.x,a.y-=b.y,c.x-=b.x,c.y-=b.y,a.y*=-1,c.y*=-1,180*(Math.atan2(a.y,
a.x)-Math.atan2(c.y,c.x))/Math.PI}catch(e){dalert(e)}};this.setRotationAngle=function(b,a){try{0>a?a+=360:360<=a&&(a-=360),a=parseInt(a.toFixed(0)),b.style.transform="rotate("+a+"deg)"}catch(c){dalert(c)}};this.makeTransformString=function(b,a,c,e,d,g,m){try{var f="",k=!0===g_browserCHK.edge||!0===g_bBrowserType_IE?" ":", ";f="translate("+b+k+a+") scale("+c+k+e+")";!1===fnObjectCheckNull(d)&&(f+=" rotate("+d+k+g+k+m+")");return f}catch(l){dalert(l)}};this.getGroupRectInfo=function(){try{if(0===g_objSelectedShapesArray.length)return null;
var b=g_objEditorDocument[g_objPageControl.nEditNumber];var a=!1===fnObjectCheckNull(g_objWrapperOutlineUtil_Improved.baseObject)?g_objWrapperOutlineUtil_Improved.baseObject:g_objSelectedShapesArray[0];var c=a.getBoundingClientRect();var e=c.top;var d=c.bottom;var g=c.left;var m=c.right;if(!0===fnObjectCheckNull(g_objWrapperOutlineUtil_Improved.baseObject)&&1<g_objSelectedShapesArray.length)for(var h=1;h<g_objSelectedShapesArray.length;h++)a=b.getElementById(g_objSelectedShapesArray[h].id),c=a.getBoundingClientRect(),
e>c.top&&(e=c.top),d<c.bottom&&(d=c.bottom),g>c.left&&(g=c.left),m<c.right&&(m=c.right);return{top:e,bottom:d,left:g,right:m,horizontalCenter:e+(d-e)/2,verticalCenter:g+(m-g)/2}}catch(k){return dalert(k),null}};this.replaceAnchorClass=function(){try{for(var b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByTagName(DZE_TAG_P),a=null,c=null,e=0;e<b.length;e++)a=b[e],c=a.classList,!1===fnObjectCheckNull(c)&&!0===c.contains("dze_shape_container")&&(!0===this.checkHasShapes(a)&&a.classList.add("dze_shape_anchor"),
g_objPropertyUtil.removeClass(a,"dze_shape_container"));b=g_objEditorDocument[g_objPageControl.nEditNumber].getElementsByTagName(DZE_TAG_LI);for(e=0;e<b.length;e++)a=b[e],c=a.classList,!1===fnObjectCheckNull(c)&&!0===c.contains("dze_shape_container")&&(!0===this.checkHasShapes(a)&&a.classList.add("dze_shape_anchor"),g_objPropertyUtil.removeClass(a,"dze_shape_container"))}catch(f){dalert(f)}};this.checkHasShapes=function(b){try{for(var a,c=0;c<b.childNodes.length;c++)if(a=b.childNodes[c],!1===fnObjectCheckNull(a.classList)&&
!0===a.classList.contains("dze_shape_main"))return!0;return!1}catch(e){dalert(e)}};this.checkHasSketch=function(b){try{for(var a,c=0;c<b.childNodes.length;c++)if(a=b.childNodes[c],!1===fnObjectCheckNull(a.classList)&&!0===a.classList.contains("dze_sketch_main"))return!0;return!1}catch(e){dalert(e)}};this.updateShapesTextFormat=function(){try{var b=function(c,d,e,f){try{if(!0===d.classList.contains("dze_shape_text_span")){var g=a.createElement("span");g.className="dze_shape_text_contents paragraph";
g.style.textAlign=e;c.appendChild(g)}else g=c.lastChild;for(var h=d.childNodes,k,m=0;m<h.length;m++)if(k=h[m],"SPAN"===k.nodeName)if(1<k.childNodes.length)b(c,k,e,f),g=c.lastChild;else{var l=k.cloneNode(!0);l.classList="dze_shape_text_contents sentence";""===l.style.color&&(l.style.color=f===SHAPE_TYPE.SQUARE_TEXTBOX?DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2:DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1);g.appendChild(l)}else 3===k.nodeType?(l=!0===d.classList.contains("dze_shape_text_span")?a.createElement("span"):
d.cloneNode(!1),""===l.style.color&&(l.style.color=f===SHAPE_TYPE.SQUARE_TEXTBOX?DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2:DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1),l.classList="dze_shape_text_contents sentence",l.textContent=k.textContent,g.appendChild(l)):"BR"===k.nodeName?1===h.length?(l=a.createElement("span"),l.style.color=f===SHAPE_TYPE.SQUARE_TEXTBOX?DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_2:DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1,l.classList="dze_shape_text_contents sentence",l.innerHTML="&#8203;",g.appendChild(l)):
m+1<h.length&&(g=a.createElement("span"),g.className="dze_shape_text_contents paragraph",g.style.textAlign=e,c.appendChild(g)):g.appendChild(k)}catch(A){dalert(A)}},a=g_objEditorDocument[g_objPageControl.nEditNumber],c=a.querySelectorAll(".dze_shape_main");if(0<c.length)for(var e,d,g,m,h,k=0;k<c.length;k++)h=c[k],d=h.querySelector(".dze_shape_text_span"),e=null,null!==d&&(e=d.parentNode.cloneNode(!1),e.removeAttribute("id"),e.removeAttribute("contenteditable"),e.className="dze_shape_text_container",
g=e.style.textAlign,g=""!==g?g:"center",m=h.getAttribute("shape_type"),b(e,d,g,m)),null!==e&&(d.parentNode.parentNode.insertBefore(e,d.parentNode),d.parentNode.parentNode.removeChild(d.parentNode))}catch(l){dalert(l)}};this.showShapeText=function(b){try{if(b){var a=b.querySelectorAll(".dze_shape_main");for(b=0;b<a.length;b++)a[b].lastChild&&(a[b].lastChild.style.display="")}}catch(c){dalert(c)}}},g_objShapeFunction=new shapeFunction,g_objShapeEvtMgr=new function(){this.m_nCmdShapeType=SHAPE_TYPE.NONE;
this.getShapeTextContainer=function(){var d=g_objEditorDocument[g_objPageControl.nEditNumber];if(!0===fnObjectCheckNull(d))return null;d=d.getElementById("dze_shape_textbox");return!1===fnObjectCheckNull(d)?d:null};this.setCmdShapeType=function(d){this.m_nCmdShapeType=d};this.getCmdShapeType=function(){return this.m_nCmdShapeType};this.isLine=function(d){var b=SHAPE_TYPE.NONE;d&&(b=d);switch(b){case SHAPE_TYPE.LINE_NORMAL:case SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION:case SHAPE_TYPE.LINE_ARROW_BI_DIRECTION:case SHAPE_TYPE.POLYLINE:return!0}return!1};
this.isSupportRotate=function(d){return d&&(d=1*d.getAttribute("shape_type"),!0===this.isLine(d))?!1:!0};this.getTransformInfo=function(d){try{var b=0,a=0,c=1,e=1,f=0;if(!1===fnObjectCheckNull(d)){var g=d.getAttribute("transform").split(")"),m=g[0].substring(g[0].indexOf("translate")+10),h=g[1].substring(g[1].indexOf("scale")+6),k=g[2].substring(g[2].indexOf("rotate")+7),l=0<m.indexOf(", ")?", ":" ",r=m.split(l);2===r.length?(b=parseFloat(r[0]),a=parseFloat(r[1])):1===r.length&&(b=parseFloat(r[0]),
a=0);l=0<h.indexOf(", ")?", ":" ";var p=h.split(l);2===p.length?(c=1*p[0],e=1*p[1]):1===p.length&&(c=1*p[0],e=1*p[0]);l=0<k.indexOf(", ")?", ":" ";0!==k.length&&0!==k.split(l).length&&(f=parseFloat(k.split(l)[0]))}return{translate:{x:b,y:a},scale:{x:c,y:e},rotate:f}}catch(n){dalert(n)}};this.setInsertMode=function(d){try{g_objShapeEvtMgr.setCmdShapeType(d),g_objWrapperOutlineUtil_Improved.setActionType(CMDMODE.INSERT_READY),g_objWrapperOutlineUtil_Improved.showPreviewField()}catch(b){dalert(b)}};
this.structInsertPoint={x:0,y:0}},g_objShapeCmd=new function(){this.setShapesStyle=function(d){try{for(var b,a,c,e,f,g=0;g<g_objSelectedShapesArray.length;g++){b=g_objSelectedShapesArray[g];f=1*b.getAttribute("shape_type");g_objShapeEvtMgr.isLine(f)||(a=b.childNodes[0].childNodes[1].childNodes[0],a.style.fill=d.fillClr,a.style.fillOpacity=1,c=b.childNodes[1].childNodes[0],c.style.color=d.fontClr,dzeJ(c).find(".dze_shape_text_contents").css("color",""));e=b.childNodes[0].childNodes[1].childNodes[1];
e.style.stroke=d.lineClr;e.style.strokeWidth=1;e.style.strokeOpacity=1;e.style.strokeDasharray=BORDER_STYLE_GRAPHIC.SOLID;b.style.margin="0.5px";f!==SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION&&f!==SHAPE_TYPE.LINE_ARROW_BI_DIRECTION||g_objShapeFunction.updateArrowStyle(b,1,d.lineClr,1);if("relative"===b.style.position.toLowerCase()){var m=g_objNodeUtil.getParentElement(b);if(!1===fnObjectCheckNull(m)&&!0===m.classList.contains("dze_shape_container")){var h=g_objShapeFunction.updateShapesContainer(b);b.style.left=
h[0]+"px";b.style.top=h[1]+"px"}}g_objWrapperOutlineUtil_Improved.updateOutline(b)}DEFAULT_FILL_COLOR=d.fillClr;DEFAULT_LINE_COLOR=d.lineClr;DEFAULTS_SHAPE_TEXTBOX_FONT_COLOR_1=d.fontClr;return!0}catch(k){dalert(k)}};this.getShapesFillColor=function(d){try{if(fnObjectCheckNull(d))return"";var b=1*d.getAttribute("shape_type");if(!0===g_objShapeEvtMgr.isLine(b))return"";var a=d.childNodes[0].childNodes[1].childNodes[0];return fnObjectCheckNull(a)?"":a.style.fill}catch(c){dalert(c)}};this.setShapesFillColor=
function(d,b){try{if(!0===fnObjectCheckNull(d))return!1;if(!0===fnObjectCheckNull(d)||0===d.length)d="none";for(var a=0;a<g_objSelectedShapesArray.length;a++){var c=g_objSelectedShapesArray[a];var e=1*c.getAttribute("shape_type");if(!0!==g_objShapeEvtMgr.isLine(e)){var f=c.childNodes[0].childNodes[1].childNodes[0];f.style.fill=d}}void 0!==b&&b||(DEFAULT_FILL_COLOR=d);return!0}catch(g){dalert(g)}};this.setShapesFillAlpha=function(d){try{var b,a;g_objSelectedShapesArray.forEach(function(c){b=1*c.getAttribute("shape_type");
!0!==g_objShapeEvtMgr.isLine(b)&&(a=c.childNodes[0].childNodes[1].childNodes[0],a.style.fillOpacity=d)});return!0}catch(c){dalert(c)}};this.getShapesStrokeColor=function(d){try{if(fnObjectCheckNull(d))return"";var b=d.childNodes[0].childNodes[1].childNodes[1];return fnObjectCheckNull(b)?"":b.style.stroke}catch(a){dalert(a)}};this.setShapesStrokeColor=function(d,b){try{var a,c;if(!0===fnObjectCheckNull(d)||0===d.length)d="none";g_objSelectedShapesArray.forEach(function(b){a=1*b.getAttribute("shape_type");
c=b.childNodes[0].childNodes[1].childNodes[1];c.style.stroke=d;a!==SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION&&a!==SHAPE_TYPE.LINE_ARROW_BI_DIRECTION||g_objShapeFunction.updateArrowStyle(b,parseInt(c.style.strokeWidth,10),d,c.style.strokeOpacity)});void 0!==b&&b||(DEFAULT_LINE_COLOR=d);return!0}catch(e){dalert(e)}};this.setShapesStrokeAlpha=function(d){try{var b,a;g_objSelectedShapesArray.forEach(function(c){b=1*c.getAttribute("shape_type");a=c.childNodes[0].childNodes[1].childNodes[1];a.style.strokeOpacity=
d;b!==SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION&&b!==SHAPE_TYPE.LINE_ARROW_BI_DIRECTION||g_objShapeFunction.updateArrowStyle(c,parseInt(a.style.strokeWidth,10),a.style.stroke,d)});return!0}catch(c){dalert(c)}};this.setShapesStrokeWidth=function(d){try{var b,a,c,e;g_objSelectedShapesArray.forEach(function(f){b=1*f.getAttribute("shape_type");a=f.childNodes[0].childNodes[1].childNodes[1];a.style.strokeWidth=d;c=parseInt(d)/2;e=[[SHAPES_LAYOUT_DIALOG.MARGIN_LEFT,c],[SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT,c],[SHAPES_LAYOUT_DIALOG.MARGIN_TOP,
c],[SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM,c]];g_objShapeCmd.setShapesOuterMargin(f,e);b!==SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION&&b!==SHAPE_TYPE.LINE_ARROW_BI_DIRECTION||g_objShapeFunction.updateArrowStyle(f,parseInt(d),a.style.stroke,a.style.strokeOpacity);g_objWrapperOutlineUtil_Improved.updateOutline(f)});return!0}catch(f){dalert(f)}};this.setShapesStrokeStyle=function(d){try{var b;g_objSelectedShapesArray.forEach(function(a){nShapeType=1*a.getAttribute("shape_type");b=a.childNodes[0].childNodes[1].childNodes[1];
b.style.strokeDasharray=d;g_objWrapperOutlineUtil_Improved.updateOutline(a)});return!0}catch(a){dalert(a)}};this.setShapesSize=function(d,b){try{return g_objSelectedShapesArray.forEach(function(a){g_objShapeFunction.onUpdateShapeSize(a,d,b);g_objWrapperOutlineUtil_Improved.updateOutline(a)}),!0}catch(a){dalert(a)}};this.setShapesRotation=function(d,b){try{for(var a,c,e=0;e<g_objSelectedShapesArray.length;e++){a=g_objSelectedShapesArray[e];c=g_objNodeUtil.getRotationAngle(a);switch(d){case ID_COMMAND_ROTATE_RIGHT_90:c+=
90;break;case ID_COMMAND_ROTATE_LEFT_90:c-=90;break;case ID_COMMAND_ROTATE_FLIP_VERTICAL:c*=-1;var f=a.firstChild.childNodes[1],g=g_objShapeEvtMgr.getTransformInfo(f),m=parseFloat(a.style.height)*g.scale.y;a.setAttribute("shape_height",m);var h=g_objShapeFunction.makeTransformString(g.translate.x,g.translate.y+m,g.scale.x,-1*g.scale.y);f.setAttribute("transform",h);break;case ID_COMMAND_ROTATE_FLIP_HORIZONTAL:c*=-1;f=a.firstChild.childNodes[1];g=g_objShapeEvtMgr.getTransformInfo(f);var k=parseFloat(a.style.width)*
g.scale.x;a.setAttribute("shape_width",k);h=g_objShapeFunction.makeTransformString(g.translate.x+k,g.translate.y,-1*g.scale.x,g.scale.y);f.setAttribute("transform",h);break;default:!1===fnObjectCheckNull(b)&&(c=b)}g_objShapeFunction.setRotationAngle(a,c);g_objWrapperOutlineUtil_Improved.updateOutline(a)}return!0}catch(l){dalert(l)}};this.setShapesFixedRatio=function(d){try{g_objSelectedShapesArray.forEach(function(b){b.setAttribute("fixed_ratio",d)})}catch(b){dalert(b)}};this.setShapesLayoutMode=
function(d){for(var b,a=0;a<g_objSelectedShapesArray.length;a++){b=g_objSelectedShapesArray[a];switch(d){case ID_COMMAND_TXTLAYOUT_IN_LINE_WITH_TEXT:g_objShapeFunction.layerController.setShapeLayoutMode(b,SHAPE_LAYOUT_MODE.IN_TEXT);var c=g_objNodeUtil.getParentElement(b);!1===fnObjectCheckNull(c)&&!0===c.classList.contains("dze_shape_container")&&(c.style["float"]="");break;case ID_COMMAND_TXTLAYOUT_LEFT_TEXT:g_objShapeFunction.layerController.setShapeLayoutMode(b,SHAPE_LAYOUT_MODE.IN_TEXT);c=g_objNodeUtil.getParentElement(b);
!1===fnObjectCheckNull(c)&&!0===c.classList.contains("dze_shape_container")&&(c.style["float"]="left");break;case ID_COMMAND_TXTLAYOUT_RIGHT_TEXT:g_objShapeFunction.layerController.setShapeLayoutMode(b,SHAPE_LAYOUT_MODE.IN_TEXT);c=g_objNodeUtil.getParentElement(b);!1===fnObjectCheckNull(c)&&!0===c.classList.contains("dze_shape_container")&&(c.style["float"]="right");break;case ID_COMMAND_TXTLAYOUT_BEHIND_TEXT:g_objShapeFunction.layerController.setShapeLayoutMode(b,SHAPE_LAYOUT_MODE.BEHIND_TEXT);break;
case ID_COMMAND_TXTLAYOUT_IN_FRONT_OF_TEXT:g_objShapeFunction.layerController.setShapeLayoutMode(b,SHAPE_LAYOUT_MODE.FRONT_TEXT)}g_objWrapperOutlineUtil_Improved.updateOutline(b)}};this.setShapesVerticalAlign=function(d){try{return g_objSelectedShapesArray.forEach(function(b){!0!==g_objShapeEvtMgr.isLine(1*b.getAttribute("shape_type"))&&(b.childNodes[1].firstChild.style.verticalAlign=d)}),!0}catch(b){dalert(b)}};this.setShapesTextPadding=function(d){try{var b,a,c,e,f;g_objSelectedShapesArray.forEach(function(g){!0!==
g_objShapeEvtMgr.isLine(1*g.getAttribute("shape_type"))&&(b=g.childNodes[1],a=b.firstChild,null!==d[0]&&(a.style.paddingTop=d[0]+"px"),null!==d[1]&&(a.style.paddingRight=d[1]+"px"),null!==d[2]&&(a.style.paddingBottom=d[2]+"px"),null!==d[3]&&(a.style.paddingLeft=d[3]+"px"),null!==d[1]||null!==d[3])&&(c=parseFloat(b.style.width),e=parseFloat(a.style.paddingRight),f=parseFloat(a.style.paddingLeft),!1===isNaN(e)&&(c-=e),!1===isNaN(f)&&(c-=f),a.style.width=c+"px")});return!0}catch(g){dalert(g)}};this.setShapesAlign=
function(d){try{var b={},a=g_objPageControl.getPageRectInfo(1*g_objPageControl.currentPage);1===g_objSelectedShapesArray.length?(b.top=a.innerTop,b.bottom=a.innerBottom,b.left=a.innerLeft,b.right=a.innerRight,b.horizontalCenter=a.innerHorizontalCenter,b.verticalCenter=a.innerVerticalCenter):b=g_objShapeFunction.getGroupRectInfo();for(var c=a=null,e=null,f=null,g=0,m=0;m<g_objSelectedShapesArray.length;m++){a=g_objSelectedShapesArray[m];c=a.getBoundingClientRect();f=g_objNodeUtil.getRotationAngle(a);
0!==f&&(a.style.transform="",e=a.getBoundingClientRect(),g=e.left-c.left,0!==f&&(a.style.transform="rotate("+f+"deg)"));switch(d){case ID_COMMAND_OBJ_ALIGN_LEFT:a.style.left=dzeLayoutControl.getValueWithoutRatio(dzeLayoutControl.getValueWithRatio(parseFloat(a.style.left))-(c.left-b.left)+g)+"px";break;case ID_COMMAND_OBJ_ALIGN_CENTER:a.style.left=dzeLayoutControl.getValueWithoutRatio(dzeLayoutControl.getValueWithRatio(parseFloat(a.style.left))-(c.left-b.verticalCenter)-c.width/2+g)+"px";break;case ID_COMMAND_OBJ_ALIGN_RIGHT:a.style.left=
dzeLayoutControl.getValueWithoutRatio(dzeLayoutControl.getValueWithRatio(parseFloat(a.style.left))-(c.left-b.right)-c.width+g)+"px";break;case ID_COMMAND_OBJ_ALIGN_TOP:a.style.top=dzeLayoutControl.getValueWithoutRatio(dzeLayoutControl.getValueWithRatio(parseFloat(a.style.top))-(c.top-b.top))+"px";break;case ID_COMMAND_OBJ_ALIGN_MIDDLE:a.style.top=dzeLayoutControl.getValueWithoutRatio(dzeLayoutControl.getValueWithRatio(parseFloat(a.style.top))-(c.top-b.horizontalCenter)-c.height/2)+"px";break;case ID_COMMAND_OBJ_ALIGN_BOTTOM:a.style.top=
dzeLayoutControl.getValueWithoutRatio(dzeLayoutControl.getValueWithRatio(parseFloat(a.style.top))-(c.top-b.bottom)-c.height)+"px"}g_objWrapperOutlineUtil_Improved.updateOutline(a)}return!0}catch(h){dalert(h)}};this.setShapesOuterMargin=function(d,b){try{for(var a=0;a<b.length;a++)switch(b[a][0]){case SHAPES_LAYOUT_DIALOG.MARGIN_LEFT:d.style.marginLeft=b[a][1]+"px";break;case SHAPES_LAYOUT_DIALOG.MARGIN_RIGHT:d.style.marginRight=b[a][1]+"px";break;case SHAPES_LAYOUT_DIALOG.MARGIN_TOP:d.style.marginTop=
b[a][1]+"px";break;case SHAPES_LAYOUT_DIALOG.MARGIN_BOTTOM:d.style.marginBottom=b[a][1]+"px"}}catch(c){dalert(c)}};this.setArrowStyle=function(d){try{for(var b,a,c,e,f=0;f<g_objSelectedShapesArray.length;f++)if(b=g_objSelectedShapesArray[f],a=1*b.getAttribute("shape_type"),!1!==g_objShapeEvtMgr.isLine(a)){c=g_objShapeFunction.lineFunction.getArrowInfo(d);e=g_objShapeFunction.lineFunction.updateLineArrowDefines(b,c);g_objShapeFunction.lineFunction.updateHeadAngle(b);a=!0===fnObjectCheckNull(c)?SHAPE_TYPE.LINE_NORMAL:
1===c.length?SHAPE_TYPE.LINE_ARROW_UNI_DIRECTION:SHAPE_TYPE.LINE_ARROW_BI_DIRECTION;b.setAttribute("shape_type",a);g_objShapeEvtMgr.setCmdShapeType(a);var g=b.firstChild.childNodes[1].childNodes[3],m=parseInt(b.firstChild.childNodes[1].childNodes[1].style.strokeWidth);g_objShapeFunction.lineFunction.setLineArrow(g,e);g.style.strokeWidth=g_objShapeFunction.lineFunction.getScaleSize(m,LINE_ARROW_SIZE.NORMAL);b.innerHTML=b.innerHTML.trim();g_objWrapperOutlineUtil_Improved.updateOutline(b)}return!0}catch(h){dalert(h)}}};
var pageManager=new function(){var k,d,m,l;function v(){return{getCopiedPage:function(){return l},setCopiedPage:function(c){l=c},getControlPageNumber:function(){return m},setControlPageNumber:function(c){m=c},initValues:function(){l=null;m=-1;r(!1)},onReady:function(){a:{try{var c=document.createElement("div"),b=document.createElement("div");c.id="dze_add_page_main_container";c.className="dze_add_page_main_container";c.setAttribute("contenteditable","false");c.style.display="none";!0===g_browserCHK.mobile&&
(c.style.opacity=1);b.className="dze_add_page_button_container";b.setAttribute("contenteditable","false");b.appendChild(t(!0));b.appendChild(t(!1));c.appendChild(b);var a=c;break a}catch(f){dalert(f)}a=void 0}d=g_objInsertUtil.insertLayerHTML(a.outerHTML,!1);u(d.firstChild.firstChild,!0);u(d.firstChild.lastChild,!1)},unload:function(){var c=d;c&&c.parentNode&&c.parentNode.removeChild(c);k=d=null},doInsertNewPage:function(c,b){try{var a=g_objPageControl,f=a.makePageContainer(b,!0);b+1!==a.getTotalPageCount()&&
g_objNodeUtil.removeAllChild(f);var e=a.createPageBreak();b+1<a.getTotalPageCount()&&f.appendChild(e);if(c!==b){var d=a.getPageMain(c);if(d){var g=d.lastChild;g&&0<=a.arrPageBreakElement.indexOf(g.nodeName)?g_objPropertyUtil.addClass(g,a.DZE_PAGE_BREAK_PARA):(!0===fnObjectCheckNull(g)||!0===fnObjectCheckNull(g.classList)||!1===g.classList.contains("dze_page_break_para"))&&d.appendChild(e.cloneNode(!0))}}a.setDirtyRange(b,null,!0);a.currentPage=b;a.onSetDelayedUpdatePageTimer();f.focus();return!0}catch(h){dalert(h)}},
doCopyPage:function(c){c=c.cloneNode(!0);g_objCopyPaste.adjustCopyContents(c.querySelector(".dze_page_main"));this.setCopiedPage(c);r(!0);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_COPIED,1.5,"screen_center")},doPastePage:function(c,b){try{if(null===l)return!1;var a=g_objPageControl,f=l.cloneNode(!0),e=f.querySelector(".dze_page_main"),d=f.ownerDocument.createDocumentFragment();g_objNodeUtil.moveNodesTo(d,e.firstChild);e=a.makePageContainer(b,!0);f=e.parentNode;g_objNodeUtil.removeAllChild(e);
e.appendChild(d);var g=a.createPageBreak();if(b+1<a.getTotalPageCount()){var h=e.lastChild;h&&0<=a.arrPageBreakElement.indexOf(h.nodeName)?g_objPropertyUtil.addClass(h,a.DZE_PAGE_BREAK_PARA):(!0===fnObjectCheckNull(h)||!0===fnObjectCheckNull(h.classList)||!1===h.classList.contains("dze_page_break_para"))&&e.appendChild(g)}if(!0===c){var k=f.previousElementSibling.childNodes[1];if((h=k.lastChild)&&0<=a.arrPageBreakElement.indexOf(h.nodeName))g_objPropertyUtil.addClass(h,a.DZE_PAGE_BREAK_PARA);else if(!0===
fnObjectCheckNull(h)||!0===fnObjectCheckNull(h.classList)||!1===h.classList.contains("dze_page_break_para"))g=g.cloneNode(!0),k.appendChild(g)}a.setDirtyRange(b,null,!0);a.setStatusPageNum(b);a.onSetDelayedUpdatePageTimer(0,b);e.focus();return!0}catch(w){return dalert(w),!1}},updatePageAddButton:function(c){try{if(!c||!d)return!1;var b=c.target||c.srcElement;if(!b)return!1;var a=!1,f=null,e=g_objPropertyUtil;"DIV"===b.nodeName&&e.hasClass(b,"dze_page_margin_top")?(a=!0,f=b):"DIV"===b.nodeName&&e.hasClass(b,
"dze_page_margin_bottom")&&(a=!1,f=b);k&&(k.style.width="",""===k.style.cssText&&k.removeAttribute("style"),k=null);if(f){k=f;f.style.width="calc(100% + 100px)";b=g_objPositionUtil;e=24;var p=g_objPageControl,g=p.getPageNum(f);a&&0===g?e=16:a||g!==p.getTotalPageCount()-1||(e=32);var h=b.getElementPosClientRect(f),l=dzeUiConfig.bMobileHybridEdit?b.getEmptyRect():b.getElementPosition(g_objEditObject[c.nEditNumber],!1);b.moveRect(h,l.left,l.top);var n=g_objZoom.getDocZoomValue()/100,m=d.style;m.left=
h.right-(g_bBrowserType_IE?78:88)*n+"px";m.top=a?h.top-e+"px":h.bottom-e+"px";m.display="";d.setAttribute("page_num",a?g:g+1)}else this.isShowButtonContainer()&&this.hideButtonContainer();return!0}catch(x){dalert(x)}},isShowButtonContainer:function(){return d&&"none"!==d.style.display?!0:!1},hideButtonContainer:function(){try{!1===fnObjectCheckNull(d)&&(d.style.display="none")}catch(c){dalert(c)}}}}function t(c){try{var b=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div"),a=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("img");
b.className="dze_add_page_button";b.setAttribute("contenteditable","false");a.className="dze_add_page_button_img";a.setAttribute("contenteditable","false");!0===c?(b.title=ID_RES_CONST_STRING_INSERT_EMPTY_PAGE,a.src=dzeEnvConfig.strPath_Image+"toolbar/ico_page_add.png",b.style.margin="5px 2px 0px 4px"):(b.title=ID_RES_CONST_STRING_PASTE_PAGE,a.src=dzeEnvConfig.strPath_Image+"toolbar/ico_paste.png",b.style.margin="5px 3px 0px 3px",b.style.display="none");b.appendChild(a);return b}catch(f){dalert(f)}}
function u(c,b){try{c.onmouseout=function(){q(!1,b)},c.onmousedown=function(a){TBCancelBubbleEvent(a);q(!0,b)},c.onmouseup=function(){var a=g_objPageControl,c=a.nEditNumber;g_objShapeFunction.onDeselectAllShapes();g_objWrapperOutlineResize.resetExtOutlineInfo();g_objTableFlag.ResetTableInfo(!1);g_objTableMiniMenu.showTableMiniMenu(!1,null,c);g_objContextMenuWin.initContextMenuLayerEvent();q(!1,b);var e=pageManager.getInstance();if(!0===b)a=parseInt(d.getAttribute("page_num"),10),e=e.doInsertNewPage(a-
1,a),!0===e&&(g_objUndoRedo.registerUndoRedoStack(0,c),editor_onselectionchange(c));else{var k=parseInt(d.getAttribute("page_num"),10),g=!1;k===g_objPageControl.getTotalPageCount()&&(g=!0);e=e.doPastePage(g,k);!0===e&&(e=a.currentPage,a.currentPage=k,g_objUndoRedo.registerUndoRedoStack(0,c),a.currentPage=e,editor_onselectionchange(c))}}}catch(a){dalert(a)}}function q(c,b){try{if(!1===fnObjectCheckNull(d)){var a=d.firstChild.firstChild,f=d.firstChild.lastChild,e="none"===f.style.display;!0===c?(!0===
b&&(a.style.marginLeft=!0===e?"3px":"6px",a.style.marginTop="4px"),f.style.marginLeft="2px",f.style.marginTop="4px"):(!0===b&&(a.style.marginLeft=!0===e?"4px":"7px",a.style.marginTop="5px"),f.style.marginLeft="3px",f.style.marginTop="5px")}}catch(p){dalert(p)}}function r(c){try{!0!==fnObjectCheckNull(d)&&(!0===c?(g_objPropertyUtil.addClass(d,"two"),d.firstChild.lastChild.style.display="",d.firstChild.firstChild.style.marginLeft="7px"):(g_objPropertyUtil.removeClass(d,"two"),d.firstChild.lastChild.style.display=
"none",d.firstChild.firstChild.style.marginLeft="4px"))}catch(b){dalert(b)}}return{getInstance:function(){!0===fnObjectCheckNull(n)&&(n=v(),n.initValues());return n}};var n};
function DzeContextButton(){this.fadeTimer=this.container=null;this.MIN_OPACITY=.3;this.arrTempItem=[];this.onclick=null;this.getHTML=function(){return"<div style='height: 27px;'></div>"};this.createItem=function(a){a="<div class='dze_context_btn_item'><div class='dze_context_btn_sep'></div>"+("<div class='dze_context_btn_text'>"+a+"</div>")+"<div class='dze_context_btn_sep'></div></div>";return document.createRange().createContextualFragment(a)};this.setContainer=function(a){this.container=a};this.setItemListener=
function(a){var b=this,c=null;a.onmousedown=function(a){TBCancelBubbleEvent(a)};a.onmouseover=function(){this.style.opacity="1";clearInterval(c)};a.onmouseout=function(){var a=parseFloat(this.style.opacity),e=this;c=setInterval(function(){if(!a||a-.1<=b.MIN_OPACITY)a=b.MIN_OPACITY+.1,clearInterval(c);a-=.1;g_objPropertyUtil.setOpacity(e,a)},10)};a.onclick=function(){b.onclick(a.childNodes[1].innerHTML)}};this.doItem=function(a){if(this.container)for(var b=this.container.childNodes,c=0,d=b.length;c<
d;c++)a(b[c],c)};this.doItemText=function(a){this.doItem(function(b,c){a(b.childNodes[1],c)})};this.setText=function(){if(this.container){var a=[].slice.call(arguments),b=a.length;if(!(1>b)){var c=this.container.childNodes.length,d=null;if(b<c){var e=0;for(b=c-b;e<b;e++)d=this.container.lastChild,this.container.removeChild(d),this.arrTempItem.push(d)}else if(b>c)for(e=0,b-=c;e<b;e++)d=this.arrTempItem.pop(),d||(d=this.createItem(""),this.setItemListener(d.firstChild)),this.container.appendChild(d);
this.doItemText(function(b,c){b.innerHTML=a[c]})}}}}
var g_objPasteOptionMenu=new function(){this.nEditNumber=0;this.bShow=!1;this.pasteContentsType=0;this.bOperating=!1;this.wheelEndTimer=this.showTimer=this.pasteMenuDiv=this.pasteEndNode=this.arrPasteDiv=null;this.WHEEL_DEALY=100;this.caretSelection=null;this.contextButton=new DzeContextButton;this.init=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return!1;this.nEditNumber=a;this.bShow=!1;this.pasteEndNode=this.arrPasteDiv=null;this.wheelEndTimer&&(clearTimeout(this.wheelEndTimer),this.wheelEndTimer=
null);null!==this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null);if(!this.pasteMenuDiv){var b=g_objLayerKit.getLayerDocument(),c=b.createElement("div");c.id="dze_paste_option_menu_"+a;c.className="dze_dic_search_btn_container";c.style.display="none";c.style.zIndex="auto";c.innerHTML=this.contextButton.getHTML();b.body.appendChild(c);this.pasteMenuDiv=c;this.contextButton.setContainer(c.firstChild);var d=this;this.contextButton.onclick=function(a){d.doPasteOption(a)};c.addEventListener("wheel",
function(a){d.hide();clearTimeout(d.wheelEndTimer);d.wheelEndTimer=setTimeout(function(){d.show(!1)},d.WHEEL_DEALY)},!1)}}catch(e){dalert(e)}};this.unload=function(){try{this.wheelEndTimer&&(clearTimeout(this.wheelEndTimer),this.wheelEndTimer=null),null!==this.showTimer&&(clearTimeout(this.showTimer),this.showTimer=null),this.pasteMenuDiv&&this.pasteMenuDiv.parentNode&&this.pasteMenuDiv.parentNode.removeChild(this.pasteMenuDiv),this.pasteMenuDiv=null}catch(a){dalert(a)}};this.setEditNumber=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;
this.nEditNumber=a;return this}catch(b){dalert(b)}};this.setPasteContentType=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;this.pasteContentsType=a;a==g_objCopyPaste.PASTE_TABLE?this.contextButton.setText(ID_RES_CONST_STRING_INSERT_AS_NESTED_TABLE,ID_RES_CONST_STRING_PASTE_CELL_OVER_CONTENT):this.contextButton.setText(ID_RES_CONST_STRING_KEEP_TEXT_ONLY);return this}catch(b){dalert(b)}};this.setPasteDiv=function(a,b){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;this.arrPasteDiv||
(this.arrPasteDiv=[]);this.arrPasteDiv[b||0]=a.cloneNode(!0);return this}catch(c){dalert(c)}};this.setPasteEndNode=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu)return this;this.pasteEndNode=a;return this}catch(b){dalert(b)}};this.isShow=function(){return this.bShow};this.isOperating=function(){return this.bOperating};this.show=function(a){try{dzeUiConfig.bUsePasteOptionMenu&&this.arrPasteDiv&&this.pasteEndNode&&this.pasteEndNode.parentNode&&!this.bShow&&!g_readonlyMode&&(this.bShow=!0,clearTimeout(this.showTimer),
this.showTimer=setTimeout(function(){this.pasteMenuDiv.style.display="block";this.setLayerPosition();this.showTimer=null}.bind(this),0))}catch(b){dalert(b)}};this.hide=function(){try{dzeUiConfig.bUsePasteOptionMenu&&this.bShow&&(this.bShow=!1,this.showTimer&&clearTimeout(this.showTimer),this.pasteMenuDiv&&(this.pasteMenuDiv.style.display="none",this.pasteMenuDiv.style.top="-100px",this.pasteMenuDiv.style.left=""))}catch(a){dalert(a)}};this.remove=function(){try{if(dzeUiConfig.bUsePasteOptionMenu){this.hide();
var a=this.pasteEndNode;if(a&&a.parentNode&&"SPAN"===a.nodeName)if(g_objNodeUtil.normalize(a),a.firstChild){var b=a.ownerDocument.createDocumentFragment();g_objNodeUtil.moveNodesTo(b,a.firstChild);a.parentNode.replaceChild(b,a)}else a.parentNode.removeChild(a);this.pasteEndNode=null}}catch(c){dalert(c)}};this.setLayerPosition=function(){try{if(!dzeUiConfig.bUsePasteOptionMenu||!this.pasteEndNode)return!1;if(!g_objNodeUtil.isAlive(this.pasteEndNode))return this.pasteEndNode=null,!1;var a=g_objPositionUtil.getElementPosition(g_objEditObject[this.nEditNumber],
!1),b=g_objPositionUtil.getFrameClientRect();a=g_objPositionUtil.moveRect(a,b.left,b.top);var c=g_objPositionUtil.getElementPosClientRect(this.pasteEndNode),d=a.top+c.bottom,e=a.left+c.right,f=this.pasteMenuDiv.offsetWidth;e+(f+1)>=a.right&&(e=a.right-(f+1));b=!0;if(d<=a.top||d+15>=a.bottom)b=!1;b?(this.pasteMenuDiv.style.top=d+"px",this.pasteMenuDiv.style.left=e+"px"):(this.pasteMenuDiv.style.top="-100px",this.pasteMenuDiv.style.left="")}catch(g){dalert(g)}};this.onWheel=this.onZoom=function(a){try{if(!dzeUiConfig.bUsePasteOptionMenu||
!this.bShow)return!1;this.hide();clearTimeout(this.wheelEndTimer);this.wheelEndTimer=setTimeout(function(){g_objPasteOptionMenu.show(!1)},this.WHEEL_DEALY)}catch(b){dalert(b)}};this.getPasteDiv=function(a){try{var b=this.arrPasteDiv[a];if(b)return b;var c=this.arrPasteDiv[KEEP_SOURCE_FORMMAT];if(c){if(a===KEEP_TEXT_ONLY)return b=this.createKeepTextOnlyPasteDiv(c),this.arrPasteDiv[a]=b;if(a===INSERT_AS_NESTED_TABLE||a===KEEP_ORG_TABLE_FORMMAT)return b=c.cloneNode(!0),this.arrPasteDiv[a]=b}return null}catch(d){dalert(d)}};
this.createKeepTextOnlyPasteDiv=function(a){try{var b=a.ownerDocument,c=a.cloneNode(!0);c.style.whiteSpace="nowrap";b.body.appendChild(c);var d=this.keepImgBefore(c);g_objTableOperation.convertChildTableToText(c,!1);var e=this.getInnerText(c);e=this.keepImgAfter(e,d);c.innerHTML="<p>"+e+"</p>";b.body.removeChild(c);return c}catch(f){dalert(f)}};this.getInnerText=function(a){try{if(!a)return"";var b=a.innerText;b=b.replace(/</g,"&lt");b=b.replace(/>/g,"&gt");b=b.replace(/\t/g,'<span class="tabSpan">\t</span>');
return b=b.replace(/(?:\r\n|\r|\n){1,}/g,"<br>")}catch(c){dalert(c)}};this.keepImgBefore=function(a){try{if(a){var b=a.ownerDocument;if(b){var c=a.querySelectorAll("img");c=[].slice.call(c);forEach(c,function(a,c){a=b.createTextNode("{dze_keep_img_id:"+a+"}");c.parentNode.replaceChild(a,c)},this);return c}}}catch(d){dalert(d)}};this.keepImgAfter=function(a,b){try{if(a&&b)return a=a.replace(/{dze_keep_img_id:[0-9]+}/g,function(a){try{var c=a.substring(17,a.length-1);c=parseInt(c,10);var e=b[c];return e?
e.outerHTML:""}catch(f){return dalert(f),""}})}catch(c){dalert(c)}};this.doPasteOption=function(a){try{if(dzeUiConfig.bUsePasteOptionMenu){var b=0;switch(a){case ID_RES_CONST_STRING_KEEP_TEXT_ONLY:b=KEEP_TEXT_ONLY;break;case ID_RES_CONST_STRING_PASTE_CELL_OVER_CONTENT:b=KEEP_ORG_TABLE_FORMMAT;break;case ID_RES_CONST_STRING_PASTE_CELL_OVER_ALL:b=PASTE_CELL_FORMMAT;break;case ID_RES_CONST_STRING_PASTE_CELL_INSERT:b=INSERT_AS_NEW_ROWS;break;case ID_RES_CONST_STRING_INSERT_AS_NESTED_TABLE:b=INSERT_AS_NESTED_TABLE}this.doPasteFormat(b);
this.hide()}}catch(c){dalert(c)}};this.doPasteFormat=function(a){try{this.bOperating=!0;var b=this.nEditNumber,c=g_objEditorDocument[b],d=c.getElementById("dze_document_main_container"),e=d?d.scrollTop:-1;g_objUndoRedo.operateUndoRedoStack(!0,!0,b,!0);(d=c.getElementById("dze_document_main_container"))&&0<=e&&(d.scrollTop=e);var f=g_objEditWindow[b],g=f?f.getSelection():null,h=g&&0<g.rangeCount?g.getRangeAt(0):null;if(!h||!h.commonAncestorContainer)return!1;if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer(0,
null,function(){g_objCaretUtil.scrollToCaret()});c=g_objCopyPaste;var k=this.getPasteDiv(a),l=c.objPasteDiv;c.setPasteDiv(k.cloneNode(!0));var m=dzeClipBoard.pasteType;dzeClipBoard.pasteType=a===INSERT_AS_NESTED_TABLE?INSERT_AS_NESTED_TABLE:a===KEEP_ORG_TABLE_FORMMAT?KEEP_ORG_TABLE_FORMMAT:"";var n=c.pasteAfter(null,b);c.setPasteDiv(l);dzeClipBoard.pasteType=m;n&&g_objUndoRedo.registerUndoRedoStack(0,b);g_objPasteOptionMenu.remove()}catch(p){dalert(p)}finally{this.bOperating=!1,h=null}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(p,z,t){p instanceof String&&(p=String(p));for(var A=p.length,B=0;B<A;B++){var L=p[B];if(z.call(t,L,B,p))return{i:B,v:L}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(p,z,t){p!=Array.prototype&&p!=Object.prototype&&(p[z]=t.value)};$jscomp.getGlobal=function(p){return"undefined"!=typeof window&&window===p?p:"undefined"!=typeof global&&null!=global?global:p};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(p,z,t,A){if(z){t=$jscomp.global;p=p.split(".");for(A=0;A<p.length-1;A++){var B=p[A];B in t||(t[B]={});t=t[B]}p=p[p.length-1];A=t[p];z=z(A);z!=A&&null!=z&&$jscomp.defineProperty(t,p,{configurable:!0,writable:!0,value:z})}};$jscomp.polyfill("Array.prototype.find",function(p){return p?p:function(p,t){return $jscomp.findInternal(this,p,t).v}},"es6","es3");
var panelManager=new function(){function p(){z();return{getCurrentPanelType:function(){return!0===J?F:F=PANEL_MAIN_TYPE.NONE},getCreatePanelContentsFn:function(){return G},isShowPanel:function(){return J},showPanel:function(c,a){try{t(c);L(c);T(dzeJ(".dze_panel_tab_menu").eq(!1===fnObjectCheckNull(a)?a:0));switch(c){case PANEL_MAIN_TYPE.CLOUD_FILE:dzeJ(document.getElementById("dze_idx_information_panel")).animate({right:"0px",opacity:1},200);break;case PANEL_MAIN_TYPE.DOC_OPEN_INFO:case PANEL_MAIN_TYPE.DOC_COMMENT:case PANEL_MAIN_TYPE.DOC_CHART:case PANEL_MAIN_TYPE.DOC_SHAPES:case PANEL_MAIN_TYPE.NEWS_SEND_INFO:case PANEL_MAIN_TYPE.DOC_WEBSEARCH:case PANEL_MAIN_TYPE.ETC:var b=
dzeJ("#dze_idx_right_pannel_td_"+g_objPageControl.nEditNumber)[0];"none"===b.style.display&&(b.style.display="",duzon_dialog.fade("in",b),resizeEditor_Height(g_objPageControl.nEditNumber),g_objSelectedShapesArray.forEach(function(a){g_objWrapperOutlineUtil_Improved.updateOutline(a)}),pageManager.getInstance().hideButtonContainer())}if(c!==PANEL_MAIN_TYPE.DOC_SHAPES)g_objShapeFunction.onDeselectAllShapes();c!==PANEL_MAIN_TYPE.DOC_CHART&&(resetSelectionObjectInfo(),g_objWrapperOutlineResize.resetExtOutlineInfo_call());
g_objTableMiniMenu.update();g_objRulerBar.update(null,!0);J=!0}catch(d){dalert(d)}},hidePanel:function(){try{switch(F){case PANEL_MAIN_TYPE.CLOUD_FILE:var c=document.getElementById("dze_idx_information_panel");dzeJ(c).animate({right:"-361px",opacity:0},200);setTimeout(function(){dzeJ(c).empty()},200);break;case PANEL_MAIN_TYPE.DOC_OPEN_INFO:case PANEL_MAIN_TYPE.DOC_COMMENT:case PANEL_MAIN_TYPE.DOC_CHART:case PANEL_MAIN_TYPE.DOC_SHAPES:case PANEL_MAIN_TYPE.DOC_WEBSEARCH:case PANEL_MAIN_TYPE.ETC:var a=
dzeJ("#dze_idx_right_pannel_td_"+g_objPageControl.nEditNumber)[0];"none"!==a.style.display&&(a.style.display="none",resizeEditor_Height(g_objPageControl.nEditNumber),DzeSpinner.closePanel(),dzeJ(".dze_style_right_pannel").empty(),F===PANEL_MAIN_TYPE.DOC_SHAPES?g_objSelectedShapesArray.forEach(function(a){g_objWrapperOutlineUtil_Improved.updateOutline(a)}):F===PANEL_MAIN_TYPE.DOC_CHART&&(onefficeChart.removeChartCanvasAll(),showExtOutline_ObjectElement(dze_menu_control.currControlObject,!0,!1,g_objPageControl.nEditNumber)),
pageManager.getInstance().hideButtonContainer())}g_objTableMiniMenu.update();g_objRulerBar.update(null,!0);J=!1}catch(b){dalert(b)}},updatePanel:function(c,a){try{if(!1!==J)if(c!==F)dzeJ(".dze_panel_container").remove(),this.showPanel(c,a);else{a=null;switch(c){case PANEL_MAIN_TYPE.DOC_WEBSEARCH:y(PANEL_TYPE.WEBSEARCH_ENCYCLOPEDIA);y(PANEL_TYPE.WEBSEARCH_IMAGE);y(PANEL_TYPE.WEBSEARCH_NEWS);break;case PANEL_MAIN_TYPE.DOC_SHAPES:y(PANEL_TYPE.SHAPES_FORMAT);y(PANEL_TYPE.SHAPES_EXTRA);break;case PANEL_MAIN_TYPE.DOC_CHART:y(PANEL_TYPE.CHART_ATTR_STYLE);
break;case PANEL_MAIN_TYPE.DOC_OPEN_INFO:y(PANEL_TYPE.DOC_USER_INFO);a="tab_contents_doc_user_info";break;case PANEL_MAIN_TYPE.DOC_COMMENT:y(PANEL_TYPE.DOC_COMMENT);a="tab_contents_doc_comment";break;case PANEL_MAIN_TYPE.ETC:y(PANEL_TYPE.ETC_MEMO),y(PANEL_TYPE.ETC_TODO)}null!==a&&dzeJ("#"+a).addClass("activate")}}catch(b){dalert(b)}},selectPanelTab:function(c){try{!1===isNaN(c)&&!1===dzeJ("ul.dze_panel_tab_container li").eq(c).hasClass("activate")&&dzeJ("ul.dze_panel_tab_container li").eq(c).trigger("click")}catch(a){dalert(a)}},
isShowDocOpenPanelInfo:function(){return!0===J&&F===PANEL_MAIN_TYPE.DOC_OPEN_INFO?!0:!1}}}function z(){try{F=PANEL_MAIN_TYPE.NONE,w=E=null,J=!1,G={addTabMenu:function(c,a,b){try{var d=document.createElement("li");d.className="dze_panel_tab_menu";if(0<=c.search("search_content")||0<=c.search("_etc"))d.className+=" dze_panel_tab_menu_text";d.setAttribute("dze_tab_contents",c);c=null;fnObjectCheckNull(a)?d.innerHTML=b:(c=document.createElement("img"),c.src=a,c.title=b,dzeJ(c).mousedown(function(a){TBCancelBubbleEvent(a)}),
d.appendChild(c));return d}catch(e){dalert(e)}},addTabEventListener:function(){try{dzeJ("ul.dze_panel_tab_container li").click(function(){var c=dzeJ(this);if(!0===c.hasClass("activate")){var a=c.attr("dze_tab_contents");"tab_contents_doc_user_info"!==a&&"tab_contents_doc_comment"!==a||0<dzeJ(".dze_panel_loading_img").length||"tab_contents_doc_user_info"===a&&0<dzeJ(".dze_panel_doc_user_request_btn.request").length||(c=document.createElement("div"),c.className="dze_panel_loading_img",c.style.width=
"34px",c.style.height="34px",c.style.backgroundImage="url(./image/oneffice_loading_02.gif)",c.style.backgroundSize="34px 34px",c.style.backgroundRepeat="no-repeat",c.style.display="inline-block",c.style.position="absolute",c.style.left="calc(50% - 17px)",c.style.top="150px","tab_contents_doc_user_info"===a?y(PANEL_TYPE.DOC_USER_INFO):"tab_contents_doc_comment"===a&&y(PANEL_TYPE.DOC_COMMENT),w.appendChild(c),setTimeout(function(){dzeJ(".dze_panel_loading_img").remove();dzeJ("#"+a).addClass("activate").hide().slideDown()},
1E3))}else{dzeJ("ul.dze_panel_tab_container li").removeClass("activate");dzeJ(".dze_panel_contents").removeClass("activate");for(var b=dzeJ("ul.dze_panel_tab_container img"),d=null,e=0;e<b.length;e++)d=b[e].getAttribute("src"),d=d.substring(0,d.lastIndexOf("_"))+"_off.png",b[e].src=d;T(c)}}).mouseenter(function(){var c=dzeJ(this);if(!0!==c.hasClass("activate")){var a=c[0].firstElementChild;a&&0<=a.className.search("dze_panel_tab")&&((a=c[0].firstElementChild.getAttribute("src"))&&(a=a.substring(0,
a.lastIndexOf("_"))+"_over.png"),c[0].firstElementChild.src=a)}}).mouseleave(function(){var c=dzeJ(this);if(!0!==c.hasClass("activate")){var a=c[0].firstElementChild;a&&0<=a.className.search("dze_panel_tab")&&((a=c[0].firstElementChild.getAttribute("src"))&&(a=a.substring(0,a.lastIndexOf("_"))+"_off.png"),c[0].firstElementChild.src=a)}})}catch(c){dalert(c)}},addContentBox:function(c,a){try{var b=document.createElement("div");b.id=c;b.className="dze_panel_box";var d=document.createElement("div");d.className=
"dze_panel_box_close";var e=document.createElement("div");e.innerHTML=a;e.className="dze_panel_box_close_title";var f=document.createElement("img");f.className="dze_panel_box_close_icon";f.src="./image/cloud/btn_panel_history_month_close.png";d.appendChild(e);d.appendChild(f);b.appendChild(d);dzeJ(d).click(function(){var a=dzeJ(this);!0===a.hasClass("open")?(a.removeClass("open"),a[0].lastChild.src="./image/cloud/btn_panel_history_month_close.png",a[0].parentElement.classList.remove("open"),a.next().slideUp()):
(ca(a.parent()),a.addClass("open"),a[0].lastChild.src="./image/cloud/btn_panel_history_month_open.png",a.next().slideDown(function(){dzeJ(this).css("display","block")}),a[0].parentElement.classList.add("open"))}).mouseenter(function(){var a=dzeJ(this);!0!==a.hasClass("open")&&a.addClass("over")}).mouseleave(function(){var a=dzeJ(this);!0!==a.hasClass("open")&&a.removeClass("over")});b.appendChild(da(c));return b}catch(g){dalert(g)}},addCheckBox:function(c,a){try{var b=document.createElement("div");
b.style.height="27px";b.style.verticalAlign="middle";var d=document.createElement("input");d.id=c;d.type="checkbox";d.value="1";var e=document.createElement("label");e.setAttribute("for",c);e.textContent=a;b.appendChild(d);b.appendChild(e);return b}catch(f){dalert(f)}},addRadioSet:function(c,a){try{for(var b=document.createElement("div"),d=0;d<c.length;d++){var e=document.createElement("div");e.style.height="27px";e.style.verticalAlign="middle";var f=document.createElement("input");f.id=c[d].id;f.type=
"radio";f.checked=!1;f.name=a;var g=document.createElement("label");g.setAttribute("for",c[d].id);g.textContent=c[d].title;e.appendChild(f);e.appendChild(g);b.appendChild(e)}return b}catch(h){dalert(h)}},addBoxDetail:function(c,a){var b=document.createElement("div");b.className="dze_panel_table_div";var d=document.createElement("div");d.style.display="table-cell";d.style.verticalAlign="middle";d.style.width="100px";d.textContent=c;b.appendChild(d);!1===fnObjectCheckNull(a)&&(c=document.createElement("div"),
c.style.display="table-cell",c.style.verticalAlign="middle",c.textContent=a,b.appendChild(c));a=document.createElement("div");a.className="dze_panel_right_cell_div";b.appendChild(a);return b},openDefaultBox:function(c){try{var a=null;switch(c){case PANEL_TYPE.CHART_ATTR_STYLE:a="#idx_content_chart_attr_title";break;case PANEL_TYPE.CHART_COLOR_EXTRA:a="line"!==onefficeChart.chartType?"#idx_content_chart_fill_color":"#idx_content_chart_border_color";break;case PANEL_TYPE.SHAPES_FORMAT:var b=!0;g_objSelectedShapesArray.some(function(a){if(!0!==
g_objShapeEvtMgr.isLine(1*a.getAttribute("shape_type")))return b=!1});a=!0===b?"#id_content_shapes_border":"#id_content_shapes_fill";break;case PANEL_TYPE.SHAPES_EXTRA:a="#id_content_shapes_size"}null!==a&&dzeJ(a+" .dze_panel_box_close").trigger("click")}catch(d){dalert(d)}}}}catch(c){dalert(c)}}function t(c){try{switch(c){case PANEL_MAIN_TYPE.CLOUD_FILE:var a=document.getElementById("dze_idx_information_panel");break;case PANEL_MAIN_TYPE.DOC_OPEN_INFO:case PANEL_MAIN_TYPE.DOC_COMMENT:case PANEL_MAIN_TYPE.DOC_CHART:case PANEL_MAIN_TYPE.DOC_SHAPES:case PANEL_MAIN_TYPE.NEWS_SEND_INFO:case PANEL_MAIN_TYPE.DOC_WEBSEARCH:case PANEL_MAIN_TYPE.ETC:a=
dzeJ(".dze_style_right_pannel").css("overflow","hidden")[0]}var b=document.createElement("div");b.className="dze_panel_container";b.appendChild(A());b.appendChild(B(c));a.appendChild(b)}catch(d){dalert(d)}}function A(){try{var c=document.createElement("div");E=document.createElement("div");var a=document.createElement("img"),b=document.createElement("span"),d=document.createElement("div");c.className="dze_panel_top";E.className="dze_panel_top_title";a.className="dze_panel_top_title_img";b.className=
"dze_panel_top_title_text";d.className="dze_panel_top_close_btn";c.appendChild(E);E.appendChild(a);E.appendChild(b);c.appendChild(d);dzeJ(d).click(function(){panelManager.getInstance().hidePanel()}).mouseenter(function(){dzeJ(this).addClass("over")}).mouseleave(function(){dzeJ(this).removeClass("over")});return c}catch(e){dalert(e)}}function B(c){try{w=document.createElement("div");var a=document.createElement("div"),b=document.createElement("ul"),d=document.createElement("div");w.className="dze_panel_body";
a.className="dze_panel_tab";b.className="dze_panel_tab_container";d.className="dze_panel_separator";var e=dzeJ("#dze_idx_information_panel");0===e.length&&(e=dzeJ("#dze_idx_right_pannel_0"));if(0<e.length){var f=parseFloat(e.css("height"));w.style.height=f-75+"px"}if("undefined"!=typeof c&&c==PANEL_MAIN_TYPE.DOC_WEBSEARCH){var g=document.createElement("div");g.className="panel_search_input";c="";c+='<input type="text" placeholder="'+ID_RES_CONST_STRING_INPUT_SEARCH_KEYWORD+'"/>';g.innerHTML=c+'<div class="search_input_btn" ></div>';
w.appendChild(g);g.lastElementChild.onclick=N;g.onkeydown=function(a){ID_KEYCODE_ENTER==a.keyCode&&N(a)}}w.appendChild(a);a.appendChild(b);w.appendChild(d);return w}catch(h){dalert(h)}}function L(c){try{var a=[];switch(c){case PANEL_MAIN_TYPE.CLOUD_FILE:a.push(u(PANEL_TYPE.DOC_INFO));a.push(u(PANEL_TYPE.DOC_HISTORY,0!==oneffice_cloud_checkedItemList.length?oneffice_cloud_checkedItemList[oneffice_cloud_checkedItemList.length-1].seq:null));var b=a[0].objExtraInfo.bIsFolder;H(c,a[0].objExtraInfo.strFileName,
b);I(a);!0===fnObjectCheckNull(b)&&dzeJ(".dze_panel_tab_menu").addClass("disable");break;case PANEL_MAIN_TYPE.DOC_OPEN_INFO:a.push(u(PANEL_TYPE.DOC_INFO));a.push(u(PANEL_TYPE.DOC_HISTORY));"W"===oneffice.parentFileContent.share_perm&&!0===objOnefficeLoader.m_bAccessManager&&a.push(u(PANEL_TYPE.DOC_USER_INFO));a.push(u(PANEL_TYPE.DOC_BACKUP_DATA));H(c,ID_RES_CONST_PANEL_TITLE_DOC_INFO);I(a);break;case PANEL_MAIN_TYPE.DOC_COMMENT:H(c,ID_RES_CONST_PANEL_TITLE_DOC_COMMENT);I([u(PANEL_TYPE.DOC_COMMENT)]);
break;case PANEL_MAIN_TYPE.DOC_CHART:a.push(u(PANEL_TYPE.CHART_ATTR_STYLE));a.push(u(PANEL_TYPE.CHART_COLOR_EXTRA));H(c,ID_RES_CONST_PANEL_TITLE_DOC_CHART);I(a);panel_chart.initChartValueCMDEvent(!1);setTimeout(function(){G.openDefaultBox(PANEL_TYPE.CHART_ATTR_STYLE);G.openDefaultBox(PANEL_TYPE.CHART_COLOR_EXTRA)},100);break;case PANEL_MAIN_TYPE.DOC_SHAPES:a.push(u(PANEL_TYPE.SHAPES_FORMAT));a.push(u(PANEL_TYPE.SHAPES_EXTRA));H(c,ID_RES_CONST_STRING_SHAPES_FORMAT);I(a);panel_format.initFormatPanel();
panel_extra.initExtraPanel();break;case PANEL_MAIN_TYPE.NEWS_SEND_INFO:H(c,ID_RES_STRING_NEWS_SEND_INFO);I([u(PANEL_TYPE.NEWS_SEND_INFO)]);break;case PANEL_MAIN_TYPE.DOC_WEBSEARCH:a.push(u(PANEL_TYPE.WEBSEARCH_ENCYCLOPEDIA));a.push(u(PANEL_TYPE.WEBSEARCH_IMAGE));a.push(u(PANEL_TYPE.WEBSEARCH_NEWS));H(c,ID_RES_CONST_STRING_WEB_SEARCH);I(a);break;case PANEL_MAIN_TYPE.ETC:a.push(u(PANEL_TYPE.ETC_MEMO)),a.push(u(PANEL_TYPE.ETC_TODO)),H(c,ID_RES_STRING_ETC_MEMO),I(a)}F=c}catch(d){dalert(d)}}function T(c){var a=
c.attr("dze_tab_contents");if(!fnObjectCheckNull(a))if(0<=a.search("search_content")){var b=!1;switch(a.split("_")[2]){default:case "dic":var d=0;break;case "img":d=1;break;case "news":d=2}duzon_dialog.currTabIdx!=d&&(duzon_dialog.currTabIdx=d,b=!0);N(null,b)}else 0<=a.search("idx_content_etc_")&&(d=panelManager.oldOpenWriterUnitEle,fnObjectCheckNull(d)||(K(null,null,d.parentElement),panelManager.oldOper=-1));c.addClass("activate");dzeJ("#"+a).addClass("activate");c.length&&(a=c[0].firstElementChild)&&
0<=a.className.search("dze_panel_tab")&&(a=c[0].firstElementChild.getAttribute("src"),fnObjectCheckNull(a)||(a=a.substring(0,a.lastIndexOf("_"))+"_on.png",c[0].firstElementChild.src=a))}function H(c,a,b){try{if(!0===fnObjectCheckNull(a))E.style.visibility="hidden";else{E.style.visibility="";var d=E.firstChild,e=E.lastChild;e.textContent=a;switch(c){case PANEL_MAIN_TYPE.CLOUD_FILE:d.src=!0===b?"./image/cloud/ico_panel_folder.png":!1===b?"./image/cloud/ico_panel_file.png":"./image/cloud/ico_panel_home.png";
break;case PANEL_MAIN_TYPE.DOC_OPEN_INFO:case PANEL_MAIN_TYPE.DOC_COMMENT:case PANEL_MAIN_TYPE.DOC_CHART:case PANEL_MAIN_TYPE.DOC_SHAPES:case PANEL_MAIN_TYPE.NEWS_SEND_INFO:case PANEL_MAIN_TYPE.DOC_WEBSEARCH:case PANEL_MAIN_TYPE.ETC:d.style.display="none",e.style.top="0px"}}}catch(f){dalert(f)}}function I(c){try{for(var a=null,b=null,d=null,e=0;e<c.length;e++){a=c[e];b=G.addTabMenu(a.strTabId,a.strTabImageUrl,a.strTabTitle);dzeJ(".dze_panel_tab_container").append(b);if(!0===fnObjectCheckNull(a.objExtraInfo))switch(a.nPanelType){case PANEL_TYPE.WEBSEARCH_ENCYCLOPEDIA:case PANEL_TYPE.WEBSEARCH_IMAGE:case PANEL_TYPE.WEBSEARCH_NEWS:a:{try{duzon_dialog.currTabIdx=
a.nPanelType-11;switch(duzon_dialog.currTabIdx){case 0:objPanelContents=dzeWebSearch.createDicSearchContainer();break;case 1:objPanelContents=dzeWebSearch.createImgSearchContainer();break;case 2:objPanelContents=dzeWebSearch.createNewsSearchContainer()}g_objPropertyUtil.hasClass(objPanelContents,"dze_panel_contents")||g_objPropertyUtil.addClass(objPanelContents,"dze_panel_contents");d=objPanelContents;break a}catch(C){dalert(C)}d=void 0}break;default:continue}switch(a.nPanelType){case PANEL_TYPE.DOC_INFO:a:{var f=
a.strTabId,g=a.objExtraInfo;try{var h=document.createElement("div"),k=document.createElement("div"),l=ea(g.strThumbnailUrl,g.bIsFolder);h.id=f;h.className="dze_panel_contents";k.className="dze_panel_separator";h.appendChild(l);h.appendChild(k);if(!1===fnObjectCheckNull(g)){var n=document.createElement("div");b:{var q=g;try{var D=document.createElement("div"),x=null;D.className="dze_panel_doc_status";var p=[q.bIsImportant,q.bIsSecure,q.bIsShared,q.bIsReadonly];for(q=0;4>q;q++)if(!0===p[q]){x=document.createElement("div");
x.className="dze_panel_doc_status_icon";switch(q){case 0:x.classList.add("important");break;case 1:x.classList.add("secure");break;case 2:x.classList.add("shared");break;case 3:x.classList.add("readonly")}D.appendChild(x)}0===D.childNodes.length&&(D.style.display="none");var u=D;break b}catch(C){dalert(C)}u=void 0}if(!1===fnObjectCheckNull(g.bIsFolder))b:{x=g;try{var t=document.createElement("table");t.style.width="95%";t.style.margin="0px auto";var m=document.createElement("span");m.style.fontFamily=
"\ub9d1\uc740 \uace0\ub515";m.style.fontSize="15px";m.style.fontWeight="bold";m.style.letterSpacing="-0.7px";m.style.color="#404e5b";m.style.lineHeight="1.5";m.textContent=ID_RES_DIALOG_STRING_POSITION;var v=t.insertRow(),r=v.insertCell();r.className="dze_panel_doc_info";r.style.width="90px";r.appendChild(m);r=v.insertCell();r.className="dze_panel_doc_info";m=m.cloneNode(!0);m.style.color="#010101";m.textContent=x.strLocation;r.appendChild(m);v=t.insertRow();r=v.insertCell();r.className="dze_panel_doc_info";
r.style.width="90px";m=m.cloneNode(!0);m.style.color="#404e5b";m.textContent=ID_RES_CONST_STRING_OWNER;r.appendChild(m);r=v.insertCell();r.className="dze_panel_doc_info";m=m.cloneNode(!0);m.style.color="#010101";m.textContent=x.strOwner;r.appendChild(m);v=t.insertRow();r=v.insertCell();r.className="dze_panel_doc_info";r.style.width="90px";m=m.cloneNode(!0);m.style.color="#404e5b";m.textContent=ID_RES_CONST_STRING_CREATE_DATE;r.appendChild(m);r=v.insertCell();r.className="dze_panel_doc_info";m=m.cloneNode(!0);
m.style.color="#010101";m.textContent=x.strCreateDate;r.appendChild(m);v=t.insertRow();r=v.insertCell();r.className="dze_panel_doc_info";r.style.width="90px";m=m.cloneNode(!0);m.style.color="#404e5b";m.textContent=ID_RES_CONST_STRING_MODIFY_DATE;r.appendChild(m);r=v.insertCell();r.className="dze_panel_doc_info";m=m.cloneNode(!0);m.style.color="#010101";m.textContent=x.strModifyDate;r.appendChild(m);!0!==x.bIsFolder&&(v=t.insertRow(),r=v.insertCell(),r.className="dze_panel_doc_info",r.style.width=
"90px",m=m.cloneNode(!0),m.style.color="#404e5b",m.textContent=ID_RES_DIALOG_STRING_SIZE,r.appendChild(m),r=v.insertCell(),r.className="dze_panel_doc_info",m=m.cloneNode(!0),m.style.color="#010101",m.textContent=x.strSize,r.appendChild(m));var y=t;break b}catch(C){dalert(C)}y=void 0}n.className="dze_panel_content_details";h.appendChild(n);n.appendChild(u);!1===fnObjectCheckNull(g.bIsFolder)&&n.appendChild(y)}d=h;break a}catch(C){dalert(C)}d=void 0}break;case PANEL_TYPE.DOC_HISTORY:d=ha(a.strTabId,
a.objExtraInfo);break;case PANEL_TYPE.DOC_BACKUP_DATA:d=ia(a.strTabId,a.objExtraInfo);break;case PANEL_TYPE.DOC_USER_INFO:d=U(a.strTabId,a.objExtraInfo);break;case PANEL_TYPE.DOC_COMMENT:d=V(a.strTabId,a.objExtraInfo);break;case PANEL_TYPE.CHART_ATTR_STYLE:d=ja(a.strTabId,a.objExtraInfo);break;case PANEL_TYPE.CHART_COLOR_EXTRA:d=addPanelContents_Format(a.strTabId,a);break;case PANEL_TYPE.SHAPES_FORMAT:d=addPanelContents_Format(a.strTabId,a);break;case PANEL_TYPE.SHAPES_EXTRA:d=addPanelContents_ShapesExtra(a.strTabId,
a);break;case PANEL_TYPE.NEWS_SEND_INFO:d=ka(a.strTabId,a.objExtraInfo);break;case PANEL_TYPE.ETC_MEMO:d=W(a.strTabId,a.objExtraInfo);break;case PANEL_TYPE.ETC_TODO:d=W(a.strTabId,a.objExtraInfo)}d.style.height=parseFloat(w.style.height)-33+"px";w.appendChild(d)}G.addTabEventListener()}catch(C){dalert(C)}}function u(c,a){try{var b={},d=null;b.nPanelType=c;switch(c){case PANEL_TYPE.DOC_INFO:b.strTabId="tab_contents_doc_info";b.strTabTitle=ID_RES_CONST_PANEL_TITLE_DOC_INFO;b.strTabImageUrl="./image/cloud/ico_panel_tab_docinfo_off.png";
if(0<oneffice_cloud_checkedItemList.length){var e=oneffice_cloud_checkedItemList[oneffice_cloud_checkedItemList.length-1];e.docData||(e=setThumbData(e));var f=0===e.fileType?!0:!1;var g=1==e.docData.bStar?!0:!1;var h=!0===e.docData.bSecurity?!0:!1;var k=fnObjectCheckNull(e.shareData.strShareDate)||""===e.shareData.strShareDate?!1:!0;var l=!0===e.docData.bViewer?!0:!1;var n=e.docData.strTitle;var q=""!==e.userData.strOwnerName?e.userData.strOwnerName:oneffice_cloud_myInfoData.name;var D=e.docData.strCreatedDate;
var x=e.docData.strModifiedDate;var p=onefficeUtil.getFileSizeUnits(e.docData.nContentSize);if(!0===f)var t="./image/cloud/img_panel_folder.png";else if(""!==e.docData.strThumbnail){var u=!0===objOnefficeLoader.isDev()?g_dzEditorBasePath+"server/server_get_attachfile.jsp":ONEFFICE_SERVER_API_GET_ATTACHMENTDATA;t=u+"?seq="+e.docData.strThumbnail}var m=[];var v="";switch(oneffice_cloud_currentBrowserMode){case CLOUD_CONST_BROWSER_MODE_SHARE:case CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST:m.push(["",ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST]);
break;case CLOUD_CONST_BROWSER_MODE_RECENT:""!==e.parentFolderSeq&&oneffice_cloud_myInfoData.id===e.userData.nOwnerID?m=onefficeGW.getFolderPath(e.parentFolderSeq):oneffice_cloud_myInfoData.id!==e.userData.nOwnerID?m.push(["",ID_RES_CONST_STRING_BROWSER_SHARE]):m.push(["",ID_RES_CONST_STRING_BROWSER_MY]);break;default:""!==e.parentFolderSeq?m=onefficeGW.getFolderPath(e.parentFolderSeq):m.push(["",ID_RES_CONST_STRING_BROWSER_MY])}for(var r=0;r<m.length;r++)v+=m[r][1],r<m.length-1&&(v+=" > ")}else if(fnObjectCheckNull(oneffice.parentFileContent)||
""===oneffice.parentFileContent)if(""!==oneffice_cloud_currFolderSeq){var w=onefficeGW.getFolderInfo(oneffice_cloud_currFolderSeq);f=!0;g=1===1*w.important?!0:!1;n=w.subject;t="./image/cloud/img_panel_folder.png";q=oneffice_cloud_myInfoData.name;D=w.regdate;x=w.moddate;m=onefficeGW.getFolderPath(oneffice_cloud_currFolderSeq);v="";for(r=0;r<m.length-1;r++)v+=m[r][1],r<m.length-2&&(v+=" > ")}else t="./image/cloud/img_panel_empty.png",n=ID_RES_CONST_STRING_BROWSER_MY;else if(e=oneffice.parentFileContent,
f=!1,g=1===1*e.important?!0:!1,h=e.bSecure,k=fnObjectCheckNull(e.share_date)||""===e.share_date?!1:!0,l=0!==1*e.readonly?!0:!1,n=e.subject,q=""!==e.owner_name?e.owner_name:e.my_id,D=e.regdate,x=e.moddate,p=onefficeUtil.getFileSizeUnits(e.content_size),""!==e.strThumbnail&&(u=!0===objOnefficeLoader.isDev()?g_dzEditorBasePath+"server/server_get_attachfile.jsp":ONEFFICE_SERVER_API_GET_ATTACHMENTDATA,t=u+"?seq="+e.strThumbnail),v="",k&&e.owner_id!==e.my_id)v=ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST;
else for(m=onefficeGW.getFolderPath(e.seq),r=0;r<m.length-1;r++)v+=m[r][1],r<m.length-2&&(v+=" > ");d={bIsFolder:f,bIsImportant:g,bIsSecure:h,bIsShared:k,bIsReadonly:l,strFileName:n,strThumbnailUrl:t,strLocation:v,strOwner:q,strCreateDate:D,strModifyDate:x,strSize:p};b.objExtraInfo=d;break;case PANEL_TYPE.DOC_HISTORY:b.strTabId="tab_contents_doc_history";b.strTabTitle=ID_RES_CONST_STRING_DOCUMENT_HISTORY;b.strTabImageUrl="./image/cloud/ico_panel_tab_dochistory_off.png";d=onefficeGW.getDocumentHistoryInfo(a);
b.objExtraInfo=d;break;case PANEL_TYPE.DOC_BACKUP_DATA:b.strTabId="tab_contents_doc_backup";b.strTabTitle=ID_RES_CONST_STRING_DOCUMENT_BACKUP;b.strTabImageUrl="./image/cloud/tab-icon-docback_off.png";d=onefficeUtil.getOpenDataList();b.objExtraInfo=d;break;case PANEL_TYPE.DOC_USER_INFO:b.strTabId="tab_contents_doc_user_info";b.strTabTitle=ID_RES_CONST_PANEL_TITLE_DOC_ACCESS;b.strTabImageUrl="./image/cloud/ico_panel_tab_docuser_off.png";d=onefficeGW.getDocumentAccessInfo();b.objExtraInfo=d;break;case PANEL_TYPE.DOC_COMMENT:b.strTabId=
"tab_contents_doc_comment";b.strTabTitle=ID_RES_CONST_PANEL_TITLE_DOC_COMMENT;b.strTabImageUrl="./image/cloud/ico_panel_tab_doccomment_off.png";d={doc_seq:oneffice.currFileSeq,group_seq:oneffice.onefficeGroupSeq};b.objExtraInfo=d;break;case PANEL_TYPE.CHART_ATTR_STYLE:b.strTabId="tab_contents_doc_chartStyle";b.strTabTitle="\ucc28\ud2b8 \uc11c\uc2dd";b.strTabImageUrl="./image/panel/tab_icon_chart_off.png";d=[{id:"idx_content_chart_attr_title",title:ID_RES_CONST_STRING_CHART_TITLE},{id:"idx_content_chart_attr_label",
title:ID_RES_CONST_STRING_CHART_DATA_LABEL},{id:"idx_content_chart_attr_item",title:ID_RES_CONST_STRING_CHART_LEGEND_VIEW},{id:"idx_content_chart_attr_change",title:ID_RES_CONST_STRING_CHART_DATA_CONVERT}];b.objExtraInfo=d;break;case PANEL_TYPE.CHART_COLOR_EXTRA:b.strTabId="tab_contents_doc_chartStyleExtra";b.strTabTitle="\ucc28\ud2b8 \uc0c9\uc0c1";b.strTabImageUrl="./image/panel/tab_icon_fiil_off.png";d=[{id:"idx_content_chart_fill_color",title:ID_RES_PROP_TAG_STRING_FILL},{id:"idx_content_chart_border_color",
title:ID_RES_DIALOG_TAB_BORDER}];b.objExtraInfo=d;break;case PANEL_TYPE.SHAPES_FORMAT:b.strTabId="tab_contents_doc_shape_format";b.strTabTitle=ID_RES_CONST_STRING_SHAPES_FORMAT;b.strTabImageUrl="./image/panel/tab_icon_fiil_off.png";d=[{id:"id_content_shapes_fill",title:ID_RES_PROP_TAG_STRING_FILL},{id:"id_content_shapes_border",title:ID_RES_CONST_STRING_SHAPES_LINE_NORMAL}];b.objExtraInfo=d;break;case PANEL_TYPE.SHAPES_EXTRA:b.strTabId="tab_contents_doc_shape_extra";b.strTabTitle=ID_RES_CONST_STRING_TXTLAYOUT_OTHERS;
b.strTabImageUrl="./image/panel/tab_icon_size_off.png";d=[{id:"id_content_shapes_size",title:ID_RES_DIALOG_STRING_SIZE},{id:"id_content_shapes_textbox",title:ID_RES_CONST_STRING_TEXTBOX}];b.objExtraInfo=d;break;case PANEL_TYPE.NEWS_SEND_INFO:b.strTabId="tab_contents_news_sendInfo";b.strTabTitle=ID_RES_STRING_NEWS_SEND_INFO;b.strTabImageUrl="./image/panel/tab_icon_news_off.png";d=[{id:"idx_content_news_journalistInfo",title:ID_RES_CONST_STRING_NEWS_JOURNALIST_INFO},{id:"idx_content_news_classifyInfo",
title:ID_RES_CONST_STRING_NEWS_CLASSIFY_INFO},{id:"idx_content_news_gradeInfo",title:ID_RES_CONST_STRING_NEWS_GRADE_INFO},{id:"idx_content_news_journalistSendInfo",title:ID_RES_CONST_STRING_NEWS_JOURNALIST_SEND_INFO},{id:"idx_content_news_title_info",title:ID_RES_CONST_STRING_NEWS_TITLE_INFO},{id:"idx_content_news_tag_info",title:ID_RES_CONST_STRING_NEWS_TAG_INFO},{id:"idx_content_news_naver_category_info",title:ID_RES_CONST_STRING_NEWS_NAVER_CATEGORY_INFO}];b.objExtraInfo=d;break;case PANEL_TYPE.WEBSEARCH_ENCYCLOPEDIA:b.strTabId=
"dze_idx_dic_search_content";b.strTabTitle=ID_RED_CONST_STRING_ENCYCLOPEDIA;b.strTabImageUrl=null;break;case PANEL_TYPE.WEBSEARCH_IMAGE:b.strTabId="dze_idx_img_search_content";b.strTabTitle=ID_RED_CONST_STRING_IMAGE;b.strTabImageUrl=null;break;case PANEL_TYPE.WEBSEARCH_NEWS:b.strTabId="dze_idx_news_search_content";b.strTabTitle=ID_RED_CONST_STRING_NEWS;b.strTabImageUrl=null;break;case PANEL_TYPE.ETC_MEMO:b.strTabId="idx_content_etc_memo";b.strTabTitle=ID_RES_STRING_ETC_MEMO;b.strTabImageUrl=null;
d=[{id:"idx_content_etc_memo",title:"mistyMemo"}];b.objExtraInfo=d;break;case PANEL_TYPE.ETC_TODO:b.strTabId="idx_content_etc_todo",b.strTabTitle=ID_RES_STRING_ETC_TODO,b.strTabImageUrl=null,d=[{id:"idx_content_etc_todo",title:"mistyTodo"}],b.objExtraInfo=d}return b}catch(C){dalert(C)}}function da(c){try{var a=document.createElement("div");a.className="dze_panel_box_open";switch(c){case "idx_content_chart_attr_title":panel_chart.subContentChartTitleDiv(a);break;case "idx_content_chart_attr_label":panel_chart.subContentChartDataLabelDiv(a);
break;case "idx_content_chart_attr_item":panel_chart.subContentChartLegendDiv(a);break;case "idx_content_chart_attr_change":panel_chart.subContentChartDataChangeDiv(a);break;case "idx_content_chart_fill_color":case "id_content_shapes_fill":panel_format.addFormatFillBox(a);break;case "idx_content_chart_border_color":case "id_content_shapes_border":panel_format.addFormatBorderBox(a);break;case "id_content_shapes_size":panel_extra.addExtraSizeBox(a);break;case "id_content_shapes_textbox":panel_extra.addExtraTextboxBox(a)}return a}catch(b){dalert(b)}}
function ea(c,a){try{var b=document.createElement("div"),d=document.createElement("div"),e=document.createElement("img");b.className="dze_panel_thumbnail";d.style.width="100%";d.style.height="fit-content";d.style.position="relative";d.style.top="3px";e.src=!1===fnObjectCheckNull(c)?c:"./image/cloud/ico_thumb_file_oneffice.png";e.style.maxWidth="280px";!1===fnObjectCheckNull(c)?(e.style.width="auto",e.addEventListener("load",function(){this.width<this.height&&(this.style.width="230px")},{once:!0}),
e.addEventListener("error",function(){this.src="./image/cloud/ico_thumb_file_oneffice.png";this.style.width="170px";this.style.boxShadow="none"},{once:!0})):e.style.width="170px";d.appendChild(e);if(!0===fnObjectCheckNull(a)){var f=document.createElement("span");f.style.fontFamily="\ub9d1\uc740 \uace0\ub515";f.style.fontSize="13px";f.style.fontWeight="bold";f.style.letterSpacing="-0.7px";f.style.color="#010101";f.style.lineHeight="1.8";f.textContent=ID_RES_CONST_PANEL_FILE_SELECT_NONE;d.appendChild(document.createElement("br"));
d.appendChild(f)}else!1===a&&!1===fnObjectCheckNull(c)&&(e.style.boxShadow="2px 2px 7px rgba(0, 0, 0, 0.3)");b.appendChild(d);return b}catch(g){dalert(g)}}function ia(c,a){try{var b=document.createElement("div"),d=document.createElement("ul"),e=null,f=null;b.id=c;b.className="dze_panel_contents";d.style.margin="13px 6px";d.style.listStyle="none";d.style.paddingInlineStart="0px";d.style.paddingLeft="0px";var g=document.createElement("div");g.innerText=ID_RES_CONST_STRING_DOCUMENT_BACKUP;g.className=
"panel_tab_title";d.appendChild(g);b.appendChild(d);for(var h=a.length-1;0<=h;h--){f=a[h];e=duzon_http.getCalStrWithTime(f.update);var k=document.createElement("div");k.className="temp_doc_list_unit_container";k.innerText=e;var l=document.createElement("li"),n=document.createElement("div");n.className="dze_panel_doc_view_btn";n.innerText=ID_RES_TOOL_STRING_MENU_VIEW;n.setAttribute("index",h);n.onclick=function(a){g_readonlyMode?cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_STRING_NO_BACKUP_AND_RECOVER,null,
[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg()}):(a=this.getAttribute("index"),a=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(oneffice.currFileSeq,"","backupdoc|"+a),window.location=a)};var q=document.createElement("img");q.style.marginLeft="6px";q.src="./image/cloud/ico_panel_user_info_arrow.png";n.appendChild(q);k.appendChild(n);l.appendChild(k);d.appendChild(l)}return b}catch(D){dalert(D)}}function ha(c,a){try{var b=document.createElement("div"),d=document.createElement("ul"),e=null,
f=null,g=null,h=null,k=null;b.id=c;b.className="dze_panel_contents";d.style.margin="0px 6px";d.style.listStyle="none";d.style.paddingInlineStart="0px";d.style.paddingLeft="0px";b.appendChild(d);for(c=0;c<a.length;c++)k=a[c],h="object"===typeof k.reg_date?getFullDateFromTimeStamp(k.reg_date.time):k.reg_date,h=h.substring(0,10),e=X(d,h,!0),!0===fnObjectCheckNull(e)&&(e=la(h),d.appendChild(e)),f=X(d,h,!1),!0===fnObjectCheckNull(f)&&(f=ma(h),dzeJ(e).find("ul").append(f)),g=na(k),f.childNodes[1].appendChild(g);
var l=dzeJ(d).find("li.month");a=null;for(d=0;d<l.length;d++)a=dzeJ(l[d]).find("li.date"),a[a.length-1].lastChild.style.borderBottom="",0===d&&dzeJ(l[0]).find("div.dze_panel_doc_history_title").each(function(a,b){0===a?setTimeout(function(){dzeJ(b).trigger("click")},100):setTimeout(function(){dzeJ(b).trigger("click")},500)});oa();return b}catch(n){dalert(n)}}function X(c,a,b){try{var d=null,e=null,f=null,g=null;d=!0===b?dzeJ(c).find("li.month"):dzeJ(c).find("li.date");for(c=0;c<d.length;c++)if(e=
d[c],f=e.getAttribute("date"),!0===b){if(f.substring(0,f.lastIndexOf("-"))===a.substring(0,a.lastIndexOf("-")))return e}else if(f===a)return g=1*e.getAttribute("cases"),!0===isNaN(g)&&(g=0),e.setAttribute("cases",++g),e.firstChild.lastChild.textContent=g+ID_RES_CONST_STRING_COUNT,e;return null}catch(h){dalert(h)}}function la(c){try{var a=document.createElement("li"),b=document.createElement("div"),d=document.createElement("div"),e=document.createElement("img"),f=document.createElement("ul"),g=document.createElement("div"),
h=document.createElement("div"),k=c.split("-");a.className="month";a.style.marginTop="13px";a.setAttribute("date",c);b.className="dze_panel_doc_history_title";dzeJ(b).click(function(){var a=dzeJ(this);dzeJ("#dze_panel_doc_history_menu_container").hide();!0===a.hasClass("open")?a.next().next().slideUp(function(){a.removeClass("open");a.css("color","");a[0].lastChild.src="./image/cloud/btn_panel_history_month_close.png";a.next().next().next().css("display","none")}):(a.addClass("open"),a.css("color",
"#1c90fb"),a[0].lastChild.src="./image/cloud/btn_panel_history_month_open.png",a.next().next().next().css("display",""),a.next().next().slideDown())}).mouseenter(function(){var a=dzeJ(this);!0!==a.hasClass("open")&&a.addClass("over")}).mouseleave(function(){var a=dzeJ(this);!0!==a.hasClass("open")&&a.removeClass("over")});d.className="dze_panel_doc_history_title_text";d.textContent=k[0]+ID_RES_CONST_STRING_YEAR+" "+k[1]+ID_RES_CONST_STRING_MONTH;d.style.width="calc(100% - 25px)";g.style.height="2px";
g.style.borderBottom="1px solid #e5e5e5";e.style.width="17px";e.style.height="17px";e.style.verticalAlign="middle";e.src="./image/cloud/btn_panel_history_month_close.png";f.style.display="none";f.style.listStyle="none";f.style.paddingInlineStart="0px";f.style.paddingLeft="0px";h.style.borderBottom="1px solid #d9d9d9";h.style.display="none";a.appendChild(b);b.appendChild(d);b.appendChild(e);a.appendChild(g);a.appendChild(f);a.appendChild(h);return a}catch(l){dalert(l)}}function ma(c){try{var a=document.createElement("li"),
b=document.createElement("div"),d=document.createElement("img"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),k=c.split("-");a.className="date";a.style.margin="8px 0px 10px";a.setAttribute("date",c);a.setAttribute("cases","1");b.className="dze_panel_doc_history_title";dzeJ(b).click(function(){var a=dzeJ(this);dzeJ("#dze_panel_doc_history_menu_container").hide();!0===a.hasClass("open")?a.next().slideUp(function(){a.removeClass("open");
a.find("img").removeClass("open");a.find("div.dze_panel_doc_history_case").removeClass("open");a.next().next().css("display","none")}):(a.addClass("open"),a.find("img").addClass("open"),a.find("div.dze_panel_doc_history_case").addClass("open"),a.next().next().css("display",""),a.next().slideDown())}).mouseenter(function(){var a=dzeJ(this);!0!==a.hasClass("open")&&a.addClass("over")}).mouseleave(function(){var a=dzeJ(this);!0!==a.hasClass("open")&&a.removeClass("over")});d.className="dze_panel_doc_history_date_button";
d.src="./image/cloud/btn_panel_history_date_close.png";e.className="dze_panel_doc_history_title_text";e.textContent=k[1]+ID_RES_CONST_STRING_MONTH+" "+k[2]+ID_RES_CONST_STRING_DAY;e.style.width="calc(100% - 60px)";e.style.marginLeft="3px";f.className="dze_panel_doc_history_case";f.textContent="1\uac74";g.style.height="fit-content";g.style.margin="10px 0px 0px 15px";g.style.display="none";h.style.borderBottom="1px dashed #d9d9d9";a.appendChild(b);b.appendChild(d);b.appendChild(e);b.appendChild(f);
a.appendChild(g);a.appendChild(h);return a}catch(l){dalert(l)}}function na(c){try{var a=document.createElement("div"),b=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");a.style.width="100%";a.style.height="34px";a.style.marginBottom="10px";b.className="dze_panel_doc_status_icon";b.style.marginRight="8px";var h=null,k=null;switch(1*c.action_code){case 1:b.style.backgroundColor="#46a1ff";b.style.backgroundImage=
"url('./image/cloud/ico_panel_history_view.png')";break;case 0:case 2:case 3:case 6:case 7:case 8:case 9:case 10:case 14:b.style.backgroundColor="#57dec6";b.style.backgroundImage="url('./image/cloud/ico_panel_history_edit.png')";break;case 4:case 5:b.style.backgroundColor="#ff91b0";b.style.backgroundImage="url('./image/cloud/ico_panel_history_share.png')";h=JSON.parse(c.action_data);break;case 15:b.style.backgroundColor="#f6cc26",b.style.backgroundImage="url('./image/cloud/ico_panel_history_chgown.png')",
k=JSON.parse(c.action_data)}d.style.width="calc(100% - 64px)";d.style.display="inline-block";d.style.position="relative";d.style.top="-4px";var l="object"===typeof c.reg_date?getFullDateFromTimeStamp(c.reg_date.time):c.reg_date,n=l.substring(0,10).split("-");l=l.substring(11,l.lastIndexOf(":"));var q=l.split(":");l=12<q[0]?ID_RES_CONST_STRING_PM+" "+(q[0]-12)+":"+q[1]:12===q[0]?ID_RES_CONST_STRING_PM+" "+l:ID_RES_CONST_STRING_AM+" "+l;e.style.height="16px";e.style.fontFamily="\ub9d1\uc740 \uace0\ub515";
e.style.fontSize="11px";e.style.color="black";e.style.textAlign="left";e.style.lineHeight="1.7";e.textContent=l;f.style.height="fit-content";f.style.fontFamily="\ub9d1\uc740 \uace0\ub515";f.style.fontSize="12px";f.style.color="black";f.style.textAlign="left";f.style.lineHeight="1.7";f.textContent=c.action_user_name;g.style.width="22px";g.style.height="22px";g.style.display="inline-block";g.style.marginBottom="6px";g.style.cursor="pointer";g.style.background="url('./image/cloud/btn_panel_history_more.png') no-repeat center center";
var p=n[0]+ID_RES_CONST_STRING_YEAR+" "+n[1]+ID_RES_CONST_STRING_MONTH+" "+n[2]+ID_RES_CONST_STRING_DAY+" "+l+"|"+c.action_user_name+"|"+c.action_code+"|"+c.device_info+"|"+c.user_ip;null!=h&&(p+="|"+h.share_perm+"|"+h.share_id);k&&(p+="|"+k.org_owner_name+"|"+k.new_owner_name);g.setAttribute("detail_info",p);dzeJ(g).click(function(){viewDocumentHistoryDetail(p.split("|"))}).mouseenter(function(){dzeJ(this).css("background-image","url('./image/cloud/btn_panel_history_more_over.png')")}).mouseleave(function(){dzeJ(this).css("background-image",
"url('./image/cloud/btn_panel_history_more.png')")});a.appendChild(b);a.appendChild(d);d.appendChild(e);d.appendChild(f);a.appendChild(g);return a}catch(x){dalert(x)}}function oa(){try{var c=document.createElement("div"),a=document.createElement("div"),b=document.createElement("img"),d=document.createElement("div"),e=document.createElement("div"),f=document.createElement("img"),g=document.createElement("span"),h=document.createElement("div"),k=document.createElement("img"),l=document.createElement("span"),
n=document.createElement("img"),q=document.createElement("div"),p=document.createElement("img");c.id="dze_panel_doc_history_menu_container";c.style.width="136px";c.style.height="fit-content";c.style.position="absolute";c.style.left="0px";c.style.top="0px";c.style.display="none";a.style.height="10px";a.style.display="block";b.style.position="relative";b.style.left="115px";b.style.top="0.5px";b.style.display="block";b.src="./image/cloud/ico_panel_more_box_top_arrow.png";d.style.display="block";d.style.border=
"1px solid rgba(109, 109, 109, 0.4)";d.style.boxShadow="0px 1px 5px 0 rgba(0, 0, 0, 0.18)";d.style.background="white";e.className="dze_panel_doc_history_menu detail";e.style.width="100%";e.style.height="32px";e.style.display="inline-block";e.style.background="white";f.style.width="14px";f.style.height="14px";f.style.margin="0px 5px";f.style.position="relative";f.style.top="8px";f.style.pointerEvents="none";f.src="./image/cloud/ico_panel_more_menu_info.png";g.style.fontFamily="\ub9d1\uc740 \uace0\ub515";
g.style.fontSize="12px";g.style.color="#4a4a4a";g.style.textAlign="left";g.style.position="relative";g.style.top="7px";g.style.pointerEvents="none";g.style.display="inline-block";g.textContent=ID_RES_CONST_PANEL_MENU_DETAIL_INFO;h.className="dze_panel_doc_history_menu copy";h.style.width="100%";h.style.height="32px";h.style.display="inline-block";h.style.background="white";k.style.width="14px";k.style.height="14px";k.style.margin="0px 5px";k.style.position="relative";k.style.top="8px";k.style.pointerEvents=
"none";k.src="./image/cloud/ico_panel_more_menu_copy.png";l.style.fontFamily="\ub9d1\uc740 \uace0\ub515";l.style.fontSize="12px";l.style.color="#4a4a4a";l.style.textAlign="left";l.style.position="relative";l.style.top="7px";l.style.pointerEvents="none";g.style.display="inline-block";l.textContent=ID_RES_CONST_STRING_SAVEAS_REMOTE;n.style.width="5px";n.style.height="10px";n.style.position="relative";n.style.top="10px";n.style.float="right";n.style.marginRight="8px";n.style.pointerEvents="none";n.src=
"./image/cloud/ico_panel_more_menu_arrow.png";q.style.height="10px";q.style.display="none";p.style.position="relative";p.style.left="115px";p.style.top="-0.6px";p.style.display="block";p.style.transform="rotate(180deg)";p.src="./image/cloud/ico_panel_more_box_top_arrow.png";c.appendChild(a);a.appendChild(b);c.appendChild(d);d.appendChild(e);e.appendChild(f);e.appendChild(g);e.appendChild(n);d.appendChild(h);h.appendChild(k);h.appendChild(l);h.appendChild(n.cloneNode(!0));c.appendChild(q);q.appendChild(p);
dzeJ(".dze_panel_container").append(c);dzeJ(".dze_panel_doc_history_menu").click(function(a){a=dzeJ(this);!0===a.hasClass("detail")?(a=dzeJ("#dze_panel_doc_history_menu_container").attr("detail_info"),viewDocumentHistoryDetail(a.split("|"))):a.hasClass("copy");dzeJ("#dze_panel_doc_history_menu_container").hide()}).mouseenter(function(){dzeJ(this).css("background","#f3f4f5")}).mouseleave(function(){dzeJ(this).css("background","")})}catch(x){dalert(x)}}function ca(c){try{var a=function(a){a.removeClass("open");
a.find(".dze_panel_box_close_icon").attr("src","./image/cloud/btn_panel_history_month_close.png");a.children().first().removeClass("open");a.children().last().slideUp()};dzeJ(".dze_panel_container .dze_panel_box").each(function(b,d){switch(dzeJ(d).attr("id")){case "idx_content_chart_attr_title":case "idx_content_chart_attr_label":case "idx_content_chart_attr_item":case "idx_content_chart_attr_change":0<c.parents("#tab_contents_doc_chartStyle").length&&a(dzeJ(d));break;case "idx_content_chart_fill_color":case "idx_content_chart_border_color":0<
c.parents("#tab_contents_doc_chartStyleExtra").length&&a(dzeJ(d));break;case "id_content_shapes_fill":case "id_content_shapes_border":0<c.parents("#tab_contents_doc_shape_format").length&&a(dzeJ(d));break;case "id_content_shapes_size":case "id_content_shapes_textbox":0<c.parents("#tab_contents_doc_shape_extra").length&&a(dzeJ(d))}})}catch(b){dalert(b)}}function ja(c,a){try{var b=document.createElement("div");b.id=c;b.className="dze_panel_contents";a.forEach(function(a){b.appendChild(G.addContentBox(a.id,
a.title))});return b}catch(d){dalert(d)}}function ka(c,a){try{var b=document.createElement("div");b.id=c;b.className="dze_panel_contents";a.forEach(function(a){b.appendChild(G.addContentBox(a.id,a.title))});return b}catch(d){dalert(d)}}function U(c,a){try{var b=document.createElement("div"),d=document.createElement("ul"),e=Y(!0),f=Y(!1),g=null,h=document.createElement("div"),k={},l=0;b.id=c;b.className="dze_panel_contents";d.style.margin="0px 6px";d.style.listStyle="none";d.style.paddingInlineStart=
"0px";b.appendChild(d);d.appendChild(e);d.appendChild(f);h.style.marginBottom="10px";h.style.borderBottom="1px dashed #d9d9d9";for(var n in a){var q=a[n];if("1"===q.access_status&&"W"===q.access_perm||"M"===q.access_perm){k.id=q.access_id;k.date=q.access_date;k.access_perm=q.access_perm;break}}void 0!==k.id&&(g=k.id===oneffice.parentFileContent.my_id?O(k,0):O(k,1));dzeJ(e).children().last().append(g);for(n in a)q=a[n],"1"===q.access_status&&"R"===q.access_perm&&(k.id=q.access_id,k.date=q.access_date,
g=O(k,0),dzeJ(f).children().last().append(g),dzeJ(f).children().last().append(h.cloneNode(!0)),l++);var p=dzeJ(f).children().first();p.text(p.text()+"("+l+")");return b}catch(x){dalert(x)}}function Y(c){try{var a=document.createElement("li"),b=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div");!0===c?(a.className="dze_panel_doc_user_list writer",b.textContent=ID_RES_CONST_PANEL_EDITING_USER):(a.className="dze_panel_doc_user_list viewer",b.textContent=ID_RES_CONST_PANEL_VIEWING_USER);
b.className="dze_panel_doc_user_list_title";b.setAttribute("user_counts","");e.style.height="3px";e.style.borderBottom="1px solid #e5e5e5";d.style.marginTop="10px";a.appendChild(b);a.appendChild(e);a.appendChild(d);return a}catch(f){dalert(f)}}function O(c,a){try{var b=document.createElement("div"),d=document.createElement("img"),e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");b.appendChild(d);b.appendChild(e);e.appendChild(f);e.appendChild(g);b.style.width=
"100%";b.style.height="34px";b.style.marginBottom="10px";d.className="dze_panel_doc_status_icon";d.style.marginRight="8px";e.style.width="calc(100% - 116px)";e.style.display="inline-block";e.style.position="relative";e.style.top="-4px";f.style.height="fit-content";f.style.fontFamily="\ub9d1\uc740 \uace0\ub515";f.style.fontSize="12px";f.style.color="black";f.style.textAlign="left";f.style.lineHeight="1.7";var h=onefficeGW.getUserInfoID(c.id);null===h&&(h=[[]],h[0].name=c.id,h[0].id=c.id);!1===fnObjectCheckNull(h)&&
0<h.length?(d.src=h[0].pic,f.textContent=h[0].name+" "+h[0].duty_name):d.style.visibility="hidden";g.style.height="fit-content";g.style.fontFamily="\ub9d1\uc740 \uace0\ub515";g.style.fontSize="11px";g.style.color="#626262";g.style.textAlign="left";g.style.lineHeight="1.7";g.textContent=c.date;if(0<a){var k=document.createElement("div"),l=document.createElement("span"),n=document.createElement("img");b.appendChild(k);k.appendChild(l);k.appendChild(n);k.className="dze_panel_doc_user_request_btn";k.setAttribute("senderID",
oneffice_cloud_myInfoData.id);k.setAttribute("receiveID",h[0].id);l.style.fontFamily="\ub9d1\uc740 \uace0\ub515";l.style.fontSize="12px";l.style.lineHeight="1.9";l.textContent=1===a?ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH:ID_RES_CONST_PANEL_PASS_WRITE_AUTH;n.style.width="4px";n.style.height="7px";n.style.position="relative";n.style.top="8px";n.style.float="right";n.style.pointerEvents="none";n.src="./image/cloud/ico_panel_user_info_arrow.png";dzeJ(k).click(function(){var a=dzeJ(this);if(!0===a.hasClass("request"))clearInterval(oneffice.responseReqInterval),
oneffice.responseReqInterval=void 0,onefficeGW.cancelAccessManagerRequestID(oneffice.currFileSeq,a.attr("receiveid"),oneffice_cloud_myInfoData.id),a.removeClass("request"),a.children().first().text(ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH),a.children().last().show(),cmnCtrlToast.showToastMsg(null,ID_RES_CONST_TOAST_EDIT_AUTH_REQUEST_CANCEL,1.5);else{var b=[oneffice_cloud_myInfoData.pic,oneffice_cloud_myInfoData.name+" "+oneffice_cloud_myInfoData.duty_name,oneffice_cloud_myInfoData.id];var d=onefficeGW.getUserInfo(a.attr("user_name"));
var e=!1===fnObjectCheckNull(d)&&0<d.length?[d[0].pic,d[0].name+" "+d[0].duty_name,d[0].id,c.access_perm]:[a.prev().prev().attr("src"),a.prev().children().first().text()];"M"===c.access_perm?callAuthFailForMobile(e[1]):a.children().first().text()===ID_RES_CONST_PANEL_REQUEST_WRITE_AUTH?(d=USER_WRITE_AUTH.REQUEST_TO,a.addClass("select"),chkCurrentEditUser(a.attr("receiveid"))?callAuthRequest(d,b,e):setChangeDocumentEditAuth(a.attr("senderid"))):a.children().first().text()===ID_RES_CONST_PANEL_PASS_WRITE_AUTH&&
(d=USER_WRITE_AUTH.PASS_TO,callAuthRequest(d,b,e))}}).mouseenter(function(){dzeJ(this).addClass("over")}).mouseleave(function(){dzeJ(this).removeClass("over")})}return b}catch(q){dalert(q)}}function M(c,a,b){try{b=["2021-06-07 17:32:20;\uc774 \uae30\uc0ac\uc5d0 \ub300\ud55c \uba54\ubaa8 \uc785\ub825"];if(dzeUiConfig.objExtInfo)switch(c){case DZE_CUSTOM_ATT.MEMO:dzeUiConfig.objExtInfo.loaded.comments?b=dzeUiConfig.objExtInfo.comments.data:dzeUiConfig.objExtInfo.comments.data&&dzeUiConfig.objExtInfo.comments.data.length?
b=dzeUiConfig.objExtInfo.comments.data:b;break;case DZE_CUSTOM_ATT.TODO:dzeUiConfig.objExtInfo.loaded.todos?b=dzeUiConfig.objExtInfo.todos.data:dzeUiConfig.objExtInfo.todos.data&&dzeUiConfig.objExtInfo.todos.data.length?b=dzeUiConfig.objExtInfo.todos.data:b}return b[a]}catch(d){dalert(d)}}function P(c,a,b,d){try{a.className="panel_writer_input";var e=c.slice(-4);c="";c+='<textarea  id="'+(0==d?e:e+"mod")+'Input" placeholder="'+("todo"==e?ID_RES_STRING_ETC_TODO_INPUT_PLEASE:ID_RES_STRING_ETC_MEMO_INPUT_PLEASE)+
'"></textarea>';a.innerHTML=c+'<div class="writer_input_btn2" style="background-color:#009cff;border-radius:3px;"></div>';a.lastElementChild.onclick=Z;a.onkeydown=function(a){ID_KEYCODE_ENTER==a.keyCode&&Z(a)}}catch(f){dalert(f)}}function N(c,a){try{var b=c?c:window.event;"undefined"==typeof a&&(a=!0);var d=b.currentTarget;c=null;if(0<=d.className.search("search_input_btn"))c=d.previousElementSibling;else if(!fnObjectCheckNull(w)&&0>d.className.search("panel_search_input")){var e=w.getElementsByClassName("panel_search_input")[0];
c=null!=e?e.firstElementChild:null}else 0<=d.className.search("panel_search_input")&&(c=d.firstElementChild);if(!fnObjectCheckNull(c)){var f=c.value.trim();if(1>f.length){a='<div class="nodata showbox" style="padding-top:50%;" >';a+='<img src="./image/bizcube/img_empty_search.png">';a+="<div>"+ID_RES_CONST_STRING_FILELIST_NO_SEARCH+"</div>";a+="</div>";container=dzeWebSearch.getCurTabContainer();container.innerHTML=a;c.select();return}if(!a&&dzeWebSearch.searchText==f){c.select();return}dzeWebSearch.initialize();
dzeWebSearch.searchText=f}dzeWebSearch.getMoreDataMethod="scroll";dzeWebSearch.viewContents()}catch(g){dalert(g)}}function aa(c,a){try{var b=c?c.currentTarget:a,d=b.closest("div");b.parentElement.id.split("_display");K(d.parentElement,!1,null);panelManager.oldOpenWriterUnitEle=null;panelManager.oldOper=2}catch(e){dalert(e)}}function ba(c,a){try{var b=null;if(0<=c.search("todo")){b=a.parentElement;var d=b.childNodes[1];b.removeChild(d);b.removeChild(b.childNodes[0]);b.firstElementChild.style.display=
""}else{b=a.parentElement.parentElement;d=fnObjectCheckNull(b.nextElementSibling)?b.lastElementChild:b.childNodes[2];b.removeChild(d);b.childNodes[1].style.display="";var e=b.childNodes[0].lastElementChild;e.lastElementChild.style.display="";e.lastElementChild.previousElementSibling.src="./image/cloud/btn_comment_delete.png"}}catch(f){dalert(f)}}function Z(c){try{var a=null,b=(c?c:window.event).currentTarget;a=b.childElementCount?b.firstElementChild:b.previousElementSibling;var d=a.value.trim(),e=
PANEL_TYPE.ETC_MEMO,f=g_objCommonUtil.getToDateStr()+";"+d;switch(a.id){case "todoInput":if(dzeUiConfig.objExtInfo.todos.data&&dzeUiConfig.objExtInfo.todos.data.length)dzeUiConfig.objExtInfo.todos.data.push(f);else{var g=a.parentElement,h=g.nextElementSibling.nextElementSibling;h.innerHTML=null;var k=[];k.push(f);dzeUiConfig.objExtInfo.todos.data=k}e=PANEL_TYPE.ETC_TODO;break;case "todomodInput":var l=a.parentElement.parentElement,n=dzeJ(l).index();dzeUiConfig.objExtInfo.todos.data&&dzeUiConfig.objExtInfo.todos.data.length?
dzeUiConfig.objExtInfo.todos.data[n]=f:(g=a.parentElement,h=g.nextElementSibling.nextElementSibling,h.innerHTML=null);K(l,!1,null);l.firstElementChild.childNodes[1].innerHTML=d;break;case "memomodInput":l=a.parentElement.parentElement;n=dzeJ(l).index();if(dzeUiConfig.objExtInfo.comments.data&&dzeUiConfig.objExtInfo.comments.data.length)dzeUiConfig.objExtInfo.comments.data[n]=f;else{g=a.parentElement;var q=g.nextElementSibling.nextElementSibling;q.innerHTML=null}K(l,!1,null);var p=l.nextElementSibling?
l.childNodes[1]:l.lastElementChild;p&&(p.style.display="",p.innerHTML=d);var t=l.childNodes[0].lastElementChild;t.lastElementChild.style.display="";t.lastElementChild.previousElementSibling.src="./image/cloud/btn_comment_delete.png";break;case "memoInput":dzeUiConfig.objExtInfo.comments.data&&dzeUiConfig.objExtInfo.comments.data.length?dzeUiConfig.objExtInfo.comments.data.push(f):(g=a.parentElement,q=g.nextElementSibling.nextElementSibling,q.innerHTML=null,k=[],k.push(f),dzeUiConfig.objExtInfo.comments.data=
k)}0>a.id.search("mod")&&y(e);a.value="";panelManager.oldOpenWriterUnitEle=null;panelManager.oldOper=-1}catch(fa){alert(fa)}}function K(c,a,b){try{if(!fnObjectCheckNull(panelManager.oldOpenWriterUnitEle)){var d=panelManager.oldOpenWriterUnitEle.id;0<=d.search("memo")?ba(d,panelManager.oldOpenWriterUnitEle.firstElementChild.firstElementChild):0<=d.search("todo")&&ba(d,panelManager.oldOpenWriterUnitEle.firstElementChild)}var e=d=null,f=null;fnObjectCheckNull(c)?fnObjectCheckNull(b)?panelManager.oldOpenWriterUnitEle=
c:(panelManager.oldOpenWriterUnitEle=c,d=b):(panelManager.oldOpenWriterUnitEle=c,d=c.parentElement);if(!fnObjectCheckNull(d))switch(panelManager.oldOper){default:case -1:a?(e=d.previousElementSibling,f=e.previousElementSibling,e.style.display="none",f.style.display="none"):(e=d.previousElementSibling,f=e.previousElementSibling,f.firstElementChild.value="",e.style.display="",f.style.display="");break;case 0:a||(e=d.previousElementSibling,f=e.previousElementSibling,f.firstElementChild.value="",e.style.display=
"",f.style.display="");case 1:}}catch(g){alert(g)}}function pa(c,a){try{var b=c.currentTarget,d=b.closest("div"),e=d.id.split("_display"),f=d.parentElement;K(f,!0,null);if(0<=e[0].search("idx_content_etc_todo")){var g=b.parentElement;g.style.display="none";var h=document.createElement("div");h.id="tmpCancel_"+e[0];h.setAttribute("style","line-height: 1.8;padding-top:10px;padding-bottom:10px;");h.innerHTML='<img style="float:right;padding-left:10px;" src = "./image/cloud/ico_cloud_cancel.png"/>';h.firstElementChild.onclick=
aa;e=g.id.split("_display");var k=document.createElement("div");P(e[0],k,null,!0);k.firstElementChild.value=g.childNodes[1].innerText;f.insertBefore(h,g);f.insertBefore(k,g)}else{f=d.parentElement;var l=b.parentElement.parentElement,n=l.nextElementSibling;b.style.display="none";b.previousElementSibling.src="./image/cloud/ico_cloud_cancel.png";n.style.display="none";e=l.id.split("_display");k=document.createElement("div");P(e[0],k,null,!0);k.firstElementChild.value=n.innerText;f.nextElementSibling?
f.insertBefore(k,f.lastElementChild):l.parentElement.appendChild(k)}panelManager.oldOper=0}catch(q){alert(q)}}function qa(c,a){try{var b=c.currentTarget;0<=b.src.search("ico_cloud_cancel")?aa(c,null):cmnMsg.showMsg(MESSAGE_ALERT,ID_RES_CONST_STRING_NOTI_DELETE_CONFIRM,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();var a=b.parentElement.parentElement.parentElement;if(0<=a.id.search("memo")){var c=a.parentElement;null==a.nextElementSibling&&c.firstElementChild!=a&&
a.previousElementSibling.removeChild(a.previousElementSibling.lastElementChild);if(dzeUiConfig.objExtInfo.comments){var f=dzeJ(a).index();dzeUiConfig.objExtInfo.comments.data.splice(f,1)}c.removeChild(a);"dze_panel_datas_idx_content_etc_memo"!=c.id||c.childElementCount||(c.innerHTML=Q("memo"))}else c=b.parentElement.parentElement,dzeUiConfig.objExtInfo.todos&&(f=dzeJ(c).index(),dzeUiConfig.objExtInfo.todos.data.splice(f,1)),fnObjectCheckNull(c.nextElementSibling)&&(f=c.previousElementSibling)&&f.removeChild(f.lastElementChild),
c.parentElement.removeChild(c),"dze_panel_datas_idx_content_etc_todo"!=a.id||a.childElementCount||(a.innerHTML=Q("todo"))})}catch(d){alert(d)}}function ra(c,a){try{var b=c.currentTarget;b.htmlFor.trim();if(dzeUiConfig.objExtInfo.todos){var d=dzeJ(b.parentElement.parentElement).index(),e=dzeUiConfig.objExtInfo.todos.data[d];0>e.split(";")[0].search("d")?(dzeUiConfig.objExtInfo.todos.data[d]="d"+e,b.setAttribute("style","overflow:visible;width:75%;height:auto;word-wrap:break-word;text-decoration:line-through;")):
(e=e.slice(1),dzeUiConfig.objExtInfo.todos.data[d]=e,b.setAttribute("style","overflow:visible;width:75%;height:auto;word-wrap:break-word;"))}}catch(f){alert(f)}}function Q(c){try{var a=0<=c.search("memo")?ID_RES_CONST_STRING_NO_DATA_MEMO:ID_RES_CONST_STRING_NO_DATA_TODO;c='<div class="nodata showbox" style="padding-top:50%;" >';c+='<img src="./image/bizcube/img_empty_template.png">';return c+('<div style="padding-top:10px;">'+a+"</div>")+"</div>"}catch(b){dalert(b)}}function W(c,a){try{var b=document.createElement("div");
b.id=c;b.className="dze_panel_contents";var d=document.createElement("div");P(c,d,null,!1);b.appendChild(d);var e=document.createElement("div");e.className="dze_panel_separator";b.appendChild(e);var f=document.createElement("div");f.id="dze_panel_datas_"+c;var g=0<=c.search("memo"),h=g?dzeUiConfig.objExtInfo.comments.data:dzeUiConfig.objExtInfo.todos.data;if(h&&h.length)for(a=0;a<h.length;a++){d=c;e=f;g=a;try{var k=null;k="idx_content_etc_memo"==d?M(DZE_CUSTOM_ATT.MEMO,g):M(DZE_CUSTOM_ATT.TODO,g);
k=k.split(";");var l=R(d,g_objCommonUtil.getUniqueID(),k);e.appendChild(l);if(0<g){var n=document.createElement("div");n.className="dze_panel_separator";l.previousElementSibling.appendChild(n)}}catch(q){dalert(q)}}else f.innerHTML=Q(g?"memo":"todo");b.appendChild(f);return b}catch(q){dalert(q)}}function R(c,a,b){try{var d=document.createElement("div");d.id="dze_panel_data_unit_"+c+a;var e=document.createElement("div");e.id=c+"_display0_"+a;e.className="tab_contents_etc_display_0";try{var f=null,g=
null,h="",k=b[0].slice(0,1);"idx_content_etc_todo"==c?(h+='<input type="checkbox" id = "check'+a+'" />',h+='<label for="check'+a+'" style="overflow:visible;width:75%;height:auto;word-wrap:break-word;">'+b[1]+"</label>",e.innerHTML=h+'<img style="float:right;padding-left:10px;" src = "./image/cloud/btn_comment_delete.png"/><img style="float:right" src = "./image/cloud/btn_comment_modify.png" />',f=e.lastElementChild,g=f.previousElementSibling,"d"==k&&(e.childNodes[1].setAttribute("style","overflow:visible;width:75%;height:auto;word-wrap:break-word;text-decoration:line-through;"),
e.childNodes[0].checked=!0),e.childNodes[1].onclick=ra):(h+='<span style="width:100%;float:left;line-height:1.8;color:#797979;font-size:12px;">'+b[0],h+='<img style="float:right;padding-left:10px;" src = "./image/cloud/btn_comment_delete.png"/>',e.innerHTML=h+'<img style="float:right" src = "./image/cloud/btn_comment_modify.png" /></span>',f=e.lastElementChild.lastElementChild,g=f.previousElementSibling);f.onclick=pa;g.onclick=qa;switch(c){case "idx_content_etc_memo":e.className+=" panel_writer_displayF";
break;case "idx_content_etc_todo":e.className+=" panel_writer_displayF"}}catch(n){dalert(n)}d.appendChild(e);if("idx_content_etc_memo"==c){var l=document.createElement("div");l.id=c+"_display1_"+a;l.className="tab_contents_etc_display_1";l.innerHTML=b[1];d.appendChild(l)}return d}catch(n){dalert(n)}}function V(c,a){try{var b=document.createElement("div"),d=document.createElement("iframe"),e=document.createElement("form"),f=document.createElement("input");b.id=c;b.className="dze_panel_contents";d.id=
c+"_iframe";d.name=c+"_iframe";d.style.width="100%";d.style.height="calc(100% - 10px)";d.style.marginTop="10px";d.style.border="none";e.method="post";e.target=c+"_iframe";e.action="/gw/comment.do";e.style.display="none";f.type="text";f.name="commentKey";e.appendChild(f);var g={moduleGbnCode:"oneffice",moduleSeq:a.doc_seq,commentType:"",sort:"D",attachYn:"N",eventType:"ONEFFICE",eventSubType:"ONE001"},h=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(a.doc_seq,a.group_seq,"view_comment");c="";
c+="doc_url|"+h;c+="\u25a6user_nm|"+oneffice_cloud_myInfoData.name;g.eventData=c+"\u25a6noti_msg|{contents}";var k=onefficeGW.getDocumentShareInfo();if(0==fnObjectCheckNull(k)&&0<k.length){a=c=h="";var l=!1;oneffice_cloud_myInfoData.id!==k[0].owner_id&&(h+=k[0].owner_company_id+"_"+k[0].owner_id+";");for(var n=0;n<k.length;n++)switch(k[n].share_type){case "0":if(oneffice_cloud_myInfoData.id===k[n].share_id)break;h+=k[n].share_company_id+"_"+k[n].share_id+";";break;case "1":c+=k[n].share_id+";";break;
case "2":a=k[n].share_company_id;break;case "9":l=!0,a=k[n].share_company_id}!0===l?(a=a.replace(/,/gi,";"),g.compFilterMen=a):(0!==h.length&&(g.empFilterMen=h),0!==c.length&&(g.deptFilterMen=c),0!==a.length&&(a=a.replace(/,/gi,";"),g.compFilterMen=a));0!==h.length&&(g.empFilter=h);0!==c.length&&(g.deptFilter=c);0!==a.length&&0==l&&(a=a.replace(/,/gi,";"),g.compFilter=a)}onefficeGW.getCommentUrl(JSON.stringify(g),!0,function(a){fnObjectCheckNull(a)||(f.setAttribute("value",encodeURIComponent(a)),
e.submit())});b.appendChild(e);b.appendChild(d);return b}catch(q){dalert(q)}}function y(c){try{var a=null,b=null;switch(c){case PANEL_TYPE.DOC_USER_INFO:case PANEL_TYPE.DOC_COMMENT:a=u(c);if(!0===fnObjectCheckNull(a.objExtraInfo))break;c===PANEL_TYPE.DOC_USER_INFO?(dzeJ("#tab_contents_doc_user_info").remove(),b=U(a.strTabId,a.objExtraInfo)):c===PANEL_TYPE.DOC_COMMENT&&(dzeJ("#tab_contents_doc_comment").remove(),b=V(a.strTabId,a.objExtraInfo));b.style.height=parseFloat(w.style.height)-32+"px";w.appendChild(b);
break;case PANEL_TYPE.CHART_ATTR_STYLE:panel_chart.initChartValueCMDEvent(!0);if("line"===onefficeChart.chartType){var d=dzeJ("#idx_content_chart_border_color .dze_panel_box_close");!1===d.hasClass("open")&&d.trigger("click")}break;case PANEL_TYPE.SHAPES_FORMAT:panel_format.updateFormatInfo(c);break;case PANEL_TYPE.SHAPES_EXTRA:panel_extra.updateExtraInfo();break;case PANEL_TYPE.ETC_TODO:var e=null;fnObjectCheckNull(w)||(e=w.childNodes[3].childNodes[2]);var f=null,g=null;g="idx_content_etc_todo";
f=M(DZE_CUSTOM_ATT.TODO,e.childElementCount);f=f.split(";");if(e.lastElementChild){var h=document.createElement("div");h.className="dze_panel_separator";e.lastElementChild.appendChild(h)}var k=R(g,g_objCommonUtil.getUniqueID(),f);e.appendChild(k);break;case PANEL_TYPE.ETC_MEMO:k=null,fnObjectCheckNull(w)||(k=w.childNodes[2].childNodes[2]),g=f=null,g="idx_content_etc_memo",f=M(DZE_CUSTOM_ATT.MEMO,k.childElementCount),f=f.split(";"),k.lastElementChild&&(h=document.createElement("div"),h.className="dze_panel_separator",
k.lastElementChild.appendChild(h)),e=R(g,g_objCommonUtil.getUniqueID(),f),k.appendChild(e)}}catch(l){dalert(l)}}return{getInstance:function(){!0===fnObjectCheckNull(S)&&(S=p());return S}};var S,F,E,w,J,G};
var panel_chart={g_chartFillColorAlphaSpinner:null,g_chartBorderColorAlphaSpinner:null,g_chartBorderWidthSpinner:null,g_panelchartType:"",setPanelChartType:function(a){this.g_panelchartType=a},contentsTableBox_Title_Icon:function(a,c,e){var d=document.createElement("div");d.className="dze_panel_table_div";var b=document.createElement("div");b.style.display="table-cell";b.style.verticalAlign="middle";b.style.width="100px";b.textContent=a;d.appendChild(b);!0===c&&(a=document.createElement("div"),a.style.display=
"table-cell",a.style.verticalAlign="middle",a.textContent=e,d.appendChild(a));e=document.createElement("div");e.className="dze_panel_right_cell_div";d.appendChild(e);return d},subContentChartLegendDiv:function(a){try{var c=document.createElement("div");c.style.height="27px";c.style.verticalAlign="middle";var e=document.createElement("input");e.id="idx_chart_check_legend";e.type="checkbox";e.checked=!1;var d=document.createElement("label");d.setAttribute("for","idx_chart_check_legend");d.textContent=
"\ud45c\uae30\ud568";c.appendChild(e);c.appendChild(d);var b=document.createElement("div");b.style.height="10px";var f=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FONT_NAME);e=[];for(d=1;d<g_arrFontName.length;d++)e.push({value:g_arrFontName[d],text:g_arrFontName[d].replace(/["']/g,"","")});f.lastChild.innerHTML=duzon_dialog.makeComboInputForm("dze_style_font_legend_family",e,null,27,0);var g=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FONT_SIZE);g.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("dze_idx_chart_legend_font_size",
"pt",96,8,14,65,27,0);var h=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FORE_COLOR),k=g_objColorComboBoxUtil.makeNewColorComboBoxDiv("dze_chart_legend_forecolor",null,0);h.lastChild.appendChild(k);var m=this.contentsTableBox_Title_Icon(ID_RES_DIALOG_STRING_POSITION);m.lastChild.innerHTML="<select style='width:65px; height:27px;' id='dze_idx_chart_legend_position'><option value='top'>"+ID_RES_PROP_TAG_STRING_TOP+"</option><option value='right'>"+ID_RES_PROP_TAG_STRING_RIGHT+"</option><option value='bottom' selected='selected'>"+
ID_RES_PROP_TAG_STRING_BOTTOM+"</option><option value='left'>"+ID_RES_PROP_TAG_STRING_LEFT+"</option><option value='none'>"+ID_RES_DIALOG_STRING_NONE+"</option></select>";a.appendChild(c);a.appendChild(dzeJ(b).clone()[0]);a.appendChild(f);a.appendChild(dzeJ(b).clone()[0]);a.appendChild(g);a.appendChild(dzeJ(b).clone()[0]);a.appendChild(h);a.appendChild(dzeJ(b).clone()[0]);a.appendChild(m)}catch(l){dalert(l)}},subContentChartDataLabelDiv:function(a){try{var c=function(a){try{if(""===a.value){$_("dze_chart_label_unit").value=
"";a.value="";var b=dzeJ(a).parents(".dze_panel_table_div");b.hide();b.prev().hide()}else onefficeChart.data_label_unit=a.value,onefficeChart.updateOnefficeChart(!0)}catch(u){dalert(u)}},e=document.createElement("div");e.style.height="27px";e.style.verticalAlign="middle";var d=document.createElement("input");d.id="idx_chart_check_data_label";d.type="checkbox";d.checked=!1;var b=document.createElement("label");b.setAttribute("for","idx_chart_check_data_label");b.textContent=ID_RES_STRING_CHART_LABEL;
e.appendChild(d);e.appendChild(b);var f=document.createElement("div");f.style.height="10px";var g=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FONT_NAME);d=[];for(b=1;b<g_arrFontName.length;b++)d.push({value:g_arrFontName[b],text:g_arrFontName[b].replace(/["']/g,"","")});g.lastChild.innerHTML=duzon_dialog.makeComboInputForm("dze_style_font_label_family",d,null,27,0);var h=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FONT_SIZE);h.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("dze_idx_chart_label_font_size",
"pt",96,8,14,65,27,0);var k=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FORE_COLOR),m=g_objColorComboBoxUtil.makeNewColorComboBoxDiv("dze_chart_label_forecolor",null,0);k.lastChild.appendChild(m);var l=this.contentsTableBox_Title_Icon(ID_RES_DIALOG_STRING_POSITION,!0,ID_RES_STRING_TOP_BOTTOM_POSITION);l.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("dze_data_label_padding_y","px",100,-100,14,65,27,0);var p=this.contentsTableBox_Title_Icon("",!0,ID_RES_STRING_LEFT_RIGHT_POSITION);
p.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("dze_data_label_padding_x","px",100,-100,14,65,27,0);var r=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_DISPLAY_FORM_SETTING);r.lastChild.innerHTML=duzon_dialog.makeComboInputForm("dze_chart_label_unit",onefficeChart.data_label_unit_set,65,27,0);var q=this.contentsTableBox_Title_Icon("");q.style.display="none";var n=document.createElement("input");n.id="dze_chart_label_unit_custom";n.type="text";n.style.width="53px";n.style.padding="4px";
dzeJ(n).on("keydown keyup",function(){3<this.value.length?this.value=this.value.substring(0,3):event.keyCode===ID_KEYCODE_ENTER&&c(this)}).on("blur",function(){c(this)});q.lastChild.appendChild(n);a.appendChild(e);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(g);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(h);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(k);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(l);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(p);a.appendChild(dzeJ(f).clone()[0]);
a.appendChild(r);a.appendChild(dzeJ(f).clone().css({height:"5px",display:"none"})[0]);a.appendChild(q)}catch(t){dalert(t)}},subContentChartDataChangeDiv:function(a){var c=document.createElement("div");c.style.height="27px";c.style.verticalAlign="middle";var e=document.createElement("input");e.id="idx_chart_data_reverse";e.type="checkbox";e.value="1";e.checked=!1;var d=document.createElement("label");d.setAttribute("for","idx_chart_data_reverse");d.textContent=ID_RES_CONST_STRING_CHART_DATA_XY_CONVERT;
c.appendChild(e);c.appendChild(d);e=document.createElement("div");e.style.height="27px";e.style.verticalAlign="middle";d=document.createElement("input");d.id="idx_chart_data_sort_reverse";d.type="checkbox";d.value="1";d.checked=!1;var b=document.createElement("label");b.setAttribute("for","idx_chart_data_sort_reverse");b.textContent=ID_RES_CONST_STRING_CHART_DATA_ORDER_CONVERT;e.appendChild(d);e.appendChild(b);d=document.createElement("div");d.style.height="10px";a.appendChild(c);a.appendChild(dzeJ(d).clone()[0]);
a.appendChild(e)},subContentChartTitleDiv:function(a){try{var c=document.createElement("input");c.id="idx_chart_title";c.type="text";c.placeholder="\ucc28\ud2b8 \uc81c\ubaa9\uc744 \uc785\ub825\ud558\uc138\uc694";var e=document.createElement("div");e.style.height="27px";e.style.verticalAlign="middle";var d=document.createElement("input");d.id="idx_chart_check_title_bold";d.type="checkbox";d.value="1";d.checked=!0;var b=document.createElement("label");b.setAttribute("for","idx_chart_check_title_bold");
b.textContent=ID_RES_CONST_STRING_BOLD;e.appendChild(d);e.appendChild(b);var f=document.createElement("div");f.style.height="10px";var g=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FONT_NAME);d=[];for(b=1;b<g_arrFontName.length;b++)d.push({value:g_arrFontName[b],text:g_arrFontName[b].replace(/["']/g,"","")});g.lastChild.innerHTML=duzon_dialog.makeComboInputForm("dze_chart_title_style_font_family",d,null,27,0);d=[];for(b=1;b<g_objComboBoxWin.arrFontSize.length;b++)d.push({value:g_objComboBoxWin.arrFontSize[b],
text:g_objComboBoxWin.arrFontSize[b]});var h=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FONT_SIZE);h.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("dze_idx_chart_title_font_size","pt",96,8,14,65,27,0);var k=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_FORE_COLOR),m=g_objColorComboBoxUtil.makeNewColorComboBoxDiv("dze_chart_title_forecolor",null,0);k.lastChild.appendChild(m);var l=this.contentsTableBox_Title_Icon(ID_RES_CONST_STRING_CHART_TITLE_PADDING);l.lastChild.innerHTML=
duzon_dialog.makeSpinnerInputForm("dze_graph_title_padding","px",100,0,20,65,27,0);a.appendChild(c);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(e);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(g);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(h);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(k);a.appendChild(dzeJ(f).clone()[0]);a.appendChild(l)}catch(p){dalert(p)}},setColorsSelectItem:function(a,c){try{var e=document.createElement("select");e.style.width="65px";e.style.height="27px";e.id=
c;var d=onefficeChart.chartType;if("polarArea"==d||"pie"==d||"doughnut"==d)for(var b=0;b<onefficeChart.makeLabels.length;b++){var f=document.createElement("option");f.value=b;f.text=onefficeChart.makeLabels[b];e.appendChild(f)}else for(b=0;b<onefficeChart.makeDatasets.length;b++)f=document.createElement("option"),f.value=b,f.text=onefficeChart.makeDatasets[b].label,e.appendChild(f);a.lastChild.appendChild(e)}catch(g){dalert(g)}},initChartValueCMDEvent:function(a){this.setPanelChartType(onefficeChart.chartType);
!0!==a&&(this.addChartTitleDefaultEvent(),this.addChartDataLabelDefaultEvent(),this.addChartlegendDefaultEvent(),this.addChartDataChangeDefaultEvent(),this.addChartFillDefaultEvent(),this.addChartBorderDefaultEvent());this.initChartTitle();this.initChartDataLabel();this.initChartLegend();this.initChartFill();this.initChartBorder()},addChartBorderDefaultEvent:function(){try{var a=1,c=$_("idx_chart_bordercolor_slider"),e="1.0",d="#1d1dff";g_chartBorderColorAlphaSpinner=duzon_dialog.modifySpinnerValue("idx_chart_bordercolor_Alpha",
100,0,50,function(b){b*=1;dlog("fillcolor_Alpha modifySpinnerValue = "+b);c.value=b;onefficeChart.colorBorderAlphaSet[a]=(100-b)/100;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_bordercolor",c,g_chartBorderColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)});g_chartBorderWidthSpinner=duzon_dialog.modifySpinnerValue("idx_chart_borderWidth",10,1,1,function(b){onefficeChart.data_graph_border[a]=parseInt(b,10);onefficeChart.updateOnefficeChart(!0)});$_("idx_chart_check_bordercolor_none").onclick=
function(){dlog("chartRatioFillColor None");e=onefficeChart.colorBorderAlphaSet[a];d=onefficeChart.colorBorderSet[a];panel_chart.objectAtrrUpdate(!0,a,"idx_chart_bordercolor",c,g_chartBorderColorAlphaSpinner);onefficeChart.colorBorderSet[a]="#NONE";onefficeChart.colorBorderAlphaSet[a]="0.0";onefficeChart.updateOnefficeChart(!0)};$_("idx_chart_check_bordercolor").onclick=function(){dlog("chartRatioFillColor");"#NONE"===onefficeChart.colorBorderSet[a]&&(onefficeChart.colorBorderSet[a]=d,onefficeChart.colorBorderAlphaSet[a]=
e);panel_chart.objectAtrrUpdate(!1,a,"idx_chart_bordercolor",c,g_chartBorderColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)};c.onchange=function(){var b=1*c.value;b=(100-b)/100;dlog("slider onChange value = "+b+" selected = "+a);onefficeChart.colorBorderAlphaSet[a]=b;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_bordercolor",c,g_chartBorderColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)};c.oninput=function(){var b=1*c.value;b=(100-b)/100;dlog("slider onInupt value = "+b+" selected = "+
a);onefficeChart.colorBorderAlphaSet[a]=b;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_bordercolor",c,g_chartBorderColorAlphaSpinner)};$_("idx_chart_item_border_select").onchange=function(){a=parseInt(this.value)+1;g_objBorderComboBoxUtil.setSelectedIndex("chartBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,g_objPropTagCommon.getBorderStyleIndex(onefficeChart.data_border_style[a]));g_chartBorderWidthSpinner.setValue(onefficeChart.data_graph_border[a]);panel_chart.objectAtrrUpdate(!1,a,"idx_chart_bordercolor",
c,g_chartBorderColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)};g_objColorComboBoxUtil.initColorComboBox("idx_chart_bordercolor",function(b){onefficeChart.colorBorderSet[a]=b;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_bordercolor",c,g_chartBorderColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]);"line"===panel_chart.g_panelchartType&&(g_objBorderComboBoxUtil.initBorderComboBox("chartBorderStyle",0,function(b){dlog("border Box Style = "+
b);g_objBorderSelectionUtil.setBorderStyle(b);onefficeChart.data_border_style[a]=b;onefficeChart.updateOnefficeChart(!0)}),g_objBorderComboBoxUtil.setContentPosition("chartBorderStyle",198))}catch(b){dalert(b)}},initChartBorder:function(){try{var a=$_("idx_chart_bordercolor_slider");"#NONE"===onefficeChart.colorBorderSet[1]?(panel_chart.objectAtrrUpdate(!0,1,"idx_chart_bordercolor",a,g_chartBorderColorAlphaSpinner),$_("idx_chart_check_bordercolor_none").checked=!0):(panel_chart.objectAtrrUpdate(!1,
1,"idx_chart_bordercolor",a,g_chartBorderColorAlphaSpinner),$_("idx_chart_check_bordercolor").checked=!0);$_("idx_chart_borderWidth").value=onefficeChart.data_graph_border[1];g_objBorderComboBoxUtil.setSelectedIndex("chartBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,g_objPropTagCommon.getBorderStyleIndex(onefficeChart.data_border_style[1]))}catch(c){dalert(c)}},objectAtrrUpdate:function(a,c,e,d,b){var f=!1;0<=e.indexOf("border")&&(f=!0);if(f){var g=onefficeChart.colorBorderAlphaSet[c];c=Color(onefficeChart.colorBorderSet[c]).alpha(g).rgbString()}else g=
onefficeChart.colorAlphaSet[c],c=Color(onefficeChart.colorSet[c]).alpha(g).rgbString();!0===a?(d.disabled=!0,d.classList.add("duzon_dialog_slider_disabled"),b.enable(!1),g_objColorComboBoxUtil.setActive(e,!1),g_objColorComboBoxUtil.setColorValue(e,c),f&&(g_objBorderComboBoxUtil.setActive("chartBorderStyle",!1),g_chartBorderWidthSpinner.enable(!1))):(d.disabled=!1,d.classList.remove("duzon_dialog_slider_disabled"),b.enable(!0),b.setValue(parseInt(d.value),10),g_objColorComboBoxUtil.setActive(e,!0),
g_objColorComboBoxUtil.setColorValue(e,c),f&&(g_objBorderComboBoxUtil.setActive("chartBorderStyle",!0),g_chartBorderWidthSpinner.enable(!0)))},addChartFillDefaultEvent:function(){try{var a=1,c=$_("idx_chart_fillcolor_slider"),e=$_("idx_chart_check_fillcolor_none"),d=$_("idx_chart_check_fillcolor"),b="#1d1dff";e.onclick=function(){dlog("chartRatioFillColor None");b=onefficeChart.colorSet[a];defaultColorAlpha=onefficeChart.colorAlphaSet[a];panel_chart.objectAtrrUpdate(!0,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner);
onefficeChart.colorSet[a]="#NONE";onefficeChart.colorAlphaSet[a]="0.0";onefficeChart.updateOnefficeChart(!0)};d.onclick=function(){dlog("chartRatioFillColor");"#NONE"===onefficeChart.colorSet[a]&&(onefficeChart.colorSet[a]=b,onefficeChart.colorAlphaSet[a]="0.6");panel_chart.objectAtrrUpdate(!1,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)};c.onchange=function(){var b=1*c.value;b=(100-b)/100;dlog("slider onChange value = "+b+" selected = "+a);onefficeChart.colorAlphaSet[a]=
b;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)};c.oninput=function(){var b=1*c.value;b=(100-b)/100;dlog("slider onInupt value = "+b+" selected = "+a);onefficeChart.colorAlphaSet[a]=b;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner)};g_chartFillColorAlphaSpinner=duzon_dialog.modifySpinnerValue("idx_chart_fillcolor_Alpha",100,0,50,function(b){b*=1;dlog("fillcolor_Alpha modifySpinnerValue = "+
b);c.value=b;onefficeChart.colorAlphaSet[a]=(100-b)/100;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)});$_("idx_chart_item_select").onchange=function(){a=parseInt(this.value)+1;var b=!1;"#NONE"===onefficeChart.colorSet[a]?b=e.checked=!0:d.checked=!0;panel_chart.objectAtrrUpdate(b,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)};g_objColorComboBoxUtil.initColorComboBox("idx_chart_fillcolor",
function(b){onefficeChart.colorSet[a]=b;panel_chart.objectAtrrUpdate(!1,a,"idx_chart_fillcolor",c,g_chartFillColorAlphaSpinner);onefficeChart.updateOnefficeChart(!0)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR])}catch(f){dalert(f)}},initChartFill:function(){try{if("line"===onefficeChart.chartType)dzeJ("#idx_content_chart_fill_color").hide();else{dzeJ("#idx_content_chart_fill_color").show();var a=$_("idx_chart_fillcolor_slider");"#NONE"===onefficeChart.colorSet[1]?(panel_chart.objectAtrrUpdate(!0,
1,"idx_chart_fillcolor",a,g_chartFillColorAlphaSpinner),$_("idx_chart_check_fillcolor_none").checked=!0):(panel_chart.objectAtrrUpdate(!1,1,"idx_chart_fillcolor",a,g_chartFillColorAlphaSpinner),$_("idx_chart_check_fillcolor").checked=!0)}}catch(c){dalert(c)}},addChartTitleDefaultEvent:function(){try{$_("idx_chart_title").onchange=function(){onefficeChart.chartTitle=this.value;onefficeChart.updateOnefficeChart(!0)},$_("idx_chart_check_title_bold").onclick=function(){onefficeChart.chartTitleFontStyle=
!0===this.checked?"bold":"normal";onefficeChart.updateOnefficeChart(!0)},$_("dze_chart_title_style_font_family").onchange=function(){onefficeChart.chartTitleFont=this.value;onefficeChart.updateOnefficeChart(!0)},duzon_dialog.modifySpinnerValue("dze_idx_chart_title_font_size",96,8,14,function(a){onefficeChart.chartTitleFontSize=parseInt(a,10);onefficeChart.updateOnefficeChart(!0)}),g_objColorComboBoxUtil.initColorComboBox("dze_chart_title_forecolor",function(a){onefficeChart.chartTitleFontColor=a;
onefficeChart.updateOnefficeChart(!0)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]),duzon_dialog.modifySpinnerValue("dze_graph_title_padding",100,0,0,function(a){onefficeChart.chartTitlePadding=parseInt(a,10);onefficeChart.updateOnefficeChart(!0)})}catch(a){dalert(a)}},initChartTitle:function(){try{var a=$_("idx_chart_title"),c=$_("idx_chart_check_title_bold"),e=$_("dze_chart_title_style_font_family");a.value=onefficeChart.chartTitle;c.checked="bold"===onefficeChart.chartTitleFontStyle?
!0:!1;void 0===onefficeChart.chartTitle?e.selectedIndex=0:1<onefficeChart.chartTitleFont.split(",").length?e.selectIndex=0:e.value=onefficeChart.chartTitleFont;$_("dze_idx_chart_title_font_size").value=onefficeChart.chartTitleFontSize;g_objColorComboBoxUtil.setColorValue("dze_chart_title_forecolor",onefficeChart.chartTitleFontColor);$_("dze_graph_title_padding").value=onefficeChart.chartTitleFontSize}catch(d){dalert(d)}},addChartDataLabelDefaultEvent:function(){try{$_("idx_chart_check_data_label").onclick=
function(){onefficeChart.data_label_view=!0===this.checked?!0:!1;onefficeChart.updateOnefficeChart(!0)},$_("dze_style_font_label_family").onchange=function(){onefficeChart.data_label_font=this.value;onefficeChart.updateOnefficeChart(!0)},duzon_dialog.modifySpinnerValue("dze_idx_chart_label_font_size",96,8,14,function(a){onefficeChart.data_label_FontSize=parseInt(a,10);onefficeChart.updateOnefficeChart(!0)}),g_objColorComboBoxUtil.initColorComboBox("dze_chart_label_forecolor",function(a){onefficeChart.data_label_color=
a;onefficeChart.updateOnefficeChart(!0)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]),duzon_dialog.modifySpinnerValue("dze_data_label_padding_x",100,-100,0,function(a){onefficeChart.data_label_padding_x=parseInt(a,10);onefficeChart.updateOnefficeChart(!0)}),duzon_dialog.modifySpinnerValue("dze_data_label_padding_y",100,-100,0,function(a){onefficeChart.data_label_padding_y=parseInt(a,10);onefficeChart.updateOnefficeChart(!0)}),$_("dze_chart_label_unit").onchange=function(){var a=$_("dze_chart_label_unit_custom"),
c=dzeJ(a).parents(".dze_panel_table_div");"user_custom_unit"===this.value?(c.show(),c.prev().show(),a.focus()):(a.value="",c.hide(),c.prev().hide(),onefficeChart.data_label_unit=""!==this.value?this.value:void 0,onefficeChart.updateOnefficeChart(!0))}}catch(a){dalert(a)}},initChartDataLabel:function(){try{var a=$_("idx_chart_check_data_label"),c=$_("dze_style_font_label_family");a.checked=onefficeChart.data_label_view;void 0===onefficeChart.data_label_font?c.selectedIndex=0:1<onefficeChart.data_label_font.split(",").length?
c.selectIndex=0:c.value=onefficeChart.data_label_font;$_("dze_idx_chart_label_font_size").value=void 0===onefficeChart.data_label_FontSize?14:onefficeChart.data_label_FontSize;g_objColorComboBoxUtil.setColorValue("dze_chart_label_forecolor",onefficeChart.data_label_color);$_("dze_data_label_padding_x").value=onefficeChart.data_label_padding_x;$_("dze_data_label_padding_y").value=onefficeChart.data_label_padding_y;if(void 0!==onefficeChart.data_label_unit){var e=!1;onefficeChart.data_label_unit_set.some(function(a){if(a.value===
onefficeChart.data_label_unit)return e=!0});if(!0===e)$_("dze_chart_label_unit").value=onefficeChart.data_label_unit;else{$_("dze_chart_label_unit").value=onefficeChart.data_label_unit_set[4].value;var d=$_("dze_chart_label_unit_custom");d.value=onefficeChart.data_label_unit;var b=dzeJ(d).parents(".dze_panel_table_div");b.show();b.prev().show()}}else $_("dze_chart_label_unit").value=onefficeChart.data_label_unit_set[0].value}catch(f){dalert(f)}},addChartlegendDefaultEvent:function(){try{$_("idx_chart_check_legend").onclick=
function(){onefficeChart.legend_view=!0===this.checked?!0:!1;onefficeChart.updateOnefficeChart(!0)},$_("dze_style_font_legend_family").onchange=function(){onefficeChart.legend_font=this.value;onefficeChart.updateOnefficeChart(!0)},duzon_dialog.modifySpinnerValue("dze_idx_chart_legend_font_size",96,8,14,function(a){onefficeChart.legend_fontsize=parseInt(a,10);onefficeChart.updateOnefficeChart(!0)}),g_objColorComboBoxUtil.initColorComboBox("dze_chart_legend_forecolor",function(a){onefficeChart.legend_foreColor=
a;onefficeChart.updateOnefficeChart(!0)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]),$_("dze_idx_chart_legend_position").onchange=function(){onefficeChart.legend_position=this.value;onefficeChart.legend_view="none"==onefficeChart.legend_position?!1:!0;onefficeChart.updateOnefficeChart(!0)}}catch(a){dalert(a)}},initChartLegend:function(){try{var a=$_("idx_chart_check_legend"),c=$_("dze_style_font_legend_family"),e=$_("dze_idx_chart_legend_position");a.checked=onefficeChart.legend_view;
void 0===onefficeChart.legend_font?c.selectedIndex=0:1<onefficeChart.legend_font.split(",").length?c.selectIndex=0:c.value=onefficeChart.legend_font;$_("dze_idx_chart_legend_font_size").value=void 0===onefficeChart.legend_fontsize?10:onefficeChart.legend_fontsize;g_objColorComboBoxUtil.setColorValue("dze_chart_legend_forecolor",onefficeChart.legend_foreColor);e.value=onefficeChart.legend_position;"none"===onefficeChart.legend_position?(onefficeChart.legend_view=!1,a.checked=!1):onefficeChart.legend_view=
!0}catch(d){dalert(d)}},addChartDataChangeDefaultEvent:function(){try{$_("idx_chart_data_reverse").onclick=function(){onefficeChart.reverseData();onefficeChart.updateOnefficeChart(!0)},$_("idx_chart_data_sort_reverse").onclick=function(){onefficeChart.reverseSortData();onefficeChart.updateOnefficeChart(!0)}}catch(a){dalert(a)}}};
function panel_format(){}panel_format.prototype=panelManager.getInstance().getCreatePanelContentsFn();panel_format.prototype.nPanelType=PANEL_TYPE.NONE;function addPanelContents_Format(b,e){try{var c=new panel_format;c.__proto__.nPanelType=e.nPanelType;var d=document.createElement("div");d.id=b;d.className="dze_panel_contents";e.objExtraInfo.forEach(function(b){d.appendChild(c.addContentBox(b.id,b.title))});return d}catch(f){dalert(f)}}
panel_format.addFormatFillBox=function(b){try{var e=new panel_format,c=this.prototype.nPanelType,d=document.createElement("div");d.style.height="10px";if(c===PANEL_TYPE.CHART_COLOR_EXTRA){var f=e.addBoxDetail(ID_RES_DIALOG_STRING_POSITION);panel_chart.setColorsSelectItem(f,"idx_chart_item_select");b.appendChild(f);b.appendChild(dzeJ(d).clone()[0])}f=[];switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:var a="idx_chart_check_fillcolor_none";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_fill_none"}f.push({id:a,
title:ID_RES_CONST_STRING_SHAPES_FILL_NONE});switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_check_fillcolor";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_fill_solid"}f.push({id:a,title:ID_RES_CONST_STRING_SHAPES_FILL_SOLID});var m=e.addRadioSet(f,"radio_fill");b.appendChild(m);b.appendChild(dzeJ(d).clone()[0]);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_fillcolor";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_fillcolor"}var h=e.addBoxDetail(ID_RES_PROP_TAG_STRING_COLOR),
n=g_objColorComboBoxUtil.makeNewColorComboBoxDiv(a,null,0);h.lastChild.appendChild(n);b.appendChild(h);b.appendChild(dzeJ(d).clone().height("5px")[0]);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_fillcolor_slider";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_fill_slider"}var g=e.addBoxDetail(ID_RES_CONST_STRING_SHAPES_TRANSPARENT,""),k=g_objPropTagCommon.makeSliderCtrl(a,0,100);k.style.width=g_strBrowserLanguage===ID_LANGUAGE_TYPE_EN?"70px":"105px";g.children[1].style.paddingRight=
"10px";g.children[1].appendChild(k);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_fillcolor_Alpha";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_fill_alpha"}g.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm(a,"%",100,0,0,65,27,0);b.appendChild(g)}catch(l){dalert(l)}};
panel_format.addFormatBorderBox=function(b){try{var e=new panel_format,c=this.prototype.nPanelType,d=document.createElement("div");d.style.height="10px";if(c===PANEL_TYPE.CHART_COLOR_EXTRA){var f=e.addBoxDetail(ID_RES_DIALOG_STRING_POSITION);panel_chart.setColorsSelectItem(f,"idx_chart_item_border_select");b.appendChild(f);b.appendChild(dzeJ(d).clone()[0])}f=[];switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:var a="idx_chart_check_bordercolor_none";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_border_none"}f.push({id:a,
title:ID_RES_CONST_STRING_NO_LINE});switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_check_bordercolor";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_border_solid"}f.push({id:a,title:ID_RES_CONST_STRING_SOLID_LINE});var m=e.addRadioSet(f,"radio_border");b.appendChild(m);b.appendChild(dzeJ(d).clone()[0]);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_bordercolor";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_bordercolor"}var h=e.addBoxDetail(ID_RES_PROP_TAG_STRING_COLOR),n=
g_objColorComboBoxUtil.makeNewColorComboBoxDiv(a,null,0);h.lastChild.appendChild(n);b.appendChild(h);b.appendChild(dzeJ(d).clone().height("5px")[0]);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_bordercolor_slider";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_border_slider"}var g=e.addBoxDetail(ID_RES_CONST_STRING_SHAPES_TRANSPARENT,""),k=g_objPropTagCommon.makeSliderCtrl(a,0,100);k.style.width=g_strBrowserLanguage===ID_LANGUAGE_TYPE_EN?"70px":"105px";g.children[1].style.paddingRight=
"10px";g.children[1].appendChild(k);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_bordercolor_Alpha";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_border_alpha"}g.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm(a,"%",100,0,0,65,27,0);b.appendChild(g);b.appendChild(dzeJ(d).clone().height("5px")[0]);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="idx_chart_borderWidth";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_border_width"}var l=e.addBoxDetail(ID_RES_CONST_STRING_LINE_WIDTH);
l.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm(a,"px",10,1,1,65,27,0);b.appendChild(l);b.appendChild(dzeJ(d).clone().height("5px")[0]);switch(c){case PANEL_TYPE.CHART_COLOR_EXTRA:a="chartBorderStyle";break;case PANEL_TYPE.SHAPES_FORMAT:a="id_shapes_border_style"}var p=e.addBoxDetail(ID_RES_CONST_STRING_LINE_STYLE);g_objBorderComboBoxUtil.arrBorderStyle=["solid","dashed","dotted"];g_objBorderComboBoxUtil.arrBorderWidth=["0","1","2"];p.lastChild.innerHTML=g_objBorderComboBoxUtil.makeBorderComboBoxHTML(a,
COMBOBOX_TYPE_BORDER_STYLE,63,53,27);b.appendChild(p);c===PANEL_TYPE.CHART_COLOR_EXTRA&&"line"!==onefficeChart.chartType&&(p.style.display="none")}catch(q){dalert(q)}};
panel_format.updateFormatInfo=function(b){try{switch(b){case PANEL_TYPE.SHAPES_FORMAT:panelShapesHandler.initShapesFormat(!0);var e=!0;g_objSelectedShapesArray.some(function(b){if(!0!==g_objShapeEvtMgr.isLine(1*b.getAttribute("shape_type")))return e=!1});if(!0===e){var c=dzeJ("#id_content_shapes_border .dze_panel_box_close");!1===c.hasClass("open")&&c.trigger("click")}}}catch(d){dalert(d)}};
panel_format.initFormatPanel=function(){try{switch(this.prototype.nPanelType){case PANEL_TYPE.SHAPES_FORMAT:panelShapesHandler.initShapesFormat(!1)}setTimeout(function(){panel_format.prototype.openDefaultBox(panel_format.prototype.nPanelType)},100)}catch(b){dalert(b)}};
function panel_extra(){}panel_extra.prototype=panelManager.getInstance().getCreatePanelContentsFn();function addPanelContents_ShapesExtra(a,b){try{var c=new panel_extra,d=document.createElement("div");d.id=a;d.className="dze_panel_contents";b.objExtraInfo.forEach(function(a){d.appendChild(c.addContentBox(a.id,a.title))});return d}catch(e){dalert(e)}}
panel_extra.addExtraSizeBox=function(a){try{var b=new panel_extra,c=document.createElement("div");c.style.height="5px";var d=b.addBoxDetail(ID_RES_DIALOG_STRING_HEIGHT);d.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_cm_height","cm",100,0,1,80,27,0);a.appendChild(d);a.appendChild(dzeJ(c).clone()[0]);var e=b.addBoxDetail(ID_RES_DIALOG_STRING_WIDTH);e.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_cm_width","cm",100,0,1,80,27,0);a.appendChild(e);a.appendChild(dzeJ(c).clone()[0]);
var g=b.addBoxDetail(ID_RES_CONST_STRING_SHAPES_ROTATE);g.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_rotation","\u00ba",360,-360,0,80,27,0);a.appendChild(g);a.appendChild(dzeJ(c).clone()[0]);var h=b.addBoxDetail(ID_RES_STRING_CONTROL_HEIGHT);h.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_percent_height","%",1E4,.01,1,80,27,0);a.appendChild(h);a.appendChild(dzeJ(c).clone()[0]);var f=b.addBoxDetail(ID_RES_STRING_CONTROL_WIDTH);f.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_percent_width",
"%",1E4,.01,1,80,27,0);a.appendChild(f);a.appendChild(dzeJ(c).clone()[0]);f=b.addCheckBox("id_shapes_fixed_ratio",ID_RES_CONST_STRING_PAPER_ORIENTATION_GARO+" "+ID_RES_CONST_STRING_PAPER_ORIENTATION_SERO+" "+ID_RES_CONST_STRING_FIXED_RATIO);a.appendChild(f)}catch(k){dalert(k)}};
panel_extra.addExtraTextboxBox=function(a){try{var b=new panel_extra,c=document.createElement("div");c.style.height="5px";var d=b.addBoxDetail(ID_RES_CONST_VERTICAL_ALIGN);d.lastChild.appendChild(utilComboBox.createImageTextType("id_shapes_text_vertical_align",{width:"80px"},{width:"105px",height:"50px",image:{width:"40px",height:"40px"}},[{value:"top",title:ID_RES_CONST_STRING_OBJ_TXT_VALIGN_TOP,image:g_dzEditorBasePath+"image/panel/icon_vertical_align_top.png"},{value:"middle",title:ID_RES_CONST_STRING_SHAPES_TEXT_ALIGN_MIDDLE,
image:g_dzEditorBasePath+"image/panel/icon_vertical_align_center.png"},{value:"bottom",title:ID_RES_CONST_STRING_OBJ_TXT_VALIGN_BOTTOM,image:g_dzEditorBasePath+"image/panel/icon_vertical_align_bottom.png"}],!1));a.appendChild(d);a.appendChild(dzeJ(c).clone().height("15px")[0]);var e=b.addBoxDetail(ID_RES_DIALOG_STRING_MARGIN_LEFT);e.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_padding_left","cm",10,0,1,80,27,0);a.appendChild(e);a.appendChild(dzeJ(c).clone()[0]);var g=b.addBoxDetail(ID_RES_DIALOG_STRING_MARGIN_RIGHT);
g.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_padding_right","cm",10,0,1,80,27,0);a.appendChild(g);a.appendChild(dzeJ(c).clone()[0]);var h=b.addBoxDetail(ID_RES_DIALOG_STRING_MARGIN_TOP);h.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_padding_top","cm",10,0,1,80,27,0);a.appendChild(h);a.appendChild(dzeJ(c).clone()[0]);var f=b.addBoxDetail(ID_RES_DIALOG_STRING_MARGIN_BOTTOM);f.lastChild.innerHTML=duzon_dialog.makeSpinnerInputForm("id_shapes_padding_bottom","cm",
10,0,1,80,27,0);a.appendChild(f);a.appendChild(dzeJ(c).clone()[0])}catch(k){dalert(k)}};panel_extra.updateExtraInfo=function(){try{panelShapesHandler.initShapesExtra(!0);var a=!0;g_objSelectedShapesArray.some(function(b){if(!0!==g_objShapeEvtMgr.isLine(1*b.getAttribute("shape_type")))return a=!1});!0===a&&!0===dzeJ("#id_content_shapes_textbox .dze_panel_box_close").hasClass("open")&&dzeJ("#id_content_shapes_size .dze_panel_box_close").trigger("click")}catch(b){dalert(b)}};
panel_extra.initExtraPanel=function(){try{panelShapesHandler.initShapesExtra(!1),setTimeout(function(){panel_format.prototype.openDefaultBox(PANEL_TYPE.SHAPES_EXTRA)},100)}catch(a){dalert(a)}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var h=a[c];h in d||(d[h]={});d=d[h]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,d,c){var b=this.length||0;0>d&&(d=Math.max(0,b+d));if(null==c||c>b)c=b;c=Number(c);0>c&&(c=Math.max(0,b+c));for(d=Number(d||0);d<c;d++)this[d]=a;return this}},"es6","es3");
function panelShapesHandler(){}panelShapesHandler.prototype.bRadioFill=!0;panelShapesHandler.prototype.bRadioBorder=!0;panelShapesHandler.prototype.objDefault={fillColor:"",fillAlpha:"",borderColor:"",borderAlpha:"",borderWidth:"",borderStyle:"",originHeight:"",originWidth:"",height:"",width:"",rotaionAngle:"",fixedRatio:"",verticalAlign:"",paddingLeft:"",paddingRight:"",paddingTop:"",paddingBottom:""};
panelShapesHandler.getShapesFormatInfo=function(){try{for(var a={fillColor:null,fillAlpha:1,borderColor:null,borderAlpha:1,borderWidth:1,borderStyle:-1,lineOnly:!0},b,d,c,h,k,f,e,g,n,p,l,m=0;m<g_objSelectedShapesArray.length;m++)b=g_objSelectedShapesArray[m],p=1*b.getAttribute("shape_type"),l=g_objShapeEvtMgr.isLine(p),c=b.childNodes[0].childNodes[1].childNodes[1],!1===l?(d=b.childNodes[0].childNodes[1].childNodes[0],void 0!==a.fillColor&&(h=d.style.fill,0===m?a.fillColor=h:a.fillColor!==h&&(a.fillColor=
void 0)),void 0!==a.fillAlpha&&(f=parseFloat(d.style.fillOpacity),!0===isNaN(f)&&(f=1),0===m?a.fillAlpha=f:a.fillAlpha!==f&&(a.fillAlpha=void 0))):(a.fillColor=void 0,a.fillAlpha=void 0),void 0!==a.borderColor&&(k=c.style.stroke,0===m?a.borderColor=k:a.borderColor!==k&&(a.borderColor=void 0)),void 0!==a.borderAlpha&&(e=parseFloat(c.style.strokeOpacity),!0===isNaN(e)&&(e=1),0===m?a.borderAlpha=e:a.borderAlpha!==e&&(a.borderAlpha=void 0)),void 0!==a.borderWidth&&(g=parseFloat(c.style.strokeWidth),!0===
isNaN(g)&&(g=1),0===m?a.borderWidth=g:a.borderWidth!==g&&(a.borderWidth=void 0)),void 0!==a.borderStyle&&(n=g_objPropTagCommon.getBorderStyleIndex(c.style.strokeDasharray),0===m?a.borderStyle=n:a.borderStyle!==n&&(a.borderStyle=void 0)),!0===a.lineOnly&&!1===l&&(a.lineOnly=!1);void 0===a.fillColor&&(a.fillColor="#ffffff");void 0===a.fillAlpha?a.fillAlpha=0:(a.fillAlpha=(1-a.fillAlpha).toFixed(2),a.fillAlpha=Math.round(100*a.fillAlpha));void 0===a.borderColor&&(a.borderColor="#ffffff");void 0===a.borderAlpha?
a.borderAlpha=0:(a.borderAlpha=(1-a.borderAlpha).toFixed(2),a.borderAlpha=Math.round(100*a.borderAlpha));void 0===a.borderWidth&&(a.borderWidth=1);void 0===a.borderStyle&&(a.borderStyle=-1);this.prototype.objDefault.fillColor=a.fillColor;this.prototype.objDefault.fillAlpha=a.fillAlpha;this.prototype.objDefault.borderColor=a.borderColor;this.prototype.objDefault.borderAlpha=a.borderAlpha;this.prototype.objDefault.borderWidth=a.borderWidth;this.prototype.objDefault.borderStyle=a.borderStyle;return a}catch(q){dalert(q)}};
panelShapesHandler.initShapesFormat=function(a){try{var b=this.getShapesFormatInfo();!0!==a&&this.initFormatListener();this.initFormatValues(b)}catch(d){dalert(d)}};
panelShapesHandler.initFormatValues=function(a){try{var b=dzeJ("#id_shapes_fill_none"),d=dzeJ("#id_shapes_fill_solid"),c=dzeJ("#id_shapes_fill_slider"),h=dzeJ("#id_shapes_fill_alpha");"none"===a.fillColor||!0===a.lineOnly?(this.prototype.bRadioFill=!1,b.prop("checked",!0),g_objColorComboBoxUtil.setActive("id_shapes_fillcolor",!1),c.attr("disabled",!0).addClass("duzon_dialog_slider_disabled"),duzon_dialog.setEnableSpinner("id_shapes_fill_alpha",!1),!0===a.lineOnly&&(dzeJ("#id_content_shapes_fill .dze_panel_box_open").css("color",
g_objColorComboBoxUtil.strDisabledColor),b.attr("disabled",!0),d.attr("disabled",!0))):(this.prototype.bRadioFill=!0,d.prop("checked",!0),g_objColorComboBoxUtil.setActive("id_shapes_fillcolor",!0),c.attr("disabled",!1).removeClass("duzon_dialog_slider_disabled"),duzon_dialog.setEnableSpinner("id_shapes_fill_alpha",!0),!1===a.lineOnly&&(dzeJ("#id_content_shapes_fill .dze_panel_box_open").css("color",""),b.attr("disabled",!1),d.attr("disabled",!1)));g_objColorComboBoxUtil.setColorValue("id_shapes_fillcolor",
a.fillColor);g_objColorComboBoxUtil.initColorComboBox("id_shapes_fillcolor",function(a){panelShapesHandler.prototype.objDefault.fillColor!==a&&(g_objBorderSelectionUtil.setBorderColor(a),panelShapesHandler.prototype.objDefault.fillColor=a,panelShapesHandler.updateFormat({color:a},null))},[ID_RES_CONST_STRING_OTHER_COLOR]);c.val(a.fillAlpha);h.val(a.fillAlpha);var k=dzeJ("#id_shapes_border_none"),f=dzeJ("#id_shapes_border_solid"),e=dzeJ("#id_shapes_border_slider"),g=dzeJ("#id_shapes_border_alpha"),
n=dzeJ("#id_shapes_border_width");"none"===a.borderColor?(this.prototype.bRadioBorder=!1,k.prop("checked",!0),g_objColorComboBoxUtil.setActive("id_shapes_bordercolor",!1),e.attr("disabled",!0).addClass("duzon_dialog_slider_disabled"),duzon_dialog.setEnableSpinner("id_shapes_border_alpha",!1),duzon_dialog.setEnableSpinner("id_shapes_border_width",!1),g_objBorderComboBoxUtil.setActive("id_shapes_border_style",!1)):(this.prototype.bRadioBorder=!0,f.prop("checked",!0),g_objColorComboBoxUtil.setActive("id_shapes_bordercolor",
!0),e.attr("disabled",!1).removeClass("duzon_dialog_slider_disabled"),duzon_dialog.setEnableSpinner("id_shapes_border_alpha",!0),duzon_dialog.setEnableSpinner("id_shapes_border_width",!0),g_objBorderComboBoxUtil.setActive("id_shapes_border_style",!0));g_objColorComboBoxUtil.setColorValue("id_shapes_bordercolor",a.borderColor);g_objColorComboBoxUtil.initColorComboBox("id_shapes_bordercolor",function(a){panelShapesHandler.prototype.objDefault.borderColor!==a&&(g_objBorderSelectionUtil.setBorderColor(a),
panelShapesHandler.prototype.objDefault.borderColor=a,panelShapesHandler.updateFormat(null,{color:a}))},[ID_RES_CONST_STRING_OTHER_COLOR]);e.val(a.borderAlpha);g.val(a.borderAlpha);n.val(a.borderWidth);g_objBorderComboBoxUtil.setSelectedIndex("id_shapes_border_style",COMBOBOX_TYPE_BORDER_STYLE,a.borderStyle)}catch(p){dalert(p)}};
panelShapesHandler.initFormatListener=function(){try{var a=dzeJ("#id_shapes_fill_none"),b=dzeJ("#id_shapes_fill_solid"),d=dzeJ("#id_shapes_fill_slider"),c=dzeJ("#id_shapes_fill_alpha");a.click(function(){!1!==panelShapesHandler.prototype.bRadioFill&&(panelShapesHandler.prototype.bRadioFill=!1,g_objColorComboBoxUtil.setActive("id_shapes_fillcolor",!1),d.attr("disabled",!0).val(100).addClass("duzon_dialog_slider_disabled"),duzon_dialog.setEnableSpinner("id_shapes_fill_alpha",!1),c.val(100),panelShapesHandler.updateFormat({color:""},
null))});b.click(function(){if(!0!==panelShapesHandler.prototype.bRadioFill){panelShapesHandler.prototype.bRadioFill=!0;g_objColorComboBoxUtil.setActive("id_shapes_fillcolor",!0);d.attr("disabled",!1).val(0).removeClass("duzon_dialog_slider_disabled");duzon_dialog.setEnableSpinner("id_shapes_fill_alpha",!0);c.val(0);var a=panelShapesHandler.prototype.objDefault.fillColor;"none"===a&&(a="#5b9bd5");g_objColorComboBoxUtil.setColorValue("id_shapes_fillcolor",a);panelShapesHandler.updateFormat({color:a,
alpha:(100-panelShapesHandler.prototype.objDefault.fillAlpha)/100},null)}});d.on("input change",function(){var a=1*this.value;c.val(a);panelShapesHandler.updateFormat({alpha:(100-a)/100},null,!0)}).click(function(){var a=1*this.value;panelShapesHandler.prototype.objDefault.fillAlpha!==a&&(c.val(a),panelShapesHandler.prototype.objDefault.fillAlpha=a,panelShapesHandler.updateFormat({alpha:(100-a)/100},null,!1))});duzon_dialog.modifySpinnerValue("id_shapes_fill_alpha",100,0,0,function(a){a*=1;d.val(a);
panelShapesHandler.updateFormat({alpha:(100-a)/100},null,!0)},function(a){a*=1;panelShapesHandler.prototype.objDefault.fillAlpha!==a&&(d.val(a),panelShapesHandler.prototype.objDefault.fillAlpha=a,panelShapesHandler.updateFormat({alpha:(100-a)/100},null,!1))},null,!1);var h=dzeJ("#id_shapes_border_none"),k=dzeJ("#id_shapes_border_solid"),f=dzeJ("#id_shapes_border_slider"),e=dzeJ("#id_shapes_border_alpha");h.click(function(){!1!==panelShapesHandler.prototype.bRadioBorder&&(panelShapesHandler.prototype.bRadioBorder=
!1,g_objColorComboBoxUtil.setActive("id_shapes_bordercolor",!1),f.attr("disabled",!0).val(100).addClass("duzon_dialog_slider_disabled"),duzon_dialog.setEnableSpinner("id_shapes_border_alpha",!1),e.val(100),duzon_dialog.setEnableSpinner("id_shapes_border_width",!1),g_objBorderComboBoxUtil.setActive("id_shapes_border_style",!1),panelShapesHandler.updateFormat(null,{color:""}))});k.click(function(){if(!0!==panelShapesHandler.prototype.bRadioBorder){panelShapesHandler.prototype.bRadioBorder=!0;g_objColorComboBoxUtil.setActive("id_shapes_bordercolor",
!0);f.attr("disabled",!1).val(0).removeClass("duzon_dialog_slider_disabled");duzon_dialog.setEnableSpinner("id_shapes_border_alpha",!0);e.val(0);duzon_dialog.setEnableSpinner("id_shapes_border_width",!0);g_objBorderComboBoxUtil.setActive("id_shapes_border_style",!0);var a=panelShapesHandler.prototype.objDefault.borderColor;"none"===a&&(a="#41719C");g_objColorComboBoxUtil.setColorValue("id_shapes_bordercolor",a);panelShapesHandler.updateFormat(null,{color:a,alpha:(100-panelShapesHandler.prototype.objDefault.borderAlpha)/
100})}});f.on("input change",function(){var a=1*this.value;e.val(a);panelShapesHandler.updateFormat(null,{alpha:(100-a)/100},!0)}).click(function(){var a=1*this.value;panelShapesHandler.prototype.objDefault.borderAlpha!==a&&(e.val(a),panelShapesHandler.prototype.objDefault.borderAlpha=a,panelShapesHandler.updateFormat(null,{alpha:(100-a)/100},!1))});duzon_dialog.modifySpinnerValue("id_shapes_border_alpha",100,0,0,function(a){var e=1*a;f.val(a);panelShapesHandler.updateFormat(null,{alpha:(100-e)/100},
!0)},function(a){a*=1;panelShapesHandler.prototype.objDefault.borderAlpha!==a&&(f.val(a),panelShapesHandler.prototype.objDefault.borderAlpha=a,panelShapesHandler.updateFormat(null,{alpha:(100-a)/100},!1))},null,!1);duzon_dialog.modifySpinnerValue("id_shapes_border_width",10,1,1,function(a){panelShapesHandler.updateFormat(null,{width:a},!0)},function(a){a*=1;panelShapesHandler.prototype.objDefault.borderWidth!==a&&(panelShapesHandler.prototype.objDefault.borderWidth=a,panelShapesHandler.updateFormat(null,
{width:a},!1))},null,!1);g_objBorderComboBoxUtil.initBorderComboBox("id_shapes_border_style",COMBOBOX_TYPE_BORDER_STYLE,function(a){a=g_objPropTagCommon.getBorderStyleIndex(a);panelShapesHandler.prototype.objDefault.borderStyle!==a&&(panelShapesHandler.prototype.objDefault.borderStyle=a,panelShapesHandler.updateFormat(null,{style:g_objPropTagCommon.getBorderStyle_Graphic(a)}))});g_objBorderComboBoxUtil.setSelectedIndex("id_shapes_border_style",COMBOBOX_TYPE_BORDER_STYLE,0);g_objBorderComboBoxUtil.setContentPosition("id_shapes_border_style",
198)}catch(g){dalert(g)}};
panelShapesHandler.updateFormat=function(a,b,d){try{var c=!1;!1===fnObjectCheckNull(a)?(!1===fnObjectCheckNull(a.color)&&(c=g_objShapeCmd.setShapesFillColor(a.color)),!1===fnObjectCheckNull(a.alpha)&&(c=g_objShapeCmd.setShapesFillAlpha(a.alpha))):!1===fnObjectCheckNull(b)&&(!1===fnObjectCheckNull(b.color)&&(c=g_objShapeCmd.setShapesStrokeColor(b.color)),!1===fnObjectCheckNull(b.alpha)&&(c=g_objShapeCmd.setShapesStrokeAlpha(b.alpha)),!1===fnObjectCheckNull(b.width)&&(c=g_objShapeCmd.setShapesStrokeWidth(b.width)),!1===
fnObjectCheckNull(b.style)&&(c=g_objShapeCmd.setShapesStrokeStyle(b.style)));!0===c&&!0!==d&&g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber)}catch(h){dalert(h)}};
panelShapesHandler.getShapesExtraInfo=function(){try{for(var a={height:1,width:1,rotationAngle:1,fixedRatio:!1,alignIndex:-1,paddingInfo:null,lineOnly:!0},b,d,c,h,k,f,e,g,n,p,l=0;l<g_objSelectedShapesArray.length;l++)b=g_objSelectedShapesArray[l],n=1*b.getAttribute("shape_type"),p=g_objShapeEvtMgr.isLine(n),void 0!==a.height&&(c=parseFloat(b.style.height),0===l?a.height=c:a.height!==c&&(a.height=void 0)),void 0!==a.width&&(h=parseFloat(b.style.width),0===l?a.width=h:a.width!==h&&(a.width=void 0)),
void 0!==a.rotationAngle&&(k=g_objNodeUtil.getRotationAngle(b),0===l?a.rotationAngle=k:a.rotationAngle!==k&&(a.rotationAngle=void 0)),void 0!==a.fixedRatio&&(f="true"===b.getAttribute("fixed_ratio"),0===l?a.fixedRatio=f:a.fixedRatio!==f&&(a.fixedRatio=void 0)),!1===p?(d=b.childNodes[1].firstChild,void 0!==a.alignIndex&&(e=g_objPropTagCommon.changeObjAttVAlignToIdx(d.style.verticalAlign),0===l?a.alignIndex=e:a.alignIndex!==e&&(a.alignIndex=void 0)),void 0!==a.paddingInfo&&(g=g_objNodeUtil.getPadding(d),
0===l?a.paddingInfo=g:(a.paddingInfo.left!==g.left&&(a.paddingInfo.left=void 0),a.paddingInfo.right!==g.right&&(a.paddingInfo.right=void 0),a.paddingInfo.top!==g.top&&(a.paddingInfo.top=void 0),a.paddingInfo.bottom!==g.bottom&&(a.paddingInfo.bottom=void 0),void 0===a.paddingInfo.left&&void 0===a.paddingInfo.right&&void 0===a.paddingInfo.top&&void 0===a.paddingInfo.bottom&&(a.paddingInfo=void 0)))):(a.alignIndex=void 0,a.paddingInfo=void 0),!0===a.lineOnly&&!1===p&&(a.lineOnly=!1);a.height=void 0===
a.height?1:1*g_objCommonUtil.PxToCM(a.height).toFixed(2);a.width=void 0===a.width?1:1*g_objCommonUtil.PxToCM(a.width).toFixed(2);a.rotationAngle=void 0===a.rotationAngle?0:Math.round(a.rotationAngle);void 0===a.fixedRatio&&(a.fixedRatio=!1);void 0===a.alignIndex&&(a.alignIndex=-1);void 0===a.paddingInfo?a.paddingInfo={left:0,right:0,top:0,bottom:0}:(a.paddingInfo.left=void 0===a.paddingInfo.left?0:1*g_objCommonUtil.PxToCM(a.paddingInfo.left).toFixed(1),a.paddingInfo.right=void 0===a.paddingInfo.right?
0:1*g_objCommonUtil.PxToCM(a.paddingInfo.right).toFixed(1),a.paddingInfo.top=void 0===a.paddingInfo.top?0:1*g_objCommonUtil.PxToCM(a.paddingInfo.top).toFixed(1),a.paddingInfo.bottom=void 0===a.paddingInfo.bottom?0:1*g_objCommonUtil.PxToCM(a.paddingInfo.bottom).toFixed(1));this.prototype.objDefault.originHeight=a.height;this.prototype.objDefault.originWidth=a.width;this.prototype.objDefault.height=a.height;this.prototype.objDefault.width=a.width;this.prototype.objDefault.rotaionAngle=a.rotationAngle;
this.prototype.objDefault.fixedRatio=a.fixedRatio;this.prototype.objDefault.alignIndex=a.alignIndex;this.prototype.objDefault.paddingLeft=a.paddingInfo.left;this.prototype.objDefault.paddingRight=a.paddingInfo.right;this.prototype.objDefault.paddingTop=a.paddingInfo.top;this.prototype.objDefault.paddingBottom=a.paddingInfo.bottom;return a}catch(m){dalert(m)}};panelShapesHandler.initShapesExtra=function(a){try{var b=this.getShapesExtraInfo();!0!==a&&this.initExtraListener();this.initExtraValues(b)}catch(d){dalert(d)}};
panelShapesHandler.initExtraValues=function(a){try{dzeJ("#id_shapes_cm_height").val(a.height),dzeJ("#id_shapes_cm_width").val(a.width),dzeJ("#id_shapes_rotation").val(a.rotationAngle),dzeJ("#id_shapes_percent_height").val(100),dzeJ("#id_shapes_percent_width").val(100),dzeJ("#id_shapes_fixed_ratio").prop("checked",a.fixedRatio),!0===a.lineOnly?(dzeJ("#id_content_shapes_textbox .dze_panel_box_open").css("color",g_objColorComboBoxUtil.strDisabledColor),dzeJ("#id_shapes_text_vertical_align").css({"pointer-events":"none",
background:"#dedede"}),dzeJ("#id_shapes_text_vertical_align .dze_combobox_selected_option").empty(),duzon_dialog.setEnableSpinner("id_shapes_padding_left",!1),duzon_dialog.setEnableSpinner("id_shapes_padding_right",!1),duzon_dialog.setEnableSpinner("id_shapes_padding_top",!1),duzon_dialog.setEnableSpinner("id_shapes_padding_bottom",!1)):(dzeJ("#id_content_shapes_textbox .dze_panel_box_open").css("color",""),duzon_dialog.setEnableSpinner("id_shapes_padding_left",!0),duzon_dialog.setEnableSpinner("id_shapes_padding_right",
!0),duzon_dialog.setEnableSpinner("id_shapes_padding_top",!0),duzon_dialog.setEnableSpinner("id_shapes_padding_bottom",!0),dzeJ("#id_shapes_text_vertical_align").css({"pointer-events":"",background:""}),dzeJ("#id_shapes_text_vertical_align .option_item[index="+a.alignIndex+"]").trigger("click"),dzeJ("#id_shapes_padding_left").val(a.paddingInfo.left),dzeJ("#id_shapes_padding_right").val(a.paddingInfo.right),dzeJ("#id_shapes_padding_top").val(a.paddingInfo.top),dzeJ("#id_shapes_padding_bottom").val(a.paddingInfo.bottom))}catch(b){dalert(b)}};
panelShapesHandler.initExtraListener=function(){try{var a=function(a,b){try{var e=!0===b?panelShapesHandler.prototype.objDefault.originHeight:panelShapesHandler.prototype.objDefault.originWidth,g=(e*(parseFloat(a)/100)).toFixed(2);!0===b?d.val(g):c.val(g);!0===f.prop("checked")&&(e=!0===b?panelShapesHandler.prototype.objDefault.originWidth:panelShapesHandler.prototype.objDefault.originHeight,g=(e*(parseFloat(a)/100)).toFixed(2),!0===b?(c.val(g),k.val(a)):(d.val(g),h.val(a)))}catch(l){dalert(l)}},
b=function(a,b){try{var e=Math.round(a/(!0===b?panelShapesHandler.prototype.objDefault.originHeight:panelShapesHandler.prototype.objDefault.originWidth)*100);!0===b?h.val(e):k.val(e);if(!0===f.prop("checked")){var g=!0===b?panelShapesHandler.prototype.objDefault.originWidth:panelShapesHandler.prototype.objDefault.originHeight;g=(e/100*g).toFixed(2);!0===b?(c.val(g),k.val(e)):(d.val(g),h.val(e))}}catch(l){dalert(l)}},d=dzeJ("#id_shapes_cm_height"),c=dzeJ("#id_shapes_cm_width"),h=dzeJ("#id_shapes_percent_height"),
k=dzeJ("#id_shapes_percent_width"),f=dzeJ("#id_shapes_fixed_ratio");duzon_dialog.modifySpinnerValue("id_shapes_cm_height",100,0,1,function(a){b(a,!0);panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(c.val())),height:Math.round(g_objCommonUtil.CMToPx(a))},null,!0)},function(a){b(a,!0);panelShapesHandler.prototype.objDefault.height!==a&&(panelShapesHandler.prototype.objDefault.height=a,!0===f.prop("checked")&&(panelShapesHandler.prototype.objDefault.width=c.val()),panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(panelShapesHandler.prototype.objDefault.width)),
height:Math.round(g_objCommonUtil.CMToPx(a))},null,!1))},.1,!1);duzon_dialog.modifySpinnerValue("id_shapes_cm_width",100,0,1,function(a){b(a,!1);panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(a)),height:Math.round(g_objCommonUtil.CMToPx(d.val()))},null,!0)},function(a){b(a,!1);panelShapesHandler.prototype.objDefault.width!==a&&(panelShapesHandler.prototype.objDefault.width=a,!0===f.prop("checked")&&(panelShapesHandler.prototype.objDefault.height=d.val()),panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(a)),
height:Math.round(g_objCommonUtil.CMToPx(panelShapesHandler.prototype.objDefault.height))},null,!1))},.1,!1);duzon_dialog.modifySpinnerValue("id_shapes_rotation",360,-360,0,function(a){a=Math.round(parseFloat(a));panelShapesHandler.updateExtra({angle:360===a||-360===a?0:a},null,!0)},function(a){a=Math.round(parseFloat(a));a=360===a||-360===a?0:a;panelShapesHandler.prototype.objDefault.rotaionAngle!==a&&(panelShapesHandler.prototype.objDefault.rotaionAngle=a,panelShapesHandler.updateExtra({angle:a},
null,!1))},1,!1);duzon_dialog.modifySpinnerValue("id_shapes_percent_height",1E4,1,1,function(e){a(e,!0);panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(c.val())),height:Math.round(g_objCommonUtil.CMToPx(d.val()))},null,!0)},function(e){a(e,!0);e=d.val();panelShapesHandler.prototype.objDefault.height!==e&&(panelShapesHandler.prototype.objDefault.height=e,!0===f.prop("checked")&&(panelShapesHandler.prototype.objDefault.width=c.val()),panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(panelShapesHandler.prototype.objDefault.width)),
height:Math.round(g_objCommonUtil.CMToPx(e))},null,!1))},1,!1);duzon_dialog.modifySpinnerValue("id_shapes_percent_width",1E4,1,1,function(e){a(e,!1);panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(c.val())),height:Math.round(g_objCommonUtil.CMToPx(d.val()))},null,!0)},function(e){a(e,!1);e=c.val();panelShapesHandler.prototype.objDefault.width!==e&&(panelShapesHandler.prototype.objDefault.width=e,!0===f.prop("checked")&&(panelShapesHandler.prototype.objDefault.height=d.val()),
panelShapesHandler.updateExtra({width:Math.round(g_objCommonUtil.CMToPx(e)),height:Math.round(g_objCommonUtil.CMToPx(panelShapesHandler.prototype.objDefault.height))},null))},1,!1);f.change(function(){panelShapesHandler.prototype.objDefault.fixedRatio!==this.checked&&(panelShapesHandler.prototype.objDefault.fixedRatio=this.checked,panelShapesHandler.updateExtra({fixedRatio:this.checked},null))});utilComboBox.addCallback("id_shapes_text_vertical_align",function(a,b){panelShapesHandler.prototype.objDefault.alignIndex!==
a&&(panelShapesHandler.prototype.objDefault.alignIndex=a,panelShapesHandler.updateExtra(null,{align:b}))});duzon_dialog.modifySpinnerValue("id_shapes_padding_left",10,0,0,function(a){panelShapesHandler.updateExtra(null,{padding:[null,null,null,Math.round(g_objCommonUtil.CMToPx(a))]},!0)},function(a){a=Math.round(g_objCommonUtil.CMToPx(a));panelShapesHandler.prototype.objDefault.paddingLeft!==a&&(panelShapesHandler.prototype.objDefault.paddingLeft=a,panelShapesHandler.updateExtra(null,{padding:[null,
null,null,a]},!1))},.1,!1);duzon_dialog.modifySpinnerValue("id_shapes_padding_right",10,0,0,function(a){panelShapesHandler.updateExtra(null,{padding:[null,Math.round(g_objCommonUtil.CMToPx(a)),null,null]},!0)},function(a){a=Math.round(g_objCommonUtil.CMToPx(a));panelShapesHandler.prototype.objDefault.paddingRight!==a&&(panelShapesHandler.prototype.objDefault.paddingRight=a,panelShapesHandler.updateExtra(null,{padding:[null,a,null,null]},!1))},.1,!1);duzon_dialog.modifySpinnerValue("id_shapes_padding_top",
10,0,0,function(a){panelShapesHandler.updateExtra(null,{padding:[Math.round(g_objCommonUtil.CMToPx(a)),null,null,null]},!0)},function(a){a=Math.round(g_objCommonUtil.CMToPx(a));panelShapesHandler.prototype.objDefault.paddingTop!==a&&(panelShapesHandler.prototype.objDefault.paddingTop=a,panelShapesHandler.updateExtra(null,{padding:[a,null,null,null]},!1))},.1,!1);duzon_dialog.modifySpinnerValue("id_shapes_padding_bottom",10,0,0,function(a){panelShapesHandler.updateExtra(null,{padding:[null,null,Math.round(g_objCommonUtil.CMToPx(a)),
null]},!0)},function(a){a=Math.round(g_objCommonUtil.CMToPx(a));panelShapesHandler.prototype.objDefault.paddingBottom!==a&&(panelShapesHandler.prototype.objDefault.paddingBottom=a,panelShapesHandler.updateExtra(null,{padding:[null,null,a,null]},!1))},.1,!1)}catch(e){dalert(e)}};
panelShapesHandler.updateExtra=function(a,b,d){try{var c=!1,h=g_objShapeEvtMgr.getShapeTextContainer();if(null!==h){var k=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(h.parentNode));!1===fnObjectCheckNull(k)&&(g_objWrapperOutlineUtil_Improved.updateShapeText(k,!0),g_objWrapperOutlineUtil_Improved.hideTextBox(k))}!1===fnObjectCheckNull(a)?(!1===fnObjectCheckNull(a.width)&&(c=g_objShapeCmd.setShapesSize(a.width,
a.height)),!1===fnObjectCheckNull(a.angle)&&(c=g_objShapeCmd.setShapesRotation(null,a.angle)),!1===fnObjectCheckNull(a.fixedRatio)&&g_objShapeCmd.setShapesFixedRatio(a.fixedRatio)):!1===fnObjectCheckNull(b)&&(!1===fnObjectCheckNull(b.align)&&(c=g_objShapeCmd.setShapesVerticalAlign(b.align)),!1===fnObjectCheckNull(b.padding)&&(c=g_objShapeCmd.setShapesTextPadding(b.padding)));dze_menu_control.setTBShapeSizeInfo(g_objPageControl.nEditNumber);!0===c&&!0!==d&&g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber)}catch(f){dalert(f)}};
function GetCurRangeArray(a){try{return new RangeArray(GetCurRange(a))}catch(b){dalert(b)}}function GetCurRangeProp(a){try{return new RangeProp(GetCurRange(a))}catch(b){dalert(b)}}function RangeProp(a){this.sc=null;this.so=0;this.ec=null;this.eo=0;a&&this.initFromRange(a);return this}
RangeProp.prototype={init:function(a,b,c,d){try{return this.sc=a,this.so=b,"undefined"===typeof c?(this.ec=a,this.eo=b):(this.ec=c,this.eo=d),this}catch(e){dalert(e)}},initFromRange:function(a){try{if(!a)return this;this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var b=this.sc.childNodes[this.so]||this.sc;g_objNodeUtil.isTextArea(b)&&(this.bInput=!0,this.selStart=b.selectionStart,this.selEnd=b.selectionEnd);return this}catch(c){dalert(c)}},equal:function(a){try{return a&&
this.so===a.so&&this.eo===a.eo&&this.sc===a.sc&&this.ec===a.ec?!0:!1}catch(b){dalert(b)}},clone:function(){try{var a=new RangeProp;a.sc=this.sc;a.so=this.so;a.ec=this.ec;a.eo=this.eo;return a}catch(b){dalert(b)}},reverse:function(){try{var a=this.sc;this.sc=this.ec;this.ec=a;a=this.so;this.so=this.eo;this.eo=a;return this}catch(b){dalert(b)}},getRange:function(a){try{if(!a){if(!this.sc)return null;a=this.sc.ownerDocument.createRange()}a.setStart(this.sc,this.so);a.setEnd(this.ec,this.eo);return a}catch(b){dalert(b)}},
collapsed:function(){return this.sc===this.ec&&this.so===this.eo?!0:!1},isNull:function(){return this.sc&&this.ec&&this.sc.parentNode&&this.ec.parentNode?!1:!0},isValid:function(){try{if(!(this.sc&&this.ec&&this.sc.parentNode&&this.ec.parentNode))return!1;var a=3===this.sc.nodeType?this.sc.nodeValue.length:this.sc.childNodes.length;if(!(0<=this.so&&this.so<=a))return!1;a=3===this.ec.nodeType?this.ec.nodeValue.length:this.ec.childNodes.length;return 0<=this.eo&&this.eo<=a?!0:!1}catch(b){dalert(b)}},
print:function(){dlog("sc: "+this.sc+", so: "+this.so+", ec: "+this.ec+", eo: "+this.eo)}};RangeProp.prototype.getNativeRange=RangeProp.prototype.getRange;function RangeArray(a){this.arrRangeProp=[];this.init(a);return this}
RangeArray.prototype={init:function(a){try{if(!a)return this;var b=dzeUiConfig;if(a.collapsed||!b.bOfficePagingMode||b.bOfficeOnePageLongMode)return this.arrRangeProp.push(new RangeProp(a)),this;b=g_objPageControl;var c=b.getPageNum(a.startContainer),d=b.getPageNum(a.endContainer);if(null===c||null===d||c==d)return this.arrRangeProp.push(new RangeProp(a)),this;var e=null,g=0,k=null,l=0,f=null;if(c<d)for(var h=c;h<=d;h++)f=b.getPageMain(h),h==c?(e=a.startContainer,g=a.startOffset,k=f,l=f.childNodes.length):
h==d?(e=f,g=0,k=a.endContainer,l=a.endOffset):(e=f,g=0,k=f,l=f.childNodes.length),this.arrRangeProp.push((new RangeProp).init(e,g,k,l));else for(h=d;h>=c;h--)f=b.getPageMain(h),h==d?(e=a.startContainer,g=a.startOffset,k=f,l=0):h==c?(e=f,g=f.childNodes.length,k=a.endContainer,l=a.endOffset):(e=f,g=0,k=f,l=f.childNodes.length),this.arrRangeProp.push((new RangeProp).init(e,g,k,l));return this}catch(m){dalert(m)}},isNull:function(){try{return!this.arrRangeProp||0>=this.arrRangeProp.length||1===this.arrRangeProp.length&&
(null===this.arrRangeProp[0].sc||null===this.arrRangeProp[0].ec)?!0:!1}catch(a){dalert(a)}},getDocument:function(){try{for(var a=0,b=this.getRangeCount();a<b;a++){var c=this.arrRangeProp[a].sc||this.arrRangeProp[a].ec;if(c)return c.ownerDocument}return null}catch(d){dalert(d)}},getRangePropAt:function(a){try{return this.isNull()?null:this.arrRangeProp[a]}catch(b){dalert(b)}},getRangeAt:function(a){try{return this.isNull()?null:this.arrRangeProp[a].getRange()}catch(b){dalert(b)}},getRangeCount:function(){return this.isNull()?
0:this.arrRangeProp.length},getOneRange:function(){try{if(this.isNull())return null;var a=this.getDocument().createRange(),b=this.getRangeCount();a.setStart(this.arrRangeProp[0].sc,this.arrRangeProp[0].so);a.setEnd(this.arrRangeProp[b-1].ec,this.arrRangeProp[b-1].eo);return a}catch(c){dalert(c)}},setCurRange:function(){try{var a=this.getDocument(),b=a?a.defaultView:null,c=b?b.getSelection():null;if(!c)return!1;var d=this.getOneRange();if(!d)return!1;c.removeAllRanges();c.addRange(d);return!0}catch(e){dalert(e)}},
collapsed:function(){try{return this.isNull()||1===this.getRangeCount()&&this.arrRangeProp[0].sc===this.arrRangeProp[0].ec&&this.arrRangeProp[0].so===this.arrRangeProp[0].eo?!0:!1}catch(a){dalert(a)}},collapse:function(a){try{a?this.arrRangeProp.splice(1,this.arrRangeProp.length):this.arrRangeProp.splice(0,this.arrRangeProp.length-1),this.arrRangeProp[0].ec=this.arrRangeProp[0].sc,this.arrRangeProp[0].eo=this.arrRangeProp[0].so}catch(b){dalert(b)}},deleteContents:function(){try{if(!this.isNull()){for(var a=
this.getDocument().createRange(),b=this.getRangeCount()-1;0<=b;b--)this.arrRangeProp[b].getRange(a),a.deleteContents();this.arrRangeProp=[];this.arrRangeProp.push(new RangeProp(a))}}catch(c){dalert(c)}},extractContents:function(){try{if(this.isNull())return null;var a=this.getDocument(),b=a.createRange(),c=null,d=a.createElement("div");a=0;for(var e=this.getRangeCount();a<e;a++)this.arrRangeProp[a].getRange(b),c=range.extractContents(),d.appendChild(c);this.arrRangeProp=[];this.arrRangeProp.push(new RangeProp(b));
appendBodyTemporary(d,null,function(){g_objSplitUtil.mergeAll(d);b.selectNodeContents(d);c=b.extractContents()});b=null;return c}catch(g){dalert(g)}},cloneContents:function(a){try{if(this.isNull())return null;var b=this.getDocument(),c=b.createRange(),d=null,e=b.createElement("div");b=0;for(var g=this.getRangeCount();b<g;b++)this.arrRangeProp[b].getRange(c),d=c.cloneContents(),e.appendChild(d);appendBodyTemporary(e,null,function(){!1!==a&&g_objSplitUtil.mergeAll(e);c.selectNodeContents(e);d=c.extractContents()});
c=null;return d}catch(k){dalert(k)}},doAllRange:function(a){try{if(a&&!this.isNull())for(var b,c=0,d=this.getRangeCount();c<d&&(b=a(this.ranges[c]),!1!==b);c++);}catch(e){dalert(e)}}};
var PageNumberDlg=duzon_dialog.extend();PageNumberDlg.curPgNum=null;PageNumberDlg.wratio=0;PageNumberDlg.hratio=0;PageNumberDlg.arrListener=[];PageNumberDlg.addHandler=function(a,c,b){EventUtil.addHandler(a,c,b);this.arrListener.push({elem:a,type:c,handler:b})};PageNumberDlg.arrNumType=null;PageNumberDlg.arrPosition=null;PageNumberDlg.arrFontFamily=null;PageNumberDlg.id_numpages="id_numpages";PageNumberDlg.id_num_type="id_num_type";PageNumberDlg.id_num_position="id_num_position";
PageNumberDlg.id_font_family="id_font_family";PageNumberDlg.id_font_color="dze_font_forecolor";PageNumberDlg.id_margin_top="id_margin_top";PageNumberDlg.id_margin_left="id_margin_left";PageNumberDlg.id_margin_right="id_margin_right";PageNumberDlg.id_margin_bottom="id_margin_bottom";PageNumberDlg.id_font_size="id_font_size";PageNumberDlg.id_num_start="id_num_start";PageNumberDlg.id_preview="id_preview";PageNumberDlg.id_preview_text="id_preview_text";PageNumberDlg.arrFontStyle=["bold","italic"];
PageNumberDlg.toggleOff="dze_style_font_propery_set";PageNumberDlg.toggleOn="dze_style_font_propery_set_down";
PageNumberDlg.getContents=function(){try{var a="";a+='<div style="width: 320px; font-size: 13px;">';a+='<div class="duzon_dialog_label_title" style="margin-left: 1px;">'+ID_RES_CONST_STRING_FORMAT_STYLE+"</div>";a+='<div class="duzon_dialog_row">'+(ID_RES_CONST_STRING_NUM_FORMAT+this.makeComboInputForm(this.id_num_type,this.arrNumType,136,27))+"</div>";a+='<div class="duzon_dialog_row">'+(ID_RES_CONST_STRING_NUM_POS+this.makeComboInputForm(this.id_num_position,this.arrPosition,136,27))+"</div>";a+=
'<div class="duzon_dialog_row">';a+=ID_RES_CONST_STRING_SHOW_NUMPAGES;a+='<div style="display: flex; align-items: center;width:136px !important; height:27px !important;">';a+='<input type="checkbox" id="'+this.id_numpages+'" name="'+this.id_numpages+'" style="visibility:visible; padding-left:1px !important; margin-left:1px !important;">';a+="</div>";a+="</div>";a+='<div style="margin:20px 0 5px 0;">';a+='<div style="border:1px solid #c5c5c5; position:relative; margin:auto;" id='+this.id_preview+">";
a+='<div class="duzon_dialog_pgnum_preview_page"></div>';a+='<div id="'+this.id_preview_text+'" style="position:absolute;"></div>';a+="</div>";a+="</div>";a+='<div style="margin-left: 1px; margin-top: 9px; font-weight:bold;">'+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_LEFT+this.makeSpinnerInputForm(this.id_margin_left,"mm",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';
a+=ID_RES_PROP_TAG_STRING_TOP+this.makeSpinnerInputForm(this.id_margin_top,"mm",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_RIGHT+this.makeSpinnerInputForm(this.id_margin_right,"mm",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_BOTTOM+this.makeSpinnerInputForm(this.id_margin_bottom,"mm",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';
a+='<div class="duzon_dialog_label_title" style="margin-left: 1px;">'+ID_RES_CONST_STRING_TEXT_STYLE+"</div>";a+='<div class="duzon_dialog_row">'+(ID_RES_CONST_STRING_FONT_NAME+this.makeComboInputForm(this.id_font_family,this.arrFontFamily,136,27))+"</div>";a+='<div class="duzon_dialog_row">'+(ID_RES_CONST_STRING_FONT_SIZE+this.makeSpinnerInputForm(this.id_font_size,"pt",100,0))+"</div>";a+='<div class="duzon_dialog_row">';a+='<div style="flex:1;">'+ID_RES_CONST_STRING_FONT_STYLE+"</div>";for(var c=
"",b="",f="",g=0,e=this.arrFontStyle.length;g<e;g++)c="id_"+this.arrFontStyle[g],b=dzeEnvConfig.strPath_Image+"dialog/btn_style_font_"+this.arrFontStyle[g]+".png",f=eval("ID_RES_CONST_STRING_"+this.arrFontStyle[g].toUpperCase()),a=g==e-1?a+("<div class='dze_style_font_propery_set' style='float:none;margin-right:0;' id='"+c+"'><img src='"+b+"' alt='' title='"+f+"' width='28' height='28'></div>"):a+("<div class='dze_style_font_propery_set' style='float:none;' id='"+c+"'><img src='"+b+"' alt='' title='"+
f+"' width='28' height='28'></div>");a+="</div>";a+='<div class="duzon_dialog_row">'+(ID_RES_CONST_STRING_FORE_COLOR+"<div>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_font_forecolor",90)+"</div>")+"</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title" style="margin-left:1px;">'+ID_RES_CONST_STRING_PGNUMERING+"</div>";a+='<div class="duzon_dialog_row">'+(ID_RES_CONST_STRING_PGNUM_START+this.makeSpinnerInputForm(this.id_num_start,"",100,0,1,
72))+"</div>";return a+"</div>"}catch(m){dalert(m)}};
PageNumberDlg.initDlg=function(){try{this.arrNumType=[{value:0,text:ID_RES_CONST_STRING_PGNUM_NO},{value:1,text:"1, 2, 3, \u00b7\u00b7\u00b7"},{value:2,text:"-1-, -2-, -3-, \u00b7\u00b7\u00b7"},{value:3,text:"<1>, <2>, <3>, \u00b7\u00b7\u00b7"},{value:4,text:"i, ii, iii, \u00b7\u00b7\u00b7"},{value:5,text:"I, II, III, \u00b7\u00b7\u00b7"}];this.arrPosition=[{value:0,text:ID_RED_CONST_STRING_TOP_LEFT},{value:1,text:ID_RED_CONST_STRING_TOP_CENTER},{value:2,text:ID_RED_CONST_STRING_TOP_RIGHT},{value:3,
text:ID_RED_CONST_STRING_BOTTOM_LEFT},{value:4,text:ID_RED_CONST_STRING_BOTTOM_CENTER},{value:5,text:ID_RED_CONST_STRING_BOTTOM_RIGHT}];this.arrFontFamily=[];for(var a=1,c=g_arrFontName.length;a<c;a++)this.arrFontFamily.push({value:g_arrFontName[a],text:g_arrFontName[a].replace(/["']/g,"","")})}catch(b){dalert(b)}};
PageNumberDlg.init=function(){this.selNumType=$_(this.id_num_type);this.selNumPosition=$_(this.id_num_position);this.selFontFamily=$_(this.id_font_family);this.checkboxNumPages=$_(this.id_numpages);this.spinMarginLeft=$_(this.id_margin_left);this.spinMarginTop=$_(this.id_margin_top);this.spinMarginRight=$_(this.id_margin_right);this.spinMarginBottom=$_(this.id_margin_bottom);this.spinFontSize=$_(this.id_font_size);this.spinNumStart=$_(this.id_num_start);this.divBold=$_("id_bold");this.divItalic=$_("id_italic");
this.divPreview=$_(this.id_preview);this.divPreviewText=$_(this.id_preview_text);this.paperSize=this.toPx(cloneSimpleObject(dzeUiConfig.nSettingPaperSize));this.paperMargin=this.toPx(cloneSimpleObject(dzeUiConfig.nSettingPaperMargin));var a=90,c=118;this.paperSize.width>this.paperSize.height&&(a=118,c=90);this.wratio=a/this.paperSize.width;this.hratio=c/this.paperSize.height;this.curPgNum=g_objPageNumber?g_objPageNumber.clone():new PageNumber;a=this.curPgNum.textAtt;a.fontFamily=a.fontFamily||g_strBodyFontFamily;
a.fontSize=a.fontSize||g_strBodyFontSize;a.color=a.color||"";a.fontWeight=a.fontWeight||"";a.fontStyle=a.fontStyle||""};
PageNumberDlg.onload=function(){try{this.init();var a=this.curPgNum,c=this.curPgNum.textAtt,b=a.margin,f=this.paperSize,g=this.paperMargin,e=this.wratio,m=this.hratio,d=this;this.modifySpinnerValue(this.id_margin_left,297,0,b.left,function(a){d.onChangeMargin(a,DZE_DIR.LEFT)});this.modifySpinnerValue(this.id_margin_top,210,0,b.top,function(a){d.onChangeMargin(a,DZE_DIR.TOP)});this.modifySpinnerValue(this.id_margin_right,297,0,b.right,function(a){d.onChangeMargin(a,DZE_DIR.RIGHT)});this.modifySpinnerValue(this.id_margin_bottom,
210,0,b.bottom,function(a){d.onChangeMargin(a,DZE_DIR.BOTTOM)});this.modifySpinnerValue(this.id_font_size,96,8,parseInt(c.fontSize),d.onChangeFontSize.bind(d));this.modifySpinnerValue(this.id_num_start,null,1,a.start,d.onChangeStartNum.bind(d));var h=0;1===a.type?""===a.startSep&&""===a.endSep?h=1:"-"===a.startSep&&"-"===a.endSep?h=2:"<"===a.startSep&&">"===a.endSep&&(h=3):2===a.type?""===a.startSep&&""===a.endSep&&(h=4):3===a.type&&""===a.startSep&&""===a.endSep&&(h=5);this.addHandler(this.selNumType,
"change",function(){d.onChangeNumType(this.selectedIndex)});this.selNumType.selectedIndex=h;this.onChangeNumType(h);this.addHandler(this.selNumPosition,"change",function(){d.onChangeNumPosition(this.selectedIndex)});var k=0>a.position-1?0:a.position-1;this.selNumPosition.selectedIndex=k;this.onChangeNumPosition(k,!0);this.addHandler(this.checkboxNumPages,"change",function(){d.onChangeNumPages(this.checked)});this.checkboxNumPages.checked=a.numpages;var n=this.divPreview.style;n.width=this.toPxStr((f.width-
g.left-g.right)*e);n.height=this.toPxStr((f.height-g.top-g.bottom)*m);n.paddingTop=this.toPxStr(g.top*m);n.paddingBottom=this.toPxStr(g.bottom*m);n.paddingLeft=this.toPxStr(g.left*e);n.paddingRight=this.toPxStr(g.right*e);var l=this.divPreviewText.style;l.marginLeft=this.toPxStr(this.mmToPx(b.left)*e);l.marginRight=this.toPxStr(this.mmToPx(b.right)*e);l.marginTop=this.toPxStr(this.mmToPx(b.top)*m);l.marginBottom=this.toPxStr(this.mmToPx(b.bottom)*m);for(var p in c)c[p]&&(l[p]=c[p]);l.fontSize=Math.max(+(parseInt(c.fontSize)*
this.hratio*2).toFixed(2),7)+"pt";a=0;for(var q=this.selFontFamily.length;a<q;a++)if(this.selFontFamily.options[a].value===c.fontFamily){this.selFontFamily.selectedIndex=a;break}this.addHandler(this.selFontFamily,"change",function(){d.onChangeFontFamily(this[this.selectedIndex].value)});this.addHandler(this.divBold,"click",function(){if(!this.hasAttribute("disabled"))d.onToggleFontStyle("fontWeight","bold")});this.addHandler(this.divItalic,"click",function(){if(!this.hasAttribute("disabled"))d.onToggleFontStyle("fontStyle",
"italic")});if(c.fontWeight)this.onToggleFontStyle("fontWeight","bold");if(c.fontStyle)this.onToggleFontStyle("fontStyle","italic");g_objColorComboBoxUtil.initColorComboBox(this.id_font_color,function(a){d.onChangeFontColor(a)},[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]);c.color&&(g_objColorComboBoxUtil.setColorValue(this.id_font_color,c.color),this.onChangeFontColor(c.color))}catch(r){dalert(r)}};
PageNumberDlg.onunload=function(){for(var a=this.arrListener.length-1;0<=a;a--){var c=this.arrListener[a];EventUtil.removeHandler(c.elem,c.type,c.handler)}};
PageNumberDlg.onChangeNumType=function(a){var c=0,b="",f="";switch(a){case 1:c=1;break;case 2:c=1;f=b="-";break;case 3:c=1;b="<";f=">";break;case 4:c=2;break;case 5:c=3}a=this.curPgNum;a.type=c;a.startSep=b;a.endSep=f;b=this.divPreviewText;0===c?(b.style.display="none",this.enableAll(!1)):(b.style.display="",b.innerHTML=a.getText(1,g_objPageControl.getTotalPageCount()),this.enableAll(!0))};
PageNumberDlg.onChangeNumPosition=function(a,c){var b=this.curPgNum;b.position=a+1;var f=a="",g="",e="",m="",d=!1,h=!1,k=!1,n=!1,l=dzeUiConfig.nSettingPaperMargin,p=l.left,q=l.right,r=Math.max(l.top-15,0);l=Math.max(l.bottom-15,0);0!==b.type&&c&&(r=b.margin.top,p=b.margin.left,q=b.margin.right,l=b.margin.bottom);switch(b.position){case 2:a="50%";f="0px";m="translateX(-50%)";h=!0;l=q=p=0;break;case 3:g=f="0px";k=h=!0;l=p=0;break;case 4:e=a="0px";n=d=!0;q=r=0;break;case 5:a="50%";m="translateX(-50%)";
e="0px";n=!0;q=p=r=0;break;case 6:e=g="0px";n=k=!0;r=p=0;break;default:f=a="0px",d=h=!0,l=q=0}c=this.divPreviewText.style;c.top=f;c.left=a;c.right=g;c.bottom=e;c.transform=m;this.spinMarginTop.value=r;this.spinMarginLeft.value=p;this.spinMarginRight.value=q;this.spinMarginBottom.value=l;0<this.curPgNum.type&&(this.setEnableSpinner(this.id_margin_top,h),this.setEnableSpinner(this.id_margin_left,d),this.setEnableSpinner(this.id_margin_right,k),this.setEnableSpinner(this.id_margin_bottom,n));this.onChangeMargin(r,
DZE_DIR.TOP);this.onChangeMargin(p,DZE_DIR.LEFT);this.onChangeMargin(q,DZE_DIR.RIGHT);this.onChangeMargin(l,DZE_DIR.BOTTOM)};PageNumberDlg.onChangeNumPages=function(a){this.curPgNum.numpages=a;this.divPreviewText.innerHTML=this.curPgNum.getText(1,g_objPageControl.getTotalPageCount())};
PageNumberDlg.onChangeMargin=function(a,c){var b=this.mmToPx(a),f=this.curPgNum.margin,g=this.divPreviewText.style;switch(c){case DZE_DIR.LEFT:f.left=a;g.marginLeft=this.toPxStr(b*this.wratio);break;case DZE_DIR.TOP:f.top=a;g.marginTop=this.toPxStr(b*this.wratio);break;case DZE_DIR.RIGHT:f.right=a;g.marginRight=this.toPxStr(b*this.wratio);break;case DZE_DIR.BOTTOM:f.bottom=a,g.marginBottom=this.toPxStr(b*this.hratio)}};
PageNumberDlg.onChangeFontFamily=function(a){this.curPgNum.textAtt.fontFamily=a;this.divPreviewText.style.fontFamily=a};PageNumberDlg.onChangeFontSize=function(a){this.curPgNum.textAtt.fontSize=a+"pt";this.divPreviewText.style.fontSize=Math.max(+(a*this.hratio*2).toFixed(2),7)+"pt"};PageNumberDlg.onChangeFontColor=function(a){this.curPgNum.textAtt.color=a;this.divPreviewText.style.color=a};
PageNumberDlg.onToggleFontStyle=function(a,c){var b=this["div"+c.capitalizeFirstLetter()];b.className===this.toggleOff?b.className=this.toggleOn:(b.className=this.toggleOff,c="");this.curPgNum.textAtt[a]=c;this.divPreviewText.style[a]=c};PageNumberDlg.onChangeStartNum=function(a){this.curPgNum.start=a};
PageNumberDlg.enableAll=function(a){this.setEnableSpinner(this.id_margin_top,a);this.setEnableSpinner(this.id_margin_left,a);this.setEnableSpinner(this.id_margin_right,a);this.setEnableSpinner(this.id_margin_bottom,a);this.setEnableSpinner(this.id_font_size,a);g_objColorComboBoxUtil.setActive(this.id_font_color,a);this.setEnableSpinner(this.id_num_start,a);a?(this.selNumPosition.removeAttribute("disabled"),this.selFontFamily.removeAttribute("disabled"),this.divBold.removeAttribute("disabled"),this.divItalic.removeAttribute("disabled"),
this.onChangeNumPosition(this.curPgNum.position-1,!0)):(this.selNumPosition.setAttribute("disabled",""),this.selFontFamily.setAttribute("disabled",""),this.divBold.setAttribute("disabled",""),this.divItalic.setAttribute("disabled",""))};PageNumberDlg.toPxStr=function(a){return+a.toFixed(2)+"px"};PageNumberDlg.mmToPx=function(a){return+g_objCommonUtil.convMMToPx(a).toFixed(2)};PageNumberDlg.ptToPx=function(a){return+g_objCommonUtil.convPtToPx(a).toFixed(2)};
PageNumberDlg.toPx=function(a){for(var c in a)a[c]=this.mmToPx(a[c]);return a};
PageNumberDlg.getTemplateContents=function(a,c){a=a.ownerDocument;var b='<div style="width:177px;">'+('<div class="dze_extdlg_title_container" style="display: flex; align-items: center;">'+ID_RES_CONST_STRING_PGNUM+"</div>");b=b+'<div align="left" style="padding: 3px 10px 3px 10px;">'+ID_RES_PROP_TAG_STRING_LEFT;b=b+'<div class="pgnum_template_preview"><canvas width="155px" height="43px"></canvas></div>'+ID_RES_DIALOG_STRING_ALIGN_MIDDLE;b=b+'<div class="pgnum_template_preview"><canvas width="155px" height="43px"></canvas></div>'+
ID_RES_PROP_TAG_STRING_RIGHT;b=b+'<div class="pgnum_template_preview"><canvas width="155px" height="43px"></canvas></div></div>'+('<div class="dze_extdlg_title_container" style="display: flex; align-items: center; margin-top:3px;">'+ID_RES_CONST_STRING_PGNUM+"/"+ID_RES_CONST_STRING_NUMPAGES+"</div>");b=b+'<div align="left" style="padding: 3px 10px 3px 10px;">'+ID_RES_PROP_TAG_STRING_LEFT;b=b+'<div class="pgnum_template_preview"><canvas width="155px" height="43px"></canvas></div>'+ID_RES_DIALOG_STRING_ALIGN_MIDDLE;
b=b+'<div class="pgnum_template_preview"><canvas width="155px" height="43px"></canvas></div>'+ID_RES_PROP_TAG_STRING_RIGHT;b+='<div class="pgnum_template_preview"><canvas width="155px" height="43px"></canvas></div></div></div>';a=a.createRange().createContextualFragment(b);var f=this.toPx(cloneSimpleObject(dzeUiConfig.nSettingPaperSize));b=this.toPx(cloneSimpleObject(dzeUiConfig.nSettingPaperMargin));f=155/f.width;for(var g=a.querySelectorAll(".pgnum_template_preview"),e=0;6>e;e++){var m=g[e];(function(){var a=
c?e:e+6;a+=1;EventUtil.addHandler(m,"mousedown",function(b){m.command_id=ID_COMMAND_PGNUM_TEMPLATE_UP;fnHandler_PageNumber(b,m,g_nActiveEditNumber,a);duzon_dialog.closeExtendsDlg();TBCancelBubbleEvent(b)})})();var d=m.firstChild.getContext("2d");d.lineWidth=1;d.strokeStyle="#c5c5c5";if(c){var h=b.left*f;d.beginPath();d.moveTo(h-5,35.5);d.lineTo(h,35.5);d.lineTo(h,30.5);d.lineWidth=1;d.stroke();var k=155-b.right*f;d.beginPath();d.moveTo(k+5,35.5);d.lineTo(k,35.5);d.lineTo(k,30.5);d.stroke();0===e?
d.fillText("1",h,15):1===e?d.fillText("1",72.5,15):2===e?d.fillText("1",k-5,15):3===e?d.fillText("1/1",h,15):4===e?d.fillText("1/1",72.5,15):5===e&&d.fillText("1/1",k-15,15)}else h=b.left*f,d.beginPath(),d.moveTo(h-5,7.5),d.lineTo(h,7.5),d.lineTo(h,12.5),d.lineWidth=1,d.stroke(),k=155-b.right*f,d.beginPath(),d.moveTo(k+5,7.5),d.lineTo(k,7.5),d.lineTo(k,12.5),d.stroke(),0===e?d.fillText("1",h,35):1===e?d.fillText("1",72.5,35):2===e?d.fillText("1",k-5,35):3===e?d.fillText("1/1",h,35):4===e?d.fillText("1/1",
72.5,35):5===e&&d.fillText("1/1",k-15,35)}return a};
var g_objSplitUtil=new function(){this.DZE_SPLIT="dze_split";this.DZE_SPLIT_CHILD="dze_split_child";this.arrMergeNode=this.arrSplitNode=null;this.bDebug=!1;this.isSkip=function(a){try{return a?"COLGROUP"===a.nodeName||"SOURCE"===a.nodeName||"P"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_hide_para")||"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,g_objCaretUtil.arrCaretMarkerClassName)||8===a.nodeType?!0:!1:!1}catch(b){dalert(b)}};this.isSplitable=function(a){try{if(!a)return!1;if(1===a.nodeType){switch(a.nodeName){case "IMG":case "VIDEO":case "SELECT":case "INPUT":case "IFRAME":return!1}var b=
g_objNodeUtil;if(b.isDocLastNode(a)||b.isDocFirstNode(a))return!1}return!0}catch(c){dalert(c)}};this.splitBefore=function(a,b,c){try{for(var d=g_objNodeUtil,e=null,f=b.parentNode;a!==f;){if(d.isCell(b)||d.isCell(f)){if(b=this.splitTr(a,b,c),!b)break}else if(d.isTr(b)||d.isTr(f)){if(b=this.splitTable(a,b,c),!b)break}else{e=f.cloneNode(!1);var g=b.previousSibling;if(g)for(;g.nextSibling;)e.appendChild(g.nextSibling);else for(;f.firstChild;)e.appendChild(f.firstChild);f.nextSibling?f.parentNode.insertBefore(e,
f.nextSibling):f.parentNode.appendChild(e);this.onSplit(f,e);b=e}f=b.parentNode}return b}catch(m){dalert(m)}};this.splitTextNode=function(a,b){try{if(!a||!a.parentNode||3!==a.nodeType)return a;var c=a.parentNode.ownerDocument,d=g_objPositionUtil,e=a.parentNode;if(!e)return a;var f=e.getBoundingClientRect(),g=d.getPageTop(e);f=d.clientRectToOffsetRect(f);var m=a.nodeValue.length;e=0;var n=c.createRange();c=null;for(var h=0,k=m,l=null,q=0;h+1<k;)l=Math.floor(.5*(h+k)),n.setStart(a,l),n.setEnd(a,Math.min(l+
1,m)),c=n.getBoundingClientRect(),c=d.clientRectToOffsetRect(c),this.bDebug&&dlog(q+") current character:"+a.nodeValue.charAt(l)+", index:"+l),e=Math.floor(c.top-f.top+g+c.height),e>b?k=l:h=l,q++;b=h;f=d=null;0<b&&b<m?(d=a,f=a.splitText(b)):0>=b?f=a:b>=m&&(d=a);return{prevNode:d,nextNode:f}}catch(t){dalert(t)}finally{}};this.splitNode=function(a,b){try{var c=g_objNodeUtil,d=!1,e=null,f=null,g=null;b+=5;g=this.getOverflowNode(a,b);var m=g.overflowNode;b=g.maxBottom;if(m&&3===m.nodeType){var n=this.splitTextNode(m,
b);n.nextNode?m=n.nextNode:n.prevNode&&n.prevNode.nextSibling&&(m=n.prevNode.nextSibling)}if(m){var h=c.findSplitPosition(m,a),k=c.getLoopParentNodeOn(m,a);if(k.contains&&k.contains(3===h.nodeType?h.parentNode:h)&&k!==h){g_objPageControl.saveCaret();d=!0;var l=!this.arrSplitNode;l&&(this.arrSplitNode=[]);this.setSplitAttr(k,this.DZE_SPLIT);this.setSplitAttr(h.parentNode,this.DZE_SPLIT_CHILD);(f=this.splitBefore(a,h,b))?e=f.previousSibling:(d=!1,e=null);l&&(this.onSplitEnd(this.arrSplitNode),this.arrSplitNode=
null)}else d=!1,e=k.previousSibling,f=k}return{bNodeSplit:d,prevNode:e,nextNode:f}}catch(q){dalert(q)}};this.splitTable=function(a,b,c){try{a=g_objNodeUtil;var d=a.getLoopParentElement(b,"tr"),e=a.getLoopParentElement(d.parentNode,"table"),f=new TableMatrix(e,!0),g=f.trs.indexOf(d);if(0>=g)return e;b=0;for(var m=f.colLength;b<m;b++)if(f.isHideForRowspan(g,b)){var n=f.getCell(g,b);this.setSplitAttr(n,this.DZE_SPLIT)}var h=f.divideTable(g);if(!h)return e;f.setTableArray([e,h]);this.updateTr(g-1,f,c);
this.onSplit(e,h);return e.nextSibling}catch(k){dalert(k)}};this.getStyleTemporary=function(a){try{return 1!==a.nodeType||"A"!==a.nodeName&&"SPAN"!==a.nodeName||!a.querySelector("img, video, iframe, span.dze_video_iframe_container_span")?null:{display:"inline-block"}}catch(b){dalert(b)}};this.setStyleTemporary=function(a,b,c){try{if(b=b||this.getStyleTemporary(a)){var d={},e;for(e in b)d[e]=a.style[e],a.style[e]=b[e];c&&c(a);for(e in b)a.style[e]=d[e]}else c&&c(a)}catch(f){dalert(f)}};this.getOverflowNode=
function(a,b){try{for(var c=g_objNodeUtil,d=g_objPositionUtil,e=dzeUiConfig.bUseSplitTr,f=0,g=[],m=[],n=[],h=0,k=function(a,b){g.push(a);m.push(b);0<h&&n.push(a);h++},l=function(){g.pop();m.pop();g.length!==n.length&&n.pop();h--},q=function(a){if(a)for(var b=g.length;0<b&&g[b-1]&&g[b-1].nodeName!==a;)l(),b=g.length},t=function(){var a=g.length;return 0<a?g[a-1]:null},p=a.firstChild,r=0,u={overflowNode:null,maxBottom:b};p;){if(!(this.skipOverflowCheck(p)||!e&&c.isCell(p)))if(this.setStyleTemporary(p,
null,function(a){r=d.getPageRect(a,!0).bottom()}),r>b)if(k(p,r),e&&c.isTr(p)){var x=c.getLoopParentElement(p,"table"),w=x.rows,z=w.length,v=Array.prototype.indexOf.call(w,p),A=this.getTrSplitInfo(x,b);if(0>A.row){if(!(0<=v-1&&w[v-1]||(q("TABLE"),t())))return u;break}else if(A.row>=z){if(v+1<z&&w[v+1])l(),k(w[v+1],r);else{q("TABLE");x=t();if(!x||"TABLE"!==x.nodeName)return u;l();k(x.nextSibling,r)}break}else if(p.firstChild){p=p.firstChild;continue}else break}else if(e&&c.isCell(p))break;else if(this.isSplitable(p))if(p.firstChild){p=
p.firstChild;continue}else{f=f?f:a.offsetHeight;if(this.findBigHeightNextElement(p,f)){b=r;g=[];m=[];h=0;p=a.firstChild;r=0;continue}break}else{c.isInlineNode(p)&&1===p.nodeType&&"baseline"!==p.style.verticalAlign&&""!==p.style.verticalAlign&&l();break}else for(;!p.nextSibling&&0<h&&m[h-1]>b&&(!e||!c.isCell(p));)l(),p=p.parentNode;p=p.nextSibling}var y=0<h?g[h-1]:null;1!==h||n[0]||!c.isParagraph(y)&&!c.isList(y)||(y=y.nextSibling);u.overflowNode=y;u.maxBottom=b;return u}catch(B){dalert(B)}};this.skipOverflowCheck=
function(a){try{if(!a)return!1;var b=1===a.nodeType;if("COLGROUP"===a.nodeName)return!0;var c=b?a.style.position:"";if(c&&("fixed"===c||"absolute"===c))return!0;var d=b?a.style.display:"";return d&&"none"===d?!0:!1}catch(e){dalert(e)}};this.findBigHeightNextElement=function(a,b){try{if(!a||3!==a.nodeType||!a.nextSibling)return null;for(var c=g_objNodeUtil,d=null;a;){if(1===a.nodeType){var e=c.getMargin(a);if(a.offsetHeight+e.bottom>b){d=a;break}}a=a.nextSibling}return d}catch(f){dalert(f)}};this.mergeOn=
function(a,b,c){try{for(var d=null,e=null,f=g_objNodeUtil;b&&c;){if(!b||!c||3===b.nodeType||3===c.nodeType||b===a){f.normalize(b.parentNode);break}if("TABLE"===b.nodeName&&"TABLE"===c.nodeName){this.mergeTable(a,b,c);break}else if("TR"===b.nodeName&&"TR"===c.nodeName){this.mergeTr(a,b,c);break}d=b.lastChild;e=c.firstChild;this.isSkip(e)&&(e=e.nextSibling);this.onMerge(b,c);f.moveNodesTo(b,c.firstChild);c.parentNode.removeChild(c);b=d;c=e}return!0}catch(g){dalert(g)}};this.mergeNode=function(a,b){try{if(!(a&&
b&&a.parentNode&&b.parentNode&&this.getCommonSplitID(a,b)))return!1;for(var c=this.DZE_SPLIT_CHILD,d=a,e=b,f=null;d&&e;){for(;d&&this.isSkip(d);)d=d.previousSibling;for(;e&&this.isSkip(e);)e=e.nextSibling;if(!d||!e)break;this.getCommonSplitID(d,e,c)&&(f=d.lastChild);if(!this.equalNodeTypeName(d,e)){null===f&&(f=d);break}d=d.lastChild;e=e.firstChild}return this.mergeOn(f,a,b)}catch(g){dalert(g)}};this.mergeAll=function(a){try{if(!a)return!1;this.arrMergeNode=[];for(var b=a.firstChild;b;){var c=b.nextSibling;
if(!this.mergeNode(b,c)||c.parentNode)b=b.nextSibling}this.onMergeEnd(this.arrMergeNode);this.arrMergeNode=null;return!0}catch(d){dalert(d)}};this.onSplit=function(a,b){try{this.arrSplitNode&&this.arrSplitNode.push({prev:a,next:b});b&&"P"===b.nodeName&&b.style.textIndent&&(b.style.textIndent="");var c=g_objPropertyUtil,d=g_objPageControl.DZE_PAGE_BREAK_PARA;c.hasClass(a,d)&&c.removeClass(a,d);b&&"LI"===b.nodeName&&(b.style.listStyleType="none");a&&b&&"TABLE"===a.nodeName&&0<=a.className.indexOf("dze_table_style")&&
(a.removeAttribute("dze_split_first"),b.removeAttribute("dze_split_first"),this.getPreviousSplitSibling(a)||a.setAttribute("dze_split_first",""))}catch(e){dalert(e)}};this.onMerge=function(a,b){try{this.arrMergeNode&&this.arrMergeNode.push(a);var c=g_objPropertyUtil,d=g_objPageControl.DZE_PAGE_BREAK_PARA;c.hasClass(b,d)&&c.addClass(a,d)}catch(e){dalert(e)}};this.onSplitEnd=function(a){try{if(a)for(var b=0,c=a.length;b<c;b++){var d=a[b].next;"OL"===a[b].prev.nodeName&&updateOList(d)}}catch(e){dalert(e)}};
this.onMergeEnd=function(a){try{if(a)for(var b=0,c=a.length;b<c;b++){var d=a[b];"OL"===d.nodeName&&updateOList(d)}}catch(e){dalert(e)}};this.resetSplitID=function(a){try{if(a)for(var b=g_objNodeUtil,c=a.firstChild;c;)b.hasAttribute(c,this.DZE_SPLIT)&&!this.isSplitNode(c)&&this.removeAllSplitAttr(c),c=c.nextSibling}catch(d){dalert(d)}};this.setSplitAttr=function(a,b){try{if(!a||!a.getAttribute)return!1;b=b||this.DZE_SPLIT;if(a.getAttribute(b))return!0;a.setAttribute(b,g_objCommonUtil.getUniqueID());
return!0}catch(c){dalert(c)}};this.removeAllSplitAttr=function(a){try{g_objNodeUtil.removeAttribute(a,this.DZE_SPLIT);g_objNodeUtil.removeAttribute(a,this.DZE_SPLIT_CHILD);var b=a.querySelectorAll("["+this.DZE_SPLIT+"]");forEach(b,function(a,b){b.removeAttribute(this.DZE_SPLIT);b.removeAttribute("dze_split_first")},this);b=a.querySelectorAll("["+this.DZE_SPLIT_CHILD+"]");forEach(b,function(a,b){b.removeAttribute(this.DZE_SPLIT_CHILD)},this)}catch(c){dalert(c)}};this.isSplitNode=function(a,b){try{return a&&
a.hasAttribute?this.getPreviousSplitSibling(a)||this.getNextSplitSibling(a)?!0:!1:!1}catch(c){dalert(c)}};this.getCommonSplitID=function(a,b,c){try{if(!(a&&b&&a.getAttribute&&b.getAttribute))return 0;c=c||this.DZE_SPLIT;var d=a.getAttribute(c),e=b.getAttribute(c);return d&&e&&d===e?d:0}catch(f){dalert(f)}};this.getSplitNodes=function(a){try{var b=[];pushArray(b,this.getPrevSplitNodes(a));b.push(a);pushArray(b,this.getNextSplitNodes(a));return b}catch(c){dalert(c)}};this.expandSplitNodes=function(a){try{for(var b=
this.getPrevSplitNodes(a[0]),c=0,d=b.length;c<d;c++)a.splice(0,0,b[c]);pushArray(a,this.getNextSplitNodes(a[a.length-1]));return a}catch(e){dalert(e)}};this.getPrevSplitNodes=function(a){try{for(var b=[],c=null;a;){c=this.getPreviousSplitSibling(a);if(!c)break;if(c===a)break;a=c;b.splice(0,0,a)}return b}catch(d){dalert(d)}};this.getNextSplitNodes=function(a){try{for(var b=[],c=null;a;){c=this.getNextSplitSibling(a);if(!c)break;if(c===a)break;a=c;b.push(a)}return b}catch(d){dalert(d)}};this.getFirstSplitNode=
function(a){try{for(var b=null;a;){b=this.getPreviousSplitSibling(a);if(!b||b===a)break;a=b}return a}catch(c){dalert(c)}};this.getLastSplitNode=function(a){try{for(var b=null;a;){b=this.getNextSplitSibling(a);if(!b||b===a)break;a=b}return a}catch(c){dalert(c)}};this.getPreviousSibling=function(a){try{if(!a)return null;if(a.previousSibling)return a.previousSibling;var b=a.parentNode;if(dzeUiConfig.bOfficePagingMode&&b&&"DIV"===b.nodeName&&g_objPropertyUtil.hasClass(b,"dze_page_main")){b=g_objPageControl;
var c=b.getPageNum(a);if(null===c)return null;a=null;for(--c;0<=c;c--){a=b.getPageMain(c);if(!a)break;if(a.lastChild)return a.lastChild}}return null}catch(d){dalert(d)}};this.getNextSibling=function(a){try{if(!a)return null;if(a.nextSibling)return a.nextSibling;var b=a.parentNode;if(dzeUiConfig.bOfficePagingMode&&b&&"DIV"===b.nodeName&&g_objPropertyUtil.hasClass(b,"dze_page_main")){b=g_objPageControl;var c=b.getPageNum(a);if(null===c)return null;var d=b.getTotalPageCount();a=null;for(c+=1;c<d;c++){a=
b.getPageMain(c);if(!a)break;if(a.firstChild)return a.firstChild}}return null}catch(e){dalert(e)}};this.getPreviousSplitSibling=function(a){try{if(!a||!a.parentNode||!dzeUiConfig.bOfficePagingMode)return null;for(var b=g_objNodeUtil,c=a,d=0,e=null;c&&!b.isLoopBreakNode(c.parentNode);){if(b.isCell(c))e||(e=[]),e.push(c);else if(c.previousSibling&&!this.isSkip(c.previousSibling))return null;d++;c=c.parentNode}for(var f=this.getPreviousSibling(c);f&&this.isSkip(f);)f=this.getPreviousSibling(f);if(this.getCommonSplitID(c,
f)){for(c=f;c&&0<d;){d--;for(c=c.lastChild;c&&this.isSkip(c);)c=c.previousSibling;b.isCell(c)&&(c=this.getPrevSplitCell(c,e.pop()))}if(this.equalNodeTypeName(a,c))return c}return null}catch(g){dalert(g)}};this.getNextSplitSibling=function(a){try{if(!a||!a.parentNode||!dzeUiConfig.bOfficePagingMode)return null;for(var b=g_objNodeUtil,c=a,d=0,e=null;c&&!b.isLoopBreakNode(c.parentNode);){if(b.isCell(c))e||(e=[]),e.push(c);else if(c.nextSibling&&!this.isSkip(c.nextSibling))return null;d++;c=c.parentNode}for(var f=
this.getNextSibling(c);f&&this.isSkip(f);)f=this.getNextSibling(f);if(this.getCommonSplitID(c,f)){for(c=f;c&&0<d;){d--;for(c=c.firstChild;c&&this.isSkip(c);)c=c.nextSibling;b.isCell(c)&&(c=this.getNextSplitCell(c,e.pop()))}if(this.equalNodeTypeName(a,c))return c}return null}catch(g){dalert(g)}};this.equalNodeTypeName=function(a,b){try{return a&&b&&a.nodeType===b.nodeType&&a.nodeName===b.nodeName?!0:!1}catch(c){dalert(c)}};this.getPrevSplitCell=function(a,b){try{var c=g_objNodeUtil,d=c.getLoopParentElement(a,
"tr"),e=c.getLoopParentElement(d.parentNode,"table"),f=e.rows,g=g_objTableUtil.getRowspan(a);if(d.rowIndex+g!==f.length)return null;var m=c.getLoopParentElement(b,"tr");if(m.previousSibling)return null;var n=new TableMatrix(e,!0);d=c=0;for(var h=m.firstChild;h&&h!=b;)c+=n.getColspan(h),h=h.nextSibling;d=c+n.getColspan(b)-1;a=n.getCell(n.rowLength-1,c);if(!this.getCommonSplitID(a,b))return null;var k=n.getColRange(n.rowLength-1,c);return k.start!==c||k.end!==d?null:a}catch(l){dalert(l)}};this.getNextSplitCell=
function(a,b){try{var c=g_objNodeUtil,d=c.getLoopParentElement(b,"tr"),e=c.getLoopParentElement(d.parentNode,"table"),f=e.rows,g=g_objTableUtil.getRowspan(b);if(d.rowIndex+g!==f.length)return null;var m=c.getLoopParentElement(a,"tr");if(m.previousSibling)return null;var n=new TableMatrix(e,!0),h=n.getColRangeFromCell(b);e=d=c=0;for(var k=m.firstChild;k;){if(c>=h.start){d=c;e=d+n.getColspan(k)-1;break}c+=n.getColspan(k);k=k.nextSibling}a=k;if(!this.getCommonSplitID(b,a))return null;h=n.getColRange(n.rowLength-
1,d);return h.start!==d||h.end!==e?null:a}catch(l){dalert(l)}};this.getTrSplitInfo=function(a,b){try{var c=g_objPositionUtil,d=a.rows,e=d.length;a=-1;for(var f=0;f<e;f++){var g=c.getPageBottom(d[f]);if(g>b){a=f;break}}c=null;0<=a&&a<e&&(c=[],c[1]=g-b,c[0]=d[a].offsetHeight-c[1],33>c[0]?(a=-1,c=null):5>=c[1]&&(a=e,c=null));return{row:a,arrHeight:c}}catch(m){dalert(m)}};this.updateTr=function(a,b,c){try{for(var d=g_objNodeUtil,e=b.table.ownerDocument,f=null,g=0,m=b.colLength;g<m;g++)if(!b.isHideForColspan(a,
g)){var n=b.getCell(a,g),h=b.getCell(a+1,g);if(this.getCommonSplitID(n,h,this.DZE_SPLIT)){var k=n.style.verticalAlign;n.style.verticalAlign="top";var l=this.splitNode(n,c);l.nextNode&&l.nextNode===n.firstChild&&(l.nextNode=l.nextNode.nextSibling);l.nextNode&&(f||(f=e.createDocumentFragment()),d.moveNodesTo(f,l.nextNode));n.style.verticalAlign=k;f&&f.firstChild&&(h.firstChild?h.insertBefore(f,h.firstChild):h.appendChild(f),this.mergeAll(h))}}return!0}catch(q){dalert(q)}};this.splitTr=function(a,b,
c){try{a=g_objNodeUtil;var d=g_objTableFunction,e=a.getLoopParentElement(b,"tr"),f=a.getLoopParentElement(e.parentNode,"table"),g=this.getTrSplitInfo(f,c),m=f.rows,n=m.length,h=Array.prototype.indexOf.call(m,e);if(0>g.row)return dalert(""),0<=h-1&&m[h-1]?e:f;if(g.row>=n)return dalert(""),h+1<n&&m[h+1]?m[h+1]:f.nextSibling;var k=g.row,l=g.arrHeight,q=new TableMatrix(f,!0);this.setSplitAttr(q.trs[k],this.DZE_SPLIT);q.divideRow(k,2,l);for(var t=q.colLength-1;0<=t;t--)if(!q.isHideForColspan(k,t)){var p=
q.getCell(k,t);this.setSplitAttr(p,this.DZE_SPLIT);q.divideCellAtY(p,k+1,l);var r=q.getCell(k+1,t);d.setCellBorderWidth(r,DZE_DIR.TOP,0,q)}this.updateTr(k,q,c);return e.nextSibling}catch(u){dalert(u)}};this.equalColRange=function(a,b,c,d,e){try{var f=e.getColRange(a,b),g=e.getColRange(c,d);return f&&g&&f.start===g.start&&f.end===g.end?!0:(dalert("Exception: same col range"),!1)}catch(m){dalert(m)}};this.getCellOffsetHeightSum=function(a,b){try{var c=g_objTableUtil,d=g_objPropertyUtil,e=d.getStyleHeight(a),
f=d.getStyleHeight(b),g=c.styleHeightToOffsetHeight(e,a),m=c.styleHeightToOffsetHeight(f,b);return g+m}catch(n){dalert(n)}};this.mergeTable=function(a,b,c){try{var d=g_objNodeUtil,e=g_objTableUtil,f=g_objTableFunction,g=g_objPropertyUtil,m=b.ownerDocument.createDocumentFragment(),n=b.rows,h=c.rows,k=n.length;if(1>k){for(var l=b.lastChild;l&&"TBODY"!==l.nodeName&&"THEAD"!==l.nodeName;)l=l.previousSibling;if(l&&("TBODY"===l.nodeName||"THEAD"===l.nodeName)){for(;h[0];)m.appendChild(h[0]);l.appendChild(m)}return!0}--k;
l=0;for(var q=n[k],t=h[0];h[0];)m.appendChild(h[0]);insertAfter(q,m);c.parentNode.removeChild(c);if(this.getCommonSplitID(q,t,this.DZE_SPLIT))return this.mergeTr(a,q,t);var p=new TableMatrix(b,!0);b=a=null;for(l=p.colLength-1;0<=l;l--)if(!p.isHideForColspan(k,l)){var r=p.getCell(k,l),u=p.getCell(k+1,l);if(this.getCommonSplitID(r,u,this.DZE_SPLIT)&&this.equalColRange(k,l,k+1,l,p)){a||(a=[]);b||(b=[]);a.push(r);b.push(u);d.moveNodesTo(m,u.firstChild);r.appendChild(m);var x=p.getRowspan(r)+p.getRowspan(u);
p.setRowspan(r,x);var w=this.getCellOffsetHeightSum(r,u),z=g.getStyleBorderWidth(u,DZE_DIR.BOTTOM);f.setCellBorderWidth(r,DZE_DIR.BOTTOM,z,p);w=e.offsetHeightToStyleHeight(w,r);e.setNodeValue_Height(r,w,"px")}}if(b)for(var v=0,A=b.length;v<A;v++)b[v].parentNode.removeChild(b[v]);if(a)for(v=0,A=a.length;v<A;v++)this.mergeAll(a[v]);return!0}catch(y){dalert(y)}};this.mergeTr=function(a,b,c){try{a=g_objNodeUtil;var d=g_objTableUtil,e=g_objTableFunction,f=g_objPropertyUtil,g=a.getLoopParentElement(b,"table"),
m=g.ownerDocument,n=null,h=null,k=new TableMatrix(g,!0),l=b.rowIndex;g=!0;for(var q=k.colLength-1;0<=q;q--)if(!k.isHideForColspan(l,q)){var t=k.getCell(l,q),p=k.getCell(l+1,q);if(!this.getCommonSplitID(t,p,this.DZE_SPLIT)||!this.equalColRange(l,q,l+1,q,k)){g=!1;dalert("");break}}if(g){g=[];for(q=k.colLength-1;0<=q;q--)if(!k.isHideForColspan(l,q)){t=k.getCell(l,q);p=k.getCell(l+1,q);g.push(t);var r=this.getCellOffsetHeightSum(t,p);n||(n=m.createDocumentFragment());(h=p.firstChild)&&"P"===h.nodeName&&
f.hasClass(h,"dze_hide_para")&&(h.parentNode.removeChild(h),h=null);a.moveNodesTo(n,p.firstChild);t.appendChild(n);var u=f.getStyleBorderWidth(p,DZE_DIR.BOTTOM);e.setCellBorderWidth(t,DZE_DIR.BOTTOM,u,k);var x=k.getRowspan(t)+k.getRowspan(p)-1;k.setRowspan(t,x);r=d.offsetHeightToStyleHeight(r,t);d.setNodeValue_Height(t,r,"px")}r=f.getStyleHeight(b)+f.getStyleHeight(c);d.setNodeValue_Height(b,r,"px");c.parentNode.removeChild(c);b=0;for(var w=g.length;b<w;b++)this.mergeAll(g[b])}return!0}catch(z){dalert(z)}}};
var layerEventUtil=function(){var b=this;this.arrTableHTML=this.arrTableCellHTML=this.objCurrentLayer=null;this.bRestoreUnDo=!1;layerEventUtil.prototype.showLayerWin=function(a,c,b,k){try{a.style.left="-2000px";a.style.top="-2000px";a.style.display="";var d=g_objPositionUtil,e=d.domRectToRect(c.getBoundingClientRect()),g=d.getFrameClientRect();d.moveRect(e,g.left,g.top);var h=e.bottom;if(ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT==b){var f=e.left;g_bBrowserType_FF?(f=f-g_nFireFoxLayerSetting_X+1,h=h-g_nFireFoxLayerSetting_Y+
1):g_bBrowserType_WK?(f+=2,h+=2):g_bBrowserType_OP?(f+=1,h+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(f+=2,h+=2);a.style.left=f-2+g_nIframeBorderSetting+"px";a.style.top=h-2+g_nIframeBorderSetting+"px"}else if(ID_DROPDOWN_LAYER_POSITION_TYPE_RIGHT==b)f=e.right,g_bBrowserType_FF?(f=f-g_nFireFoxLayerSetting_X+1,h=h-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(f+=2,h+=2):g_bBrowserType_OP?(f+=1,h+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(f+=2,h+=2),a.style.left=
f-a.offsetWidth-2+g_nIframeBorderSetting+"px",a.style.top=h-2+g_nIframeBorderSetting+"px";else return;duzon_dialog.fade("in",a);dzeWebSearch.hideWebSearchBtn();g_objPasteOptionMenu.remove();this.objCurrentLayer=a;this.bRestoreUnDo=k;this.addLayerEvent()}catch(m){dalert(m)}};layerEventUtil.prototype.addLayerEvent=function(){try{dzeEnvConfig.iFrameLayer&&(window.attachEvent?g_objLayerKit.getLayerDocument().attachEvent("onmousedown",this.checkdownParentLayer):g_objLayerKit.getLayerDocument().addEventListener("mousedown",
this.checkdownParentLayer,!1));window.attachEvent?document.attachEvent("onmousedown",this.checkdownLayer):document.addEventListener("mousedown",this.checkdownLayer,!1);for(var a in g_arrEditorAreaContainer)window.attachEvent?g_objEditorDocument[a].attachEvent("onmousedown",this.checkdownHideLayer):g_objEditorDocument[a].addEventListener("mousedown",this.checkdownHideLayer,!1)}catch(c){dalert(c)}};layerEventUtil.prototype.removeLayerEvent=function(){try{dzeEnvConfig.iFrameLayer&&(window.attachEvent?
g_objLayerKit.getLayerDocument().detachEvent("onmousedown",this.checkdownParentLayer):g_objLayerKit.getLayerDocument().removeEventListener("mousedown",this.checkdownParentLayer,!1));window.detachEvent?document.detachEvent("onmousedown",this.checkdownLayer):document.removeEventListener("mousedown",this.checkdownLayer,!1);for(var a in g_arrEditorAreaContainer)window.detachEvent?g_objEditorDocument[a].detachEvent("onmousedown",this.checkdownHideLayer):g_objEditorDocument[a].removeEventListener("mousedown",
this.checkdownHideLayer,!1)}catch(c){dalert(c)}};layerEventUtil.prototype.checkdownParentLayer=function(a){try{if(null!=b.objCurrentLayer){TBCancelBubbleEvent_iFrameLayer(a);var c=g_objPositionUtil.GetDocumentClientPos_XY_iFrameLayer(a),g=c.nPos_X,k=c.nPos_Y,d=b.objCurrentLayer.offsetWidth,e=b.objCurrentLayer.offsetHeight;b.objCurrentLayer.offsetLeft<g&&b.objCurrentLayer.offsetTop<k&&g<b.objCurrentLayer.offsetLeft+d&&k<b.objCurrentLayer.offsetTop+e||(b.initHideDynamicLayer(),b.restoreUnDoForPreview())}}catch(l){dalert(l)}};
layerEventUtil.prototype.checkdownLayer=function(a){try{if(null!=b.objCurrentLayer){TBCancelBubbleEvent(a);var c=g_objPositionUtil.GetDocumentClientPos_XY(a),g=c.nPos_X,k=c.nPos_Y,d=b.objCurrentLayer.offsetWidth,e=b.objCurrentLayer.offsetHeight;b.objCurrentLayer.offsetLeft<g&&b.objCurrentLayer.offsetTop<k&&g<b.objCurrentLayer.offsetLeft+d&&k<b.objCurrentLayer.offsetTop+e||(b.initHideDynamicLayer(),b.restoreUnDoForPreview())}}catch(l){dalert(l)}};layerEventUtil.prototype.checkdownHideLayer=function(a){try{b.initHideDynamicLayer(),
b.restoreUnDoForPreview(),editor_onmousedown(null,-1),g_objTableFlag.ResetTableInfo(!1)}catch(c){dalert(c)}};layerEventUtil.prototype.initHideDynamicLayer=function(a){try{if(g_bDynamicLayer){var c=a?a.target||a.srcElement:null;g_objMenuWin.TBMenuCloseMenuState();g_objMenuWin.initMenuLayerEvent();g_objComboBoxWin.initComboBoxLayerEvent();g_objContextMenuWin.initContextMenuLayerEvent();g_objLetterSpacingWin.initLetterSpacingLayerEvent();g_objLineHeightWin.initLineHeightLayerEvent();if(!c||"DIV"!==c.nodeName||
!g_objPropertyUtil.hasClass(c,"dze_page_controller")){var b=g_objEditorDocument[g_objPageControl.nEditNumber].body.querySelectorAll("div.dze_page_controller.click");a=0;for(var k=b.length;a<k;a++)g_objPropertyUtil.removeClass(b[a],"click"),g_objPropertyUtil.removeClass(b[a].firstChild,"click")}g_objObjectSelectionInfo.bSelectObject||g_objWrapperOutlineResize.resetExtOutlineInfo();for(var d in g_TBDropDown)for(var e in g_TBDropDown[d])fnObjectCheckNull(g_TBDropDown[d][e].element)||ID_STRING_NAME_CHECKED==
g_TBDropDown[d][e].element.TBSTATE&&TBSetState(g_TBDropDown[d][e].element,ID_STRING_NAME_UNCHECKED,g_TBDropDown[d][e].button_type);for(d in g_TBComboBox)for(e in g_TBComboBox[d])fnObjectCheckNull(g_TBComboBox[d][e].element)||ID_STRING_NAME_CHECKED==g_TBComboBox[d][e].element.TBSTATE&&TBSetState(g_TBComboBox[d][e].element,ID_STRING_NAME_UNCHECKED,g_TBComboBox[d][e].button_type);g_bDynamicLayer=!1;duzon_menubar.closeHiddenTbContainerTool();!0===dzeUiConfig.bUseUiMode&&dze_menu_control.removeHelpBtnLayer();
this.arrTableHTML=this.arrTableCellHTML=null;this.bRestoreUnDo=!1}}catch(l){dalert(l)}};layerEventUtil.prototype.canSaveTableHTML=layerEventUtil.prototype.canSaveTableSelectedCellHTML=function(a){try{return"undefined"!==typeof g_objSelectedShapesArray&&g_objSelectedShapesArray&&0<g_objSelectedShapesArray.length?!1:GetCurTable(a)?!0:!1}catch(c){dalert(c)}};layerEventUtil.prototype.saveTableHTML=function(a){try{this.arrTableHTML=g_objTableFunction.getTableSelectedHTML(a)}catch(c){dalert(c)}};layerEventUtil.prototype.restoreTableHTML=
function(a){try{g_objTableFunction.setTableSelectedHTML(a,this.arrTableHTML)}catch(c){dalert(c)}};layerEventUtil.prototype.saveTableSelectedCellHTML=function(a,b){try{this.arrTableCellHTML=g_objTableFunction.getTableSelectedCellHTML(a,b)}catch(g){dalert(g)}};layerEventUtil.prototype.restoreTableSelectedCellHTML=function(a,b){try{g_objTableFunction.setTableSelectedCellHTML(a,this.arrTableCellHTML,b)}catch(g){dalert(g)}};layerEventUtil.prototype.getSelectedTableArray=function(){try{return this.arrTableCellHTML}catch(a){dalert(a)}};
layerEventUtil.prototype.restoreUnDoForPreview=function(){try{!0===this.bRestoreUnDo&&!0===dzeUiConfig.bTBPreviewLetterOperation&&g_objUndoRedo.operateUndoRedoStack(!0,!0,g_nActiveEditNumber)}catch(a){dalert(a)}}},g_objLayerEventUtil=new layerEventUtil;
var transparentViewUtil=function(){this.arrTransparentView=[];transparentViewUtil.prototype.initTransparentView=function(b){try{var a=this.getTransparentView(b);if(a)return a;b=b||document;a=b.createElement("div");a.innerHTML='<div id="transparentView" style="display:none;position:absolute;z-index:20009;border:0px;background-color:#ffffff;filter:alpha(opacity=40);opacity:0.4;"></div>';a=a.firstChild;b.body.appendChild(a);return this.arrTransparentView[this.arrTransparentView.length]=a}catch(d){dalert(d)}};
transparentViewUtil.prototype.unload=function(){try{for(var b=this.arrTransparentView,a=null,d=0,c=b.length;d<c;d++)(a=b[d])&&a.parentNode&&a.parentNode.removeChild(a);this.arrTransparentView=[]}catch(e){dalert(e)}};transparentViewUtil.prototype.getTransparentView=function(b){try{b=b||document;for(var a=this.arrTransparentView,d=null,c=0,e=a.length;c<e;c++)if(d=a[c],d.ownerDocument===b)return d;return null}catch(f){dalert(f)}};transparentViewUtil.prototype.showTransparentView=function(b,a,d){try{var c=
this.initTransparentView(d);if(c)if(b){g_objPropertyUtil.applyFilterOpacityStyle(c,b,a);var e=g_objPositionUtil.getDocumentClientSize(c.ownerDocument.defaultView),f=e.nClientWidth,h=e.nClientHeight,g=g_objPositionUtil.getDocumentScrollPosition(!1),k=g.nScrollLeft,l=g.nScrollTop;c.style.left="0px";c.style.top="0px";c.style.width=k+f+"px";c.style.height=l+h+"px";c.style.display=""}else c.style.display="none"}catch(m){dalert(m)}}},g_objTransparentViewUtil=new transparentViewUtil;
var g_objTableUtil=new function(){this.ID_TABLE_ALIGN_NONE=0;this.ID_TABLE_ALIGN_LEFT=1;this.ID_TABLE_ALIGN_CENTER=2;this.ID_TABLE_ALIGN_RIGHT=3;this.RESET_WIDTH=1;this.RESET_HEIGHT=16;this.RESET_ALL=this.RESET_WIDTH|this.RESET_HEIGHT;this.getTableRowElement=function(a,b){try{var c=function(a,b){try{return a.rows(b)}catch(g){dalert(g)}return null},d=function(a,b){try{return a.rows[b]}catch(g){dalert(g)}return null};this.getTableRowElement=g_bBrowserType_IE?c:d;return this.getTableRowElement(a,b)}catch(e){dalert(e)}return null};
this.getTableCellElement=function(a,b,c){try{var d=function(a,b,c){try{return a.rows(b).cells(c)}catch(m){dalert(m)}return null},e=function(a,b,c){try{return a.rows[b].cells[c]}catch(m){dalert(m)}return null};this.getTableCellElement=g_bBrowserType_IE?d:e;return this.getTableCellElement(a,b,c)}catch(f){dalert(f)}return null};this.getTableCellsLength=function(a,b){try{var c=function(a,b){try{return a.rows(b).cells.length}catch(g){dalert(g)}return null},d=function(a,b){try{return a.rows[b].cells.length}catch(g){dalert(g)}return null};
this.getTableCellsLength=g_bBrowserType_IE?c:d;return this.getTableCellsLength(a,b)}catch(e){dalert(e)}return null};this.getClosetTable=function(a,b){try{for(;a&&a!==b.parentNode&&"BODY"!==a.nodeName;){if("TABLE"===a.nodeName)return a;a=a.parentNode}return null}catch(c){dalert(c)}};this.getFarthestTable=function(a,b){try{for(var c=null;a&&a!==b.parentNode&&"BODY"!==a.nodeName;)"TABLE"===a.nodeName&&(c=a),a=a.parentNode;return c}catch(d){dalert(d)}};this.getClosetCell=function(a,b){try{for(;a&&a!==
b.parentNode&&"BODY"!==a.nodeName;){if("TD"===a.nodeName||"TH"===a.nodeName)return a;a=a.parentNode}return null}catch(c){dalert(c)}};this.getFirstCell=function(a){try{if(!a)return null;var b=a.rows;if(!b||0>=b.length)return null;var c=b[0].cells;return!c||0>=c.length?null:c[0]}catch(d){dalert(d)}};this.getLastCell=function(a){try{if(!a)return null;var b=new TableMatrix(a,!0);return b?b.getCell(b.rowLength-1,b.colLength-1):null}catch(c){dalert(c)}};this.isCellInFirstRow=function(a){try{if(!a)return!1;
var b=g_objNodeUtil,c=b.getLoopParentElement(a,"tr"),d=b.getLoopParentElement(c,"table");if(!d)return!1;var e=d.rows;return e&&0<e.length&&e[0]===c?!0:!1}catch(f){dalert(f)}};this.isCellInLastRow=function(a){try{if(!a)return!1;var b=g_objNodeUtil,c=b.getLoopParentElement(a,"tr"),d=b.getLoopParentElement(c,"table");if(!d)return!1;var e=d.rows;if(!e)return!1;var f=e.length;return 0>=f?!1:f===c.rowIndex+this.getRowspan(a)?!0:!1}catch(g){dalert(g)}};this.cloneCell=function(a,b,c){try{if(!a||"TD"!==a.nodeName&&
"TH"!==a.nodeName)return null;"undefined"===typeof c&&(c=!1);var d=a.cloneNode(b);!1===b&&a.firstChild&&this.setCellInnerText("",d,a);c||g_objTableSelection.deselectCell(d);if(d.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD)&&!d.hasAttribute("dze_split")){if(this.isBlankCell(d)){var e=d.getAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD);e&&(this.setCellInnerText(e,d,null),d.removeAttribute(DZE_CUSTOM_ATT_HASTEXT))}d.removeAttribute(DZE_CUSTOM_ATT_FOCUS)}if(d.hasAttribute("style")&&!1===b){var f=parseStyle(d.getAttribute("style")),
g=g_objNodeUtil.checkTagName(d.firstChild,"p");if(f&&g)for(var h in f)if("fontFamily"==h||"fontSize"==h||"color"==h||"fontWeight"==h||"lineHeight"==h||"letterSpacing"==h)g.style[h]||(g.style[h]=f[h])}return d}catch(m){dalert(m)}};this.isProtect=function(a){try{return(a=a||GetCurTable())&&a.hasAttribute&&a.hasAttribute(DZE_CUSTOM_ATT_PROTECT)&&"true"===a.getAttribute(DZE_CUSTOM_ATT_PROTECT)?!0:!1}catch(b){dalert(b)}};this.createEmptyCell=function(a,b,c){try{var d=g_objEditorDocument[c].createElement("td");
d.innerHTML="<p><br /></p>";this.setRowspan(d,a);this.setColspan(d,b);return d}catch(e){dalert(e)}};this.isBlankCell=function(a){try{if(!a)return!0;var b=a.firstChild;if(!b)return!0;var c=g_objPlaceholder;if(c.isBlankPlaceholder(a))return!0;if(!b.nextSibling&&"P"===b.nodeName){var d=b.firstChild;if(!d||!d.nextSibling&&c.isBlankPlaceholderSpan(d))return!0;var e=d.nextSibling;if(e&&!e.nextSibling&&c.isBlankPlaceholderSpan(d)&&"BR"===e.nodeName||g_objNodeUtil.isBlankPara(b))return!0}return!1}catch(f){dalert(f)}};
this.getTableMaxColSpanCount=function(a){try{for(var b=0,c=a.rows.length,d=0;d<c;d++){for(var e=0,f=this.getTableCellsLength(a,d),g=0;g<f;g++){var h=this.getTableCellElement(a,d,g);e+=h.colSpan}b<e&&(b=e)}return b}catch(m){dalert(m)}return 0};this.getTableRowColSpanCount=function(a,b){try{for(var c=0,d=this.getTableCellsLength(a,b),e=0;e<d;e++){var f=this.getTableCellElement(a,b,e);c+=f.colSpan}return c}catch(g){dalert(g)}return 0};this.getTableColGroupWidthValue=function(a){try{var b=[],c=a.getElementsByTagName("col");
for(a=0;a<c.length;a++){var d=c[a].getAttribute("width"),e=g_objCommonUtil.extractNumberValueUnit(d);if(null==e)return null;b[a]=e}return b}catch(f){dalert(f)}return null};this.getTableMargin=function(a){try{var b=parseInt(a.style.marginLeft),c=parseInt(a.style.marginTop),d=parseInt(a.style.marginRight),e=parseInt(a.style.marginBottom);if(isNaN(b)||ID_STRING_NAME_UNDEFINED===b)b=0;if(isNaN(c)||ID_STRING_NAME_UNDEFINED===c)c=0;if(isNaN(d)||ID_STRING_NAME_UNDEFINED===d)d=0;if(isNaN(e)||ID_STRING_NAME_UNDEFINED===
e)e=0;return{left:b,top:c,right:d,bottom:e}}catch(f){dalert(f)}return null};this.getTableCellPadding=function(a){try{var b=a.cellPadding;if(null===b||""===b||ID_STRING_NAME_UNDEFINED===b)return"";var c=g_objCommonUtil.getNumberValue(b);return null==c?"":c}catch(d){dalert(d)}return null};this.setTableCellPadding=function(a,b){try{null===b||""===b?a.removeAttribute("cellpadding"):a.cellPadding=b}catch(c){dalert(c)}};this.getTableCellSpacing=function(a){try{var b=a.cellSpacing;if(null===b||""===b||ID_STRING_NAME_UNDEFINED===
b)return 0;var c=g_objCommonUtil.getNumberValue(b);return null==c?0:c}catch(d){dalert(d)}return null};this.setTableCellSpacing=function(a,b){try{null===b||""===b?a.removeAttribute("cellspacing"):a.cellSpacing=b}catch(c){dalert(c)}};this.getTableBorderCollapse=function(a){try{if(null==a.getAttribute("style"))return!1;var b=a.style.borderCollapse;return null===b||""===b||ID_STRING_NAME_UNDEFINED===b||"collapse"!==b?!1:!0}catch(c){dalert(c)}return null};this.setTableBorderCollapse=function(a,b){try{null===
b||""===b||!0!==b?a.getAttribute("style")&&a.style.borderCollapse&&(a.style.borderCollapse="separate"):a.style.borderCollapse="collapse"}catch(c){dalert(c)}};this.setNodeValue_Width=function(a,b,c){try{if(a){b=Math.max(parseFloat(b.toFixed(2)),0);a.getAttribute("width")&&a.removeAttribute("width");var d=a.style;d&&("important"===d.getPropertyPriority("width")&&d.removeProperty("width"),a.style.width=b+c)}}catch(e){dalert(e)}};this.setNodeValue_Height=function(a,b,c){try{if(a){b=Math.max(parseFloat(b.toFixed(2)),
0);a.getAttribute("height")&&a.removeAttribute("height");var d=a.style;d&&("important"===d.getPropertyPriority("height")&&d.removeProperty("height"),a.style.height=b+c)}}catch(e){dalert(e)}};this.getColspan=function(a){try{if(!a)return 1;var b=a.getAttribute("colspan")|0;return parseInt(b?b:1)}catch(c){dalert(c)}};this.getRowspan=function(a){try{if(!a)return 1;var b=a.getAttribute("rowspan")|0;return parseInt(b?b:1)}catch(c){dalert(c)}};this.setColspan=function(a,b){try{a&&(1>=b?a.removeAttribute("colspan"):
a.setAttribute("colspan",b))}catch(c){dalert(c)}};this.setRowspan=function(a,b){try{a&&(1>=b?a.removeAttribute("rowspan"):a.setAttribute("rowspan",b))}catch(c){dalert(c)}};this.getAlignTableByStyleProperty=function(a){try{if("0px"!=a.style.marginLeft&&"0"!=a.style.marginLeft||"auto"!=a.style.marginRight){if("auto"==a.style.marginLeft&&"auto"==a.style.marginRight)return this.ID_TABLE_ALIGN_CENTER;if("auto"==a.style.marginLeft&&("0px"==a.style.marginRight||"0"==a.style.marginRight))return this.ID_TABLE_ALIGN_RIGHT}else return this.ID_TABLE_ALIGN_LEFT;
var b=a.getAttribute("align");if(null==b||""==b)return this.ID_TABLE_ALIGN_NONE;b=b.toLowerCase();return"left"==b?this.ID_TABLE_ALIGN_LEFT:"center"==b?this.ID_TABLE_ALIGN_CENTER:"right"==b?this.ID_TABLE_ALIGN_RIGHT:this.ID_TABLE_ALIGN_NONE}catch(c){dalert(c)}return this.ID_TABLE_ALIGN_NONE};this.setAlignTableByStyleProperty=function(a,b,c,d,e,f,g){try{a.removeAttribute("align"),c?(a.style.marginLeft="undefined"!==typeof d?d:"",a.style.marginRight="undefined"!==typeof f?f:""):(c="undefined"!==typeof d?
d:"0",f="undefined"!==typeof f?f:"0","left"==b?(a.style.marginLeft=c,a.style.marginRight="auto"):"center"==b?(a.style.marginLeft="auto",a.style.marginRight="auto"):"right"==b&&(a.style.marginLeft="auto",a.style.marginRight=f)),"undefined"!==typeof e&&(a.style.marginTop=e),"undefined"!==typeof g&&(a.style.marginBottom=g)}catch(h){dalert(h)}};this.setTable_Outdent_Indent=function(a,b){try{a.removeAttribute("align");var c=a.style.marginLeft,d=a.style.marginRight;c=c.toLowerCase();d=d.toLowerCase();"auto"==
c&&(c=a.style.marginLeft="");"auto"==d&&(a.style.marginRight="");var e=dzeUiConfig.nCustomOutdentIndentWidth;b&&(e*=-1);""==c?a.style.marginLeft=e+"px":isNaN(c)?-1==c.indexOf("px")?a.style.marginRight="":a.style.marginLeft=parseInt(c)+e+"px":a.style.marginLeft=parseInt(c)+e+"px"}catch(f){dalert(f)}};this.setAlignTable=function(a,b,c){try{var d="";if(!b)if(a==ID_COMMAND_JUSTIFY_LEFT)d="left";else if(a==ID_COMMAND_JUSTIFY_CENTER)d="center";else if(a==ID_COMMAND_JUSTIFY_RIGHT)d="right";else if(a==ID_COMMAND_JUSTIFY_JUSTIFY)b=
!0;else return;if(window.attachEvent)for(var e=g_objEditorDocument[c].selection,f=e.createRange(),g=f.parentElement(),h=g.getElementsByTagName("table"),m=0;m<h.length;m++){var l=h[m],k=e.createRange();k.moveToElementText(l);k.collapse(!0);var n=e.createRange();n.moveToElementText(l);n.collapse(!1);var r=f.inRange(k),t=f.inRange(n);r||t&&g_objTableUtil.setAlignTableByStyleProperty(l,d,b);r&&t&&g_objTableUtil.setAlignTableByStyleProperty(l,d,b);r&&(t||g_objTableUtil.setAlignTableByStyleProperty(l,d,
b))}else{var u=GetCurTable(c);if(g_objTableSelection.isTableSelected(u))g_objTableSelection.doAllTable(function(a){this.setAlignTableByStyleProperty(a,d,b)}.bind(this),u);else if(e=g_objEditWindow[c].getSelection(),1==e.rangeCount){f=e.getRangeAt(0);g=f.commonAncestorContainer;var p=g_objEditorDocument[c].createRange();if(g.nodeType!=ID_SELECTION_TEXT_NODE)for(h=g.getElementsByTagName("table"),m=0;m<h.length;m++){l=h[m];p.selectNode(l);var q=f.compareBoundaryPoints(Range.END_TO_START,p),v=f.compareBoundaryPoints(Range.START_TO_START,
p),w=f.compareBoundaryPoints(Range.END_TO_END,p),y=f.compareBoundaryPoints(Range.START_TO_END,p);-1!=q||1!=v&&0!=v||g_objTableUtil.setAlignTableByStyleProperty(l,d,b);0!=v&&-1!=v||1!=w&&0!=w||g_objTableUtil.setAlignTableByStyleProperty(l,d,b);1!=y||0!=w&&-1!=w||g_objTableUtil.setAlignTableByStyleProperty(l,d,b)}}}}catch(x){dalert(x)}finally{f=null}};this.setMultiToOneColgroup=function(a){try{if(!a)return!1;var b=g_objNodeUtil,c=b.getImmediateChildNodesByTagName(a,"colgroup");if(1>=c.length)return!1;
var d=c[0];for(a=1;a<c.length;a++)b.moveNodesTo(d,c[a].firstChild),c[a].parentNode.removeChild(c[a]);return!0}catch(e){dalert(e)}};this.addColgroup=function(a,b){try{if(!a)return!1;var c=g_objNodeUtil,d=g_objTableUtil,e=a.ownerDocument,f=b||g_objTableUtil.getMatrix(a),g=f.tables,h=!1,m=c.getImmediateChildNodesByTagName(a,"colgroup")[0];h|=this.setMultiToOneColgroup(a);var l=c.getImmediateChildNodesByTagName(m,"col");a=!1;for(var k=0;k<l.length;k++)if(!l[k].style.width){a=!0;break}if(!m||l.length!=
f.colLength||a){var n=f.calculateColWidth();if(!n)return!1;h|=1;var r=f.arraySum(n),t=e.createDocumentFragment();for(k=0;k<f.colLength;k++){var u=e.createElement("col");u.style.width=n[k]+"px";t.appendChild(u)}for(k=0;k<g.length;k++){var p=c.getImmediateChildNodesByTagName(g[k],"colgroup")[0];h|=this.setMultiToOneColgroup(g[k]);p||(p=e.createElement("colgroup"),g[k].firstChild?g[k].insertBefore(p,g[k].firstChild):g[k].insertBefore(p));c.removeAllChild(p);p.appendChild(t.cloneNode(!0))}d.setTableWidth(f.tables,
r)}h&&b&&b.initColgroup();return h}catch(q){dalert(q)}};this.removeColgroup=function(a){try{if(a){var b=g_objNodeUtil,c=g_objTableUtil.getSplitTables(a);a=null;for(var d=0;d<c.length;d++)(a=b.getImmediateChildNodesByTagName(c[d],"colgroup")[0])&&c[d].removeChild(a)}}catch(e){dalert(e)}};this.getSplitTables=function(a){try{var b=[a];dzeUiConfig.bOfficePagingMode&&null!==g_objPageControl.getPageNum(a)&&(b=g_objSplitUtil.getSplitNodes(a));return b}catch(c){dalert(c)}};this.getRows=function(a){try{if(!a)return null;
if(!dzeUiConfig.bOfficePagingMode)return a.rows;var b=this.getSplitTables(a);a=[];for(var c=0;c<b.length;c++){var d=[].slice.call(b[c].rows);a=a.concat(d)}return a}catch(e){dalert(e)}};this.getMatrix=function(a){try{return a?new TableMatrix(a):null}catch(b){dalert(b)}};this.isBizboxReportTable=function(a){try{switch(g_objNodeUtil.getAttribute(a,"tools")){case DZE_CUSTOM_VALUE_BIZBOX_REPORT_1:case DZE_CUSTOM_VALUE_BIZBOX_REPORT_5:case DZE_CUSTOM_VALUE_BIZBOX_REPORT_6:return!0}return!1}catch(b){dalert(b)}};
this.isBizboxReportHomeTable=function(a){if(this.isBizboxReportTable(a))switch(g_objNodeUtil.getAttribute(a,"dze_desc")){case DZE_CUSTOM_VALUE_SCHEDULE_HOME:case DZE_CUSTOM_VALUE_TASK_HOME:case DZE_CUSTOM_VALUE_PREV_TASK_HOME:case DZE_CUSTOM_VALUE_REMARK_HOME:case DZE_CUSTOM_VALUE_OPINION:case DZE_CUSTOM_VALUE_CHECKLIST:return!0}return!1};this.isBizboxReport2Table=function(a){if(this.isBizboxReportTable(a))switch(g_objNodeUtil.getAttribute(a,"dze_desc")){case DZE_CUSTOM_VALUE_USER_INFO:case DZE_CUSTOM_VALUE_TASK_SCHEDULE:case DZE_CUSTOM_VALUE_TASK_NOT_FINISH:case DZE_CUSTOM_VALUE_TASK_WILL_DO:return!0}return!1};
this.getBizboxReportTableQuery=function(a){a=a?"[dze_desc='"+a+"']":"";return"table[tools='"+DZE_CUSTOM_VALUE_BIZBOX_REPORT_5+"']"+a+", table[tools='"+DZE_CUSTOM_VALUE_BIZBOX_REPORT_6+"']"+a};this.removeBizboxReportTableAttr=function(a){try{if(a){var b=g_objNodeUtil;b.removeAttribute(a,"tools");b.removeAttribute(a,"dze_desc");b.removeAttribute(a,"dze_protect");var c=a.querySelectorAll("tr[dze_rowgroup]");forEach(c,function(a,c){b.removeAttribute(c,"dze_rowgroup")});var d=a.querySelectorAll("td[dze_placeholder_td], th[dze_placeholder_td]");
forEach(d,function(a,c){b.removeAttribute(c,"dze_placeholder_td");b.removeAttribute(c,"dze_hastext");b.removeAttribute(c,"dze_focus")})}}catch(e){dalert(e)}};this.setDzeTable=function(a,b){try{if(!a)return!1;var c=g_objPropertyUtil;if(c.hasClass(a,"dze_table"))return!1;b=b||this.getMatrix(a);var d=a.style,e=null;if("fixed"!==d.tableLayout||"break-word"!==d.wordWrap||"normal"!==d.wordBreak)e=this.getTableCellPixelSize(a,b);var f=b.tables;d=0;for(var g=f.length;d<g;d++)c.addClass(f[d],"dze_table"),
f[d].style.tableLayout="",f[d].style.wordWrap="",f[d].style.wordBreak="";this.setTableCellPixelSize(a,b,e);return!0}catch(h){dalert(h)}};this.removeAllDzeTable=function(a){try{if(a){var b=g_objPropertyUtil,c=a.querySelectorAll("table.dze_table");forEach(c,function(a,c){b.removeClass(c,"dze_table");c.style.tableLayout="fixed";c.style.wordWrap="break-word";c.style.wordBreak="normal"},this)}}catch(d){dalert(d)}};this.resetTableCellPixelSize=function(a,b,c){try{c=c||this.RESET_ALL;var d=this.getTableCellPixelSize(a,
b,c);return this.setTableCellPixelSize(a,b,d,c)}catch(e){dalert(e)}};this.getTableCellPixelSize=function(a,b,c){try{if(!a)return null;c=c||this.RESET_ALL;b=b||this.getMatrix(a);a=[];var d=[],e=0;if(c&this.RESET_WIDTH){a=b.calculateColWidth();for(var f=0,g=a.length;f<g;f++)e+=a[f]}c&this.RESET_HEIGHT&&(d=b.calculateRowHeight());return{tableWidth:e,arrColWidth:a,arrRowHeight:d}}catch(h){dalert(h)}};this.setTableCellPixelSize=function(a,b,c,d){try{if(!a||!c)return!1;var e=c.tableWidth,f=c.arrColWidth,
g=c.arrRowHeight;if(!f||!g)return!1;d=d||this.RESET_ALL;b=b||this.getMatrix(a);c=g_objNodeUtil;for(var h=g_objTableUtil,m=b.tables,l=0;l<b.rowLength;l++)for(var k=0;k<b.colLength;k++)if(b.isShow(l,k)){var n=b.getCell(l,k),r=b.getRowRange(l,k),t=b.getColRange(l,k);d&this.RESET_WIDTH&&this.setNodeValue_Width(n,h.offsetWidthToStyleWidth(b.arraySum(f,t.start,t.end),n),"px");d&this.RESET_HEIGHT&&this.setNodeValue_Height(n,h.offsetHeightToStyleHeight(b.arraySum(g,r.start,r.end),n),"px")}if(d&this.RESET_WIDTH){this.addColgroup(a,
b);for(a=0;a<m.length;a++)for(var u=c.getImmediateChildNodesByTagName(m[a],"colgroup")[0],p=c.getImmediateChildNodesByTagName(u,"col"),q=0;q<p.length;q++)this.setNodeValue_Width(p[q],f[q],"px");e&&this.setTableWidth(b.tables,e)}if(d&this.RESET_HEIGHT)for(q=0;q<b.trs.length;q++)this.setNodeValue_Height(b.trs[q],g[q],"px");return!0}catch(v){dalert(v)}};this.getCellWidthAppendant=function(a){try{if(!a)return 0;var b=g_objNodeUtil.getLoopParentElement(a,"table");if(!b)return 0;var c=g_objPropertyUtil,
d=parseFloat(c.getElement_BorderWidth_With_Unit(a,"left").nValue)+parseFloat(c.getElement_BorderWidth_With_Unit(a,"right").nValue);"collapse"===b.style.borderCollapse&&(d/=2);var e=c.getPadding(a,c.LEFT)+c.getPadding(a,c.RIGHT),f=b.cellPadding?2*parseFloat(b.cellPadding):0;return d+e+f}catch(g){dalert(g)}};this.getCellHeightAppendant=function(a){try{if(!a)return 0;var b=g_objNodeUtil.getLoopParentElement(a,"table");if(!b)return 0;var c=g_objPropertyUtil,d=parseFloat(c.getElement_BorderWidth_With_Unit(a,
"top").nValue)+parseFloat(c.getElement_BorderWidth_With_Unit(a,"bottom").nValue);"collapse"===b.style.borderCollapse&&(d/=2);var e=c.getPadding(a,c.TOP)+c.getPadding(a,c.BOTTOM),f=b.cellPadding?2*parseFloat(b.cellPadding):0;return d+e+f}catch(g){dalert(g)}};this.offsetWidthToStyleWidth=function(a,b){try{if(!a||!b)return 0;var c=a-this.getCellWidthAppendant(b);return Math.max(c,0)}catch(d){dalert(d)}};this.offsetHeightToStyleHeight=function(a,b){try{if(!a||!b)return 0;var c=a-this.getCellHeightAppendant(b);
return Math.max(c,0)}catch(d){dalert(d)}};this.styleWidthToOffsetWidth=function(a,b){try{if(!a||!b)return 0;var c=a+this.getCellWidthAppendant(b);return Math.max(c,0)}catch(d){dalert(d)}};this.styleHeightToOffsetHeight=function(a,b){try{if(!a||!b)return 0;var c=a+this.getCellHeightAppendant(b);return Math.max(c,0)}catch(d){dalert(d)}};this.setTableWidth=function(a,b){try{if(!a)return!1;var c=a;Array.isArray(a)||(c=[a]);for(var d=g_objPropertyUtil,e=0,f=c.length;e<f;e++){a=c[e];var g=a.rows,h=g&&0<
g.length?g[0]:null,m=h?h.cells:null,l=m?m.length:0,k=this.isPercentTable(a),n=0;0<l&&(n=parseFloat(d.getElement_BorderWidth_With_Unit(m[0],"left").nValue)/2+parseFloat(d.getElement_BorderWidth_With_Unit(m[l-1],"right").nValue)/2,n=Math.floor(n));this.setNodeValue_Width(a,b+n,"px");k&&this.setPercentTable(a)}}catch(r){dalert(r)}};this.getParentListArray=function(a,b){try{if(!a)return null;for(var c=g_objNodeUtil,d=null;a&&a!==b&&!c.isBoundNode(a);)null===d&&c.isListItem(a)?(d=[],d.push(a)):d&&(c.isList(a)||
c.isListItem(a))&&d.push(a),a=a.parentNode;return d&&1<d.length&&!c.isList(d[d.length-1])?null:d}catch(e){dalert(e)}};this.setCellInnerText=function(a,b,c){try{if(!b)return null;a=a||"<br>";refCell=c?c:b;var d=b.ownerDocument,e=b.querySelectorAll("span.dze_shape_main"),f=0<e.length?d.createDocumentFragment():null;forEach(e,function(a,b){b&&"absolute"===b.style.position&&f.appendChild(b)},this);var g=g_objNodeUtil.getFirstTextNode(refCell),h=TextAtt.getAtt(g),m=ParaAtt.getAtt(g);e=d=null;var l=b!==
refCell||null===c?this.getParentListArray(g,refCell):null;if(l&&1<l.length){g=c=null;for(var k=0,n=l.length;k<n;k++)g=l[k].cloneNode(!1),g.removeAttribute("start"),c?(g.appendChild(c),c=g):c=d=g;c&&d&&(d.innerHTML=a,b.innerHTML="",b.appendChild(c))}d||(b.innerHTML="<p>"+a+"</p>",d=b.firstChild,e=d.firstChild);TextAtt.setAtt(e,h);ParaAtt.setAtt(d,m);f&&f.firstChild&&(g_objPropertyUtil.addClass(d,"dze_shape_anchor"),d.firstChild?d.insertBefore(f,d.firstChild):d.appendChild(f));return b}catch(r){dalert(r)}};
this.isSameTable=function(a,b){try{return a&&b?this.getSplitTables(a).some(function(a){return b==a})?!0:!1:!1}catch(c){dalert(c)}};this.isCellInSameTable=function(a,b){try{if(!a||!b)return!1;var c=g_objNodeUtil,d=c.getLoopParentElement(a.parentNode,"table"),e=c.getLoopParentElement(b.parentNode,"table");return this.isSameTable(d,e)?!0:!1}catch(f){dalert(f)}};this.isPercentTable=function(a){return a?(a=g_objNodeUtil.getNodeWidthHeight(a,!0))&&"%"===a.strUnit?!0:!1:!1};this.setPercentTable=function(a){try{if(!a)return!1;
var b=a;Array.isArray(a)||(b=[a]);if(this.isPercentTable(b[0]))return!0;for(var c=g_objCommonUtil,d=null,e=0,f=b.length;e<f;e++)(a=b[e])&&a.parentNode&&(d=Math.floor(100*c.convPxToPercent(a,a.offsetWidth)),this.setNodeValue_Width(a,d,"%"));return!0}catch(g){dalert(g)}};this.isPxTable=function(a){return a?(a=g_objNodeUtil.getNodeWidthHeight(a,!0))&&"px"===a.strUnit||""===a.strUnit?!0:!1:!1};this.setPxTable=function(a){try{if(!a)return!1;var b=a;Array.isArray(a)||(b=[a]);if(this.isPxTable(b[0])||!this.isPercentTable(b[0]))return!0;
for(var c=g_objCommonUtil,d=null,e=null,f=0,g=b.length;f<g;f++)a=b[f],e=g_objNodeUtil.getNodeWidthHeight(a,!0).nValue/100,d=Math.floor(c.convPercentToPx(a,e)),this.setNodeValue_Width(a,d,"px");return!0}catch(h){dalert(h)}};this.removeHeightAttr=function(a){try{if(!a)return!1;var b=a;"undefined"===typeof b.length&&(b=[a]);var c=g_objNodeUtil,d=g_objPropertyUtil;forEach(b,function(a,b){c.removeAttribute(b,"height");d.removeStyleAttribute(b,"height");d.removeStyleAttribute(b,"min-height");d.removeStyleAttribute(b,
"max-height")},this);return!0}catch(e){dalert(e)}};this.getTableAlign=function(a){try{if(!a)return"";var b=a.style,c=b.marginLeft,d=b.marginRight;return 0===parseInt(c,10)&&"auto"===d?"left":"auto"===c&&0===parseInt(d,10)?"right":"auto"===c&&"auto"===d?"center":""===c&&""===d?"justify":""}catch(e){dalert(e)}};this.getTableStylePreset=function(a){try{if(!a)return-1;var b=a.className;if(!b)return-1;var c=b.split(" ");a=0;for(var d=c.length;a<d;a++)if(0<=c[a].indexOf("dze_table_style_"))return parseInt(c[a].replace("dze_table_style_",
""),10);return-1}catch(e){dalert(e)}}};
function TableMatrix(a,b,d){this.matrix=null;this.table=a?a:null;this.colgroups=this.trs=this.tables=null;this.colLength=this.rowLength=0;this.arrBlankRow=this.arrBlankCol=this.arrRowHeight=this.arrColWidth=null;this.bDirty=!1;this.bOneTable=b?!0:!1;this.bDoNotFindSplitTable=!1;a&&this.makeMatrix();!this.bClone&&this.table&&!0!==d&&g_objTableUtil.addColgroup(this.table,this);return this}
TableMatrix.prototype={SHOW:1,HIDE_ROWSPAN:16,HIDE_COLSPAN:256,DZE_TEMP:"dze_temp",isShow:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.SHOW)?!0:!1},isHide:function(a,b){return!this.isShow(a,b)},isHideForRowspan:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.HIDE_ROWSPAN)?!0:!1},isHideForColspan:function(a,b){return this.matrix[a]&&this.matrix[a][b]&&0!=(this.matrix[a][b]&this.HIDE_COLSPAN)?!0:!1},getHeightSumObj:function(a){var b=
a;return{getHeight:function(a){a=Math.min(b,a);b-=a;return a=Math.max(a,0)}}},getColspan:function(a){a=a.getAttribute("colspan")|0;return parseInt(a?a:1)},getRowspan:function(a){a=a.getAttribute("rowspan")|0;return parseInt(a?a:1)},setColspan:function(a,b){1>=b?a.removeAttribute("colspan"):a.setAttribute("colspan",b)},setRowspan:function(a,b){1>=b?a.removeAttribute("rowspan"):a.setAttribute("rowspan",b)},arraySum:function(a,b,d){d="undefined"==typeof d?a.length-1:d;var c=0;for(b="undefined"==typeof b?
0:b;b<=d;b++)c+=a[b];return c},arrayCloset:function(a,b){for(var d=Number.MAX_VALUE,c=0,e=0;e<a.length;e++){var f=Math.abs(b-a[e]);f<d&&(c=e,d=f)}return a[c]},arrayUnion:function(a,b){a=a.concat();for(var d=0;d<b.length;d++)0>a.indexOf(b[d])&&a.push(b[d]);return a},arrayWidthToPos:function(a,b){b[0]=0;for(var d=1;d<=a.length;d++)b[d]=b[d-1]+a[d-1];return b},arrayPosToWidth:function(a,b){for(var d=0;d<a.length-1;d++)b[d]=a[d+1]-a[d];return b},arrayFillNullWithMedian:function(a){try{if(a){for(var b=
1,d=a.length;b<d;b++)if(null===a[b]){for(var c=b-1;0<=c&&null===a[c];c--);for(var e=b+1;e<d&&null===a[e];e++);0>c&&(c=0);e>=d&&(e=d-1);var f=a[c],h=a[e];e-=c;h<f&&(h=f);var g=this.getIntegerDivision(h-f,e);for(e=0;e<g.length-1;e++)a[e+c+1]=a[e+c]+g[e]}return a}}catch(k){dalert(k)}},getGCD:function(a,b){return b?this.getGCD(b,a%b):a},getIntegerDivision:function(a,b){var d=Math.floor(a/b);a%=b;for(var c=[],e=0;e<b;e++)c[e]=d;for(e=b-1;0<e&&0<a;e--)c[e]+=1,a--;return c},getCellIndex:function(a,b){try{if(0>
a||a>=this.rowLength||0>b||b>=this.colLength)return null;var d=0,c=0;for(d=a;this.isHideForRowspan(d,b);d--);for(a=0;c<=b;c++)this.isHide(d,c)&&a++;return{row:d,col:c-a-1}}catch(e){dalert(e)}},getCell:function(a,b){try{var d=this.getCellIndex(a,b);return d?this.trs[d.row].cells[d.col]:null}catch(c){dalert(c)}},getNextCell:function(a,b){try{for(b+=1;a<this.rowLength;a++){for(;b<this.colLength;b++)if(this.isShow(a,b))return this.getCell(a,b);b=0}return null}catch(d){dalert(d)}},getPrevCell:function(a,
b){try{for(--b;0<=a;a--){for(;0<=b;b--)if(this.isShow(a,b))return this.getCell(a,b);b=this.colLength}return null}catch(d){dalert(d)}},getNextCellFromCell:function(a){try{var b=this.getMatrixIndex(a);return b&&b[0]?this.getNextCell(b[0].row,b[0].col):null}catch(d){dalert(d)}},getPrevCellFromCell:function(a){try{var b=this.getMatrixIndex(a);return b&&b[0]?this.getPrevCell(b[0].row,b[0].col):null}catch(d){dalert(d)}},getMatrixIndex:function(a){try{if(!a)return null;var b=this.trs.indexOf(a.parentNode);
if(0>b)return null;var d=a.cellIndex,c=0;for(a=0;a<=d&&c<this.colLength;a++,c++)this.isHide(b,c)&&a--;--c;var e=this.getColRange(b,c),f=this.getRowRange(b,c);b=[];for(var h=f.start;h<=f.end;h++)for(a=e.start;a<=e.end;a++)b.push({row:h,col:a});return b}catch(g){dalert(g)}},getRowRange:function(a,b){try{for(var d=0,c=0;this.isHideForColspan(a,b);b--);for(;this.isHideForRowspan(a,b);a--);d=a;for(a+=1;this.isHideForRowspan(a,b);a++);c=a-1;return{start:d,end:c,length:c-d+1}}catch(e){dalert(e)}},getColRange:function(a,
b){try{for(var d=0,c=0;this.isHideForColspan(a,b);b--);for(;this.isHideForRowspan(a,b);a--);d=b;for(b+=1;this.isHideForColspan(a,b);b++);c=b-1;return{start:d,end:c,length:c-d+1}}catch(e){dalert(e)}},getRowRangeFromCell:function(a){try{var b=this.getMatrixIndex(a);return b?this.getRowRange(b[0].row,b[0].col):null}catch(d){dalert(d)}},getColRangeFromCell:function(a){try{var b=this.getMatrixIndex(a);return b?this.getColRange(b[0].row,b[0].col):null}catch(d){dalert(d)}},insertCell:function(a,b,d){try{if(!a)return!1;
for(var c=d;c<this.colLength&&!this.isShow(b,c);c++);var e=this.getCell(b,c);e?this.trs[b].insertBefore(a,e):this.trs[b].appendChild(a);if(a&&("TD"===a.nodeName||"TH"===a.nodeName)){var f=this.getColspan(a),h=this.getRowspan(a);for(a=b;a<b+h;a++)for(c=d;c<d+f;c++)"undefined"!=typeof this.matrix[a][c]&&(a==b&&c==d?this.matrix[a][c]=this.SHOW:(this.matrix[a][c]=0,c>d&&(this.matrix[a][c]|=this.HIDE_COLSPAN),a>b&&(this.matrix[a][c]|=this.HIDE_ROWSPAN)))}return!0}catch(g){dalert(g)}},equalCell:function(a,
b,d,c){try{if(a==d&&b==c)return!0;var e=this.getCellIndex(a,b),f=this.getCellIndex(d,c);return e.row==f.row&&e.col==f.col?!0:!1}catch(h){dalert(h)}},createBlankCell:function(a,b){try{var d=this.table.ownerDocument.createElement("td");d.innerHTML="<p><br /></p>";d.style.width="0px";this.setRowspan(d,a);this.setColspan(d,b);return d}catch(c){dalert(c)}},clone:function(){try{var a=new TableMatrix(null);a.bClone=!0;a.table=this.table.cloneNode(!0);a.tables||(a.tables=[]);for(var b=0;b<this.tables.length;b++)a.tables[b]=
this.tables[b]==this.table?a.table:this.tables[b].cloneNode(!0);a.initTrs();a.initColgroup();a.rowLength=this.rowLength;a.colLength=this.colLength;a.arrColWidth=this.arrColWidth?this.arrColWidth.slice(0):this.calculateColWidth();a.arrRowHeight=this.arrRowHeight?this.arrRowHeight.slice(0):this.calculateRowHeight();a.bDirty=this.bDirty;a.matrix=this.matrix?this.matrix.slice(0):null;return a}catch(d){dalert(d)}},setTable:function(a){try{if(!a)return this;this.table=a;this.makeMatrix();return this}catch(b){dalert(b)}},
setTableArray:function(a,b){try{if(!a||0==a.length)return this;this.table=b||a[0];this.tables=a;this.bOneTable=1==a.length?!0:!1;this.bDoNotFindSplitTable=!0;this.makeMatrix();return this}catch(d){dalert(d)}},init:function(){try{this.bClone?(this.initTrs(),this.initColgroup(),this.bDirty=!1):(this.initTables(),this.initTrs(),this.initColgroup(),this.bDirty=!1,this.clearCache())}catch(a){dalert(a)}},initTables:function(){try{var a=null,b=null;a=this.bOneTable?[this.table]:this.bDoNotFindSplitTable&&
this.tables.length?this.tables:g_objTableUtil.getSplitTables(this.table);for(var d=0,c=a.length;d<c;d++)for(;b=a[d].rows[0];)if(0===b.cells.length)b.parentNode.removeChild(b);else break;this.tables=a}catch(e){dalert(e)}},initTrs:function(){try{if(!this.trs||0<this.trs.length)this.trs=[];for(var a=0,b=this.tables.length;a<b;a++){var d=[].slice.call(this.tables[a].rows);this.trs=this.trs.concat(d)}}catch(c){dalert(c)}},initColgroup:function(){try{if(!this.colgroups||0<this.colgroups.length)this.colgroups=
[];for(var a=0,b=this.tables.length;a<b;a++){var d=g_objNodeUtil.getImmediateChildNodesByTagName(this.tables[a],"colgroup");this.colgroups=this.colgroups.concat(d)}}catch(c){dalert(c)}},clearCache:function(){try{this.arrBlankRow=this.arrBlankCol=this.arrRowHeight=this.arrColWidth=null}catch(a){dalert(a)}},makeMatrix:function(){try{this.init();this.matrix=[];var a=this.trs,b=null,d=null,c=null,e=0,f=0,h=0,g=0,k=a.length,l=0;for(f=0;f<k;f++)for(d=a[f],b=d.cells,l=b.length,h=e=0;e<l;e++){c=b[e];for(var n=
this.getColspan(c),p=this.getRowspan(c);this.matrix[f]&&this.matrix[f][h];h++);for(var m=h;m<h+n;m++)for(var q=f;q<f+p;q++)this.matrix[q]||(this.matrix[q]=[]),q==f&&m==h?this.matrix[q][m]=this.SHOW:(this.matrix[q][m]=0,m>h&&(this.matrix[q][m]|=this.HIDE_COLSPAN),q>f&&(this.matrix[q][m]|=this.HIDE_ROWSPAN))}this.rowLength=this.matrix.length;this.colLength=0<this.rowLength?this.matrix[0].length:0;if(this.matrix.length>k){for(g=this.matrix.length-1;g>=k;g--)for(h=this.matrix[g].length-1;0<=h;h=this.getColRange(g,
h).start-1)if(this.matrix[g][h]&&this.isHideForRowspan(g,h)){var r=this.getCell(g,h);r&&this.setRowspan(r,this.getRowspan(r)-1)}this.matrix.splice(k);this.rowLength=k}}catch(u){dalert(u)}},calculateColWidth:function(){try{if(this.arrColWidth&&this.arrColWidth.length==this.colLength)return this.arrColWidth.slice(0);for(var a=[],b=0;b<this.colLength;b++)a[b]=null;var d=a.length;for(b=0;b<this.rowLength&&0<d;b++)for(var c=0,e=0;e<this.colLength;e++)if(!this.isHideForColspan(b,e))if(e=this.getColRange(b,
e).end,null===a[e]){var f=this.getCell(b,e);c+=f.offsetWidth;a[e]=c;d--}else c=a[e];a.splice(0,0,0);if(a.every(function(a){return 0===a||null===a}))return null;this.arrayFillNullWithMedian(a);this.arrColWidth=this.arrayPosToWidth(a,[]);return this.arrColWidth.slice(0)}catch(h){dalert(h)}},calculateRowHeight:function(){try{if(this.arrRowHeight&&this.arrRowHeight.length==this.rowLength)return this.arrRowHeight.slice(0);for(var a=[],b=0;b<this.rowLength;b++)a[b]=null;for(var d=a.length,c=0;c<this.colLength&&
0<d;c++){var e=0;for(b=0;b<this.rowLength;b++)if(!this.isHideForRowspan(b,c))if(b=this.getRowRange(b,c).end,null===a[b]){var f=this.getCell(b,c);e+=f.offsetHeight;a[b]=e;d--}else e=a[b]}a.splice(0,0,0);if(a.every(function(a){return 0===a||null===a}))return null;b=1;for(var h=a.length;b<h;b++)null===a[b]&&(a[b]=a[b-1]+this.trs[b-1].offsetHeight);this.arrRowHeight=this.arrayPosToWidth(a,[]);return this.arrRowHeight.slice(0)}catch(g){dalert(g)}},splitRow:function(a,b){try{if("undefined"==typeof a||0>
a||a>=this.rowLength)return!1;b=b?!0:!1;for(var d=this.calculateRowHeight(),c=g_objTableUtil,e=g_objPropertyUtil,f=this.colLength-1;0<=f;f--)if(this.isHideForRowspan(a,f)){var h=this.getCell(a,f),g=h.cloneNode(b),k=this.getRowRange(a,f),l=this.getColRange(a,f);this.setRowspan(h,a-k.start);this.setRowspan(g,k.end-a+1);var n=e.getStyleHeight(h);n=this.getHeightSumObj(n);var p=c.offsetHeightToStyleHeight(this.arraySum(d,k.start,a-1),h);c.setNodeValue_Height(h,n.getHeight(p),"px");p=c.offsetHeightToStyleHeight(this.arraySum(d,
a,k.end),h);c.setNodeValue_Height(g,n.getHeight(p),"px");this.insertCell(g,a,f);f=l.start;this.bDirty=!0}this.bDirty&&this.makeMatrix();return!0}catch(m){dalert(m)}},splitCol:function(a,b){try{if("undefined"==typeof a||0>a||a>=this.colLength)return!1;b=b?!0:!1;for(var d=this.calculateColWidth(),c=g_objTableUtil,e=g_objPropertyUtil,f=this.rowLength-1;0<=f;f--)if(this.isHideForColspan(f,a)){var h=this.getCell(f,a),g=h.cloneNode(b),k=this.getRowRange(f,a),l=this.getColRange(f,a);this.setColspan(h,a-
l.start);this.setColspan(g,l.end-a+1);if(10<e.getStyleWidth(h)){var n=c.offsetWidthToStyleWidth(this.arraySum(d,l.start,a-1),h);c.setNodeValue_Width(h,n,"px");n=c.offsetWidthToStyleWidth(this.arraySum(d,a,l.end),h);c.setNodeValue_Width(g,n,"px")}insertAfter(h,g);f=k.start;this.bDirty=!0}this.bDirty&&this.makeMatrix();return!0}catch(p){dalert(p)}},removeRow:function(a,b,d){try{if(isNaN(a))return null;isNaN(b)&&(b=a);if(a>b||0>a||a>=this.rowLength||0>b||b>=this.rowLength)return null;var c=this.table.ownerDocument;
if(!c)return null;for(var e=g_objNodeUtil,f=g_objTableUtil,h=g_objPropertyUtil,g=!1,k=this.colLength-1;0<=k;k--){var l=this.getRowRange(a,k);l.start<a&&l.end>b&&e.setAttribute(this.getCell(a,k),this.DZE_TEMP,"")}this.splitRow(a,!1);this.splitRow(b+1,!0);var n=d&&!1===d.returnFragment?null:c.createDocumentFragment();c=d=null;l=[];for(var p=b;p>=a;p--)(c=(d=this.trs[p])?d.parentNode:null)&&("TBODY"===c.nodeName||"THEAD"===c.nodeName)&&0>l.indexOf(c)&&l.push(c),n?n.firstChild?n.insertBefore(d,n.firstChild):
n.appendChild(d):d.parentNode.removeChild(d);for(var m=l.length-1;0<=m;m--)(c=l[m])&&c.parentNode&&!c.firstChild&&c.parentNode.removeChild(c);for(m=this.tables.length-1;0<=m;m--)0==this.tables[m].rows.length&&(this.tables[m].parentNode&&this.tables[m].parentNode.removeChild(this.tables[m]),this.table==this.tables[m]&&(0<=m-1?this.table=this.tables[m-1]:m+1<this.tables.length&&(this.table=this.tables[m+1])),this.tables.splice(m,1));this.makeMatrix();for(k=this.colLength-1;0<=k;k--){var q=this.getCell(a-
1,k),r=this.getCell(a,k);q=e.hasAttribute(q,this.DZE_TEMP)?q:null;r=e.hasAttribute(r,this.DZE_TEMP)?r:null;e.removeAttribute(q,this.DZE_TEMP);e.removeAttribute(r,this.DZE_TEMP);if(q&&r){if(10<h.getStyleHeight(q)){var u=f.offsetHeightToStyleHeight(q.offsetHeight+r.offsetHeight,q);f.setNodeValue_Height(q,u,"px")}this.setRowspan(q,this.getRowspan(q)+this.getRowspan(r));r.parentNode.removeChild(r);g=!0}}g&&this.makeMatrix();this.arrRowHeight&&0<this.arrRowHeight.length&&this.arrRowHeight.splice(a,b-a+
1);return n&&n.firstChild?n:null}catch(t){dalert(t)}},removeCol:function(a,b,d){try{if(isNaN(a))return null;isNaN(b)&&(b=a);if(a>b||0>a||a>=this.colLength||0>b||b>=this.colLength)return null;var c=g_objNodeUtil,e=g_objTableUtil,f=this.table.ownerDocument;if(!f)return null;for(var h=this.calculateColWidth(),g=this.rowLength-1;0<=g;g--){var k=this.getColRange(g,a);k.start<a&&k.end>b&&c.setAttribute(this.getCell(g,a),this.DZE_TEMP,"")}this.splitCol(a,!1);this.splitCol(b+1,!0);var l=[];for(g=0;g<this.rowLength;g++)for(var n=
a;n<=b;n++)l[g]||(l[g]=[]),l[g][n]=!1;var p=d&&!1===d.returnFragment?null:f.createDocumentFragment();for(g=this.rowLength-1;0<=g;g--){var m=this.trs[g].cloneNode(!1);for(n=b;n>=a;n--)if(!l[g][n]){var q=this.getRowRange(g,n);k=this.getColRange(g,n);if(!(q.start<g)){for(var r=q.start;r<=q.end;r++)for(var u=k.start;u<=k.end;u++)l[r]&&!1===l[r][u]&&(l[r][u]=!0);m.insertBefore(this.getCell(g,n),m.firstChild)}}p&&(p.firstChild?p.insertBefore(m,p.firstChild):p.appendChild(m))}this.makeMatrix();for(g=this.rowLength-
1;0<=g;g--){var t=this.getCell(g,a-1),v=this.getCell(g,a);t=c.hasAttribute(t,this.DZE_TEMP)?t:null;v=c.hasAttribute(v,this.DZE_TEMP)?v:null;c.removeAttribute(t,this.DZE_TEMP);c.removeAttribute(v,this.DZE_TEMP);if(t&&v){var y=e.offsetWidthToStyleWidth(t.offsetWidth+v.offsetWidth,t);e.setNodeValue_Width(t,y,"px");this.setColspan(t,this.getColspan(t)+this.getColspan(v));v.parentNode.removeChild(v)}}d=0;for(var x=this.colgroups.length;d<x;d++){var w=c.getImmediateChildNodesByTagName(this.colgroups[d],
"col");for(f=b;f>=a;f--)w[f]&&w[f].parentNode&&w[f].parentNode.removeChild(w[f])}h.splice(a,b-a+1);e.setTableWidth(this.tables,this.arraySum(h));this.makeMatrix();this.arrColWidth&&0<this.arrColWidth.length&&this.arrColWidth.splice(a,b-a+1);return p&&p.firstChild?p:null}catch(z){dalert(z)}},cloneRow:function(a,b,d){try{if(a>b||0>a||a>=this.rowLength||0>b||b>=this.rowLength)return null;var c=this.table.ownerDocument;if(!c)return null;d=d?!0:!1;for(var e=g_objTableUtil,f=g_objPropertyUtil,h=null,g=
[],k=a;k<=b;k++)for(var l=0;l<this.colLength;l++)g[k]||(g[k]=[]),g[k][l]=!1;var n=c.createDocumentFragment();for(k=a;k<=b;k++){var p=this.trs[k].cloneNode(!1);for(l=0;l<this.colLength;l++)if(!g[k][l]){for(var m=this.getRowRange(k,l),q=this.getColRange(k,l),r=m.start;r<=m.end;r++)for(var u=q.start;u<=q.end;u++)g[r]&&!1===g[r][u]&&(g[r][u]=!0);var t=this.getCell(k,l),v=e.cloneCell(t,d),y=Math.max(a,m.start),x=Math.min(b,m.end),w=this.getRowspan(t);c=x-y+1;if(w!=c&&(this.setRowspan(v,c),10<f.getStyleHeight(t))){h=
h||this.calculateRowHeight();var z=this.arraySum(h,y,x);e.setNodeValue_Height(v,e.offsetHeightToStyleHeight(z,t),"px")}p.appendChild(v)}n.appendChild(p)}return n}catch(A){dalert(A)}},cloneCol:function(a,b,d){try{if(a>b||0>a||a>=this.colLength||0>b||b>=this.colLength)return null;var c=this.table.ownerDocument;if(!c)return null;d=d?!0:!1;for(var e=g_objTableUtil,f=null,h=[],g=0;g<this.rowLength;g++)for(var k=a;k<=b;k++)h[g]||(h[g]=[]),h[g][k]=!1;var l=c.createDocumentFragment();for(g=0;g<this.rowLength;g++){var n=
this.trs[g].cloneNode(!1);for(k=a;k<=b;k++)if(!h[g][k]){for(var p=this.getRowRange(g,k),m=this.getColRange(g,k),q=p.start;q<=p.end;q++)for(var r=m.start;r<=m.end;r++)h[q]&&!1===h[q][r]&&(h[q][r]=!0);var u=this.getCell(g,k),t=e.cloneCell(u,d),v=Math.max(a,m.start),y=Math.min(b,m.end),x=this.getColspan(u);c=y-v+1;if(c!=x){this.setColspan(t,c);f=f||this.calculateColWidth();var w=this.arraySum(f,v,y);e.setNodeValue_Width(t,e.offsetWidthToStyleWidth(w,u),"px")}n.appendChild(t)}l.appendChild(n)}return l}catch(z){dalert(z)}},
divideCellCol:function(a,b){try{if(!a||1>b)return!1;if(1==b||this.divideCellCol_NotAddCol(a,b))return!0;var d=this.table.ownerDocument;if(!d)return!1;var c=g_objTableUtil,e=this.getDividePosition(a,b,!0);if(!e)return!1;var f=this.getDivideRowCol(e);if(!f)return!1;for(var h=this.getMatrixIndex(a),g=this.getColRange(h[0].row,h[0].col),k=f.length-1;0<=k;k--)1<f[k].span&&this.divideCol(g.start+k,f[k].span,f[k].arrSize);f=this.getDivideCell(e);if(!f)return!1;h=this.getMatrixIndex(a);this.getColRange(h[0].row,
h[0].col);var l=d.createDocumentFragment();for(k=0;k<b;k++)d=a,0<k&&(d=c.cloneCell(a,!1,!0),l.appendChild(d)),this.setColspan(d,f[k].span),c.setNodeValue_Width(d,c.offsetWidthToStyleWidth(f[k].size,a),"px");var n=a.parentNode,p=a.nextSibling;p?n.insertBefore(l,p):n.appendChild(l);this.makeMatrix();this.arrColWidth=null;return!0}catch(m){dalert(m)}},divideCellRow:function(a,b){try{if(!a||1>b)return!1;if(1==b||this.divideCellRow_NotAddRow(a,b))return!0;if(!this.table.ownerDocument)return!1;var d=g_objTableUtil,
c=this.getDividePosition(a,b,!1);if(!c)return!1;var e=this.getDivideRowCol(c);if(!e)return!1;for(var f=this.getMatrixIndex(a),h=this.getRowRange(f[0].row,f[0].col),g=e.length-1;0<=g;g--)1<e[g].span&&this.divideRow(h.start+g,e[g].span,e[g].arrSize);e=this.getDivideCell(c);if(!e)return!1;f=this.getMatrixIndex(a);h=this.getRowRange(f[0].row,f[0].col);var k=h.end+1;for(g=e.length-1;0<=g;g--)b=a,0<g&&(b=d.cloneCell(a,!1,!0)),this.setRowspan(b,e[g].span),d.setNodeValue_Height(b,d.offsetHeightToStyleHeight(e[g].size,
a),"px"),0<g&&(k-=e[g].span,this.insertCell(b,k,f[0].col));this.makeMatrix();this.arrRowHeight=null;return!0}catch(l){dalert(l)}},getDividePosition:function(a,b,d){try{var c=this.getMatrixIndex(a);if(!c)return null;var e=null,f=null;a=0;d?(e=this.getColRange(c[0].row,c[0].col),f=this.arrColWidth=this.arrColWidth||this.calculateColWidth(),a=10):(e=this.getRowRange(c[0].row,c[0].col),f=this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight(),a=25);if(!f)return null;d=[];c=[];var h=[],g=f.slice(e.start,
e.end+1);this.arrayWidthToPos(g,d);var k=this.getIntegerDivision(this.arraySum(g),b);this.arrayWidthToPos(k,c);c[0]=0;c[b]=d[d.length-1];for(b=1;b<c.length-1;b++){var l=this.arrayCloset(d,c[b]),n=Math.abs(c[b]-l);0!=n&&n<a&&0>c.indexOf(l)&&l<c[b+1]&&(c[b]=l)}h=this.arrayUnion(d,c);h.sort(function(a,b){return a-b});return{arrCurPos:d,arrPos:c,arrNewPos:h}}catch(p){dalert(p)}},getDivideRowCol:function(a){try{if(!a)return null;var b=a.arrCurPos,d=a.arrNewPos;if(!b||!d)return null;a=[];for(var c=0,e=
0,f=1;f<b.length;f++){e=d.indexOf(b[f],c+1);var h=[];this.arrayPosToWidth(d.slice(c,e+1),h);a.push({span:e-c,arrSize:h});c=e}return a}catch(g){dalert(g)}},getDivideCell:function(a){try{if(!a)return null;var b=a.arrPos,d=a.arrNewPos;if(!b||!d)return null;a=[];for(var c=0,e=0,f=1;f<b.length;f++)e=d.indexOf(b[f],c+1),a.push({span:e-c,size:d[e]-d[c]}),c=e;return a}catch(h){dalert(h)}},divideCellCol_NotAddCol:function(a,b){try{if(!a||isNaN(b)||1>b)return!1;if(1==b)return!0;var d=this.table.ownerDocument;
if(!d)return!1;var c=this.getColspan(a),e=this.getGCD(c,b);if(c<b||e!=b)return!1;var f=g_objTableUtil,h=this.getMatrixIndex(a),g=this.getColRange(h[0].row,h[0].col);this.arrColWidth=this.arrColWidth||this.calculateColWidth();var k=this.arrColWidth.slice(g.start,g.end+1),l=parseInt(c/e),n=d.createDocumentFragment();for(d=0;d<b;d++){c=a;0<d&&(c=f.cloneCell(a,!1,!0),n.appendChild(c));this.setColspan(c,l);var p=this.arraySum(k,l*d,l*d+l-1);f.setNodeValue_Width(c,f.offsetWidthToStyleWidth(p,a),"px")}var m=
a.parentNode,q=a.nextSibling;q?m.insertBefore(n,q):m.appendChild(n);this.makeMatrix();return!0}catch(r){dalert(r)}},divideCellRow_NotAddRow:function(a,b){try{if(!a||isNaN(b)||1>b)return!1;if(1==b)return!0;if(!this.table.ownerDocument)return!1;var d=this.getRowspan(a),c=this.getGCD(d,b);if(d<b||c!=b)return!1;var e=g_objTableUtil,f=this.getMatrixIndex(a),h=f[0].row,g=f[0].col,k=this.getRowRange(h,g);this.arrRowHeight=this.arrRowHeight||this.calculateRowHeight();var l=this.arrRowHeight.slice(k.start,
k.end+1),n=parseInt(d/c);for(--b;0<=b;b--){d=a;0<b&&(d=e.cloneCell(a,!1,!0));this.setRowspan(d,n);var p=this.arraySum(l,n*b,n*b+n-1);e.setNodeValue_Height(d,e.offsetWidthToStyleWidth(p,a),"px");0<b&&this.insertCell(d,h+b*n,g)}this.makeMatrix();return!0}catch(m){dalert(m)}},divideCol:function(a,b,d){try{if(isNaN(a)||isNaN(b))return!1;if(1==b)return!0;var c=this.table.ownerDocument;if(!c)return!1;var e=g_objNodeUtil,f=g_objTableUtil;this.arrColWidth=this.arrColWidth||this.calculateColWidth();if(!d){var h=
this.arrColWidth[a];d=[];for(var g=0;g<b;g++)d.push(+(h/b).toFixed(2))}for(var k=this.rowLength-1;0<=k;k=this.getRowRange(k,a).start-1){var l=this.getCell(k,a);l&&this.setColspan(l,this.getColspan(l)+b-1)}var n=c.createDocumentFragment();g=0;for(var p=this.colgroups.length;g<p;g++){var m=e.getImmediateChildNodesByTagName(this.colgroups[g],"col")[a];for(c=0;c<b;c++)h=m,0<c&&(h=m.cloneNode(),n.appendChild(h)),f.setNodeValue_Width(h,d[c],"px");var q=m.parentNode,r=m.nextSibling;r?q.insertBefore(n,r):
q.appendChild(n)}this.makeMatrix();return!0}catch(u){dalert(u)}},divideRow:function(a,b,d){try{if(isNaN(a)||isNaN(b)||0>a||a>=this.rowLength)return!1;if(1==b)return!0;var c=this.table.ownerDocument;if(!c)return!1;var e=g_objPropertyUtil,f=g_objTableUtil;if(!d){this.calculateRowHeight();var h=this.arrRowHeight[a];d=[];for(var g=0;g<b;g++)d.push(+(h/b).toFixed(2))}for(var k=this.colLength-1;0<=k;k=this.getColRange(a,k).start-1){var l=this.getCell(a,k);l&&this.setRowspan(l,this.getRowspan(l)+b-1)}var n=
c.createDocumentFragment(),p=this.trs[a],m=e.getStyleHeight(p);m=this.getHeightSumObj(m);for(g=0;g<b;g++)a=p,0<g&&(a=p.cloneNode(),n.appendChild(a)),f.setNodeValue_Height(a,m.getHeight(d[g]),"px");var q=p.parentNode,r=p.nextSibling;r?q.insertBefore(n,r):q.appendChild(n);this.makeMatrix();return!0}catch(u){dalert(u)}},divideTable:function(a){try{if(0>=a||a>=this.rowLength)return null;var b=g_objNodeUtil;this.splitRow(a);var d=this.trs[a-1],c=this.trs[a],e=c.ownerDocument,f=d.parentNode,h=c.parentNode,
g=b.getLoopParentElement(d.parentNode,"table"),k=g.cloneNode(!1),l=b.getImmediateChildNodesByTagName(g,"colgroup");if(0<l.length){var n=e.createDocumentFragment();a=0;for(var p=l.length;a<p;a++)n.appendChild(l[a].cloneNode(!0));k.firstChild?k.insertBefore(n,k.firstChild):k.appendChild(n)}if(f===h){var m=h.cloneNode(!1);b.moveNodesTo(m,c);k.appendChild(m);h=m}b.moveNodesTo(k,h);insertAfter(g,k);return k}catch(q){dalert(q)}},divideCellAtY:function(a,b,d){try{if(!a||!d||!this.table.ownerDocument)return!1;
var c=g_objNodeUtil,e=g_objPropertyUtil,f=g_objTableUtil,h=this.getMatrixIndex(a),g=this.getRowRange(h[0].row,h[0].col);if(!(g.start<b&&b<=g.end))return!1;var k=f.cloneCell(a,!1,!0);c.removeAllChild(k);var l=e.getStyleHeight(a);l=this.getHeightSumObj(l);var n=f.offsetHeightToStyleHeight(d[0],a);f.setNodeValue_Height(a,l.getHeight(n),"px");n=f.offsetHeightToStyleHeight(d[1],a);f.setNodeValue_Height(k,l.getHeight(n),"px");this.setRowspan(a,b-g.start);this.setRowspan(k,g.end-b+1);this.insertCell(k,b,
h[0].col);this.makeMatrix();return!0}catch(p){dalert(p)}},insertBlankCol:function(a,b){try{if("undefined"==typeof a||0>a||a>this.colLength||0>=b)return!1;b=b||0;this.splitCol(a,!1);var d=this.createBlankCell(this.rowLength,b);this.insertCell(d,0,a);if(0<this.colgroups.length){var c=this.table.ownerDocument;d=g_objNodeUtil;for(var e=c.createDocumentFragment(),f=0;f<b;f++){var h=c.createElement("col");h.style.width="0px";e.appendChild(h)}f=0;for(var g=this.colgroups.length;f<g;f++){var k=d.getImmediateChildNodesByTagName(this.colgroups[f],
"col");k[a]&&k[a].parentNode&&(a<k.length?k[a].parentNode.insertBefore(e.cloneNode(!0),k[a]):k[a].parentNode.appendChild(e.cloneNode(!0)))}}this.makeMatrix();return!0}catch(l){dalert(l)}},insertBlankRow:function(a,b){try{if("undefined"==typeof a||0>a||a>this.rowLength||0>=b)return!1;b=b||0;this.splitRow(a,!1);var d=this.table.ownerDocument,c=d.createDocumentFragment(),e=d.createElement("tr");for(d=0;d<b;d++)c.appendChild(e.cloneNode(!1));var f=this.createBlankCell(b,this.colLength);c.firstChild.appendChild(f);
0>=a?this.trs[0].parentNode.insertBefore(c,this.trs[0]):insertAfter(this.trs[a-1],c);this.makeMatrix();return!0}catch(h){dalert(h)}},insertRow:function(a,b){try{if("undefined"==typeof a||0>a||a>this.rowLength)return!1;b=b||1;this.splitRow(a,!1);a=0<a?a-1:a;for(var d=this.cloneRow(a,a),c=this.table.ownerDocument.createDocumentFragment(),e=0;e<b;e++)c.appendChild(d.cloneNode(!0));0==a?this.trs[0].parentNode.insertBefore(c,this.trs[0]):insertAfter(this.trs[a],c);this.makeMatrix();return!0}catch(f){dalert(f)}},
getSelection:function(){try{var a=!1,b=[],d=function(a){a=this.getMatrixIndex(a);for(var c=a.length-1;0<=c;c--){var d=a[c].row,e=a[c].col;b[d]||(b[d]=[]);b[d][e]=!0}}.bind(this),c=function(a,c,d,e){for(;a<=d;a++)for(var f=c;f<=e;f++)b[a]&&b[a][f]&&(b[a][f]=!1)}.bind(this),e=function(a,c,d,e){for(;a<=d;a++)for(var f=c;f<=e;f++)if(!b[a]||!b[a][f])return!1;return!0}.bind(this);g_objTableSelection.doAllSelectedCell(function(b){d(b);a=!0},this.table);if(!a)return null;for(var f=[],h=null,g=0,k=-1,l=-1,
n=-1,p=-1,m=0,q=b.length;m<q;m++)if(b[m])for(var r=0,u=b[m].length;r<u;r++)if(b[m][r]){k=l=m;n=p=r;g=1;for(var t=m;t<q;t++)for(var v=r;v<u;v++)if(e(m,r,t,v)){var y=(t-m+1)*(v-r+1);y>g&&(l=t,p=v,g=y)}c(k,n,l,p);f.push({nStartRow:k,nStartCol:n,nEndRow:l,nEndCol:p})}h=c=null;for(m=0;m<f.length;m++){c=f[m];h=null;for(var x=c.nStartRow;x<=c.nEndRow;x++)for(var w=c.nStartCol;w<=c.nEndCol;w++)this.isShow(x,w)&&(h||(h=[]),h.push(this.getCell(x,w)));c.arrCell=h}return f}catch(z){dalert(z)}},isBlankCol:function(a){try{if(0>
a||a>=this.colLength)return!0;if(this.arrBlankCol&&null!==this.arrBlankCol[a])return this.arrBlankCol[a];if(!this.arrBlankCol){this.arrBlankCol=[];for(var b=0;b<this.colLength;b++)this.arrBlankCol[b]=null}for(b=0;b<this.rowLength&&!this.isShow(b,a);b++);this.arrBlankCol[a]=b<this.rowLength?!1:!0;return this.arrBlankCol[a]}catch(d){dalert(d)}},isBlankRow:function(a){try{if(0>a||a>=this.rowLength)return!0;if(this.arrBlankRow&&null!==this.arrBlankRow[a])return this.arrBlankRow[a];if(!this.arrBlankRow){this.arrBlankRow=
[];for(var b=0;b<this.rowLength;b++)this.arrBlankRow[b]=null}for(b=0;b<this.colLength&&!this.isShow(a,b);b++);this.arrBlankRow[a]=b<this.colLength?!1:!0;return this.arrBlankRow[a]}catch(d){dalert(d)}},removeBlankCol:function(){try{for(var a=g_objTableResize,b=a.nMinWidth,d=a.nMinWidth=0,c=this.colLength-1;1<=c;c--)if(this.isBlankCol(c)){var e=this.calculateColWidth();if(!e)break;e=e.slice();e[c-1]+=e[c];e[c]=0;a.setColWidth(this,c,0);a.setColWidth(this,c-1,e[c-1]);this.removeCol(c,c,{returnFragment:!1});
d++}return d}catch(f){dalert(f)}finally{a.nMinWidth=b}},removeBlankRow:function(){try{for(var a=g_objTableResize,b=a.nMinHeight,d=a.nMinHeight=0,c=this.rowLength-1;1<=c;c--)if(this.isBlankRow(c)){var e=this.calculateRowHeight();if(!e)return 0;e=e.slice();e[c-1]+=e[c];e[c]=0;a.setRowHeight(this,c,0);a.setRowHeight(this,c-1,e[c-1]);this.removeRow(c,c,{returnFragment:!1});d++}return d}catch(f){dalert(f)}finally{a.nMinHeight=b}},removeZeroWidthCol:function(){try{var a=this.calculateColWidth();if(!a)return 0;
for(var b=!1,d=0,c=this.colLength-1;0<=c;c--)if(0===a[c]){b=!1;for(var e=this.rowLength-1;0<=e;e--)if(this.isShow(e,c)&&1===this.getColRange(e,c).length){b=!0;break}!1===b&&(this.removeCol(c,c,{returnFragment:!1}),d++)}return d}catch(f){dalert(f)}},removeZeroHeightRow:function(){try{var a=this.calculateRowHeight();if(!a)return 0;for(var b=!1,d=0,c=this.rowLength-1;0<=c;c--)if(0===a[c]){b=!1;for(var e=this.colLength-1;0<=e;e--)if(this.isShow(c,e)&&1===this.getRowRange(c,e).length){b=!0;break}!1===
b&&(this.removeRow(c,c,{returnFragment:!1}),d++)}return d}catch(f){dalert(f)}}};
var tagUtil=function(){this.bFormTagSwitch=!1;this.arrInputType="checkbox radio text password search tel url week month".split(" ");tagUtil.prototype.updateCurFormTagAttr=function(a){try{var c=g_objEditorDocument[a];return c?this.updateFormTagAttr(c.activeElement):!1}catch(d){dalert(d)}};tagUtil.prototype.updateFormTagAttr=function(a){try{if(a&&1===a.nodeType){var c=!1;if("INPUT"===a.nodeName)switch(a.type){case "checkbox":var d=a.checked,b="true"===a.getAttribute("checked")?!0:!1;d!==b&&(d?a.setAttribute("checked",
!0):a.removeAttribute("checked"),c=!0);break;case "radio":d=a.checked;b="true"===a.getAttribute("checked")?!0:!1;d?a.setAttribute("checked",!0):a.removeAttribute("checked");if(d&&a.name){var f=a.ownerDocument.querySelectorAll("input[type=radio][name="+a.name+"]");forEach(f,function(b,c){c!==a&&c.hasAttribute("checked")&&c.removeAttribute("checked")},this)}c=!0;break;case "text":case "search":case "tel":case "url":case "week":case "month":case "date":var e=a.value,g=a.getAttribute("value");e!==g&&
(a.setAttribute("value",a.value),c=!0)}else if("TEXTAREA"===a.nodeName)e=a.value,e!==a.textContent&&(a.textContent=e,c=!0);else if("SELECT"===a.nodeName){var h=a.selectedIndex;d=-1;var k=a.options;b=0;for(var l=k.length;b<l;b++)if("selected"===k[b].getAttribute("selected")){d=b;break}if(h!==d){b=0;for(l=k.length;b<l;b++)b===h?k[b].setAttribute("selected","selected"):k[b].removeAttribute("selected");c=!0}}return c}}catch(m){dalert(m)}};tagUtil.prototype.formTagSwitch=function(a,c){try{var d=g_objEditorDocument[c];
if(d){var b=d.getElementsByTagName("input");c=0;for(var f=b.length;c<f;c++)0<=this.arrInputType.indexOf(b[c].type)&&this.formTagSwitch_ContentEditable(b[c],a);var e=d.getElementsByTagName("select");c=0;for(f=e.length;c<f;c++)this.formTagSwitch_ContentEditable(e[c],a)}}catch(g){dalert(g)}};tagUtil.prototype.formTagSwitch_ContentEditable=function(a,c){try{if(a){var d=a.ownerDocument;if(d){var b=a.parentNode;b&&(!1===c?(c=function(a){var b=d.createElement("span");b.contentEditable="false";var c=null;
"INPUT"===a.nodeName&&"radio"===a.type&&g_objPropertyUtil.hasClass(a,"dze_checkbox_radio")&&a.nextSibling&&"LABEL"===a.nextSibling.nodeName&&(c=a.nextSibling);a.parentNode.replaceChild(b,a);b.appendChild(a);c&&b.appendChild(c);return b},"SPAN"===b.nodeName?b.firstChild===b.lastChild&&b.firstChild===a?b.contentEditable="false":(b.removeAttribute("contentEditable"),g_objNodeUtil.splitOn(b.parentNode,a),c(a)):c(a)):"SPAN"===b.nodeName&&(b.firstChild===b.lastChild&&b.firstChild===a?(b.removeChild(a),
b.parentNode.replaceChild(a,b)):(b.removeAttribute("contentEditable"),g_objNodeUtil.splitOn(b.parentNode,a))))}}}catch(f){dalert(f)}};tagUtil.prototype.force_formTagSwitch=function(a,c){try{if(a){for(var d=a.querySelectorAll("input"),b=0,f=d.length;b<f;b++)0<=this.arrInputType.indexOf(d[b].type)&&this.formTagSwitch_ContentEditable(d[b],c);var e=a.querySelectorAll("select");b=0;for(f=e.length;b<f;b++)this.formTagSwitch_ContentEditable(e[b],c)}}catch(g){dalert(g)}};tagUtil.prototype.removeChild=function(a,
c,d,b,f){try{var e=a;if(void 0===e||null===e)return!1;"object"!=typeof e&&(e=document.getElementsByTagName(a));if(void 0===e.length||0===e.length)e.parentNode.removeChild(e);else for(a=0;a<e.length;a++){var g=e[a],h=!1;null!=c&&null!=d&&g[c]===d?h=!0:null===c&&null===d&&(h=!0);h&&(g.parentNode.removeChild(g),a=--a);void 0!=b&&b(h)}void 0!=f&&f(e)}catch(k){dalert(k)}}},g_objTagUtil=new tagUtil;
var g_objBorderComboBoxUtil=new function(){var k=this;this.arrBorderStyle="noline solid dotted dashed double hidden".split(" ");this.arrBorderWidth=["0","1","2","3"];this.strDisabledColor="#dedede";this.makeBorderComboBoxHTML=function(b,c,e,f,g){try{var a="";a+='<div id="borderComboBoxContainer_'+b+'" class="'+g_strSkin_ComboBox_Area+'" style="width:'+e+"px;";"number"===typeof g&&(a+="height:"+g+"px;");a+='line-height:0;overflow:hidden;display:inline-block">';a+='<table style="border:0px;width:'+
e+"px;";"number"===typeof g&&(a+="height:"+g+"px;");a+='line-height:0;table-layout:fixed;" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td class="tbComboBox_AreaLabel_1"id="tbComboBox_'+b+'" style="line-height:0;height:14px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding:5px;">';if(0==c)for(var d=0;d<this.arrBorderStyle.length;d++)a="double"==this.arrBorderStyle[d]?a+('<div id="borderComboBoxLabel_Sub_'+b+"_"+d+'" style="height:1px;border-top:3px '+this.arrBorderStyle[d]+
' #000000;display:none;"></div>'):"noline"==this.arrBorderStyle[d]?a+('<div id="borderComboBoxLabel_Sub_'+b+"_"+d+'" style="display:none;">'+ID_RES_CONST_STRING_NO_LINE+"</div>"):"hidden"===this.arrBorderStyle[d]?a+('<div id="borderComboBoxLabel_Sub_'+b+"_"+d+'" style="display:none;">'+ID_RES_STRING_HIDDEN_LINE+"</div>"):a+('<div id="borderComboBoxLabel_Sub_'+b+"_"+d+'" style="height:1px;border-top:1px '+this.arrBorderStyle[d]+' #000000;display:none;"></div>');else if(1==c)for(d=0;d<this.arrBorderWidth.length;d++)a+=
'<div id="borderComboBoxLabel_Sub_'+b+"_"+d+'" style="height:1px;border-top:'+this.arrBorderWidth[d]+'px solid #000000;display:none;"></div>';a+="</td>";a+='<td class="'+g_strSkin_ComboBox_AreaArrow+'" style="line-height:0;width:14px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;">';a+='<img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;">';a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div id="borderComboBoxLayer_'+
b+'" style="position:absolute;display:none;z-index:20032;">';a+='<table cellpadding=1 cellspacing=1 border=0 style="width:'+f+'px;border-collapse:separate;table-layout:auto;" class="'+g_strSkin_ComboBoxWin+'">';a+="<tr>";a+='<td style="line-height:normal;height:20px;border:0;">';a+='<table cellpadding=1 cellspacing=1 border=0 style="width:'+f+'px;border-collapse:separate;table-layout:auto;">';if(0==c)for(d=0;d<this.arrBorderStyle.length;d++)a+="<tr>",a+='<td style="line-height:normal;padding:1px;height:20px;border:0;">',
a+='<table id="borderSubContainer_'+b+"_"+this.arrBorderStyle[d]+'" cellpadding=1 cellspacing=1 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" style="width: '+f+'px; height: 20px; nLayerWidth + border-collapse:collapse;">',a+="<tr>",a+='<td width="1" style="border:0;height:20px;"></td>',a+='<td id="borderSub_'+b+"_"+this.arrBorderStyle[d]+'" cusBorderIndex="'+d+'" style="line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;border:0;height:20px;">',a=
"double"==this.arrBorderStyle[d]?a+('<div style="height:1px;border-top:3px '+this.arrBorderStyle[d]+' #000000;"></div>'):"noline"==this.arrBorderStyle[d]?a+('<div style="">'+ID_RES_CONST_STRING_NO_LINE+"</div>"):"hidden"==this.arrBorderStyle[d]?a+('<div style="">'+ID_RES_STRING_HIDDEN_LINE+"</div>"):a+('<div style="height:1px;border-top:1px '+this.arrBorderStyle[d]+' #000000;"></div>'),a+="</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>";else if(1==c)for(d=0;d<this.arrBorderWidth.length;d++)a+=
"<tr>",a+='<td style="line-height:normal;padding:1px;height:18px;border:0;">',a+='<table id="borderSubContainer_'+b+"_"+this.arrBorderWidth[d]+'" width="'+f+'px" height="18" cellpadding=1 cellspacing=1 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" style="border-collapse:collapse;">',a+="<tr>",a+='<td width="1" style="border:0;height:18px;"></td>',a+='<td id="borderSub_'+b+"_"+this.arrBorderWidth[d]+'" cusBorderIndex="'+d+'" style="line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;border:0;height:18px;">',
a+='<div style="height:1px;border-top:'+this.arrBorderWidth[d]+'px solid #000000;"></div>',a+="</td>",a+="</tr>",a+="</table>",a+="</td>",a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(h){dalert(h)}};this.initBorderComboBox=function(b,c,e){try{var f=g_objLayerKit.getElementById("borderComboBoxContainer_"+b);if(null!=f){var g=g_objLayerKit.getElementById("borderComboBoxLayer_"+b);if(null!=g)if(f.onmouseover=function(a){!0!==g_objPropertyUtil.element_hasClass(this,"disableStatus")&&
""!=g.style.display&&(this.className=g_strSkin_ComboBox_AreaOver)},f.onmouseout=function(a){!0!==g_objPropertyUtil.element_hasClass(this,"disableStatus")&&""!=g.style.display&&(this.className=g_strSkin_ComboBox_Area)},f.onmousedown=function(a){!0!==g_objPropertyUtil.element_hasClass(this,"disableStatus")&&""!=g.style.display&&(this.className=g_strSkin_ComboBox_AreaDown)},f.onmouseup=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||""==g.style.display||(this.className=g_strSkin_ComboBox_Area)},
f.onclick=function(a){!0!==g_objPropertyUtil.element_hasClass(this,"disableStatus")&&k.showBorderComboBoxLayer(b)},g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+b+"_1").style.display="",0==c){f="selFormBorderStyle"===b;for(var a=null,d=null,h=0;h<this.arrBorderStyle.length;h++)d=g_objLayerKit.getElementById("borderSubContainer_"+b+"_"+this.arrBorderStyle[h]),!f&&"hidden"===this.arrBorderStyle[h]&&(a=g_objNodeUtil.getLoopParentElement(d,"tr"))&&(a.style.display="none"),d.onmouseover=function(a){g_objComboBoxWin.fnComboBoxItemOver(this)},
d.onmouseout=function(a){g_objComboBoxWin.fnComboBoxItemOut(this)},g_objLayerKit.getElementById("borderSub_"+b+"_"+this.arrBorderStyle[h]).onclick=function(a){k.clickBorderComboBoxLayer(this,b,c);"undefined"!=typeof e&&e(k.getSelectedBorderValue(b,c))};f&&(d=g_objLayerKit.getElementById("borderSubContainer_"+b+"_"+this.arrBorderStyle[5]),(a=g_objNodeUtil.getLoopParentElement(d,"tr"))&&a.previousSibling&&a.parentNode.insertBefore(a,a.parentNode.firstChild))}else if(1==c)for(h=0;h<this.arrBorderWidth.length;h++)d=
g_objLayerKit.getElementById("borderSubContainer_"+b+"_"+this.arrBorderWidth[h]),d.onmouseover=function(a){g_objComboBoxWin.fnComboBoxItemOver(this)},d.onmouseout=function(a){g_objComboBoxWin.fnComboBoxItemOut(this)},g_objLayerKit.getElementById("borderSub_"+b+"_"+this.arrBorderWidth[h]).onclick=function(a){k.clickBorderComboBoxLayer(this,b,c);"undefined"!=typeof e&&e(k.getSelectedBorderValue(b,c))}}}catch(l){dalert(l)}};this.showBorderComboBoxLayer=function(b){try{var c=g_objLayerKit.getElementById("borderComboBoxContainer_"+
b);if(null!=c){var e=g_objLayerKit.getElementById("borderComboBoxLayer_"+b);null!=e&&(""==e.style.display?(e.style.display="none",c.className=g_strSkin_ComboBox_Area):(e.style.display="",c.className=g_strSkin_ComboBox_AreaDown))}}catch(f){dalert(f)}};this.clickBorderComboBoxLayer=function(b,c,e){try{this.showBorderComboBoxLayer(c);var f=g_objPropertyUtil.getTargetCellFlag(b,"cusBorderIndex");if("double"==this.arrBorderStyle[f]){var g=g_objLayerKit.getElementById("txtBorderWidth")||g_objLayerKit.getElementById("txtFormBorderWidth");
g&&3>g.value&&(g.value=3,g_objBorderSelectionUtil.setBorderWidth(3))}var a=this.getSubArrayObject(e);if(null!=a)for(b=0;b<a.length;b++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+c+"_"+b).style.display=b==f?"":"none"}catch(d){dalert(d)}};this.getSelectedBorderValue=function(b,c){try{var e=this.getSubArrayObject(c);if(null==e)return"";for(c=0;c<e.length;c++)if(""==g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+b+"_"+c).style.display)return e[c];return""}catch(f){dalert(f)}};this.setSelectedBorderValue=
function(b,c,e){try{var f=this.getSubArrayObject(c);if(null!=f)for(c=0;c<f.length;c++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+b+"_"+c).style.display=f[c]==e?"":"none"}catch(g){dalert(g)}};this.setSelectedIndex=function(b,c,e){try{var f=this.getSubArrayObject(c);if(null!=f){var g=f.length;e>=g&&(e=1);for(c=0;c<g;c++)g_objLayerKit.getElementById("borderComboBoxLabel_Sub_"+b+"_"+c).style.display=c==e?"":"none"}}catch(a){dalert(a)}};this.getSubArrayObject=function(b){try{if(COMBOBOX_TYPE_BORDER_STYLE==
b)return this.arrBorderStyle;if(1==b)return this.arrBorderWidth}catch(c){dalert(c)}return null};this.setContentPosition=function(b,c,e){b=g_objLayerKit.getElementById("borderComboBoxLayer_"+b);null!=b&&("number"===typeof c&&(b.style.left=c+"px"),"number"===typeof e&&(b.style.top=e+"px"))};this.setActive=function(b,c){try{var e=g_objLayerKit.getElementById("borderComboBoxContainer_"+b);if(null!=e){var f=g_objLayerKit.getElementById("borderComboBoxLayer_"+b);if(null!=f){var g=g_objLayerKit.getElementById("tbComboBox_"+
b);null!=g&&(c?(e.style.backgroundColor="",f.style.backgroundColor="",g.style.backgroundColor="",g_objPropertyUtil.applyFilterOpacityStyle(e,!1,-1),g_objPropertyUtil.element_hasClass(e,"disableStatus")&&g_objPropertyUtil.element_removeClass(e,"disableStatus")):(e.style.backgroundColor=this.strDisabledColor,f.style.backgroundColor=this.strDisabledColor,g.style.backgroundColor=this.strDisabledColor,g_objPropertyUtil.applyFilterOpacityStyle(e,!1,0),g_objPropertyUtil.element_hasClass(e,"disableStatus")||
g_objPropertyUtil.element_addClass(e,"disableStatus")))}}}catch(a){dalert(a)}}};
var g_objBorderSelectionUtil=new function(){var h=this;this.bUseSelectRec=!1;this.arrID_SelectRec=["selectRec_0","selectRec_1","selectRec_2"];this.arrObjSelectRec=[];this.arrID_MainRec=["mainRec_0","mainRec_1","mainRec_2","mainRec_3"];this.arrObjMainRec=[];this.arrID_MiniRec="miniRec_h_0 miniRec_h_1 miniRec_h_2 miniRec_v_0 miniRec_v_1 miniRec_v_2".split(" ");this.arrObjMiniRec=[];this.bHide_MiniRec_v_1=this.bHide_MiniRec_h_1=!1;this.nBorderWidth=0;this.strBorderColor=this.strBorderStyle="";this.makeBorderSelectionHTML=
function(c,b,d,a){try{var e=2*b+2*d,f=parseInt(e/3),g=e+10;this.bUseSelectRec=1==c?!1:a;a="";a+='<div id="borderSelectionContainer" style="overflow:hidden;min-height:96px;display:inline-flex;align-items:center;">';a+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td colspan="2">';this.bUseSelectRec&&(a+=this.makeBorderSelectionHTML_selectRec(g));a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+=this.makeBorderSelectionHTML_mainRec(c,
b,d);a+="</td>";a+="<td>";a+='<table style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td style="height:'+f+'px;vertical-align:top;">';a+=this.makeBorderSelectionHTML_miniRec("miniRec_h_0",10,!0,0);a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="height:'+f+'px;vertical-align:middle;">';0==c&&(a+=this.makeBorderSelectionHTML_miniRec("miniRec_h_1",10,!0,1));a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="height:'+f+'px;vertical-align:bottom;">';
a+=this.makeBorderSelectionHTML_miniRec("miniRec_h_2",10,!0,2);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<table width="'+e+'"style="border-collapse:collapse;table-layout:fixed;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td align="left">';a+=this.makeBorderSelectionHTML_miniRec("miniRec_v_0",10,!1,0);a+="</td>";a+='<td align="center">';0==c&&(a+=this.makeBorderSelectionHTML_miniRec("miniRec_v_1",10,!1,1));a+="</td>";a+='<td align="right">';
a+=this.makeBorderSelectionHTML_miniRec("miniRec_v_2",10,!1,2);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="<td></td>";a+="</tr>";return a+"</table></div>"}catch(k){dalert(k)}};this.makeBorderSelectionHTML_selectRec=function(c){try{var b=parseInt((c-24)/3),d=parseInt(b/2);c=ID_RES_STRING_ALL;var a=ID_RES_STRING_OUTER,e=ID_RES_STRING_INNER,f="";f+='<table border="0" cellspacing="0" cellpadding="0">';f+="<tr>";f+='<td width="'+b+'">';f+='<table id="selectRec_0" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+="</tr>";f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_left" title="'+c+'"></td>';f+="</tr>";f+="</table>";f+="</td>";f+='<td width="12"></td>';f+='<td width="'+b+'" align="center">';f+='<table id="selectRec_1" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_1" title="'+a+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_2" title="'+a+'"></td>';f+="</tr>";f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_3" title="'+a+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_center_4" title="'+a+'"></td>';f+="</tr>";f+="</table>";f+="</td>";f+='<td width="12"></td>';f+='<td width="'+b+'" align="right">';f+='<table id="selectRec_2" style="border-collapse:collapse;table-layout:fixed;cursor:pointer;" border="0" cellspacing="0" cellpadding="0">';
f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_1" title="'+e+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_2" title="'+e+'"></td>';f+="</tr>";f+="<tr>";f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_3" title="'+e+'"></td>';f+='<td width="'+d+'" height="'+d+'" class="b_s_select_right_4" title="'+e+'"></td>';f+="</tr>";f+="</table>";f+="</td>";f+="</tr>";f+="<tr>";f+='<td colspan="5" height="14"></td>';return f+"</tr></table>"}catch(g){dalert(g)}};
this.makeBorderSelectionHTML_mainRec=function(c,b,d){try{var a="";a+='<table style="border-collapse:collapse;table-layout:fixed;min-height: 80px;" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td class="b_s_out_left_top" style="width:'+b+"px;height:"+b+'px;"></td>';a+='<td style="width:'+d+"px;height:"+b+'px;"></td>';a+='<td style="width:'+d+"px;height:"+b+'px;"></td>';a+='<td class="b_s_out_right_top" style="width:'+b+"px;height:"+b+'px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="height:'+
d+'px;"></td>';0==c?(a+='<td id="mainRec_0" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>',a+='<td id="mainRec_1" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>'):(a+='<td id="mainRec_0" class="b_s_in_left b_s_in_top" style="height:'+d+'px;"></td>',a+='<td id="mainRec_1" class="b_s_in_right b_s_in_top" style="height:'+d+'px;"></td>');a+='<td style="height:'+d+'px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="height:'+
d+'px;"></td>';0==c?(a+='<td id="mainRec_2" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>',a+='<td id="mainRec_3" class="b_s_in_left b_s_in_top b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>'):(a+='<td id="mainRec_2" class="b_s_in_left b_s_in_bottom" style="height:'+d+'px;"></td>',a+='<td id="mainRec_3" class="b_s_in_right b_s_in_bottom" style="height:'+d+'px;"></td>');a+='<td style="height:'+d+'px;"></td>';a+="</tr>";a+="<tr>";a+='<td class="b_s_out_left_bottom" style="height:'+
b+'px;"></td>';a+='<td style="height:'+b+'px;"></td>';a+='<td style="height:'+b+'px;"></td>';a+='<td class="b_s_out_right_bottom" style="height:'+b+'px;"></td>';return a+"</tr></table>"}catch(e){dalert(e)}};this.makeBorderSelectionHTML_miniRec=function(c,b,d,a){try{var e="";e+='<table id="'+c+'" class="b_s_mini" style="border-collapse:separate;table-layout:fixed;cursor:pointer;border-spacing:2px;" border="0" cellspacing="2" cellpadding="0">';d?0==a?(e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #000000;"></td>',
e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>"):1==a?(e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #000000;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',
e+="</tr>"):2==a&&(e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #c5c5c5;"></td>',e+="</tr>",e+="<tr>",e+='<td style="width:'+b+'px;height:1px;border-top:1px solid #000000;"></td>',e+="</tr>"):(e+="<tr>",0==a?(e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #000000;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+
b+'px;border-left:1px solid #c5c5c5;"></td>'):1==a?(e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #000000;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>'):2==a&&(e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #c5c5c5;"></td>',e+='<td style="width:1px;height:'+b+'px;border-left:1px solid #000000;"></td>'),
e+="</tr>");return e+"</table>"}catch(f){dalert(f)}};this.initBorderSelection=function(){try{this.bHide_MiniRec_v_1=this.bHide_MiniRec_h_1=!1;this.nBorderWidth=0;this.strBorderColor=this.strBorderStyle="";if(this.bUseSelectRec)for(var c=0;c<this.arrID_SelectRec.length;c++)this.arrObjSelectRec[c]=g_objLayerKit.getElementById(this.arrID_SelectRec[c]),this.arrObjSelectRec[c].onclick=function(b){h.clickSelectRec(this)};for(c=0;c<this.arrID_MainRec.length;c++)this.arrObjMainRec[c]=g_objLayerKit.getElementById(this.arrID_MainRec[c]);
for(c=0;c<this.arrID_MiniRec.length;c++){var b=g_objLayerKit.getElementById(this.arrID_MiniRec[c]);null==b?this.arrObjMiniRec[c]=null:(this.arrObjMiniRec[c]=b,b.onclick=function(){h.clickMiniRec(this)})}}catch(d){dalert(d)}};this.initPropTagTableCellStyleBorder=function(c){try{if(c){var b=c[0][0],d=c[0][1];b||d?!b&&d?this.hideMiniRec("miniRec_h_1"):b&&!d&&this.hideMiniRec("miniRec_v_1"):(this.hideMiniRec("miniRec_h_1"),this.hideMiniRec("miniRec_v_1"));var a=c[1];c="";b=0;for(var e=d="",f=0;f<a.length;f++)c=
2>=f?"h":"v",b=f%3,d="miniRec_"+c+"_"+b,e="bHide_MiniRec_"+c+"_"+b,!0!==this[e]&&(a[f]&&a[f]!==ID_PROP_BORDER_DUPLICATED?this.setChecked_borderValue(d,!1,a[f]):this.setChecked_borderValue(d,!1,""));this.updateSelectRec()}}catch(g){dalert(g)}};this.setBorderWidth=function(c){try{g_objPropTagCommon.setSelectedTableCustomStyle(),this.nBorderWidth=c}catch(b){dalert(b)}};this.setBorderStyle=function(c){try{g_objPropTagCommon.setSelectedTableCustomStyle(),this.strBorderStyle=c}catch(b){dalert(b)}};this.setBorderColor=
function(c){try{g_objPropTagCommon.setSelectedTableCustomStyle(),this.strBorderColor=c}catch(b){dalert(b)}};this.getBorderString=function(){try{return"noline"==this.strBorderStyle?"0px solid #000000":""==this.strBorderColor?this.nBorderWidth+"px none":this.nBorderWidth+"px "+this.strBorderStyle+" "+this.strBorderColor}catch(c){dalert(c)}};this.getMiniRecBorderString=function(c){return c?this.getBorderValue(c.id):""};this.clickSelectRec=function(c){try{if(this.bUseSelectRec){g_objPropTagCommon.setSelectedTableCustomStyle();
for(var b=c.id,d=-1,a=!1,e=0;e<this.arrID_SelectRec.length;e++)this.arrID_SelectRec[e]==b?(d=e,this.select(c),a=!0):this.isSelected(this.arrObjSelectRec[e])&&this.deselect(this.arrObjSelectRec[e]);a?0==d?(this.setChecked(this.arrID_MiniRec[0],!0),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!0),this.setChecked(this.arrID_MiniRec[2],!0),this.setChecked(this.arrID_MiniRec[3],!0),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!0),this.setChecked(this.arrID_MiniRec[5],
!0)):1==d?(this.setChecked(this.arrID_MiniRec[0],!0),this.setChecked(this.arrID_MiniRec[2],!0),this.setChecked(this.arrID_MiniRec[3],!0),this.setChecked(this.arrID_MiniRec[5],!0)):2==d&&(this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!0),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!0)):(this.setChecked(this.arrID_MiniRec[0],!1),this.bHide_MiniRec_h_1||this.setChecked(this.arrID_MiniRec[1],!1),this.setChecked(this.arrID_MiniRec[2],!1),this.setChecked(this.arrID_MiniRec[3],
!1),this.bHide_MiniRec_v_1||this.setChecked(this.arrID_MiniRec[4],!1),this.setChecked(this.arrID_MiniRec[5],!1))}}catch(f){dalert(f)}};this.isSelected=function(c){return g_objPropertyUtil.hasClass(c,"b_s_rec_selected")};this.select=function(c,b){return!1===b?this.deselect(c):g_objPropertyUtil.addClass(c,"b_s_rec_selected")};this.deselect=function(c){return g_objPropertyUtil.removeClass(c,"b_s_rec_selected")};this.updateSelectRec=function(){try{if(this.bUseSelectRec){for(var c=[],b=0;b<this.arrObjMiniRec.length;b++){if(1==
b){if(this.bHide_MiniRec_h_1){c[b]=!0;continue}}else if(4==b&&this.bHide_MiniRec_v_1){c[b]=!0;continue}this.isSelected(this.arrObjMiniRec[b])?c[b]=!0:c[b]=!1}var d=-1;1==c[0]&&1==c[1]&&1==c[2]&&1==c[3]&&1==c[4]&&1==c[5]&&this.checkAll()?d=0:1==c[0]&&0==c[1]&&1==c[2]&&1==c[3]&&0==c[4]&&1==c[5]&&this.checkOuter()?d=1:0==c[0]&&1==c[1]&&0==c[2]&&0==c[3]&&1==c[4]&&0==c[5]&&this.checkInner()&&(d=2);for(b=0;b<this.arrObjSelectRec.length;b++)b==d?this.isSelected(this.arrObjSelectRec[b])||this.select(this.arrObjSelectRec[b]):
this.isSelected(this.arrObjSelectRec[b])&&this.deselect(this.arrObjSelectRec[b])}}catch(a){dalert(a)}};this.clickMiniRec=function(c){try{var b=!1,d=this.getBorderString(),a=this.getMiniRecBorderString(c);b=this.compareBorderString(d,a)?!1:!0;this.doClickMiniRec(c,b);this.select(c,b);this.bUseSelectRec&&this.updateSelectRec()}catch(e){dalert(e)}};this.rightDiv=this.leftDiv=null;this.compareBorderString=function(c,b){try{var d=this.leftDiv,a=this.rightDiv;null===d&&(this.leftDiv=d=document.createElement("div"));
null===a&&(this.rightDiv=a=document.createElement("div"));var e=d.style,f=a.style;e.border=c;f.border=b;return e.borderWidth===f.borderWidth&&e.borderStyle===f.borderStyle&&e.borderColor===f.borderColor?!0:!1}catch(g){dalert(g)}};this.doClickMiniRec=function(c,b){try{g_objPropTagCommon.setSelectedTableCustomStyle();var d="";b&&(d=this.getBorderString());this.setMiniRecBorder(c.id,d)}catch(a){dalert(a)}};this.getBorderSelectionMiniRecById=function(c){try{for(var b=0;b<this.arrID_MiniRec.length;b++)if(this.arrID_MiniRec[b]==
c)return this.arrObjMiniRec[b]}catch(d){dalert(d)}return null};this.getBorderValue=function(c){try{var b=null,d="";this.arrID_MiniRec[0]===c?(b=this.arrObjMainRec[0],d=b.style.borderTopWidth+" "+b.style.borderTopStyle+" "+b.style.borderTopColor):this.arrID_MiniRec[1]===c?(b=this.arrObjMainRec[0],d=b.style.borderBottomWidth+" "+b.style.borderBottomStyle+" "+b.style.borderBottomColor):this.arrID_MiniRec[2]===c?(b=this.arrObjMainRec[2],d=b.style.borderBottomWidth+" "+b.style.borderBottomStyle+" "+b.style.borderBottomColor):
this.arrID_MiniRec[3]===c?(b=this.arrObjMainRec[0],d=b.style.borderLeftWidth+" "+b.style.borderLeftStyle+" "+b.style.borderLeftColor):this.arrID_MiniRec[4]==c?(b=this.arrObjMainRec[0],d=b.style.borderRightWidth+" "+b.style.borderRightStyle+" "+b.style.borderRightColor):this.arrID_MiniRec[5]==c&&(b=this.arrObjMainRec[1],d=b.style.borderRightWidth+" "+b.style.borderRightStyle+" "+b.style.borderRightColor);return d.trim()}catch(a){dalert(a)}return""};this.setChecked=function(c,b){try{var d=this.getBorderSelectionMiniRecById(c);
null!=d&&(b?this.isSelected(d)||this.select(d):this.isSelected(d)&&this.deselect(d),this.doClickMiniRec(d,b))}catch(a){dalert(a)}};this.hideMiniRec=function(c){try{if(c==this.arrID_MiniRec[1]||c==this.arrID_MiniRec[4]){var b=this.getBorderSelectionMiniRecById(c);if(null==b)return null;b.style.display="none";b=g_objPropertyUtil;var d=g_objTableUtil,a=function(a,b,c){return d.getTableCellElement(a,b,c)};c==this.arrID_MiniRec[1]?(this.bHide_MiniRec_h_1=!0,b.removeClass(this.arrObjMainRec[0],"b_s_in_bottom"),
b.removeClass(this.arrObjMainRec[1],"b_s_in_bottom"),b.removeClass(this.arrObjMainRec[2],"b_s_in_top"),b.removeClass(this.arrObjMainRec[3],"b_s_in_top"),a(this.arrObjSelectRec[0],0,0).style.borderBottom="0px",a(this.arrObjSelectRec[0],0,1).style.borderBottom="0px",a(this.arrObjSelectRec[0],1,0).style.borderTop="0px",a(this.arrObjSelectRec[0],1,1).style.borderTop="0px",a(this.arrObjSelectRec[1],0,0).style.borderBottom="0px",a(this.arrObjSelectRec[1],0,1).style.borderBottom="0px",a(this.arrObjSelectRec[1],
1,0).style.borderTop="0px",a(this.arrObjSelectRec[1],1,1).style.borderTop="0px",a(this.arrObjSelectRec[2],0,0).style.borderBottom="0px",a(this.arrObjSelectRec[2],0,1).style.borderBottom="0px",a(this.arrObjSelectRec[2],1,0).style.borderTop="0px",a(this.arrObjSelectRec[2],1,1).style.borderTop="0px"):c==this.arrID_MiniRec[4]&&(this.bHide_MiniRec_v_1=!0,b.removeClass(this.arrObjMainRec[0],"b_s_in_right"),b.removeClass(this.arrObjMainRec[1],"b_s_in_left"),b.removeClass(this.arrObjMainRec[2],"b_s_in_right"),
b.removeClass(this.arrObjMainRec[3],"b_s_in_left"),a(this.arrObjSelectRec[0],0,0).style.borderRight="0px",a(this.arrObjSelectRec[0],0,1).style.borderLeft="0px",a(this.arrObjSelectRec[0],1,0).style.borderRight="0px",a(this.arrObjSelectRec[0],1,1).style.borderLeft="0px",a(this.arrObjSelectRec[1],0,0).style.borderRight="0px",a(this.arrObjSelectRec[1],0,1).style.borderLeft="0px",a(this.arrObjSelectRec[1],1,0).style.borderRight="0px",a(this.arrObjSelectRec[1],1,1).style.borderLeft="0px",a(this.arrObjSelectRec[2],
0,0).style.borderRight="0px",a(this.arrObjSelectRec[2],0,1).style.borderLeft="0px",a(this.arrObjSelectRec[2],1,0).style.borderRight="0px",a(this.arrObjSelectRec[2],1,1).style.borderLeft="0px");this.bHide_MiniRec_h_1&&this.bHide_MiniRec_v_1&&(this.arrObjSelectRec[1].style.display="none",this.arrObjSelectRec[2].style.display="none")}}catch(e){dalert(e)}};this.setChecked_borderValue=function(c,b,d){try{var a=this.getBorderSelectionMiniRecById(c);null!=a&&(g_objPropTagCommon.setSelectedTableCustomStyle(),
b?this.isSelected(a)||this.select(a):this.isSelected(a)&&this.deselect(a),this.setMiniRecBorder(c,d))}catch(e){dalert(e)}};this.setMiniRecBorder=function(c,b){try{var d=this.arrID_MiniRec,a=this.arrObjMainRec;d[0]==c?(a[0].style.borderTop=b,a[1].style.borderTop=b):d[1]==c?(a[0].style.borderBottom=b,a[1].style.borderBottom=b,a[2].style.borderTop=b,a[3].style.borderTop=b):d[2]==c?(a[2].style.borderBottom=b,a[3].style.borderBottom=b):d[3]==c?(a[0].style.borderLeft=b,a[2].style.borderLeft=b):d[4]==c?
(a[0].style.borderRight=b,a[2].style.borderRight=b,a[1].style.borderLeft=b,a[3].style.borderLeft=b):d[5]==c&&(a[1].style.borderRight=b,a[3].style.borderRight=b)}catch(e){dalert(e)}};this.checkAll=function(){try{var c=this.arrObjMainRec[0].style.borderTop,b=this.arrObjMainRec[0].style.borderBottom,d=this.arrObjMainRec[0].style.borderLeft,a=this.arrObjMainRec[0].style.borderRight,e=this.arrObjMainRec[1].style.borderRight;return c!==this.arrObjMainRec[2].style.borderBottom||c!==d||c!==e||!this.bHide_MiniRec_h_1&&
c!==b||!this.bHide_MiniRec_v_1&&c!==a?!1:!0}catch(f){dalert(f)}};this.checkOuter=function(){try{var c=this.arrObjMainRec[0].style.borderTop,b=this.arrObjMainRec[0].style.borderLeft,d=this.arrObjMainRec[1].style.borderRight;return c===this.arrObjMainRec[2].style.borderBottom&&c===b&&c===d?!0:!1}catch(a){dalert(a)}};this.checkInner=function(){try{return this.arrObjMainRec[0].style.borderBottom===this.arrObjMainRec[0].style.borderRight?!0:!1}catch(c){dalert(c)}}};
var colorComboBoxUtil=function(){var f=this;this.strDisabledColor="#dedede";colorComboBoxUtil.prototype.makeNewColorComboBoxDiv=function(c,d,b){try{var a=document.createElement("div");a.id="colorComboBoxContainer_"+c;a.className=g_strSkin_ComboBox_Area;a.style.height="27px";a.style.width="48px";a.style.display="inline-block";d&&void 0!==d&&(a.style.width=d+"px");b&&void 0!==b&&(a.style.marginRight=b+"px");var e=document.createElement("table");e.cellPadding=0;e.cellSpacing=0;e.style.border=0;e.style.width=
a.style.width;e.style.tableLayout="fixed";var f=e.insertRow(),g=f.insertCell();g.id="colorComboBoxLabel_"+c;g.style.lineHeight=0;g.style.border=0;g.style.padding="4px";var h=document.createElement("div");h.id="colorComboBoxLabel_Sub_"+c;h.style.backgroundColor="#000000";h.style.height="19px";g.appendChild(h);var k=f.insertCell();k.style.width="20px";k.className=g_strSkin_ComboBox_AreaArrow;a.appendChild(e);return a}catch(l){dalert(l)}};colorComboBoxUtil.prototype.makeColorComboBoxHTML=function(c,
d,b){try{var a="";a+='<div id="colorComboBoxContainer_'+c+'" class="'+g_strSkin_ComboBox_Area+'" style="width:'+d+"px;";!1===fnObjectCheckNull(b)&&"number"===typeof b&&(a+="margin-right:"+b+"px;");a+='line-height:0;overflow:hidden;display:inline-block">';a+='<table style="border:0px;width:'+d+'px;line-height:0;table-layout:fixed;" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td id="colorComboBoxLabel_'+c+'" class="tbComboBox_AreaLabel_1" style="line-height:0;height:14px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding:3px;">';
a+='<div id="colorComboBoxLabel_Sub_'+c+'" style="height:16px;background-color:#000000;border:1px dotted #000000;"></div>';a+="</td>";a+='<td class="'+g_strSkin_ComboBox_AreaArrow+'" style="line-height:0;width:14px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;">';a+='<img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;">';a+="</td>";a+="</tr>";return a+"</table></div>"}catch(e){dalert(e)}};colorComboBoxUtil.prototype.getCallFunc=
function(c,d,b){return"TextBoxTextColor"!=c?function(a){duzon_dialog.closeExtendsDlg();f.clickColorComboBoxLayer(c,"");"undefined"!=typeof b&&b("");g_objPropTagCommon.setSelectedTableCustomStyle()}:function(a){duzon_dialog.closeExtendsDlg();f.clickColorComboBoxLayer(c,"#000000");"undefined"!=typeof b&&b("")}};colorComboBoxUtil.prototype.initColorComboBox=function(c,d,b){try{var a=g_objLayerKit.getElementById("colorComboBoxContainer_"+c);null!=a&&(a.onmouseover=function(a){g_objPropertyUtil.element_hasClass(this,
"disableStatus")||(this.className=g_strSkin_ComboBox_AreaOver)},a.onmouseout=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_Area)},a.onmousedown=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_AreaDown)},a.onmouseup=function(a){g_objPropertyUtil.element_hasClass(this,"disableStatus")||(this.className=g_strSkin_ComboBox_Area)},a.onclick=function(a){if(!g_objPropertyUtil.element_hasClass(this,
"disableStatus")){"undefined"==typeof b&&(b="TextBoxTextColor"!=c?[ID_RES_DIALOG_BTN_NOCOLOR,ID_RES_CONST_STRING_OTHER_COLOR]:[ID_RES_DIALOG_STRING_BASIC,ID_RES_CONST_STRING_OTHER_COLOR]);var e=[];b.forEach(function(b){switch(b){case ID_RES_DIALOG_BTN_NOCOLOR:case ID_RES_DIALOG_STRING_BASIC:e.push(f.getCallFunc(c,a,d));break;case ID_RES_CONST_STRING_OTHER_COLOR:e.push(function(){var a=f.getColorValue(c);duzon_dialog.viewDetailColorPicker(a,function(a){""!=a&&(duzon_dialog.closeExtendsDlg(),f.clickColorComboBoxLayer(c,
a),"undefined"!=typeof d&&d(a),g_objPropTagCommon.setSelectedTableCustomStyle())})})}});duzon_dialog.viewExtendsDlg(this,g_nActiveEditNumber,function(a){duzon_dialog.closeExtendsDlg();f.clickColorComboBoxLayer(c,a);"undefined"!=typeof d&&d(a,c);g_objPropTagCommon.setSelectedTableCustomStyle()},b,e,"",!1)}})}catch(e){dalert(e)}};colorComboBoxUtil.prototype.clickColorComboBoxLayer=function(c,d){try{g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+c).style.backgroundColor=d}catch(b){dalert(b)}};
colorComboBoxUtil.prototype.getColorValue=function(c){try{var d=g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+c).style.backgroundColor;return g_objCommonUtil.getHexColorCode(d)}catch(b){dalert(b)}};colorComboBoxUtil.prototype.setColorValue=function(c,d){try{g_objPropTagCommon.setSelectedTableCustomStyle(),g_objLayerKit.getElementById("colorComboBoxLabel_Sub_"+c).style.backgroundColor=d}catch(b){dalert(b)}};colorComboBoxUtil.prototype.setActive=function(c,d){try{var b=g_objLayerKit.getElementById("colorComboBoxContainer_"+
c);if(null!=b){var a=g_objLayerKit.getElementById("colorComboBoxLabel_"+c);null!=a&&(g_objPropTagCommon.setSelectedTableCustomStyle(),d?(b.style.backgroundColor="",a.style.backgroundColor="",g_objPropertyUtil.applyFilterOpacityStyle(b,!1,-1),g_objPropertyUtil.element_hasClass(b,"disableStatus")&&g_objPropertyUtil.element_removeClass(b,"disableStatus")):(b.style.backgroundColor=this.strDisabledColor,a.style.backgroundColor=this.strDisabledColor,g_objPropertyUtil.applyFilterOpacityStyle(b,!0,4),g_objPropertyUtil.element_hasClass(b,
"disableStatus")||g_objPropertyUtil.element_addClass(b,"disableStatus")))}}catch(e){dalert(e)}}},g_objColorComboBoxUtil=new colorComboBoxUtil;
var g_objCaretUtil=new function(){this.CARET_MARKER="dze_caret_marker";this.CARET_MARKER_START="dze_caret_marker_start";this.CARET_MARKER_END="dze_caret_marker_end";this.arrCaretMarkerClassName=[this.CARET_MARKER,this.CARET_MARKER_START,this.CARET_MARKER_END];this.ID_CURRENT_CARET="dze_page_caret_current_position";this.DZE_ONTEXT="dze_ontext";this.DZE_ONINPUT="dze_oninput";this.DZE_PAIR="dze_pair";this.ALIGN_TO_TOP=this.nEditNumber=0;this.ALIGN_TO_BOTTOM=1;this.bComposing=!1;this.arrCaretElementName=
["IMG","EMBED","OBJECT","BR"];this.caretPosHistory=[];this.arrNotMarkerClassName=["dze_page_container","dze_document_container","dze_document_main_container"];this.isComposing=function(a){try{return a&&"undefined"!==typeof a.isComposing?a.isComposing:this.bComposing}catch(c){dalert(c)}};this.isCollapsed=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var c=g_objEditWindow[a];return(c?c.getSelection():null).isCollapsed?!0:!1}catch(b){dalert(b)}};this.getPageNum=function(a){try{"undefined"===
typeof a&&(a=this.nEditNumber);var c={start:null,end:null},b=GetCurRange(a);if(!b)return c;a=g_objPageControl;c.start=a.getPageNum(b.startContainer);c.end=a.getPageNum(b.endContainer);return c}catch(d){dalert(d)}finally{}};this.exsistInPageNum=function(a,c){try{"undefined"===typeof a&&(a=this.nEditNumber);var b=GetCurRange(a);if(!b)return!1;a=g_objPageControl;return"undefined"===typeof a?!1:a.getPageNum(b.startContainer)<=c&&c<=a.getPageNum(b.endContainer)?!0:!1}catch(d){dalert(d)}finally{}};this.removeMarkerAttribute=
function(a){try{if(a&&"SPAN"===a.nodeName){var c=g_objNodeUtil,b=g_objPropertyUtil,d=a.id;d&&0<=d.indexOf("caret")&&c.removeAttribute(a,"id");b.removeClass(a,this.CARET_MARKER);b.removeClass(a,this.CARET_MARKER_START);b.removeClass(a,this.CARET_MARKER_END);c.removeAttribute(a,this.DZE_ONTEXT);c.removeAttribute(a,this.DZE_PAIR);return!0}}catch(e){dalert(e)}};this.removeAllCaretMarker=function(a){try{if(a){var c=a.querySelectorAll("span."+this.CARET_MARKER+", span."+this.CARET_MARKER_START+", span."+
this.CARET_MARKER_END);forEach(c,function(a,c){c&&c.parentNode&&(c.firstChild?this.removeMarkerAttribute(c):c.parentNode.removeChild(c))},this)}}catch(b){dalert(b)}};this.insertCaretMarker=function(a,c,b){try{if(!a||!c)return null;var d=a.commonAncestorContainer;if(!d)return null;var e=d.ownerDocument;if(!e)return null;var h=a.startContainer,g=a.endContainer;if(h&&"TR"===h.nodeName||g&&"TR"===g.nodeName)return null;if(h&&"BODY"===h.nodeName||g&&"BDOY"===g.nodeName)return dalert(""),null;d=g_objPropertyUtil;
if(d.hasClass(h,this.arrNotMarkerClassName)||d.hasClass(g,this.arrNotMarkerClassName))return dalert(""),null;var f=d=null,k=a.cloneRange(),n=h&&3===h.nodeType,q=g&&3===g.nodeType;"undefined"!==typeof b&&k.collapse(b);b=null;var l=k.collapsed;if(l){f=e.createElement("span");f.id=c;f.className=this.CARET_MARKER;f.setAttribute(this.DZE_ONTEXT,q);!1===fnObjectCheckNull(a.startContainer.classList)&&!0===a.startContainer.classList.contains("dze_shape_main")&&k.selectNode(a.startContainer);var m=a.startContainer.childNodes[a.startOffset]||
a.startContainer;g_objNodeUtil.isTextArea(m)&&f.setAttribute(this.DZE_ONINPUT,m.selectionStart+","+m.selectionEnd)}else{var t=g_objCommonUtil.getUniqueID();d=e.createElement("span");d.id=c;d.className=this.CARET_MARKER_START;d.setAttribute(this.DZE_PAIR,t);d.setAttribute(this.DZE_ONTEXT,n);k.collapse(!0);k.insertNode(d);(b=d.nextSibling)&&3===b.nodeType&&""===b.nodeValue&&b.parentNode.removeChild(b);f=e.createElement("span");f.id=c;f.className=this.CARET_MARKER_END;f.setAttribute(this.DZE_PAIR,t);
f.setAttribute(this.DZE_ONTEXT,q);k=a.cloneRange();k.collapse(!1)}k.insertNode(f);(b=f.nextSibling)&&3===b.nodeType&&""===b.nodeValue&&b.parentNode.removeChild(b);return{start:d,end:f,collapsed:l}}catch(u){dalert(u)}};this.removeCaretMarker=function(a,c,b){try{if(!a||!c)return null;var d=g_objEditorDocument[this.nEditNumber];if(!d)return null;var e=b?b:d.getElementById(c);if(!e)return null;b=g_objNodeUtil;var h=this,g=e.className&&e.className!==this.CARET_MARKER?!1:!0,f=e.className===this.CARET_MARKER_START?
!0:!1,k=null;g||(k=d.querySelector("#"+c+"."+(f?this.CARET_MARKER_END:this.CARET_MARKER_START)))||(g=!0);c=function(a,b){1===b.textNode.nodeType&&inArray(b.textNode.nodeName,h.arrCaretElementName)?a.setStartAfter(b.textNode):a.setStart(b.textNode,b.textOffset)};var n=function(a,b){1===b.textNode.nodeType&&inArray(b.textNode.nodeName,h.arrCaretElementName)?a.setEndAfter(b.textNode):a.setEnd(b.textNode,b.textOffset)},q={result:!0,inputSelection:null};if(g)if(this.isExistOnText(e)){var l=e.parentNode;
a.selectNodeContents(l);a.setEndAfter(e);var m=this.getTextCountInRange(a);e.parentNode.removeChild(e);b.normalize(l);a.selectNodeContents(l);q=this.getTextNodeFromOffset(m,a);c(a,q);a.collapse(!0)}else q.inputSelection=this.getInputSelection(e),a.selectNode(e),a.deleteContents();else{g=f?e:k;e=f?k:e;var t=this.isExistOnText(g),u=this.isExistOnText(e),v=g.parentNode,w=e.parentNode;k=f=0;var p=m=l=null,r=null;t&&u?(a.selectNodeContents(v),a.setEndAfter(g),f=this.getTextCountInRange(a),a.selectNodeContents(w),
a.setEndAfter(e),k=this.getTextCountInRange(a),v.removeChild(g),w.removeChild(e),b.normalize(v),b.normalize(w),a.selectNodeContents(v),l=this.getTextNodeFromOffset(f,a),a.selectNodeContents(w),m=this.getTextNodeFromOffset(k,a),c(a,l),n(a,m)):t&&!u?(a.selectNodeContents(v),a.setEndAfter(g),f=this.getTextCountInRange(a),v.removeChild(g),b.normalize(v),r=d.createRange(),r.selectNode(e),r.deleteContents(),a.selectNodeContents(v),l=this.getTextNodeFromOffset(f,a),c(a,l),a.setEnd(r.endContainer,r.endOffset)):
!t&&u?(a.selectNodeContents(w),a.setEndAfter(e),k=this.getTextCountInRange(a),w.removeChild(e),b.normalize(w),p=d.createRange(),p.selectNode(g),p.deleteContents(),a.selectNodeContents(w),m=this.getTextNodeFromOffset(k,a),a.setStart(p.startContainer,p.startOffset),n(a,m)):(p=d.createRange(),p.selectNode(g),p.deleteContents(),r=d.createRange(),r.selectNode(e),r.deleteContents(),a.setStart(p.startContainer,p.startOffset),a.setEnd(r.endContainer,r.endOffset));r=p=null}return q}catch(x){dalert(x)}};this.isExistOnText=
function(a){try{if(!a)return!1;var c="true"===a.getAttribute(this.DZE_ONTEXT)?!0:!1,b=a.previousSibling,d=a.nextSibling;a=null;var e=g_objNodeUtil;b&&3===b.nodeType&&!e.isIgnorable(b)?a=b:d&&3===d.nodeType&&!e.isIgnorable(d)&&(a=d);return a&&c}catch(h){dalert(h)}};this.getInputSelection=function(a){try{if(!a)return null;var c=a.getAttribute(this.DZE_ONINPUT);if(!c)return null;var b=a.nextSibling;if(!b||1!==b.nodeType||!("TEXTAREA"===b.nodeName||"INPUT"===b.nodeName&&0<=g_objNodeUtil.arrTextInputType.indexOf(b.type)))return null;
var d=c.split(",");return d&&2===d.length?{input:b,selectionStart:parseInt(d[0]),selectionEnd:parseInt(d[1])}:null}catch(e){dalert(e)}};this.getTextCountInRange=function(a){try{if(!a)return 0;var c=0,b=a.endContainer.childNodes[a.endOffset]||a.endContainer,d=g_objNodeUtil;d.traverseNodesInRange(a,function(a){if(!a||a===b)return!1;3!==a.nodeType||d.isIgnorable(a)?1===a.nodeType&&inArray(a.nodeName,this.arrCaretElementName)&&(c+=1):c+=a.nodeValue.length;return!0}.bind(this));return c}catch(e){dalert(e)}};
this.getTextNodeFromOffset=function(a,c){try{if(!c)return null;var b={textNode:null,textOffset:a},d=g_objNodeUtil;d.traverseNodesInRange(c,function(a){if(!a)return!1;var e=0;3!==a.nodeType||d.isIgnorable(a)?1===a.nodeType&&inArray(a.nodeName,this.arrCaretElementName)&&(e=1):(e=a.nodeValue.length,a.parentNode!==c.commonAncestorContainer&&(e=(e=a.nodeValue)?e.length:0));if(b.textOffset>e)return b.textOffset-=e,!0;if(b.textOffset===e&&a.parentNode!==c.commonAncestorContainer)return b.prevTextNode=a,
b.prevTextOffset=b.textOffset,b.textOffset-=e,!0;b.textNode=a;return!1}.bind(this));return b.textNode?b:b.prevTextNode?(b.textNode=b.prevTextNode,b.textOffset=b.prevTextOffset,b):null}catch(e){dalert(e)}};this.createMarkerId=function(a){var c=Math.random().toString(36).substr(2,9);return a?a+"_"+c:"dze_caret_marker_"+c};this.saveCaret=function(a,c){try{if("undefined"===typeof a||null===a)a=g_nActiveEditNumber;var b=g_objEditorDocument[a],d=b.defaultView;if(!d||!b)return null;this.nEditNumber=a;var e=
d.getSelection();if(!e)return null;a=null;c=c||this.ID_CURRENT_CARET;b=0;for(var h=e.rangeCount;b<h&&1>b;b++){var g=e.getRangeAt(b);g&&(a=this.insertCaretMarker(g,c),g=null)}return a}catch(f){dalert(f)}};this.restoreCaret=function(a,c){try{if("undefined"===typeof a||null===a)a=g_nActiveEditNumber;var b=g_objEditorDocument[a],d=b.defaultView;if(!d||!b)return!1;this.nEditNumber=a;c=c||this.ID_CURRENT_CARET;a=null;var e=b.getElementById(c);if(e){var h=b.createRange();if(a=this.removeCaretMarker(h,c,
e)){var g=a.inputSelection;if(g)g.input.focus({preventScroll:!0}),g.input.setSelectionRange(g.selectionStart,g.selectionEnd);else{var f=d.getSelection();f.removeAllRanges();f.addRange(h)}}}return a&&!0===a.result?!0:!1}catch(k){dalert(k)}};this.moveCaret=function(a,c,b){try{if(!a)return!1;var d=g_objNodeUtil,e=a.ownerDocument,h=e.defaultView.getSelection(),g=null,f=a,k=0;3===f.nodeType?(!1===b?k=f.nodeValue.length:!0===b||isNaN(b)?k=0:0<=k&&k<=f.nodeValue.length&&(k=b),g=e.createRange(),g.setStart(f,
k),g.setEnd(f,k),h.removeAllRanges(),h.addRange(g)):1!==f.nodeType||g_objNodeUtil.canSelectNodeContents(f)?(h=null,f=(h=!1===b?d.getLastTextNode(f):d.getFirstTextNode(f,!0))?h:f,h||!d.isCell(f)||f.firstChild||(f.innerHTML="<P><BR></P>",f=f.firstChild),b=!1===b?"end":"start","BR"===f.nodeName&&(b="end",h=null,f.previousSibling&&3===f.previousSibling.nodeType?h=f.previousSibling:(h=e.createTextNode(""),f.parentNode.insertBefore(h,f)),f=h),d.isCell(a)&&a!==d.getLoopParentElementByTagNames(f,d.arrCellTagName)&&
(f=a,b="start"),duzon_dialog.setFocusElement(f,this.nEditNumber,b)):(g=e.createRange(),g.selectNode(f),g.collapse(!1===b?!1:!0),h.removeAllRanges(),h.addRange(g));!1!==c&&this.scrollToCaret();return!0}catch(n){dalert(n)}finally{}};this.moveCaretFromPoint=function(a,c){try{var b=this.getRangeFromPoint(a,c);return b&&b.sc?SetCurRange(b.getRange()):!1}catch(d){dalert(d)}};this.moveCaretToClosetPageMain=function(a){try{var c=g_objEditorDocument[a],b=c?c.defaultView:null,d=b?b.getSelection():null;if(!d)return!1;
var e=0<d.rangeCount?d.getRangeAt(0):null;a=null;b=0;e?(a=e.startContainer,b=e.startOffset):(a=g_objPageControl.getPageMain(0),b=0);if(!a)return!1;for(var h=g_objNodeUtil;!h.isLoopBreakNode(a);)b=h.getChildIndex(a),a=a.parentNode;e=e||c.createRange();if(!e)return!1;e.setStart(a,b);e.setEnd(a,b);d.removeAllRanges();d.addRange(e);return!0}catch(g){dalert(g)}finally{}};this.moveCaretForRemovePage=function(a){try{var c=g_objEditWindow[this.nEditNumber],b=c?c.getSelection():null,d=b&&0<b.rangeCount?b.getRangeAt(0):
null;if(!d)return!1;c=g_objPageControl;var e=this.getPageNum(),h=e.start,g=e.end;if(h===a&&g===a){b=a+1;var f=c.getTotalPageCount();d=!1;b>=f&&(b=a-1,d=!0);g_objHeaderFooter.getHeaderFooterEditMode()?this.moveCaret(g_objHeaderFooter.getHeader(b)):this.moveCaret(c.getPageMain(b),!1,!d)}else if(h===a&&g>a){var k=c.getPageMain(h+1);k&&(d.setStart(k,0),b.removeAllRanges(),b.addRange(d))}else h<a&&g===a&&(k=c.getPageMain(g-1))&&(d.setEnd(k,k.childNodes.length),b.removeAllRanges(),b.addRange(d));return!0}catch(n){dalert(n)}finally{}};
this.scrollToCaret=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var c=GetCurRange(a);if(!c)return!1;var b=c.startContainer,d=c.startOffset,e=b.childNodes[d]||b;if(!g_objNodeUtil.getLoopBreakNode(e))return!1;if(!c.getBoundingClientRect)return this.scrollTo(e,a);var h=g_objPositionUtil,g=c.getBoundingClientRect();g=h.domRectToRect(g);if(h.isEmptyRect(g)){var f=b.childNodes[d];f&&"BR"===f.nodeName&&b.childNodes[d-1]&&(e=b.childNodes[d-1]);e||(e=b);return this.scrollTo(e,a)}var k=g_objEditorDocument[a].body.firstChild;
if(!k||"dze_document_main_container"!==k.id||!k)return!1;var n=k.scrollLeft,q=k.scrollTop;h.moveRect(g,n,q);var l=h.createRect(n,q,k.offsetWidth,k.offsetHeight);return this.setScroll(k,this.getScrollPos(g,l))}catch(m){dalert(m)}finally{}};this.scrollTo=function(a,c){try{if(a&&dzeUiConfig.bOfficePagingMode){"undefined"===typeof c&&(c=g_nActiveEditNumber);if(g_objNodeUtil.isHeaderFooterMain(a)||!g_objNodeUtil.getLoopBreakNode(a))return!1;var b=g_objEditorDocument[c].body.firstChild;if(!b||"dze_document_main_container"!==
b.id||!b)return!1;for(;1!==a.nodeType||"BR"===a.nodeName||"OPTION"===a.nodeName;)a=a.parentNode;if(g_objPropertyUtil.hasClass(a,"dze_hide_para")||a.style&&"none"===a.style.display)return!1;c=g_objPositionUtil;var d=g_objZoom.getDocZoomValue()/100,e=c.createRect(b.scrollLeft,b.scrollTop,b.offsetWidth,b.offsetHeight),h=c.createRect(c.getDocumentLeft(a)*d,c.getDocumentTop(a)*d,Math.max(a.offsetWidth,15)*d,Math.max(a.offsetHeight,15)*d);return this.setScroll(b,this.getScrollPos(h,e))}}catch(g){dalert(g)}};
this.getScrollPos=function(a,c){try{var b={left:null,top:null},d=30*(g_objZoom.getDocZoomValue()/100);a.bottom>c.bottom?b.top=Math.max(a.bottom-c.height+d,0):a.top<c.top&&(b.top=Math.max(a.top-d,0));a.right>c.right?b.left=Math.max(a.right-c.width+d,0):a.left<c.left&&(b.left=Math.max(a.left-d,0));return b}catch(e){dalert(e)}};this.setScroll=function(a,c){try{if(!a||!c)return!1;var b=!1;null!==c.top&&(a.scrollTop=c.top,b=!0);null!==c.left&&(a.scrollLeft=c.left,b=!0);return b}catch(d){dalert(d)}};this.scrollToPage=
function(a,c){try{if(!(!dzeUiConfig.bOfficePagingMode||0>a||a>=g_objPageControl.getTotalPageCount())){var b=g_objEditorDocument[this.nEditNumber].body.firstChild;if(b&&"dze_document_main_container"===b.id){var d=g_objPageControl.getPageNode(a),e=g_objZoom.getDocZoomValue()/100;a=-15*e;var h=b.offsetHeight,g=g_objPositionUtil.getDocumentTop(d)*e,f=g+Math.max(d.offsetHeight,15)*e;c===this.ALIGN_TO_TOP?b.scrollTop=Math.max(g+a,0):c===this.ALIGN_TO_BOTTOM&&(b.scrollTop=Math.max(f-h-a,0))}}}catch(k){dalert(k)}};
this.getCaretNormalContainer=function(a){var c=!1;if(window.getSelection)if((a=g_objEditWindow[a].getSelection())&&1==a.rangeCount)a=a.getRangeAt(0),c=a.collapsed;else return null;else{a=g_objEditorDocument[a].selection;if(fnObjectCheckNull(a))return null;a=a.createRange();if(fnObjectCheckNull(a))return null;""==a.htmlText&&(c=!0)}if(!c)return dlog("collapsed = false -> N/A!"),null;c="commonAncestorContainer"in a?a.commonAncestorContainer:a.parentElement().childNodes[0];if(!c)return dlog("no objAncestorNode -> N/A!"),
null;c.nodeType==ID_SELECTION_TEXT_NODE&&(c=c.parentNode);return c.nodeType!=ID_SELECTION_ELEMENT_NODE?(dlog("nodeType != 1 -> N/A!"),null):{objRange:a,objAncestorNode:c}};this.getRangeFromPoint=function(a,c){try{var b=g_objEditorDocument[this.nEditNumber],d=null;if(b.caretRangeFromPoint)d=b.caretRangeFromPoint(a,c);else if(b.caretPositionFromPoint){if((d=b.caretPositionFromPoint(a,c))&&d.offsetNode)return(new RangeProp).init(d.offsetNode,d.offset,d.offsetNode,d.offset)}else b.body.createTextRange&&
(d=this.getRangeFromPointForIE(a,c));if(!d)return null;var e=new RangeProp(d);return e.sc&&e.ec?e:null}catch(h){dalert(h)}finally{}};this.getRangeFromPointForIE=function(a,c){try{var b=g_objEditorDocument[this.nEditNumber],d=b.body.createTextRange();try{if(d.moveToPoint(a,c),d){var e=d.duplicate(),h=e.parentElement();if(h instanceof window.HTMLInputElement)return null;var g=d.duplicate();g.moveToElementText(h);g.setEndPoint("EndToEnd",e);return this.getRangeFromText(h.firstChild,g.text)}}catch(n){if(b.elementFromPoint)try{var f=
b.elementFromPoint(a,c),k=b.createRange();f&&inArray(f.nodeName,this.arrCaretElementName)?k.selectNode(f):k.selectNodeContents(f);k.collapse(!1);return k}catch(q){}}return null}catch(n){dalert(n)}finally{}};this.getRangeFromText=function(a,c){try{for(var b=g_objEditorDocument[this.nEditNumber],d=null,e=null;a;){if(3===a.nodeType){var h=a.nodeValue;if(h=h?h.replace(/\u00a0/g," "):null){var g=c.length;if(0>=g||c===h)return{startContainer:a,endContainer:a,startOffset:g,endOffset:g};for(var f=c,k=h,n=
f.length,q=k.length,l=0,m=0,t=null,u=null;l<n&&m<q;){t=f.charCodeAt(l);for(u=k.charCodeAt(m);(10===t||13===t)&&l<n;)t=f.charCodeAt(++l);for(;(10===u||13===u)&&m<q;)u=k.charCodeAt(++m);if(t!==u)break;l++;m++}var v=l;var w=m;if(v>=g)return{startContainer:a,endContainer:a,startOffset:w,endOffset:w};c=c.substring(v)}}else 1===a.nodeType&&(d=d||b.body.createTextRange(),d.moveToElementText(a),c=c.substring(d.text.length),d=null,e=a);a=a.nextSibling}var p=e&&"BR"===e.nodeName,r=e&&e.firstChild&&e.firstChild===
e.lastChild&&"BR"===e.firstChild.nodeName;return p||r?{startContainer:p?e.parentNode:e,endContainer:p?e.parentNode:e,startOffset:0,endOffset:0}:null}catch(x){dalert(x)}};this.isCollapsed=function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var c=g_objEditWindow[a];return(c?c.getSelection():null).isCollapsed?!0:!1}catch(b){dalert(b)}};this.isContentEditable=function(a){try{var c=GetCurRange(a);if(!c)return!1;for(var b=c.startContainer,d=c.endContainer;b&&1!==b.nodeType;)b=b.parentNode;for(;d&&
1!==d.nodeType;)d=d.parentNode;return b&&d?b.isContentEditable&&d.isContentEditable:!1}catch(e){dalert(e)}};this.canMove=function(a,c,b,d){var e=SelectionUtil;switch(d){case 37:return!e.isOnFirst(a,c,b);case 38:return!e.isOnFirstLine(a,c,b);case 39:return!e.isOnLast(a,c,b);case 40:return!e.isOnLastLine(a,c,b)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");function utilComboBox(){}utilComboBox.prototype.fnCallback={};utilComboBox.addCallback=function(a,b){try{Object.keys(this.prototype.fnCallback).some(function(a,b){}),this.prototype.fnCallback[a]=b}catch(c){dalert(c)}};
utilComboBox.callback=function(a,b,c){try{this.prototype.fnCallback[a](b,c)}catch(d){dalert(d)}};
utilComboBox.createTextType=function(a,b,c,d){try{var e=dzeJ(document.createElement("select"));e.attr({id:a,name:a});"string"===typeof b?e.addClass(b):Object.keys(b).forEach(function(a){e.css(a,b[a])});var f;c.forEach(function(a,b){f=dzeJ(document.createElement("option"));f.attr({index:b,value:a.value}).text(a.title);e.append(f[0])});"function"===typeof d&&this.addCallback(a,d);e.change(function(){utilComboBox.callback(a,1*dzeJ(this).attr("index"),this.value)});return e[0]}catch(g){dalert(g)}};
utilComboBox.createImageType=function(){};
utilComboBox.createImageTextType=function(a,b,c,d,e,f){try{var g=dzeJ("<div>").attr({id:a,"class":"dze_combobox_container"}),h=80,n=27;!1===fnObjectCheckNull(b)&&("string"===typeof b?g.addClass(b):Object.keys(b).forEach(function(a){"width"===a?(h=parseInt(b[a],10)-2,g.width(h),h-=18):"height"===a?(n=parseInt(b[a],10)-2,g.height(n)):g.css(a,b[a])}));var l=dzeJ("<table>",{cellspacing:0,cellpadding:0,style:"border: 0px;"}).append("<tbody>").append("<tr>").append("<tr>");g.append(l);var p=dzeJ(l).find("tr:first");
p.append("<td>").append("<td>");var k=dzeJ(p).find("td:first");k.attr("class","dze_combobox_selected_option");k.css({width:h+"px",height:n+"px","padding-right":"5px"});k=dzeJ(p).find("td:last");k.css({width:"18px",height:n+"px","text-align":"center","vertical-align":"middle"});k.append(dzeJ("<img>",{src:g_dzEditorBasePath+"image/toolbar/toolbar_buttonarrow.gif",style:"width: 5px; height: 5px;"}));p.click(function(){var a=g.find(".dze_combobox_options_list");if("none"===a.css("display")){if("true"!==
a.attr("set_position")){a.css({visibility:"hidden",display:"block"});var b=a[0].offsetLeft+u,c=a[0].offsetTop-1;a.attr("set_position",!0).css({left:b,top:c,visibility:"",display:"none"})}a.slideDown("fast")}else a.slideUp("fast")});var q=dzeJ("<div>").attr("class","dze_combobox_options_list");g.append(q);h+=18;var r=!1===fnObjectCheckNull(c.width)?parseInt(c.width,10):h,v=!1===fnObjectCheckNull(c.height)?parseInt(c.height,10):"",u=0>h-r?h-r-1:-1;q.css({width:r});l=dzeJ("<table>",{cellspacing:0,cellpadding:0,
style:"width: 100%"}).append("<tbody>");q.append(l);var m;d.forEach(function(b,d){l.find("tbody").append(dzeJ("<tr>").append(k=dzeJ("<td>")));m=dzeJ("<div>").attr({index:d,value:b.value,"class":"option_item"}).height(v);k.append(m);if(!1===fnObjectCheckNull(b.image)){var f=dzeJ("<img>",{src:b.image});f.css({"margin-right":"10px",position:"relative",top:"50%",transform:"translateY(-50%)"});m.append(f);!1===fnObjectCheckNull(c.image)&&("string"===typeof c.image?f.addClass(c.image):Object.keys(c.image).forEach(function(a){f.css(a,
c.image[a])}))}!1===fnObjectCheckNull(b.title)&&(d=dzeJ("<span>"),m.append(d),d.text(b.title),d.attr("class","option_title"),d.css({"font-size":"13px","font-family":"\ub9d1\uc740 \uace0\ub515","letter-spacing":"-0.7px"}));m.click(function(){var b=dzeJ(this).clone();!0!==e&&(b.removeClass("option_item").height(""),b.find("img").hide());b.appendTo(g.find(".dze_combobox_selected_option").empty());utilComboBox.callback(a,1*b.attr("index"),b.attr("value"));g.find(".dze_combobox_options_list").hide()})});
"function"===typeof f&&this.addCallback(a,f);return g[0]}catch(t){dalert(t)}};utilComboBox.prototype.addListener=function(a,b){};
var SelectionUtil={getCurRange:function(a){try{"undefined"===typeof a&&(a=g_nActiveEditNumber);var b=g_objEditorDocument[a],c=b?b.defaultView:null,d=c?c.getSelection():null;if(!d)return null;var g=d.rangeCount;if(0>=g)return null;if(1===g)return d.getRangeAt(0);if(1<g){var f=d.getRangeAt(0),e=d.getRangeAt(g-1),l=b.createRange();l.setStart(f.startContainer,f.startOffset);l.setEnd(e.endContainer,e.endOffset);return l}return null}catch(k){dalert(k)}},setCurRange:function(a){try{if(!a||!a.commonAncestorContainer)return!1;
var b=a.commonAncestorContainer.ownerDocument,c=b?b.defaultView:null,d=c?c.getSelection():null;if(!d)return!1;d.removeAllRanges();d.addRange(a);return!0}catch(g){dalert(g)}},isMultiSelected:function(a){try{var b=this.getCurRange(a);if(!b||b.collapsed)return!1;a=g_objNodeUtil;return a.getLoopHeaderFooterBody(b.startContainer)!==a.getLoopHeaderFooterBody(b.endContainer)?!0:!1}catch(c){dalert(c)}finally{}},isBoundContentsAllSelected:function(a){try{var b=this.getCurRange(a);if(!b||b.collapsed)return!1;
if(b.startContainer&&b.startContainer===b.endContainer){var c=b.startContainer;a=g_objNodeUtil;if(a.isBoundNode(c)&&("SPAN"!==c.nodeName||!g_objPropertyUtil.hasClass(c,"dze_shape_text_contents"))){for(var d=b.startOffset,g=b.endOffset,f=c.firstChild;f&&a.isDocFirstNode(f);)d=Math.max(0,d-1),f=f.nextSibling;for(var e=c.lastChild;e&&a.isDocLastNode(e);)g=Math.max(0,g+1),e=e.previousSibling;if(0===d&&g===c.childNodes.length)return!0}}return!1}catch(l){dalert(l)}finally{}},isSelectionOnCell:function(a){try{var b=
this.getCurRange(a);if(!b||b.collapsed)return!1;var c=b.startContainer.childNodes[b.startOffset]||b.startContainer,d=b.endContainer.childNodes[b.endOffset]||b.endContainer;if(!c||!d)return!1;a=g_objNodeUtil;var g=a.arrCellTagName,f=a.getLoopParentElementByTagNames(c,g),e=a.getLoopParentElementByTagNames(d,g);return(f||e)&&f!==e?!0:!1}catch(l){dalert(l)}finally{}},isDeleteDirectly:function(a){try{return this.isBoundContentsAllSelected(a)||this.isMultiSelected(a)||this.isSelectionOnCell(a)?!0:!1}catch(b){dalert(b)}},
deleteSelection:function(a,b){try{return this.isSelectionOnCell(a)?g_objTableOperation.deleteSelectionOnCell(a):this.isBoundContentsAllSelected(a)||this.isMultiSelected(a)?this.execDeleteCurSelection(a)?!0:!1:this.execDeleteCurSelection(a,b)}catch(c){dalert(c)}},execDeleteCurSelection:function(a,b){try{var c=GetCurRange(a);if(c){var d=this.execDeleteSelection(c,b);d&&(d.getRange(c),this.setCurRange(c));return d}}catch(g){dalert(g)}finally{}},execDeleteSelection:function(a,b){try{if(!a||a.collapsed)return null;
var c=new RangeArray(a);if(!c||c.collapsed())return null;var d=b&&!0===b.bDoNotExpandRange?!0:!1,g=b&&!0===b.bDoNotRemoveEmpty?!0:!1;a=g_objNodeUtil;var f=dzeUiConfig.bOfficePgOverflowVisible,e=c.getDocument(),l=c.getRangeCount(),k=c.getRangePropAt(0),m=c.getRangePropAt(l-1);d||(3===k.sc.nodeType&&0===k.so&&(k.so=a.getChildIndex(k.sc),k.sc=k.sc.parentNode),3===m.ec.nodeType&&m.eo===m.ec.nodeValue.length&&(m.eo=a.getChildIndex(m.ec)+1,m.ec=m.ec.parentNode));var h=k.clone();h.ec=m.ec;h.eo=m.eo;var n=
e.createRange();for(d=l-1;0<=d;d--)if(c.arrRangeProp[d].getRange(n),n.deleteContents(),f){var r=n.commonAncestorContainer;a.isPageMain(r)&&this.insertParaToEmptyBound(r)}var t=h.sc===h.ec;h.eo=t?h.so:0;var p=g?null:a.removeEmptyNode(null,h.sc);p&&!0===p.bDeleted&&(h.sc=p.offsetNode,h.so=p.offset);t?(h.ec=h.sc,h.eo=h.so):(p=g?null:a.removeEmptyNode(null,h.ec))&&!0===p.bDeleted&&(h.ec=p.offsetNode,h.eo=p.offset);h.sc&&h.sc.parentNode&&h.ec&&h.sc.nodeName===h.ec.nodeName&&h.sc.nextSibling===h.ec&&!h.sc.firstChild&&
0===h.eo&&a.isParagraph(h.sc)&&(h.sc.parentNode.removeChild(h.sc),h.sc=h.ec,h.so=h.eo);var q=this.insertParaToEmptyBound(h.sc)||a.insertBrIntoBlankPara(h.sc);this.insertParaToEmptyBound(h.ec)||a.insertBrIntoBlankPara(h.ec);h.ec=h.sc;h.eo=h.so;if(q){var u=e.createTextNode("");q.parentNode.insertBefore(u,q);n.selectNodeContents(u)}else if(3!==n.startContainer.nodeType||n.startContainer!==n.endContainer)h.isValid()?(n.setStart(h.sc,h.so),n.setEnd(h.sc,h.so)):dalert("invalid rangeprop");return new RangeProp(n)}catch(v){dalert(v)}finally{}},
insertParaToEmptyBound:function(a){try{if(!a||!a.parentNode)return null;var b=g_objNodeUtil;if(!b.isBoundNode(a))return null;var c=a.firstChild;if(b.isPageMain(a))for(;c&&(b.isDocFirstNode(c)||b.isDocLastNode(c));)c=c.nextSibling;if(!c){if(!dzeUiConfig.bOfficePgOverflowVisible&&b.isPageMain(a)&&a!==g_objPageControl.getPageMain(0))return null;var d=a.ownerDocument,g=d.createElement("P"),f=d.createElement("BR");g.appendChild(f);c=null;for(var e=a.lastChild;e&&b.isDocLastNode(e);)c=e,e=e.previousSibling;
c?a.insertBefore(g,c):a.appendChild(g)}return f}catch(l){dalert(l)}},existOnFirst:function(a,b){try{return a&&b?this.isOnFirst(a,b.startContainer,b.startOffset):!1}catch(c){dalert(c)}},existOnLast:function(a,b){try{return a&&b?this.isOnLast(a,b.endContainer,b.endOffset):!1}catch(c){dalert(c)}},isOnFirst:function(a,b,c){try{if(!a||!b||!a.contains(3===b.nodeType?b.parentNode:b))return!1;for(var d=g_objNodeUtil,g=g_objPropertyUtil,f=0,e=null,l=!0;b!==a.parentNode;){f=0;if(3===b.nodeType)1===c&&""===
b.nodeValue?c=0:0<b.nodeValue.length&&32===b.nodeValue.charCodeAt(0)&&1===c&&(c=0);else if(1===b.nodeType)for(e=b.firstChild;e;){if(1===e.nodeType&&"SPAN"===e.nodeName&&g.hasClass(e,"dze_shape_main"))f++;else if(3===e.nodeType&&0===e.nodeValue.length)f++;else if(1!==e.nodeType||"SPAN"!==e.nodeName||e.firstChild||e===b.firstChild&&e===b.lastChild)break;else f++;e=e.nextSibling}if(0<c-f){l=!1;break}if(d.isLoopBreakNode(b))break;c=d.getChildIndex(b);b=b.parentNode}return l}catch(k){dalert(k)}},isOnLast:function(a,
b,c,d){try{if(!a||!b||!a.contains(3===b.nodeType?b.parentNode:b))return!1;for(var g=g_objNodeUtil,f=0,e=null,l=!0;b!==a.parentNode;){f=0;if(3===b.nodeType)f=b.nodeValue.length,0<f&&32===b.nodeValue.charCodeAt(f-1)&&c===f&&--f;else if(1===b.nodeType&&(f=b.childNodes.length,0<f))for(e=b.lastChild;e;){if(1===e.nodeType&&"BR"===e.nodeName&&!0!==d)f--;else if(3===e.nodeType&&0===e.nodeValue.length)f--;else if(1!==e.nodeType||"SPAN"!==e.nodeName||e.firstChild||e===b.firstChild&&e===b.lastChild)break;else f--;
e=e.previousSibling}if(c<f){l=!1;break}if(g.isLoopBreakNode(b))break;c=g.getChildIndex(b)+1;b=b.parentNode}return l}catch(k){dalert(k)}},isOnFirstLine:function(a,b,c,d){try{if(!(a&&a.parentNode&&b&&b.parentNode)||a!==b&&!a.contains(3===b.nodeType?b.parentNode:b))return!1;if(this.isOnFirst(a,b,c))return!0;var g=g_objPositionUtil,f=d||this.getOffsetRect(b,c);if(g.isEmptyRect(f))return!1;var e=f.top,l=this.getTreeWalkerWalkedToNode(a,b);if(!l)return!1;var k=l.currentNode,m=null;if(3===k.nodeType&&k===
b&&(g.forEachCharRect(k,function(a,b){if(b&&b.top<e)throw m=!1,BreakException;},!1,c-2),!1===m))return!1;for(;k;){if(3===k.nodeType||1===k.nodeType&&"BR"===k.nodeName){if(g.forEachCharRect(k,function(a,b){if(b&&b.top<e)throw m=!1,BreakException;},!1),!1===m)return!1}else{var h=k.getBoundingClientRect();if(h&&h.top<e)return!1}k=l.previousNode()}return!0}catch(n){dalert(n)}},isOnLastLine:function(a,b,c,d){try{if(!(a&&a.parentNode&&b&&b.parentNode)||a!==b&&!a.contains(3===b.nodeType?b.parentNode:b))return!1;
if(this.isOnLast(a,b,c))return!0;var g=g_objPositionUtil,f=d||this.getOffsetRect(b,c);if(g.isEmptyRect(f))return!1;var e=f.bottom-3,l=this.getTreeWalkerWalkedToNode(a,b);if(!l)return!1;var k=l.currentNode,m=null;if(k===b&&3===k.nodeType&&(g.forEachCharRect(k,function(a,b){if(b&&b.top>=e)throw m=!1,BreakException;},!0,c),!1===m))return!1;for(k=l.currentNode;k;){if(3===k.nodeType||1===k.nodeType&&"BR"===k.nodeName){if(g.forEachCharRect(k,function(b,a){if(a&&a.top>=e)throw m=!1,BreakException;}),!1===
m)return!1}else{var h=k.getBoundingClientRect();if(h&&h.top>=e)return!1}k=l.nextNode()}return!0}catch(n){dalert(n)}},getTreeWalkerWalkedToNode:function(a,b){try{if(!a||!b)return null;var c=b.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,function(a){return b===a?NodeFilter.FILTER_ACCEPT:g_objNodeUtil.canCaretExistOn(a)},!1),d=c.firstChild();if(!d)return null;for(;d!==b;)if(d=c.nextNode(),!d)return null;return c.currentNode?c:null}catch(g){dalert(g)}},getOffsetRect:function(a,
b){try{if(!a||!a.parentNode)return g_objPositionUtil.getEmptyRect();var c=g_objPositionUtil,d=a.ownerDocument.createRange();d.setStart(a,b);d.setEnd(a,b);var g=c.domRectToRect(d.getBoundingClientRect());if(c.isEmptyRect(g)){var f=a.childNodes[b]||a.childNodes[b-1]||a;f&&3===f.nodeType?(d.selectNode(f),g=c.domRectToRect(d.getBoundingClientRect()),c.isEmptyRect(g)&&(f=f.parentNode)&&f.getBoundingClientRect&&(g=c.domRectToRect(f.getBoundingClientRect()))):f&&f.getBoundingClientRect&&(g=c.domRectToRect(f.getBoundingClientRect()))}if(c.isEmptyRect(g)){var e=
a.parentNode,l=g_objNodeUtil.getChildIndex(a);d.setStart(e,l);d.setEnd(e,l);g=c.domRectToRect(d.getBoundingClientRect())}return g}catch(k){return dalert(k),g_objPositionUtil.getEmptyRect()}finally{}},isOnInput:function(a){try{var b=g_objEditorDocument[a];if(!b)return null;var c=b.activeElement;return!c||1!==c.nodeType||"INPUT"!==c.nodeName&&"TEXTAREA"!==c.nodeName?null:c}catch(d){dalert(d)}},getRangeFirstChildChk:function(a,b){var c=!1;a=GetCurRange(a);var d=a.commonAncestorContainer,g=d.children;
if(1>d.childElementCount)return!1;!1===g_objPropertyUtil.element_hasClass(a.commonAncestorContainer,"dze_page_main")?(a=g[0],SelectionUtil.getRangeTextStyleChk(a,b)&&(c=!0)):(a=g[0],d=a.children,0<a.childElementCount&&(a=d[0],SelectionUtil.getRangeTextStyleChk(a,b)&&(c=!0)));return c},getRangeChildChk:function(a,b){try{var c=!1,d=GetCurRange(a);a=function(a){return g_objHeaderFooter.getHeaderFooterEditMode()!==g_objHeaderFooter.contains(a)?NodeFilter.FILTER_REJECT:"SPAN"===a.nodeName?NodeFilter.FILTER_ACCEPT:
NodeFilter.FILTER_SKIP};a.acceptNode=a;for(var g=g_objNodeUtil.createRangeWalker(d,NodeFilter.SHOW_ELEMENT,a),f=g.firstChild();f;){if(SelectionUtil.getRangeTextStyleChk(f,b))c=!0;else return!1;f=g.nextNode()}return c}catch(e){dalert(e)}finally{d=null}},getRangeTextStyleChk:function(a,b){var c=!1;if("SPAN"===a.nodeName&&!1===fnObjectCheckNull(a)){var d=a.style.fontWeight.toLowerCase(),g=a.style.fontFamily.toLowerCase(),f=a.style.fontStyle.toLowerCase(),e=a.style.textDecorationLine;e=void 0===a.style.textDecorationLine?
a.style.textDecoration.toLowerCase():e.toLowerCase();var l=a.style.fontSize.toLowerCase(),k=a.style.letterSpacing.toLowerCase(),m=b.toLowerCase();if(d===m||g===m||l===m||k===m||f===m||-1<e.indexOf(m)||"strikethrough"===m&&-1<e.indexOf("line-through"))c=!0;if(0<a.childNodes.length)for(d=a.childNodes,g=0;g<d.length;g++)f=d[g],"SPAN"===f.nodeName&&!1===fnObjectCheckNull(a)&&(c=this.getRangeTextStyleChk(f,b))}return c}},GetCurRange=SelectionUtil.getCurRange.bind(SelectionUtil),SetCurRange=SelectionUtil.setCurRange.bind(SelectionUtil);
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objListUtil=new function(){this.arrCustomULStyle=["dzeExtListStyleTriangle","dzeExtListStyleInnerCircle","dzeExtListStyleFillCircle","dzeExtListStyleDiamond","dzeExtListStyleHypon"];this.arrTextStyleName="fontFamily fontSize color fontWeight fontStyle textDecoration verticalAlign".split(" ");this.isParaNodeName=function(a){return"P"===a||"PRE"===a||this.isHeadNodeName(a)};this.isHeadNodeName=function(a){return"H1"===a||"H2"===a||"H3"===a||"H4"===a||"H5"===a};this.isListNodeName=function(a){return"OL"===
a||"UL"===a||"DL"===a};this.isListItemNodeName=function(a){return"LI"===a||"DT"===a||"DD"===a};this.isPara=function(a){return a&&1===a.nodeType&&this.isParaNodeName(a.nodeName)};this.isList=function(a){return a&&1===a.nodeType&&this.isListNodeName(a.nodeName)};this.isListItem=function(a){return a&&1===a.nodeType&&this.isListItemNodeName(a.nodeName)};this.getPreviousSibling=function(a){if(!a)return null;var b=a.previousSibling;b||"undefined"===typeof g_objSplitUtil||(b=g_objSplitUtil.getPreviousSplitSibling(a));
return b};this.getNextSibling=function(a){if(!a)return null;var b=a.nextSibling;b||"undefined"===typeof g_objSplitUtil||(b=g_objSplitUtil.getNextSplitSibling(a));return b};this.isULStyle=function(a){return"disc"===a||"circle"===a||"square"===a||this.isCustomULStyle(a)};this.isCustomULStyle=function(a){return a&&0<=this.arrCustomULStyle.indexOf(a)?!0:!1};this.isDefaultListStyle=function(a,b){return""===b||"OL"===a&&"decimal"===b||"UL"===a&&"disc"===b};this.getDefaultListStyle=function(a){return"OL"===
a?"decimal":"UL"===a?"disc":""};this.getDefaultListStyleArray=function(a){return"OL"===a?dzeUiConfig.applyOListStyleDepthItems:"UL"===a?dzeUiConfig.applyUListStyleDepthItems:null};this.getListInfo=function(a,b,c){try{if(!a||!a.parentNode||!this.isList(a))return null;c=c||{};var d=this.getRootList(a),e=this.getLevel(a),f=a.nodeName,g=this.getDefaultListStyleArray(f);c.list=a;c.rootList=d;c.nodeName=f;c.level=e;c.maxLevel=g?g.length:0;c.listItemCount=this.getListItemCount(a);if(b&&!0===b.style){f=a=
"";var h=this.getListStyleArray(d);h&&(0<=e&&e<h.length&&(a=h[e]),0<=e+1&&e+1<h.length&&(f=h[e+1]));c.style=a;c.nextStyle=f;c.nextNodeName=this.isULStyle(f)?"UL":"OL"}if(b&&!0===b.nextRootList){var k=this.getNextSibling(d);k&&k.nodeName===d.nodeName&&(c.nextRootList=k)}if(b&&!0===b.prevRootList){var l=this.getPreviousSibling(d);l&&l.nodeName===d.nodeName&&(c.prevRootList=l)}return c}catch(n){dalert(n)}};this.getListItemInfo=function(a,b){try{if(!this.isListItem(a))return null;var c=a.parentNode;if(!c||
!c.parentNode||!this.isList(c))return null;var d={};d.listItem=a;d.list=c;d.index=this.getIndex(a);return this.getListInfo(c,b,d)}catch(e){dalert(e)}};this.getListStyle=function(a){try{if(!this.isList(a))return"";var b=a.nodeName,c=a.style.listStyleType;if(!c&&"UL"===b){for(var d="",e=g_objPropertyUtil,f=0,g=this.arrCustomULStyle;f<g;f++)e.hasClass(a,this.arrCustomULStyle[f])&&(d=this.arrCustomULStyle[f]);if(d)return d}if(this.isDefaultListStyle(b,c))return this.getDefaultListStyle(b);"UL"!==b||this.isULStyle(c)||
(c=this.getDefaultListStyle("UL"));return c}catch(h){dalert(h)}};this.setListStyle=function(a,b){try{if(!this.isList(a))return!1;b=b||"";for(var c=g_objPropertyUtil,d=0,e=this.arrCustomULStyle.length;d<e;d++)c.removeClass(a,this.arrCustomULStyle[d]);if(this.isDefaultListStyle(a.nodeName,b))return a.style.listStyleType=this.getDefaultListStyle(a.nodeName),!0;0<=this.arrCustomULStyle.indexOf(b)&&(c.addClass(a,b),b="");"UL"!==a.nodeName||this.isULStyle(b)||(b="");a.style.listStyleType=b;""===b&&""===
a.style.cssText&&a.removeAttribute("style");return!0}catch(f){dalert(f)}};this.getLoopParentListItem=function(a,b){return g_objNodeUtil.getLoopParentElementByTagNames(a,g_objNodeUtil.arrListItemTagName,b)};this.getCurListItemsInRange=function(a,b){try{var c=[];b=b||{};var d=GetCurRange(a);if(!d)return c;var e=g_objNodeUtil,f="undefined"!==typeof g_objHeaderFooter?g_objHeaderFooter:null;a=SelectionUtil;var g=d.startContainer.childNodes[d.startOffset]||d.startContainer,h=d.endContainer.childNodes[d.endOffset-
1]||d.endContainer;if(!g||!h)return c;var k=!1===b.bCheckBound?!1:!0;if(!0===b.bStartEndLi&&!(this.isList(g)||this.getLoopParentListItem(g,k)||this.isList(h)||this.getLoopParentListItem(h,k)))return c;if(g.compareDocumentPosition(h)&Node.DOCUMENT_POSITION_PRECEDING){var l=g;g=h;h=l}var n=e.createRangeWalker(d,NodeFilter.SHOW_ELEMENT,function(a){if(1!==a.nodeType)var b=!1;else if("TABLE"===a.nodeName)b=!0;else{var c=(b=a.style)?b.position.toLowerCase():"";b=b&&("absolute"===c||"fixed"===c)&&e.isBlockNodeName(a.nodeName)||
"SPAN"===a.nodeName&&g_objPropertyUtil.hasClass(a,"dze_shape_text_contents")||"DIV"===a.nodeName&&g_objPropertyUtil.hasClass(a,"shape_textbox")?!0:!1}return!b||a.contains(3===g.nodeType?g.parentNode:g)||a.contains(3===h.nodeType?h.parentNode:h)?!a||1!==a.nodeType||"LI"!==a.nodeName&&"DT"!==a.nodeName&&"DD"!==a.nodeName?NodeFilter.FILTER_SKIP:f&&f.getHeaderFooterEditMode()!==f.contains(a)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT});if(!n)return c;var m=n.firstChild();
for(l=null;m;){c.push(m);l=n.nextNode();if(l===m)break;m=l}var p=0<c.length?c[0]:null;p&&a.isOnLast(p,d.startContainer,d.startOffset)&&c.splice(0,1);(p=0<c.length?c[c.length-1]:null)&&a.isOnFirst(p,d.endContainer,d.endOffset)&&c.splice(c.length-1,1);0===c.length&&(p=this.getLoopParentListItem(d.commonAncestorContainer,k))&&c.push(p);"undefined"!==typeof g_objSplitUtil&&g_objSplitUtil.expandSplitNodes(c);if(!0===b.bExceptSomeSelect){b=[];var r=this.getLoopParentListItem(g,k),t=this.getLoopParentListItem(h,
k);r&&!a.isOnFirst(r,d.startContainer,d.startOffset)&&0>b.indexOf(r)&&b.push(r);t&&a.isOnFirst(t,d.endContainer,d.endOffset)&&0>b.indexOf(t)&&b.push(t);forEach(b,function(a,b){a=c.indexOf(b);0<=a&&c.splice(a,1)},this)}return c}catch(q){dalert(q)}};this.getListStyleArray=function(a){try{if(!this.isList(a))return null;for(var b=[],c=this.getFirstLists(a),d=0,e=c.length;d<e;d++)b.push(this.getListStyle(c[d]));var f=this.getDefaultListStyleArray(a.nodeName);e=b.length;var g=f?f.length:-1;if(e<g){a:{try{if(!f||
!b||f.length<b.length){var h=-1;break a}a=0;for(var k=f.length-b.length;a<k;a++){c=!0;for(var l=0,n=b.length;l<n;l++)if(f[a+l]!==b[l]){c=!1;break}if(!0===c){h=a;break a}}h=-1;break a}catch(m){dalert(m)}h=void 0}if(0<=h)for(d=e,k=0;d<g;d++,k++)b[d]=f[(h+e+k)%g];else for(d=e;d<g;d++)b[d]=f[d]}return b}catch(m){dalert(m)}};this.getIndex=function(a){try{for(var b=-1;a;)this.isListItem(a)&&b++,a=this.getPreviousSibling(a);return b}catch(c){dalert(c)}};this.getListItemCount=function(a,b,c){try{if(!a)return 0;
for(var d=0,e=a.firstChild;e;)this.isListItem(e)&&(!0!==b||"none"!==e.style.display)&&d++,e=!0===c?e.nextSibling:this.getNextSibling(e);return d}catch(f){dalert(f)}};this.isFirstListItem=function(a){try{if(!this.isListItem(a)&&!this.isList(a.parentNode))return!1;for(var b=a.parentNode.firstChild;b;){if(this.isListItem(b))return b===a?!0:!1;b=this.getNextSibling(b)}return 0}catch(c){dalert(c)}};this.getLevel=function(a){try{for(var b=-1;a&&!g_objNodeUtil.isBoundNode(a);)this.isList(a)&&b++,a=a.parentNode;
return b}catch(c){dalert(c)}};this.getRootList=function(a){try{for(var b=null;a&&!g_objNodeUtil.isBoundNode(a);)this.isList(a)&&(b=a),a=a.parentNode;return b}catch(c){dalert(c)}};this.getDirectULChildren=function(a){try{for(var b=[],c=a?a.firstChild:null;c;)1===c.nodeType&&"UL"===c.nodeName&&b.push(c),c=c.nextSibling;return b}catch(d){dalert(d)}};this.setStart=function(a,b){try{if(!a||"OL"!==a.nodeName||isNaN(b)||0>=b)return!1;1===b?a.removeAttribute("start"):a.setAttribute("start",b);return!0}catch(c){dalert(c)}};
this.getStart=function(a){try{if(!a||"OL"!==a.nodeName)return-1;var b=a.getAttribute("start")||1;return parseInt(b,10)}catch(c){dalert(c)}};this.continueStart=function(a,b){if(!a||"OL"!==a.nodeName)return!1;b=this.getStart(b)+this.getListItemCount(b);return this.setStart(a,b)};this.getFirstLists=function(a){try{if(!this.isList(a))return[];"undefined"!==typeof g_objSplitUtil&&(a=g_objSplitUtil.getFirstSplitNode(a));var b=[],c=this.getLevel(a);b[c]=a;for(var d=[],e=a.firstChild;e||0<d.length;){e?this.isList(e)&&
d.push(e):e=d.shift().firstChild;this.isList(e)&&(c=this.getLevel(e),b[c]||(b[c]=e));if(!e)break;e=this.getNextSibling(e)}return b}catch(f){dalert(f)}};this.getFirstChildListArray=function(a){try{if(!this.isList(a))return[];for(var b=[],c=0;a;)this.isList(a)&&(b[c++]=a),a=a.firstChild;return b}catch(d){dalert(d)}};this.getLastChildListArray=function(a){try{if(!this.isList(a))return[];for(var b=[],c=0;a;)this.isList(a)&&(b[c++]=a),a=a.lastChild;return b}catch(d){dalert(d)}};this.getFirstListItem=function(a){try{if(!this.isList(a))return null;
for(var b=a.firstChild;b;){if(this.isListItem(b))return b;if(this.isList(b))b=b.firstChild;else break}return null}catch(c){dalert(c)}};this.getLastListItem=function(a){try{if(!this.isList(a))return null;for(var b=a.lastChild;b;){if(this.isListItem(b))return b;if(this.isList(b))b=b.lastChild;else break}return null}catch(c){dalert(c)}};this.getNextListItem=function(a){try{if(!this.isList(a.parentNode))return null;for(var b=a.nodeName,c=null;a;){if((c=this.getNextSibling(a))&&c.nodeName===b)return c;
if(c&&this.isList(c))return this.getFirstListItem(c);if(c)break;else a=a.parentNode}return null}catch(d){dalert(d)}};this.getPreviousListItem=function(a){try{if(!this.isList(a.parentNode))return null;for(var b=a.nodeName,c=null;a;){if((c=this.getPreviousSibling(a))&&c.nodeName===b)return c;if(c&&this.isList(c))return this.getLastListItem(c);if(c)break;else a=a.parentNode}return null}catch(d){dalert(d)}};this.mergeRootList=function(a,b,c,d){try{if(!(this.isList(a)&&this.isList(b)&&a.parentNode&&b.parentNode))return!1;
for(var e=this.getLastChildListArray(a),f=this.getFirstChildListArray(b),g=Math.max(e.length,f.length)-1;0<=g;g--){var h=e[g],k=f[g];if(h&&k&&this.mergeList(h,k,c,d)){var l=this.getDirectULChildren(h);for(a=0;a+1<l.length;a++)this.getNextSibling(l[a])===l[a+1]&&this.mergeList(l[a],l[a+1],!0,!0)&&(l[a+1]=l[a])}}return!0}catch(n){dalert(n)}};this.mergSiblingList=function(a,b,c){try{if(!this.isList(a))return null;!1!==b&&(a=this.mergePreviousList(a));!1!==c&&(a=this.mergeNextList(a));return a}catch(d){dalert(d)}};
this.mergePreviousList=function(a){try{for(var b=g_objNodeUtil,c=null;a;)if(c=this.getPreviousSibling(a),this.isList(c)&&this.isList(a)&&c.nodeName===a.nodeName)b.moveNodesTo(c,a.firstChild),a.parentNode.removeChild(a),a=c;else break;return a}catch(d){dalert(d)}};this.mergeNextList=function(a){try{for(var b=g_objNodeUtil,c=null;a;)if(c=this.getNextSibling(a),this.isList(a)&&this.isList(c)&&a.nodeName===c.nodeName)b.moveNodesTo(a,c.firstChild),c.parentNode.removeChild(c);else break;return a}catch(d){dalert(d)}};
this.mergeList=function(a,b,c,d){try{if(!(a&&b&&this.isList(a)&&this.isList(b)))return!1;var e=a.ownerDocument,f=null;if(!0===c&&a.nodeName!==b.nodeName||!0===d&&this.getListStyle(a)!==this.getListStyle(b))return!1;f=e.createDocumentFragment();g_objNodeUtil.moveNodesTo(f,b.firstChild);a.appendChild(f);b.parentNode&&b.parentNode.removeChild(b);return!0}catch(g){dalert(g)}};this.arrangeList=function(a,b){try{if("UL"===a.nodeName){var c=a.className,d=b.className;if(!fnObjectCheckNull(c)&&""!==c&&c!==
d)return!1}if(dzeJ(a).css("list-style-type")!==dzeJ(b).css("list-style-type"))return!1;for(;b.hasChildNodes();)a.appendChild(b.firstChild);b.parentNode.removeChild(b);b=[];for(c=0;c<a.childNodes.length-1;c++){var e=a.childNodes[c];var f=e.nodeName;"OL"!==f&&"UL"!==f||f!==a.childNodes[c+1].nodeName||(-1===b.indexOf(e)&&b.push(e),b.push(a.childNodes[c+1]))}var g=b.length-1;if(1<b.length)for(c=0;c<g;c++){var h=b[c];var k=b[c+1];fnObjectCheckNull(h)||fnObjectCheckNull(k)||h.nodeName===k.nodeName&&this.arrangeList(h,
k)&&(b[c+1]=h)}return!0}catch(l){dalert(l)}};this.replaceAllParaWithListItem=function(a){try{if(a){var b=a.ownerDocument,c=null,d=g_objNodeUtil,e=a.querySelectorAll("ol>p, ul>p");e=[].slice.call(e);e.forEach(function(a){c||(c=b.createDocumentFragment());d.moveNodesTo(c,a.firstChild);var e=this.isListItem(a.previousSibling)?a.previousSibling.cloneNode(!1):a.parentNode&&"DL"===a.parentNode.nodeName?b.createElement("DD"):b.createElement("LI");e.appendChild(c);a.parentNode.replaceChild(e,a)}.bind(this))}}catch(f){dalert(f)}};
this.removeFirstLastBlankLi=function(a){try{if(!this.isList(a))return!1;for(var b=g_objNodeUtil,c=a.firstChild,d=c.nextSibling;c&&d;){if(this.isListItem(c)&&b.isBlankPara(c))c.parentNode.removeChild(c);else break;c=d;d=c.nextSibling}c=a.lastChild;for(d=c.previousSibling;c&&d;){if(this.isListItem(c)&&b.isBlankPara(c))c.parentNode.removeChild(c);else break;c=d;d=c.previousSibling}return!0}catch(e){dalert(e)}};this.replaceWithLI=function(a){try{var b=a.ownerDocument.createElement("LI");this.copyAttribute(b,
a);g_objNodeUtil.moveNodesTo(b,a.firstChild);a.parentNode.replaceChild(b,a);return b}catch(c){dalert(c)}};this.replaceWithPara=function(a,b){try{if(!this.isListItem(a))return null;b=b||"P";if(!this.isParaNodeName(b))return null;var c=g_objNodeUtil,d=a.ownerDocument,e=this.getRootList(a).parentNode,f=this.getLevel(a),g=d.createElement(b);this.copyAttribute(g,a);0<f&&(g.style.paddingLeft="",g.style.marginLeft=20*f+20+"px");c.splitOn(e,a,function(a){g_objListUtil.onSplit(a)});var h=d.createDocumentFragment();
c.moveNodesTo(h,a.firstChild);g.appendChild(h);a.parentNode.replaceChild(g,a);this.setChildTextStyle(g,this.getTextStyle(g));a=0;for(var k=this.arrTextStyleName.length;a<k;a++)g.style[this.arrTextStyleName[a]]="";""===g.style.cssText&&g.removeAttribute("style");c.insertBrIntoBlankPara(g);return g}catch(l){dalert(l)}};this.replaceWithOL=function(a,b,c){return this.isPara(a)?this.replaceWithListFromPara(a,"OL",b,c):this.isList(a)?this.replaceWithList(a,"OL",b,c):this.isListItem(a)?this.replaceWithListFromListItem(a,
"OL",b,c):null};this.replaceWithUL=function(a,b){return this.isPara(a)?this.replaceWithListFromPara(a,"UL",b):this.isList(a)?this.replaceWithList(a,"UL",b):this.isListItem(a)?this.replaceWithListFromListItem(a,"UL",b):null};this.replaceWithList=function(a,b,c,d){try{var e=g_objNodeUtil,f=null;f="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getSplitNodes(a):[a];for(var g=null,h=null,k=null,l=null,n=a.ownerDocument,m=n.createDocumentFragment(),p=0,r=f.length;p<r;p++)if(h=f[p],h.parentNode){h.nodeName!==
b?(k=n.createElement(b),this.copyAttribute(k,h),e.moveNodesTo(m,h.firstChild),k.appendChild(m),h.parentNode.replaceChild(k,h)):k=h;if("OL"===b||"UL"===b){var t=k.childNodes,q=null;p=0;for(r=t.length;p<r;p++)q=t[p],1!==q.nodeType||"DD"!==q.nodeName&&"DT"!==q.nodeName||this.replaceWithLI(q)}"undefined"!==typeof c?this.setListStyle(k,c):this.followListStyle(k);this.setStart(k,d);l=k.firstChild;this.mergeRootList(this.getPreviousSibling(l.parentNode),l.parentNode,!0,!0);this.mergeRootList(l.parentNode,
this.getNextSibling(l.parentNode),!0,!0);null===g&&h===a&&(g=l.parentNode)}return g}catch(u){dalert(u)}};this.replaceWithListFromListItem=function(a,b,c,d,e,f){try{var g=g_objNodeUtil,h=a.ownerDocument;"OL"!==b&&"UL"!==b||"DD"!==a.nodeName&&"DT"!==a.nodeName||(a=this.replaceWithLI(a));var k=a.parentNode,l=k.parentNode,n=h.createElement(b);this.copyAttribute(n,k);g.splitOn(l,a,function(a){g_objListUtil.onSplit(a)});this.copySplitAttribute(n,a.nextSibling);a.parentNode.replaceChild(n,a);n.appendChild(a);
null!==c&&"undefined"!==typeof c?this.setListStyle(n,c):this.followListStyle(n);this.setStart(n,d);!1!==e&&(n=a.parentNode,this.mergeRootList(this.getPreviousSibling(n),n,!0,!0));!1!==f&&(n=a.parentNode,this.mergeRootList(n,this.getNextSibling(n),!0,!0));return a}catch(m){dalert(m)}};this.replaceWithListFromPara=function(a,b,c,d){try{if(!this.isPara(a)||!a.parentNode||!this.isListNodeName(b))return null;var e=g_objNodeUtil,f=a.ownerDocument,g=f.createElement(b),h=f.createElement("DL"===b?"DD":"LI"),
k=g;g.appendChild(h);this.copyAttribute(h,a);this.setTextStyle(h,this.getChildSameTextStyle(a));"undefined"!==typeof c&&this.setListStyle(g,c);this.setStart(g,d);d=0;for(var l=g_objCommonUtil.toPx(a.style.marginLeft)||0;20<=l;)l-=20,d++;for(var n=[].slice.call(a.childNodes),m=null,p=0,r=n.length;p<r;p++)if((m=n[p])&&1===m.nodeType&&"SPAN"===m.nodeName&&g_objPropertyUtil.hasClass(m,"tabSpan"))m.parentNode.removeChild(m),d++;else if(!m||1!==m.nodeType||"SPAN"!==m.nodeName||!g_objPropertyUtil.hasClass(m,
"dze_shape_main"))if(!m||3!==m.nodeType||""!==m.nodeValue)if(!m||1!==m.nodeType||"SPAN"!==m.nodeName||!g_objPropertyUtil.hasClass(m,g_objCaretUtil.arrCaretMarkerClassName))break;if(0<d){h.style.paddingLeft="";h.style.marginLeft=0===l?"":l+"px";""===h.style.cssText&&h.removeAttribute("style");var t=this.getLastChildListArray(this.getPreviousSibling(a)),q=k;for(p=d;0<p;p--)k=t[p]?t[p].cloneNode(!1):f.createElement(b),k.appendChild(q),q=k}var u=f.createDocumentFragment();e.moveNodesTo(u,a.firstChild);
h.appendChild(u);a.parentNode.replaceChild(k,a);for(q=g;q!==k;)(!c||c&&q!==g)&&this.followListStyle(q),q=q.parentNode;k=this.getRootList(h);this.mergeRootList(this.getPreviousSibling(k),k,!0);k=this.getRootList(h);this.mergeRootList(k,this.getNextSibling(k),!0);return h}catch(v){dalert(v)}};this.onSplit=function(a){try{this.removeEmptyList(a.previousSibling);this.removeEmptyList(a.nextSibling);var b=a.previousSibling,c=a.nextSibling;b&&"OL"===b.nodeName&&c&&"OL"===c.nodeName&&b.style.listStyleType===
c.style.listStyleType&&this.continueStart(c,b)}catch(d){dalert(d)}};this.removeEmptyList=function(a){this.isList(a)&&!a.firstChild&&a.parentNode.removeChild(a)};this.copyAttribute=function(a,b){try{var c=g_objNodeUtil.copyAttribute(a,b);if(this.isList(a)){var d=a.nodeName;"UL"!==d&&"DL"!==d||a.removeAttribute("start");"UL"!==d||this.isULStyle(a.style.listStyleType)||(a.style.listStyleType="",""===a.style.cssText&&a.removeAttribute("style"))}var e=a.style.textAlign;this.isListItem(a)?a.style.listStylePosition=
"center"===e||"right"===e?"inside":"":a.style.listStylePosition="";""===a.style.cssText&&a.removeAttribute("style");return c}catch(f){dalert(f)}};this.copySplitAttribute=function(a,b){try{if(!(a&&b&&a.hasAttribute&&b.hasAttribute))return!1;if("undefined"!==typeof g_objSplitUtil){var c=g_objSplitUtil.DZE_SPLIT,d=g_objSplitUtil.DZE_SPLIT_CHILD;b.hasAttribute&&b.hasAttribute(c)&&a.setAttribute(c,b.getAttribute(c));b.hasAttribute(d)&&a.setAttribute(d,b.getAttribute(d));return!0}return!1}catch(e){dalert(e)}};
this.setTextStyle=function(a,b){try{Object.keys(b).forEach(function(c){a.style[c]=b[c]})}catch(c){dalert(c)}};this.textNodefilter=function(a){return"undefined"!==typeof g_objSelectedShapesArray&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()||!g_objPropertyUtil.hasClass(a,"dze_shape_main")?3!==a.nodeType?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT};this.setChildTextStyle=function(a,b){try{var c=Object.keys(b);if(0===c.length)return!1;
var d=a.ownerDocument,e=d.createTreeWalker(a,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,this.textNodefilter,!0),f=this,g=e.firstChild();for(a=null;g;){a=e.nextNode();var h=g.parentNode;g_objNodeUtil.isInlineNode(h)||(h=d.createElement("SPAN"),g.parentNode.replaceChild(h,g),h.appendChild(g));c.forEach(function(a){f.isDefaultTextStyle(a,h.style[a])&&h.style[a]!==b[a]&&(h.style[a]=b[a])});g=a}return!0}catch(k){dalert(k)}};this.getTextStyle=function(a){try{for(var b={},c="",d="",e=null,f=0,g=this.arrTextStyleName.length;f<
g;f++){c=this.arrTextStyleName[f];d="";if(3===a.nodeType)for(e=a.parentNode;e&&""===d&&!g_objNodeUtil.isBoundNode(e);)d=this.getTextStyleValue(e,c),e=e.parentNode;else d=this.getTextStyleValue(a,c);d&&(b[c]=d)}return b}catch(h){dalert(h)}};this.getTextStyleValue=function(a,b){try{if(!a||1!==a.nodeType)return"";var c=a.nodeName,d=a.style[b];if(""===d&&this.isHeadNodeName(c)){if("fontSize"===b)return"H1"===c?"21pt":"H2"===c?"18pt":"H3"===c?"15pt":"H4"===c?"12pt":"H5"===c?"10pt":"";if("fontWeight"===
b)return"bold"}return d}catch(e){dalert(e)}};this.isDefaultTextStyle=function(a,b){return!b||""===b||"normal"===b||"none"===b||"verticalAlign"===a&&"baseline"===b||"color"===a&&"baseline"===b||"fontSize"===a&&b===g_strBodyFontSize||"fontFamily"===a&&b===g_strBodyFontFamily?!0:!1};this.deleteDefaultTextStyle=function(a){try{for(var b="",c="",d=0,e=this.arrTextStyleName.length;d<e;d++)b=this.arrTextStyleName[d],(c=a[b])&&this.isDefaultTextStyle(b,c)&&delete a[b];return a}catch(f){dalert(f)}};this.mergeTextStyle=
function(a,b){for(var c={},d,e=0,f=this.arrTextStyleName.length;e<f;e++)d=this.arrTextStyleName[e],a[d]&&b[d]&&a[d]===b[d]&&(c[d]=b[d]);return c};this.getChildSameTextStyle=function(a){try{var b=a.ownerDocument.createTreeWalker(a,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,this.textNodefilter,!0),c=null;for(a=b.firstChild();a;){if(c){var d=this.getTextStyle(a);c=this.mergeTextStyle(c,d)}else c=this.getTextStyle(a);a=b.nextNode()}c&&(c=this.deleteDefaultTextStyle(c));return c||{}}catch(e){dalert(e)}};
this.followListStyle=function(a){try{if(!this.isList(a))return!1;var b=this.getPreviousList(a),c=this.getListStyle(b);if(!c){var d=this.getLevel(a),e=this.getDefaultListStyleArray(a.nodeName);e&&e[d]&&(c=e[d])}this.setListStyle(a,c);return!0}catch(f){dalert(f)}};this.getListFilter=function(a,b){var c=this;return function(d){if(!c.isList(d)||a&&d.nodeName!==a)return NodeFilter.FILTER_SKIP;if(!isNaN(b)){d=c.getLevel(d);if(d>b)return NodeFilter.FILTER_REJECT;if(d<b)return NodeFilter.FILTER_SKIP}return NodeFilter.FILTER_ACCEPT}};
this.getPreviousList=function(a){try{if(!this.isList(a))return null;var b=a.ownerDocument,c=this.getRootList(a),d=this.getLevel(a),e=null;e="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getSplitNodes(c):[c];for(var f=c=null,g=null,h=0,k=e.length;h<k;h++)for(c=b.createTreeWalker(e[h],NodeFilter.SHOW_ELEMENT,this.getListFilter(a.nodeName,d),!0),f=c.firstChild();f;){if(f===a)return g&&g!==a?g:null;g=f;f=c.nextNode()}return null}catch(l){dalert(l)}};this.getLastChildList=function(a,b,c){try{if(!this.isList(a)||
isNaN(c))return null;var d=a.ownerDocument,e=null;e="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getSplitNodes(a):[a];for(var f=a=null,g=null,h=0,k=e.length;h<k;h++)for(a=d.createTreeWalker(e[h],NodeFilter.SHOW_ELEMENT,this.getListFilter(b,c),!0),f=a.firstChild();f;)g=f,f=a.nextNode();return g}catch(l){dalert(l)}};this.findPreviousList=function(a){function b(a){if(!a)return null;var b=g_objListUtil.getPreviousSibling(a);if(b)return b;if(g_objNodeUtil.isCell(a))return g_objTableFunction.getFindUpDownCell(a,
!0);if(g_objNodeUtil.isCell(a.parentNode)){var c=g_objTableFunction;for(b=c.getFindUpDownCell(a.parentNode,!0);b&&!b.lastChild;)b=c.getFindUpDownCell(b,!0);return b?b.lastChild:null}if(a&&g_objNodeUtil.isPageMain(a.parentNode)&&(c=g_objPageControl,"undefined"!==typeof c)){for(b=c.getPageMain(c.getPageNum(a.parentNode)-1);b&&!b.lastChild;)b=c.getPageMain(c.getPageNum(b)-1);return b?b.lastChild:null}return null}try{if(!this.isList(a))return null;for(var c=this.getRootList(a),d=this.getLevel(a),e=a.nodeName,
f=this.getListFilter(e,d),g=c;g;){if(0===d&&g!==a&&f(g)===NodeFilter.FILTER_ACCEPT)return g;if(0<d&&this.isList(g)&&(prevList=g===c?this.getPreviousList(a):this.getLastChildList(g,e,d)))return prevList;g=b(g)}return null}catch(h){dalert(h)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,b){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(d.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,b,c){if(d){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in b||(b[e]={});b=b[e]}a=a[a.length-1];c=b[a];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
var nOutlineCount=0,outlineUtil=function(){this.arrStrID_Outline_Line=this.arrStrID_Outline_Rectangle=this.arrObjContainer=this.rootContaienr=this.arrObj_Outline_Line=this.arrObj_Outline_Rectangle=null;this.nOutline_Basis_Min_Line=6;this.nOutline_Basis_Min_Center_Rectangle=30;this.bSkipSolidDotted=!1;this.indicatorWidth=7;outlineUtil.prototype.initializeExtOutline=function(a){try{var d=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_outline_image");null!==d&&d.parentNode.removeChild(d);
var b=document;a&&dzeEnvConfig.iFrameLayer&&(b=g_objLayerKit.getLayerDocument());this.arrObj_Outline_Rectangle=[];for(a=0;8>a;a++)this.arrObj_Outline_Rectangle[a]=null;this.arrObj_Outline_Line=[];for(a=0;4>a;a++)this.arrObj_Outline_Line[a]=null;this.arrObjContainer=[];var c=g_objCommonUtil.getTimeCodeString()+"_"+nOutlineCount;nOutlineCount++;this.arrStrID_Outline_Rectangle=[];for(a=0;8>a;a++)this.arrStrID_Outline_Rectangle[a]="outline_rect_"+c+"_"+a;this.arrStrID_Outline_Line=[];for(a=0;4>a;a++)this.arrStrID_Outline_Line[a]=
"outline_line_"+c+"_"+a;c="";var e=g_bDocType_XHTML;d=!0;g_bBrowserType_IE&&6>=g_bBrowserVerInfo&&(d=!1);g_bBrowserType_IE&&!e&&(d=!1);var f=document.createElement("div");f.id="dze_outline_image";g_objPageControl.documentContainerNode.parentNode.appendChild(f);this.rootContaienr=b=f;var l=function(a,c,d){a=g_objInsertUtil.insertLayerHTML(a,b);f.appendChild(a);if(!a)return a;var e=void 0===a.children[0]?a:a.children[0];"line"===d?this.arrObj_Outline_Line[c]=e:this.arrObj_Outline_Rectangle[c]=e;return this.arrObjContainer.push(a)}.bind(this);
e=!1;"undefined"!==typeof objOnefficeLoader&&!0===objOnefficeLoader.m_bHybrid&&(e=!0);for(a=0;8>a;a++)if(c=d?e?'<div id="'+this.arrStrID_Outline_Rectangle[a]+'" style="display:none;position:absolute;z-index:20008;width:'+this.indicatorWidth+"px;height:"+this.indicatorWidth+'px;border:1px solid #1c90fb;background-color:#ffffff;border-radius:50%"></div>':'<div id="'+this.arrStrID_Outline_Rectangle[a]+'" style="display:none;position:absolute;z-index:20008;width:'+this.indicatorWidth+"px;height:"+this.indicatorWidth+
'px;border:1px solid #7F7F7F;background-color:#ffffff"></div>':'<img id="'+this.arrStrID_Outline_Rectangle[a]+'" src="'+g_strBlankImageData+'" width="5" height="5" border="0" alt="" style="display:none;position:absolute;z-index:20008;width:5px;height:5px;border:1px solid #7F7F7F;background-color:#ffffff;" />',!l(c,a,"rect"))return;for(a=0;4>a&&(c=0==a||2==a?d?'<div id="'+this.arrStrID_Outline_Line[a]+'" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:1px solid #7F7F7F;border-top:0px;border-right:0px;border-bottom:0px;"></div>':
'<img id="'+this.arrStrID_Outline_Line[a]+'" src="'+g_strBlankImageData+'" alt="" style="display:none;position:absolute;z-index:20007;width:1px;border-left:1px solid #7F7F7F;border-top:0px;border-right:0px;border-bottom:0px;" />':d?'<div id="'+this.arrStrID_Outline_Line[a]+'" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:0px;border-top:1px solid #7F7F7F;border-right:0px;border-bottom:0px;"></div>':'<img id="'+this.arrStrID_Outline_Line[a]+'" src="'+g_strBlankImageData+
'" alt="" style="display:none;position:absolute;z-index:20007;width:1px;height:1px;border-left:0px;border-top:1px solid #7F7F7F;border-right:0px;border-bottom:0px;"></div>',l(c,a,"line"));a++);}catch(h){dalert(h)}};outlineUtil.prototype.finalize=outlineUtil.prototype.unload=function(){try{var a=this.arrObjContainer;if(a){for(var d=null,b=a.length-1;0<=b;b--)(d=a[b])&&d.parentNode&&d.parentNode.removeChild(d);this.arrObjContainer=null}}catch(c){dalert(c)}};outlineUtil.prototype.getDocument=function(){return this.rootContaienr?
this.rootContaienr.ownerDocument:document};outlineUtil.prototype.showExtOutline=function(a,d,b,c,e,f,l,h,m){try{for(var g=0;8>g;g++)if(null==this.arrObj_Outline_Rectangle[g])return!1;for(g=0;4>g;g++){if(null==this.arrObj_Outline_Line[g])return!1;this.bSkipSolidDotted||(this.arrObj_Outline_Line[g].style.borderStyle=b?"dotted":"solid")}if(a){var k=this.indicatorWidth/2;k+=1;this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.left=c-k+"px";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.top=
e-k+"px";g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.LEFT_TOP]?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.cursor="NW-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.cursor="default");this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.left=
f-k+"px";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.top=e-k+"px";g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT_TOP]?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.cursor="NE-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.cursor=
"default");this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.left=f-k+"px";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.top=l-k+"px";h?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.cursor="NW-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.cursor=
"default");this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.left=c-k+"px";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.top=l-k+"px";g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.LEFT_BOTTOM]?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.cursor="SW-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.backgroundColor=
"#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.cursor="default");this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_TOP].style.display="";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_TOP].style.display="";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM].style.display="";this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT_BOTTOM].style.display="";a=f-c;b=l-e;a>this.nOutline_Basis_Min_Center_Rectangle?(h=c+a/2,this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.left=
h-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.top=e-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.display="",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.TOP]?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.cursor="N-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.cursor=
"default"),this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.left=h-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.top=l-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.display="",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.cursor="S-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.TOP].style.display="none",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.BOTTOM].style.display=
"none");b>this.nOutline_Basis_Min_Center_Rectangle?(h=e+b/2,this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.left=f-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.top=h-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.display="",m?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.cursor="E-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.backgroundColor=
"#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.cursor="default"),this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.left=c-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.top=h-k+"px",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.display="",g_objWrapperOutlineUtil.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.LEFT]?(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.backgroundColor="#ffffff",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.cursor=
"W-resize"):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.backgroundColor="#c0c0c0",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.cursor="default")):(this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.RIGHT].style.display="none",this.arrObj_Outline_Rectangle[OUTLINE_INDICATOR.LEFT].style.display="none");b>this.nOutline_Basis_Min_Line?(d?(this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.top=e+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.width=
"1px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.height=b-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.width="1px",this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.height=b+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.LEFT].style.display="none";a>this.nOutline_Basis_Min_Line?(d?(this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.left=
c+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.width=a-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.width=a+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.TOP].style.display="none";b>this.nOutline_Basis_Min_Line?(d?(this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.left=
f-1+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.top=e+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.height=b-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.left=f+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.top=e+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.height=b+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.RIGHT].style.display="none";a>this.nOutline_Basis_Min_Line?
(d?(this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.left=c+5+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.top=l-1+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.width=a-9+"px"):(this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.left=c+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.top=l+"px",this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.width=a+"px"),this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.display=""):this.arrObj_Outline_Line[OUTLINE_BORDER.BOTTOM].style.display=
"none";if(!d)for(g=0;8>g;g++)this.arrObj_Outline_Rectangle[g].style.display="none"}else{for(g=0;8>g;g++)this.arrObj_Outline_Rectangle[g].style.display="none";for(g=0;4>g;g++)this.arrObj_Outline_Line[g].style.display="none"}}catch(w){dalert(w)}};outlineUtil.prototype.setZIndexExtOutline=function(a){this.setZIndexExtOutlineRect(a);this.setZIndexExtOutlineLine(a)};outlineUtil.prototype.setZIndexExtOutlineRect=function(a){try{for(var d=0;8>d;d++)this.arrObj_Outline_Rectangle[d].style.zIndex=a}catch(b){dalert(b)}};
outlineUtil.prototype.setZIndexExtOutlineLine=function(a){try{for(var d=0;4>d;d++)this.arrObj_Outline_Line[d].style.zIndex=a}catch(b){dalert(b)}};outlineUtil.prototype.setExtOutlineBorder=function(a){try{if(a&&12===a.length){this.bSkipSolidDotted=!0;for(var d=0;4>d;d++){var b=d%4*3,c=0===d%2?"Left":"Top",e=a[b],f=a[b+1],l=a[b+2];"hidden"===f?(this.arrObj_Outline_Line[d].style["border"+c+"Width"]="2px",this.arrObj_Outline_Line[d].style["border"+c+"Style"]="dashed",this.arrObj_Outline_Line[d].style["border"+
c+"Color"]="#c5c5c5"):(this.arrObj_Outline_Line[d].style["border"+c+"Width"]=""===e?"0px":e,this.arrObj_Outline_Line[d].style["border"+c+"Style"]="noline"===f?"none":f,this.arrObj_Outline_Line[d].style["border"+c+"Color"]=l)}}}catch(h){dalert(h)}}},outlineUtil_Improved=function(){this.arrBorderSet=[];this.arrIndicatorSet=[];this.arrOutlineMgr=[];this.structCaretInfo=this.objOutlineMainDiv=null;outlineUtil_Improved.prototype.initializeOutline=function(){try{dlog("initializeOutline");var a=g_objEditorDocument[g_objPageControl.nEditNumber].getElementById("dze_document_main_container");
if(!1===fnObjectCheckNull(a)){this.objOutlineMainDiv=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div");this.objOutlineMainDiv.id="dze_outline_main";this.initStructCaretInfo();var d=this.createFakeCaret();this.objOutlineMainDiv.appendChild(d);a.appendChild(this.objOutlineMainDiv)}}catch(b){dalert(b)}};outlineUtil_Improved.prototype.addPreviewField=function(a){try{var d=g_objEditorDocument[g_objPageControl.nEditNumber],b=d.createElement("div"),c=d.createElement("svg"),e=d.getElementById("dze_document_main_container").getBoundingClientRect();
b.className="dze_shape_preview_field";var f="0 0 "+e.width+" "+e.height;c.setAttribute("xmlns","http://www.w3.org/2000/svg");c.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink");c.setAttribute("version","1.1");c.setAttribute("style","width: 100%; height: 100%; position: absolute; left: 0px; top: 0px; z-index: 40000;");c.setAttribute("viewBox",f);a===CMDMODE.INSERT_READY&&(c.style.cursor="crosshair");this.addEventListener(a);b.appendChild(c);this.objOutlineMainDiv.appendChild(b)}catch(l){dalert(l)}};
outlineUtil_Improved.prototype.removePreviewField=function(){try{var a=this.objOutlineMainDiv.getElementsByClassName("dze_shape_preview_field")[0];!0!==fnObjectCheckNull(a)&&(this.removeEventListener(),this.objOutlineMainDiv.removeChild(a))}catch(d){dalert(d)}};outlineUtil_Improved.prototype.updatePreviewField=function(a){try{var d=this.objOutlineMainDiv.getElementsByClassName("dze_shape_preview_field")[0];!0!==fnObjectCheckNull(d)&&(d.firstChild.appendChild(a),d.innerHTML=d.innerHTML.trim())}catch(b){dalert(b)}};
outlineUtil_Improved.prototype.addEventListener=function(a){try{var d=g_objNodeUtil.getParentElement(this.objOutlineMainDiv);window.attachEvent?(a===CMDMODE.INSERT_READY&&d.attachEvent("onmousedown",g_objWrapperOutlineUtil_Improved.onMouseDown),d.attachEvent("onmousemove",g_objWrapperOutlineUtil_Improved.onMouseMove),d.attachEvent("onmouseup",g_objWrapperOutlineUtil_Improved.onMouseUp)):(a===CMDMODE.INSERT_READY&&d.addEventListener("mousedown",g_objWrapperOutlineUtil_Improved.onMouseDown,!1),d.addEventListener("mousemove",
g_objWrapperOutlineUtil_Improved.onMouseMove,!1),d.addEventListener("mouseup",g_objWrapperOutlineUtil_Improved.onMouseUp,!1))}catch(b){dalert(b)}};outlineUtil_Improved.prototype.removeEventListener=function(){try{var a=g_objNodeUtil.getParentElement(this.objOutlineMainDiv);window.attachEvent?(a.detachEvent("onmousedown",g_objWrapperOutlineUtil_Improved.onMouseDown),a.detachEvent("onmousemove",g_objWrapperOutlineUtil_Improved.onMouseMove),a.detachEvent("onmouseup",g_objWrapperOutlineUtil_Improved.onMouseUp)):
(a.removeEventListener("mousedown",g_objWrapperOutlineUtil_Improved.onMouseDown,!1),a.removeEventListener("mousemove",g_objWrapperOutlineUtil_Improved.onMouseMove,!1),a.removeEventListener("mouseup",g_objWrapperOutlineUtil_Improved.onMouseUp,!1))}catch(d){dalert(d)}};outlineUtil_Improved.prototype.getArrIndexByObject=function(a){try{if(!0===fnObjectCheckNull(a)||!1===fnObjectCheckNull(this.arrOutlineMgr)&&1>this.arrOutlineMgr.length)return-1;for(var d,b=0;b<this.arrOutlineMgr.length;b++)if(d=this.arrOutlineMgr[b].object,
d===a)return b;return-1}catch(c){dalert(c)}};outlineUtil_Improved.prototype.getArrIndexByOutlineSet=function(a){try{if(!0===fnObjectCheckNull(a)||!0===fnObjectCheckNull(this.arrOutlineMgr)&&1>this.arrOutlineMgr.length)return-1;for(var d,b=0;b<this.arrOutlineMgr.length;b++)if(d=this.arrOutlineMgr[b].outline_set,d===a)return b;return-1}catch(c){dalert(c)}};outlineUtil_Improved.prototype.getObjectByIndex=function(a){try{return this.arrOutlineMgr[a].object}catch(d){dalert(d)}};outlineUtil_Improved.prototype.getOutlineSetByIndex=
function(a){try{return this.arrOutlineMgr[a].outline_set}catch(d){dalert(d)}};outlineUtil_Improved.prototype.createBorderSet=function(){try{this.arrBorderSet=[];for(var a,d=0;d<OUTLINE_BORDER.TOTAL_COUNTS;d++){var b=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div");b.className="dze_outline_border";a="width: 0px; height: 0px; left: 0px; top: 0px;";switch(d){case OUTLINE_BORDER.LEFT:case OUTLINE_BORDER.ROTATION:a+=" border-left-width: 1px; border-left-color: #bbbbbb;";break;case OUTLINE_BORDER.TOP:a+=
" border-top-width: 1px; border-top-color: #bbbbbb;";break;case OUTLINE_BORDER.RIGHT:a+=" border-right-width: 1px; border-right-color: #bbbbbb;";break;case OUTLINE_BORDER.BOTTOM:a+=" border-bottom-width: 1px; border-bottom-color: #bbbbbb;"}b.setAttribute("style",a);this.arrBorderSet[d]=b}}catch(c){dalert(c)}};outlineUtil_Improved.prototype.createIndicatorSet=function(a){try{this.arrIndicatorSet=[];var d=OUTLINE_INDICATOR.TOTAL_COUNTS;a||--d;for(a=0;a<d;a++){var b=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div");
b.id="dze_outline_indicator_"+a.toString();b.className="dze_outline_indicator";switch(a){case OUTLINE_INDICATOR.LEFT_TOP:var c="nw-resize";break;case OUTLINE_INDICATOR.RIGHT_TOP:c="ne-resize";break;case OUTLINE_INDICATOR.RIGHT_BOTTOM:c="se-resize";break;case OUTLINE_INDICATOR.LEFT_BOTTOM:c="sw-resize";break;case OUTLINE_INDICATOR.TOP:c="n-resize";break;case OUTLINE_INDICATOR.RIGHT:c="e-resize";break;case OUTLINE_INDICATOR.BOTTOM:c="s-resize";break;case OUTLINE_INDICATOR.LEFT:c="w-resize";break;case OUTLINE_INDICATOR.ROTATION:c=
"url("+dzeEnvConfig.strPath_Image+"shape-rotate.cur) 10 10, wait"}var e=10.6;a===OUTLINE_INDICATOR.ROTATION&&(e=16.6);b.style.width=e+"px";b.style.height=e+"px";b.style.cursor=c;a===OUTLINE_INDICATOR.ROTATION&&b.setAttribute("rotate","");this.arrIndicatorSet[a]=b;b.onmousedown=function(a){var c=this.id.split("_");g_objWrapperOutlineUtil_Improved.setPressedIndicator(parseInt(c[3],10));g_objWrapperOutlineUtil_Improved.onMouseDown(a,null)}}}catch(f){dalert(f)}};outlineUtil_Improved.prototype.addOutline=
function(a){try{!0===fnObjectCheckNull(this.arrOutlineMgr)&&(this.arrOutlineMgr=[]);var d=g_objShapeEvtMgr.isSupportRotate(a);this.createBorderSet();this.createIndicatorSet(d);var b=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div"),c=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div"),e=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div");b.className="dze_outline_set";b.style.pointerEvents="none";for(d=0;d<this.arrIndicatorSet.length;d++)d<
this.arrBorderSet.length&&c.appendChild(this.arrBorderSet[d]),e.appendChild(this.arrIndicatorSet[d]);b.appendChild(c);b.appendChild(e);!1===fnObjectCheckNull(a.id)&&b.setAttribute("object_id",a.id);this.objOutlineMainDiv.appendChild(b);this.arrOutlineMgr.push({object:a,outline_set:b})}catch(f){dalert(f)}};outlineUtil_Improved.prototype.removeOutline=function(a){try{if(!0!==fnObjectCheckNull(this.arrOutlineMgr)){var d=g_objEditorDocument[g_objPageControl.nEditNumber];if(!0!==fnObjectCheckNull(d)&&
(this.objOutlineMainDiv=d.getElementById("dze_outline_main"),!0===fnObjectCheckNull(this.objOutlineMainDiv)&&this.initializeOutline(),!0!==fnObjectCheckNull(this.objOutlineMainDiv)))if(!0===fnObjectCheckNull(a)){if(this.objOutlineMainDiv.childNodes)for(var b=1;b<this.objOutlineMainDiv.childNodes.length;b++)this.objOutlineMainDiv.removeChild(this.objOutlineMainDiv.childNodes[b]),b--;this.arrOutlineMgr=[]}else for(b=0;b<this.arrOutlineMgr.length;b++){var c=this.arrOutlineMgr[b].outline_set;var e=this.arrOutlineMgr[b].object;
if(e===a){this.objOutlineMainDiv.removeChild(c);this.arrOutlineMgr.splice(b,1);break}}}}catch(f){dalert(f)}};outlineUtil_Improved.prototype.updateOutline=function(a){try{if(!0!==fnObjectCheckNull(this.arrOutlineMgr)){var d=this.arrOutlineMgr[a].object,b=this.arrOutlineMgr[a].outline_set;a={left:"",top:"",width:"",height:"",rotate:null,horReverse:null,verReverse:null};if(!1===fnObjectCheckNull(d.className)&&"dze_shape_main"===d.className)a=g_objShapeFunction.getShapeRectInfo(d);else{var c=d.getBoundingClientRect();
a.left=c.left;a.top=c.top;a.width=c.width;a.height=c.height}b.style.width=a.width+"px";b.style.height=a.height+"px";b.style.left=a.left+"px";b.style.top=a.top+"px";b.style.transform="rotate("+a.rotate+"deg)";this.updateBorder(b.childNodes[0],a);this.updateIndicator(b.childNodes[1],a,0!==a.rotate)}}catch(e){dalert(e)}};outlineUtil_Improved.prototype.updateBorder=function(a,d){try{if(!0!==fnObjectCheckNull(a)&&!0!==fnObjectCheckNull(d))for(var b,c=0;c<a.childNodes.length;c++)if(b=a.childNodes[c],!1===
fnObjectCheckNull(d.horReverse)||!1===fnObjectCheckNull(d.verReverse))b.style.display="none";else switch(b.style.display="",c){case OUTLINE_BORDER.LEFT:b.style.left="0px";b.style.top="0px";b.style.height=d.height+"px";break;case OUTLINE_BORDER.TOP:b.style.left="0px";b.style.top="0px";b.style.width=d.width+"px";break;case OUTLINE_BORDER.RIGHT:b.style.left=d.width-1+"px";b.style.top="0px";b.style.height=d.height+"px";break;case OUTLINE_BORDER.BOTTOM:b.style.left="0px";b.style.top=d.height-1+"px";b.style.width=
d.width+"px";break;case OUTLINE_BORDER.ROTATION:b.style.left=d.width/2-1+"px",b.style.top="-19px",b.style.height="19px"}}catch(e){dalert(e)}};outlineUtil_Improved.prototype.updateIndicator=function(a,d,b){try{if(!0!==fnObjectCheckNull(a)&&!0!==fnObjectCheckNull(d))for(var c,e=5,f=0;f<a.childNodes.length;f++)if(c=a.childNodes[f],!0===b&&f!==OUTLINE_INDICATOR.ROTATION)c.style.display="none";else{c.style.display="";if(!1===fnObjectCheckNull(d.horReverse)&&!1===fnObjectCheckNull(d.verReverse)){if(f===
OUTLINE_INDICATOR.TOP||f===OUTLINE_INDICATOR.RIGHT||f===OUTLINE_INDICATOR.BOTTOM||f===OUTLINE_INDICATOR.LEFT){c.style.display="none";continue}if(!1===d.horReverse&&!1===d.verReverse||!0===d.horReverse&&!0===d.verReverse){if(f===OUTLINE_INDICATOR.RIGHT_TOP||f===OUTLINE_INDICATOR.LEFT_BOTTOM){c.style.display="none";continue}}else if(!1===d.horReverse||!1===d.verReverse)if(f===OUTLINE_INDICATOR.LEFT_TOP||f===OUTLINE_INDICATOR.RIGHT_BOTTOM){c.style.display="none";continue}c.style.display=""}switch(f){case OUTLINE_INDICATOR.LEFT_TOP:c.style.left=
0-e-.5+"px";c.style.top=0-e-.5+"px";break;case OUTLINE_INDICATOR.RIGHT_TOP:c.style.left=d.width-e+.5+"px";c.style.top=0-e-.5+"px";break;case OUTLINE_INDICATOR.RIGHT_BOTTOM:c.style.left=d.width-e+.5+"px";c.style.top=d.height-e+.5+"px";break;case OUTLINE_INDICATOR.LEFT_BOTTOM:c.style.left=0-e-.5+"px";c.style.top=d.height-e+.5+"px";break;case OUTLINE_INDICATOR.TOP:if(20>d.width){c.style.display="none";continue}else c.style.display="";c.style.left=d.width/2-e-.5+"px";c.style.top=0-e-.5+"px";break;case OUTLINE_INDICATOR.RIGHT:if(20>
d.height){c.style.display="none";continue}else c.style.display="";c.style.left=d.width-e+.5+"px";c.style.top=d.height/2-e-.5+"px";break;case OUTLINE_INDICATOR.BOTTOM:if(20>d.width){c.style.display="none";continue}else c.style.display="";c.style.left=d.width/2-e-.5+"px";c.style.top=d.height-e+.5+"px";break;case OUTLINE_INDICATOR.LEFT:if(20>d.height){c.style.display="none";continue}else c.style.display="";c.style.left=0-e-.5+"px";c.style.top=d.height/2-e-.5+"px";break;case OUTLINE_INDICATOR.ROTATION:20>
d.width?c.style.display="none":(c.style.display="",e=8,c.style.left=d.width/2-e-.5+"px",c.style.top=0-e-.5-30+"px")}}}catch(l){dalert(l)}};outlineUtil_Improved.prototype.addTextBox=function(a,d){try{if(!0!==fnObjectCheckNull(a)){var b=this.convertTextFormatToEditBox(a);if(!0===d){for(var c=b.querySelectorAll("#"+g_objCaretUtil.ID_CURRENT_CARET),e=0;e<c.length;e++)c[e].id+="_editbox";c=g_objEditorDocument[g_objPageControl.nEditNumber].querySelectorAll("#"+g_objCaretUtil.ID_CURRENT_CARET);for(e=0;e<
c.length;e++)c[e].parentNode.removeChild(c[e])}this.getOutlineSetByIndex(this.getArrIndexByObject(a)).appendChild(b);!1===d&&setTimeout(function(){var a=b.querySelectorAll("span");a=a[a.length-1];g_objCaretUtil.moveCaret(a,!0,!1)},200)}}catch(f){dalert(f)}finally{!0===d&&g_objCaretUtil.restoreCaret(void 0,g_objCaretUtil.ID_CURRENT_CARET+"_editbox")}};outlineUtil_Improved.prototype.convertTextFormatToEditBox=function(a){try{var d=function(a,c){try{if(-1!==c.className.indexOf("dzeExtListStyle")){var b=
c.className;b=b.replace("dze_shape_text_contents","");b=b.replace("paragraph","");b=b.replace("list_container","");b=b.trim();a.className=b}else a.style.listStyleType=c.style.listStyleType;a.style.cursor="text";for(b=0;b<c.childNodes.length;b++){var e=c.childNodes[b];if(-1!==e.className.indexOf("list_item")){var g=v.createElement("li");g.setAttribute("style",e.getAttribute("style"));g.style.cursor="text";for(var k=0;k<e.childNodes.length;k++)if(3===e.childNodes[k].nodeType){var h=v.createElement("span");
h.className="dze_shape_text_contents sentence";h.textContent=e.childNodes[k].textContent;g.appendChild(h)}else g.appendChild(e.childNodes[k].cloneNode(!0));a.appendChild(g)}else if(-1!==e.className.indexOf("list_container")){var f=v.createElement(e.getAttribute("list_type"));d(f,e);a.appendChild(f)}else a.appendChild(e.cloneNode(!0))}}catch(z){alert(z)}},b=a.lastChild,c=b.firstChild,e=g_objCommonUtil.toPx(b.style.marginTop),f=g_objCommonUtil.toPx(b.style.marginRight),l=g_objCommonUtil.toPx(b.style.marginBottom),
h=g_objCommonUtil.toPx(b.style.marginLeft),m=g_objCommonUtil.toPx(b.style.width),g=g_objCommonUtil.toPx(b.style.height),k=g_objCommonUtil.toPx(b.style.left),w=g_objCommonUtil.toPx(b.style.top),n=g_objZoom.getDocZoomValue()/100;k*=n;w*=n;e*=n;f*=n;l*=n;h*=n;var v=a.ownerDocument,p=v.createElement("div"),q=v.createElement("div");p.appendChild(q);p.id="dze_shape_textbox";p.setAttribute("style","width: "+m+"px; height: "+g+"px; margin: "+e+"px "+f+"px "+l+"px "+h+"px; position: relative; left: "+k+"px; top: "+
w+"px; overflow: hidden; transform: scale("+n+"); transform-origin: left top;");q.setAttribute("contenteditable",!0);q.setAttribute("style","width: "+parseFloat(c.style.width)+"px; height: "+parseFloat(c.style.height)+"px; display: table-cell; background: transparent; word-break: break-all; vertical-align: "+c.style.verticalAlign+"; padding: "+dzeJ(c).css("padding")+"; outline: none; color: "+c.style.color+"; overflow: hidden;");a=[];for(b=0;b<c.childNodes.length;b++)g_objPropertyUtil.hasClass(c.childNodes[b],
"dze_shape_text_contents")&&g_objPropertyUtil.hasClass(c.childNodes[b],"paragraph")&&a.push(c.childNodes[b]);for(b=0;b<a.length;b++){var r=a[b];if(-1!==r.className.indexOf("list_container")){var t=v.createElement(r.getAttribute("list_type"));d(t,r);q.appendChild(t)}else{t=a[b].cloneNode(!0);q.appendChild(t);var u=t.outerHTML;u=u.substring(u.indexOf("<span")+5,u.lastIndexOf("</span>"));u="<p"+u+"</p>";t.outerHTML=u}}var x=q.querySelectorAll("[contenteditable]");for(b=0;b<x.length;b++)x[b].removeAttribute("contenteditable");
return p}catch(y){dalert(y)}};outlineUtil_Improved.prototype.removeTextBox=function(a){try{var d=this.getOutlineSetByIndex(this.getArrIndexByObject(a)),b=d.querySelector("#dze_shape_textbox");null!==b&&d.removeChild(b)}catch(c){dalert(c)}};outlineUtil_Improved.prototype.convertTextFormatToShape=function(a){try{var d=function(a,c){try{a.className=a.className.concat(" list_container");a.setAttribute("list_type",c.nodeName.toLowerCase());""!==c.className?a.className=a.className.concat(" "+c.className):
a.style.listStyleType=dzeJ(c).css("list-style-type");for(var e,h,g,k=0;k<c.childNodes.length;k++)if(e=c.childNodes[k],"LI"===e.nodeName){g=b.createElement("span");dzeJ(e).find("span").addClass("dze_shape_text_contents sentence");g.className="dze_shape_text_contents paragraph list_item";for(var f=0;f<e.childNodes.length;f++)if(3===e.childNodes[f].nodeType){var m=b.createElement("span");m.className="dze_shape_text_contents sentence";m.textContent=e.childNodes[f].textContent;g.appendChild(m)}else g.appendChild(e.childNodes[f].cloneNode(!0));
fnObjectCheckNull(e.getAttribute("style"))||g.setAttribute("style",e.getAttribute("style"));a.appendChild(g)}else-1!=="OL|UL".indexOf(e.nodeName)&&(h=b.createElement("span"),h.className="dze_shape_text_contents paragraph",d(h,e),a.appendChild(h))}catch(t){alert(t)}},b=g_objEditorDocument[g_objPageControl.nEditNumber],c=b.getElementById("dze_shape_textbox");if(!1===fnObjectCheckNull(c)){dzeJ(c).find("#"+g_objCaretUtil.ID_CURRENT_CARET+"_editbox").remove();var e=a.querySelector(".dze_shape_text_container");
a=[];for(var f=b.createElement("span"),l,h,m=0;m<c.firstChild.childNodes.length;m++)"P"!==c.firstChild.childNodes[m].nodeName&&"OL"!==c.firstChild.childNodes[m].nodeName&&"UL"!==c.firstChild.childNodes[m].nodeName||a.push(c.firstChild.childNodes[m]);for(m=0;m<a.length;m++)l=a[m],null===g_objNodeUtil.getLoopParentElement(l,"table")&&(h=b.createElement("span"),h.className="dze_shape_text_contents paragraph",-1!=="OL|UL".indexOf(l.nodeName)?d(h,l):(h.innerHTML=l.innerHTML,!1===fnObjectCheckNull(l.getAttribute("style"))&&
h.setAttribute("style",l.getAttribute("style")),dzeJ(l).find("span").addClass("dze_shape_text_contents sentence")),f.appendChild(h));if(e.innerHTML===f.innerHTML)return!1;for(;!0===e.hasChildNodes();)e.removeChild(e.firstChild);e.innerHTML=f.innerHTML;return!0}return!1}catch(g){dalert(g)}};outlineUtil_Improved.prototype.initStructCaretInfo=function(){try{this.structCaretInfo={caret:{left:"",top:"",height:""},insertPoint:{node:null,startOffset:""}}}catch(a){dalert(a)}};outlineUtil_Improved.prototype.createFakeCaret=
function(){try{var a=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div");a.style.width="2px";a.style.height="18px";a.style.display="none";a.style.background="black";a.style.position="absolute";a.style.zIndex="40000";return a}catch(d){dalert(d)}};outlineUtil_Improved.prototype.showFakeCaret=function(a){try{var d=this.objOutlineMainDiv.childNodes[0];!1===fnObjectCheckNull(d)&&(!0===a?d.style.display="block":(d.style.display="none",d.style.left="",d.style.top=""));!1===a&&this.initStructCaretInfo()}catch(b){dalert(b)}};
outlineUtil_Improved.prototype.updateFakeCaretPosition=function(a){try{var d=function(a,b,d,l,h){var c=g_objEditorDocument[g_objPageControl.nEditNumber].createRange(),e=a.nodeValue.length;!0===h&&e++;for(var k=0;k<e;k++){!0===g_bBrowserType_IE&&0!==k&&k===e-1&&!0===h?c.setStart(a,k-1):c.setStart(a,k);c.setEnd(a,k);var f=c.getBoundingClientRect();var n=!0===g_bBrowserType_IE&&0!==k&&k===e-1&&!0===h?f.right:f.left;var v=f.top;var p=f.bottom;if(b.clientY>v-5&&b.clientY<p+5&&(0===k&&!0===d&&b.clientX<
n-5||k===e-1&&!0===l&&b.clientX>n+5||b.clientX>n-5&&b.clientX<n+5))return k===e-1&&!0===l&&b.clientX>n+5?(c.setStart(a,k+1),c.setEnd(a,k+1),f=c.getBoundingClientRect(),g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.caret.left=f.left,g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.insertPoint.startOffset=k+1):(g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.caret.left=n,g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.insertPoint.startOffset=
k),g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.caret.top=v,g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.caret.height=f.height,g_objWrapperOutlineUtil_Improved.outlineManager.structCaretInfo.insertPoint.node=a,!0}return!1},b=this.objOutlineMainDiv.childNodes[0];(function(a){for(var b=g_objPageControl.getPageMain(g_objPageControl.currentPage),c,l,h,m=null,g=0;g<b.childNodes.length;g++)if(c=b.childNodes[g],l=c.getBoundingClientRect(),h=l.top,l=h+l.height,0===g&&
a.clientY<h){m=c;break}else if(g===b.childNodes.length-1&&a.clientY>l){m=c;break}else if(a.clientY>h&&a.clientY<l){m=c;break}if(!1===fnObjectCheckNull(m)){var k=[];g=g_objEditorDocument[g_objPageControl.nEditNumber].createRange();g.selectNode(m);g_objNodeUtil.traverseNodesInRange(g,function(a){!1===fnObjectCheckNull(a)&&(a.nodeType===ID_SELECTION_TEXT_NODE||a.nodeType===ID_SELECTION_ELEMENT_NODE&&(a.nodeName.toLowerCase()===DZE_TAG_IMG||!1===fnObjectCheckNull(a.classList)&&!0===a.classList.contains("dze_shape_main")))&&
k.push(a)});for(g=0;g<k.length;g++)if(m=k[g],m.nodeType===ID_SELECTION_TEXT_NODE){b=g_objNodeUtil.getParentElement(m);if(!0===b.classList.contains("dze_shape_text_contents")&&(b=g_objNodeUtil.getLoopParentByClassName(b,"dze_shape_main"),b===g_objSelectedShapesArray[0]||"absolute"===b.style.position.toLowerCase()))continue;b=!1;g!==k.length-1&&k[g+1].nodeType===ID_SELECTION_ELEMENT_NODE&&(b=!0);if(!0===d(m,a,0===g,g===k.length-1,b))break}}})(a);!1===fnObjectCheckNull(b)&&(b.style.left=this.structCaretInfo.caret.left+
"px",b.style.top=this.structCaretInfo.caret.top+"px",b.style.height=this.structCaretInfo.caret.height+"px")}catch(c){dalert(c)}}},guideLineManager=new function(){function a(){return{MAGNET_POWER:10,onReady:function(){if(!0===fnObjectCheckNull(c)){try{try{c=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div"),c.className="dze_guide_line_container"}catch(g){dalert(g)}d(!0);d(!1)}catch(g){dalert(g)}var a=g_objWrapperOutlineUtil_Improved.outlineManager.objOutlineMainDiv;!1===fnObjectCheckNull(a)&&
!1===fnObjectCheckNull(c)&&a.appendChild(c)}try{e={previous:null,current:null,next:null};l=1;var b=1*g_objPageControl.currentPage;!0!==isNaN(b)&&(0!==b&&(e.previous=g_objPageControl.getPageRectInfo(b-1)),b<g_objPageControl.getTotalPageCount()-1&&(e.next=g_objPageControl.getPageRectInfo(b+1)),e.current=g_objPageControl.getPageRectInfo(b))}catch(g){dalert(g)}f=g_objShapeFunction.getGroupRectInfo()},onRelease:function(){if(!0!==fnObjectCheckNull(c)){var a=g_objNodeUtil.getParentElement(c);!1===fnObjectCheckNull(a)&&
a.removeChild(c);f=e=c=null}},getGuideLineContainer:function(){return c},getPageRectInfo:function(a){!0===fnObjectCheckNull(a)&&(a=l);if(0===a)return e.previous;if(1===a)return e.current;if(2===a)return e.next},getGroupRectInfo:function(){return f},showGuideLine:function(a){try{if(a!==GUIDE_LINE_TYPE.TYPE_NONE){var b=10>a?c.firstChild:c.lastChild;var d=this.getPageRectInfo(l);switch(a){case GUIDE_LINE_TYPE.OUTER_TOP:var e=d.outerLeft;var h=d.outerTop;break;case GUIDE_LINE_TYPE.OUTER_BOTTOM:e=d.outerLeft;
h=d.outerBottom;break;case GUIDE_LINE_TYPE.OUTER_HORIZONTAL_CENTER:e=d.outerLeft;h=d.outerHorizontalCenter;break;case GUIDE_LINE_TYPE.INNER_TOP:e=d.outerLeft;h=d.innerTop;break;case GUIDE_LINE_TYPE.INNER_BOTTOM:e=d.outerLeft;h=d.innerBottom;break;case GUIDE_LINE_TYPE.INNER_HORIZONTAL_CENTER:e=d.outerLeft;h=d.innerHorizontalCenter;break;case GUIDE_LINE_TYPE.OUTER_LEFT:e=d.outerLeft;h=d.outerTop;break;case GUIDE_LINE_TYPE.OUTER_RIGHT:e=d.outerRight;h=d.outerTop;break;case GUIDE_LINE_TYPE.OUTER_VERTICAL_CENTER:e=
d.outerVerticalCenter;h=d.outerTop;break;case GUIDE_LINE_TYPE.INNER_LEFT:e=d.innerLeft;h=d.outerTop;break;case GUIDE_LINE_TYPE.INNER_RIGHT:e=d.innerRight;h=d.outerTop;break;case GUIDE_LINE_TYPE.INNER_VERTICAL_CENTER:e=d.innerVerticalCenter,h=d.outerTop}b.style.left=e-.5+"px";b.style.top=h-.5+"px";10>a?b.style.width=d.outerRight-d.outerLeft+"px":b.style.height=d.outerBottom-d.outerTop+"px";b.style.display=""}}catch(n){dalert(n)}},hideGuideLine:function(a){try{!0===a?c.firstChild.style.display="none":
c.lastChild.style.display="none"}catch(m){dalert(m)}},getGuideLineType:function(a,b,d){try{var c=GUIDE_LINE_TYPE.TYPE_NONE,g=a.clientX-g_objWrapperOutlineUtil_Improved.getStartPositionInfo().x,h=a.clientY-g_objWrapperOutlineUtil_Improved.getStartPositionInfo().y,m=f.top+h,p=f.bottom+h,q=f.left+g,r=f.right+g,t=f.horizontalCenter+h,u=f.verticalCenter+g;a=null;a=e.current;l=1;if(b===CMDMODE.MOVE_ON_LAYER)a.outerTop>p?null!==e.previous&&(a=e.previous,l=0):a.outerBottom<m&&null!==e.next&&(a=e.next,l=2),
Math.abs(a.outerTop-m)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_TOP:Math.abs(a.outerBottom-p)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_BOTTOM:Math.abs(a.outerHorizontalCenter-t)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_HORIZONTAL_CENTER:Math.abs(a.innerTop-m)<=this.MAGNET_POWER||Math.abs(a.innerTop-p)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.INNER_TOP:Math.abs(a.innerBottom-m)<=this.MAGNET_POWER||Math.abs(a.innerBottom-p)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.INNER_BOTTOM:Math.abs(a.innerHorizontalCenter-
t)<=this.MAGNET_POWER&&(c=GUIDE_LINE_TYPE.INNER_HORIZONTAL_CENTER),Math.abs(a.outerLeft-q)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.OUTER_LEFT:Math.abs(a.outerRight-r)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.OUTER_RIGHT:Math.abs(a.outerVerticalCenter-u)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.OUTER_VERTICAL_CENTER:Math.abs(a.innerLeft-q)<=this.MAGNET_POWER||Math.abs(a.innerLeft-r)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.INNER_LEFT:Math.abs(a.innerRight-q)<=this.MAGNET_POWER||Math.abs(a.innerRight-r)<=this.MAGNET_POWER?
c+=GUIDE_LINE_TYPE.INNER_RIGHT:Math.abs(a.innerVerticalCenter-u)<=this.MAGNET_POWER&&(c+=GUIDE_LINE_TYPE.INNER_VERTICAL_CENTER);else if(b===CMDMODE.RESIZE){switch(d){case OUTLINE_INDICATOR.TOP:case OUTLINE_INDICATOR.LEFT_TOP:case OUTLINE_INDICATOR.RIGHT_TOP:Math.abs(a.outerTop-m)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_TOP:Math.abs(a.outerBottom-m)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_BOTTOM:Math.abs(a.innerTop-m)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.INNER_TOP:Math.abs(a.innerBottom-m)<=
this.MAGNET_POWER&&(c=GUIDE_LINE_TYPE.INNER_BOTTOM);break;case OUTLINE_INDICATOR.BOTTOM:case OUTLINE_INDICATOR.LEFT_BOTTOM:case OUTLINE_INDICATOR.RIGHT_BOTTOM:Math.abs(a.outerTop-p)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_TOP:Math.abs(a.outerBottom-p)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.OUTER_BOTTOM:Math.abs(a.innerTop-p)<=this.MAGNET_POWER?c=GUIDE_LINE_TYPE.INNER_TOP:Math.abs(a.innerBottom-p)<=this.MAGNET_POWER&&(c=GUIDE_LINE_TYPE.INNER_BOTTOM)}switch(d){case OUTLINE_INDICATOR.LEFT:case OUTLINE_INDICATOR.LEFT_TOP:case OUTLINE_INDICATOR.LEFT_BOTTOM:Math.abs(a.outerLeft-
q)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.OUTER_LEFT:Math.abs(a.outerRight-q)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.OUTER_RIGHT:Math.abs(a.innerLeft-q)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.INNER_LEFT:Math.abs(a.innerRight-q)<=this.MAGNET_POWER&&(c+=GUIDE_LINE_TYPE.INNER_RIGHT);break;case OUTLINE_INDICATOR.RIGHT:case OUTLINE_INDICATOR.RIGHT_TOP:case OUTLINE_INDICATOR.RIGHT_BOTTOM:Math.abs(a.outerLeft-r)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.OUTER_LEFT:Math.abs(a.outerRight-r)<=this.MAGNET_POWER?c+=
GUIDE_LINE_TYPE.OUTER_RIGHT:Math.abs(a.innerLeft-r)<=this.MAGNET_POWER?c+=GUIDE_LINE_TYPE.INNER_LEFT:Math.abs(a.innerRight-r)<=this.MAGNET_POWER&&(c+=GUIDE_LINE_TYPE.INNER_RIGHT)}}return c}catch(x){dalert(x)}}}}function d(a){try{var b=g_objEditorDocument[g_objPageControl.nEditNumber].createElement("div");b.className="dze_object_guide_line";b.style.display="none";!0===a?b.classList.add("horizontal"):b.classList.add("vertical");c.appendChild(b)}catch(g){dalert(g)}}return{getInstance:function(){!0===
fnObjectCheckNull(b)&&(b=a());return b}};var b,c,e,f,l};
var g_objWrapperOutlineUtil=new function(){var a=this;this.objOutlineUtil=null;this.nExtOutlineRectPressedType=OUTLINE_INDICATOR.NONE;this.arrResizeExtOutlineRectangle=[];this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.LEFT_TOP]=!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT_TOP]=!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM]=!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.LEFT_BOTTOM]=!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.TOP]=!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT]=
!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.BOTTOM]=!0;this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.LEFT]=!0;this.initializeExtOutline=function(a){try{this.objOutlineUtil=new outlineUtil;this.objOutlineUtil.initializeExtOutline(a);for(var b=this,d=EventUtil,e=OUTLINE_INDICATOR.LEFT,g=this.objOutlineUtil.arrObj_Outline_Rectangle,f=null,k=OUTLINE_INDICATOR.LEFT_TOP;k<=e;k++)f=g[k],function(){var a=k;d.addHandler(f,"mousedown",function(c){b.outlineRectangle_onmousedown(a,c)});d.addHandler(f,
"touchstart",function(c){b.outlineRectangle_onmousedown(a,c)})}()}catch(l){dalert(l)}};this.unload=function(){try{this.objOutlineUtil&&(this.objOutlineUtil.unload(),this.objOutlineUtil=null)}catch(b){dalert(b)}};this.getDocument=function(){return this.objOutlineUtil?this.objOutlineUtil.getDocument():document};this.showExtOutline=function(b,c,d,e,g){try{if(!g_readonlyMode&&null!==g_objPageControl.documentContainerNode){null===this.objOutlineUtil&&g_objWrapperOutlineUtil.initializeExtOutline(!1);var f=
0,k=0,l=0,m=0,q=this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT_BOTTOM],r=this.arrResizeExtOutlineRectangle[OUTLINE_INDICATOR.RIGHT];if(c){if(null==b||null==g_objWrapperOutlineResize.objExtSelectedInfo)return!1;var h=null;switch(g_objWrapperOutlineResize.objExtSelectedInfo.nObjType){case DZE_OBJ_IMG:case DZE_OBJ_TABLE:case DZE_OBJ_TD:case DZE_OBJ_VIDEO:h=g_objPositionUtil.getElementPosClientRect(b);break;case DZE_OBJ_HR:var p=g_objZoom.getDocZoomValue()/100;h=g_objPositionUtil.getElementPosClientRect(b);
h.top-=6*p;h.bottom+=6*p;break;default:return!1}var n=g_objPositionUtil.getElementPosition(g_objEditObject[g],!1);f=n.left+h.left;k=n.top+h.top;l=n.left+h.right;m=n.top+h.bottom;f=h.left;k=h.top;l=h.right;m=h.bottom}this.objOutlineUtil.showExtOutline(c,d,e,f,k,l,m,q,r);c||g_objTransparentViewUtil.showTransparentView(!1,null,a.getDocument())}}catch(t){dalert(t)}};this.outlineRectangle_onmousedown=function(b,c){try{if(null!=g_objWrapperOutlineResize.objExtSelectedInfo&&a.arrResizeExtOutlineRectangle[b]){TBCancelBubbleEvent(c);
g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=!0);a.nExtOutlineRectPressedType=b;var d=g_objWrapperOutlineResize.objExtSelectedInfo.objElement;switch(g_objWrapperOutlineResize.objExtSelectedInfo.nObjType){case DZE_OBJ_IMG:case DZE_OBJ_VIDEO:g_objWrapperOutlineResize.newExtDragPosInfo(d,c,g_nActiveEditNumber);break;case DZE_OBJ_TD:g_objTableResize.prepareResize(g_objNodeUtil.getLoopParentElement(d,"table"),!0);g_objWrapperOutlineResize.newExtDragPosInfo(d,c,g_nActiveEditNumber);
break;case DZE_OBJ_TABLE:g_objTableResize.prepareResize(d,!0);g_objWrapperOutlineResize.newExtDragPosInfo(d,c,g_nActiveEditNumber);break;default:return}g_bTableResizingYN&&g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objTransparentViewUtil.showTransparentView(!0,0,a.getDocument());a.addMouseListener(c)}}catch(e){dalert(e)}};this.outlineRectangle_onmousemove=function(b){try{if(-1!=a.nExtOutlineRectPressedType){var c=g_objWrapperOutlineResize.objExtSelectedInfo,d=c.nObjType,e=c.objElement,g=
a.nExtOutlineRectPressedType;c=g_nActiveEditNumber;switch(d){case DZE_OBJ_IMG:case DZE_OBJ_VIDEO:case DZE_OBJ_TD:case DZE_OBJ_TABLE:g_objWrapperOutlineResize.resizePositionByDragForExtMode(d,e,b,g,c)}}}catch(f){dalert(f)}};this.outlineRectangle_onmouseup=function(b){try{if(g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[g_nActiveEditNumber]=!1),null!=g_objWrapperOutlineResize.objExtSelectedInfo){DZE_OBJ_TABLE==g_objWrapperOutlineResize.objExtSelectedInfo.nObjType&&g_objWrapperOutlineResize.afterResizeTargetElement(a.nExtOutlineRectPressedType,
g_nActiveEditNumber);a.nExtOutlineRectPressedType=OUTLINE_INDICATOR.NONE;g_objWrapperOutlineResize.objExtDragPosInfo=null;g_objTransparentViewUtil.showTransparentView(!1,null,a.getDocument());a.removeMouseListener(b);switch(g_objWrapperOutlineResize.objExtSelectedInfo.nObjType){case DZE_OBJ_VIDEO:case DZE_OBJ_IMG:a.showExtOutline(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!0,!1,g_nActiveEditNumber);!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&("img"==g_objWrapperOutlineResize.objExtSelectedInfo.objElement.nodeName.toLowerCase()&&
dze_menu_control.setTBImageSizeInfo(g_nActiveEditNumber,!0),"video"==g_objWrapperOutlineResize.objExtSelectedInfo.objElement.nodeName.toLowerCase()&&dze_menu_control.setTBVideoSizeInfo(g_nActiveEditNumber));break;case DZE_OBJ_TABLE:case DZE_OBJ_TD:a.showExtOutline(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!0,!1,g_nActiveEditNumber)}if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();g_objUndoRedo.registerUndoRedoStack(0,g_nActiveEditNumber)}}catch(c){dalert(c)}};
this.addMouseListener=function(b){try{var c=EventUtil,d=a.getDocument();"touchstart"===b.type?(c.addHandler(d,"touchmove",a.outlineRectangle_onmousemove),c.addHandler(d,"touchend",a.outlineRectangle_onmouseup)):(c.addHandler(d,"mousemove",a.outlineRectangle_onmousemove),c.addHandler(d,"mouseup",a.outlineRectangle_onmouseup))}catch(e){dalert(e)}};this.removeMouseListener=function(b){try{var c=EventUtil,d=a.getDocument();"touchend"===b.type?(c.removeHandler(d,"touchmove",a.outlineRectangle_onmousemove),
c.removeHandler(d,"touchend",a.outlineRectangle_onmouseup)):(c.removeHandler(d,"mousemove",a.outlineRectangle_onmousemove),c.removeHandler(d,"mouseup",a.outlineRectangle_onmouseup))}catch(e){dalert(e)}}},g_objWrapperOutlineUtil_Improved=new function(){this.outlineManager=new outlineUtil_Improved;this.guideLineManager=null;this.nActionType=CMDMODE.NORMAL;this.nPressedIndicator=OUTLINE_INDICATOR.NONE;this.baseObject=null;this.structStartPosition={x:0,y:0};this.structEndPosition={x:0,y:0};this.initEventManager=
function(){this.nActionType=CMDMODE.NORMAL;this.nPressedIndicator=OUTLINE_INDICATOR.NONE;this.baseObject=null;this.structStartPosition={x:0,y:0};this.structEndPosition={x:0,y:0}};this.getActionType=function(){return this.nActionType};this.setActionType=function(a){this.nActionType=a};this.getPressedIndicator=function(){return this.nPressedIndicator};this.setPressedIndicator=function(a){this.nPressedIndicator=a};this.getStartPositionInfo=function(){return this.structStartPosition};this.setStartPositionInfo=
function(a,b){this.structStartPosition.x=a;this.structStartPosition.y=b};this.getEndPositionInfo=function(){return this.structEndPosition};this.setEndPositionInfo=function(a,b){this.structEndPosition.x=a;this.structEndPosition.y=b};this.initWrapperOutlineUtil=function(){try{dlog("initWrapperOutlineUtil"),this.initEventManager(),this.outlineManager.initializeOutline(),this.guideLineManager=guideLineManager.getInstance()}catch(a){dalert(a)}};this.showPreviewField=function(){try{this.outlineManager.addPreviewField(this.nActionType)}catch(a){dalert(a)}};
this.hidePreviewField=function(){try{this.outlineManager.removePreviewField()}catch(a){dalert(a)}};this.updatePreviewField=function(a){try{this.outlineManager.updatePreviewField(a)}catch(b){dalert(b)}};this.showOutline=function(a){try{!0===g_readonlyMode||!1===fnObjectCheckNull(this.outlineManager.arrOutlineMgr)&&0<this.outlineManager.arrOutlineMgr.length&&!0===this.outlineManager.arrOutlineMgr.some(function(b){return b.object===a})||(this.outlineManager.addOutline(a),this.outlineManager.updateOutline(this.outlineManager.arrOutlineMgr.length-
1),this.outlineManager.objOutlineMainDiv.style.display="")}catch(b){dalert(b)}};this.showTextBox=function(a,b){try{this.outlineManager.addTextBox(a,b),a.lastChild.style.display="none"}catch(c){dalert(c)}};this.hideTextBox=function(a){try{this.outlineManager.removeTextBox(a),a.lastChild.style.display=""}catch(b){dalert(b)}};this.updateShapeText=function(a,b){try{!0===this.outlineManager.convertTextFormatToShape(a)&&!0===b&&g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber)}catch(c){dalert(c)}};
this.hideOutline=function(a){try{if(null!==a)a.lastChild.style.display="";else{var b=g_objEditorDocument[g_objPageControl.nEditNumber];if(!1===fnObjectCheckNull(b)){var c=b.querySelectorAll(".dze_shape_main");for(b=0;b<c.length;b++)c[b].lastChild.style.display=""}}this.outlineManager.removeOutline(a);!1===fnObjectCheckNull(this.outlineManager.objOutlineMainDiv)&&this.outlineManager.objOutlineMainDiv.childNodes&&1>this.outlineManager.objOutlineMainDiv.childNodes.length&&(this.outlineManager.objOutlineMainDiv.style.display=
"none")}catch(d){dalert(d)}};this.updateOutline=function(a){try{this.updateShapeText(a);this.hideTextBox(a);var b=this.outlineManager.getArrIndexByObject(a);-1<b&&this.outlineManager.updateOutline(b)}catch(c){dalert(c)}};this.isResizeAction=function(a){try{if(!0===fnObjectCheckNull(a))return!1;var b=a.nodeName.toLowerCase();if(!1===fnObjectCheckNull(b)&&b!==DZE_TAG_PATH)return!1;var c=g_objNodeUtil.getLoopParentElementByTagNames(a,[DZE_TAG_DIV]);return!1===fnObjectCheckNull(c)&&c.nodeName.toLowerCase()===
DZE_TAG_DIV&&"dze_outline_indicator"===c.className?!0:!1}catch(d){dalert(d)}};this.isInsertable=function(a){try{var b=g_objPageControl.getPageNode(0).getBoundingClientRect();return a<b.left||a>b.right?!1:!0}catch(c){dalert(c)}};this.onMouseDown=function(a,b){try{if(dlog("g_objWrapperOutlineUtil_Improved.onMouseDown"),g_objWrapperOutlineUtil_Improved.getActionType()===CMDMODE.INSERT_READY||!(!0===fnObjectCheckNull(g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr)||0>g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.length)){var c=
g_objPositionUtil.GetDocumentClientPos_XY(a);g_objWrapperOutlineUtil_Improved.setStartPositionInfo(c.nPos_X,c.nPos_Y);g_objWrapperOutlineUtil_Improved.setEndPositionInfo(c.nPos_X,c.nPos_Y);var d=g_objWrapperOutlineUtil_Improved.getActionType();if(d===CMDMODE.INSERT_READY){if(!1===g_objWrapperOutlineUtil_Improved.isInsertable(a.offsetX)||a.button!==MOUSE_BTN.L){g_objWrapperOutlineUtil_Improved.hidePreviewField();g_objWrapperOutlineUtil_Improved.initEventManager();g_objShapeFunction.arrPreviewInfo=
[];return}g_objShapeEvtMgr.structInsertPoint.x=a.offsetX;g_objShapeEvtMgr.structInsertPoint.y=a.offsetY;g_objWrapperOutlineUtil_Improved.setActionType(CMDMODE.INSERT);g_objShapeFunction.createShapeGuideLine()}else{c=!1;for(var e=0;e<g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.length;e++){var g=g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr[e];g=g.object;if(!1===fnObjectCheckNull(g.className)&&"dze_shape_main"===g.className){c=!0;break}}if(!0===c){var f=g_objWrapperOutlineUtil_Improved.getPressedIndicator();
if(f===OUTLINE_INDICATOR.NONE)d=!0===b?CMDMODE.MOVE_ON_LAYER:CMDMODE.MOVE_IN_TEXT;else{if(a.button!==MOUSE_BTN.L)return;d=f===OUTLINE_INDICATOR.ROTATION?CMDMODE.ROTATE:CMDMODE.RESIZE;var k=a.target;k=g_objNodeUtil.getLoopParentByClassName(k,"dze_outline_set");var l=g_objWrapperOutlineUtil_Improved.outlineManager.getArrIndexByOutlineSet(k);g_objWrapperOutlineUtil_Improved.baseObject=g_objWrapperOutlineUtil_Improved.outlineManager.getObjectByIndex(l)}g_objWrapperOutlineUtil_Improved.setActionType(d);
if(d===CMDMODE.MOVE_IN_TEXT)g_objWrapperOutlineUtil_Improved.outlineManager.addEventListener(d),g_objWrapperOutlineUtil_Improved.outlineManager.showFakeCaret(!0);else{g_objWrapperOutlineUtil_Improved.showPreviewField();if(d===CMDMODE.RESIZE||d===CMDMODE.MOVE_ON_LAYER)g_objWrapperOutlineUtil_Improved.guideLineManager.onReady();g_objShapeFunction.createShapeGuideLine()}}}TBCancelBubbleEvent(a)}}catch(m){dalert(m)}};this.onMouseMove=function(a){try{throttle(g_objWrapperOutlineUtil_Improved,g_objWrapperOutlineUtil_Improved.updateWindowForShapes,
a),TBCancelBubbleEvent(a)}catch(b){dalert(b)}};this.updateWindowForShapes=function(a){try{var b=g_objWrapperOutlineUtil_Improved.getActionType();if(b===CMDMODE.INSERT_READY){var c=g_objWrapperOutlineUtil_Improved.outlineManager.objOutlineMainDiv.getElementsByClassName("dze_shape_preview_field")[0].firstChild;if(!0===g_objWrapperOutlineUtil_Improved.isInsertable(a.offsetX))c.style.cursor="crosshair";else{c.style.cursor="";return}}else if(b===CMDMODE.INSERT)g_objShapeFunction.onUpdateShapesPreview(a);
else{if(1!==a.buttons)return;var d=g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr[g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.length-1];if(!0===fnObjectCheckNull(d))return;d=d.object;if(!1===fnObjectCheckNull(d.className)&&"dze_shape_main"===d.className&&b!==CMDMODE.NORMAL)if(b===CMDMODE.MOVE_IN_TEXT)g_objWrapperOutlineUtil_Improved.outlineManager.updateFakeCaretPosition(a);else{if(b===CMDMODE.RESIZE||b===CMDMODE.MOVE_ON_LAYER){g_objWrapperOutlineUtil_Improved.guideLineManager.hideGuideLine(!0);
g_objWrapperOutlineUtil_Improved.guideLineManager.hideGuideLine(!1);var e=g_objWrapperOutlineUtil_Improved.guideLineManager.getGuideLineType(a,b,g_objWrapperOutlineUtil_Improved.getPressedIndicator());0<e&&(b=e%10,g_objWrapperOutlineUtil_Improved.guideLineManager.showGuideLine(b),9<e&&g_objWrapperOutlineUtil_Improved.guideLineManager.showGuideLine(e-b))}g_objShapeFunction.onUpdateShapesPreview(a,e)}}var g=g_objPositionUtil.GetDocumentClientPos_XY(a);g_objWrapperOutlineUtil_Improved.setEndPositionInfo(g.nPos_X,
g.nPos_Y)}catch(f){dalert(f)}};this.onMouseUp=function(a){try{dlog("g_objWrapperOutlineUtil_Improved.onMouseUp");var b=!1,c=g_objWrapperOutlineUtil_Improved.getActionType(),d=g_objPositionUtil.GetDocumentClientPos_XY(a);g_objWrapperOutlineUtil_Improved.setEndPositionInfo(d.nPos_X,d.nPos_Y);if(c===CMDMODE.INSERT)b=g_objShapeFunction.onUpdateShapes(a);else{var e=g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr[g_objWrapperOutlineUtil_Improved.outlineManager.arrOutlineMgr.length-1];if(!0===
fnObjectCheckNull(e))return;e=e.object;!0===g_objPropertyUtil.element_hasClass(e,"dze_shape_main")&&(b=g_objShapeFunction.onUpdateShapes(a),a.button===MOUSE_BTN.R&&editor_oncontextmenu(a,g_objPageControl.nEditNumber))}editor_onselectionchange(g_objPageControl.nEditNumber);if(b&&c===CMDMODE.MOVE_IN_TEXT){var g=g_objPageControl.getPageNum(g_objSelectedShapesArray[0]);g_objPageControl.onSetDelayedUpdatePageTimer(0,g)}TBCancelBubbleEvent(a)}catch(f){dalert(f)}finally{g_objWrapperOutlineUtil_Improved.outlineManager.removeEventListener(),
g_objWrapperOutlineUtil_Improved.getActionType()===CMDMODE.MOVE_IN_TEXT&&g_objWrapperOutlineUtil_Improved.outlineManager.showFakeCaret(!1),g_objWrapperOutlineUtil_Improved.guideLineManager.onRelease(),g_objWrapperOutlineUtil_Improved.hidePreviewField(),g_objWrapperOutlineUtil_Improved.initEventManager(),g_objShapeFunction.arrPreviewInfo=[],!0===b&&(panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_SHAPES),g_objUndoRedo.registerUndoRedoStack(0,g_objPageControl.nEditNumber))}}};
var handlerUI={arrCommandUpdateIndex:[],arrContextUpdateIndex:[],arrMenuTableUpdateIndex:[],getCommandUpdateIndex:function(c,a){try{if("undefined"==typeof this.arrCommandUpdateIndex[c]||"undefined"==typeof this.arrCommandUpdateIndex[c][a])return-1;var e=this.arrCommandUpdateIndex[c][a];return null==e?-1:e}catch(b){dalert(b)}return-1},setCommandUpdateIndex:function(c,a,e){try{fnObjectCheckNull(this.arrCommandUpdateIndex[c])&&(this.arrCommandUpdateIndex[c]=[]),this.arrCommandUpdateIndex[c][a]=e}catch(b){dalert(b)}},
getContextUpdateIndex:function(c,a){try{var e=this.arrContextUpdateIndex[c][a];return null==e?-1:e}catch(b){dalert(b)}return-1},setContextUpdateIndex:function(c,a,e){try{fnObjectCheckNull(this.arrContextUpdateIndex[c])&&(this.arrContextUpdateIndex[c]=[]),this.arrContextUpdateIndex[c][a]=e}catch(b){dalert(b)}},getMenuTableUpdateIndex:function(c){try{var a=this.arrCommandUpdateIndex[c];return null==a?-1:a}catch(e){dalert(e)}return-1},setMenuTableUpdateIndex:function(c,a){try{this.arrCommandUpdateIndex[c]=
a}catch(e){dalert(e)}},queryCommandStatus:function(c,a,e,b,r,f,v){try{void 0===v&&(v=!1);if(g_browserCHK.mobile){if(a==ID_COMMAND_PRINT||a==ID_COMMAND_INSERT_OBJECT_MOVIE)return ID_STRING_NAME_GRAY;a==ID_COMMAND_SHAPES_INSERT&&(dzeUiConfig.bUseShapesFeature=!1)}var d=f=!1,l=!1;a=parseInt(a);switch(a){case ID_COMMAND_COPY:case ID_COMMAND_COPY_EXT:GetMultiCellSelection(b)?d=!0:a===ID_COMMAND_COPY&&0<g_objSelectedShapesArray.length?d=!0:a===ID_COMMAND_COPY_EXT?d=!0:!1===g_objEditWindow[b].getSelection().isCollapsed&&
(d=!0);break;case ID_COMMAND_CUT:g_readonlyMode||(GetMultiCellSelection(b)?d=!0:0<g_objSelectedShapesArray.length?d=!0:!1===g_objEditWindow[b].getSelection().isCollapsed&&(d=!0));break;case ID_COMMAND_DELETE:g_readonlyMode||(GetMultiCellSelection(b)?d=!0:0<g_objEditWindow[b].getSelection().rangeCount&&(d=!0));break;case ID_COMMAND_PASTE:case ID_COMMAND_PASTE_EXT:!g_readonlyMode&&0<g_objEditWindow[b].getSelection().rangeCount&&(d=!0);break;case ID_COMMAND_PASTE_CELL:dzeClipBoard&&dzeClipBoard.copyData&&
0<dzeClipBoard.copyData.length&&(d=!0);break;case ID_COMMAND_INSERT_ORDERED_LIST:case ID_COMMAND_INSERT_UNORDERED_LIST:case ID_COMMAND_STYLE_CASCADE_ORDERLIST:d=!0;f=!1;"undefined"!==typeof g_objSelectedShapesArray&&"undefined"!==typeof g_objShapeEvtMgr&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()&&(d=!1);if(a===ID_COMMAND_INSERT_ORDERED_LIST){var k=GetCurList(b);k&&"OL"===k.nodeName&&(f=!0)}else a===ID_COMMAND_INSERT_UNORDERED_LIST&&(k=GetCurList(b))&&"UL"===
k.nodeName&&(f=!0);break;case ID_COMMAND_SET_LIST_START_NEW:l=!0;var m=GetCurListItem(b);!m||!m.parentNode||"OL"!==m.parentNode.nodeName||"undefined"===typeof g_objListUtil||g_objListUtil.isFirstListItem(m)&&1===g_objListUtil.getStart(m.parentNode)||(d=!0,l=!1);break;case ID_COMMAND_SET_LIST_START_CONTINUE:l=!0;(k=GetCurList(b))&&"OL"===k.nodeName&&(d=!0,l=!1);break;case ID_COMMAND_BOLD:case ID_COMMAND_ITALIC:case ID_COMMAND_UNDERLINE:case ID_COMMAND_STRIKE:case ID_COMMAND_SUBSCRIPT:case ID_COMMAND_SUPERSCRIPT:case ID_COMMAND_SELECT_ALL:case ID_COMMAND_HORIZONTAL_RULE:try{switch(f=
c.queryCommandState(e),d=0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?!0:c.queryCommandEnabled(e),a){case ID_COMMAND_BOLD:case ID_COMMAND_ITALIC:case ID_COMMAND_UNDERLINE:case ID_COMMAND_STRIKE:case ID_COMMAND_SUPERSCRIPT:case ID_COMMAND_SUBSCRIPT:var x=g_objEditWindow[b].getSelection(),g=0<x.rangeCount?x.getRangeAt(0):null,y=letterFunction.getInstance();if(g&&a===ID_COMMAND_SUPERSCRIPT){var h=g.commonAncestorContainer;3===h.nodeType&&(h=h.parentNode);if(!1===
fnObjectCheckNull(h)){var t=h.style.verticalAlign;!1===isNaN(parseInt(t,10))&&(d=f=!0)}}if(g&&!0===g.collapsed&&y.hasSavedStyle()){var w=y.getSavedCommand();b=0;switch(a){case ID_COMMAND_BOLD:b=DZE_LETTER_COMMAND_BOLD;break;case ID_COMMAND_ITALIC:b=DZE_LETTER_COMMAND_ITALIC;break;case ID_COMMAND_UNDERLINE:b=DZE_LETTER_COMMAND_UNDERLINE;break;case ID_COMMAND_STRIKE:b=DZE_LETTER_COMMAND_STRIKE;break;case ID_COMMAND_SUPERSCRIPT:b=DZE_LETTER_COMMAND_SUPERSCRIPT;break;case ID_COMMAND_SUBSCRIPT:b=DZE_LETTER_COMMAND_SUBSCRIPT}(w&
b)===b?d=f=!0:f=!1}else if(g&&!1===g.collapsed){var z=SelectionUtil.getRangeChildChk(b,e);v&&(z=SelectionUtil.getRangeFirstChildChk(b,e));z&&(d=f=!0)}else g&&!0!==g_bBrowserType_CR&&(a===ID_COMMAND_SUPERSCRIPT||a===ID_COMMAND_SUBSCRIPT)&&(h=g.commonAncestorContainer.parentNode,!1===fnObjectCheckNull(h)&&(t=h.style.verticalAlign,a===ID_COMMAND_SUPERSCRIPT&&!1===isNaN(parseInt(t,10))||a===ID_COMMAND_SUBSCRIPT&&-1<t.indexOf("sub")))&&(d=f=!0)}}catch(n){d=f=!1,dlog(n)}break;case ID_COMMAND_OUTDENT:case ID_COMMAND_INDENT:case ID_COMMAND_FORE_COLOR:case ID_COMMAND_BACK_COLOR:case ID_COMMAND_INSERT_IMAGE:case ID_COMMAND_SHAPES_INSERT:if(g_bBrowserType_IE)try{f=
c.queryCommandState(e),d=c.queryCommandEnabled(e)}catch(n){d=f=!1}else if(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP){try{f=c.queryCommandState(e)}catch(n){f=!1}d=c.queryCommandEnabled(e)}break;case ID_COMMAND_HYPERLINK_INSERT:d=g_readonlyMode||SelectionUtil.isMultiSelected(b)?!1:!0;break;case ID_COMMAND_HYPERLINK_REMOVE:g_readonlyMode||(d=g_objALinkMgr.getCurrentLink(b)?!0:!1);break;case ID_COMMAND_JUSTIFY_LEFT:case ID_COMMAND_JUSTIFY_CENTER:case ID_COMMAND_JUSTIFY_RIGHT:case ID_COMMAND_JUSTIFY_JUSTIFY:f=
!1;d=!0;1==r&&a==ID_COMMAND_JUSTIFY_LEFT?f=!0:2==r&&a==ID_COMMAND_JUSTIFY_CENTER?f=!0:3==r&&a==ID_COMMAND_JUSTIFY_RIGHT?f=!0:4==r&&a==ID_COMMAND_JUSTIFY_JUSTIFY&&(f=!0);break;case ID_COMMAND_UNDO:case ID_COMMAND_REDO:w=ID_STRING_NAME_UNCHECKED;var u=g_objUndoRedo.arrUndoRedoStruct[b];return w=u?a===ID_COMMAND_UNDO?0===u.nUndoRedoStackPos?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED:u.nUndoRedoStack_LastEventPos<=u.nUndoRedoStackPos?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;
case ID_COMMAND_FORM_TAG_SWITCH:return g_objTagUtil.bFormTagSwitch?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_INSERT_BOOKMARK:case ID_COMMAND_INSERT_OBJECT_MOVIE:case ID_COMMAND_FILE_LAYOUT:case ID_COMMAND_FILE_DOCFORM:return dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.getHeaderFooterEditMode()||a==ID_COMMAND_FILE_LAYOUT&&0<g_objSelectedShapesArray.length?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_ADD_TEXT:return!0===g_objShapeEvtMgr.isLine(g_objShapeEvtMgr.getCmdShapeType())||
1<g_objSelectedShapesArray.length?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_DELETE_PAGE:return 1===g_objPageControl.getTotalPageCount()?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_PASTE_PAGE:return null===pageManager.getInstance().getCopiedPage()?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_HELP:return ID_STRING_NAME_GRAY;case ID_COMMAND_VIEW_RULERBAR:return isShowedRulerBar()?ID_STRING_NAME_CHECKED:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_EDIT_PRIINT_PAGE_BREAK:case ID_COMMAND_INSERT_NEW_PAGE:return!0===
dzeUiConfig.bOfficeOnePageLongMode||g_objHeaderFooter.getHeaderFooterEditMode()||a==ID_COMMAND_EDIT_PRIINT_PAGE_BREAK&&(0<g_objSelectedShapesArray.length||null!==g_objShapeEvtMgr.getShapeTextContainer())||a==ID_COMMAND_EDIT_PRIINT_PAGE_BREAK&&dzeUiConfig.bOfficePgOverflowVisible||a==ID_COMMAND_EDIT_PRIINT_PAGE_BREAK&&GetCurTable(b)?ID_STRING_NAME_GRAY:GetCurTable(b)?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_CONV_KOREAN:var p=getTextInfoFromCurrPosition(b).value.trim();return 2>
p.length?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_REGIST_SCHEDULE:p=getTextInfoFromCurrPosition(b).value.trim();dlog("Date : "+/^(19|20)\d{2}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[0-1])$/.test(p));dlog("Date2 : "+date2_pattern.test(p));dlog("DateTime : "+/^(19|20)\d{2}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[0-1]) (0[0-9]|1[0-9]|2[0-3]):([0-5][0-9])$/.test(p));break;case ID_COMMAND_DISABLE_PRIVACY:case ID_COMMAND_PRIVACY_CHANGE_PASSWORD:var q=g_objEditWindow[g_objPageControl.nEditNumber].getSelection().anchorNode;
if(!q)return ID_STRING_NAME_GRAY;ID_SELECTION_TEXT_NODE==q.nodeType&&(q=q.parentNode);return q.getAttribute("privacyProtect")?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;case ID_COMMAND_DOCUMENT_SECURITY_SETTING:return fnObjectCheckNull(oneffice.parentFileContent)||""==oneffice.parentFileContent||fnObjectCheckNull(oneffice.parentFileContent.my_id)||oneffice.parentFileContent.my_id!=oneffice.parentFileContent.owner_id?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_ONEFFICE_CONNECT:return fnObjectCheckNull(oneffice.parentFileContent)||
""==oneffice.parentFileContent?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_EDIT_WATERMARK:case ID_COMMAND_DOC_SECURE_GRADE:return fnObjectCheckNull(oneffice.parentFileContent)||""==oneffice.parentFileContent||!0===g_readonlyMode?ID_STRING_NAME_GRAY:!fnObjectCheckNull(oneffice.parentFileContent.my_id)&&oneffice.parentFileContent.my_id==oneffice.parentFileContent.owner_id||"S"==oneffice.parentFileContent.share_perm?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;case ID_COMMAND_GET_BIZBOX_REPORT_LIST:return!0===
g_readonlyMode?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SELECT_FORMULA:case ID_COMMAND_TABLE_CELL_STYLE:case ID_COMMAND_TABLE_BORDER_TYPE:case ID_COMMAND_TABLE_BORDER_THICKNESS:case ID_COMMAND_TABLE_BORDER_COLOR:case ID_COMMAND_TABLE_ADD_ROW:case ID_COMMAND_TABLE_ADD_ROW_DOWN:case ID_COMMAND_TABLE_ADD_COL:case ID_COMMAND_TABLE_ADD_COL_RIGHT:case ID_COMMAND_TABLE_DELETE_ROW:case ID_COMMAND_TABLE_DELETE_COL:case ID_COMMAND_TABLE_DELETE_EXT:case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SPLIT_CELL:case ID_COMMAND_TABLE_STYLE:case ID_COMMAND_TABLE_CONVERT_TEXT:case ID_COMMAND_TABLE_CELL_BACKCOLOR:case ID_COMMAND_TABLE_CELL_SAME_WIDTH:case ID_COMMAND_TABLE_CELL_SAME_HEIGHT:return null;
default:return ID_STRING_NAME_UNCHECKED}if(f&&d)return ID_STRING_NAME_CHECKED;if(!f&&d)return ID_STRING_NAME_UNCHECKED;if(l)return ID_STRING_NAME_HIDE;if(!d)return ID_STRING_NAME_GRAY}catch(n){dalert(n)}return null},checkCommandStatusForShapes:function(c){try{var a=ID_STRING_NAME_UNCHECKED;switch(c){case ID_COMMAND_PASTE_EXT:case ID_COMMAND_COPY_EXT_STYLE:case ID_COMMAND_STYLE_PARAGRAPH:case ID_COMMAND_INDENT:case ID_COMMAND_OUTDENT:a=ID_STRING_NAME_GRAY;break;case ID_COMMAND_INSERT_UNORDERED_LIST:case ID_COMMAND_INSERT_ORDERED_LIST:case ID_COMMAND_STYLE_INCREASEORDER:case ID_COMMAND_STYLE_DECREASEORDER:case ID_COMMAND_STYLE_CASCADE_ORDERLIST:a=
ID_STRING_NAME_GRAY;break;case ID_COMMAND_HYPERLINK_INSERT:case ID_COMMAND_INSERT_BOOKMARK:case ID_COMMAND_EDIT_PRIINT_PAGE_BREAK:case ID_COMMAND_EDIT_WATERMARK:a=ID_STRING_NAME_GRAY;break;case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SELECT_FORMULA:case ID_COMMAND_TABLE_CELL_STYLE:case ID_COMMAND_TABLE_BORDER_TYPE:case ID_COMMAND_TABLE_BORDER_THICKNESS:case ID_COMMAND_TABLE_BORDER_COLOR:case ID_COMMAND_TABLE_ADD_ROW:case ID_COMMAND_TABLE_ADD_ROW_DOWN:case ID_COMMAND_TABLE_ADD_COL:case ID_COMMAND_TABLE_ADD_COL_RIGHT:case ID_COMMAND_TABLE_DELETE_ROW:case ID_COMMAND_TABLE_DELETE_COL:case ID_COMMAND_TABLE_DELETE_EXT:case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SPLIT_CELL:case ID_COMMAND_TABLE_STYLE:case ID_COMMAND_TABLE_CONVERT_TEXT:case ID_COMMAND_TABLE_CELL_BACKCOLOR:case ID_COMMAND_TABLE_CELL_SAME_WIDTH:case ID_COMMAND_TABLE_CELL_SAME_HEIGHT:return null}return a}catch(e){dalert(e)}},
setDisableMenu:function(c){var a=!0===g_objTableFunction.hasLockedCellInSelection()?!0:!1;"number"!=typeof c&&(c=Number(c));switch(c){case ID_COMMAND_CUT:case ID_COMMAND_PASTE:case ID_COMMAND_EDIT_PASTESPECIAL:case ID_COMMAND_DELETE:case ID_COMMAND_STYLE_FONT:case ID_COMMAND_STYLE_PARAGRAPH:case ID_COMMAND_STYLE_STYLE:case ID_COMMAND_STYLE_UNORDEREDLIST:case ID_COMMAND_STYLE_ORDEREDLIST:case ID_COMMAND_INSERT_ORDERED_LIST:case ID_COMMAND_INSERT_UNORDERED_LIST:case ID_COMMAND_JUSTIFY_LEFT:case ID_COMMAND_JUSTIFY_CENTER:case ID_COMMAND_JUSTIFY_RIGHT:case ID_COMMAND_JUSTIFY_JUSTIFY:case ID_COMMAND_OUTDENT:case ID_COMMAND_INDENT:case ID_COMMAND_INSERT_IMAGE:case ID_COMMAND_INSERT_OBJECT:case ID_COMMAND_INSERT_OBJECT_MOVIE:case ID_COMMAND_INSERT_OBJECT_FILE:case ID_COMMAND_INSERT_OBJECT_HR:case ID_COMMAND_INSERT_SPECIALCHARS:case ID_COMMAND_HYPERLINK_INSERT:case ID_COMMAND_IMAGE_PROPERTY:case ID_COMMAND_STYLE_INCREASE_FONTSIZE:case ID_COMMAND_STYLE_DECREASE_FONTSIZE:case ID_COMMAND_BOLD:case ID_COMMAND_ITALIC:case ID_COMMAND_UNDERLINE:case ID_COMMAND_STRIKE:case ID_COMMAND_SUPERSCRIPT:case ID_COMMAND_SUBSCRIPT:case ID_COMMAND_FORE_COLOR:case ID_COMMAND_BACK_COLOR:case ID_COMMAND_HEADING_SIZE:case ID_COMMAND_STYLE_TEMPLATE:case ID_COMMAND_STYLE_TEMPLATE_COMBO:case ID_COMMAND_FONT_NAME:case ID_COMMAND_FONT_SIZE:case ID_COMMAND_LINE_HEIGHT:case ID_COMMAND_LETTER_SPACING:case ID_COMMAND_PASTE_CELL:case ID_COMMAND_TABLE_CELL_PROPERTY:case ID_COMMAND_TABLE_CREATE:case ID_COMMAND_TABLE_CELL_STYLE:if(c===
ID_COMMAND_TABLE_CELL_STYLE&&!0===GetMultiCellSelection())return!1;case ID_COMMAND_TABLE_CELL_ALIGN:case ID_COMMAND_TABLE_CELL_BACKCOLOR:case ID_COMMAND_TABLE_MERGE_CELL:case ID_COMMAND_TABLE_SPLIT_CELL:case ID_COMMAND_TABLE_FORMULA:case ID_COMMAND_TABLE_FORMULA_EXT:case ID_COMMAND_TABLE_SELECT_FORMULA:case ID_COMMAND_TABLE_NUMBER_FORMAT:return a?!0:!1;case ID_COMMAND_TABLE_DELETE_ROW:return g_objTableFunction.isIncludedProtectedCellInRow();case ID_COMMAND_TABLE_DELETE_COL:return g_objTableFunction.isIncludedProtectedCellInColumn();
case ID_COMMAND_TABLE_DELETE_TABLE:case ID_COMMAND_TABLE_CONVERT_TEXT:return!0;default:return!1}}};
var updateHandlerUI={disableToolbarList:[],addDisableToolbarList:function(b){for(var a=0,c=arguments.length;a<c;a++)isNaN(arguments[a])||this.disableToolbarList.push(arguments[a])},update_toolbar_button:function(b,a){try{for(var c=g_objEditorDocument[a],e=GetMultiCellSelection(a),d=getAlignValueForSelectionArea(a),f=0,h=g_TBButton[a].length;f<h;f++){var l=g_TBButton[a][f].command_id,g=g_TBButton[a][f].element,m=g_TBButton[a][f].element.command,k=g_TBButton[a][f].support_type;if(!g.isShow||!1!==g.isShow())if(dzeUiConfig.bSupportNewsEditor&&
this.updateMenuNameForDocState(l,g),e&&ID_SUPPORT_TYPE_MULTI_CELL!==k&&ID_SUPPORT_TYPE_TABLE_OPERATION!==k&&ID_SUPPORT_TYPE_PERSISTENCE!==k||inArray(l,this.disableToolbarList))TBSetState(g_TBButton[a][f].element,ID_STRING_NAME_GRAY,g_TBButton[a][f].button_type);else{var n=ID_STRING_NAME_UNCHECKED;n=0<g_objSelectedShapesArray.length?handlerUI.checkCommandStatusForShapes(l):handlerUI.queryCommandStatus(c,l,m,a,d,b);var p=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(p=handlerUI.setDisableMenu(l));
n=1==p?ID_STRING_NAME_GRAY:n;null!=n&&TBSetState(g,n,g_TBButton[a][f].button_type)}}f=0;for(h=g_TBDropDown[a].length;f<h;f++)l=g_TBDropDown[a][f].command_id,g=g_TBDropDown[a][f].element,k=g_TBDropDown[a][f].support_type,g.isShow&&!1===g.isShow()||(e&&ID_SUPPORT_TYPE_MULTI_CELL!==k&&ID_SUPPORT_TYPE_PERSISTENCE!==k||inArray(l,this.disableToolbarList))&&TBSetState(g_TBDropDown[a][f].element,ID_STRING_NAME_GRAY,g_TBDropDown[a][f].button_type)}catch(q){dalert(q)}},update_toolbar_combobox:function(b,a){try{b=
!1;var c=GetMultiCellSelection(a),e=g_objPropertyUtil.getSelectionAttributeValue(a);if("undefined"!=typeof e&&null!=e){duzon_dialog.initSelectionFontStyleList(e);for(var d=0,f=g_TBComboBox[a].length;d<f;d++){var h=g_TBComboBox[a][d].element,l=g_TBComboBox[a][d].element.command,g=g_TBComboBox[a][d].element.command_id,m=g_TBComboBox[a][d].support_type;if(!h.isShow||!1!==h.isShow())if(c&&ID_SUPPORT_TYPE_MULTI_CELL!==m&&ID_SUPPORT_TYPE_PERSISTENCE!==m||inArray(g,this.disableToolbarList))TBSetState(g_TBComboBox[a][d].element,
ID_STRING_NAME_GRAY,g_TBComboBox[a][d].button_type);else{if(g==ID_COMMAND_FONT_NAME||g==ID_COMMAND_FONT_SIZE||g==ID_COMMAND_HEADING_SIZE)if(c)b=!0;else try{b=(g==ID_COMMAND_FONT_NAME||g==ID_COMMAND_FONT_SIZE)&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?handlerUI.checkCommandStatusForShapes(g)===ID_STRING_NAME_UNCHECKED:g_objEditorDocument[a].queryCommandEnabled(l)}catch(q){b=!1}else if(g==ID_COMMAND_LETTER_SPACING||g==ID_COMMAND_LINE_HEIGHT)if(c)b=!0;else try{b=
0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?handlerUI.checkCommandStatusForShapes(g)===ID_STRING_NAME_UNCHECKED:g_objEditorDocument[a].queryCommandEnabled("FontName")}catch(q){b=!1}else if(g===ID_COMMAND_STYLE_TEMPLATE_COMBO)b=getEnableStyleTemplate(a);else break;var k=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(k=handlerUI.setDisableMenu(g));if(b=1==k?!1:b)if(TBSetState(h,ID_STRING_NAME_UNCHECKED,g_TBComboBox[a][d].button_type),k=-1,g==ID_COMMAND_FONT_NAME)g_TBComboBoxLabel[a][d].element.innerHTML=
""==duzon_dialog.selectionFontStyleList.fontFamily?"<span>"+ID_RES_CONST_STRING_FONT_NAME+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.fontFamily.replace(/["']/g,"")+"</span>";else if(g==ID_COMMAND_FONT_SIZE)g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.fontSize?"<span>"+ID_RES_CONST_STRING_FONT_SIZE+"</span>":"<span>"+duzon_dialog.selectionFontStyleList.fontSize+"</span>";else if(g==ID_COMMAND_HEADING_SIZE)k=this.getMappingIndex_Heading(a),-1==k&&(k=
0),g_TBComboBoxLabel[a][d].element.innerHTML=0==k?"<span>"+ID_RES_CONST_STRING_HEADING_SIZE+"</span>":"<span>"+g_objComboBoxWin.arrHeadingText[k]+"</span>";else if(g===ID_COMMAND_STYLE_TEMPLATE_COMBO){k=this.getMappingIndex_StyleTemplate(a);-1==k&&(k=0);var n=getStyleTemplateName();n&&(g_TBComboBoxLabel[a][d].element.innerHTML="<span>"+n[k]+"</span>")}else g==ID_COMMAND_LETTER_SPACING?g_TBComboBoxLabel[a][d].element.innerHTML=""==duzon_dialog.selectionFontStyleList.letterSpacing?"<span>"+ID_RES_CONST_STRING_LETTER_SPACING+
"</span>":"<span>"+duzon_dialog.selectionFontStyleList.letterSpacing+"</span>":g==ID_COMMAND_LINE_HEIGHT&&(null==e[5]&&(e[5]=""),g_TBComboBoxLabel[a][d].element.innerHTML=null==e[5]||""==e[5]?"<span>"+ID_RES_CONST_STRING_LINE_HEIGHT+"</span>":"<span>"+parseInt(Math.round(100*parseFloat(e[5])),10)+"%</span>");else{TBSetState(h,ID_STRING_NAME_GRAY,g_TBComboBox[a][d].button_type);var p=g_objNodeUtil.getChildrenCollection(g_TBComboBoxLabel[a][d].element);if(null==p)break;for(k=0;k<p.length;k++)ID_SELECTION_ELEMENT_NODE==
p[k].nodeType&&(p[k].style.display="none")}}}}}catch(q){dalert(q)}},getMappingIndex_FontName:function(b,a){try{for(a=0;a<g_arrFontName.length;a++){if("undefined"==typeof b||null==b||""==b)return 0;if(b.toLowerCase().replace(/(^'|'$)/g,"")==g_arrFontName[a].replace(/(^'|'$)/g,""))return a}return-1}catch(c){dalert(c)}},updateMenuNameForDocState:function(b,a){try{switch(b){case ID_COMMAND_POST_NEWS:if(!1===fnObjectCheckNull(dzeUiConfig.nBizwatchArticleId)&&0<parseInt(dzeUiConfig.nBizwatchArticleId)&&
a.getAttribute("title")==ID_RES_STRING_POST_NEWS){a.setAttribute("title",ID_RES_STRING_UPDATE_POSTED_NEWS);var c=a.getElementsByClassName("dze_ribbon_tb_item_text")[0];if(c)switch(c.nodeName.toLowerCase()){case DZETAG.DIV:3==c.childNodes[2].nodeType&&(c.childNodes[2].nodeValue=c.childNodes[2].nodeValue.replace("\ub4f1\ub85d","\uc5c5\ub370\uc774\ud2b8"));break;case DZETAG.IMG:c.getAttribute("alt")==ID_RES_STRING_POST_NEWS&&c.setAttribute("alt",ID_RES_STRING_UPDATE_POSTED_NEWS),c.nodeValue.replace("\ub4f1\ub85d",
"\uc5c5\ub370\uc774\ud2b8")}}}}catch(e){dlaert(e)}},getMappingIndex_FontSize:function(b,a){try{if(null==b)return-1;for(a=0;a<g_objComboBoxWin.arrFontSize.length;a++)if(b==g_objComboBoxWin.arrFontSize[a])return a;b=b.toLowerCase();a=-1;"11px"==b?a=1:"12px"==b?a=2:"13px"==b?a=3:"15px"==b?a=4:"16px"==b?a=5:"17px"==b?a=6:"19px"==b?a=7:"21px"==b?a=8:"22px"==b?a=9:"23px"==b?a=10:"24px"==b?a=11:"25px"==b?a=12:"26px"==b?a=13:"32px"==b?a=14:"40px"==b?a=15:"48px"==b&&(a=16);return a}catch(c){dalert(c)}},getMappingIndex_LetterSpacing:function(b,
a){try{if(null==b)return-1;b=b.toLowerCase();for(a=0;a<g_objLetterSpacingWin.arrLetterSpacing.length;a++)if(b==g_objLetterSpacingWin.arrLetterSpacing[a])return a;return-1}catch(c){dalert(c)}},getMappingIndex_LineHeight:function(b,a){try{if(null==b)return-1;for(a=0;a<g_objLineHeightWin.arrLineHeight.length;a++)if(b==g_objLineHeightWin.arrLineHeight[a])return a;return-1}catch(c){dalert(c)}},getMappingIndex_Heading:function(b){try{var a=-1;if(window.attachEvent){var c=g_objEditorDocument[b].selection,
e=c.createRange(),d=e.parentElement();""==e.text?a=this.getLoop_ParentHeadingBlock(d):this.is_Include_heading_block(d)||(a=this.getLoop_ParentHeadingBlock(d))}else{c=g_objEditWindow[b].getSelection();if(1!=c.rangeCount)return-1;e=c.getRangeAt(0);d=e.commonAncestorContainer;ID_SELECTION_TEXT_NODE==d.nodeType?(d=g_objNodeUtil.getParentElement(d),a=this.getLoop_ParentHeadingBlock(d)):this.is_Include_heading_block(d)||(a=this.getLoop_ParentHeadingBlock(d))}return a}catch(f){dalert(f)}return-1},getLoop_ParentHeadingBlock:function(b){try{if(fnObjectCheckNull(b)||
ID_SELECTION_ELEMENT_NODE!=b.nodeType)return-1;var a=b.nodeName.toLowerCase();if("body"==a)return-1;var c=this.checkIsHeadingBlock(a);if(-1!=c)return c;for(;;){var e=g_objNodeUtil.getParentElement(b);if(fnObjectCheckNull(e))break;a=e.nodeName.toLowerCase();if("body"==a)break;c=this.checkIsHeadingBlock(a);if(-1!=c)return c;b=e}}catch(d){dalert(d)}return-1},checkIsHeadingBlock:function(b){try{for(var a=1;a<g_objComboBoxWin.arrHeadingBlock.length;a++)if(b==g_objComboBoxWin.arrHeadingBlock[a])return a}catch(c){dalert(c)}return-1},
is_Include_heading_block:function(b){try{if(null==b)return!1;for(var a=0;a<b.childNodes.length;a++){var c=b.childNodes[a];if(ID_SELECTION_ELEMENT_NODE==c.nodeType){var e=c.nodeName.toLowerCase();if(-1!=updateHandlerUI.checkIsHeadingBlock(e)||this.is_Include_heading_block(c))return!0}}}catch(d){dalert(d)}return!1},getMappingIndex_StyleTemplate:function(b){try{var a=getStyleTemplate(b);return g_objComboBoxWin.arrStyleTemplateName.indexOf(a)}catch(c){dalert(c)}},update_toolbar_dropdown:function(b,a){try{for(var c=
g_objEditorDocument[a],e=0,d=g_TBDropDown[a].length;e<d;e++){var f=g_TBDropDown[a][e].element,h=g_TBDropDown[a][e].element.command,l=g_TBDropDown[a][e].element.command_id;if(!f.isShow||!1!==f.isShow())if(""!=h){var g=ID_STRING_NAME_UNCHECKED;g=0<g_objSelectedShapesArray.length?handlerUI.checkCommandStatusForShapes(l):handlerUI.queryCommandStatus(c,l,h,a,-1,b);var m=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(m=handlerUI.setDisableMenu(l));g=1==m?ID_STRING_NAME_GRAY:g;null!=g&&TBSetState(f,
g,g_TBDropDown[a][e].button_type)}else dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(m=handlerUI.setDisableMenu(l),1==m&&TBSetState(f,ID_STRING_NAME_GRAY,g_TBDropDown[a][e].button_type))}}catch(k){dalert(k)}},setStateButton:function(b,a,c,e){try{var d=handlerUI.getCommandUpdateIndex(b,a);-1!=d&&(a=null,ID_TB_QUERY_STATUS_BUTTON==c?a=g_TBButton[b][d].element:ID_TB_QUERY_STATUS_COMBOBOX==c?a=g_TBComboBox[b][d].element:ID_TB_QUERY_STATUS_DROPDOWN==c&&(a=g_TBDropDown[b][d].element),TBSetState(a,
e,c))}catch(f){dalert(f)}},update_toolbar_manual:function(b,a,c){try{b=ID_STRING_NAME_UNCHECKED;var e=[[ID_COMMAND_TABLE_CREATE,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_DOC_TEMPLETE,ID_TB_QUERY_STATUS_BUTTON],[ID_COMMAND_INSERT_EMOTICONS,ID_TYPE_TOOLBAR_BUTTON],[ID_COMMAND_SHAPES_INSERT,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SELECT_PARAGRAPH,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_STYLE_STYLE,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_HIGHLIGHTER,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_HEADER,ID_TB_QUERY_STATUS_DROPDOWN],
[ID_COMMAND_FOOTER,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_HEADER_FOOTER_OPTIONS,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_MOVE_FRONT,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_MOVE_BACK,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_TEXT_VERTICAL_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_LAYOUT,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_ALIGN,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_ROTATE,ID_TB_QUERY_STATUS_DROPDOWN],[ID_COMMAND_SHAPES_STYLE,ID_TB_QUERY_STATUS_DROPDOWN],
[ID_COMMAND_SHAPES_CHANGE,ID_TB_QUERY_STATUS_DROPDOWN]];if(!0!==a)for(var d=[ID_COMMAND_IMAGE_BORDER_TYPE,ID_COMMAND_IMAGE_BORDER_THICKNESS,ID_COMMAND_IMAGE_BORDER_COLOR,ID_COMMAND_VIDEO_BORDER_TYPE,ID_COMMAND_VIDEO_BORDER_THICKNESS,ID_COMMAND_VIDEO_BORDER_COLOR,ID_COMMAND_SHAPES_FILL],f=0;f<d.length;f++)e[e.length]=[d[f],ID_TB_QUERY_STATUS_DROPDOWN];else b=ID_STRING_NAME_GRAY;var h=GetMultiCellSelection(c);for(d=0;d<e.length;d++)if(b===ID_STRING_NAME_GRAY)this.setStateButton(c,e[d][0],e[d][1],b);
else{var l=null;var g="";!0===dzeUiConfig.bUseLockEditCellFunction&&(l=handlerUI.setDisableMenu(e[d][0]));l=!0===l?l:a;g=!0===l?ID_STRING_NAME_GRAY:ID_STRING_NAME_UNCHECKED;var m=e[d][0];var k=g_arrConst[m][4];if(m===ID_COMMAND_SHAPES_CHANGE||m===ID_COMMAND_SHAPES_FILL||m===ID_COMMAND_SHAPES_TEXT_VERTICAL_ALIGN)for(f=0;f<g_objSelectedShapesArray.length;f++){var n=g_objSelectedShapesArray[f];var p=1*n.getAttribute("shape_type");if(!0===g_objShapeEvtMgr.isLine(p))g=ID_STRING_NAME_GRAY;else{g=ID_STRING_NAME_UNCHECKED;
break}}else m===ID_COMMAND_STYLE_STYLE?0<g_objSelectedShapesArray.length&&(g=ID_STRING_NAME_GRAY):h&&ID_SUPPORT_TYPE_MULTI_CELL!==k&&ID_SUPPORT_TYPE_PERSISTENCE!==k&&(g=ID_STRING_NAME_GRAY);this.setStateButton(c,e[d][0],e[d][1],g)}this.setStateButton(c,ID_COMMAND_HIDE_MINIBAR,ID_TB_QUERY_STATUS_BUTTON,null);this.setNoneSelectGrayList(ID_TB_QUERY_STATUS_BUTTON,c);this.setNoneSelectGrayList(ID_TB_QUERY_STATUS_DROPDOWN,c)}catch(q){dalert(q)}},update_context_menu:function(b,a,c,e){try{for(var d=g_objEditorDocument[e],
f=0;f<g_objContextMenuWin.arrTBContextMenuItem[b].length;f++){var h=g_objContextMenuWin.arrTBContextMenuItem[b][f],l=g_objContextMenuWin.arrTBContextMenuItem[b][f].command,g=g_objContextMenuWin.arrTBContextMenuItem[b][f].command_id;if(!0===g_readonlyMode)g_objMenuWin.TBSubMenuSetState(h,ID_STRING_NAME_GRAY);else if("img"==c&&ID_COMMAND_INSERT_IMAGE==g)g_objMenuWin.TBSubMenuSetState(h,ID_STRING_NAME_UNCHECKED);else{var m=handlerUI.queryCommandStatus(d,g,l,e,-1,a);null==m&&h.TBSTATE==ID_STRING_NAME_UNCHECKED&&
(m=ID_STRING_NAME_UNCHECKED);null!=m&&g_objMenuWin.TBSubMenuSetState(h,m)}}}catch(k){dalert(k)}},update_toolbar_for_locked_cell_option:function(b){try{for(var a,c,e,d=0,f=g_TBButton[b].length;d<f;d++)a=g_TBButton[b][d].command_id,c=g_TBButton[b][d].element,c.isShow&&!1===c.isShow()||(e=handlerUI.setDisableMenu(a))&&TBSetState(c,ID_STRING_NAME_GRAY,g_TBButton[b][d].button_type);d=0;for(f=g_TBDropDown[b].length;d<f;d++)a=g_TBDropDown[b][d].command_id,c=g_TBDropDown[b][d].element,c.isShow&&!1===c.isShow()||
(e=handlerUI.setDisableMenu(a))&&TBSetState(c,ID_STRING_NAME_GRAY,g_TBDropDown[b][d].button_type)}catch(h){dalert(h)}},setNoneSelectGrayList:function(b,a){var c=null;if(b!==ID_TB_QUERY_STATUS_BUTTON&&b!==ID_TB_QUERY_STATUS_COMBOBOX&&b!==ID_TB_QUERY_STATUS_DROPDOWN)dalert("getNoneSelectGrayList \ud30c\ub77c\uba54\ud0c0 tbQueryStatus \ub294 "+ID_TB_QUERY_STATUS_BUTTON+", "+ID_TB_QUERY_STATUS_COMBOBOX+", "+ID_TB_QUERY_STATUS_DROPDOWN+" \uc911\uc5d0 \ud558\ub098\ub9cc \uac00\ub2a5\ud569\ub2c8\ub2e4.");
else if(g_objEditWindow&&g_objEditWindow[a]&&g_objEditWindow[a].getSelection()&&g_objEditWindow[a].getSelection().type&&"None"===g_objEditWindow[a].getSelection().type&&(b===ID_TB_QUERY_STATUS_BUTTON?c=[ID_COMMAND_STYLE_FONT,ID_COMMAND_STYLE_PARAGRAPH,ID_COMMAND_STYLE_INCREASEORDER,ID_COMMAND_STYLE_DECREASEORDER,ID_COMMAND_EDIT_REPLACE_CASE,ID_COMMAND_STYLE_INCREASE_FONTSIZE,ID_COMMAND_STYLE_DECREASE_FONTSIZE,ID_COMMAND_JUSTIFY_LEFT,ID_COMMAND_JUSTIFY_CENTER,ID_COMMAND_JUSTIFY_RIGHT,ID_COMMAND_JUSTIFY_JUSTIFY]:
b!==ID_TB_QUERY_STATUS_COMBOBOX&&b===ID_TB_QUERY_STATUS_DROPDOWN&&(c=[ID_COMMAND_STYLE_CASCADE_ORDERLIST,ID_COMMAND_STYLE_STYLE])),c&&0<c.length){var e=this;c.forEach(function(c){e.setStateButton(a,c,b,ID_STRING_NAME_GRAY)})}},update_mobile_menu:function(b){try{var a=letterFunction.getInstance().hasSavedStyle(),c=0,e={},d=GetCurRange(b);if(d.collapsed)var f=d.commonAncestorContainer;else switch(f=d.startContainer,f.nodeName){case "P":case "LI":case "H1":case "H2":case "H3":case "H4":case "H5":case "H6":f=
f.childNodes[d.startOffset]}3===f.nodeType&&(f=f.parentNode);var h=g_objNodeUtil.getInlineTextStyle(f);if(!0===a){c=letterFunction.getInstance().getSavedCommand();e={size:h.size,family:h.family,color:h.color,bgColor:h.bgColor,bold:(c&DZE_LETTER_COMMAND_BOLD)===DZE_LETTER_COMMAND_BOLD,italic:(c&DZE_LETTER_COMMAND_ITALIC)===DZE_LETTER_COMMAND_ITALIC,underline:(c&DZE_LETTER_COMMAND_UNDERLINE)===DZE_LETTER_COMMAND_UNDERLINE,strike:(c&DZE_LETTER_COMMAND_STRIKE)===DZE_LETTER_COMMAND_STRIKE,super:(c&DZE_LETTER_COMMAND_SUPERSCRIPT)===
DZE_LETTER_COMMAND_SUPERSCRIPT,sub:(c&DZE_LETTER_COMMAND_SUBSCRIPT)===DZE_LETTER_COMMAND_SUBSCRIPT,unorderlist:!1,orderlist:!1,textalign:0,lineHeight:h.lineHeight};var l=letterFunction.getInstance().getSavedStyle();(c&DZE_LETTER_COMMAND_FONT_SIZE)===DZE_LETTER_COMMAND_FONT_SIZE&&(e.size=l.style.fontSize);(c&DZE_LETTER_COMMAND_FONT_FAMILY)===DZE_LETTER_COMMAND_FONT_FAMILY&&(e.family=l.style.fontFamily)}else e={size:h.size,family:h.family,color:h.color,bgColor:h.bgColor,bold:"bold"===h.bold,italic:"italic"===
h.italic,underline:-1<h.textDeco.indexOf("underline"),strike:-1<h.textDeco.indexOf("line-through"),super:!1,sub:!1,unorderlist:!1,orderlist:!1,textalign:0,lineHeight:h.lineHeight},"baseline"!==h.subscript&&("sub"===h.subscript.type?e.sub=!0:e.super=!0);f=g_objNodeUtil.getLoopParentElementByTagNames(f,"p li h1 h2 h3 h4 h5 h6".split(" "),!0);if(!fnObjectCheckNull(f)){switch(f.style.textAlign){case "left":e.textalign=1;break;case "center":e.textalign=2;break;case "right":e.textalign=3;break;case "justify":e.textalign=
4}"LI"===f.nodeName&&(f=f.parentNode,"OL"===f.nodeName?e.orderlist=!0:e.unorderlist=!0)}MobileEventUtil.sendHybridMessage("style_chunk",e);var g=g_objUndoRedo.arrUndoRedoStruct[b];c=a=!1;0<g.nUndoRedoStack_LastEventPos&&(0<g.nUndoRedoStackPos&&(a=!0),g.nUndoRedoStackPos<g.nUndoRedoStack_LastEventPos&&(c=!0));MobileEventUtil.sendHybridMessage("undoStatus",a);MobileEventUtil.sendHybridMessage("redoStatus",c);MobileEventUtil.sendHybridMessage("saveStatus",oneffice.bModified);var m=GetCurTable(b)?!0:
!1;MobileEventUtil.sendHybridMessage("tableStatus",m)}catch(k){dalert(k)}}};
var updateTableHandlerUI={nEditNumber:0,curEnableForRibbon:{},curEnableForContext:{},clearCache:function(){try{this.curEnableForRibbon={},this.curEnableForContext={}}catch(b){dalert(b)}},setStateTableButton:function(b,c){try{if(this.curEnableForRibbon[b]!==c){this.curEnableForRibbon[b]=c;var d=handlerUI.getCommandUpdateIndex(this.nEditNumber,b);if(-1!=d){c=c?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;var a=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(a=handlerUI.setDisableMenu(b));
c=1==a?ID_STRING_NAME_GRAY:c;a=null;var f=g_arrConst[b][6];switch(f){case ID_TB_QUERY_STATUS_DROPDOWN:a=g_TBDropDown[this.nEditNumber][d].element;break;case ID_TB_QUERY_STATUS_BUTTON:a=g_TBButton[this.nEditNumber][d].element}TBSetState(a,c,f)}}}catch(e){dalert(e)}},updateTableUIHandler:function(b,c){try{this.nEditNumber=b;c=c||GetCurTable(b);if(!c&&dzeUiConfig.bUseUiMode&&"ribbon"===dze_menu_control.ui_mode)return!1;var d=this.setStateTableButton.bind(this);return this.updateTableCommand(d,c)}catch(a){dalert(a)}},
setStateTableContextMenu:function(b,c,d,a){try{this.curEnableForContext[c]=a;var f=handlerUI.getContextUpdateIndex(b,c);-1!=f&&(b=a?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY,a=null,dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(a=handlerUI.setDisableMenu(c)),b=1==a?ID_STRING_NAME_GRAY:b,g_objMenuWin.TBSubMenuSetState(d[f],b))}catch(e){dalert(e)}},updateTableContextMenuUIHandler:function(b,c,d){try{var a=function(a,d){this.setStateTableContextMenu(b,a,c,d)}.bind(this);return this.updateTableCommand(a,
d)}catch(f){dalert(f)}},setStateTableMenu:function(b,c,d){try{var a=handlerUI.getMenuTableUpdateIndex(b);if(-1!=a){d=d?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_GRAY;var f=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(f=handlerUI.setDisableMenu(b));d=1==f?ID_STRING_NAME_GRAY:d;g_objMenuWin.TBSubMenuSetState(c[a],d)}}catch(e){dalert(e)}},updateTableMenuUIHandler:function(){try{var b=g_objMenuWin.objSubMenuItem[ID_COMMAND_MENU_TABLE_INDEX],c=function(c,a){this.setStateTableMenu(c,b,a)}.bind(this);
return this.updateTableCommand(c)}catch(d){dalert(d)}},updateTableCommand:function(b,c){try{if(!b)return!1;var d=g_nActiveEditNumber;c=c||GetCurTable(d);var a=!c||dzeUiConfig.bUseShapesFeature&&0!==g_objSelectedShapesArray.length||!1===g_objEditMode.isContentEditable(c)?!1:!0,f=a?GetSelectedCellCount(d,c):-1;a&&GetMultiCellSelection(d);var e=a?g_objTableUtil.isProtect(c):!1;b(ID_COMMAND_LOCK_EDIT_CELL,a);b(ID_COMMAND_TABLE_ADD_COL,a&&!e);b(ID_COMMAND_TABLE_ADD_COL_RIGHT,a&&!e);b(ID_COMMAND_TABLE_ADD_ROW_COL,
a);b(ID_COMMAND_TABLE_DELETE_ROW,a);b(ID_COMMAND_TABLE_DELETE_COL,a);b(ID_COMMAND_TABLE_SPLIT_CELL,a&&!e);b(ID_COMMAND_TABLE_SPLIT_ROW,a);b(ID_COMMAND_TABLE_SPLIT_COL,a);b(ID_COMMAND_TABLE_ADD_ROW,a&&!e);b(ID_COMMAND_TABLE_ADD_ROW_DOWN,a&&!e);b(ID_COMMAND_TABLE_COPY_ROW_DOWN,a);b(ID_COMMAND_TABLE_CELL_SAME_WIDTH,a);b(ID_COMMAND_TABLE_CELL_SAME_HEIGHT,a);b(ID_COMMAND_TABLE_CONVERT_TEXT,a&&!e);b(ID_COMMAND_TABLE_PROPERTY,a);b(ID_COMMAND_TABLE_CELL_PROPERTY,a);b(ID_COMMAND_TABLE_CELL_STYLE,a&&!e);b(ID_COMMAND_COPY,
a);b(ID_COMMAND_TABLE_DELETE_EXT,a);b(ID_COMMAND_TABLE_NUMBER_FORMAT,a);b(ID_COMMAND_TABLE_BORDER_THICKNESS,a&&!e);b(ID_COMMAND_TABLE_BORDER_TYPE,a&&!e);b(ID_COMMAND_TABLE_BORDER_COLOR,a&&!e);b(ID_COMMAND_TABLE_STYLE,a&&!e);b(ID_COMMAND_COPY_EXT,a);b(ID_COMMAND_TABLE_SELECT,a);b(ID_COMMAND_TABLE_FORMULA,a);b(ID_COMMAND_TABLE_FORMULA_EXT,a);b(ID_COMMAND_TABLE_CELL_ALIGN,a);b(ID_COMMAND_TABLE_CELL_BACKCOLOR,a&&!e);b(ID_COMMAND_TABLE_MERGE_CELL,a&&!e&&1<f);b(ID_COMMAND_TABLE_SELECT_FORMULA,0===f);b(ID_COMMAND_TABLE_CELL_INSERT,
a&&!e);b(ID_COMMAND_TABLE_CELL_DELETE,a&&!e);return!0}catch(g){dalert(g)}}};
function GetCurTableInfo(n){try{return"undefined"==typeof n&&(n=g_nActiveEditNumber),GetTableInfo(GetCurRange(n))}catch(b){dalert(b)}}
function GetTableInfo(n){try{if(!n)return null;var b=n.endContainer.childNodes[n.endOffset]||n.endContainer,a=null,c=null,d=null,e=null,h=g_objNodeUtil,f=h.arrCellTagName;a=h.getLoopParentElementByTagNames(n.startContainer.childNodes[n.startOffset]||n.startContainer,f);if(!a)return null;d=h.getLoopParentElement(a,"table");if(!d)return null;if(n.collapsed)return{table:d,cell:a,endCell:a};c=h.getLoopParentElementByTagNames(b,f);return c?a===c?{table:d,cell:a,endCell:a}:(e=h.getLoopParentElement(c,"table"))&&
g_objTableUtil.getSplitTables(d).some(function(a){return e===a})?{table:d,cell:a,endCell:c}:null:null}catch(g){dalert(g)}}function GetCurTable(n){try{var b=GetCurTableInfo(n);return b?b.table:null}catch(a){dalert(a)}}function GetCurCell(n){try{var b=GetCurTableInfo(n);return b?b.cell:null}catch(a){dalert(a)}}function GetMultiCellSelection(n){try{var b=GetCurCell(n);return b&&g_objTableSelection.isCellSelected(b)?!0:!1}catch(a){dalert(a)}}
function GetSelectedCellCount(n,b){try{var a=b||GetCurTable(n);if(!a)return 0;var c=0,d=g_objTableUtil.getSplitTables(a);forEach(d,function(a,b){(a=b.querySelectorAll("td[cusflag], th[cusflag]"))&&(c+=a.length)});return c}catch(e){dalert(e)}}
var g_objTableSelection=new function(){function n(){this.init();return this}this.STATE_NONE=this.state=0;this.STATE_SELECT_CELL=1;this.getState=function(){return this.state};this.curCellForKeyUp=null;n.prototype.deselectPrevCell=function(){try{if(this.matrix)for(var b=g_objTableSelection,a=this.sy;a<=this.ey;a++)for(var c=this.sx;c<=this.ex;c++)this.matrix.isShow(a,c)&&b.deselectCell(this.matrix.getCell(a,c))}catch(d){dalert(d)}};n.prototype.init=function(){try{this.lastCell=this.firstCell=this.startCell=
this.startTable=this.matrix=null,this.nCellCount=0,this.start_midx=null,this.ex=this.ey=this.sx=this.sy=0,this.bMouseUp=!1}catch(b){dalert(b)}};this.prevSel=new n;this.doAllTable=function(b,a){try{if(b&&(a=a||GetCurTable())){var c=g_objTableUtil.getSplitTables(a);a=0;for(var d=c.length;a<d;a++)b(c[a])}}catch(e){}};this.doAllSelectedCell=function(b,a){try{if(b&&(a=a||GetCurTable()))for(var c=GetCurCell(),d=g_objTableUtil.getSplitTables(a),e=a=null,h=null,f=0,g=0,k=d.length;g<k;g++){a=d[g];for(var m=
0,l=a.rows.length;m<l;m++,f++){e=a.rows[m];for(var p=0,n=e.cells.length;p<n;p++)((h=e.cells[p])&&h.hasAttribute("cusflag")||c&&c==h)&&b(h,f,p,m,p,a,n,g)}}}catch(q){}};this.doAllCell=function(b,a){try{if(b&&(a=a||GetCurTable()))for(var c=g_objTableUtil.getSplitTables(a),d=a=null,e=null,h=0,f=0,g=c.length;f<g;f++){a=c[f];for(var k=0,m=a.rows.length;k<m;k++,h++){d=a.rows[k];for(var l=0,p=d.cells.length;l<p;l++)(e=d.cells[l])&&b(e,h,l,k,l,a,p)}}}catch(v){}};this.doEvent=function(b,a){try{switch(b.type){case "mousedown":return this.onMouseDown(b,
a);case "mousemove":return this.onMouseMove(b,a);case "mouseup":return this.onMouseUp(b,a);case "touchstart":return this.onTouchStart(b,a);case "touchmove":return this.onTouchMove(b,a);case "touchend":return this.onTouchEnd(b,a);case "click":return this.onClick(b,a)}}catch(c){dalert(c)}};this.canSelect=function(b,a){try{return!g_bTableOperationYN||!b||g_objVideoControl.getResizeStatus()||letterFunction.getInstance().hasCopyedStyle()||g_objPropertyUtil.hasClass(g_objEditorDocument[a].body,"unselectable")?
!1:!0}catch(c){dalert(c)}};this.onMouseDown=function(b,a){try{if(!this.canSelect(b,a))return!1;var c=b.target||b.srcElement;if(!c)return!1;var d=g_objNodeUtil,e=d.getLoopParentElementByTagNames(c,d.arrCellTagName),h=d.getLoopParentElement(e,"tr"),f=d.getLoopParentElement(h,"table"),g=GetCurTable(a);f&&g_objTableUtil.getSplitTables(f).some(function(a){return g==a})||(this.clearCellSelection(g),g_objTableFlag.ResetTableInfo(!1),this.state=this.STATE_NONE);if(e&&h&&f){var k=!1;this.doAllTable(function(a){k||
a!==g||(k=!0)},f);var m=GetMultiCellSelection(a);if(k&&b.shiftKey&&!DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)&&!b.altKey&&this.onMouseDown_multiCellSelection(b,e))return setSelectionColor(a,"transparent"),TBCancelBubbleEvent(b),!0;var l=m&&this.isCellSelected(e),p=2===b.buttons;if(!k||p&&!l||!p)g_objTableFlag.ResetTableInfo(!1),this.clearCellSelection(g),this.nCellCount=0;this.prevSel.init();this.prevSel.startTable=f;this.prevSel.startCell=e;this.prevSel.firstCell=e;this.prevSel.lastCell=
e;dzeUiConfig.bUseLockEditCellFunction&&(g_arrLockedCells=g_objTableFunction.getLockedCells(f),!1===fnObjectCheckNull(g_arrLockedCells)&&0<g_arrLockedCells.length&&(g_bHasLockedCell=!0));this.state=this.STATE_SELECT_CELL;return!0}return!1}catch(v){dalert(v)}};this.onMouseMove=function(b,a){try{if(!g_bTableOperationYN||this.state!==this.STATE_SELECT_CELL||!b||2===b.buttons||1!==b.buttons)return!1;throttle(this,function(a,b){this.prevSel.bMouseUp||(this.selectingCell(a,b)||(this.prevSel.firstCell=null,
this.prevSel.lastCell=null,this.prevSel.nCellCount=0,this.clearCellSelection(this.prevSel.startTable)),a=0<this.prevSel.nCellCount?"transparent":"",this.prev_color!==a&&(this.prev_color=a,setSelectionColor(b,a)))},b,a);return!0}catch(c){dalert(c)}};this.selectingCell=function(b,a){try{var c=b.target||b.srcElement;if(!c)return!1;a=g_objNodeUtil;var d=c?c.ownerDocument:null;(g_bBrowserType_IE||g_bBrowserType_EDGE)&&a.isPageMain(c)&&d.elementFromPoint&&(c=d.elementFromPoint(b.clientX,b.clientY));var e=
a.getLoopParentElement(c,"td")||a.getLoopParentElement(c,"th"),h=a.getLoopParentElement(e,"table");if(!h)return!1;var f=this.prevSel,g=f.matrix||(f.matrix=(new TableMatrix).setTable(f.startTable));if(!g||!g.tables||!g.tables.some(function(a){return h==a}))return!1;var k=f.start_midx||(f.start_midx=g.getMatrixIndex(f.startCell)),m=g.getMatrixIndex(e);if(!k||!m)return!1;f.deselectPrevCell();f.sy=Math.min(k[0].row,m[0].row);f.sx=Math.min(k[0].col,m[0].col);f.ey=Math.max(k[k.length-1].row,m[m.length-
1].row);f.ex=Math.max(k[k.length-1].col,m[m.length-1].col);f.nCellCount=0;f.firstCell=null;f.lastCell=null;if(f.startCell==e){f.firstCell=e;f.lastCell=e;c=!1;if(e){var l=g_objPositionUtil.getElementPosClientRect(e);d=g_objPropertyUtil;if(Math.abs(l.right-b.clientX)<Math.max(d.getPadding(e,d.RIGHT),4)||Math.abs(l.left-b.clientX)<Math.max(d.getPadding(e,d.LEFT),4))c=!0;if(Math.abs(l.top-b.clientY)<Math.max(d.getPadding(e,d.TOP),4)||Math.abs(l.bottom-b.clientY)<Math.max(d.getPadding(e,d.BOTTOM),4))c=
!0}c&&(this.selectCell(e,2),f.nCellCount=1)}else this.expandSelect(g,f),this.table_selectRange(g,f);return!0}catch(p){dalert(p)}};this.onMouseUp=function(b,a){try{if(!b||!g_bTableOperationYN||this.state!==this.STATE_SELECT_CELL)return!1;var c=!1,d=this.prevSel;d.firstCell&&d.lastCell&&0<d.nCellCount&&(c=!0,2!==b.button&&g_objCaretUtil.moveCaret(d.firstCell,!1));d.init();d.bMouseUp=!0;this.state=this.STATE_NONE;setSelectionColor(a);return c}catch(e){dalert(e)}};this.getCellSelObject=function(b){var a=
{};a.sy=b[0].row;a.sx=b[0].col;a.ey=b[b.length-1].row;a.ex=b[b.length-1].col;return a};this.equalCellSelObject=function(b,a){return b&&a&&b.sy===a.sy&&b.sx===a.sx&&b.ey===a.ey&&b.ex===a.ex?!0:!1};this.onMouseDown_multiCellSelection=function(b,a){try{var c=GetCurTableInfo(b.nEditNumber);if(!c)return!1;var d=c.table,e=c.cell,h=c.endCell;e===h&&(h=a);if(!e||!h||e===h)return!1;var f=new TableMatrix(d);if(!f)return!1;var g=f.getMatrixIndex(e);if(!g)return!1;var k=f.getMatrixIndex(h);if(!k)return!1;var m=
this.getCellSelObject(g),l=this.getCellSelObject(k);l.sy=Math.min(l.sy,m.sy);l.ey=Math.max(l.ey,m.ey);l.sx=Math.min(l.sx,m.sx);l.ex=Math.max(l.ex,m.ex);this.clearCellSelection(d);this.expandSelect(f,l);this.table_selectRange(f,l);return!0}catch(p){dalert(p)}};this.onTouchStart=function(b,a){try{if(!this.canSelect(b,a))return!1;var c=b.target||b.srcElement;if(!c)return!1;b=g_objNodeUtil;var d=b.getLoopParentElementByTagNames(c,b.arrCellTagName),e=b.getLoopParentElement(d,"tr"),h=b.getLoopParentElement(e,
"table");this.state=this.STATE_NONE;this.prevSel.init();return d&&e&&h&&!g_objTableUtil.isBizboxReportTable(h)?(this.prevSel.startTable=h,this.prevSel.startCell=d,this.prevSel.bTableSelected=this.isTableSelected(h),this.prevSel.outlineCell=this.getOutlineCell(h),this.state=this.STATE_SELECT_CELL,!0):!1}catch(f){dalert(f)}};this.onTouchMove=function(b,a){};this.onTouchEnd=function(b,a){try{if(!(b&&g_bTableOperationYN&&this.state===this.STATE_SELECT_CELL&&this.prevSel&&objOnefficeLoader.m_bHybrid))return!1;
var c=b.target||b.srcElement;if(!c)return!1;b=g_objNodeUtil;var d=b.getLoopParentElementByTagNames(c,b.arrCellTagName),e=b.getLoopParentElement(d,"tr"),h=b.getLoopParentElement(e,"table"),f=GetCurTable(a);return h&&g_objTableUtil.getSplitTables(h).some(function(a){return f==a})?d?!0:!1:(this.clearCellSelection(f),g_objTableFlag.ResetTableInfo(!1),!1)}catch(g){dalert(g)}};this.onClick=function(b,a){try{if(!(b&&g_bTableOperationYN&&this.state===this.STATE_SELECT_CELL&&this.prevSel&&objOnefficeLoader.m_bHybrid))return!1;
var c=b.target||b.srcElement;if(!c)return!1;this.state=this.STATE_NONE;var d=g_objNodeUtil,e=d.getLoopParentElementByTagNames(c,d.arrCellTagName),h=d.getLoopParentElement(e,"tr"),f=d.getLoopParentElement(h,"table");d=c=null;var g=GetCurTableInfo(a);g&&(c=g.table,d=g.cell);var k=this.prevSel;e!==k.startCell||k.bTableSelected||k.outlineCell||c!==k.startTable?d===e&&e===k.startCell&&(k.bTableSelected||k.outlineCell&&k.outlineCell!==e)?(this.clearCellSelection(f),this.selectCell(e,2),this.showOutline(a,
e)):(this.clearCellSelection(f),this.hideOutline(b)):this.selectTable(a,f);return!0}catch(m){dalert(m)}};this.isTableNaviKey=function(b){switch(b){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:case 9:return!0}return!1};this.onKeyDown_multiCellSelection=function(b,a){try{if(!b||b.cancelBubble||b.altKey||DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)||!GetMultiCellSelection(a))return!1;var c=b.keyCode;if(!this.isTableNaviKey(c))return!1;var d=GetCurRange(a);if(!d)return!1;var e=
GetCurTableInfo(a);if(!e)return!1;var h=e.table,f=e.cell,g=new TableMatrix(h);if(!g)return!1;var k=g.getSelection();k=k&&k[0]?k[0]:null;if(!k)return!1;if(b.shiftKey&&c!==ID_KEYCODE_TAB){var m=g.getMatrixIndex(f);if(!m)return!1;var l=this.getCellSelObject(m),p={sy:k.nStartRow,sx:k.nStartCol,ey:k.nEndRow,ex:k.nEndCol};a=!1;switch(c){case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_HOME:l.ex>=p.ex&&(a=!0);break;case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_PAGE_UP:l.ey>=p.ey&&(a=!0);break;case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_END:l.sx<=
p.sx&&(a=!0);break;case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_PAGE_DOWN:l.sy<=p.sy&&(a=!0)}var n=cloneSimpleObject(p);n=a?this.expandSelectFromKey(g,n,l,c):this.shrinkSelectFromKey(g,n,l,c);this.hideOutline(b);if(!d.collapsed){if(this.equalCellSelObject(n,l))return this.clearCellSelection(h),!0;b=SelectionUtil;var q=c===ID_KEYCODE_ARROW_RIGHT||c===ID_KEYCODE_ARROW_LEFT?this.equalCellSelObject(p,l):!1,t=q?b.existOnFirst(f,d):!1,r=q?b.existOnLast(f,d):!1;if(c===ID_KEYCODE_ARROW_RIGHT&&q&&t&&!r||c===
ID_KEYCODE_ARROW_LEFT&&q&&!t&&r)return this.clearCellSelection(h),!0}this.clearCellSelection(h);this.table_selectRange(g,n)}else{c===ID_KEYCODE_TAB&&(c=b.shiftKey?ID_KEYCODE_ARROW_LEFT:ID_KEYCODE_ARROW_RIGHT);if(c!==ID_KEYCODE_TAB&&!d.collapsed)return this.clearCellSelection(h),!1;var u=this.findCellFromKey(g,f,c);u||(u=f);u!==f&&(this.clearCellSelection(h),this.selectCell(u,2),this.isShowOutline(f)&&this.showOutline(a,u),g_objCaretUtil.moveCaret(u))}return!0}catch(w){dalert(w)}finally{}};this.onKeyUp=
function(b,a){try{if(g_bTableOperationYN&&b){var c=b.keyCode;if(!(!this.isTableNaviKey(c)&&c!==ID_KEYCODE_DELETE||DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL)||b.altKey)){var d=GetCurTableInfo(a);if(d){var e=d.table,h=d.cell;h&&e&&(this.isCellSelected(h)?updateTableHandlerUI.updateTableUIHandler(a):h!==this.curCellForKeyUp&&(this.curCellForKeyUp=h,g_objTableFlag.removeFlagInfo(e),updateTableHandlerUI.updateTableUIHandler(a),g_objTableMiniMenu.delayUpdate(a)))}else this.curCellForKeyUp=null,
g_objTableFlag.ResetTableInfo(!1),g_objTableMiniMenu.showTableMiniMenu(!1,null,a)}}}catch(f){dalert(f)}};this.isTableSelected=function(b){try{if(!b)return!1;for(var a=0,c=g_objTableUtil.getSplitTables(b).length;a<c;a++)if(this.isShowOutline(b))return!0;return!1}catch(d){dalert(d)}};this.isCellSelected=function(b){try{if(!b||!b.getAttribute)return!1;var a=b.getAttribute("cusflag");a=parseInt(a,10);switch(a){case 2:case 3:case 4:return!0}return!1}catch(c){dalert(c)}};this.isShowOutline=function(b){var a=
getObjType(b),c=g_objWrapperOutlineResize.objExtSelectedInfo;return c&&c.nObjType===a&&c.objElement===b?!0:!1};this.showOutline=function(b,a){return showExtOutline_ObjectElement(a,!0,!0,b)};this.hideOutline=function(b){return g_objWrapperOutlineResize.resetExtOutlineInfo(b)};this.getOutlineCell=function(b){var a=null;try{this.doAllCell(function(b){if(this.isShowOutline(b))throw a=b,BreakException;}.bind(this),b)}catch(c){}return a};this.selectTable=function(b,a){try{var c=a||GetCurTable(b);c&&(g_objTableSelection.table_selectAll(c,
b),g_objTableSelection.updateManualTableUIHandler(b),g_objTableMiniMenu.showTableMiniMenu(!1),showExtOutline_ObjectElement(c,!0,!1,b))}catch(d){dalert(d)}};this.clearCellSelection=function(b,a){try{b=b||GetCurTable();if(!b)return!1;this.doAllSelectedCell(function(b,d,e,h,f,g,k,m){b.hasAttribute("cusflag")&&(d=b.getAttribute("cusflag"),b.removeAttribute("cusflag"),a&&a.push([m,h,e,d]))},b);return a?a:null}catch(c){dalert(c)}};this.restoreCellSelection=function(b,a){try{if(!b)return!1;a=a||GetCurTable();
if(!a)return!1;var c=g_objTableUtil,d=c.getSplitTables(a);a=0;for(var e=b.length;a<e;a++){var h=b[a];if(h){var f=c.getTableCellElement(d[h[0]],h[1],h[2]);f&&f.setAttribute("cusflag",h[3])}}return!0}catch(g){dalert(g)}};this.selectCell=function(b,a){try{if(!b)return!1;switch(a){case 2:case 3:case 4:b.setAttribute("cusflag",a);break;default:this.deselectCell(b)}return!0}catch(c){dalert(c)}};this.selectCellRange=function(b,a){try{if(!b||!a)return!1;if(b===a)return this.selectCell(b,2);var c=g_objNodeUtil,
d=c.getLoopParentElement(b,"table"),e=c.getLoopParentElement(a,"table");if(!d||!e||!g_objTableUtil.isSameTable(d,e))return!1;var h=new TableMatrix(d);if(!h)return!1;var f=h.getMatrixIndex(b);if(!f)return!1;var g=h.getMatrixIndex(a);if(!g)return!1;var k={sy:Math.min(f[0].row,g[0].row),sx:Math.min(f[0].col,g[0].col),ey:Math.max(f[f.length-1].row,g[g.length-1].row),ex:Math.max(f[f.length-1].col,g[g.length-1].col)};this.clearCellSelection(d);this.table_selectRange(h,k);return!0}catch(m){dalert(m)}};this.deselectAllCell=
function(b){try{if(!b)return!1;this.doAllCell(function(a){this.deselectCell(a)}.bind(this),b);return!0}catch(a){dalert(a)}};this.deselectCell=function(b){try{b&&b.hasAttribute("cusflag")&&b.removeAttribute("cusflag")}catch(a){dalert(a)}};this.removeAllCellSelection=function(b){try{if(b){var a=b.querySelectorAll("td[cusflag], th[cusflag], td[bg_changing], th[bg_changing]");forEach(a,function(a,b){b&&(b.removeAttribute("cusflag"),b.removeAttribute("bg_changing"))},this)}}catch(c){dalert(c)}};this.expandSelect=
function(b,a){try{if(!b||!a)return null;for(var c=50,d=!0;d&&0<c;){d=!1;c--;if(0<a.sx)for(var e=a.sy;e<=a.ey;e++)for(;b.isHideForColspan(e,a.sx);a.sx--)d=!0;if(a.ex<b.colLength-1)for(e=a.sy;e<=a.ey;e++)for(;b.isHideForColspan(e,a.ex+1);a.ex++)d=!0;if(0<a.sy)for(var h=a.sx;h<=a.ex;h++)for(;b.isHideForRowspan(a.sy,h);a.sy--)d=!0;if(a.ey<b.rowLength-1)for(h=a.sx;h<=a.ex;h++)for(;b.isHideForRowspan(a.ey+1,h);a.ey++)d=!0}return a}catch(f){dalert(f)}};this.table_SelectionCaretCell=function(b){try{if(!GetMultiCellSelection(b)){var a=
GetCurCell(b);a&&this.selectCell(a,2)}}catch(c){dalert(c)}};this.table_selectAll=function(b,a){try{if(!b)return!1;var c=null,d=null,e=0;this.doAllCell(function(a){c||(c=a);d=a;this.selectCell(a,3);e++}.bind(this),b);this.selectCell(c,2);this.selectCell(d,4);return!0}catch(h){dalert(h)}};this.table_selectRow=function(b,a){try{if(!b)return!1;var c=g_objTableUtil.getMatrix(b),d=c?c.getSelection():null;if(!d||1<d.length)return!1;d=d[0];d.sy=d.nStartRow;d.ey=d.nEndRow;d.sx=0;d.ex=c.colLength-1;this.expandSelect(c,
d);this.table_selectRange(c,d);return!0}catch(e){dalert(e)}};this.table_selectCol=function(b,a){try{if(!b)return!1;var c=g_objTableUtil.getMatrix(b),d=c?c.getSelection():null;if(!d||1<d.length)return!1;d=d[0];d.sy=0;d.ey=c.rowLength-1;d.sx=d.nStartCol;d.ex=d.nEndCol;this.expandSelect(c,d);this.table_selectRange(c,d);return!0}catch(e){dalert(e)}};this.table_selectRange=function(b,a){try{if(!b||!a)return null;for(var c=null,d=null,e=0,h=a.sy;h<=a.ey&&h<b.rowLength;h++)for(var f=a.sx;f<=a.ex&&f<b.colLength;f++)b.isShow(h,
f)&&(d=b.getCell(h,f),c||(c=d),this.selectCell(d,3),e++);this.selectCell(c,2);this.selectCell(d,4);a.firstCell=c;a.lastCell=d;a.nCellCount=e;return a}catch(g){dalert(g)}};this.expandSelectFromKey=function(b,a,c,d){try{var e=null,h=null,f=null,g=null,k=cloneSimpleObject(a);switch(d){case ID_KEYCODE_ARROW_LEFT:a.sx--;if(0>a.sx&&(a.sx=0,c.ey===a.ey?a.sy=Math.max(a.sy-1,0):a.ey=Math.max(a.ey-1,0),a.ey<a.sy)){var m=a.sy;a.sy=a.ey;a.ey=m}break;case ID_KEYCODE_ARROW_TOP:a.sy--;break;case ID_KEYCODE_ARROW_RIGHT:a.ex++;
a.ex>=b.colLength&&(a.ex=b.colLength-1,c.ey===a.ey?a.sy=Math.min(a.sy+1,b.rowLength-1):a.ey=Math.min(a.ey+1,b.rowLength-1),a.ey<a.sy&&(m=a.sy,a.sy=a.ey,a.ey=m));break;case ID_KEYCODE_ARROW_BOTTOM:a.ey++;break;case ID_KEYCODE_PAGE_UP:a.sy=Math.max(a.sy-5,0);break;case ID_KEYCODE_PAGE_DOWN:a.ey=Math.min(a.ey+5,b.rowLength-1);break;case ID_KEYCODE_HOME:e=a.sx;for(var l=a.sy;l<=a.ey;l++)g=b.trs[l].cells,f=g[0],h=b.getMatrixIndex(f),e=Math.min(e,h[0].col);a.sx=e;break;case ID_KEYCODE_END:e=a.ex;for(l=
a.sy;l<=a.ey;l++)g=b.trs[l].cells,f=g[g.length-1],h=b.getMatrixIndex(f),e=Math.max(e,h[h.length-1].col);a.ex=e}var n=this.expandSelect(b,a);c=null;a.sy<k.sy?c=b.getCell(a.sy,a.sx):a.ey>k.ey&&(c=b.getCell(a.ey,a.ex));c&&g_objCaretUtil.scrollTo(c);return n}catch(v){dalert(v)}};this.shrinkSelectFromKey=function(b,a,c,d){try{if(!b||!a||!c)return null;var e=!1,h=!1,f=function(a,b,c,d,e){for(;a<=b;a++)for(var f=c;f<=d;f++)e(a,f)},g=null;switch(d){case ID_KEYCODE_ARROW_TOP:g=b.getRowRange(a.ey,c.sx);g=b.getRowRange(g.start-
1,c.sx);a.ey=g.end;h=!0;break;case ID_KEYCODE_ARROW_BOTTOM:g=b.getRowRange(a.sy,c.sx);g=b.getRowRange(g.end+1,c.sx);a.sy=g.start;e=!0;break;case ID_KEYCODE_ARROW_LEFT:g=b.getColRange(c.sy,a.ex);g=b.getColRange(c.sy,g.start-1);a.ex=g.end;break;case ID_KEYCODE_ARROW_RIGHT:g=b.getColRange(c.sy,a.sx);g=b.getColRange(c.sy,g.end+1);a.sx=g.start;break;case ID_KEYCODE_HOME:a.ex=c.ex;break;case ID_KEYCODE_END:a.sx=c.sx;break;case ID_KEYCODE_PAGE_UP:a.ey=c.ey;h=!0;break;case ID_KEYCODE_PAGE_DOWN:a.sy=c.sy,
e=!0}switch(d){case ID_KEYCODE_ARROW_TOP:case ID_KEYCODE_ARROW_BOTTOM:case ID_KEYCODE_HOME:case ID_KEYCODE_END:f(a.sy,a.ey,a.sx,c.sx-1,function(c,d){g=b.getRowRange(c,d);if(g.start<a.sy||g.end>a.ey)a.sx=Math.max(a.sx,b.getColRange(c,d).end+1)});f(a.sy,a.ey,c.ex+1,a.ex,function(c,d){g=b.getRowRange(c,d);if(g.start<a.sy||g.end>a.ey)a.ex=Math.min(a.ex,b.getColRange(c,d).start-1)});break;case ID_KEYCODE_ARROW_LEFT:case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_PAGE_UP:case ID_KEYCODE_PAGE_DOWN:f(a.sy,c.sy-
1,a.sx,a.ex,function(c,d){g=b.getColRange(c,d);if(g.start<a.sx||g.end>a.ex)a.sy=Math.max(a.sy,b.getRowRange(c,d).end+1)}),f(c.ey+1,a.ey,a.sx,a.ex,function(c,d){g=b.getColRange(c,d);if(g.start<a.sx||g.end>a.ex)a.ey=Math.min(a.ey,b.getRowRange(c,d).start-1)})}c=null;e?c=b.getCell(a.sy,a.sx):h&&(c=b.getCell(a.ey,a.ex));c&&g_objCaretUtil.scrollTo(c);return a}catch(k){dalert(k)}};this.findCellFromKey=function(b,a,c){try{var d=b.getMatrixIndex(a);if(!d)return null;var e=d[0].row,h=d[0].col,f=d[d.length-
1].row;d=null;switch(c){case ID_KEYCODE_ARROW_TOP:a=b.getCell(e-1,h);break;case ID_KEYCODE_ARROW_BOTTOM:a=b.getCell(f+1,h);break;case ID_KEYCODE_ARROW_LEFT:a=b.getPrevCell(e,h);break;case ID_KEYCODE_ARROW_RIGHT:a=b.getNextCell(e,h);break;case ID_KEYCODE_HOME:d=b.trs[e];a=d.cells[0];break;case ID_KEYCODE_END:d=b.trs[e];a=d.cells[d.cells.length-1];break;case ID_KEYCODE_PAGE_UP:a=b.getCell(Math.max(e-5,0),h);break;case ID_KEYCODE_PAGE_DOWN:a=b.getCell(Math.min(f+5,b.rowLength-1),h)}return a}catch(g){dalert(g)}};
this.checkMoveCellForce=function(b){try{if(!b||b.cancelBubble||g_bBrowserType_OP)return!1;var a=b.target||b.srcElement;if(!a)return!1;var c=a.ownerDocument,d=c?c.defaultView:null,e=d?d.getSelection():null;if(!e)return!1;var h=b.nEditNumber;if(GetMultiCellSelection(h))return!1;var f=GetCurRange(h);if(!f)return!1;a=null;c=0;e.anchorNode&&e.anchorNode===f.endContainer&&e.anchorOffset===f.endOffset?(a=f.startContainer,c=f.startOffset):(a=f.endContainer,c=f.endOffset);if(!a)return!1;var g=f.startContainer.childNodes[f.startOffset]||
f.startContainer;if(!f.collapsed&&1===f.endOffset-f.startOffset&&g&&f.startContainer===f.endContainer&&"HR"===g.nodeName)return!1;e=g_objNodeUtil;var k=e.getLoopParentElementByTagNames(a,e.arrCellTagName);if(!k)return!1;var m=e.getLoopParentElement(k,"table");if(!m)return!1;e=g_objTableUtil;g=SelectionUtil;var l=e.getSplitTables(m),n=l.indexOf(m),v=l.length,q=g_bBrowserType_CR&&!g_bBrowserType_EDGE||g_bBrowserType_SF||g_browserCHK.iOS&&g_browserCHK.isWebView(),t=b.keyCode,r=b.shiftKey&&!b.altKey&&
!DZESHORTCUT.isPressedKeyMapForOS(b,ID_KEYCODE_CTRL);if(t===ID_KEYCODE_ARROW_TOP){if((q||r)&&g.isOnFirst(k,a,c)||(q||r)&&g.isOnFirstLine(k,a,c)||0<n&&e.isCellInFirstRow(k)&&g.isOnFirstLine(k,a,c))return!0}else if(t===ID_KEYCODE_ARROW_BOTTOM){if((q||r)&&g.isOnLast(k,a,c)||(q||r)&&g.isOnLastLine(k,a,c)||n+1!==v&&e.isCellInLastRow(k)&&g.isOnLastLine(k,a,c))return!0}else if(t===ID_KEYCODE_ARROW_LEFT){if(g.isOnFirst(k,a,c)&&e.getFirstCell(m)===k||r&&g.isOnFirst(k,a,c))return!0}else if(t===ID_KEYCODE_ARROW_RIGHT){if(g.isOnLast(k,
a,c)&&e.getLastCell(m)===k||r&&g.isOnLast(k,a,c))return!0}else if(t===ID_KEYCODE_BACKSPACE&&f.collapsed&&g.isOnFirst(k,a,c)&&0!==g_objSplitUtil.getSplitNodes(k).indexOf(k))return!0;return!1}catch(u){return dalert(u),!1}finally{}};this.updateManualTableUIHandler=function(b){try{updateTableHandlerUI.updateTableUIHandler(b),GetMultiCellSelection(b)&&updateHandlerUI.update_toolbar_combobox("",b)}catch(a){dalert(a)}}};
var g_bHasLockedCell=!1,g_arrLockedCells=null,g_objTableFlag=new function(){this.ResetTableInfo=function(b){try{if(!(g_bBrowserType_FF||g_bBrowserType_WK||g_bBrowserType_OP)||-1==g_objWrapperOutlineUtil.nExtOutlineRectPressedType){var a=g_objWrapperOutlineResize.objExtSelectedInfo;!a||a.nObjType!==DZE_OBJ_TABLE&&a.nObjType!==DZE_OBJ_TD||g_objWrapperOutlineResize.resetExtOutlineInfo();var d=GetCurTable();fnObjectCheckNull(d)||(b||this.removeFlagInfo(d),g_bHasLockedCell=!1,g_arrLockedCells=null)}}catch(c){dalert(c)}};
this.removeFlagInfo=function(b,a){try{var d=g_objNodeUtil,c=g_objTableUtil,k=g_objTableSelection,g=!1===a?[b]:c.getSplitTables(b);b=0;for(var l=g.length;b<l;b++){var e=g[b];a=0;for(var m=e.rows.length;a<m;a++)for(var n=c.getTableCellsLength(e,a),f=0;f<n;f++){var h=c.getTableCellElement(e,a,f);k.deselectCell(h);d.removeAttribute(h,"bg_changing")}}}catch(p){dalert(p)}}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(d){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(d||"")+"_"+b++,d)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,c={next:function(){if(d<a.length){var e=d++;return{value:b(e,a[e]),done:!1}}c.next=function(){return{done:!0,value:void 0}};return c.next()}};c[Symbol.iterator]=function(){return c};return c};
$jscomp.polyfill=function(a,b,d,c){if(b){d=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in d||(d[e]={});d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var g_objTableOperation=new function(){this.RET_FALSE=0;this.RET_TRUE=1;this.RET_DELETE_TABLE=2;this.FORMULA_SUM=0;this.FORMULA_AVERAGE=1;this.FORMULA_MULTIPLY=2;this.table_AddTableRow=function(a,b,d){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var c=a.ownerDocument,e=g_objTableUtil.getMatrix(a);if(!c||!e)return!1;var f=e.getSelection();if(!f||1<f.length)return!1;d=d?!0:!1;f=f[0];a=g_objNodeUtil;c=g_objTableUtil;var g=e.DZE_TEMP;e.calculateRowHeight();var k=b?f.nStartRow:
f.nEndRow;k=b?k:k+1;for(var h=e.colLength-1;0<=h;h--)if(e.equalCell(f.nStartRow,h,f.nEndRow,h)){var l=e.getRowRange(f.nStartRow,h);b?l.start<f.nStartRow&&l.end>=f.nEndRow&&a.setAttribute(e.getCell(f.nStartRow,h),g,""):l.start<=f.nStartRow&&l.end>f.nEndRow&&a.setAttribute(e.getCell(f.nStartRow,h),g,"")}e.splitRow(k);var m=e.cloneRow(f.nStartRow,f.nEndRow,d);g_objSplitUtil.removeAllSplitAttr(m);forEach(m.querySelectorAll("td, th"),function(a,b){b.firstChild||(b.innerHTML="<P><BR></P>")});b?e.trs[k].parentNode.insertBefore(m,
e.trs[k]):insertAfter(e.trs[k-1],m);e.makeMatrix();var r=f.nEndRow-f.nStartRow+1,n=f.nStartRow-1,q=f.nEndRow+r+1;r=q-n+1;for(h=e.colLength-1;0<=h;h--){d=b=null;for(f=n;f<=q;f=e.getRowRange(f,h).end+1)b=e.getCell(f,h),b=a.hasAttribute(b,g)?b:null,a.removeAttribute(b,g),b&&(d=d||[],d.push(b));if(d&&0!=d.length){b=d[0];l=f=0;for(var p=d.length;l<p;l++)f+=e.getRowspan(d[l]);l=1;for(p=d.length;l<p;l++)d[l].parentNode.removeChild(d[l]);e.setRowspan(b,f);var t=c.offsetHeightToStyleHeight(b.offsetHeight,
b);c.setNodeValue_Height(b,t,"px")}}return!0}catch(u){dalert(u)}};this.deleteTableRow=function(a){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return this.RET_FALSE;var b=new TableMatrix(a),d=b?b.getSelection():null;if(!d||1<d.length)return this.RET_FALSE;d=d[0];if(b.rowLength===d.nEndRow-d.nStartRow+1)return this.RET_DELETE_TABLE;var c=a.ownerDocument,e=c?c.defaultView:null,f=e?e.getSelection():null;f&&f.removeAllRanges();b.removeRow(d.nStartRow,d.nEndRow,{returnFragment:!1});
var g=b.getCell(d.nStartRow,d.nStartCol);g=(g=g?g:b.getCell(d.nStartRow-1,d.nStartCol))?g:b.tables[0].rows[0].cells[0];g_objCaretUtil.moveCaret(g);return this.RET_TRUE}catch(k){dalert(k)}};this.table_AddTableCol=function(a,b){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var d=a.ownerDocument,c=g_objTableUtil.getMatrix(a);if(!d||!c)return!1;var e=c.getSelection();if(!e||1<e.length)return!1;e=e[0];var f=g_objNodeUtil,g=g_objTableUtil,k=g_objTableResize,h=c.DZE_TEMP,l=
a.parentNode,m=g_objPropertyUtil.getPadding(l),r=Math.floor(l.offsetWidth-m[g_objPropertyUtil.LEFT]-m[g_objPropertyUtil.RIGHT]),n=a.offsetWidth,q=c.calculateColWidth(),p=b?e.nStartCol:e.nEndCol+1;g.addColgroup(a,c);for(var t=c.rowLength-1;0<=t;t--)if(c.equalCell(t,e.nStartCol,t,e.nEndCol)){var u=c.getColRange(t,e.nStartCol);b?u.start<e.nStartCol&&u.end>=e.nEndCol&&f.setAttribute(c.getCell(t,e.nStartCol),h,""):u.start<=e.nStartCol&&u.end>e.nEndCol&&f.setAttribute(c.getCell(t,e.nStartCol),h,"")}c.splitCol(p);
var v=d.createDocumentFragment(),x=c.cloneCol(e.nStartCol,e.nEndCol);for(t=c.rowLength-1;0<=t;t--)f.moveNodesTo(v,x.removeChild(x.lastChild).firstChild),c.insertCell(v,t,p);c.makeMatrix();b=0;for(var y=c.colgroups.length;b<y;b++){for(var z=c.colgroups[b],B=f.getImmediateChildNodesByTagName(z,"col"),A=e.nStartCol;A<=e.nEndCol;A++)v.appendChild(B[A].cloneNode(!1));z.insertBefore(v,B[e.nEndCol+1])}var D=c.arraySum(q),w=c.arraySum(q,e.nStartCol,e.nEndCol);g.setTableWidth(c.tables,D+w);var E=e.nStartCol-
1,F=e.nEndCol+(e.nEndCol-e.nStartCol+1)+1;for(t=c.rowLength-1;0<=t;t--){q=e=null;for(v=E;v<=F;v=c.getColRange(t,v).end+1)e=c.getCell(t,v),e=f.hasAttribute(e,h)?e:null,f.removeAttribute(e,h),e&&(q=q||[],q.push(e));if(q&&0!=q.length){e=q[0];b=v=0;for(y=q.length;b<y;b++)v+=c.getColspan(q[b]);b=1;for(y=q.length;b<y;b++)q[b].parentNode.removeChild(q[b]);c.setColspan(e,v);var G=g.offsetWidthToStyleWidth(e.offsetWidth,e);g.setNodeValue_Width(e,G,"px")}}var C=a.offsetWidth;1>=Math.abs(n-r)&&C>r&&C<=1.25*
n&&k.setTableSize(a,n,0);return!0}catch(H){dalert(H)}return!1};this.deleteTableCol=function(a){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return this.RET_FALSE;var b=new TableMatrix(a),d=b?b.getSelection():null;if(!d||1<d.length)return this.RET_FALSE;d=d[0];if(b.colLength===d.nEndCol-d.nStartCol+1)return this.RET_DELETE_TABLE;var c=a.ownerDocument,e=c?c.defaultView:null,f=e?e.getSelection():null;f&&f.removeAllRanges();b.removeCol(d.nStartCol,d.nEndCol,{returnFragment:!1});
var g=b.getCell(d.nStartRow,d.nStartCol);g=(g=g?g:b.getCell(d.nStartRow,d.nStartCol-1))?g:b.tables[0].rows[0].cells[0];g_objCaretUtil.moveCaret(g);return this.RET_TRUE}catch(k){dalert(k)}};this.deleteTable=function(a){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var b=g_objNodeUtil,d=g_objTableUtil.getSplitTables(a),c=GetCurTable(),e=b.getClosetBound(c);a=null;0<=d.indexOf(c)&&(a=(a=getCaretNodeWalker(d[d.length-1]).getNextNodeOutside(d[d.length-1]))||getCaretNodeWalker(d[0]).getPrevNodeOutside(d[0]));
c=0;for(var f=d.length;c<f;c++)d[c]&&d[c].parentNode.removeChild(d[c]);!e||e.firstChild||b.isBoundNode(e)||(e.innerHTML=b.isNodeInShape(e)?"<BR>":"<P><BR></P>",a||(a=e));a&&g_objCaretUtil.moveCaret(a,!1);return!0}catch(g){dalert(g)}};this.deleteCellContents=function(a,b){try{if(!a||!1===g_objEditMode.isContentEditable(a)||!0===g_objTableFunction.isCellLocked(a)||g_readonlyMode)return!1;var d=!1!==b?GetCurCell():null;b=!1;a===d&&(b=!0);g_objTableUtil.setCellInnerText("",a);b&&g_objCaretUtil.moveCaret(a);
return!0}catch(c){dalert(c)}};this.deleteSelectedCellContents=function(a,b){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var d=GetCurCell(b),c=!1,e=0;g_objTableSelection.doAllSelectedCell(function(a){this.deleteCellContents(a,!1)&&e++;a==d&&(c=!0)}.bind(this),a);c&&g_objCaretUtil.moveCaret(d);return 0<e?!0:!1}catch(f){dalert(f)}};this.deleteSelectedCell=function(a,b,d){try{if(!b||!1===g_objEditMode.isContentEditable(b)||g_readonlyMode)return!1;var c=g_objTableUtil.getMatrix(b);
if(!c)return!1;var e=c.getSelection();e=e&&e[0]?e[0]:null;if(!e)return!1;for(var f=g_objTableSelection,g=0==e.nStartRow&&e.nEndRow==c.rowLength-1,k=!0,h=e.nStartRow;h<=e.nEndRow&&k;h++)forEach(c.trs[h].cells,function(a,b){f.isCellSelected(b)||(k=!1)},this);e=k&&g;h=null;var l=!1;k&&!g?l=g_objTableOperation.deleteTableRow(b,a):!k&&g?l=g_objTableOperation.deleteTableCol(b,a):e?(h=g_objPageControl.getPageNum(c.tables[0]),l=g_objTableOperation.deleteTable(b)):l=g_objTableOperation.deleteSelectedCellContents(b,
a);l&&(e?(!1!==d&&g_objUndoRedo.registerUndoRedoStack(0,a),editor_onselectionchange(a),g_objPageControl.onSetDelayedUpdatePageTimer(null,h)):commonUpdateAfterChange(a,b,{bUndoRedo:d}));return l}catch(m){dalert(m)}};this.table_MergeTableCell=function(a,b){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var d=a.ownerDocument,c=g_objTableUtil,e=g_objTableFunction,f=g_objNodeUtil;b=g_objPageControl;var g=c.getMatrix(a),k=g?g.getSelection():null;if(!k||1!=k.length)return!1;
k=k[0];if(1>=k.arrCell.length)return!1;var h=g.calculateColWidth(),l=g.calculateRowHeight(),m=k.arrCell;g_objCaretUtil.moveCaret(m[0]);var r={};a=0;for(var n=m.length;a<n;a++){var q=b.getPageNum(m[a]);r[q]||(r[q]=[]);r[q].push(m[a])}var p=Object.keys(r),t="";1<p.length&&(t=(t=m[0].getAttribute(g_objSplitUtil.DZE_SPLIT))||g_objCommonUtil.getUniqueID());p.forEach(function(a){var b=r[a];a=b[0];t&&a.setAttribute(g_objSplitUtil.DZE_SPLIT,t);for(var k=Number.MAX_VALUE,m=0,n=Number.MAX_VALUE,q=0,p=0,u=b.length;p<
u;p++){var w=g.getMatrixIndex(b[p]);k=Math.min(k,w[0].row);m=Math.max(m,w[w.length-1].row);n=Math.min(n,w[0].col);q=Math.max(q,w[w.length-1].col)}u=g.getCell(k,q);p=g.getCell(m,n);u=e.GetTableCellBorderAttribute(u,"right");e.SetTableCellBorderAttribute(a,u,"right");u=e.GetTableCellBorderAttribute(p,"bottom");e.SetTableCellBorderAttribute(a,u,"bottom");g.setRowspan(a,m-k+1);g.setColspan(a,q-n+1);w=d.createDocumentFragment();p=1;for(u=b.length;p<u;p++)c.isBlankCell(b[p])||f.moveNodesTo(w,b[p].firstChild),
b[p].parentNode.removeChild(b[p]);g.makeMatrix();w.firstChild&&a.appendChild(w);b=g.arraySum(h,n,q);k=g.arraySum(l,k,m);c.setNodeValue_Width(a,c.offsetWidthToStyleWidth(b,a),"px");c.setNodeValue_Height(a,c.offsetHeightToStyleHeight(k,a),"px")});g.removeBlankCol();g.removeBlankRow();return!0}catch(u){dalert(u)}return!1};this.table_SplitTableRow=function(a,b,d){try{if(!b||1===d||!1===g_objEditMode.isContentEditable(b)||g_readonlyMode)return!1;0<g_objNodeUtil.getImmediateChildNodesByTagName(b,"colgroup").length&&
g_objTableUtil.addColgroup(b,c);var c=g_objTableUtil.getMatrix(b),e=c.getSelection();if(!e||1<e.length)return!1;e=e[0];var f=e.arrCell.slice();f.sort(function(a,b){return a.rowSpan-b.rowSpan});a=g_objTableSelection;var g=a.isCellSelected(f[0]);b=0;for(var k=f.length;b<k;b++)c.divideCellRow(f[b],d);if(g){e=c.getSelection()[0];for(b=e.arrCell.length-1;0<=b;b--)a.selectCell(e.arrCell[b],3);a.selectCell(c.getCell(e.nStartRow,e.nStartCol),2);a.selectCell(c.getCell(e.nEndRow,e.nEndCol),4)}g_objCaretUtil.moveCaret(c.getCell(e.nStartRow,
e.nStartCol));return!0}catch(h){dalert(h)}};this.table_SplitTableCol=function(a,b,d){try{if(!b||1===d||!1===g_objEditMode.isContentEditable(b)||g_readonlyMode)return!1;0<g_objNodeUtil.getImmediateChildNodesByTagName(b,"colgroup").length&&g_objTableUtil.addColgroup(b,c);var c=g_objTableUtil.getMatrix(b),e=c.getSelection();if(!e||1<e.length)return!1;e=e[0];var f=e.arrCell.slice();f.sort(function(a,b){return a.colSpan-b.colSpan});a=g_objTableSelection;var g=a.isCellSelected(f[0]);b=0;for(var k=f.length;b<
k;b++)c.divideCellCol(f[b],d);if(g){e=c.getSelection()[0];for(b=e.arrCell.length-1;0<=b;b--)a.selectCell(e.arrCell[b],3);a.selectCell(c.getCell(e.nStartRow,e.nStartCol),2);a.selectCell(c.getCell(e.nEndRow,e.nEndCol),4)}g_objCaretUtil.moveCaret(c.getCell(e.nStartRow,e.nStartCol));return!0}catch(h){dalert(h)}};this.table_TableCellSameHeight=function(a){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var b=g_objTableResize,d=g_objTableUtil.getMatrix(a),c=d?d.getSelection():
null;if(!c||1>c.length)return!1;for(var e=Number.MAX_VALUE,f=0,g=0,k=0,h=0;h<c.length;h++)e=Math.min(c[h].nStartRow,e),f=Math.max(c[h].nEndRow,f);g=f-e+1;if(1>=g&&g_objTableSelection.isCellSelected(c[0].arrCell[0]))return cmnCtrlToast.showToastMsg(null,ID_RES_STRING_SELECT_MULTI_ROW,2,"screen_center"),!1;1>=g&&(e=0,f=d.rowLength-1,g=f-e+1);b.prepareResize(a,!1);for(a=20;0<a;){var l=d.arraySum(d.calculateRowHeight()),m=d.calculateRowHeight(),r=d.arraySum(m,e,f);if(0==k)for(var n=e;n<=f;n++)d.isBlankRow(n)&&
k++;var q=d.getIntegerDivision(r,g-k);n=e;for(c=0;n<=f;n++,c++)d.isBlankRow(n)?(m[n]=0,c--):m[n]=q[c];var p=d.arrayWidthToPos(m,[]);for(n=e;n<=f;n++)d.isBlankRow(n)&&(p[n]=null);d.arrayFillNullWithMedian(p);m=d.arrayPosToWidth(p,m);for(n=e;n<=f;n++)b.setRowHeight(d,n,m[n]);d.clearCache();var t=d.arraySum(d.calculateRowHeight());if(5>=Math.abs(t-l))break;a--}b.afterResize();return!0}catch(u){dalert(u)}return!1};this.table_TableCellSameWidth=function(a){try{if(!a||!1===g_objEditMode.isContentEditable(a)||
g_readonlyMode)return!1;var b=g_objTableResize,d=g_objTableUtil.getMatrix(a),c=d?d.getSelection():null;if(!c||1>c.length)return!1;for(var e=Number.MAX_VALUE,f=0,g=0,k=0,h=0;h<c.length;h++)e=Math.min(c[h].nStartCol,e),f=Math.max(c[h].nEndCol,f);g=f-e+1;if(1>=g&&g_objTableSelection.isCellSelected(c[0].arrCell[0]))return cmnCtrlToast.showToastMsg(null,ID_RES_STRING_SELECT_MULTI_COL,2,"screen_center"),!1;1>=g&&(e=0,f=d.colLength-1,g=f-e+1);b.prepareResize(a,!1);var l=d.calculateColWidth(),m=d.arraySum(l,
e,f);for(h=e;h<=f;h++)d.isBlankCol(h)&&k++;var r=d.getIntegerDivision(m,g-k);h=e;for(a=0;h<=f;h++,a++)d.isBlankCol(h)?(l[h]=0,a--):l[h]=r[a];var n=d.arrayWidthToPos(l,[]);for(h=e;h<=f;h++)d.isBlankCol(h)&&(n[h]=null);d.arrayFillNullWithMedian(n);l=d.arrayPosToWidth(n,l);for(h=e;h<=f;h++)b.setColWidth(d,h,l[h]);b.afterResize();return!0}catch(q){dalert(q)}return!1};this.table_TableCellAlign=function(a,b,d){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode)return!1;var c=this.table_TableCellHorizontalAlign(a,
b);return c|=this.table_TableCellVerticalAlign(a,d)}catch(e){dalert(e)}};this.table_TableCellHorizontalAlign=function(a,b){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode||"left"!==b&&"center"!==b&&"right"!==b&&"none"!==b)return!1;g_objTableSelection.doAllSelectedCell(function(a){a.style.textAlign="none"===b?"":b;a.removeAttribute("align")},a);return!0}catch(d){dalert(d)}};this.table_TableCellVerticalAlign=function(a,b){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode||
"top"!=b&&"middle"!=b&&"bottom"!=b)return!1;g_objTableSelection.doAllSelectedCell(function(a){a.style.verticalAlign=b},a);return!0}catch(d){dalert(d)}};this.table_TableFormula=function(a,b,d,c){try{if(!a||!1===g_objEditMode.isContentEditable(a)||g_readonlyMode||!a.ownerDocument)return!1;var e=g_objTableUtil,f=e.getMatrix(a),g=f?f.getSelection():null;if(!g||1<g.length)return!1;g=g[0];var k=0,h=GetCurCell(c);g.arrCell.forEach(function(a){var c=f.getMatrixIndex(a);if(c){var l=f.getRowRange(c[0].row,
c[0].col);c=f.getColRange(c[0].row,c[0].col);if(b==DZE_DIR.HORIZONTAL){var n=l.start;l=l.end;var q=0;var p=f.colLength-1}else if(b==DZE_DIR.VERTICAL)n=0,l=f.rowLength-1,q=c.start,p=c.end;else return;for(c=[];n<=l;n++)for(var t=q;t<=p;t++)if(f.isShow(n,t)){var u=f.getCell(n,t);inArray(u,g.arrCell)||c.push(u)}if(0!=c.length){l=[];for(q=0;q<c.length;q++)p=g_objPropertyUtil.getTextContent(c[q]),p=p.trim(),p=p.removeComma(),p=removeZeroWidthSpaceFromString(p),""==p?l[q]=null:isNaN(p)?l[q]=null:l[q]=parseFloat(p);
c=g_objTableFunction.doFormulaData(l,d);if(null!=c){if(1==d||2==d)c=toFloat(c,3);l=!1;a==h&&(l=!0);e.setCellInnerText(""+c,a);l&&g_objCaretUtil.moveCaret(h,!1,!1);k++}}}});return 0<k?!0:!1}catch(l){dalert(l)}};this.table_SetTableStyle=function(a,b){function d(a,b){try{if(a&&b){for(var c=["Style","Width","Color"],e=["Top","Right","Bottom","Left"],d="",f="",g=0;g<e.length;g++)for(var h=0;h<c.length;h++)d="border"+e[g]+c[h],f="border"+c[h],b[f]&&!fnObjectCheckNull(b[f][g])&&(a.style[d]=b[f][g]);a.style.color=
b.color?b.color:"";a.style.backgroundColor=b.backgroundColor?b.backgroundColor:"";a.style.borderImage=""}}catch(z){dalert(z)}}function c(a,b){try{if(!a)return null;a.borderStyle&&!fnObjectCheckNull(a.borderStyle[b])&&(a.borderStyle[b]=null);a.borderWidth&&!fnObjectCheckNull(a.borderWidth[b])&&(a.borderWidth[b]=null);a.borderColor&&!fnObjectCheckNull(a.borderColor[b])&&(a.borderColor[b]=null);return a}catch(p){dalert(p)}}try{if(!a||"undefined"===typeof DzeTableStylePreset)return a;var e=DzeTableStylePreset[b];
if(!e)return a;for(var f=new TableMatrix(a),g="dze_table_style_"+b,k=0;9>k;k++)for(var h=0,l=f.tables.length;h<l;h++)g_objPropertyUtil.removeClass(f.tables[h],"dze_table_style_"+k);if(1<b&&9>b)for(1<f.tables.length&&f.tables[0].setAttribute("dze_split_first",""),h=0,l=f.tables.length;h<l;h++)g_objPropertyUtil.addClass(f.tables[h],g);var m=Object.keys(e);k=h=0;var r=null;m.forEach(function(a){r=e[a];if("cell"===a)for(h=0;h<f.rowLength;h++)for(k=0;k<f.colLength;k++)f.isShow(h,k)&&d(f.getCell(h,k),r);
else if("firstRowCell"===a)for(h=0;h<f.colLength;h++)f.isShow(0,h)&&d(f.getCell(0,h),r);else if("row"===a)for(h=0;h<f.rowLength;h++){a=f;var b=h,g=r;try{for(var l=null,m=null,n=0;n<a.colLength;n++)a.isShow(b,n)&&(l=a.getCell(b,n))&&(m=g?JSON.parse(JSON.stringify(g)):null,0===n?c(m,1):(n!==a.colLength-1&&c(m,1),c(m,3)),d(l,m))}catch(x){dalert(x)}}else if("firstCol"===a){b=r;try{for(clone=g=null,l=0;l<f.rowLength;l++)f.isShow(l,0)&&(!(g=f.getCell(l,0))||0===l&&"firstCol"===a||(clone=b?JSON.parse(JSON.stringify(b)):
null,0===l?c(clone,2):l===f.rowLength-1?c(clone,0):(c(clone,0),c(clone,2)),d(g,clone)))}catch(x){dalert(x)}}});return a}catch(n){dalert(n)}};this.addRowgroup=function(a,b,d){try{if(!a)return!1;var c=g_objTableUtil.getMatrix(a);if(!c)return!1;var e=this.getRowgroupInfo(a,b);if(!e)return!1;var f=c.cloneRow(e.start,e.end);if(!f)return!1;g_objSplitUtil.removeAllSplitAttr(f);if(a.getAttribute("dze_desc")===DZE_CUSTOM_VALUE_TASK_SCHEDULE){var g=e.start;try{if(c&&f)for(var k=b=null,h=null,l=null,m=e.end-
g+1,r=0;r<m;r++)b=c.trs[g+r],k=f.childNodes[r],h=b?b.cells[0]:null,l=k?k.cells[0]:null,h&&l&&(l.innerHTML=h.innerHTML)}catch(x){dalert(x)}}var n=this.getNewRowgroupID(a);if(null===n)return!1;g=DZE_CUSTOM_ATT_ROWGROUP;for(var q=f.firstChild;q;)q.setAttribute(g,n),q=q.nextSibling;var p=e.end+1;if(p<c.rowLength)c.splitRow(p),g_objNodeUtil.getLoopParentElement(c.trs[p],"tbody").insertBefore(f,c.trs[p]);else{var t=c.tables;t[t.length-1].tBodies[0].appendChild(f)}c.makeMatrix();g_objTableFlag.ResetTableInfo(!1);
if(e=this.getRowgroupInfo(a,n)){var u=c.trs[e.start].cells[0];if(a.getAttribute("dze_desc")===DZE_CUSTOM_VALUE_TASK_SCHEDULE){var v=c.trs[e.start].cells[1];v&&(u=v)}g_objNodeUtil.getLoopParentElement(u?u.parentNode:null,"table")&&(g_objCaretUtil.moveCaret(u.firstChild),g_objPlaceholder.setPlaceholderFocus(u),updateTableHandlerUI.updateTableUIHandler(d))}commonUpdateAfterChange(d,a);return!0}catch(x){dalert(x)}};this.deleteRowgroup=function(a,b,d){try{if(!a)return!1;var c=g_objTableUtil.getMatrix(a);
if(!c)return!1;var e=this.getRowgroupInfo(a,b);if(!e)return!1;g_objTableFlag.ResetTableInfo(!1);b=g_objNodeUtil;var f=b.getAncestorNodeOnCaret(d);f=b.getLoopParentElementByTagNames(f,b.arrCellTagName);b=!1;var g=c.getMatrixIndex(f);g&&0<g.length&&(b=g_objPositionUtil.isOverlap(e.start,e.end,g[0].row,g[g.length-1].row));b&&g_objEditWindow[d].getSelection().removeAllRanges();if(!c.removeRow(e.start,e.end))return!1;if(b)for(var k=g[g.length-1].row,h=g[g.length-1].col;0<=k;k--)if(f=c.getCell(k,h)){g_objCaretUtil.moveCaret(f);
g_objPlaceholder.setPlaceholderFocus(f);updateTableHandlerUI.updateTableUIHandler(d);break}commonUpdateAfterChange(d,a);return!0}catch(l){dalert(l)}};this.getRowgroupInfo=function(a,b){try{if(!a||"undefined"==typeof b||null===b)return null;var d=DZE_CUSTOM_ATT_ROWGROUP,c=null,e=null,f=null,g=null,k=null,h=g_objTableUtil.getRows(a);a=0;for(var l=h.length;a<l;a++)if(h[a].hasAttribute(d)){if(f=k,k=h[a].getAttribute(d),k==b){for(e=c=a;a<l&&k==h[a].getAttribute(d);a++)e=a;g=a<l?h[a].getAttribute(d):null;
break}}else k=null;if(null==c)return null;b={};b.start=c;b.end=e;b.id=k;b.prevID=f;b.nextID=g;return b}catch(m){dalert(m)}};this.getNewRowgroupID=function(a){try{var b=0,d=DZE_CUSTOM_ATT_ROWGROUP,c=g_objTableUtil.getRows(a);a=0;for(var e=c.length;a<e;a++)c[a].hasAttribute(d)&&!isNaN(c[a].getAttribute(d))&&(b=Math.max(b,parseFloat(c[a].getAttribute(d))));return Math.ceil(b)+1}catch(f){dalert(f)}};this.resetRowgroupID=function(a,b){try{var d=DZE_CUSTOM_ATT_ROWGROUP,c=null;b=b?b:1;var e=g_objTableUtil.getRows(a);
a=0;for(var f=e.length;a<f;a++)if(e[a].hasAttribute(d)){for(c=e[a].getAttribute(d);a<f&&c==e[a].getAttribute(d);a++)e[a].setAttribute(d,b);a--;b++}}catch(g){dalert(g)}};this.mergeTable=function(a,b,d){try{if(!a||!b)return!1;var c=g_objTableUtil,e=c.getMatrix(a),f=c.getMatrix(b);c=1;a.getAttribute("dze_desc")===b.getAttribute("dze_desc")&&a.getAttribute("dze_desc")===DZE_CUSTOM_VALUE_USER_INFO&&(c=0);if(0>f.rowLength-c||e.colLength!==f.colLength)return!1;this.resetRowgroupID(b,99999);var g=f.removeRow(c,
f.rowLength-1);if(!g)return!1;if(!1===d){var k=e.removeRow(c,e.rowLength-c);if(!k)return!1;g_objNodeUtil.moveNodesTo(k,g.firstChild);var h=f.tables[f.tables.length-1].rows;if(!h)return!1;h[h.length-1].parentNode.appendChild(k)}else{var l=e.tables[e.tables.length-1].rows;if(!l)return!1;l[l.length-1].parentNode.appendChild(g)}this.resetRowgroupID(a,1);a=!1===d?e:f;for(b=0;b<a.tables.length;b++)a.tables[b].parentNode.removeChild(a.tables[b]);return!0}catch(m){dalert(m)}};this.splitOnAllChildTables=function(a,
b){try{if(a&&b){var d=b.getElementsByTagName("table");if(0>=d.length)return!1;var c=g_objNodeUtil;forEach(d,function(b,d){c.splitOn(a,d)})}}catch(e){dalert(e)}};this.convertChildTableToText=function(a,b){try{if(!a)return!1;[].slice.call(a.getElementsByTagName("table")).forEach(function(a){this.convertTableToText(a,b)}.bind(this));return!0}catch(d){dalert(d)}};this.convertTableToText=function(a,b){try{var d=g_objNodeUtil;if(!a||!a.parentNode||!d.checkTagName(a,"table"))return!1;var c=a.ownerDocument,
e=null;g_objTableUtil.getSplitTables(a).forEach(function(a){var b=a.parentNode,f=[a];f=f.concat([].slice.call(a.getElementsByTagName("table")));if(0>=f.length)return!1;f.forEach(function(a){a=d.splitOn(b,a);d.checkTagName(a,"table")&&f.push(a)}.bind(this));f.forEach(function(a){var b=this.tableToText(a,"<p>","</p>","","<span style='white-space:pre'>\t</span>");b=c.createRange().createContextualFragment(b);e=b.lastChild;a.parentNode.replaceChild(b,a)}.bind(this))}.bind(this));e&&!1!==b&&g_objCaretUtil.moveCaret(e,
!0,!1);return!0}catch(f){dalert(f)}};this.tableToText=function(a,b,d,c,e){try{"undefined"==typeof b&&(b="");"undefined"==typeof d&&(d="\n");"undefined"==typeof c&&(c="");"undefined"==typeof e&&(e="\t");var f=g_objNodeUtil,g="",k=a.rows;a=0;for(var h=k.length;a<h;a++){var l=k[a].cells;g+=b;for(var m=0,r=l.length;m<r;m++)0!=m&&(g+=c),g+=f.getInnerText(l[m]),m!=r-1&&(g+=e);g+=d}return g}catch(n){dalert(n)}};this.convertTableToFormatText=function(a){try{if(!a||!a.parentNode||"TABLE"!==a.nodeName)return!1;
var b=g_objNodeUtil,d=g_objTableUtil,c=g_objCaretUtil,e=a.ownerDocument.createDocumentFragment(),f=c.saveCaret(),g=b.getLoopParentElementByTagNames(f?f.start?f.start:f.end:null,["td","th"]);g_objTableUtil.getSplitTables(a).forEach(function(a){var c=a.parentNode,f=[a];f=f.concat([].slice.call(a.getElementsByTagName("table")));if(0>=f.length)return!1;f.forEach(function(a){(a=b.splitOn(c,a))&&"TABLE"===a.nodeName&&f.push(a)}.bind(this));f.forEach(function(a){var c=a.querySelectorAll("td, th");forEach(c,
function(a,c){d.isBlankCell(c)&&g!==c||b.moveNodesTo(e,c.firstChild)});caretNode=e.lastChild;a.parentNode.replaceChild(e,a)}.bind(this))}.bind(this));c.restoreCaret();return!0}catch(k){dalert(k)}};this.removeAllEmpName=function(a){try{if(a){for(var b=[DZE_CUSTOM_VALUE_SCHEDULE,DZE_CUSTOM_VALUE_TASK,DZE_CUSTOM_VALUE_SCHEDULE_HOME,DZE_CUSTOM_VALUE_TASK_HOME,DZE_CUSTOM_VALUE_TASK_SCHEDULE],d=[],c=0,e=b.length;c<e;c++)d[c]=g_objTableUtil.getBizboxReportTableQuery(b[c]);b=[];c=0;for(e=d.length;c<e;c++)b=
b.concat([].slice.call(a.querySelectorAll(d[c])));b.forEach(function(a){if(a){var b=g_objNodeUtil,c=Number.MAX_VALUE,e=a.rows,d=0;for(a=a.rows.length;d<a;d++){var f=e[d];if(f.hasAttribute("dze_rowgroup")){var r=f.getAttribute("dze_rowgroup");r!=c&&(c=r,(f=b.checkTagName(f.firstChild,"td","th"))&&(f=b.checkTagName(f.firstChild,"p"))&&f.hasAttribute("title")&&f.removeAttribute("title"))}}}})}}catch(f){dalert(f)}};this.autoInsertNewRow=function(a,b,d,c){try{var e=c.ownerDocument,f=c.rows,g=f.length,
k=a.getRowRange(b,d).end;for(b=0;b<d;b++)if(!a.isHideForColspan(k,b)){var h=a.getCell(k,b),l=a.getRowspan(h);l+=g;a.setRowspan(h,l)}var m=e.createDocumentFragment();for(d=0;d<g;d++)m.appendChild(f[0]);insertAfter(a.trs[k],m);a.makeMatrix()}catch(r){dalert(r)}};this.deleteCell=function(a,b,d){try{if(!a&&!b)return!1;var c=g_objNodeUtil,e=g_objTableUtil;if(a&&b&&!e.isCellInSameTable(a,b))return!1;d=d||new TableMatrix(c.getLoopParentElement(a||b,"table"),!1,!0);if(!d)return!1;var f=d.getMatrixIndex(a),
g=d.getMatrixIndex(b);f&&g&&(f[0].row>g[0].row||f[0].row===g[0].row&&f[0].col>g[0].col)&&(a=g,g=f,f=a);b=a=0;var k=d.colLength-1,h=d.rowLength-1;f&&g?(a=f[0].col,b=f[0].row,k=g[g.length-1].col,h=g[g.length-1].row):f&&!g?(a=f[0].col,b=f[0].row):!f&&g&&(k=g[g.length-1].col,h=g[0].row);if(0===b&&0===a&&h===d.rowLength-1&&k===d.colLength-1)return this.deleteTable(d.table);if(b===h)for(var l=a;l<=k;l++)d.isShow(b,l)&&this.deleteCellContents(d.getCell(b,l));else{for(l=a;l<d.colLength;l++)d.isShow(b,l)&&
this.deleteCellContents(d.getCell(b,l));for(l=0;l<=k;l++)d.isShow(h,l)&&this.deleteCellContents(d.getCell(h,l))}b<=h&&d.removeRow(0===a?b:b+1,k===d.colLength-1?h:h-1);return!0}catch(m){dalert(m)}};this.nativeRangeToCellRange=function(a){try{if(!a||a.collapsed)return null;var b=a.startContainer,d=a.startOffset,c=a.endContainer,e=a.endOffset;if(!b||"TR"!==b.nodeName&&"TABLE"!==b.nodeName||!c||"TR"!==c.nodeName&&"TABLE"!==c.nodeName)return null;a=g_objNodeUtil;var f=a.getLoopParentElement(b,"table"),
g=a.getLoopParentElement(c,"table");if(!f||!g||!g_objTableUtil.isSameTable(f,g))return null;var k=new TableMatrix(f,!1,!0);if(!k)return null;f=null;"TABLE"===b.nodeName&&0===d?f=b.rows[0].cells[0]:"TR"===b.nodeName&&(f=b.cells[d],!f&&1<d&&b.cells[d-1]&&(f=k.getNextCellFromCell(b.cells[d-1])));b=null;if("TABLE"===c.nodeName&&e===c.childNodes.length){var h=c.rows[c.rows.length-1];b=h.cells[h.cells.length-1]}else"TR"===c.nodeName&&(1<e&&(b=c.cells[e-1]),!b&&c.cells[e]&&(b=k.getPrevCellFromCell(c.cells[e])));
if(!f||!b)return null;var l=k.getMatrixIndex(f),m=k.getMatrixIndex(b);return l&&m&&(l[0].row>m[0].row||l[0].row===m[0].row&&l[0].col>m[0].col)?null:{matrix:k,stCell:f,enCell:b}}catch(r){dalert(r)}};this.sortRangePropArrayInDocumentOrder=function(a){try{if(a&&a.length){var b=a[0].sc.ownerDocument;if(b){var d=b.createRange(),c=b.createRange();a.sort(function(a,b){if(a.sc===b.sc)return a.so-b.so;a.getRange(d);b.getRange(c);return d.compareBoundaryPoints(Range.START_TO_START,c)})}}}catch(e){dalert(e)}finally{c=
d=null}};this.getDepthUntilBound=function(a,b){try{for(var d=0;a&&a!==b.parentNode&&"BODY"!==a.nodeName;)d++,a=a.parentNode;return d}catch(c){dalert(c)}};this.getClosetTableIfTr=function(a){try{var b=a.nodeName;return"TR"===b||"TBODY"===b||"THEAD"===b||"COLGROUP"===b?g_objNodeUtil.getLoopParentElement(a,"table"):null}catch(d){dalert(d)}};this.divideRangeOnCellForDel=function(a){try{if(!a)return null;var b=g_objNodeUtil,d=g_objTableUtil,c=a.commonAncestorContainer;if(!c)return null;c=this.getClosetTableIfTr(c)||
c;if(!c)return null;for(var e=[],f=function(a,b,c,d){var f=new RangeProp;f.init(a,b,c,d);e.push(f)},g=new RangeProp(a),k=a=null,h=null,l=null,m=0,r=0,n=!1,q=null;!(q&&g.equal(q)||g.collapsed());)q=g.clone(),a=d.getClosetCell(g.sc,c),h=d.getClosetTable(a,c),k=d.getClosetCell(g.ec,c),l=d.getClosetTable(k,c),m=this.getDepthUntilBound(a,c),r=this.getDepthUntilBound(k,c),(n=d.isSameTable(h,l))?(f(g.sc,g.so,a,a.childNodes.length),f(a.parentNode,b.getChildIndex(a)+1,k.parentNode,b.getChildIndex(k)),f(k,
0,g.ec,g.eo),g.ec=g.sc,g.eo=g.so):m>=r&&h?(f(g.sc,g.so,a,a.childNodes.length),f(a.parentNode,b.getChildIndex(a)+1,h,h.childNodes.length),g.sc=h.parentNode,g.so=b.getChildIndex(h)+1):m<=r&&l?(f(l,0,k.parentNode,b.getChildIndex(k)),f(k,0,g.ec,g.eo),g.ec=l.parentNode,g.eo=b.getChildIndex(l)):(e.push(g.clone()),g.ec=g.sc,g.eo=g.so);for(b=0;b<e.length;b++)e[b].collapsed()&&(e.splice(b,1),b--);this.sortRangePropArrayInDocumentOrder(e);return e}catch(p){dalert(p)}};this.divideRangeOnCellForCopy=function(a){try{if(!a)return null;
var b=g_objNodeUtil,d=g_objTableUtil,c=a.commonAncestorContainer;if(!c)return null;c=this.getClosetTableIfTr(c)||c;if(!c)return null;for(var e=[],f=function(a,b,c,d){var f=new RangeProp;f.init(a,b,c,d);e.push(f)},g=new RangeProp(a),k=a=null,h=null,l=null,m=0,r=0,n=!1,q=null;!(q&&g.equal(q)||g.collapsed());)if(q=g.clone(),a=d.getClosetCell(g.sc,c),h=d.getClosetTable(a,c),k=d.getClosetCell(g.ec,c),l=d.getClosetTable(k,c),m=this.getDepthUntilBound(a,c),r=this.getDepthUntilBound(k,c),n=d.isSameTable(h,
l))f(a,0,g.sc,g.so),f(h,0,a.parentNode,b.getChildIndex(a)),f(g.ec,g.eo,k,k.childNodes.length),f(k.parentNode,b.getChildIndex(k)+1,l,l.childNodes.length),g.sc=h.parentNode,g.so=b.getChildIndex(h),g.ec=l.parentNode,g.eo=b.getChildIndex(l)+1;else if(m>=r&&h)f(a,0,g.sc,g.so),f(h,0,a.parentNode,b.getChildIndex(a)),g.sc=h.parentNode,g.so=b.getChildIndex(h);else if(m<=r&&l)f(g.ec,g.eo,k,k.childNodes.length),f(k.parentNode,b.getChildIndex(k)+1,l,l.childNodes.length),g.ec=l.parentNode,g.eo=b.getChildIndex(l)+
1;else break;for(b=0;b<e.length;b++)e[b].collapsed()&&(e.splice(b,1),b--);this.sortRangePropArrayInDocumentOrder(e);return e}catch(p){dalert(p)}};this.deleteSelectionOnCell=function(a){try{if(GetMultiCellSelection(a)||!SelectionUtil.isSelectionOnCell(a))return!1;var b=GetCurRange(a);if(!b||b.collapsed)return!1;var d=this.divideRangeOnCellForDel(b);if(!d)return!1;var c=g_objEditorDocument[a];c.defaultView.getSelection().removeAllRanges();dlog("delete selection on cell directly!");a=SelectionUtil;var e=
c.createRange();c=null;b=[];for(var f=null,g=d.length-1;0<=g;g--)d[g].getRange(e),(c=this.nativeRangeToCellRange(e))?this.deleteCell(c.stCell,c.enCell,c.matrix):(f=a.execDeleteSelection(e))&&b.push(f);this.sortRangePropArrayInDocumentOrder(b);(f=b[0])&&SetCurRange(f.getRange(e));return!0}catch(k){dalert(k)}finally{}};this.cloneSelectionOnCell=function(a){try{if(GetMultiCellSelection(a)||!SelectionUtil.isSelectionOnCell(a))return!1;var b=GetCurRange(a);if(!b||b.collapsed)return!1;var d=b.commonAncestorContainer;
if(!d)return!1;d=this.getClosetTableIfTr(d)||d;if(!d)return!1;a=g_objTableUtil;var c=g_objNodeUtil,e=function(a,b,d){for(var e=[b];a&&a!==d;)b=c.getChildIndex(a),e.push(b),a=a.parentNode;return e.reverse()},f=function(a,b){for(var c=0,d,e=0,f=a.length;e<f;e++){c=a[e];d=b.childNodes[c];if(!d)break;b=d}return{offsetNode:b,offset:c}},g=d.ownerDocument,k=new RangeProp(b),h=null,l=null,m=a.getFarthestTable(k.sc,d),r=a.getFarthestTable(k.ec,d);m&&(m.setAttribute("DZE_TEMP_CLONE_TABLE_START",""),h=e(k.sc,
k.so,m));r&&(r.setAttribute("DZE_TEMP_CLONE_TABLE_END",""),l=e(k.ec,k.eo,r));m&&(k.sc=m.parentNode,k.so=c.getChildIndex(m));r&&(k.ec=r.parentNode,k.eo=c.getChildIndex(r)+1);var n=g.createRange();n.setStart(k.sc,k.so);n.setEnd(k.ec,k.eo);var q=(new RangeArray(n)).cloneContents(!1);m&&m.removeAttribute("DZE_TEMP_CLONE_TABLE_START");r&&r.removeAttribute("DZE_TEMP_CLONE_TABLE_END");var p=g.createElement("div");p.appendChild(q);appendBodyTemporary(p,null,function(){var a=new RangeProp;a.init(p,0,p,p.childNodes.length);
var b=p.querySelector("table[DZE_TEMP_CLONE_TABLE_START]"),d=p.querySelector("table[DZE_TEMP_CLONE_TABLE_END]");b&&(b.removeAttribute("DZE_TEMP_CLONE_TABLE_START"),b=f(h,b),a.sc=b.offsetNode,a.so=b.offset);d&&(d.removeAttribute("DZE_TEMP_CLONE_TABLE_END"),b=f(l,d),a.ec=b.offsetNode,a.eo=b.offset);d=SelectionUtil;a.getRange(n);a=this.divideRangeOnCellForCopy(n);for(b=a.length-1;0<=b;b--){a[b].getRange(n);var e=this.nativeRangeToCellRange(n);e?this.deleteCell(e.stCell,e.enCell,e.matrix):d.execDeleteSelection(n)}g_objSplitUtil.mergeAll(p);
c.moveNodesTo(q,p.firstChild)}.bind(this));return q}catch(t){dalert(t)}finally{n=b=null}}},DzeTableStylePreset=[{cell:{borderStyle:["solid","solid","solid","solid"],borderWidth:["1px","1px","1px","1px"],borderColor:["#000000","#000000","#000000","#000000"]}},{cell:{borderStyle:["none","none","none","none"],borderWidth:["1px","1px","1px","1px"],borderColor:["#000000","#000000","#000000","#000000"]},row:{borderStyle:["solid",null,"solid",null],borderColor:["#808080",null,"#808080",null]}},{cell:{borderStyle:["none",
"none","none","none"],borderWidth:["1px","1px","1px","1px"],borderColor:["#000000","#000000","#000000","#000000"]},row:{borderStyle:["solid",null,"solid",null],borderColor:["#808080",null,"#808080",null]}},{cell:{borderStyle:["solid","solid","solid","solid"],borderWidth:["1px","1px","1px","1px"],borderColor:["#000000","#000000","#000000","#000000"]}},{cell:{borderStyle:["solid","solid","solid","solid"],borderWidth:["1px","1px","1px","1px"],borderColor:["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]},firstRowCell:{borderStyle:[null,
"none",null,"none"],borderColor:[null,"#FFFFFF",null,"#FFFFFF"]},row:{borderStyle:[null,"solid",null,"solid"],borderColor:[null,"#FFFFFF",null,"#FFFFFF"]},firstCol:{backgroundColor:"#808080",color:"#FFFFFF"}},{cell:{borderStyle:["none","none","none","none"],borderWidth:["1px","1px","1px","1px"],borderColor:["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]},row:{borderStyle:["solid","solid","solid","solid"],borderColor:["#808080","#808080","#808080","#808080"]}},{cell:{borderStyle:["solid","solid","solid",
"solid"],borderWidth:["1px","1px","1px","1px"],borderColor:["#000000","#000000","#000000","#000000"]}},{cell:{borderStyle:["solid","solid","solid","solid"],borderWidth:["1px","1px","1px","1px"],borderColor:["#FFFFFF","#FFFFFF","#FFFFFF","#FFFFFF"]},firstCol:{backgroundColor:"#808080",color:"#FFFFFF"}},{cell:{borderStyle:["none","none","none","none"],borderWidth:["1px","1px","1px","1px"],borderColor:["#000000","#000000","#000000","#000000"]},firstCol:{borderStyle:[null,"solid",null,null],borderColor:[null,
"#FFFFFF",null,null]},firstRowCell:{borderStyle:[null,"none","solid","none"],borderColor:[null,"#000000","#FFFFFF","#000000"]}}];
var g_ojbMaxID=1,g_objTableFunction=new function(){this.createTable=function(a,c){try{g_bActivate[c]||g_objInsertUtil.activeSaveRangeFocus(0,c);var b=!1;if(window.attachEvent)ID_STRING_NAME_CONTROL!=g_objEditorDocument[g_nActiveEditNumber].selection.type.toLowerCase()&&(b=!0);else{var d=getSelectionType();if(d.nodeType==ID_SELECTION_ELEMENT_NODE||d.nodeType==ID_SELECTION_TEXT_NODE)b=!0}if(!b)return null;var e=GetCurRange(c);if(!e)return null;var g=g_objTableUtil,f=g_objNodeUtil,l=f.getClosetBound(e.startContainer,
function(a){return f.isListItem(a)?!0:!1});if(!l)return null;var k=l.ownerDocument,h=g_objPositionUtil.getInnerWidth(l);b=function(a){return"undefined"!==typeof a&&null!==a?!0:!1};var m=a[0],n=a[1],q=a[2],y=b(a[3])?a[3]:"px",r=b(a[6])?a[6]:3,v=b(a[7])?a[7]:"1px solid rgb(0, 0, 0)",B=b(a[8])?a[8]:"1px solid rgb(0, 0, 0)",C=b(a[9])?a[9]:"1px solid rgb(0, 0, 0)",D=b(a[10])?a[10]:"1px solid rgb(0, 0, 0)",F=b(a[11])?a[11]:"1px solid rgb(0, 0, 0)",J=b(a[12])?a[12]:"1px solid rgb(0, 0, 0)",E=a[13],t=a[14],
M=a[15],w=a[16],K=a[17],u=a[18],z=a[19],x=a[20],p=a[21],G=a[22],H=b(a[23])?a[23]:!0;"%"==y?null==q&&(q=100):null==q&&(q=h);a="width:"+ID_TABLE_INSERT_CELL_WIDTH+"px;";h="height:"+ID_TABLE_INSERT_CELL_HEIGHT+"px;";b="";null!=q&&(b="width:"+q+y+";");y="";null!=r&&(y='cellpadding="'+r+'"');r='cellspacing="0"';null!=G&&(r='cellspacing="'+G+'"');G="";!0===H&&(G="border-collapse:collapse;");H=!1;v==B&&v==C&&v==D&&v==F&&v==J&&(H=!0);d="";null!=E&&(d="background-color:"+E+";");E="";null!=t&&(E="background-image:url("+
t+");",E+="background-repeat:"+M+";");t="";""!=w?"left"==w?t="margin-left:"+("undefined"!==typeof u?u:"0")+";margin-right:auto;":"center"==w?t="margin-left:auto;margin-right:auto;":"right"==w&&(t="margin-left:auto;margin-right:"+("undefined"!==typeof x?x:"0")+";"):("undefined"!==typeof u&&null!==u&&0!==u&&(t=t+"margin-left:"+u+";"),"undefined"!==typeof x&&null!==x&&0!==x&&(t=t+"margin-right:"+x+";"));"undefined"!==typeof z&&null!==z&&0!==z&&(t=t+"margin-top:"+z+";");"undefined"!==typeof p&&null!==
p&&0!==p&&(t=t+"margin-bottom:"+p+";");(u=G+b+t+d+E)&&(u='style="'+u+'"');w="";w+='<table class="dze_table"'+r+" "+y+" "+u+">";for(u=0;u<m;u++){w+="<tr>";for(z=0;z<n;z++)x="",x+=a,x+=h,H?x+="border:"+v+";":(p="",2<=m?0==u?p+="border-top:"+v+";":u==m-1?p+="border-bottom:"+C+";":(p+="border-top:"+B+";",p+="border-bottom:"+B+";"):(p+="border-top:"+v+";",p+="border-bottom:"+C+";"),2<=n&&(0==z?p+="border-left:"+D+";":z==n-1?p+="border-right:"+J+";":(p+="border-left:"+F+";",p+="border-right:"+F+";")),""!=
p&&(x+=p)),w+='<td style="'+x+'">',w+="<p><br></p>",w+="</td>";w+="</tr>"}var A=g_objInsertUtil.insertTableCodeAtSelection(w+"</table>",c);if(!0===g_browserCHK.sf&&A&&f.isCell(A.parentNode)&&A.parentNode.firstChild===A){var I=k.createElement("p");I.className="dze_hide_para";I.innerHTML="<br>";A.parentNode.insertBefore(I,A)}var N=getIntegerDivision(q,n);g_objTableSelection.doAllCell(function(a,b,c){b=g.offsetWidthToStyleWidth(N[c],a);g.setNodeValue_Width(a,b,"px")},A);K&&g_objTableOperation.table_SetTableStyle(A,
K);return A}catch(L){dalert(L)}return!1};this.GetTableCellBorderAttribute=function(a,c){try{if(!a||"left"!=c&&"top"!=c&&"right"!=c&&"bottom"!=c)return null;var b=g_objPropertyUtil,d={};d.style=b.getElementStyleAttributeValue(a,"border-"+c+"-style",g_nActiveEditNumber);var e=b.getElement_BorderWidth_With_Unit(a,c);null!=e&&(d.width=e.nValue,d.width_unit=e.strUnit);d.color=b.getElementStyleAttributeValue(a,"border-"+c+"-color",g_nActiveEditNumber);return d}catch(g){dalert(g)}};this.SetTableCellBorderAttribute=
function(a,c,b){try{if(!a||!c||"left"!=b&&"top"!=b&&"right"!=b&&"bottom"!=b)return!1;var d=g_objPropertyUtil;""==c.width_unit&&(c.width_unit="px");0!=c.width&&(a.style[camelCase("border-"+b+"-width")]=c.width+c.width_unit,d.setElement_BorderStyle(a,c.style,b),"left"==b&&d.setElement_BorderLeftColor(a,c.color),"top"==b&&d.setElement_BorderTopColor(a,c.color),"right"==b&&d.setElement_BorderRightColor(a,c.color),"bottom"==b&&d.setElement_BorderBottomColor(a,c.color));return!0}catch(e){dalert(e)}};this.doFormulaData=
function(a,c){try{for(var b=null,d=null,e=0,g=0;g<a.length;g++)if(null!=a[g]){var f=a[g].toString(),l=f.split(".");if(0==c||1==c){null==b&&(b=0);null==d&&(d=0);if(2==l.length){b+=parseInt(l[0]);var k="0."+l[1];d+=parseFloat(k)}else b+=parseInt(f);1==c&&e++}else if(2==c)if(null==b&&(b=1),2==l.length){var h=null,m=null;h=b*parseInt(l[0]);k="0."+l[1];m=b*parseFloat(k);b=h+m}else b*=parseInt(f)}if(null!=b){if(0==c)return b+d;if(1==c)return(b+d)/e;if(2==c)return b}}catch(n){dalert(n)}return null};this.getSelectedCellAttribute=
function(a,c,b){try{if(fnObjectCheckNull(a)||fnObjectCheckNull(c))return null;var d=[];d[ID_PROP_NODE_BACKGROUND_COLOR]=[];d[ID_PROP_NODE_BACKGROUND_IMAGE]=[];var e=0;g_objTableSelection.doAllSelectedCell(function(a){var b=a.style.backgroundColor;b&&(b=g_objCommonUtil.getHexColorCode(b));d[ID_PROP_NODE_BACKGROUND_COLOR][e]=b;b=g_objPropertyUtil.getBackgroundImageURL(a);if(null==b||""==b)b=null;a=a.style.backgroundRepeat;if(null==a||""==a)a=null;d[ID_PROP_NODE_BACKGROUND_IMAGE][e]=[b,a];e++},c);if(0==
e)return null;a=[];a[ID_PROP_NODE_BORDER]=this.getCellBorderAttribute(c,!0);a[ID_PROP_NODE_BACKGROUND_COLOR]=d[ID_PROP_NODE_BACKGROUND_COLOR][0];a[ID_PROP_NODE_BACKGROUND_IMAGE]=d[ID_PROP_NODE_BACKGROUND_IMAGE][0];if(1<e)for(c=1;c<e;c++)d[ID_PROP_NODE_BACKGROUND_COLOR][0]!=d[ID_PROP_NODE_BACKGROUND_COLOR][c]&&(a[ID_PROP_NODE_BACKGROUND_COLOR]=null),d[ID_PROP_NODE_BACKGROUND_IMAGE][0][0]!=d[ID_PROP_NODE_BACKGROUND_IMAGE][c][0]&&(a[ID_PROP_NODE_BACKGROUND_IMAGE]=[null,null]),d[ID_PROP_NODE_BACKGROUND_IMAGE][0][1]!=
d[ID_PROP_NODE_BACKGROUND_IMAGE][c][1]&&(a[ID_PROP_NODE_BACKGROUND_IMAGE]=[null,null]);return a}catch(g){dalert(g)}return null};this.getCellBorderAttribute=function(a,c,b){try{fnObjectCheckNull(b)&&(b="");var d="borderTop"+b,e="borderBottom"+b,g="borderRight"+b;b="borderLeft"+b;var f=[[!1,!1],[]];f[1][0]=null;f[1][1]=null;f[1][2]=null;f[1][3]=null;f[1][4]=null;f[1][5]=null;var l=g_objTableUtil.getMatrix(a),k=l?l.getSelection():null;if(!k||1<k.length)return null;k=c?k[0]:{nStartRow:0,nStartCol:0,nEndRow:l.rowLength-
1,nEndCol:l.colLength-1,arrCell:[]};c=a=0;for(var h=k.nStartCol;h<=k.nEndCol&&!(l.isBlankCol(h)||a++,1<a);h++);for(h=k.nStartRow;h<=k.nEndRow&&!(l.isBlankRow(h)||c++,1<c);h++);f[0]=[1<c?!0:!1,1<a?!0:!1];a=h=0;var m=c=null;for(h=Math.max(k.nStartRow-1,0);h<=k.nStartRow&&0<=h;h++)for(a=k.nStartCol;a<=k.nEndCol;a++)if(!l.isHideForColspan(h,a)){if(f[1][0]==ID_PROP_BORDER_DUPLICATED)break;c=l.getColRange(h,a);c.start<k.nStartCol||c.end>k.nEndCol||(m=l.getCell(h,a),h==k.nStartRow?this.assignMappingBorderValue(f[1],
0,m.style[d]):this.assignMappingBorderValue(f[1],0,m.style[e]))}for(h=k.nStartRow;h<=k.nEndRow;h++)for(a=k.nStartCol;a<=k.nEndCol;a++)if(l.isShow(h,a)){if(f[1][1]==ID_PROP_BORDER_DUPLICATED)break;m=l.getCell(h,a);h==k.nStartRow?this.assignMappingBorderValue(f[1],1,m.style[e]):this.assignMappingBorderValue(f[1],1,m.style[d])}for(h=k.nEndRow;h<=k.nEndRow+1&&h<l.rowLength;h++)for(a=k.nStartCol;a<=k.nEndCol;a++)if(!l.isHideForColspan(h,a)){if(f[1][2]==ID_PROP_BORDER_DUPLICATED)break;c=l.getColRange(h,
a);c.start<k.nStartCol||c.end>k.nEndCol||(m=l.getCell(h,a),h==k.nEndRow?this.assignMappingBorderValue(f[1],2,m.style[e]):this.assignMappingBorderValue(f[1],2,m.style[d]))}for(a=Math.max(k.nStartCol-1,0);a<=k.nStartCol&&0<=a;a++)for(h=k.nStartRow;h<=k.nEndRow;h++)if(!l.isHideForRowspan(h,a)){if(f[1][3]==ID_PROP_BORDER_DUPLICATED)break;c=l.getRowRange(h,a);c.start<k.nStartRow||c.end>k.nEndRow||(m=l.getCell(h,a),a==k.nStartCol?this.assignMappingBorderValue(f[1],3,m.style[b]):this.assignMappingBorderValue(f[1],
3,m.style[g]))}for(h=k.nStartRow;h<=k.nEndRow;h++)for(a=k.nStartCol;a<=k.nEndCol;a++)if(l.isShow(h,a)){if(f[1][4]==ID_PROP_BORDER_DUPLICATED)break;m=l.getCell(h,a);a==k.nStartCol?this.assignMappingBorderValue(f[1],4,m.style[g]):this.assignMappingBorderValue(f[1],4,m.style[b])}for(a=k.nEndCol;a<=k.nEndCol+1&&a<l.colLength;a++)for(h=k.nStartRow;h<=k.nEndRow;h++)if(!l.isHideForRowspan(h,a)){if(f[1][5]==ID_PROP_BORDER_DUPLICATED)break;c=l.getRowRange(h,a);c.start<k.nStartRow||c.end>k.nEndRow||(m=l.getCell(h,
a),a==k.nEndCol?this.assignMappingBorderValue(f[1],5,m.style[g]):this.assignMappingBorderValue(f[1],5,m.style[b]))}return f}catch(n){dalert(n)}return null};this.assignMappingBorderValue=function(a,c,b){try{ID_PROP_BORDER_DUPLICATED!=a[c]&&(null==a[c]?a[c]=b:b!=a[c]&&(a[c]=ID_PROP_BORDER_DUPLICATED))}catch(d){dalert(d)}};this.setSelectedCellAttribute=function(a,c){try{if(!fnObjectCheckNull(c)){this.setCellBorderAttribute(a[ID_PROP_NODE_BORDER],c,!0);var b=null;(a[ID_PROP_NODE_BACKGROUND_COLOR][0]?
g_objTableSelection.doAllCell:g_objTableSelection.doAllSelectedCell)(function(c){!0!==this.isCellLocked(c)&&(b=a[ID_PROP_NODE_BACKGROUND_COLOR],this.setSelectedCellAttribute_BackgroundColor(c,b[1],b[2]),b=a[ID_PROP_NODE_BACKGROUND_IMAGE],this.setSelectedCellAttribute_BackgroundImage(c,b[1],b[2],b[3]))}.bind(this),c)}}catch(d){dalert(d)}};this.setSelectedCellBackground=function(a,c){try{if(!c)return!1;(null===a||""===a)&&0<g_objTableUtil.getTableStylePreset(c)&&(a="#FFFFFF");var b=0;g_objTableSelection.doAllSelectedCell(function(c){!0!==
this.isCellLocked(c)&&this.setSelectedCellAttribute_BackgroundColor(c,!0,a)&&b++}.bind(this),c);return 0<b?!0:!1}catch(d){dalert(d)}};this.setCellBorderAttribute=function(a,c,b){try{if(a[0]){var d=a[1]?a[7]:"",e=a[2]?a[8]:"",g=a[3]?a[9]:"",f=a[4]?a[10]:"",l=a[5]?a[11]:"",k=a[6]?a[12]:"",h=new TableMatrix(c),m=h?h.getSelection():null;if(m&&!(1<m.length)){if(b)m=m[0];else{var n=[];g_objTableSelection.doAllTable(function(a){a=[].slice.call(a.querySelectorAll("td, th"));n=n.concat(a)},c);m={nStartRow:0,
nStartCol:0,nEndRow:h.rowLength-1,nEndCol:h.colLength-1,arrCell:n}}var q=m.nStartRow,y=m.nEndRow,r=m.nStartCol,v=m.nEndCol;m.arrCell.forEach(function(a){var b=h.getRowRangeFromCell(a),c=h.getColRangeFromCell(a);var m=r==c.start?f:l;null!==m&&this.setCellBorder(a,DZE_DIR.LEFT,m,h);m=v==c.end?k:l;null!==m&&this.setCellBorder(a,DZE_DIR.RIGHT,m,h);m=q==b.start?d:e;null!==m&&this.setCellBorder(a,DZE_DIR.TOP,m,h);m=y==b.end?g:e;null!==m&&this.setCellBorder(a,DZE_DIR.BOTTOM,m,h)}.bind(this))}}}catch(B){dalert(B)}};
this.setCellBorder=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeft=b;break;case DZE_DIR.TOP:a.style.borderTop=b;break;case DZE_DIR.RIGHT:a.style.borderRight=b;break;case DZE_DIR.BOTTOM:a.style.borderBottom=b;break;default:a.style.border=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,c,b,d,this.setCellBorder)}}}catch(g){dalert(g)}};this.setCellBorderWidth=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeftWidth=
b;break;case DZE_DIR.TOP:a.style.borderTopWidth=b;break;case DZE_DIR.RIGHT:a.style.borderRightWidth=b;break;case DZE_DIR.BOTTOM:a.style.borderBottomWidth=b;break;default:a.style.borderWidth=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,c,b,d,this.setCellBorderWidth)}}}catch(g){dalert(g)}};this.setCellBorderStyle=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeftStyle=b;break;case DZE_DIR.TOP:a.style.borderTopStyle=
b;break;case DZE_DIR.RIGHT:a.style.borderRightStyle=b;break;case DZE_DIR.BOTTOM:a.style.borderBottomStyle=b;break;default:a.style.borderStyle=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,c,b,d,this.setCellBorderStyle)}}}catch(g){dalert(g)}};this.setCellBorderColor=function(a,c,b,d){try{if(a){switch(c){case DZE_DIR.LEFT:a.style.borderLeftColor=b;break;case DZE_DIR.TOP:a.style.borderTopColor=b;break;case DZE_DIR.RIGHT:a.style.borderRightColor=
b;break;case DZE_DIR.BOTTOM:a.style.borderBottomColor=b;break;default:a.style.borderColor=b}if(d){var e=g_objNodeUtil.getLoopParentElement(a,"table");e&&"collapse"==e.style.borderCollapse&&this.setNeighborCellBorder(a,c,b,d,this.setCellBorderColor)}}}catch(g){dalert(g)}};this.setNeighborCellBorder=function(a,c,b,d,e){try{var g=null;g=c?[c]:[DZE_DIR.LEFT,DZE_DIR.TOP,DZE_DIR.RIGHT,DZE_DIR.BOTTOM];for(c=0;c<g.length;c++)for(var f=g[c],l=DZE_DIR.reverse(f),k=this.getNeighborCell(a,f,d),h=0;h<k.length;h++)e(k[h],
l,b)}catch(m){dalert(m)}};this.getNeighborCell=function(a,c,b){try{var d=[];if(!a||!c||!b)return d;var e=b.getMatrixIndex(a),g=e[0].row,f=e[0].col,l=b.getRowRange(g,f),k=b.getColRange(g,f);if(c==DZE_DIR.TOP){if(g=l.start-1,0>g)return d}else if(c==DZE_DIR.BOTTOM){if(g=l.end+1,g>=b.rowLength)return d}else if(c==DZE_DIR.LEFT){if(f=k.start-1,0>f)return d}else if(c==DZE_DIR.RIGHT){if(f=k.end+1,f>=b.colLength)return d}else return d;if(c==DZE_DIR.TOP||c==DZE_DIR.BOTTOM)for(f=k.start;f<=k.end&&f<b.colLength;f++){if(!b.isHideForColspan(g,
f)){var h=b.getColRange(g,f);k.start<=h.start&&k.end>=h.end&&d.push(b.getCell(g,f))}}else if(c==DZE_DIR.LEFT||c==DZE_DIR.RIGHT)for(g=l.start;g<=l.end&&g<b.rowLength;g++)b.isHideForRowspan(g,f)||(h=b.getRowRange(g,f),l.start<=h.start&&l.end>=h.end&&d.push(b.getCell(g,f)));return d}catch(m){dalert(m)}};this.setSelectedCellAttribute_BackgroundColor=function(a,c,b){try{if(!c)return!1;null==b||""==b?(a.removeAttribute("bgColor"),g_objPropertyUtil.removeStyleAttribute(a,"background-color")):(a.removeAttribute("bgColor"),
a.style.backgroundColor=b);return!0}catch(d){dalert(d)}};this.setSelectedCellAttribute_BackgroundImage=function(a,c,b,d){try{c&&(null==b||""==b?(g_objPropertyUtil.removeStyleAttribute(a,"background-image"),g_objPropertyUtil.removeStyleAttribute(a,"background-repeat")):(a.style.backgroundImage=objOnefficeLoader.m_nAppEnvType==APPENV.WE?g_onefficeWeTool&&"onex"==g_onefficeWeTool.m_IsOnex?"url("+b+")":"url("+getFullUrlFromPath(b)+")":oneffice.bUseOnexFile?"url("+b+")":"url("+getFullUrlFromPath(b)+")",
a.style.backgroundRepeat=d,"no-repeat"==d&&(a.style.backgroundPosition="center center")))}catch(e){dalert(e)}};this.setTableAttribute=function(a,c,b,d){try{if(!fnObjectCheckNull(c)&&!fnObjectCheckNull(b)){if(a[ID_PROP_NODE_BORDER][0]){var e=a[ID_PROP_NODE_BORDER][2],g=a[ID_PROP_NODE_BORDER][5],f=a[ID_PROP_NODE_BORDER][7],l=a[ID_PROP_NODE_BORDER][8],k=a[ID_PROP_NODE_BORDER][10],h=a[ID_PROP_NODE_BORDER][11],m=a[ID_PROP_NODE_BORDER][12];c=!1;f==a[ID_PROP_NODE_BORDER][9]&&f==k&&f==m&&(e&&g?f==l&&f==h&&
(c=!0):e&&!g?f==l&&(c=!0):!e&&g?f==h&&(c=!0):c=!0);if(c){var n=b.rows.length;for(e=0;e<n;e++){var q=g_objTableUtil.getTableCellsLength(b,e);for(g=0;g<q;g++)g_objTableUtil.getTableCellElement(b,e,g).style.border=f}}else this.setCellBorderAttribute(a[ID_PROP_NODE_BORDER],b,!1)}if(a[ID_PROP_NODE_BACKGROUND_COLOR][0]){var y=a[ID_PROP_NODE_BACKGROUND_COLOR][1];forEach(b.rows,function(a,b){g_objPropertyUtil.removeStyleAttribute(b,"background")},this);null==y||""==y?g_objPropertyUtil.removeStyleAttribute(b,
"background-color"):b.style.backgroundColor=y}this.setSelectedCellAttribute_BackgroundImage(b,a[ID_PROP_NODE_BACKGROUND_IMAGE][0],a[ID_PROP_NODE_BACKGROUND_IMAGE][1],a[ID_PROP_NODE_BACKGROUND_IMAGE][2]);var r=a[ID_PROP_NODE_GENERAL][0],v=a[ID_PROP_NODE_GENERAL][1];r&&(f=r,"%"===v&&(f=g_objCommonUtil.convPercentToPx(b,r/100),f=parseFloat(f.toFixed(2))),g_objTableResize.setTableSize(b,f,0,!0),"%"===v&&g_objTableUtil.setNodeValue_Width(b,r,v));g_objTableUtil.setTableCellPadding(b,a[ID_PROP_NODE_GENERAL][2]);
g_objTableUtil.setTableCellSpacing(b,a[ID_PROP_NODE_GENERAL][8]);g_objTableUtil.setTableBorderCollapse(b,a[ID_PROP_NODE_GENERAL][9]);var B=a[ID_PROP_NODE_GENERAL][3];r=!1;""==B&&(r=!0);g_objTableUtil.setAlignTableByStyleProperty(b,B,r,a[ID_PROP_NODE_GENERAL][4],a[ID_PROP_NODE_GENERAL][5],a[ID_PROP_NODE_GENERAL][6],a[ID_PROP_NODE_GENERAL][7]);if(!0===dzeUiConfig.bUseReportForm){var C=a[ID_PROP_NODE_GENERAL][10],D=a[ID_PROP_NODE_GENERAL][11];!1===fnObjectCheckNull(C)&&""!==C?b.setAttribute("id",C):
b.removeAttribute("id");!1===fnObjectCheckNull(D)&&""!==D?b.setAttribute("mapping_key",D):b.removeAttribute("mapping_key")}a[ID_PROP_NODE_STYLE]&&g_objTableOperation.table_SetTableStyle(b,a[ID_PROP_NODE_STYLE])}}catch(F){dalert(F)}};this.setLockEditCell=function(a,c){try{if(!fnObjectCheckNull(a)){var b=!1;g_objTableSelection.doAllSelectedCell(function(a){this.controlBackgroundImage(a,c,"false"===a.getAttribute("contenteditable"));"false"===a.getAttribute("contenteditable")?a.removeAttribute("contenteditable"):
a.setAttribute("contenteditable",!1);b=!0}.bind(this),a);b&&(g_objTableSelection.deselectAllCell(a),g_objUndoRedo.registerUndoRedoStack(0,c))}}catch(d){dalert(d)}};this.controlBackgroundImage=function(a,c,b){try{var d=g_objEditWindow[c].getComputedStyle(a,null);if(null===d||"none"===d)d=a.style;var e=d.backgroundImage;if(!1===b){var g="url('"+dzeEnvConfig.strPath_Image+"toolbar/ico_incell_lock.png')";if(null!==e&&"none"!==e&&0<e.length){if(!(0<=e.indexOf("ico_incell_lock.png"))){var f=d.backgroundRepeat,
l=d.backgroundPosition,k=a.style.backgroundImage;null!==k&&"none"!==k&&0<k.length?a.setAttribute("origin_bg_style",!0):a.setAttribute("origin_bg_style",!1);a.style.backgroundImage=g+", "+e;a.style.backgroundRepeat="no-repeat, "+f;a.style.backgroundPosition="right 2px bottom 2px, "+l}}else a.style.backgroundImage=g,a.style.backgroundRepeat="no-repeat",a.style.backgroundPosition="right 2px bottom 2px"}else{c=!1;if(1===e.split(",").length||"false"===a.getAttribute("origin_bg_style"))c=!0;a.removeAttribute("origin_bg_style");
!0===c?(g_objPropertyUtil.removeStyleAttribute(a,"background-image"),g_objPropertyUtil.removeStyleAttribute(a,"background-repeat"),g_objPropertyUtil.removeStyleAttribute(a,"background-position")):(f=d.backgroundRepeat,l=d.backgroundPosition,a.style.backgroundImage=e.substring(e.indexOf(",")+2,e.length),a.style.backgroundRepeat=f.substring(f.indexOf(",")+2,f.length),a.style.backgroundPosition=l.substring(l.indexOf(",")+2,l.length))}}catch(h){dalert(h)}};this.getLockedCells=function(a){try{if(fnObjectCheckNull(a))return!1;
for(var c=a.rows.length,b,d,e=[],g=0;g<c;g++){b=g_objTableUtil.getTableCellsLength(a,g);for(var f=0;f<b;f++)d=g_objTableUtil.getTableCellElement(a,g,f),"false"===d.getAttribute("contenteditable")&&e.push(d)}return e}catch(l){dalert(l)}};this.hasLockedCellInSelection=function(){try{if(fnObjectCheckNull(g_arrLockedCells))return!1;for(var a,c=0;c<g_arrLockedCells.length;c++)if(a=g_arrLockedCells[c].getAttribute("cusflag"),null===a&&(a=0),a=parseInt(a),0<a&&5>a)return!0;return!1}catch(b){dalert(b)}};
this.isCellLocked=function(a){try{if(!1===dzeUiConfig.bUseLockEditCellFunction||fnObjectCheckNull(a))return!1;var c=g_objNodeUtil.getElementTagName(a).toLowerCase();return"td"!==c&&"th"!==c||"false"!==a.getAttribute("contenteditable")?!1:!0}catch(b){dalert(b)}};this.isNeighborCellLocked=function(a,c){try{if(!a||"TD"!==a.nodeName&&"TH"!==a.nodeName)return!1;var b=g_objNodeUtil.getLoopParentElement(a,"table"),d=g_objNodeUtil.getParentElement(a).rowIndex,e=this.getFindCell(b,d,a.cellIndex,c);if(e){var g=
g_objTableUtil.getTableCellElement(b,e.nextRow,e.nextCol);if(this.isCellLocked(g))return!0}return!1}catch(f){dalert(f)}};this.isIncludedProtectedCellInColumn=function(){try{var a=g_objTableFunction.getCurrentCell(g_nActiveEditNumber);if(null===a||null===a.table)return!1;for(var c=a.table.rows,b,d=0;d<c.length;d++)if(b=c[d].cells[a.col],null!==b&&!0===this.isCellLocked(b))return!0;return!1}catch(e){dalert(e)}};this.isIncludedProtectedCellInRow=function(){try{var a=g_objTableFunction.getCurrentCell(g_nActiveEditNumber);
if(null===a||null===a.table)return!1;var c=a.table.rows[a.row].cells;for(a=0;a<c.length;a++){var b=c[a];if(null!==b&&!0===this.isCellLocked(b))return!0}return!1}catch(d){dalert(d)}};this.moveFocusNextCell=function(a,c){try{if(!a)return!1;var b=a.keyCode,d=a.shiftKey&&!a.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL);a=!0;var e=ID_KEYCODE_TAB===b;if(!(ID_KEYCODE_ARROW_LEFT===b||d&&e))if(ID_KEYCODE_ARROW_RIGHT===b||!d&&e)a=!1;else return!1;var g=GetCurTableInfo(c),f=g?g.cell:null,l=g?
g.table:null;if(!f)return!1;var k=g_objTableSelection;if(d&&!e&&!k.isCellSelected(f))return k.selectCell(f,2),this.setCellSelectionRange(c,f,a),!0;var h=this.getFindNextCell(f,!a);if(!h){if(d&&!e)return!1;if(!g_bBrowserType_IE&&l&&ID_KEYCODE_ARROW_LEFT===b&&!d&&!e){var m=l.ownerDocument;win=m.defaultView;sel=win.getSelection();range=m.createRange();range.setStartBefore(l);range.setEndBefore(l);sel.removeAllRanges();sel.addRange(range);return!0}return this.setFocusSiblingNode(g.table,a,c)}if(d&&!e){if(f===
h)return k.deselectAllCell(g.table);var n=k.selectCellRange(f,h);n&&this.setCellSelectionRange(c,f,a);return n}return this.setFocusNextCell(h,a)}catch(q){dalert(q)}return!1};this.moveFocusUpDownCell=function(a,c){try{if(!a)return!1;var b=a.keyCode,d=a.shiftKey&&!a.altKey&&!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL);a=!0;if(ID_KEYCODE_ARROW_BOTTOM===b)a=!1;else if(ID_KEYCODE_ARROW_TOP!==b)return!1;var e=GetCurTableInfo(c),g=e?e.cell:null;if(!g)return!1;b=g_objTableSelection;var f=this.getFindUpDownCell(g,
a);if(!f)return d?!1:this.setFocusSiblingNode(e.table,a,c);if(d){if(g===f)return b.deselectAllCell(e.table);var l=b.selectCellRange(g,f);l&&this.setCellSelectionRange(c,g,a);return l}return this.setFocusNextCell(f,a)}catch(k){dalert(k)}return!1};this.moveFocusCell=function(a,c){try{var b=a.keyCode;a=!0;if(ID_KEYCODE_ARROW_BOTTOM==b||ID_KEYCODE_ARROW_RIGHT==b||ID_KEYCODE_TAB==b)a=!0;else if(ID_KEYCODE_ARROW_TOP==b||ID_KEYCODE_ARROW_LEFT==b)a=!1;else return!1;var d=this.getCurrentCell(c);if(null==d)return!1;
var e=d.table,g={nextRow:d.row,nextCol:d.col};for(d=null;;){g=this.getFindCell(e,g.nextRow,g.nextCol,b);if(null==g){d=null;break}d=g_objTableUtil.getTableCellElement(e,g.nextRow,g.nextCol);break}return null==d?this.setFocusSiblingNode(e,!a,c):this.setFocusNextCell(d,!a)}catch(f){dalert(f)}};this.setCellSelectionRange=function(a,c,b){try{var d=GetCurRange(a);if(d.collapsed)if(b){if(d.startContainer!==c||0!==d.startOffset)d.setStart(c,0),SetCurRange(d)}else if(d.endContainer!==c||d.endOffset!==c.childNodes.length)d.setEnd(c,
c.childNodes.length),SetCurRange(d);return!0}catch(e){dalert(e)}finally{}};this.getCurrentCell=function(a){try{var c=null,b=null,d=-1,e=-1;if(window.attachEvent){var g=g_objEditorDocument[a].selection;if(null==g)return null;var f=g.createRange();if(null==f)return null;var l=f.parentElement();b=(b=g_objNodeUtil.getLoopParentElement(l,"td"))||g_objNodeUtil.getLoopParentElement(l,"th");if(fnObjectCheckNull(b))return null;var k=g_objNodeUtil.getLoopParentElement(b,"tr")}else{g=g_objEditWindow[a].getSelection();
if(null==g||1!=g.rangeCount)return null;f=g.getRangeAt(0);l=f.commonAncestorContainer;b=(b=g_objNodeUtil.getLoopParentElement(l,"td"))||g_objNodeUtil.getLoopParentElement(l,"th");if(fnObjectCheckNull(b))return null;k=g_objNodeUtil.getLoopParentElement(b,"tr")}if(fnObjectCheckNull(k))return null;c=g_objNodeUtil.getLoopParentElement(k,"table");if(fnObjectCheckNull(c))return null;d=k.rowIndex;e=b.cellIndex;return{table:c,cell:b,row:d,col:e}}catch(h){dalert(h)}return null};this.getFindNextCell=function(a,
c){try{if(!a)return null;var b=g_objNodeUtil,d=b.getLoopParentElement(a,"tr"),e=b.getLoopParentElement(d,"table");if(!e)return null;var g=g_objTableUtil.getSplitTables(e);if(!g)return null;var f=g.indexOf(e);if(0>f)return null;var l=d.rowIndex,k=a.cellIndex;b=a=null;if(!1===c){k--;c=!0;for(var h=f;0<=h;h--){a=g[h].rows;c||(l=a.length-1);for(var m=l;0<=m;m--){b=a[m].cells;c||(k=b.length-1);c=!1;for(var n=k;0<=n;n--)if(b[n])return b[n]}}}else for(k++,h=f;h<g.length;h++){a=g[h].rows;for(m=l;m<a.length;m++){b=
a[m].cells;for(n=k;n<b.length;n++)if(b[n])return b[n];k=0}l=0}return null}catch(q){dalert(q)}return{nextRow:0,nextCol:0}};this.getFindUpDownCell=function(a,c){try{if(!a)return null;var b=g_objNodeUtil.getLoopParentElement(a,"table");if(!b)return null;var d=new TableMatrix(b);if(!d)return null;var e=d.getMatrixIndex(a);return!e||0>=e.length?null:d.getCell(c?e[0].row-1:e[e.length-1].row+1,e[0].col)}catch(g){dalert(g)}return null};this.getFindCell=function(a,c,b,d){a=g_objTableUtil.getTableCellElement(a,
c,b);if(!a)return null;switch(d){case ID_KEYCODE_ARROW_LEFT:return this.getFindNextCell(a,!1);case ID_KEYCODE_ARROW_RIGHT:case ID_KEYCODE_TAB:return this.getFindNextCell(a,!0);case ID_KEYCODE_ARROW_TOP:return this.getFindUpDownCell(a,!0);case ID_KEYCODE_ARROW_BOTTOM:return this.getFindUpDownCell(a,!1)}return null};this.setFocusNextCell=function(a,c){try{return g_objCaretUtil.moveCaret(a,!0,c?!1:!0)}catch(b){dalert(b)}};this.setFocusSiblingNode=function(a,c,b){try{if(!a)return!1;var d=getCaretNodeWalker(a);
if(!d||!d.currentNode())return!1;var e=c?d.getPrevNodeOutside(a):d.getNextNodeOutside(a);e&&this.setFocusNextCell(e,c);return!0}catch(g){dalert(g)}};this.getTableSelectedCellHTML=function(a,c){try{if(!a)return null;var b={arrHTML:[]};g_objTableSelection.doAllSelectedCell(function(a){!1===c?b.arrHTML.push(a.innerHTML):b.arrHTML.push(a.outerHTML)},a);a=g_nActiveEditNumber;b.selection=g_objUndoRedo.getUndoRedoSelection(a);b.selectedCellCount=GetSelectedCellCount(a);b.bOuterHTML=c;return b}catch(d){dalert(d)}return null};
this.setTableSelectedCellHTML=function(a,c){try{if(!a||!c)return!1;var b=c.arrHTML;if(!b||0==b.length)return!1;var d=c.bOuterHTML,e=0;g_objTableSelection.doAllSelectedCell(function(a){b[e]&&(!1===d?a.innerHTML=b[e++]:a.outerHTML=b[e++])},a);a=g_nActiveEditNumber;g_objUndoRedo.restoreSelection(c.selection,a);g_objUndoRedo.restoreCellSelection(a,c.selectedCellCount);return!0}catch(g){dalert(g)}};this.getTableSelectedHTML=function(a){try{if(!a)return null;for(var c={arrInnerHTML:[],arrTableAttr:[]},
b=null,d=g_objTableUtil.getSplitTables(a),e=0,g=d.length;e<g;e++)c.arrInnerHTML.push(d[e].innerHTML),b=a.ownerDocument.createElement("table_attr"),g_objNodeUtil.copyAttribute(b,d[e]),c.arrTableAttr.push(b);a=g_nActiveEditNumber;c.selection=g_objUndoRedo.getUndoRedoSelection(a);c.selectedCellCount=GetSelectedCellCount(a);return c}catch(f){dalert(f)}};this.setTableSelectedHTML=function(a,c){try{if(!a||!c)return!1;var b=c.arrInnerHTML;if(!b||0==b.length)return!1;var d=c.arrTableAttr,e=g_objTableUtil.getSplitTables(a);
a=0;for(var g=e.length;a<g;a++)e[a]&&b&&b[a]&&(e[a].innerHTML=b[a]),e[a]&&d&&d[a]&&g_objNodeUtil.copyAttribute(e[a],d[a]);b=g_nActiveEditNumber;g_objUndoRedo.restoreSelection(c.selection,b);g_objUndoRedo.restoreCellSelection(b,c.selectedCellCount);return!0}catch(f){dalert(f)}}};
var g_objTableResize=new function(){var u=this;this.objVGuideline=this.objHGuideline=this.objResizeLine=this.objResizeLineLayer=this.objResizeTableLayer=null;this.nResizeStart_Y=this.nResizeStart_X=0;this.bPercentTable=!1;this.ptDiff=this.rcFrame=this.orgRect=null;this.nMinHeight=this.nMinWidth=10;this.bFromOffsetHeight=this.bFromOffsetWidth=this.bResizeMouseMove=!1;this.objResizeCell=this.objResizeTable=this.mouseDownTimeStamp=null;this.nCellIndex=this.nRowIndex=-1;this.objTableEnterLine=null;this.bTableEnterLine=
!1;this.ID_TABLE_LINE_NOTHING=0;this.ID_TABLE_LINE_TOP=1;this.matrix=null;this.bResizeLeft=this.bResizeTable=!1;this.func_onmouseup=this.func_onmousemove=null;this.initializeResizeLineLayer=function(){try{if(!this.objResizeLineLayer){var a='<div id="divResizeTable">';a+='<div id="divResizeLine" class="tbResizeLineContainer" style="display:none;">';dzeUiConfig.bCustomTableEnterLineYN&&(a+='<div id="divTableEnterLine" style="position:absolute;width:60px;height:12px;text-align:center;margin:0px;padding:0px;display:none;">',
a+='<img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_table_enter.png" alt="" border="0" />',a+="</div>");a+="</div>";a+='<div id="divResizeHGuideline" class="tbResizeHGuideline" style="display:none;"></div>';var b=g_objInsertUtil.insertLayerHTML(a+'<div id="divResizeVGuideline" class="tbResizeVGuideline" style="display:none;"></div></div>',!1);if(b){this.objResizeTableLayer=b;if(this.objResizeLineLayer=b.querySelector("#divResizeLine")){this.objResizeLineLayer.onmousedown=function(a){u.resize_onmousedown(a)};
a=0;for(var c=this.objResizeLineLayer.childNodes.length;a<c;a++){var d=this.objResizeLineLayer.childNodes[a];"tbResizeLine"===d.className&&(this.objResizeLine=d)}this.objResizeLineLayer.addEventListener("wheel",function(a){u.setTableMoveLine(!1,!1,0,0,0,0,0)},{passive:!0})}if(this.objTableEnterLine=b.querySelector("#divTableEnterLine"))this.objTableEnterLine.onclick=function(a){u.tableEnterLineClick(a,u.objResizeTable)};this.objHGuideline=b.querySelector("#divResizeHGuideline");this.objVGuideline=
b.querySelector("#divResizeVGuideline");g_objNodeUtil.initFalsePropagationEvent(this.objResizeLineLayer);g_objNodeUtil.initFalsePropagationEvent(this.objHGuideline);g_objNodeUtil.initFalsePropagationEvent(this.objVGuideline)}}}catch(e){dalert(e)}};this.unload=function(){try{var a=this.objResizeTableLayer;a&&a.parentNode&&a.parentNode.removeChild(a);this.objVGuideline=this.objHGuideline=this.objResizeLine=this.objResizeLineLayer=this.objResizeTableLayer=null}catch(b){dalert(b)}};this.getCurResizingObj=
function(){var a=g_nTableEventID;return ID_TABLE_EVENT_COL_RESIZE===a?this.objResizeCell:ID_TABLE_EVENT_ROW_RESIZE===a?this.objResizeCell:ID_TABLE_EVENT_TABLE_RESIZE===a?this.objResizeTable:null};this.tableEnterLineClick=function(a,b){try{if(dzeUiConfig.bCustomTableEnterLineYN&&!fnObjectCheckNull(b)&&this.bTableEnterLine&&ID_TABLE_EVENT_NOTHING===g_nTableEventID){TBCancelBubbleEvent(a);var c=g_objNodeUtil.getParentElement(b),d=document.createElement("p");d.innerHTML=window.attachEvent?"&nbsp;":"<br />";
c.insertBefore(d,b);this.setTableMoveLine(!1,!1,0,0,0,0,0)}}catch(e){dalert(e)}};this.resize_onmousedown=function(a,b){try{if(g_bTableResizingYN){var c=g_nActiveEditNumber;if(-1!=c){var d=g_objWrapperOutlineResize.objExtSelectedInfo;if(!d||d.nObjType!==DZE_OBJ_TD){if(this.objTableEnterLine)return this.tableEnterLineClick(a,this.objResizeTable);b===ID_TABLE_EVENT_TABLE_RESIZE&&(g_nTableEventID=ID_TABLE_EVENT_TABLE_RESIZE,this.objResizeTable=g_objTableMiniMenu.objTableNode);if(this.objResizeTable&&
ID_TABLE_EVENT_NOTHING!==g_nTableEventID){TBCancelBubbleEvent(a);g_bBrowserType_IE&&(g_arrForceCancelBubbleMouseDown[c]=!0);b=g_objPositionUtil;var e=b.GetDocumentClientPos_XY(a);this.nResizeStart_X=e.nPos_X;this.nResizeStart_Y=e.nPos_Y;this.rcFrame=b.getElementPosition(g_objEditObject[c],!1);var f=this.getCurResizingObj();this.orgRect=b.getElementPosClientRect(f);b.moveRect(this.orgRect,this.rcFrame.left,this.rcFrame.top);this.ptDiff=this.bResizeLeft?{x:this.orgRect.left-this.nResizeStart_X,y:this.orgRect.top-
this.nResizeStart_Y}:{x:this.orgRect.right-this.nResizeStart_X,y:this.orgRect.bottom-this.nResizeStart_Y};this.prepareResize(this.objResizeTable,!1);this.removeMouseListener();this.addMouseListener();g_objTransparentViewUtil.showTransparentView(!0,0);g_objTableMiniMenu.showTableMiniMenu(!1);this.bResizeMouseMove=!1;this.mouseDownTimeStamp=a.timeStamp;if("undefined"!==typeof g_objShapeFunction&&null===g_objShapeEvtMgr.getShapeTextContainer())g_objShapeFunction.onDeselectAllShapes()}}}}}catch(k){dalert(k)}};
this.resize_onmousemove=function(a){try{if(EventUtil.normalize(a),a.timeStamp<this.mouseDownTimeStamp+10||-1==g_nActiveEditNumber||!EventUtil.isLeftButtonPressed(a)||g_nTableEventID===ID_TABLE_EVENT_NOTHING)this.resize_onmouseup(a);else{var b=g_nTableEventID,c=b===ID_TABLE_EVENT_COL_RESIZE,d=b===ID_TABLE_EVENT_ROW_RESIZE;b=b===ID_TABLE_EVENT_TABLE_RESIZE;if(c||d||b){this.bResizeMouseMove=!0;this.setResizeTable(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)?!0:!1);var e=g_objPositionUtil,f=g_objZoom.getDocZoomValue(),
k=e.GetDocumentClientPos_XY(a),g=k.nPos_X+this.ptDiff.x,m=k.nPos_Y+this.ptDiff.y,h=this.orgRect,l=this.getCurResizingObj(),n=e.getElementPosClientRect(l);e.moveRect(n,this.rcFrame.left,this.rcFrame.top);var r=this.bResizeLeft,q=k=a=0,t=0;if(c||b)a=r?this.bResizeTable?0:h.right-g:g-h.left,q=r?this.bResizeTable?g-n.left:n.width-a:a-n.width;if(d||b)k=r?0:m-h.top,t=r?m-n.top:k-n.height;100!==f&&(q/=f/100,t/=f/100);q=Math.round(q);t=Math.round(t);if(0!==q||0!==t)if(c?this.doResizeCol(this.objResizeTable,
q,this.nRowIndex,this.nCellIndex):d?this.doResizeRow(this.objResizeTable,t,this.nRowIndex,this.nCellIndex):b&&this.doResizeTable(this.objResizeTable,q,t),c||d)n=e.getElementPosClientRect(l),e.moveRect(n,this.rcFrame.left,this.rcFrame.top),c?this.showVGuideline(!0,r?n.left:n.right):d&&this.showHGuideline(!0,r?n.top:n.bottom),this.moveResizeLineLayer(g,m)}}}catch(v){dalert(v),this.resize_onmouseup()}};this.resize_onmouseup=function(a){try{a=g_nActiveEditNumber;var b=this.objResizeTable;g_bBrowserType_IE&&
(g_arrForceCancelBubbleMouseDown[a]=!1);g_objTransparentViewUtil.showTransparentView(!1,null);var c=g_objPositionUtil,d=g_nTableEventID;if(d===ID_TABLE_EVENT_COL_RESIZE||d===ID_TABLE_EVENT_ROW_RESIZE){var e=this.getCurResizingObj(),f=c.getElementPosClientRect(e);c.moveRect(f,this.rcFrame.left,this.rcFrame.top);this.moveResizeLineLayer(this.bResizeLeft?f.left:f.right,this.bResizeLeft?f.top:f.bottom)}this.showHGuideline(!1);this.showVGuideline(!1);var k=b?c.getElementPosClientRect(b):null;c.moveRect(k,
this.rcFrame.left,this.rcFrame.top);g_nTableEventID!==ID_TABLE_EVENT_TABLE_RESIZE||!1!==this.bResizeMouseMove&&!c.equalRect(k,this.orgRect)?this.bResizeMouseMove&&(this.afterResize(),commonUpdateAfterChange(a,b,{bResetOutline:!1})):(g_objLayerEventUtil.initHideDynamicLayer(),g_objTableSelection.selectTable(a));g_objTableMiniMenu.delayUpdate()}catch(g){dalert(g)}finally{this.removeMouseListener()}};this.setTableMoveLine=function(a,b,c,d,e,f,k,g){try{if(g_bTableResizingYN&&this.objResizeLineLayer){this.bTableEnterLine=
!1;var m=this.objTableEnterLine,h=this.objResizeLineLayer.style;a?(h.display="",b?this.ID_TABLE_LINE_NOTHING==k?(m&&(m.style.display="none"),h.cursor="row-resize",h.left=c+"px",h.top=d-g/2-1+"px",h.width=e-c-4+"px",h.height=g+2+"px"):this.ID_TABLE_LINE_TOP==k&&m&&(this.bTableEnterLine=!0,m.style.display="",m.style.left=e-c-60+"px",h.cursor="pointer",h.left=c+"px",h.top=d-g/2-1+"px",h.width=e-c-4+"px",h.height=g+2+"px"):(h.cursor="col-resize",h.left=c-g/2-1+"px",h.top=d+"px",h.width=g+2+"px",h.height=
f-d-4+"px")):(h.display="none",m&&(m.style.display="none"))}}catch(l){dalert(l)}};this.moveResizeLineLayer=function(a,b){try{var c=this.objResizeLineLayer;if(c){var d=g_nTableEventID,e=c.style;ID_TABLE_EVENT_ROW_RESIZE===d?e.top=parseInt(b-parseInt(e.height,10)/2,10)+"px":ID_TABLE_EVENT_COL_RESIZE===d&&(e.left=parseInt(a-parseInt(e.width,10)/2,10)+"px")}}catch(f){dalert(f)}};this.checkResizeLineLayer=function(a,b){try{var c=null;if(!(!g_bTableResizingYN||-1==g_nActiveEditNumber||g_nActiveEditNumber!=
b||EventUtil.isLeftButtonPressed(a)||g_bDynamicLayer||letterFunction.getInstance().hasCopyedStyle()||g_objVideoControl.getResizeStatus()||onefficeChart&&onefficeChart.insertMode)){this.initializeResizeLineLayer();var d=a.target,e=getSelectedObjectType(d);if(e!==DZE_OBJ_SHAPE&&e!==DZE_OBJ_SHAPE_TEXT){e=g_objNodeUtil;var f=e.getLoopParentElementByTagNames(d,e.arrCellTagName),k=e.getLoopParentElement(f,"tr"),g=e.getLoopParentElement(k,"table");if(g&&!1!==g_objEditMode.isContentEditable(g))if(c=this.hitTest(f,
k,g,a.clientX,a.clientY,b)){var m=c.nTableEventID,h=c.bResizeLeft,l=c.rcFrame,n=c.pos,r=c.thick;this.objResizeTable=g;this.objResizeCell=f;this.nRowIndex=k.rowIndex;this.nCellIndex=f.cellIndex;this.bResizeLeft=h;g_nTableEventID=m;m===ID_TABLE_EVENT_COL_RESIZE?this.setTableMoveLine(!0,!1,n,l.top,n,l.bottom,0,2*r):c.nTableEventID===ID_TABLE_EVENT_ROW_RESIZE?this.setTableMoveLine(!0,!0,l.left,n,l.right,n,0,2*r):m===ID_TABLE_EVENT_TABLE_ENTERLINE&&(this.setTableMoveLine(!0,!0,l.left,n,l.right,n,1,2*r),
g_nTableEventID=ID_TABLE_EVENT_NOTHING)}else this.objResizeCell=this.objResizeTable=null,this.nCellIndex=this.nRowIndex=-1,this.bResizeLeft=this.bResizeTable=!1,g_nTableEventID=ID_TABLE_EVENT_NOTHING}}}catch(q){dalert(q)}finally{null===c&&this.objResizeLineLayer&&"none"!==this.objResizeLineLayer.style.display&&this.setTableMoveLine(!1,!1,0,0,0,0,0)}};this.hitTest=function(a,b,c,d,e,f){try{if(a&&b&&c){var k=g_objPropertyUtil;c=g_objPositionUtil;var g=c.getElementPosClientRect(a),m=g_objZoom.getDocZoomValue()/
100,h=3*m,l=parseFloat(k.getElement_BorderWidth_With_Unit(a,"left").nValue)*m,n=parseFloat(k.getElement_BorderWidth_With_Unit(a,"right").nValue)*m,r=parseFloat(k.getElement_BorderWidth_With_Unit(a,"top").nValue)*m,q=parseFloat(k.getElement_BorderWidth_With_Unit(a,"bottom").nValue)*m;l=Math.max(l/2,h);n=Math.max(n/2,h);r=Math.max(q/2,h);q=Math.max(q/2,h);a=ID_TABLE_EVENT_ROW_RESIZE;m=ID_TABLE_EVENT_COL_RESIZE;k=null;h=!1;Math.abs(g.right-d)<=n?k=m:Math.abs(g.left-d)<=l?(k=m,h=!0):Math.abs(g.bottom-
e)<=q?k=a:0!==b.rowIndex&&Math.abs(g.top-e)<=r?(k=a,h=!0):this.objTableEnterLine&&0===objTr.rowIndex&&Math.abs(g.top-e)<r&&(k=ID_TABLE_EVENT_TABLE_ENTERLINE);if(null===k)return null;d=b=0;var t=c.getElementPosition(g_objEditObject[f],!1);k===m?(b=t.left+(h?g.left:g.right),d=h?l:n):k===a?(b=t.top+(h?g.top:g.bottom),d=h?r:q):k===ID_TABLE_EVENT_TABLE_ENTERLINE&&(b=t.top+g.top,d=r);return{nTableEventID:k,bResizeLeft:h,rcFrame:t,pos:b,thick:d}}}catch(v){dalert(v)}};this.checkMinWidth=function(a,b,c){try{Array.isArray(a)||
(a=[a]);for(var d=0,e=0;e<a.length;e++)d=a[e]+c,d<b&&(d=b,c=d-a[e]);return c}catch(f){dalert(f)}};this.setResizeTable=function(a){this.bResizeTable=a?!0:!1};this.prepareResize=function(a,b){try{if(!a||!a.ownerDocument)return!1;var c=g_objTableUtil;this.objResizeTable=a;this.bFromOffsetHeight=this.bFromOffsetWidth=!0;this.bPercentTable=c.isPercentTable(a);this.setResizeTable(b);this.matrix=g_objTableUtil.getMatrix(a);c.removeHeightAttr(this.matrix.tables);c.addColgroup(a,this.matrix);c.setDzeTable(a,
this.matrix);c.resetTableCellPixelSize(a,this.matrix,c.RESET_WIDTH)}catch(d){dalert(d)}};this.afterResize=function(){try{this.bPercentTable&&(this.bPercentTable=!1,g_objTableUtil.setPercentTable(this.matrix.tables))}catch(a){dalert(a)}};this.setTableSize=function(a,b,c,d){try{if(a){this.prepareResize(a,!0);var e=g_objNodeUtil,f=this.matrix,k=b-a.offsetWidth,g=c-a.offsetHeight,m=0,h=0,l=0,n=1;if(0<b)for(m=parseInt(k/f.colLength),h=parseInt(k-m*f.colLength),l=0,n=0<k?1:-1,b=0;b<f.colLength;b++)l=0,
f.colLength-b<=Math.abs(h)&&(h+=-1*n,l=n),this.doResizeColFromMatrixIndex(a,m+l,0,b);if(0<c)for(m=parseInt(g/f.trs.length),l=parseInt(g-m*f.trs.length),n=0<g?1:-1,c=0;c<f.rowLength;c++){var r=this.matrix.getCell(c,0);a=e.getLoopParentElement(r,"table");l=0;f.rowLength-c<=Math.abs(l)&&(h+=-1*n,l=n);this.doResizeRowFromMatrixIndex(a,m+l,c,0)}!0===d?this.objResizeTable=this.matrix=null:this.afterResize()}}catch(q){dalert(q)}};this.setColWidth=function(a,b,c){try{if(!a||0>b)return!1;var d=g_objTableUtil,
e=g_objNodeUtil,f=a.calculateColWidth();if(b>=f.length)return!1;c=Math.max(c,this.nMinWidth);a.arrColWidth[b]=c;f[b]=c;for(var k=a.arraySum(f),g=0;g<a.rowLength;g++)if(!a.isHideForRowspan(g,b)){var m=a.getCell(g,b),h=a.getColRange(g,b),l=d.offsetWidthToStyleWidth(a.arraySum(f,h.start,h.end),m);d.setNodeValue_Width(m,l,"px")}for(f=0;f<a.colgroups.length;f++){var n=e.getImmediateChildNodesByTagName(a.colgroups[f],"col");d.setNodeValue_Width(n[b],c,"px")}d.setTableWidth(a.tables,k);return!0}catch(r){dalert(r)}};
this.setRowHeight=function(a,b,c){try{if(!a||0>b)return!1;var d=g_objTableUtil,e=a.calculateRowHeight();if(b>=e.length)return!1;c=Math.max(c,this.nMinHeight);a.arrRowHeight[b]=c;e[b]=c;for(var f=0;f<a.colLength;f++)if(!a.isHideForColspan(b,f)){var k=a.getCell(b,f),g=a.getRowRange(b,f),m=d.offsetHeightToStyleHeight(a.arraySum(e,g.start,g.end),k);d.setNodeValue_Height(k,m,"px")}d.setNodeValue_Height(a.trs[b],c,"px");return!0}catch(h){dalert(h)}};this.doResizeTable=function(a,b,c){try{if(!b&&!c||!a||
!this.matrix)return!1;var d=g_objNodeUtil,e=this.matrix,f=this.bResizeTable;this.bResizeTable=!0;if(0!=b){var k=b/e.colLength;for(b=0;b<e.colLength;b++)this.doResizeColFromMatrixIndex(a,k,0,b)}if(0!=c){var g=c/a.rows.length;for(a=0;a<e.rowLength;a++){var m=this.matrix.getCell(a,0),h=d.getLoopParentElement(m,"table");this.doResizeRowFromMatrixIndex(h,g,a,0)}}this.bResizeTable=f}catch(l){dalert(l)}};this.doResizeRowFromCell=function(a,b){try{if(!a||!b||!this.matrix)return!1;var c=g_objNodeUtil.getLoopParentElement(a,
"table"),d=g_objNodeUtil.getLoopParentElement(a,"tr");return c&&d?this.doResizeRow(c,b,d.rowIndex,a.cellIndex):!1}catch(e){dalert(e)}};this.doResizeRow=function(a,b,c,d){try{if(!b||!this.matrix)return!1;var e=g_objTableUtil.getTableCellElement(a,c,d);if(!e)return!1;var f=this.matrix.getMatrixIndex(e);if(!f)return!1;c=this.bResizeLeft&&g_nTableEventID===ID_TABLE_EVENT_ROW_RESIZE?f[0].row-1:f[f.length-1].row;d=f[f.length-1].col;return 0>c?!1:this.doResizeRowFromMatrixIndex(a,b,c,d)}catch(k){dalert(k)}};
this.doResizeRowFromMatrixIndex=function(a,b,c,d){try{if(!b||!this.matrix)return!1;var e=this.getHeight.bind(this),f=g_objTableUtil.setNodeValue_Height.bind(g_objTableUtil),k=this.matrix;a=c;var g=k.trs[a];c=null;var m=e(g);d=[];if(0>b)for(;0===this.checkMinWidth(m,this.nMinHeight,b)&&0<=a-1&&k.isBlankRow(a);)--a,g=k.trs[a],m=e(g);b=this.checkMinWidth(m,this.nMinHeight,b);if(0==b)return!1;for(var h=0;h<k.colLength;h++)k.isHideForColspan(a,h)||(c=k.getCell(a,h),d[h]=e(c));for(h=0;h<k.colLength;h++)k.isHideForColspan(a,
h)||(c=k.getCell(a,h),f(c,d[h]+b,"px"));f(g,m+b,"px");this.bFromOffsetHeight=!1;return!0}catch(l){dalert(l)}};this.doResizeColFromCell=function(a,b){try{if(!a||!b||!this.matrix)return!1;var c=g_objNodeUtil.getLoopParentElement(a,"table"),d=g_objNodeUtil.getLoopParentElement(a,"tr");return c&&d?this.doResizeCol(c,b,d.rowIndex,a.cellIndex):!1}catch(e){dalert(e)}};this.doResizeCol=function(a,b,c,d){try{if(!b||!this.matrix)return!1;var e=g_objTableUtil.getTableCellElement(a,c,d);if(!e)return!1;var f=
this.matrix.getMatrixIndex(e);if(!f)return!1;this.bResizeLeft&&g_nTableEventID===ID_TABLE_EVENT_COL_RESIZE?(c=f[f.length-1].row,d=f[0].col-1):(c=f[f.length-1].row,d=f[f.length-1].col);return this.doResizeColFromMatrixIndex(a,b,c,d)}catch(k){dalert(k)}};this.doResizeColFromMatrixIndex=function(a,b,c,d){try{if(!b||!this.matrix)return!1;var e=this.getWidth.bind(this),f=g_objTableUtil.setNodeValue_Width.bind(g_objTableUtil),k=g_objNodeUtil.getImmediateChildNodesByTagName.bind(g_objNodeUtil),g=this.matrix,
m=k(a,"colgroup")[0],h=k(m,"col");m=c=null;var l=Math.max(d,0),n=d+1,r=0,q=0,t=0,v=[],u=[],x=n===g.colLength;if((d=-1===d)||x||this.bResizeTable){d&&(b*=-1);r=e(a);q=e(h[l]);if(0<b)for(;0===this.checkMinWidth(q,this.nMinWidth,b)&&l+1<g.colLength&&g.isBlankCol(l+1);)l+=1,q=e(h[l]);else for(;0===this.checkMinWidth(q,this.nMinWidth,b)&&0<=l-1&&g.isBlankCol(l);)--l,q=e(h[l]);b=this.checkMinWidth(q,this.nMinWidth,b);if(0==b)return!1;for(var p=0;p<g.rowLength;p++)g.isHideForRowspan(p,l)||(c=g.getCell(p,
l),v[p]=e(c));for(p=0;p<g.rowLength;p++)g.isHideForRowspan(p,l)||(c=g.getCell(p,l),f(c,v[p]+b,"px"));for(var w=0;w<g.colgroups.length;w++)h=k(g.colgroups[w],"col"),f(h[l],q+b,"px");for(w=0;w<g.tables.length;w++)f(g.tables[w],r+b,"px")}else{q=e(h[l]);t=e(h[n]);if(0<b)for(;0===this.checkMinWidth(t,this.nMinWidth,-1*b)&&n+1<g.colLength&&g.isBlankCol(n+1);)n+=1,t=e(h[n]);else for(;0===this.checkMinWidth(q,this.nMinWidth,b)&&0<=l-1&&g.isBlankCol(l);)--l,q=e(h[l]);b=this.checkMinWidth(q,this.nMinWidth,
b);b=-1*this.checkMinWidth(t,this.nMinWidth,-1*b);if(0==b)return!1;for(p=0;p<g.rowLength;p++)g.equalCell(p,l,p,n)||(g.isHideForRowspan(p,l)||(c=g.getCell(p,l),v[p]=e(c)),g.isHideForRowspan(p,n)||(m=g.getCell(p,n),u[p]=e(m)));for(p=0;p<g.rowLength;p++)g.equalCell(p,l,p,n)||(g.isHideForRowspan(p,l)||(c=g.getCell(p,l),f(c,v[p]+b,"px")),g.isHideForRowspan(p,n)||(m=g.getCell(p,n),f(m,u[p]-b,"px")));for(w=0;w<g.colgroups.length;w++)h=k(g.colgroups[w],"col"),f(h[l],q+b,"px"),f(h[n],t-b,"px")}this.bFromOffsetWidth=
!1;return!0}catch(y){dalert(y)}};this.getCellWidth=function(a){try{if(!a)return 0;var b=a.offsetWidth;return 0==b?g_objPropertyUtil.getStyleWidth(a):g_objTableUtil.offsetWidthToStyleWidth(b,a)}catch(c){dalert(c)}};this.getCellHeight=function(a){try{if(!a)return 0;var b=a.offsetHeight;return 0==b?g_objPropertyUtil.getStyleHeight(a):g_objTableUtil.offsetHeightToStyleHeight(b,a)}catch(c){dalert(c)}};this.getColWidth=function(a){try{if(!a)return 0;var b=g_objNodeUtil,c=b.getLoopParentElement(a,"colgroup");
if(!c)return 0;var d=this.objResizeTable||b.getLoopParentElement(c,"table");if(!d)return 0;var e=this.matrix||g_objTableUtil.getMatrix(d);if(!e)return 0;c=0;for(d=a;d;)b.checkTagName(d.previousSibling,"col")&&c++,d=d.previousSibling;for(d=b=0;d<e.rowLength;d++){var f=e.getCell(d,c);if(1==e.getColspan(f)&&(b=f.offsetWidth))return b}var k=g_objPropertyUtil.getStyleWidth(a);return 0<=k?k:e.calculateColWidth()[c]}catch(g){dalert(g)}};this.getWidth=function(a,b){try{if(!a)return 0;if(!b&&!this.bFromOffsetWidth){var c=
g_objPropertyUtil.getStyleWidth(a);if(0<=c)return c}switch(a.nodeName){case "TD":case "TH":return this.getCellWidth(a);case "COL":return this.getColWidth(a)}return a.offsetWidth}catch(d){dalert(d)}};this.getHeight=function(a,b){try{if(!a)return 0;if(!b&&!this.bFromOffsetHeight){var c=g_objPropertyUtil.getStyleHeight(a);if(0<=c)return c}switch(a.nodeName){case "TD":case "TH":return this.getCellHeight(a)}return a.offsetHeight}catch(d){dalert(d)}};this.showHGuideline=function(a,b){try{if(!this.objHGuideline)return!1;
a?(this.objHGuideline.style.display="",this.objHGuideline.style.top=b+"px"):this.objHGuideline.style.display="none";return!0}catch(c){dalert(c)}};this.showVGuideline=function(a,b){try{if(!this.objVGuideline)return!1;a?(this.objVGuideline.style.display="",this.objVGuideline.style.left=b+"px"):this.objVGuideline.style.display="none";return!0}catch(c){dalert(c)}};this.addMouseListener=function(){try{this.func_onmousemove=function(a){throttle(u,u.resize_onmousemove,a)},this.func_onmouseup=function(a){throttle(u,
u.resize_onmouseup,a)},window.attachEvent?(document.attachEvent("onmousemove",this.func_onmousemove),document.attachEvent("onmouseup",this.func_onmouseup)):(document.addEventListener("mousemove",this.func_onmousemove,!1),document.addEventListener("mouseup",this.func_onmouseup,!1))}catch(a){dalert(a)}};this.removeMouseListener=function(){try{this.func_onmousemove&&this.func_onmouseup&&(window.attachEvent?(document.detachEvent("onmousemove",this.func_onmousemove),document.detachEvent("onmouseup",this.func_onmouseup)):
(document.removeEventListener("mousemove",this.func_onmousemove,!1),document.removeEventListener("mouseup",this.func_onmouseup,!1)),clearTimeout(this.func_onmousemove.tId),clearTimeout(this.func_onmouseup.tId),this.func_onmouseup=this.func_onmousemove=null)}catch(a){dalert(a)}};this.applyTableResizeKeyAction=function(a,b){try{var c=GetCurTableInfo(b);if(!c)return!1;var d=c.table,e=d.ownerDocument,f=!0,k=0;c=!(g_nTableEventID===ID_TABLE_EVENT_ROW_RESIZE||g_nTableEventID===ID_TABLE_EVENT_COL_RESIZE);
if(ID_KEYCODE_ARROW_TOP==a.keyCode)k=a.shiftKey?-1:-5,g_nTableEventID=ID_TABLE_EVENT_ROW_RESIZE;else if(ID_KEYCODE_ARROW_BOTTOM==a.keyCode)k=a.shiftKey?1:5,g_nTableEventID=ID_TABLE_EVENT_ROW_RESIZE;else if(ID_KEYCODE_ARROW_RIGHT==a.keyCode)k=a.shiftKey?1:5,f=!1,g_nTableEventID=ID_TABLE_EVENT_COL_RESIZE;else if(ID_KEYCODE_ARROW_LEFT==a.keyCode)k=a.shiftKey?-1:-5,f=!1,g_nTableEventID=ID_TABLE_EVENT_COL_RESIZE;else return!1;var g=DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)?!0:!1;this.setResizeTable(g);
if(c||null===this.matrix||this.matrix.tables&&0>this.matrix.tables.indexOf(d)){this.prepareResize(d,g);var m=function(a){if(g_nTableEventID===ID_TABLE_EVENT_ROW_RESIZE||g_nTableEventID===ID_TABLE_EVENT_COL_RESIZE)g_nTableEventID=ID_TABLE_EVENT_NOTHING;this.afterResize();commonUpdateAfterChange(b,d);EventUtil.removeHandler(e,"keyup",m)}.bind(this);EventUtil.addHandler(e,"keyup",m)}g_objTableMiniMenu.showTableMiniMenu(!1,null,b);if(DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&!a.altKey){var h=
this.matrix,l=f?h.calculateRowHeight():h.calculateColWidth(),n=[];g_objTableSelection.doAllSelectedCell(function(a){if(a=h.getMatrixIndex(a)){var b=a.length;1>b||(a=f?a[b-1].row:a[b-1].col,!isNaN(a)&&0>n.indexOf(a)&&n.push(a))}},d);n.sort();n.forEach(function(a){f?this.setRowHeight(h,a,l[a]+k):this.setColWidth(h,a,l[a]+k)}.bind(this))}else if(!DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL)&&a.altKey){var r=null,q=null;g_objTableSelection.doAllSelectedCell(function(a,b,c,d,f,e){r=a;q=e},d);if(!r)return!1;
var t=r.offsetHeight;a=t;f?this.doResizeRow(q,k,r.parentNode.rowIndex,r.cellIndex):this.doResizeCol(q,k,r.parentNode.rowIndex,r.cellIndex);a=r.offsetHeight;if(t!=a&&f){h=this.matrix;var v=h.getMatrixIndex(r),u=h.getCell(v[v.length-1].row+1,v[0].col),x=g_objNodeUtil.getLoopParentElement(u,"table");u&&this.doResizeRow(x,-1*k,u.parentNode.rowIndex,u.cellIndex)}}else return!1;return!0}catch(p){return dalert(p),!0}}};
var g_objTableMiniMenu=new function(){var k=this;this.objRowgroupControl=this.objResizeControl=this.objCommandControl=this.objTableMiniMenuLayer=null;this.bShow=!1;this.nEditNumber=0;this.rcTable=this.rcArea=this.objTableNode=null;this.arrTableRect=[];this.wheelEndTimer=this.timeoutID=null;this.strRowgroupBtnDiv="";this.initializeTableMiniMenuLayer=function(){try{if(!this.objTableMiniMenuLayer){var a='<div style="position: absolute;">';a+='<img class="tbRowgroupBtn" src="'+dzeEnvConfig.strPath_Image+
'toolbar/btn-itm-add-normal.svg" alt="'+ID_RES_CONST_STRING_ADD+'">';a+='<img class="tbRowgroupBtn" style="left:20px;" src="'+dzeEnvConfig.strPath_Image+'toolbar/btn-itm-del-normal.svg" alt="'+ID_RES_CONST_STRING_DELETE+'">';this.strRowgroupBtnDiv=a+="</div>";var b='<div id="divTableMiniMenuLayer">';b+='<div id="divTableMiniMenu" class="tbResizeLineContainer" style="display:none;background-color:#FFFFFF;cursor:pointer;z-index:'+DZE_ZINDEX_TABLE_MINI_MENU+';">';b+='<img src="'+dzeEnvConfig.strPath_Image+
'toolbar/minibar_btn_plus.gif" alt="" style="width:14px;height:14px;border:1px solid #7F7F7F;" />';b+="</div>";b+='<div id="divResizeCtrl" class="tbResizeControl" style="display:none;"></div>';b+='<div id="divRowgroupCtrl" style="position:absolute; width:60px; z-index:'+DZE_ZINDEX_TABLE_MINI_MENU+'; display:none;">';b+=a;var c=g_objInsertUtil.insertLayerHTML(b+"</div></div>",!1);if(c){this.objTableMiniMenuLayer=c;this.objCommandControl=c.querySelector("#divTableMiniMenu");this.objCommandControl.onmousedown=
function(a){TBCancelBubbleEvent(a)};this.objCommandControl.onclick=function(a){k.tableMiniMenuClick(a,k.objTableNode)};if(this.objResizeControl=c.querySelector("#divResizeCtrl"))this.objResizeControl.onmousedown=function(a){g_objTableResize.resize_onmousedown(a,ID_TABLE_EVENT_TABLE_RESIZE)};this.objRowgroupControl=c.querySelector("#divRowgroupCtrl");g_objNodeUtil.initFalsePropagationEvent(this.objCommandControl);g_objNodeUtil.initFalsePropagationEvent(this.objResizeControl);g_objNodeUtil.initFalsePropagationEvent(this.objRowgroupControl)}}}catch(d){dalert(d)}};
this.unload=function(){try{var a=this.objTableMiniMenuLayer;a&&a.parentNode&&a.parentNode.removeChild(a);this.objRowgroupControl=this.objResizeControl=this.objCommandControl=this.objTableMiniMenuLayer=null}catch(b){dalert(b)}};this.isShow=function(){return this.bShow};this.onWheel=this.onZoom=this.onResize=function(a){try{if(!this.isShow())return!1;"undefined"==typeof a&&(a=g_nActiveEditNumber);this.showTableMiniMenu(!1,null,a);clearTimeout(this.wheelEndTimer);this.wheelEndTimer=setTimeout(function(){this.update(a)}.bind(this),
120)}catch(b){dalert(b)}};this.update=function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);var b=GetCurTable(a);this.showTableMiniMenu(b?!0:!1,b,a)}catch(c){dalert(c)}};this.delayUpdate=function(a,b){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),b=isNaN(b)?10:b,clearTimeout(this.timeoutID),this.timeoutID=setTimeout(function(){g_objTableMiniMenu.update(a)},b)}catch(c){dalert(c)}};this.showTableMiniMenu=function(a,b,c){try{if(dzeUiConfig.bUseTableMiniMenu){null!=b&&null!=b.className&&
0<=b.className.indexOf("dze_tb_layout")&&(a=!1);g_readonlyMode&&(a=!1);var d=g_objWrapperOutlineResize.objExtSelectedInfo;d&&d.objElement&&"TABLE"===d.objElement.nodeName&&(a=!1);b&&b.parentNode||(b=null,a=!1);b&&!1===g_objEditMode.isContentEditable(b)&&(b=null,a=!1);a&&!this.objTableMiniMenuLayer&&this.initializeTableMiniMenuLayer();this.bShow=a;this.nEditNumber=c;this.objTableNode=b;var f=g_objPositionUtil;a&&(this.rcArea=f.getElementPosition(g_objEditObject[this.nEditNumber],!1),this.rcTable=null,
this.arrTableRect=[],g_objTableUtil.getSplitTables(this.objTableNode).forEach(function(a){var b=f.getElementPosClientRect(a);b=f.moveRect(b,this.rcArea.left,this.rcArea.top);this.arrTableRect.push(b);a==this.objTableNode&&(this.rcTable=b)}.bind(this)),f.isEmptyRect(this.rcTable)&&(this.bShow=a=!1,this.objTableNode=b=null));b&&g_objTableUtil.isBizboxReportTable(b)&&!0===this.showRowgroupControl(this.bShow)?(this.showCommandMenu(!1),this.showResizeControl(!1)):(objOnefficeLoader.m_bHybrid||(this.showCommandMenu(this.bShow),
this.showResizeControl(this.bShow)),this.showRowgroupControl(!1))}}catch(e){dalert(e)}};this.showCommandMenu=function(a){try{var b=this.objCommandControl;if(b)if(a){var c=parseFloat(b.firstChild.style.width),d=parseFloat(b.firstChild.style.height);b.style.left=this.arrTableRect[0].left-c-1+"px";b.style.top=this.arrTableRect[0].top-d-1+"px";b.style.display=""}else b.style.display="none"}catch(f){dalert(f)}};this.showResizeControl=function(a){try{var b=this.objResizeControl;b&&(a?(b.style.left=this.arrTableRect[this.arrTableRect.length-
1].right+"px",b.style.top=this.arrTableRect[this.arrTableRect.length-1].bottom+"px",b.style.display=""):b.style.display="none")}catch(c){dalert(c)}};this.showRowgroupControl=function(a){try{this.hideRowgroupControl();if(!this.objTableNode||!this.objRowgroupControl||!a)return!1;var b=g_objPositionUtil,c=DZE_CUSTOM_ATT_ROWGROUP,d=this.objTableNode.getAttribute(DZE_CUSTOM_ATT_DESC);a=0;for(var f=this.objRowgroupControl,e=f.firstChild,l=g_objTableUtil.getRows(this.objTableNode),n=null,g=0,k=l.length;g<
k;g++){var m=l[g];if(m.hasAttribute(c)&&"none"!=m.style.display){var p=m.getAttribute(c);if(p!=n){a++;var h=b.getElementPosClientRect(m);h=b.moveRect(h,this.rcArea.left,this.rcArea.top);h=b.moveRect(h,-1*this.arrTableRect[0].left,-1*this.arrTableRect[0].top);e=null==n?e:this.getNextRowgroupDiv(e,!0);e.style.top=h.top+1.5+"px";e.style.display="";e.setAttribute(c,p);this.initializeRowgroupBtns(e,d);n=p}}}e=this.getNextRowgroupDiv(f.firstChild);for(d=null;e;)d=this.getNextRowgroupDiv(e),""!=e.style.display&&
(this.finalizeRowgroupBtns(e),e.parentNode.removeChild(e)),e=d;if(0>=a)return!1;var q=f.firstChild?f.firstChild.lastChild:null;q&&(q.style.display=1<f.childNodes.length?"":"none");f.style.left=this.arrTableRect[0].right+"px";f.style.top=this.arrTableRect[0].top+"px";f.style.display="";if(f.childNodes){var r="scale("+g_objZoom.getDocZoomValue()/100+")";for(g=0;g<f.childNodes.length;g++)f.childNodes[g].style.transform=r,f.childNodes[g].style.transformOrigin="left top"}return!0}catch(t){return dalert(t),
!1}};this.hideRowgroupControl=function(){try{if(this.objRowgroupControl){var a=this.objRowgroupControl;a.style.display="none";a.left="0px";a.top="0px";for(var b=a.firstChild;b;)b.style.display="none",b.left="0px",b.top="0px",b=b.nextSibling}}catch(c){dalert(c)}};this.getNextRowgroupDiv=function(a,b){try{if(a){if(a.nextSibling)return a.nextSibling;if(b){var c=document.createRange().createContextualFragment(this.strRowgroupBtnDiv);this.objRowgroupControl.appendChild(c);return this.objRowgroupControl.lastChild}}return null}catch(d){dalert(d)}};
this.initializeRowgroupBtns=function(a,b){try{if(a){var c=a.firstChild,d=c?c.nextSibling:null;if(c&&d){if(!a._bInit){a._bInit=!0;var f=this;c._onclick=function(){var a=this.parentNode.getAttribute(DZE_CUSTOM_ATT_ROWGROUP);g_objTableOperation.addRowgroup(f.objTableNode,a,f.nEditNumber)};d._onclick=function(){var a=this.parentNode.getAttribute(DZE_CUSTOM_ATT_ROWGROUP);g_objTableOperation.deleteRowgroup(f.objTableNode,a,f.nEditNumber)};c.addEventListener("click",c._onclick,!1);d.addEventListener("click",
d._onclick,!1);c._onmouseover=function(){this.src=dzeEnvConfig.strPath_Image+"toolbar/btn-itm-add-over.svg"};d._onmouseover=function(){this.src=dzeEnvConfig.strPath_Image+"toolbar/btn-itm-del-over.svg"};c.addEventListener("mouseover",c._onmouseover,!1);d.addEventListener("mouseover",d._onmouseover,!1);c._onmouseout=function(){this.src=dzeEnvConfig.strPath_Image+"toolbar/btn-itm-add-normal.svg"};d._onmouseout=function(){this.src=dzeEnvConfig.strPath_Image+"toolbar/btn-itm-del-normal.svg"};c.addEventListener("mouseout",
c._onmouseout,!1);d.addEventListener("mouseout",d._onmouseout,!1);a._onmousedown=function(a){TBCancelBubbleEvent(a)};a.addEventListener("mousedown",a._onmousedown,!1);c.addEventListener("mousedown",a._onmousedown,!1);d.addEventListener("mousedown",a._onmousedown,!1);a._ondrag=function(){return!1};a.addEventListener("dragstart",a._ondragstart,!1);c.addEventListener("dragstart",a._ondragstart,!1);d.addEventListener("dragstart",a._ondragstart,!1);var e=g_objNodeUtil;e.initFalsePropagationEvent(a);e.initFalsePropagationEvent(c);
e.initFalsePropagationEvent(d)}e=a="";switch(b){case DZE_CUSTOM_VALUE_SCHEDULE:a=ID_RES_CONST_STRING_ADD_SCHEDULE;e=ID_RES_CONST_STRING_DELETE_SCHEDULE;break;case DZE_CUSTOM_VALUE_TASK:a=ID_RES_CONST_STRING_ADD_TASK;e=ID_RES_CONST_STRING_DELETE_TASK;break;case DZE_CUSTOM_VALUE_TASK_SCHEDULE:a=ID_RES_CONST_STRING_ADD_TASK_SCHEDULE;e=ID_RES_CONST_STRING_DELETE_TASK_SCHEDULE;break;default:a=ID_RES_CONST_STRING_ADD,e=ID_RES_CONST_STRING_DELETE}a&&c.setAttribute("title",a);e&&d.setAttribute("title",e)}}}catch(l){dalert(l)}};
this.finalizeRowgroupBtns=function(a){try{if(a){var b=a.firstChild,c=b?b.nextSibling:null;b&&c&&a._bInit&&(a._bInit=!1,b.removeEventListener("click",b._onclick),c.removeEventListener("click",c._onclick),b._onclick=null,c._onclick=null,b.removeEventListener("mouseover",b._onmouseover),c.removeEventListener("mouseover",c._onmouseover),b._onmouseover=null,c._onmouseover=null,b.removeEventListener("mouseout",b._onmouseout),c.removeEventListener("mouseout",c._onmouseout),b._onmouseout=null,c._onmouseout=
null,a.removeEventListener("mousedown",a._onmousedown,!1),b.removeEventListener("mousedown",a._onmousedown,!1),c.removeEventListener("mousedown",a._onmousedown,!1),a._onmousedown=null,a.removeEventListener("dragstart",a._ondrag,!1),b.removeEventListener("dragstart",a._ondrag,!1),c.removeEventListener("dragstart",a._ondrag,!1),a._ondrag=null)}}catch(d){dalert(d)}};this.tableMiniMenuClick=function(a,b){try{if(!fnObjectCheckNull(b)){g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);var c={nContextMenuType:g_objContextMenuWin.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU,
strSelectedTagName:""},d=this.arrTableRect[0],f=parseFloat(this.objCommandControl.firstChild.style.height);g_objContextMenuWin.showContextMenuLayer(c,d.left+1,d.top-f-1,g_nActiveEditNumber)}}catch(e){dalert(e)}}};
var dzeWebSearch={searchBTnObj:null,searchText:"",nEditNumber:0,getMoreDataMethod:"scroll",viewWebSearchBtn:function(a,b){try{this.nEditNumber=a,!0===dzeUiConfig.bSearchKeyword&&setTimeout(function(){dzeWebSearch.searchText=getSelectionTextValue(a).trim();if(!(2>dzeWebSearch.searchText.length||30<dzeWebSearch.searchText.length)){if(null==dzeWebSearch.searchBTnObj){dzeWebSearch.searchBTnObj=g_objLayerKit.getLayerDocument().createElement("div");dzeWebSearch.searchBTnObj.id="dze_dic_search";dzeWebSearch.searchBTnObj.className=
"dze_dic_search_btn_container";dzeWebSearch.searchBTnObj.style.display="none";var d="<table border='0' cellspacing='0' cellpadding='0' height='27' style='border-spacing: 0;'><tr><td class='dze_dic_search_btn_td_left'></td><td class='dze_dic_search_btn_td_mid'></td>"+("<td class='dze_dic_search_btn_td_text'>"+ID_RES_CONST_STRING_WEB_SEARCH+"</td>");d=d+"<td class='dze_dic_search_btn_td_mid'></td>"+("<td class='dze_dic_search_btn_td_searchimg'><img src='"+dzeEnvConfig.strPath_Image+"dialog/ico_txt_search.png' /></td>");
dzeWebSearch.searchBTnObj.innerHTML=d+"<td class='dze_dic_search_btn_td_mid'></td><td class='dze_dic_search_btn_td_right'></td></tr></table>";g_objLayerKit.getLayerDocument().body.appendChild(dzeWebSearch.searchBTnObj);dzeWebSearch.searchBTnObj.onclick=function(b){dzeWebSearch.viewWebSearchDialog(b?b:window.event,a);dzeWebSearch.hideWebSearchBtn()}}"none"==dzeWebSearch.searchBTnObj.style.display&&(duzon_dialog.fade("in",dzeWebSearch.searchBTnObj),dzeWebSearch.setLayerPosition(dzeWebSearch.searchBTnObj,
b,a))}},0)}catch(d){dalert(d)}},hideWebSearchBtn:function(){try{null!=dzeWebSearch.searchBTnObj&&(dzeWebSearch.searchBTnObj.style.display="none")}catch(a){dalert(a)}},viewWebSearchDialog:function(a,b){try{duzon_dialog.viewDialog(a,b,ID_RES_CONST_STRING_WEB_SEARCH,dzeWebSearch.getTabContents_Search(),1,[ID_RES_ADJUST_VIEW_CLOSE],[function(a){duzon_dialog.closeDialog()}],function(){dzeWebSearch.initialize();duzon_dialog.viewTabContents(0)},function(){dzeWebSearch.searchText="";dzeWebSearch.displaySearchMoreOk=
[!0,!0,!0]},!0,"screen_center")}catch(d){dalert(d)}},getTabContents_Search:function(){try{var a=duzon_dialog.getTabContents(3,[ID_RED_CONST_STRING_ENCYCLOPEDIA,ID_RED_CONST_STRING_IMAGE,ID_RED_CONST_STRING_NEWS],[dzeWebSearch.createSearchContainer("dic"),dzeWebSearch.createSearchContainer("img"),dzeWebSearch.createSearchContainer("news")],[90,70,60],dzeWebSearch.createSearchDefaultContainer(),[function(){g_objLayerKit.getElementById(dzeWebSearch.dze_idx_dic_search_content).childNodes.length||dzeWebSearch.viewContents()},
function(){g_objLayerKit.getElementById(dzeWebSearch.dze_idx_img_search_content).childNodes.length||dzeWebSearch.viewContents()},function(){g_objLayerKit.getElementById(dzeWebSearch.dze_idx_news_search_content).childNodes.length||dzeWebSearch.viewContents()}],dzeWebSearch.getSearchWordFormContainer()),b=document.createElement("div");b.className="duzon_dialog_content_big";b.appendChild(a);return b}catch(d){dalert(d)}},dze_idx_search_btn_more_container:"dze_idx_search_btn_more_container",dze_idx_search_btn_more:"dze_idx_img_search_btn_more",
dze_idx_search_btn_more_obj:null,displaySearchMoreOk:[!0,!0,!0],displaySearchResultCount:[0,0,0],createSearchDefaultContainer:function(){try{var a=document.createElement("div");a.className="dze_search_btn_more_container";a.id=this.dze_idx_search_btn_more_container;"button"==this.getMoreDataMethod&&(this.dze_idx_search_btn_more_obj=document.createElement("input"),this.dze_idx_search_btn_more_obj.type="button",this.dze_idx_search_btn_more_obj.id=this.dze_idx_search_btn_more,this.dze_idx_search_btn_more_obj.value=
ID_RED_CONST_STRING_VIEW_MORE,this.dze_idx_search_btn_more_obj.style.display="none",this.dze_idx_search_btn_more_obj.onclick=function(){dzeWebSearch.viewContents()},a.appendChild(this.dze_idx_search_btn_more_obj));var b=document.createElement("div");b.className="websearch_license_view";b.innerHTML="<a href='https://developers.naver.com' target='_blank' title='Powered by NAVER OpenAPI' style='text-decoration:none'><b><span style='color:#959595'>Powered by</span> <span style='color:#07C740'>NAVER</span> <span style='color:#474747'>OpenAPI</span></b></a>";
a.appendChild(b);return a}catch(d){dalert(d)}},setSearchBtnMoreStatus:function(a){try{"button"==this.getMoreDataMethod&&("show"==a?(this.dze_idx_search_btn_more_obj.value=ID_RED_CONST_STRING_VIEW_MORE,this.dze_idx_search_btn_more_obj.disabled=!1,this.dze_idx_search_btn_more_obj.style.display="inline"):"wait"==a?(this.dze_idx_search_btn_more_obj.value=ID_RED_CONST_STRING_SEARCHING,this.dze_idx_search_btn_more_obj.disabled=!0,this.dze_idx_search_btn_more_obj.style.display="inline"):this.dze_idx_search_btn_more_obj.style.display=
"none")}catch(b){dalert(b)}},displaySearchResultData:function(a,b){try{"dic"==a.searchType?dzeWebSearch.displayDicSearchResultData(a,b):"img"==a.searchType?dzeUiConfig.bSupportNewsEditor?dzeWebSearch.displayImgSearchResultData(a,b):dzeWebSearch.displayImgSearchResultDataOrg(a,b):"news"==a.searchType&&dzeWebSearch.displayNewsSearchResultData(a,b)}catch(d){dalert(d)}},createSearchContainer:function(a){try{var b={};"dic"==a?b=dzeWebSearch.createDicSearchContainer():"img"==a?b=dzeWebSearch.createImgSearchContainer():
"news"==a&&(b=dzeWebSearch.createNewsSearchContainer());return b}catch(d){dalert(d)}},addScrollEvent:function(a){try{a.onscroll=function(){dzeWebSearch.viewContents()}}catch(b){dalert(b)}},removeScrollEvent:function(a){try{a.onscroll=function(){}}catch(b){dalert(b)}},dze_idx_dic_search_content:"dze_idx_dic_search_content",createDicSearchContainer:function(){try{var a=document.createElement("div");a.className="dze_search_content_container";a.id=this.dze_idx_dic_search_content;return a}catch(b){dalert(b)}},
diaplayDicImageSize:110,displayDicSearchResultData:function(a,b){try{var d=g_objLayerKit.getElementById(this.dze_idx_dic_search_content);if(0<a.total)for(var c="",e="",h="",g=0;g<a.display;g++)e="",""!=a.items[g].thumbnail&&(e="<img src='"+a.items[g].thumbnail+"' align='left' title='' alt='result image' />"),h="",""!=a.items[g].link&&(h=" <a href='"+a.items[g].link+"' target='_blank' title='"+a.items[g].link+"'>"+ID_RED_CONST_STRING_VIEW_MORE+"</a>"),c+="<div class='dze_search_content_result_line'>",
c+="<div class='dze_search_content_result_title'>"+a.items[g].title+"</div>",c+="<div class='dze_search_content_result_description'><table width='100%' border='0' cellspacing='0' cellpadding='0'><tr><td>"+e+a.items[g].description+h+"</td></tr></table></div>",c+="</div>";else c=this.getNoResultDataHtml();var f=document.createElement("div");f.innerHTML=c;var k=f.getElementsByTagName("img"),l=this.nEditNumber;for(g=0;g<k.length;g++)k[g].onload=function(){this.ondblclick=function(){if(!0!==g_readonlyMode){var a=
new Image;a.src=this.src;a.onload=function(){this.onload=null;duzon_dialog.closeDialog();setOrgImageSize(a,getMaxBoundSize(l),!0);insertHTMLCodeAtSelection(null,a,l);g_objTableFlag.ResetTableInfo();g_objUndoRedo.registerUndoRedoStack(0,l);editor_onselectionchange(l);g_objPageControl.onSetDelayedUpdatePageTimer()}}}},k[g].onerror=function(){this.parentNode.removeChild(this)};dzeUiConfig.bSupportNewsEditor&&!g_objPropertyUtil.hasClass(d,"tab_contents_websearch")&&g_objPropertyUtil.addClass(d,"tab_contents_websearch");
d.appendChild(f);"function"==typeof b&&b()}catch(n){dalert(n)}},dze_idx_img_search_content:"dze_idx_img_search_content",createImgSearchContainer:function(){try{var a=document.createElement("div");a.className="dze_search_content_container";a.id=this.dze_idx_img_search_content;return a}catch(b){dalert(b)}},displayImageSize:110,noImageSrc:"",displayImgSearchResultData:function(a,b){try{dzeWebSearch.displayImageSize=100;var d=g_objLayerKit.getElementById(this.dze_idx_img_search_content),c=g_objLayerKit.getElementById("websearchMsg"),
e=c?c:document.createElement("div");c||(e.id="websearchMsg",e.className="",e.style.width="100%",e.style.height="20px",e.style.position="relative",e.style.backgroundColor="#f2f2f2",e.style.color="#8c8c8c",e.style.textAlign="center",e.style.lineHeight="1.8",e.style.marginBottom="1px",e.style.borderBottom="1px solid #d9d9d9",e.style.padding="5px",e.style.userSelect="none",e.innerHTML=ID_RES_STRING_WEBSEARCH_IMG_DBCLICK,d.parentElement.insertBefore(e,d));this.noImageSrc=dzeEnvConfig.strPath_Image+"dialog/noimage.png";
if(0<a.total){1==a.start&&"\uc721\uad70\uad50\uc721\uc0ac\ub839\ubd80"==dzeWebSearch.searchText&&(a.items.unshift({link:"",sizeheight:"40",sizewidth:"110",thumbnail:dzeEnvConfig.strPath_Image+"edu_army2.png",title:"\uc721\uad70\uad50\uc721\uc0ac\ub839\ubd80"}),a.items.unshift({link:"",sizeheight:"80",sizewidth:"80",thumbnail:dzeEnvConfig.strPath_Image+"edu_army1.jpg",title:"\uc721\uad70 \uad50\uc721\uc0ac\ub839\ubd80"}));c="";var h="<table width='100%' border='0' cellpadding='2' cellspacing='2'>";
e=!0;for(var g="",f=0;f<a.display;f++){e&&(h+="<tr>",e=!1);c="";if(""!=a.items[f].thumbnail){var k=parseInt(a.items[f].sizewidth,10),l=parseInt(a.items[f].sizeheight,10);k<dzeWebSearch.displayImageSize&&l<dzeWebSearch.displayImageSize||(k>=l?(l=parseInt(l*dzeWebSearch.displayImageSize/k),k=dzeWebSearch.displayImageSize):(k=parseInt(k*dzeWebSearch.displayImageSize/l),l=dzeWebSearch.displayImageSize));c="<img src='"+a.items[f].thumbnail+"' width='"+k+"' height='"+l+"' style='margin-bottom:4px;' linkPath='"+
a.items[f].link+"' />"}g=a.items[f].title;""!=a.items[f].link&&(g=" <a href='"+a.items[f].link+"' target='_blank' title='"+a.items[f].link+"'><div style='width:"+dzeWebSearch.displayImageSize+"px;height:40px;overflow:hidden;line-height:1.1;text-align:left'>"+g+"</div></a>");h+="<td width="+dzeWebSearch.displayImageSize+" style='padding-top:4px;padding-bottom:4px;text-align:center;vertical-align:top' align='center'><div style='width:auto;clear:both'>"+c+"</div><div style='width:auto;clear:both;overflow:hidden'>"+
g+"</div></td>";(f+1)%3||(h+="</tr>",e=!0)}h+="</table>"}else h=this.getNoResultDataHtml();var n=document.createElement("div");n.innerHTML=h;var p=n.getElementsByTagName("img"),m=this.nEditNumber;for(f=0;f<p.length;f++)p[f].ondblclick=function(){if(!0!==g_readonlyMode){var a=this.src,b=a;this.getAttribute("linkPath")&&(b=this.getAttribute("linkPath"));var c=new Image;c.src=b;c.onload=function(){this.onload=null;duzon_dialog.closeDialog();setOrgImageSize(this,getMaxBoundSize(m),!0);insertHTMLCodeAtSelection(null,
this,m);g_objTableFlag.ResetTableInfo();g_objUndoRedo.registerUndoRedoStack(0,m);editor_onselectionchange(m);g_objPageControl.onSetDelayedUpdatePageTimer()};c.onerror=function(){if(a!=this.src){var b=new Image;b.src=a;b.onload=function(){this.onload=null;duzon_dialog.closeDialog();setOrgImageSize(this,getMaxBoundSize(m),!0);insertHTMLCodeAtSelection(null,this,m);g_objUndoRedo.registerUndoRedoStack(0,m);editor_onselectionchange(m);g_objPageControl.onSetDelayedUpdatePageTimer()};b.onerror=function(){}}}}},
function(){var a=0,b=p[f],c=p[f].getAttribute("linkPath"),d=dzeWebSearch.noImageSrc;b.onerror=function(){a++;this.removeAttribute("linkPath");1<a?(this.src=d,this.setAttribute("width",dzeWebSearch.displayImageSize),this.setAttribute("height",dzeWebSearch.displayImageSize),this.style.opacity="0.2",this.ondblclick=function(){},this.parentNode.nextSibling.innerHTML=""):c&&(this.src=c)}}();dzeUiConfig.bSupportNewsEditor&&!g_objPropertyUtil.hasClass(d,"tab_contents_websearch")&&g_objPropertyUtil.addClass(d,
"tab_contents_websearch");d.appendChild(n);"function"==typeof b&&b()}catch(q){dalert(q)}},displayImgSearchResultDataOrg:function(a,b){try{var d=g_objLayerKit.getElementById(this.dze_idx_img_search_content);this.noImageSrc=dzeEnvConfig.strPath_Image+"dialog/noimage.png";if(0<a.total){1==a.start&&"\uc721\uad70\uad50\uc721\uc0ac\ub839\ubd80"==dzeWebSearch.searchText&&(a.items.unshift({link:"",sizeheight:"40",sizewidth:"110",thumbnail:dzeEnvConfig.strPath_Image+"edu_army2.png",title:"\uc721\uad70\uad50\uc721\uc0ac\ub839\ubd80"}),
a.items.unshift({link:"",sizeheight:"80",sizewidth:"80",thumbnail:dzeEnvConfig.strPath_Image+"edu_army1.jpg",title:"\uc721\uad70 \uad50\uc721\uc0ac\ub839\ubd80"}));for(var c="",e="<table width='100%' border='0' cellpadding='5' cellspacing='5'>",h=!0,g="",f=0;f<a.display;f++){h&&(e+="<tr>",h=!1);c="";if(""!=a.items[f].thumbnail){var k=parseInt(a.items[f].sizewidth,10),l=parseInt(a.items[f].sizeheight,10);k<this.displayImageSize&&l<this.displayImageSize||(k>=l?(l=parseInt(l*this.displayImageSize/k),
k=this.displayImageSize):(k=parseInt(k*this.displayImageSize/l),l=this.displayImageSize));c="<img src='"+a.items[f].thumbnail+"' width='"+k+"' height='"+l+"' style='margin-bottom:5px;' linkPath='"+a.items[f].link+"' />"}g=a.items[f].title;""!=a.items[f].link&&(g=" <a href='"+a.items[f].link+"' target='_blank' title='"+a.items[f].link+"'><div style='width:110px;height:40px;overflow:hidden;line-height:1.2;text-align:left'>"+g+"</div></a>");e+="<td width='110' style='padding:5px;text-align:center;vertical-align:top' align='center'><div style='width:auto;clear:both'>"+
c+"</div><div style='width:auto;clear:both;overflow:hidden'>"+g+"</div></td>";(f+1)%3||(e+="</tr>",h=!0)}e+="</table>"}else e=this.getNoResultDataHtml();var n=document.createElement("div");n.innerHTML=e;var p=n.getElementsByTagName("img"),m=this.nEditNumber;for(f=0;f<p.length;f++)p[f].ondblclick=function(){if(!0!==g_readonlyMode){var a=this.src,b=a;this.getAttribute("linkPath")&&(b=this.getAttribute("linkPath"));var c=new Image;c.src=b;c.onload=function(){this.onload=null;duzon_dialog.closeDialog();
setOrgImageSize(this,getMaxBoundSize(m),!0);insertHTMLCodeAtSelection(null,this,m);g_objTableFlag.ResetTableInfo();g_objUndoRedo.registerUndoRedoStack(0,m);editor_onselectionchange(m);g_objPageControl.onSetDelayedUpdatePageTimer()};c.onerror=function(){if(a!=this.src){var b=new Image;b.src=a;b.onload=function(){this.onload=null;duzon_dialog.closeDialog();setOrgImageSize(this,getMaxBoundSize(m),!0);insertHTMLCodeAtSelection(null,this,m);g_objUndoRedo.registerUndoRedoStack(0,m);editor_onselectionchange(m);
g_objPageControl.onSetDelayedUpdatePageTimer()};b.onerror=function(){}}}}},function(){var a=0,b=p[f],c=p[f].getAttribute("linkPath"),d=dzeWebSearch.noImageSrc;b.onerror=function(){a++;this.removeAttribute("linkPath");1<a?(this.src=d,this.setAttribute("width",110),this.setAttribute("height",110),this.style.opacity="0.2",this.ondblclick=function(){},this.parentNode.nextSibling.innerHTML=""):c&&(this.src=c)}}();dzeUiConfig.bSupportNewsEditor&&!g_objPropertyUtil.hasClass(d,"tab_contents_websearch")&&
g_objPropertyUtil.addClass(d,"tab_contents_websearch");d.appendChild(n);"function"==typeof b&&b()}catch(q){dalert(q)}},dze_idx_news_search_content:"dze_idx_news_search_content",createNewsSearchContainer:function(){try{var a=document.createElement("div");a.className="dze_search_content_container";dzeUiConfig.bSupportNewsEditor&&(a.className+=" tab_contents_websearch");a.id=this.dze_idx_news_search_content;return a}catch(b){dalert(b)}},displayNewsSearchResultData:function(a,b){try{var d=g_objLayerKit.getElementById(this.dze_idx_news_search_content);
if(0<a.total)for(var c="",e="",h="",g=0;g<a.display;g++){var f=a.items[g].title;""!=a.items[g].link&&(f=" <a href='"+a.items[g].link+"' target='_blank' title='"+a.items[g].link+"'>"+f+"</a>");e=a.items[g].originallink.split("/");h=e[0]+"//"+e[2];h="<a href='"+a.items[g].originallink+"' target='_blank' title='"+a.items[g].originallink+"'>"+h+"</a>";c+="<div class='dze_search_content_result_line'>";c+="<div class='dze_search_content_result_title'>"+f+"</div>";c+="<div class='dze_search_content_result_description'>"+
a.items[g].description+"<br />["+h+" "+this.convTimeFormat(a.items[g].pubDate)+"]</div>";c+="</div>"}else c=this.getNoResultDataHtml();var k=document.createElement("div");k.innerHTML=c;d.appendChild(k);"function"==typeof b&&b()}catch(l){dalert(l)}},getNoResultDataHtml:function(){try{var a=ID_RES_CONST_STRING_NO_SEARCH_RESULT;""==dzeWebSearch.searchText&&(a=ID_RES_CONST_STRING_INPUT_SEARCH_KEYWORD);var b="<div class='dze_search_content_result_line'>";return b+("<div class='dze_search_content_result_description'>"+
a+"</div>")+"</div>"}catch(d){dalert(d)}},convTimeFormat:function(a){try{var b=a.split(",")[1].trim().split(" "),d=b[2],c=this.convMonthStr(b[1],1),e=b[0],h=b[3].split(":")[0]+":"+b[3].split(":")[1];return d+"-"+c+"-"+e+" "+h}catch(g){dalert(g)}},convMonthStr:function(a,b){try{var d=" Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),c="";if(2==b)c=d[a];else for(var e in d)if(a.toLowerCase()==d[e].toLowerCase()){c=e;10>c&&(c="0"+c);break}return c}catch(h){dalert(h)}},searchData:function(a,
b,d,c,e){try{isNaN(d)&&(d=1),duzon_http.ajax({type:"get",url:dzeEnvConfig.strSearchWordURL,async:!0,dataType:"json",data:{searchType:a,query:b,start:d,display:c},timeout:3E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(c){"undefined"!=typeof e&&null!=e&&""!=e&&(c.searchType=a,c.query=b,"undefined"!=typeof c.start&&(c.last=c.start-1+c.display),dzeWebSearch.setSearchMoreOk(c),e(c))},error:function(a){}})}catch(h){dalert(h)}},viewContents:function(a){try{var b=dzeWebSearch.displaySearchResultCount[duzon_dialog.currTabIdx]+
1,d=dzeWebSearch.getTabIdxToSearchType(duzon_dialog.currTabIdx),c=dzeWebSearch.searchCountArray[duzon_dialog.currTabIdx];if(!0===dzeWebSearch.displaySearchMoreOk[duzon_dialog.currTabIdx]){if("scroll"==this.getMoreDataMethod){var e=dzeWebSearch.getCurTabContainer();if(!e||e.offsetHeight+e.scrollTop<e.scrollHeight)return;dzeWebSearch.removeScrollEvent(e)}"button"==this.getMoreDataMethod&&dzeWebSearch.setSearchBtnMoreStatus("wait");dzeWebSearch.searchData(d,dzeWebSearch.searchText,b,c,function(a){dzeWebSearch.displaySearchResultData(a);
dzeWebSearch.setSearchBtnMoreStatus("hide");a.start-1+a.display<a.total&&("scroll"==dzeWebSearch.getMoreDataMethod?setTimeout(function(){dzeWebSearch.addScrollEvent(e)},0):"button"==dzeWebSearch.getMoreDataMethod&&dzeWebSearch.setSearchBtnMoreStatus("show"))})}}catch(h){dalert(h)}},setSearchMoreOk:function(a){try{var b=0;"img"==a.searchType?b=1:"news"==a.searchType&&(b=2);a.total>a.start-1+a.display&&(dzeWebSearch.displaySearchMoreOk[b]=!0);dzeWebSearch.displaySearchResultCount[b]=a.start-1+a.display}catch(d){dalert(d)}},
searchTypeArray:["dic","img","news"],searchCountArray:[10,30,10],getSearchTypeToTabIdx:function(a){try{var b=0,d;for(d in this.searchTypeArray)this.searchTypeArray[d]==a&&(b=d);return b}catch(c){dalert(c)}},getTabIdxToSearchType:function(a){try{return this.searchTypeArray[a]}catch(b){dalert(b)}},setLayerPosition:function(a,b,d){try{var c=g_objPositionUtil.getNodeElementPosition(g_objEditObject[d]),e=b.clientX+c.left;a.style.top=b.clientY+c.top-a.offsetHeight-10+"px";a.style.left=e+"px"}catch(h){dalert(h)}},
webSearchFormContainer:null,webSearchFormObj:null,webSearchButtonObj:null,getSearchWordFormContainer:function(){try{this.webSearchFormContainer=document.createElement("div");this.webSearchFormContainer.className="dze_web_search_form_container";var a="<table border='0' cellpadding='0' cellspacing='0' align='center' style='margin:auto'>";a+="<tr>";a+="<td width='3'></td>";a+="<td></td>";a+="<td></td>";a+="<td width='86' align='right'></td>";this.webSearchFormContainer.innerHTML=a+"</tr></table>";this.webSearchFormObj=
document.createElement("input");this.webSearchFormObj.type="text";this.webSearchFormObj.id="";this.webSearchFormObj.name="";this.webSearchFormObj.className="dze_web_search_form";this.webSearchFormObj.placeholder=ID_RES_CONST_STRING_INPUT_SEARCH_KEYWORD;""!=dzeWebSearch.searchText&&(this.webSearchFormObj.value=dzeWebSearch.searchText);this.webSearchFormObj.onfocus=function(a){this.select()};this.webSearchFormObj.onkeydown=function(a){(a?a:window.event).keyCode==ID_KEYCODE_ENTER&&dzeWebSearch.executeSearchButton()};
this.webSearchButtonObj=document.createElement("input");this.webSearchButtonObj.type="button";this.webSearchButtonObj.id="";this.webSearchButtonObj.name="";this.webSearchButtonObj.value=ID_RES_CONST_STRING_EDIT_SEARCH;this.webSearchButtonObj.onclick=function(){dzeWebSearch.executeSearchButton()};var b=this.webSearchFormContainer.getElementsByTagName("td");b[1].appendChild(this.webSearchFormObj);b[3].appendChild(this.webSearchButtonObj);return this.webSearchFormContainer}catch(d){dalert(d)}},executeSearchButton:function(){try{dzeWebSearch.webSearchFormObj.value=
dzeWebSearch.webSearchFormObj.value.trim();var a=dzeWebSearch.webSearchFormObj.value;1>a.length?(alert(ID_RES_CONST_STRING_INPUT_SEARCH_KEYWORD),dzeWebSearch.webSearchFormObj.select()):dzeWebSearch.searchText==a?dzeWebSearch.webSearchFormObj.select():(dzeWebSearch.initialize(),dzeWebSearch.searchText=a,duzon_dialog.viewTabContents(duzon_dialog.currTabIdx))}catch(b){dalert(b)}},initialize:function(){try{var a=g_objLayerKit.getElementById(dzeWebSearch.dze_idx_dic_search_content);a&&(a.innerHTML="");
var b=g_objLayerKit.getElementById(dzeWebSearch.dze_idx_img_search_content);if(b){b.innerHTML="";var d=b.previousElementSibling;d&&"websearchMsg"==d.id&&b.parentElement.removeChild(d)}var c=g_objLayerKit.getElementById(dzeWebSearch.dze_idx_news_search_content);c&&(c.innerHTML="");dzeWebSearch.displaySearchMoreOk=[!0,!0,!0];dzeWebSearch.displaySearchResultCount=[0,0,0]}catch(e){dalert(e)}},convKorean:function(a,b){try{this.nEditNumber=b;var d=getTextInfoFromCurrPosition(b);dzeWebSearch.searchText=
d.value.trim();2>dzeWebSearch.searchText.length||100<dzeWebSearch.searchText.length||dzeWebSearch.searchData("errata",dzeWebSearch.searchText,1,1,function(c){dzeWebSearch.setConvData(c,a,b,d.node)})}catch(c){dalert(c)}},setConvData:function(a,b,d,c){try{""!=a.errata&&dzeWebSearch.searchText!=a.errata&&(null!==c?(c.nodeValue=a.errata,duzon_dialog.setFocusElement(c,d,"end")):insertHTMLCodeAtSelection(a.errata,null,d),g_objUndoRedo.registerUndoRedoStack(0,d))}catch(e){dalert(e)}},getInitContent:function(){return"<table style='margin-top:72px;' align='center' width='300' border='0' cellspacing='0' cellpadding='0'><tr><td class='dze_dialog_get_remote_content_initialize' height='96'><div style='width:auto'></div></td></tr><tr><td align='center'>URL\uc785\ub825 \uc2dc \uc785\ub825\ub41c \uc6f9\ud398\uc774\uc9c0 \ub0b4\uc758<br />\ud45c\ub97c \uc790\ub3d9\uc73c\ub85c \uac00\uc838\uc635\ub2c8\ub2e4.</td></tr></table>"},
getEmptyContent:function(){return"<table style='margin-top:72px;' align='center' width='300' border='0' cellspacing='0' cellpadding='0'><tr><td class='dze_dialog_get_remote_content_nodata' height='96'><div style='width:auto'></div></td></tr><tr><td align='center'>\uc785\ub825\ud55c \uc6f9\ud398\uc774\uc9c0 \ub0b4\uc5d0 \uac00\uc838\uc62c \uc218 \uc788\ub294<br />\ud45c\uac00 \uc5c6\uc2b5\ub2c8\ub2e4.</td></tr></table>"},viewRemoteSiteContentDialog:function(a){try{var b=document.createElement("div");
b.className="duzon_dialog_content_medium";var d=document.createElement("div");d.style.width="auto";d.style.height="auto";var c=document.createElement("div");c.innerHTML="URL \uc785\ub825";c.className="duzon_dialog_label_title";c.style.height="auto";d.appendChild(c);var e=document.createElement("input");e.type="text";e.id="DZE_IDX_REMOTE_ADDR";e.className="duzon_dialog_body_urlform";e.setAttribute("style","width: 324px !important; margin-right: 4px; margin-top: 12px;");e.onkeydown=function(a){a.keyCode==
ID_KEYCODE_ENTER&&document.getElementById("dze_idx_duzon_dialog_btn_get_content").click()};d.appendChild(e);var h=document.createElement("input");h.type="button";h.value="\uac00\uc838\uc624\uae30";h.id="dze_idx_duzon_dialog_btn_get_content";h.className="duzon_dialog_btn_upload";h.onclick=function(){var b=document.getElementById("DZE_IDX_REMOTE_ADDR");dzeWebSearch.getRemoteSiteContent(b.value,a)};d.appendChild(h);var g=document.createElement("div");g.className="duzon_dialog_label_title";g.style.marginTop=
"4px";g.style.height="auto";d.appendChild(g);var f=document.createElement("input");f.type="checkbox";f.id="DZE_IDX_SEARCH_CHARSET";f.value="1";f.onclick=function(){var b=document.getElementById("DZE_IDX_REMOTE_ADDR");dzeWebSearch.getRemoteSiteContent(b.value,a)};g.appendChild(f);var k=document.createElement("label");k.setAttribute("for","DZE_IDX_SEARCH_CHARSET");k.innerHTML="\uae00\uc790\uc14b\ubcc0\uacbd";g.appendChild(k);var l=document.createElement("div");l.className="duzon_dialog_label_separator";
d.appendChild(l);var n=document.createElement("div");n.innerHTML="\ub370\uc774\ud130 \ud14c\uc774\ube14";n.className="duzon_dialog_label_title";n.style.height="auto";n.style.marginBottom="12px";d.appendChild(n);var p=document.createElement("div");p.className="dze_dialog_get_remote_content_box";var m=document.createElement("div");m.style.width="auto";m.style.height="auto";m.id="DZE_IDX_REMOTE_CONTENT";m.innerHTML=this.getInitContent();p.appendChild(m);b.appendChild(d);b.appendChild(p);return b}catch(q){dalert(q)}},
getRemoteSiteContent:function(a,b){try{if(""!=a.trim()){var d="utf-8";1==document.getElementById("DZE_IDX_SEARCH_CHARSET").checked&&(d="euc-kr");duzon_http.ajax({type:"get",url:dzeEnvConfig.strGetWebContentURL,async:!0,dataType:"html",data:{charSet:d,url:a},timeout:3E3,loading_screen:!0,loading_image_url:"",loading_image_size:[],success:function(a){dzeWebSearch.viewRemoteSiteContent(a,b)},error:function(a){}})}}catch(c){dalert(c)}},viewRemoteSiteContent:function(a,b){var d=document.getElementById("DZE_IDX_REMOTE_CONTENT");
a=a.match(/<table.*?>.*?<\/[\s]*table>/gi);if(null==a)d.innerHTML=this.getEmptyContent();else{d.innerHTML="";var c=null,e=null;c="";for(var h=0;h<a.length;h++){e=document.createElement("div");e.style.width="2000px";e.style.height="auto";c=a[h].replace(/<th\b/gi,"<td");c=c.replace(/<[\/]*tbody>/gi,"");c=c.replace(/<[\/]*thead>/gi,"");e.innerHTML=c;c=e.getElementsByTagName("*");for(var g=c.length-1;0<=g;g--){var f=c[g].nodeName.toLowerCase();if("colgroup"==f||"caption"==f)c[g].parentNode.removeChild(c[g]);
else if("table"!=f&&"tr"!=f&&"th"!=f&&"thead"!=f&&"tbody"!=f&&"td"!=f||c[g].removeAttribute("style"),"table"==f&&(c[g].style.borderCollapse="collapse",c[g].setAttribute("cellpadding","1"),c[g].setAttribute("cellspacing","0")),"th"==f||"td"==f)c[g].style.border="1px solid #000000",c[g].innerHTML="<P>"+c[g].innerText+"</p>"}e.style.transform="scale(0.7)";e.style.transformOrigin="0px 0px 0px";c=e.childNodes[0];c.style.cursor="pointer";c.onmouseover=function(){this.style.backgroundColor="#f2f2f2"};c.onmouseout=
function(){this.style.backgroundColor=""};c.onmousedown=function(a){TBCancelBubbleEvent(a)};c.onclick=function(a){TBCancelBubbleEvent(a);a=document.createElement("div");a.innerHTML=this.outerHTML;a=a.childNodes[0];a.style.backgroundColor="";a.style.cursor="";duzon_dialog.closeDialog();g_objNodeUtil.clean(a);g_objInsertUtil.insertTableAtSelection(a,b);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();g_objUndoRedo.registerUndoRedoStack(0,b)};d.appendChild(e)}}},getCurTabContainer:function(){try{switch(duzon_dialog.currTabIdx){case 0:return g_objLayerKit.getElementById(dzeWebSearch.dze_idx_dic_search_content);
case 1:return g_objLayerKit.getElementById(dzeWebSearch.dze_idx_img_search_content);case 2:return g_objLayerKit.getElementById(dzeWebSearch.dze_idx_news_search_content)}}catch(a){dalert(a)}}};
var letterSpacingWin=function(){var d=this;this.objLetterSpacingLayer=null;this.bLetterSpacingDisplay=!1;this.arrLetterSpacing=" 1pt 2pt 4pt 6pt 8pt 10pt".split(" ");letterSpacingWin.prototype.initializeLetterSpacingLayer=function(){try{if(null==this.objLetterSpacingLayer){"undefined"!=typeof dzeUiConfig.arrCustomLetterSpacing&&0<dzeUiConfig.arrCustomLetterSpacing.length&&(this.arrLetterSpacing=dzeUiConfig.arrCustomLetterSpacing);var a='<div id="divLetterSpacingSelWin" style="position:absolute; display:none; z-index:20031">';
a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;">';for(var c=0;c<this.arrLetterSpacing.length;c++)a+='<tr><td style="line-height:normal;padding:0">',a+='<table id="ComboBoxItem_LetterSpacing_Sub_'+c+'" cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',
a=0==c?a+('<td style="line-height:normal;text-align:left;padding-left:8px"><span>'+ID_RES_COMBOBOX_REMOVE_LETTER_SPACING+"</span></td>"):a+('<td style="line-height:normal;text-align:left;padding-left:8px"><span>'+this.arrLetterSpacing[c]+"</span></td>"),a+="</tr></table>",a+="</td></tr>";a+="</table>";a+="</td></tr></table>";a+="</div>";var b=g_objLayerKit.getElementById("divLetterSpacingSelWin");b||(b=g_objInsertUtil.insertLayerHTML(a,!0));b&&(this.objLetterSpacingLayer=b,this.initLetterSpacingSubItem("ComboBoxItem_LetterSpacing"),
g_objNodeUtil.initFalsePropagationEvent(this.objLetterSpacingLayer))}}catch(e){dalert(e)}};letterSpacingWin.prototype.initLetterSpacingSubItem=function(a){try{for(var c=0;c<this.arrLetterSpacing.length;c++){var b=g_objLayerKit.getElementById(a+"_Sub_"+c);b.onmouseout=function(a){d.fnLetterSpacingCellOut(this)};b.onmousedown=TBCancelBubbleEvent;b.onmouseup=TBCancelBubbleEvent;(function(){var a=d.arrLetterSpacing[c];b.onclick=function(){!0===dzeUiConfig.bTBPreviewLetterOperation&&(d.objLetterSpacingLayer.onmouseleave=
function(){});d.fnLetterSpacingCellClick(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()};b.onmouseover=function(b){d.fnLetterSpacingCellOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&d.fnLetterSpacingCellClick(a,!1);dzeUiConfig.bOfficePagingMode&&g_objPageControl.clearUpdatePageTimer()}})()}}catch(e){dalert(e)}return null};letterSpacingWin.prototype.unload=function(){try{var a=g_objLayerKit.getElementById("divLetterSpacingSelWin");a&&a.parentNode&&a.parentNode.removeChild(a);
this.objLetterSpacingLayer=null}catch(c){dalert(c)}};letterSpacingWin.prototype.initLetterSpacingLayerEvent=function(){try{null!=this.objLetterSpacingLayer&&this.bLetterSpacingDisplay&&(this.objLetterSpacingLayer.style.display="none",this.bLetterSpacingDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objLetterSpacingLayer=null)}catch(a){dalert(a)}};letterSpacingWin.prototype.showLetterSpacingLayer=function(a,c,b){try{if(dlog("showLetterSpacingLayer"),this.initializeLetterSpacingLayer(),!fnObjectCheckNull(a)&&
null!=this.objLetterSpacingLayer)if(g_nActiveEditNumber=b,this.bLetterSpacingDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{this.bLetterSpacingDisplay=!0;g_objLayerEventUtil.showLayerWin(this.objLetterSpacingLayer,a,c,dzeUiConfig.bTBPreviewLetterOperation);var e=g_objPropertyUtil.getSelectionAttributeValue(b);if("undefined"!=typeof e&&null!=e){var f=e[4];if("undefined"==typeof f||null==f)f="";var d=updateHandlerUI.getMappingIndex_LetterSpacing(f);for(a=0;a<g_objLetterSpacingWin.arrLetterSpacing.length;a++)a==
d?g_objLayerKit.getElementById("ComboBoxItem_LetterSpacing_Sub_"+a).className=g_strSkin_ComboBoxItem_Down:g_objLayerKit.getElementById("ComboBoxItem_LetterSpacing_Sub_"+a).className=g_strSkin_ComboBoxItem_Out;!0===dzeUiConfig.bTBPreviewLetterOperation&&(g_objLayerEventUtil.canSaveTableSelectedCellHTML(b)?g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(b)):g_objUndoRedo.registerUndoRedoStack(0,b),this.objLetterSpacingLayer.onmouseleave=function(){g_objLayerEventUtil.canSaveTableSelectedCellHTML(b)?
g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(b)):(g_objUndoRedo.registerUndoRedoStack(0,b),g_objUndoRedo.operateUndoRedoStack(!0,!0,b))})}}}catch(h){dalert(h)}};letterSpacingWin.prototype.fnLetterSpacingCellOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(c){dalert(c)}};letterSpacingWin.prototype.fnLetterSpacingCellOut=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(c){dalert(c)}};
letterSpacingWin.prototype.fnLetterSpacingCellClick=function(a,c,b){try{var e=!0,f=!1,d=g_nActiveEditNumber;"undefined"!=typeof c&&(e=c);if(window.attachEvent){var h=g_objEditorDocument[d].selection;if(fnObjectCheckNull(h))return;var g=h.type;g=g.toLowerCase();if(ID_STRING_NAME_NONE==g||ID_STRING_NAME_TEXT==g){var l=h.createRange();if(fnObjectCheckNull(l))return;f=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_LETTER_SPACE,a)}}else if(g=getSelectionTypeForUpdateUI(),ID_STRING_NAME_NONE==
g||ID_STRING_NAME_TEXT==g)f=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_LETTER_SPACE,a,0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer());this.update_toolbar_combobox_timer&&(clearTimeout(this.update_toolbar_combobox_timer),this.update_toolbar_combobox_timer=null);this.update_toolbar_combobox_timer=setTimeout(function(){try{updateHandlerUI.update_toolbar_combobox("",d)}catch(k){}},10);0!=e&&g_objLayerEventUtil.initHideDynamicLayer();0!=e&&!0===
f&&(!1===fnObjectCheckNull(b)&&"function"===typeof b?b(f):(g_objUndoRedo.registerUndoRedoStack(0,d),editor_onselectionchange(d)))}catch(k){dalert(k)}}},g_objLetterSpacingWin=new letterSpacingWin;
var lineHeightWin=function(){var d=this;this.objLineHeightLayer=null;this.bLineHeightDisplay=!1;this.arrLineHeight=" 1 1.2 1.5 1.8 2 2.5 3".split(" ");lineHeightWin.prototype.initializeLineHeightLayer=function(){try{if(null==this.objLineHeightLayer){"undefined"!=typeof dzeUiConfig.arrCustomLineHeight&&0<dzeUiConfig.arrCustomLineHeight.length&&(this.arrLineHeight=dzeUiConfig.arrCustomLineHeight);var a='<div id="divLineHeightSelWin" style="position:absolute; display:none; z-index:20031">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+
g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;">';for(var b=0;b<this.arrLineHeight.length;b++)a+='<tr><td style="line-height:normal;padding:0;">',a+='<table id="ComboBoxItem_LineHeight_Sub_'+b+'" cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;" class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',a=0==b?a+('<td style="line-height:normal;text-align:left;cursor:default;padding-left:8px"><span>'+
ID_RES_COMBOBOX_REMOVE_LINE_HEIGHT+"</span></td>"):a+('<td style="line-height:normal;text-align:left;cursor:default;padding-left:8px"><span>'+100*parseFloat(this.arrLineHeight[b],10)+" %</span></td>"),a+="</tr></table>",a+="</td></tr>";a+="</table>";a+="</td></tr></table>";a+="</div>";var c=g_objLayerKit.getElementById("divLineHeightSelWin");c||(c=g_objInsertUtil.insertLayerHTML(a,!0));c&&(this.objLineHeightLayer=c,this.initLineHeightSubItem("ComboBoxItem_LineHeight"),g_objNodeUtil.initFalsePropagationEvent(this.objLineHeightLayer))}}catch(e){dalert(e)}};
lineHeightWin.prototype.initLineHeightSubItem=function(a){try{for(var b=0;b<this.arrLineHeight.length;b++){var c=g_objLayerKit.getElementById(a+"_Sub_"+b);c.onmouseout=function(a){d.fnLineHeightCellOut(this)};c.onmousedown=TBCancelBubbleEvent;c.onmouseup=TBCancelBubbleEvent;(function(){var a=d.arrLineHeight[b];c.onclick=function(){!0===dzeUiConfig.bTBPreviewLetterOperation&&(d.objLineHeightLayer.onmouseleave=function(){});d.fnLineHeightCellClick(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()};
c.onmouseover=function(b){d.fnLineHeightCellOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&d.fnLineHeightCellClick(a,!1);dzeUiConfig.bOfficePagingMode&&g_objPageControl.clearUpdatePageTimer()}})()}}catch(e){dalert(e)}return null};lineHeightWin.prototype.unload=function(){try{var a=g_objLayerKit.getElementById("divLineHeightSelWin");a&&a.parentNode&&a.parentNode.removeChild(a);this.objLineHeightLayer=null}catch(b){dalert(b)}};lineHeightWin.prototype.initLineHeightLayerEvent=function(){try{null!=
this.objLineHeightLayer&&this.bLineHeightDisplay&&(this.objLineHeightLayer.style.display="none",this.bLineHeightDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objLineHeightLayer=null)}catch(a){dalert(a)}};lineHeightWin.prototype.showLineHeightLayer=function(a,b,c){try{if(this.initializeLineHeightLayer(),!fnObjectCheckNull(a)&&null!=this.objLineHeightLayer)if(g_nActiveEditNumber=c,this.bLineHeightDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{this.bLineHeightDisplay=!0;g_objLayerEventUtil.showLayerWin(this.objLineHeightLayer,
a,b,dzeUiConfig.bTBPreviewLetterOperation);var e=g_objPropertyUtil.getSelectionAttributeValue(c);if("undefined"!=typeof e&&null!=e){var d=e[5];if("undefined"==typeof d||null==d)d="";var g=updateHandlerUI.getMappingIndex_LineHeight(d);for(a=0;a<g_objLineHeightWin.arrLineHeight.length;a++)a==g?g_objLayerKit.getElementById("ComboBoxItem_LineHeight_Sub_"+a).className=g_strSkin_ComboBoxItem_Down:g_objLayerKit.getElementById("ComboBoxItem_LineHeight_Sub_"+a).className=g_strSkin_ComboBoxItem_Out;!0===dzeUiConfig.bTBPreviewLetterOperation&&
(g_objLayerEventUtil.canSaveTableSelectedCellHTML(c)?g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(c)):g_objUndoRedo.registerUndoRedoStack(0,c),this.objLineHeightLayer.onmouseleave=function(){g_objLayerEventUtil.canSaveTableSelectedCellHTML(c)?g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(c)):(g_objUndoRedo.registerUndoRedoStack(0,c),g_objUndoRedo.operateUndoRedoStack(!0,!0,c))})}}}catch(h){dalert(h)}};lineHeightWin.prototype.fnLineHeightCellOver=function(a){try{a.className!=
g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(b){dalert(b)}};lineHeightWin.prototype.fnLineHeightCellOut=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(b){dalert(b)}};lineHeightWin.prototype.fnLineHeightCellClick=function(a,b,c){try{var d=!0;"undefined"!=typeof b&&(d=b);b=g_nActiveEditNumber;g_objLetterFn.setParaStyle(b,{lineHeight:a});0!=d&&g_objLayerEventUtil.initHideDynamicLayer();0!=d&&(!1===fnObjectCheckNull(c)&&
"function"===typeof c?c(!0):(g_objUndoRedo.registerUndoRedoStack(0,b),editor_onselectionchange(b)))}catch(f){dalert(f)}finally{objRange=null}}},g_objLineHeightWin=new lineHeightWin;
var ID_TABLE_INSERT_CELL_WIDTH=100,ID_TABLE_INSERT_CELL_HEIGHT=25,g_objTableSizeBoxWin=new function(){var k=this;this.nTBLimitSizeBox_Col=this.nTBLimitSizeBox_Row=this.nTBMinSizeBox_Col=this.nTBMinSizeBox_Row=15;this.nTBSizeCell_Height=this.nTBSizeCell_Width=18;this.nTBChangePos_Y=this.nTBChangePos_X=this.nTBLimitPos_Y=this.nTBLimitPos_X=this.nTBMinPos_Y=this.nTBMinPos_X=this.nTBMenuPos_Y=this.nTBMenuPos_X=0;this.objTBSizeBox={};this.objTBSizeBox.objBackWin=null;this.objTBSizeBox.objBG=null;this.objTBSizeBox.objWindow=
null;this.objTBSizeBox.objStatus=null;this.bTBSizeBoxCancel=this.bTBSizeBoxDisplay=!1;this.nTBStatusSpan_Col=this.nTBStatusSpan_Row=-1;this.initializeTableSizeBoxLayer=function(){try{if(null==this.objTBSizeBox.objBackWin){var e=this.drawTableSize(this.nTBLimitSizeBox_Row,this.nTBLimitSizeBox_Col,this.nTBMinSizeBox_Row,this.nTBMinSizeBox_Col),b=g_objLayerKit.getElementById("TB_Size_Box");b||(b=g_objInsertUtil.insertLayerHTML(e,!0));if(b){var a=this.objTBSizeBox;a.objParent=b;a.objBackWin=b.querySelector("#TB_Size_Box_Back_Win");
a.objBG=b.querySelector("#TB_Size_Box_BG");a.objWindow=b.querySelector("#TB_Size_Box_Window");a.objStatus=b.querySelector("#TB_Size_Box_Status");a.objStatus.objStatusText=g_objLayerKit.getElementById("TB_Size_Box_Status_Text");a.objBackWin.style.display="none";a.objBG.style.display="none";a.objWindow.style.display="none";a.objStatus.style.display="none";this.initTableSizeBoxSubItem();g_objNodeUtil.initFalsePropagationEvent(a.objBackWin);g_objNodeUtil.initFalsePropagationEvent(a.objBG);g_objNodeUtil.initFalsePropagationEvent(a.objWindow);
g_objNodeUtil.initFalsePropagationEvent(a.objStatus)}}}catch(c){dalert(c)}};this.unload=function(){try{if(this.objTBSizeBox){var e=this.objTBSizeBox.objParent;e&&e.parentNode&&e.parentNode.removeChild(e)}this.objTBSizeBox={}}catch(b){dalert(b)}};this.drawTableSize=function(e,b,a,c){try{var d="<div id='TB_Size_Box'>";d+="<div id='TB_Size_Box_Back_Win' class='"+g_strSkin_SizeBoxBackWin+"'>";d+="<div id='TB_Size_Box_BG' class='"+g_strSkin_SizeBoxBG+"'></div>";d+="</div>";d+="<div id='TB_Size_Box_Window' class='tbSizeBoxWindow'>";
d+="<table cellSpacing='0' cellPadding='0' border='0' style='width:270px;'>";for(var f=0;f<e;f++){d+="<tr>";d+="<td style='text-align:left;'>";d+="<table cellSpacing='0' cellPadding='0' border='0' style='width:270px;height:18px;table-layout:auto;'>";d+="<tr>";for(var h=0;h<b;h++)d=f<a&&h<c?g_bDocType_XHTML?d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0' style='border-collapse:separate;'><tr><td></td></tr></table></td>"):d+("<td><table id='tbSizeBoxCell_"+
f+"_"+h+"' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0' style='border-collapse:separate;'><tr><td><img alt='' width='1' height='1' border='0' style='vertical-align:baseline;border:none;'></td></tr></table></td>"):g_bDocType_XHTML?d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' style='display:none;border-collapse:separate;' class='"+g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0'><tr><td></td></tr></table></td>"):d+("<td><table id='tbSizeBoxCell_"+f+"_"+h+"' style='display:none;border-collapse:separate;' class='"+
g_strSkin_SizeBoxCell+"' cellSpacing='0' border='0'><tr><td><img alt='' width='1' height='1' border='0' style='vertical-align:baseline;border:none;'></td></tr></table></td>");d+="</tr>";d+="</table>";d+="</td>";d+="</tr>"}d+="</table>";d+="</div>";d+="<div id='TB_Size_Box_Status' class='"+g_strSkin_SizeBoxStatus+"'>";d+="<table cellSpacing='0' cellPadding='0' style='margin-top:3' align='center' border='0'>";d+="<tr>";d+="<td align='center' class='"+g_strSkin_SizeBoxStatusText+"' style='line-height:normal;'><span id='TB_Size_Box_Status_Text'>";
d+="<span style='display:none'>"+ID_RES_TABLE_SIZE_SELECT+"</span>";for(f=0;f<e;f++)d+="<span style='display:none'>"+(f+1)+"</span>";d+="<span style='display:none'> X </span>";for(h=0;h<b;h++)d+="<span style='display:none'>"+(h+1)+"</span>";d+="<span style='display:none'>"+ID_RES_TABLE_SIZE_CANCEL+"</span>";d+="</span></td>";d+="</tr>";d+="</table>";return d+"</div></div>"}catch(g){}};this.initTableSizeBoxSubItem=function(){try{for(var e=0;e<this.nTBLimitSizeBox_Row;e++)for(var b=0;b<this.nTBLimitSizeBox_Col;b++){var a=
g_objLayerKit.getElementById("tbSizeBoxCell_"+e+"_"+b);(function(){var c=e,d=b;a.onmouseover=function(){k.changeBGSizeBox(c,d)}})();a.onmousedown=TBCancelBubbleEvent;a.onmouseup=TBCancelBubbleEvent;(function(){var c=e,d=b;a.onclick=function(){k.createNewTable(c,d)}})()}}catch(c){}};this.changeBGSizeBox=function(e,b){try{g_objTableSizeBoxWin.objTBSizeBox.objBG.style.width=(b+1)*g_objTableSizeBoxWin.nTBSizeCell_Width+"px",g_objTableSizeBoxWin.objTBSizeBox.objBG.style.height=(e+1)*g_objTableSizeBoxWin.nTBSizeCell_Height+
"px",g_objTableSizeBoxWin.setTableSizeBoxStatus(e+1,b+1,!1)}catch(a){}};this.resizeTableSizeBox=function(e){try{var b=g_objPositionUtil.GetDocumentClientPos_XY(e),a=b.nPos_X,c=b.nPos_Y,d=g_objPositionUtil.getFrameClientRect();a+=d.left;c+=d.top;var f=k.objTBSizeBox.objBackWin,h=f.offsetWidth,g=f.offsetHeight;null!=f&&g_objTableSizeBoxWin.bTBSizeBoxDisplay?f.offsetLeft<a&&f.offsetTop<c&&a<f.offsetLeft+h&&c<f.offsetTop+g?(k.bTBSizeBoxCancel=!1,k.nTBMinPos_X-k.nTBSizeCell_Width<a&&a<k.nTBLimitPos_X&&
k.changeTBSizeBox_X(a),k.nTBMinPos_Y-k.nTBSizeCell_Height<c&&c<k.nTBLimitPos_Y&&k.changeTBSizeBox_Y(c)):k.bTBSizeBoxCancel||(k.setTableSizeBoxStatus(-1,-1,!0),k.bTBSizeBoxCancel=!0):k.bTBSizeBoxCancel||(k.setTableSizeBoxStatus(-1,-1,!0),k.bTBSizeBoxCancel=!0)}catch(l){dalert(l)}};this.setTableSizeBoxStatus=function(e,b,a){try{var c=g_objNodeUtil.getChildrenCollection(this.objTBSizeBox.objStatus.objStatusText);-1!=this.nTBStatusSpan_Row&&(c[this.nTBStatusSpan_Row].style.display="none");-1!=this.nTBStatusSpan_Col&&
(c[this.nTBLimitSizeBox_Row+this.nTBStatusSpan_Col+1].style.display="none");this.nTBStatusSpan_Row=e;this.nTBStatusSpan_Col=b;-1==e&&-1==b?(a?(c[0].style.display="none",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.lineHeight="normal"):(c[0].style.display="",c[0].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="none"),c[this.nTBLimitSizeBox_Row+1].style.display="none"):
(c[0].style.display="none",c[e].style.display="",c[e].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+1].style.display="",c[this.nTBLimitSizeBox_Row+1].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+b+1].style.display="",c[this.nTBLimitSizeBox_Row+b+1].style.lineHeight="normal",c[this.nTBLimitSizeBox_Row+this.nTBLimitSizeBox_Col+2].style.display="none")}catch(d){dalert(d)}};this.changeTBSizeBox_X=function(e){try{if(e<this.nTBChangePos_X){if(e<this.nTBChangePos_X-this.nTBSizeCell_Width){var b=
(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width;this.nTBChangePos_X=this.nTBMenuPos_X+(b-1)*this.nTBSizeCell_Width+6;this.objTBSizeBox.objBackWin.style.width=(b-1)*this.nTBSizeCell_Width+10+"px";this.objTBSizeBox.objBG.style.width=(b-1)*this.nTBSizeCell_Width+"px";this.objTBSizeBox.objStatus.style.width=(b-1)*this.nTBSizeCell_Width+10+"px";for(var a=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+c+"_"+(b-1)).style.display=
"none"}}else if(e>this.nTBChangePos_X)for(b=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,this.nTBChangePos_X=this.nTBMenuPos_X+(b+1)*this.nTBSizeCell_Width+6,this.objTBSizeBox.objBackWin.style.width=(b+1)*this.nTBSizeCell_Width+10+"px",this.objTBSizeBox.objBG.style.width=(b+1)*this.nTBSizeCell_Width+"px",this.objTBSizeBox.objStatus.style.width=(b+1)*this.nTBSizeCell_Width+10+"px",a=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+
c+"_"+b).style.display=""}catch(d){dalert(d)}};this.changeTBSizeBox_Y=function(e){try{if(e<this.nTBChangePos_Y){if(e<this.nTBChangePos_Y-this.nTBSizeCell_Height){var b=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height;this.nTBChangePos_Y=this.nTBMenuPos_Y+(b-1)*this.nTBSizeCell_Height+6;this.objTBSizeBox.objBackWin.style.height=(b-1)*this.nTBSizeCell_Height+10+"px";this.objTBSizeBox.objBG.style.height=(b-1)*this.nTBSizeCell_Height+"px";this.objTBSizeBox.objStatus.style.top=this.nTBMenuPos_Y+
(b-1)*this.nTBSizeCell_Height+6+4+"px";for(var a=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+(b-1)+"_"+c).style.display="none"}}else if(e>this.nTBChangePos_Y)for(b=(this.nTBChangePos_Y-this.nTBMenuPos_Y-6)/this.nTBSizeCell_Height,this.nTBChangePos_Y=this.nTBMenuPos_Y+(b+1)*this.nTBSizeCell_Height+6,this.objTBSizeBox.objBackWin.style.height=(b+1)*this.nTBSizeCell_Height+10+"px",this.objTBSizeBox.objBG.style.height=(b+1)*this.nTBSizeCell_Height+
"px",this.objTBSizeBox.objStatus.style.top=this.nTBMenuPos_Y+(b+1)*this.nTBSizeCell_Height+6+4+"px",a=(this.nTBChangePos_X-this.nTBMenuPos_X-6)/this.nTBSizeCell_Width,c=0;c<a;c++)document.getElementById("tbSizeBoxCell_"+b+"_"+c).style.display=""}catch(d){dalert(d)}};this.initTableSizeLayerEvent=function(){try{if(null!=this.objTBSizeBox&&null!=this.objTBSizeBox.objBackWin){var e=this.objTBSizeBox;this.bTBSizeBoxDisplay&&(e.objBackWin.style.display="none",e.objBG.style.display="none",e.objWindow.style.display=
"none",e.objStatus.style.display="none",this.bTBSizeBoxDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objTBSizeBox.objBackWin=null,this.objTBSizeBox.objBG=null,this.objTBSizeBox.objWindow=null,this.objTBSizeBox.objStatus=null)}}catch(b){dalert(b)}};this.showTableSizeBoxLayer=function(e,b){try{if(this.initializeTableSizeBoxLayer(),!fnObjectCheckNull(e)&&null!=this.objTBSizeBox.objBackWin){g_nActiveEditNumber=b;for(b=0;b<this.nTBLimitSizeBox_Row;b++)for(var a=0;a<this.nTBLimitSizeBox_Col;a++)b<
this.nTBMinSizeBox_Row&&a<this.nTBMinSizeBox_Col||(g_objLayerKit.getElementById("tbSizeBoxCell_"+b+"_"+a).style.display="none");this.setTableSizeBoxStatus(-1,-1,!1);var c=g_objPositionUtil.getOuterRect(e),d=g_objPositionUtil.getFrameClientRect(),f=d.left+c.left,h=d.top+c.top+c.height;g_bBrowserType_FF?(f=f-g_nFireFoxLayerSetting_X+1,h=h-g_nFireFoxLayerSetting_Y+1):g_bBrowserType_WK?(f+=2,h+=2):g_bBrowserType_OP?(f+=1,h+=1):g_bBrowserType_IE&&g_bDocType_XHTML&&8<=g_bBrowserVerInfo&&(f+=2,h+=2);if(this.bTBSizeBoxDisplay)g_objLayerEventUtil.initHideDynamicLayer();
else{this.nTBMenuPos_X=f-2+g_nIframeBorderSetting;this.nTBMenuPos_Y=h-3+g_nIframeBorderSetting;var g=this.objTBSizeBox;g.objBackWin.style.left=this.nTBMenuPos_X+"px";g.objBackWin.style.top=this.nTBMenuPos_Y+"px";g.objBackWin.style.width=this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+10+"px";g.objBackWin.style.height=this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+10+"px";g.objBackWin.style.display="";g.objWindow.style.left=this.nTBMenuPos_X+6+"px";g.objWindow.style.top=this.nTBMenuPos_Y+6+"px";g.objWindow.style.display=
"";g.objBG.style.width=0;g.objBG.style.height=0;g.objBG.style.display="";g.objStatus.style.left=this.nTBMenuPos_X+"px";g.objStatus.style.top=this.nTBMenuPos_Y+this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+6+4+"px";g.objStatus.style.width=this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+10+"px";g.objStatus.style.display="";this.nTBMinPos_X=this.nTBMenuPos_X+this.nTBMinSizeBox_Row*this.nTBSizeCell_Width+6;this.nTBMinPos_Y=this.nTBMenuPos_Y+this.nTBMinSizeBox_Col*this.nTBSizeCell_Height+6;this.nTBLimitPos_X=
this.nTBMenuPos_X+this.nTBLimitSizeBox_Col*this.nTBSizeCell_Width+6;this.nTBLimitPos_Y=this.nTBMenuPos_Y+this.nTBLimitSizeBox_Row*this.nTBSizeCell_Height+6;this.nTBChangePos_X=this.nTBMenuPos_X+this.nTBMinSizeBox_Col*this.nTBSizeCell_Width+6;this.nTBChangePos_Y=this.nTBMenuPos_Y+this.nTBMinSizeBox_Row*this.nTBSizeCell_Height+6;this.bTBSizeBoxDisplay=!0;g_objLayerEventUtil.objCurrentLayer=g.objBackWin;duzon_dialog.animateDlg(g.objBackWin,"down");duzon_dialog.animateDlg(g.objWindow,"down");duzon_dialog.animateDlg(g.objBG,
"down");duzon_dialog.animateDlg(g.objStatus,"down");g_objLayerEventUtil.addLayerEvent()}}}catch(l){dalert(l)}};this.createNewTable=function(e,b){try{var a=[];a[0]=e+1;a[1]=b+1;a[2]=100;a[3]="%";a[4]=null;a[5]=null;a[6]=1;a[7]="1px solid #000000";a[8]="1px solid #000000";a[9]="1px solid #000000";a[10]="1px solid #000000";a[11]="1px solid #000000";a[12]="1px solid #000000";a[13]=null;a[14]=null;a[15]=null;a[16]="";a[17]=null;a[18]=null;a[19]=null;a[20]=null;a[21]=null;a[22]=0;a[23]=!0;e=g_nActiveEditNumber;
var c=g_objTableFunction.createTable(a,e);c&&(g_objCaretUtil.moveCaret(c),commonUpdateAfterChange(e,c));g_objLayerEventUtil.initHideDynamicLayer()}catch(d){dalert(d)}}};
var g_objMenuWin=new function(){this.arrTBMenu=[];this.ID_MENU_ITEM_SEGMENT=6;this.bMenuLayerShow=this.bMenuDisplayToggle=!1;this.arrMenuMember=[];this.twoDepthMenu=[];this.twoDepthMenu[ID_COMMAND_INSERT_OBJECT]=[ID_COMMAND_INSERT_OBJECT_MOVIE,ID_COMMAND_INSERT_OBJECT_HR];this.twoDepthMenu[ID_COMMAND_INSERT_PARAGRAPH]=[ID_COMMAND_INSERT_PARAGRAPH_STARTPOINT,ID_COMMAND_INSERT_PARAGRAPH_ENDPOINT];this.twoDepthMenu[ID_COMMAND_STYLE_STYLE]=[ID_COMMAND_STYLE_STYLE_BASIC,ID_COMMAND_STYLE_STYLE_SUBJECT1,
ID_COMMAND_STYLE_STYLE_SUBJECT2,ID_COMMAND_STYLE_STYLE_SUBJECT3,ID_COMMAND_STYLE_STYLE_SUBJECT4,ID_COMMAND_STYLE_STYLE_SUBJECT5];this.twoDepthMenu[ID_COMMAND_SHAPES_MOVE_FRONT]=[ID_COMMAND_BRING_FORWARD,ID_COMMAND_BRING_TO_FRONT];this.twoDepthMenu[ID_COMMAND_SHAPES_MOVE_BACK]=[ID_COMMAND_SEND_BACKWARD,ID_COMMAND_SEND_TO_BACK];this.twoDepthMenu[ID_COMMAND_SHAPES_LAYOUT]=[ID_COMMAND_TXTLAYOUT_IN_LINE_WITH_TEXT,ID_COMMAND_TXTLAYOUT_BEHIND_TEXT,ID_COMMAND_TXTLAYOUT_IN_FRONT_OF_TEXT,ID_COMMAND_TXTLAYOUT_LEFT_TEXT,
ID_COMMAND_TXTLAYOUT_RIGHT_TEXT];this.twoDepthMenu[ID_COMMAND_TABLE_CELL_ALIGN]=[ID_COMMAND_TABLE_CELL_ALIGN_LEFT_TOP,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_TOP,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_TOP,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_MIDDLE,ID_COMMAND_TABLE_CELL_ALIGN_LEFT_BOTTOM,ID_COMMAND_TABLE_CELL_ALIGN_CENTER_BOTTOM,ID_COMMAND_TABLE_CELL_ALIGN_RIGHT_BOTTOM];this.twoDepthMenu[ID_COMMAND_TABLE_FORMULA]=[ID_COMMAND_TABLE_HORIZONTAL_SUM,
ID_COMMAND_TABLE_VERTICAL_SUM,ID_COMMAND_TABLE_HORIZONTAL_AVERAGE,ID_COMMAND_TABLE_VERTICAL_AVERAGE,ID_COMMAND_TABLE_HORIZONTAL_MULTIPLY,ID_COMMAND_TABLE_VERTICAL_MULTIPLY];this.twoDepthMenu[ID_COMMAND_PASTE_CELL]=[ID_COMMAND_PASTE_CELL_OVER_CONTENT,ID_COMMAND_PASTE_CELL_OVER_ALL,ID_COMMAND_PASTE_CELL_INSERT,ID_COMMAND_PASTE_CELL_INSERT_AS_TABLE];this.twoDepthMenu[ID_COMMAND_TABLE_CELL_INSERT]=[ID_COMMAND_TABLE_ADD_COL,ID_COMMAND_TABLE_ADD_COL_RIGHT,ID_COMMAND_TABLE_ADD_ROW,ID_COMMAND_TABLE_ADD_ROW_DOWN];
this.twoDepthMenu[ID_COMMAND_TABLE_CELL_DELETE]=[ID_COMMAND_TABLE_DELETE_COL,ID_COMMAND_TABLE_DELETE_ROW,ID_COMMAND_TABLE_DELETE_TABLE];this.twoDepthMenu[ID_COMMAND_IMAGE_BORDER_THICKNESS]=[ID_COMMAND_IMAGE_BORDER_NONE,ID_COMMAND_IMAGE_BORDER_1PX,ID_COMMAND_IMAGE_BORDER_2PX,ID_COMMAND_IMAGE_BORDER_3PX,ID_COMMAND_IMAGE_BORDER_4PX,ID_COMMAND_IMAGE_BORDER_5PX,ID_COMMAND_IMAGE_BORDER_6PX,ID_COMMAND_IMAGE_BORDER_7PX,ID_COMMAND_IMAGE_BORDER_8PX,ID_COMMAND_IMAGE_BORDER_9PX,ID_COMMAND_IMAGE_BORDER_10PX];
this.twoDepthMenu[ID_COMMAND_IMAGE_BORDER_TYPE]=[ID_COMMAND_IMAGE_BORDER_SOLID,ID_COMMAND_IMAGE_BORDER_DASHED,ID_COMMAND_IMAGE_BORDER_DOTTED,ID_COMMAND_IMAGE_BORDER_DOUBLE];this.twoDepthMenu[ID_COMMAND_LINE_ARROW]=[ID_COMMAND_LINE_ARROW_NONE,ID_COMMAND_LINE_ARROW1,ID_COMMAND_LINE_ARROW2,ID_COMMAND_LINE_ARROW3,ID_COMMAND_LINE_ARROW4,ID_COMMAND_LINE_ARROW5,ID_COMMAND_LINE_ARROW6,ID_COMMAND_LINE_ARROW7,ID_COMMAND_LINE_ARROW8,ID_COMMAND_LINE_ARROW9,ID_COMMAND_LINE_ARROW10];this.twoDepthMenu[ID_COMMAND_INSERT_EMPTY_PAGE]=
[ID_COMMAND_INSERT_NEW_PAGE_ABOVE,ID_COMMAND_INSERT_NEW_PAGE_BELOW];this.twoDepthMenu[ID_COMMAND_PASTE_PAGE]=[ID_COMMAND_PASTE_PAGE_ABOVE,ID_COMMAND_PASTE_PAGE_BELOW];this.twoDepthMenu[ID_COMMAND_STYLE_TEMPLATE]=[{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_DEFAULT,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_EMPHASIS1,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_EMPHASIS2,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_EMPHASIS3,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,
text:ID_RES_STRING_BOX1,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_BOX2,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_BOX3,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_QUOTATION,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_FIRST_LETTER_BIG,img:""},-1,{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_REMOVE_FORMAT,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_SUBTITLE1,img:""},{cmd:ID_COMMAND_STYLE_TEMPLATE,text:ID_RES_STRING_SUBTITLE2,
img:""}];this.arrMenuLayer=[];this.objSubMenuItem=[];this.openMenuList=[ID_COMMAND_FILE_OPEN,ID_COMMAND_FILE_DOCFORM,ID_COMMAND_FILE_LAYOUT,ID_COMMAND_SAVEAS,ID_COMMAND_PRINT,ID_COMMAND_EDIT_PASTESPECIAL,ID_COMMAND_EDIT_SEARCH,ID_COMMAND_EDIT_REPLACE,ID_COMMAND_EDIT_REPLACE_CASE,ID_COMMAND_INSERT_IMAGE,ID_COMMAND_SHAPES_INSERT,ID_COMMAND_INSERT_OBJECT_MOVIE,ID_COMMAND_INSERT_OBJECT_FILE,ID_COMMAND_INSERT_SPECIALCHARS,ID_COMMAND_INSERT_BOOKMARK,ID_COMMAND_HYPERLINK_INSERT,ID_COMMAND_STYLE_FONT,ID_COMMAND_STYLE_PARAGRAPH,
ID_COMMAND_STYLE_UNORDEREDLIST,ID_COMMAND_STYLE_ORDEREDLIST,ID_COMMAND_TABLE_CREATE,ID_COMMAND_TABLE_PROPERTY,ID_COMMAND_TABLE_CELL_PROPERTY,ID_COMMAND_TABLE_CELL_STYLE,ID_COMMAND_TABLE_ADD_ROW_COL,ID_COMMAND_TABLE_SPLIT_CELL,ID_COMMAND_TABLE_CELL_HORIZONTALALIGN,ID_COMMAND_TABLE_CELL_VERTICALALIGN,ID_COMMAND_TABLE_SELECT_FORMULA];this.initializeMenuLayer=function(){try{dlog("initializeMenuLayer");if(dzeEnvConfig.iFrameLayer){var a=parseInt(window.frameElement.getAttribute("dzeditor_no"),10);dlog("dzeditor_frame_no:"+
a)}this.arrMenuMember=g_arrMenuBar?g_arrMenuBar.slice():[];for(var b=0;b<this.arrMenuMember.length;b++){var c=g_objLayerKit.getElementById("divMenuSelect_"+b);if(!c){var d=null;dzeEnvConfig.iFrameLayer?(a=parseInt(window.frameElement.getAttribute("dzeditor_no"),10),isNaN(a)&&(a=0),d=this.arrTBMenu[a][b].element):d=this.arrTBMenu[0][b].element;if(null==d)break;d="";d+="<div id='divMenuSelect_"+b+"' class='MenuContainer' style='text-align:left;'>";d+="<div class='duzon_menubar_select_container'>";d+=
this.buildMenuContent(b);d+="</div>";d+="</div>";c=g_objInsertUtil.insertLayerHTML(d,!0);if(!c)break}this.arrMenuLayer[b]=c;c.style.display="none";this.objSubMenuItem[b]=[];this.setupMenuEvent(c,b)}}catch(e){dalert(e)}};this.unload=function(){try{for(var a=0,b=this.arrMenuLayer.length;a<b;a++){var c=this.arrMenuLayer[a];c&&c.parentNode&&c.parentNode.removeChild(c)}this.arrMenuLayer=[];this.objSubMenuItem=[]}catch(d){dalert(d)}};this.buildMenuContent=function(a){try{var b="";b+='<table class="MenuContent" cellpadding="0" cellspacing="0" style="border-collapse:separate;">';
b+=this.buildMenuItem_Margin();for(var c=0,d=0;d<this.arrMenuMember[a].length;d++)if(-1==this.arrMenuMember[a][d])b+=this.buildMenuItem_Garbage(),b+=this.buildMenuItem_Separator(),b+=this.buildMenuItem_Garbage();else if(this.arrMenuMember[a][d]!=ID_COMMAND_LOCK_EDIT_CELL||!1!==dzeUiConfig.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode)if(this.arrMenuMember[a][d]!==ID_COMMAND_SHAPES_INSERT||!1!==dzeUiConfig.bUseShapesFeature)this.arrMenuMember[a][d]===ID_COMMAND_HEADER&&!1===dzeUiConfig.bUseHeaderFooter?
d+=2:(b+=this.buildMenuItem(this.arrMenuMember[a][d],!1),a==ID_COMMAND_MENU_TABLE_INDEX&&handlerUI.setMenuTableUpdateIndex(this.arrMenuMember[a][d],c),c++);b+=this.buildMenuItem_Margin();return b+"</table>"}catch(e){dalert(e)}};this.buildMenuItem=function(a,b){try{var c="";c+='<tr class="MenuItem '+g_strSkin_MenuItem+'" MBCODE='+a+">";c+='<td width="10" style="line-height:1;vertical-align:middle;"></td>';c=""==g_arrIcon[a]?c+('<td width="16" style="line-height:1;vertical-align:middle;"><div style="line-height:0;" class="MenuItem_Image"><img src="'+
g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div></td>'):c+('<td width="16" style="line-height:1;vertical-align:middle;"><div style="line-height:0;" class="MenuItem_Image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" alt="'+g_arrConst[a][1]+'" width="16" height="16" style="vertical-align:baseline;border:none;"></div></td>');c+='<td width="6" style="line-height:1;vertical-align:middle;"></td>';var d="",e;for(e in shortcutsMenuList)if(e==
a){d="<span class='shortcuts_text'>("+shortcutsMenuList[e]+")</span>";break}var f=g_arrConst[a][1];inArray(a,this.openMenuList)&&(f+="...");!b||ID_COMMAND_JUSTIFY_LEFT!=a&&ID_COMMAND_JUSTIFY_CENTER!=a&&ID_COMMAND_JUSTIFY_RIGHT!=a&&ID_COMMAND_JUSTIFY_JUSTIFY!=a&&ID_COMMAND_OUTDENT!=a&&ID_COMMAND_INDENT!=a&&ID_COMMAND_SELECT_ALL!=a||(f+=" ("+ID_RES_TOOL_STRING_MENU_TABLE+")",d="");c+='<td  style="line-height:1;text-align:left;vertical-align:middle;min-width:110px;">'+f+d+"</td>";b=!1;for(e in this.twoDepthMenu)if(a==
e){b=!0;break}c=1==b?c+('<td width="3"><img src="'+dzeEnvConfig.strPath_Image+'toolbar/btn_sub_arrow.png" alt="view submenu" width="3" height="5" style="border:none;"></td>'):c+'<td width="3"></td>';return c+'<td width="10" style="line-height:1;vertical-align:middle;"></td></tr>'}catch(g){dalert(g)}};this.buildMenuItem_Margin=function(){try{var a="";a+='<tr class="MenuItem_Garbage">';return a+'<td colspan="6" height="2"></td></tr>'}catch(b){dalert(b)}};this.buildMenuItem_Garbage=function(){try{var a=
"";a+='<tr class="MenuItem_Garbage">';return a+'<td colspan="6" height="1"></td></tr>'}catch(b){dalert(b)}};this.buildMenuItem_Separator=function(){try{var a="";a+='<tr class="MenuSeparator">';return a+'<td colspan="6" class="MenuItem_Separator" style="line-height:normal;"></td></tr>'}catch(b){dalert(b)}};this.setupMenuEvent=function(a,b){try{if(a){var c=a.querySelectorAll(".MenuItem");forEach(c,function(a,c){this.setupMenuItemEvent(c,b)},this)}}catch(d){dalert(d)}};this.setupMenuItemEvent=function(a,
b){try{if(g_objPropertyUtil.hasClass(a,"MenuItem")){var c=a.getAttribute("MBCODE");a.onmouseover=function(a){g_objMenuWin.setMenuItemMouseOver(this)};a.onmousedown=function(a){TBCancelBubbleEvent(a)};a.onmouseup=function(a){TBCancelBubbleEvent(a)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;window.attachEvent?a.oncontextmenu=fnReturnFalsePropagation:a.addEventListener("contextmenu",fnReturnFalsePropagation,!1);var d=!1;for(idx in this.twoDepthMenu)if(c==
idx){d=!0;break}1!=d&&(a.onclick=function(a){eval(g_arrConst[c][3])(a,this,-1)});a.command=g_arrConst[c][0];a.commandtype=ID_COMMAND_TYPE_MENU;a.TBSTATE=ID_STRING_NAME_UNCHECKED;a.command_id=c;a.support_type=g_arrConst[c][4];a.support_control_type=g_arrConst[c][5];this.objSubMenuItem[b][this.objSubMenuItem[b].length]=a}}catch(e){dalert(e)}};this.initMenuLayerEvent=function(){try{this.closeMenuLayer(),g_objLayerEventUtil.removeLayerEvent()}catch(a){dalert(a)}};this.closeMenuLayer=function(a){try{for(a=
0;a<this.arrMenuMember.length;a++)fnObjectCheckNull(this.arrMenuLayer[a])||(this.arrMenuLayer[a].style.display="none");duzon_menubar.hideTwoDepthMenu();duzon_menubar.closeHiddenTbContainerTool()}catch(b){dalert(b)}};this.showMenuLayer=function(a,b){try{dlog("showMenuLayer nIndex : "+a+", nEditNumber:"+b);this.initializeMenuLayer();dlog(this.arrMenuLayer[a]);g_objWrapperOutlineResize.resetExtOutlineInfo();g_nActiveEditNumber=b;var c=this.arrTBMenu[b][a].element;null!=c&&(this.closeMenuLayer("hide"),
this.update_menuItem(b),g_objLayerEventUtil.showLayerWin(this.arrMenuLayer[a],c,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,!1))}catch(d){dalert(d)}};this.update_menuItem=function(a){try{var b=g_objEditorDocument[a],c="";c=window.attachEvent?g_objEditorDocument[a].selection.type:getSelectionTypeForUpdateUI();c=c.toLowerCase();if(ID_STRING_NAME_CONTROL==c)if(1==getSelectionControl(a).rangeLength)for(var d=0;d<this.objSubMenuItem.length;d++)for(var e=0;e<this.objSubMenuItem[d].length;e++){var f=this.objSubMenuItem[d][e];
ID_SUPPORT_CONTROL_TYPE_NO==f.support_control_type&&this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY)}else for(d=0;d<this.objSubMenuItem.length;d++)for(e=0;e<this.objSubMenuItem[d].length;e++)f=this.objSubMenuItem[d][e],this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY);else if(GetMultiCellSelection(a))for(d=0;d<this.objSubMenuItem.length;d++)if(ID_COMMAND_MENU_TABLE_INDEX==d)this.update_table_menuItem_queryStatus(g_objEditorDocument[a]);else for(e=0;e<this.objSubMenuItem[d].length;e++)f=this.objSubMenuItem[d][e],
ID_SUPPORT_TYPE_MULTI_CELL==f.support_type?this.TBSubMenuSetState(f,ID_STRING_NAME_UNCHECKED):ID_SUPPORT_TYPE_PERSISTENCE!=f.support_type&&ID_SUPPORT_TYPE_TABLE_OPERATION!=f.support_type?this.TBSubMenuSetState(f,ID_STRING_NAME_GRAY):ID_SUPPORT_TYPE_PERSISTENCE==f.support_type&&this.TBSubMenuSetState(f,ID_STRING_NAME_UNCHECKED);else for(d=0;d<this.objSubMenuItem.length;d++)if(ID_COMMAND_MENU_TABLE_INDEX==d)this.update_table_menuItem_queryStatus(g_objEditorDocument[a]);else for(e=0;e<this.objSubMenuItem[d].length;e++){var g=
this.objSubMenuItem[d][e],h=handlerUI.queryCommandStatus(b,this.objSubMenuItem[d][e].command_id,this.objSubMenuItem[d][e].command,a,-1,c);null==h&&g.TBSTATE==ID_STRING_NAME_UNCHECKED&&(h=ID_STRING_NAME_UNCHECKED);null!=h&&this.TBSubMenuSetState(g,h)}}catch(k){dalert(k)}};this.update_table_menuItem_queryStatus=function(a){try{updateTableHandlerUI.updateTableMenuUIHandler()}catch(b){dalert(b)}};this.setMenuItemMouseOver=function(a){try{if(a.TBSTATE!=ID_STRING_NAME_GRAY){var b=g_objNodeUtil.getChildrenCollection(a);
if(null!=b&&this.ID_MENU_ITEM_SEGMENT==b.length){b=!1;for(idx in this.twoDepthMenu)if(a.getAttribute("mbcode")==idx){b=!0;break}1==b?(setWindowResizeEvent(!1),duzon_menubar.viewTwoDepthMenu(a,a.getAttribute("mbcode"),this.twoDepthMenu[a.getAttribute("mbcode")]),setWindowResizeEvent(!0)):duzon_menubar.hideTwoDepthMenu(a.getAttribute("mbcode"))}}}catch(c){dalert(c)}};this.TBSubMenuSetState=function(a,b){try{b=b.toLowerCase();var c=null;dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell&&(c=handlerUI.setDisableMenu(a.command_id));
b=1==c?ID_STRING_NAME_GRAY:b;!g_objPropertyUtil.hasClass(a,"MenuItem")||b!==ID_STRING_NAME_GRAY&&b!==ID_STRING_NAME_CHECKED&&b!==ID_STRING_NAME_UNCHECKED&&b!==ID_STRING_NAME_HIDE||(b===ID_STRING_NAME_CHECKED||b===ID_STRING_NAME_UNCHECKED||b===ID_STRING_NAME_HIDE?g_objPropertyUtil.setFilterOpacityStyle(a,!1):b===ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!0),b===ID_STRING_NAME_CHECKED||b===ID_STRING_NAME_UNCHECKED||b===ID_STRING_NAME_GRAY?"none"===a.style.display&&(a.style.display=
""):b===ID_STRING_NAME_HIDE&&(a.style.display="none"),a.TBSTATE=b)}catch(d){dalert(d)}};this.TBMenuSetState=function(a,b){try{switch(b=b.toLowerCase(),a.className){case g_strSkin_Menu_Area:case g_strSkin_Menu_AreaOver:case g_strSkin_Menu_AreaDown:case g_strSkin_Menu_AreaUp:if(b==ID_STRING_NAME_GRAY||b==ID_STRING_NAME_CHECKED||b==ID_STRING_NAME_UNCHECKED){var c=a.TBSTATE;b!=c&&(b==ID_STRING_NAME_CHECKED?(a.className=g_strSkin_Menu_AreaUp,c==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,
!1)):b==ID_STRING_NAME_UNCHECKED?(a.className=g_strSkin_Menu_Area,c==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!1)):b==ID_STRING_NAME_GRAY&&(a.className=g_strSkin_Menu_Area,g_objPropertyUtil.setFilterOpacityStyle(a,!0)),a.TBSTATE=b)}}}catch(d){dalert(d)}};this.TBMenuSetStateAllEnable=function(a,b){try{!0===g_readonlyMode&&(g_bMenuEnabled=a=!1);for(var c=0;c<this.arrTBMenu[b].length;c++)a?this.TBMenuSetState(this.arrTBMenu[b][c].element,ID_STRING_NAME_UNCHECKED):this.TBMenuSetState(this.arrTBMenu[b][c].element,
ID_STRING_NAME_GRAY);!0===dzeUiConfig.bUseUiMode&&!0===dze_menu_control.ribbon_menu_created[b]&&dze_menu_control.RibbonMenuSetStateAllEnable(a,b)}catch(d){dalert(d)}};this.TBMenuShowMenuState=function(a,b,c){try{var d=this.arrTBMenu[c][a].element;if(d.TBSTATE!=ID_STRING_NAME_GRAY)if(b&&(this.bMenuDisplayToggle=!this.bMenuDisplayToggle),this.bMenuDisplayToggle)for(b=0;b<this.arrTBMenu[c].length;b++)b==a?ID_STRING_NAME_CHECKED!=this.arrTBMenu[c][b].element.TBSTATE&&(this.TBMenuSetState(d,ID_STRING_NAME_CHECKED),
this.showMenuLayer(a,c),g_bDynamicLayer=this.bMenuLayerShow=!0):ID_STRING_NAME_CHECKED==this.arrTBMenu[c][b].element.TBSTATE&&this.TBMenuSetState(this.arrTBMenu[c][b].element,ID_STRING_NAME_UNCHECKED);else this.bMenuLayerShow&&(g_objLayerEventUtil.initHideDynamicLayer(),d.className=g_strSkin_Menu_AreaOver)}catch(e){dalert(e)}};this.TBMenuCloseMenuState=function(){try{if(this.bMenuLayerShow)for(var a=0;a<this.arrTBMenu[g_nActiveEditNumber].length;a++)ID_STRING_NAME_CHECKED==this.arrTBMenu[g_nActiveEditNumber][a].element.TBSTATE&&
this.TBMenuSetState(this.arrTBMenu[g_nActiveEditNumber][a].element,ID_STRING_NAME_UNCHECKED);this.bMenuLayerShow=this.bMenuDisplayToggle=!1}catch(b){dalert(b)}};this.TBMenuButtonMouseOver=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a);var e=this.arrTBMenu[c][b].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_Menu_AreaUp:g_strSkin_Menu_AreaOver,this.TBMenuShowMenuState(b,!1,c))}catch(f){dalert(f)}};this.TBMenuButtonMouseOut=function(a,b,c,d){try{d&&
TBCancelBubbleEvent(a);var e=this.arrTBMenu[c][b].element;e.TBSTATE!=ID_STRING_NAME_GRAY&&(e.className=e.TBSTATE==ID_STRING_NAME_CHECKED?g_strSkin_Menu_AreaUp:g_strSkin_Menu_Area)}catch(f){dalert(f)}};this.TBMenuButtonMouseDown=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a);var e=this.arrTBMenu[c][b].element;if(e.TBSTATE!=ID_STRING_NAME_GRAY){if(e.TBSTATE==ID_STRING_NAME_CHECKED)e.className=g_strSkin_Menu_AreaUp;else if(e.TBSTATE==ID_STRING_NAME_UNCHECKED){if(e.className=g_strSkin_Menu_AreaDown,
g_bDynamicLayer){g_objLayerEventUtil.initHideDynamicLayer();dlog("g_bDynamicLayer:"+g_bDynamicLayer);return}}else e.className=g_strSkin_Menu_AreaDown;this.TBMenuShowMenuState(b,!0,c)}}catch(f){dalert(f)}};this.TBMenuButtonMouseUp=function(a,b,c,d){try{d&&TBCancelBubbleEvent(a)}catch(e){dalert(e)}};this.queryStatusMenuItem=function(a,b){try{var c={};c.element=a;c.menuIndex=b;c.element.TBSTATE=ID_STRING_NAME_UNCHECKED;return c}catch(d){dalert(d)}return null};this.TBInitMenuButton=function(a,b){try{if(g_bMenuBar_Display){this.arrTBMenu[b][this.arrTBMenu[b].length]=
this.queryStatusMenuItem(a,this.arrTBMenu[b].length);var c=this.arrTBMenu[b].length-1;a.onmouseover=function(a){g_objMenuWin.TBMenuButtonMouseOver(a,c,b,!0)};a.onmouseout=function(a){g_objMenuWin.TBMenuButtonMouseOut(a,c,b,!0)};a.onmousedown=function(a){g_objMenuWin.TBMenuButtonMouseDown(a,c,b,!0)};a.onmouseup=function(a){g_objMenuWin.TBMenuButtonMouseUp(a,c,b,!0)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBCancelBubbleEvent;a.className=
g_strSkin_Menu_Area;a.TBSTATE==ID_STRING_NAME_GRAY&&g_objPropertyUtil.setFilterOpacityStyle(a,!0)}}catch(d){dalert(d)}}};
var comboBoxWin=function(){var n=this;this.objComboBoxLayer=null;this.objComboBoxLayerSub=[];this.bComboBoxDisplay=!1;this.arrFontSizeText=[ID_RES_COMBOBOX_REMOVE_FONT_SIZE,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_8,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_24,ID_RES_COOMBOBOX_WIN_SIZE_TEXT_36];
this.arrFontSize=" 6pt 7pt 8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 19pt 20pt 22pt 24pt 26pt 30pt 36pt 40pt 44pt 48pt 54pt 60pt 66pt 72pt 80pt 88pt 96pt".split(" ");this.arrHeadingText=[ID_RES_CONST_STRING_STYLE_STYLE_BASIC,ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT1,ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT2,ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT3,ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT4,ID_RES_CONST_STRING_STYLE_STYLE_SUBJECT5];this.arrHeadingBlock=" h1 h2 h3 h4 h5 h6".split(" ");this.arrSortType=
[ID_RES_DIALOG_STRING_NAME,ID_RES_DIALOG_STRING_SIZE,ID_RES_CONST_STRING_LAST_MODIFIED_DATE,ID_RES_CONST_STRING_OWNER];this.arrStyleTemplateName=null;this.strComboBoxCommand="";comboBoxWin.prototype.initText=function(){try{null===this.arrStyleTemplateName&&(this.arrStyleTemplateName=getStyleTemplateName())}catch(a){dalert(a)}};comboBoxWin.prototype.initializeComboBoxLayer=function(){try{if(null==this.objComboBoxLayer){this.initText();var a='<div id="divComboBoxSelect" style="position:absolute; display:none; z-index:20031">';
a+='<table cellpadding=0 cellspacing=0 border=0 style="border-collapse:separate;table-layout:auto;" class="'+g_strSkin_ComboBoxWin+'"><tr><td style="line-height:normal;">';for(var b='<table id="ComboBoxItem_FontName" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">',c=0;c<g_arrFontName.length;c++)b+='<tr><td style="line-height:normal">',b+='<table id="ComboBoxItem_FontName_Sub_'+c+'"  cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+
'"><tr>',b=""==g_arrFontName[c]?b+("<td style='line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;padding-left:8px;'>"+ID_RES_COMBOBOX_REMOVE_FONT_FAMILY+"</td>"):b+("<td style='line-height:normal;text-align:left;vertical-align:middle;color:#000000;cursor:default;font-size:9pt;padding-left:8px;font-family:"+g_arrFontName[c]+";'>"+g_arrFontName[c].replace(/["']/g,"")+"</td>"),b+="</tr></table>",b+="</td></tr>";b+="</table>";"undefined"!=typeof dzeUiConfig.arrCustomFontSize&&
0<dzeUiConfig.arrCustomFontSize.length&&(this.arrFontSize=dzeUiConfig.arrCustomFontSize);var d='<table id="ComboBoxItem_FontSize" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';for(c=0;c<this.arrFontSize.length;c++)d+='<tr><td style="line-height:normal;">',d+='<table id="ComboBoxItem_FontSize_Sub_'+c+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>',d=0==c?d+('<td style="line-height:normal;text-align:left;font-family:'+
ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:8px">'+this.arrFontSizeText[c]+"</td>"):d+('<td style="line-height:normal;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:8px">'+this.arrFontSize[c]+"</td>"),d+="</tr></table>",d+="</td></tr>";d+="</table>";var f='<table id="ComboBoxItem_HeadingSize" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';
for(c=0;c<this.arrHeadingText.length;c++){f+='<tr><td style="line-height:normal;padding:0;">';f+='<table id="ComboBoxItem_HeadingSize_Sub_'+c+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'"><tr>';var e=this.arrHeadingBlock[c];f=0==c?f+('<td style="line-height:0;text-align:left;font-family:'+ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:8px">'+this.arrHeadingText[c]+"</td>"):f+('<td style="line-height:0;text-align:left;font-family:'+
ID_RES_GLOBAL_FONT_FAMILY_TYPE_1+';color:#000000;cursor:default;font-size:12px;padding-left:8px"><'+e+">"+this.arrHeadingText[c]+"</"+e+"></td>");f+="</tr></table>";f+="</td></tr>"}f+="</table>";e='<table id="ComboBoxItem_StyleTemplate" cellpadding=0 cellspacing=0 border=0 style="display:none;border-collapse:separate;table-layout:auto;">';c=0;for(var h=this.arrStyleTemplateName.length;c<h;c++){var k=this.arrStyleTemplateName[c];-1===k?e+='<tr><td class="dze_ribbon_tb_left_separator" style="line-height:normal;padding:0;height:1px;"></td></tr>':
(e+='<tr><td style="line-height:normal;padding:0;">',e+='<table id="ComboBoxItem_StyleTemplate_Sub_'+c+'" cellpadding=0 cellspacing=0 border=0 class="'+g_strSkin_ComboBoxItem_Out+'" title="'+k+'">',e+='<tr><td style="line-height:0;text-align:left;cursor:default;padding-left:8px">'+getStyleTemplateHtml(k,"combo")+"</td></tr>",e+="</table>",e+="</td></tr>")}e+="</table>";a+=b;a+=d;a+=f;a+=e;a+="</td></tr></table>";a+="</div>";var l=g_objLayerKit.getElementById("divComboBoxSelect");l||(l=g_objInsertUtil.insertLayerHTML(a,
!0));this.objComboBoxLayer=l;this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(l.querySelector("#ComboBoxItem_FontName"),g_arrFontName.length,0);this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(l.querySelector("#ComboBoxItem_FontSize"),this.arrFontSize.length,1);this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=this.initComboBoxSubItem(l.querySelector("#ComboBoxItem_HeadingSize"),this.arrHeadingText.length,2);this.objComboBoxLayerSub[this.objComboBoxLayerSub.length]=
this.initComboBoxSubItem(l.querySelector("#ComboBoxItem_StyleTemplate"),this.arrStyleTemplateName.length,3)}}catch(g){dalert(g)}};comboBoxWin.prototype.unload=function(){try{var a=g_objLayerKit.getElementById("divComboBoxSelect");a&&a.parentNode&&a.parentNode.removeChild(a);this.objComboBoxLayer=null;this.objComboBoxLayerSub=[]}catch(b){dalert(b)}};comboBoxWin.prototype.initComboBoxSubItem=function(a,b,c){try{var d={};d.element=a;d.subItem=[];for(var f=a.id,e=0;e<b;e++){var h=a.querySelector("#"+
f+"_Sub_"+e);h&&(d.subItem[e]=h,h.onmouseout=function(a){n.fnComboBoxItemOut(this)},h.onmousedown=TBCancelBubbleEvent,h.onmouseup=TBCancelBubbleEvent,function(){var a="",b=h;0==c?a=g_arrFontName[e]:1==c?a=n.arrFontSize[e]:2==c?a=e:3===c&&(a=n.arrStyleTemplateName[e]);h.onclick=function(c){!0===dzeUiConfig.bTBPreviewLetterOperation&&(n.objComboBoxLayer.onmouseleave=function(){});n.setComboBox(a,!0,null,b)};h.onmouseover=function(){n.fnComboBoxItemOver(this);!0===dzeUiConfig.bTBPreviewLetterOperation&&
n.setComboBox(a,!1,null,b);dzeUiConfig.bOfficePagingMode&&g_objPageControl.clearUpdatePageTimer()}}())}window.attachEvent?d.element.oncontextmenu=fnReturnFalsePropagation:d.element.addEventListener("contextmenu",fnReturnFalsePropagation,!1);return d}catch(k){dalert(k)}return null};comboBoxWin.prototype.initComboBoxLayerEvent=function(){try{null!=this.objComboBoxLayer&&this.bComboBoxDisplay&&(this.objComboBoxLayerSub[0].element.style.display="none",this.objComboBoxLayerSub[1].element.style.display=
"none",this.objComboBoxLayerSub[2].element.style.display="none",this.objComboBoxLayer.style.display="none",this.strComboBoxCommand="",this.bComboBoxDisplay=!1,g_objLayerEventUtil.removeLayerEvent(),this.objComboBoxLayer=null,this.objComboBoxLayerSub=[])}catch(a){dalert(a)}};comboBoxWin.prototype.showComboBoxLayer=function(a,b,c){try{if(this.initializeComboBoxLayer(),null!=this.objComboBoxLayer){g_nActiveEditNumber=b;g_nLetterOperationType=a;var d=0,f=0;if(0==a)f=ID_COMMAND_FONT_NAME;else if(1==a)f=
ID_COMMAND_FONT_SIZE;else if(2==a)f=ID_COMMAND_HEADING_SIZE,g_nLetterOperationType=ID_LETTER_OPERATION_HEADING_SIZE;else if(3===a)f=ID_COMMAND_STYLE_TEMPLATE_COMBO;else return;var e=handlerUI.getCommandUpdateIndex(b,f);-1!=e&&(d=e);var h=c?c:g_TBComboBox[b][d].element;if(null!=h)if(this.bComboBoxDisplay)g_objLayerEventUtil.initHideDynamicLayer();else{var k=g_objPropertyUtil.getSelectionAttributeValue(b);if("undefined"!=typeof k&&null!=k){if(0==a){if("undefined"==typeof k[0]||null==k[0])k[0]="";for(var l=
updateHandlerUI.getMappingIndex_FontName(k[0],b),g=0;g<g_arrFontName.length;g++){var m=this.objComboBoxLayerSub[a].subItem[g];m&&(m.className=l===g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out)}}else if(1==a){if("undefined"==typeof k[1]||null==k[1])k[1]="";l=updateHandlerUI.getMappingIndex_FontSize(k[1],b);for(g=0;g<this.arrFontSize.length;g++)if(m=this.objComboBoxLayerSub[a].subItem[g])m.className=l===g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out}else if(2==a)for(l=updateHandlerUI.getMappingIndex_Heading(b),
g=0;g<this.arrHeadingText.length;g++){if(m=this.objComboBoxLayerSub[a].subItem[g])m.className=l===g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out}else if(3==a)for(l=updateHandlerUI.getMappingIndex_StyleTemplate(b),g=0;g<this.arrStyleTemplateName.length;g++)if(m=this.objComboBoxLayerSub[a].subItem[g])m.className=l===g?g_strSkin_ComboBoxItem_Down:g_strSkin_ComboBoxItem_Out;this.strComboBoxCommand=g_TBComboBox[b][d].element.command;this.bComboBoxDisplay=!0;this.objComboBoxLayerSub[a].element.style.display=
"";g_objLayerEventUtil.showLayerWin(this.objComboBoxLayer,h,ID_DROPDOWN_LAYER_POSITION_TYPE_LEFT,dzeUiConfig.bTBPreviewLetterOperation);!0===dzeUiConfig.bTBPreviewLetterOperation&&(g_objLayerEventUtil.canSaveTableSelectedCellHTML(b)?g_objLayerEventUtil.saveTableSelectedCellHTML(GetCurTable(b)):g_objUndoRedo.setUndoSelection(b),this.objComboBoxLayer.onmouseleave=function(){if(g_objLayerEventUtil.canSaveTableSelectedCellHTML(b))g_objLayerEventUtil.restoreTableSelectedCellHTML(GetCurTable(b));else{g_objUndoRedo.registerUndoRedoStack(0,
b);g_objUndoRedo.operateUndoRedoStack(!0,!0,b);var a=0;"none"!==this.querySelector("#ComboBoxItem_FontName").style.display?a=DZE_LETTER_COMMAND_FONT_FAMILY:"none"!==this.querySelector("#ComboBoxItem_FontSize").style.display&&(a=DZE_LETTER_COMMAND_FONT_SIZE);0!==a&&letterFunction.getInstance().removeSentenceStyle(a)}})}}}}catch(p){dalert(p)}};comboBoxWin.prototype.setupComboBoxLabel=function(a,b){try{this.initText();var c="",d=null;if(ID_COMMAND_FONT_NAME===b)d=g_arrFontName;else if(ID_COMMAND_FONT_SIZE===
b)d=this.arrFontSize;else if(ID_COMMAND_HEADING_SIZE===b)d=this.arrHeadingText;else if(ID_COMMAND_STYLE_TEMPLATE_COMBO===b)d=this.arrStyleTemplateName;else return;b=0;for(var f=d.length;b<f;b++)c+="<span style='display:none;line-height:normal;'>"+d[b]+"</span>";a.innerHTML=c}catch(e){dalert(e)}};comboBoxWin.prototype.fnComboBoxItemOver=function(a){try{a.className!=g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Over)}catch(b){dalert(b)}};comboBoxWin.prototype.fnComboBoxItemOut=function(a){try{a.className!=
g_strSkin_ComboBoxItem_Down&&(a.className=g_strSkin_ComboBoxItem_Out)}catch(b){dalert(b)}};comboBoxWin.prototype.setComboBox=function(a,b,c,d){try{var f=!0,e=!1,h=g_nActiveEditNumber,k=GetMultiCellSelection(h);"undefined"!=typeof b&&(f=b);if(""!=g_objComboBoxWin.strComboBoxCommand)if(d&&d.id&&0<=d.id.indexOf("ComboBoxItem_StyleTemplate"))fnHandler_setStyleTemplate(null,d,h,b,b);else{var l=getSelectionTypeForUpdateUI();if(ID_STRING_NAME_NONE==l||ID_STRING_NAME_TEXT==l)g_nLetterOperationType==ID_LETTER_OPERATION_FONT_FAMILY?
e=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_FONT_FAMILY,a,0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()):g_nLetterOperationType==ID_LETTER_OPERATION_FONT_SIZE?e=letterFunction.getInstance().setSentenceStyle(DZE_LETTER_COMMAND_FONT_SIZE,a,0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()):g_nLetterOperationType==ID_LETTER_OPERATION_HEADING_SIZE&&(e=g_objLetterFn.setParaStyle(h,{head:g_objComboBoxWin.arrHeadingBlock[a]}));
0!=f&&g_objLayerEventUtil.initHideDynamicLayer();0!=f&&(!1===fnObjectCheckNull(c)&&"function"===typeof c?c(e):k?commonUpdateAfterChange(h,GetCurTable(h)):(g_objUndoRedo.registerUndoRedoStack(0,h),g_objPageControl.onSetDelayedUpdatePageTimer(),editor_onselectionchange(h)))}}catch(g){dalert(g)}}},g_objComboBoxWin=new comboBoxWin;
var g_objContextMenuWin=new function(){this.ID_CONTEXT_TYPE_CASE_GENERAL=0;this.ID_CONTEXT_TYPE_CASE_TABLE_ONE=1;this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI=2;this.ID_CONTEXT_TYPE_CASE_CONTROL=3;this.ID_CONTEXT_TYPE_CASE_CONTROL_EXTERNAL_DATA=4;this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU=5;this.ID_CONTEXT_TYPE_CASE_VIDEO_CONTROL=6;this.ID_CONTEXT_TYPE_CASE_TEXTBOX_CONTROL=7;this.ID_CONTEXT_TYPE_CASE_HEADER=8;this.ID_CONTEXT_TYPE_CASE_FOOTER=9;this.ID_CONTEXT_TYPE_CASE_PAGE_CONTROL=10;this.ID_CONTEXT_TYPE_CASE_SELECT=
11;this.ID_CONTEXT_TYPE_CASE_PAGE_NUMBER=12;this.arrContextMenuType_SubItems="arrContextMenu_General arrContextMenu_OneCell arrContextMenu_MultiCell arrContextMenu_Control arrContextMenu_ControlExternalData arrContextMenu_TableMiniMenu arrContextMenu_Video arrContextMenu_Textbox arrContextMenu_Header arrContextMenu_Footer arrContextMenu_Page_Control arrContextMenu_Select arrContextMenu_PageNumber".split(" ");this.divContextMenuRoot=null;this.objContextMenuLayer=[];this.arrTBContextMenuItem=[];this.nActiveContextMenu=
0;this.objContextInfo=null;this.bShow=this.bContextMenuAttachMouseEvent=!1;this.isShow=function(){return this.bShow};this.initializeContextMenuLayer=function(a){try{if(!this.objContextMenuLayer[a]&&(this.divContextMenuRoot||(this.divContextMenuRoot=g_objInsertUtil.insertLayerHTML("<div id='divContextMenuRoot'></div>",!0)),this.divContextMenuRoot)){var c=this.divContextMenuRoot.querySelector("#divContextMenu_"+a);if(!c){var b="<div id='divContextMenu_"+a+"' class='ContextMenuContainer'";switch(a){case this.ID_CONTEXT_TYPE_CASE_VIDEO_CONTROL:case this.ID_CONTEXT_TYPE_CASE_HEADER:case this.ID_CONTEXT_TYPE_CASE_FOOTER:case this.ID_CONTEXT_TYPE_CASE_PAGE_CONTROL:case this.ID_CONTEXT_TYPE_CASE_SELECT:case this.ID_CONTEXT_TYPE_CASE_PAGE_NUMBER:b+=
" style='width: auto;'"}b+=">";b+="<table cellpadding=0 cellspacing=0 border=0 width='100%'><tr><td>";b+="<table cellpadding=0 cellspacing=0 border=0 class='"+g_strSkin_MenuWin+"'><tr><td>";b+=this.buildContextMenuContent(a);b+="</td></tr></table>";b+="</td></tr></table>";b+="</div>";var d=document.createRange().createContextualFragment(b);c=d.firstChild;if(!c)return;this.divContextMenuRoot.appendChild(d)}c.style.display="none";c.style.height="";c.style.overflowY="";c.scrollTop=0;this.objContextMenuLayer[a]=
c;this.arrTBContextMenuItem[a]=[];this.setupContextMenuEvent(c,a);g_objNodeUtil.initFalsePropagationEvent(c)}}catch(h){dalert(h)}};this.unload=function(){try{var a=this.divContextMenuRoot;a&&a.parentNode&&a.parentNode.removeChild(a);this.divContextMenuRoot=null;this.objContextMenuLayer=[];this.arrTBContextMenuItem=[]}catch(c){dalert(c)}};this.buildContextMenuContent=function(a){try{var c=this.arrContextMenuType_SubItems[a];if(!c)return"";a=dzeUiConfig;var b=a[c];if(!b)return"";c=g_objMenuWin;var d=
"";d+='<table class="MenuContent" cellpadding=0 cellspacing=0 style="border-collapse:separate;">';d+=g_objMenuWin.buildMenuItem_Margin();for(var h=0,k=b.length;h<k;h++)if(ID_TYPE_MENU_SEPARATOR==b[h])d+=c.buildMenuItem_Garbage(),d+=c.buildMenuItem_Separator(),d+=c.buildMenuItem_Garbage();else{var g=b[h];if(g!==ID_COMMAND_INSERT_INPUTBOX||!1!==a.bUseReportForm)if(g!==ID_COMMAND_LOCK_EDIT_CELL||!1!==a.bUseLockEditCellFunction&&!1!==g_bLockEditCellMode)d+=c.buildMenuItem(g,!0)}d+=g_objMenuWin.buildMenuItem_Margin();
return d+"</table>"}catch(e){dalert(e)}};this.setupContextMenuEvent=function(a,c){try{if(a){this.setupContextMenuItemEvent(a,c);var b=a.querySelectorAll(".MenuItem");forEach(b,function(a,b){this.setupContextMenuItemEvent(b,c)},this)}}catch(d){dalert(d)}};this.setupContextMenuItemEvent=function(a,c){try{if(a)if(g_objPropertyUtil.hasClass(a,"MenuItem")){var b=a.getAttribute("MBCODE");a.onmouseover=function(a){g_objMenuWin.setMenuItemMouseOver(this)};a.onmousedown=TBCancelBubbleEvent;a.onmouseup=function(a){eval(g_arrConst[b][3])(a,
this,-1,"context",c)};a.ondragstart=TBCancelBubbleEvent;a.onselectstart=TBCancelBubbleEvent;a.onselect=TBCancelBubbleEvent;a.onclick=TBCancelBubbleEvent;a.command=g_arrConst[b][0];a.commandtype=ID_COMMAND_TYPE_CONTEXT_MENU;a.TBSTATE=ID_STRING_NAME_UNCHECKED;a.command_id=b;a.support_type=g_arrConst[b][4];a.support_control_type=g_arrConst[b][5];var d=this.arrTBContextMenuItem[c].length;this.arrTBContextMenuItem[c][d]=a;this.ID_CONTEXT_TYPE_CASE_TABLE_ONE!==c&&this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI!==
c||handlerUI.setContextUpdateIndex(c,b,d)}else g_objPropertyUtil.hasClass(a,"ContextMenuContainer")&&(a.dze_add_listener||(a.dze_add_listener=[]),!0!==a.dze_add_listener.wheel&&(a.dze_add_listener.wheel=!0,EventUtil.addHandler(a,"wheel",function(a){var b=g_objLayerKit.getElementById(duzon_menubar.idx_twodepth_menu_container);if(b&&"none"!==b.style.display)return TBCancelBubbleEvent(a),!1;b=a.deltaY;var c=this.scrollTop;if(c>=this.scrollHeight-this.offsetHeight&&0<b||0===c&&0>b)return TBCancelBubbleEvent(a),
!1;a.cancelBubble=!0;return!1})))}catch(h){dalert(h)}};this.initContextMenuLayerEvent=function(){try{if(dlog("initContextMenuLayerEvent"),duzon_menubar.hideTwoDepthMenu(),null!=this.objContextMenuLayer){for(var a=0;a<this.objContextMenuLayer.length;a++)fnObjectCheckNull(this.objContextMenuLayer[a])||(this.objContextMenuLayer[a].style.display="none");this.bContextMenuAttachMouseEvent&&(this.bContextMenuAttachMouseEvent=!1,g_objLayerEventUtil.removeLayerEvent());this.bShow=!1}}catch(c){dalert(c)}};
this.showContextMenuLayer=function(a,c,b,d){try{if(!0!==g_readonlyMode&&(this.initializeContextMenuLayer(a?a.nContextMenuType:null),null!=this.objContextMenuLayer))if(this.bContextMenuAttachMouseEvent)g_objLayerEventUtil.initHideDynamicLayer();else for(this.display_context_menuItem(a,c,b,d),this.bContextMenuAttachMouseEvent=this.bShow=g_bDynamicLayer=!0,a=0;a<this.objContextMenuLayer.length;a++)if(this.objContextMenuLayer[a]&&""===this.objContextMenuLayer[a].style.display){g_objLayerEventUtil.objCurrentLayer=
this.objContextMenuLayer[a];g_objLayerEventUtil.addLayerEvent();break}}catch(h){dalert(h)}};this.getContextMenuType=function(a,c){try{var b={nContextMenuType:this.ID_CONTEXT_TYPE_CASE_GENERAL,strSelectedTagName:""},d=a?a.target||a.srcElement:null,h=g_objNodeUtil.getLoopParentElementByTagNames(d,[DZE_TAG_SPAN,DZE_TAG_DIV]);if(0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()&&(!0===g_objPropertyUtil.element_hasClass(h,"dze_shape_preview_field")||!0===g_objPropertyUtil.element_hasClass(h,
"dze_shape_main")))return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TEXTBOX_CONTROL,b;if(dzeUiConfig.bUseHeaderFooter&&!g_objHeaderFooter.getHeaderFooterEditMode()){var k=a.srcElement?a.srcElement:a.target,g=g_objPageControl.getPageNum(k),e=g_objHeaderFooter.getHeaderContainer(g),f=g_objHeaderFooter.getFooterContainer(g);if(e.contains(k))return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_HEADER,b;if(f.contains(k))return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_FOOTER,b}if(d&&"DIV"===d.nodeName&&
g_objPropertyUtil.hasClass(d,"dze_page_num"))return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_PAGE_NUMBER,b;if(window.attachEvent){if(ID_STRING_NAME_CONTROL==g_objEditorDocument[c].selection.type.toLowerCase()){var n=g_objEditorDocument[c].selection.createRange();if(1==n.length){var l=n.item(0).tagName.toLowerCase();if("table"==l||"img"==l)return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_CONTROL,b.strSelectedTagName=l,b;if("video"==l||"videoframecover"==l||"videoresize"==l)return"video"==l?
g_objVideoControl.setFocusParentNode(n.item(0)):g_objVideoControl.setFocusParentNode(n.item(0).parentNode),b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_VIDEO_CONTROL,b}return null}}else{if(g_objVideoControl.isVideo(d)||g_objVideoControl.isVideoControl(d))return g_objVideoControl.setFocusParentNode(d),b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_VIDEO_CONTROL,b;if(d&&"SELECT"===d.nodeName)return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_SELECT,b;var m=getSelectionType();dlog("objNodeInfo.nodeType:"+
m.nodeType);if(d&&!b.objDelete){a=null;for(h=g_objNodeUtil;d&&!h.isLoopBreakNode(d)&&!h.isCell(d);)a=d,d=d.parentNode;!a||"DIV"!==a.nodeName&&"PRE"!==a.nodeName||(b.objDelete=a)}if(ID_SELECTION_ELEMENT_NODE==m.nodeType)if(1==m.length){m=!1;var q=getSelectionElementNode(c);if(fnObjectCheckNull(q))if(g_bBrowserType_WK||g_bBrowserType_OP||g_bBrowserType_IE)m=!0;else return null;if(!m){l=q.nodeName.toLowerCase();dlog("strTagName:"+l);if("table"==l||"img"==l)return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_CONTROL,
b.strSelectedTagName=l,b;if("br"!=l&&"#text"!=l&&"a"!=l&&"span"!==l)return null}}else{if("tr"!=m.nodeName.toLowerCase())return null}else if(ID_SELECTION_TEXT_NODE!=m.nodeType&&ID_SELECTION_DUPLICATE!=m.nodeType)return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_GENERAL,b}var p=GetCurTable(c);dzeUiConfig.bUseLockEditCellFunction&&!p&&(g_bHasLockedCell=!g_objEditMode.checkSelectionContentEditable(c));if(GetMultiCellSelection(c))return 1>=GetSelectedCellCount(c)?b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TABLE_ONE:
b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI,b.table=p,b;if(p)return b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_TABLE_ONE,b.table=p,b;b.nContextMenuType=this.ID_CONTEXT_TYPE_CASE_GENERAL;return b}catch(r){dalert(r)}return-1};this.display_context_menuItem=function(a,c,b,d){try{if(!a)return!1;c={left:c,top:b};var h=a.nContextMenuType,k=this.objContextMenuLayer[h];if(!k||!0!==this.updateContextMenu(d,a))return!1;this.nActiveContextMenu=h;k.style.display="";var g=this.getContextMenuRect(k,
c);h!==this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU&&this.adjustContextMenuRect(k,g);this.setContextMenuRect(k,g);g_bContextMenuDisplayInEditAreaYN&&this.ShowContextMenuDisplayInEditArea(d,g.left,g.top,h);return!0}catch(e){dalert(e)}};this.updateContextMenu=function(a,c){try{if(!c)return!1;var b=c.nContextMenuType,d=c.strSelectedTagName,h=this.objContextMenuLayer[b];if(b==this.ID_CONTEXT_TYPE_CASE_GENERAL){updateHandlerUI.update_context_menu(b,null,null,a);for(var k=h.getElementsByTagName("table"),g=
0;g<k.length;g++)if("MenuContent"==k[g].className)for(var e=k[g].getElementsByTagName("tr"),f=0;f<e.length;f++)if(e[f].getAttribute("mbcode")&&e[f].getAttribute("mbcode")==ID_COMMAND_FILE_PROPERTY){e[f].style.display="none";e[f+1].style.display="none";e[f+2].style.display="none";e[f+3].style.display="none";break}else e[f].getAttribute("style")&&e[f].removeAttribute("style");var n=h.querySelector("tr.MenuItem[mbcode='18']");if(n){var l=n.childNodes[3];l&&l.firstChild&&c.objDelete?(l.firstChild.nodeValue=
"DIV"===c.objDelete.nodeName||"PRE"===c.objDelete.nodeName?ID_RES_CONST_STRING_DELETE_DIV:ID_RES_CONST_STRING_DELETE,n.style.display=""):n.style.display="none"}d=!1;for(g=0;g<this.arrTBContextMenuItem[b].length;g++)if(this.arrTBContextMenuItem[b][g].command_id==ID_COMMAND_HYPERLINK_REMOVE&&"unchecked"==this.arrTBContextMenuItem[b][g].TBSTATE){d=!0;break}if(1==d&&"dzeExtFile"==g_objALinkMgr.getPropContentParam(a).arrValue[3])for(g=0;g<k.length;g++)if("MenuContent"==k[g].className)for(e=k[g].getElementsByTagName("tr"),
f=0;f<e.length;f++)if(e[f].getAttribute("mbcode")&&e[f].getAttribute("mbcode")==ID_COMMAND_FILE_PROPERTY){e[f].getAttribute("style")&&e[f].removeAttribute("style");e[f+1].getAttribute("style")&&e[f+1].removeAttribute("style");e[f+2].getAttribute("style")&&e[f+2].removeAttribute("style");e[f+3].getAttribute("style")&&e[f+3].removeAttribute("style");break}}else if(b==this.ID_CONTEXT_TYPE_CASE_TABLE_ONE)updateHandlerUI.update_context_menu(b,null,null,a),updateTableHandlerUI.updateTableContextMenuUIHandler(b,
this.arrTBContextMenuItem[b],c.table);else if(b==this.ID_CONTEXT_TYPE_CASE_TABLE_MULTI)updateHandlerUI.update_context_menu(b,null,null,a),updateTableHandlerUI.updateTableContextMenuUIHandler(b,this.arrTBContextMenuItem[b],c.table);else if(b==this.ID_CONTEXT_TYPE_CASE_CONTROL){c=!1;var m=getSelectionControl(a);if(null!=m.controlObject&&"undefined"!=typeof m.controlObject&&"img"==m.controlObject.nodeName.toLowerCase()){var q=m.controlObject;q.getAttribute("chart_id")&&q.getAttribute("chart_data")&&
(c=!0)}k=h.getElementsByTagName("table");for(g=0;g<k.length;g++)if("MenuContent"==k[g].className)for(e=k[g].getElementsByTagName("tr"),f=0;f<e.length;f++){var p=1*e[f].getAttribute("mbcode");if(p===ID_COMMAND_IMAGE_REPLACE)!0===c?e[f].style.display="none":e[f].removeAttribute("style");else if(p===ID_COMMAND_SET_IMAGE_INFO)!0===c?e[f].removeAttribute("style"):e[f].style.display="none";else if(p===ID_COMMAND_MODIFY_CHART_ATTR){!0===c?(e[f].removeAttribute("style"),e[f-1].removeAttribute("style"),e[f-
2].removeAttribute("style"),e[f-3].removeAttribute("style")):(e[f].style.display="none",e[f-1].style.display="none",e[f-2].style.display="none",e[f-3].style.display="none");break}}updateHandlerUI.update_context_menu(b,ID_STRING_NAME_CONTROL,d,a)}else b==this.ID_CONTEXT_TYPE_CASE_TABLE_MINI_MENU?dzeUiConfig.bUseLockEditCellFunction&&g_bHasLockedCell?g_objMenuWin.TBSubMenuSetState(this.arrTBContextMenuItem[b][1],ID_STRING_NAME_GRAY):g_objMenuWin.TBSubMenuSetState(this.arrTBContextMenuItem[b][1],ID_STRING_NAME_UNCHECKED):
b==this.ID_CONTEXT_TYPE_CASE_TEXTBOX_CONTROL?updateHandlerUI.update_context_menu(b,null,null,a):b==this.ID_CONTEXT_TYPE_CASE_PAGE_CONTROL&&updateHandlerUI.update_context_menu(b,null,null,a);return!0}catch(r){dalert(r)}};this.getContextMenuRect=function(a,c){try{var b={};b.left=c.left;b.width=a.offsetWidth;b.right=c.left+b.width;b.top=c.top;b.height=a.offsetHeight;b.bottom=c.top+b.height;return b}catch(d){dalert(d)}};this.adjustContextMenuRect=function(a,c){try{if(a&&c){var b=0;a=0;g_objLayerKit.getLayerWindow().innerWidth&&
(b=g_objLayerKit.getLayerWindow().innerWidth);g_objLayerKit.getLayerWindow().innerHeight&&(a=g_objLayerKit.getLayerWindow().innerHeight);g_objLayerKit.getLayerDocument().documentElement.clientWidth&&(b=g_objLayerKit.getLayerDocument().documentElement.clientWidth);g_objLayerKit.getLayerDocument().documentElement.clientHeight&&(a=g_objLayerKit.getLayerDocument().documentElement.clientHeight);var d=0,h=0;d=g_objLayerKit.getLayerDocument().documentElement.scrollLeft?g_objLayerKit.getLayerDocument().documentElement.scrollLeft:
g_objLayerKit.getLayerDocument().body.scrollLeft;var k=h=g_objLayerKit.getLayerDocument().documentElement.scrollTop?g_objLayerKit.getLayerDocument().documentElement.scrollTop:g_objLayerKit.getLayerDocument().body.scrollTop;h=a+h;var g=d;b+=d;c.bottom>h&&(c.top-=c.bottom-h,c.top<k&&(c.top=k));c.right>b&&(c.left-=c.right-b,c.left<g&&(c.left=g));c.height>a?(c.height=a-2,c.bottom=c.top+c.height,c.bScroll=!0):c.bScroll=!1;0>c.left&&(c.left=0);0>c.top&&(c.top=0);return c}}catch(e){dalert(e)}};this.setContextMenuRect=
function(a,c){try{if(!a||!c)return a;a.style.left=c.left+"px";a.style.top=c.top+"px";!0===c.bScroll?(a.style.height=c.height+"px",a.style.overflowY="scroll"):(a.style.height="",a.style.overflowY="");a.scrollTop=0;return a}catch(b){dalert(b)}};this.ShowContextMenuDisplayInEditArea=function(a,c,b,d){try{var h=g_objPositionUtil.getElementPosition(g_objEditObject[a],!1),k=h.right,g=h.bottom,e=this.objContextMenuLayer[d].offsetWidth,f=this.objContextMenuLayer[d].offsetHeight;c+e>k&&(this.objContextMenuLayer[d].style.left=
k-e+"px");b+f>g&&(this.objContextMenuLayer[d].style.top=g-f+"px")}catch(n){dalert(n)}}};
var g_strBackgroundImageURL=null,propTagCommon=function(){this.static_ctrl_width=76;this.spin_ctrl_width=62;this.fBodyLineHeight=1.8;this.setTxbxLineHeight=function(a){this.fBodyLineHeight=a};this.setStaticCtrlWidth=function(a,b){this.static_ctrl_width=a;this.spin_ctrl_width=b};propTagCommon.prototype.makeStaticSpinnerInputCtrl=function(a,b,c,e,d,f,g,h){try{var k=document.createElement("table");k.setAttribute("cellspacing","0");k.setAttribute("cellpadding","0");var l=k.insertRow(),m=l.insertCell();
m.setAttribute("width",g_objPropTagCommon.static_ctrl_width);m.innerHTML=a;if(!1===fnObjectCheckNull(h)){var p=l.insertCell();p.className="duzon_dialog_slider_container";p.appendChild(h)}l.insertCell().innerHTML=duzon_dialog.makeSpinnerInputForm(b,d,c,e,"",f);"undefined"!=typeof g&&null!=g&&""!=g&&(l.insertCell().innerHTML="&nbsp"+g);return k}catch(n){dalert(n)}};propTagCommon.prototype.makeStaticComboBoxCtrl=function(a,b,c,e,d,f){try{var g=document.createElement("table");g.setAttribute("cellspacing",
"0");g.setAttribute("cellpadding","0");var h=g.insertRow(),k=h.insertCell();k.setAttribute("width",g_objPropTagCommon.static_ctrl_width);k.innerHTML=a;var l=h.insertCell();if("undefined"!=typeof e){var m=document.createElement("select");m.id=b;m.name=b;m.className=c;var p=d.length;for(a=0;a<p;a++){var n=document.createElement("option");n.value=d[a];n.innerHTML=e[a];m.appendChild(n)}l.appendChild(m)}else{var q=g_objPropTagCommon.changeIDtoStr(b);switch(b){case TEXTBOX_GRAPHICATT_LINE_STYLE:g_objBorderComboBoxUtil.arrBorderStyle=
["solid","dotted","dashed"];g_objBorderComboBoxUtil.arrBorderWidth=["0","1","2"];l.innerHTML=g_objBorderComboBoxUtil.makeBorderComboBoxHTML(q,0,this.spin_ctrl_width,90);break;case TEXTBOX_TEXTATT_TEXT_COLOR:case TEXTBOX_GRAPHICATT_FILL_COLOR:case TEXTBOX_GRAPHICATT_LINE_COLOR:l.innerHTML=g_objColorComboBoxUtil.makeColorComboBoxHTML(q,this.spin_ctrl_width)}}"undefined"!=typeof f&&(h.insertCell().innerHTML="&nbsp"+f+"&nbsp");return g}catch(r){dalert(r)}};propTagCommon.prototype.makeCheckboxCtrl=function(a,
b,c,e){try{var d=document.createElement("div"),f=document.createElement("input"),g=document.createElement("label");d.appendChild(f);d.appendChild(g);f.setAttribute("type","checkbox");f.id=a;f.name=b;f.value=c;g.setAttribute("for",a);g.textContent=e;return d.innerHTML}catch(h){dalert(h)}};propTagCommon.prototype.makeRadioButtonCtrl=function(a,b,c,e,d){try{var f=document.createElement("div"),g=document.createElement("input"),h=document.createElement("label"),k=null,l=null,m=null;if(!1===fnObjectCheckNull(d)&&
0<d.length){f.appendChild(h);h.appendChild(g);g.style.display="none";k=document.createElement("table");l=document.createElement("img");m=document.createElement("span");k.setAttribute("cellspacing","0");k.setAttribute("cellpadding","0");var p=k.insertRow(),n=p.insertCell();n.style.height="55px";n.appendChild(l);p=k.insertRow();n=p.insertCell();n.appendChild(m);h.appendChild(k)}else f.appendChild(g),f.appendChild(h);g.setAttribute("type","radio");g.id=a;g.name=b;g.value=c;h.setAttribute("for",a);!1===
fnObjectCheckNull(k)?(l.className="duzon_dialog_img_radio_button_off",l.setAttribute("src",d),l.setAttribute("alt",e),m.style.fontSize="10pt",m.textContent=e):h.textContent=e;return f.innerHTML}catch(q){dalert(q)}};propTagCommon.prototype.makeSliderCtrl=function(a,b,c){try{var e=document.createElement("input");e.id=a;e.className="duzon_dialog_slider";e.type="range";e.min=b;e.max=c;e.value=0;!0===g_bBrowserType_IE&&(e.style.margin="-10px 0px");return e}catch(d){dalert(d)}};propTagCommon.prototype.makeContentsTitle=
function(a,b,c){try{var e=document.createElement("div");e.className=b;e.innerHTML=c;a.appendChild(e)}catch(d){dalert(d)}};propTagCommon.prototype.makeSeperateLine=function(a,b){try{var c=document.createElement("div");c.className=b;a.appendChild(c)}catch(e){dalert(e)}};propTagCommon.prototype.makeEmptyLine=function(a,b,c,e){try{!0===fnObjectCheckNull(b)&&(b=2);var d=a.insertRow().insertCell();d.colSpan=b;d.setAttribute("style",e)}catch(f){dalert(f)}};propTagCommon.prototype.getComboCtrlEle=function(a){return"object"==
typeof a?a.childNodes[0].childNodes[0].childNodes[1].childNodes[0]:null};propTagCommon.prototype.getSpinnerCtrlEle=function(a,b){return"object"==typeof a?a.childNodes[0].childNodes[0].childNodes[!0===b?2:1].childNodes[0].firstChild:null};this.sTextAttCtrlEle=[];this.sTextAttCtrlEle[DZE_TEXTATT_FONTNAME]=null;this.sTextAttCtrlEle[DZE_TEXTATT_FONTSIZE]=null;this.sTextAttCtrlEle[DZE_TEXTATT_FORECOLOR]=null;this.sTextAttCtrlEle[DZE_TEXTATT_BACKCOLOR]=null;this.sTextAttCtrlEle[DZE_TEXTATT_LETTERSPACING]=
null;this.sTextAttCtrlEle[DZE_TEXTATT_BITFLAG]=null;propTagCommon.prototype.makeGeneralTextAttContentsCtrl=function(a){try{g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_TEXTATT);var b=document.createElement("div"),c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");var e=c.insertRow(),d=e.insertCell();d.width="50%";var f=["Gothic","DuzonTitle",
"DuzonBody"],g=[ID_RES_COOMBOBOX_FONT_NAME_7,ID_RES_COOMBOBOX_FONT_NAME_6,"[\ub354\uc874] \ubcf8\ubb38\uccb4 30"],h=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_CONST_STRING_FONT_NAME+" : ","txBox_TextAtt_Facename","duzon_dialog_body_txbx_combo_selectform",g,f);this.sTextAttCtrlEle[DZE_TEXTATT_FONTNAME]=this.getComboCtrlEle(h);d.appendChild(h);d=e.insertCell();d.width="50%";h=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_FONT_SIZE+" : ","TextBoxTextSize",20,0,"");this.sTextAttCtrlEle[DZE_TEXTATT_FONTSIZE]=
this.getSpinnerCtrlEle(h);d.appendChild(h);g_objPropTagCommon.makeEmptyLine(c,2,4,"height:4px;");e=c.insertRow();d=e.insertCell();d.width="50%";f=["normal","italic","bold"];g=[ID_RES_DIALOG_STRING_NORMAL,ID_RES_CONST_STRING_ITALIC,ID_RES_CONST_STRING_BOLD];h=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_CONST_TEXTATT_STYLE+" : ","txBox_TextAtt","duzon_dialog_body_txbx_combo_selectform",g,f);this.sTextAttCtrlEle[DZE_TEXTATT_BITFLAG]=this.getComboCtrlEle(h);d.appendChild(h);d=e.insertCell();d.width=
"50%";h=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_CONST_STRING_FORE_COLOR+" : ",TEXTBOX_TEXTATT_TEXT_COLOR);this.sTextAttCtrlEle[DZE_TEXTATT_FORECOLOR]=this.getComboCtrlEle(h);d.appendChild(h);b.appendChild(c);a.appendChild(b)}catch(k){dalert(k)}};this.sObjAttCtrlEle=[];this.sObjAttCtrlEle[DZE_OBJATT_WIDTH]=null;this.sObjAttCtrlEle[DZE_OBJATT_HEIGHT]=null;this.sObjAttCtrlEle[DZE_OBJATT_INNER_MARGIN]=null;this.sObjAttCtrlEle[DZE_OBJATT_OUTER_MARGIN]=null;this.m_paraAttAlignCtrlEle=this.sObjAttCtrlEle[DZE_OBJATT_VALIGN]=
null;propTagCommon.prototype.makeGeneralAlignContentsCtrl=function(a){try{g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_ALIGN);var b=document.createElement("div"),c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");var e=c.insertRow(),d=e.insertCell();d.width="50%";var f=["left","center","right","justify"],g=[ID_RES_CONST_STRING_JUSTIFYLEFT,
ID_RES_CONST_STRING_JUSTIFYCENTER,ID_RES_CONST_STRING_JUSTIFYRIGHT,ID_RES_CONST_STRING_JUSTIFYJUSTIFY],h=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_CONST_STRING_ALIGN+" : ","txBox_ParaAtt_Align","duzon_dialog_body_txbx_combo_selectform",g,f);this.m_paraAttAlignCtrlEle=this.getComboCtrlEle(h);d.appendChild(h);d=e.insertCell();d.width="50%";f=["top","middle","bottom"];g=[ID_RES_PROP_TAG_STRING_ALIGN_TOP,ID_RES_PROP_TAG_STRING_ALIGN_MIDDLE,ID_RES_PROP_TAG_STRING_ALIGN_BOTTOM];h=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_CONST_VERTICAL_ALIGN+
" : ","txBox_ObjAtt_VAlign","duzon_dialog_body_txbx_combo_selectform",g,f);this.sObjAttCtrlEle[DZE_OBJATT_VALIGN]=this.getComboCtrlEle(h);d.appendChild(h);g_objPropTagCommon.makeEmptyLine(c,2,4,"height:4px;");b.appendChild(c);a.appendChild(b)}catch(k){dalert(k)}};this.m_TextContentsEditCtrlEle=null;propTagCommon.prototype.makeGeneralTextBoxContentsCtrl=function(a){try{g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_TEXTBOX);var b=document.createElement("div"),
c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");var e=c.insertRow(),d=e.insertCell();d.width="50%";var f=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_HORIZONTAL_WIDTH+" : ","TextBoxWidth",2E3,0,"","undefined","px");this.sObjAttCtrlEle[DZE_OBJATT_WIDTH]=this.getSpinnerCtrlEle(f);d.appendChild(f);d=e.insertCell();d.width="50%";f=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_VERTICAL_HEIGHT+
" : ","TextBoxHeight",2E3,0,"","undefined","px");this.sObjAttCtrlEle[DZE_OBJATT_HEIGHT]=this.getSpinnerCtrlEle(f);d.appendChild(f);g_objPropTagCommon.makeEmptyLine(c,2,4,"height:4px;");e=c.insertRow();d=e.insertCell();d.width="50%";f=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_INNER_MARGIN+" : ","TextBoxInnerMargin",5,0,"","undefined","px");this.sObjAttCtrlEle[DZE_OBJATT_INNER_MARGIN]=this.getSpinnerCtrlEle(f);d.appendChild(f);d=e.insertCell();d.width="50%";f=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_OUTER_MARGIN+
" : ","TextBoxOuterMargin",5,0,"","undefined","px");this.sObjAttCtrlEle[DZE_OBJATT_OUTER_MARGIN]=this.getSpinnerCtrlEle(f);d.appendChild(f);g_objPropTagCommon.makeEmptyLine(c,2,4,"height:4px;");e=c.insertRow();d=e.insertCell();d.colSpan=2;var g=this.makeTextInputCtrl();d.appendChild(g);b.appendChild(c);a.appendChild(b)}catch(h){dalert(h)}};propTagCommon.prototype.makeTextInputCtrl=function(){try{var a=document.createElement("table");a.setAttribute("cellspacing","0");a.setAttribute("cellpadding","0");
a.setAttribute("width","100%");a.setAttribute("style","border-collapse:collapse;");var b=a.insertRow(),c=b.insertCell();c.innerHTML=ID_RES_PROP_TEXTBOX_CONTENTS+" : ";c.width=this.static_ctrl_width+"px";c=b.insertCell();c.setAttribute("style","margin:0;padding:0;cellpadding:0;cellspacing:0;textAlign:left;");c.innerHTML='<input type="text" name="dze_edit_txbx_contents" id="idx_dze_txbx_contents" value="" size="50" class="dze_txbx_contents" tabindex="1">';this.m_TextContentsEditCtrlEle=c.childNodes[0];
return a}catch(e){dalert(e)}};this.sGraphicAttCtrlEle=[];this.sGraphicAttCtrlEle[DZE_GRAPHICATT_FILLCOLOR]=null;this.sGraphicAttCtrlEle[DZE_GRAPHICATT_LINESTYLE]=null;this.sGraphicAttCtrlEle[DZE_GRAPHICATT_LINECOLOR]=null;this.sGraphicAttCtrlEle[DZE_GRAPHICATT_LINEWIDTH]=null;propTagCommon.prototype.makeFillContentsCtrl=function(a){try{g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_PROP_TAG_STRING_FILL);var b=document.createElement("div"),c=document.createElement("table");
c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");var e=c.insertRow(),d=e.insertCell();d.width="50%";var f=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_PROP_TAG_STRING_COLOR+" : ",TEXTBOX_GRAPHICATT_FILL_COLOR);this.sGraphicAttCtrlEle[DZE_GRAPHICATT_FILLCOLOR]=this.getComboCtrlEle(f);d.appendChild(f);d=e.insertCell();d.width="50%";g_objPropTagCommon.makeEmptyLine(c,2,4,"height:4px;");b.appendChild(c);
a.appendChild(b)}catch(g){dalert(g)}};propTagCommon.prototype.makeLineContentsCtrl=function(a){try{g_objPropTagCommon.makeContentsTitle(a,"duzon_dialog_label_title",ID_RES_CONST_STRING_LINE);var b=document.createElement("div"),c=document.createElement("table");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");c.setAttribute("width","100%");c.setAttribute("style","border-collapse:collapse;");var e=c.insertRow(),d=e.insertCell();d.width="50%";d.setAttribute("style","vertical-align:top;");
var f=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_PROP_TAG_STRING_COLOR+" : ",TEXTBOX_GRAPHICATT_LINE_COLOR);this.sGraphicAttCtrlEle[DZE_GRAPHICATT_LINECOLOR]=this.getComboCtrlEle(f);d.appendChild(f);d=e.insertCell();d.width="50%";f=g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_CONST_STRING_LINE_WIDTH+" : ","TextBoxLineWidth",10,0,"px","g_objPropTagCommon.onChangeSpinnerValue");this.sGraphicAttCtrlEle[DZE_GRAPHICATT_LINEWIDTH]=this.getSpinnerCtrlEle(f);d.appendChild(f);g_objPropTagCommon.makeEmptyLine(f,
2,8,"height:8px;");e=c.insertRow();d=e.insertCell();f=g_objPropTagCommon.makeStaticComboBoxCtrl(ID_RES_CONST_STRING_LINE_STYLE+" : ",TEXTBOX_GRAPHICATT_LINE_STYLE);this.sGraphicAttCtrlEle[DZE_GRAPHICATT_LINESTYLE]=this.getComboCtrlEle(f);d.appendChild(f);b.appendChild(c);a.appendChild(b)}catch(g){dalert(g)}};propTagCommon.prototype.buildTagTable_TableRowColCount=function(a,b){try{a="undefined"!==typeof a&&null!==a?a:null;b="undefined"!==typeof b&&null!==b?b:"140";var c="";c+='<div class="duzon_dialog_label_title"'+
(a?' style="width:'+a+'px"':"")+">"+ID_RES_PROP_TAG_STRING_ROW_COL+"</div>";c+='<div class="duzon_dialog_row"'+(a?' style="width:'+a+'px"':"")+">";c+='<div class="duzon_dialog_row" style="width:'+b+'px;">';c+=ID_RES_PROP_TAG_STRING_ROW_NUM+duzon_dialog.makeSpinnerInputForm("txtTableRowCount","",20,0,"",70);c+="</div>";c+='<div class="duzon_dialog_row" style="width:'+b+'px;">';c+=ID_RES_PROP_TAG_STRING_COL_NUM+duzon_dialog.makeSpinnerInputForm("txtTableColCount","",20,0,"",70);return c+"</div></div>"}catch(e){dalert(e)}};
propTagCommon.prototype.buildTagTable_General=function(){try{var a="";a+=this.buildTagTable_TableRowColCount();a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SIZE_DEFINE+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_DIALOG_STRING_WIDTH+duzon_dialog.makeSpinnerInputForm("txtTableWidth","%",2E3,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';
a+=ID_RES_PROP_TAG_STRING_WIDTH_UNIT;a+='<input type="radio" id="rdoWidthUnit_Px" name="rdoWidthUnit" value="0" /><label for="rdoWidthUnit_Px">px</label>';a+='<input type="radio" id="rdoWidthUnit_Percentage" name="rdoWidthUnit" value="0" /><label for="rdoWidthUnit_Percentage">%</label>';a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_DIALOG_STRING_HEIGHT+duzon_dialog.makeSpinnerInputForm("txtTableHeight","  ",3E3,0);a+=
"</div>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_CONST_STRING_OUTER_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_LEFT+duzon_dialog.makeSpinnerInputForm("txtTableLeftMargin","px",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_TOP+duzon_dialog.makeSpinnerInputForm("txtTableTopMargin",
"px",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_RIGHT+duzon_dialog.makeSpinnerInputForm("txtTableRightMargin","px",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_BOTTOM+duzon_dialog.makeSpinnerInputForm("txtTableBottomMargin","px",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+
ID_RES_PROP_TAG_STRING_ALL_CELL_INNER_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_CONST_STRING_INNER_MARGIN+duzon_dialog.makeSpinnerInputForm("txtTableCellPadding","px",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_CONST_STRING_OUTER_MARGIN+duzon_dialog.makeSpinnerInputForm("txtTableCellSpacing","px",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';
a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_TABLE_ALIGN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_TABLE_ALIGN;a+='<select id="selTableAlign" name="selTableAlign" class="duzon_dialog_body_align_selectform" style="width:72px !important;">';a+='<option value="">'+ID_RES_DIALOG_STRING_NONE+"</option>";a+='<option value="left">'+ID_RES_PROP_TAG_STRING_LEFT+"</option>";a+='<option value="center">'+
ID_RES_PROP_TAG_STRING_CENTER+"</option>";a+='<option value="right">'+ID_RES_PROP_TAG_STRING_RIGHT+"</option>";a+="</select>";a+="</div>";a+="</div>";!0===dzeUiConfig.bUseReportForm&&(a+='<div class="duzon_dialog_label_separator"></div>',a+='<div class="duzon_dialog_label_title">'+ID_RES_CONST_STRING_EXTEND_FUNC+"</div>",a+='<div class="duzon_dialog_row">',a+='<div class="duzon_dialog_row" style="width:140px;">',a+="id<input type='text' name='dze_input_box_id' value='' id='id_dze_input_box_id' style='width: 80px;  height: 20px; padding: 0px 5px;'/>",
a+="</div>",a+='<div class="duzon_dialog_row" style="width:140px;">',a+="key<input type='text' name='dze_input_box_key' value='' id='id_dze_input_box_key' style='width: 80px; height: 20px; padding: 0px 5px;'/>",a+="</div>",a+="</div>");return a}catch(b){dalert(b)}};propTagCommon.prototype.buildTagCommon_Border=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_DIALOG_TAB_BORDER+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_SIZE+" : </td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtBorderWidth","px",10,0,"")+"</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_FORM_TYPE+" : </td>";a+="<td>";a+=g_objBorderComboBoxUtil.makeBorderComboBoxHTML("selBorderStyle",
0,70,90);a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2">';a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="46">'+ID_RES_DIALOG_STRING_FORM_COLOR+" : </td>";a+="<td>";a+=g_objColorComboBoxUtil.makeColorComboBoxHTML("txtBorderColor",70);a+="</td>";a+="</tr>";a+="<tr>";a+='<td colspan="2" style="padding-top:5px;"><input type="checkbox" id="dze_idx_table_bordercollapse" checked><label for="dze_idx_table_bordercollapse">'+ID_RES_CONST_STRING_TABLE_COLLAPSE+"</label></td>";
a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td style="text-align:center;">';a+=g_objBorderSelectionUtil.makeBorderSelectionHTML(0,16,24,!0);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};propTagCommon.prototype.buildTagCommon_Background=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_FILL+"</div>";a+=
"<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="14"></td>';a+='<td><input type="radio" id="rdoBackgroundColorUseNo" name="rdoBackgroundColorUseYN" value="0" checked /><label for="rdoBackgroundColorUseNo">'+ID_RES_PROP_TAG_STRING_NO_COLOR_FILL+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+=
"</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="14"></td>';a+='<td><input type="radio" id="rdoBackgroundColorUseYes" name="rdoBackgroundColorUseYN" value="1" /><label for="rdoBackgroundColorUseYes">'+ID_RES_PROP_TAG_STRING_COLOR+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_FACE_COLOR+"</td>";a+="<td>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("txtBackgroundColor",150)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_IMAGE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="14"></td>';a+='<td><input type="checkbox" id="chkBackgroundImageUseYN" name="chkBackgroundImageUseYN" value="0" /><label for="chkBackgroundImageUseYN">'+ID_RES_PROP_TAG_STRING_USER_IMAGE+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:8px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';
a+='<form name="frmImageFileUpload" method="post" enctype="multipart/form-data" target="ifrmImageFileUploadTarget" action="'+dzeEnvConfig.strUploadImageURL+'">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_IMAGE_FILE+"</td>";a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+=duzon_dialog.makeExtFileForm("dze_upimage_file","fileBackgroundImage",
"250px",[".png",".jpg",".gif"]);a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+='<tr><td colspan="3" height="5"></td></tr>';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100"></td>';a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+='<input type="text" id="txtReadBackgroundImageURL" name="txtReadBackgroundImageURL" class="duzon_dialog_body_urlform" style="width:248px !important;" disabled value="" />';
a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</form>";a+='<iframe name="ifrmImageFileUploadTarget" id="ifrmImageFileUploadTarget" style="width:;height:;display:none;"></iframe>';a+="</td>";a+="</tr>";a+="<tr>";a+="<td>";a+='<div style="height:5px;"></div>';a+="</td>";a+="</tr>";a+="<tr>";a+='<td width="100%" style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="30"></td>';a+='<td width="100">'+ID_RES_PROP_TAG_STRING_FILL_TYPE+
"</td>";a+="<td>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="100%">';a+='<select id="selBackgroundRepeat" name="selBackgroundRepeat" style="width:100%;">';a+='<option value="repeat">'+ID_RES_PROP_TAG_STRING_REPEAT+"</option>";a+='<option value="repeat-x">'+ID_RES_PROP_TAG_STRING_REPEAT_HOR+"</option>";a+='<option value="repeat-y">'+ID_RES_PROP_TAG_STRING_REPEAT_VER+"</option>";a+='<option value="no-repeat">'+ID_RES_PROP_TAG_STRING_REPEAT_NO+"</option>";
a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};propTagCommon.prototype.buildTagCommon_Madang=function(){return"undefined"!==typeof TableStyleDlg?TableStyleDlg.getContent({width:406,height:286,col:4,itemMargin:10,padding:0,bAddNone:!0}):""};propTagCommon.prototype.onChangeImgSrc=function(){try{var a=g_objLayerKit.getLayerDocument().forms.frmImageFileUpload.dze_upimage_file.files;duzon_http.showLoading();
checkValidImgFile(a,function(a,c,e,d){duzon_http.hideLoading();0<d.length?(g_strBackgroundImageURL=null,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="",cmnMsg.showMsgArray(null,d,null)):this.uploadImageFile()}.bind(this))}catch(b){dalert(b)}};propTagCommon.prototype.uploadImageFile=function(){try{var a=g_objLayerKit.getLayerDocument().forms.frmImageFileUpload;g_strBackgroundImageURL=null;g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="";var b=a.dze_upimage_file.files;
!b||0>=b.length||uploadImg(g_nActiveEditNumber,a,g_objPropTagCommon.uploadImageFileDone,2)}catch(c){dalert(c)}};propTagCommon.prototype.uploadImageFileDone=function(a){try{if(a&&"success"==a.result){g_objPropTagCommon.setSelectedTableCustomStyle();var b=a.url;if(b&&Array.isArray(b))if(0<b.length)b=b[0];else return;g_strBackgroundImageURL=b=b.replace("&amp;","&");g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=b}else alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),g_strBackgroundImageURL=null,
g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=""}catch(c){g_strBackgroundImageURL=null,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value="",dalert(c)}};propTagCommon.prototype.onChangeSpinnerValue=function(a){try{g_objBorderSelectionUtil.setBorderWidth(a)}catch(b){dalert(b)}};propTagCommon.prototype.getSelectedTableStyle=function(){return"undefined"!==typeof TableStyleDlg?TableStyleDlg.getSelectedIndex():-1};propTagCommon.prototype.setSelectedTableCustomStyle=function(){return"undefined"!==
typeof TableStyleDlg?TableStyleDlg.selectNone():-1};propTagCommon.prototype.changeIDtoStr=function(a){switch(a){case TEXTBOX_GRAPHICATT_FILL_COLOR:a="TextBoxFillColor";break;case TEXTBOX_GRAPHICATT_LINE_COLOR:a="TextBoxLineColor";break;case TEXTBOX_GRAPHICATT_LINE_STYLE:a="TextBoxLineStyle";break;default:case TEXTBOX_TEXTATT_TEXT_COLOR:a="TextBoxTextColor"}return a};propTagCommon.prototype.changeParaAttAlignToStr=function(a){switch(a){default:case PARAATT_ALIGN_LEFT:a="left";break;case PARAATT_ALIGN_CENTER:a=
"center";break;case PARAATT_ALIGN_RIGHT:a="right";break;case PARAATT_ALIGN_JUSTIFY:a="justify"}return a};propTagCommon.prototype.changeParaAttAlignToIdx=function(a){switch(a){default:case "start":case "left":a=PARAATT_ALIGN_LEFT;break;case "center":a=PARAATT_ALIGN_CENTER;break;case "end":case "right":a=PARAATT_ALIGN_RIGHT;break;case "justify":a=PARAATT_ALIGN_JUSTIFY}return a};propTagCommon.prototype.changeObjAttAlignToStr=function(a,b){b=0;var c="";switch(a){case OBJATT_ALIGN_BASIC:break;default:case OBJATT_ALIGN_LEFT:c=
"margin-left:"+b+"px;margin-right:auto;";break;case OBJATT_ALIGN_CENTER:c="margin-left:auto;margin-right:auto;";break;case OBJATT_ALIGN_RIGHT:c="margin-left:auto;margin-right: "+b+"px;"}return c};propTagCommon.prototype.changeObjAttAlignToIdx=function(a){var b="";switch(a){case OBJATT_ALIGN_BASIC:break;default:case "margin-left:0px;margin-right:auto;":b=OBJATT_ALIGN_LEFT;break;case "margin-left:auto;margin-right:auto;":b=OBJATT_ALIGN_CENTER;break;case "margin-left:auto;margin-right:0px;":b=OBJATT_ALIGN_RIGHT}return b};
propTagCommon.prototype.changeObjAttVAlignToStr=function(a){switch(a){case OBJATT_VALIGN_TOP:a="top";break;case OBJATT_VALIGN_MIDDLE:a="middle";break;default:case OBJATT_VALIGN_BOTTOM:a="bottom"}return a};propTagCommon.prototype.changeObjAttVAlignToIdx=function(a){switch(a){default:case "top":a=OBJATT_VALIGN_TOP;break;case "middle":a=OBJATT_VALIGN_MIDDLE;break;case "bottom":a=OBJATT_VALIGN_BOTTOM}return a};propTagCommon.prototype.changeTextStyleToStr=function(a){var b="";switch(a){case "italic":b=
"font-style:italic";break;case "bold":b="font-weight:bold"}return b};propTagCommon.prototype.changeFontNameToIdx=function(a){switch(a){default:case "\ub9d1\uc740 \uace0\ub515":a=0;break;case "\uad81\uc11c":a=1;break;case "[\ub354\uc874] \ubcf8\ubb38\uccb4 30":a=2}return a};propTagCommon.prototype.getBorderStyle_Normal=function(a){var b=BORDER_STYLE_GRAPHIC.SOLID;switch(a){case 0:b=BORDER_STYLE_NORMAL.SOLID;break;case 1:b=BORDER_STYLE_NORMAL.DASH;break;case 2:b=BORDER_STYLE_NORMAL.DOT;break;case 3:b=
BORDER_STYLE_NORMAL.DOUBLE}return b};propTagCommon.prototype.getBorderStyle_Graphic=function(a){var b=BORDER_STYLE_GRAPHIC.SOLID;switch(a){case 0:b=BORDER_STYLE_GRAPHIC.SOLID;break;case 1:b=BORDER_STYLE_GRAPHIC.DASH;break;case 2:b=BORDER_STYLE_GRAPHIC.DOT;break;case 3:b=BORDER_STYLE_GRAPHIC.DOUBLE}return b};propTagCommon.prototype.getBorderStyleIndex=function(a){var b=0;switch(a){case BORDER_STYLE_GRAPHIC.SOLID:case BORDER_STYLE_NORMAL.SOLID:b=0;break;case BORDER_STYLE_GRAPHIC.DASH:case BORDER_STYLE_NORMAL.DASH:b=
1;break;case BORDER_STYLE_GRAPHIC.DOT:case BORDER_STYLE_NORMAL.DOT:b=2;break;case BORDER_STYLE_GRAPHIC.DOUBLE:case BORDER_STYLE_NORMAL.DOUBLE:b=3}return b}},g_objPropTagCommon=new propTagCommon;
var propTagSelect=function(){var g=this;this.objInputDisplayContainer=this.objSelectDisplayCount=this.objSelectElement=null;this.nMaxCount=50;propTagSelect.prototype.buildTagSelect=function(){try{var a="";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%">';a+='<div class="duzon_dialog_label_title" style="margin-top:6px;">'+ID_RES_PROP_TAG_LIST_NUM+"</div>";a+="</td>";a+='<td width="50%" style="text-align:center;">';
a+='<select id="selectDisplayCount">';a+="</select>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_LIST_CONTENT+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="inputDisplayContainer" style="text-align:center;padding:0px;">';a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:280px;"></div>'}catch(c){dalert(c)}};
propTagSelect.prototype.initPropTagSelect=function(a){try{if(null!=a&&(this.objSelectElement=a,this.objSelectDisplayCount=g_objLayerKit.getElementById("selectDisplayCount"),null!=this.objSelectDisplayCount&&(this.objSelectDisplayCount.onchange=function(a){g.changeDisplayInfo()},this.objInputDisplayContainer=g_objLayerKit.getElementById("inputDisplayContainer"),null!=this.objInputDisplayContainer))){this.drawDisplayContent(this.nMaxCount,this.objSelectDisplayCount,this.objInputDisplayContainer);var c=
a.options.length;this.setupDisplayCount(c,this.objSelectDisplayCount);this.setupDisplayContent(this.nMaxCount,c);this.assignDisplayContent(this.nMaxCount,a)}}catch(b){dalert(b)}};propTagSelect.prototype.drawDisplayContent=function(a,c,b){try{for(var d=0;d<a;d++)g_objNodeUtil.addOptionForSelectBox(c,d,d+1);for(d=0;d<a;d++){var e=document.createElement("div");e.style.marginTop="4px";e.style.marginBottom="4px";e.id="inputContainer_"+d;var f=document.createElement("input");f.setAttribute("type","text");
f.style.width="90%";f.id="inputContent_"+d;e.appendChild(f);b.appendChild(e)}}catch(h){dalert(h)}};propTagSelect.prototype.setupDisplayCount=function(a,c){try{for(var b=0;b<c.options.length;b++)if(a-1==c.options[b].value){c.selectedIndex=b;break}}catch(d){dalert(d)}};propTagSelect.prototype.setupDisplayContent=function(a,c){try{for(var b=0;b<a;b++)if(b<c){var d=g_objLayerKit.getElementById("inputContainer_"+b);d.style.display=""}else d=g_objLayerKit.getElementById("inputContainer_"+b),d.style.display=
"none"}catch(e){dalert(e)}};propTagSelect.prototype.assignDisplayContent=function(a,c){try{for(var b=0;b<c.options.length;b++)if(b<a)g_objLayerKit.getElementById("inputContent_"+b).value=c.options[b].text;else break}catch(d){dalert(d)}};propTagSelect.prototype.changeDisplayInfo=function(){try{var a=this.objSelectDisplayCount.selectedIndex+1;this.setupDisplayCount(a,this.objSelectDisplayCount);this.setupDisplayContent(this.nMaxCount,a)}catch(c){dalert(c)}};propTagSelect.prototype.applyDisplayInfo=
function(){try{for(;0<this.objSelectElement.options.length;)this.objSelectElement.removeChild(this.objSelectElement.options[0]);for(var a=this.objSelectDisplayCount.selectedIndex+1,c=0;c<a;c++){var b=g_objLayerKit.getElementById("inputContent_"+c).value;g_objNodeUtil.addOptionForSelectBox(this.objSelectElement,"",b)}}catch(d){dalert(d)}}},g_objPropTagSelect=new propTagSelect;
var propTagTableCreate=function(){propTagTableCreate.prototype.buildTagTextBox_General=function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_medium";g_objPropTagCommon.makeGeneralTextAttContentsCtrl(a);g_objPropTagCommon.makeSeperateLine(a,"duzon_dialog_label_separator");g_objPropTagCommon.makeGeneralAlignContentsCtrl(a);g_objPropTagCommon.makeSeperateLine(a,"duzon_dialog_label_separator");g_objPropTagCommon.makeGeneralTextBoxContentsCtrl(a);return a}catch(b){dalert(b)}};
propTagTableCreate.prototype.buildTagCommon_Fill_Line=function(){try{var a=document.createElement("div");a.className="duzon_dialog_content_medium";g_objPropTagCommon.makeFillContentsCtrl(a);g_objPropTagCommon.makeSeperateLine(a,"duzon_dialog_label_separator");g_objPropTagCommon.makeLineContentsCtrl(a);return a}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreate_General=function(){try{var a="";return a+=g_objPropTagCommon.buildTagTable_General()}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreate_Border=
function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreate_Background=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Background()}catch(b){dalert(b)}};propTagTableCreate.prototype.buildTagTableCreate_Madang=function(){return g_objPropTagCommon.buildTagCommon_Madang()};propTagTableCreate.prototype.buildTagTableCreateCommon=function(){return'<div style="height:1px;width:365px;"></div>'};propTagTableCreate.prototype.initPropTagTableCreate=
function(){try{g_strBackgroundImageURL=null;duzon_dialog.modifySpinnerValue("txtTableRowCount",100,1,5,"");duzon_dialog.modifySpinnerValue("txtTableColCount",100,1,4,"");duzon_dialog.modifySpinnerValue("txtTableWidth",2E3,0,100,"");duzon_dialog.modifySpinnerValue("txtTableHeight",3E3,0,"auto","");duzon_dialog.modifySpinnerValue("txtTableLeftMargin",100,-100,0,"");duzon_dialog.modifySpinnerValue("txtTableTopMargin",100,-100,0,"");duzon_dialog.modifySpinnerValue("txtTableRightMargin",100,-100,0,"");
duzon_dialog.modifySpinnerValue("txtTableBottomMargin",100,-100,0,"");duzon_dialog.modifySpinnerValue("txtTableCellPadding",100,0,3,"");duzon_dialog.modifySpinnerValue("txtTableCellSpacing",100,0,0,"");duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,1,"g_objPropTagCommon.onChangeSpinnerValue");duzon_dialog.setEnableSpinner("txtTableHeight",!1);var a=g_objLayerKit.getElementById("rdoWidthUnit_Px"),b=g_objLayerKit.getElementById("rdoWidthUnit_Percentage");b.checked=!0;a.addEventListener("change",
function(){var a=DzeSpinner.getSpinner("txtTableWidth");a&&a.unit&&(a.unit.innerHTML="px")});b.addEventListener("change",function(){var a=DzeSpinner.getSpinner("txtTableWidth");a&&a.unit&&(a.unit.innerHTML="%")});g_objLayerKit.getElementById("selTableAlign").selectedIndex=0;g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)});g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,1);g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",
function(a){g_objBorderSelectionUtil.setBorderColor(a)});g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.initBorderSelection();g_objBorderSelectionUtil.setBorderWidth(g_objLayerKit.getElementById("txtBorderWidth").value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));g_objBorderSelectionUtil.setChecked("miniRec_v_0",
!0);g_objBorderSelectionUtil.setChecked("miniRec_v_1",!0);g_objBorderSelectionUtil.setChecked("miniRec_v_2",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_1",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0);g_objBorderSelectionUtil.updateSelectRec();g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor");g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1);g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff");
g_objLayerKit.getElementById("rdoBackgroundColorUseNo").onclick=function(){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)};g_objLayerKit.getElementById("rdoBackgroundColorUseYes").onclick=function(){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)};duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.onChangeImgSrc()});duzon_dialog.disableImageUrlForm("txtReadBackgroundImageURL");duzon_dialog.disableExtFileForm("fileBackgroundImage");var c=g_objLayerKit.getElementById("selBackgroundRepeat");
c.onchange=function(){g_objPropTagCommon.setSelectedTableCustomStyle()};c.disabled=!0;g_objLayerKit.getElementById("chkBackgroundImageUseYN").onclick=function(){g_objPropTagCommon.setSelectedTableCustomStyle();this.checked?(duzon_dialog.enableExtFileForm("fileBackgroundImage"),c.disabled=!1):(duzon_dialog.disableExtFileForm("fileBackgroundImage"),c.disabled=!0)}}catch(d){dalert(d)}};propTagTableCreate.prototype.resetPropTagTableCreate=function(){try{g_strBackgroundImageURL=null;g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",
COMBOBOX_TYPE_BORDER_STYLE,0);g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.setBorderWidth(g_objLayerKit.getElementById("txtBorderWidth").value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));g_objBorderSelectionUtil.setChecked("miniRec_v_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_v_1",!0);
g_objBorderSelectionUtil.setChecked("miniRec_v_2",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_0",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_1",!0);g_objBorderSelectionUtil.setChecked("miniRec_h_2",!0);g_objBorderSelectionUtil.updateSelectRec();g_objLayerKit.getElementById("rdoBackgroundColorUseNo").checked=!0;g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1);g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff");g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked=
!1;g_objLayerKit.getElementById("fileBackgroundImage").disabled=!0;var a=g_objLayerKit.getElementById("selBackgroundRepeat");a.selectedIndex=0;a.disabled=!0}catch(b){dalert(b)}};propTagTableCreate.prototype.getPropSettingData=function(){try{var a=[],b=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableRowCount").value);if(null==b)return null;var c=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableColCount").value);if(null==c)return null;var d=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableWidth").value),
g=g_objLayerKit.getElementById("rdoWidthUnit_Px").checked?"":"%",h=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableLeftMargin").value),k=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableTopMargin").value),l=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableRightMargin").value),m=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableBottomMargin").value),n=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableCellPadding").value),
p=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableCellSpacing").value),q=g_objLayerKit.getElementById("dze_idx_table_bordercollapse").checked,r=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0"),t=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),u=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2"),v=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0"),w=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),x=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2"),
e=null;g_objLayerKit.getElementById("rdoBackgroundColorUseYes").checked&&(e=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));var f=null;g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked&&(f=g_strBackgroundImageURL);var y=g_objLayerKit.getElementById("selBackgroundRepeat").value,z=g_objLayerKit.getElementById("selTableAlign").value,A=g_objPropTagCommon.getSelectedTableStyle();a[0]=b;a[1]=c;a[2]=d;a[3]=g;a[4]=null;a[5]="";a[6]=n;a[7]=r;a[8]=t;a[9]=u;a[10]=v;a[11]=w;a[12]=x;
a[13]=e;a[14]=f;a[15]=y;a[16]=z;a[17]=A;a[18]=h;a[19]=k;a[20]=l;a[21]=m;a[22]=p;a[23]=q;return a}catch(B){dalert(B)}return null};propTagTableCreate.prototype.initPropTagTableCreateSimple=function(){try{duzon_dialog.modifySpinnerValue("txtTableRowCount",100,1,5,""),duzon_dialog.modifySpinnerValue("txtTableColCount",100,1,4,"")}catch(a){dalert(a)}};propTagTableCreate.prototype.getPropSettingDataSimple=function(){try{var a=[],b=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableRowCount").value);
if(null==b)return null;var c=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableColCount").value);if(null==c)return null;a[0]=b;a[1]=c;return a}catch(d){dalert(d)}return null}},g_objPropTagTableCreate=new propTagTableCreate;
var g_objPropTagTable=new function(){this.objTableInfo=null;this.nEditNumber=0;this.arrInitBorderAttribute=this.arrInitTableAttribute=null;this.nTableMaxWidth=2E3;this.nTableMaxPercentWidth=400;this.buildTagTextBox_General=function(){try{var a="";return a+=g_objPropTagCommon.buildTagTextBox_General()}catch(b){dalert(b)}};this.buildTagCommon_Fill_Line=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Fill_Line()}catch(b){dalert(b)}};this.buildTagTable_General=function(){try{var a=
"";return a+=g_objPropTagCommon.buildTagTable_General()}catch(b){dalert(b)}};this.buildTagTable_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(b){dalert(b)}};this.buildTagTable_Background=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Background()}catch(b){dalert(b)}};this.buildTagTable_Madang=function(){return g_objPropTagCommon.buildTagCommon_Madang()};this.buildTagTableCommon=function(){return'<div style="height:1px;width:365px;"></div>'};
this.initPropTagTable=function(a,b){try{g_strBackgroundImageURL=null;this.objTableInfo=a;this.nEditNumber=b;this.arrInitBorderAttribute=this.arrInitTableAttribute=null;duzon_dialog.modifySpinnerValue("txtTableRowCount",20,0,"","");duzon_dialog.modifySpinnerValue("txtTableColCount",20,0,"","");this.nTableMaxWidth=2E3;this.nTableMaxPercentWidth=400;duzon_dialog.modifySpinnerValue("txtTableWidth",this.nTableMaxWidth,0,"","");duzon_dialog.modifySpinnerValue("txtTableHeight",3E3,0,"auto","");duzon_dialog.modifySpinnerValue("txtTableLeftMargin",
100,-100,"0","");duzon_dialog.modifySpinnerValue("txtTableTopMargin",100,-100,"0","");duzon_dialog.modifySpinnerValue("txtTableRightMargin",100,-100,"0","");duzon_dialog.modifySpinnerValue("txtTableBottomMargin",100,-100,"0","");duzon_dialog.modifySpinnerValue("txtTableCellPadding",100,0,"3","");duzon_dialog.modifySpinnerValue("txtTableCellSpacing",100,0,"0","");duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,1,"g_objPropTagCommon.onChangeSpinnerValue");var e=g_objLayerKit.getElementById("rdoWidthUnit_Px"),
f=g_objLayerKit.getElementById("rdoWidthUnit_Percentage"),k=this;e.addEventListener("change",function(){k.onRadioChange(this)});f.addEventListener("change",function(){k.onRadioChange(this)});duzon_dialog.setEnableSpinner("txtTableHeight",!1);g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)});g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,1);g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",
function(a){g_objBorderSelectionUtil.setBorderColor(a)});g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.initBorderSelection();g_objBorderSelectionUtil.setBorderWidth(g_objLayerKit.getElementById("txtBorderWidth").value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor");
g_objLayerKit.getElementById("rdoBackgroundColorUseNo").onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)};g_objLayerKit.getElementById("rdoBackgroundColorUseYes").onclick=function(a){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)};duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.onChangeImgSrc()});duzon_dialog.disableImageUrlForm("txtReadBackgroundImageURL");duzon_dialog.disableExtFileForm("fileBackgroundImage");var d=g_objLayerKit.getElementById("selBackgroundRepeat");
d.onchange=function(){g_objPropTagCommon.setSelectedTableCustomStyle()};g_objLayerKit.getElementById("chkBackgroundImageUseYN").onclick=function(a){g_objPropTagCommon.setSelectedTableCustomStyle();this.checked?(duzon_dialog.enableExtFileForm("fileBackgroundImage"),d.disabled=!1):(duzon_dialog.disableExtFileForm("fileBackgroundImage"),d.disabled=!0)};if(a){var n=a.rows.length,r=g_objTableUtil.getTableMaxColSpanCount(a);g_objLayerKit.getElementById("txtTableRowCount").value=n;g_objLayerKit.getElementById("txtTableColCount").value=
r;duzon_dialog.setEnableSpinner("txtTableRowCount",!1);duzon_dialog.setEnableSpinner("txtTableColCount",!1);var c=g_objNodeUtil.getNodeWidthHeight(a,!0);b="";var l=DzeSpinner.getSpinner("txtTableWidth");""==c.strUnit||"px"==c.strUnit?(""!=c.nValue&&null!=c.nValue&&(g_objLayerKit.getElementById("txtTableWidth").value=c.nValue,l&&(l.unit.innerHTML="px",l.min=0,l.max=this.nTableMaxWidth)),g_objLayerKit.getElementById("rdoWidthUnit_Px").checked=!0):"%"==c.strUnit?(""!=c.nValue&&null!=c.nValue&&(g_objLayerKit.getElementById("txtTableWidth").value=
c.nValue,l&&(l.unit.innerHTML="%",l.min=0,l.max=this.nTableMaxPercentWidth)),g_objLayerKit.getElementById("rdoWidthUnit_Percentage").checked=!0,b="%"):g_objLayerKit.getElementById("rdoWidthUnit_Px").checked=!0;var u=g_objTableUtil.getTableMargin(a);g_objLayerKit.getElementById("txtTableLeftMargin").value=u.left;g_objLayerKit.getElementById("txtTableTopMargin").value=u.top;g_objLayerKit.getElementById("txtTableRightMargin").value=u.right;g_objLayerKit.getElementById("txtTableBottomMargin").value=u.bottom;
var v=g_objTableUtil.getTableCellPadding(a);g_objLayerKit.getElementById("txtTableCellPadding").value=v;var y=g_objTableUtil.getTableCellSpacing(a);g_objLayerKit.getElementById("txtTableCellSpacing").value=y;var g=g_objTableUtil.getTableBorderCollapse(a);g_objLayerKit.getElementById("dze_idx_table_bordercollapse").checked=g;var w=g_objTableUtil.getAlignTableByStyleProperty(a);g_objLayerKit.getElementById("selTableAlign").selectedIndex=w;if(!0===dzeUiConfig.bUseReportForm){var p=a.getAttribute("id"),
q=a.getAttribute("mapping_key");if(!0===fnObjectCheckNull(p)||0===p.length)p="";if(!0===fnObjectCheckNull(q)||0===q.length)q="";g_objLayerKit.getElementById("id_dze_input_box_id").value=p;g_objLayerKit.getElementById("id_dze_input_box_key").value=q}var t=g_objTableFunction.getCellBorderAttribute(a,!1);this.arrInitBorderAttribute=t[1].slice();g_objBorderSelectionUtil.initPropTagTableCellStyleBorder(t);var h=a.style.backgroundColor;null==h||""==h?(h=null,g_objLayerKit.getElementById("rdoBackgroundColorUseNo").checked=
!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","#ffffff")):(h=g_objCommonUtil.getHexColorCode(h),g_objLayerKit.getElementById("rdoBackgroundColorUseYes").checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",h));var m=g_objPropertyUtil.getBackgroundImageURL(a);c=null;null==m||""==m?(m=null,g_objLayerKit.getElementById("fileBackgroundImage").disabled=!0,g_objLayerKit.getElementById("selBackgroundRepeat").disabled=
!0):(g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked=!0,g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=m,c=a.style.backgroundRepeat,d=g_objLayerKit.getElementById("selBackgroundRepeat"),"repeat"==c?d.selectedIndex=0:"repeat-x"==c?d.selectedIndex=1:"repeat-y"==c?d.selectedIndex=2:"no-repeat"==c&&(d.selectedIndex=3),duzon_dialog.enableExtFileForm("fileBackgroundImage"));this.arrInitTableAttribute=[];this.arrInitTableAttribute[ID_PROP_NODE_BORDER]=null;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]=
h;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE]=[m,c];this.arrInitTableAttribute[ID_PROP_NODE_GENERAL]=[g_objLayerKit.getElementById("txtTableWidth").value,b,v,g_objLayerKit.getElementById("txtTableLeftMargin").value,g_objLayerKit.getElementById("txtTableTopMargin").value,g_objLayerKit.getElementById("txtTableRightMargin").value,g_objLayerKit.getElementById("txtTableBottomMargin").value]}}catch(x){dalert(x)}};this.resetPropTagTable=function(){try{if(this.arrInitBorderAttribute=this.arrInitTableAttribute=
g_strBackgroundImageURL=null,g_objLayerKit.getElementById("txtBorderWidth").value=1,g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,0),g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000"),g_objBorderSelectionUtil.setBorderWidth(g_objLayerKit.getElementById("txtBorderWidth").value),g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0)),g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor")),
duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.uploadImageFile()}),this.objTableInfo){var a=this.objTableInfo.rows.length,b=g_objTableUtil.getTableMaxColSpanCount(this.objTableInfo);g_objLayerKit.getElementById("txtTableRowCount").value=a;g_objLayerKit.getElementById("txtTableColCount").value=b;duzon_dialog.setEnableSpinner("txtTableRowCount",!1);duzon_dialog.setEnableSpinner("txtTableColCount",!1);var e=g_objTableFunction.getCellBorderAttribute(this.objTableInfo,
!1);this.arrInitBorderAttribute=e[1].slice();var f=e[0][0],k=e[0][1];f||k?!f&&k?g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"):f&&!k&&g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"):(g_objBorderSelectionUtil.hideMiniRec("miniRec_h_1"),g_objBorderSelectionUtil.hideMiniRec("miniRec_v_1"));g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_h_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_h_2",
!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_0",!1,"");g_objBorderSelectionUtil.bHide_MiniRec_v_1||g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_1",!1,"");g_objBorderSelectionUtil.setChecked_borderValue("miniRec_v_2",!1,"");g_objBorderSelectionUtil.updateSelectRec();var d=this.objTableInfo.style.backgroundColor;null==d||""==d?(d=null,g_objLayerKit.getElementById("rdoBackgroundColorUseNo").checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",
"#ffffff")):(d=g_objCommonUtil.getHexColorCode(d),g_objLayerKit.getElementById("rdoBackgroundColorUseYes").checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",d));var n=g_objPropertyUtil.getBackgroundImageURL(this.objTableInfo);a=null;if(null==n||""==n)n=null,g_objLayerKit.getElementById("fileBackgroundImage").disabled=!0,g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked=!1,g_objLayerKit.getElementById("selBackgroundRepeat").disabled=
!0,g_objLayerKit.getElementById("selBackgroundRepeat").selectedIndex=0;else{g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked=!0;g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=n;a=this.objTableInfo.style.backgroundRepeat;var r=g_objLayerKit.getElementById("selBackgroundRepeat");"repeat"==a?r.selectedIndex=0:"repeat-x"==a?r.selectedIndex=1:"repeat-y"==a?r.selectedIndex=2:"no-repeat"==a&&(r.selectedIndex=3)}this.arrInitTableAttribute=[];this.arrInitTableAttribute[ID_PROP_NODE_BORDER]=
null;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]=d;this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE]=[n,a]}}catch(c){dalert(c)}};this.getPropSettingData=function(){try{var a=[],b=parseFloat(g_objLayerKit.getElementById("txtTableWidth").value),e=g_objLayerKit.getElementById("rdoWidthUnit_Px").checked?"px":"%",f=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableLeftMargin").value),k=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableTopMargin").value),
d=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableRightMargin").value),n=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableBottomMargin").value),r=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableCellPadding").value),c=g_objCommonUtil.getNumberValue(g_objLayerKit.getElementById("txtTableCellSpacing").value),l=g_objLayerKit.getElementById("dze_idx_table_bordercollapse").checked,u=g_objLayerKit.getElementById("selTableAlign").value;a[ID_PROP_NODE_GENERAL]=
[b,e,r,u,f,k,d,n,c,l];if(!0===dzeUiConfig.bUseReportForm){var v=g_objLayerKit.getElementById("id_dze_input_box_id").value,y=g_objLayerKit.getElementById("id_dze_input_box_key").value;a[ID_PROP_NODE_GENERAL].push(v);a[ID_PROP_NODE_GENERAL].push(y)}b=!0;var g=g_objBorderSelectionUtil.bHide_MiniRec_h_1?!1:!0,w=g_objBorderSelectionUtil.bHide_MiniRec_v_1?!1:!0,p=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0");""===p&&(p=ID_PROP_BORDER_DUPLICATED);e="";g&&(e=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),
""===e&&(e=ID_PROP_BORDER_DUPLICATED));var q=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2");""===q&&(q=ID_PROP_BORDER_DUPLICATED);var t=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0");""===t&&(t=ID_PROP_BORDER_DUPLICATED);f="";w&&(f=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),""===f&&(f=ID_PROP_BORDER_DUPLICATED));var h=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2");""===h&&(h=ID_PROP_BORDER_DUPLICATED);p==this.arrInitBorderAttribute[0]&&e==this.arrInitBorderAttribute[1]&&
q==this.arrInitBorderAttribute[2]&&t==this.arrInitBorderAttribute[3]&&f==this.arrInitBorderAttribute[4]&&h==this.arrInitBorderAttribute[5]&&(b=!1);a[ID_PROP_NODE_BORDER]=[b,!0,g,!0,!0,w,!0,p,e,q,t,f,h];g=null;g_objLayerKit.getElementById("rdoBackgroundColorUseYes").checked&&(g=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"));a[ID_PROP_NODE_BACKGROUND_COLOR]=g==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?[!1,g]:[!0,g];g=null;g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked&&
(g=g_objLayerKit.getElementById("txtReadBackgroundImageURL").value);var m=g_objLayerKit.getElementById("selBackgroundRepeat").value;a[ID_PROP_NODE_BACKGROUND_IMAGE]=g==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?m==this.arrInitTableAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?[!1,g,m]:[!0,g,m]:[!0,g,m];a[ID_PROP_NODE_STYLE]=g_objPropTagCommon.getSelectedTableStyle();return a}catch(x){dalert(x)}return null};this.onRadioChange=function(a){try{var b=DzeSpinner.getSpinner("txtTableWidth");
if(a===g_objLayerKit.getElementById("rdoWidthUnit_Px")){var e=parseFloat(g_objLayerKit.getElementById("txtTableWidth").value)/100,f=g_objCommonUtil.convPercentToPx(this.objTableInfo,e);g_objLayerKit.getElementById("txtTableWidth").value=Math.floor(f);b&&(b.unit&&(b.unit.innerHTML="px"),b.min=0,b.max=this.nTableMaxWidth)}else a===g_objLayerKit.getElementById("rdoWidthUnit_Percentage")&&(f=parseFloat(g_objLayerKit.getElementById("txtTableWidth").value),e=100*g_objCommonUtil.convPxToPercent(this.objTableInfo,
f),g_objLayerKit.getElementById("txtTableWidth").value=Math.floor(e),b&&(b.unit&&(b.unit.innerHTML="%"),b.min=0,b.max=this.nTableMaxPercentWidth))}catch(k){dalert(k)}}};
var g_objPropTagTableCell=new function(){this.objTableNode=null;this.buildTagTableCell=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_SET_INNER_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_LEFT+duzon_dialog.makeSpinnerInputForm("txtCellPaddingLeft","px",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_TOP+duzon_dialog.makeSpinnerInputForm("txtCellPaddingTop",
"px",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_RIGHT+duzon_dialog.makeSpinnerInputForm("txtCellPaddingRight","px",100,0);a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_BOTTOM+duzon_dialog.makeSpinnerInputForm("txtCellPaddingBottom","px",100,0);a+="</div>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+
ID_RES_CONST_STRING_ALIGN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_ALIGN_HOR;a+='<select id="selTextAlign" name="selTextAlign" style="width:80px !important;">';a+='<option value=""></option>';a+='<option value="none">'+ID_RES_DIALOG_STRING_NONE+"</option>";a+='<option value="left">'+ID_RES_CONST_STRING_JUSTIFYLEFT+"</option>";a+='<option value="center">'+ID_RES_CONST_STRING_JUSTIFYCENTER+"</option>";a+='<option value="right">'+
ID_RES_CONST_STRING_JUSTIFYRIGHT+"</option>";a+="</select>";a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_ALIGN_VER;a+='<select id="selVerticalAlign" name="selVerticalAlign" style="width:80px !important;">';a+='<option value=""></option>';a+='<option value="none">'+ID_RES_DIALOG_STRING_NONE+"</option>";a+='<option value="top">'+ID_RES_PROP_TAG_STRING_ALIGN_TOP+"</option>";a+='<option value="middle">'+ID_RES_PROP_TAG_STRING_ALIGN_MIDDLE+"</option>";
a+='<option value="bottom">'+ID_RES_PROP_TAG_STRING_ALIGN_BOTTOM+"</option>";a+="</select>";return a+"</div></div>"}catch(h){dalert(h)}};this.buildTagTableCellCommon=function(){return'<div style="height:1px;width:365px;"></div>'};this.initPropTagTableCell=function(a,h){try{if(this.objTableNode=a,!fnObjectCheckNull(a)){duzon_dialog.modifySpinnerValue("txtCellPaddingLeft",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingTop",100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingRight",
100,0,"","");duzon_dialog.modifySpinnerValue("txtCellPaddingBottom",100,0,"","");for(var d=[g_objLayerKit.getElementById("txtCellPaddingLeft"),g_objLayerKit.getElementById("txtCellPaddingTop"),g_objLayerKit.getElementById("txtCellPaddingRight"),g_objLayerKit.getElementById("txtCellPaddingBottom")],c=[],e=[],f=[],b=0;4>b;b++)c[b]=[];var k={},l=function(a){if(!a)return 0;if(k[a])return k[a];var b=g_objCommonUtil.extractNumberValueUnit(a);if(b)return k[a]=+parseFloat(b.nValue).toFixed(2),k[a]},g=g_objLayerKit.getElementById("selTextAlign");
g_objTableSelection.doAllSelectedCell(function(a){c[0][c[0].length]=l(a.style.paddingLeft);c[1][c[1].length]=l(a.style.paddingTop);c[2][c[2].length]=l(a.style.paddingRight);c[3][c[3].length]=l(a.style.paddingBottom);var b=a.style.textAlign;b||(b=a.align);e[e.length]=b;f[f.length]=a.style.verticalAlign},a);for(b=0;4>b;b++)a="0",c[b].every(function(a){return c[b][0]==a})?""!==c[b][0]&&(a=c[b][0]):a="",d[b].value=a;d="";e.every(function(a){return e[0]===a})?(d=e[0].toLowerCase(),g.selectedIndex="left"===
d?2:"center"===d?3:"right"===d?4:1):g.selectedIndex=0;g="";var m=g_objLayerKit.getElementById("selVerticalAlign");f.every(function(a){return f[0]===a})?(g=f[0].toLowerCase(),m.selectedIndex="top"===g?2:"middle"===g?3:"bottom"===g?4:1):m.selectedIndex=0}}catch(n){dalert(n)}};this.applyPropTagTableCell=function(){try{if(!fnObjectCheckNull(this.objTableNode)){var a=g_objLayerKit.getElementById("txtCellPaddingLeft").value,h=g_objLayerKit.getElementById("txtCellPaddingTop").value,d=g_objLayerKit.getElementById("txtCellPaddingRight").value,
c=g_objLayerKit.getElementById("txtCellPaddingBottom").value,e=g_objLayerKit.getElementById("selTextAlign").value,f=g_objLayerKit.getElementById("selVerticalAlign").value;g_objTableSelection.doAllSelectedCell(function(b){0===parseFloat(a)?b.style.paddingLeft="":""!=a&&(b.style.paddingLeft=a+"px");0===parseFloat(h)?b.style.paddingTop="":""!=h&&(b.style.paddingTop=h+"px");0===parseFloat(d)?b.style.paddingRight="":""!=d&&(b.style.paddingRight=d+"px");0===parseFloat(c)?b.style.paddingBottom="":""!=c&&
(b.style.paddingBottom=c+"px");""!==e&&(b.style.textAlign="none"===e?"":e,b.removeAttribute("align"));"none"===f?b.style.verticalAlign="":""!==f&&(b.style.verticalAlign=f)}.bind(this),this.objTableNode)}}catch(b){dalert(b)}}};
var ID_PROP_NODE_BORDER=0,ID_PROP_NODE_BACKGROUND_COLOR=1,ID_PROP_NODE_BACKGROUND_IMAGE=2,ID_PROP_NODE_GENERAL=3,ID_PROP_NODE_STYLE=4,ID_PROP_BORDER_DUPLICATED="duplicated",propTagTableCellStyle=function(){this.arrInitBorderAttribute=this.arrInitCellAttribute=null;propTagTableCellStyle.prototype.buildTagTableCellStyle_Border=function(){try{var a="";return a+=g_objPropTagCommon.buildTagCommon_Border()}catch(c){dalert(c)}};propTagTableCellStyle.prototype.buildTagTableCellStyle_Background=function(){try{var a=
"";a+=g_objPropTagCommon.buildTagCommon_Background();a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_APPLY_RANGE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td width="50%" style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="14">';a+='<td><input type="radio" id="rdoApplyBackground_Selected" name="rdoApplyBackground" value="0" /><label for="rdoApplyBackground_Selected">'+
ID_RES_PROP_TAG_STRING_SELECTED_CELL+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+='<td width="50%">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="14">';a+='<td><input type="radio" id="rdoApplyBackground_All" name="rdoApplyBackground" value="1" /><label for="rdoApplyBackground_All">'+ID_RES_PROP_TAG_STRING_ALL_CELL+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";return a+"</table></div>"}catch(c){dalert(c)}};propTagTableCellStyle.prototype.buildTagTableCellStyleCommon=
function(){return'<div style="height:1px;width:365px;"></div>'};propTagTableCellStyle.prototype.initPropTagTableCellStyle=function(a,c){try{this.arrInitBorderAttribute=this.arrInitCellAttribute=g_strBackgroundImageURL=null;var b=g_objLayerKit.getElementById("dze_idx_table_bordercollapse"),d=!0;b&&(d=g_objTableUtil.getTableBorderCollapse(a),b.checked=d);duzon_dialog.modifySpinnerValue("txtBorderWidth",10,0,1,"g_objPropTagCommon.onChangeSpinnerValue");g_objBorderComboBoxUtil.initBorderComboBox("selBorderStyle",
0,function(a){g_objBorderSelectionUtil.setBorderStyle(a)});var f=g_objBorderComboBoxUtil.getSubArrayObject(COMBOBOX_TYPE_BORDER_STYLE);b=0;if(f)for(d=0;d<f.length;d++)if("solid"===f[d]){b=d;break}g_objBorderComboBoxUtil.setSelectedIndex("selBorderStyle",COMBOBOX_TYPE_BORDER_STYLE,b);g_objColorComboBoxUtil.initColorComboBox("txtBorderColor",function(a){g_objBorderSelectionUtil.setBorderColor(a)});g_objColorComboBoxUtil.setColorValue("txtBorderColor","#000000");g_objBorderSelectionUtil.initBorderSelection();
g_objBorderSelectionUtil.setBorderWidth(g_objLayerKit.getElementById("txtBorderWidth").value);g_objBorderSelectionUtil.setBorderStyle(g_objBorderComboBoxUtil.getSelectedBorderValue("selBorderStyle",0));g_objBorderSelectionUtil.setBorderColor(g_objColorComboBoxUtil.getColorValue("txtBorderColor"));g_objColorComboBoxUtil.initColorComboBox("txtBackgroundColor");g_objLayerKit.getElementById("rdoBackgroundColorUseNo").onclick=function(){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1)};g_objLayerKit.getElementById("rdoBackgroundColorUseYes").onclick=
function(){g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0)};duzon_dialog.addEventExtFileForm("fileBackgroundImage",function(){g_objPropTagCommon.onChangeImgSrc()});duzon_dialog.disableExtFileForm("fileBackgroundImage");duzon_dialog.disableImageUrlForm("txtReadBackgroundImageURL");g_objLayerKit.getElementById("selBackgroundRepeat").onchange=function(){g_objPropTagCommon.setSelectedTableCustomStyle()};g_objLayerKit.getElementById("chkBackgroundImageUseYN").onclick=function(a){g_objPropTagCommon.setSelectedTableCustomStyle();
this.checked?(duzon_dialog.enableExtFileForm("fileBackgroundImage"),g_objLayerKit.getElementById("selBackgroundRepeat").disabled=!1):(duzon_dialog.disableExtFileForm("fileBackgroundImage"),g_objLayerKit.getElementById("selBackgroundRepeat").disabled=!0)};g_objLayerKit.getElementById("rdoApplyBackground_Selected").checked=!0;this.arrInitCellAttribute=g_objTableFunction.getSelectedCellAttribute(g_objEditorDocument[c],a,c);if(null!=this.arrInitCellAttribute){this.arrInitBorderAttribute=this.arrInitCellAttribute[0][1].slice();
g_objBorderSelectionUtil.initPropTagTableCellStyleBorder(this.arrInitCellAttribute[ID_PROP_NODE_BORDER]);var g=g_objLayerKit.getElementById("rdoBackgroundColorUseYes"),l=g_objLayerKit.getElementById("rdoBackgroundColorUseNo");null===this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?(g.checked=!1,l.checked=!1,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","")):""===this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]?(l.checked=
!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!1),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor","")):(g.checked=!0,g_objColorComboBoxUtil.setActive("txtBackgroundColor",!0),g_objColorComboBoxUtil.setColorValue("txtBackgroundColor",this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_COLOR]));if(null==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0])g_objLayerKit.getElementById("fileBackgroundImage").disabled=!0,g_objLayerKit.getElementById("selBackgroundRepeat").disabled=
!0;else{g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked=!0;g_objLayerKit.getElementById("txtReadBackgroundImageURL").value=this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0];var e=g_objLayerKit.getElementById("selBackgroundRepeat");"repeat"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?e.selectedIndex=0:"repeat-x"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?e.selectedIndex=1:"repeat-y"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?
e.selectedIndex=2:"no-repeat"==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]&&(e.selectedIndex=3);duzon_dialog.enableExtFileForm("fileBackgroundImage")}}}catch(k){dalert(k)}};propTagTableCellStyle.prototype.getPropSettingData=function(){try{var a=[],c=g_objLayerKit.getElementById("dze_idx_table_bordercollapse").checked;a[ID_PROP_NODE_GENERAL]=[null,null,null,null,null,null,null,null,null,c];c=!0;var b=g_objBorderSelectionUtil.bHide_MiniRec_h_1?!1:!0,d=g_objBorderSelectionUtil.bHide_MiniRec_v_1?
!1:!0,f=g_objBorderSelectionUtil.getBorderValue("miniRec_h_0");""===f&&(f=ID_PROP_BORDER_DUPLICATED);var g="";b&&(g=g_objBorderSelectionUtil.getBorderValue("miniRec_h_1"),""===g&&(g=ID_PROP_BORDER_DUPLICATED));var l=g_objBorderSelectionUtil.getBorderValue("miniRec_h_2");""===l&&(l=ID_PROP_BORDER_DUPLICATED);var e=g_objBorderSelectionUtil.getBorderValue("miniRec_v_0");""===e&&(e=ID_PROP_BORDER_DUPLICATED);var k="";d&&(k=g_objBorderSelectionUtil.getBorderValue("miniRec_v_1"),""===k&&(k=ID_PROP_BORDER_DUPLICATED));
var p=g_objBorderSelectionUtil.getBorderValue("miniRec_v_2");""===p&&(p=ID_PROP_BORDER_DUPLICATED);f==this.arrInitBorderAttribute[0]&&g==this.arrInitBorderAttribute[1]&&l==this.arrInitBorderAttribute[2]&&e==this.arrInitBorderAttribute[3]&&k==this.arrInitBorderAttribute[4]&&e==this.arrInitBorderAttribute[5]&&(c=!1);a[ID_PROP_NODE_BORDER]=[c,!0,b,!0,!0,d,!0,f,g,l,e,k,p];var m=g_objLayerKit.getElementById("rdoApplyBackground_All").checked;b=null;var h=g_objLayerKit.getElementById("rdoBackgroundColorUseYes"),
q=g_objLayerKit.getElementById("rdoBackgroundColorUseNo");h.checked?b=g_objColorComboBoxUtil.getColorValue("txtBackgroundColor"):q.checked&&(b="");a[ID_PROP_NODE_BACKGROUND_COLOR]=h.checked||q.checked?[m,!0,b]:[m,!1,b];h=null;g_objLayerKit.getElementById("chkBackgroundImageUseYN").checked&&(h=g_objLayerKit.getElementById("txtReadBackgroundImageURL").value);var n=g_objLayerKit.getElementById("selBackgroundRepeat").value;a[ID_PROP_NODE_BACKGROUND_IMAGE]=h==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][0]?
n==this.arrInitCellAttribute[ID_PROP_NODE_BACKGROUND_IMAGE][1]?[m,!1,h,n]:[m,!0,h,n]:[m,!0,h,n];return a}catch(r){dalert(r)}return null};propTagTableCellStyle.prototype.checkBorderDuplicatedValue=function(a){}},g_objPropTagTableCellStyle=new propTagTableCellStyle;
var propTagTableSplitCell=function(){var d=this;this.bSplitRow=!0;this.nSplitCount=-1;this.objRadioCol=this.objRadioRow=null;propTagTableSplitCell.prototype.buildTagTableSplitCell=function(){try{var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SPLIT_ROW_COL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="76"><input type="radio" id="rdoSplitCellRow" name="rdoSplitCell" value="0" /><label for="rdoSplitCellRow">'+ID_RES_PROP_TAG_STRING_ROW_NUM+"</label></td>";a+='<td width="50"></td>';a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtPropSplitCellRow","",20,2)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;">';a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table width="100%" border="0" cellspacing="0" cellpadding="0">';
a+="<tr>";a+='<td width="76"><input type="radio" id="rdoSplitCellCol" name="rdoSplitCell" value="1" /><label for="rdoSplitCellCol">'+ID_RES_PROP_TAG_STRING_COL_NUM+"</label></td>";a+='<td width="50"></td>';a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtPropSplitCellCol","",20,2)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:220px;"></div>'}catch(b){dalert(b)}};propTagTableSplitCell.prototype.initPropTagTableSplitCell=function(){try{duzon_dialog.modifySpinnerValue("txtPropSplitCellRow",
20,2,"","");duzon_dialog.modifySpinnerValue("txtPropSplitCellCol",20,2,"","");this.bSplitRow=!0;this.nSplitCount=-1;this.objRadioRow=g_objLayerKit.getElementById("rdoSplitCellRow");this.objRadioRow.checked=!0;this.objRadioCol=g_objLayerKit.getElementById("rdoSplitCellCol");var a=g_objLayerKit.getElementById("txtPropSplitCellRow"),b=g_objLayerKit.getElementById("txtPropSplitCellCol");a.value=2;b.value="";this.objRadioRow.onclick=function(c){d.switchSplitCell(!0);a.value=2;b.value=""};this.objRadioCol.onclick=
function(c){d.switchSplitCell(!1);a.value="";b.value=2};this.switchSplitCell(!0)}catch(c){dalert(c)}};propTagTableSplitCell.prototype.switchSplitCell=function(a){try{a?(duzon_dialog.setEnableSpinner("txtPropSplitCellRow",!0),duzon_dialog.setEnableSpinner("txtPropSplitCellCol",!1)):(duzon_dialog.setEnableSpinner("txtPropSplitCellRow",!1),duzon_dialog.setEnableSpinner("txtPropSplitCellCol",!0))}catch(b){dalert(b)}};propTagTableSplitCell.prototype.getPropSettingData=function(){try{if(g_objLayerKit.getElementById("rdoSplitCellRow").checked){this.bSplitRow=
!0;var a=g_objLayerKit.getElementById("txtPropSplitCellRow");this.nSplitCount=parseInt(a.value)}else{this.bSplitRow=!1;var b=g_objLayerKit.getElementById("txtPropSplitCellCol");this.nSplitCount=parseInt(b.value)}}catch(c){dalert(c)}}},g_objPropTagTableSplitCell=new propTagTableSplitCell;
var propTagTableAddRowCol=function(){var c=this;this.objTxtColCount=this.objTxtRowCount=this.objRadioColRight=this.objRadioColLeft=this.objRadioCol=this.objRadioRowBottom=this.objRadioRowTop=this.objRadioRow=null;this.bAddRow=!0;this.nAddCount=this.nAddDirection=-1;propTagTableAddRowCol.prototype.buildTagTableAddRowCol=function(){try{var a="";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td style="vertical-align:top;">';
a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="24"></td>';a+='<td width="70"><input type="radio" id="rdoAddRow" name="rdoAddRowCol" value="0" /><label for="rdoAddRow">'+ID_RES_PROP_TAG_ADD_ROW+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;"></td>';a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="50"></td>';
a+='<td width="160" height="22">';a+='<input type="radio" id="rdoAddRowTop" name="rdoAddRowTopBottom" value="0" /><label for="rdoAddRowTop">'+ID_RES_PROP_TAG_UP+"</label>";a+="&nbsp;&nbsp;&nbsp;&nbsp;";a+='<input type="radio" id="rdoAddRowBottom" name="rdoAddRowTopBottom" value="0" /><label for="rdoAddRowBottom">'+ID_RES_PROP_TAG_DOWN+"</label>";a+="</td>";a+='<td width="90"></td>';a+='<td width="40">'+ID_RES_PROP_TAG_STRING_ROW_NUM+"</td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtAddRowCount",
"",10,1)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:20px;">';a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="24"></td>';a+='<td width="70"><input type="radio" id="rdoAddCol" name="rdoAddRowCol" value="1" /><label for="rdoAddCol">'+ID_RES_PROP_TAG_ADD_COL+"</label></td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;height:4px;"></td>';
a+="</tr>";a+="<tr>";a+='<td style="vertical-align:top;">';a+='<table border="0" cellspacing="0" cellpadding="0">';a+="<tr>";a+='<td width="50"></td>';a+='<td width="160" height="22">';a+='<input type="radio" id="rdoAddColLeft" name="rdoAddColLeftRight" value="0" /><label for="rdoAddColLeft">'+ID_RES_DIALOG_STRING_ALIGN_LEFT+"</label>";a+="&nbsp;&nbsp;&nbsp;&nbsp;";a+='<input type="radio" id="rdoAddColRight" name="rdoAddColLeftRight" value="0" /><label for="rdoAddColRight">'+ID_RES_DIALOG_STRING_ALIGN_RIGHT+
"</label>";a+="</td>";a+='<td width="90"></td>';a+='<td width="40">'+ID_RES_PROP_TAG_STRING_COL_NUM+"</td>";a+="<td>"+duzon_dialog.makeSpinnerInputForm("txtAddColCount","",10,1)+"</td>";a+="</tr>";a+="</table>";a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:320px;"></div>'}catch(b){dalert(b)}};propTagTableAddRowCol.prototype.initPropTagTableAddRowCol=function(){try{duzon_dialog.modifySpinnerValue("txtAddRowCount",10,1,"",""),duzon_dialog.modifySpinnerValue("txtAddColCount",
10,1,"",""),this.objRadioRow=g_objLayerKit.getElementById("rdoAddRow"),this.objRadioRowTop=g_objLayerKit.getElementById("rdoAddRowTop"),this.objRadioRowBottom=g_objLayerKit.getElementById("rdoAddRowBottom"),this.objTxtRowCount=g_objLayerKit.getElementById("txtAddRowCount"),this.objRadioRow.checked=!0,this.objRadioRowTop.checked=!0,this.objTxtRowCount.value=1,this.objRadioCol=g_objLayerKit.getElementById("rdoAddCol"),this.objRadioColLeft=g_objLayerKit.getElementById("rdoAddColLeft"),this.objRadioColRight=
g_objLayerKit.getElementById("rdoAddColRight"),this.objTxtColCount=g_objLayerKit.getElementById("txtAddColCount"),this.objRadioColLeft.checked=!0,this.objTxtColCount.value=1,this.objRadioRow.onclick=function(a){c.switchAddRowCol(!0)},this.objRadioCol.onclick=function(a){c.switchAddRowCol(!1)},this.switchAddRowCol(!0)}catch(a){dalert(a)}};propTagTableAddRowCol.prototype.switchAddRowCol=function(a){try{a?(this.objRadioRowTop.disabled=!1,this.objRadioRowBottom.disabled=!1,duzon_dialog.setEnableSpinner("txtAddRowCount",
!0),this.objRadioColLeft.disabled=!0,this.objRadioColRight.disabled=!0,duzon_dialog.setEnableSpinner("txtAddColCount",!1)):(this.objRadioRowTop.disabled=!0,this.objRadioRowBottom.disabled=!0,duzon_dialog.setEnableSpinner("txtAddRowCount",!1),this.objRadioColLeft.disabled=!1,this.objRadioColRight.disabled=!1,duzon_dialog.setEnableSpinner("txtAddColCount",!0))}catch(b){dalert(b)}};propTagTableAddRowCol.prototype.getPropSettingData=function(){try{this.objRadioRow.checked?(this.bAddRow=!0,this.nAddDirection=
this.objRadioRowTop.checked?0:1,this.nAddCount=parseInt(this.objTxtRowCount.value)):(this.bAddRow=!1,this.nAddDirection=this.objRadioColLeft.checked?0:1,this.nAddCount=parseInt(this.objTxtColCount.value))}catch(a){dalert(a)}}},g_objPropTagTableAddRowCol=new propTagTableAddRowCol;
var propTagTableSelectFormula=function(){var l=this;this.objTableNode=this.objOutlineUtil=this.objTableCopyView=null;this.nSelectedCol=this.nSelectedRow=-1;this.arrRowCol=[];this.objFormulaResult=this.objFormulaData=this.objRadioMutiply=this.objRadioAverage=this.objRadioSum=null;this.strInfoString="\uc801\uc6a9\ud560 \uc140\uc744 \ud3b8\uc9d1\ucc3d\uc5d0\uc11c \uc120\ud0dd\ud558\uc138\uc694";this.strNaNString="\uacc4\uc0b0 \ubd88\uac00\ud55c \ud56d\ubaa9\uc774 \uc120\ud0dd\ub418\uc5c8\uc2b5\ub2c8\ub2e4";
this.bShowTagTableSelectFormula=!1;propTagTableSelectFormula.prototype.buildTagTableSelectFormula=function(){try{this.strInfoString=ID_RES_PROP_TAG_STRING_SELECT_CELL_EDITOR;this.strNaNString=ID_RES_PROP_TAG_STRING_NO_CALC_SELECTED_CELL;var a="";a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_SELECT_CELL+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td id="formulaData" style="height:80px;text-align:center;" class="mappingCode_preview propSection_td">';
a+=this.strInfoString;a+="</td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_CALC_TYPE+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';a+="<tr>";a+='<td><input type="radio" id="rdoFormulaSum" name="rdoFormula" value="0" /> <label for="rdoFormulaSum">'+ID_RES_PROP_TAG_STRING_CALC_SUM+"</label></td>";a+='<td><input type="radio" id="rdoFormulaAverage" name="rdoFormula" value="1" /> <label for="rdoFormulaAverage">'+
ID_RES_PROP_TAG_STRING_CALC_AVG+"</label></td>";a+='<td><input type="radio" id="rdoFormulaMutiply" name="rdoFormula" value="2" /> <label for="rdoFormulaMutiply">'+ID_RES_PROP_TAG_STRING_CALC_MUL+"</label></td>";a+="</tr>";a+="</table>";a+="</div>";a+='<div class="duzon_dialog_label_separator"></div>';a+='<div class="duzon_dialog_label_title">'+ID_RES_PROP_TAG_STRING_CALC_RESULT+"</div>";a+="<div>";a+='<table width="100%" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse;">';
a+="<tr>";a+='<td id="formulaResult" style="height:40px;text-align:center;" class="mappingCode_preview propSection_td">';a+=this.strInfoString;a+="</td>";a+="</tr>";a+="</table>";return a+'</div><div style="height:1px;width:320px;"></div>'}catch(b){dalert(b)}};propTagTableSelectFormula.prototype.initPropTagTableSelectFormula=function(a,b,d,e){try{this.objRadioSum=g_objLayerKit.getElementById("rdoFormulaSum"),this.objRadioAverage=g_objLayerKit.getElementById("rdoFormulaAverage"),this.objRadioMutiply=
g_objLayerKit.getElementById("rdoFormulaMutiply"),this.objRadioSum.checked=!0,this.objRadioSum.onclick=function(a){l.displayData()},this.objRadioAverage.onclick=function(a){l.displayData()},this.objRadioMutiply.onclick=function(a){l.displayData()},this.objFormulaData=g_objLayerKit.getElementById("formulaData"),this.objFormulaResult=g_objLayerKit.getElementById("formulaResult"),this.objTableNode=a,this.nSelectedRow=b,this.nSelectedCol=d,this.arrRowCol=[],this.showTableCopyView(!0,a,b,d,e)}catch(c){dalert(c)}};
propTagTableSelectFormula.prototype.initTableCopyView=function(){try{if(null==this.objTableCopyView){var a=g_objLayerKit.getElementById("tableCopyView");a||(a=g_objInsertUtil.insertLayerHTML('<div id="tableCopyView" style="display:none;position:absolute;z-index:20028;border:0px;background-color:;filter:alpha(opacity=60);opacity:0.6;"></div>',!0));if(!a)return;this.objTableCopyView=a}null==this.objOutlineUtil&&(this.objOutlineUtil=g_objWrapperOutlineUtil.objOutlineUtil)}catch(b){dalert(b)}};propTagTableSelectFormula.prototype.showTableCopyView=
function(a,b,d,e,c){try{if(a){this.bShowTagTableSelectFormula=!0;null==this.objTableCopyView&&this.initTableCopyView();a=g_objPositionUtil;var g=a.getElementPosClientRect(b),h=a.getNodeElementPosition(g_objEditObject[c],!0),n=a.getFrameClientRect();a.moveRect(h,n.left,n.top);var l=h.left+g.left,p=h.top+g.top,u=h.left+g.right,v=h.top+g.bottom;this.objTableCopyView.style.left=l+"px";this.objTableCopyView.style.top=p+"px";this.objTableCopyView.style.width=u-l+"px";this.objTableCopyView.style.height=
v-p+"px";c=this.objTableCopyView.style.display="";for(var f=0;f<b.rows.length;f++)for(var q=g_objTableUtil.getTableCellsLength(b,f),k=0;k<q;k++)if(f!=d||k!=e)c+='<input type="checkbox" id="chkFormula_'+f+"_"+k+'" style="position:absolute;" />';this.objTableCopyView.innerHTML=c;for(f=0;f<b.rows.length;f++)for(q=g_objTableUtil.getTableCellsLength(b,f),k=0;k<q;k++)if(f!=d||k!=e){var r=g_objTableUtil.getTableCellElement(b,f,k),m=g_objPositionUtil.getElementPosClientRect(r),w=h.left+m.left,x=h.top+m.top,
t=g_objLayerKit.getElementById("chkFormula_"+f+"_"+k);t.style.left=w-l+"px";t.style.top=x-p+"px";(function(){var a=f,b=k;t.onclick=function(c){g_objPropTagTableSelectFormula.clickCheckBox(this,a,b)}})()}r=g_objTableUtil.getTableCellElement(b,d,e);m=g_objPositionUtil.getElementPosClientRect(r);this.objOutlineUtil.showExtOutline(!0,!1,!1,m.left,m.top,m.right,m.bottom,!1,!1)}else this.bShowTagTableSelectFormula=!1,this.objTableCopyView.style.display="none",this.objOutlineUtil.showExtOutline(!1,!1,!1,
0,0,0,0,!1,!1)}catch(y){dalert(y)}};propTagTableSelectFormula.prototype.clickCheckBox=function(a,b,d){try{for(var e=!1,c=0;c<this.arrRowCol.length;c++)if(b==this.arrRowCol[c][0]&&d==this.arrRowCol[c][1]){e=!0;break}a.checked?e||(this.arrRowCol[this.arrRowCol.length]=[b,d]):e&&(this.arrRowCol=this.removeKeyValueInArray(this.arrRowCol,b,d));this.displayData()}catch(g){dalert(g)}};propTagTableSelectFormula.prototype.removeKeyValueInArray=function(a,b,d){try{for(var e=[];0<a.length;){var c=a.shift();
if(b!=c[0]||d!=c[1])e[e.length]=c}return e}catch(g){dalert(g)}};propTagTableSelectFormula.prototype.displayData=function(){try{this.strInfoString=ID_RES_PROP_TAG_STRING_SELECT_CELL_EDITOR;this.strNaNString=ID_RES_PROP_TAG_STRING_NO_CALC_SELECTED_CELL;for(var a="",b=[],d=0;d<this.arrRowCol.length;d++){var e=g_objTableUtil.getTableCellElement(this.objTableNode,this.arrRowCol[d][0],this.arrRowCol[d][1]),c=g_objPropertyUtil.getTextContent(e);c=c.trim().replace(/[\u200B-\u200D\uFEFF]|(\\n|\\r)+/g,"");
c=c.removeComma();if(0!=c.localeCompare("")){if(isNaN(c)){this.objFormulaData.innerHTML=this.strNaNString;this.objFormulaResult.innerHTML=this.strNaNString;return}a=""==a?c:a+(" : "+c);b[d]=parseFloat(c)}}if(""==a)this.objFormulaData.innerHTML=this.strInfoString,this.objFormulaResult.innerHTML=this.strInfoString;else{this.objFormulaData.innerHTML=a;var g=this.getFormulaCode(),h=g_objTableFunction.doFormulaData(b,g);if(null!=h){if(1==g||2==g)h=toFloat(h,3);this.objFormulaResult.innerHTML=h}}}catch(n){dalert(n)}};
propTagTableSelectFormula.prototype.getFormulaCode=function(){try{return this.objRadioSum.checked?0:this.objRadioAverage.checked?1:this.objRadioMutiply.checked?2:-1}catch(a){dalert(a)}};propTagTableSelectFormula.prototype.setFormulaResultValue=function(){try{if(this.strInfoString!=this.objFormulaResult.innerHTML&&""!=this.objFormulaResult.innerHTML){var a=g_objTableUtil.getTableCellElement(this.objTableNode,this.nSelectedRow,this.nSelectedCol);g_objTableUtil.setCellInnerText(this.objFormulaResult.innerHTML,
a)}}catch(b){dalert(b)}}},g_objPropTagTableSelectFormula=new propTagTableSelectFormula;
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(c.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
var dze_menu_control={nEditNumber:0,setEditNumber:function(a){try{"undefined"!=typeof a&&(this.nEditNumber=a)}catch(c){dalert(c)}},tb_menu_list:[],setTbMenuList:function(){try{var a=[ID_RES_TOOL_STRING_MENU_FILE,ID_RES_TOOL_STRING_MENU_HOME,ID_RES_TOOL_STRING_MENU_INSERT,ID_RES_TOOL_STRING_MENU_LAYOUT,ID_RES_TOOL_STRING_MENU_VIEW,ID_RES_TOOL_STRING_MENU_TABLE,ID_RES_CONST_STRING_INSERT_IMAGE,ID_RES_CONST_STRING_SHAPES,ID_RES_CONST_STRING_INSERT_OBJECT_MOVIE,ID_RES_CONST_STRING_HEADER_FOOTER,ID_RES_CONST_STRING_TEMP_SAVE],
c=[5,6,7,8,9,10],b="idxTableMenu idxImagePropertyMenu idxShapePropertyMenu idxVideoPropertyMenu idxHeaderFooterMenu idxTempSaveMenu".split(" "),d=dzeUiConfig.ribbon_menu_list_tab.slice();forEach(d,function(b,d){(b=a[d])&&this.tb_menu_list.push(b)},this);var e=d.length-1,f=0;forEach(d,function(a,h){a=c.indexOf(h);0<=a&&(h=d.indexOf(h),this[b[a]]=h,e=Math.min(e,h),f=Math.max(f,h))},this);this.idxDynamicMenuStart=e;this.idxDynamicMenuEnd=f}catch(g){dalert(g)}},idxDynamicMenuStart:5,idxTableMenu:5,idxImagePropertyMenu:6,
idxShapePropertyMenu:7,idxVideoPropertyMenu:8,idxHeaderFooterMenu:9,idxTempSaveMenu:10,idxDynamicMenuEnd:10,idxDefalutMenu:1,tb_menu_content_left_list:[],setTbMenuContentLeftList:function(){try{this.tb_menu_content_left_list=dzeUiConfig.ribbon_menu_list_left}catch(a){dalert(a)}},tb_menu_content_list:[],setTbMenuContentList:function(){try{this.tb_menu_content_list=dzeUiConfig.ribbon_menu_list_main}catch(a){dalert(a)}},tb_menu_content_right_list:[],setTbMenuContentRightList:function(){try{this.tb_menu_content_right_list=
dzeUiConfig.ribbon_menu_list_right}catch(a){dalert(a)}},tb_menu_content_bottom_list:[],setTbMenuContentBottomList:function(){try{this.tb_menu_content_bottom_list=dzeUiConfig.ribbon_menu_list_bottom}catch(a){dalert(a)}},tb_menu_content_help_list:[],setTbMenuContentHelpList:function(){try{if(!0===g_browserCHK.isWebView())this.tb_menu_content_help_list=dzeUiConfig.ribbon_menu_list_help_forWebview;else{if(0==objOnefficeLoader.m_bDomainDuzon){var a=dzeUiConfig.ribbon_menu_list_help.indexOf(ID_COMMAND_HELP_ONEFFICE_VOC);
-1<a&&dzeUiConfig.ribbon_menu_list_help.splice(a,1)}this.tb_menu_content_help_list=dzeUiConfig.ribbon_menu_list_help}}catch(c){dalert(c)}},status_right_btn_list:[],setStatusRightBtnList:function(){!0===g_browserCHK.isWebView()?this.status_right_btn_list=dzeUiConfig.status_right_btn_list_forWebview:this.status_right_btn_list=dzeUiConfig.status_right_btn_list},allTbCommandIdList:[],setAllTbCommandIdList:function(){try{this.allTbCommandIdList=[];var a=this.tb_menu_content_list;0<this.tb_menu_content_left_list.length&&
a.push(this.tb_menu_content_left_list);0<this.tb_menu_content_right_list.length&&a.push(this.tb_menu_content_right_list);a.push(this.tb_menu_content_bottom_list);for(var c=0;c<a.length;c++)for(var b=a[c],d=0;d<b.length;d++)if(!(2>b[d].length))for(var e=0;e<b[d].length-1;e++)this.allTbCommandIdList.push(b[d][e])}catch(f){dalert(f)}},setExceptMenuList:function(){try{var a=onefficeUtil.getRequestParameter("ref");null!==a&&0<=a.indexOf("backupdoc")&&onefficeUtil.setBackupDocUiConfig()}catch(c){dalert(c)}},
curr_checked_menu:[],prev_checked_menu:[],initialize:function(a){try{!0===dzeUiConfig.bUseUiMode&&(this.setEditNumber(a),this.setTbMenuList(),this.setTbMenuContentLeftList(),this.setTbMenuContentList(),this.setTbMenuContentRightList(),this.setTbMenuContentBottomList(),this.setTbMenuContentHelpList(),this.setExceptMenuList(),this.setAllTbCommandIdList(),this.getUiMode(),dlog("dze_menu_control.initialize, UI MODE:"+this.ui_mode),this.addRibbonUiContainer(a),this.addUiToggleBtnInBasicUi(a),this.addRulerbarContainer(a),
this.addStatusbarContainer(a),this.curr_checked_menu[a]=-1,this.prev_checked_menu[a]=-1,this.showMenuUi(a),this.addEventMenuControl(a))}catch(c){dalert(c)}},addUiToggleBtnInBasicUi:function(a){try{if(this.setEditNumber(a),!0===dzeUiConfig.bUseUiMode&&"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&1<dzeUiConfig.arrCustomMenuUiType.length&&null!=document.getElementById("TB_CONTAINER_MENU_"+a)){var c=document.getElementById("TB_CONTAINER_MENU_"+a).childNodes[0];if(null!=c){var b=c.rows[0].insertCell();
b.id="TB_MENU_PROPERTY_TD_BASIC_"+a;var d=document.createElement("table");d.id="TB_MENU_PROPERTY_CONTAINER_"+a;d.setAttribute("border","0");d.setAttribute("cellspacing","0");d.setAttribute("cellpadding","0");var e=d.insertRow();if(!0===dzeUiConfig.bUsePropUserMenu){var f=this.makeReturnBasicUserInfoPropertyMenuTd(a,"TB_MENU_USERINFO_TEXT_BTN",function(a){});f.style.display="none";e.appendChild(f);h=this.makeReturnBasicPropertyMenuTd(a,"TB_MENU_USERINFO_BTN","",dzeEnvConfig.strPath_Image+"toolbar/btn_user_normal.png",
function(a){});e.appendChild(h);g=this.makeReturnBasicPropertyMenuEmptyTd();e.appendChild(g)}var g=null,h=null;!0===dzeUiConfig.bUsePropSecurityMenu&&(h=this.makeReturnBasicPropertyMenuTd(a,"TB_MENU_SECURITY_BTN",ID_RES_CONST_STRING_SECURITY_DOCUMENTS,dzeEnvConfig.strPath_Image+"toolbar/icon_lock_normal.png"),e.appendChild(h),h.style.display="none",g=this.makeReturnBasicPropertyMenuEmptyTd(),e.appendChild(g),g.style.display="none");!0===dzeUiConfig.bUsePropReadonlyMenu&&(h=this.makeReturnBasicPropertyMenuTd(a,
"TB_MENU_READONLY_BTN",ID_RES_CONST_STRING_READ_ONLY_DOCUMENT,dzeEnvConfig.strPath_Image+"toolbar/btn_read.png"),e.appendChild(h),h.style.display="none",g=this.makeReturnBasicPropertyMenuEmptyTd(),e.appendChild(g),g.style.display="none");!0===dzeUiConfig.bUsePropShareMenu&&(h=this.makeReturnBasicPropertyMenuTd(a,"TB_MENU_SHARE_BTN","",dzeEnvConfig.strPath_Image+"toolbar/btn_share_off.png"),e.appendChild(h),g=this.makeReturnBasicPropertyMenuEmptyTd(),e.appendChild(g));!0===dzeUiConfig.bUsePropFavorMenu&&
(h=this.makeReturnBasicPropertyMenuTd(a,"TB_MENU_FAVOR_BTN","",dzeEnvConfig.strPath_Image+"toolbar/btn_favorite_normal.png",function(b){onefficeGW.setDocumentFavorStatus(b,a)}),e.appendChild(h),g=this.makeReturnBasicPropertyMenuEmptyTd(),e.appendChild(g));h=this.makeReturnBasicPropertyMenuTd(a,"TB_MENU_HELP_BTN",ID_RES_TOOL_STRING_MENU_HELP,dzeEnvConfig.strPath_Image+"toolbar/btn_info_normal.png",function(b){dze_menu_control.showHelpBtnLayer(a,b)});if(objOnefficeLoader.m_bDomainDuzon&&"undefined"!=
typeof localStorage&&localStorage.getItem("dzeNotificationIcon")!=objOnefficeLoader.getVer()){var l=document.createElement("img");l.id="dze_idx_noti_new";l.src=dzeEnvConfig.strPath_Image+"ico_noti_new.png";l.setAttribute("style","width:12px;height:12px;position:absolute;right:-3px;top:-3px;");h.appendChild(l)}e.appendChild(h);g=this.makeReturnBasicPropertyMenuEmptyTd();e.appendChild(g);h=this.makeReturnBasicPropertyMenuTd(a,"TB_MENU_UI_SWITCH_BTN",ID_RES_UI_TOGGLE_STRING_MENUSTYLE,dzeEnvConfig.strPath_Image+
"toolbar/btn_option_normal.png",function(b){oneffice.bBackupLoadedContent?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT,2,"center"):dze_menu_control.showSettingDialog(a,b)});e.appendChild(h);g=this.makeReturnBasicPropertyMenuEmptyTd();e.appendChild(g);b.appendChild(d);this.resizePropertyTableInfo("basic",a)}}}catch(n){dalert(n)}},makeReturnBasicPropertyMenuTd:function(a,c,b,d,e){var f=null;try{f=document.createElement("td");var g=c+"_"+a;a=c+"_IMG_"+a;f.align="center";
f.style.position="relative";f.id=g;f.innerHTML="<img src='"+d+"' id='"+a+"' width='16' height='16' />";b&&(f.title=b);if("TB_MENU_READONLY_BTN"==c||"TB_MENU_SHARE_BTN"==c||"TB_MENU_USERINFO_BTN"==c||"TB_MENU_SECURITY_BTN"==c)return f;f.onclick=function(a){a=a?a:window.event;"function"===typeof e&&e(this);TBCancelBubbleEvent(a)};f.style.cursor="pointer";if("TB_MENU_FAVOR_BTN"==c)return f;f.onmouseover=function(a){this.getElementsByTagName("img")[0].src=this.getElementsByTagName("img")[0].src.replace(/(click|normal)/,
"over");a.preventDefault()};f.onmousedown=function(a){this.getElementsByTagName("img")[0].src=this.getElementsByTagName("img")[0].src.replace(/(over|normal)/,"click");a.preventDefault()};f.onmouseup=function(a){this.getElementsByTagName("img")[0].src=this.getElementsByTagName("img")[0].src.replace(/(click|normal)/,"over");a.preventDefault()};f.onmouseout=function(a){this.getElementsByTagName("img")[0].src=this.getElementsByTagName("img")[0].src.replace(/(click|over)/,"normal");a.preventDefault()};
return f}catch(h){return dalert(h),f}},makeReturnBasicUserInfoPropertyMenuTd:function(a,c,b){var d=null;try{return d=document.createElement("td"),d.id=c+"_"+a,d.align="center",d.innerHTML='<div class="dze_property_userinfo_text" id="dze_idx_property_userinfo_text_'+a+'"></div>',d.onclick=function(a){a=a?a:window.event;"function"===typeof b&&b(this);TBCancelBubbleEvent(a)},d.style.cursor="default",d}catch(e){return dalert(e),d}},makeReturnBasicPropertyMenuEmptyTd:function(){var a=document.createElement("td");
a.innerHTML='<div style="width:auto"></div>';return a},showSettingDialog:function(a,c){try{var b=function(a){var b=document.getElementById("dze_idx_ribbon_menu_sel"),d=document.getElementById("dze_idx_toolbar_menu_sel");a?(b.firstChild.style.backgroundColor="lightblue",d.firstChild.style.backgroundColor=""):(b.firstChild.style.backgroundColor="",d.firstChild.style.backgroundColor="lightblue")};"undefined"==typeof a&&(a=dze_menu_control.nEditNumber);dze_menu_control.removeHelpBtnLayer();duzon_dialog.closeExtendsDlg();
duzon_dialog.closeDialog();duzon_dialog.viewDialog(null,a,"ONEFFICE "+ID_RES_STRING_SETTING,function(){var a=dzeEnvConfig.strPath_Image+"dialog/icon_ribbon_menu.png",b=dzeEnvConfig.strPath_Image+"dialog/icon_toolbar_menu.png";var c='<p class="setting_subtitle">'+ID_RES_UI_TOGGLE_STRING_MENUSTYLE+"</p>";c=c+'<div style=\'width: 280px; max-width: 370px; margin-top: 4px; display: flex; justify-content:flex-start;\'><div class="setting_menu_style" id="dze_idx_ribbon_menu_sel">'+('<div><img src="'+a+'" alt="" title="'+
ID_RES_STRING_RIBBON_MENU+'" width="27" height="27"></div>'+ID_RES_STRING_RIBBON_MENU);c=c+'</div><div class="setting_menu_style" id="dze_idx_toolbar_menu_sel">'+('<div><img src="'+b+'" alt="" title="'+ID_RES_STRING_TOOLBAR_MENU+'" width="27" height="27"></div>'+ID_RES_STRING_TOOLBAR_MENU);c+="</div></div>";objOnefficeLoader.getAppEnvType()===APPENV.GW&&(c=c+'<table cellpadding="0" cellspacing="0" width="370px"style="background-color: white;"><tbody><tr><td colspan="3" style="height:40px;"/><div class="setting_line_dash"/></td></tr><tr><td colspan=\'3\' align=\'center\'>'+
("<p class='setting_subtitle'>"+ID_RES_STRING_AUTO_SAVE_CYCLE+"</p>"),c+="<span style='float:left;'><input type='radio' name='dze_auto_save_interval' value='10' id='dze_idx_auto_save_interval0' /><label for='dze_idx_auto_save_interval0'>10"+ID_RES_STRING_MINUTES+"</label></span>",c+="<span style='float:left;margin-left:20px'><input type='radio' name='dze_auto_save_interval' value='5' id='dze_idx_auto_save_interval1' /><label for='dze_idx_auto_save_interval1'>5"+ID_RES_STRING_MINUTES+"</label></span>",
c+="<span style='float:left;margin-left:20px'><input type='radio' name='dze_auto_save_interval' value='1' id='dze_idx_auto_save_interval2' /><label for='dze_idx_auto_save_interval2'>1"+ID_RES_STRING_MINUTES+"</label></span>",c+="<span style='float:left;margin-left:20px'><input type='radio' name='dze_auto_save_interval' value='0' id='dze_idx_auto_save_interval3' /><label for='dze_idx_auto_save_interval3'>"+ID_RES_STRING_NOT_USED+"</label></span>",c+="</td></tr></tbody></table>");return c}(),1,[ID_RES_DIALOG_BTN_OK],
[function(){var b="lightblue"==document.getElementById("dze_idx_ribbon_menu_sel").firstChild.style.backgroundColor?"ribbon":"basic";dze_menu_control.ui_mode!=b&&(dze_menu_control.setUiMode(b),dze_menu_control.showMenuUi(a));if(objOnefficeLoader.getAppEnvType()===APPENV.GW){b=duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env);var c=dzeJ('input[name="dze_auto_save_interval"]:checked');b.autoSaveInterval=c.attr("value");onefficeUtil.m_UserEnvConfig.user_env=b;onefficeCommon.updateOnefficeUserEnv(JSON.stringify(b));
b=parseInt(b.autoSaveInterval);oneffice.autoSaveTime=60*b;clearInterval(oneffice.autoSaveTimer);oneffice.autoSaveTimer=null;0!=oneffice.autoSaveTime&&(oneffice.autoSaveTimer=setInterval(function(){onefficeGW.autoSaveFunction(a)},1E3*oneffice.autoSaveTime))}duzon_dialog.closeDialog()}],function(){var a=document.getElementById("dze_idx_ribbon_menu_sel"),c=document.getElementById("dze_idx_toolbar_menu_sel");"ribbon"==dze_menu_control.ui_mode?b(!0):b(!1);a.onclick=function(){b(!0)};c.onclick=function(){b(!1)};
if(objOnefficeLoader.getAppEnvType()===APPENV.GW){a=document.getElementById("dze_idx_auto_save_interval0");c=document.getElementById("dze_idx_auto_save_interval1");var f=document.getElementById("dze_idx_auto_save_interval2"),g=document.getElementById("dze_idx_auto_save_interval3");if(onefficeUtil.m_UserEnvConfig&&onefficeUtil.m_UserEnvConfig.user_env){var h=duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env);if(1==fnObjectCheckNull(h.autoSaveInterval))c.checked=!0;else switch(h.autoSaveInterval){case "10":a.checked=
!0;break;case "5":c.checked=!0;break;case "1":f.checked=!0;break;case "0":g.checked=!0}}}},function(){},!0,"screen_center")}catch(d){dalert(d)}},help_btn_layer:null,showHelpBtnLayer:function(a,c){try{if("undefined"==typeof a&&(a=dze_menu_control.nEditNumber),this.setEditNumber(a),null==this.help_btn_layer){this.help_btn_layer=document.createElement("div");this.help_btn_layer.className="dze_help_btn_container";var b="";b+="<table border='0' cellspacing='0' cellpadding='0' width='100%'>";b+="\t<tr><td colspan='6' height='2'></td></tr>";
for(var d=0;d<this.tb_menu_content_help_list.length;d++){var e=this.tb_menu_content_help_list[d],f="<img src='"+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[e]+"'>",g=g_arrConst[e][1];objOnefficeLoader.m_bDomainDuzon&&e==ID_COMMAND_HELP_ONEFFICE_VOC&&"undefined"!=typeof localStorage&&localStorage.getItem("dzeNotificationIcon")!=objOnefficeLoader.getVer()&&(f+="<div style='position:relative;'><img src='"+dzeEnvConfig.strPath_Image+"ico_noti_new.png' style='position:absolute;right:-3px;top:-20px;'></div>");
b+="\t<tr class='dze_ui_toggle_btn_unit' height='24' commandId='"+e+"'><td width='10'></td><td width='16'>"+f+"</td><td width='6'></td><td align='left'>"+g+"</td><td width='10'></td><td width='8'></td></tr>"}this.help_btn_layer.innerHTML=b+"\t<tr><td colspan='6' height='2'></td></tr></table>";this.addEventHelpBtnLayer(a);this.setUiToggleContainerPosition(this.help_btn_layer);c.appendChild(this.help_btn_layer);this.help_btn_layer.style.display="block";duzon_dialog.animateDlg(this.help_btn_layer,"down");
g_bDynamicLayer=!0}else this.removeHelpBtnLayer()}catch(h){dalert(h)}},removeHelpBtnLayer:function(){try{if(null!=dze_menu_control.help_btn_layer){var a=document.getElementById("TB_MENU_HELP_BTN_IMG_"+dze_menu_control.nEditNumber);a.src=a.src.replace(/(click|over)/,"normal");dze_menu_control.help_btn_layer.style.display="none";dze_menu_control.help_btn_layer.parentNode.removeChild(dze_menu_control.help_btn_layer);dze_menu_control.help_btn_layer=null;g_bDynamicLayer=!1}}catch(c){dalert(c)}},addEventHelpBtnLayer:function(a){try{if(null!=
this.help_btn_layer)for(var c=this.help_btn_layer.getElementsByTagName("tr"),b=0;b<c.length;b++)if(c[b].getAttribute("commandId")){var d=c[b].getAttribute("commandId"),e=eval(g_arrConst[d][3]);(function(){var d=e;c[b].onclick=function(b){b=b?b:window.event;d(b,this,a);dze_menu_control.removeHelpBtnLayer();TBCancelBubbleEvent(b)}})();c[b].onmouseover=function(){this.className="dze_ui_toggle_btn_over"};c[b].onmouseout=function(){this.className="dze_ui_toggle_btn_unit"};c[b].onmousedown=function(){this.className=
"dze_ui_toggle_btn_down"}}}catch(f){dalert(f)}},setUiToggleContainerPosition:function(a){try{a.style.top="24px",a.style.left="-141px"}catch(c){dalert(c)}},addRulerbarContainer:function(a){try{if(dlog("addRulerbarContainer ==="),g_bRulerbar_Display){this.setEditNumber(a);var c=document.getElementById("DZE_IDX_EDITOR_EDITOR_FRAME_"+a);if(null!=c){c.style.backgroundColor="#F2F2F2";var b=document.createElement("div");b.id="TB_CONTAINER_RULERBAR_"+a;b.style.display="none";b.style.borderWidth="0px";b.style.height=
"24px";b.style.backgroundColor="#F2F2F2";b.style.zIndex=20008;b.style.position="relative";c.firstChild?c.insertBefore(b,c.firstChild):c.appendChild(b)}}}catch(d){dalert(d)}},addRibbonUiContainer:function(a){try{if(this.setEditNumber(a),!0===dzeUiConfig.bUseUiMode&&"undefined"!=typeof dzeUiConfig.arrCustomMenuUiType&&0<dzeUiConfig.arrCustomMenuUiType.length&&inArray("ribbon",dzeUiConfig.arrCustomMenuUiType)){var c=document.getElementById("TB_CONTAINER_"+a);if(null!=c&&!0===dzeUiConfig.bCustomize_MenuBar_Display&&
0!=c.rows.length){var b=c.insertRow(1),d=b.insertCell();d.id="TB_CONTAINER_MENU_RIBBON_"+a;d.className="dze_ribbon_menu_tb_container";b.style.display="none"}}}catch(e){dalert(e)}},addStatusbarContainer:function(a){if(!0===dzeUiConfig.bUseBottomStatusBar){var c=document.getElementById("ToolbarSetBottomStatusBar_"+a);if(c){var b=document.createElement("table");b.id="STATUS_BAR_TBL_"+a;b.setAttribute("width","100%");b.setAttribute("border","0");b.setAttribute("align","left");b.setAttribute("cellspacing",
"0");b.setAttribute("cellpadding","0");var d=b.insertRow(),e=d.insertCell();e.width="300";e.height="30";e.appendChild(this.makeStatusbarLeftContent(a));e=d.insertCell();e.height="30";e.align="center";e.appendChild(this.makeStatusbarCenterContent(a));e.appendChild(this.makeProgressbarCenterContent(a));e=d.insertCell();e.width="300";e.height="30";e.appendChild(this.makeStatusbarRightContent(a));c.appendChild(b)}}},makeStatusbarLeftContent:function(a){var c=document.createElement("table");c.id="STATUS_BAR_LEFT_TBL_"+
a;c.setAttribute("border","0");c.setAttribute("align","left");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");a=c.insertRow();var b=a.insertCell();b.width="20";b.height="30";b.innerHTML='<div style="width:auto"></div>';b=a.insertCell();b.width="";b.height="30";b.className="dze_style_status_page_no_text";b.innerHTML="1/1 "+ID_RES_CONST_STRING_PAGE;b.onclick=function(a){DZESHORTCUT.moveToPage(!0)};return c},makeStatusbarCenterContent:function(a){var c=document.createElement("div");
c.id="STATUS_BAR_CENTER_DIV_"+a;c.style.width="auto";c.style.margin="auto";c.style.textAlign="center";return c},makeProgressbarCenterContent:function(a){var c=document.createElement("div");c.id="PROGRESS_BAR_CENTER_DIV_"+a;c.className="dze_progress_bar_center_div";c.style.display="none";var b=document.createElement("div");b.id="PROGRESS_BAR_CENTER_SUB_DIV_"+a;b.className="dze_progress_bar_center_sub_div";c.appendChild(b);return c},makeStatusbarRightContent:function(a){this.setStatusRightBtnList();
var c=document.createElement("table");c.id="STATUS_BAR_RIGHT_TBL_"+a;c.setAttribute("border","0");c.setAttribute("align","right");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");for(var b=c.insertRow(),d="",e=null,f=null,g="",h=0;h<this.status_right_btn_list.length;h++)g=this.status_right_btn_list[h],d=g_arrIcon[g],e=document.createElement("img"),e.alt=g_arrConst[g][1],e.src=dzeEnvConfig.strPath_Image+"toolbar/"+d,e.style.width="16px",e.style.height="16px",f=eval(g_arrConst[g][3]),
objNewCell=b.insertCell(),objNewCell.width="32",objNewCell.height="30",objNewCell.align="center",objNewCell.title=g_arrConst[g][1],objNewCell.appendChild(e),objNewCell.className="dze_status_command_btn_normal",objNewCell.onmouseover=function(){this.className="dze_status_command_btn_over"},objNewCell.onmouseout=function(){this.className="dze_status_command_btn_normal"},function(){var b=f;objNewCell.onclick=function(d){d=d?d:window.event;b(d,this,a);TBCancelBubbleEvent(d)}}();objNewCell=b.insertCell();
objNewCell.width="10";objNewCell.height="30";objNewCell.innerHTML='<div style="width:auto"></div>';objNewCell=b.insertCell();objNewCell.height="30";objNewCell.appendChild(this.makeZoomRangeSlider(a));objNewCell=b.insertCell();objNewCell.width="20";objNewCell.height="30";objNewCell.innerHTML='<div style="width:auto"></div>';return c},slider_btn_start_ok:!1,slider_btn_start_x:0,slider_mousedown_x:0,slider_btn_obj:null,slider_move_unit_px_plus:6,slider_move_unit_px_minus:1.5,slider_max_zoom_value:400,
slider_min_zoom_value:25,slider_btn_img_min_px:0,slider_btn_img_mid_px:50,slider_btn_img_max_px:99,makeZoomRangeSlider:function(a){try{var c=document.createElement("table");c.id="ZOOM_RANGE_SLIDER_TBL_"+a;c.setAttribute("border","0");c.setAttribute("cellspacing","0");c.setAttribute("cellpadding","0");var b=c.insertRow(),d=b.insertCell();d.width="8";d.height="30";d.className="dze_zoom_range_slider_btn_minus_normal";d.innerHTML='<div style="width:auto"></div>';d.onmouseover=function(){this.className=
"dze_zoom_range_slider_btn_minus_over"};var e=null,f=null;d.onmousedown=function(){if(!(g_objZoom.getDocZoomValue()<=dze_menu_control.slider_min_zoom_value)){var b=g_objZoom.setUnitZoomValue(a,-10);dze_menu_control.setSliderBtnPosition(a,b);e=setTimeout(function(){f=setInterval(function(){var b=g_objZoom.setUnitZoomValue(a,-10);dze_menu_control.setSliderBtnPosition(a,b);b<=dze_menu_control.slider_min_zoom_value&&clearInterval(f)},70)},500)}};d.onmouseup=function(){clearTimeout(e);clearInterval(f);
f=e=null};d.onmouseout=function(){this.className="dze_zoom_range_slider_btn_minus_normal";clearTimeout(e);clearInterval(f);f=e=null};d=b.insertCell();d.width="109";d.height="30";d.className="dze_zoom_range_slider_body";var g=document.createElement("img");g.className="slide_handle_btn";g.style.left="50px";g.id="ZOOM_RANGE_SLIDER_IMG_BTN_"+a;g.src=dzeEnvConfig.strPath_Image+"/toolbar/view_zoom_circle.png";d.appendChild(g);d=b.insertCell();d.width="8";d.height="10";d.className="dze_zoom_range_slider_btn_plus_normal";
d.innerHTML='<div style="width:auto"></div>';d.onmouseover=function(){this.className="dze_zoom_range_slider_btn_plus_over"};var h=null,l=null;d.onmousedown=function(){if(!(g_objZoom.getDocZoomValue()>=dze_menu_control.slider_max_zoom_value)){var b=g_objZoom.setUnitZoomValue(a,10);dze_menu_control.setSliderBtnPosition(a,b);h=setTimeout(function(){l=setInterval(function(){var b=g_objZoom.setUnitZoomValue(a,10);dze_menu_control.setSliderBtnPosition(a,b);b>=dze_menu_control.slider_max_zoom_value&&clearInterval(l)},
70)},500)}};d.onmouseup=function(){clearTimeout(h);clearInterval(l);l=h=null};d.onmouseout=function(){this.className="dze_zoom_range_slider_btn_plus_normal";clearTimeout(h);clearInterval(l);l=h=null};d=b.insertCell();d.width="10";d.height="30";d.innerHTML='<div style="width:auto"></div>';d=b.insertCell();d.width="40";d.height="30";d.className="dze_zoom_range_slider_btn_value_normal";d.id="ZOOM_VALUE_"+a;d.innerHTML="100%";d.onmouseover=function(){this.className="dze_zoom_range_slider_btn_value_over"};
d.onmouseout=function(){this.className="dze_zoom_range_slider_btn_value_normal"};d.onclick=function(b){fnHandler_viewPageZoomDlg(b,this,a,"screen_center")};c.onmousedown=function(b){try{var d=b?b:window.event,c=d.srcElement?d.srcElement:d.target;if("slide_handle_btn"===c.className)dze_menu_control.slider_btn_start_ok=!0,dze_menu_control.slider_btn_start_x=parseInt(c.style.left.replace(/px/,""),10),dze_menu_control.slider_mousedown_x=d.clientX,dze_menu_control.slider_btn_obj=c;else if("dze_zoom_range_slider_body"===
c.className){dze_menu_control.slider_btn_obj=document.getElementById("ZOOM_RANGE_SLIDER_IMG_BTN_"+a);dze_menu_control.slider_mousedown_x=d.clientX;var e=g_objPositionUtil.getNodeElementPosition(c).left,f=dze_menu_control.slider_mousedown_x-e;b=f-4;4>f&&(b=0);b<dze_menu_control.slider_btn_img_min_px&&(b=dze_menu_control.slider_btn_img_min_px);b>dze_menu_control.slider_btn_img_max_px&&(b=dze_menu_control.slider_btn_img_max_px);b>dze_menu_control.slider_btn_img_mid_px-4&&b<dze_menu_control.slider_btn_img_mid_px+
4&&(b=dze_menu_control.slider_btn_img_mid_px);dze_menu_control.slider_btn_obj.style.left=b+"px";if(b>=dze_menu_control.slider_btn_img_mid_px){var g=100+(b-dze_menu_control.slider_btn_img_mid_px)*dze_menu_control.slider_move_unit_px_plus;99<=b&&(g=dze_menu_control.slider_max_zoom_value)}else g=Math.floor(100+(b-dze_menu_control.slider_btn_img_mid_px)*dze_menu_control.slider_move_unit_px_minus),b<=dze_menu_control.slider_btn_img_min_px&&(g=dze_menu_control.slider_min_zoom_value);g_objZoom.zoomDocument(a,
g);dze_menu_control.slider_btn_start_ok=!0;dze_menu_control.slider_btn_start_x=parseInt(dze_menu_control.slider_btn_obj.style.left.replace(/px/,""),10)}}catch(u){dalert(u)}};c.onmousemove=function(b){try{var d=b?b:window.event;if(!0===dze_menu_control.slider_btn_start_ok&&dze_menu_control.slider_btn_obj){var c=dze_menu_control.slider_btn_start_x+(d.clientX-dze_menu_control.slider_mousedown_x);c<dze_menu_control.slider_btn_img_min_px&&(c=dze_menu_control.slider_btn_img_min_px);c>dze_menu_control.slider_btn_img_max_px&&
(c=dze_menu_control.slider_btn_img_max_px);c>dze_menu_control.slider_btn_img_mid_px-4&&c<dze_menu_control.slider_btn_img_mid_px+4&&(c=dze_menu_control.slider_btn_img_mid_px);dze_menu_control.slider_btn_obj.style.left=c+"px";if(c>=dze_menu_control.slider_btn_img_mid_px){var e=100+(c-dze_menu_control.slider_btn_img_mid_px)*dze_menu_control.slider_move_unit_px_plus;99<=c&&(e=dze_menu_control.slider_max_zoom_value)}else e=Math.floor(100+(c-dze_menu_control.slider_btn_img_mid_px)*dze_menu_control.slider_move_unit_px_minus),
c<=dze_menu_control.slider_btn_img_min_px&&(e=dze_menu_control.slider_min_zoom_value);throttle(g_objZoom,g_objZoom.zoomDocument,a,e)}}catch(q){dalert(q)}};c.onmouseup=function(a){try{dze_menu_control.slider_btn_start_ok=!1,dze_menu_control.slider_btn_start_x=0,dze_menu_control.slider_mousedown_x=0,dze_menu_control.slider_btn_obj=null}catch(p){dalert(p)}};c.onmouseleave=function(a){try{dze_menu_control.slider_btn_start_ok=!1,dze_menu_control.slider_btn_start_x=0,dze_menu_control.slider_mousedown_x=
0,dze_menu_control.slider_btn_obj=null}catch(p){dalert(p)}};return c}catch(n){dalert(n)}},setSliderBtnPosition:function(a,c){if(a=document.getElementById("ZOOM_RANGE_SLIDER_IMG_BTN_"+a)){var b=50;100>c?b+=Math.floor((c-100)/dze_menu_control.slider_move_unit_px_minus):100<c&&(b+=Math.floor((c-100)/dze_menu_control.slider_move_unit_px_plus));a.style.left=b+"px"}},ui_mode:"ribbon",getUiMode:function(){try{this.ui_mode="ribbon";if(oneffice.bTempLoadedContent)return this.ui_mode;if("undefined"==typeof dzeUiConfig.arrCustomMenuUiType||
0==dzeUiConfig.arrCustomMenuUiType.length||!inArray("ribbon",dzeUiConfig.arrCustomMenuUiType))return this.setUiMode(this.ui_mode),this.ui_mode;if(1==dzeUiConfig.arrCustomMenuUiType.length)return this.setUiMode(dzeUiConfig.arrCustomMenuUiType[0]),this.ui_mode;this.ui_mode=dzeUiConfig.arrCustomMenuUiType[0];if("undefined"!=typeof localStorage)try{localStorage.getItem("dzeUiMode")&&(this.ui_mode=localStorage.getItem("dzeUiMode"))}catch(a){dalert(a)}inArray(this.ui_mode,dzeUiConfig.arrCustomMenuUiType)||
(this.ui_mode="ribbon");this.setUiMode(this.ui_mode);return this.ui_mode}catch(a){dalert(a)}},setUiMode:function(a){try{if(this.ui_mode=a,"undefined"!=typeof localStorage)try{localStorage.setItem("dzeUiMode",a)}catch(c){dalert(c)}}catch(c){dalert(c)}},showMenuUi:function(a){try{!0!==dzeUiConfig.bCustomize_MenuBar_Display&&this.setUiMode("basic"),"ribbon"==this.getUiMode()?dze_menu_control.showRibbonUi(a):dze_menu_control.showBasicUi(a)}catch(c){dalert(c)}},keep_check_ribbon_menu:!0,showRibbonUi:function(a){try{this.initEditorUi(),
g_bMenuBar_Display&&(document.getElementById("TB_CONTAINER_MENU_"+a).parentNode.style.display="none"),g_bToolBar1_Display&&(document.getElementById("TB_CONTAINER_TOOL_1_"+a).parentNode.style.display="none"),g_bToolBar2_Display&&(document.getElementById("TB_CONTAINER_TOOL_2_"+a).parentNode.style.display="none"),g_bToolBar3_Display&&(document.getElementById("TB_CONTAINER_TOOL_3_"+a).parentNode.style.display="none"),this.createRibbonMenu(a),document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a).parentNode.style.display=
"",this.initTitle(a),this.moveTBIcon_BasicUi_To_TbContainer(a),this.moveTBIcon_TbContainer_To_Left_RibbonUi(a),this.moveTBIcon_TbContainer_To_Right_RibbonUi(a),this.moveTBIcon_TbContainer_To_Bottom_RibbonUi(a),!0!==this.keep_check_ribbon_menu&&(this.curr_checked_menu[a]=0),this.activateMenu(this.curr_checked_menu[a],a),this.setUiMode("ribbon"),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,g_arrEditorHeight[a]),this.addRibbonUiEvent(a),this.movePropertyMenuBox_BasicUi_To_RibbonUi(a),
!1!==g_objOnefficeEditor.isDocumentLoaded&&editor_onselectionchange(a)}catch(c){dalert(c)}},showBasicUi:function(a){try{if(dlog("showBasicUi"),this.addTitleToBasicUi(a),this.initTitle(a),!0===this.ribbon_menu_created[a]||"basic"!=this.ui_mode)this.initEditorUi(),g_bMenuBar_Display&&(document.getElementById("TB_CONTAINER_MENU_"+a).parentNode.style.display=""),g_bToolBar1_Display&&(document.getElementById("TB_CONTAINER_TOOL_1_"+a).parentNode.style.display=""),g_bToolBar2_Display&&(document.getElementById("TB_CONTAINER_TOOL_2_"+
a).parentNode.style.display=""),g_bToolBar3_Display&&(document.getElementById("TB_CONTAINER_TOOL_3_"+a).parentNode.style.display=""),document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a).parentNode.style.display="none",this.moveTBIcon_TbContainer_To_BasicUi(a),this.setUiMode("basic"),g_bEditorHeightIFrameYN?resizeEditor_Height(a):resizeEditor_Height(a,g_arrEditorHeight[a]),this.removeRibbonUiMouseEvent(a),this.movePropertyMenuBox_RibbonUi_To_BasicUi(a)}catch(c){dalert(c)}},addTitleToBasicUi:function(a){a=
document.getElementById("TB_MENU_EMPTY_AREA_"+a);a.className="dze_ribbon_menu_title_bg";a.style="vertical-align:middle;text-align:center;";a.innerHTML='<input type="text" id="dze_ribbon_menu_title_text_toolbar" dze_auto_resize autocomplete="off" style="display:none;" tabindex="-1" title="'+ID_RES_STRING_DOCUMENT_NAME+'"></input>'},initEditorUi:function(){try{g_objLayerEventUtil.initHideDynamicLayer(),g_objWrapperOutlineResize.resetExtOutlineInfo(),duzon_menubar.closeHiddenTbContainerTool(),duzon_dialog.closeExtendsDlg(),
duzon_dialog.closeDialog()}catch(a){dalert(a)}},ribbon_menu_created:[],createRibbonMenu:function(a){try{if(!0!==this.ribbon_menu_created[a]){var c=objOnefficeLoader.getAppEnvType()===APPENV.GW,b=document.getElementById("TB_CONTAINER_MENU_RIBBON_"+a);document.getElementById("TB_CONTAINER_MENU_"+a);var d='<table style="width:100%;border:0px;" cellSpacing="0" cellPadding="0" border="0">';d+="<tr>";d+='<td valign="center">';d+='<table width="100%" height="33" cellSpacing="0" cellPadding="0" border="0" id="RIBBON_CONTAINER_TITLE_'+
a+'">';d+="<tr>";d+='<td width="76" class="dze_ribbon_menu_title_bg">';d+="<a"+(c?' href="'+getFullUrlFromPath(g_dzEditorBasePath+"index.html")+'" target="_blank"':"")+'  tabindex="-1"  style="margin-left:15px;">';d+='<img width="93" height="17" src="./image/oneffice_logo_white.png" title="'+(c?ID_RES_STRING_GO_TO_HOME:"")+'"/>';d+="</a>";d+="</td>";d+='<td class="dze_ribbon_menu_title_bg" style="vertical-align:middle;text-align:center;">';d+='<input type="text" id="dze_ribbon_menu_title_text" dze_auto_resize autocomplete="off" style="display:none;" tabindex="-1" title="'+
ID_RES_STRING_DOCUMENT_NAME+'"></input>';d+="</td>";d+='<td width="76" class="dze_ribbon_menu_title_bg" id="TB_MENU_PROPERTY_TD_RIBBON_'+a+'">';d+="</td>";d+="</tr>";d+="</table>";d+="</td>";d+="</tr>";d+="<tr>";d+='<td valign="center">';d+='<table width="100%" height="29" cellSpacing="0" cellPadding="0" border="0" id="RIBBON_CONTAINER_MENU_'+a+'">';d+='<tr height="30" id="TB_MENUBAR_RIBBON_'+a+'">';d+='<td class="dze_ribbon_menu_title_bg">';d+='<table style="width:100%;border:0px;white-space:nowrap;" cellSpacing="0" cellPadding="0" border="0">';
d+='<tr valign="center" height="30" id="TB_MENUBAR_RIBBON_'+a+'">';d+='<td class="dze_ribbon_menu_left"><div class="dze_ribbon_menu_left"></div></td>';for(c=0;c<dze_menu_control.tb_menu_list.length;c++)d=c<this.idxDynamicMenuStart?d+('<td id="TB_MENU_RIBBON_'+c+"_"+a+'" class="dze_ribbon_menu_off"><span class="dze_ribbon_menu_text_normal">'+dze_menu_control.tb_menu_list[c]+"</span></td>"):d+('<td id="TB_MENU_RIBBON_'+c+"_"+a+'" class="dze_ribbon_d_menu_hide"><span class="dze_ribbon_menu_text_normal">'+
dze_menu_control.tb_menu_list[c]+"</span></td>");d+='<td class="dze_ribbon_menu_right"><div style="width:auto"></div></td>';d+="</tr>";d+="</table>";d+="</td>";d+="</tr>";d+="</table>";d+="</td>";d+="</tr>";d+="<tr>";d+='<td id="TB_MENU_RIBBON_CONTENT_CONTAINER_'+a+'">';d+='<div id="TB_MENU_RIBBON_CONTENT_DYNAMIC_CONTAINER_'+a+'" class="dze_style_ribbon_content_dynamic_container">';d+='<table border="0" width="100%" cellspacing="0" cellpadding="0" id="TB_MENU_RIBBON_CONTENT_TBL_MAIN_'+a+'" style="position:relative;">';
d+="<tr>";0<this.tb_menu_content_left_list.length&&(d+='<td height="68" width="24" class="dze_ribbon_tb_content_left_td"><div class="dze_ribbon_tb_content_left" id="TB_MENU_RIBBON_CONTENT_LEFT_'+a+'"></div></td>');d+='<td height="68">';d+='<table border="0" width="100%" height="62" cellspacing="0" cellpadding="0">';d+="<tr>";d+='<td style="overflow:hidden">';for(c=0;c<dze_menu_control.tb_menu_list.length;c++)d+='<div class="dze_ribbon_tb_content" id="TB_MENU_RIBBON_CONTENT_'+c+"_"+a+'"></div>';d+=
"</td>";d+="</tr>";d+="</table>";d+="</td>";0<this.tb_menu_content_right_list.length&&(d+='<td class="dze_ribbon_tb_content_right_td">',d+='<div class="dze_ribbon_tb_content_right" id="TB_MENU_RIBBON_CONTENT_RIGHT_'+a+'"></div></div>',d+="</td>");d+="</tr>";d+="</table>";d+="</div>";d+='<table border="0" width="100%" cellspacing="0" cellpadding="0" id="TB_MENU_RIBBON_CONTENT_TBL_BOTTOM_'+a+'">';d+="<tr>";d+='<td colspan="3" class="dze_ribbon_tb_content_bottom_td">';d+='<table border="0" width="100%" height="28" cellspacing="0" cellpadding="0">';
d+="<tr>";d+='<td style="overflow:hidden">';d+='<div class="dze_ribbon_tb_content_bottom" id="TB_MENU_RIBBON_CONTENT_BOTTOM_'+a+'"></div>';d+="</td>";d+="</tr>";d+="</table>";d+="</td>";d+="</tr>";d+="</table>";d+="</td>";b.innerHTML=d+"</tr></table>";dze_menu_control.createRibbonHideButton(a);dze_menu_control.addRibbonMenuEvent(a);dze_menu_control.ribbon_menu_created[a]=!0}}catch(e){dalert(e)}},createRibbonHideButton:function(a){try{var c=document.querySelector("td.dze_ribbon_menu_right");if(c){var b=
document.createElement("div");b.id="dze_idx_btn_ribbon_hide_"+a;b.className="dze_style_btn_ribbon_hide";b.innerHTML='<img width="14px" height="14px" src="'+(dzeEnvConfig.strPath_Image+"ribbon/ico_cloud_arrow_up_default.png")+'">';b.title=ID_RES_CONST_STRING_HIDE_RIBBON_TOOLBARS;b.onmouseover=function(){this.className="dze_style_btn_ribbon_hide_over";this.childNodes[0].src=this.childNodes[0].src.replace("ico_cloud_arrow_up_default.png","ico_cloud_arrow_up_over.png")};b.onmousedown=function(){this.className=
"dze_style_btn_ribbon_hide_down"};b.onmouseup=function(){this.className="dze_style_btn_ribbon_hide_over"};b.onmouseout=function(){this.className="dze_style_btn_ribbon_hide";this.childNodes[0].src=this.childNodes[0].src.replace("ico_cloud_arrow_up_over.png","ico_cloud_arrow_up_default.png")};b.onclick=function(){dze_menu_control.bShowStatusRibbonMainMenu=!1;dze_menu_control.showRibbonMainMenuContainer(a,!1);this.style.display="none";var b=document.getElementById("dze_idx_btn_ribbon_dock_"+a);b&&(b.style.display=
"")};var d=document.createElement("div");d.id="dze_idx_btn_ribbon_dock_"+a;d.className="dze_style_btn_ribbon_hide";d.style.display="none";d.innerHTML='<img width="14px" height="14px" src="'+(dzeEnvConfig.strPath_Image+"ribbon/ico_pin_default.png")+'">';d.title=ID_RES_CONST_STRING_SHOW_RIBBON_TOOLBARS_ALWAYS;d.onmouseover=function(){this.className="dze_style_btn_ribbon_hide_over";this.childNodes[0].src=this.childNodes[0].src.replace("ico_pin_default.png","ico_pin_over.png")};d.onmousedown=function(){this.className=
"dze_style_btn_ribbon_hide_down"};d.onmouseup=function(){this.className="dze_style_btn_ribbon_hide_over"};d.onmouseout=function(){this.className="dze_style_btn_ribbon_hide";this.childNodes[0].src=this.childNodes[0].src.replace("ico_pin_over.png","ico_pin_default.png")};d.onclick=function(){dze_menu_control.bShowStatusRibbonMainMenu=!0;dze_menu_control.showRibbonMainMenuContainer(a,!0);this.style.display="none";var b=document.getElementById("dze_idx_btn_ribbon_hide_"+a);b&&(b.style.display="")};c.appendChild(b);
c.appendChild(d)}}catch(e){dalert(e)}},bShowStatusRibbonMainMenu:!0,showRibbonMainMenuContainer:function(a,c){try{"undefined"==typeof c&&(c=!0);document.getElementById("TB_MENU_RIBBON_CONTENT_DYNAMIC_CONTAINER_"+a);var b=document.getElementsByClassName("dze_ribbon_tb_content_bottom_td")[0];!0===c?(this.slideRibbonToolContainer(a,"down"),b.style.borderWidth="1px 0 0 0"):(this.slideRibbonToolContainer(a,"up"),b.style.borderWidth="0px");var d=document.getElementById("TB_CONTAINER_"+a);d.parentNode.setAttribute("height",
d.offsetHeight);d.parentNode.style.height=d.offsetHeight+"px";resizeEditor_Height(a)}catch(e){dalert(e)}},slideRibbonToolContainer:function(a,c){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_DYNAMIC_CONTAINER_"+a),d="up"==c?68:0;if("down"!=c||"none"==b.style.display)if("up"!=c||"none"!=b.style.display)if(g_bBrowserType_IE)b.style.display="down"==c?"":"none";else{b.style.display="";b.style.overflow="hidden";var e=setInterval(function(){"up"==c?(d-=15,0>=d&&(d=0)):(d+=15,68<=d&&(d=68));b.style.height=
d+"px";var f=document.getElementById("TB_CONTAINER_"+a);f.parentNode.setAttribute("height",f.offsetHeight);f.parentNode.style.height=f.offsetHeight+"px";resizeEditor_Height(a);g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a);g_objTableMiniMenu.onWheel(a);0==d&&(b.style.display="none");68==d&&(b.style.display="");if(68==d||0==d)clearInterval(e),b.style.overflow=""},30)}},addRibbonMenuEvent:function(a){try{"undefined"==
typeof a&&(a=this.nEditNumber);this.setEditNumber(a);for(var c=null,b=0;b<this.tb_menu_list.length;b++)c=document.getElementById("TB_MENU_RIBBON_"+b+"_"+a),c.TBSTATE=b<this.idxDynamicMenuStart?ID_STRING_NAME_UNCHECKED:ID_STRING_NAME_HIDE,c.onclick=function(){if(this.TBSTATE!=ID_STRING_NAME_GRAY){if(this.TBSTATE==ID_STRING_NAME_UNCHECKED){var b=this.id.replace("TB_MENU_RIBBON_","").split("_").shift();dze_menu_control.activateMenu(b,a)}!1===dze_menu_control.bShowStatusRibbonMainMenu&&dze_menu_control.showRibbonMainMenuContainer(a,
!0)}},c.onmouseover=function(){this.TBSTATE!=ID_STRING_NAME_GRAY&&"dze_ribbon_menu_off"==this.className&&(this.className="dze_ribbon_menu_off_over")},c.onmouseout=function(){this.TBSTATE!=ID_STRING_NAME_GRAY&&"dze_ribbon_menu_off_over"==this.className&&(this.className="dze_ribbon_menu_off")}}catch(d){dalert(d)}},setMenuItemProperty:function(a,c,b){try{if("undefined"==typeof b&&(b=this.nEditNumber),-1!=b){var d=document.getElementById("TB_MENU_RIBBON_"+c+"_"+b);a==ID_STRING_NAME_CHECKED?(d.className=
c<this.idxDynamicMenuStart?"dze_ribbon_menu_on":"dze_ribbon_d_menu_on",d.TBSTATE=ID_STRING_NAME_CHECKED,this.setTBItemTextGray(!1,c,b),c===this.idxImagePropertyMenu?this.setTBImageSizeInfo(b):c===this.idxShapePropertyMenu?this.setTBShapeSizeInfo(b):c===this.idxVideoPropertyMenu&&this.setTBVideoSizeInfo(b)):a==ID_STRING_NAME_UNCHECKED?(d.className=c<this.idxDynamicMenuStart?"dze_ribbon_menu_off":"dze_ribbon_d_menu_off",d.TBSTATE=ID_STRING_NAME_UNCHECKED,this.setTBItemTextGray(!1,c,b)):a==ID_STRING_NAME_GRAY?
(d.TBSTATE=ID_STRING_NAME_GRAY,this.setTBItemTextGray(!0,c,b)):a==ID_STRING_NAME_HIDE&&(d.TBSTATE=ID_STRING_NAME_HIDE,d.className="dze_ribbon_d_menu_hide")}}catch(e){dalert(e)}},setTBItemTextGray:function(a,c,b){try{"undefined"==typeof b&&(b=this.nEditNumber),document.getElementById("TB_MENU_RIBBON_"+c+"_"+b).childNodes[0].className=a?"dze_ribbon_menu_text_gray":"dze_ribbon_menu_text_normal",a||document.getElementById("TB_MENU_RIBBON_CONTENT_"+c+"_"+b).getElementsByTagName("div")}catch(d){dalert(d)}},
activateMenu:function(a,c){try{if(console.log(a),0>a&&(a=0),!0!==g_readonlyMode||0==a||4==a||a==dze_menu_control.idxTempSaveMenu)if(dzeWebSearch.hideWebSearchBtn(),duzon_menubar.hideTwoDepthMenu(),"undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);if(b){if(this.curr_checked_menu[[c]]==a&&b.childNodes.length){var d=!1;if(a===this.idxShapePropertyMenu&&0<g_objSelectedShapesArray.length)d=!0;else{var e=getSelectionControl(c).controlObject;
b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+this.idxImagePropertyMenu+"_"+c);var f=g_arrConst[ID_COMMAND_MODIFY_CHART_ATTR][2]+"_"+c,g=b.getElementsByTagName("div");b=!1;for(var h=0;h<g.length;h++)if(g[h].id===f){b=!0;break}e&&"IMG"===e.nodeName&&(!0===b&&null!=e.getAttribute("chart_id")||!1===b)&&(d=!0)}if(d){this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c);a===this.idxImagePropertyMenu&&this.setChartModifyToolbarIcon(c);return}}0<=this.curr_checked_menu[c]&&this.isShowMenu(this.curr_checked_menu[c])&&
this.uncheckMenu(this.curr_checked_menu[c],c);this.curr_checked_menu[c]<this.idxDynamicMenuStart&&(this.prev_checked_menu[c]=this.curr_checked_menu[c]);this.curr_checked_menu[c]=a;this.activateMenuDetail(a,c);this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c);g_readonlyMode?g_objOnefficeEditor.disableAllMenuCtrl(c):g_objOnefficeEditor.updateAllMenuCtrl(c);this.showAllTBState(c)}}}catch(l){dalert(l)}},deactivateMenu:function(a,c){try{if("undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){var b=
document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);b.TBSTATE!=ID_STRING_NAME_GRAY&&(b.TBSTATE=ID_STRING_NAME_UNCHECKED);a<this.idxDynamicMenuStart?this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c):this.setMenuItemProperty(ID_STRING_NAME_HIDE,a,c);this.deactivateMenuDetail(a,c)}}catch(d){dalert(d)}},uncheckMenu:function(a,c){try{if("undefined"===typeof c&&(c=g_nActiveEditNumber),-1!==c){var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);b&&(b.TBSTATE!=ID_STRING_NAME_GRAY&&(b.TBSTATE=ID_STRING_NAME_UNCHECKED),
this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c),this.deactivateMenuDetail(a,c))}}catch(d){dalert(d)}},activateMenuDetail:function(a,c){try{if(-1!=c){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);"block"!=b.style.display&&(this.moveTBIcon_TbContainer_To_Main_RibbonUi(a,c),b.style.display="block",dze_menu_control.setShowHideRibbonMainToolbars(a,c))}}catch(d){dalert(d)}},deactivateMenuDetail:function(a,c){try{this.moveTBIcon_Main_RibbonUi_To_TbContainer(a,c),document.getElementById("TB_MENU_RIBBON_CONTENT_"+
a+"_"+c).style.display="none"}catch(b){dalert(b)}},isShowMenu:function(a,c){try{if("undefined"==typeof c&&(c=g_nActiveEditNumber),-1!=c){var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);return b&&b.TBSTATE!=ID_STRING_NAME_HIDE?!0:!1}}catch(d){dalert(d)}},setShowHideRibbonMainToolbars:function(a,c){try{"undefined"==typeof a&&(a=dze_menu_control.curr_checked_menu[c]),"undefined"==typeof c&&(c=g_nActiveEditNumber),0>c||0>a||(dze_menu_control.resizeTbContentDiv(a,c),dze_menu_control.removeBtnMoreRibbonTb("main",
"left",a,c),dze_menu_control.removeBtnMoreRibbonTb("main","right",a,c),dze_menu_control.makeBtnMoreRibbonTb("main","right",a,c),dze_menu_control.resizeTbContentDiv(a,c))}catch(b){dalert(b)}},setShowHideRibbonBottomToolbars:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber),0>a||(dze_menu_control.resizeTbContentDiv("",a),dze_menu_control.removeBtnMoreRibbonTb("bottom","left","",a),dze_menu_control.removeBtnMoreRibbonTb("bottom","right","",a),dze_menu_control.makeBtnMoreRibbonTb("bottom",
"right","",a),dze_menu_control.resizeTbContentDiv("",a))}catch(c){dalert(c)}},makeBtnMoreRibbonTb:function(a,c,b,d){try{"undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]);"undefined"==typeof d&&(d=g_nActiveEditNumber);if(0>d||0>b)return null;if("main"==a)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==a)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return null;if(null==e)return null;var f=e.childNodes[0];if(null==f)return null;
if(window.innerWidth>f.offsetWidth)return dze_menu_control.removeBtnMoreRibbonTb(a,"left",b,d),dze_menu_control.removeBtnMoreRibbonTb(a,"right",b,d),e.style.marginLeft="0px",null;var g=g_objNodeUtil.getLoopParentElement(e,"table");if("right"==c){var h=g.rows[0].cells[g.rows[0].cells.length-1];if("btnMore"!=h.getAttribute("type")){if("main"==a)var l="duzon_btn_view_hidden_ribbon_toolbar_next",n="duzon_btn_view_hidden_ribbon_toolbar_next_down",p="duzon_btn_view_hidden_ribbon_toolbar_next_over";else l=
"duzon_btn_view_hidden_ribbon_toolbar_next_bottom",n="duzon_btn_view_hidden_ribbon_toolbar_next_down_bottom",p="duzon_btn_view_hidden_ribbon_toolbar_next_over_bottom";h=g.rows[0].insertCell();h.setAttribute("type","btnMore");h.width=13;h.className=l;h.onmousedown=function(){this.className=n};h.onmouseup=function(){this.className=p};h.onmouseover=function(){this.className=p};h.onmouseout=function(){this.className=l}}h.onclick=function(){dze_menu_control.viewMoreRibbonTb(this,a,b,d)};return h}if("left"==
c){var m=g.rows[0].cells[0];if("btnMore"!=m.getAttribute("type")){if("main"==a)var k="duzon_btn_view_hidden_ribbon_toolbar_prev",q="duzon_btn_view_hidden_ribbon_toolbar_prev_down",r="duzon_btn_view_hidden_ribbon_toolbar_prev_over";else k="duzon_btn_view_hidden_ribbon_toolbar_prev_bottom",q="duzon_btn_view_hidden_ribbon_toolbar_prev_down_bottom",r="duzon_btn_view_hidden_ribbon_toolbar_prev_over_bottom";m=g.rows[0].insertCell(0);m.setAttribute("type","btnMore");m.width=13;m.className=k;m.onmousedown=
function(){this.className=q};m.onmouseup=function(){this.className=r};m.onmouseover=function(){this.className=r};m.onmouseout=function(){this.className=k}}m.onclick=function(){dze_menu_control.viewMoreRibbonTb(this,a,b,d)};return m}return null}catch(u){return dalert(u),null}},removeBtnMoreRibbonTb:function(a,c,b,d){try{"undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]);"undefined"==typeof d&&(d=g_nActiveEditNumber);if(0>d||0>b)return 0;if("main"==a)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+
b+"_"+d);else if("bottom"==a)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return 0;var f=g_objNodeUtil.getLoopParentElement(e,"table");if(!f)return 0;a=0;if("right"==c){var g=f.rows[0].cells[f.rows[0].cells.length-1];"btnMore"==g.getAttribute("type")&&(a=g.offsetWidth,g.parentNode.removeChild(g))}else if("left"==c){var h=f.rows[0].cells[0];"btnMore"==h.getAttribute("type")&&(a=h.offsetWidth,h.parentNode.removeChild(h));e.style.marginLeft="0px"}return a}catch(l){return dalert(l),
0}},resizeTbContentDiv:function(a,c){try{if("undefined"==typeof a||""==a)a=dze_menu_control.curr_checked_menu[c];"undefined"==typeof c&&(c=g_nActiveEditNumber);if(!(0>c||0>a)){var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c);if(null!=b){var d=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+c);null!=d&&(b.style.width="1px",d.style.width="1px",b.style.width=b.parentNode.offsetWidth-1+"px",d.style.width=d.parentNode.offsetWidth-1+"px")}}}catch(e){return dalert(e),null}},viewMoreRibbonTb:function(a,
c,b,d){try{if(a&&("undefined"==typeof b&&(b=dze_menu_control.curr_checked_menu[d]),"undefined"==typeof d&&(d=g_nActiveEditNumber),!(0>d||0>b))){if("main"==c)var e=document.getElementById("TB_MENU_RIBBON_CONTENT_"+b+"_"+d);else if("bottom"==c)e=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+d);else return;var f=e.childNodes[0];if(null!=f){var g=f.offsetWidth+20-window.innerWidth;if(0<a.cellIndex){var h=dze_menu_control.makeBtnMoreRibbonTb(c,"left",b,d);dze_menu_control.removeBtnMoreRibbonTb(c,
"right",b,d);e.style.marginLeft=-h.offsetWidth+"px";dze_menu_control.slideMoveRibbonTb(e,"left",-g)}else{dze_menu_control.makeBtnMoreRibbonTb(c,"right",b,d);var l=dze_menu_control.removeBtnMoreRibbonTb(c,"left",b,d);e.style.marginLeft=-g+l+"px";dze_menu_control.slideMoveRibbonTb(e,"right",0)}}}}catch(n){dalert(n)}},slideMoveRibbonTb:function(a,c,b){try{var d=parseInt(a.style.marginLeft.replace(/px/,""),10),e=0,f="left"==c?-5:5,g=setInterval(function(){e++;1E3<e?(a.style.marginLeft=b+"px",clearInterval(g)):
(d+=f,"left"==c?d<=b&&(d=b):d>=b&&(d=b),d==b?(a.style.marginLeft=d+"px",clearInterval(g)):a.style.marginLeft=d+"px")},7)}catch(h){dalert(h)}},makeTB:function(a,c){try{if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_BUTTON)return this.makeTB_Button(a,c);if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_COMBOBOX){var b=0,d=0;ID_COMMAND_FONT_NAME==a?(b=102,d=2):ID_COMMAND_FONT_SIZE==a||ID_COMMAND_HEADING_SIZE==a?(b=72,d=1):ID_COMMAND_LETTER_SPACING==a||ID_COMMAND_LINE_HEIGHT==a?(b=52,d=1):ID_COMMAND_STYLE_TEMPLATE_COMBO===
a&&(b=80,d=1);return this.makeTB_ComboBox(a,b,d,c)}return g_arrConst[a][6]==ID_TYPE_TOOLBAR_DROPDOWN?this.makeTB_DropDown(a,c):g_arrConst[a][6]==ID_TYPE_TOOLBAR_SPINNER?this.makeTB_Spinner(a,c):g_arrConst[a][6]==ID_TYPE_TOOLBAR_FILE_OPEN_FORM?this.makeTB_FileOpenForm(a,c):g_arrConst[a][6]==ID_TYPE_TOOLBAR_GALLERY?this.makeTB_Gallery(a,c):""}catch(e){dalert(e)}},makeTB_Button:function(a,c){try{var b=g_arrConst[a][1];shortcutsMenuList[a]&&(b=g_arrConst[a][1]+" ["+shortcutsMenuList[a]+"]");return'<div orgCommandId="'+
a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+b+'" TBTYPE="toggle" style="overflow:hidden;"><div class="duzon_tb_button_image"><img src="'+g_strBlankImageData+'" _src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[a][1]+'"></div></div>'}catch(d){dalert(d)}return""},makeTB_FileOpenForm:function(a,c){try{var b="i_nm_"+(g_strEditObjectName+"_"+(parseInt(c,10)+DZE_IFRAME_TMP_NO)),d='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+
"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';d+='<div class="duzon_tb_button_image"><img src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" style="vertical-align:baseline;border:none;" alt="'+g_arrConst[a][1]+'" /></div>';d+="<div>";d+='<form name="FRM_NM_'+g_arrConst[a][2]+"_"+c+'" id="FRM_ID_'+g_arrConst[a][2]+"_"+c+'" method="post" enctype="multipart/form-data" target="'+b+'">';d+='<input type="file" name="openfile" value="" class="duzon_tb_button_file_form" accept="'+
g_arrConst[a][7]+'" />';d+="</form>";return d+"</div></div>"}catch(e){dalert(e)}return""},makeTB_ComboBox:function(a,c,b,d){try{var e="";e+='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+d+'" TBTYPE="toggle" style="line-height:0;width:'+c+'px;overflow:hidden;" title="'+g_arrConst[a][1]+'">';e+='<table style="width:'+c+'px;border:0px;table-layout:fixed;line-height:0;" cellSpacing="0" cellPadding="0">';e+="<tr>";g_bBrowserType_WK?g_bDocType_XHTML?(e+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',e+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(e+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span>&nbsp;</td>',e+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):g_bDocType_XHTML?(e+='<td style="line-height:0;height:15px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span></td>',e+='<td style="line-height:0;width:14px;height:15px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>'):(e+='<td style="line-height:0;height:16px;text-align:left;border-left:1px;border-top:0px;border-bottom:0px;padding-left:2px;padding-top:2px;padding-right:0px;padding-bottom:0px;" class="tbComboBox_AreaLabel_'+
b+'"><span id="'+g_arrConst[a][2]+"_"+d+'_LABEL" style="line-height:0;"></span></td>',e+='<td style="line-height:0;width:16px;height:16px;border-top:0px;border-right:1px;border-bottom:0px;padding:0px;" class="'+g_strSkin_ComboBox_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></td>');e+="</tr>";return e+"</table></div>"}catch(f){dalert(f)}return""},makeTB_DropDown:function(a,c){try{var b="";b+='<div orgCommandId="'+a+'" id="'+
g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';b+='<table style="width:100%;border:0px;table-layout:auto;" cellSpacing="0" cellPadding="0" width="30">';b+="<tr>";b+='<td width="18" style="line-height:0;height:20px;border:0px;padding:0px;">';b+='<div class="tbDropDown_AreaButton"><div class="tb_DropDown_Button_Image"><img src="'+g_strBlankImageData+'" _src="'+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+'" alt="'+g_arrConst[a][1]+'" style="vertical-align:baseline;border:none;width:24px;height:24px;"></div></div>';
switch(a){case ID_COMMAND_FORE_COLOR:b+='<div id="TB_SETFORECOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_BACK_COLOR:b+='<div id="TB_SETBACKCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';break;case ID_COMMAND_TABLE_CELL_BACKCOLOR:b+='<div id="TB_SETCELLBACKCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';
break;case ID_COMMAND_IMAGE_BORDER_COLOR:b+='<div id="TB_SETIMAGEBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_TABLE_BORDER_COLOR:b+='<div id="TB_SETTABLEBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_HIGHLIGHTER:b+='<div id="TB_HIGHLIGHTER_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';
break;case ID_COMMAND_TEXTBOX_FILL_COLOR:b+='<div id="TB_FILLCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';break;case ID_COMMAND_TEXTBOX_LINE_COLOR:b+='<div id="TB_LINECOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';break;case ID_COMMAND_VIDEO_BORDER_COLOR:b+='<div id="TB_SETVIDEOBORDERCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>';
break;case ID_COMMAND_SHAPES_FILL:b+='<div id="TB_SHAPEFILLCOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#FFFFFF;"></div>';break;case ID_COMMAND_SHAPES_BORDER:b+='<div id="TB_SHAPELINECOLOR_'+c+'_SUB_color_selector" class="dze_color_picker_result_line" style="background-color:#000000;"></div>'}b+="</td>";b+='<td width="13" style="line-height:0;height:20px;border:0px;padding:0px;vertical-align:middle;">';b+='<div id="'+g_arrConst[a][2]+"_"+c+'_SUB" class="'+
g_strSkin_DropDown_AreaArrow+'"><img src="'+g_strBlankImageData+'" alt="" width="1" height="1" style="vertical-align:baseline;border:none;"></div>';b+="</td>";b+="</tr>";return b+"</table></div>"}catch(d){dalert(d)}return""},makeTB_Spinner:function(a,c){try{var b=g_arrConst[a][10],d=g_arrConst[a][11],e="dze_form_"+g_arrConst[a][2]+"_"+c,f='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+g_arrConst[a][1]+'" TBTYPE="toggle" style="overflow:hidden;">';f+="<table width='100%' align='' border='0' cellpadding='0' cellspacing='0'>";
f+="<tr>";f+="<td width='16'>"+("<img src='"+g_strBlankImageData+"' _src='"+dzeEnvConfig.strPath_Image+"toolbar/"+g_arrIcon[a]+"'>")+"</td>";f+="<td width='100%' class='dze_ribbon_tb_spinner_item_text'>"+g_arrConst[a][1]+": </td>";f+="<td class='dze_ribbon_tb_spinner_input_form_container'>";f+=DzeSpinner.getHTML({id:e,width:67,height:24,unit:d,value:b});f+="</td>";f+="</tr>";return f+"</table></div>"}catch(g){dalert(g)}},makeTB_Gallery:function(a,c){try{var b=g_arrConst[a][1];shortcutsMenuList[a]&&
(b=g_arrConst[a][1]+" ["+shortcutsMenuList[a]+"]");var d=getStyleTemplateName(),e=[];a===ID_COMMAND_STYLE_TEMPLATE&&forEach(d,function(a,b){-1===b?e.push('<div class="dze_ribbon_tb_left_separator" style="width: 2px; height: 43px; margin: 3px 2px 0 2px;"></div>'):e.push('<div class="duzon_tb_button_gallery_item_ribbon" title="'+b+'">'+getStyleTemplateHtml(b,"gallery")+"</div>")},this);d="";d+='<div orgCommandId="'+a+'" id="'+g_arrConst[a][2]+"_"+c+'" title="'+b+'" TBTYPE="toggle" style="overflow:hidden;">';
d+='<div style="display:flex;">';d+=e.join("");return d+"</div></div>"}catch(f){dalert(f)}},checkCommandIdInTbContainer:function(a,c){try{var b=this.TB_CONTAINER[c].getElementsByTagName("div");c=!1;for(var d=0;d<b.length;d++)if(b[d].getAttribute("orgCommandId")==a){c=!0;break}return c}catch(e){dalert(e)}},changeImageSrc:function(a,c){try{if(a){var b=c?/\/ribbon\//:/\/toolbar\//;c=c?"/toolbar/":"/ribbon/";var d=a.getAttribute("_src");d?(a.removeAttribute("_src"),a.src=d.replace(b,c)):a.src=a.src.replace(b,
c)}}catch(e){dalert(e)}},setImageSrcFromAttrSrc:function(a){try{if(a){var c=a.getAttribute("_src");c&&(a.removeAttribute("_src"),a.src=c)}}catch(b){dalert(b)}},movePropertyMenuBox_BasicUi_To_RibbonUi:function(a){try{var c=document.getElementById("TB_MENU_PROPERTY_TD_RIBBON_"+a);if(c){for(var b=document.getElementById("TB_MENU_PROPERTY_CONTAINER_"+a),d=b.getElementsByTagName("img"),e=0;e<d.length;e++)this.changeImageSrc(d[e],!1),d[e].width="22",d[e].height="22";var f=document.getElementById("dze_idx_property_userinfo_text_"+
a);f&&(f.style.top="5px");c.appendChild(b);this.resizePropertyTableInfo("ribbon",a)}}catch(g){dalert(g)}},movePropertyMenuBox_RibbonUi_To_BasicUi:function(a){try{for(var c=document.getElementById("TB_MENU_PROPERTY_TD_BASIC_"+a),b=document.getElementById("TB_MENU_PROPERTY_CONTAINER_"+a),d=b.getElementsByTagName("img"),e=0;e<d.length;e++)this.changeImageSrc(d[e],!0),d[e].width="16",d[e].height="16";var f=document.getElementById("dze_idx_property_userinfo_text_"+a);f&&(f.style.top="2px");c.appendChild(b);
this.resizePropertyTableInfo("basic",a)}catch(g){dalert(g)}},ribbon_property_icon_size:22,ribbon_property_space_size:16,ribbon_property_userinfo_text_size:135,basic_property_icon_size:15,basic_property_space_size:8,resizePropertyTableInfo:function(a,c){try{var b=document.getElementById("TB_MENU_PROPERTY_CONTAINER_"+c);if(!fnObjectCheckNull(b)){var d=document.getElementById("TB_MENU_USERINFO_TEXT_BTN_"+c);d&&d.removeAttribute("width");if("ribbon"==a){for(var e=document.getElementById("TB_MENU_PROPERTY_TD_RIBBON_"+
c),f=b.rows[0].cells.length,g=0,h=0,l=0;l<f;l++)"none"!=b.rows[0].cells[l].style.display&&(b.rows[0].cells[l].id=="TB_MENU_USERINFO_TEXT_BTN_"+c?(h=b.rows[0].cells[l].childNodes[0].offsetWidth+10,b.rows[0].cells[l].width=h,g+=h):b.rows[0].cells[l].id?(b.rows[0].cells[l].width=this.ribbon_property_icon_size,g+=this.ribbon_property_icon_size):(b.rows[0].cells[l].width=this.ribbon_property_space_size,g+=this.ribbon_property_space_size));e.width=g;e.parentNode.cells[0].width=g}else{var n=document.getElementById("TB_MENU_PROPERTY_TD_BASIC_"+
c);f=b.rows[0].cells.length;for(l=h=g=0;l<f;l++)"none"!=b.rows[0].cells[l].style.display&&(b.rows[0].cells[l].id=="TB_MENU_USERINFO_TEXT_BTN_"+c?(h=b.rows[0].cells[l].childNodes[0].offsetWidth+10,b.rows[0].cells[l].width=h,g+=h):b.rows[0].cells[l].id?(b.rows[0].cells[l].width=this.basic_property_icon_size,g+=this.basic_property_icon_size):(b.rows[0].cells[l].width=this.basic_property_space_size,g+=this.basic_property_space_size));n.width=g}}}catch(p){dalert(p)}},initTitle:function(a){try{var c=function(a){if(a){var b=
function(a){this.hasAttribute("readonly")||(a.cancelBubble=!0)};a.onmouseover=b;a.onmouseout=b;a.onmouseup=b;a.onselectstart=b;a.onselect=b;a.onclick=b}};if("ribbon"==this.getUiMode()){var b=document.getElementById("RIBBON_CONTAINER_TITLE_"+a);if(!b)return;var d=b.rows[0];if(!d||2>d.cells.length)return;var e=d.cells[0].firstChild,f=d.cells[1].firstChild;if(!e||"A"!==e.nodeName||!f||"INPUT"!==f.nodeName)return;c(e)}else if(f=document.getElementById("TB_MENU_EMPTY_AREA_"+a).firstChild,!f||"INPUT"!==
f.nodeName)return;c(f);var g=function(a){try{if(a&&!a.isNull()){var b=a.getRange();SetCurRange(b)}}catch(n){dalert(n)}};f.onkeydown=function(){dze_menu_control.resizeTitle(this)};f.onmousedown=function(b){this.hasAttribute("readonly")||(this._caret||(this._caret=GetCurRangeProp(a)),b.cancelBubble=!0)};f.onfocus=function(){this._value=this.value;this.select();dze_menu_control.resizeTitle(this)};f.onblur=function(){var b=this._caret,c=this._value;this._caret=this._value=null;var d=this,e=this.value.trim();
(e=removeZeroWidthSpaceFromString(e))?c!==e&&dze_menu_control.renameDocTitle(a,e,function(){d.value=e;dze_menu_control.resizeTitle(d);cmnCtrlToast.showToastMsg(null,ID_RES_STRING_DOCUMENT_RENAMED,1.5)},function(){d.value=c;dze_menu_control.resizeTitle(d);cmnCtrlToast.showToastMsg(null,ID_RES_STRING_DOCUMENT_RENAMED_FAIL,1.5)}):(d.value=c,dze_menu_control.resizeTitle(d));g(b);duzon_dialog.setEditorFocus(a)};f.onkeyup=function(a){switch(a.keyCode){case ID_KEYCODE_ENTER:case ID_KEYCODE_ESCAPE:this.blur()}dze_menu_control.resizeTitle(this)};
this.updateTitle()}catch(h){dalert(h)}},forceBlurTitleInput:function(){try{var a=document.activeElement;a&&"INPUT"===a.nodeName&&"dze_ribbon_menu_title_text"===a.id&&a.blur()}catch(c){dalert(c)}},resizeTitle:function(a){try{return resizeInput(a,94,94,720)}catch(c){dalert(c)}},updateTitle:function(){try{var a;if((a="ribbon"==this.getUiMode()?document.getElementById("dze_ribbon_menu_title_text"):document.getElementById("dze_ribbon_menu_title_text_toolbar"))&&"INPUT"===a.nodeName){var c=oneffice.currFileSubject;
c&&(a.style.display="",a.value=c);c=!0;var b=oneffice?oneffice.currFileOwnerId:null,d=oneffice_cloud_myInfoData?oneffice_cloud_myInfoData.id:null;b&&d&&b===d&&!oneffice.bTempLoadedContent||(c=!1);c&&objOnefficeLoader.getAppEnvType()!==APPENV.GW&&(c=!1);c?a.removeAttribute("readonly"):a.setAttribute("readonly","");this.resizeTitle(a)}}catch(e){dalert(e)}},renameDocTitle:function(a,c,b,d){b=b||function(){};d=d||function(){};if(!c)return d();var e=oneffice.bModified,f=oneffice.bModifiedPos;onefficeGW.saveFileContent({type:1,
seq:oneffice.currFileSeq,folderSeq:oneffice.currFolderSeq,subject:c,content:"",content_size:"0",owner_id:"",keyword:"",readonly:"",regdate:"",moddate:"",accessdate:"",important:"",deleted:"0"},function(d){oneffice.bModified=e;oneffice.bModifiedPos=f;onefficeCommon.accessDocumentHistory(d,CLOUD_CONST_HISTORY_ACTIONCODE_RENAME);oneffice.currFileSubject=c;oneffice.parentFileContent.subject=c;d=c+" - ONEFFICE";dzeJ(document.head).find("title").text(d);dzeJ(g_objEditorDocument[a].head).find("title").text(d);
b()},d)},TB_CONTAINER:[],moveTBIcon_BasicUi_To_TbContainer:function(a){try{"undefined"==typeof this.TB_CONTAINER[a]&&(this.TB_CONTAINER[a]=document.createElement("div"),this.TB_CONTAINER[a].id="dze_idx_ribbon_tb_container_"+a,this.TB_CONTAINER[a].style.display="none",document.body.appendChild(this.TB_CONTAINER[a]));for(var c=-1,b=0;b<this.allTbCommandIdList.length;b++)if(c=this.allTbCommandIdList[b],!(0>c)&&1!=this.checkCommandIdInTbContainer(c,a)){for(var d=0,e=!1,f=[],g=1;3>=g;g++)if(e=eval("dzeUiConfig.bCustomize_ToolBar"+
g+"_Display"),f=eval("dzeUiConfig.arrCustomToolbar"+g),e){for(var h=0;h<f.length;h++)if(c==f[h][0]){d=g;break}if(0<d)break}if(0<d){var l=document.getElementById("TB_CONTAINER_TOOL_"+d+"_"+a).querySelector("#"+(g_arrConst[c][2]+"_"+a));if(l){if(!l.nextSibling||!l.nextSibling.getAttribute("orgCommandId")){var n=document.createElement("span");n.setAttribute("orgCommandId",c);l.parentNode.insertBefore(n,l)}l.setAttribute("orgCommandId",c);l.isShow=function(){var b=this.parentNode;return b&&"DIV"===b.nodeName&&
b.id==="dze_idx_ribbon_tb_container_"+a?!1:!0};this.TB_CONTAINER[a].appendChild(l)}}else{var p=this.makeTB(c,a);if(""!=p){var m=document.createElement("span");m.className="dze_ribbon_tb_item";m.title=g_arrConst[c][1];m.innerHTML=p;var k=m.childNodes[0];this.TB_CONTAINER[a].appendChild(k);k.isShow=function(){var b=this.parentNode;return b&&"DIB"===b.nodeName&&b.id==="dze_idx_ribbon_tb_container_"+a?!1:!0};var q=g_arrConst[c][6];q==ID_TYPE_TOOLBAR_FILE_OPEN_FORM?this.addEventTBFileOpenForm(c,a):q==
ID_TYPE_TOOLBAR_SPINNER?this.addEventTBSpinner(c,a):q==ID_TYPE_TOOLBAR_GALLERY?this.addEventTBGallery(k,c,a):(TBInitButton(c,q,a),ID_TB_QUERY_STATUS_BUTTON==q?handlerUI.setCommandUpdateIndex(a,c,g_TBButton[a].length-1):ID_TB_QUERY_STATUS_COMBOBOX==q?handlerUI.setCommandUpdateIndex(a,c,g_TBComboBox[a].length-1):ID_TB_QUERY_STATUS_DROPDOWN==q&&handlerUI.setCommandUpdateIndex(a,c,g_TBDropDown[a].length-1))}}}}catch(r){dalert(r)}},currControlObject:null,addEventTBSpinner:function(a,c){try{if(g_arrConst[a][6]==
ID_TYPE_TOOLBAR_SPINNER){for(var b=null,d=0;d<this.TB_CONTAINER[c].childNodes.length;d++)if(this.TB_CONTAINER[c].childNodes[d].getAttribute("orgCommandId")==a){b=this.TB_CONTAINER[c].childNodes[d];break}if(null!=b){var e=g_arrConst[a][7],f=g_arrConst[a][8],g=g_arrConst[a][9],h="dze_form_"+g_arrConst[a][2]+"_"+c,l=eval(g_arrConst[a][3]),n=b.querySelector("input[id='"+h+"']");DzeSpinner.createSpinner(n,{max:e,min:f,amount:g,callback:function(b){l(b,a,c)},onmouseup:function(b){l(b,a,c,!0)},onkeyup:function(b){l(b,
a,c,!0)}}).container.style.border="none"}}}catch(p){dalert(p)}},addEventTBFileOpenForm:function(a,c){try{if(g_arrConst[a][6]==ID_TYPE_TOOLBAR_FILE_OPEN_FORM){for(var b=null,d=0;d<this.TB_CONTAINER[c].childNodes.length;d++)if(this.TB_CONTAINER[c].childNodes[d].getAttribute("orgCommandId")==a){b=this.TB_CONTAINER[c].childNodes[d];break}if(null!=b){b.className="duzon_tb_button_ribbon";b.onmouseover=function(){this.className="duzon_tb_button_over_ribbon"};b.onmousedown=function(){this.className="duzon_tb_button_down_ribbon";
TBCancelBubbleEvent};b.onmouseup=function(){this.className="duzon_tb_button_over_ribbon"};b.onmouseout=function(){this.className="duzon_tb_button_ribbon"};var e=b.getElementsByTagName("input")[0],f=document.getElementById("TB_CONTAINER_"+c);e.onclick=function(){f.onmousedown=function(a){a.returnValue=!0;a.cancelBubble=!1};f.onmouseup=function(a){a.returnValue=!0;a.cancelBubble=!1};f.onclick=function(a){a.returnValue=!0;a.cancelBubble=!1};setTimeout(function(){f.onmousedown=TBCancelBubbleEvent;f.onmouseup=
TBCancelBubbleEvent;f.onclick=TBCancelBubbleEvent},0)};e.onchange=function(b){""!=g_arrConst[a][3]&&eval(g_arrConst[a][3])(b,this,a,c)}}}}catch(g){dalert(g)}},addEventTBGallery:function(a,c,b){try{if(a){var d=g_arrConst[c][3],e=EventUtil,f=dzeUiConfig.bTBPreviewLetterOperation,g=!1,h=null,l=function(){h&&(clearTimeout(h),h=null)};f&&e.addHandler(a,"mouseleave",function(a){g_objOnefficeEditor.isDocumentLoaded&&!0===g&&(g_objUndoRedo.operateUndoRedoStack(!0,!1,b),g=!1)});var n=a.querySelectorAll(".duzon_tb_button_gallery_item_ribbon");
forEach(n,function(a,c){f&&(e.addHandler(c,"mouseover",function(a){g_objOnefficeEditor.isDocumentLoaded&&(l(),h=setTimeout(function(){!1===g&&(g_objUndoRedo.registerUndoRedoStack(0,b),g_objUndoRedo.registerUndoRedoStack(0,b),g=!0);window[d].call(window,a,c,b,!1)},300))}),e.addHandler(c,"mouseout",function(a){g_objOnefficeEditor.isDocumentLoaded&&l()}));e.addHandler(c,"click",function(a){g_objOnefficeEditor.isDocumentLoaded&&(f&&(l(),!0===g&&(g_objUndoRedo.operateUndoRedoStack(!0,!1,b),g=!1)),window[d].call(window,
a,c,b,!0))})})}}catch(p){dalert(p)}},moveTBIcon_TbContainer_To_BasicUi:function(a){try{this.moveTBIcon_Main_RibbonUi_To_TbContainer(this.curr_checked_menu[a],a);this.moveTBIcon_Left_RibbonUi_To_TbContainer(a);this.moveTBIcon_Right_RibbonUi_To_TbContainer(a);this.moveTBIcon_Bottom_RibbonUi_To_TbContainer(a);this.changeTbClass(this.TB_CONTAINER[a],"basic");for(var c=!1,b=1;3>=b;b++)if(toolbarDisplay=eval("dzeUiConfig.bCustomize_ToolBar"+b+"_Display")){var d=document.getElementById("TB_CONTAINER_TOOL_"+
b+"_"+a).getElementsByTagName("span");for(j=d.length-1;0<=j;j--)if(d[j].getAttribute("orgCommandId")){var e=this.TB_CONTAINER[a].getElementsByTagName("div");c=!1;for(var f=0;f<e.length;f++)if(e[f].getAttribute("orgCommandId")&&e[f].getAttribute("orgCommandId")==d[j].getAttribute("orgCommandId")){d[j].parentNode.insertBefore(e[f],d[j]);c=!0;break}!0!==c&&d[j].parentNode.parentNode.removeChild(d[j].parentNode)}}}catch(g){dalert(g)}},setTBStyle_Basic_To_Ribbon:function(a){try{return"duzon_tb_button"==
a.className&&(a.className="duzon_tb_button_ribbon",a.onmouseover=function(){this.className="duzon_tb_button_over_ribbon"},a.onmousedown=function(){this.className="duzon_tb_button_down_ribbon"},a.onmouseout=function(){this.className="duzon_tb_button_ribbon"}),a}catch(c){dalert(c)}},setTBStyle_Ribbon_To_Basic:function(a){try{return"duzon_tb_button_ribbon"==a.className&&(a.className="duzon_tb_button",a.onmouseover=function(){this.className="duzon_tb_button_over"},a.onmousedown=function(){this.className=
"duzon_tb_button_down"},a.onmouseout=function(){this.className="duzon_tb_button"}),a}catch(c){dalert(c)}},getTbObjFromTbContainer:function(a,c){try{var b=this.TB_CONTAINER[c].getElementsByTagName("div");for(c=0;c<b.length;c++)if(a==b[c].getAttribute("orgCommandId"))return b[c];return null}catch(d){return null}},changeTbClass:function(a,c){try{if("ribbon"==c){(0==a.className.indexOf("duzon_tb_button")||0==a.className.indexOf("duzon_tb_dropdown"))&&0>a.className.indexOf("_ribbon")&&(a.className+="_ribbon");
for(var b=a.getElementsByTagName("div"),d=0;d<b.length;d++){0>b[d].className.indexOf("_ribbon")&&(0==b[d].className.indexOf("duzon_tb_button")&&(b[d].className+="_ribbon"),0==b[d].className.indexOf("duzon_tb_dropdown")&&(b[d].className+="_ribbon","table"==b[d].childNodes[0].nodeName.toLowerCase()&&(b[d].childNodes[0].setAttribute("width",39),b[d].childNodes[0].setAttribute("height",30),b[d].childNodes[0].setAttribute("align","center"),b[d].childNodes[0].style.width="39px",b[d].childNodes[0].style.margin=
"auto",b[d].childNodes[0].rows[0].cells[0].setAttribute("width",26),b[d].childNodes[0].rows[0].cells[0].style.textAlign="center",b[d].childNodes[0].rows[0].cells[0].style.height="30px",b[d].childNodes[0].rows[0].cells[1].setAttribute("width",13),b[d].childNodes[0].rows[0].cells[1].style.height="30px")),0==b[d].className.indexOf("tb_DropDown_Button_Image")&&(b[d].className+="_ribbon",b[d].firstChild&&"IMG"===b[d].firstChild.nodeName&&(b[d].firstChild.style.width="24px",b[d].firstChild.style.height=
"24px")),0==b[d].className.indexOf("tbDropDown_AreaButton")&&(b[d].className+="_ribbon"));var e=b[d].getElementsByTagName("img");e.length&&this.changeImageSrc(e[0],!1)}}else if("basic"==c)for(a.className=a.className.replace(/_ribbon$/,""),b=a.getElementsByTagName("div"),d=0;d<b.length;d++)b[d].className=b[d].className.replace(/_ribbon$/,""),0==b[d].className.indexOf("duzon_tb_dropdown")&&"table"==b[d].childNodes[0].nodeName.toLowerCase()&&(b[d].childNodes[0].setAttribute("width",26),b[d].childNodes[0].removeAttribute("height"),
b[d].childNodes[0].removeAttribute("align"),b[d].childNodes[0].style.width="100%",b[d].childNodes[0].style.margin="",b[d].childNodes[0].rows[0].cells[0].setAttribute("width",16),b[d].childNodes[0].rows[0].cells[0].style.textAlign="",b[d].childNodes[0].rows[0].cells[0].style.height="16px",b[d].childNodes[0].rows[0].cells[1].setAttribute("width",10),b[d].childNodes[0].rows[0].cells[1].style.height="16px"),e=b[d].getElementsByTagName("img"),e.length&&this.changeImageSrc(e[0],!0),0==b[d].className.indexOf("tb_DropDown_Button_Image")&&
b[d].firstChild&&"IMG"===b[d].firstChild.nodeName&&(b[d].firstChild.style.width="16px",b[d].firstChild.style.height="16px")}catch(f){dalert(f)}},makeRibbonTbUnit:function(a,c){try{var b=null;if("undefined"==typeof a||null==a||!a.length)return b;if(2>a.length){var d=Math.abs(a[0]);if(0<=a[0]){b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height="";var e=b.insertRow();k=e.insertCell();k.width=d;k.height="";k.innerHTML='<div class="dze_ribbon_tb_left_separator">'}else b=
document.createElement("table"),b.cellSpacing="0",b.cellPadding="0",b.border="0",b.width=d,b.height="",e=b.insertRow(),k=e.insertCell(),k.width=d,k.height=""}else{if(inArray(a[0],this.removeToolbarList))return null;var f=a[a.length-1];if(1==f){d=50;var g=62,h=a[0],l=g_arrConst[h][1].replace(/(\s|\/)/g,"");if(3<l.length){var n=g_arrConst[h][1].replace(/\//g,"");n=n.replace(/\s/,"<br />")}else n=l;b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.style.minWidth=d+
"px";b.height=g;e=b.insertRow();k=e.insertCell();k.setAttribute("orgCommandId",h);k.style.minWidth=d+"px";k.height=g;k.align="center";k.className="dze_ribbon_tb_item_box";k.title=l;var p=this.getTbObjFromTbContainer(h,c);if(null==p)return p;p.style.margin="auto";k.appendChild(p);this.changeTbClass(k,"ribbon");var m=document.createElement("div");m.className="dze_ribbon_tb_item_text";m.id=p.id+"_RIBBON_TEXT";m.innerHTML=n;ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[h][6]?m.className="dze_ribbon_tb_item_text_dropbox":
ID_TYPE_TOOLBAR_GALLERY==g_arrConst[h][6]&&(m.style.height="12px");p.appendChild(m)}else if(2==f){var k=e=null;d=112;g=40;var q=a[0],r=this.getTbObjFromTbContainer(q,c);if(null==r)return r;this.setImageSrcFromAttrSrc(r.querySelector("img[_src]"));r.style.marginTop="0";r.style.marginBottom="0";q===ID_COMMAND_SHAPE_HEIGHT&&(r.querySelector(".duzon_spinner_input_form_container").style.width="75px");var u=a[1],t=this.getTbObjFromTbContainer(u,c);if(null==t)return t;this.setImageSrcFromAttrSrc(t.querySelector("img[_src]"));
t.style.marginTop="0";t.style.marginBottom="0";u===ID_COMMAND_SHAPE_WIDTH&&(t.querySelector(".duzon_spinner_input_form_container").style.width="75px");q==ID_COMMAND_HEADER_MARGIN_FROM_TOP&&(d=160);b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();k=e.insertCell();k.width=d;k.height=6;e=b.insertRow();k=e.insertCell();k.width=d;k.className="dze_ribbon_tb_item_box_left";k.setAttribute("orgCommandId",q);k.appendChild(r);e=b.insertRow();
k=e.insertCell();k.width=d;k.height=4;e=b.insertRow();k=e.insertCell();k.width=d;k.className="dze_ribbon_tb_item_box_left";k.setAttribute("orgCommandId",u);k.appendChild(t);e=b.insertRow();k=e.insertCell();k.width=d;k.height=6}else if(3!=f)if(4==f){k=e=null;d=24;g=40;if(g_arrConst[a[0]][6]==ID_TYPE_TOOLBAR_DROPDOWN||g_arrConst[a[1]][6]==ID_TYPE_TOOLBAR_DROPDOWN)d=35;q=a[0];r=this.getTbObjFromTbContainer(q,c);if(null==r)return r;this.setImageSrcFromAttrSrc(r.querySelector("img[_src]"));r.style.marginTop=
"0";r.style.marginBottom="0";u=a[1];t=this.getTbObjFromTbContainer(u,c);if(null==t)return t;this.setImageSrcFromAttrSrc(t.querySelector("img[_src]"));t.style.marginTop="0";t.style.marginBottom="0";b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;b.height=g;e=b.insertRow();k=e.insertCell();k.width=d;k.height=6;e=b.insertRow();k=e.insertCell();k.width=d;k.className="dze_ribbon_tb_item_box_left";k.setAttribute("orgCommandId",q);k.appendChild(r);e=b.insertRow();
k=e.insertCell();k.width=d;k.height=2;e=b.insertRow();k=e.insertCell();k.width=d;k.className="dze_ribbon_tb_item_box_left";k.setAttribute("orgCommandId",u);k.appendChild(t);e=b.insertRow();k=e.insertCell();k.width=d;k.height=6;var w=b.querySelectorAll("img");a=0;for(var x=w.length;a<x;a++)w[a].style.width="16px",w[a].style.height="16px"}else if(5==f){d=24;g=28;h=a[0];h==ID_COMMAND_HEADING_SIZE||h==ID_COMMAND_FONT_SIZE?d="74":h==ID_COMMAND_FONT_NAME?d="104":h==ID_COMMAND_LINE_HEIGHT||h==ID_COMMAND_LETTER_SPACING?
d="54":h===ID_COMMAND_STYLE_TEMPLATE_COMBO&&(d="80");ID_TYPE_TOOLBAR_DROPDOWN==g_arrConst[h][6]&&(d="35");var v=this.getTbObjFromTbContainer(h,c);b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width=d;e=b.insertRow();k=e.insertCell();h==ID_COMMAND_FIXED_RATIO?(v.setAttribute("fixed_ratio",!1),v.style.position="absolute",v.style.top="calc(50% - 13px)",k.setAttribute("orgCommandId",h),k.style.width="50%",k.style.height="30px",k.style.borderTop="1px solid",k.style.borderBottom=
"1px solid",k.style.borderRight="1px solid",k.appendChild(v),k=e.insertCell(),k.style.width="50%"):(b.height=g,k.className="dze_ribbon_tb_item_box_bottom",k.width=d,k.height=g,k.setAttribute("orgCommandId",h),k.appendChild(v))}}return b}catch(y){return dalert(y),null}},moveTBIcon_TbContainer_To_Main_RibbonUi:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c),d=document.createElement("table");d.cellSpacing="0";d.cellPadding="0";d.border="0";for(var e=d.insertRow(),f=
null,g=0,h=0,l=0;l<this.tb_menu_content_list[a].length;l++)if(h=this.tb_menu_content_list[a][l][0],h!==ID_COMMAND_SHAPES_INSERT||!1!==dzeUiConfig.bUseShapesFeature)if(h==ID_COMMAND_HEADER&&!1===dzeUiConfig.bUseHeaderFooter)l+=4;else if(h!=ID_COMMAND_INSERT_INPUTBOX&&h!=ID_COMMAND_SEND_REPORT_FORM&&h!=ID_COMMAND_GET_EXTERNAL_DATA||!1!==dzeUiConfig.bUseReportForm)if(h!=ID_COMMAND_MODIFY_CHART_ATTR||!0===this.bChartImage)if(h!=ID_COMMAND_IMAGE_REPLACE||1!=this.bChartImage)if(h!=ID_COMMAND_IMAGE_RESET_PICTURE||
1!=this.bChartImage){var n=this.makeRibbonTbUnit(this.tb_menu_content_list[a][l],c);if(null!=n){f=e.insertCell(g);g++;var p=n.width,m=n.height;p&&(f.width=p);m&&(f.height=m);f.appendChild(n)}}f=e.insertCell(g);f.innerHTML="<div style='width:auto'></div>";b.appendChild(d);duzon_dialog.animateDlg(d,"right")}catch(k){dalert(k)}},moveTBIcon_TbContainer_To_Left_RibbonUi:function(a){try{if(0!=this.tb_menu_content_left_list.length){var c=document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a),b=document.createElement("table");
b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0;f<this.tb_menu_content_left_list.length;f++){var g=this.makeRibbonTbUnit(this.tb_menu_content_left_list[f],a);null!=g&&(e=d.insertCell(),e.width=g.width,e.height=g.height,e.appendChild(g))}c.appendChild(b)}}catch(h){dalert(h)}},moveTBIcon_TbContainer_To_Right_RibbonUi:function(a){try{if(0!=this.tb_menu_content_right_list.length){var c=document.getElementById("TB_MENU_RIBBON_CONTENT_RIGHT_"+a),b=document.createElement("table");
b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0,g=0;g<this.tb_menu_content_right_list.length;g++){var h=this.makeRibbonTbUnit(this.tb_menu_content_right_list[g],a);null!=h&&(e=d.insertCell(),e.width=h.width,e.height=h.height,e.appendChild(h),f+=parseInt(e.width,10))}c.appendChild(b);c.parentNode.setAttribute("width",f)}}catch(l){dalert(l)}},moveTBIcon_TbContainer_To_Bottom_RibbonUi:function(a){try{var c=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+
a),b=document.createElement("table");b.cellSpacing="0";b.cellPadding="0";b.border="0";b.width="100%";for(var d=b.insertRow(),e=null,f=0,g=0;g<this.tb_menu_content_bottom_list.length;g++){var h=this.makeRibbonTbUnit(this.tb_menu_content_bottom_list[g],a);null!=h&&(e=d.insertCell(f),f++,e.width=h.width,e.height=h.height,e.appendChild(h))}e=d.insertCell(f);e.innerHTML="<div style='width:auto'></div>";c.appendChild(b);this.setShowHideRibbonBottomToolbars()}catch(l){dalert(l)}},moveTBIcon_Main_RibbonUi_To_TbContainer:function(a,
c){try{for(var b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).getElementsByTagName("td"),d=b.length-1;0<=d;d--)b[d].getAttribute("orgCommandId")&&(1<b[d].childNodes[0].childNodes.length&&b[d].childNodes[0].childNodes[1].id==b[d].childNodes[0].id+"_RIBBON_TEXT"&&b[d].childNodes[0].removeChild(b[d].childNodes[0].childNodes[1]),2<b[d].childNodes[0].childNodes.length&&b[d].childNodes[0].childNodes[2].id==b[d].childNodes[0].id+"_RIBBON_TEXT"&&b[d].childNodes[0].removeChild(b[d].childNodes[0].childNodes[2]),
this.TB_CONTAINER[c].appendChild(b[d].childNodes[0]),b[d].parentNode.removeChild(b[d]));document.getElementById("TB_MENU_RIBBON_CONTENT_"+a+"_"+c).innerHTML=""}catch(e){dalert(e)}},moveTBIcon_Left_RibbonUi_To_TbContainer:function(a){try{if(document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a)){for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),
c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_LEFT_"+a).innerHTML=""}}catch(d){dalert(d)}},moveTBIcon_Right_RibbonUi_To_TbContainer:function(a){try{if(document.getElementById("TB_MENU_RIBBON_CONTENT_RIGHT_"+a)){for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_RIGHT_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_RIGHT_"+
a).innerHTML=""}}catch(d){dalert(d)}},moveTBIcon_Bottom_RibbonUi_To_TbContainer:function(a){try{if(document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a)){for(var c=document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a).getElementsByTagName("td"),b=c.length-1;0<=b;b--)c[b].getAttribute("orgCommandId")&&(this.TB_CONTAINER[a].appendChild(c[b].childNodes[0]),c[b].parentNode.removeChild(c[b]));document.getElementById("TB_MENU_RIBBON_CONTENT_BOTTOM_"+a).innerHTML=""}}catch(d){dalert(d)}},RibbonMenuSetStateAllEnable:function(a,
c){try{for(var b=0;b<this.tb_menu_list.length;b++)if(!0===oneffice.bTempLoadedContent)b==dze_menu_control.idxTempSaveMenu?this.setEnableRibbonMenu(b,c):this.setDisableRibbonMenu(b,c);else{if(!0===g_readonlyMode)if(0==b||4==b){this.setEnableRibbonMenu(b,c);continue}else this.setDisableRibbonMenu(b,c);a?this.setEnableRibbonMenu(b,c):this.setDisableRibbonMenu(b,c)}this.showAllTBState()}catch(d){dalert(d)}},setDisableRibbonMenu:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);
this.setTBItemTextGray(!0,a,c);b.TBSTATE!=ID_STRING_NAME_HIDE&&this.setMenuItemProperty(ID_STRING_NAME_GRAY,a,c)}catch(d){dalert(d)}},setEnableRibbonMenu:function(a,c){try{var b=document.getElementById("TB_MENU_RIBBON_"+a+"_"+c);this.setTBItemTextGray(!1,a,c);a==this.curr_checked_menu[c]?this.setMenuItemProperty(ID_STRING_NAME_CHECKED,a,c):b.TBSTATE!=ID_STRING_NAME_HIDE&&this.setMenuItemProperty(ID_STRING_NAME_UNCHECKED,a,c)}catch(d){dalert(d)}},arrRibbonUiListener:null,addRibbonUiEvent:function(a){try{this.arrRibbonUiListener=
[];var c=function(b,c,e){b&&(EventUtil.addHandler(b,c,e),g_arrEditorListener.push({nEditNumber:a,elem:b,type:c,handler:e}))};c(g_objEditWindow[a],"resize",function(a){dze_menu_control.evtResizeShowHideTb(a)});c(window,"resize",function(a){dze_menu_control.evtResizeShowHideTb(a)})}catch(b){dalert(b)}},removeRibbonUiMouseEvent:function(a){try{a=0;for(var c=this.arrRibbonUiListener?this.arrRibbonUiListener.length:0;a<c;a++){var b=this.arrRibbonUiListener[a];b&&EventUtil.removeHandler(b.elem,b.type,b.handler)}this.arrRibbonUiListener=
null}catch(d){dalert(d)}},timeoutID_dynamicMenu:null,evtMouseUpShowDynamicMenu:function(a){try{var c=g_nActiveEditNumber;if(-1!=c&&!0!==g_readonlyMode&&!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode){var b=a?a:window.event;if(!b||"undefined"===typeof b.keyCode||isNavigationKeyCode(b.keyCode)||b.altKey||b.shiftKey||b.ctrlKey||b.metaKey)null!==this.timeoutID_dynamicMenu&&(clearTimeout(this.timeoutID_dynamicMenu),this.timeoutID_dynamicMenu=null),this.timeoutID_dynamicMenu=setTimeout(function(){this.setDynamicMenu(c);
var a=this.curr_checked_menu[c];a>=this.idxDynamicMenuStart&&!this.isShowMenu(a)&&this.activateMenu(this.prev_checked_menu[c])}.bind(this),0)}}catch(d){dalert(d)}},activateMenuIfNotActive:function(a,c){try{a?this.isShowMenu(c)?c===this.idxImagePropertyMenu?this.setTBImageSizeInfo(g_objPageControl.nEditNumber):c===this.idxShapePropertyMenu?this.setTBShapeSizeInfo(g_objPageControl.nEditNumber):c===this.idxVideoPropertyMenu&&this.setTBVideoSizeInfo(g_objPageControl.nEditNumber):this.activateMenu(c):
this.isShowMenu(c)&&this.deactivateMenu(c)}catch(b){dalert(b)}},setDynamicMenu:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);dzeUiConfig.bUseHeaderFooter&&!1===dzeUiConfig.bSupportNewsEditor&&this.activateMenuIfNotActive(g_objHeaderFooter.getHeaderFooterEditMode(),this.idxHeaderFooterMenu);var c=0<g_objSelectedShapesArray.length,b=!c&&GetCurTable(a),d=b&&!1!==g_objEditMode.isContentEditable(b),e=this.checkVideoCaret(a),f=this.checkImageCaret(a);this.activateMenuIfNotActive(d,this.idxTableMenu);
this.activateMenuIfNotActive(c&&!e&&!f,this.idxShapePropertyMenu);this.activateMenuIfNotActive(e,this.idxVideoPropertyMenu);this.activateMenuIfNotActive(f,this.idxImagePropertyMenu)}catch(g){dalert(g)}},bChartImage:!1,checkImageCaret:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);this.bChartImage=!1;var c=getSelectionControl(a).controlObject;if(c&&"IMG"===c.nodeName){if(c.getAttribute("chart_id"))this.bChartImage=!0;else if(g_objVideoControl.isVideoSpan(c.parentNode)||c.hasAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO))return!1;
return!0}return!1}catch(b){dalert(b)}},checkVideoCaret:function(a){try{"undefined"==typeof a&&(a=g_nActiveEditNumber);var c=getSelectionControl(a),b=c?c.controlObject:null;return b?g_objVideoControl.isVideo(b)?!0:!1:!1}catch(d){dalert(d)}},evtResizeShowHideTb:function(){try{for(var a in g_arrEditorAreaContainer){var c=a;dze_menu_control.setShowHideRibbonMainToolbars(dze_menu_control.curr_checked_menu[c],c);dze_menu_control.setShowHideRibbonBottomToolbars(c)}}catch(b){dalert(b)}},addEventMenuControl:function(a){try{window.attachEvent?
g_objEditorDocument[a].attachEvent("onmousedown",dze_menu_control.evtEditorMouseDown):g_objEditorDocument[a].addEventListener("mousedown",dze_menu_control.evtEditorMouseDown,!1)}catch(c){dalert(c)}},evtEditorMouseDown:function(a){try{dze_menu_control.removeHelpBtnLayer()}catch(c){dalert(c)}},setTBImageSizeInfo:function(a,c){try{if(!0!==g_readonlyMode&&!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&(dze_menu_control.currControlObject=null,objOnefficeLoader.m_bHybrid||this.curr_checked_menu[a]==
dze_menu_control.idxImagePropertyMenu)){var b=getSelectionControl(a);if("undefined"!=typeof b.controlObject&&null!=b.controlObject&&"img"==b.controlObject.nodeName.toLowerCase()){var d=b.controlObject;dze_menu_control.currControlObject=d;var e=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_HEIGHT][2]+"_"+a);e&&(e.value=d.height);var f=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_WIDTH][2]+"_"+a);f&&(f.value=d.width);try{c&&onefficeChart.makeCanvasChartToImage(d,
a,c)}catch(g){}}}}catch(g){dalert(g)}},setTBShapeSizeInfo:function(a){try{if(!0!==g_readonlyMode&&!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&this.curr_checked_menu[a]==dze_menu_control.idxShapePropertyMenu){dze_menu_control.currControlObject=null;var c=getSelectionControl(a);dze_menu_control.currControlObject=c.controlObject;var b=1,d=1;c=!1;for(var e=1,f=1,g=!1,h,l=0;l<g_objSelectedShapesArray.length;l++)h=g_objSelectedShapesArray[l],void 0!==b&&(e=parseFloat(h.style.height),
0===l?b=e:b!==e&&(b=void 0)),void 0!==d&&(f=parseFloat(h.style.width),0===l?d=f:d!==f&&(d=void 0)),void 0!==g&&(g="true"===h.getAttribute("fixed_ratio"),0===l?c=g:c!==g&&(c=void 0));b=void 0===b?1:g_objCommonUtil.PxToCM(b).toFixed(2);d=void 0===d?1:g_objCommonUtil.PxToCM(d).toFixed(2);void 0===c&&(c=!1);var n=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_SHAPE_HEIGHT][2]+"_"+a);n&&(n.value=b);var p=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_SHAPE_WIDTH][2]+"_"+a);p&&(p.value=
d);var m=document.getElementById(g_arrConst[ID_COMMAND_FIXED_RATIO][2]+"_"+a),k=m.firstChild.firstChild;a=b/d;m.setAttribute("fixed_ratio",c);m.setAttribute("ratio_value",a);m.style.opacity="";k.src=!0===c?dzeEnvConfig.strPath_Image+"toolbar/ico_link.png":dzeEnvConfig.strPath_Image+"toolbar/ico_link_none.png"}}catch(q){dalert(q)}},setTBCurrentImageSizeInfo:function(a){try{if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&this.curr_checked_menu[a]==dze_menu_control.idxImagePropertyMenu&&
dze_menu_control.currControlObject){var c=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_HEIGHT][2]+"_"+a);c&&(c.value=dze_menu_control.currControlObject.offsetHeight);var b=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_IMAGE_WIDTH][2]+"_"+a);b&&(b.value=dze_menu_control.currControlObject.offsetWidth)}}catch(d){dalert(d)}},setTBVideoSizeInfo:function(a){try{if(!0===dzeUiConfig.bUseUiMode&&"ribbon"==dze_menu_control.ui_mode&&(dze_menu_control.currControlObject=null,this.curr_checked_menu[a]==
dze_menu_control.idxVideoPropertyMenu)){var c=getSelectionControl(a).controlObject;if(c){var b=g_objVideoControl.getVideo(c);if(b){dze_menu_control.currControlObject=b;var d=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_VIDEO_HEIGHT][2]+"_"+a);d&&(d.value=g_objCommonUtil.pxToNumber(b.style.height||b.clientHeight||b.height));var e=document.getElementById("dze_form_"+g_arrConst[ID_COMMAND_VIDEO_WIDTH][2]+"_"+a);e&&(e.value=g_objCommonUtil.pxToNumber(b.style.width||b.clientWidth||b.width))}}}}catch(f){dalert(f)}},
setTBHeaderFooter:function(a){try{if(dzeUiConfig.bUseHeaderFooter&&g_objHeaderFooter.getHeaderFooterEditMode()){var c=dzeLayoutControl.getDocPrintMarginInfo(a,!1);c||(c=dzeUiConfig.nSettingPaperMargin);if(c){var b="dze_form_"+g_arrConst[ID_COMMAND_HEADER_MARGIN_FROM_TOP][2]+"_"+a,d=document.getElementById(b);d&&(d.value=parseFloat(c.headerTop)/10);b="dze_form_"+g_arrConst[ID_COMMAND_FOOTER_MARGIN_FROM_BOTTOM][2]+"_"+a;if(d=document.getElementById(b))d.value=parseFloat(c.footerBottom)/10}}}catch(e){dalert(e)}},
removeToolbarList:[],removeToolbar:function(a,c){try{this.removeToolbarList.push(a);var b=document.getElementById(g_arrConst[a][2]+"_"+c);if(b)if("ribbon"==this.ui_mode)if(b.nextSibling)b.parentNode.removeChild(b);else{if(b.parentNode.getAttribute("orgCommandId")){var d=g_objNodeUtil.getLoopParentElement(b,"table").parentNode;d.parentNode.removeChild(d)}}else b.parentNode.parentNode.removeChild(b.parentNode)}catch(e){dalert(e)}},setChartModifyToolbarIcon:function(a){try{for(var c=!1,b=document.getElementById("TB_MENU_RIBBON_CONTENT_"+
this.idxImagePropertyMenu+"_"+a),d=g_arrConst[ID_COMMAND_MODIFY_CHART_ATTR][2]+"_"+a,e=b.getElementsByTagName("div"),f=null,g=0;g<e.length;g++)if(e[g].id===d){c=!0;f=e[g];break}var h=b.firstChild.rows[0],l=h.cells.length-1;if(!0===this.bChartImage){if(!0!==c){var n=this.makeRibbonTbUnit([ID_COMMAND_MODIFY_CHART_ATTR,1],a);if(null!=n){var p=h.insertCell(l);p.width=n.width;p.height=n.height;p.appendChild(n)}}}else if(!0===c){var m=f.parentNode;if(m.getAttribute("orgCommandId")){1<m.childNodes[0].childNodes.length&&
m.childNodes[0].childNodes[1].id==m.childNodes[0].id+"_RIBBON_TEXT"&&m.childNodes[0].removeChild(m.childNodes[0].childNodes[1]);2<m.childNodes[0].childNodes.length&&m.childNodes[0].childNodes[2].id==m.childNodes[0].id+"_RIBBON_TEXT"&&m.childNodes[0].removeChild(m.childNodes[0].childNodes[2]);this.TB_CONTAINER[a].appendChild(m.childNodes[0]);var k=g_objNodeUtil.getLoopParentElement(m.parentNode,"td");g_objNodeUtil.getLoopParentElement(k,"div")===b&&k.parentNode.removeChild(k)}}}catch(q){dalert(q)}},
showAllTBState:function(a){},destruct:function(){}};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
function isShowedRulerBar(){try{return g_bRulerbar_Display&&g_objRulerBar.isShow()?!0:!1}catch(a){dalert(a)}}function isSVG(a){try{return a&&"undefined"!=typeof a&&g_objNodeUtil.getElementTagName(a).toLowerCase()==DZE_TAG_SVG?!0:!1}catch(b){dalert(b)}}
function DzeRuler(){this.unit="mm";this.min=-300;this.max=600;this.gap=5;this.scale=1;this.tickTextMarginTop=this.tickTextMarginLeft=0;this.disableRightDiv=this.disableLeftDiv=this.tickDiv=this.rulerDiv=null;this.bVertical=!1;this.toPx=function(a){var b=g_objCommonUtil.getDPI();return function(a){return Math.ceil(a*b/25.4)}}();this.create=function(a,b){try{if(!a)return null;this.bVertical=b||!1;var c=document.createElement("div");c=document.createElement("div");c.className=b?"dze_ruler_vertical":
"dze_ruler";this.rulerDiv=c;this.tickDiv=this.createTickDiv();this.disableLeftDiv=this.createDisableDiv(!0);this.disableRightDiv=this.createDisableDiv(!1);c.appendChild(this.disableLeftDiv);c.appendChild(this.disableRightDiv);c.appendChild(this.tickDiv);a.appendChild(c);this.setTickPosition();return this}catch(d){dalert(d)}};this.createTickDiv=function(){try{var a=document.createElement("div");a.className="dze_ruler_tick_container";a.appendChild(this.createTick());a.appendChild(this.createTickText());
return a}catch(b){dalert(b)}};this.createTick=function(){try{var a=document.createElement("div");a.className="dze_ruler_tick";for(var b=this.min;b<=this.max;b+=this.gap)a.appendChild(document.createElement("div"));return a}catch(c){dalert(c)}};this.createTickText=function(){try{var a=document.createElement("div");a.className="dze_ruler_tick_text";for(var b=this.max/10,c=null,d=this.min/10;d<=b;d++)c=document.createElement("div"),c.appendChild(document.createTextNode(Math.abs(d))),a.appendChild(c);
return a}catch(e){dalert(e)}};this.setTickPosition=function(){try{for(var a=this.bVertical?"top":"left",b=0,c=this.bVertical?this.tickTextMarginTop:this.tickTextMarginLeft,d=this.tickDiv.firstChild.childNodes,e=0,f=d.length;e<f;e++)b=Math.ceil(this.toPx(this.gap*this.scale*e)-1),d[e].style[a]=b+"px";d=this.tickDiv.lastChild.childNodes;var k=this.bVertical?0:Math.ceil(this.toPx(5))-1;e=0;for(f=d.length;e<f;e++)b=Math.ceil(this.toPx(10*this.scale*e)-k-1),b+=c,d[e].style[a]=b+"px"}catch(n){dalert(n)}};
this.createDisableDiv=function(a){try{var b=document.createElement("div"),c="dze_ruler_disable";c=a?this.bVertical?c+"_top":c+"_left":this.bVertical?c+"_bottom":c+"_right";b.className=c;return b}catch(d){dalert(d)}};this.setOrigin=function(a){try{var b=this.bVertical?"top":"left",c=parseInt(this.rulerDiv.style[b],10),d=-1*this.toPx(this.min)*this.scale;this.tickDiv.style[b]=Math.ceil(a-d-c)+"px"}catch(e){dalert(e)}};this.setEnableRange=function(a,b){try{var c=this.bVertical?"height":"width",d=parseInt(this.rulerDiv.style[this.bVertical?
"top":"left"],0),e=parseInt(this.rulerDiv.style[c],0);this.disableLeftDiv.style[c]=Math.ceil(Math.max(a-d,0))+"px";this.disableRightDiv.style[c]=Math.ceil(Math.max(d+e-b,0))+"px"}catch(f){dalert(f)}};this.setShowRange=function(a,b){try{var c=this.bVertical?"height":"width";this.rulerDiv.style[this.bVertical?"top":"left"]=Math.ceil(a)+"px";this.rulerDiv.style[c]=Math.ceil(Math.max(b-a,0))+"px"}catch(d){dalert(d)}};this.setScale=function(a,b){try{this.scale!==a&&(this.scale=a,this.setTickPosition())}catch(c){dalert(c)}}}
function DzeRulerPointer(){this.gap=g_objCommonUtil.toPx("2.5mm");this.origin=0;this.scale=this.max=this.min=null;this.sign=1;this.onStop=this.onChange=this.onStart=this.guideline=this.divPointer=null;this.create=function(a,b,c){try{var d=document.createElement("div");d.className="dze_ruler_pointer";this.divPointer=d;var e=document.createElement("div");e.className="dze_ruler_arrow";b&&e.setAttribute(b,"");c&&e.setAttribute("title",c);var f=document.createElement("div");f.className="dze_ruler_drag";
e.appendChild(f);d.appendChild(e);a.appendChild(d);this.addListener(f);return this}catch(k){dalert(k)}};this.setGuideline=function(a){this.guideline=a;return this};this.addListener=function(a){try{var b=null,c=null,d=this;dzeJ(a).draggable({start:function(a,f){f.helper.data("dze_origin",f.position||{left:0,top:0});b=null;c=parseInt(d.divPointer.style.left,0);this.style.height=window.screen.height+"px";this.style.top="-10px";if(d.onStart)d.onStart()},drag:function(a,d){a=d.helper.data("dze_origin");
d=d.position;d.top=a.top;if(a.left===d.left)return d;var e=Math.ceil(this.origin),f=this.gap*this.scale,h=c+(d.left-a.left)-e,l=0<=h?1:-1;h=Math.abs(h);var m=parseInt(h/f),p=Math.ceil(f*m);f=Math.ceil(f*(m+1));h=h-p<f-h?p:f;0!==h&&(h*=l);l=h+e;null!==this.min&&l<this.min&&(l=this.min,h=this.min-e);null!==this.max&&l>this.max&&(l=this.max,h=this.max-e);this.divPointer.style.left=l+"px";d.left=a.left;this.guideline.show(!0);this.guideline.setLeft(l);this.onChange&&(a=Math.ceil(h/this.scale)*this.sign,
b!==a&&(b=a,this.onChange(a)));return d}.bind(this),stop:function(a,b){this.guideline.show(!1);a.target.style.height="";a.target.style.top="";if(this.onStop)this.onStop()}.bind(this)})}catch(e){dalert(e)}};this.setScale=function(a){this.scale=a;return this};this.setLeft=function(a){this.divPointer&&(this.divPointer.style.left=Math.ceil(a)+"px");return this};this.setOrigin=function(a){this.origin=a;return this};this.setMin=function(a){this.min=a;return this};this.setMax=function(a){this.max=a;return this};
this.hide=function(){this.divPointer.style.display="none";return this};this.show=function(){this.divPointer.style.display="";return this}}function DzeRulerGuideline(a){var b=a.ownerDocument.createElement("div");b.className="dze_v_rulerbar_guideline";a.appendChild(b);this.show=function(a){b.style.display=a?"":"none";b.style.height=a?g_nEditAreaSetHeight+"px":""};this.setLeft=function(a){b.style.left=a+"px"}}
function DzeRulerControl(){this.minDist=this.guideline=this.secondLineTextIndent=this.marginRight=this.marginLeft=this.textIndent=this.rulerVertical=this.ruler=this.divRulerbarVertical=this.divRulerbar=null;this.useRulerBgLine=!1;this.isInit=function(){return this.divRulerbar?!0:!1};this.init=function(a){try{if(!this.isInit()){var b=document.getElementById("TB_CONTAINER_RULERBAR_"+a);if(b){this.divRulerbar=b;var c=null;this.useRulerBgLine&&(c=document.createElement("div"),c.className="dze_ruler_bg",
b.appendChild(c));this.ruler=(new DzeRuler).create(b);var d=new DzeRulerGuideline(b);this.textIndent=(new DzeRulerPointer).create(b,"text_indent",ID_RES_CONST_STRING_FIRST_PARAGRAPH_INDENT);this.marginLeft=(new DzeRulerPointer).create(b,"margin_left",ID_RES_DIALOG_STRING_ALIGN_LEFT+ID_RES_CONST_STRING_INDENT);this.marginRight=(new DzeRulerPointer).create(b,"margin_right",ID_RES_DIALOG_STRING_ALIGN_RIGHT+ID_RES_CONST_STRING_INDENT);this.secondLineTextIndent=(new DzeRulerPointer).create(b,"second_line_text_indent",
ID_RES_CONST_STRING_OUTDENT);this.textIndent.guideline=d;this.marginLeft.guideline=d;this.marginRight.guideline=d;this.secondLineTextIndent.guideline=d;this.textIndent.onChange=this.onChangeTextIndent.bind(this);this.marginLeft.onChange=this.onChangeMarginLeft.bind(this);this.marginRight.onChange=this.onChangeMarginRight.bind(this);this.secondLineTextIndent.onChange=this.onChangeSecondLineTextIndent.bind(this);this.textIndent.onStart=this.onDragStart;this.marginLeft.onStart=this.onDragStart;this.marginRight.onStart=
this.onDragStart;this.secondLineTextIndent.onStart=this.onDragStart;this.textIndent.onStop=this.onDragStop;this.marginLeft.onStop=this.onDragStop;this.marginRight.onStop=this.onDragStop;this.secondLineTextIndent.onStop=this.onDragStop;b.addEventListener("contextmenu",fnReturnFalsePropagation,!1);this.minDist=g_objCommonUtil.toPx("15mm");this.initVertical(a);this.useRulerBgLine&&(c=document.createElement("div"),c.className="dze_ruler_left_top_whole_rect",b.appendChild(c),c=document.createElement("div"),
c.className="dze_ruler_left_top_wide_rect",b.appendChild(c),c=document.createElement("div"),c.className="dze_ruler_left_top_narrow_rect",b.appendChild(c))}}}catch(e){dalert(e)}};this.initVertical=function(a){try{var b=document.getElementById("TB_CONTAINER_RULERBAR_V_"+a);b&&(a=null,this.useRulerBgLine&&(a=document.createElement("div"),a.className="dze_ruler_bg_vertical",b.appendChild(a)),this.divRulerbarVertical=b,this.rulerVertical=new DzeRuler,this.rulerVertical.min=-500,this.rulerVertical.max=
500,this.rulerVertical.create(b,!0),b.addEventListener("contextmenu",fnReturnFalsePropagation,!1))}catch(c){dalert(c)}};this.isShow=function(){return this.divRulerbar&&"none"!==this.divRulerbar.style.display?!0:!1};this.show=function(a){this.divRulerbar&&(this.divRulerbar.style.display=a?"":"none");this.divRulerbarVertical&&(this.divRulerbarVertical.style.display=a?"":"none");this.prevState=null};this.prevState=null;this.needUpdate=function(a){try{var b={};a&&(b.parent=a.parentNode,b.para=a,b.bound=
g_objNodeUtil.getClosetBound(b.para),b.boundWidth=b.bound?b.bound.style.width:null,b.textIndent=a.style.textIndent,b.marginLeft=a.style.marginLeft,b.marginRight=a.style.marginRight);if(!this.prevState||this.prevState.parent!==b.parent||this.prevState.para!==b.para||this.prevState.bound!==b.bound||this.prevState.boundWidth!==b.boundWidth||this.prevState.textIndent!==b.textIndent||this.prevState.marginLeft!==b.marginLeft||this.prevState.marginRight!==b.marginRight)return this.prevState=b,!0;this.prevState=
b;return!1}catch(c){dalert(c)}};this.update=function(a,b){try{if(!this.isShow())return!1;if("undefined"===typeof a||null===a)a=g_nActiveEditNumber;var c=this._createInfo1(a);if(!0!==b&&!this.needUpdate(c.para))return!1;c=this._createInfo2(a,c);this._updateRuler(c);this._updateRulerVertical(c);this._updateRulerPointer(c)}catch(d){dalert(d)}};this._createInfo=function(a){var b=this._createInfo1(a);return this._createInfo2(a,b)};this._createInfo1=function(a){try{var b={},c=g_objZoom.getDocZoomValue()/
100;b.scale=c;var d=GetCurRange(a),e=this.getPara(d),f=this.getBound(d);e&&f&&(b.para=e,b.bound=f,a=g_objCommonUtil,b.textIndent=a.toPx(e.style.textIndent)*c,b.marginLeft=a.toPx(e.style.marginLeft)*c,b.marginRight=a.toPx(e.style.marginRight)*c);return b}catch(k){dalert(k)}};this._createInfo2=function(a,b){try{var c=b.para,d=b.bound;c&&d&&(b.rcBound=this.getElementRect(d),b.rcPara=this.getElementRect(c));return b}catch(e){dalert(e)}};this._updateRuler=function(a){try{if(a&&this.ruler){var b=this.ruler;
b.setScale(a.scale);if(a.para&&a.bound){var c=a.rcBound,d=a.rcPara;b.setShowRange(c.left,c.right);b.setEnableRange(d.left-a.marginLeft,d.right+a.marginRight);b.setOrigin(d.left-a.marginLeft)}}}catch(e){dalert(e)}};this._updateRulerVertical=function(a){try{if(a&&this.rulerVertical){var b=this.rulerVertical;b.setScale(a.scale);if(a.para&&a.textBound){var c=a.rcBound,d=a.rcTextBound;b.setShowRange(Math.min(c.top,d.top),Math.max(c.bottom,d.bottom));b.setEnableRange(d.top,d.bottom);b.setOrigin(d.top)}else if(a.rcPage){var e=
a.rcPage;b.setShowRange(e.top,e.bottom);b.setEnableRange(e.top,e.bottom);b.setOrigin(e.top+e.height/2)}}}catch(f){dalert(f)}};this._updateRulerPointer=function(a){try{if(this.ruler)if(a&&a.para&&a.bound){var b=a.rcPara,c=a.rcBound;!1!==a.updateTextIndent&&this.textIndent.show().setScale(a.scale).setLeft(b.left+a.textIndent).setOrigin(b.left).setMin(Math.min(c.left,b.left)).setMax(Math.max(b.right-this.minDist,b.left+a.textIndent));!1!==a.updateMarginLeft&&this.marginLeft.show().setScale(a.scale).setLeft(b.left).setOrigin(b.left-
a.marginLeft).setMin(Math.min(c.left,b.left)).setMax(Math.max(b.right-this.minDist,b.left));!1!==a.updateMarginRight&&(this.marginRight.show().setScale(a.scale).setLeft(b.right).setOrigin(b.right+a.marginRight).setMin(Math.min(b.left+this.minDist,b.right)).setMax(Math.max(c.right,b.right)).sign=-1);!1!==a.updateSecondLineTextIndent&&this.secondLineTextIndent.show().setScale(a.scale).setLeft(b.left).setOrigin(b.left-a.marginLeft).setMin(Math.min(c.left,b.left)).setMax(Math.max(b.right-this.minDist,
b.left))}else this.textIndent.hide(),this.marginLeft.hide(),this.marginRight.hide(),this.secondLineTextIndent.hide()}catch(d){dalert(d)}};this.timeoutID=null;this.delayUpdate=function(a){clearTimeout(this.timeoutID);this.timeoutID=setTimeout(function(){g_objRulerBar.update(a,!0)},10)};this.getPara=function(a){try{a=a||GetCurRange(g_nActiveEditNumber);if(!a)return null;var b=a.startContainer.childNodes[a.startOffset]||a.startContainer;return b?"undefined"!==typeof g_objSelectedShapesArray&&g_objSelectedShapesArray.length&&
"DIV"===b.nodeName?g_objNodeUtil.getClosetParagraph(g_objSelectedShapesArray[0]):g_objNodeUtil.getClosetParagraph(b):null}catch(c){dalert(c)}};this.getTextBound=function(a){try{var b=this.getPara(a);if(b){var c=g_objNodeUtil;return c.getClosest(b.parentNode,function(a){return c.isBlockNode(a)||"TD"===a.nodeName||"TH"===a.nodeName?!0:!1})}return null}catch(d){dalert(d)}};this.getBound=function(a){try{a=a||GetCurRange(g_nActiveEditNumber);if(!a)return null;var b=g_objPageControl;return"undefined"!==
typeof g_objSelectedShapesArray&&g_objSelectedShapesArray.length?b.getPageContainer(b.getPageNum(g_objSelectedShapesArray[0])):b.getPageContainer(b.getPageNum(a.startContainer))}catch(c){dalert(c)}};this.getElementRect=function(a){try{var b=g_objPropertyUtil,c=g_objPositionUtil,d=b.getPadding(a,0),e=b.getPadding(a,2),f=b.getPadding(a,1),k=b.getPadding(a,3);b=0;this.divRulerbarVertical&&(b=Math.ceil(g_objCommonUtil.toPx(this.divRulerbarVertical.style.width)));var n=c.getDocumentLeft(a)+d,h=a.offsetWidth-
d-e;d=n+h;var l=c.getDocumentTop(a)+f,m=a.offsetHeight-f-k;f=l+m;k=0;"undefined"!==typeof c.getDocumentDiffTransformTop&&(k=c.getDocumentDiffTransformTop(a));l+=k;var p=g_objZoom.getDocZoomValue()/100,g={left:n,top:l,right:d,bottom:f,width:h,height:m};g_objPageControl.documentContainerNode.contains(a)?this.applyZoom(g):(g.width*=p,g.right=g.left+g.width,g.height*=p,g.bottom=g.top+g.height);Object.keys(g).forEach(function(a){g[a]=Math.ceil(g[a])});g.right=g.left+g.width;g.bottom=g.top+g.height;g.left+=
b;g.right+=b;return g}catch(q){dalert(q)}};this.getScrollParent=function(a){try{for(;a&&"BODY"!==a.nodeName;){if("DIV"===a.nodeName&&"dze_document_main_container"===a.id)return a;a=a.parentNode}return null}catch(b){dalert(b)}};this.applyZoom=function(a,b,c){try{b=b||g_objPageControl.documentContainerNode;c=c||0;var d=b.style.transform,e=0,f=0;if(""===d)d=1;else{var k=d.match(/[+-]?\d+(\.\d+)?/g).map(function(a){return parseFloat(a)});d=k[0]||1;e=k[4]||0;f=k[5]||0}var n=b.style.transformOrigin;a.left*=
d;a.width*=d;a.right=a.left+a.width;a.top*=d;a.height*=d;a.bottom=a.top+a.height;var h=b.offsetLeft+e,l=(h+(h+b.offsetWidth))/2,m=b.offsetTop+f,p=(m+(m+b.offsetHeight))/2;1!==d&&("left top"===n||""===n?m=(m-c)*d+c:"center top"===n&&(h=l-(l-h)*d,m=p-(p-m)*d));a.left+=h+c;a.right+=h+c;a.top+=m+c;a.bottom+=m+c;var g=this.getScrollParent(b),q=g?g.scrollLeft:0;a.left-=q;a.right-=q;var r=g?g.scrollTop:0;a.top-=r;a.bottom-=r;return a}catch(t){dalert(t)}};this.onChangeTextIndent=function(a){try{dlog("* (Ruler) textIndent: "+
a+"px");var b=g_nActiveEditNumber;g_objLetterFn.setParaStyle(b,{textIndent:a});var c=this._createInfo(b);c.updateTextIndent=!1;this._updateRulerPointer(c)}catch(d){dalert(d)}};this.onChangeMarginLeft=function(a){try{dlog("* (Ruler) marginLeft: "+a+"px");var b=g_nActiveEditNumber;g_objLetterFn.setParaStyle(b,{marginLeft:a});var c=this._createInfo(b);c.updateMarginLeft=!1;this._updateRulerPointer(c)}catch(d){dalert(d)}};this.onChangeMarginRight=function(a){try{dlog("* (Ruler) marginRight: "+a+"px");
var b=g_nActiveEditNumber;g_objLetterFn.setParaStyle(b,{marginRight:a});var c=this._createInfo(b);c.updateMarginRight=!1;this._updateRulerPointer(c)}catch(d){dalert(d)}};this.onChangeSecondLineTextIndent=function(a){try{dlog("* (Ruler) left: "+a+"px");var b=g_nActiveEditNumber,c=this.getPara();if(c){var d=g_objCommonUtil.toPx(c.style.textIndent),e=g_objCommonUtil.toPx(c.style.marginLeft);g_objLetterFn.setParaStyle(b,{marginLeft:a,textIndent:d-(a-e),secondLine:!0});var f=this._createInfo(b);f.updateSecondLineTextIndent=
!1;this._updateRulerPointer(f)}}catch(k){dalert(k)}};this.undoData=null;this.onDragStart=function(){};this.onDragStop=function(){try{var a=g_nActiveEditNumber;g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer()}catch(b){dalert(b)}}}var g_objRulerBar=new DzeRulerControl;
var dzeLayoutControl={dzeEditNumber:0,defaultEditAreaHeight:0,currEditAreaHeight:0,resizeEditAreaHeight:0,setEditAreaSize:function(b,a){try{if(b&&(dzeLayoutControl.dzeEditNumber=b),!0===dzeUiConfig.bOfficeMode&&!dzeUiConfig.bOfficePagingMode){"undefined"==typeof a&&(a=!1);!0===a&&(this.currEditAreaHeight=0);this.defaultEditAreaHeight=dzeUiConfig.nSettingPaperSize.height-dzeUiConfig.nSettingPaperMargin.top-dzeUiConfig.nSettingPaperMargin.bottom;var c=g_objEditorDocument[b].body.childNodes.length;if(0<
c){var d=g_objEditorDocument[b].body.childNodes[c-1];if(d.nodeType!=ID_SELECTION_ELEMENT_NODE)for(;d.previousSibling&&(d=d.previousSibling,d.nodeType!=ID_SELECTION_ELEMENT_NODE););this.resizeEditAreaHeight=Math.ceil((d.offsetTop+d.offsetHeight)*ONE_PX2MM);this.resizeEditAreaHeight<this.defaultEditAreaHeight&&(this.resizeEditAreaHeight=this.defaultEditAreaHeight)}else this.resizeEditAreaHeight=this.defaultEditAreaHeight;0==this.currEditAreaHeight&&(this.currEditAreaHeight=this.defaultEditAreaHeight);
this.resizeEditAreaHeight!=this.currEditAreaHeight&&(document.getElementById("dzeditor_Parent_"+b).style.height=this.resizeEditAreaHeight+"mm",this.currEditAreaHeight=this.resizeEditAreaHeight)}}catch(e){dalert(e)}},dzeEditAreaContainerScrollTimer:null,dzeEditAreaContainerScrollDown:!1,dzeEditAreaContainerHorizontalScrollTimer:null,dzeEditAreaContainerHorizontalScrollDown:!1,dzeEditAreaContainerMouseOffX:0,dzeEditAreaContainerMouseOffY:0,setOfficeLayout:function(b,a){try{b&&(dzeLayoutControl.dzeEditNumber=
b),dzeUiConfig.bOfficePagingMode?"undefined"!=typeof a&&a(b):setTimeout(function(){var c=document.getElementById("MAIN_EDIT_AREA_CONTAINER_"+b),d=document.getElementById("MAIN_EDIT_AREA_CONTAINER_BOX_"+b),e=document.createElement("div");e.id="MAIN_EDIT_AREA_CONTAINER_CUSTOM_SCROLL";d.appendChild(e);var f=document.createElement("div");f.id="MAIN_EDIT_AREA_CONTAINER_CUSTOM_HORIZONTAL_SCROLL";f.style.opacity=.5;d.appendChild(f);setTimeout(function(){if(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)dzeLayoutControl.onChangeEditAreaScrollHorizontalPositionWidth()},
100);d.className="MAIN_EDIT_AREA_CONTAINER_BOX_CUSTOM_STYLE";d.style.height=c.offsetHeight+"px";d.style.overflow="auto";d.style.backgroundColor="#F2F2F2";d.onmousedown=function(a){TBCancelBubbleEvent(a)};d.onmousemove=function(a){if(dzeLayoutControl.dzeEditAreaContainerScrollDown)dzeLayoutControl.onEditAreaMoveVerticalScrollPosition(a);else if(dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown)dzeLayoutControl.onEditAreaMoveHorizontalScrollPosition(a);else TBCancelBubbleEvent(a)};d.onmouseup=
function(a){dzeLayoutControl.dzeEditAreaContainerScrollDown=!1;dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown=!1;TBCancelBubbleEvent(a)};d.onclick=function(a){TBCancelBubbleEvent(a)};d.onscroll=function(a){g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,b);g_objTableMiniMenu.onWheel(b);if(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)dzeLayoutControl.onChangeEditAreaScrollPosition(d,
d,e)};e.onmouseover=function(){this.style.opacity=1;dzeLayoutControl.dzeEditAreaContainerScrollTimer&&clearTimeout(dzeLayoutControl.dzeEditAreaContainerScrollTimer)};e.onmouseleave=function(){dzeLayoutControl.dzeEditAreaContainerScrollTimer=setTimeout(function(){dzeLayoutControl.setEditAreaScrollOut(e)},500)};e.onmousedown=function(a){dzeLayoutControl.dzeEditAreaContainerScrollDown=!0;dzeLayoutControl.dzeEditAreaContainerMouseOffY=a.y};e.onmouseup=function(){dzeLayoutControl.dzeEditAreaContainerScrollDown=
!1};e.onmousemove=function(a){dzeLayoutControl.dzeEditAreaContainerScrollDown&&(a.preventDefault(a),dzeLayoutControl.onEditAreaMoveVerticalScrollPosition(a))};f.onmousedown=function(a){dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown=!0;dzeLayoutControl.dzeEditAreaContainerMouseOffX=a.x};f.onmouseup=function(){dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown=!1;this.style.opacity=.5};f.onmousemove=function(a){dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown&&(a.preventDefault(a),
dzeLayoutControl.onEditAreaMoveHorizontalScrollPosition(a))};if(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)window.attachEvent?(document.attachEvent("mouseup",dzeLayoutControl.dze_layout_document_mouseup),document.attachEvent("mousemove",dzeLayoutControl.dze_layout_document_mousemove),window.attachEvent("onresize",dzeLayoutControl.dze_layout_window_onresize)):(document.addEventListener("mouseup",dzeLayoutControl.dze_layout_document_mouseup),document.addEventListener("mousemove",dzeLayoutControl.dze_layout_document_mousemove),
window.addEventListener("resize",dzeLayoutControl.dze_layout_window_onresize));c=document.getElementById("dzeditorContainer_"+b);c.style.width=dzeUiConfig.nSettingPaperSize.width+"mm";c.style.height=dzeUiConfig.nSettingPaperSize.height+"mm";c.style.margin="auto";c.style.marginTop="10px";c.style.marginBottom="10px";c.align="center";f=c.insertRow(0).insertCell(0);f.style.height=dzeUiConfig.nSettingPaperMargin.top+"mm";f.style.padding="0";f.style.margin="0";f.style.borderWidth="1px 1px 0 1px";f.style.borderColor=
" #ebebeb #d9d9d9 #d9d9d9 #ebebeb";f.style.borderStyle="solid";f.style.backgroundColor="#FFFFFF";f.id="dzEditor_header_"+b;c=c.insertRow(2).insertCell(0);c.style.height=dzeUiConfig.nSettingPaperMargin.bottom+"mm";c.style.padding="0";c.style.margin="0";c.style.borderWidth="0px 1px 1px 1px";c.style.borderColor="#ebebeb #d9d9d9 #d9d9d9 #ebebeb";c.style.borderStyle="solid";c.style.backgroundColor="#FFFFFF";c.id="dzEditor_footer_"+b;document.getElementById("TB_CONTAINER_"+b).style.borderWidth="0 0 1px 0";
c=document.getElementById("dzeditor_Parent_"+b);c.style.width=dzeUiConfig.nSettingPaperSize.width-dzeUiConfig.nSettingPaperMargin.left-dzeUiConfig.nSettingPaperMargin.right+"mm";c.style.height=dzeUiConfig.nSettingPaperSize.height-dzeUiConfig.nSettingPaperMargin.top-dzeUiConfig.nSettingPaperMargin.bottom+"mm";c.style.borderWidth="0px 1px 0 1px";c.style.borderColor="#ebebeb #d9d9d9 #d9d9d9 #ebebeb";c.style.borderStyle="solid";c.style.verticalAlign="top";c.style.padding="0";c.style.paddingLeft=dzeUiConfig.nSettingPaperMargin.left+
"mm";c.style.paddingRight=dzeUiConfig.nSettingPaperMargin.right+"mm";c.style.backgroundColor="#FFFFFF";c.className="body_pagebreak_bg";c.style.backgroundPositionY=c.style.height;c=document.getElementById("dzeditor_"+b);c.style.width="100%";c.style.height="100%";g_objEditorDocument[b].body.style.overflow="hidden";"undefined"!=typeof a&&a(b);d.style.display="block"},100)}catch(c){dalert(c)}},dze_layout_document_mousemove:function(b){try{if(dzeLayoutControl.dzeEditAreaContainerScrollDown)dzeLayoutControl.onEditAreaMoveVerticalScrollPosition(b);
else if(dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown)dzeLayoutControl.onEditAreaMoveHorizontalScrollPosition(b)}catch(a){dalert(a)}},dze_layout_document_mouseup:function(b){try{dzeLayoutControl.dzeEditAreaContainerScrollDown=!1,dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown=!1,$_("MAIN_EDIT_AREA_CONTAINER_CUSTOM_HORIZONTAL_SCROLL").style.opacity=.5}catch(a){dalert(a)}},dze_layout_window_onresize:function(b){},onEditAreaMoveVerticalScrollPosition:function(b){try{if(0===b.buttons)dzeLayoutControl.dzeEditAreaContainerScrollDown=
!1;else{var a=$_("MAIN_EDIT_AREA_CONTAINER_BOX_"+dzeLayoutControl.dzeEditNumber),c=$_("MAIN_EDIT_AREA_CONTAINER_CUSTOM_SCROLL"),d=b.y-dzeLayoutControl.dzeEditAreaContainerMouseOffY;c.style.top=parseInt(c.style.top)+d;a.scrollTop=parseInt(a.scrollTop)+a.scrollHeight/a.offsetHeight*d;dzeLayoutControl.dzeEditAreaContainerMouseOffY=b.y}}catch(e){dalert(e)}},onEditAreaMoveHorizontalScrollPosition:function(b){try{var a=$_("MAIN_EDIT_AREA_CONTAINER_BOX_"+dzeLayoutControl.dzeEditNumber),c=$_("MAIN_EDIT_AREA_CONTAINER_CUSTOM_HORIZONTAL_SCROLL");
if(0===b.buttons)c.style.opacity=.5,dzeLayoutControl.dzeEditAreaContainerHorizontalScrollDown=!1;else{c.style.opacity=1;var d=b.x-dzeLayoutControl.dzeEditAreaContainerMouseOffX,e=parseInt(c.style.left)+d;0>e&&(e=0);e+parseInt(c.style.width)+2>a.offsetWidth&&(e=a.offsetWidth-parseInt(c.style.width)-2);c.style.left=e+"px";a.scrollLeft=parseInt(a.scrollLeft)+a.scrollWidth/a.offsetWidth*d;dzeLayoutControl.dzeEditAreaContainerMouseOffX=b.x}}catch(f){dalert(f)}},onChangeEditAreaScrollHorizontalPositionWidth:function(){try{var b=
$_("MAIN_EDIT_AREA_CONTAINER_BOX_"+dzeLayoutControl.dzeEditNumber),a=$_("MAIN_EDIT_AREA_CONTAINER_CUSTOM_HORIZONTAL_SCROLL");a.style.visibility=b.offsetWidth===b.scrollWidth?"hidden":"";a.style.width=b.offsetWidth/b.scrollWidth*b.offsetWidth+"px";a.style.left="0px";a.style.bottom="3px"}catch(c){dalert(c)}},onChangeEditAreaScrollPosition:function(b,a,c){try{c.style.opacity=1;dzeLayoutControl.dzeEditAreaContainerScrollTimer&&clearTimeout(dzeLayoutControl.dzeEditAreaContainerScrollTimer);var d=document.getElementById("TB_CONTAINER_"+
dzeLayoutControl.dzeEditNumber);c.style.left=parseInt(b.clientWidth)-12+"px";c.style.height=b.clientHeight*a.clientHeight/a.scrollHeight+"px";c.style.top=b.clientHeight*a.scrollTop/a.scrollHeight+d.offsetHeight+1+"px";dzeLayoutControl.dzeEditAreaContainerScrollTimer=setTimeout(function(){dzeLayoutControl.setEditAreaScrollOut(c)},1E3)}catch(e){dalert(e)}},setEditAreaScrollOut:function(b){try{0<b.style.opacity&&(b.style.opacity-=.1,dzeLayoutControl.dzeEditAreaContainerScrollTimer=setTimeout(function(){dzeLayoutControl.setEditAreaScrollOut(b)},
30))}catch(a){dalert(a)}},setReadonlyMode:function(b,a){try{g_readonlyMode=b;g_bTableResizingYN=!b;var c=oneffice.isReadOnlyDoc();g_objMenuWin.TBMenuSetStateAllEnable(!b,a);var d=g_objPageControl,e=g_objHeaderFooter,f=g_objPropertyUtil;!0===b&&(disableAllControl(a),d.setPageLabelButton(),e.setHeaderFooterEditMode(!1));var h=null,g=null,k=null,l=null;!0===b?(c&&f.addClass(g_objEditorDocument[a].body,"unselectable"),h=function(a){a&&(a.contentEditable=!1)},g=function(a){a&&(a.style.display="none")},
k=l=function(a){a&&(c?(f.addClass(a,"unselectable"),a.contentEditable=!1,a.style.opacity=""):e.disable(a),a.parentNode&&a.parentNode.hasAttribute("title")&&a.parentNode.removeAttribute("title"))}):(f.removeClass(g_objEditorDocument[a].body,"unselectable"),h=function(a){a&&(a.contentEditable=!0)},g=function(a){a&&(a.style.display="")},k=function(a,b){a&&(e.enable(a,b),a.parentNode&&a.parentNode.setAttribute("title",ID_RES_STRING_TITLE_EDIT_HEADER))},l=function(a,b){a&&(e.enable(a,b),a.parentNode&&
a.parentNode.setAttribute("title",ID_RES_STRING_TITLE_EDIT_FOOTER))});var n=d.getTotalPageCount();for(a=0;a<n;a++)h(d.getPageMain(a)),k(e.getHeader(a),!b),l(e.getFooter(a),!b),g(d.getMarginIndicator(a));dzeUiConfig.bCopyPasteTableCell=!b}catch(m){dalert(m)}},getDocPrintMarginInfo:function(b,a){try{var c=g_objEditorDocument[b].body;if(c&&c.childNodes.length){var d=dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property");if(d&&"dze_document_property"==d.className){var e=this.getDocPrintMarginInfoFromElem(d);
!0===a&&d.parentNode.removeChild(d);return e}}return null}catch(f){dalert(f)}},getDocPrintMarginInfoFromElem:function(b){try{var a=b?b.getAttribute(DZE_CUSTOM_ATT_PAGEMARGIN):null;if(!a)return null;var c=a.split(","),d={top:parseInt(c[0],10),right:parseInt(c[1],10),bottom:parseInt(c[2],10),left:parseInt(c[3],10),headerTop:0,footerBottom:0};d.headerTop=c[4]?parseFloat(c[4]):d.top/2;d.footerBottom=c[5]?parseFloat(c[5]):d.bottom/2;return d}catch(e){dalert(e)}},setDocPrintMargin:function(b,a){try{"undefined"==
typeof a&&(a=null);var c=this.getDocPrintMarginInfo(b,!0);null==a&&(a=c);!dzeUiConfig.bUseHeaderFooter&&a&&(a.headerTop=a.top/2,a.footerBottom=a.bottom/2);null!=a&&(dzeUiConfig.nSettingPaperMargin=a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.setPageSizeUpdate(),g_objHeaderFooter.setHeaderOverflowBlinderStyle();else{document.getElementById("dzEditor_header_"+b).style.height=dzeUiConfig.nSettingPaperMargin.top+"mm";document.getElementById("dzEditor_footer_"+b).style.height=dzeUiConfig.nSettingPaperMargin.bottom+
"mm";var d=document.getElementById("dzeditor_Parent_"+b);d.style.width=dzeUiConfig.nSettingPaperSize.width-dzeUiConfig.nSettingPaperMargin.left-dzeUiConfig.nSettingPaperMargin.right+"mm";d.style.height=dzeUiConfig.nSettingPaperSize.height-dzeUiConfig.nSettingPaperMargin.top-dzeUiConfig.nSettingPaperMargin.bottom+"mm";d.style.paddingLeft=dzeUiConfig.nSettingPaperMargin.left+"mm";d.style.paddingRight=dzeUiConfig.nSettingPaperMargin.right+"mm";d.style.backgroundPositionY=d.style.height}a="portrait";
dzeUiConfig.nSettingPaperSize.width>dzeUiConfig.nSettingPaperSize.height&&(a="landscape");var e=dzeUiConfig.nSettingPaperMargin.top+"mm "+dzeUiConfig.nSettingPaperMargin.right+"mm "+dzeUiConfig.nSettingPaperMargin.bottom+"mm "+dzeUiConfig.nSettingPaperMargin.left+"mm";c=!1;var f=g_objEditorDocument[b].getElementsByTagName("style");for(d=0;d<f.length;d++)if("print"==f[d].getAttribute("media")){f[d].innerHTML="@page{ margin : "+e+"; size:"+a+";}";c=!0;break}if(!1===c){var h=g_objEditorDocument[b].getElementsByTagName("head")[0],
g=g_objEditorDocument[b].createElement("style");g.setAttribute("type","text/css");g.setAttribute("media","print");g.innerHTML="@page{ margin : "+e+"; size:"+a+";}";h.appendChild(g)}}catch(k){dalert(k)}},getCustomPropertyEle:function(b,a){try{for(var c=g_objEditorDocument[b].body.firstElementChild;c;){var d=c.nodeName.toLowerCase();if(d==a)return c;if("dze_"!=d.substring(0,4))break;c=c.nextElementSibling}return null}catch(e){dalert(e)}},createCustomProperty:function(b,a,c,d){try{return customTagEle=
document.createElement(a),customTagEle.className=a,d.appendChild(customTagEle),customTagEle}catch(e){dalert(e)}},getPaperSizeProperty:function(b,a){try{a=null;var c=g_objEditorDocument[b].body;if(c&&c.childElementCount){var d=dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property");if(d&&"dze_document_property"==d.className){var e=d.getAttribute(DZE_CUSTOM_ATT_PAPERSIZE);if(e){var f=e.split(",");a={width:parseFloat(f[0]),height:parseFloat(f[1])}}}}return a}catch(h){dalert(h)}},getDocumentNoProperty:function(b){try{if(!g_objEditorDocument[b])return null;
var a=g_objEditorDocument[b].body;if(a&&a.childElementCount){var c=dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property");if(c&&"dze_document_property"==c.className||(c=dzeLayoutControl.getCustomPropertyEle(DZE_IFRAME_TMP_NO,"dze_doc_property"))&&"dze_document_property"==c.className)return c.getAttribute(DZE_CUSTOM_ATT_DOCUMENT_NO)}return null}catch(d){dalert(d)}},getOnePageModeProperty:function(b){try{if(!g_objEditorDocument[b])return!1;var a=g_objEditorDocument[b].body;if(a&&a.childElementCount){var c=
dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property");if(c&&"dze_document_property"==c.className)return this.getOnePageModePropertyFromElem(c)}return!1}catch(d){return dalert(d),!1}},getOnePageModePropertyFromElem:function(b){try{var a=b?b.getAttribute(DZE_CUSTOM_ATT_ONEPAGE_MODE):null;if(null==a||""==a)a=!1;else{try{a=duzon_http.parseJSON(a)}catch(c){a=null}"boolean"!=typeof a&&(a=!1)}return a}catch(c){return dalert(c),!1}},applyPaperSizeProperty:function(b,a){try{var c=dzeLayoutControl.getPaperSizeProperty(b,
!0);if("undefined"==typeof a||null==a){if(a=c)dzeUiConfig.nSettingPaperSize.width=a.width,dzeUiConfig.nSettingPaperSize.height=a.height}else parseFloat(a.width)>parseFloat(a.height)?(dzeUiConfig.nSettingPaperSize.width=297,dzeUiConfig.nSettingPaperSize.height=210):(dzeUiConfig.nSettingPaperSize.width=210,dzeUiConfig.nSettingPaperSize.height=297);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.setPageSizeUpdate();else{var d=document.getElementById("dzeditorContainer_"+b);d.style.width=dzeUiConfig.nSettingPaperSize.width+
"mm";d.style.height=dzeUiConfig.nSettingPaperSize.height+"mm";var e=document.getElementById("dzeditor_Parent_"+b);e.style.width=dzeUiConfig.nSettingPaperSize.width-dzeUiConfig.nSettingPaperMargin.left-dzeUiConfig.nSettingPaperMargin.right+"mm";e.style.height=dzeUiConfig.nSettingPaperSize.height-dzeUiConfig.nSettingPaperMargin.top-dzeUiConfig.nSettingPaperMargin.bottom+"mm"}}catch(f){dalert(f)}},updatePaperDirectionCtrl:function(b){try{"object"==typeof b&&b.width>b.height&&(b="garo");"garo"==b?dzeLayoutControl.m_ctrlPaperDlgRadioTD.firstElementChild.nextElementSibling.firstElementChild.checked=
!0:dzeLayoutControl.m_ctrlPaperDlgRadioTD.firstElementChild.firstElementChild.checked=!0;for(var a=cmnDlg.getDlg().getElementsByClassName("dze_paper_direction_view"),c=0;c<a.length;c++)"garo"==b?(a[c].style.width="120px",a[c].style.height="80px"):(a[c].style.width="80px",a[c].style.height="120px")}catch(d){dalert(d)}},updateOnePageModeCtrl:function(b){try{var a=document.getElementById("dze_idx_paper_out_view_paper"),c=dzeLayoutControl.m_ctrlPgContentsRadioTD;if("off"==b){if(0<a.childNodes.length)return;
var d=document.createElement("div"),e=a.outerHTML;b=null;for(var f=1;2>=f;f++)d.innerHTML=e,b=d.firstChild,b.removeAttribute("id"),b.style.position="absolute",b.style.left=-5*f+"px",b.style.top=-5*f+"px",b.style.zIndex=20032+f,a.appendChild(b),d.innerHTML="";a.style.marginTop=5*f+"px";c&&(c.style.opacity=1)}else a.style.marginTop=0,a.innerHTML="",c&&(c.style.opacity=.5,dzeUiConfig.bOfficePgOverflowVisible=!1);c&&dzeLayoutControl.updatePgContentsOverflow(dzeUiConfig.bOfficePgOverflowVisible)}catch(h){dalert(h)}},
updatePgContentsOverflow:function(b){try{b?dzeLayoutControl.m_ctrlPgContentsRadioTD.firstElementChild.nextElementSibling.firstElementChild.checked=!0:dzeLayoutControl.m_ctrlPgContentsRadioTD.firstElementChild.firstElementChild.checked=!0}catch(a){dalert(a)}},m_ctrlPgContentsRadioTD:null,m_ctrlPaperDlgRadioTD:null,m_ctrlPaperDlgPreviewDiv:null,getPaperDirectionContainer:function(){try{var b=document.createElement("div");b.className="duzon_dialog_content_medium";var a="";a+="<table width='100%' border='0' cellpadding='0' cellspacing='5'>";
a+="<tr>";a+="<td height='23' width='80'>"+ID_RES_CONST_STRING_PAPER_ORIENTATION+" : </td>";a+="<td>";a+="<span><input type='radio' name='dze_print_paper_type' value='sero' id='dze_idx_paper_direction_type1' /><label for='dze_idx_paper_direction_type1'>"+ID_RES_CONST_STRING_PAPER_ORIENTATION_SERO+"</label></span>";a+="<span style='margin-left:5px'><input type='radio' name='dze_print_paper_type' value='garo' id='dze_idx_paper_direction_type2' /><label for='dze_idx_paper_direction_type2'>"+ID_RES_CONST_STRING_PAPER_ORIENTATION_GARO+
"</label></span>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td height='23'>"+ID_RES_CONST_STRING_PAPER_COLOR+" : </td>";a+="<td>"+g_objColorComboBoxUtil.makeColorComboBoxHTML("dze_paper_background",90)+"</td>";a+="</tr>";a+="<tr>";a+="<td height='23'>"+ID_RES_CONST_STRING_PAPER_SIZE+" : </td>";a+="<td><span style='color:gray;'>A4 (21cm x 29.7cm)</span></td>";a+="</tr>";a+="<tr>";a+="<td height='23' width='80'>"+ID_RES_CONST_STRING_ONEPAGE_MODE+" : </td>";a+="<td>";a+="<span><input type='radio' name='dze_onepagemode' value='off' id='dze_idx_onepagemode_off' /><label for='dze_idx_onepagemode_off'>"+
ID_RES_CONST_STRING_ONEPAGE_MODE_OFF+"</label></span>";a+="<span style='margin-left:5px'><input type='radio' name='dze_onepagemode' value='on' id='dze_idx_onepagemode_on' /><label for='dze_idx_onepagemode_on'>"+ID_RES_CONST_STRING_ONEPAGE_MODE_ON+"</label></span>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td height='23' width='80'>"+ID_RES_CONST_STRING_PAGE_CONTENTS+" : </td>";a+="<td>";a+="<span><input type='radio' name='dze_pgContentsOverflow' value='off' id='dze_idx_pgContentsOverflow_off' /><label for='dze_idx_pgContentsOverflow_off'>"+
ID_RES_CONST_STRING_PAGE_CONTENTS_OVERFLOW_OFF+"</label></span>";a+="<span style='margin-left:5px'><input type='radio' name='dze_pgContentsOverflow' value='on' id='dze_idx_pgContentsOverflow_on' /><label for='dze_idx_pgContentsOverflow_on'>"+ID_RES_CONST_STRING_PAGE_CONTENTS_OVERFLOW_ON+"</label></span>";a+="</td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<table width='100%' border='0' cellpadding='5' cellspacing='0'>";a+="<tr>";a+="<td align='center' width='99' height='160'>";
a+="<div class='dze_paper_direction_view' id='dze_idx_paper_out_view_paper' style='padding:10px;width:80px;height:120px;'></div>";a+="</td>";b.innerHTML=a+"</tr></table>";var c=b.childNodes[0];dzeLayoutControl.m_ctrlPaperDlgRadioTD=c.firstElementChild.firstElementChild.firstElementChild.nextElementSibling;dzeLayoutControl.m_ctrlPaperDlgPreviewDiv=b.childNodes[2].firstElementChild.firstElementChild.firstElementChild.firstElementChild;dzeLayoutControl.m_ctrlPgContentsRadioTD=c.rows[4].lastElementChild;
return b}catch(d){dalert(d)}},getPrintSettingContainer:function(){try{var b=g_objPropTagCommon.static_ctrl_width,a="";a+="<div class='duzon_dialog_content_medium'>";a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";a+="<tr>";a+="<td align='center'>";a+="<span><input type='radio' name='dze_print_margin_type' value='10' id='dze_idx_print_margin_type1' /><label for='dze_idx_print_margin_type1'>"+ID_RES_CONST_STRING_PRINT_MARGIN_NARROW+" (10mm)</label></span>";a+="<span style='margin-left:5px'><input type='radio' name='dze_print_margin_type' value='20' id='dze_idx_print_margin_type2' /><label for='dze_idx_print_margin_type2'>"+
ID_RES_CONST_STRING_PRINT_MARGIN_NORMAL+" (20mm)</label></span>";a+="<span style='margin-left:5px'><input type='radio' name='dze_print_margin_type' value='30' id='dze_idx_print_margin_type3' /><label for='dze_idx_print_margin_type3'>"+ID_RES_CONST_STRING_PRINT_MARGIN_WIDE+" (30mm)</label></span>";a+="<span style='margin-left:5px'><input type='radio' name='dze_print_margin_type' value='999' id='dze_idx_print_margin_type999' readonly /><label>"+ID_RES_CONST_STRING_USER_DEFINE+"</label></span>";a+="</td>";
a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<table width='100%' border='0' cellpadding='5' cellspacing='0'>";a+="<tr>";a+="<td align='center' colspan='3'>";g_objPropTagCommon.static_ctrl_width=32;a+="<div style='width:auto'>"+g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_PROP_TAG_STRING_TOP+":","dze_print_margin_top",100,0,"","","mm").outerHTML+"</div>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td align='right'>";g_objPropTagCommon.static_ctrl_width=0;a+="<div style='width:90px;'><p style='text-align:left'>"+
ID_RES_PROP_TAG_STRING_LEFT+" :</p>"+g_objPropTagCommon.makeStaticSpinnerInputCtrl("","dze_print_margin_left",100,0,"","","mm").outerHTML+"</div>";a+="</td>";a+="<td align='center' width='99'>";a+="<div class='dze_paper_out_view' id='dze_idx_paper_out_view' style='padding:10px;width:80px;height:120px;'><div class='dze_paper_margin_view'></div></div>";a+="</td>";a+="<td align='left'>";g_objPropTagCommon.static_ctrl_width=0;a+="<div style='width:auto'><p style='text-align:left'>"+ID_RES_PROP_TAG_STRING_RIGHT+
" :</p>"+g_objPropTagCommon.makeStaticSpinnerInputCtrl("","dze_print_margin_right",100,0,"","","mm").outerHTML+"</div>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td align='center' colspan='3'>";g_objPropTagCommon.static_ctrl_width=45;a+="<div style='width:auto'>"+g_objPropTagCommon.makeStaticSpinnerInputCtrl(ID_RES_PROP_TAG_STRING_BOTTOM+":","dze_print_margin_bottom",100,0,"","","mm").outerHTML+"</div>";a+="</td>";a+="</tr>";a+="</table>";a+="</div>";g_objPropTagCommon.static_ctrl_width=b;return a}catch(c){dalert(c)}},
getIDocSecureGradeContainer:function(){try{var b=document.createElement("div");b.className="duzon_dialog_content_medium";var a="";a+="<table width='100%' border='0' cellpadding='0' cellspacing='5'>";a+="<tr>";a+="<td>";a+="<span><input type='radio' name='dze_watermark_set' value='1' id='dze_idx_paper_watermark_1' /><label for='dze_idx_paper_watermark_1'>"+ID_RES_PROP_BUILDER_BLOCK_PROP_ITEM_APPLY+"</label></span>";a+="&nbsp;&nbsp;&nbsp;<span><input type='radio' name='dze_watermark_set' value='0' id='dze_idx_paper_watermark_0' checked='true' /><label for='dze_idx_paper_watermark_0'>"+
ID_RES_CONST_STRING_CLEAR+"</label></span>";a+="</td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<table width='100%' border='0' cellpadding='5' cellspacing='0'>";a+="<tr>";a+="<td align='center' width='33%'>";a+="<div><input type='radio' name='securedoc_level' value='1' id='dze_idx_securedoc_1' /><label for='dze_idx_securedoc_1'>1\uae09 \ubcf4\uc548\ubb38\uc11c</label></div>";a+="<div class='dze_paper_watermark_view_1' id='dze_idx_paper_out_view_paper1' style='padding:10px;width:80px;height:120px;'></div>";
a+="</td>";a+="<td align='center' width='34%'>";a+="<div><input type='radio' name='securedoc_level' value='2' id='dze_idx_securedoc_2' /><label for='dze_idx_securedoc_2'>2\uae09 \ubcf4\uc548\ubb38\uc11c</label></div>";a+="<div class='dze_paper_watermark_view_2' id='dze_idx_paper_out_view_paper2' style='padding:10px;width:80px;height:120px;'></div>";a+="</td>";a+="<td align='center' width='33%'>";a+="<div><input type='radio' name='securedoc_level' value='3' id='dze_idx_securedoc_3' /><label for='dze_idx_securedoc_3'>3\uae09 \ubcf4\uc548\ubb38\uc11c</label></div>";
a+="<div class='dze_paper_watermark_view_3' id='dze_idx_paper_out_view_paper3' style='padding:10px;width:80px;height:120px;'></div>";a+="</td>";b.innerHTML=a+"</tr></table>";return b}catch(c){dalert(c)}},checked_secure_grade:0,initializeSecureGradeInfo:function(b){dzeLayoutControl.checked_secure_grade=0;""==dzeUiConfig.sWatermarkImageSrc?(document.getElementById("dze_idx_paper_watermark_0").checked=!0,dzeLayoutControl.checked_secure_grade=0,document.getElementById("dze_idx_securedoc_1").disabled=
!0,document.getElementById("dze_idx_securedoc_2").disabled=!0,document.getElementById("dze_idx_securedoc_3").disabled=!0):(document.getElementById("dze_idx_paper_watermark_1").checked=!0,document.getElementById("dze_idx_securedoc_1").disabled=!1,document.getElementById("dze_idx_securedoc_2").disabled=!1,document.getElementById("dze_idx_securedoc_3").disabled=!1);0<=dzeUiConfig.sWatermarkImageSrc.indexOf("secure_1")?(document.getElementById("dze_idx_securedoc_1").checked=!0,dzeLayoutControl.checked_secure_grade=
1):0<=dzeUiConfig.sWatermarkImageSrc.indexOf("secure_2")?(document.getElementById("dze_idx_securedoc_2").checked=!0,dzeLayoutControl.checked_secure_grade=2):0<=dzeUiConfig.sWatermarkImageSrc.indexOf("secure_3")&&(document.getElementById("dze_idx_securedoc_3").checked=!0,dzeLayoutControl.checked_secure_grade=3);document.getElementById("dze_idx_paper_watermark_0").onclick=function(){1==this.checked&&(document.getElementById("dze_idx_securedoc_1").disabled=!0,document.getElementById("dze_idx_securedoc_2").disabled=
!0,document.getElementById("dze_idx_securedoc_3").disabled=!0,dzeLayoutControl.checked_secure_grade=0)};document.getElementById("dze_idx_paper_watermark_1").onclick=function(){1==this.checked&&(document.getElementById("dze_idx_securedoc_1").disabled=!1,document.getElementById("dze_idx_securedoc_1").checked=!1,document.getElementById("dze_idx_securedoc_2").disabled=!1,document.getElementById("dze_idx_securedoc_2").checked=!1,document.getElementById("dze_idx_securedoc_3").disabled=!1,document.getElementById("dze_idx_securedoc_3").checked=
!1,dzeLayoutControl.checked_secure_grade=0)};document.getElementById("dze_idx_paper_out_view_paper1").onclick=function(){1==document.getElementById("dze_idx_paper_watermark_1").checked&&(document.getElementById("dze_idx_securedoc_1").checked=!0,dzeLayoutControl.checked_secure_grade=1)};document.getElementById("dze_idx_paper_out_view_paper2").onclick=function(){1==document.getElementById("dze_idx_paper_watermark_1").checked&&(document.getElementById("dze_idx_securedoc_2").checked=!0,dzeLayoutControl.checked_secure_grade=
2)};document.getElementById("dze_idx_paper_out_view_paper3").onclick=function(){1==document.getElementById("dze_idx_paper_watermark_1").checked&&(document.getElementById("dze_idx_securedoc_3").checked=!0,dzeLayoutControl.checked_secure_grade=3)}},setSecureGradeInfo:function(b){1==document.getElementById("dze_idx_paper_watermark_0").checked?dzeLayoutControl.setDocWatermarkSrc("",b):(1==document.getElementById("dze_idx_securedoc_1").checked?dzeLayoutControl.checked_secure_grade=1:1==document.getElementById("dze_idx_securedoc_2").checked?
dzeLayoutControl.checked_secure_grade=2:1==document.getElementById("dze_idx_securedoc_3").checked&&(dzeLayoutControl.checked_secure_grade=3),1==document.getElementById("dze_idx_paper_watermark_1").checked&&(0==dzeLayoutControl.checked_secure_grade?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALERT_CHOICE_DOC_SECURE_GRADE,1.5):dzeLayoutControl.setDocWatermarkSrc("image/dialog/"+("secure_"+dzeLayoutControl.checked_secure_grade+".png"),b)))},convMmToPx_In_PrintMarginPriview:function(b){return Math.floor(b/
2)},viewPreviewPrintMargin:function(b,a){b=dzeLayoutControl.convMmToPx_In_PrintMarginPriview(b);var c="sero";1==$_("dze_idx_paper_direction_type2").checked&&(c="garo");"top"==a?$_("dze_idx_paper_out_view").style.paddingTop=b+"px":"left"==a?$_("dze_idx_paper_out_view").style.paddingLeft=b+"px":"right"==a?$_("dze_idx_paper_out_view").style.paddingRight=b+"px":"bottom"==a&&($_("dze_idx_paper_out_view").style.paddingBottom=b+"px");"top"==a||"bottom"==a?(a="sero"==c?$_("dze_idx_paper_out_view").offsetHeight-
143:$_("dze_idx_paper_out_view").offsetHeight-103,$_("dze_idx_paper_out_view").style.height=parseInt($_("dze_idx_paper_out_view").style.height.replace(/px/,""),10)-a+"px",$_("dze_idx_paper_out_view").childNodes[0].style.height=parseInt($_("dze_idx_paper_out_view").style.height.replace(/px/,""),10)-2+"px"):(a="sero"==c?$_("dze_idx_paper_out_view").offsetWidth-103:$_("dze_idx_paper_out_view").offsetWidth-143,$_("dze_idx_paper_out_view").style.width=parseInt($_("dze_idx_paper_out_view").style.width.replace(/px/,
""),10)-a+"px",$_("dze_idx_paper_out_view").childNodes[0].style.width=parseInt($_("dze_idx_paper_out_view").style.width.replace(/px/,""),10)-2+"px");this.checkPrintMarginPreset()},viewPreviewPrintMarginAll:function(b){dzeLayoutControl.viewPreviewPrintMargin(b.top,"top");dzeLayoutControl.viewPreviewPrintMargin(b.left,"left");dzeLayoutControl.viewPreviewPrintMargin(b.right,"right");dzeLayoutControl.viewPreviewPrintMargin(b.bottom,"bottom")},initPrintSetting:function(b){dzeLayoutControl.updatePaperDirectionCtrl({width:dzeUiConfig.nSettingPaperSize.width,
height:dzeUiConfig.nSettingPaperSize.height});duzon_dialog.modifySpinnerValue("dze_print_margin_top",100,0,dzeUiConfig.nSettingPaperMargin.top,function(a){dzeLayoutControl.viewPreviewPrintMargin(a,"top")});duzon_dialog.modifySpinnerValue("dze_print_margin_left",100,0,dzeUiConfig.nSettingPaperMargin.left,function(a){dzeLayoutControl.viewPreviewPrintMargin(a,"left")});duzon_dialog.modifySpinnerValue("dze_print_margin_right",100,0,dzeUiConfig.nSettingPaperMargin.right,function(a){dzeLayoutControl.viewPreviewPrintMargin(a,
"right")});duzon_dialog.modifySpinnerValue("dze_print_margin_bottom",100,0,dzeUiConfig.nSettingPaperMargin.bottom,function(a){dzeLayoutControl.viewPreviewPrintMargin(a,"bottom")});$_("dze_print_margin_top").select();for(var a=cmnDlg.getDlg().getElementsByTagName("input"),c=0;c<a.length;c++)"radio"==a[c].getAttribute("type")&&"999"!=a[c].value&&function(){var b=a[c].value;a[c].onclick=function(){1==this.checked&&("dze_idx_paper_direction_type1"==this.id||"dze_idx_paper_direction_type2"==this.id?dzeLayoutControl.updatePaperDirectionCtrl(this.value):
"dze_idx_onepagemode_off"==this.id||"dze_idx_onepagemode_on"==this.id?(dzeLayoutControl.updateOnePageModeCtrl(this.value),"on"===this.value?(document.getElementById("dze_idx_pgContentsOverflow_off").disabled=!0,document.getElementById("dze_idx_pgContentsOverflow_on").disabled=!0):(document.getElementById("dze_idx_pgContentsOverflow_off").disabled=!1,document.getElementById("dze_idx_pgContentsOverflow_on").disabled=!1)):"dze_idx_pgContentsOverflow_off"!=this.id&&"dze_idx_pgContentsOverflow_on"!=this.id&&
($_("dze_print_margin_top").value=b,$_("dze_print_margin_left").value=b,$_("dze_print_margin_right").value=b,$_("dze_print_margin_bottom").value=b,dzeLayoutControl.viewPreviewPrintMarginAll({top:b,left:b,right:b,bottom:b})))}}();b={top:$_("dze_print_margin_top").value,left:$_("dze_print_margin_left").value,right:$_("dze_print_margin_right").value,bottom:$_("dze_print_margin_bottom").value};this.viewPreviewPrintMarginAll(b);g_objColorComboBoxUtil.initColorComboBox("dze_paper_background",function(a){document.getElementById("dze_idx_paper_out_view").style.backgroundColor=
a;document.getElementById("dze_idx_paper_out_view_paper").style.backgroundColor=a;var b=document.getElementById("dze_idx_paper_out_view_paper").childNodes.length;if(0<b)for(var c=0;c<b;c++)document.getElementById("dze_idx_paper_out_view_paper").childNodes[c].style.backgroundColor=a});g_objColorComboBoxUtil.setColorValue("dze_paper_background",dzeUiConfig.sSettingPaperColor);document.getElementById("dze_idx_paper_out_view").style.backgroundColor=dzeUiConfig.sSettingPaperColor;document.getElementById("dze_idx_paper_out_view_paper").style.backgroundColor=
dzeUiConfig.sSettingPaperColor;!0===dzeUiConfig.bOfficeOnePageLongMode?(document.getElementById("dze_idx_onepagemode_on").checked=!0,document.getElementById("dze_idx_onepagemode_off").checked=!1,dzeLayoutControl.updateOnePageModeCtrl("on"),document.getElementById("dze_idx_pgContentsOverflow_off").disabled=!0,document.getElementById("dze_idx_pgContentsOverflow_on").disabled=!0):(document.getElementById("dze_idx_onepagemode_on").checked=!1,document.getElementById("dze_idx_onepagemode_off").checked=
!0,dzeLayoutControl.updateOnePageModeCtrl("off"),document.getElementById("dze_idx_pgContentsOverflow_off").disabled=!1,document.getElementById("dze_idx_pgContentsOverflow_on").disabled=!1)},checkPrintMarginPreset:function(){for(var b=cmnDlg.getDlg().getElementsByTagName("input"),a=!1,c=0;c<b.length;c++)if("radio"==b[c].getAttribute("type")&&"999"!=b[c].value){var d=b[c].value;d==$_("dze_print_margin_top").value&&d==$_("dze_print_margin_left").value&&d==$_("dze_print_margin_right").value&&d==$_("dze_print_margin_bottom").value&&
(a=b[c].checked=!0)}!0!==a&&($_("dze_idx_print_margin_type999").checked=!0)},setNewPrintMargin:function(b){var a=dzeUiConfig.nSettingPaperMargin;a.top=parseFloat($_("dze_print_margin_top").value||0);a.left=parseFloat($_("dze_print_margin_left").value||0);a.right=parseFloat($_("dze_print_margin_right").value||0);a.bottom=parseFloat($_("dze_print_margin_bottom").value||0);dzeLayoutControl.setDocPrintMargin(b,a)},setPaperBackground:function(b){var a=g_objColorComboBoxUtil.getColorValue("dze_paper_background");
""==a&&(a="#FFFFFF");dzeUiConfig.sSettingPaperColor=a;dzeUiConfig.bOfficePagingMode?g_objPageControl.setDocumentPageColor(b,a):(g_objEditorDocument[b].body.style.backgroundColor=a,setTimeout(function(){dzeLayoutControl.setEditAreaSize(b)},500))},setDocPageColor:function(b){var a=this.getDocPageColor(b);dzeUiConfig.sSettingPaperColor=a;dzeUiConfig.bOfficePagingMode?g_objPageControl.setDocumentPageColor(b,a):g_objEditorDocument[b].body.style.backgroundColor=a},getDocPageColor:function(b){var a="#FFFFFF",
c=g_objEditorDocument[b].body;c&&c.childElementCount&&(b=dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property"))&&"dze_document_property"==b.className&&(a=b.getAttribute(DZE_CUSTOM_ATT_PAGECOLOR),null==a&&(a="#FFFFFF"));return a},setObjExtInfo:function(b,a){try{if(b&&b.firstElementChild){var c=b.firstElementChild;for(a=0;a<b.childElementCount;a++){var d=c.nodeName.toLowerCase(),e=c.getAttribute("data");if(e)switch(d){case DZE_CUSTOM_ATT.MEMO:dzeUiConfig.objExtInfo.comments.data=e.split(",");
break;case DZE_CUSTOM_ATT.TODO:dzeUiConfig.objExtInfo.todos.data=e.split(",")}c=c.nextElementSibling}}}catch(f){alert(f)}},setOnePageMode:function(b){try{b=!1,1==document.getElementById("dze_idx_onepagemode_on").checked&&(b=!0),dzeUiConfig.bOfficeOnePageLongMode!==b&&g_objPageControl.changePageMode(b)}catch(a){dalert(a)}},setDocPgOverflow:function(b){try{var a=!1,c=dzeLayoutControl.m_ctrlPgContentsRadioTD;a=c?c.firstElementChild.firstElementChild.checked?!1:!0:dzeLayoutControl.getDocPgOverflow(b);
dzeUiConfig.bOfficePgOverflowVisible=a;return dzeUiConfig.bOfficePgOverflowVisible}catch(d){dalert(d)}},getDocPgOverflow:function(b){var a=!1,c=g_objEditorDocument[b].body;c&&c.childElementCount&&(b=dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property"))&&"dze_document_property"==b.className&&(a=b.getAttribute(DZE_CUSTOM_ATT_PAGE_OVERFLOWVISIBLE),a="false"==a||null==a?!1:!0);return a},getDocWatermarkSrcFromDocProperty:function(b){var a="",c=g_objEditorDocument[b].body;if(c&&c.childElementCount&&
(c=dzeLayoutControl.getCustomPropertyEle(b,"dze_doc_property"))&&"dze_document_property"==c.className){a=c.getAttribute(DZE_CUSTOM_ATT_WATERMARKSRC);null==a&&(a="");b=parseInt(c.getAttribute(DZE_CUSTOM_ATT_WATERMARKTYPE));c=c.getAttribute(DZE_CUSTOM_ATT_WATERMARKDATA);var d=[];c&&0<c.length&&(d=c.split(","),g_objWaterMarkMgr.watermarkMode=b);2===b?(g_objWaterMarkMgr.m_watermarkTextAttr.text=d[0],g_objWaterMarkMgr.m_watermarkTextAttr.font_family=d[1],g_objWaterMarkMgr.m_watermarkTextAttr.font_size=
d[2],"true"===d[3]&&(g_objWaterMarkMgr.m_watermarkTextAttr.bold=!0),"true"===d[4]&&(g_objWaterMarkMgr.m_watermarkTextAttr.italic=!0),g_objWaterMarkMgr.m_watermarkTextAttr.opacity=parseFloat(d[5])):1===b&&(g_objWaterMarkMgr.m_watermarkPicAttr.path=d[0],g_objWaterMarkMgr.m_watermarkPicAttr.zoom=d[1],g_objWaterMarkMgr.m_watermarkPicAttr.rotate=d[2],g_objWaterMarkMgr.m_watermarkPicAttr.opacity=parseFloat(d[3]))}return a},setDocWatermarkSrc:function(b,a){try{dzeUiConfig.sWatermarkImageSrc=b;""!=b?changeCss(".dze_page_container",
"background","url('"+b+"') no-repeat center center;",g_objEditorDocument[a]):changeCss(".dze_page_container","background","",g_objEditorDocument[a],null,!0);var c=dzeLayoutControl.getCustomPropertyEle(a,"dze_doc_property");c||(c=dzeLayoutControl.getCustomPropertyEle(DZE_IFRAME_TMP_NO,"dze_doc_property"));c&&"dze_doc_property"==c.nodeName.toLowerCase()&&"dze_document_property"==c.className&&(b=[],2===g_objWaterMarkMgr.watermarkMode?(b[0]=g_objWaterMarkMgr.m_watermarkTextAttr.text,b[1]=g_objWaterMarkMgr.m_watermarkTextAttr.font_family,
b[2]=g_objWaterMarkMgr.m_watermarkTextAttr.font_size,b[3]=g_objWaterMarkMgr.m_watermarkTextAttr.bold,b[4]=g_objWaterMarkMgr.m_watermarkTextAttr.italic,b[5]=g_objWaterMarkMgr.m_watermarkTextAttr.opacity):1===g_objWaterMarkMgr.watermarkMode&&(b[0]=g_objWaterMarkMgr.m_watermarkPicAttr.path,b[1]=g_objWaterMarkMgr.m_watermarkPicAttr.zoom,b[2]=g_objWaterMarkMgr.m_watermarkPicAttr.rotate,b[3]=g_objWaterMarkMgr.m_watermarkPicAttr.opacity),dzeUiConfig.mWatermarkData=b,dzeUiConfig.mWatermarkType=g_objWaterMarkMgr.watermarkMode)}catch(d){dalert(d)}},
setDocWatermarkSrcFromDocProperty:function(b){try{var a=this.getDocWatermarkSrcFromDocProperty(b);this.setDocWatermarkSrc(a,b)}catch(c){dalert(c)}},showRightPannel:function(b){try{var a=document.getElementById("dze_idx_right_pannel_td_"+b);if("none"==a.style.display){duzon_dialog.fade("in",a);var c=document.getElementById("dze_idx_div_right_pannel_top_"+b);if(null==c){var d=document.getElementById("dze_idx_right_pannel_"+b);c=document.createElement("div");c.className="div_style_right_pannel_top";
c.id="dze_idx_div_right_pannel_top_"+b;d.appendChild(c);var e=document.createElement("div");e.className="right_pannel_top_title_string";e.id="dze_idx_right_pannel_top_title_string_"+b;c.appendChild(e);var f=document.createElement("div");f.className="btn_style_right_pannel_close_normal";f.title=ID_RES_ADJUST_VIEW_CLOSE;f.onclick=function(){dzeLayoutControl.showRightPannel(b);dzeLayoutControl.setRightPannelToobarInitialize(b)};f.onmouseover=function(){this.className="btn_style_right_pannel_close_over"};
f.onmouseout=function(){this.className="btn_style_right_pannel_close_normal"};c.appendChild(f);var h=document.createElement("div");h.className="div_style_right_pannel_body";h.id="dze_idx_div_right_pannel_body_"+b;d.appendChild(h);h.onmousedown=function(a){TBCancelBubbleEvent(a)}}}else a.style.display="none";resizeEditor_Height(b)}catch(g){dalert(g)}},listRightPannelToolbar:[ID_COMMAND_DOCUMENT_HISTORY],setRightPannelToobarInitialize:function(b){for(var a,c=0;c<this.listRightPannelToolbar.length;c++){a=
this.listRightPannelToolbar[c];var d=document.getElementById(g_arrConst[a][2]+"_"+b);TBSetState(d,ID_STRING_NAME_UNCHECKED,g_arrConst[a][6])}},getValueWithRatio:function(b){try{return b*(g_objZoom.getDocZoomValue()/100)}catch(a){dalert(a)}},getValueWithoutRatio:function(b){try{return b*(100/g_objZoom.getDocZoomValue())}catch(a){dalert(a)}},setExportFrom:function(b){try{if(!b)return null;var a=b.getAttribute("export_from");if(!a)return null;var c=b.ownerDocument,d=c?c.body:null;if(!d)return null;if("wehago"===
a){var e=d.querySelectorAll(".sheet");if(0<e.length){var f=c.createElement("div");f.className="dze_printpagebreak";f.contenteditable=!1;var h=null,g=c.createDocumentFragment();forEach(e,function(a,b){h=f.cloneNode(!0);insertAfter(b,h);g_objNodeUtil.moveNodesTo(g,b.firstChild);b.parentNode.replaceChild(g,b)},this);h&&h.parentNode&&(h.parentNode.removeChild(h),h=null)}b.removeAttribute("export_from");return{bSave:!0}}return null}catch(k){dalert(k)}}};
function Section(){this.pageColor=this.pageMargin=this.pageSize=null;this.bOfficeOnePageLongMode=!1;this.type=null}var g_objSectionUtil=new Section;Section.prototype.isSectionNode=function(b){try{return b&&b.nodeType==ID_SELECTION_ELEMENT_NODE&&"dze_doc_property"==b.tagName.toLowerCase()?!0:!1}catch(a){dalert(a)}};
Section.prototype.equal=function(b){try{return b?this.pageSize.width==b.pageSize.width&&this.pageSize.height==b.pageSize.height&&this.pageMargin.top==b.pageSize.top&&this.pageMargin.bottom==b.pageSize.bottom&&this.pageMargin.left==b.pageSize.left&&this.pageMargin.right==b.pageSize.right&&this.pageMargin.headerTop==b.pageSize.headerTop&&this.pageMargin.footerBottom==b.pageSize.footerBottom&&this.pageMargin.pageColor==b.pageSize.pageColor?!0:!1:!1}catch(a){dalert(a)}};
Section.prototype.getFirstSection=function(){try{var b=dzeUiConfig,a=new Section;a.pageSize=cloneSimpleObject(b.nSettingPaperSize);a.pageMargin=cloneSimpleObject(b.nSettingPaperMargin);a.pageColor=b.sSettingPaperColor;a.bOfficeOnePageLongMode=b.bOfficeOnePageLongMode;return a}catch(c){dalert(c)}};
Section.prototype.getSectionFromPropElem=function(b){try{if(!this.isSectionNode(b))return null;var a=this.getFirstSection(),c=b.getAttribute(DZE_CUSTOM_ATT_PAPERSIZE),d=b.getAttribute(DZE_CUSTOM_ATT_PAGEMARGIN),e=b.getAttribute(DZE_CUSTOM_ATT_PAGECOLOR),f=b.getAttribute(DZE_CUSTOM_ATT_ONEPAGE_MODE);b.getAttribute(DZE_CUSTOM_ATT_PAGE_OVERFLOWVISIBLE);var h=b.getAttribute(DZE_CUSTOM_ATT_SECTION_TYPE);if(f){var g=duzon_http.parseJSON(f);"boolean"==typeof g&&(a.bOfficeOnePageLongMode=g)}if(h&&(g=h.toLowerCase(),
a.type=g,"none"==g)||!dzeUiConfig.bUseMultipleSection)return a;c&&(g=c.split(","),a.pageSize={width:parseFloat(g[0]),height:parseFloat(g[1])});d&&(g=d.split(","),a.pageMargin={top:parseInt(g[0],10),right:parseInt(g[1],10),bottom:parseInt(g[2],10),left:parseInt(g[3],10)},a.pageMargin.headerTop=g[4]?parseFloat(g[4]):a.pageMargin.top/2,a.pageMargin.footerBottom=g[5]?parseFloat(g[5]):a.pageMargin.bottom/2);e&&(a.pageColor=e);return a}catch(k){dalert(k)}};
var g_objZoom=new function(){var e=100;this.wheelTimer=null;this.nWheelStoredZoom=!1;this.margin=10;this.saveZoomAttName=DZE_CUSTOM_ATT_PAGEZOOM;this.cache={};this.getDocZoomValue=function(){return e};this.getMinZoomValue=function(){return 25};this.getMaxZoomValue=function(){return 400};this.unload=function(){this.cache={}};this.getDocZoomValueFromZoomElem=function(a){try{var b=this.findElement("zoom",a);if(b){var c=b.style.transform;if(""===c)return 100;c=c.match(/[+-]?\d+(\.\d+)?/g).map(function(a){return parseFloat(a)});
c=c[0];return c=parseInt(100*c,10)}return e}catch(d){return e}};this.saveCache=function(a,b){this.cache||(this.cache={});a&&b&&(this.cache[a+"Elem"]=b);return b};this.getCache=function(a){return(a=a&&this.cache?this.cache[a+"Elem"]:null)&&g_objNodeUtil.isAlive(a)?a:null};this.findElement=function(a,b){try{var c=this.getCache(a);if(c)return c;"undefined"===typeof b&&(b=g_nActiveEditNumber);c=null;if("zoom"===a)c=g_objEditorDocument[b].getElementById("dze_document_container");else if("zoom_wrapper"===
a)c=g_objEditorDocument[b].getElementById("dze_document_container_wrapper");else if("scroll"===a)c=g_objEditorDocument[b].body.firstChild;else if("ruler"===a)c=document.getElementById("TB_CONTAINER_RULERBAR_"+b);else if("noti"===a)c=document.getElementById("TB_CONTAINER_READONLY_NOTIBAR_"+b);else if("zoomtext"===a)c=document.getElementById("ZOOM_VALUE_"+b);else if("iframe"===a)c=objOnefficeLoader.m_bHybrid?document.getElementById("dzeditor_"+b):document.getElementById("DZE_IDX_EDITOR_EDITOR_FRAME_"+
b);else return null;this.saveCache(a,c);return c}catch(d){return null}};this.setStyleTransform=function(a,b){a&&1===a.nodeType&&(a.style.transform="scale("+b+")",a.style.msTransform="scale("+b+")")};this.setStyleTransformOrigin=function(a,b){a&&1===a.nodeType&&("left top"===b?(a.style.transformOrigin="left top",a.style.msTransformOrigin="left top",a.style.marginLeft=this.margin+"px",a.style.marginRight=this.margin+"px"):"center top"===b&&(a.style.transformOrigin="center top",a.style.msTransformOrigin=
"center top",a.style.marginLeft="auto",a.style.marginRight="auto"))};this.zoomDocument=function(a,b,c){try{if(!0===dzeUiConfig.bOfficePagingMode){var d=this.findElement("scroll",a),f=this.findElement("zoom",a);if(d&&f&&(b=Math.max(b,this.getMinZoomValue(a)),b=Math.min(b,400),b!==this.getDocZoomValue()||!0===c)){var h=d.scrollTop*b/this.getDocZoomValue();e=b;this.setStyleTransform(f,b/100);var k=this.getFitPageWidthZoomValue(a);c=e>=k;this.setStyleTransformOrigin(f,c?"left top":"center top");this.setStyleTransformOrigin(this.findElement("ruler",
a),c?"left top":"center top");var g=g_browserCHK.iOS?this.findElement("zoom_wrapper",a):null;g&&f&&(g.style.height=f.offsetHeight*b/100+"px");this.setEditorIframeHeight(a);d.scrollTop=h;this.afterZoomDocument(a)}}}catch(l){dalert(l)}};this.getRulerBarHeight=function(a){try{var b=this.findElement("ruler",a);return b&&"none"!==b.style.display?b.offsetHeight:0}catch(c){dalert(c)}};this.getNotiBarHeight=function(a){try{var b=this.findElement("noti",a);return b&&"none"!==b.style.display?b.offsetHeight+
4:0}catch(c){dalert(c)}};this.setEditorIframeHeight=function(a){try{var b=g_objEditObject[a];if(b&&"%"!==g_objCommonUtil.extractNumberValueUnit(b.style.height).strUnit){var c=this.getRulerBarHeight(a)||0,d=this.getNotiBarHeight(a)||0;b.style.height=parseInt(g_nEditAreaSetHeight-c-d,10)+"px"}}catch(f){dalert(f)}};this.afterZoomDocument=function(a){try{var b=this.getDocZoomValue();1===dzeUiConfig.saveZoomType&&localStorage.setItem(this.saveZoomAttName,b);var c=this.findElement("zoomtext",a);c&&(c.innerHTML=
parseInt(b,10)+"%");if(!1===fnObjectCheckNull(g_objPageControl))g_objPageControl.onChangeEditAreaScrollHorizontalPositionWidth();dze_menu_control.setSliderBtnPosition(a,b);g_objTableResize.setTableMoveLine(!1,!1,0,0,0,0,0);g_objWrapperOutlineResize.objExtSelectedInfo&&showExtOutline_ObjectElement(g_objWrapperOutlineResize.objExtSelectedInfo.objElement,!0,!1,a);g_objTableMiniMenu.onZoom(a);if(0<g_objSelectedShapesArray.length)for(b=0;b<g_objSelectedShapesArray.length;b++)g_objWrapperOutlineUtil_Improved.updateOutline(g_objSelectedShapesArray[b]);
g_objPasteOptionMenu.onZoom();pageManager.getInstance().hideButtonContainer();g_objRulerBar.delayUpdate(a)}catch(d){dalert(d)}};this.setUnitZoomValue=function(a,b){try{var c=e,d=c;d=10*Math.floor((c+b)/10);this.zoomDocument(a,d);return d}catch(f){dalert(f)}};this.setPresetZoomValue=function(a,b){return this.zoomDocument(a,this.getPresetZoomValue(a,b))};this.getPresetZoomValue=function(a,b){return 0===b?this.getFitPageWidthZoomValue(a):1===b?this.getFitPageZoomValue(a):this.getDocZoomValue()};this.getFitPageWidthZoomValue=
function(a){try{var b=this.findElement("iframe",a),c=g_objPageControl.getPageContainer(0);return b&&c?Math.max((b.offsetWidth-2*this.margin)/c.offsetWidth*100,10):this.getDocZoomValue()}catch(d){dalert(d)}};this.getFitPageZoomValue=function(a){try{var b=this.findElement("iframe"),c=g_objPageControl.getPageContainer(0);if(!b||!c)return this.getDocZoomValue();var d=isShowedRulerBar(),e=d?this.getRulerBarHeight(a):0,h=b.offsetHeight,k=c.offsetHeight,g=this.margin,l=(b.offsetWidth-g)/c.offsetWidth;a=
(h-g+e)/k;b=null;l<=a?b=l:(e=d?Math.floor(24*a):0,b=(h-g-e)/k);return Math.max(Math.floor(100*b),10)}catch(m){dalert(m)}};this.initDocZoomPropertyInfo=function(a){try{if(0!==dzeUiConfig.saveZoomType&&100!==e){var b=e;e=100;this.zoomDocument(a,b)}}catch(c){return dalert(c),100}};this.setConfigDocZoomPropertyInfo=function(a){try{var b=this.getDocZoomPropertyInfo(a);b&&(b=parseInt(b,10),b=Math.max(b,this.getMinZoomValue(a)),e=b=Math.min(b,400))}catch(c){dalert(c)}};this.getDocZoomPropertyInfo=function(a){try{var b=
100;if(2===dzeUiConfig.saveZoomType){var c=dzeLayoutControl.getCustomPropertyEle(a,"dze_doc_property");c&&"dze_document_property"===c.className&&(b=c.getAttribute(this.saveZoomAttName)||100)}else b=localStorage.getItem(this.saveZoomAttName)||100;return parseInt(b,10)}catch(d){return dalert(d),100}};this.saveDocZoomPropertyInfo=function(a){try{var b=dzeUiConfig.saveZoomType,c=this.getDocZoomValue();2===b?a.setAttribute(this.saveZoomAttName,c):1===b&&localStorage.setItem(this.saveZoomAttName,c)}catch(d){dalert(d)}};
this.onMouseWheel=function(a,b){try{var c=a.wheelDelta;!0===fnObjectCheckNull(c)&&(c=-40*a.deltaY);a=0>c?-10:10;null!==this.wheelTimer?this.nWheelStoredZoom+=a:(this.nWheelStoredZoom=a,clearTimeout(this.wheelTimer),this.wheelTimer=setTimeout(function(){this.setUnitZoomValue(b,this.nWheelStoredZoom);this.wheelTimer=null}.bind(this),1))}catch(d){dalert(d)}}};
objOnefficeLoader.m_bHybrid&&(g_objZoom.margin=5,g_objZoom.saveZoomAttName+="_mobile",g_objZoom.getDocZoomValue=g_objZoom.getDocZoomValueFromZoomElem,g_objZoom.getMinZoomValue=function(e){return Math.min(g_objZoom.getFitPageWidthZoomValue(e),100)},g_objZoom.initDocZoomPropertyInfo=function(e){try{0!==dzeUiConfig.saveZoomType&&this.zoomDocument(e,this.getMinZoomValue(e),!0)}catch(a){return dalert(a),100}});
var PictureCropper=function(a){this.$orgImg=a.imgNode;this.initHandler=a.initHandler;this.moveHandler=a.moveHandler;this.startHandler=a.startHandler;this.endHandler=a.endHandler;this.minContainerWidth=void 0===a.minContainerWidth?0:a.opt.minContainerWidth;this.minContainerHeight=void 0===a.minContainerHeight?0:a.opt.minContainerHeight;this.$Container;this.cropObj;this.$orgImgClone=this.$orgImg.cloneNode();this.imgHeight=Number(this.$orgImg.style.height.replace("px",""));this.imgWidth=Number(this.$orgImg.style.width.replace("px",
""));this.$orgImgClone.width=this.imgWidth;this.$orgImgClone.height=this.imgHeight};
PictureCropper.prototype={init:function(){var a=this;void 0!=a.cropObj&&a.destroy();a.createTempCotainer();a.cropObj=new Cropper(a.$orgImgClone,{guides:!1,minContainerWidth:a.minContainerWidth,minContainerHeight:a.minContainerHeight,minCropBoxWidth:a.minContainerWidth,minCropBoxHeight:a.minContainerHeight,viewMode:3,movable:!1,zoomable:!1,ready:function(b){var c=Number(a.$orgImg.style.height.replace("px","")),d=Number(a.$orgImg.style.width.replace("px",""));a.cropObj.setCropBoxData({width:d,height:c,
left:0,top:0});void 0!=a.initHandler&&a.initHandler(b,a)},cropstart:function(b){void 0!=a.startHandler&&a.startHandler(b,a)},cropend:function(b){void 0!=a.endHandler&&a.endHandler(b,a)},cropmove:function(b){void 0!=a.moveHandler&&a.moveHandler(b,a)},zoom:function(a){}})},createTempCotainer:function(){this.$Container=document.createElement("div");this.$Container.className="cropper-mode";this.$Container.style.height=this.imgHeight+"px";this.$Container.style.width=this.imgWidth+"px";this.$orgImgClone.id=
"";this.$orgImgClone.style.display="inline-block";this.$Container.appendChild(this.$orgImgClone);this.$orgImg.parentNode.insertBefore(this.$Container,this.$orgImg);this.$orgImg.classList.add("dze_img_edit_mode")},getCropObj:function(){return this.cropObj},changeOrgImgView:function(a){dlog("orgImgPath",this.$orgImg.src);dlog("cropImgPath",this.getCropImgPath());var b=this.cropObj.getCropBoxData();a=b.width;b=b.height;this.$orgImg.src=this.getCropImgPath();this.$orgImg.style.width=a+"px";this.$orgImg.style.height=
b+"px";this.destroy()},getOrgImgTag:function(a){return this.$orgImg},getCropImgTag:function(a){void 0===a&&(a=document.createElement("img"));var b=this.cropObj.getCroppedCanvas();a.src=b.toDataURL();return a},getCropImgPath:function(){return this.cropObj.getCroppedCanvas().toDataURL()},resetCropGrid:function(){this.cropObj.reset()},setRotate:function(a){0>a||360<a||this.cropObj.rotateTo(a)},setAspectRatio:function(a){this.cropObj.setAspectRatio(a)},destroy:function(){null!=this.cropObj&&this.cropObj.destroy();
null!=this.$Container&&this.$Container.parentNode.removeChild(this.$Container);delete this.cropObj;delete this.$Container;this.$orgImg.classList.remove("dze_img_edit_mode")}};
var LayoutTableDlg=duzon_dialog.extend();
(function(){this.bUseMaxTextCount=!1;void 0!=objOnefficeLoader&&objOnefficeLoader.m_bDomainBizwatch&&(this.bUseMaxTextCount=!0);this.grid=this.widgets=null;this.log=function(c,b){if(b){for(var a="",h=0;h<b.length&&b[h];h++)a+=" (x,y)="+b[h].x+","+b[h].y;dlog(c+b.length+" items."+a)}};this.getWidgetHTML=function(c,b){b=b?'<div class="newWidget grid-stack-item" widget-type="'+c.type+'" data-gs-width="'+c.col+'" data-gs-height="'+c.row+'"'+(c.minCol?' data-gs-min-width="'+c.minCol+'"':"")+(c.minRow?
' data-gs-min-height="'+c.minRow+'"':"")+' style="width:'+c.width+"px;height:"+c.height+'px;">':'<div widget-type="'+c.type+'">';b=b+'<div class="grid-stack-item-content">'+c.content;return b+"</div></div>"};this.initWidget=function(){try{var c=function(a){var c=a.type;if(c){void 0===a.col&&(a.col=20);void 0===a.width&&(a.width=250);void 0===a.content&&(a.content="<p><br></p>");var d=a.setCellContent;a.setCellContent=function(a,b){a.className="dze_tb_layout_td";d&&d(a,b);a.firstChild||(a.innerHTML=
"<p><br></p>")};b.widgets[c]=a;a.drag_html=b.getWidgetHTML(a,!0);a.html=b.getWidgetHTML(a,!1)}};this.widgets={};var b=this;c({type:"title",row:3,height:60,minCol:10,content:'<h1 class="fit" style="font-size:21pt;font-weight:bold;margin:0;">'+ID_RES_STRING_ENTER_TITLE+"</h1>",setCellContent:function(a){a.className="dze_tb_layout_td";a.setAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD,ID_RES_STRING_ENTER_TITLE);a.innerHTML="<h1><br></h1>"}});c({type:"subtitle-date",row:2,height:40,content:['<div style="float:left;width:186px;">',
'<h3 class="fit" style="font-size:15pt;font-weight:bold;margin:0;">'+ID_RES_STRING_ENTER_SUBTITLE+"</h3>",'</div><div style="float:left;border-right:1px dashed rgb(197, 197, 197);height:100%;"></div><div style="float:left;">','<p class="fit">'+ID_RES_STRING_DATE+"</p>","</div>"].join(""),setCellContent:function(a){a.setAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD,ID_RES_STRING_ENTER_SUBTITLE);a.innerHTML="<h3><br></h3>"}});c({type:"content",row:5,height:80,content:'<p class="fit">'+ID_RES_STRING_ENTER_CONTENT+
"<br>"+(b.bUseMaxTextCount?"("+ID_RES_STRING_LIMT_CHAR_COUNT+": 1000)":"")+"</p>",setCellContent:function(a){b.bUseMaxTextCount&&a.setAttribute("max_text_counts",1E3);a.setAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD,ID_RES_STRING_ENTER_CONTENT);a.style.verticalAlign="top"}});c({type:"content_small",row:2,height:40,content:'<p class="fit">'+ID_RES_STRING_ENTER_CONTENT+"<br>"+(b.bUseMaxTextCount?" ("+ID_RES_STRING_LIMT_CHAR_COUNT+": 400)":"")+"</p>",setCellContent:function(a){b.bUseMaxTextCount&&a.setAttribute("max_text_counts",
400);a.setAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD,ID_RES_STRING_ENTER_CONTENT);a.style.verticalAlign="top"}});c({type:"image",row:9,height:80,content:['<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;background-color:#f2f2f2;">','<img src="'+dzeEnvConfig.strPath_Image+'dialog/ico_placeholder_img.png" style="width:40px;height:40px;"></img>','<p class="fit" style="margin-top:5px !important;">'+ID_RES_STRING_INSERT_IMG+"</p>","</div>"].join(""),setCellContent:function(a){a.style.verticalAlign=
"top";a.innerHTML="<p><img "+DZE_CUSTOM_ATT_PLACEHOLDER_IMG+' src="'+dzeEnvConfig.strPath_Image+'dialog/bg_transparent.png" style="width:100%;height:100%;"></img></p>'}});c({type:"video-content1009",row:9,height:80,content:['<div style="float:left;width:124px;display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;background-color:#f2f2f2;">','<img src="'+dzeEnvConfig.strPath_Image+'dialog/ico_placeholder_video.png" style="width:40px;height:40px;"></img>','<p class="fit" style="margin-top:5px !important;max-width: 124px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+
ID_RES_STRING_INSERT_VIDEO+"</p>",'</div><div style="float:left;border-right:1px dashed rgb(197, 197, 197);height:100%;"></div><div style="float:left;">','<p class="fit" style="max-width: 124px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">'+ID_RES_STRING_ENTER_CONTENT+"</p>","</div>"].join(""),setCellContent:function(a){a.style.verticalAlign="top";a.innerHTML="<p><img "+DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO+' src="'+dzeEnvConfig.strPath_Image+'dialog/bg_transparent.png" style="width:100%;height:100%;"></img></p>'}});
c({type:"subtitle",col:14,row:2,height:40,content:'<h3 class="fit" style="font-size:15pt;font-weight:bold;margin:0;">'+ID_RES_STRING_ENTER_SUBTITLE+"</h3>",setCellContent:function(a){a.setAttribute(DZE_CUSTOM_ATT_PLACEHOLDER_TD,ID_RES_STRING_ENTER_SUBTITLE);a.innerHTML="<h3><br></h3>"}});c({type:"date",col:6,row:2,height:20,content:'<p class="fit">'+ID_RES_STRING_DATE+"</p>",setCellContent:function(a){a.innerHTML="<p>"+getDateString()+"</p>"}});c({type:"video",col:10,row:9,height:40,content:['<div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;background-color:#f2f2f2;">',
'<img src="'+dzeEnvConfig.strPath_Image+'dialog/ico_placeholder_video.png" style="width:40px;height:40px;"></img>','<p class="fit" style="margin-top:5px !important;">'+ID_RES_STRING_INSERT_VIDEO+"</p>","</div>"].join(""),setCellContent:function(a){a.style.verticalAlign="top";a.innerHTML="<p><img "+DZE_CUSTOM_ATT_PLACEHOLDER_VIDEO+' src="'+dzeEnvConfig.strPath_Image+'dialog/bg_transparent.png" style="width:100%;height:100%;"></img></p>'}});c({type:"content1009",col:10,row:9,height:20,content:'<p class="fit">'+
ID_RES_STRING_ENTER_CONTENT+"</p>",setCellContent:function(a){a.style.verticalAlign="top"}})}catch(a){dalert(a)}};this.getContents=function(){try{var c=function(a,b){return'<div class="duzon_dialog_row" style="font-size:13px;font-weight:bold;margin:'+(b||0===b?"0":"20px")+' 0 10px 0;">'+a+"</div>"};this.initWidget();var b="";b+='<div style="display:flex;flex-direction:row;">';b+='<div style="width:400px;min-height:600px;">';b+='<div style="position:relative;height:20px;margin-bottom:7px;">';b+='<div id="trash" style="position:absolute;left:0;top:-25px;width:400px;height:50px;text-align:right;">';
b+='<img style="position:absolute;right:0;bottom:5px;width:20px;height:22px;" src="'+dzeEnvConfig.strPath_Image+'cloud/ico_cloud_trashbox.png">';b+="</div>";b+="</div>";b+=function(a,b){var c='<table id="bg_table" class="unselectable" style="position:absolute; border-collapse:collapse; background-image: url(/oneffice/image/dialog/bg_grid.gif); width:402px;" cellspacing="0" cellpadding="1">';for(var d=0;d<b;d++){c+="<tr>";for(var h=0;h<a;h++)c+="<td></td>";c+="</tr>"}return c+"</table>"}(20,30);b+=
'<div id="grid" class="grid-stack grid-stack-20" style="width:400px;min-height:600px;" data-gs-max-row="30" data-gs-animate="yes"></div>';b+="</div>";b+='<div class="duzon_dialog_label_vseparator"></div>';b+="<div>";var a=" "+ID_RES_TOOL_STRING_MENU_LAYOUT;b+=c(ID_RES_PROP_TEMPLETE_STRING_SUBJECT+a,0);b+=this.widgets.title.drag_html;b+=c(ID_RES_STRING_SUBTITLE+a);b+=this.widgets["subtitle-date"].drag_html;b+=c(ID_RES_STRING_BODY+a);b+=this.widgets.content.drag_html;b+='<div style="margin-top:15px;"></div>';
b+=this.widgets.content_small.drag_html;b+=c(ID_RED_CONST_STRING_IMAGE+" "+ID_RES_TOOL_STRING_MENU_INSERT+a);b+=this.widgets.image.drag_html;b+=c(ID_RES_STRING_VIDEO+" "+ID_RES_TOOL_STRING_MENU_INSERT+a);b+=this.widgets["video-content1009"].drag_html;return b+"</div></div>"}catch(h){dalert(h)}};this.onload=function(c){try{if(c){var b=this;dzeJ(c.ownerDocument).on("keydown",this.onKeyDown);var a=dzeJ("#grid");this.grid=a.gridstack({column:20,maxRow:30,row:30,cellHeight:20,float:!0,removable:"#trash",
removeTimeout:100,acceptWidgets:".newWidget",resizable:{handles:"e, se, s, sw, w, nw, n, ne"},alwaysShowResizeHandle:!1,verticalMargin:0}).data("gridstack");wrap(this.grid,"_readAttr",function(a,b,c){c=a.apply(this,Array.prototype.slice.call(arguments,1));b=dzeJ(b);c.type=b.attr("widget-type");return c});a.on("added",this.onAdded);a.on("removed",this.onRemoved);a.on("change",this.onChange);var h=dzeJ(c);h.on("dragstart",this.onDragStart);h.on("dragstop",this.onDragStop);h.on("dropped",this.onDropped);
var d=dzeJ(".newWidget");d.draggable({revert:"invalid",scroll:!1,appendTo:"div.duzon_dialog",helper:"clone"});d.each(function(a,c){dzeJ(c).on("click",b.onClick)});var e=dzeJ("#trash");e.on("dropover",function(a,b){dzeJ(this).children("img").attr("src",dzeEnvConfig.strPath_Image+"cloud/ico_cloud_trashbox_open.png")});a=function(a,b){dzeJ(this).children("img").attr("src",dzeEnvConfig.strPath_Image+"cloud/ico_cloud_trashbox.png")};e.on("dropout",a);e.on("drop",a);textFit(c.querySelectorAll(".fit"),{detectMultiLine:!1})}}catch(f){dalert(f)}};
this.onunload=function(c){try{dzeJ(c.ownerDocument).off("onkeydown",LayoutTableDlg.onKeyDown)}catch(b){dalert(b)}};this.onOkClick=function(c){try{var b=dzeJ(".grid-stack > .grid-stack-item:visible").map(function(a,b){a=dzeJ(b).data("_gridstack_node");return{x:a.x,y:a.y,width:a.width,height:a.height,type:a.type}}).toArray();return this.toTable(b)}catch(a){dalert(a)}};this.onKeyDown=function(c){try{if(c.keyCode===ID_KEYCODE_DELETE||c.keyCode===ID_KEYCODE_BACKSPACE){var b=dzeJ("#grid>.grid-stack-item:not(.ui-resizable-autohide)");
1===b.length&&LayoutTableDlg.grid.removeWidget(b)}}catch(a){dalert(a)}};this.onClick=function(c){try{c=LayoutTableDlg;var b=dzeJ(this).attr("widget-type"),a=c.widgets[b];if(a){var h=dzeJ.parseHTML(a.html);c.grid.addWidget(h,0,0,a.col,a.row,!0,a.minCol,null,a.minRow,null)}}catch(d){dalert(d)}};this.onAdded=function(c,b){try{if(LayoutTableDlg.log(" added ",b),1===b.length){c=LayoutTableDlg;var a=c.grid,h=c.widgets,d=b[0],e=d.el.attr("widget-type").split("-"),f=e.length;if(a.container.attr("data-gs-current-height")>
a.opts.maxRow)cmnCtrlToast.showToastMsg(null,ID_RES_STRING_LAYOUT_TABLE_LIMIT_ROW,2,"screen_center"),a.removeWidget(d.el);else if(1<f){a.removeWidget(d.el);var k=d.x;for(b=0;b<f;b++){var g=h[e[b]],m=dzeJ.parseHTML(g.html);a.addWidget(m,k,d.y,g.col,g.row,!1,g.minCol,null,g.minRow,null);textFit(m[0].querySelectorAll(".fit"),{detectMultiLine:!1});k+=g.col}}else void 0===d._beforeDragX?textFit(d.el[0].querySelectorAll(".fit"),{detectMultiLine:!1}):d.type=d.el.attr("widget-type")}}catch(n){dalert(n)}};
this.onRemoved=function(c,b){try{LayoutTableDlg.log(" removed ",b)}catch(a){dalert(a)}};this.onChange=function(c,b){try{LayoutTableDlg.log(" change ",b)}catch(a){dalert(a)}};this.onDragStart=function(c,b){};this.onDragStop=function(c,b){};this.onDropped=function(c,b,a){};this.toTable=function(c){try{return function(b){for(var a=0,c=0,d=b.length;c<d;c++)b[c].id=a++;b.maxID=a;return b}(c),function(b){for(var a=0,c=0,d,e=0,f=b.length;e<f;e++)d=b[e],a=Math.max(a,d.y+d.height),c=Math.max(c,d.x+d.width);
b.maxRow=b.maxHeight=a;b.maxCol=b.maxWidth=c;return b}(c),function(b){for(var a=[],c=0;c<b.maxRow;c++)a[c]=[];c=0;for(var d=b.length;c<d;c++)for(var e=b[c],f=e.y,k=e.y+e.height;f<k;f++)for(var g=e.x,m=e.x+e.width;g<m;g++)a[f][g]=e.id;b.matrix=a;return b}(c),this.fillEmpty(c),function(b){for(var a=b.matrix,c=b.maxRow-1;0<c;c--){var d;a:{for(d=0;d<b.maxCol;d++)if(a[c-1][d]!==a[c][d]){d=!1;break a}d=!0}d&&(a.splice(c,1),b.maxRow--)}return b}(c),function(b){for(var a=b.matrix,c=b.maxCol-1;0<c;c--){var d;
a:{for(d=0;d<b.maxRow;d++)if(a[d][c]!==a[d][c-1]){d=!1;break a}d=!0}if(d){for(d=b.maxRow-1;0<=d;d--)a[d].splice(c,1);b.maxCol--}}return b}(c),function(b){function a(a){for(var c=0,d=b.length;c<d;c++)if(b[c].id===a)return b[c]}function c(a,c){for(var d=a;d<b.maxRow&&e[a][c]===e[d][c];d++);return d-a}function d(a,c){for(var d=c;d<b.maxCol&&e[a][c]===e[a][d];d++);return d-c}for(var e=b.matrix,f=-1,k=0;k<b.maxRow;k++)for(var g=0;g<b.maxCol;g++)if(f!==e[k][g]){f=e[k][g];var m=a(f);m._visit||(m.my=k,m.mx=
g,m.rowspan=c(k,g),m.colspan=d(k,g),m._visit=!0)}return b}(c),function(c){c.sort(function(a,c){var b=a.my-c.my;return 0!==b?b:a.mx-c.mx})}(c),this.createTable(c)}catch(b){dalert(b)}};this.fillEmpty=function(c){try{for(var b=function(a){for(var c=a.y,b=a.y+a.height;c<b;c++)for(var g=a.x,e=a.x+a.width;g<e;g++)d[c][g]=a.id},a=function(a,b){for(var g=a,e=Number.MAX_VALUE,f=b;f<c.maxCol&&void 0===d[a][f];f++){for(var l=a;l<c.maxRow&&void 0===d[l][f];l++)g=l;e=Math.min(e,g);if(0===e-a)break}if(0<e-a){--b;
var h=f;if(0<b){f=d[a][b];for(l=g=a;l<c.maxRow&&d[l][b]===f;l++)g=l;e=Math.min(e,g)}if(h<c.maxCol){f=d[a][h];for(l=g=a;l<c.maxRow&&d[l][h]===f;l++)g=l;e=Math.min(e,g)}}return e-a+1},h=function(a,b){for(var e=b,f=Number.MAX_VALUE,g=a;g<c.maxRow&&void 0===d[g][b];g++){for(var h=b;h<c.maxCol&&void 0===d[g][h];h++)e=h;f=Math.min(f,e);if(0===f-b)break}if(0<f-b){--a;var k=g;if(0<a){g=d[a][b];for(h=e=b;h<c.maxCol&&d[a][h]===g;h++)e=h;f=Math.min(f,e)}if(k<c.maxRow){g=d[k][b];for(h=e=b;h<c.maxCol&&d[k][h]===
g;h++)e=h;f=Math.min(f,e)}}return f-b+1},d=c.matrix,e=0;e<c.maxRow;e++)for(var f=0;f<c.maxCol;f++)if(void 0===d[e][f]){var k={x:f,y:e,width:h(e,f),height:a(e,f),type:"empty",id:c.maxID++};c.push(k);b(k)}return c}catch(g){dalert(g)}};this.createTable=function(c){try{var b=g_objLayerKit.getLayerDocument(),a=b.createElement("table"),h=b.createElement("tbody"),d=b.createElement("tr"),e=b.createElement("td");b=[];var f=null,k=null;a.style.width=5*c.maxWidth+"%";a.style.borderCollapse="collapse";a.setAttribute("cellspacing",
0);a.setAttribute("cellpadding",3);a.appendChild(h);for(var g=0;g<c.maxRow;g++)f=d.cloneNode(),b.push(f),h.appendChild(f);var m=Math.ceil(DOCUMENT_MAIN_WIDTH/20);h=g_objTableUtil;for(g=0;g<c.length;g++)k=c[g],f=e.cloneNode(),b[k.my].appendChild(f),1<k.rowspan&&(f.rowSpan=k.rowspan),1<k.colspan&&(f.colSpan=k.colspan),f.style.width=5*k.width+"%",f.style.height=h.offsetHeightToStyleHeight(m*k.height,f)+"px",this.setCellContet(f,k.type);g_objPlaceholder.setAllPlaceholderText(a);return a}catch(n){dalert(n)}};
this.setCellContet=function(c,b){try{"empty"===b&&(c.className="dze_dummy_cell");var a=this.widgets[b];a&&a.setCellContent?a.setCellContent(c,a):(c.style.verticalAlign="top",c.innerHTML="<p><br></p>")}catch(h){dalert(h)}}}).call(LayoutTableDlg);
var ImageInsertDlg=duzon_dialog.extend();
(function(){this.IMG_INSERT=0;this.IMG_MODIFY=1;this.IMG_REPLACE=2;this.type=this.IMG_INSERT;this.idx_insertimage_radio_type1="idx_insertimage_radio_type1";this.idx_insertimage_radio_type2="idx_insertimage_radio_type2";this.idx_insertimage_radio_type3="idx_insertimage_radio_type3";this.idx_insertimage_upimage_txt="idx_insertimage_upimage_txt";this.idx_insertimage_upurl_txt="idx_insertimage_upurl_txt";this.idx_insertimage_keyword_txt="idx_insertimage_keyword_txt";this.idx_insertimage_checkbox_orgratio=
"idx_insertimage_checkbox_orgratio";this.idx_insertimage_size_title="idx_insertimage_size_title";this.idx_insertimage_size_table="idx_insertimage_size_table";this.idx_dze_insertimage_width="dze_image_width";this.idx_dze_insertimage_height="dze_image_height";this.idx_dze_org_imagesize="idx_dze_org_imagesize";this.arrAlignBtn=null;this.arrImg=[];this.setImgArray=function(b){this.arrImg=b};this.imgRatio=1;this.backupState=null;this.initBackupState=function(){this.backupState={arrImg:[],width:"",height:"",
bRatioChecked:!0,imgRatio:1}};this.inputUrlPasteTimer=null;this.bOkBtnClick=!1;this.getContents=function(){try{var b=this.type===this.IMG_INSERT&&!1!==dzeUiConfig.bUseMultiImageInsert,a="<div style='width:350px;'>";a+="<form name='dze_insert_image_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadImageURL+"' >";a+="<table width='100%' border='0' cellpadding='0' cellspacing='0'>";a+="<tr>";a+="<td><input type='radio' name='dze_insert_type' value='1' id='"+
this.idx_insertimage_radio_type1+"' checked='true' /><label for='"+this.idx_insertimage_radio_type1+"'>"+ID_RES_DIALOG_STRING_FILE_PATH+"</label></td>";a+="<td style='float: right;'>";a+=this.makeExtFileForm("dze_upimage_file",this.idx_insertimage_upimage_txt,"258px",[".png",".jpg",".gif",".jpeg"],b);a+="</td>";a+="</tr>";a+="<tr>";a+="<td colspan='2' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td><input type='radio' name='dze_insert_type' value='2' id='"+this.idx_insertimage_radio_type2+"' /><label for='"+
this.idx_insertimage_radio_type2+"'>"+ID_RES_DIALOG_STRING_URL_INPUT+"</label></td>";a+="<td style='text-align: right;'><input type='text' name='dze_upimage_url' value='' id='"+this.idx_insertimage_upurl_txt+"' class='duzon_dialog_body_urlform' disabled /></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div id='id_image_detail_setting'>";a+="<div id='"+this.idx_insertimage_size_table+"' width='100%'>";a+="<div class='duzon_dialog_label_title' id='"+this.idx_insertimage_size_title+
"'>"+ID_RES_DIALOG_STRING_SIZE+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_DIALOG_STRING_WIDTH+this.makeSpinnerInputForm(this.idx_dze_insertimage_width,"px");a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_DIALOG_STRING_HEIGHT+this.makeSpinnerInputForm(this.idx_dze_insertimage_height,"px");a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div style="width:140px;">';a+="<input type='checkbox' name='dze_image_orgratio' value='1' id='"+
this.idx_insertimage_checkbox_orgratio+"' checked='checked' /><label for='"+this.idx_insertimage_checkbox_orgratio+"' style='cursor: pointer;'>"+ID_RES_DIALOG_STRING_KEEP_RATIO+"</label>";a+="</div>";a+="<input type='button' value='"+ID_RES_DIALOG_STRING_SET_ORG+"' id='"+this.idx_dze_org_imagesize+"' class='duzon_dialog_btn_upload' style='padding-left:6px !important; padding-right:6px !important; padding-top: 3px !important; width:auto !important;' />";a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";
a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_LEFT+duzon_dialog.makeSpinnerInputForm("dze_image_marginleft","px");a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_TOP+duzon_dialog.makeSpinnerInputForm("dze_image_margintop","px");a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row">';a+='<div class="duzon_dialog_row" style="width:140px;">';
a+=ID_RES_PROP_TAG_STRING_RIGHT+duzon_dialog.makeSpinnerInputForm("dze_image_marginright","px");a+="</div>";a+='<div class="duzon_dialog_row" style="width:140px;">';a+=ID_RES_PROP_TAG_STRING_BOTTOM+duzon_dialog.makeSpinnerInputForm("dze_image_marginbottom","px");a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_INSERT_IMAGE_PARAGRAPH_ALIGN+"</div>";a+="<div style='height: 50px; margin-top: 4px; display: flex;'>";
for(var c=b=null,e=null,d=this.dze_image_align_propertys,f=0,k=d.length;f<k;f++)if(!dzeUiConfig.bSupportNewsEditor||"middle"!==d[f]&&"top"!==d[f])b="idx_dze_align_style_"+d[f],c=dzeEnvConfig.strPath_Image+"dialog/ico_ali_picture_"+d[f]+".png",e=0===f?window.ID_RES_DIALOG_STRING_ALIGN_BASIC:window["ID_RES_DIALOG_STRING_ALIGN_"+d[f].toUpperCase()],a+="<div class='dze_image_align_propery_set' id='"+b+"' style='margin-right: 10px;'><div><img src='"+c+"' alt='' title='"+e+"' width='28' height='28'></div>"+
e+"</div>";a+="</div>";dzeUiConfig.bSupportNewsEditor&&(a+="<div class='duzon_dialog_label_separator'></div>",a+="<div class='duzon_dialog_label_title' style='margin-bottom: 7px;'>"+ID_RES_STRING_NEWS_IMAGE_INFO+"</div>",a+="<div class='duzon_dialog_row'>",a+=ID_RES_STRING_CAPTION+"<input type='text' id='news_img_caption' class='duzon_dialog_body_urlform'>",a+="</div>",a+="<div class='duzon_dialog_row'>",a+=ID_RES_STRING_REPLACE_TEXT+"<input type='text' id='news_img_alt' class='duzon_dialog_body_urlform'>",
a+="</div>",a+="<div class='duzon_dialog_row'>",a+=ID_RES_STRING_LINK_URL+"<input type='text' id='news_img_url' class='duzon_dialog_body_urlform'>",a+="</div>",a+="<div class='duzon_dialog_row'>",a+="<input type='checkbox' name='news_img_main' id='news_img_main' /><label for='news_img_main'>"+ID_RES_STRING_SET_MAIN_IMAGE+"</label>",a+="</div>");a+="</div>";a+="</form>";a+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+"' style='width:100%;height:100px;display:none'></iframe>";
return a+"</div>"}catch(h){dalert(h)}};this.onLoad=function(b){try{b=b||[];var a=[];b&&Array.isArray(b)&&b.forEach(function(b){a.push(b.cloneNode(!0))});this.setImgArray(a);this.initBackupState();var c=0<b.length?b[0]:null,e=this,d=g_objLayerKit.getLayerDocument().dze_insert_image_form;c&&(g_objLayerKit.getElementById(this.idx_insertimage_upurl_txt).value=c.src);var f=d.dze_insert_type,k=f[0],h=f[1];if(this.type===this.IMG_MODIFY)h.checked=!0,k.disabled=!0,h.disabled=!0,this.disableExtFileForm(this.idx_insertimage_upimage_txt),
this.disableImageUrlForm(this.idx_insertimage_upurl_txt),g_objLayerKit.getElementById("id_image_detail_setting").style.display="";else if(this.type===this.IMG_INSERT||this.type===this.IMG_REPLACE){this.type===this.IMG_INSERT?(k.checked=!0,this.enableExtFileForm(this.idx_insertimage_upimage_txt),this.disableImageUrlForm(this.idx_insertimage_upurl_txt)):(h.checked=!0,this.disableExtFileForm(this.idx_insertimage_upimage_txt),this.enableImageUrlForm(this.idx_insertimage_upurl_txt));g_objLayerKit.getElementById("id_image_detail_setting").style.display=
"";for(var l=null,g=0;g<f.length;g++)f[g].addEventListener("change",function(){this!==l&&(l=this);e.onChangeRadio()});this.addEventExtFileForm(this.idx_insertimage_upimage_txt,function(){e.onChangeImgSrc()});var m=g_objLayerKit.getElementById(this.idx_insertimage_upurl_txt),n="";m.onkeydown=function(a){a.keyCode===ID_KEYCODE_ENTER&&(n=m.value,e.onChangeImgSrc())};m.onpaste=function(){clearTimeout(this.inputUrlPasteTimer);this.inputUrlPasteTimer=setTimeout(function(){n=m.value;e.onChangeImgSrc()},
100)}.bind(this);m.onblur=function(){this.value!==n&&(n=m.value,e.onChangeImgSrc())};!0===dzeUiConfig.bIndependentEdit&&"function"===typeof onefficeExtContent.addUploadForm&&onefficeExtContent.addUploadForm(d)}var r=c?c.width:"",w=d.dze_image_width,z=DzeSpinner.createSpinner(w,{max:5E3,min:0,value:r});z.setValue=this.setImgWidth.bind(this);w.onkeyup=function(){z.setValue(w.value)};var A=c?c.height:"",x=d.dze_image_height,B=DzeSpinner.createSpinner(x,{max:5E3,min:0,value:A});B.setValue=this.setImgHeight.bind(this);
x.onkeyup=function(){B.setValue(x.value)};var C=g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio");c&&(this.imgRatio=0<r?A/r:1,C.checked=c.hasAttribute("dze_image_no_proportion")?!0:!1);C.onclick=function(){e.onClickRatio()};g_objLayerKit.getElementById(this.idx_dze_org_imagesize).onclick=function(){e.onClickOrgImgSize()};var D=g_objCommonUtil,q={};["marginRight","marginTop","marginBottom","marginLeft"].forEach(function(a,d){q[a]=0;var f=c?D.toPx(c.style[a]):0;b.every(function(b){return f===
D.toPx(b.style[a])})&&(q[a]=f)});this.modifySpinnerValue("dze_image_marginright",100,0,q.marginRight,null);this.modifySpinnerValue("dze_image_margintop",100,0,q.marginTop,null);this.modifySpinnerValue("dze_image_marginbottom",100,0,q.marginBottom,null);this.modifySpinnerValue("dze_image_marginleft",100,0,q.marginLeft,null);var p=this.dze_image_align_propertys;this.arrAlignBtn=[];var E=c?c.align:"",y=c?c.style.verticalAlign:"";g=0;for(var J=p.length;g<J;g++)if(!dzeUiConfig.bSupportNewsEditor||"middle"!==
p[g]&&"top"!==p[g]){var t=g_objLayerKit.getElementById("idx_dze_align_style_"+p[g]);this.arrAlignBtn.push(t);f=d="";switch(p[g]){case "default":f="baseline";break;case "middle":f="middle";break;case "top":f="top";break;case "left":d="left";break;case "right":d="right"}t._align=d;t._vertical_align=f;d=!1;0===g&&this.type==this.IMG_INSERT&&(d=!0);d||""!==E||""!==y||"default"!==p[g]||(d=!0);d||E!==p[g]||(d=!0);d||y!==p[g]||(d=!0);d||"baseline"!==y||"default"!==p[g]||(d=!0);d&&g_objPropertyUtil.addClass(t,
"dze_image_align_propery_set_selected");t.onclick=function(){e.onClickAlign(this)}}if(dzeUiConfig.bSupportNewsEditor){var K=g_objLayerKit.getElementById("news_img_url"),v=c.parentElement,F=v&&"a"==v.nodeName.toLowerCase()?!0:!1;K.value=F?v.getAttribute("href"):"";var u=F?v.nextElementSibling:c.nextElementSibling;u&&"figcaption"!=u.nodeName.toLowerCase()&&(u=null);var G=u?u.innerText:null,H=g_objLayerKit.getElementById("news_img_caption");!1===fnObjectCheckNull(c.getAttribute("img_caption"))?H.value=
c.getAttribute("img_caption"):G&&(H.value=G);var L=g_objLayerKit.getElementById("news_img_alt");!1===fnObjectCheckNull(c.getAttribute("alt"))&&(L.value=c.getAttribute("alt"));var M=g_objLayerKit.getElementById("news_img_main");!1===fnObjectCheckNull(c.getAttribute("main_image"))&&"true"===c.getAttribute("main_image")&&M.setAttribute("checked",!0)}this.bOkBtnClick=!1}catch(I){dalert(I)}};this.updateImageList=function(b){try{var a=document.createElement("table");a.setAttribute("cellspacing","0");a.setAttribute("cellpadding",
"0");a.setAttribute("width","100%");a.setAttribute("style","border-collapse:collapse;");var c;a.innerHTML="<colgroup><col style='width: 110px;'><col style='width: 10px;'><col style='width: 110px;'><col style='width: 10px;'><col style='width: 110px;'></clogroup>";var e=document.createElement("div"),d=document.createElement("div"),f=document.createElement("div"),k=document.createElement("img"),h=document.createElement("p"),l=document.createElement("p");e.appendChild(d);e.appendChild(f);d.appendChild(k);
f.appendChild(h);f.appendChild(l);e.style.width="110px";e.style.marginBottom="5px";d.style.width="100%";d.style.height="70px";d.style.marginBottom="5px";k.style.maxWidth="100%";k.style.maxHeight="100%";f.style.width="100%";f.style.textAlign="left";h.style.marginLeft="5px";l.style.fontSize="11px";l.style.marginLeft="5px";for(d=0;d<b.length;d++){var g=b[d];var m=e.cloneNode(!0);0===d%3&&(c=a.insertRow());var n=c.insertCell();n.appendChild(m);n.style.textAlign="center";m.firstChild.firstChild.setAttribute("src",
g.url);m.lastChild.firstChild.textContent=g.description;""!==g.width&&""!==g.height&&(m.lastChild.lastChild.textContent=g.width+" x "+g.height);2!==d%3&&(n=c.insertCell())}return a}catch(r){dalert(r)}};this.onUnload=function(){try{clearTimeout(this.inputUrlPasteTimer);var b=g_objLayerKit.getLayerDocument().dze_insert_image_form.dze_upimage_url;b&&(b.onblur=null)}catch(a){dalert(a)}};this.onClickOk=function(b){try{if(!this.bOkBtnClick&&this.arrImg&&0!==this.arrImg.length){b=b||function(){};var a=this.getImgProp();
if(this.type===this.IMG_MODIFY)b(null,a);else{var c=g_objLayerKit.getLayerDocument().dze_insert_image_form,e=c.dze_insert_type;if(e[0].checked)this.bOkBtnClick=!0,uploadImg(this.nEditNumber,c,function(c){this.bOkBtnClick=!1;(c=c?c.url:null)&&this.arrImg&&0!==c.length&&0!==this.arrImg.length&&a?b(c,a):dalert("upload err")}.bind(this));else if(e[1].checked){var d=c.dze_upimage_url.value;d&&this.arrImg[0].src===d&&(0!=d.toLowerCase().indexOf("http")&&0!=d.indexOf("//")&&(d="http://"+d),b([d],a))}}}}catch(f){dalert(f)}};
this.getImgProp=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,a={};a.arrImg=this.arrImg.slice();var c=b.dze_image_width.value;a.width=""===c||isNaN(c)?"":parseInt(c,10)+"px";var e=b.dze_image_height.value;a.height=""===e||isNaN(e)?"":parseInt(e,10)+"px";a.bKeepRatio=b.dze_image_orgratio.checked;var d=b.dze_image_marginleft.value;a.marginLeft=""===d||"0"===d||isNaN(d)?"":parseInt(d,10)+"px";var f=b.dze_image_marginright.value;a.marginRight=""===f||"0"===f||isNaN(f)?"":
parseInt(f,10)+"px";var k=b.dze_image_margintop.value;a.marginTop=""===k||"0"===k||isNaN(k)?"":parseInt(k,10)+"px";var h=b.dze_image_marginbottom.value;a.marginBottom=""===h||"0"===h||isNaN(h)?"":parseInt(h,10)+"px";e=c="";d=0;for(var l=this.arrAlignBtn.length;d<l;d++){var g=this.arrAlignBtn[d];g_objPropertyUtil.hasClass(g,"dze_image_align_propery_set_selected")&&(g._align&&(c=g._align),g._vertical_align&&(e=g._vertical_align))}a.align=c;a.vertical_align=e;dzeUiConfig.bSupportNewsEditor&&(a.caption=
b.news_img_caption.value,a.alt=b.news_img_alt.value,a.main=b.news_img_main.checked,a.url=HyperlinkDlg.getLinkUrl(b.news_img_url));return a}catch(m){dalert(m)}};this.setImgProp=function(b,a,c){try{if(b&&a){c=c||{};var e=!1;!1!==c.bSetSize&&b.style.width!==a.width&&(e=!0,b.removeAttribute("width"),b.style.width=a.width);!1!==c.bSetSize&&b.style.height!==a.height&&(e=!0,b.removeAttribute("height"),b.style.height=a.height);b.style.marginLeft!==a.marginLeft&&(e=!0,b.style.marginLeft=a.marginLeft);b.style.marginTop!==
a.marginTop&&(e=!0,b.style.marginTop=a.marginTop);b.style.marginRight!==a.marginRight&&(e=!0,b.style.marginRight=a.marginRight);b.style.marginBottom!==a.marginBottom&&(e=!0,b.style.marginBottom=a.marginBottom);b.align!==a.align&&(e=!0,""===a.align?b.removeAttribute("align"):b.align=a.align);b.style.verticalAlign!==a.vertical_align&&(e=!0,b.style.verticalAlign=""===a.vertical_align?"":a.vertical_align);a.bKeepRatio!==b.hasAttribute("dze_image_no_proportion")&&(e=!0,a.bKeepRatio?b.setAttribute("dze_image_no_proportion",
""):b.removeAttribute("dze_image_no_proportion"));if(dzeUiConfig.bSupportNewsEditor){e=!0;var d=g_objEditorDocument[g_objPageControl.nEditNumber];b.setAttribute("alt",a.alt);b.setAttribute("main_image",a.main);var f=b.parentElement;c=null;var k=f.nodeName.toLowerCase();if(k==DZETAG.A)0<a.url.length?f.setAttribute("href",a.url):(c=f.parentElement,c.replaceChild(b,f),parnetNoeName=c.nodeName.toLowerCase(),f=c),c=f.parentElement;else if(0<a.url.length){var h=d.createElement("a");h.setAttribute("href",
a.url);h.setAttribute("target","_blank");var l=f.replaceChild(h,b);h.appendChild(l);k=h.nodeName.toLowerCase();c=f;f=h}l=h=null;switch(k){case DZETAG.FIGURE:this.setImgPropForCatpion(a,f.lastElementChild);break;case DZETAG.P:h=d.createElement("figure");l=d.createElement("figcaption");this.setImgPropCreateCaption(a,l,h,f,b);break;case DZETAG.A:if(c){var g=c.nodeName.toLowerCase();g==DZETAG.FIGURE?(this.setImgPropForCatpion(a,c.lastElementChild),h=c):g==DZETAG.P?0<a.caption.length?(h=d.createElement("figure"),
l=d.createElement("figcaption"),this.setImgPropCreateCaption(a,l,h,c,f)):f.nodeName.toLowerCase()==DZETAG.FIGURE&&this.setImgPropForCatpion(a,f.lastElementChild):g==DZETAG.DIV&&0<a.caption.length&&(h=d.createElement("figure"),l=d.createElement("figcaption"),this.setImgPropCreateCaption(a,l,h,c,f))}}if(!fnObjectCheckNull(h)&&e){var m=h.getElementsByTagName(DZETAG.FIGCAP);h.style.width=b.style.width;!fnObjectCheckNull(m)&&m[0]&&(m[0].style.width=b.style.width)}}return e}}catch(n){dalert(n)}};this.setImgPropCreateCaption=
function(b,a,c,e,d){try{a.innerHTML=b.caption;c.appendChild(a);var f=e.replaceChild(c,d);c.insertBefore(f,a)}catch(k){dalert(k)}};this.setImgPropForCatpion=function(b,a){try{0<b.caption.length?a.innerHTML=b.caption:(figureEle=a.parentElement,pEle=figureEle.parentElement,pEle.replaceChild(figureEle.firstElementChild,figureEle))}catch(c){dalert(c)}};this.onChangeRadio=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,a=b.dze_insert_type,c=g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio"),
e={arrImg:this.arrImg,imgRatio:this.imgRatio,width:b.dze_image_width.value,height:b.dze_image_height.value,bRatioChecked:c.checked},d=this.backupState;this.arrImg=d.arrImg;this.imgRatio=d.imgRatio;this.type!==this.IMG_REPLACE&&(b.dze_image_width.value=d.width,b.dze_image_height.value=d.height,c.checked=d.bRatioChecked);this.backupState=e;a[0].checked?(this.enableExtFileForm(this.idx_insertimage_upimage_txt),this.disableImageUrlForm(this.idx_insertimage_upurl_txt),g_objLayerKit.getElementById("id_image_detail_setting").style.display=
"",g_objLayerKit.getElementById(this.idx_insertimage_upimage_txt).focus()):a[1].checked&&(this.disableExtFileForm(this.idx_insertimage_upimage_txt),this.enableImageUrlForm(this.idx_insertimage_upurl_txt),g_objLayerKit.getElementById("id_image_detail_setting").style.display="",g_objLayerKit.getElementById(this.idx_insertimage_upurl_txt).select());this.enableSize(1<this.arrImg.length?!1:!0)}catch(f){dalert(f)}};this.onChangeImgSrc=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,
a=null;if(!0===dzeUiConfig.bSupportNewsEditor&&!1===fnObjectCheckNull(b.media_file))a=b.media_file.files;else{var c=b.dze_insert_type;!1===fnObjectCheckNull(c)&&(1==c[0].checked?a=b.dze_upimage_file.files:1==c[1].checked&&(a=[b.dze_upimage_url.value]))}this.setImgArray([]);duzon_http.showLoading();checkValidImgFile(a,function(a,b,c,k){duzon_http.hideLoading();0<k.length?cmnMsg.showMsgArray(null,k,null):this.setImgArray(c);if(this.type!==this.IMG_REPLACE)this.onClickOrgImgSize();!0!==dzeUiConfig.bSupportNewsEditor&&
this.enableSize(1<c.length?!1:!0)}.bind(this))}catch(e){dalert(e)}};this.setImgWidth=function(b){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form;if((!this.arrImg||0===this.arrImg.length)&&this.type!==this.IMG_REPLACE)return alert(ID_RES_DIALOG_ALERT_INSERT_IMAGE),a.dze_image_width.value="",!1;if(""===b||isNaN(b))return a.dze_image_width.value="",!1;b=parseInt(b,10);b=Math.max(0,Math.min(5E3,b));a.dze_image_width.value=b;if(g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio").checked){var c=
parseInt(b*this.imgRatio,10);c=Math.max(0,Math.min(5E3,c));a.dze_image_height.value=c}}catch(e){dalert(e)}};this.setImgHeight=function(b){try{var a=g_objLayerKit.getLayerDocument().dze_insert_image_form;if((!this.arrImg||0===this.arrImg.length)&&this.type!==this.IMG_REPLACE)return alert(ID_RES_DIALOG_ALERT_INSERT_IMAGE),a.dze_image_height.value="",!1;if(""===b||isNaN(b))return a.dze_image_height.value="",!1;b=parseInt(b,10);b=Math.max(0,Math.min(b,5E3));a.dze_image_height.value=b;if(g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio").checked){var c=
parseInt(b/this.imgRatio,10);c=Math.max(0,Math.min(5E3,c));a.dze_image_width.value=c}}catch(e){dalert(e)}};this.enableSize=function(b){try{g_objLayerKit.getElementById(this.idx_dze_insertimage_width).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_dze_insertimage_height).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_insertimage_checkbox_orgratio).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_dze_org_imagesize).disabled=b?!1:!0,g_objLayerKit.getElementById(this.idx_insertimage_size_title).style.opacity=
b?"":.3,g_objLayerKit.getElementById(this.idx_insertimage_size_table).style.opacity=b?"":.3}catch(a){dalert(a)}};this.onClickRatio=function(){try{if(g_objLayerKit.getElementById("idx_insertimage_checkbox_orgratio").checked){var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,a=parseFloat(b.dze_image_width.value),c=parseFloat(b.dze_image_height.value);this.imgRatio=0<a?c/a:1}}catch(e){dalert(e)}};this.onClickOrgImgSize=function(){try{var b=g_objLayerKit.getLayerDocument().dze_insert_image_form,
a=this.arrImg,c=getMaxBoundSize(this.nEditNumber);a.forEach(function(a){setOrgImageSize(a,c,!0)});var e=a&&0<a.length?a[0]:null;if(e){a=g_objCommonUtil;var d=a.toPx(e.style.width),f=a.toPx(e.style.height);b.dze_image_width.value=d;b.dze_image_height.value=f;this.imgRatio=0<d?f/d:1}else b.dze_image_width.value="",b.dze_image_height.value=""}catch(k){dalert(k)}};this.onClickAlign=function(b){try{for(var a=g_objPropertyUtil,c=this.arrAlignBtn,e=0,d=c.length;e<d;e++)c[e]!==b&&a.removeClass(c[e],"dze_image_align_propery_set_selected");
a.addClass(b,"dze_image_align_propery_set_selected")}catch(f){dalert(f)}}}).call(ImageInsertDlg);
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(b,d,e){return b==a&&"q"==d&&e==c}}));return!0===c.q}catch(b){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){a!=Array.prototype&&a!=Object.prototype&&(a[c]=b.value)};$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(a,c){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:c})};
$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(b){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(b||"")+"_"+c++,b)}var c=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};$jscomp.polyfill=function(a,c,b,d){if(c){b=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in b||(b[e]={});b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill("WeakMap",function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),d=Object.seal({}),c=new a([[b,2],[d,3]]);if(2!=c.get(b)||3!=c.get(d))return!1;c.delete(b);c.set(d,4);return!c.has(b)&&4==c.get(d)}catch(p){return!1}}function b(){}function d(a){if(!$jscomp.owns(a,f)){var d=new b;$jscomp.defineProperty(a,f,{value:d})}}function e(a){var c=Object[a];c&&(Object[a]=function(a){if(a instanceof b)return a;d(a);return c(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&
$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;var f="$jscomp_hidden_"+Math.random();e("freeze");e("preventExtensions");e("seal");var l=0,h=function(a){this.id_=(l+=Math.random()+1).toString();if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};h.prototype.set=function(a,b){d(a);if(!$jscomp.owns(a,f))throw Error("WeakMap key fail: "+a);a[f][this.id_]=b;return this};h.prototype.get=function(a){return $jscomp.owns(a,f)?a[f][this.id_]:void 0};h.prototype.has=
function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)};h.prototype.delete=function(a){return $jscomp.owns(a,f)&&$jscomp.owns(a[f],this.id_)?delete a[f][this.id_]:!1};return h},"es6","es3");$jscomp.MapEntry=function(){};
$jscomp.polyfill("Map",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_MAP||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),d=new a($jscomp.makeIterator([[b,"s"]]));if("s"!=d.get(b)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),e=c.next();if(e.done||e.value[0]!=b||"s"!=e.value[1])return!1;e=c.next();return e.done||4!=e.value[0].x||"t"!=e.value[1]||!c.next().done?!1:!0}catch(n){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=new WeakMap,d=function(a){this.data_={};this.head_=l();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};d.prototype.set=function(a,b){a=0===a?0:a;var d=e(this,a);d.list||(d.list=this.data_[d.id]=[]);d.entry?d.entry.value=b:(d.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,
value:b},d.list.push(d.entry),this.head_.previous.next=d.entry,this.head_.previous=d.entry,this.size++);return this};d.prototype.delete=function(a){a=e(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};d.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=l();this.size=0};d.prototype.has=function(a){return!!e(this,a).entry};
d.prototype.get=function(a){return(a=e(this,a).entry)&&a.value};d.prototype.entries=function(){return f(this,function(a){return[a.key,a.value]})};d.prototype.keys=function(){return f(this,function(a){return a.key})};d.prototype.values=function(){return f(this,function(a){return a.value})};d.prototype.forEach=function(a,b){for(var d=this.entries(),c;!(c=d.next()).done;)c=c.value,a.call(b,c[1],c[0],this)};d.prototype[Symbol.iterator]=d.prototype.entries;var e=function(a,d){var c=d&&typeof d;"object"==
c||"function"==c?b.has(d)?c=b.get(d):(c=""+ ++h,b.set(d,c)):c="p_"+d;var e=a.data_[c];if(e&&$jscomp.owns(a.data_,c))for(a=0;a<e.length;a++){var f=e[a];if(d!==d&&f.key!==f.key||d===f.key)return{id:c,list:e,index:a,entry:f}}return{id:c,list:e,index:-1,entry:void 0}},f=function(a,d){var b=a.head_;return $jscomp.iteratorPrototype(function(){if(b){for(;b.head!=a.head_;)b=b.previous;for(;b.next!=b.head;)return b=b.next,{done:!1,value:d(b)};b=null}return{done:!0,value:void 0}})},l=function(){var a={};return a.previous=
a.next=a.head=a},h=0;return d},"es6","es3");
$jscomp.polyfill("Set",function(a){function c(){if($jscomp.ASSUME_NO_NATIVE_SET||!a||"function"!=typeof a||!a.prototype.entries||"function"!=typeof Object.seal)return!1;try{var b=Object.seal({x:4}),c=new a($jscomp.makeIterator([b]));if(!c.has(b)||1!=c.size||c.add(b)!=c||1!=c.size||c.add({x:4})!=c||2!=c.size)return!1;var f=c.entries(),l=f.next();if(l.done||l.value[0]!=b||l.value[1]!=b)return!1;l=f.next();return l.done||l.value[0]==b||4!=l.value[0].x||l.value[1]!=l.value[0]?!1:f.next().done}catch(h){return!1}}
if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;$jscomp.initSymbolIterator();var b=function(a){this.map_=new Map;if(a){a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)this.add(b.value)}this.size=this.map_.size};b.prototype.add=function(a){a=0===a?0:a;this.map_.set(a,a);this.size=this.map_.size;return this};b.prototype.delete=function(a){a=this.map_.delete(a);this.size=this.map_.size;return a};b.prototype.clear=function(){this.map_.clear();
this.size=0};b.prototype.has=function(a){return this.map_.has(a)};b.prototype.entries=function(){return this.map_.entries()};b.prototype.values=function(){return this.map_.values()};b.prototype.keys=b.prototype.values;b.prototype[Symbol.iterator]=b.prototype.values;b.prototype.forEach=function(a,b){var c=this;this.map_.forEach(function(d){return a.call(b,d,d,c)})};return b},"es6","es3");
function canListEdit(a){return"undefined"!==typeof g_objSelectedShapesArray&&0<g_objSelectedShapesArray.length&&null===g_objShapeEvtMgr.getShapeTextContainer()?!1:!0}function GetCurList(a){return _getCurList(a,!0)}function GetCurListItem(a){return _getCurList(a,!1)}
function _getCurList(a,c){try{a=fnObjectCheckNull(a)?g_nActiveEditNumber:a;if(!canListEdit(a))return null;var b=GetCurRange(a);if(!b)return null;a=g_objNodeUtil;for(var d=g_objListUtil,e=b.startContainer.childNodes[b.startOffset]||b.startContainer;e&&!a.isBoundNode(e);){if(c&&a.isList(e)||!c&&a.isListItem(e))return e;e=e.parentNode}if(b.collapsed){var f=b.startContainer,l=b.startOffset,h=1===f.nodeType?f.childNodes[l-1]:null;if(h&&a.isList(h)&&1===d.getListItemCount(h)){if(c)return h;if(!c&&a.isListItem(h.lastChild))return h.lastChild}}return null}catch(g){dalert(g)}finally{}}
function GetCurListInfo(a,c){return g_objListUtil.getListInfo(GetCurList(a),c)}function GetCurListItemInfo(a,c){return g_objListUtil.getListItemInfo(GetCurListItem(a),c)}function toggleOL(a){try{var c=!1,b=GetCurList(a);return c=b&&"OL"===b.nodeName?removeOLUL(a):insertOL(a)}catch(d){dalert(d)}}function toggleUL(a){try{var c=!1,b=GetCurList(a);return c=b&&"UL"===b.nodeName?removeOLUL(a):insertUL(a)}catch(d){dalert(d)}}
function insertOL(a,c,b){try{var d=g_objListUtil,e=g_objCaretUtil,f=GetCurRange(a),l=f?f.collapsed:!0,h=g_objLetterFn.getSelectedParagraph(a);f=null;var g=0,k=e.createMarkerId("insertorderedlist");e.saveCaret(a,k);for(var m=0,p=h.length;m<p;m++)f=h[m],1===p&&l&&d.isList(f.parentNode)&&d.replaceWithOL(f.parentNode,c,b)?g++:d.replaceWithOL(f,c,b)&&g++;e.restoreCaret(a,k);return 0<g?!0:!1}catch(n){dalert(n)}}
function insertUL(a,c){try{var b=g_objListUtil,d=g_objCaretUtil,e=GetCurRange(a),f=e?e.collapsed:!0,l=g_objLetterFn.getSelectedParagraph(a);e=null;var h=0,g=d.createMarkerId("insertunorderedlist");d.saveCaret(a,g);for(var k=0,m=l.length;k<m;k++)e=l[k],1===m&&f&&b.isList(e.parentNode)&&b.replaceWithUL(e.parentNode,c)?h++:b.replaceWithUL(e,c)&&h++;d.restoreCaret(a,g);return 0<h?!0:!1}catch(p){dalert(p)}}
function removeOLUL(a){try{var c=g_objListUtil,b=g_objCaretUtil,d=g_objLetterFn.getSelectedParagraph(a),e=null,f=0,l=b.createMarkerId("removeolul");b.saveCaret(a,l);for(var h=0,g=d.length;h<g;h++)e=d[h],c.isListItem(e)&&c.replaceWithPara(e)&&f++;b.restoreCaret(a,l);return 0<f?!0:!1}catch(k){dalert(k)}}
function applyListStyleDepth(a,c,b,d,e){try{if(!0!==dzeUiConfig.bApplyListStyleDepth||GetMultiCellSelection(c))return!1;var f=!1;"decrease"===a?f=applyListStyleDepth_Decrease(c,b,d,e):"increase"===a&&(f=applyListStyleDepth_Increase(c,b,d,e));return f}catch(l){dalert(l)}}
function applyListStyleDepth_Decrease(a,c,b,d){try{null===d&&(d=!0);var e=g_objListUtil,f=e.getCurListItemsInRange(a,{bStartEndLi:d,bCheckBound:b});if(!f||0===f.length)return!1;b="";d=0;for(var l=f.length;d<l;d++){var h=e.getListItemInfo(f[d],{style:!0});if(h&&h.nextStyle&&!(h.level>=h.maxLevel)){""===b&&(b=g_objCaretUtil.createMarkerId("list_depth_decrease"),g_objCaretUtil.saveCaret(a,b));var g=h.listItem,k=g.ownerDocument.createElement(h.nextNodeName);g.parentNode.replaceChild(k,g);k.appendChild(g);
e.setListStyle(k,h.nextStyle);e.mergSiblingList(g.parentNode);applyListStyleDepth_SetListItemStyle(g)}}if(e=b?!0:!1)g_objCaretUtil.restoreCaret(a,b),dzeUiConfig.bOfficePagingMode&&(updateOList(f[0].parentNode),g_objPageControl.onSetDelayedUpdatePageTimerForNode(f[0])),!1!==c&&g_objUndoRedo.registerUndoRedoStack(0,a);return e}catch(m){dalert(m)}}
function applyListStyleDepth_Increase(a,c,b,d){try{null===d&&(d=!0);var e=g_objListUtil,f=e.getCurListItemsInRange(a,{bStartEndLi:d,bCheckBound:b});if(!f||0===f.length)return!1;d=g_objNodeUtil;b="";for(var l=0,h=f.length;l<h;l++){var g=e.getListItemInfo(f[l]);if(g&&!(0>=g.level)){""===b&&(b=g_objCaretUtil.createMarkerId("list_depth_increase"),g_objCaretUtil.saveCaret(a,b));var k=g.listItem;d.splitOn(g.list.parentNode,k);var m=k.previousSibling;m&&!m.firstChild&&m.parentNode.removeChild(m);for(var p=
null,n=k.nextSibling;n&&d.isList(n);)p=n.nextSibling,n.firstChild||n.parentNode.removeChild(n),n=p;e.mergSiblingList(k.parentNode,!1,!0);applyListStyleDepth_SetListItemStyle(k);if((n="undefined"!==typeof g_objSplitUtil?g_objSplitUtil.getNextSibling(k):null)&&d.isList(n))for(p=n;p;)d.isList(p)&&p.removeAttribute("start"),p=p.firstChild}}if(e=b?!0:!1){g_objCaretUtil.restoreCaret(a,b);updateOList(f[0].parentNode);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimerForNode(f[0]);
!1!==c&&g_objUndoRedo.registerUndoRedoStack(0,a)}return e}catch(r){dalert(r)}}function hasListInRange(a,c){try{var b=g_objListUtil.getCurListItemsInRange(a,{bStartEndLi:!1,bCheckBound:c});return b&&0!==b.length?!0:!1}catch(d){dalert(d)}}
function applyListStyleDepth_SetListItemStyle(a){try{if(!a)return!1;var c=g_objPropertyUtil;forEach(["dzeExtListStyleTriangleLi","dzeExtListStyleInnerCircleLi","dzeExtListStyleFillCircleLi","dzeExtListStyleDiamondLi","dzeExtListStyleHyponLi"],function(b,d){c.removeClass(a,d)},this);return!0}catch(b){dalert(b)}}
function applyAutoListStyle(a,c){try{if(!(!0!==dzeUiConfig.bAutoSetListStyleType||0<g_objSelectedShapesArray.length||g_objShapeEvtMgr.getShapeTextContainer()||GetMultiCellSelection(c))){var b=!1;if(window.getSelection){var d=g_objEditWindow[c].getSelection();if(d&&1==d.rangeCount){var e=d.getRangeAt(0);b=e.collapsed}else return}else{d=g_objEditorDocument[c].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;""==e.htmlText&&(b=!0)}if(b){var f="commonAncestorContainer"in
e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(f)if(3!=f.nodeType)dlog("nodeType != 3 -> N/A!");else{b="";var l=/^(1|01|A|I)\.\s*/i;if(/^(\-|\*)\s*/i.test(f.nodeValue.replace(/\u200B/g,"")))dlog("match pattern -> ul"),b="ul";else if(l.test(f.nodeValue.replace(/\u200B/g,"")))dlog("match pattern -> ol"),b="ol";else{dlog("no match pattern -> N/A! : value:"+f.nodeValue);return}if("ol"==b){if("li"==f.parentNode.nodeName.toLowerCase()){dlog("inner ol/ul list -> N/A!");return}var h=/^1\.\s*/,
g=/^01\.\s*/,k=/^A\.\s*/;l=/^a\.\s*/;var m=/^I\.\s*/,p=/^i\.\s*/;b="";var n=null;if(h.test(f.nodeValue))n=h,b="decimal";else if(g.test(f.nodeValue))n=g,b="decimal-leading-zero";else if(k.test(f.nodeValue))n=k,b="upper-alpha";else if(l.test(f.nodeValue))n=l,b="lower-alpha";else if(m.test(f.nodeValue))n=m,b="upper-roman";else if(p.test(f.nodeValue))n=p,b="lower-roman";else{dlog("OL list type unknown -> N/A!");return}dlog("autoListType -> "+b);f.nodeValue=f.nodeValue.replace(n,"\u200b");fnHandler_SupportCommand_Main(c,
"InsertOrderedList");if(window.attachEvent){d=g_objEditorDocument[c].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;if(""==e.htmlText){f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];if(!f)return;var r=g_objNodeUtil.getLoopParentElement(f,"OL");if(!r)return;r.style.listStyleType=b;var q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,
c,"first"))}}else{d=g_objEditWindow[c].getSelection();if(!d)return;if(1==d.rangeCount&&(e=d.getRangeAt(0),e.collapsed)){f=e.commonAncestorContainer;if(!f)return;r=g_objNodeUtil.getLoopParentElement(f,"ol");if(!r)return;r.style.listStyleType=b;q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,c,"first"))}}}else if("ul"==b){r=/^\*\s*/;l=/^\-\s*/;b="";n=null;if(r.test(f.nodeValue.replace(/\u200B/g,"")))n=r,b="disc";else if(l.test(f.nodeValue.replace(/\u200B/g,
"")))n=l,b="hypon";else{dlog("UL list type unknown -> N/A!");return}if("hypon"==b&&!0!==dzeUiConfig.useExtUnorderedListStyleType){dlog("useExtUnorderedListStyleType : "+dzeUiConfig.useExtUnorderedListStyleType+" -> N/A!");return}if("li"==f.parentNode.nodeName.toLowerCase()){if(""==f.parentNode.innerText.replace(n,"\u200b").replace(/\u200B/g,"").trim()){duzon_dialog.setFocusElement(f.parentNode,c,"end");dlog("no li content -> N/A!");return}if(!f.previousSibling||1<f.nodeValue.replace(/\u200B/g,"").length){dlog("li content ok-> N/A!");
return}}f.nodeValue=f.nodeValue.replace(/\u200B/g,"");f.nodeValue=f.nodeValue.replace(n,"\u200b");if("li"==f.parentNode.nodeName.toLowerCase()){h=document.createElement("ul");if("disc"==b)h.style.listStyleType=b;else if("hypon"==b)h.className="dzeExtListStyleHypon";else return;f.parentNode.nextSibling?f.parentNode.parentNode.insertBefore(h,f.parentNode.nextSibling):f.parentNode.parentNode.appendChild(h);f.parentNode.innerHTML=f.parentNode.innerHTML.replace(/\u200B/g,"").replace(/<br>$/,"");g=document.createElement("li");
g.className="dzeExtListStyleHyponLi";g.innerHTML=duzon_dialog.dze_bookmark_last_tag;h.appendChild(g);"disc"==b&&g.getAttribute("class")&&g.removeAttribute("class");duzon_dialog.setFocusElement(g,c,"end")}else if(fnHandler_SupportCommand_Main(c,"InsertUnOrderedList"),window.attachEvent){d=g_objEditorDocument[c].selection;if(fnObjectCheckNull(d))return;e=d.createRange();if(fnObjectCheckNull(e))return;if(""==e.htmlText){f="commonAncestorContainer"in e?e.commonAncestorContainer:e.parentElement().childNodes[0];
if(!f)return;k=g_objNodeUtil.getLoopParentElement(f,"ul");if(!k)return;if("disc"==b)k.style.listStyleType=b;else if("hypon"==b)k.className="dzeExtListStyleHypon";else return;q=g_objNodeUtil.getLoopParentElement(f,"li");null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,c,"first"))}}else{d=g_objEditWindow[c].getSelection();if(!d)return;if(1==d.rangeCount&&(e=d.getRangeAt(0),e.collapsed)){f=e.commonAncestorContainer;if(!f)return;k=g_objNodeUtil.getLoopParentElement(f,
"ul");if(!k)return;if("disc"==b)k.style.listStyleType=b;else if("hypon"==b)k.className="dzeExtListStyleHypon";else return;q=g_objNodeUtil.getLoopParentElement(f,"li");q.className="dzeExtListStyleHyponLi";null!=q&&(q.innerHTML=q.innerHTML.replace(/\u200B/g,""),duzon_dialog.setFocusElement(q,c,"first"))}}}else{dlog("autoListType none -> N/A!");return}g_objUndoRedo.registerUndoRedoStack(0,c);TBCancelBubbleEvent(a)}}else dlog("collapsed = false -> N/A!")}}catch(t){dalert(t)}finally{}}
function applyListStyleBackSpace(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_BACKSPACE)return!1;var c=a.nEditNumber,b=g_objListUtil,d=GetCurListItem(c);if(!d)return!1;var e=GetCurRange(c);if(!e||!e.collapsed)return!1;var f=e.startContainer,l=e.startOffset;if(!SelectionUtil.isOnFirst(d,f,l))return!1;var h=b.getRootList(d);if(!h)return!1;var g=b.isList(h.previousSibling)?h.previousSibling:null;if(g&&SelectionUtil.isOnFirst(h,f,l)&&b.mergeRootList(g,h))return g_objCaretUtil.moveCaret(d,
!1),TBCancelBubbleEvent(a),!0;var k=b.getLevel(d);if(0<k){if(applyListStyleDepth("increase",c))return TBCancelBubbleEvent(a),!0}else if(0===k){var m=b.replaceWithPara(d);if(m)return g_objCaretUtil.moveCaret(m),TBCancelBubbleEvent(a),!0}return!1}catch(p){dalert(p)}finally{}}
function applyListStyleDelete(a){function c(c){var h=f.isList(c.nextSibling)?c.nextSibling:null;if(h&&SelectionUtil.isOnLast(c,b,d)){var g=!1,k=[h];"undefined"!==typeof g_objSplitUtil&&(k=k.concat(g_objSplitUtil.getNextSplitNodes(h)));h=0;for(var m=k.length;h<m;h++)f.mergeRootList(c,k[h])&&(g=!0);if(g)return g_objCaretUtil.moveCaret(l,!1,!1),g_objUndoRedo.registerUndoRedoStack(0,e),TBCancelBubbleEvent(a),!0}return!1}var b=null,d=null;try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_DELETE)return!1;
var e=a.nEditNumber,f=g_objListUtil,l=GetCurListItem(e);if(!l)return!1;var h=l.parentNode;if(!f.isList(h))return!1;var g=GetCurRange(e);if(!g||!g.collapsed)return!1;b=g.startContainer;d=g.startOffset;var k=c(h);!1===k&&(k=c(f.getRootList(h)));return k}catch(m){dalert(m)}finally{g=null}}
function applyListBlankEnter(a){try{if(!a||a.cancelBubble||a.modifierKey||a.keyCode!==ID_KEYCODE_ENTER)return!1;var c=a.nEditNumber,b=g_objListUtil,d=GetCurListItem(c);if(!d||!g_objNodeUtil.isBlankPara(d))return!1;var e=b.getLevel(d);if(0<e){if(applyListStyleDepth("increase",c))return TBCancelBubbleEvent(a),!0}else if(0===e){var f=b.replaceWithPara(d);if(f)return g_objCaretUtil.moveCaret(f),TBCancelBubbleEvent(a),!0}return!1}catch(l){dalert(l)}}
function updateOListAfterEnterKeydown(a,c){try{if(dzeUiConfig.bOfficePagingMode&&"undefined"!==typeof g_objSplitUtil&&!(a.keyCode!=ID_KEYCODE_ENTER||a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)){a=g_objNodeUtil;var b=a.getAncestorNodeOnCaret(c);b=a.getLoopParentElement(b,"li");!b||1<b.childNodes.length||0<b.innerText.trim().length||setTimeout(function(){var a=g_objNodeUtil.getAncestorNodeOnCaret(c);if(a=g_objSplitUtil.getNextSibling(a))a.start=1,updateOList(a)},0)}}catch(d){dalert(d)}}
function updateOList(a,c){try{if(a&&dzeUiConfig.bOfficePagingMode&&"undefined"!==typeof g_objSplitUtil){var b=g_objNodeUtil,d=g_objSplitUtil,e=[],f=b.checkTagName(a,"ol","ul");if(f){if(!0===c||"undefined"==typeof c){var l=b.checkTagName(f.parentNode,"ol","ul");l&&updateOList(l,!0)}var h=d.getPreviousSplitSibling(f);for((h=b.checkTagName(h,"ol","ul"))&&(f=h);f;){for(var g=f.start||1,k=f.firstChild;k;)"LI"===k.nodeName&&"none"!==k.style.listStyleType&&g++,b.checkTagName(k,"ol","ul")&&e.push(k),k=k.nextSibling;
var m=d.getNextSplitSibling(f);if((m=b.checkTagName(m,"ol","ul"))&&0<g){for(var p=m.firstChild;p;){if("LI"===p.nodeName&&"none"===p.style.listStyleType)g--;else break;p=p.nextSibling}0<g&&(m.start=g)}f=m}if(!1===c||"undefined"==typeof c)for(a=0;a<e.length;a++)updateOList(e[a],!1)}}}catch(n){dalert(n)}}
function setMultiLevelListStyle(a,c){try{if(!c)return!1;var b=c.length;if(!b)return!1;var d=GetCurList(a);d||(insertOL(a),d=GetCurList(a));if(!d)return!1;for(var e=g_objNodeUtil,f=g_objListUtil,l=d.ownerDocument,h=new Set,g=g_objLetterFn.getSelectedParagraph(a),k=d=null,m=0,p=g.length;m<p;m++)if((d=e.isListItem(g[m])?f.getRootList(g[m]):null)&&h.add(d),"undefined"!==typeof g_objSplitUtil){if(d&&0===m&&(k=g_objSplitUtil.getPrevSplitNodes(d)))for(var n=0;n<k.length;n++)h.add(k[n]);if(d&&m===p-1&&(k=
g_objSplitUtil.getNextSplitNodes(d)))for(n=0;n<k.length;n++)h.add(k[n])}var r=g_objCaretUtil.createMarkerId("set_multi_level_list");g_objCaretUtil.saveCaret(a,r);h.forEach(function(a){var d=[a];a=[].slice.call(a.querySelectorAll("OL, UL"));d=d.concat(a);a=0;for(var h=d.length;a<h;a++){var g=d[a],k=f.getLevel(g);if(0<=k&&k<b){k=c[k];var m=f.isULStyle(k)?"UL":"OL";g.nodeName!==m&&(m=l.createElement(m),e.copyAttribute(m,g),e.moveNodesTo(m,g.firstChild),g.parentNode.replaceChild(m,g),g=m);f.setListStyle(g,
k);f.mergePreviousList(g)}}});g_objCaretUtil.restoreCaret(a,r);g_objUndoRedo.registerUndoRedoStack(0,a);if(dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();return!0}catch(q){dalert(q)}}
function deleteLiBr(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||a.modifierKey)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed||!c.startContainer)return!1;var b=g_objNodeUtil,d=g_objCaretUtil,e=c.startContainer,f=c.startOffset,l=e.ownerDocument,h=a.nEditNumber;3===e.nodeType&&""===e.nodeValue&&(f=b.getChildIndex(e)+1,e=e.parentNode);var g=e.childNodes[f];if(!g||"BR"!==g.nodeName)return!1;var k=b.getLoopParentElementByTagNames(e,b.arrListItemTagName,!0);if(!k)return!1;
a=null;for(c=g;c&&!b.isListItem(c)&&!b.isLoopBreakNode(c);){if("DIV"===c.nodeName){a=c;break}c=c.parentNode}if(a){var m="delete_li_remove_div_"+g_objCommonUtil.getUniqueID();d.saveCaret(h,m);var p=l.createDocumentFragment();b.moveNodesTo(p,a.firstChild);a.parentNode.replaceChild(p,a);d.restoreCaret(h,m)}k=b.getLoopParentElementByTagNames(e,b.arrListItemTagName,!0);if(!k)return!1;b=null;d=g;for(e=null;d&&d!==k;){for(e=d.nextSibling;e;)if(3===e.nodeType&&""===e.nodeValue)e=e.nextSibling;else break;
if(e&&1===e.nodeType&&"TABLE"===e.nodeName){b=e;break}d=d.parentNode}if(!b)return!1;dlog("delete br direct");d=g;for(g=null;d&&d!==k;){g=d.parentNode;if(g!==k&&(g.firstChild!==d||g.lastChild!==d))break;g.removeChild(d);d=g}g_objCaretUtil.moveCaret(b);return!0}catch(n){dalert(n)}finally{}}
function deleteNextLi(a){try{if(!a||a.cancelBubble||a.keyCode!==ID_KEYCODE_DELETE||a.modifierKey)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed||!c.startContainer)return!1;var b=c.startContainer,d=c.startOffset;c=g_objNodeUtil;var e=c.getLoopParentElementByTagNames(b,c.arrListItemTagName,!0);if(!e||!SelectionUtil.isOnLast(e,b,d))return!1;var f=g_objListUtil.getNextListItem(e);if(!f||e.nodeName!==f.nodeName||!f.firstChild||"TABLE"!==f.firstChild.nodeName)return!1;b=g_objCaretUtil;var l=
a.nEditNumber,h="delete_next_li_"+g_objCommonUtil.getUniqueID();b.saveCaret(l,h);var g=e.ownerDocument.createDocumentFragment();c.moveNodesTo(g,f.firstChild);e.appendChild(g);a=f;for(f=null;a&&!a.firstChild&&!c.isLoopBreakNode(a)&&(f=a.parentNode,f.removeChild(a),a=f,a.previousSibling!==e););b.restoreCaret(l,h);return!0}catch(k){dalert(k)}finally{}}
function isMultiCaretOnSameRootList(a){try{var c=GetCurRange(a);if(!c||c.collapsed)return!1;a=g_objListUtil;var b=a.getRootList(c.startContainer),d=a.getRootList(c.endContainer);return b&&d?b===d||"undefined"!==typeof g_objSplitUtil&&0<=g_objSplitUtil.getSplitNodes(b).indexOf(d)?!0:!1:!1}catch(e){dalert(e)}}var g_objCurListForDialog=null;function setCurListForDialog(a){try{var c=GetCurList(a);return c?c?(g_objCurListForDialog=c,!0):!1:!1}catch(b){dalert(b)}}
function getCurListForDialog(){try{return g_objNodeUtil.isAlive(g_objCurListForDialog)?g_objCurListForDialog:null}catch(a){dalert(a)}}function getCurListStyleArrayForDialog(){try{var a=getCurListForDialog();if(!a)return null;var c=g_objListUtil,b=a?c.getRootList(a):null;return b?c.getListStyleArray(b):null}catch(d){dalert(d)}}
function setListStartNew(a){try{var c=GetCurListItem(a),b=c?c.parentNode:null,d=g_objListUtil;if(!b||"OL"!==b.nodeName||1===d.getStart(b)&&d.isFirstListItem(c))return!1;var e=g_objCaretUtil.createMarkerId("dze_list_start_new");g_objCaretUtil.saveCaret(a,e);var f=d.replaceWithListFromListItem(c,"OL",d.getListStyle(b),1,!1);g_objCaretUtil.restoreCaret(a,e);updateOList(c.parentNode,!1);return f?!0:!1}catch(l){dalert(l)}}
function setListStartContinue(a){try{var c=GetCurList(a);if(!c||"OL"!==c.nodeName)return!1;a=g_objListUtil;for(var b=a.findPreviousList(c);b&&0===a.getListItemCount(b);)b=a.findPreviousList(b);if(!b)return!1;a.continueStart(c,b);a.setListStyle(c,a.getListStyle(b));updateOList(c,!1);return!0}catch(d){dalert(d)}}
function onDeleteListEvent(a){try{var c=!1;deleteListItemAfterTripleClick(a)&&(c=!0);deleteBlankListItem(a)&&(c=!0);deleteNextBlankListItem(a)&&(c=!0);pullAndDeleteNextListItem(a)&&(c=!0);deleteLiBr(a)&&(c=!0);deleteNextLi(a)&&(c=!0);return c}catch(b){dalert(b)}}
function deleteListItemAfterTripleClick(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=GetCurRange(a.nEditNumber);if(!c||c.collapsed)return!1;var b=c.startContainer,d=c.endContainer,e=c.startOffset,f=c.endOffset;if(!b||!d)return!1;a=g_objListUtil;var l=g_objNodeUtil.getLoopParentBlockNode(b);return a.isListItem(l)&&a.isListItem(d)&&a.getNextListItem(l)===d?SelectionUtil.isOnFirst(l,b,e)&&SelectionUtil.isOnFirst(d,d,f)?deleteListItem(l):!1:!1}catch(h){dalert(h)}finally{}}
function deleteBlankListItem(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed)return!1;a=g_objListUtil;var b=g_objNodeUtil,d=b.getLoopParentBlockNode(c.startContainer);return a.isListItem(d)&&b.isBlankPara(d)?deleteListItem(d):!1}catch(e){dalert(e)}finally{}}
function deleteNextBlankListItem(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=GetCurRange(a.nEditNumber);if(!c||!c.collapsed)return!1;a=g_objListUtil;var b=g_objNodeUtil,d=b.getLoopParentBlockNode(c.startContainer);if(!a.isListItem(d))return!1;var e=a.getNextListItem(d);if(!e||!b.isBlankPara(e))return!1;var f=e.parentNode;return f&&f.firstChild===f.lastChild?deleteListItem(e):!1}catch(l){dalert(l)}finally{}}
function getCaretNodeAfterDeleteListItem(a){try{var c=g_objListUtil,b=c.getNextListItem(a);if(b)return b;var d=c.getRootList(a),e=d?d.nextSibling:null;if(e)return e;var f=c.getPreviousListItem(a);if(f)return f;var l=d?d.previousSibling:null;return l?l:null}catch(h){dalert(h)}}
function deleteListItem(a){try{if(!a)return!1;var c=g_objListUtil,b=getCaretNodeAfterDeleteListItem(a);dlog(" * Delete list item directly!");if(!b){var d=c.replaceWithPara(a);g_objCaretUtil.moveCaret(d);return!0}for(var e=a.parentNode;c.isList(e)&&e.firstChild===e.lastChild&&e.firstChild===a;)a=e,e=e.parentNode;a.parentNode.removeChild(a);c.isListItem(b)&&c.mergSiblingList(b.parentNode);g_objCaretUtil.moveCaret(b);return!0}catch(f){dalert(f)}}
function pullAndDeleteNextListItem(a){try{if(!a||a.keyCode!==ID_KEYCODE_DELETE)return!1;var c=a.nEditNumber,b=GetCurRange(c);if(!b||!b.collapsed)return!1;a=g_objListUtil;var d=g_objNodeUtil,e=d.getLoopParentBlockNode(b.startContainer);if(!a.isListItem(e))return!1;var f=a.getNextListItem(e);if(!a.isListItem(f)||!SelectionUtil.isOnLast(e,b.startContainer,b.startOffset,!0))return!1;var l=g_objCaretUtil.createMarkerId("pull_list_item");g_objCaretUtil.saveCaret(c,l);var h=e.ownerDocument.createDocumentFragment();
d.moveNodesTo(h,f.firstChild);e.appendChild(h);g_objCaretUtil.restoreCaret(c,l);for(var g=f.parentNode;a.isList(g)&&g.firstChild===g.lastChild&&g.firstChild===f;)f=g,g=g.parentNode;f.parentNode.removeChild(f);a.mergSiblingList(e.parentNode);dlog(" * Delete and pull list item directly!");return!0}catch(k){dalert(k)}finally{}};
var ZoomDlg=duzon_dialog.extend();ZoomDlg.zoomRatioList=[0,1,25,50,75,100,200,400];
ZoomDlg.getZoomDialogContent=function(){try{var d=document.createElement("div");d.className="duzon_dialog_content_small";for(var a=null,b=null,e=null,g=!1,c=0;c<this.zoomRatioList.length;c++)a=document.createElement("div"),b=document.createElement("input"),b.type="radio",b.name="zoom_ratio",b.value=this.zoomRatioList[c],b.id="zoom_ratio_"+this.zoomRatioList[c],this.zoomRatioList[c]==g_objZoom.getDocZoomValue()&&(b.setAttribute("checked",!0),g=!0),b.onclick=function(a){1==this.checked&&duzon_dialog.setEnableSpinner("page_zoom",
!1)},e=document.createElement("label"),e.setAttribute("for",b.id),e.innerHTML=0==this.zoomRatioList[c]?ID_RES_CONST_STRING_DOC_ZOOM_FIT_WIDTH:1==this.zoomRatioList[c]?ID_RES_CONST_STRING_DOC_ZOOM_FIT_PAGE:this.zoomRatioList[c]+"%",a.appendChild(b),a.appendChild(e),d.appendChild(a);a=document.createElement("div");a.style.position="relative";b=document.createElement("input");b.type="radio";b.name="zoom_ratio";b.value=this.zoomRatioList[c];b.id="zoom_ratio_userset";!0!==g&&b.setAttribute("checked",!0);
b.onclick=function(a){1==this.checked&&duzon_dialog.setEnableSpinner("page_zoom",!0)};e=document.createElement("label");e.setAttribute("for",b.id);e.innerHTML=ID_RES_CONST_STRING_USER_SET;var f=document.createElement("div");f.style.position="absolute";f.style.top="3px";f.style.left="100px";f.innerHTML=duzon_dialog.makeSpinnerInputForm("page_zoom","%",100,100,g_objZoom.getDocZoomValue());a.appendChild(b);a.appendChild(e);a.appendChild(f);d.appendChild(a);return d}catch(h){return dalert(h),""}};
ZoomDlg.initZoomDialogContent=function(){try{duzon_dialog.modifySpinnerValue("page_zoom",this.zoomRatioList[this.zoomRatioList.length-1],10,g_objZoom.getDocZoomValue()),inArray(g_objZoom.getDocZoomValue(),this.zoomRatioList)?duzon_dialog.setEnableSpinner("page_zoom",!1):duzon_dialog.setEnableSpinner("page_zoom",!0)}catch(d){dalert(d)}};
ZoomDlg.getSelectedZoomValue=function(d){try{var a=this.zoomValue,b=cmnDlg.m_objBody;if(!b)return a;var e=null,g=b.querySelectorAll("input[type=radio]");try{forEach(g,function(a,b){if(b.checked)throw e=b,BreakException;})}catch(h){}if(e){var c=e.id;if("zoom_ratio_userset"===c){var f=DzeSpinner.getSpinner("page_zoom");f&&(a=f.getValue())}else startsWith(c,"zoom_ratio_")&&(a=c.replace("zoom_ratio_",""));a=parseInt(a,10);if(0===a||1===a)a=g_objZoom.getPresetZoomValue(d,a)}return parseInt(a,10)}catch(h){dalert(h)}};
ZoomDlg.setSelectedZoomValue=function(d){var a=this.getSelectedZoomValue(d);g_objZoom.zoomDocument(d,a);dze_menu_control.setSliderBtnPosition(d,g_objZoom.getDocZoomValue())};
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.SymbolClass=function(a,b){this.$jscomp$symbol$id_=a;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:b})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};$jscomp.Symbol=function(){function a(c){if(this instanceof a)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+b++,c)}var b=0;return a}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");var ParagraphDlg=duzon_dialog.extend();
(function(){this.idx_dze_style_paragraph_justify="idx_dze_style_paragraph_justify";this.idx_dze_style_paragraph_left="idx_dze_style_paragraph_left";this.idx_dze_style_paragraph_center="idx_dze_style_paragraph_center";this.idx_dze_style_paragraph_right="idx_dze_style_paragraph_right";this.dze_style_paragraph_align_propertys=["left","center","right","justify"];this.idx_dze_firstline_indent_normal="idx_dze_firstline_indent_normal";this.idx_dze_firstline_indent_in="idx_dze_firstline_indent_in";this.idx_dze_firstline_indent_out=
"idx_dze_firstline_indent_out";this.marginLeftMax=533;this.marginLeftMin=0;this.marginRightMax=533;this.marginRightMin=0;this.lineHeightMax=500;this.lineHeightMin=0;this.oldProp=this.defaultProp=null;this.getContents=function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_ALIGN+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td colspan='4'>";a+="<div class='dze_style_paragraph_align_title'>"+
ID_RES_DIALOG_STRING_ALIGN_TYPE+" </div>";for(var b="",c="",d="",e="",f=0;f<this.dze_style_paragraph_align_propertys.length;f++)b=this.dze_style_paragraph_align_propertys[f],c="idx_dze_style_paragraph_"+b,d=eval("ID_RES_CONST_STRING_JUSTIFY"+b.toUpperCase()),e=dzeEnvConfig.strPath_Image+"dialog/btn_style_paragraph_"+b+".png",a+="<div class='dze_style_font_propery_set' id='"+c+"'><img src='"+e+"' alt='"+b+"' title='"+d+"' width='28' height='28'></div>";a+="</td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";
a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";a+='<div class="duzon_dialog_row">';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_ALIGN_LEFT+this.makeSpinnerInputForm("dze_style_p_margin_left","px",this.marginLeftMax,this.marginLeftMin,"0");a+="</div>";a+='<div style="width:15px;"></div>';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_ALIGN_RIGHT+
this.makeSpinnerInputForm("dze_style_p_margin_right","px",this.marginRightMax,this.marginRightMin,"0");a+="</div>";a+="</div>";a+='<div class="duzon_dialog_row" style="margin-top:10px;">';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';a+=ID_RES_DIALOG_STRING_PARAGRAPH_TOP+this.makeSpinnerInputForm("dze_style_p_margin_top","px","876","0","0");a+="</div>";a+='<div style="width:15px;"></div>';a+='<div style="flex-grow:1; display:flex; justify-content:space-between; align-items:center;">';
a+=ID_RES_DIALOG_STRING_PARAGRAPH_BOTTOM+this.makeSpinnerInputForm("dze_style_p_margin_bottom","px","876","0","0");a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_FIRST_PARAGRAPH+"</div>";a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td>";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_normal+"' value='normal' /><label for='"+
this.idx_dze_firstline_indent_normal+"'>"+ID_RES_DIALOG_STRING_NORMAL+"</label> &nbsp; &nbsp;";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_in+"' value='in' /><label for='"+this.idx_dze_firstline_indent_in+"'>"+ID_RES_CONST_STRING_INDENT+"</label> &nbsp; &nbsp;";a+="<input type='radio' name='dze_firstline_indent_form' id='"+this.idx_dze_firstline_indent_out+"' value='out' /><label for='"+this.idx_dze_firstline_indent_out+"'>"+ID_RES_CONST_STRING_OUTDENT+
"</label>";a+="</td>";a+="<td width='90' align='right'><div style='float:right'>"+this.makeSpinnerInputForm("dze_style_p_firstline_indent","px","553","0","0")+"</div></td>";a+="</tr>";a+="</table>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_SPACING+"</div>";return a+='<div class="duzon_dialog_row">'+(ID_RES_DIALOG_STRING_LINEHEIGHT+this.makeSpinnerInputForm("dze_style_p_line_height","%",this.lineHeightMax,this.lineHeightMin,
g_strBodyLineHeight))+"</div>"}catch(g){dalert(g)}};this.onLoad=function(a){try{this.defaultProp||(this.defaultProp={textAlign:"justify",marginLeft:"0px",marginRight:"0px",marginTop:g_strPTagMarginTop,marginBottom:g_strPTagMarginBottom,textIndent:"0px",lineHeight:g_strBodyLineHeight});var b=this.defaultProp;this.oldProp=cloneSimpleObject(a);a=this.removeUnit(a);for(var c=this.dze_style_paragraph_align_propertys,d=null,e=0,f=c.length;e<f;e++)d=$_("idx_dze_style_paragraph_"+c[e]),d.onclick=this.onClickAlign,
c[e]===a.textAlign&&(d.className="dze_style_font_propery_set_down");c=null;this.modifySpinnerValue("dze_style_p_margin_left",this.marginLeftMax,this.marginLeftMin,a.marginLeft);this.modifySpinnerValue("dze_style_p_margin_right",this.marginRightMax,this.marginRightMin,a.marginRight);this.modifySpinnerValue("dze_style_p_margin_top",876,0,a.marginTop);this.modifySpinnerValue("dze_style_p_margin_bottom",876,0,a.marginBottom);c=this.modifySpinnerValue("dze_style_p_line_height",this.lineHeightMax,this.lineHeightMin,
a.lineHeight,null,null,10);c.getValue=function(){var a=this.input.value;""===a&&(a=Math.round(100*b.lineHeight));return+parseFloat(a).toFixed(2)};c.getAmount=function(){var a=this.getValue()%this.amount;return 0!==a?a:this.amount};var g=this.modifySpinnerValue("dze_style_p_firstline_indent",533,0,""!==a.textIndent?Math.abs(a.textIndent):""),h=g_objLayerKit.getElementById(this.idx_dze_firstline_indent_normal),k=g_objLayerKit.getElementById(this.idx_dze_firstline_indent_in),l=g_objLayerKit.getElementById(this.idx_dze_firstline_indent_out);
h.onchange=this.onChangeIndent;k.onchange=this.onChangeIndent;l.onchange=this.onChangeIndent;0===a.textIndent?(h.checked=!0,g.setValue(0)):0<a.textIndent?k.checked=!0:0>a.textIndent&&(l.checked=!0);this.onChangeIndent()}catch(m){dalert(m)}};this.onClickOk=function(a){try{var b=this.oldProp,c=this.getPropFromDialog(),d=Object.keys(c);d.forEach(function(a){"undefined"!==typeof c[a]&&c[a]==b[a]&&delete c[a]}.bind(this));d=Object.keys(c);0<d.length&&(dlog("set para style: "+c),a(c))}catch(e){dalert(e)}};
this.isNull=function(a){return"undefined"===typeof a||null===a||""===a?!0:!1};this.isNotNull=function(a){return!this.isNull(a)};this.copyIfNull=function(a,b){try{Object.keys(b).forEach(function(c){"undefined"===typeof a[c]||this.isNull(b[c])||(a[c]=b[c])}.bind(this))}catch(c){dalert(c)}};this.getPropFromDialog=function(){try{for(var a={},b=this.dze_style_paragraph_align_propertys,c=0,d=b.length;c<d;c++)if(g_objPropertyUtil.hasClass($_("idx_dze_style_paragraph_"+b[c]),"dze_style_font_propery_set_down")){a.textAlign=
b[c];break}b="";b=$_("dze_style_p_margin_left").value;this.isNotNull(b)&&(a.marginLeft=b+"px");b=$_("dze_style_p_margin_right").value;this.isNotNull(b)&&(a.marginRight=b+"px");b=$_("dze_style_p_margin_top").value;this.isNotNull(b)&&(a.marginTop=b+"px");b=$_("dze_style_p_margin_bottom").value;this.isNotNull(b)&&(a.marginBottom=b+"px");b=$_("dze_style_p_line_height").value;this.isNotNull(b)&&(a.lineHeight=parseInt(b,10)/100);if(1==$_(this.idx_dze_firstline_indent_normal).checked)a.textIndent="";else if(b=
$_("dze_style_p_firstline_indent").value,this.isNotNull(b)){var e=parseInt(b,10);1==$_(this.idx_dze_firstline_indent_in).checked?a.textIndent=e+"px":1==$_(this.idx_dze_firstline_indent_out).checked&&(a.textIndent=-1*e+"px")}return a}catch(f){dalert(f)}};this.removeUnit=function(a){try{return this.isNotNull(a.marginLeft)&&(a.marginLeft=g_objCommonUtil.toPx(a.marginLeft)),this.isNotNull(a.marginRight)&&(a.marginRight=g_objCommonUtil.toPx(a.marginRight)),this.isNotNull(a.marginTop)&&(a.marginTop=g_objCommonUtil.toPx(a.marginTop)),
this.isNotNull(a.marginBottom)&&(a.marginBottom=g_objCommonUtil.toPx(a.marginBottom)),this.isNotNull(a.textIndent)&&(a.textIndent=g_objCommonUtil.toPx(a.textIndent)),this.isNotNull(a.lineHeight)&&(a.lineHeight=Math.round(100*a.lineHeight)),a}catch(b){dalert(b)}};this.onClickAlign=function(){try{for(var a=ParagraphDlg.dze_style_paragraph_align_propertys,b=0,c=a.length;b<c;b++)$_("idx_dze_style_paragraph_"+a[b]).className="dze_style_font_propery_set";this.className="dze_style_font_propery_set_down"}catch(d){dalert(d)}};
this.onChangeIndent=function(){try{var a=ParagraphDlg,b=DzeSpinner.getSpinner("dze_style_p_firstline_indent");!0===$_(a.idx_dze_firstline_indent_normal).checked?(b.enable(!1),b.setValue(0)):!0!==$_(a.idx_dze_firstline_indent_in).checked&&!0!==$_(a.idx_dze_firstline_indent_out).checked||b.enable(!0)}catch(c){dalert(c)}}}).call(ParagraphDlg);
var BookmarkDlg=duzon_dialog.extend();
(function(){this.idx_dze_bookmark_list_select="idx_dze_bookmark_list_select";this.idx_dze_bookmark_sort_name="idx_dze_bookmark_sort_name";this.idx_dze_bookmark_sort_position="idx_dze_bookmark_sort_position";this.idx_dze_bookmark_name_form="idx_dze_bookmark_name_form";this.idx_dze_bookmark_insert_btn="idx_dze_bookmark_insert_btn";this.idx_dze_bookmark_delete_btn="idx_dze_bookmark_delete_btn";this.idx_dze_bookmark_move_btn="idx_dze_bookmark_move_btn";this.lastGoBookmark=null;this.getContent=function(a){try{var b=
"";b=getSelectionTextValue(a);b=b.trim();25<b.length&&(b=b.substr(0,25));a="";a+="<div class='duzon_dialog_content_medium' style='width:345px;'>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_NAME+"</div>";a+='<div class="duzon_dialog_row">';a+="<input type='text' name='bookmark_name' id='"+this.idx_dze_bookmark_name_form+"' value='"+b+"' class='dze_bookmark_name_formbox' />";a+="<input type='button' value='"+ID_RES_DIALOG_BTN_INSERT+"' id='"+this.idx_dze_bookmark_insert_btn+
"' class='dze_bookmark_button' />";a+="</div>";a+="<div class='duzon_dialog_label_title' style='margin-top: 10px;'>"+ID_RES_DIALOG_STRING_BOOKMARK_LIST+"</div>";a+="<div class='duzon_dialog_row' style='align-items: flex-start;'>";a+="<select class='dze_bookmark_list_container' id='"+this.idx_dze_bookmark_list_select+"' size='6'></select>";a+="<div style='width: 60px; margin-left:10px;'>";a+="<input type='button' value='"+ID_RES_CONST_BTN_DELETE+"' id='"+this.idx_dze_bookmark_delete_btn+"' class='dze_bookmark_button' style='margin-bottom:8px;'/>";
a+="<input type='button' value='"+ID_RES_DIALOG_STRING_MOVE+"' id='"+this.idx_dze_bookmark_move_btn+"' class='dze_bookmark_button' />";a+="</div>";a+="</div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_BOOKMARK_SORT_STANDARD+"</div>";a+="<div class=''>";a+="<input type='radio' name='bk_sort' value='name' id='"+this.idx_dze_bookmark_sort_name+"'><label for='"+this.idx_dze_bookmark_sort_name+"'>"+ID_RES_DIALOG_STRING_NAME+"</label>";
a+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='bk_sort' value='position' id='"+this.idx_dze_bookmark_sort_position+"' checked><label for='"+this.idx_dze_bookmark_sort_position+"'>"+ID_RES_DIALOG_STRING_POSITION+"</label>";return a+"</div></div>"}catch(d){return dalert(d),""}};this.onLoad=function(a){try{this.printBookmark();var b=this;g_objLayerKit.getElementById(this.idx_dze_bookmark_insert_btn).onclick=function(){b.insertBookmark(a)};g_objLayerKit.getElementById(this.idx_dze_bookmark_name_form).onkeyup=
function(c){c.keyCode===ID_KEYCODE_ENTER&&b.insertBookmark(a)};g_objLayerKit.getElementById(this.idx_dze_bookmark_delete_btn).onclick=function(){b.removeBookmark(a,b.getSelectedBookmark())};g_objLayerKit.getElementById(this.idx_dze_bookmark_move_btn).onclick=function(){b.goBookmark(b.getSelectedBookmark())};g_objLayerKit.getElementById(this.idx_dze_bookmark_sort_name).onclick=function(){b.printBookmark("name")};g_objLayerKit.getElementById(this.idx_dze_bookmark_sort_position).onclick=function(){b.printBookmark("position")};
var d=$_(this.idx_dze_bookmark_list_select);d.onkeyup=function(a){a.keyCode===ID_KEYCODE_ENTER&&b.goBookmark(b.getSelectedBookmark())};d.ondblclick=function(){b.goBookmark(b.getSelectedBookmark())};g_bBrowserType_IE&&(d.style.width=d.offsetWidth-10+"px")}catch(c){dalert(c)}};this.closeDialog=function(){duzon_dialog.closeDialog();g_bBrowserType_IE&&this.lastGoBookmark&&(g_objALinkMgr.selectBookmark(this.lastGoBookmark),editor_onselectionchange(g_nActiveEditNumber),this.lastGoBookmark=null);return!0};
this.printBookmark=function(a,b){try{var d=g_objALinkMgr.getBookmarkList(null,a||"position",{bSkipEndBookmark:!0}),c=$_(this.idx_dze_bookmark_list_select),e=c.selectedIndex,h=c.scrollTop;c.innerHTML="";a=null;for(var f="",g=0;g<d.length;g++)f=d[g].getAttribute("name"),a=document.createElement("option"),a.className="dze_bookmark_list_item",a.value=f,a.innerHTML=f,a.setAttribute("title",f),a.bookmark=d[g],c.appendChild(a);if(b&&0<=e){var k=c.options.length;e>=k&&(e=k-1);c.selectedIndex=e;c.scrollTop=
h}}catch(l){dalert(l)}};this.getSelectedBookmark=function(){try{var a=$_(this.idx_dze_bookmark_list_select),b=a.options[a.selectedIndex];return b?b.bookmark:null}catch(d){dalert(d)}};this.selectBookmark=function(a){try{for(var b=$_(this.idx_dze_bookmark_list_select),d=b.options,c=0,e=d.length;c<e;c++)if(d[c].value===a){b.selectedIndex=c;break}}catch(h){dalert(h)}};this.insertBookmark=function(a){try{var b=$_(this.idx_dze_bookmark_name_form).value;b=b.trim();if(""==b)return alert(ID_RES_DIALOG_ALERT_INPUT_BOOKMARK_NAME),
$_(this.idx_dze_bookmark_name_form).focus(),!1;if(25<b.length)return alert(ID_RES_DIALOG_ALERT_MAX_VALUE+"25 "+ID_RES_STRING_LETTER),$_(this.idx_dze_bookmark_name_form).focus(),!1;if(!0===dzeUiConfig.bUseLockEditCellFunction){var d=g_objEditorDocument[this.nEditNumber].getSelection();if(!1===fnObjectCheckNull(d)&&0<d.rangeCount){var c=d.getRangeAt(0).commonAncestorContainer;c=g_objNodeUtil.getLoopParentElement(c,"td");if(!1===fnObjectCheckNull(c)&&"td"===c.nodeName.toLowerCase()&&!0===g_objTableFunction.isCellLocked(c))return alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA),
!1}}g_bBrowserType_IE&&(this.closeDialog(),this.lastGoBookmark=null);if(g_objALinkMgr.insertBookmark(a,b)){g_objALinkMgr.removeAllOddEndBookmark();this.printBookmark();this.selectBookmark(b);$_(this.idx_dze_bookmark_name_form).value="";g_objTableFlag.ResetTableInfo();g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);if(!0===dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();return!0}return!1}catch(e){return dalert(e),!1}};this.removeBookmark=function(a,
b){try{if(!b)return alert(ID_RES_DIALOG_ALERT_INPUT_SELECT_DELTE_BOOKMARK_ITEM),!1;if(!0===dzeUiConfig.bUseLockEditCellFunction){var d=g_objNodeUtil.getLoopParentElementByTagNames(b,["td","th"],!0);if(!0===g_objTableFunction.isCellLocked(d))return alert(ID_RES_CONST_STRING_NOT_EDITABLE_AREA),!1}if(g_objALinkMgr.removeBookmark(b)){this.printBookmark("",!0);g_objUndoRedo.registerUndoRedoStack(0,a);editor_onselectionchange(a);if(!0===dzeUiConfig.bOfficePagingMode)g_objPageControl.onSetDelayedUpdatePageTimer();
return!0}return!1}catch(c){dalert(c)}};this.goBookmark=function(a){if(g_bBrowserType_IE){var b=g_objALinkMgr.goBookmark(a,!1);this.lastGoBookmark=a}else b=g_objALinkMgr.goBookmark(a),editor_onselectionchange(g_nActiveEditNumber);return b}}).call(BookmarkDlg);
var HyperlinkDlg=BookmarkDlg.extend();
(function(){this.m_idTxtForm="idx_dze_hyperlink_text_form";this.m_idHyperLinkType="idx_dze_hyperlink_type_url";this.m_idBmkLinkType="idx_dze_hyperlink_type_bookmark";this.m_idUrlForm="idx_dze_hyperlink_form_url";this.m_idUnlinkBtn="idx_dze_hyperlink_unlink_button";this.m_idBmkFormList="idx_dze_hyperlink_bookmark_form_list";this.m_idLinkOpenTypeSelf="idx_dze_hyperlink_open_type_self";this.m_idLinkOpenTypeBlank="idx_dze_hyperlink_open_type_blank";this.m_idTitleOpenLinkDoc="idx_dze_hyperlink_target_menu_box";
this.m_idWebAddrLinkForm="idx_dze_hyperlink_url_form_box";this.m_idBmkLinkForm="idx_dze_hyperlink_bookmark_form_box";this.getContents=function(){try{var a=this.checkLinkTextDisable()?"disabled style='opacity: 0.3;'":"",c=this.m_idTxtForm,d=this.m_idHyperLinkType,e=this.m_idBmkLinkType,b="";b+="<div class='duzon_dialog_content_small'>";b+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_VIEW_TEXT+"</div>";b+="<div class=''><input type='text' name='hyperlink_text' id='"+c+"' value='' class='dze_hyperlink_name_formbox' "+
a+"/></div>";b+="<div class='duzon_dialog_label_separator'></div>";b+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_LINK_TYPE+"</div>";b+="<div class=''>";b+="<input type='radio' name='link_type' value='url' id='"+d+"' checked><label for='"+d+"'>"+ID_RES_DIALOG_STRING_WEB_ADDR+"</label>";b+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='link_type' value='bookmark' id='"+e+"'><label for='"+e+"'>"+ID_RES_CONST_STRING_INSERT_BOOKMARK+"</label>";b+="</div>";b+="<div class='duzon_dialog_label_separator'></div>";
b+="<div id='"+this.m_idWebAddrLinkForm+"'>";b+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_WEB_ADDR+"</div>";b+="<div class=''><input type='text' name='hyperlink_form_url' id='idx_dze_hyperlink_form_url' autocomplete='off' value='' class='dze_hyperlink_name_formbox' /></div>";b+="</div>";b+="<div id='"+this.m_idBmkLinkForm+"' style='display:none'>";b+="<div class='duzon_dialog_label_title'>"+ID_RES_CONST_STRING_INSERT_BOOKMARK+"</div>";b+="<div id='"+this.m_idBmkFormList+"'>";b+=
"</div>";b+="</div>";b+="<div class='duzon_dialog_label_separator'></div>";b+="<div id='"+this.m_idTitleOpenLinkDoc+"'>";b+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_LINK_TARGET+"</div>";b+="<div class=''>";b+="<input type='radio' name='link_open_type' value='_blank' id='"+this.m_idLinkOpenTypeBlank+"' checked><label for='"+this.m_idLinkOpenTypeBlank+"'>"+ID_RES_DIALOG_STRING_LINK_NEW_WINDOW+"</label>";b+="<div style='display:none;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type='radio' name='link_open_type' value='_self' id='"+
this.m_idLinkOpenTypeSelf+"'><label for='"+this.m_idLinkOpenTypeSelf+"'>"+ID_RES_DIALOG_STRING_LINK_CURRENT_WINDOW+"</label></div>";b+="</div>";b+="<div class='duzon_dialog_label_separator'></div>";b+="</div>";b+="<div style='width:auto;text-align:right'><input type='button' id='"+this.m_idUnlinkBtn+"' value='"+ID_RES_DIALOG_STRING_LINK_NO_CONNECT+"' style='width:70px !important;'></div>";return b+"</div>"}catch(f){dalert(f)}};this.onLoad=function(){try{var a=this;this.setHyperLinkContentData();g_objLayerKit.getElementById(this.m_idHyperLinkType).onclick=
function(){a.setHyperLinkType()};g_objLayerKit.getElementById(this.m_idBmkLinkType).onclick=function(){a.setHyperLinkType()};g_objLayerKit.getElementById(this.m_idUnlinkBtn).onclick=function(){a.closeDialog();g_objALinkMgr.removeLink(g_nActiveEditNumber)}}catch(c){dalert(c)}};this.setHyperLinkType=function(){try{1==$_(this.m_idHyperLinkType).checked?($_(this.m_idWebAddrLinkForm).style.display="block",$_(this.m_idBmkLinkForm).style.display="none",$_(this.m_idLinkOpenTypeBlank).disabled=!1,"_self"===
g_objALinkMgr.getPropContentParam(this.nEditNumber).arrValue[1]?$_(this.m_idLinkOpenTypeSelf).checked=!0:$_(this.m_idLinkOpenTypeBlank).checked=!0,$_(this.m_idTitleOpenLinkDoc).style.display=""):($_(this.m_idWebAddrLinkForm).style.display="none",$_(this.m_idBmkLinkForm).style.display="block",$_(this.m_idLinkOpenTypeSelf).checked=!0,$_(this.m_idLinkOpenTypeBlank).disabled=!0,$_(this.m_idTitleOpenLinkDoc).style.display="none")}catch(a){dalert(a)}};this.selectedObject=null;this.idx_dze_hyperlink_bookmark_list_form=
"idx_dze_hyperlink_bookmark_list_form";this.setHyperLinkContentData=function(){try{var a=g_objALinkMgr.getPropContentParam(this.nEditNumber),c=a.arrValue[0],d=a.arrValue[1],e=a.arrValue[2],b=a.arrValue[4];this.selectedObject=null;var f=getSelectionControl(this.nEditNumber);if(null!=f.controlObject&&"undefined"!=typeof f.controlObject&&f.controlObject.nodeName.toLowerCase()==DZE_TAG_IMG){this.selectedObject=f.controlObject;var h=document.querySelector("#"+this.m_idTxtForm);!1===fnObjectCheckNull(h)&&
(h.setAttribute("disabled",""),h.style.opacity="0.3",h.parentNode.previousElementSibling.style.opacity="0.3")}else{if(!0===fnObjectCheckNull(b)||0===b.length)b=getSelectionTextValue(this.nEditNumber),""===b&&(b=e);$_(this.m_idTxtForm).value=b}0==c.indexOf("#")?($_(this.m_idBmkLinkType).checked=!0,$_(this.m_idUrlForm).value="http://"):($_(this.m_idHyperLinkType).checked=!0,$_(this.m_idUrlForm).value=c);this.setHyperLinkType();"_self"===d?$_(this.m_idLinkOpenTypeSelf).checked=!0:$_(this.m_idLinkOpenTypeBlank).checked=
!0;""==c||"http://"==c?($_(this.m_idUnlinkBtn).disabled=!0,$_(this.m_idUnlinkBtn).className="duzon_dialog_btn_disabled",$_(this.m_idUnlinkBtn).style.color="#d9d9d9"):($_(this.m_idUnlinkBtn).disabled=!1,$_(this.m_idUnlinkBtn).className="duzon_dialog_btn_normal");var k=g_objALinkMgr.getBookmarkList(null,"",{bSkipEndBookmark:!0}),g=document.createElement("select");g.className="dze_hyperlink_bookmark_form";g.id=this.idx_dze_hyperlink_bookmark_list_form;a=null;a=document.createElement("option");a.value=
"";a.innerHTML="----- "+ID_RES_DIALOG_STRING_LIST_SELECT+" -----";g.appendChild(a);for(d=0;d<k.length;d++)a=document.createElement("option"),a.value=k[d].getAttribute("name"),a.innerHTML=k[d].getAttribute("name"),c=="#"+k[d].getAttribute("name")&&a.setAttribute("selected","selected"),g.appendChild(a);$_(this.m_idBmkFormList).appendChild(g)}catch(l){dalert(l)}};this.getLinkUrl=function(a){try{var c="",d=$_(HyperlinkDlg.m_idHyperLinkType),e=$_(HyperlinkDlg.idx_dze_hyperlink_bookmark_list_form);fnObjectCheckNull(d)||
1!=d.checked?fnObjectCheckNull(a)?fnObjectCheckNull(e)||(c="#"+e.value):c=a.value:c=$_(HyperlinkDlg.m_idUrlForm).value;0!=c.indexOf("#")&&(a=/^http(s)*:\/\/http(s)*:\/\//i,a.test(c)&&(c=c.replace(/^http(s)*:\/\//i,"")),a=/^http(s)*:\/\//i,a.test(c)||(c=location.protocol+"//"+c));return c}catch(b){dalert(b)}};this.inputHyperLink=function(){try{if(1==$_(this.m_idHyperLinkType).checked&&("http://"==$_(this.m_idUrlForm).value||""==$_(this.m_idUrlForm).value))return alert(ID_RES_DIALOG_ALERT_INPUT_WEB_ADDR),
$_(this.m_idUrlForm).focus(),!1;if(1==$_(this.m_idBmkLinkType).checked&&""==$_(this.idx_dze_hyperlink_bookmark_list_form).value)return alert(ID_RES_DIALOG_ALERT_SELECT_BOOKMARK),$_(this.idx_dze_hyperlink_bookmark_list_form).focus(),!1;var a="",c="",d="";a=this.getLinkUrl();c=1==$_(this.m_idHyperLinkType).checked?1==$_(this.m_idLinkOpenTypeBlank).checked?"_blank":"_self":"_self";d=$_(this.m_idTxtForm).value;""==d&&(d=a+"_"+ID_RES_CONST_STRING_DIRECT_GO);a=[a,c,"",d];dlog(a);this.closeDialog();c=!1;
this.selectedObject?(a.push(this.selectedObject),this.selectedObject=null,c=g_objALinkMgr.setLinkHTMLToObject(a,this.nEditNumber)):c=g_objALinkMgr.setLinkHTML(a,this.nEditNumber);return c}catch(e){dalert(e)}};this.checkLinkTextDisable=function(){try{var a=!1,c=g_objEditWindow[g_nActiveEditNumber];if(!c)return a;var d=c.getSelection();if(!d)return a;1<g_objNodeUtil.getNodesOnSelection(d,ID_SELECTION_ELEMENT_NODE,function(a){return a&&a.tagName&&"span"!=a.tagName.toLowerCase()?!0:!1}).length&&(a=!0);
return a}catch(e){dalert(e)}}}).call(HyperlinkDlg);
var ReplaceCaseDlg=duzon_dialog.extend();
(function(){this.idx_dze_replace_case_capital="idx_dze_replace_case_capital";this.idx_dze_replace_case_small="idx_dze_replace_case_small";this.idx_dze_replace_case_reverse="idx_dze_replace_case_reverse";this.idx_dze_replace_case_firstword_capital="idx_dze_replace_case_firstword_capital";this.replace_case_array="capital small reverse letter sentence paragraph".split(" ");this.getContent=function(){try{var a="";a+="<div class='duzon_dialog_content_small'>";a+="<table width='100%' cellpadding='0' cellspacing='0' border='0'>";
for(var b="",c="",d="",e=0;e<this.replace_case_array.length;e++)c=this.replace_case_array[e],b="idx_dze_replace_case_"+c,d=eval("ID_RES_CONST_STRING_REPLACE_CASE_"+c.toUpperCase()),a+="<tr><td>",a+="<div class='duzon_dialog_btn_replace_case_item' id='"+b+"'>",a+="<table width='100%' cellpadding='0' cellspacing='0' border='0'>",a+="<tr>",a+="<td width='30'>",a+="<div class='duzon_dialog_btn_replace_case_item_image'><img src='"+dzeEnvConfig.strPath_Image+"dialog/popup_btn_replace_case_"+c+".png' width='28' height='28' title='"+
c+"' alt='"+c+"'></div>",a+="</td>",a+="<td style='background-color:#FFFFFF' width='6'></td>",a+="<td style='background-color:#FFFFFF;cursor:pointer'>"+d+"</td>",a+="</tr>",a+="</table>",a+="</div>",a+="</td></tr>",e<this.replace_case_array.length-1&&(a+="<tr><td colspan='2' height='6'></td></tr>");return a+"</table></div>"}catch(f){return dalert(f),""}};this.doLoopItem=function(a){for(var b=cmnDlg.getDlg().querySelectorAll("div.duzon_dialog_btn_replace_case_item"),c=0,d=b.length;c<d;c++)a(b[c])};
this.deselectAll=function(a){this.doLoopItem(function(a){a.removeAttribute("selected")})};this.getSelected=function(){var a="";try{this.doLoopItem(function(b){if(b.hasAttribute("selected"))throw a=b.id.split("_").pop(),BreakException;})}catch(b){}return a};this.onLoad=function(){try{var a=this;this.doLoopItem(function(b){b.onclick=function(){a.deselectAll();this.setAttribute("selected","")}})}catch(b){dalert(b)}};this.onClickOk=function(a){try{var b=this.getSelected();if(!b)return!1;var c=GetCurRange(a);
g_objCaretUtil.saveCaret(a,"dze_replace_case");var d=!1;"upper"===b||"lower"===b||"reverse"===b||"capital"===b||"small"===b?d=this.setCaseAll(c,b):"word"===b||"letter"===b?d=this.setCaseWord(c):"sentence"===b?d=this.setCaseSentence(c):"paragraph"===b&&(d=this.setCaseParagraph(c));g_objCaretUtil.restoreCaret(a,"dze_replace_case");return d?!0:!1}catch(e){dalert(e)}};this._filter=function(a){return!g_objHeaderFooter.getHeaderFooterEditMode()&&g_objHeaderFooter.isHeaderFooterContainer(a)||!(0<g_objSelectedShapesArray.length&&
null===g_objShapeEvtMgr.getShapeTextContainer())&&g_objPropertyUtil.hasClass(a,"dze_shape_main")?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT};this._textFilter=function(a){var b=ReplaceCaseDlg._filter(a);return b===NodeFilter.FILTER_ACCEPT&&a&&3!==a.nodeType?NodeFilter.FILTER_SKIP:b};this.setCaseAll=function(a,b){try{if(!a||a.collapsed)return!1;var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset;if(!c||!e)return!1;var g=null;"upper"===b||"capital"===b?g=this.toUpperCase.bind(this):
"lower"===b||"small"===b?g=this.toLowerCase.bind(this):"reverse"===b&&(g=this.toReverseCase.bind(this));var h="";if(c===e&&3===c.nodeType)return h=g(h,b,d,f),h!==c.nodeValue&&(c.nodeValue=h),!0;for(var p=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,this._textFilter),k=p.firstChild();k;)h=k.nodeValue,h=k===c?g(h,d):k===e?g(h,null,f):g(h),h!==k.nodeValue&&(k.nodeValue=h),k=p.nextNode();return!0}catch(q){dalert(q)}};this.setCaseWord=function(a){try{var b=this._collectText(a,
"word");if(!b)return!1;var c=b.arrText;a=[];for(var d=0,e=0,f=c.length;e<f;e++)a[e]=this.toTitleCase(c[e],b.startIndex-d,b.endIndex-d),d+=c[e].length;var g=a.join("");this._replaceText(g,b.startIndex,b.endIndex,b.walker);return!0}catch(h){dalert(h)}};this.setCaseSentence=function(a){try{var b=this._collectText(a,"sentence");if(!b)return!1;var c=b.arrText;a=[];for(var d=0,e=c.length;d<e;d++)a[d]=this.toCapitalizeFirstLetter(c[d]);var f=a.join("");this._replaceText(f,b.startIndex,b.endIndex,b.walker);
return!0}catch(g){dalert(g)}};this.setCaseParagraph=function(a){try{var b=this._collectText(a,"paragraph");if(!b)return!1;var c=b.arrText;a=[];for(var d=0,e=c.length;d<e;d++)a[d]=this.toCapitalizeFirstLetter(c[d]);var f=a.join("");this._replaceText(f,b.startIndex,b.endIndex,b.walker);return!0}catch(g){dalert(g)}};this._expandRange=function(a){var b=g_objNodeUtil.getClosetParagraph(a.startContainer),c=g_objNodeUtil.getClosetParagraph(a.endContainer);if(!b||!c)return a;if("undefined"!==typeof g_objSplitUtil){var d=
g_objSplitUtil.getPrevSplitNodes(b);0<d.length&&(b=d[0]);d=g_objSplitUtil.getNextSplitNodes(c);0<d.length&&(c=d[d.length-1])}a.setStart(b,0);a.setEnd(c,c.childNodes.length);return a};this._getFirstTextNode=function(a){var b=a.startContainer,c=a.startOffset;if(b&&3===b.nodeType)return{node:b,offset:c};if((b=a.startContainer.childNodes[a.startOffset])&&3===b.nodeType)return{node:b,offset:0};a=a.cloneRange();a.collapsed?(a.setStart(a.commonAncestorContainer,0),a=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT),
b=a.lastChild()):(a.setEnd(a.commonAncestorContainer,a.commonAncestorContainer.childNodes.length),a=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT),b=a.firstChild());return b&&3===b.nodeType?{node:b,offset:0}:{node:null,offset:0}};this._getLastTextNode=function(a){var b=a.endContainer,c=a.endOffset;if(b&&3===b.nodeType)return{node:b,offset:c};if((b=a.endContainer.childNodes[a.endOffset-1])&&3===b.nodeType)return{node:b,offset:b.nodeValue.length};a=a.cloneRange();a.collapsed?(a.setEnd(a.commonAncestorContainer,
a.commonAncestorContainer.childNodes.length),a=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT),b=a.firstChild()):(a.setStart(a.commonAncestorContainer,0),a=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT),b=a.lastChild());return b&&3===b.nodeType?{node:b,offset:b.nodeValue.length}:{node:null,offset:0}};this._collectText=function(a,b){var c=this._getFirstTextNode(a),d=this._getLastTextNode(a),e=c.node;c=c.offset;var f=d.node,g=d.offset;if(!e||!f||3!==e.nodeType||3!==f.nodeType||!this._expandRange(a))return null;
var h=null;if("word"===b||"sentence"===b)h=function(a){if("BR"===a.nodeName)return!0;if(g_objNodeUtil.isParagraph(a))return"undefined"!==typeof g_objSplitUtil&&g_objSplitUtil.getPreviousSplitSibling(a)?!1:!0};else if("paragraph"===b)h=function(a){if(g_objNodeUtil.isParagraph(a))return"undefined"!==typeof g_objSplitUtil&&g_objSplitUtil.getPreviousSplitSibling(a)?!1:!0};else return null;var p=this,k=function(a){return p._filter(a)!==NodeFilter.FILTER_ACCEPT||1!==a.nodeType||h(a)?NodeFilter.FILTER_ACCEPT:
NodeFilter.FILTER_SKIP},q=g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,k);d="";for(var l=null,n=0,t=0,u=0,r=0,v=0,m=q.firstChild();m;)d&&h(m)&&(l||(l=[]),l[u++]=d,d="",v=r),m===e&&("word"===b?(n=r,3===e.nodeType&&(n+=c)):n=v),m===f&&(t=r,3===f.nodeType&&(t+=g)),3===m.nodeType&&(d+=m.nodeValue,r+=m.nodeValue.length),m=q.nextNode();d&&(l||(l=[]),l[u++]=d,d=l.join(""));"word"===b&&(b=this.getWordStartIndex(d,n),0<=b&&(n=b));return{text:d,arrText:l,startIndex:n,endIndex:t,
walker:g_objNodeUtil.createRangeWalker(a,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,function(a){var b=k(a);return b===NodeFilter.FILTER_ACCEPT&&a&&3!==a.nodeType?NodeFilter.FILTER_SKIP:b})}};this._replaceText=function(a,b,c,d){try{var e=0,f=0;b===c&&c++;for(var g=d.firstChild();g;){f=g.nodeValue.length;b<e+f&&c>e&&(temp=a.substring(e,e+f),temp!==g.nodeValue&&(g.nodeValue=temp));if(e>c)break;e+=f;g=d.nextNode()}return!0}catch(h){dalert(h)}};this.toUpperCase=function(a,b,c){a=this._split(a,b,c);return a.pre+
a.str.toUpperCase()+a.after};this.toLowerCase=function(a,b,c){a=this._split(a,b,c);return a.pre+a.str.toLowerCase()+a.after};this.toReverseCase=function(a,b,c){b=this._split(a,b,c);a=b.str;c="";for(var d,e=0,f=a.length;e<f;e++)d=a.charCodeAt(e),c=65<=d&&90>=d?c+a.charAt(e).toLowerCase():97<=d&&122>=d?c+a.charAt(e).toUpperCase():c+a.charAt(e);return b.pre+c+b.after};this.toCapitalizeFirstLetter=function(a,b,c){b=this._split(a,b,c);a=b.str;c="";for(var d,e=!1,f=0,g=a.length;f<g;f++)d=a.charCodeAt(f),
!1!==e||this.isSpaceCode(d)?c+=a.charAt(f):(c+=a.charAt(f).toUpperCase(),e=!0);return b.pre+c+b.after};this.toTitleCase=function(a,b,c){a=this._split(a,b,c);a.str=a.str.replace(/\w\S*/g,function(a){return a.charAt(0).toUpperCase()+a.substr(1)});return a.pre+a.str+a.after};this._split=function(a,b,c){var d="",e="";isNaN(b)||isNaN(c)?!isNaN(b)&&isNaN(c)?(d=a.substring(0,b),a=a.substring(b)):isNaN(b)&&!isNaN(c)&&(e=a.substring(c),a=a.substring(0,c)):(d=a.substring(0,b),e=a.substring(c),a=a.substring(b,
c));return{pre:d,str:a,after:e}};this.isSpaceCode=function(a){return 9===a||10===a||13===a||32===a||160===a?!0:!1};this.getWordStartIndex=function(a,b){for(b=Math.min(a.length,b);0<=b;b--)if(this.isSpaceCode(a.charCodeAt(b)))return b;return 0}}).call(ReplaceCaseDlg);
var ListDlg=duzon_dialog.extend();
(function(){this.getListContainerContent=function(a,b){try{var c=parseInt(b.length/4,10);a="<div class='dze_orderedlist_container' id='"+a+"' style='height:"+(100*c+5+"px")+";'>";c=0;for(var d=b.length;c<d;c++){var f=b[c],e=f,g=c%4,h=parseInt(c/4,10);g=99*g+1*g+4+"px";var k=99*h+1*h+4+"px";a="none"==f?a+("<span class='dze_orderedlist_unit_img' value='"+e+"' style='top:"+k+"; left:"+g+";'>"+ID_RES_DIALOG_STRING_NONE+"</span>"):a+("<span class='dze_orderedlist_unit_img' value='"+e+"' style='top:"+k+
"; left:"+g+"; background-image: url("+dzeEnvConfig.strPath_Image+"dialog/btn_style_list_"+f+".png)'></span>")}return a+"</div>"}catch(l){dalert(l)}}}).call(ListDlg);var UListDlg=ListDlg.extend();
(function(){this.unorderlist_styles=["none","disc","circle","square"];this.unorderlist_ext_styles=["fillcircle","innercircle","diamond","triangle"];this.id_ul_container="id_ul_container";this.arrItem=[];this.getContent=function(){try{var a="";a+="<div class='duzon_dialog_content_medium' id='idx_dze_unorderedlist_content_medium'>";var b=this.unorderlist_styles;!0===dzeUiConfig.useExtUnorderedListStyleType&&(b=b.concat(this.unorderlist_ext_styles));a+=this.getListContainerContent(this.id_ul_container,
b);return a+"</div>"}catch(c){dalert(c)}};this.onLoad=function(a,b){try{var c=this;this.arrItem=[].slice.call(b.querySelectorAll("span.dze_orderedlist_unit_img"));for(var d=null,f=0,e=this.arrItem.length;f<e;f++)d=this.arrItem[f],this.convertListStyle(d.getAttribute("value"))===a&&d.setAttribute("selected",""),d.onclick=function(){c.select(this,b)}}catch(g){dalert(g)}};this.select=function(a){try{for(var b=a.hasAttribute("selected")?!0:!1,c=0,d=this.arrItem.length;c<d;c++)this.arrItem[c].removeAttribute("selected");
b?a.removeAttribute("selected"):a.setAttribute("selected","")}catch(f){dalert(f)}};this.getListStyle=function(){try{for(var a=null,b=0,c=this.arrItem.length;b<c;b++)if(a=this.arrItem[b],a.hasAttribute("selected"))return this.convertListStyle(a.getAttribute("value"));return""}catch(d){dalert(d)}};this.convertListStyle=function(a){return"innercircle"===a?"dzeExtListStyleInnerCircle":"triangle"===a?"dzeExtListStyleTriangle":"fillcircle"===a?"dzeExtListStyleFillCircle":"diamond"===a?"dzeExtListStyleDiamond":
a}}).call(UListDlg);var OListDlg=ListDlg.extend();
(function(){this.orderlist_styles="none decimal decimal-leading-zero upper-alpha lower-alpha upper-roman lower-roman lower-greek".split(" ");this.id_ol_container="id_ol_container";this.id_ol_start="id_ol_start";this.id_ol_spinner="id_ol_spinner";this.id_ol_preview="id_ol_preview";this.arrItem=[];this.getContent=function(){try{var a="";a+="<div class='duzon_dialog_content_medium'>";a+=this.getListContainerContent(this.id_ol_container,this.orderlist_styles);a+="</div>";a+="<table border='0' cellspacing='0' cellpadding='0' style='margin-top:7px;'>";
a+="<tr>";a+="<td style='padding-right: 7px;'><input type='checkbox' id='"+this.id_ol_start+"' value='1' ><label for='"+this.id_ol_start+"'>"+ID_RES_CONST_STRING_LIST_NO_START+"</label> :</td>";a+="<td>"+this.makeSpinnerInputForm(this.id_ol_spinner,"",0,null,"",null,"","","","50px")+"</td>";a+="<td style='width:21px;'></td>";a+="<td style='padding-right: 7px;'>"+ID_RES_CONST_STRING_PREVIEW+" : </td>";a+="<td><ol id='"+this.id_ol_preview+"' class='style_dze_orderedlist_preview_num_ol'><li>&#8203;</li></ol></td>";
a+="</tr>";return a+"</table></div>"}catch(b){dalert(b)}};this.onLoad=function(a,b){try{if(a&&b){var c=this,d=a.start||1,f=a.listStyle,e=$_(c.id_ol_preview);this.arrItem=[].slice.call(b.querySelectorAll("span.dze_orderedlist_unit_img"));a=null;b=0;for(var g=this.arrItem.length;b<g;b++)a=this.arrItem[b],a.getAttribute("value")===f&&(a.setAttribute("selected",""),e.style.listStyleType=f),a.onclick=function(){c.select(this)};var h=this.modifySpinnerValue(this.id_ol_spinner,null,1,d,function(a){e.setAttribute("start",
a)});e.setAttribute("start",d);h.enable(!1);$_(this.id_ol_start).onclick=function(a){h.enable(this.checked)}}}catch(k){dalert(k)}};this.select=function(a){try{for(var b=a.hasAttribute("selected")?!0:!1,c=0,d=this.arrItem.length;c<d;c++)this.arrItem[c].removeAttribute("selected");if(b)a.removeAttribute("selected");else{a.setAttribute("selected","");var f=a.getAttribute("value"),e=$_(this.id_ol_preview);e.style.listStyleType=f;e.firstChild.style.listStyleType=f}}catch(g){dalert(g)}};this.getListStyle=
function(){try{for(var a=null,b=0,c=this.arrItem.length;b<c;b++)if(a=this.arrItem[b],a.hasAttribute("selected"))return a.getAttribute("value");return""}catch(d){dalert(d)}};this.getStart=function(){try{if($_(this.id_ol_start).checked){var a=DzeSpinner.getSpinner(this.id_ol_spinner);if(a)return a.getValue()}return""}catch(b){dalert(b)}};this.getInfo=function(){return{listStyle:this.getListStyle(),start:this.getStart()}}}).call(OListDlg);var MultiLevelListDlg=duzon_dialog.extend();
(function(){this.arrListStyle=null;this.arrPreset=["decimal upper-alpha lower-alpha upper-roman lower-roman decimal-leading-zero decimal upper-alpha lower-alpha upper-roman lower-roman decimal-leading-zero".split(" "),"upper-alpha upper-roman lower-alpha lower-roman decimal decimal-leading-zero upper-alpha upper-roman lower-alpha lower-roman decimal decimal-leading-zero".split(" "),"upper-roman upper-alpha lower-roman lower-alpha decimal decimal-leading-zero upper-roman upper-alpha lower-roman lower-alpha decimal decimal-leading-zero".split(" ")];
this.getContent=function(){try{var a=dzeUiConfig.applyOListStyleDepthItems||null,b=dzeUiConfig.applyUListStyleDepthItems||null,c=[];a&&c.push(a);b&&c.push(b);for(var d=0,f=this.arrPreset.length;d<f;d++)c.push(this.arrPreset[d]);this.arrListStyle=c;c=0;var e="";e+='<table style="width:100%; border: 0px solid black;" cellspacing="0" cellpadding="0">';e+=this.getTitleRowHTML(0,ID_RES_DIALOG_STRING_CASCADE_ORDERLIST);e+="</table>";e+='<div class="dze_level_list_container">';e+='<div class="dze_level_list_row">';
e+=this.getItemHtml(a,c++);e+=this.getItemHtml(b,c++);e+="</div>";e+='<div class="dze_level_list_row">';d=0;for(f=this.arrPreset.length;d<f;d++)e+=this.getItemHtml(this.arrPreset[d],c++);return e+"</div></div>"}catch(g){dalert(g)}};this.getItemHtml=function(a,b){try{if(!a)return"";b='<div class="dze_level_list_item" index="'+b+'">';b+='<div class="dze_level_list_btn">'+this.getMultiLevelListHtml(a,3)+"</div>";b+='<div class="dze_level_list_preview">'+this.getMultiLevelListHtml(a,6)+"</div>";return b+
"</div>"}catch(c){dalert(c)}};this.getMultiLevelListHtml=function(a,b){try{if(!a)return"";for(var c=g_objListUtil,d="",f="",e="",g=[],h=0,k=Math.min(a.length,b);h<k;h++)e=a[h],f=c.isULStyle(e)?"ul":"ol",d=c.isCustomULStyle(e)?d+("<"+f+' class="'+e+'">'):d+("<"+f+' style="list-style-type: '+e+';">'),d+="<li><span>\u2015\u2015\u2015\u2015\u2015</span></li>",g.push("</"+f+">");return d+=g.join("")}catch(l){dalert(l)}};this.onLoad=function(a,b){try{var c=this,d=a.querySelectorAll("div.dze_level_list_item");
a=0;for(var f=d.length;a<f;a++)d[a].onclick=function(){var a=parseInt(this.getAttribute("index"),10);duzon_dialog.closeExtendsDlg();setMultiLevelListStyle(b,c.arrListStyle[a])}}catch(e){dalert(e)}}}).call(MultiLevelListDlg);
var TableStyleDlg=duzon_dialog.extend();
(function(){this.createTable=function(a){var b=a&&a.row?a.row:5,c=a&&a.col?a.col:5,e=a&&a.text?a.text:"\u2015",g=a&&a.fontSize?a.fontSize:10,h=a&&a.backgroundColor?a.backgroundColor:"",d=(a&&a.height?a.height:66)-6;a=parseInt(((a&&a.width?a.width:82)-6-c)/c,10);var k=parseInt((d-b)/b,10);d='<table cellpadding="0" cellspacing="0" style="table-layout:fixed;">';for(var f=0;f<b;f++){d+='<tr style="height: '+k+'px">';for(var l=0;l<c;l++)d+='<td style="width:'+a+"px; height: "+k+"px; font-size:"+g+"px; background-color:"+
h+'">'+e+"</td>";d+="</tr>"}d+="</table>";b=document.createElement("div");b.innerHTML=d;return b.firstChild};this.createNoneTable=function(a,b){return this.createTable({row:1,col:1,text:ID_RES_CONST_STRING_USER_DEFINE,width:a,height:b,fontSize:12,backgroundColor:"#f2f2f2"})};this.createPresetTable=function(a,b,c){b=this.createTable({row:5,col:5,text:"-",width:b,height:c});g_objTableOperation.table_SetTableStyle(b,a);return b};this.getContent=function(a){try{if("undefined"===typeof DzeTableStylePreset)return null;
var b=a&&a.width?a.width:310,c=a&&a.height?a.height:266,e=a&&a.col?a.col:3,g=a&&"undefined"!==typeof a.itemMargin?a.itemMargin:0,h=a&&"undefined"!==typeof a.padding?a.padding:12,d=a&&a.bAddNone?a.bAddNone:!1,k=DzeTableStylePreset.length,f=Math.ceil(k/e),l=parseInt((b-g*(e-1)-2*h)/e,0),q=parseInt((c-g*(f-1)-2*h)/f,0),m=document.createElement("div");m.className="dze_table_style_container";m.style.width=b+"px";m.style.height=c+"px";var r=document.createElement("div");r.style.width=l-2+"px";r.style.height=
q-2+"px";c=b=null;for(var p=f=0,t=0,u=0,w=!1,n=0,x=k+(d?1:0);n<x;n++)f=parseInt(n/e,10),p=parseInt(n%e,10),b=r.cloneNode(!0),t=h+l*p-1*p,u=h+q*f-1*f,g&&0!==p&&(t+=g*p),g&&0!==f&&(u+=g*f),b.style.left=t+"px",b.style.top=u+"px",(w=d&&n>=k?!0:!1)?(c=this.createNoneTable(l-6,q-6),b.setAttribute("none","")):c=this.createPresetTable(n,l-6,q-6),b.appendChild(c),m.appendChild(b);if(!0===a.title){var v=document.createElement("div");v.appendChild(this.createCommonPopupTableTitle(ID_RES_CONST_STRING_STYLE_STYLE));
v.appendChild(m);m=v}return m}catch(y){dalert(y)}};this.getItem=function(a){return document.querySelector("div.dze_table_style_container > div"+(a||""))};this.getItems=function(){return document.querySelectorAll("div.dze_table_style_container > div")};this.deselect=function(){for(var a=this.getItems(),b=a.length,c=0;c<b;c++)a[c].removeAttribute("selected");return 0<b?!0:!1};this.select=function(a){this.deselect();if("Number"===typeof a){var b=this.getItems();if(0>a||a>=b.length)return!1;a=b[a]}a.setAttribute("selected",
"");return!0};this.selectNone=function(){var a=this.getItem("[none]");return a?this.select(a):null};this.getSelectedIndex=function(){return this.getIndex(this.getItem("[selected]"))};this.getIndex=function(a){if(!a)return-1;for(var b=0;a.previousSibling;)b++,a=a.previousSibling;return b};this.onLoad=function(a,b,c){try{if(!a)return!1;var e=this,g=a.querySelectorAll("div.dze_table_style_container > div");a=null;for(var h=0,d=0,k=g.length;d<k;d++)a=g[d],a.onclick=function(a){h++;if(g_bBrowserType_IE||
1===a.detail)setTimeout(function(){h=0},400),2!==h&&(e.getSelectedIndex()===e.getIndex(this)?e.deselect():e.select(this))},c&&(a.onmouseover=function(){g_objLayerEventUtil.saveTableHTML(c);g_objTableOperation.table_SetTableStyle(c,e.getIndex(this))},a.onmouseout=function(){g_objLayerEventUtil.restoreTableHTML(c)}),b&&(a.ondblclick=function(){b()});return!0}catch(f){dalert(f)}}}).call(TableStyleDlg);
var VideoDlg=duzon_dialog.extend();
(function(){this.getContent=function(a){try{var d=g_objVideoControl.getAllowPlayVideoList(!0);a="";a+="<div class='duzon_dialog_content_medium'>";a+="<form name='dze_insert_video_form' method='post' enctype='multipart/form-data' target='dze_upload_iframe' action='"+dzeEnvConfig.strUploadVideoURL+"' >";a+="<table id = "+this.idx_insertvideo_table+" width='100%' border='0' celladding='0' cellspacing='0' style='table-layout:fixed'>";dzeUiConfig.bSupportNewsEditor?(a+="<tr>",a+="<td width='80'><input type='radio' name='dze_insert_type' value='3' id='"+
this.idx_insertvideo_radio_type3+"' checked /><label for='"+this.idx_insertvideo_radio_type3+"' style='padding-top:0 !important;'>"+ID_RES_DIALOG_STRING_URL_INPUT+"</label></td><td>",a+="<input type='text' name='dze_ext_url' value='' id='"+this.idx_dze_ext_url+"' class='duzon_dialog_body_urlform' style='width:100% !important;box-sizeing:border-box;padding-left:0px  !important;padding-right:0px !important;' placeholder ='"+ID_RES_DIALOG_STRING_URL_INPUT+"'>"):(a+="<tr>",a+="<td width='80'><input type='radio' name='dze_insert_type' value='1' id='"+
this.idx_insertvideo_radio_type1+"' checked /><label for='"+this.idx_insertvideo_radio_type1+"' style='padding-top:0 !important;'>"+ID_RES_DIALOG_STRING_FILE_PATH+"</label></td><td>",a+=this.makeExtFileForm("dze_upvideo_file",this.idx_insertvideo_upvideo_txt,"auto",d));a+="</td></tr>";a+="<tr><td colspan='2' height='2' /></tr>";a+="<tr>";a+="<td colspan='2'><input type='radio' name='dze_insert_type' value='2' id='"+this.idx_insertvideo_radio_type2+"' /><label for='"+this.idx_insertvideo_radio_type2+
"'  style='padding-top:0 !important;'>"+ID_RES_DIALOG_STRING_INPUT_SOURCE+"</label></td>";a+="</tr>";a+="<tr><td colspan='2' height='5' /></tr>";a+="</table>";a+="<div class=''><textarea name='dze_ext_movie_source' id='"+this.idx_dze_ext_movie_source+"' class='dze_ext_movie_source_form' placeholder='"+ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE+"' disabled></textarea></div>";a+="<div class='duzon_dialog_label_separator'></div>";a+="<div class='duzon_dialog_label_title'>"+ID_RES_DIALOG_STRING_MARGIN+"</div>";
a+="<table width='100%' border='0' celladding='0' cellspacing='0'>";a+="<tr>";a+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_LEFT+"</td>";a+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_marginleft","px","500","0","0")+"</td>";a+="<td width='22%'>"+ID_RES_DIALOG_STRING_MARGIN_TOP+"</td>";a+="<td width='28%'>"+this.makeSpinnerInputForm("dze_movie_margintop","px","500","0","0")+"</td>";a+="</tr>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_RIGHT+
"</td>";a+="<td>"+this.makeSpinnerInputForm("dze_movie_marginright","px","500","0","0")+"</td>";a+="<td>"+ID_RES_DIALOG_STRING_MARGIN_BOTTOM+"</td>";a+="<td>"+this.makeSpinnerInputForm("dze_movie_marginbottom","px","500","0","0")+"</td>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_CONST_INSERT_IMAGE_PARAGRAPH_ALIGN+"</td>";a+="<td colspan='4' align='left'>";for(d=0;d<this.dze_video_align_propertys.length;d++)curr_id="idx_dze_align_style_"+this.dze_video_align_propertys[d],
curr_icon=dzeEnvConfig.strPath_Image+"dialog/ico_ali_video_"+this.dze_video_align_propertys[d]+".png",1===d?(curr_exeName=eval("ID_RES_DIALOG_STRING_ALIGN_BASIC"),a+="<div class='dze_image_align_propery_set dze_image_align_propery_set_selected' id='"+curr_id+"'><div><img src='"+curr_icon+"' alt='' title='"+curr_exeName+"' width='28' height='28'></div>"+curr_exeName+"</div>"):(curr_exeName=eval("ID_RES_DIALOG_STRING_ALIGN_"+this.dze_video_align_propertys[d].toUpperCase()),a+="<div class='dze_image_align_propery_set' id='"+
curr_id+"'><div><img src='"+curr_icon+"' alt='' title='"+curr_exeName+"' width='28' height='28'></div>"+curr_exeName+"</div>");a+="</td>";a+="</tr>";a+="<tr>";a+="<td colspan='4' height='5'></td>";a+="</tr>";a+="<tr>";a+="<td>"+ID_RES_DIALOG_STRING_AUTO_PLAY+"</td>";a+="<td colspan='4' align='left'>"+this.makeComboInputFormWithArray("dze_idx_video_playtype",this.dze_video_playtype_propertys)+"</td>";a+="</tr>";a+="</table>";a+="</form>";a+='<iframe name="dze_upload_iframe" id=\''+this.idx_dze_upload_iframe+
"' style='width:100%;height:100px;display:none'></iframe>";a+="</div>";g_objVideoControl.setUpVideoUrl(null);return a}catch(c){dalert(c)}};this.insertExtMovieContent=function(a){try{var d=g_objLayerKit.getLayerDocument().dze_insert_video_form,c=this.nEditNumber,b=null;a=g_objVideoControl.getOption(a);switch(g_bBrowserType_IE?this.getRadioValue(d.dze_insert_type):d.dze_insert_type.value){case "1":case "30":var e=g_objLayerKit.getElementById(this.idx_insertvideo_upvideo_txt);if(!e||!e.value||0>=e.value.length)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO_EMPTY),
!1;var f=g_objVideoControl.getUpVideoUrl();if(null==f||""==f)return alert(ID_RES_DIALOG_ALERT_UPLOAD_ERROR),!1;b=g_objVideoControl.createVideo(a);if(!b)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO),!1;break;case "3":case "31":case "32":case "33":e=g_objLayerKit.getElementById("idx_dze_ext_url");if(!e||!e.value||0>=e.value.length)return alert(ID_RES_DIALOG_ALERT_SELECT_VALID_VIDEO_EMPTY),!1;b=duzon_dialog.getVideoForCheckedFormCtrl(d.dze_insert_type,a);if(0==b||!b)return!1;break;default:var k=
g_objLayerKit.getElementById(this.idx_dze_ext_movie_source),h=fnObjectCheckNull(k)?null:k.value.trim();!0===dzeUiConfig.bRemoveXSS&&(h=removeXSS(h,{bCheckIframe:!1}));if(!h&&k)return alert(ID_RES_DIALOG_STRING_INPUT_MOVIE_SOURCE),k.focus(),!1;b=g_objVideoControl.createVideoIframe(a,h);if(!b)return alert(ID_RES_DIALOG_STRING_MOVIE_INPUT_GUIDE),!1}this.closeDialog();if(!b)return!1;insertHTMLCodeAtSelection(null,b,c);b.lastChild&&"VIDEORESIZE"===b.lastChild.nodeName&&g_objVideoControl.animate(b.lastChild);
return!0}catch(g){dalert(g)}};this.onLoad=function(a,d,c){try{if(d){g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_table).style.opacity="0.5";var b=g_objLayerKit.getElementById(duzon_dialog.idx_dze_ext_movie_source);fnObjectCheckNull(b)||(b.style.opacity="0.5",b.disabled=!0);b=g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_radio_type1);fnObjectCheckNull(b)||(b.disabled=!0);b=g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_radio_type2);fnObjectCheckNull(b)||(b.disabled=
!0);b=g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_radio_type3);fnObjectCheckNull(b)||(b.disabled=!0);b=g_objLayerKit.getElementById(duzon_dialog.idx_dze_ext_url);fnObjectCheckNull(b)||(b.disabled=!0);b=g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_upvideo_txt);fnObjectCheckNull(b)||(b.disabled=!0);if(!fnObjectCheckNull(c))if("VIDEO"===c.nodeName)g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_upvideo_txt+"_view").innerText=c.currentSrc;else{var e=c.firstChild;e&&
0<=g_objVideoControl.arrVideoNodeName.indexOf(e.nodeName)&&(a="","IMG"===e.nodeName&&(a=createYoutubeIframe(e,!0)),a||(a=e.outerHTML),g_objLayerKit.getElementById(duzon_dialog.idx_dze_ext_movie_source).value=a)}}if(!d)if(duzon_dialog.modifySpinnerValue("dze_movie_marginleft",500,0,0,""),duzon_dialog.modifySpinnerValue("dze_movie_margintop",500,0,0,""),duzon_dialog.modifySpinnerValue("dze_movie_marginright",500,0,0,""),duzon_dialog.modifySpinnerValue("dze_movie_marginbottom",500,0,0,""),dzeUiConfig.bSupportNewsEditor){var f=
g_objLayerKit.getLayerDocument().dze_insert_video_form,k=f.dze_insert_type;if(!fnObjectCheckNull(k))for(var h=k.length,g=0;g<h;g++){var l=f.dze_insert_type[g];fnObjectCheckNull(l)||(l.onclick=function(a){duzon_dialog.checkDzeInsertTypeVideo(this,!0)})}}else g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_radio_type1).onclick=function(){duzon_dialog.checkDzeInsertTypeVideo(this,!0)},g_objLayerKit.getElementById(duzon_dialog.idx_insertvideo_radio_type2).onclick=function(){duzon_dialog.checkDzeInsertTypeVideo(this,
!0)};else if(c){var r=""==c.style.marginTop?0:c.style.marginTop,t=""==c.style.marginRight?0:c.style.marginRight,u=""==c.style.marginBottom?0:c.style.marginBottom;duzon_dialog.modifySpinnerValue("dze_movie_marginleft",500,0,parseInt(""==c.style.marginLeft?0:c.style.marginLeft),"");duzon_dialog.modifySpinnerValue("dze_movie_margintop",500,0,parseInt(r),"");duzon_dialog.modifySpinnerValue("dze_movie_marginright",500,0,parseInt(t),"");duzon_dialog.modifySpinnerValue("dze_movie_marginbottom",500,0,parseInt(u),
"");var m=null;m="center"===c.style.textAlign?"center":""==c.style["float"]?"default":c.style["float"]}for(g=0;g<duzon_dialog.dze_video_align_propertys.length;g++){var n=g_objLayerKit.getElementById("idx_dze_align_style_"+duzon_dialog.dze_video_align_propertys[g]);d&&""!=m&&(m===duzon_dialog.dze_video_align_propertys[g]?g_objPropertyUtil.addClass(n,"dze_image_align_propery_set_selected"):n.className="dze_image_align_propery_set");n.onclick=function(){for(var a=document.getElementsByClassName("dze_image_align_propery_set_selected"),
b=0;b<a.length;b++)a[b].className="dze_image_align_propery_set";g_objPropertyUtil.addClass(this,"dze_image_align_propery_set_selected")}}if(d){var p=g_objLayerKit.getElementById("dze_idx_video_playtype");p.value=c.getAttribute("playtype");""===p.value&&(p.value="Manual")}else!0===dzeUiConfig.bIndependentEdit&&"function"===typeof onefficeExtContent.addUploadForm&&(f=g_objLayerKit.getLayerDocument().dze_insert_video_form,onefficeExtContent.addUploadForm(f)),duzon_dialog.addEventExtFileForm(duzon_dialog.idx_insertvideo_upvideo_txt,
function(){g_objVideoControl.insertVideoForm()})}catch(q){dalert(q)}};this.modifyExtMovieContent=function(a){try{for(var d=g_objLayerKit.getElementById("dze_movie_marginleft").value,c=g_objLayerKit.getElementById("dze_movie_margintop").value,b=g_objLayerKit.getElementById("dze_movie_marginright").value,e=g_objLayerKit.getElementById("dze_movie_marginbottom").value,f,k=document.getElementsByClassName("dze_image_align_propery_set_selected"),h=0;h<duzon_dialog.dze_image_align_propertys.length;h++)k[0].id===
"idx_dze_align_style_"+duzon_dialog.dze_image_align_propertys[h]&&(f=duzon_dialog.dze_image_align_propertys[h]);var g=g_objLayerKit.getElementById("dze_idx_video_playtype");""!=d&&(a.style.marginLeft=d+"px");""!=c&&(a.style.marginTop=c+"px");""!=b&&(a.style.marginRight=b+"px");""!=e&&(a.style.marginBottom=e+"px");"center"===f?(a.style.textAlign=f,a.style["float"]=""):(a.style["float"]="default"===f?"":f,a.style.textAlign="");!1===fnObjectCheckNull(g)&&"VIDEO"===a.nodeName&&a.setAttribute("playtype",
g.value);this.closeDialog();return!0}catch(l){dalert(l)}}}).call(VideoDlg);