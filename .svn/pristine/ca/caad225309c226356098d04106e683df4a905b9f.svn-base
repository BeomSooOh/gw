var onefficeUtil={SortFileList:function(b,a,c){try{if(b){var d=oneffice.getAppEnvType(),e=d==APPENV.GW?oneffice.getListViewMgr():onefficeFileListMgr,f=0>a?!1:!0,h=b.sort(function(a,b){var c="fileName",g="";switch(e.m_SortType){default:case VIEWSORT.NAME:c=d==APPENV.GW?"subject":"fileName";break;case VIEWSORT.SHAREDATE:d==APPENV.GW&&(c="share_date");break;case VIEWSORT.READDATE:d==APPENV.GW&&(c="accessdate");break;case VIEWSORT.SHAREBYDATE:d==APPENV.GW&&(c="share_date");break;case VIEWSORT.UPLOADDATE:c=
"uploadDate";break;case VIEWSORT.SIZE:d==APPENV.GW?c="content_size":(c="size",g=a[c]-b[c]);d==APPENV.GW&&(g=a.type>b.type?f?-1:1:a.type<b.type?f?1:-1:"1"==a.type&&"1"==b.type?a[c]-b[c]:f?-1:1);break;case VIEWSORT.TYPE:d==WE&&(c="directory");break;case VIEWSORT.MODDATE:c=d==APPENV.GW?"moddate":"lastModifyDate";break;case VIEWSORT.OWNER:d==APPENV.GW&&(c="owner_name",a[c].length||(c="owner_id"))}""===g&&(g=onefficeUtil.getCmpResult(a,b,c,d,e,f));return g});f&&(h=h.reverse());if(d==APPENV.WE)e.m_aFileList=
h;else return h}}catch(k){dalert(k)}},getCmpResult:function(b,a,c,d,e,f){try{var h=0,k=!0,g=b.type,l=a.type,m=e.m_SortType==VIEWSORT.SHAREDATE&&"object"==typeof b[c]&&d==APPENV.GW?b[c].time:b[c],p=e.m_SortType==VIEWSORT.SHAREDATE&&"object"==typeof a[c]&&d==APPENV.GW?a[c].time:a[c];d==APPENV.GW?k=e.m_SortType==VIEWSORT.NAME||e.m_SortType==VIEWSORT.MODDATE||e.m_SortType==VIEWSORT.SHAREDATE:(k=e.m_SortType==VIEWSORT.NAME||e.m_SortType==VIEWSORT.UPLOADDATE||e.m_SortType==VIEWSORT.MODDATE,g=1==b.directory?
0:1,l=1==a.directory?0:1);return h=g>l?k?d==APPENV.GW?f?-1:1:1:-1:g<l?k?d==APPENV.GW?f?1:-1:-1:1:m>p?1:m<p?-1:0}catch(q){dalert(q)}},changeSortCtrlInfo:function(b,a){try{var c=oneffice.getAppEnvType(),d=DRIVE_FILE_VIEW.FILE_ITEM,e=c==APPENV.GW?oneffice.getListViewMgr():onefficeFileListMgr;c==APPENV.GW&&(d=e.getListViewType());if(d)e.updateSortCtrlInfo(b,!0);else if(!fnObjectCheckNull(a)){var f=a.parentElement;f&&onefficeUtil.hideSortArrowCtrl(f);e.m_nSortArrowImgDegree=-90;e.m_SortType=b}}catch(h){dalert(h)}},
hideSortArrowCtrl:function(b){},getFileSizeUnits:function(b){try{var a="";return a=1048576<=b?(b/1024/1024).toFixed(2)+" MB":1024<=b?(b/1024).toFixed(2)+" KB":1<b?b+" bytes":1==b?b+" byte":"0 byte"}catch(c){dalert(c)}},onFileListCloseClick:function(){try{duzon_dialog.closeDialog()}catch(b){dalert(b)}},checkSimpleSameContent:function(b){try{return!oneffice.bModified||oneffice.bModifiedPos==g_objUndoRedo.arrUndoRedoStruct[b].nUndoRedoStackPos}catch(a){dalert(a)}},checkSameContent:function(b){try{var a=
/dze_version="\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}"/,c=oneffice.savedContent.replace(a,""),d=b.replace(a,"");return c===d?!0:!1}catch(e){dalert(e)}},setSavedContent:function(b){try{oneffice.savedContent=b}catch(a){dalert(a)}},getRequestParameter:function(b){try{var a=null,c=oneffice.getAppEnvType();if(0<=document.location.href.indexOf("?")){var d=document.location.href.split("?")[1],e="",f="";e=decodeURIComponent(d);if(c==APPENV.GW)try{e=window.atob(e)}catch(g){}f=e.split("&");for(c=0;c<f.length;c++)if(!(0>
f[c].indexOf("="))){var h=f[c].split("=")[0],k=f[c].split("=")[1];if(h==b){a=k;break}}}return a}catch(g){return dalert(g),null}},getDomainInfo:function(b){try{var a=document.domain.split(".");return 0<=b&&b<a.length?a[b]:0}catch(c){return dalert(c),0}},getCookieValue:function(b){try{for(var a=document.cookie.split("; "),c=0;c<a.length;c++){var d=a[c].search(b);if(0<=d&&d<a[c].length)return a[c].split("=")[1]}return 0}catch(e){return dalert(e),0}},setCookieValue:function(b,a,c){try{var d=new Date;
d.setTime(d.getTime()+864E5*c);document.cookie=b+"="+a+";expires="+d.toUTCString()+";path=/"}catch(e){dalert(e)}},timeConverter:function(b){var a=new Date(b);b=a.getFullYear()+"";var c=a.getMonth()+1+"",d=a.getDate()+"",e=a.getHours()+"",f=a.getMinutes()+"";a=a.getSeconds()+"";1===d.length&&(d="0"+d);1===c.length&&(c="0"+c);1===e.length&&(e="0"+e);1===f.length&&(f="0"+f);1===a.length&&(a="0"+a);return b+"-"+c+"-"+d+" "+e+":"+f+":"+a},getNewSeq:function(){try{return(new Date).getTime()}catch(b){dalert(b)}},
showDocSubject:function(b){try{var a=!1,c=oneffice.currFileSubject;"undefined"!=typeof b&&(c=b,a=!0);""==c&&(c=oneffice.unTitleMsg+" "+oneffice.currFileRegDate.replace(/:/g,"").substr(5,oneffice.currFileRegDate.length));c+=" - ONEFFICE";var d=(objOnefficeLoader.isEditor()?g_objEditorDocument[g_nActiveEditNumber]:document).getElementsByTagName("title")[0];d&&(d.innerHTML=c);!0===g_readonlyMode&&(c="["+ID_RES_CONST_STRING_READ_ONLY+"]"+c);document.getElementsByTagName("head")[0].getElementsByTagName("title")[0].innerHTML=
c;var e=oneffice.getAppEnvType();if(e==APPENV.WE||e==APPENV.GW&&oneffice.currFileRegDate!=oneffice.currFileModDate)if(a){var f=document.getElementById("STATUS_BAR_CENTER_DIV_"+g_nActiveEditNumber),h=document.getElementById("PROGRESS_BAR_CENTER_DIV_"+g_nActiveEditNumber);f.style.display="none";h.style.display="";this.updateProgressBar(!1)}else oneffice.currFileModDate.length&&(document.getElementById("STATUS_BAR_CENTER_DIV_"+g_nActiveEditNumber).innerHTML=ID_RES_CONST_STRING_LAST_MODIFIED_DATE+" : "+
oneffice.currFileModDate);dze_menu_control.updateTitle()}catch(k){dalert(k)}},progressIntervalID:null,updateProgressBar:function(b,a){try{var c=document.getElementById("PROGRESS_BAR_CENTER_SUB_DIV_"+g_nActiveEditNumber);if(c){var d=parseInt(c.style.width,10);if(isNaN(d)||100<=d)d=0;var e=100-d,f=60;b?(60>d&&(d=60),f=100):0<d&&(f=Math.min(d+parseInt(e/2,10),100));null!==this.progressIntervalID&&(clearInterval(this.progressIntervalID),this.progressIntervalID=null);onefficeUtil.progressIntervalID=setInterval(function(){100<=
d?(clearInterval(this.progressIntervalID),this.progressIntervalID=null,setTimeout(function(){onefficeUtil.notificationStatusBar(a)},300)):(d=Math.min(d+2,f),d=Math.max(d,5),c.style.width=Math.min(d,100)+"%")}.bind(this),10)}}catch(h){dalert(h)}},notificationStatusBar:function(b){try{var a=g_nActiveEditNumber,c=document.getElementById("STATUS_BAR_CENTER_DIV_"+a),d=document.getElementById("PROGRESS_BAR_CENTER_DIV_"+a),e=d.querySelector("#PROGRESS_BAR_CENTER_SUB_DIV_"+a);d.style.display="none";c.style.display=
"";e.style.width="0px";if(!1!==fnObjectCheckNull(b)||!b){c.innerHTML=ID_RES_CONST_STRING_LAST_MODIFIED_DATE+" : "+oneffice.currFileModDate;cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_SAVED,2,"center",!0,TOAST_TYPE_OPTION_OK);var f=0,h=setInterval(function(){f++;3<f?clearInterval(h):c.innerHTML=f%2?ID_RES_CONST_STRING_LAST_MODIFIED_DATE+" : "+oneffice.currFileModDate:""},500)}}catch(k){dalert(k)}},setReadonlyNotificationBar:function(b,a,c){try{var d=document.getElementById("DZE_IDX_EDITOR_EDITOR_FRAME_"+
b);if(d){var e=document.getElementById("TB_CONTAINER_RULERBAR_"+b);e&&"none"!==e.style.display&&(e.style.display="none",resizeEditor_Height(b));var f=document.getElementById("TB_CONTAINER_READONLY_NOTIBAR_"+b);null==f&&(f=document.createElement("div"),f.id="TB_CONTAINER_READONLY_NOTIBAR_"+b,f.className="duzon_readonly_notification_bar_container",f.style.display="none",d.firstChild?d.insertBefore(f,d.firstChild):d.appendChild(f));var h=document.getElementById("TB_CONTAINER_READONLY_NOTIINFO_"+b);null==
h&&(h=document.createElement("p"),h.id="TB_CONTAINER_READONLY_NOTIINFO_"+b,h.style.padding="7px 0",h.style.fontSize="14px",h.style.lineHeight="1.5",h.innerText=ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT,f.appendChild(h));dzeJ(f).fadeIn("slow",null,function(){resizeEditor_Height(b)});if(null!==oneffice.tempContent)onefficeUtil.makeTempSavedContentNotiBar(h,b);else{var k=document.getElementById("TB_CONTAINER_READONLY_CLOSEBTN_"+b);null==k&&(k=document.createElement("img"),k.id="TB_CONTAINER_READONLY_CLOSEBTN_"+
b,k.className="duzon_readonly_close_btn",k.src="./image/cloud/ico_cloud_cancel.png",k.title=ID_RES_ADJUST_VIEW_CLOSE,f.appendChild(k),k.onclick=function(){var a=document.getElementById("TB_CONTAINER_READONLY_NOTIBAR_"+g_nActiveEditNumber);a&&(a.style.display="none");resizeEditor_Height(b)});if(0==fnObjectCheckNull(a)&&a&&0==fnObjectCheckNull(c)&&null!=f&&null!=h){h.innerText=-1==c?ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT:ID_RES_CONST_STRING_OPENED_READ_ONLY_DOCUMENT+" ["+a[c].name+"]\ub2d8\uc774 \ud3b8\uc9d1\uc911\uc785\ub2c8\ub2e4. ";
var g=document.createElement("span");g.className="cloud_icon_button";g.style.marginLeft="10px";g.style.paddingLeft="6px";g.style.paddingRight="6px";g.style.cursor="pointer";g.innerText="\uc790\uc138\ud788 \ubcf4\uae30";h.appendChild(g);g.onclick=function(a){var b=panelManager.getInstance();!0===b.isShowPanel()?b.updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO,2):b.showPanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO,2);TBCancelBubbleEvent(a)}}}}}catch(l){dalert(l)}},setEditModeDocument:function(b){try{!1===g_readonlyMode&&
(g_objPageControl.setShowHidePageLabelBtns(!0),g_objPageControl.setPageNumberReadonlyMode(b))}catch(a){dalert(a)}},setReadonlyDocument:function(b){try{if(!0===g_readonlyMode){for(var a=g_objEditorDocument[b].body.getElementsByTagName("video"),c=0;c<a.length;c++)a[c].getAttribute("draggable")&&a[c].removeAttribute("draggable");g_objPageControl.setShowHidePageLabelBtns(!1);dze_menu_control.activateMenu(0,b);g_objPageControl.setPageNumberReadonlyMode(b);(a=g_objTableMiniMenu)&&a.showTableMiniMenu(!1,
null,b);"undefined"!==typeof g_objPasteOptionMenu&&g_objPasteOptionMenu.hide()}}catch(d){dalert(d)}},m_UserEnvConfig:{},getSortStorageTitle:function(b){try{switch(1==fnObjectCheckNull(b)?oneffice_cloud_currentBrowserMode:b){case CLOUD_CONST_BROWSER_MODE_MYONEFFICE:var a="sortMyOneffice";break;case CLOUD_CONST_BROWSER_MODE_RECENT:a="sortRecent";break;case CLOUD_CONST_BROWSER_MODE_FAVORITE:a="sortFavorite";break;case CLOUD_CONST_BROWSER_MODE_SHARE:case CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST:case CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST:a=
"sortShare";break;case CLOUD_CONST_BROWSER_MODE_SECURITY:a="sortSecurity";break;case CLOUD_CONST_BROWSER_MODE_TRASHBOX:a="sortTrashbox"}return a}catch(c){dalert(c)}},updateUserSortConfig:function(b,a){try{var c=!1;if(onefficeUtil.m_UserEnvConfig&&onefficeUtil.m_UserEnvConfig.user_env){var d=duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env),e=oneffice.getAppEnvType()==APPENV.GW?oneffice.getListViewMgr():onefficeFileListMgr,f=onefficeUtil.getSortStorageTitle(a);if(1==b)d[f]!=e.m_SortType&&
(d[f]=e.m_SortType,onefficeUtil.m_UserEnvConfig.user_env=d,onefficeCommon.updateOnefficeUserEnv(JSON.stringify(d)),c=!0);else if(1==fnObjectCheckNull(d[f]))d[f]=e.m_SortType,onefficeUtil.m_UserEnvConfig.user_env=d,onefficeCommon.updateOnefficeUserEnv(JSON.stringify(d));else{e.m_nSortArrowImgDegree=-90;e.m_SortType=m_SortType=d[f];switch(e.m_SortType){case VIEWSORT.NAME:m_SortOption=CLOUD_CMD_SORT_TITE;e.m_nSortArrowImgDegree=m_nSortArrowImgDegree;break;case VIEWSORT.OWNER:m_SortOption=CLOUD_CMD_SORT_OWNER;
e.m_nSortArrowImgDegree=m_nSortArrowImgDegree;break;case VIEWSORT.SIZE:m_SortOption=CLOUD_CMD_SORT_FILESIZE;e.m_nSortArrowImgDegree=m_nSortArrowImgDegree;break;case VIEWSORT.SHAREDATE:m_SortOption=CLOUD_CMD_SORT_SHEREDATE;e.m_nSortArrowImgDegree=-m_nSortArrowImgDegree;break;case VIEWSORT.MODDATE:m_SortOption=CLOUD_CMD_SORT_RECENTDATE;e.m_nSortArrowImgDegree=-m_nSortArrowImgDegree;break;case VIEWSORT.READDATE:m_SortOption=CLOUD_CMD_SORT_READDATE;e.m_nSortArrowImgDegree=-m_nSortArrowImgDegree;break;
case VIEWSORT.SHAREBYDATE:m_SortOption=CLOUD_CMD_SORT_SHEREBYDATE,e.m_nSortArrowImgDegree=-m_nSortArrowImgDegree}e.updateSortCtrlInfo(e.m_SortType,!0);c=!0}}return c}catch(h){dalert(h)}},getFilterStorageTitle:function(b){try{switch(1==fnObjectCheckNull(b)?oneffice_cloud_currentBrowserMode:b){case CLOUD_CONST_BROWSER_MODE_RECENT:var a="filterRecent"}return a}catch(c){dalert(c)}},updateUserFilterConfig:function(b,a){try{var c=!1;if(onefficeUtil.m_UserEnvConfig&&onefficeUtil.m_UserEnvConfig.user_env){var d=
duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env),e=oneffice.getAppEnvType()==APPENV.GW?oneffice.getListViewMgr():onefficeFileListMgr,f=onefficeUtil.getFilterStorageTitle(a);1==b?d[f]!=e.m_FilterType&&(d[f]=e.m_FilterType,onefficeUtil.m_UserEnvConfig.user_env=d,onefficeCommon.updateOnefficeUserEnv(JSON.stringify(d)),c=!0):1==fnObjectCheckNull(d[f])?(d[f]=e.m_FilterType,onefficeUtil.m_UserEnvConfig.user_env=d,onefficeCommon.updateOnefficeUserEnv(JSON.stringify(d))):c=!0}return c}catch(h){dalert(h)}},
updateUserViewMode:function(){try{if(onefficeUtil.m_UserEnvConfig&&onefficeUtil.m_UserEnvConfig.user_env){var b=duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env),a=oneffice.getAppEnvType()==APPENV.GW?oneffice.getListViewMgr():onefficeFileListMgr;0==fnObjectCheckNull(b.viewThumbFileMode)&&a.getListViewType()!=b.viewThumbFileMode&&a.setListViewType(b.viewThumbFileMode)}}catch(c){dalert(c)}},isArticleForOpenURL:function(b){try{switch(1*oneffice_cloud_currFolderSeq){case 12030:case 12031:case 12032:return!0;
case 12002:var a=0,c=null;for(a;a<oneffice_cloud_currentItemList.length;a++)if(c=oneffice_cloud_currentItemList[a],b==c.seq&&onefficeUtil.isArticle(c.folderSeq))return!0}return!1}catch(d){dalert(d)}},isArticle:function(b){try{if(!fnObjectCheckNull(b))return b==CLOUD_CONST_STRING_NEWSROOM_SEQ?!0:!1}catch(a){dalert(a)}return!1},isRegArticle:function(b){try{if(!fnObjectCheckNull(b)){var a=duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env),c=fnObjectCheckNull(a)?null:a.articleSeqs;if(c&&0<=c.search(b))return!0}return!1}catch(d){dalert(d)}},
updateArticleConfig:function(b,a,c){try{if(a&&b.length){var d=duzon_http.parseJSON(onefficeUtil.m_UserEnvConfig.user_env);b+=";";if("undefined"==typeof d.articleSeqs||d.articleSeqs&&0>d.articleSeqs.search(b))d.articleSeqs="undefined"==typeof d.articleSeqs?b:d.articleSeqs+b,onefficeUtil.m_UserEnvConfig.user_env=d;onefficeCommon.updateOnefficeUserEnv(JSON.stringify(d),null,c)}}catch(e){dalert(e)}},checkUserAgreement:function(b){try{"function"===typeof b&&(oneffice.m_bUserAgreement=!0,b(),b=null),onefficeCommon.getOnefficeUserEnv(function(a){if(a&&
a.user_env){onefficeUtil.m_UserEnvConfig=a;objOnefficeLoader.getEditorMode()===EDITORMODE.HOME&&(onefficeUtil.updateUserSortConfig(!1),onefficeUtil.updateUserFilterConfig(!1),onefficeUtil.updateUserViewMode());var c=duzon_http.parseJSON(a.user_env);if(0==fnObjectCheckNull(c.autoSaveInterval)){var d=parseInt(c.autoSaveInterval);oneffice.autoSaveTime=60*d}"yes"==c.doNotShowAgain||!0===objOnefficeLoader.m_bDomainDuzon?(oneffice.m_bUserAgreement=!0,"function"===typeof b&&b()):onefficeUtil.showUserAgreeDialog(b,
a.user_env)}else!1===objOnefficeLoader.m_bDomainDuzon&&onefficeUtil.showUserAgreeDialog(b),onefficeCommon.updateOnefficeUserEnv(JSON.stringify({}))})}catch(a){dalert(a)}},showUserAgreeDialog:function(b,a){try{cmnDlg.viewBasicDlg(null,oneffice_cloud_currNEditNumber,"ONEFFICE Beta \uc11c\ube44\uc2a4 \uc548\ub0b4",onefficeUtil.getUserAgreeConfirmHTML(),["ONEFFICE \uc0ac\uc6a9\ud558\uae30"],[function(b){b=!0===fnObjectCheckNull(a)?{}:duzon_http.parseJSON(a);document.getElementById("dze_idx_input_check_agreement").checked&&
(b.doNotShowAgain="yes",1==fnObjectCheckNull(onefficeUtil.m_UserEnvConfig.user_env)&&(onefficeUtil.m_UserEnvConfig.user_env={}),onefficeUtil.m_UserEnvConfig.user_env.doNotShowAgain="yes");onefficeCommon.updateOnefficeUserEnv(JSON.stringify(b),"Y",function(){});duzon_dialog.closeDialog()}],function(){var a=document.getElementById("idx_duzon_dialog_close_btn");a.parentNode.removeChild(a)},function(){oneffice.m_bUserAgreement=!0;"function"===typeof b&&b()},!0)}catch(c){dalert(c)}},getUserAgreeConfirmHTML:function(){try{var b=
document.createElement("div");b.id="dze_idx_user_agree_container";b.className="cloud_user_agree_dialog_container";b.style.height="auto";b.style.width="auto";var a=document.createElement("div");a.id="dze_idx_usesr_guide_container";a.className="users_guide_container";a.innerHTML="<p>ONEFFICE beta \uc11c\ube44\uc2a4\uc5d0 \uc624\uc2e0\uac83\uc744 \ud658\uc601\ud569\ub2c8\ub2e4.</p><p>\ubcf8 \uc11c\ube44\uc2a4\ub294 Bizbox Alpha\ub97c \ud1b5\ud55c \ubb38\uc11c \ucee4\ubba4\ub2c8\ucf00\uc774\uc158\uc774 \uac00\ub2a5\ud558\ub3c4\ub85d<br /> \uc790\uccb4 \uac1c\ubc1c\ud55c \ubbf8\ub2c8\uba40 \uc6f9\uc624\ud53c\uc2a4 \uc785\ub2c8\ub2e4.</p><p><br /></p><p>\uc9c0\uae08\uae4c\uc9c0 \uc5c6\uc5c8\ub358 \uc0c8\ub85c\uc6b4 Document Life Cycle\uc744 \ubb34\ub8cc\ub85c \uacbd\ud5d8\ud574\ubcf4\uc138\uc694.</p><p>\uc624\ud53c\uc2a4\uc758 \uc0c8\ub85c\uc6b4 \uc815\uc758, ONEFFICE\uc5d0 \ub9ce\uc740 \uad00\uc2ec \ubd80\ud0c1 \ub4dc\ub9bd\ub2c8\ub2e4.</p>";
var c=document.createElement("div");c.id="dze_idx_usesr_guide_bottom_container";c.className="users_guide_buttom_container";c.innerHTML="* \ubcf8 \uc11c\ube44\uc2a4\ub294 \ubca0\ud0c0\ubc84\uc804\uc774\ubbc0\ub85c \uc911\uc694\ud55c \ubb38\uc11c\ub294 \ubc18\ub4dc\uc2dc \ubc31\uc5c5\ud574\ub450\uc2dc\uae30 \ubc14\ub78d\ub2c8\ub2e4.";var d=document.createElement("input");d.type="checkbox";d.id="dze_idx_input_check_agreement";d.style.visibility="visible";d.style.width="15px";d.style.height="15px";d.style.float=
"left";d.style.opacity="0";var e=document.createElement("label");e.innerHTML="\ub2e4\uc2dc \ubcf4\uc9c0 \uc54a\uae30";e.setAttribute("for","dze_idx_input_check_agreement");var f=document.createElement("div");f.className="user_agree_check_container";f.appendChild(d);f.appendChild(e);b.appendChild(a);b.appendChild(c);b.appendChild(f);return b.outerHTML}catch(h){dalert(h)}},onReloadFileContent:function(b,a){try{var c=oneffice.getAppEnvType();if(b){var d="";switch(c){case APPENV.WE:onefficeWE.setCurrFileInfo(!1);
onefficeUtil.setSavedContent(b);d=b;break;default:var e=b;oneffice.parentFileContent=cloneSimpleObject(e);oneffice.currFileSeq=e.seq;oneffice.currFolderSeq=e.folderSeq;oneffice.currFileSubject=e.subject;oneffice.currFileRegDate="object"==typeof e.regdate?getFullDateFromTimeStamp(e.regdate.time):e.regdate;oneffice.currFileModDate="object"==typeof e.moddate?getFullDateFromTimeStamp(e.moddate.time):e.moddate;oneffice.currFileOwnerId=e.owner_id;oneffice.savedContent=e.content;""==e.subject&&e.content==
oneffice.emptyContent&&(oneffice.bNewFileStart=!0,oneffice.bNewFileStartSavedContent=e.content);updateSecurityButtonByStatus(a);d=e.content}if(!0!==g_browserCHK.mobile&&!0===dzeUiConfig.bTempSavedDocRecovery){var f=onefficeUtil.getRequestParameter("ref"),h=onefficeUtil.getTempDataFromLocalStorage(oneffice.currFileSeq);null!=h&&(e.readonly=1);if("tempdoc"==f&&null!=h&&!0!==oneffice.bTempLoadedContent){onefficeUtil.openTempSavedContentAction(a);return}}g_objPageControl.documentContainerNode=null;setEditorHTMLCode(d,
!1,a);var k=dzeLayoutControl.getCustomPropertyEle(a,"dze_doc_property");if(c==APPENV.GW){var g=dzeLayoutControl.getDocumentNoProperty(a);g===oneffice.MERGE_DOC?oneffice.bMadeByMerge=!0:g!==oneffice.currFileSeq&&(oneffice.bMadeByCopy=!0,oneffice.strSavedDocNo=g)}dzeLayoutControl.setDocPgOverflow(a);dzeUiConfig.bOfficeOnePageLongMode=dzeLayoutControl.getOnePageModeProperty(a);dzeLayoutControl.applyPaperSizeProperty(a);dzeLayoutControl.setDocPageColor(a);g_objZoom.setConfigDocZoomPropertyInfo(a);dzeLayoutControl.setDocWatermarkSrcFromDocProperty(a);
g_objHeaderFooter.importHeaderFooterAttribute(k);g_objHeaderFooter.setHeaderOverflowBlinderStyle();g_objPageNumber.import(k);changeCss(".editorContainer","opacity","1",document);dzeLayoutControl.setDocPrintMargin(a);b=k=null;b=c==APPENV.GW?onefficeGW:onefficeWE;b.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate,oneffice.currFileModDate);initializeDocFocus(a);dzeLayoutControl.setEditAreaSize(a,!0);dzeUiConfig.bOfficePagingMode&&g_objPageControl.initializeMultiPageMode(a);
g_objWrapperOutlineUtil_Improved.initWrapperOutlineUtil();switch(c){default:case APPENV.GW:"undefined"==typeof e.readonly&&(e.readonly=0)}c==APPENV.GW?onefficeGW.showDocumentProperties(e,a):onefficeUtil.checkLanguage(g_onefficeWeTool.m_langCode);fnHandler_viewRulerbar(null,null,a);!0===g_readonlyMode&&onefficeUtil.setReadonlyNotificationBar(a);g_objZoom.initDocZoomPropertyInfo(a);c==APPENV.GW&&!1===oneffice.bNewFileStart&&(!0===oneffice.bMadeByCopy?(onefficeUtil.renewDocumentQRCode(),onefficeGW.exchangeContentsListInfo(!0,
oneffice.strSavedDocNo)):onefficeGW.exchangeContentsListInfo(!0));g_browserCHK.mobile&&(dzeUiConfig.bTBPreviewLetterOperation=!1,setTimeout(function(){g_objEditorDocument[0].getElementById("dze_document_main_container").scrollTop=0;g_objEditorDocument[0].getElementById("dze_document_main_container").focus()},10));g_objOnefficeEditor.isDocumentLoaded=!0}else switch(dzeLayoutControl.setReadonlyMode(!0,a),alert(ID_RES_CONST_STRING_INVALID_CALL),c){case APPENV.WE:document.location.href=WEHAGO_MAIN_LOCATION;
break;default:case APPENV.GW:document.location.href=oneffice.drivePath}}catch(l){dalert(l)}},onLoadFileContent:function(b,a){try{var c=function(a){var b=getEditorHTMLCode(!1,a,!0);objOnefficeLoader.m_nAppEnvType===APPENV.WE?onefficeWE.saveFileProcess(b,function(){onefficeUtil.setSavedContent(b);onefficeUtil.updateProgressBar(!0);g_onefficeWeTool.reqListSave(!0)},function(){}):onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,b,a,function(){onefficeUtil.setSavedContent(b);
onefficeGW.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,oneffice.currFileRegDate)},!0)},d=onefficeUtil.getRequestParameter("ref"),e=!1,f=!1,h=oneffice.getAppEnvType();if(b){var k="";switch(h){case APPENV.WE:onefficeWE.setCurrFileInfo(!1);onefficeUtil.setSavedContent(b);k=b;break;default:var g=b;oneffice.parentFileContent=cloneSimpleObject(g);oneffice.currFileSeq=g.seq;oneffice.currFolderSeq=g.folderSeq;oneffice.currFileSubject=g.subject;oneffice.currFileOpenDate=
g.hasOwnProperty("openFileDate")?g.openFileDate:null;oneffice.currFilePath=g.hasOwnProperty("openPath")?g.openPath:null;oneffice.currFileRegDate="object"==typeof g.regdate?getFullDateFromTimeStamp(g.regdate.time):g.regdate;oneffice.currFileModDate="object"==typeof g.moddate?getFullDateFromTimeStamp(g.moddate.time):g.moddate;oneffice.currFileOwnerId=g.owner_id;oneffice.savedContent=g.content;""==g.subject&&g.content==oneffice.emptyContent&&(oneffice.bNewFileStart=!0,oneffice.bNewFileStartSavedContent=
g.content);updateSecurityButtonByStatus(a);k=g.content;var l={doc_no:g.seq,folder_no:g.folderSeq,doc_name:g.subject,readonly:g.readonly,important:g.important,content:g.content,openFileDate:g.openFileDate,openPath:g.openPath};!1===fnObjectCheckNull(g.owner_id)&&(l.owner_id=g.owner_id);!1===fnObjectCheckNull(g.security_key)&&"0"!==g.security_key&&"1"!==g.security_key&&(l.security_key=g.security_key);var m=g.my_id==g.owner_id?!0:!1;if(m&&d&&0<=d.indexOf("backupdoc")&&0==oneffice.bBackupLoadedContent){var p=
d.split("|")[1];onefficeUtil.updateOpenDataIndexedDB(g.seq,l,p);return}m&&onefficeUtil.updateOpenDataIndexedDB(g.seq,l)}if(!0!==g_browserCHK.mobile&&!0===dzeUiConfig.bTempSavedDocRecovery){var q=oneffice.bBackupLoadedContent?oneffice.tempContent:onefficeUtil.getTempDataFromLocalStorage(oneffice.currFileSeq);null!=q&&(g.readonly=1);if("tempdoc"==d&&null!=q&&!0!==oneffice.bTempLoadedContent){onefficeUtil.openTempSavedContentAction(a);return}}if(20>=k.length&&0<=k.indexOf("category")){dlog("setEditorHTMLCode = "+
k);var B=k.split(",")[0],C=k.split(",")[1],r=parseInt(B.split(":")[1]),t=parseInt(C.split(":")[1]);dlog("setEditorHTMLCode  categoryIdx = "+r);dlog("setEditorHTMLCode  dataIdx = "+t);k="";e=!0}setEditorHTMLCode(k,!1,a);var n=dzeLayoutControl.getCustomPropertyEle(a,"dze_doc_property");dzeLayoutControl.setObjExtInfo(n);var x=dzeLayoutControl.setExportFrom(n);x&&x.bSave&&(f=!0);if(h==APPENV.GW){var w=dzeLayoutControl.getDocumentNoProperty(a);w===oneffice.MERGE_DOC?oneffice.bMadeByMerge=!0:w!==oneffice.currFileSeq&&
(oneffice.bMadeByCopy=!0,oneffice.strSavedDocNo=w)}oneffice.docVersion=fnObjectCheckNull(n)?"1.0.0.0":n.getAttribute("dze_version")||"1.0.0.0";dzeLayoutControl.setDocPgOverflow(a);dzeUiConfig.bOfficeOnePageLongMode=dzeLayoutControl.getOnePageModeProperty(a);dzeLayoutControl.applyPaperSizeProperty(a);dzeLayoutControl.setDocPageColor(a);g_objZoom.setConfigDocZoomPropertyInfo(a);dzeLayoutControl.setDocWatermarkSrcFromDocProperty(a);g_objHeaderFooter.importHeaderFooterAttribute(n);g_objHeaderFooter.setHeaderOverflowBlinderStyle();
g_objPageNumber.import(n);!0===objOnefficeLoader.m_bDomainBizwatch&&!0===dzeUiConfig.bSupportNewsEditor&&!1===fnObjectCheckNull(n)&&(dzeUiConfig.nBizwatchArticleId=n.getAttribute(DZE_CUSTOM_ATT_ARTICLE_ID)||null);!0===dzeUiConfig.bSupportNewsEditor&&g_objHeaderFooter.setOption({bUseEditMode:!1});var D=dzeLayoutControl.getDocPrintMarginInfo(a,!0);dzeLayoutControl.setDocPrintMargin(a,D);b=n=null;b=h==APPENV.GW?onefficeGW:onefficeWE;b.setCurrFileInfo(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,
oneffice.currFileRegDate,oneffice.currFileModDate);initializeDocFocus(a);dzeLayoutControl.setEditAreaSize(a,!0);dzeUiConfig.bOfficePagingMode&&g_objPageControl.initializeMultiPageMode(a);changeCss(".editorContainer","opacity","1",document);g_objWrapperOutlineUtil_Improved.initWrapperOutlineUtil();switch(h){case APPENV.WE:switch(g_onefficeWeTool.m_nDocPermission){case 1:fnCommandReadOnlyMode(a,1.5)}break;default:case APPENV.GW:"undefined"==typeof g.readonly&&(g.readonly=0);var u="W";1==g.readonly||
"R"==g.share_perm&&g.my_id!=g.owner_id?(fnCommandReadOnlyMode(a,2),onefficeGW.setAccessDocument(g.seq,"R","1",360,function(a){})):(1==dzeUiConfig.bMobileHybridEdit&&(u="M"),onefficeGW.setAccessDocument(g.seq,u,"1",360,function(b){"R"==b.access_perm?(fnCommandReadOnlyMode(a,0),onefficeGW.viewDocumentAccessInfo(oneffice.currFileSeq)):onefficeGW.setTimerDocumentAccessStatus(u,g)}))}h==APPENV.GW?(onefficeGW.showDocumentProperties(g,a,function(){if(!0===e&&1===r&&0===t){var b=g_objEditorDocument[0].getElementById("idx_auto_writer");
b&&(b.textContent=oneffice_cloud_myInfoData.name,b.id="");g_objUndoRedo.registerInitialContentStack(a)}!1===objOnefficeLoader.m_bHybrid&&("view_comment"===d?onefficeUtil.openDocComment():!1===objOnefficeLoader.m_bDev&&!1===oneffice.bTempLoadedContent&&onefficeGW.getCommentCounts(oneffice_cloud_myInfoData,function(a){0<a?onefficeUtil.openDocComment():!0===g_browserCHK.mobile&&!0===dzeUiConfig.bMobileEdit&&onefficeUtil.sendCommentStatus(0)}))}),objOnefficeLoader.m_bHybrid||setTimeout(function(){onefficeGW.onCheckEditUseTimer()},
500)):onefficeUtil.checkLanguage(g_onefficeWeTool.m_langCode);fnHandler_viewRulerbar(null,null,a);!0===g_readonlyMode&&onefficeUtil.setReadonlyNotificationBar(a);g_objZoom.initDocZoomPropertyInfo(a);g_objPageControl.changeCssPageBreakAfter(a);g_objVideoControl.setReadOnly(a);g_readonlyMode?g_objPlaceholder.removeAllPlaceholderText(g_objEditorDocument[a].body):g_objPlaceholder.setAllPlaceholderText(g_objEditorDocument[a].body);if(h==APPENV.GW){var E=objOnefficeLoader.m_bDomainBizwatch?onefficeUtil.isArticle(oneffice.currFolderSeq)?
"openNews":"openDoc":"openDoc";onefficeCommon.accessUserFunction(E);onefficeCommon.accessDocumentHistory(oneffice.currFileSeq,CLOUD_CONST_HISTORY_ACTIONCODE_OPEN);!1===oneffice.bNewFileStart&&(!0===oneffice.bMadeByCopy?(onefficeUtil.renewDocumentQRCode(),onefficeGW.exchangeContentsListInfo(!0,oneffice.strSavedDocNo)):onefficeGW.exchangeContentsListInfo(!0))}g_browserCHK.mobile&&(dzeUiConfig.bTBPreviewLetterOperation=!1,setTimeout(function(){g_objEditorDocument[0].getElementById("dze_document_main_container").scrollTop=
0;g_objEditorDocument[0].getElementById("dze_document_main_container").focus()},10));g_objOnefficeEditor.isDocumentLoaded=!0;if(!0===e){var y=function(b){duzon_dialog.inputSelectDocFormDataOfContent(r,t,b,a);g_objPageControl.syncUpdatePageAll();c(a);g_objUndoRedo.registerInitialContentStack(a)};if(0>r||0>t)alert(ID_RES_DIALOG_ALERT_SELECT_DOCFORM);else{var v=void 0;if(objOnefficeLoader.m_nAppEnvType===APPENV.GW){f="";"ja"===CLOUD_CONST_LANG&&(f="_ja");var z="js/const/sample"+f+"/"+docformTemplateCategory[r].data[t].html;
dynamicScriptCallDirect(z).then(function(){v=onefficeUtil.getDocFormContent(z);void 0!==v?y(v):dlog("Form Bot Content Undefined")},function(){dlog("loadFail")})}else v=docformTemplateCategory[r].data[t].html,y(v)}}else f&&c(a),g_objUndoRedo.registerInitialContentStack(a)}else switch(dzeLayoutControl.setReadonlyMode(!0,a),alert(ID_RES_CONST_STRING_INVALID_CALL),h){case APPENV.WE:document.location.href=WEHAGO_MAIN_LOCATION;break;default:case APPENV.GW:document.location.href=oneffice.drivePath}}catch(A){dalert(A)}},
openHTMLContent:function(b,a,c){try{var d=objOnefficeLoader.m_nAppEnvType,e="";if(d===APPENV.WE){var f=a.split(".")[0];e=dzeEnvConfig.strPath_Document+f+"_wehago/"+f+"_wehago.html"}else e=dzeEnvConfig.strPath_Document+a.split(".")[0]+"/"+a;duzon_http.readFile(e,{timeout:3E4,success:function(e){"SUCCESS"!==e.resultMessage&&dlog(e.resultMessage);if(e){var f=onefficeCommon.newFileContent();f.content=e;switch(d){case APPENV.WE:g_onefficeWeTool.m_bViewer?fnLoadViewModeSuccessCB({content:f.content,subject:g_onefficeWeTool.m_OrgFileName},
g_onefficeWeTool.m_ctrlViewer):g_onefficeWeTool.openContentsSuccessCB(f.content);break;default:case APPENV.GW:f.seq=b;var g=onefficeCommon.getOnefficeGuideDoc(b);f.subject=g&&g.title?g.title:a.substring(a.lastIndexOf("/")+1);f.content_size=e.length;onefficeUtil.onLoadFileContent(f,c)}}},error:function(a){dlog("error:openHTMLContent.readFile")}})}catch(h){dalert(h)}},makeQRMessageBox:function(b,a,c){try{var d=document.createElement("div");a?d.setAttribute("class","oneffice_qrcode_last_container"):
d.setAttribute("class","oneffice_qrcode_first_container");d.setAttribute("contenteditable","false");d.setAttribute("style","height: 120px; outline: 0px;");var e=document.createElement("div");e.setAttribute("id","dze_idx_qr_image");e.style.width="60px";e.style.height="60px";e.style.margin="30px";e.style.display="block";var f=new Image;f.setAttribute("id","dze_idx_qr_border");f.style.position="absolute";f.style.width="120px";f.style.height="120px";a||(f.style.top="0px");objOnefficeLoader.m_bHybrid?
(f.src="../image/Artboard.png",f.setAttribute("webSrc","./image/Artboard.png")):f.src="./image/Artboard.png";new QRCode(e,{text:b,width:400,height:400,correctLevel:QRCode.CorrectLevel.L});var h=e.querySelector("img");h.style.width="60px";var k=document.createElement("div");k.setAttribute("id","dze_idx_qr_container");a&&k.setAttribute("style","float: left; padding-right: 18px;");k.appendChild(f);k.appendChild(e);d.appendChild(k);if(a){var g=document.createElement("div");g.setAttribute("style","height: 120px; display: table-cell; vertical-align: middle;");
g.innerHTML="<p style='font-size:13px; font-weight:bold; line-height: 2.2;'>\uc6d0\ud53c\uc2a4 QR\ucf54\ub4dc\ub85c \uc6d0\ubcf8 \ubb38\uc11c\ub97c \ud0d0\uc0c9 \ubd88\ub7ec\uc62c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p><p style='font-size:11px;'>\uad8c\ud55c\uc5d0 \ub530\ub77c \ubb38\uc11c \uc5f4\ub78c\uc774 \uc81c\ud55c\ub420 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p><p style='font-size:11px;'>\ubcf8 \ubb38\uc11c\ub294 \uc778\uc1c4, \uc5f4\ub78c \ubc0f \uacf5\uc720 \ub4f1\uc5d0 \ub300\ud574 \uc774\ub825\uc774 \uad00\ub9ac\ub429\ub2c8\ub2e4.</p>";
d.appendChild(g)}h.onload=function(){h.onload=null;"function"===typeof c&&c(d)}}catch(l){dalert(l)}},renewDocumentQRCode:function(){try{var b=g_nActiveEditNumber,a=g_objEditorDocument[b];if(a){var c=!1,d=!1,e=a.getElementsByClassName("oneffice_qrcode_first_container"),f=a.getElementsByClassName("oneffice_qrcode_last_container");for(a=0;a<e.length;a++)dzeJ(e[a--]).remove(),c=!0;for(a=0;a<f.length;a++)dzeJ(f[a--]).remove(),d=!0;if(!objOnefficeLoader.m_bDev){var h=!0===objOnefficeLoader.m_bHybrid?onefficeMGW:
onefficeGW;c&&onefficeUtil.makeQRMessageBox(h.getDocumentShareOpenURL(oneffice.currFileSeq,oneffice.onefficeGroupSeq,"qr_url"),!1,function(a){insertQRCodeElement(a,!1,b)});d&&onefficeUtil.makeQRMessageBox(h.getDocumentShareOpenURL(oneffice.currFileSeq,oneffice.onefficeGroupSeq,"qr_url"),!0,function(a){insertQRCodeElement(a,!0,b)})}}}catch(k){dalert(k)}},openQRCodeDialog:function(b){try{oneffice.onErrorCheckSession(function(){if(oneffice.getAppEnvType()==APPENV.GW){var a=onefficeUtil.getRequestParameter("seq");
a?b?onefficeUtil.requestOpenDialog(a):onefficeUtil.qrOpenDialog(a):closeViewer()}else g_onefficeWeTool.m_bViewer=!0,g_onefficeWeTool.m_ctrlViewer=htmlContainer,onefficeWE.openFileProcess()?duzon_http.hideLoading():(alert(ID_RES_CONST_STRING_WE_NOT_SUPPORTED),document.location.href=WEDRIVE_MAIN_LOCATION)},dzeUiConfig.bAlwaysCheckSession)}catch(a){dalert(a)}},requestOpenDialog:function(b){try{onefficeCommon.getSearchUserInfoList(CLOUD_CONST_SEARCH_USER_INFO_OPTION_DOC_SEQ,b,function(a){onefficeCommon.getMyInfo(function(c){if(a.id==
c.id){var d=onefficeUtil.getRequestParameter("ref").split("|"),e=d[1];onefficeGW.getShareInfo(b,function(f){for(var h=0;h<f.length;h++)if(f[h].share_id==e){0==g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_ALREADY_ALLOW_DOCUMENT,2):onefficeUtil.requestAllowWithMsg(ID_RES_CONST_STRING_ALREADY_ALLOW_DOCUMENT);return}cmnDlg.viewBasicDlg(null,0,"",onefficeCommon.getDocOpenAllow(),[ID_RES_CONST_STRING_ALLOW,ID_RES_CONST_STRING_DENY],[function(){onefficeGW.shareDocument(b,SHARE_TARGET.PERSON,
d[1],d[2],function(b){b=[];b.push(e);onefficeGW.sendNoteMessage(b,onefficeUtil.makeRequestMessage(a,c,!0),c);duzon_dialog.closeDialog();0==g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_REQUEST_ALLOW,2):onefficeUtil.requestAllowWithMsg(ID_RES_CONST_STRING_REQUEST_ALLOW)})},function(){duzon_dialog.closeDialog();0==g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_REQUEST_NOT_ALLOW,2):onefficeUtil.requestAllowWithMsg(ID_RES_CONST_STRING_REQUEST_NOT_ALLOW)}],
function(){for(var f=document.getElementById("idx_dlg"),g=document.getElementsByClassName("duzon_dialog_buttonbox")[0],h=g.childNodes,m=g.offsetHeight,p=0;p<h.length;p++)h[p].style.display="none";g.style.color="#148dda";g.style.backgroundColor="#dddee3";g_browserCHK.iPad||g_browserCHK.androidtablet?(g.style.fontSize="30px",g.style.padding="10px"):(f.style.transform=g_browserCHK.mobile?"scale(1.3)":"scale(0.5)",g.style.fontSize="36px",g.style.padding="25px");f=document.createElement("div");h=document.createElement("div");
f.style="width:"+(g.offsetWidth/2-100)+"px; line-height:"+m+"px; display: inline-block;";h.style="width:"+(g.offsetWidth/2-100)+"px; line-height:"+m+"px; display: inline-block;";f.innerHTML+=ID_RES_CONST_STRING_ALLOW;h.innerHTML+=ID_RES_CONST_STRING_DENY;g.appendChild(f);g.appendChild(h);f.ontouchstart=function(a){this.style.color="#244dda"};f.ontouchend=function(a){this.style.color="#148dda"};f.onclick=function(){onefficeGW.shareDocument(b,SHARE_TARGET.PERSON,d[1],d[2],function(b){b=[];b.push(e);
onefficeGW.sendNoteMessage(b,onefficeUtil.makeRequestMessage(a,c,!0),c);duzon_dialog.closeDialog();0==g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_REQUEST_ALLOW,2):onefficeUtil.requestAllowWithMsg(ID_RES_CONST_STRING_REQUEST_ALLOW)})};h.ontouchstart=function(a){this.style.color="#244dda"};h.ontouchend=function(a){this.style.color="#148dda"};h.onclick=function(){duzon_dialog.closeDialog();0==g_browserCHK.mobile?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_REQUEST_NOT_ALLOW,
2):onefficeUtil.requestAllowWithMsg(ID_RES_CONST_STRING_REQUEST_NOT_ALLOW)};g=document.getElementsByClassName("duzon_dialog_body_content")[0];g.style.padding="0";0==g_browserCHK.mobile&&(g.style.transform="scale(0.8)");if(3<=d.length){var q="R"==d[2]?ID_RES_CONST_STRING_VIEWING:ID_RES_TOOL_STRING_MENU_EDIT;onefficeCommon.getSearchUserInfoList(CLOUD_CONST_SEARCH_USER_INFO_OPTION_USER_SEQ,e,function(a){a=a&&0<a.length?a[0]:null;var b=document.getElementById("dze_idx_doc_allow_title");a&&b&&(b.innerText=
String.format(ID_RES_CONST_STRING_SOMEONE_PERM,a.name,q))})}onefficeCommon.getFileContent(b,function(a){onefficeUtil.updateQRInfo(b,a,!1)},null,null,null,!0)},function(){},!0)})}else fnLoadViewMode(),duzon_dialog.closeDialog(),!0!==dzeUiConfig.bIndependentEdit&&oneffice.getAppEnvType()==APPENV.GW&&"undefined"!==typeof onefficeCommon.accessUserFunction&&onefficeCommon.accessUserFunction("visit")},!1)})}catch(a){dalert(a)}},qrOpenDialog:function(b){try{cmnDlg.viewBasicDlg(null,0,"",onefficeCommon.getDocOpenInfo(!0),
[ID_RES_CONST_STRING_VIEWING],[function(a){fnLoadViewMode();duzon_dialog.closeDialog();!0!==dzeUiConfig.bIndependentEdit&&oneffice.getAppEnvType()==APPENV.GW&&"undefined"!==typeof onefficeCommon.accessUserFunction&&onefficeCommon.accessUserFunction("visit")}],function(){var a=document.getElementById("idx_dlg"),c=document.getElementsByClassName("duzon_dialog_buttonbox")[0];c.firstChild.style.display="none";c.innerHTML+=ID_RES_CONST_STRING_VIEWING;c.style.color="#148dda";c.style.backgroundColor="#dddee3";
g_browserCHK.iPad||g_browserCHK.androidtablet?(c.style.fontSize="30px",c.style.padding="10px"):(a.style.transform="scale(1.3)",c.style.fontSize="36px",c.style.padding="25px");c.ontouchstart=function(a){this.style.backgroundColor="#bbb"};c.ontouchend=function(a){this.style.backgroundColor="#dddee3"};c.onclick=function(){fnLoadViewMode();duzon_dialog.closeDialog();!0!==dzeUiConfig.bIndependentEdit&&oneffice.getAppEnvType()==APPENV.GW&&"undefined"!==typeof onefficeCommon.accessUserFunction&&onefficeCommon.accessUserFunction("visit")};
document.getElementsByClassName("duzon_dialog_body_content")[0].style.padding="0";onefficeCommon.getFileContent(b,function(a){null==a?(duzon_dialog.closeDialog(),onefficeUtil.requestOpenPermDialog(b)):onefficeUtil.updateQRInfo(b,a,!0)},null,null,null,!0);setTimeout(function(){onefficeUtil.dialogCenterReposition()},100)},function(){},!0)}catch(a){dalert(a)}},updateSimpleQRInfo:function(b,a){try{if(a.doc_name){var c=document.getElementById("dze_idx_doc_info_subject");c&&(c.innerText=a.doc_name)}if(a.name){var d=
document.getElementById("dze_idx_doc_info_owner");d&&(d.innerText=a.duty_name?a.name+" "+a.duty_name:a.name)}if(a.reg_date){var e=document.getElementById("dze_idx_doc_info_newdate");e&&(e.innerText="object"==typeof a.reg_date?getFullDateFromTimeStamp(a.reg_date.time):a.reg_date,e.innerText=e.innerText.substring(0,10).replace(/-/gi,"."))}if(a.mod_date){var f=document.getElementById("dze_idx_doc_info_moddate");f&&(f.innerText="object"==typeof a.mod_date?getFullDateFromTimeStamp(a.mod_date.time):a.mod_date,
f.innerText=f.innerText.substring(0,10).replace(/-/gi,"."))}if(a.content_size){var h=document.getElementById("dze_idx_doc_info_size");h&&(h.innerText=onefficeUtil.getFileSizeUnits(a.content_size))}}catch(k){dalert(k)}},updateQRInfo:function(b,a,c){try{if(c&&a.strThumbnail){var d=document.getElementById("dze_idx_doc_info_thumb"),e=(new Date).getTime();d&&(d.innerHTML='<img src="'+ONEFFICE_SERVER_API_GET_ATTACHMENTDATA+"?seq="+a.strThumbnail+"&_t="+e+'" style="width:252px; max-height:356px; border-radius: 6px;">')}c&&
(onefficeCommon.getSecurityInfo(b,"",function(a){0!=a&&(document.getElementById("dze_idx_doc_info_ico_sec").style.display="")}),a.readonly&&"1"==a.readonly&&(document.getElementById("dze_idx_doc_info_ico_read").style.display=""));if(a.subject){var f=document.getElementById("dze_idx_doc_info_subject");f&&(f.innerText=a.subject)}a.owner_id&&document.getElementById("dze_idx_doc_info_owner")&&onefficeCommon.getSearchUserInfoList(CLOUD_CONST_SEARCH_USER_INFO_OPTION_USER_SEQ,a.owner_id,function(a){a=a&&
0<a.length?a[0]:null;var b=document.getElementById("dze_idx_doc_info_owner");a&&b&&(b.innerText=a.name+" "+a.duty_name)});if(a.regdate){var h=document.getElementById("dze_idx_doc_info_newdate");h&&(h.innerText="object"==typeof a.regdate?getFullDateFromTimeStamp(a.regdate.time):a.regdate,h.innerText=h.innerText.substring(0,10).replace(/-/gi,"."))}if(a.moddate){var k=document.getElementById("dze_idx_doc_info_moddate");k&&(k.innerText="object"==typeof a.moddate?getFullDateFromTimeStamp(a.moddate.time):
a.moddate,k.innerText=k.innerText.substring(0,10).replace(/-/gi,"."))}if(a.content_size){var g=document.getElementById("dze_idx_doc_info_size");g&&(g.innerText=onefficeUtil.getFileSizeUnits(a.content_size))}}catch(l){dalert(l)}},makeRequestMessage:function(b,a,c){try{var d=1==fnObjectCheckNull(c)?!1:c;c="";var e=d?"":"open_request|"+a.id+"|R";d?(c+="[ONEFFICE \ubb38\uc11c \uad8c\ud55c \ud5c8\uc6a9]\r\n",c+=a.name+"\ub2d8\uc774 \ubb38\uc11c "+ID_RES_CONST_STRING_VIEWING+"\uc5d0 \ub300\ud55c \uad8c\ud55c\uc744 \ud5c8\uc6a9\ud558\uc600\uc2b5\ub2c8\ub2e4.\r\n\r\n\r\n"):
(c+="[ONEFFICE \ubb38\uc11c \uad8c\ud55c \uc694\uccad]\r\n",c+=a.name+"\ub2d8\uc774 \ubb38\uc11c "+ID_RES_CONST_STRING_VIEWING+"\uc5d0 \ub300\ud55c \uad8c\ud55c\uc744 \uc694\uccad\ud558\uc600\uc2b5\ub2c8\ub2e4.\r\n\r\n\r\n");c+="\u25a3 \ubb38\uc11c \uc81c\ubaa9 \u25a3\r\n";c+=b.doc_name+"\r\n\r\n";c+="\u25a3 \uad8c\ud55c \ud5c8\uc6a9 URL \ub9c1\ud06c \u25a3\r\n";return c+=onefficeGW.getDocumentShareOpenURL(onefficeUtil.getRequestParameter("seq"),onefficeUtil.getRequestParameter("groupseq"),e)+"\r\n\r\n"}catch(f){dalert(f)}},
requestOpenPermDialog:function(b){try{var a=null,c=null;cmnDlg.viewBasicDlg(null,0,"",onefficeCommon.getDocOpenInfo(!1),[ID_RES_CONST_STRING_REQUEST_PERMMISION],[function(b){a&&c&&(b=[],b.push(a.id),onefficeGW.sendNoteMessage(b,onefficeUtil.makeRequestMessage(a,c),c));duzon_dialog.closeDialog();onefficeUtil.requestConfirmDialog()}],function(){var d=document.getElementById("idx_dlg"),e=document.getElementsByClassName("duzon_dialog_buttonbox")[0];e.firstChild.style.display="none";e.innerHTML+=ID_RES_CONST_STRING_REQUEST_PERMMISION;
e.style.color="#148dda";e.style.backgroundColor="#dddee3";g_browserCHK.iPad||g_browserCHK.androidtablet?(e.style.fontSize="30px",e.style.padding="10px"):(d.style.transform="scale(1.3)",e.style.fontSize="36px",e.style.padding="25px");e.ontouchstart=function(a){this.style.backgroundColor="#bbb"};e.ontouchend=function(a){this.style.backgroundColor="#dddee3"};e.onclick=function(){if(a&&c){var b=[];b.push(a.id);onefficeGW.sendNoteMessage(b,onefficeUtil.makeRequestMessage(a,c),c)}duzon_dialog.closeDialog();
onefficeUtil.requestConfirmDialog()};document.getElementsByClassName("duzon_dialog_body_content")[0].style.padding="0";onefficeCommon.getSearchUserInfoList(CLOUD_CONST_SEARCH_USER_INFO_OPTION_DOC_SEQ,b,function(c){a=c;onefficeUtil.updateSimpleQRInfo(b,a)});onefficeCommon.getMyInfo(function(a){c=a},!1)},function(){},!0)}catch(d){dalert(d)}},requestConfirmDialog:function(){try{cmnDlg.viewBasicDlg(null,0,"",onefficeCommon.getDocRequestConfirm(),[ID_RES_DIALOG_BTN_OK],[function(b){duzon_dialog.closeDialog();
window.close()}],function(){var b=document.getElementById("idx_dlg"),a=document.getElementsByClassName("duzon_dialog_buttonbox")[0];a.firstChild.style.display="none";a.innerHTML+=ID_RES_DIALOG_BTN_OK;a.style.color="#148dda";a.style.backgroundColor="#dddee3";g_browserCHK.iPad||g_browserCHK.androidtablet?(a.style.fontSize="30px",a.style.padding="10px"):(b.style.transform="scale(1.3)",a.style.fontSize="36px",a.style.padding="25px");a.ontouchstart=function(a){this.style.backgroundColor="#bbb"};a.ontouchend=
function(a){this.style.backgroundColor="#dddee3"};a.onclick=function(){duzon_dialog.closeDialog();window.close()};document.getElementsByClassName("duzon_dialog_body_content")[0].style.padding="0"},function(){},!0)}catch(b){dalert(b)}},requestAllowWithMsg:function(b){try{cmnDlg.viewBasicDlg(null,0,"",onefficeCommon.getDocAllowMessage(b),[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog();g_browserCHK.mobile&&window.close()}],function(){var a=document.getElementById("idx_dlg"),b=document.getElementsByClassName("duzon_dialog_buttonbox")[0];
b.firstChild.style.display="none";b.innerHTML+=ID_RES_DIALOG_BTN_OK;b.style.color="#148dda";b.style.backgroundColor="#dddee3";g_browserCHK.iPad||g_browserCHK.androidtablet?(b.style.fontSize="30px",b.style.padding="10px"):(a.style.transform="scale(1.3)",b.style.fontSize="36px",b.style.padding="25px");b.ontouchstart=function(a){this.style.backgroundColor="#bbb"};b.ontouchend=function(a){this.style.backgroundColor="#dddee3"};b.onclick=function(){duzon_dialog.closeDialog();g_browserCHK.mobile&&window.close()};
document.getElementsByClassName("duzon_dialog_body_content")[0].style.padding="0"},function(){},!0)}catch(a){dalert(a)}},dialogCenterReposition:function(){try{var b=document.getElementById("idx_dlg"),a=0,c=0;g_objLayerKit.getLayerDocument().documentElement.scrollWidth?g_objLayerKit.getLayerWindow().innerHeight?(a=g_objLayerKit.getLayerWindow().innerWidth,c=g_objLayerKit.getLayerWindow().innerHeight):(a=g_objLayerKit.getLayerDocument().documentElement.clientWidth,c=g_objLayerKit.getLayerDocument().documentElement.clientHeight):
(a=g_objLayerKit.getLayerDocument().body.scrollWidth,c=g_objLayerKit.getLayerDocument().body.scrollHeight);b.style.top=(c-b.offsetHeight)/2+"px";b.style.left=(a-b.offsetWidth)/2+"px"}catch(d){dalert(d)}},updateOpenDataIndexedDB:function(b,a,c){try{if(null==oneffice_cloud_myInfoData&&0==onefficeCommon.bExceptionExit)onefficeCommon.getMyInfo(function(a){oneffice_cloud_myInfoData=a}),setTimeout(function(){onefficeUtil.updateOpenDataIndexedDB(b,a,c)},300);else if(window.indexedDB){var d=null,e=1==fnObjectCheckNull(c)?
-1:c,f=indexedDB.open("ONEFFICE_DB",1);f.onupgradeneeded=function(a){d=f.result;d.createObjectStore("open_doc_backup",{keyPath:"doc_no"})};f.onsuccess=function(c){d=f.result;c=d.transaction(["open_doc_backup"],"readwrite").objectStore("open_doc_backup");var h=onefficeUtil.getRequestParameter("ref");h=h&&0<=h.indexOf("viewback")?!0:!1;0>e&&0==oneffice.bBackupLoadedContent&&0==h&&(h=CryptoJS.MD5(a.content).toString(),h={doc_no:b+"|"+(new Date).getTime(),folder_no:a.folder_no,doc_name:a.doc_name,readonly:a.readonly,
important:a.important,content:a.content,openFileDate:a.openFileDate,openPath:a.openPath,update:duzon_http.getCurrTime(),id:oneffice_cloud_myInfoData.id,group_seq:oneffice_cloud_myInfoData.group_seq,checksum:h},h=CryptoJS.AES.encrypt(JSON.stringify(h),b),h={doc_no:b+"|"+(new Date).getTime(),enc_data:h.toString()},c.put(h));oneffice.backupContentList=[];var g=0;c.openCursor().onsuccess=function(a){if(a=a.target.result){if(a.key&&a.key.split("|")[0]==b){var c=duzon_http.parseJSON(CryptoJS.AES.decrypt(a.value.enc_data,
b).toString(CryptoJS.enc.Utf8));if(e==g){oneffice.tempContent=c;onefficeUtil.openBackupDoc(oneffice_cloud_currNEditNumber);return}var f=(new Date(duzon_http.getCurrTime())).getTime(),h=(new Date(c.update)).getTime();6048E5<f-h?a.delete():oneffice.backupContentList.push(c);g++}a.continue()}else{if(15<oneffice.backupContentList.length){a=d.transaction(["open_doc_backup"],"readwrite").objectStore("open_doc_backup").openCursor();var k=oneffice.backupContentList.length-15;a.onsuccess=function(a){if(a=
a.target.result)0<k&&(oneffice.backupContentList.shift(),a.delete(),k--),a.continue()}}0<=e&&onefficeUtil.openBackupDoc(oneffice_cloud_currNEditNumber)}}}}}catch(h){dalert(h)}},openBackupDoc:function(b){try{oneffice.bBackupLoadedContent=!0,onefficeUtil.openTempSavedContentAction(b)}catch(a){dalert(a)}},getOpenDataList:function(){try{return oneffice.backupContentList?oneffice.backupContentList:null}catch(b){dalert(b)}},getOpenDataByIndex:function(b){try{return oneffice.backupContentList&&oneffice.backupContentList.length>
b?oneffice.backupContentList[b]:null}catch(a){dalert(a)}},saveTempDataToLocalStorage:function(b,a,c){try{if("undefined"!=typeof localStorage&&"undefined"!=typeof JSON){var d="oneffice_"+b;"undefined"!==typeof c&&(d=c+"_"+b);a.update=duzon_http.getCurrTime();null!=oneffice_cloud_myInfoData?(a.id=oneffice_cloud_myInfoData.id,a.group_seq=oneffice_cloud_myInfoData.group_seq):(a.id="",a.group_seq="");a.checksum=CryptoJS.MD5(a.content).toString();var e=this.getTempDataFromLocalStorage(b,c);null!==e&&"undefined"!=
typeof e.checksum&&e.checksum==a.checksum||localStorage.setItem(d,CryptoJS.AES.encrypt(JSON.stringify(a),b))}}catch(f){dalert(f)}},removeTempDataFromLocalStorage:function(b,a){try{if("undefined"!=typeof localStorage){var c="oneffice_"+b;"undefined"!==typeof a&&(c=a+"_"+b);localStorage.removeItem(c)}}catch(d){dalert(d)}},removeAllTempDataFromLocalStorage:function(b){try{if("undefined"!=typeof localStorage){onefficeUtil.getTempSavedDocumentList(b);b=0;for(var a=oneffice.tempSavedContentList.length;b<
a;b++)localStorage.removeItem(oneffice.tempSavedContentList[b].key);return a}return 0}catch(c){return dalert(c),0}},getTempDataFromLocalStorage:function(b,a){try{var c=null;oneffice.tempContent=null;if("undefined"!=typeof localStorage){var d="oneffice_"+b;"undefined"!==typeof a&&(d=a+"_"+b);c=localStorage.getItem(d);null!=c&&(oneffice.tempContent=duzon_http.parseJSON(CryptoJS.AES.decrypt(c,b).toString(CryptoJS.enc.Utf8)))}return oneffice.tempContent}catch(e){return dalert(e),oneffice.tempContent=
null}},makeTempSavedContentNotiBar:function(b,a){try{if(null!=b&&"undefined"!=typeof oneffice.tempContent&&null!=oneffice.tempContent){var c=oneffice.tempContent.update;if(!0===oneffice.bTempLoadedContent)b.innerHTML=String.format(ID_RES_CONST_STRING_TEMP_SAVED_DOCUMENT_LOADED,c);else{b.innerHTML=String.format(ID_RES_CONST_STRING_CONFIRM_TEMP_SAVED_DOCUMENT_OPEN,c);b.innerHTML=b.innerHTML.replace(/(\[.+\])/,"<span style='color:#1c90fb;font-weight:bold;'>$1</span>");var d=document.createElement("span");
d.className="dze_btn_temp_saved_content_view_normal";d.style.marginLeft="20px";d.innerText=ID_RES_DIALOG_BTN_OK;d.onmouseover=function(){this.className="dze_btn_temp_saved_content_view_over"};d.onmouseout=function(){this.className="dze_btn_temp_saved_content_view_normal"};d.onmousedown=function(a){this.className="dze_btn_temp_saved_content_view_down";TBCancelBubbleEvent(a)};d.onmouseup=function(){this.className="dze_btn_temp_saved_content_view_over"};d.onclick=function(){onefficeUtil.openTempSavedContentAction(a)};
b.appendChild(d);var e=document.createElement("span");e.className="dze_btn_temp_saved_content_delete_normal";e.style.marginLeft="4px";e.innerText=ID_RES_CONST_BTN_DELETE;e.onmouseover=function(){this.className="dze_btn_temp_saved_content_delete_over"};e.onmouseout=function(){this.className="dze_btn_temp_saved_content_delete_normal"};e.onmousedown=function(a){this.className="dze_btn_temp_saved_content_delete_down";TBCancelBubbleEvent(a)};e.onmouseup=function(){this.className="dze_btn_temp_saved_content_delete_over"};
e.onclick=function(){onefficeUtil.deleteTempSavedContentAction(a)};b.appendChild(e)}resizeEditor_Height(a)}}catch(f){dalert(f)}},deleteTempSavedContentAction:function(b){try{cmnMsg.showMsg(MESSAGE_CONFIRM,ID_RES_CONST_STRING_CONFIRM_TEMP_SAVED_DOCUMENT_DELETE,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();onefficeUtil.removeTempDataFromLocalStorage(oneffice.currFileSeq);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_TEMP_SAVED_DOCUMENT_DELETED_COMPLETE,2);setTimeout(function(){document.location.reload()},
1E3)},function(){cmnMsg.hideMsg()})}catch(a){dalert(a)}},openTempSavedContentAction:function(b){try{duzon_http.showLoading(),oneffice.parentFileContent.content=oneffice.tempContent.content,oneffice.parentFileContent.subject=oneffice.tempContent.doc_name,g_objPageControl.documentContainerNode=null,oneffice.bTempLoadedContent=!0,onefficeUtil.onLoadFileContent(oneffice.parentFileContent,b),duzon_http.hideLoading(),dze_menu_control.activateMenu(dze_menu_control.idxTempSaveMenu,b)}catch(a){dalert(a)}},
setBackupDocUiConfig:function(){try{dzeUiConfig.ribbon_menu_list_main[dze_menu_control.idxTempSaveMenu].pop(),dzeUiConfig.ribbon_menu_list_main[dze_menu_control.idxTempSaveMenu].pop(),dzeUiConfig.ribbon_menu_list_main[dze_menu_control.idxTempSaveMenu].push([ID_COMMAND_GOBACK_ORG_DOC,1],[-2])}catch(b){dalert(b)}},getOverwriteTempDocToOrgDocDialogContent:function(){try{var b="";b+="<div class='duzon_dialog_content_medium' style='width: 368px;'>";b+="\t<div class='duzon_dialog_org_document_title'>"+
ID_RES_CONST_STRING_ORG_DOCUMENT_INFO+"</div>";b+="\t<div id='dze_idx_org_document_info_box' class='duzon_dialog_org_document_info_box'>";b+="\t\t<div class='duzon_dialog_org_document_info_box_txt1'>"+ID_RES_CONST_STRING_DOCUMENT_LAST_UPDATE+"</div><div class='duzon_dialog_org_document_info_box_txt2' id='dze_idx_org_document_update'></div>";b+="\t\t<div class='duzon_dialog_org_document_info_box_txt_space'></div>";b+="\t\t<div class='duzon_dialog_org_document_info_box_txt1'>"+ID_RES_CONST_STRING_DOCUMENT_WRITER+
"</div><div class='duzon_dialog_org_document_info_box_txt2' id='dze_idx_org_document_owener'></div>";b+="\t</div>";b+="\t<div id='dze_idx_org_document_info_desc' class='duzon_dialog_org_document_info_desc'>"+ID_RES_CONST_STRING_CONFIRM_TEMP_SAVED_DOCUMENT_OVERWRITE+"</div>";return b+"</div>"}catch(a){dalert(a)}},setOrgDocumentInfo:function(){try{var b=null,a=null;onefficeGW.getDocumentHistory(oneffice.currFileSeq,function(c){if(0==c.length)duzon_dialog.closeDialog(),cmnMsg.showMsg(MESSAGE_ERROR,ID_RES_CONST_STRING_SERVER_ERROR_CONTENT,
null,[ID_RES_ADJUST_VIEW_CLOSE],function(){cmnMsg.hideMsg()},null,!0);else{for(var d=0;d<c.length;d++)if("0"==c[d].action_code||"2"==c[d].action_code){b=c[d].action_user_name;a="object"===typeof c[d].reg_date?getFullDateFromTimeStamp(c[d].reg_date.time):c[d].reg_date;break}null==b?(duzon_dialog.closeDialog(),cmnMsg.showMsg(MESSAGE_ERROR,ID_RES_CONST_STRING_SERVER_ERROR_CONTENT,null,[ID_RES_ADJUST_VIEW_CLOSE],function(){cmnMsg.hideMsg()},null,!0)):(dzeJ("#dze_idx_org_document_update").html(a),dzeJ("#dze_idx_org_document_owener").html(b))}},
!0,function(){duzon_dialog.closeDialog();cmnMsg.showMsg(MESSAGE_ERROR,ID_RES_CONST_STRING_SERVER_ERROR_CONTENT,null,[ID_RES_ADJUST_VIEW_CLOSE],function(){cmnMsg.hideMsg()},null,!0)})}catch(c){dalert(c)}},saveTempLoadedDocToOrgDoc:function(b){try{if("1"==oneffice.parentFileContent.readonly)cmnMsg.showMsg(MESSAGE_ERROR,ID_RES_CONST_STRING_ALERT_OVERWRITE_FAIL_READONLY_ATTR_DOCUMENT,null,[ID_RES_ADJUST_VIEW_CLOSE],function(){cmnMsg.hideMsg()});else{g_readonlyMode=!1;var a=getEditorHTMLCode(!1,b,!0);
onefficeGW.saveFile(oneffice.currFileSeq,oneffice.currFolderSeq,oneffice.currFileSubject,a,b,function(){onefficeUtil.removeTempDataFromLocalStorage(oneffice.currFileSeq);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_OVERWRITE_ORG_DOC_COMPLETE,2);setTimeout(function(){if(1==oneffice.bBackupLoadedContent){var a=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(oneffice.currFileSeq,"","");document.location=a}else document.location.reload()},1E3)},!0,function(){g_readonlyMode=!0;cmnMsg.showMsg(MESSAGE_ERROR,
ID_RES_CONST_STRING_SERVER_ERROR_CONTENT,null,[ID_RES_ADJUST_VIEW_CLOSE],function(){cmnMsg.hideMsg()},null,!0)})}}catch(c){g_readonlyMode=!0,dalert(c)}},loadTempSavedDocumentsInfo:function(){try{if(!0!==g_browserCHK.mobile&&!0===dzeUiConfig.bTempSavedDocRecovery){var b=oneffice.tempSavedContentList.length;this.getTempSavedDocumentList();if(b!=oneffice.tempSavedContentList.length)if(0<oneffice.tempSavedContentList.length){var a=$_("dze_idx_temp_documents_info_container");if(null==a){a=document.createElement("div");
a.id="dze_idx_temp_documents_info_container";a.className="temp_documents_info_container";dzeJ("#dze_idx_browser_left_container").append(a);var c=document.createElement("div");c.className="temp_documents_info_string";c.innerHTML=ID_RES_CONST_STRING_TEMP_SAVED_DOCUMENTS;var d=document.createElement("div");d.className="temp_documents_info_count";d.innerHTML="<span class='temp_documents_info_count_string'>"+oneffice.tempSavedContentList.length+"</span>\uac1c";dzeJ(a).append(c);dzeJ(a).append(d);dzeJ(a).fadeIn("slow");
dzeJ(a).mouseover(function(){dzeJ(this).attr("class","temp_documents_info_container_over")});dzeJ(a).mousedown(function(){dzeJ(this).attr("class","temp_documents_info_container_down")});dzeJ(a).mouseup(function(){dzeJ(this).attr("class","temp_documents_info_container_over")});dzeJ(a).mouseout(function(){dzeJ(this).attr("class","temp_documents_info_container")});dzeJ(a).click(function(){onefficeUtil.showTempSavedDocumentListInfo()});cmnMsg.showMsg(MESSAGE_CONFIRM,ID_RES_CONST_STRING_CONFIRM_TEMP_SAVED_DOCUMENT_LIST_OPEN,
null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();onefficeUtil.showTempSavedDocumentListInfo()},function(){cmnMsg.hideMsg()},function(){cmnMsg.hideMsg()})}else dzeJ(".temp_documents_info_count_string").html(oneffice.tempSavedContentList.length)}else(a=$_("dze_idx_temp_documents_info_container"))&&a.parentNode.removeChild(a)}}catch(e){dalert(e)}},getTempSavedDocumentList:function(b){try{oneffice.tempSavedContentList=[];"undefined"==typeof b&&(b="oneffice");b+="_";var a=
b.length;if("undefined"!=typeof localStorage&&null!=oneffice_cloud_myInfoData)for(var c="",d=[],e=0,f=localStorage.length;e<f;e++)if((c=localStorage.key(e))&&c.substring(0,a)==b){var h=localStorage.getItem(c),k=c.split("_")[1];try{d=duzon_http.parseJSON(CryptoJS.AES.decrypt(h,k).toString(CryptoJS.enc.Utf8))}catch(g){onefficeUtil.removeTempDataFromLocalStorage(k);e--;continue}d&&d.id==oneffice_cloud_myInfoData.id&&d.group_seq==oneffice_cloud_myInfoData.group_seq&&oneffice.tempSavedContentList.push({key:c,
doc_no:d.doc_no,doc_name:d.doc_name,update:d.update})}}catch(g){oneffice.tempSavedContentList=[],dalert(g)}},showTempSavedDocumentListInfo:function(){try{cmnDlg.viewBasicDlg(null,oneffice_cloud_currNEditNumber,ID_RES_CONST_STRING_TEMP_SAVED_DOC_BOX,onefficeUtil.getTempSavedDocumentListInfoDialogContent(),[ID_RES_ADJUST_VIEW_CLOSE],[function(b){duzon_dialog.closeDialog()}],function(){dzeJ(".duzon_dialog_body_content").css("background-color","#efefef");onefficeUtil.showTempSavedDocumentListData();onefficeUtil.addEventDeleteAllBtn()},
function(){})}catch(b){return dalert(b),[]}},getTempSavedDocumentListInfoDialogContent:function(){try{var b="";b+="<div class='duzon_dialog_content_medium' style='width:520px'>";b+="\t<div style='height: 30px;margin-bottom: 5px;'>";b+="\t<div class='duzon_dialog_org_document_title' style='float:left'>"+String.format(ID_RES_CONST_STRING_TEMP_SAVED_DOCUMENT_NUM_STRING,"<span class='temp_documents_info_count_string'>"+oneffice.tempSavedContentList.length+"</span>")+"</div>";b+="\t<div class='duzon_dialog_org_document_delete_all' style='float:right'>"+
ID_RES_CONST_STRING_DELETE_ALL_DOC+"</div>";b+="\t</div>";return b+"\t<div id='dze_idx_org_document_list_info_box' class='duzon_dialog_org_document_list_info_box'></div></div>"}catch(a){dalert(a)}},showTempSavedDocumentListData:function(){try{if(0!=oneffice.tempSavedContentList.length)for(var b=null,a=null,c=null,d=null,e=0,f=oneffice.tempSavedContentList.length;e<f;e++)b=document.createElement("div"),b.className="temp_doc_list_unit_container",a=document.createElement("div"),a.innerHTML=oneffice.tempSavedContentList[e].doc_name,
a.className="temp_doc_list_unit_subject",c=document.createElement("div"),c.innerHTML=oneffice.tempSavedContentList[e].update,c.className="temp_doc_list_unit_date",d=document.createElement("div"),d.innerHTML="",d.className="temp_doc_list_unit_trash_button_blank",d.title=ID_RES_CONST_BTN_DELETE,dzeJ(b).append(a),dzeJ(b).append(c),dzeJ(b).append(d),function(){var a=oneffice.tempSavedContentList[e].doc_no,c=b;c.ondblclick=function(){duzon_dialog.closeDialog();var b=dzeEnvConfig.strPath_Dir+oneffice.getEditModeDocPath(a,
"","tempdoc");window.open().location=b};d.onclick=function(b){cmnMsg.showMsg(MESSAGE_CONFIRM,ID_RES_CONST_STRING_CONFIRM_TEMP_SAVED_DOCUMENT_DELETE,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){cmnMsg.hideMsg();onefficeUtil.removeTempDataFromLocalStorage(a);cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_TEMP_SAVED_DOCUMENT_DELETED_COMPLETE,2);c.parentNode.removeChild(c);0==$_("dze_idx_org_document_list_info_box").childNodes.length&&duzon_dialog.closeDialog();onefficeUtil.loadTempSavedDocumentsInfo()},
function(){cmnMsg.hideMsg()});TBCancelBubbleEvent(b)};d.onmouseover=function(a){this.className="temp_doc_list_unit_trash_button_over";TBCancelBubbleEvent(a)};d.onmouseout=function(a){this.className="temp_doc_list_unit_trash_button";TBCancelBubbleEvent(a)};d.onmousedown=function(a){this.className="temp_doc_list_unit_trash_button_down";TBCancelBubbleEvent(a)};d.onmouseup=function(a){this.className="temp_doc_list_unit_trash_button_over";TBCancelBubbleEvent(a)}}(),b.onmouseenter=function(){dzeJ(this).children(".temp_doc_list_unit_trash_button_blank").attr("class",
"temp_doc_list_unit_trash_button")},b.onmouseleave=function(){dzeJ(this).children(".temp_doc_list_unit_trash_button").attr("class","temp_doc_list_unit_trash_button_blank")},dzeJ("#dze_idx_org_document_list_info_box").append(b)}catch(h){dalert(h)}},addEventDeleteAllBtn:function(){try{dzeJ(".duzon_dialog_org_document_delete_all").mouseover(function(){dzeJ(this).attr("class","duzon_dialog_org_document_delete_all_over")}),dzeJ(".duzon_dialog_org_document_delete_all").mousedown(function(){dzeJ(this).attr("class",
"duzon_dialog_org_document_delete_all_down")}),dzeJ(".duzon_dialog_org_document_delete_all").mouseup(function(){dzeJ(this).attr("class","duzon_dialog_org_document_delete_all_over")}),dzeJ(".duzon_dialog_org_document_delete_all").mouseout(function(){dzeJ(this).attr("class","duzon_dialog_org_document_delete_all")}),dzeJ(".duzon_dialog_org_document_delete_all").click(function(){cmnMsg.showMsg(MESSAGE_CONFIRM,ID_RES_CONST_STRING_CONFIRM_TEMP_SAVED_ALL_DOCUMENT_DELETE,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
function(){cmnMsg.hideMsg();onefficeUtil.removeAllTempDataFromLocalStorage();cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_TEMP_SAVED_ALL_DOCUMENT_DELETED_COMPLETE,2);duzon_dialog.closeDialog();onefficeUtil.loadTempSavedDocumentsInfo()},function(){cmnMsg.hideMsg()},function(){cmnMsg.hideMsg()})})}catch(b){dalert(b)}},callbackRequestManager:function(b){0<b.length&&(""===b[0].requestID||""===b[0].request_name?dlog("\uac80\uc0c9\ub41c \uacb0\uacfc\uac00 \uc5c6\ub2e4."):void 0!==b[0].request_id&&
(clearInterval(oneffice.requestManagerSearchInterval),oneffice.requestManagerSearchInterval=void 0,arrSenderInfo=[b[0].pic,b[0].name+" "+b[0].duty_name],callAuthReqeustAnswer(USER_WRITE_AUTH.REQUEST_FROM,arrSenderInfo,b[0].editor_id,b[0].request_id)))},callbackResponseManager:function(b){"9"===b?(viewAuthResponse(USER_WRITE_AUTH.RESPONSE_DENY),clearInterval(oneffice.responseReqInterval),oneffice.responseReqInterval=void 0,onefficeGW.updateReqAnswerAccessManager(oneffice.parentFileContent.seq,"","",
ACCESS_MANAGER_RESOPONSE_VALUE.INIT),!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO)):"1"===b?(viewAuthResponse(USER_WRITE_AUTH.RESPOSNE_SUCCESS),clearInterval(oneffice.responseReqInterval),oneffice.responseReqInterval=void 0,onefficeGW.updateReqAnswerAccessManager(oneffice.parentFileContent.seq,"","",ACCESS_MANAGER_RESOPONSE_VALUE.INIT),fnCommandEditorMode(g_nActiveEditNumber,0),fnHandler_onefficeFileReload(g_nActiveEditNumber),
oneffice.accessmanagerUserInfos=[],onefficeUtil.searchAccessManagerConnectInterval(),!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO)):null===b&&(viewAuthResponse(USER_WRITE_AUTH.RESPONSE_EDITOR_OUT),clearInterval(oneffice.responseReqInterval),oneffice.responseReqInterval=void 0,!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO))},searchRequestInterval:function(){!1===
objOnefficeLoader.m_bAccessManager?dlog("AcessManager \uae30\ub2a5\uc740 \ub3d9\uc791\ud558\uc9c0 \uc54a\ub294\ub2e4."):oneffice.requestManagerSearchInterval?dlog("\uc774\ubbf8 Timer\uac00 \ub3d9\uc791 \uc911 searchAccessManagerConnectInterval"):oneffice.requestManagerSearchInterval=setInterval(function(){dlog("searchRequestInterval \ud3b8\uc9d1 \uad8c\ud55c \uc694\uccad\ud55c \uc0ac\ub78c \uc5ec\ubd80 Timer ");onefficeGW.searchRequestManager(oneffice.parentFileContent.seq,oneffice.parentFileContent.my_id,
onefficeUtil.callbackRequestManager)},DZE_ACCESS_MANAGER_SEARCH_REQUEST_USER)},searchResponseInterval:function(b){!1===objOnefficeLoader.m_bAccessManager?dlog("AcessManager \uae30\ub2a5\uc740 \ub3d9\uc791\ud558\uc9c0 \uc54a\ub294\ub2e4."):0===b||9999===b?(0===b?viewAuthResponse(USER_WRITE_AUTH.RESPONSE_DUPL):viewAuthResponse(USER_WRITE_AUTH.RESPONSE_EDITOR_OUT),!0===panelManager.getInstance().isShowDocOpenPanelInfo()&&panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO)):oneffice.responseReqInterval?
dlog("\uc774\ubbf8 Timer\uac00 \ub3d9\uc791 \uc911 responseReqInterval"):oneffice.responseReqInterval=setInterval(function(){dlog("searchResponseInterval \uc694\uccad\ud55c \uacb0\uacfc\uac12 \uc751\ub2f5 \ub300\uae30 Timer ");onefficeGW.searchAMResponseAnswer(oneffice.parentFileContent.seq,oneffice.parentFileContent.my_id,onefficeUtil.callbackResponseManager)},DZE_ACCESS_MANAGER_SEARCH_RESPONSE_ANSWER_TIME)},permissionChangeResult:function(){onefficeGW.getShareInfo(oneffice.currFileSeq,function(b){if(0==
fnObjectCheckNull(b)){var a=!0;console.dir(b);if(0<b.length)for(var c=0;c<b.length;c++){var d=b[c];d.share_id!==oneffice.parentFileContent.my_id&&"1"!=d.share_type&&"9"!=d.share_type||"W"!==d.share_perm||(a=!1)}dalert("Permission bChangeFind = "+a)}})},searchAccessManagerConnectInterval:function(){!1===objOnefficeLoader.m_bAccessManager?dlog("AcessManager \uae30\ub2a5\uc740 \ub3d9\uc791\ud558\uc9c0 \uc54a\ub294\ub2e4."):oneffice.accessManagerSearchInterval?dlog("\uc774\ubbf8 Timer\uac00 \ub3d9\uc791 \uc911 searchAccessManagerConnectInterval"):
oneffice.accessManagerSearchInterval=setInterval(function(){dlog("searchAccessManagerConnectInterval \ud3b8\uc9d1\uad8c\ud55c \uc774\uad00 \uc5f4\ub78c\uc790 \ub300\uae30 \ubaa8\ub4dc \uc0c1\ud0dc Timer ");onefficeCommon.getDocumentAccessInfo(oneffice.currFileSeq,function(b){var a=!1;if(!1===oneffice.editUseWorkEnd&&oneffice.parentFileContent.owner_id!==oneffice.parentFileContent.my_id){0===b.length&&onefficeUtil.permissionChangeResult();for(var c=0,d;d=b[c];c++)oneffice.parentFileContent.my_id!==
d.access_id||oneffice.parentFileContent.share_perm===d.access_perm||"R"!==d.access_perm&&"NONE"!==d.access_perm||onefficeUtil.permissionChangeResult()}if(void 0!==b&&null!==b){b.length<oneffice.accessmanagerUserInfos.length&&(oneffice.accessmanagerUserInfos=[]);for(c=0;d=b[c];c++)-1===oneffice.accessmanagerUserInfos.indexOf(d.name)&&(oneffice.accessmanagerUserInfos.push(d.name),a=!0);!0===a&&(1<b.length&&void 0===oneffice.requestManagerSearchInterval&&onefficeUtil.searchRequestInterval(),panelManager.getInstance().isShowDocOpenPanelInfo()&&
panelManager.getInstance().updatePanel(PANEL_MAIN_TYPE.DOC_OPEN_INFO))}},!1)},DZE_ACCESS_MANAGER_SEARCH_CONNECTOR)},openDocComment:function(){try{if(!0===g_browserCHK.mobile){var b=!1,a=!1,c=!1,d=!1,e=[],f=[],h="",k=0;if("undefined"!=typeof onefficeComment.getUserList){onefficeComment.getUserList(!0).then(function(a){e=a;b=!0});onefficeComment.getUserList(!1).then(function(b){f=b;a=!0});onefficeComment.getEventData(oneffice.currFileSeq,oneffice.onefficeGroupSeq,function(a){h=a;c=!0});onefficeComment.getCounts(function(a){k=
a;d=!0});var g=!1,l=setInterval(function(){if(!0===b&&!0===a&&!0===c&&!0===d&&(clearInterval(l),!1===g)){g=!0;var m={commentUseYn:"Y",mentionEmpList:null!==e?e:[],event:{},commentCnt:k,attachYn:"N"};m.event={alertYn:"Y",pushYn:"Y",talkYn:"Y",mailYn:"Y",smsYn:"Y",portalYn:"Y",timelineYn:"Y",recvEmpBulkList:[],recvEmpBulk:"",recvEmpList:null!==f?"sameAlpha"===f?e:f:[],recvMentionEmpList:[],moduleSeq:oneffice.currFileSeq,eventType:"ONEFFICE",eventSubType:"ONE001",data:h,url:""};onefficeUtil.sendCommentStatus(Base64.encode(JSON.stringify(m)))}},
1);setTimeout(function(){!1===g&&(clearInterval(l),g=!0,onefficeUtil.sendCommentStatus(0))},3E4)}}else panelManager.getInstance().showPanel(PANEL_MAIN_TYPE.DOC_COMMENT)}catch(m){dalert(m)}},sendCommentStatus:function(b){try{var a=!0===isNaN(b)?"app://onefficeCommonCmt/"+b:"app://onefficeCmtLoadDisplay/"+b;if(g_browserCHK.iOS){var c=document.createElement("a");c.href=a;c.click()}else document.location.href=a}catch(d){dalert(d)}},getDocFormContent:function(b){var a=void 0;0<=b.indexOf("file_docform_day_report.js")||
0<=b.indexOf("file_docform_day_report_army.js")?a=day_report:0<=b.indexOf("file_docform_day_report_1.js")?a=day_report_1:0<=b.indexOf("file_docform_day_2_report.js")?a=day2_report:0<=b.indexOf("file_docform_day_report_corona.js")?a=day_report_corona:0<=b.indexOf("file_docform_day_report_corona1.js")?a=day_report_corona1:0<=b.indexOf("file_docform_time_report.js")?a=time_report:0<=b.indexOf("file_docform_week_report.js")||0<=b.indexOf("file_docform_week_report_army.js")?a=week_report:0<=b.indexOf("file_docform_meeting_report.js")||
0<=b.indexOf("file_docform_meeting_report_army.js")?a=meeting_report:0<=b.indexOf("file_docform_improve_report.js")?a=improve_report:0<=b.indexOf("file_docform_issue_report.js")?a=issue_report:0<=b.indexOf("file_docform_buss_report.js")?a=buss_report:0<=b.indexOf("file_docform_service_report.js")?a=service_report:0<=b.indexOf("file_docform_adjust_method_report.js")?a=adjust_method_report:0<=b.indexOf("file_docform_basic_report.js")?a=basic_report:0<=b.indexOf("file_docform_general_report.js")?a=general_report:
0<=b.indexOf("file_docform_event_plan_report.js")?a=event_plan_report:0<=b.indexOf("file_docform_tax_notice_report.js")?a=tax_notice_report:0<=b.indexOf("file_docform_tax_net_report.js")?a=tax_net_report:0<=b.indexOf("file_docform_analyze_plan_report.js")?a=analyze_report:0<=b.indexOf("file_docform_tax_saving_report.js")?a=saveing_report:0<=b.indexOf("file_docform_dev_report.js")?a=dev_report:0<=b.indexOf("file_docform_current_status_report.js")?a=current_status_report:0<=b.indexOf("file_docform_news_bizwatch.js")?
a=news_bizwatch:0<=b.indexOf("file_docform_notice_army.js")?a=notice_army:0<=b.indexOf("file_docform_press_release_army.js")?a=press_release_army:dalert("No content");return a},bCheckLanguage:!1,checkLanguage:function(b){function a(a){switch(a){case "kr":case "ko":case "ko-kr":a="ko";break;case "jp":case "ja":a="ja";break;case "cn":case "zh-cn":a="zh-cn";break;case "en":a="en";break;default:return""}return a}function c(a){switch(a){case "kr":case "ko":case "ko-kr":a=ID_RES_STRING_LANGUAGE_KO;break;
case "jp":case "ja":a=ID_RES_STRING_LANGUAGE_JA;break;case "cn":case "zh-cn":a=ID_RES_STRING_LANGUAGE_CN;break;case "en":a=ID_RES_STRING_LANGUAGE_EN;break;default:return""}return a}try{if(!0!==this.bCheckLanguage&&"undefined"!=typeof localStorage){this.bCheckLanguage=!0;var d=a(b);if(d){var e=navigator.userLanguage||navigator.language||"";e=e.toLowerCase();e=a(e);b="";"undefined"!==typeof localStorage&&(b=localStorage.getItem("onefficeLanguage")||"");if(d!==(b||e)){localStorage.setItem("onefficeLanguage",
d);var f=String.format(ID_RES_STRING_ALERT_CHANGE_LANGUAGE,c(d));cmnMsg.showMsg("alert",f,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg();setTimeout(function(){document.location.reload()},100)})}else d&&d===e&&d===b&&localStorage.removeItem("onefficeLanguage")}}}catch(h){dalert(h)}}};
