var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,a,c){b instanceof String&&(b=String(b));for(var d=b.length,f=0;f<d;f++){var e=b[f];if(a.call(c,e,f,b))return{i:f,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var f=b[d];f in c||(c[f]={});c=c[f]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");
function setInitialize(){try{!1===oneffice.m_bUserAgreement?onefficeUtil.checkUserAgreement(setInitialize):(!1===objOnefficeLoader.m_bDomainDuzon?dzeJ("#dze_idx_oneffice_bi").attr("src","./image/cloud/oneffice_bi_beta.png"):dzeJ("#dze_idx_oneffice_bi").attr("src","./image/cloud/oneffice_bi.png"),oneffice.setListViewMgr(),setUserInfoEventHandler(function(){!0!==g_browserCHK.mobile&&!0===dzeUiConfig.bTempSavedDocRecovery&&setTimeout(function(){onefficeUtil.loadTempSavedDocumentsInfo()},2E3)}),changeLanguage(),
initNewDocBtn(),makeSearchDefaultUI(),makeCloudBrowser(),makeFolderInfoInit(),setResizeEventHandler(),initSearchEventStatus(),(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)&&setScrollEventHandler(),onefficeCommon.accessUserFunction("visit"),oneffice.getListViewMgr().createTemplateThumbnailView(CLOUD_CONST_BROWSER_MODE_TEMPLATE,docformHomeTemplate),dzeJ("#drive_thumbnailItemPanel, #dze_idx_filelist, #dze_idx_search_list_container, #dze_idx_filelist_search").mousedown(function(b){if("drive_thumbnailItemPanel"===
b.target.id||"dze_idx_filelist"===b.target.id||"dze_idx_filelist_search"===b.target.id||"dze_idx_search_list_container"===b.target.id)firstShiftBtn=lastSelectBtn=null,oneffice.getListViewMgr().resetCheckListFunc()}),setTimeout(function(){changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_RECENT);selectBrowserFolderItem("",!0);dzeJ("#dze_idx_new_template_more_btn").on("click",function(b){b=document.getElementById("dze_idx_top_panel");var a=!0;b&&"100%"===b.style.height&&(a=!1);updateTemplateListSize(a)});
objOnefficeLoader.getAppEnvType()!==APPENV.GW?dzeUiConfig.bUseChgOwn=!1:loadChgOwn(!0);check1Day()&&0==g_browserCHK.mobile&&0==g_bBrowserType_CR&&showCompatibilityGuide()},200))}catch(b){dalert(b)}}
function changeLanguage(){try{var b=document.getElementById("dze_idx_cloud_search_input");b&&(b.placeholder=ID_RES_STRING_TOTAL_SEARCH);var a=document.getElementById("dze_idx_new_template_more_btn_text");a&&(a.innerText=ID_RED_CONST_STRING_VIEW_MORE+" ");var c=document.getElementById("dze_idx_filelist_search_select_period_text");c&&(c.textContent=ID_RES_CONST_STRING_SEARCH_PERIOD_OPTION_ALL);var d=document.getElementById("dze_idx_filelist_search_select_type_text");d&&(d.textContent=ID_RES_CONST_STRING_SEARCH_TYPE_OPTION_SUBJECT);
var f=document.getElementById("dze_idx_filelist_search_input_text");f&&(f.placeholder=ID_RES_CONST_STRING_INPUT_SEARCH_KEYWORD);var e=document.getElementById("dze_idx_template_text");e&&(e.textContent=ID_RES_STRING_TITLE_TEMPLATE)}catch(g){dalert(g)}}
function initNewDocBtn(){try{var b=dzeJ("div.cloud_create_new_item_txt"),a=b.find("#cloud_plus_txt").html("+");g_bBrowserType_IE&&a.css("margin-top","0px");b.find("#newItemTxt").html(ID_RES_CONST_STRING_FILE_NEW);b.click(function(a){executeCloudCommand(a,CLOUD_CMD_CREATE_FILE)})}catch(c){dalert(c)}}function getCheckCloudRightButtonEvent(b){try{var a=!1,c=b?b:window.event;"which"in c?a=3===b.which:"button"in c&&(a=2===b.button);return a}catch(d){dalert(d)}}
function getCloudResizeStatus(){return oneffice_cloud_resize_status_flag}function setCloudResizeStatus(b){try{oneffice_cloud_resize_status_flag=b}catch(a){dalert(a)}}
function setResizeEventHandler(){try{window.attachEvent?(document.attachEvent("mouseup",cloud_document_onmouseup),document.attachEvent("mousemove",cloud_document_onmousemove),document.attachEvent("click",cloud_document_onmouseclick),window.attachEvent("onresize",cloud_window_onresize)):(document.addEventListener("mouseup",cloud_document_onmouseup),document.addEventListener("mousemove",cloud_document_onmousemove),document.addEventListener("click",cloud_document_onmouseclick),window.addEventListener("resize",
cloud_window_onresize))}catch(b){dalert(b)}}
function setTemplateScrollEventHandler(){try{var b=document.getElementById("dze_idx_cloud_template_list_panel"),a=document.getElementById.bind(document)("dze_idx_cloud_template_scrollbar");parseInt(b.clientHeight)===parseInt(b.scrollHeight)?(a.style.opacity=0,a.style.display="none"):(a.style.display="",a.style.left=parseInt(b.offsetLeft+b.clientWidth)-12+"px",a.style.height=b.clientHeight/b.scrollHeight*b.clientHeight+"px",a.style.top=b.scrollTop/b.scrollHeight*b.clientHeight+b.offsetTop+"px",a.style.opacity=
1,b.addEventListener("scroll",function(){var c=b.offsetTop;a.style.left=parseInt(b.offsetLeft+b.clientWidth)-12+"px";a.style.height=b.clientHeight/b.scrollHeight*b.clientHeight+"px";a.style.top=c;a.style.top=b.scrollTop/b.scrollHeight*b.clientHeight+c+"px"}),a.onmouseover=function(){this.style.opacity=1;nCloudBrowserScrollTimer&&clearTimeout(nCloudBrowserScrollTimer)},a.onmouseleave=function(){nCloudBrowserScrollTimer=setTimeout(function(){setScrollOut(a)},500)},a.onmousedown=function(){bCloudBrowserScrollDown=
!0;nCloudBrowserMouseOffY=event.y},a.onmouseup=function(){bCloudBrowserScrollDown=!1},a.onmousemove=function(a){bCloudBrowserScrollDown&&a.preventDefault(a)})}catch(c){dalert(c)}}
function setScrollEventHandler(){try{var b=document.getElementById("dze_idx_filelist"),a="block"==b.style.display||""==b.style.display?"dze_idx_filelist":"drive_thumbnailItemPanel",c=document.getElementById.bind(document),d=c(a),f=c(a),e=c("dze_idx_filelist_scrollbar");dzeJ("#dze_idx_filelist, #drive_thumbnailItemPanel").off("mousewheel DOMMouseScroll").on("mousewheel DOMMouseScroll",function(a){fullScreenWheelEvent(a.originalEvent)});f.addEventListener("scroll",function(){onChangeScrollPosition(d,
f,e,0)});e.onmouseover=function(){this.style.opacity=1;nCloudBrowserScrollTimer&&clearTimeout(nCloudBrowserScrollTimer)};e.onmouseleave=function(){nCloudBrowserScrollTimer=setTimeout(function(){setScrollOut(e)},500)};e.onmousedown=function(){bCloudBrowserScrollDown=!0;nCloudBrowserMouseOffY=event.y};e.onmouseup=function(){bCloudBrowserScrollDown=!1};e.onmousemove=function(a){bCloudBrowserScrollDown&&(a.preventDefault(a),onMoveHorizScrollPosition(a))}}catch(g){dalert(g)}}
function setSearchScrollEventHandler(){try{switch(oneffice_cloud_search_more_index){case 1:var b="dze_idx_search_myoneffice_list";break;case 2:b="dze_idx_search_shareout_list";break;case 3:b="dze_idx_search_sharein_list";break;default:b="dze_idx_search_list_container"}var a=document.getElementById.bind(document),c=a(b),d=a(b),f=a("dze_idx_search_filelist_scrollbar");d.addEventListener("scroll",function(){onChangeScrollPosition(c,d,f,2)});f.onmouseover=function(){this.style.opacity=1;nCloudBrowserScrollTimer&&
clearTimeout(nCloudBrowserScrollTimer)};f.onmouseleave=function(){nCloudBrowserScrollTimer=setTimeout(function(){setScrollOut(f)},500)};f.onmousedown=function(a){bCloudBrowserScrollDown=!0;nCloudBrowserMouseOffY=a.y};f.onmouseup=function(){bCloudBrowserScrollDown=!1};f.onmousemove=function(a){bCloudBrowserScrollDown&&(a.preventDefault(a),onMoveHorizScrollPosition(a))}}catch(e){dalert(e)}}
function showLnbScroll(b){var a=0;!0===b&&(a=1);$_("dze_idx_folderlist_v_scrollbar").style.opacity=a;$_("dze_idx_folderlist_scrollbar").style.opacity=a}
function setCloudFolderScrollEventHandler(){try{var b=document.getElementById.bind(document),a=b("cloud_browser_list_folder_container"),c=b("dze_idx_folderlist_scrollbar"),d=b("dze_idx_folderlist_v_scrollbar");a.addEventListener("scroll",function(){onChangeScrollPosition(a,a,c,1)});c.onmousedown=function(a){bCloudBrowserFolderScrollDown=!0;bCloudBrowserFolderVScrollDown=!1;nCloudBrowserFolderMouseOffY=eval.y};a.addEventListener("scroll",function(){onChangeScrollPosition(a,a,d,3)});d.onmousedown=function(a){bCloudBrowserFolderVScrollDown=
!0;bCloudBrowserFolderScrollDown=!1;nCloudBrowserFolderMouseOffX=a.x};a.onmouseenter=function(){showLnbScroll(!0)};a.onmouseleave=function(){bCloudBrowserFolderVScrollDown||bCloudBrowserFolderScrollDown||(showLnbScroll(!1),bCloudBrowserFolderVScrollDown=bCloudBrowserFolderScrollDown=!1)}}catch(f){dalert(f)}}
function onGetAccessUserFunctionInfo(){try{onefficeCommon.getAccessUserFunctionInfo(function(b){for(var a="",c=0;c<b.length;c++)a+=b[c].actionCmd+" = "+b[c].totalCount+"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";cmnDlg.viewBasicDlg(null,0,"\ud604\ud669",a,[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!1)})}catch(b){dalert(b)}}
function onMoveHorizScrollPosition(b){try{var a=0;if(bCloudBrowserFolderScrollDown){var c=$_("cloud_browser_list_folder_container"),d=$_("dze_idx_folderlist_scrollbar");a=b.y-nCloudBrowserFolderMouseOffY;nCloudBrowserFolderMouseOffY=b.y}else{var f=document.getElementById("dze_idx_filelist");c=$_("block"==f.style.display||""==f.style.display?"dze_idx_filelist":"drive_thumbnailItemPanel");d=$_("dze_idx_filelist_scrollbar");a=b.y-nCloudBrowserMouseOffY;nCloudBrowserMouseOffY=b.y}d.style.top=parseInt(d.style.top)+
a;c.scrollTop=parseInt(c.scrollTop)+c.scrollHeight/c.offsetHeight*a}catch(e){dalert(e)}}
function onMoveHorizVScrollPosition(b){try{var a=0;if(bCloudBrowserFolderVScrollDown){var c=$_("cloud_browser_list_folder_container"),d=$_("dze_idx_folderlist_v_scrollbar");a=b.x-nCloudBrowserFolderMouseOffX;nCloudBrowserFolderMouseOffX=b.x}var f=parseInt(d.style.left)+a;if(290<f+parseInt(d.style.width))return!1;0>f&&(f=0);d.style.left=f+"px";c.scrollLeft=parseInt(c.scrollLeft)+c.scrollWidth/c.offsetWidth*a}catch(e){dalert(e)}}
function fullScreenWheelEvent(b){var a=!0,c=0;c=b.wheelDelta?b.wheelDelta/120:b.deltaY;0>c&&(a=!1);if(!animationIng){var d=b.currentTarget,f=document.getElementById("dze_idx_browser_left_container"),e=document.getElementById("dze_idx_top_panel");oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_RECENT&&(a&&"none"===dzeJ("#dze_idx_top_panel").css("display")&&0==d.scrollTop&&d.scrollHeight>=d.clientHeight?(animationIng=!0,dzeJ("#dze_idx_top_panel").slideDown("slow",function(){d.style.height=
f.clientHeight-e.clientHeight-95+"px";animationIng=!1})):a||"none"==dzeJ("#dze_idx_top_panel").css("display")||(animationIng=!0,d.style.height=f.clientHeight-115+"px",dzeJ("#dze_idx_top_panel").slideUp("slow",function(){animationIng=!1})))}}var animationIng=!1;
function onChangeScrollPosition(b,a,c,d){try{1!==d&&3!==d&&(c.style.opacity=1);var f=document.getElementById("dze_idx_browser_left_container"),e=document.getElementById("dze_idx_top_panel"),g=b.offsetTop;dzeJ(":focus").blur();if(0===d){nCloudBrowserScrollTimer&&clearTimeout(nCloudBrowserScrollTimer);c.style.left=parseInt(f.clientWidth)+parseInt(b.clientWidth)-12-290+"px";c.style.height=a.clientHeight/a.scrollHeight*b.clientHeight+"px";c.style.top=a.scrollTop/a.scrollHeight*b.clientHeight+g+"px";removeSearchSelectItems();
dzeJ(".cloud_file_list_search_pos").css("bottom","0");nCloudBrowserScrollTimer&&clearTimeout(nCloudBrowserScrollTimer);nCloudBrowserScrollTimer=setTimeout(function(){dzeJ(".cloud_file_list_search_pos").animate({bottom:"126px"},800);setScrollOut(c)},700);if(oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_RECENT){if(oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SHARE||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST||oneffice_cloud_currentBrowserMode===
CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST){var h=a.scrollHeight-a.clientHeight;if(h-h/100<=a.scrollTop){if(oneffice_cloud_currentItemList.length+oneffice.currentShareListLimit<oneffice.currentShareListOffset+oneffice.currentShareListLimit)return!1;oneffice.currentShareListOffset+=oneffice.currentShareListLimit;var l=parseInt(12E3+oneffice_cloud_currentBrowserMode);g_updateListSuccessCB(!1,convertShareListData(l,oneffice_cloud_currentItemList),null,!0)}}return}if(animationIng){c.style.opacity=0;return}0==
e.clientHeight?0==a.scrollTop&&a.scrollHeight>=a.clientHeight&&(animationIng=!0,dzeJ("#dze_idx_top_panel").slideDown("slow",function(){a.style.height=f.clientHeight-e.clientHeight-95+"px";animationIng=!1})):(animationIng=!0,a.style.height=f.clientHeight-40-55+"px",dzeJ("#dze_idx_top_panel").slideUp("slow",function(){a.style.height=f.clientHeight-95+"px";e.clientHeight=0;animationIng=!1}))}if(1===d&&!bCloudBrowserFolderVScrollDown){var k=dzeJ("#dze_idx_browser_left_container").height()-467;if(a.offsetHeight<
k)return c.style.opacity=0,!1;c.style.left="280px";c.style.height=b.clientHeight*a.clientHeight/a.scrollHeight-10+"px";c.style.top=b.clientHeight*a.scrollTop/a.scrollHeight+g+"px";0==a.scrollTop&&a.scrollHeight>=a.clientHeight?dzeJ(".dze_shadow_div.top").hide():dzeJ(".dze_shadow_div.top").show();var n=c.offsetTop-124+c.offsetHeight;0<a.scrollTop&&n>=a.clientHeight?dzeJ(".dze_shadow_div.bottom").hide():dzeJ(".dze_shadow_div.bottom").show()}2===d&&(nCloudBrowserScrollTimer&&clearTimeout(nCloudBrowserScrollTimer),
c.style.left=parseInt(f.clientWidth)+parseInt(b.clientWidth)-12-290+"px",c.style.height=a.clientHeight/a.scrollHeight*b.clientHeight+"px",c.style.top=a.scrollTop/a.scrollHeight*b.clientHeight+g+"px",nCloudBrowserScrollTimer=setTimeout(function(){setScrollOut(c)},1E3));3!==d||bCloudBrowserScrollDown||(c.style.left=b.clientWidth*a.scrollLeft/a.scrollWidth+"px",c.style.width=84100/a.scrollWidth+"px",c.style.top=parseInt(b.clientHeight)+170+"px","290px"===c.style.width&&(c.style.width=0))}catch(m){dalert(m)}}
function initLnbScrollBar(b){initLnbVScrollBar();var a=document.getElementById.bind(document),c=a("cloud_browser_list_folder_container"),d=a("cloud_browser_list_folder_container");a=a("dze_idx_folderlist_scrollbar");null!=a&&""===a.style.opacity&&(a.style.opacity="1");if(c&&d&&a){var f=c.offsetTop,e=dzeJ("#dze_idx_browser_left_container").height()-458,g=c.clientHeight*d.clientHeight/d.scrollHeight+"px";c=c.clientHeight*d.scrollTop/d.scrollHeight+f+"px";if(d.offsetHeight<e)return a.style.left=0,a.style.height=
0,a.style.top=0,dzeJ(".dze_shadow_div").hide(),!1;a.style.left="280px";a.style.height=g;a.style.top=c;0==d.scrollTop&&d.scrollHeight>=d.clientHeight?dzeJ(".dze_shadow_div.top").hide():dzeJ(".dze_shadow_div.top").show();c=a.offsetTop-134+a.offsetHeight;0<d.scrollTop&&c>=d.clientHeight?dzeJ(".dze_shadow_div.bottom").hide():dzeJ(".dze_shadow_div.bottom").show();void 0!=b&&b()}}
function initLnbVScrollBar(b){var a=document.getElementById.bind(document),c=a("cloud_browser_list_folder_container"),d=a("cloud_browser_list_folder_container");a=a("dze_idx_folderlist_v_scrollbar");if(c&&d&&a){var f=c.offsetLeft,e=parseInt(c.clientHeight)+170+"px",g=84100/d.scrollWidth+"px";c=c.clientWidth*d.scrollLeft/d.scrollWidth+f+"px";if(291>d.scrollWidth||"290px"===g)return a.style.left=0,a.style.width=0,a.style.top=0,!1;a.style.left=c;a.style.width=g;a.style.top=e;void 0!=b&&b()}}
function setScrollOut(b){try{0<b.style.opacity&&(b.style.opacity-=.1,nCloudBrowserScrollTimer=setTimeout(function(){setScrollOut(b)},30))}catch(a){dalert(a)}}function setFolderScrollOut(b){try{bCloudBrowserFolderScrollDown=bCloudBrowserFolderVScrollDown=!1,0<b.style.opacity&&(showLnbScroll(!1),nCloudBrowserFolderScrollTimer=setTimeout(function(){setFolderScrollOut(b)},30))}catch(a){dalert(a)}}
function cloud_document_onmouseclick(b){CLOUD_POPUP_FOLDER_NAVI_LIST_SHOW&&(dzeJ(".cloud_folder_sub_container").slideUp(),dzeJ(".sub_folder_popup").removeClass("active"),CLOUD_POPUP_FOLDER_NAVI_LIST_SHOW=!1)}
function cloud_document_onmouseup(b){try{if(bCloudBrowserFolderVScrollDown=bCloudBrowserFolderScrollDown=bCloudBrowserScrollDown=!1,!0===getCloudResizeStatus()){var a=oneffice.getListViewMgr();setCloudResizeStatus(!1);updateCloudContainerSize(!0);a.setPosSortLayerMenu(null)}}catch(c){dalert(c)}}
function cloud_document_onmousemove(b){try{!0===getCloudResizeStatus()&&(b.preventDefault(b),resizeCloudContainerWidth(b)),bCloudBrowserFolderScrollDown?(b.preventDefault(b),onMoveHorizScrollPosition(b)):bCloudBrowserFolderVScrollDown?(b.preventDefault(b),onMoveHorizVScrollPosition(b)):bCloudBrowserScrollDown&&(b.preventDefault(b),onMoveHorizScrollPosition(b))}catch(a){dalert(a)}}var ___cloudSelectPopupData;
function ___initCloudSelectPopupData(){___cloudSelectPopupData={show:!1,resizedFinished:null,container:null,nType:-1,prevBodyWidth:-1}}___initCloudSelectPopupData();
function cloud_window_onresize(b){try{var a=document.getElementById("dze_idx_top_panel");a&&"100%"===a.style.height&&setTemplateScrollEventHandler();updateCloudContainerSize(!0);var c=oneffice.getListViewMgr();c&&c.checkMenuTextShow();if(!0===___cloudSelectPopupData.show){var d=document.body,f=function(){null!==___cloudSelectPopupData.resizedFinished&&(clearTimeout(___cloudSelectPopupData.resizedFinished),___cloudSelectPopupData.resizedFinished=null)};f();___cloudSelectPopupData.resizedFinished=setTimeout(function(){null===
___cloudSelectPopupData.container&&(___cloudSelectPopupData.container=dzeJ(".cloud_select_popup_container"));switch(___cloudSelectPopupData.nType){case CLOUD_POPUP_TYPE_LIST_COMMON_MENU:case CLOUD_POPUP_TYPE_SORT_MENU:case CLOUD_POPUP_TYPE_FILTER_MENU:var a=g_objCommonUtil.pxToNumber(___cloudSelectPopupData.prevBodyWidth);a=g_objCommonUtil.pxToNumber(d.style.width)-a;var b=g_objCommonUtil.pxToNumber(___cloudSelectPopupData.container.css("left"));___cloudSelectPopupData.container.css("left",b+a+"px");
___cloudSelectPopupData.prevBodyWidth=d.style.width}f()},100)}}catch(e){dalert(e)}}
function updateCloudContainerSize(b){try{oneffice.getListViewMgr().getListViewType();"undefined"===typeof b&&(b=!1);if(b){var a=document.getElementsByClassName("cloud_file_list_item");a&&a.length&&changeCss(".cloud_folder_info_item_name","width","100%",document)}var c=document.getElementById("dze_idx_cloud_container"),d=document.body;d.style.width=c.offsetWidth+"px";d.style.height=c.offsetHeight+"px";var f=document.getElementById("cloud_browser_list_folder_container");f&&(b=458,objOnefficeLoader.m_bDomainBizwatch&&
(b+=44),f.style.maxHeight=document.getElementById("dze_idx_browser_left_container").offsetHeight-b+"px");var e=document.getElementById("dze_idx_cloud_search_form"),g=document.getElementById("dze_idx_cloud_search_input"),h=document.getElementById("dze_idx_cloud_user_info");g.placeholder=ID_RES_STRING_TOTAL_SEARCH;e.style.width=c.offsetWidth-(230+h.offsetWidth+86)+"px";g_browserCHK.iOS?(g.style.width=e.offsetWidth-86+"px",g.style.height="27px"):g.style.width=e.offsetWidth-80+"px";var l=document.getElementById("dze_idx_toolbar_menu_list"),
k=document.getElementById("dze_idx_cloud_toolbar_menu"),n=document.getElementById("dze_idx_cloud_right_control");l&&k&&n&&(k.style.width=l.offsetWidth-n.offsetWidth-60+"px");var m=document.getElementById("dze_idx_filelist"),t=document.getElementById("drive_thumbnailItemPanel"),u=document.getElementById("dze_idx_search_list_container"),p=document.getElementById("dze_idx_search_myoneffice_list"),r=document.getElementById("dze_idx_search_shareout_list"),q=document.getElementById("dze_idx_search_sharein_list"),
v=document.getElementById("dze_idx_browser_left_container"),w=document.getElementById("dze_idx_top_panel"),x=oneffice.m_FileBrowserListDiv.parentElement.nextElementSibling.children[0];c=473;m&&(m.style.height=v.offsetHeight-(x.offsetHeight+55+42+20)+"px");t&&(t.style.height=v.offsetHeight-(x.offsetHeight+55+42)+"px");w&&(c=w.offsetWidth-40);var y=parseInt(c/242),z=parseInt(c/202);m=y===z?y:z;m=(c-184*m)/m/2;changeCss(".cloud_thumbnail_item","margin-left",m+"px",document);changeCss(".cloud_thumbnail_item",
"margin-right",m+"px",document);changeCss(".cloud_template_thumbnail_text","margin-left",m+"px",document);changeCss(".cloud_template_thumbnail_text","margin-right",m+"px",document);changeCss(".cloud_search_title_area","margin-left",m+"px",document);changeCss(".cloud_search_title_area","margin-right",m+"px",document);changeCss("#dze_idx_recent_seperate_today","margin-left",m+"px",document);changeCss("#dze_idx_recent_seperate_week","margin-left",m+"px",document);changeCss("#dze_idx_recent_seperate_ago",
"margin-left",m+"px",document);u&&(u.style.height=v.offsetHeight-(x.offsetHeight+55)+"px");p&&(p.style.maxHeight=v.offsetHeight-(x.offsetHeight+55+60)+"px");r&&(r.style.maxHeight=v.offsetHeight-(x.offsetHeight+55+60)+"px");q&&(q.style.maxHeight=v.offsetHeight-(x.offsetHeight+55+60)+"px")}catch(A){dalert(A)}}
function resizeCloudContainerWidth(b){try{if(!getCheckCloudRightButtonEvent(b)){var a=b.x;if(!(230>a||450<a)){var c=document.getElementById("dze_idx_browser_left_container"),d=document.getElementById("dze_idx_browser_right_container"),f=document.getElementById("dze_idx_browser_resizer");c.style.width=a+"px";d.style.marginLeft=a+"px";f.style.left=a-3+"px"}}}catch(e){dalert(e)}}
function setUserInfoEventHandler(b){try{var a=dzeJ("#dze_idx_cloud_user_photo"),c=dzeJ("#dze_idx_cloud_user_name");onefficeCommon.getMyInfo(function(d){oneffice_cloud_myInfoData=d;0==fnObjectCheckNull(d.pic)&&a.attr("src",d.pic);var f=d.name;d.duty_name&&(f+=" "+d.duty_name);c.text(f);oneffice.onefficeGroupSeq=d.group_seq;a.click(function(a){"\uc774\uc218\uae38"===oneffice_cloud_myInfoData.name&&"sokm83"===oneffice_cloud_myInfoData.login_id&&superUserCopyDocument(a)});onefficeUtil.checkLanguage(d.langCode);
"function"===typeof b&&b()})}catch(d){dalert(d)}}function makeCloudBrowser(){try{var b=document.getElementById("dze_idx_browser_list");oneffice.m_FileBrowserListDiv=b;makeDefaultItems(b)}catch(a){dalert(a)}}function makeShadowDiv(){var b=document.createElement("div");b.classList.add("dze_shadow_div");var a=document.createElement("div");b.appendChild(a);return b}
function makeDefaultItems(b){try{b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_RECENT)),b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_MYONEFFICE)),getFolderItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_MYONEFFICE,"",0,0,function(a){var b=document.getElementById("dze_idx_browser_myoneffice_list");b.insertBefore(a,b.firstChild);addMyOnefficeRootMoreEvent()}),b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_SHARE)),addShareItemMoreEvent(),objOnefficeLoader.m_bDomainBizwatch&&
(b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_NEWSROOM)),addNewsItemMoreEvent()),b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_FAVORITE)),b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_SECURITY)),b.appendChild(getDefaultItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_TRASHBOX))}catch(a){dalert(a)}}
function eventMyOnefficeDir(b,a){var c=dzeJ("#dze_idx_browser_myoneffice_list"),d=dzeJ("#cloud_browser_list_folder_container");"none"===d.css("display")?(c.css("height","auto"),d.slideDown(400,function(){initLnbScrollBar()}),b.src=b.src.replace("ico_cloud_renewal_arrow_right","ico_cloud_renewal_arrow_bottom")):(c.animate({height:"44px"},{start:function(a,b){dzeJ(".dze_shadow_div").hide()}}),d.slideUp(400,function(){initLnbScrollBar()}),b.src=b.src.replace("ico_cloud_renewal_arrow_bottom","ico_cloud_renewal_arrow_right"));
void 0!=a&&a.stopPropagation()}function addMyOnefficeRootMoreEvent(){try{dzeJ("#dze_idx_browser_list_item_myoneffice_more").off("click").click(function(b){eventMyOnefficeDir(this,b)})}catch(b){dalert(b)}}
function addShareItemMoreEvent(){try{dzeJ("#dze_idx_browser_list_item_share_more").click(function(b){var a=dzeJ("#dze_idx_browser_list_share_container"),c=dzeJ("#dze_idx_browser_list_item_share_out"),d=dzeJ("#dze_idx_browser_list_item_share_in");0<this.src.indexOf("ico_cloud_renewal_arrow_right")?(a.animate({height:"132px"}),c.show(),d.show(),this.src=this.src.replace("ico_cloud_renewal_arrow_right","ico_cloud_renewal_arrow_bottom")):(a.animate({height:"44px"}),c.fadeOut(),d.fadeOut(),this.src=this.src.replace("ico_cloud_renewal_arrow_bottom",
"ico_cloud_renewal_arrow_right"));b.stopPropagation()})}catch(b){dalert(b)}}
function addNewsItemMoreEvent(){try{dzeJ("#dze_idx_browser_list_item_news_more").click(function(b){var a=dzeJ("#dze_idx_browser_newsroom"),c=dzeJ("#dze_idx_browser_list_item_mynews"),d=dzeJ("#dze_idx_browser_list_item_send_mynews");0<this.src.indexOf("ico_cloud_renewal_arrow_right")?(a.animate({height:"132px"}),d.show(),c.show(),this.src=this.src.replace("ico_cloud_renewal_arrow_right","ico_cloud_renewal_arrow_bottom")):(a.animate({height:"44px"}),d.fadeOut(),c.fadeOut(),this.src=this.src.replace("ico_cloud_renewal_arrow_bottom",
"ico_cloud_renewal_arrow_right"));b.stopPropagation()})}catch(b){dalert(b)}}
function getBrowserModeDiv(b){try{var a=null;switch(b){case CLOUD_CONST_BROWSER_MODE_RECENT:a=document.getElementById("dze_idx_browser_recent");break;case CLOUD_CONST_BROWSER_MODE_MYONEFFICE:a=document.getElementById("dze_idx_browser_myoneffice_list").firstChild;break;case CLOUD_CONST_BROWSER_MODE_SHARE:a=document.getElementById("dze_idx_browser_list_item_share");break;case CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST:a=document.getElementById("dze_idx_browser_list_item_share_out");break;case CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST:a=
document.getElementById("dze_idx_browser_list_item_share_in");break;case CLOUD_CONST_BROWSER_MODE_SECURITY:a=document.getElementById("dze_idx_browser_security");break;case CLOUD_CONST_BROWSER_MODE_FAVORITE:a=document.getElementById("dze_idx_browser_favorite");break;case CLOUD_CONST_BROWSER_MODE_TRASHBOX:a=document.getElementById("dze_idx_browser_trashbox");break;case CLOUD_CONST_BROWSER_MODE_NEWSROOM:a=document.getElementById("dze_idx_browser_list_item_newsroom");break;case CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST:a=
document.getElementById("dze_idx_browser_list_item_mynews");break;case CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST:a=document.getElementById("dze_idx_browser_list_item_send_mynews")}return a}catch(c){dalert(c)}}function chkBrowserSearchMode(b){void 0===b&&(b=oneffice_cloud_currentBrowserMode);return b===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH||b===CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT?!0:!1}
function changeCurBrowserMode(b,a){try{objOnefficeLoader.m_bDomainBizwatch&&(CLOUD_CONST_BROWSER_MODE_NEWSROOM==b||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST?dzeJ("#newItemTxt").html("\uc0c8\uae30\uc0ac \uc791\uc131\ud558\uae30"):dzeJ("#newItemTxt").html(ID_RES_CONST_STRING_FILE_NEW));a=!0===fnObjectCheckNull(a)?!1:a;if(oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_RECENT&&CLOUD_CONST_BROWSER_MODE_RECENT===
b||-99===oneffice_cloud_currentBrowserMode)a&&updateCloudContainerSize(!1),document.getElementById("dze_idx_top_panel");var c=dzeJ("#dze_idx_top_panel");CLOUD_CONST_BROWSER_MODE_RECENT===oneffice_cloud_currentBrowserMode&&CLOUD_CONST_BROWSER_MODE_RECENT===b||-99===oneffice_cloud_currentBrowserMode&&!1===a?c.slideDown("slow",function(){updateCloudContainerSize(!1)}):c.slideUp("slow",function(){updateCloudContainerSize(!1)});if(!fnObjectCheckNull(oneffice.m_FileBrowserListDiv)){c=null;var d=getBrowserModeDiv(oneffice_cloud_currentBrowserMode);
if(d){for(var f=0;f<d.childNodes.length;f++)if("cloud_browser_list_item_icon_img"==d.childNodes[f].className){c=d.childNodes[f];c.src=c.src.replace("_on.png",".png");break}d.style.backgroundColor=ONE_CLR_FILEBROWSER_OFF;d.lastChild.style.fontWeight="normal";d.lastChild.style.letterSpacing="-0.8px"}var e=getBrowserModeDiv(b);if(e&&(CLOUD_CONST_BROWSER_MODE_MYONEFFICE!==b||!a)){for(f=0;f<e.childNodes.length;f++)if("cloud_browser_list_item_icon_img"==e.childNodes[f].className){c=e.childNodes[f];!1===
(0<c.src.indexOf("_share_out")||0<c.src.indexOf("_share_in")||0<c.src.indexOf("_send_mynews")||0<c.src.indexOf("_mynews"))&&(c.src=c.src.replace(".png","_on.png"));break}e.style.backgroundColor=ONE_CLR_FILEBROWSER_ON;e.lastChild.style.fontWeight="bold";e.lastChild.style.letterSpacing="-0.96px"}if(oneffice_cloud_currentBrowserMode!=b){oneffice.m_FileItemListDiv||(oneffice.m_FileItemListDiv=document.getElementById("dze_idx_filelist"));b!=CLOUD_CONST_BROWSER_MODE_SHARE&&(document.getElementById("dze_idx_filelist_search_select_type_text").innerText=
getSearchOptionSelectItemTitle(SEARCH_TYPE_OPTION_SUBJECT));chkBrowserSearchMode(b)?dzeJ("#dze_idx_filelist_search").hide():dzeJ("#dze_idx_filelist_search").show();var g=oneffice.getListViewMgr();oneffice.m_FileItemListDiv&&oneffice.m_FileItemListDiv.previousElementSibling&&(g.getListViewType()&&oneffice_cloud_checkedItemList.length&&(g.m_bChkListInit=!0,g.m_nCheckLstInitMode=CHECKLISTINITMODE.CHG_BROWSERMODE),b==CLOUD_CONST_BROWSER_MODE_TRASHBOX?(nChgSortType=m_SortType=VIEWSORT.MODDATE,m_SortOption=
CLOUD_CMD_SORT_RECENTDATE,g.m_nSortArrowImgDegree=m_nSortArrowImgDegree,g.updateSortCtrlInfo(nChgSortType,!0)):b==CLOUD_CONST_BROWSER_MODE_SHARE||b==CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST||b==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST?(nChgSortType=m_SortType=VIEWSORT.SHAREDATE,m_SortOption=CLOUD_CMD_SORT_SHEREDATE,g.m_nSortArrowImgDegree=90):b==CLOUD_CONST_BROWSER_MODE_RECENT?(m_FilterOption=CLOUD_CMD_FILTER_ALL,m_SortType=VIEWSORT.READDATE,nChgSortType=VIEWSORT.share,m_SortOption=CLOUD_CMD_SORT_READDATE,
m_FilterOption=CLOUD_CMD_FILTER_ALL,g.m_nSortArrowImgDegree=90):0==onefficeUtil.updateUserSortConfig(!1,b)&&(g.m_nSortArrowImgDegree=-90,b==CLOUD_CONST_BROWSER_MODE_MYONEFFICE||b==CLOUD_CONST_BROWSER_MODE_SECURITY||b==CLOUD_CONST_BROWSER_MODE_FAVORITE||-1==b?(nChgSortType=m_SortType=VIEWSORT.NAME,m_SortOption=CLOUD_CMD_SORT_TITE,g.m_nSortArrowImgDegree=m_nSortArrowImgDegree):b==CLOUD_CONST_BROWSER_MODE_TRASHBOX&&(nChgSortType=m_SortType=VIEWSORT.MODDATE,m_SortOption=CLOUD_CMD_SORT_RECENTDATE,g.m_nSortArrowImgDegree=
-m_nSortArrowImgDegree,g.updateSortCtrlInfo(nChgSortType,!0))));g_LNaviMenuBar.setCurCategory(b);g.isRootFolder()||g.updateRootFolderStack("")}}}catch(h){dalert(h)}}
function lnbMenuCtrol(b){void 0===b&&(b="oneffice");var a=dzeJ("#dze_idx_browser_myoneffice_list"),c=dzeJ("#cloud_browser_list_folder_container"),d=dzeJ("#dze_idx_browser_list_share_container"),f=dzeJ("#dze_idx_browser_list_item_share_out"),e=dzeJ("#dze_idx_browser_list_item_share_in"),g=dzeJ("#dze_idx_browser_newsroom"),h=dzeJ("#dze_idx_browser_list_item_mynews"),l=dzeJ("#dze_idx_browser_list_item_send_mynews");switch(b){case "oneffice":setTimeout(function(){a.css("height","auto");c.slideDown(400,
function(){initLnbScrollBar();g_bBrowserType_IE&&dzeJ("#dze_idx_top_panel").slideDown()});g_bBrowserType_IE||dzeJ("#dze_idx_top_panel").slideDown()},50);break;case "share":d.animate({height:"132px"},{done:function(){dzeJ(".dze_shadow_div").hide()}});f.show();e.show();break;case "newsroom":g.animate({height:"132px"},{done:function(){dzeJ(".dze_shadow_div").hide()}}),h.show(),l.show()}}
function getDefaultItemDetail(b){try{var a=document.createElement("div");a.className="cloud_browser_list_item";switch(b){case CLOUD_CONST_BROWSER_ITEM_INDEX_RECENT:a.id="dze_idx_browser_recent";a.style.paddingLeft="52px";a.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_RECENT);a.innerHTML=getBrowserItemHTML(b,ID_RES_CONST_STRING_BROWSER_RECENT);a.onclick=function(b){g_ChangeCategory(b,CLOUD_CONST_BROWSER_MODE_RECENT,a)};break;case CLOUD_CONST_BROWSER_ITEM_INDEX_MYONEFFICE:a.id=
"dze_idx_browser_myoneffice_list";a.className="cloud_browser_list_item_my_oneffice";a.onmouseup=function(a){var b=document.getElementById("copyDiv");a=a.currentTarget.getAttribute("folderSeq");if(b&&"0"!=b.style.opacity){b=checkCopyListTo(oneffice_cloud_checkedItemList,a,!0);a=!1;for(var c=0;c<oneffice_cloud_checkedItemList.length;c++)0==oneffice_cloud_checkedItemList[c].fileType&&(a=!0);a&&b&&setTimeout(function(){reloadOnListUpdate()},100)}};a.onmouseover=function(a){if(document.getElementById("copyDiv")){a=
document.getElementById("dze_idx_browser_list_item_myoneffice_more");var b=dzeJ("#dze_idx_browser_myoneffice_list"),c=dzeJ("#cloud_browser_list_folder_container");"none"===c.css("display")&&(b.css("height","auto"),c.slideUp(400),c.show(500),a.src=a.src.replace("ico_cloud_renewal_arrow_right","ico_cloud_renewal_arrow_bottom"))}};break;case CLOUD_CONST_BROWSER_ITEM_INDEX_SHARE:a.id="dze_idx_browser_list_share_container";a.className="";a.style.height="132px";var c=document.createElement("div");c.id=
"dze_idx_browser_list_item_share";c.className="cloud_browser_list_item";c.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_SHARE);c.innerHTML=getBrowserItemHTML(b,ID_RES_CONST_STRING_BROWSER_SHARE);c.onclick=function(a){lnbMenuCtrol("share");g_ChangeCategory(a,CLOUD_CONST_BROWSER_MODE_SHARE,c)};a.appendChild(c);var d=document.createElement("div");d.id="dze_idx_browser_list_item_share_out";d.className="cloud_browser_list_item";d.style.paddingLeft="72px";d.setAttribute("folderSeq",
CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST);d.innerHTML=getBrowserItemHTML(CLOUD_CONST_BROWSER_ITEM_INDEX_MY_SHARE,ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST);d.onclick=function(a){g_ChangeCategory(a,CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST,d)};a.appendChild(d);var f=document.createElement("div");f.id="dze_idx_browser_list_item_share_in";f.className="cloud_browser_list_item";f.style.paddingLeft="72px";f.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+
CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST);f.innerHTML=getBrowserItemHTML(CLOUD_CONST_BROWSER_ITEM_INDEX_BY_SHARE,ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST);f.onclick=function(a){g_ChangeCategory(a,CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST,f)};a.appendChild(f);break;case CLOUD_CONST_BROWSER_ITEM_INDEX_SECURITY:a.id="dze_idx_browser_security";a.style.paddingLeft="52px";a.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_SECURITY);a.innerHTML=getBrowserItemHTML(b,
ID_RES_CONST_STRING_BROWSER_SECURITY);a.onclick=function(b){g_ChangeCategory(b,CLOUD_CONST_BROWSER_MODE_SECURITY,a)};break;case CLOUD_CONST_BROWSER_ITEM_INDEX_FAVORITE:a.id="dze_idx_browser_favorite";a.style.paddingLeft="52px";a.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_FAVORITE);a.innerHTML=getBrowserItemHTML(b,ID_RES_CONST_STRING_BROWSER_FAVORITE);a.onclick=function(b){g_ChangeCategory(b,CLOUD_CONST_BROWSER_MODE_FAVORITE,a)};break;case CLOUD_CONST_BROWSER_ITEM_INDEX_TRASHBOX:a.id=
"dze_idx_browser_trashbox";a.style.paddingLeft="52px";a.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_TRASHBOX);a.innerHTML=getBrowserItemHTML(b,ID_RES_CONST_STRING_BROWSER_TRASHBOX);a.onclick=function(b){g_ChangeCategory(b,CLOUD_CONST_BROWSER_MODE_TRASHBOX,a)};break;case CLOUD_CONST_BROWSER_ITEM_INDEX_NEWSROOM:a.id="dze_idx_browser_newsroom";a.className="";a.style.height="132px";var e=document.createElement("div");e.id="dze_idx_browser_list_item_newsroom";
e.className="cloud_browser_list_item";e.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_NEWSROOM);e.innerHTML=getBrowserItemHTML(b,ID_RES_CONST_STRING_BROWSER_NEWSROOM);e.onclick=function(a){lnbMenuCtrol("newsroom");g_ChangeCategory(a,CLOUD_CONST_BROWSER_MODE_NEWSROOM,e)};a.appendChild(e);var g=document.createElement("div");g.id="dze_idx_browser_list_item_mynews";g.className="cloud_browser_list_item";g.style.paddingLeft="72px";g.setAttribute("folderSeq",
CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST);g.innerHTML=getBrowserItemHTML(CLOUD_CONST_BROWSER_ITEM_INDEX_MYNEWS,ID_RES_CONST_STRING_BROWSER_MYNEWS_LIST);g.onclick=function(a){g_ChangeCategory(a,CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST,g)};a.appendChild(g);var h=document.createElement("div");h.id="dze_idx_browser_list_item_send_mynews";h.className="cloud_browser_list_item";h.style.paddingLeft="72px";h.setAttribute("folderSeq",CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+
CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST);h.innerHTML=getBrowserItemHTML(CLOUD_CONST_BROWSER_ITEM_INDEX_SEND_MYNEWS,ID_RES_CONST_STRING_BROWSER_SEND_MYNEWS_LIST);h.onclick=function(a){g_ChangeCategory(a,CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST,h)};a.appendChild(h)}return a}catch(l){dalert(l)}}
function createSrollContent(b){var a=document.createElement("div");a.id="dze_idx_folderlist_scrollbar";var c=document.createElement("div");c.id="dze_idx_folderlist_v_scrollbar";dzeJ(b).append(a);dzeJ(b).append(c);setTimeout(function(){setCloudFolderScrollEventHandler()},0)}
function getFolderItemDetail(b,a,c,d,f){try{var e=document.createElement("div");e.setAttribute("listIndex",d);var g=null;switch(b){case CLOUD_CONST_BROWSER_ITEM_INDEX_MYONEFFICE:e.className="cloud_browser_list_item";e.setAttribute("folderSeq","");e.innerHTML=getBrowserItemHTML(b,ID_RES_CONST_STRING_BROWSER_MY);e.onclick=function(a){oneffice_cloud_SearchMode&&searchCloudEnd(!0,CLOUD_CONST_BROWSER_MODE_MYONEFFICE);var b=oneffice.getListViewMgr(),c=e.getAttribute("folderSeq");changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_MYONEFFICE);
selectBrowserFolderItem(c,!0);TBCancelBubbleEvent(a);b.isRootFolder()||b.updateRootFolderStack(c)};break;case CLOUD_CONST_BROWSER_ITEM_INDEX_FOLDER:if("undefined"===a)return"";var h="undefined"===a.subject?"":a.subject;e.className="cloud_browser_list_item_folder";e.style.paddingLeft=52+20*c+"px";e.setAttribute("folderSeq",a.seq);e.setAttribute("parentSeq",a.folderSeq);e.setAttribute("depth",c);e.innerHTML=getBrowserItemHTML(b,h);e.onclick=function(a){oneffice_cloud_SearchMode&&searchCloudEnd(!0,CLOUD_CONST_BROWSER_MODE_MYONEFFICE);
oneffice.getListViewMgr().m_bDirectFolder=!0;changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_MYONEFFICE,!0);selectBrowserFolderItem(e.getAttribute("folderSeq"),!0);TBCancelBubbleEvent(a)};e.onmouseup=function(a){a.stopPropagation();var b=document.getElementById("copyDiv");a=a.currentTarget.getAttribute("folderSeq");if(b){b=checkCopyListTo(oneffice_cloud_checkedItemList,a,!0);a=!1;for(var c=0;c<oneffice_cloud_checkedItemList.length;c++)0==oneffice_cloud_checkedItemList[c].fileType&&(a=!0);a&&b&&setTimeout(function(){reloadOnListUpdate()},
100)}};break;default:return}var l=e.getAttribute("folderSeq"),k=null;getFolderItemsInFolder(l,function(a){var b=!0;if(""===l&&0<a.length){g=document.createElement("div");g.id="cloud_browser_list_folder_container";g.style.maxHeight=document.getElementById("dze_idx_browser_left_container").offsetHeight-458+"px";(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)&&createSrollContent(g);for(var c=[],d=b=0;b<a.length;b++)getFolderItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_FOLDER,a[b],0,b,function(b){c.push(b);
d++;if(d===a.length){b=c.sort(function(a,b){return a.getAttribute("listIndex")-b.getAttribute("listIndex")});for(var f=0;f<d;f++)g.appendChild(b[f])}});if(b=document.getElementById("dze_idx_browser_myoneffice_list")){var h=makeShadowDiv();h.classList.add("top");var n=makeShadowDiv();n.classList.add("bottom");b.appendChild(h);b.appendChild(g);b.appendChild(n)}else initLnbScrollBar()}else k=e.getElementsByClassName("cloud_browser_list_item_icon_arrow")[0],0<a.length?(k.style.opacity="1.0",k.setAttribute("isOpened",
"0")):(k.style.opacity="0.0",k.setAttribute("isOpened","0"),b=!1),k.setAttribute("folderSeq",l),b&&(k.onclick=function(a){makeBrowserFolderItems(e,k.getAttribute("folderSeq"),k.getAttribute("isOpened"),function(a){0<a?(k.src=k.src.replace("ico_cloud_renewal_arrow_right","ico_cloud_renewal_arrow_bottom"),k.style.opacity="1.0",k.setAttribute("isOpened","1")):(0==a?(k.src=k.src.replace("ico_cloud_renewal_arrow_bottom","ico_cloud_renewal_arrow_right"),k.style.opacity="1.0"):k.style.opacity="0.0",k.setAttribute("isOpened",
"0"))});TBCancelBubbleEvent(a)});"function"===typeof f&&f(e)})}catch(n){dalert(n)}}
function resetFolderListItems(b){try{removeChildsInFolder("",b);var a=document.getElementById("cloud_browser_list_folder_container");if(!a){a=document.createElement("div");a.id="cloud_browser_list_folder_container";var c=458;a.style.maxHeight=document.getElementById("dze_idx_browser_left_container").offsetHeight-c+"px";(g_bBrowserType_IE||g_bBrowserType_CR||g_bBrowserType_WK)&&createSrollContent(a);document.getElementById("dze_idx_browser_myoneffice_list").appendChild(a)}a&&(drawFolder(a),a.style.maxHeight=
document.getElementById("dze_idx_browser_left_container").offsetHeight-c+"px");if(a){var d=dzeJ(".cloud_browser_list_item_folder",a);if(!d||0>=d.length)!0===g_bBrowserType_IE?a.parentNode.removeChild(a):a.remove()}}catch(f){dalert(f)}}function drawFolder(b){var a=[];dzeJ(".cloud_browser_list_item_icon_arrow[isopened=1]").each(function(){a.push(dzeJ(this).attr("folderseq"))});dzeJ(".cloud_browser_list_item_folder").remove();drawFolderImple("",b);for(var c=0;a.length>c;c++)drawFolderImple(a[c],b)}
function drawFolderImple(b,a){getFolderItemsInFolder(b,function(c){var d=[],f=document.getElementById("dze_idx_browser_list_item_myoneffice_more");0>=c.length?(f.style.opacity="0.0",f.setAttribute("isOpened","0"),f.setAttribute("folderSeq",""),f.src=f.src.replace("ico_cloud_renewal_arrow_bottom","ico_cloud_renewal_arrow_right")):(f.style.opacity="1.0",f.setAttribute("isOpened","0"));for(var e=f=0;f<c.length;f++)getFolderItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_FOLDER,c[f],0,f,function(f){d.push(f);
e++;if(e===c.length){f=d.sort(function(a,b){return a.getAttribute("listIndex")-b.getAttribute("listIndex")});for(var g=0;g<e;g++)if(""!=b){var l=dzeJ(f[g]),k=l.find(".cloud_browser_list_item_icon_arrow"),n=dzeJ(".cloud_browser_list_item_folder[folderseq="+f[g].getAttribute("parentseq")+"]"),m=n.find(".cloud_browser_list_item_icon_arrow"),t=Number(n.css("padding-left").replace("px",""));m.attr("isopened","1");m.css("opacity","1");m.attr("src",k.attr("src").replace("ico_cloud_renewal_arrow_right","ico_cloud_renewal_arrow_bottom"));
l.css("padding-left",t+20+"px");l.attr("depth",Number(n.attr("depth"))+1);k=dzeJ(".cloud_browser_list_item_folder[parentseq="+f[g].getAttribute("parentseq")+"]");0<dzeJ(".cloud_browser_list_item_folder").length&&""!=l.attr("parentseq")&&(0<k.length&&(n=k.last()),n.after(l))}else a.appendChild(f[g]);resetBrowserFolderSelection(oneffice_cloud_currFolderSeq)}})})}
function isFolderChild(b,a){for(var c=b.getElementsByClassName("cloud_browser_list_item_folder"),d="",f=a.getAttribute("folderseq"),e=a.getAttribute("parentseq"),g=0;c.length>g;g++){var h=c[g].getAttribute("folderseq"),l=c[g].getAttribute("parentseq");if(h===f){d="0";break}else d="1",dlog("newcheck : ",f,"orgcheck : ",h),l!=e&&(d="2")}"1"===d&&(dlog("call : ",f),""===e?b.appendChild(a):dzeJ(".cloud_browser_list_item_folder[folderseq="+f+"]").append(dzeJ(a)));return d}
function getBrowserItemHTML(b,a){try{a="undefined"===typeof a?"":a;var c="";switch(b){case CLOUD_CONST_BROWSER_ITEM_INDEX_RECENT:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_oneffice.png"/><span class="cloud_browser_list_item_text" style="font-weight: bold; letter-spacing: -0.96px;">'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_MYONEFFICE:c='<img id="dze_idx_browser_list_item_myoneffice_more" class="cloud_browser_list_item_icon_arrow" src="./image/cloud/ico_cloud_renewal_arrow_bottom.png"/><img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_myhome.png"/><span class="cloud_browser_list_item_text">'+
a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_SHARE:c='<img id="dze_idx_browser_list_item_share_more" class="cloud_browser_list_item_icon_arrow" src="./image/cloud/ico_cloud_renewal_arrow_bottom.png"/><img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_share.png"/><span class="cloud_browser_list_item_text" >'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_SECURITY:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_security.png"/><span class="cloud_browser_list_item_text">'+
a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_FAVORITE:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_favorite.png"/><span class="cloud_browser_list_item_text">'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_TRASHBOX:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_trashbox.png"/><span class="cloud_browser_list_item_text">'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_FOLDER:c='<img class="cloud_browser_list_item_icon_arrow" src="./image/cloud/ico_cloud_renewal_arrow_right.png"/><img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_folder.png"/><span class="cloud_browser_list_item_text">'+
a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_MY_SHARE:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_share_out.png"/><span class="cloud_browser_list_item_text">'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_BY_SHARE:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_share_in.png"/><span class="cloud_browser_list_item_text">'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_NEWSROOM:c='<img id="dze_idx_browser_list_item_news_more" class="cloud_browser_list_item_icon_arrow" src="./image/cloud/ico_cloud_renewal_arrow_bottom.png"/><img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_newsroom.png"/><span class="cloud_browser_list_item_text">'+
a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_MYNEWS:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_mynews.png"/><span class="cloud_browser_list_item_text">'+a+"</span>";break;case CLOUD_CONST_BROWSER_ITEM_INDEX_SEND_MYNEWS:c='<img class="cloud_browser_list_item_icon_img" src="./image/cloud/ico_cloud_renewal_send_mynews.png"/><span class="cloud_browser_list_item_text">'+a+"</span>"}return c}catch(d){dalert(d)}}
function getBowserArrowItemHTML(b,a){try{return a="undefined"===typeof a?!1:""===a?!0:!1,("undefined"===typeof b?0:b)?a?'<img width="14px" height="14px" src="./image/cloud/ico_cloud_arrow_right.png" style="position:relative; top:21px; float:right; padding-right: 10px;" />':'<img width="14px" height="14px" src="./image/cloud/ico_cloud_arrow_right.png" style="position:relative; top:3px;" />':a?'<img width="14px" height="14px" src="./image/cloud/ico_cloud_arrow_bottom.png" style="position:relative; top:21px; float:right; padding-right: 10px;" />':
'<img width="14px" height="14px" src="./image/cloud/ico_cloud_arrow_bottom.png" style="position:relative; top:3px;" />'}catch(c){dalert(c)}}
function selectBrowserFolderItem(b,a){try{var c=oneffice.getListViewMgr(),d=c.getListViewType(),f=oneffice_cloud_currentBrowserMode;a="undefined"===typeof a?!1:a;oneffice_cloud_currFolderSeq=b;oneffice_cloud_checkedItemList.length&&d&&(c.m_bChkListInit=!0,c.m_nCheckLstInitMode=CHECKLISTINITMODE.SET_FOLDERSELECT);if(a){if(oneffice.m_FileItemListDiv){var e=oneffice.m_FileItemListDiv.previousElementSibling;e&&(f!==CLOUD_CONST_BROWSER_MODE_RECENT&&f!==CLOUD_CONST_BROWSER_MODE_SHARE&&f!==CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST&&
f!==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST?(e.children[3].style.display="none",updateCloudContainerSize(!1)):(d||(e.children[3].style.display=""),updateCloudContainerSize(!0)))}updateFileList(oneffice_cloud_currFolderSeq,!0)}resetBrowserFolderSelection(oneffice_cloud_currFolderSeq)}catch(g){dalert(g)}}
function getAllItemsInFolder(b,a,c){try{"undefined"===typeof a&&(a=""),onefficeGW.getFileList(b,"",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,a,function(a){"function"===typeof c&&c(a);!1===oneffice_cloud_firstload&&updateCloudContainerSize(!1)})}catch(d){dalert(d)}}
function getSearchItemsAllFolder(b,a,c){try{var d=oneffice.getListViewMgr(),f=d.getSearchMgr();"undefined"===typeof a&&(a=f.getKeyword());var e=0;oneffice_cloud_search_myonefficeItemList=[];oneffice_cloud_search_shareOutItemList=[];oneffice_cloud_search_shareInItemList=[];onefficeGW.getFileList(b,"",oneffice_cloud_currentBrowserMode,a,function(a){e+=1;oneffice_cloud_search_myonefficeItemList=onefficeUtil.SortFileList(a,d.m_nSortArrowImgDegree);objOnefficeLoader.m_bDomainBizwatch&&(oneffice_cloud_search_myonefficeItemList=
oneffice_cloud_search_myonefficeItemList.filter(function(a){return a.folderSeq!=CLOUD_CONST_STRING_NEWSROOM_SEQ}));var b=oneffice_cloud_myInfoData.id;forEach(oneffice_cloud_search_myonefficeItemList,function(a,c){c.owner_id=b});2===e&&"function"===typeof c&&c()},"myoneffice");onefficeGW.getFileList(b,"",oneffice_cloud_currentBrowserMode,a,function(a){e+=1;for(var b=0;b<a.length;b++)a[b].owner_id===oneffice_cloud_myInfoData.id&&1!=a[b].deleted?oneffice_cloud_search_shareOutItemList.push(a[b]):a[b].owner_id!==
oneffice_cloud_myInfoData.id&&oneffice_cloud_search_shareInItemList.push(a[b]);oneffice_cloud_search_shareOutItemList=onefficeUtil.SortFileList(oneffice_cloud_search_shareOutItemList,d.m_nSortArrowImgDegree);oneffice_cloud_search_shareInItemList=onefficeUtil.SortFileList(oneffice_cloud_search_shareInItemList,d.m_nSortArrowImgDegree);objOnefficeLoader.m_bDomainBizwatch&&(oneffice_cloud_search_shareOutItemList=oneffice_cloud_search_shareOutItemList.filter(function(a){return a.folderSeq!=CLOUD_CONST_STRING_NEWSROOM_SEQ}),
oneffice_cloud_search_shareInItemList=oneffice_cloud_search_shareInItemList.filter(function(a){return a.folderSeq!=CLOUD_CONST_STRING_NEWSROOM_SEQ}));2===e&&"function"===typeof c&&c()},"share")}catch(g){dalert(g)}}function getFileItemsInFolder(b,a){try{onefficeGW.getFileList(b,"file",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,"",function(b){"function"===typeof a&&a(b)})}catch(c){dalert(c)}}
function getFolderItemsInFolder(b,a){try{onefficeGW.getFileList(b,"folder",CLOUD_CONST_BROWSER_MODE_MYONEFFICE,"",function(b){"function"===typeof a&&a(b)},"",null,!1)}catch(c){dalert(c)}}
function getFolderItemsInRecent(b,a){try{var c="0";switch(m_FilterOption){case CLOUD_CMD_FILTER_MY:c="1";break;case CLOUD_CMD_FILTER_BY:c="2"}onefficeGW.getFileList("",c,CLOUD_CONST_BROWSER_MODE_RECENT,"",function(b){objOnefficeLoader.m_bDomainBizwatch&&(b=b.filter(function(a){return a.folderSeq!=CLOUD_CONST_STRING_NEWSROOM_SEQ}));"function"===typeof a&&a(b)},"",b)}catch(d){dalert(d)}}
function getFolderItemsInSecurity(b){try{onefficeGW.getFileList("","",CLOUD_CONST_BROWSER_MODE_SECURITY,"",function(a){"function"===typeof b&&b(a)})}catch(a){dalert(a)}}function getFolderItemsInFavorite(b){try{onefficeGW.getFileList("","",CLOUD_CONST_BROWSER_MODE_FAVORITE,"",function(a){"function"===typeof b&&b(a)})}catch(a){dalert(a)}}
function getFolderItemsInShare(b){try{onefficeGW.getFileList("","",CLOUD_CONST_BROWSER_MODE_SHARE,"",function(a){"function"===typeof b&&b(a)})}catch(a){dalert(a)}}function getFolderItemsInTrashbox(b){try{onefficeGW.getFileList("","",CLOUD_CONST_BROWSER_MODE_TRASHBOX,"",function(a){"function"===typeof b&&b(a)})}catch(a){dalert(a)}}
function getFolderItemsInNewsroom(b){try{onefficeGW.getFileList(CLOUD_CONST_STRING_NEWSROOM_SEQ,"",CLOUD_CONST_BROWSER_MODE_NEWSROOM,"",function(a){"function"===typeof b&&b(a)})}catch(a){dalert(a)}}
function removeChildsInFolder(b,a){try{var c=""==b?dzeJ(".cloud_browser_list_item_folder").filter("[parentseq]"):dzeJ(".cloud_browser_list_item_folder").filter("[parentseq="+b+"]");var d=document.getElementById("cloud_browser_list_folder_container");if(d){var f="none"==d.style.display?!1:!0;if(0<c.length)if(a)setTimeout(function(){initLnbScrollBar()},200);else for(c.slideUp(300,function(){c.remove();f&&dzeJ(d).slideDown(300,function(){setTimeout(function(){initLnbScrollBar()},200)})}),b=0;b<c.length;b++)removeChildsInFolder(c[b].getAttribute("folderseq"),
a)}return c.length}catch(e){dalert(e)}}
function makeBrowserFolderItems(b,a,c,d){try{if("1"===("undefined"===typeof c?"0":c)&&(removeChildsInFolder(a),"function"===typeof d)){d(0);return}getFolderItemsInFolder(a,function(b){0===b.length&&"function"===typeof d&&d(-1);var c=document.getElementById("cloud_browser_list_folder_container"),f=c.firstChild;"dze_idx_folderlist_scrollbar"==f.id&&(f=f.nextSibling);if(null===f)for(var h=0;h<b.length;h++)getFolderItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_FOLDER,b[h],0,h,function(a){for(var b=!1,d=c.firstChild;d;){if(d.hasAttribute("listIndex")&&
0<d.getAttribute("listIndex")-a.getAttribute("listIndex")){c.insertBefore(a,d);b=!0;break}d=d.nextSibling}b||c.appendChild(a)});else for(;f;){if(f.getAttribute("folderseq")===a){for(var l=parseInt(f.getAttribute("depth"))+1,k=[],n=h=0;h<b.length;h++)getFolderItemDetail(CLOUD_CONST_BROWSER_ITEM_INDEX_FOLDER,b[h],l,h,function(d){k.push(d);n++;if(n===b.length){d=k.sort(function(a,b){return a.getAttribute("listIndex")-b.getAttribute("listIndex")});for(var e=n-1;0<=e;e--)d[e].style.display="none",f.nextSibling?
c.insertBefore(d[e],f.nextSibling):c.appendChild(d[e]);dzeJ(".cloud_browser_list_item_folder").filter("[parentseq="+a+"]").slideDown(300,function(){setTimeout(function(){initLnbScrollBar()},200)})}});break}f=f.nextSibling}"function"===typeof d&&d(b.length)})}catch(f){dalert(f)}}
function resetBrowserFolderSelection(b){try{oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_MYONEFFICE&&""!=b&&(dzeJ(".cloud_browser_list_item").css("backgroundColor",ONE_CLR_FILEBROWSER_OFF),dzeJ("#dze_idx_top_panel").slideUp("slow",function(){updateCloudContainerSize(!1)}));for(var a=document.getElementsByClassName("cloud_browser_list_item_folder"),c=0;c<a.length;c++){var d=a[c].getAttribute("folderSeq");b==d?(a[c].style.backgroundColor=ONE_CLR_FILEBROWSER_ON,a[c].lastChild.style.fontWeight=
"bold",a[c].lastChild.style.letterSpacing="-0.96px"):(a[c].style.backgroundColor=ONE_CLR_FILEBROWSER_OFF,a[c].lastChild.style.fontWeight="normal",a[c].lastChild.style.letterSpacing="-0.8px")}setTimeout(function(){initLnbScrollBar()},200)}catch(f){dalert(f)}}
function getSortTitle(){var b="";switch(oneffice.getListViewMgr().m_SortType){case VIEWSORT.NAME:b=ID_RES_CONST_STRING_SEARCH_TYPE_OPTION_SUBJECT+" ";break;case VIEWSORT.SIZE:b=ID_RES_CONST_STRING_FILE_SIZE+" ";break;case VIEWSORT.MODDATE:b=ID_RES_CONST_STRING_LAST_MODIFIED_DATE+" ";break;case VIEWSORT.SHAREDATE:b=ID_RES_CONST_STRING_SHARED_DATE+" ";break;case VIEWSORT.OWNER:b=ID_RES_CONST_STRING_OWNER+" "}return b}
function createFolderListItemTitle(b,a,c,d,f){try{var e=document.createElement("div");e.className=b;e.innerHTML=a;"string"==typeof d&&d.length&&(e.style.minWidth=d);return e}catch(g){dalert(g)}}
function makeFolderInfoInit(b){try{var a=document.getElementById("dze_idx_folder_info");a.innerHTML="";var c=createFolderListItemTitle("cloud_info_text_item",ID_RES_CONST_STRING_IMPORTANT,VIEWSORT.IMPORTANT,"76px");a.appendChild(c);var d=createFolderListItemTitle("cloud_folder_info_item_name",ID_RES_CONST_STRING_DOCUMENT_TITLE,VIEWSORT.NAME);d.className+=" cloud_info_text_item";d.style.marginRight="27px";d.style.paddingTop="0";a.appendChild(d);var f=createFolderListItemTitle("cloud_info_text_item",
ID_RES_CONST_STRING_FILE_TYPE,VIEWSORT.TYPE,"175px"),e=createFolderListItemTitle("cloud_info_text_item",ID_RES_CONST_STRING_FILE_SIZE,VIEWSORT.SIZE,"120px"),g=createFolderListItemTitle("cloud_info_text_item",makeDateListItemTitle(),VIEWSORT.MODDATE,"190px"),h=createFolderListItemTitle("cloud_info_text_item",ID_RES_CONST_STRING_OWNER,VIEWSORT.OWNER,"150px");oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST&&oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST&&
oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_RECENT&&oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_SHARE&&(h.style.display="none");a.appendChild(f);a.appendChild(h);a.appendChild(g);a.appendChild(e);if(!0!==b){var l=oneffice.getListViewMgr();g_objSupport?g_objSupport.bThumbListView&&!0===g_objSupport.bThumbListDefaultView&&l.setListViewType(DRIVE_FILE_VIEW.THUMBNAIL_ITEM):l.setListViewType(DRIVE_FILE_VIEW.THUMBNAIL_ITEM)}}catch(k){dalert(k)}}
function setCheckAllFolderItems(b,a){try{var c=null;c="undefined"==typeof a?document.getElementsByClassName("cloud_file_list_item"):a.getElementsByClassName("cloud_file_list_item");if(b)for(var d=0;d<c.length;d++)"cloud_folder_info_item_checkbtn"===c[d].childNodes[0].className&&(c[d].childNodes[0].checked=!0,c[d].style.backgroundColor="#CFF1FF");else for(d=0;d<c.length;d++)"cloud_folder_info_item_checkbtn"===c[d].childNodes[0].className&&(c[d].childNodes[0].checked=!1,c[d].style.backgroundColor="#ffffff")}catch(f){dalert(f)}}
function resetFolderPath(b,a){onefficeGW.getFolderContent(b,function(a){dlog(a);m_aStrUpperFolderSeq=[];var c=!0,f=0;if(""!=a.folderSeq)for(m_aStrUpperFolderSeq.push({curTitle:a.subject,parentSeq:a.folderSeq});c;)f++,100===f&&(c=!1),onefficeGW.getFolderContent(b,function(a){m_aStrUpperFolderSeq.push({curTitle:a.subject,parentSeq:a.folderSeq})},!1),c=!1;else m_aStrUpperFolderSeq.push({curTitle:a.subject,parentSeq:a.folderSeq})},!1)}
function makeParentFolderItem(b,a){try{var c=oneffice.getListViewMgr();onefficeGW.getFolderContent(b,function(b){g_objTagUtil.removeChild(document.getElementById("cloud_file_list_root"),null,null);var d=document.createElement("div");d.className="cloud_file_list_item";d.id="drive_fileItem_0";var e=document.createElement("div");e.className="cloud_file_list_open_area";d.appendChild(e);var g=document.createElement("div");g.className="cloud_folder_info_item_icon";g.innerHTML='<img src="./image/cloud/ico_cloud_renewal_list_folder.png"/>';
g.disabled=!0;d.title=ID_RES_CONST_STRING_MOVE_TO_PARENT_FOLDER;e.appendChild(g);var h=document.createElement("div");h.className="cloud_folder_info_item_name";h.innerHTML="..";e.appendChild(h);""==oneffice_cloud_currFolderSeq&&0==oneffice_cloud_currFolderSeq||oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_MYONEFFICE||onefficeGW.getFolderContent(oneffice_cloud_currFolderSeq,function(a){a=c.setThumbData(a);oneffice_cloud_currFolderList=[];oneffice_cloud_currFolderList.push(a)});d.onmouseover=
function(){this.style.backgroundColor="#F5F5F5"};d.onmouseout=function(){this.style.backgroundColor="#ffffff"};(function(){var a=b.folderSeq;!0===g_browserCHK.mobile?h.onclick=function(){oneffice_cloud_currFolderSeq=a;updateFileList(a,!0);selectBrowserFolderItem(a)}:(e.ondblclick=function(){c.isRootFolder()||c.updateRootFolderStack();oneffice_cloud_currFolderSeq=a;updateFileList(a,!0);selectBrowserFolderItem(a)},e.onmouseup=function(){document.getElementById("copyDiv")&&checkCopyListTo(oneffice_cloud_checkedItemList,
a,!0)})})();"function"===typeof a&&a(d)})}catch(d){dalert(d)}}
function getFileTypeStatusHTML(b){try{var a="",c=document.createElement("div"),d=document.createElement("img"),f=document.createElement("div"),e=document.createElement("span");c.style.width="47px";c.style.height="24px";c.style.borderRadius="2px";d.style.verticalAlign="middle";d.style.alignContent="left";f.style.display="inline";f.style.marginLeft="3px";e.style.lineHeight="24px";e.style.fontSize="12px";e.style.verticalAlign="middle";e.style.color="#0d6b5f";c.appendChild(d);f.appendChild(e);c.appendChild(f);
switch(b){case CLOUD_CONST_FILE_TYPE_SEND_MYNEWS:c.style.backgroundColor="#acf0e7";d.src="./image/cloud/ico_cloud_renewal_send_mynews.png";d.style.width="13px";d.style.height="13px";e.textContent=ID_RES_CONST_STRING_POST_MYNEWS;a=c.outerHTML;break;case CLOUD_CONST_FILE_TYPE_READONLY:c.style.backgroundColor="#d8e4ff";c.style.width="69px";d.src="./image/cloud/icon-doc-readonly.png";e.textContent=ID_RES_CONST_STRING_READ_ONLY;a=c.outerHTML;break;case CLOUD_CONST_FILE_TYPE_SECURITY:c.style.backgroundColor=
"#ffe9e3";d.src="./image/cloud/icon-doc-security.png";e.textContent=ID_RES_CONST_STRING_SECURITY;a=c.outerHTML;break;case CLOUD_CONST_FILE_TYPE_SHARE_IN:c.style.backgroundColor="#acf0e7";d.src="./image/cloud/ico_cloud_renewal_share_in.png";d.style.width="13px";d.style.height="13px";e.textContent=ID_RES_CONST_STRING_SHARE_DOCUMENT;a=c.outerHTML;break;case CLOUD_CONST_FILE_TYPE_SHARE_OUT:c.style.backgroundColor="#acf0e7",d.src="./image/cloud/ico_cloud_renewal_share_out.png",d.style.width="13px",d.style.height=
"13px",e.textContent=ID_RES_CONST_STRING_SHARE_DOCUMENT,a=c.outerHTML}return a}catch(g){dalert(g)}}function returnPageTrash(b,a){return oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_TRASHBOX?(a=ID_RES_CONST_STRING_DELETE_CONTAINS_IMPORTANT_FOLDER,b&&(a=ID_RES_CONST_STRING_DELETE_CONTAINS_IMPORTANT_DOCUMENT),cmnCtrlToast.showToastMsg(null,a,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR),!0):!1}
function makeFileItem(b,a,c,d){try{var f=oneffice.getListViewMgr();document.getElementById("dze_idx_filelist");var e=document.createElement("div");e.id="drive_fileItem_"+a;e.className="cloud_file_list_item";e.setAttribute("seq",b.seq);var g=document.createElement("div");g.className="cloud_favorite_info_item_icon";g.innerHTML=b.owner_id&&oneffice_cloud_myInfoData.id!==b.owner_id?'<img src="./image/cloud/ico_cloud_favorite_empty.png" style="opacity:0.5;" />':0==b.important?'<img src="./image/cloud/ico_cloud_favorite_empty.png" onclick="onefficeGW.setFavorite(\''+
b.seq+"', true);\" />":'<img src="./image/cloud/ico_cloud_favorite.png" onclick="onefficeGW.setFavorite(\''+b.seq+"', false);\" />";b.seq!==CLOUD_CONST_STRING_GUIDE_SEQ&&b.seq!==CLOUD_CONST_STRING_VIDEO_MANUAL_SEQ&&e.appendChild(g);var h=document.createElement("div");h.className="cloud_file_list_open_area";e.appendChild(h);var l=document.createElement("div");l.className="cloud_folder_info_item_icon";0==b.type?l.innerHTML='<img src="./image/cloud/ico_cloud_renewal_list_folder.png"/>':oneffice_cloud_currentBrowserMode==
CLOUD_CONST_BROWSER_MODE_NEWSROOM||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST?(oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST&&onefficeUtil.isRegArticle(b.seq),l.innerHTML='<img src="./image/cloud/ico_cloud_renewal_news.png"/>'):oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_FAVORITE||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_TRASHBOX?
onefficeUtil.isRegArticle(b.seq)?l.innerHTML='<img src="./image/cloud/ico_cloud_renewal_news.png"/>':onefficeUtil.isArticle(b.folderSeq)?l.innerHTML='<img src="./image/cloud/ico_cloud_renewal_news.png"/>':l.innerHTML='<img src="./image/cloud/ico_cloud_renewal_file.png"/>':l.innerHTML='<img src="./image/cloud/ico_cloud_renewal_file.png"/>';h.appendChild(l);var k=document.createElement("div");k.className="cloud_folder_info_item_name";k.innerHTML=b.subject;k.title=b.subject;c=this.getSearchMgr().getKeyword();
if(!1===fnObjectCheckNull(c)&&0<c.length){var n=k.innerHTML.search(new RegExp(c,"i"));if(0<=n){var m=k.innerHTML.substr(n,c.length);k.innerHTML=k.innerHTML.replace(m,makeSearchMatchSpan(m))}}var t=onefficeCommon.isOnefficeGuideDoc(b.seq);t&&(k.style.fontWeight="bold");if(!t){var u=document.createElement("span");u.setAttribute("txt_chg_own","");u.seq=b.seq;b.owner_change?(u.style.display="",u.innerHTML=ID_RES_STRING_CHG_OWN_ING):(u.style.display="none",u.innerHTML="");k.appendChild(u)}h.appendChild(k);
var p=document.createElement("div");p.className="cloud_file_type_area";h.appendChild(p);if(1==b.type&&b.seq!==CLOUD_CONST_STRING_GUIDE_SEQ&&b.seq!==CLOUD_CONST_STRING_VIDEO_MANUAL_SEQ){if(oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_RECENT||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SHARE||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST){var r=document.createElement("div");
r.className="cloud_folder_info_item_shareowner";r.style.width="90px";var q=b.owner_name?b.owner_name:b.owner_id;r.innerHTML=q;r.setAttribute("title",q);!1===fnObjectCheckNull(c)&&0<c.length&&(r.innerHTML=r.innerHTML.replace(c,makeSearchMatchSpan(c)));h.appendChild(r)}var v=document.createElement("div");v.className="cloud_folder_info_item_modified";v.style.width="130px";v.innerHTML=convertDateDiff(convertDate(b,0));h.appendChild(v);var w=document.createElement("div"),x=onefficeUtil.getFileSizeUnits(b.content_size);
w.className="cloud_folder_info_item_filesize";w.style.width="60px";w.innerHTML=x;h.appendChild(w)}var y=!0;a=oneffice_cloud_currentBrowserMode;if(a===CLOUD_CONST_BROWSER_MODE_SHARE||a===CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST||a===CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT||a===CLOUD_CONST_BROWSER_MODE_RECENT||a===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH)y=checkOwnerDocument(b,!0);var z=b.share_count;oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_RECENT&&(""!=b.share_date&&b.owner_id===oneffice_cloud_myInfoData.id&&
0<b.share_count&&(z=1),b.owner_id!=oneffice_cloud_myInfoData.id&&(z=2));if(0<Number(z)){var A=document.createElement("div");A.className="cloud_file_type_icon";A.innerHTML=getFileTypeStatusHTML(y?CLOUD_CONST_FILE_TYPE_SHARE_OUT:CLOUD_CONST_FILE_TYPE_SHARE_IN);p.appendChild(A);A.onclick=function(a){showDialogDocumentShareInfo(a,b.seq,y)}}if(b.security_key&&"0"!==b.security_key){var B=document.createElement("div");B.className="cloud_file_type_icon";B.innerHTML=getFileTypeStatusHTML(CLOUD_CONST_FILE_TYPE_SECURITY);
p.appendChild(B)}if(0<parseInt(b.readonly,10)){var C=document.createElement("div");C.className="cloud_file_type_icon";C.innerHTML=getFileTypeStatusHTML(CLOUD_CONST_FILE_TYPE_READONLY);p.appendChild(C)}if((oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_NEWSROOM||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_FAVORITE||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_TRASHBOX)&&onefficeUtil.isRegArticle(b.seq)){var D=
document.createElement("div");D.className="cloud_file_type_icon";D.innerHTML=getFileTypeStatusHTML(CLOUD_CONST_FILE_TYPE_SEND_MYNEWS);p.appendChild(D)}(function(){if(!0===g_browserCHK.mobile)k.onclick=function(){oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_TRASHBOX&&(0==b.type?(oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_MYONEFFICE&&(oneffice_cloud_SearchMode&&searchCloudEnd(!1),changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_MYONEFFICE)),oneffice_cloud_currFolderSeq=
b.seq,updateFileList(b.seq,!0),selectBrowserFolderItem(b.seq)):1!=b.deleted&&(oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARE&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_RECENT||0!==b.share_count||b.owner_id==oneffice_cloud_myInfoData.id?onefficeGW.openDocument(b.seq):oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_RECENT?onefficeCommon.getTempFileContent(docSeq,function(a){1==
a?onefficeGW.openDocument(docSeq):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECENT_NO_SHARE_DOCUMENT,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR)}):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECENT_NO_SHARE_DOCUMENT,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR)))};else{var a=function(a){var b=document.getElementById("dze_idx_folder_info");if(b){var c=document.getElementById("dze_idx_filelist");dzeJ(b).on("mouseover",function(a){dzeJ(c).animate({scrollTop:1},1E3)}).on("mouseout",
function(a){dzeJ(c).stop()})}b=document.getElementById("dze_idx_cloud_container");document.getElementById("copyDiv");var d=document.getElementsByClassName("list_checked"),f=document.createElement("div");f.id="copyDiv";f.style.opacity="0";for(var e=0;e<d.length;e++){var g=dzeJ(d[e]).clone()[0];g.style.width=a.clientWidth+"px";g.style.height=a.clientHeight+"px";g.style.zIndex="1000";f.appendChild(g)}b.appendChild(f);var h=0;dzeJ(b).on("mousemove",function(a){var b=a.pageX-dzeJ(copyDiv).width()/4;a=
a.pageY+5;h++;10<h&&(copyDiv.style.opacity="0.5");dzeJ(copyDiv).offset({left:b,top:a})}).on("mouseup",function(b){dzeJ(a).removeClass("movable");b=document.getElementById("dze_idx_cloud_container");dzeJ(b).off("mousemove");b=document.getElementById("dze_idx_folder_info");dzeJ(b).off("mouseover");(b=document.getElementById("copyDiv"))&&b.parentNode.removeChild(b)})};dzeJ(h).on("mousedown",function(c){var d=DZESHORTCUT.isPressedKeyMapForOS(c,ID_KEYCODE_CTRL),e=c.shiftKey;c=c.currentTarget.parentElement;
(!d&&!e||chkBrowserSearchMode())&&0>c.className.indexOf("list_checked")&&resetCheckListFunc(!0);if(e&&firstShiftBtn&&!chkBrowserSearchMode())for(resetCheckListFunc(!0),e=f.getBtnIdx(firstShiftBtn,2),c=f.getBtnIdx(c,2),d=e<=c?c:e,e=e<=c?e:c;e<=d;e++){c=document.getElementById("drive_fileItem_"+e);var g=oneffice_cloud_currentItemList[f.getDataIdx(e)];null===c&&(c=document.getElementById("drive_fileItem_"+ ++e));onefficeCommon.isOnefficeGuideDoc(c.getAttribute("seq"))||""==c.getAttribute("seq")||(c.classList.add("list_checked"),
c.checked=!0,updateCheckedItemList(c,g))}else b&&(b.fileType=0==f.isFolder(b)?1:0,docSeq=b.seq,bFolder=b.fileType?!1:!0,docInfo=b.docData),onefficeCommon.isOnefficeGuideDoc(docSeq)||(0>c.className.indexOf("list_checked")?(c.classList.add("list_checked"),c.checked=!0):!e&&!d||chkBrowserSearchMode()||(c.classList.remove("list_checked"),c.checked=!1),updateCheckedItemList(c,b));d=this.parentNode;0>d.className.indexOf("list_checked")||oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_MYONEFFICE||
(dzeJ(d).addClass("movable"),a(d))}).on("mouseup",function(a){var c=this.parentNode,d=document.getElementById("copyDiv"),e=DZESHORTCUT.isPressedKeyMapForOS(a,ID_KEYCODE_CTRL);a=a.shiftKey;targetDiv=c;childDiv=targetDiv.getElementsByClassName("cloud_folder_info_item_icon")[0].firstElementChild;(null===d||null!=d&&"0"===d.style.opacity)&&!e&&!a&&0<targetDiv.className.indexOf("list_checked")&&(1===oneffice_cloud_checkedItemList.length&&targetDiv.getAttribute("seq")===oneffice_cloud_checkedItemList[0].seq&&
lastSelectBtn===targetDiv?resetCheckListFunc(!0):(firstShiftBtn=lastSelectBtn=null,0<oneffice_cloud_checkedItemList.length&&resetCheckListFunc(!0),targetDiv.classList.add("list_checked"),targetDiv.checked=!0,updateCheckedItemList(targetDiv,b)));if(0<childDiv.src.indexOf("ico_cloud_renewal_list_folder")&&0>targetDiv.className.indexOf("movable")&&d){if(0<targetDiv.className.indexOf("list_checked"))return;updateCheckedItemList(targetDiv,b);c=targetDiv.getAttribute("seq");checkCopyListTo(oneffice_cloud_checkedItemList,
c,!0)}else if(lastSelectBtn&&lastSelectBtn==targetDiv)targetDiv.classList.remove("list_checked"),targetDiv.checked=!1,firstShiftBtn=lastSelectBtn=null,resetCheckListFunc(!0),f.updateMenuItem();else{if(a&&!chkBrowserSearchMode()){null==firstShiftBtn&&null==lastSelectBtn?lastSelectBtn=firstShiftBtn=targetDiv:null!=firstShiftBtn&&(lastSelectBtn=targetDiv);f.updateMenuItem();return}e&&!chkBrowserSearchMode()&&(firstShiftBtn=targetDiv);e||a||(firstShiftBtn=lastSelectBtn=targetDiv);lastSelectBtn=targetDiv}f.updateMenuItem()});
h.ondblclick=function(){if(returnPageTrash(!f.isFolder(b)))return!1;var a=oneffice_cloud_currentBrowserMode;if(f.isFolder(b)){var c=f.m_aStrUpperFolderSeq.length;a!=CLOUD_CONST_BROWSER_MODE_FAVORITE&&a!=CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH&&0<c&&f.m_aStrUpperFolderSeq[c-1].curTitle!=b.subject?f.m_aStrUpperFolderSeq.push({parentSeq:oneffice_cloud_currFolderSeq,curTitle:b.subject}):a!=CLOUD_CONST_BROWSER_MODE_FAVORITE&&a!=CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH||f.getThumbListView()||(f.m_bDirectFolder=
!0);oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_MYONEFFICE&&(oneffice_cloud_SearchMode&&searchCloudEnd(!1),changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_MYONEFFICE));oneffice_cloud_currFolderSeq=b.seq;updateFileList(b.seq,!0);selectBrowserFolderItem(b.seq)}else 1!=b.deleted&&(oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARE&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_RECENT||
0!==b.share_count||b.owner_id==oneffice_cloud_myInfoData.id?onefficeGW.openDocument(b.seq):oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_RECENT?onefficeCommon.getTempFileContent(docSeq,function(a){1==a?onefficeGW.openDocument(docSeq):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECENT_NO_SHARE_DOCUMENT,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR)}):cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECENT_NO_SHARE_DOCUMENT,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR))}}e.onmouseover=
function(){for(var a=0;a<e.childNodes.length;a++)"cloud_folder_info_item_checkbtn"===e.childNodes[a].className&&!1===e.childNodes[a].checked&&(this.style.backgroundColor="#F5F5F5")};e.onmouseout=function(){for(var a=0;a<e.childNodes.length;a++)"cloud_folder_info_item_checkbtn"===e.childNodes[a].className&&!1===e.childNodes[a].checked&&(this.style.backgroundColor="#ffffff")}})();return e}catch(E){dalert(E)}}
function updateFileListView(b){try{if(!(fnObjectCheckNull(oneffice.m_FileItemListDiv)||!oneffice.m_FileItemListDiv.childElementCount||oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_RECENT&&0<oneffice_cloud_current_search_BackupItemList.length)){for(var a=oneffice.getListViewMgr(),c=0;c<oneffice_cloud_currentItemList.length;c++){var d=makeFileItem(oneffice_cloud_currentItemList[c],c),f=oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_MYONEFFICE&&oneffice_cloud_currFolderSeq.length?
c+1:c;0<oneffice_cloud_current_search_BackupItemList.length&&(f=c);oneffice.m_FileItemListDiv.children.length>f&&oneffice.m_FileItemListDiv.replaceChild(d,oneffice.m_FileItemListDiv.children[f])}var e=g_searchMgr.getSearchType()==SEARCH_TYPE.CUR&&g_searchMgr.getKeyword().length?!0:!1;a.createThumbnailView(e?"":oneffice_cloud_currFolderSeq,b)}}catch(g){dalert(g)}}
function g_ChangeCategory(b,a,c){try{oneffice_cloud_SearchMode&&searchCloudEnd(!0,a),oneffice_cloud_currentBrowserMode===a?oneffice_cloud_currentItemList=[]:changeCurBrowserMode(a),selectBrowserFolderItem(c.getAttribute("folderSeq"),!0),TBCancelBubbleEvent(b)}catch(d){dalert(d)}}
function emptyListContent(){var b="<div>"+ID_RES_CONST_STRING_SELECT_IS_EMPTY+'<br><span class="empty_new_doc_btn">'+ID_RES_CONST_STRING_SELECT_IS_EMPTY_NEWDOC+" </span>"+ID_RES_CONST_STRING_SELECT_IS_EMPTY_TEMPLATE_MSG+"</div>",a=dzeJ('<div class="oneffice_empty_msg"></div>');a.html(b);dzeJ("#drive_thumbnailItemPanel, #dze_idx_filelist").html(a);dzeJ(".empty_new_doc_btn").css("color","#0095F4");dzeJ(".empty_new_doc_btn").on("click",function(a){executeCloudCommand(a,CLOUD_CMD_CREATE_FILE)})}
function g_updateListSuccessCB(b,a,c,d){try{var f=oneffice.getListViewMgr();f.getSearchMgr();if(d)a=convertShareListData(CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+oneffice_cloud_currentBrowserMode,a);else switch(oneffice_cloud_currentBrowserMode){case CLOUD_CONST_BROWSER_MODE_NEWSROOM:case CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST:case CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST:a=convertNewsListData(CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+oneffice_cloud_currentBrowserMode,a)}null!=dzeJ(".oneffice_empty_msg")&&
dzeJ(".oneffice_empty_msg").remove();var e=document.getElementById("dze_idx_filelist"),g=makeFileListView(a,e,b,c,d);if(oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH){viewFolderPathInfo("search");var h=document.getElementById("dze_idx_search_result_text"),l=document.getElementById("dze_idx_cloud_search_input").value;b=0;if(oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT)switch(oneffice_cloud_search_more_index){case 1:b=
oneffice_cloud_search_myonefficeItemList.length;break;case 2:b=oneffice_cloud_search_shareOutItemList.length;break;case 3:b=oneffice_cloud_search_shareInItemList.length}else oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH&&(b=oneffice_cloud_search_myonefficeItemList.length+oneffice_cloud_search_shareOutItemList.length+oneffice_cloud_search_shareInItemList.length);h.innerHTML=String.format(ID_RES_CONST_STRING_BROWSER_UNIFIED_SEARCH_RESULT,makeSearchMatchSpan(l),makeSearchMatchSpan(b))}else 0<=
g&&viewFolderPathInfo(oneffice_cloud_currFolderSeq,k);var k=oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_RECENT;if(k&&0===a.length)emptyListContent(),dzeJ("#dze_idx_filelist_search").hide();else{f.updateMenuItem();var n=document.getElementById("dze_idx_top_panel"),m=n&&"100%"===n.style.height;chkBrowserSearchMode()||m||dzeJ("#dze_idx_filelist_search").show()}closeHomePopup()}catch(t){dalert(t)}}
function makeOnefficeGuideDoc(){try{var b=function(a){a=onefficeCommon.getOnefficeGuideDoc(a);var b=onefficeCommon.newFileContent();b.seq=a.seq;b.subject=a.title;b.moddate="<div>&nbsp;</div>";return b};return[b(CLOUD_CONST_STRING_GUIDE_SEQ),b(CLOUD_CONST_STRING_VIDEO_MANUAL_SEQ)]}catch(a){dalert(a)}}
function makeFileListView(b,a,c,d,f){try{var e=-1,g=oneffice.getListViewMgr();g.getListViewType();var h=!1,l=null;fnObjectCheckNull(d)?e=setCurItemListPreProcess(b,!1,f):oneffice_cloud_SearchMode||""==d?e=setCurItemListPreProcess(b,!0):(e=setCurItemListPreProcess(b),0<=e&&(h=!0));0<=e&&(!1!==fnObjectCheckNull(oneffice.m_FileItemListDiv)||f||(oneffice.m_FileItemListDiv.innerHTML=""),""!=d&&null===document.getElementById("cloud_file_list_root")&&h?makeParentFolderItem(d,function(b){l=b;a.insertBefore(l,
a.firstChild)}):g_objTagUtil.removeChild(document.getElementById("cloud_file_list_root"),null,null));makeFolderInfoInit(!0);if(oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT){g.changeFolderInfo();var k=g.getSearchMgr();k&&k.makeSearchListView()}else if(0<=e){k=0;d=b;var n=d.length;f?(k=oneffice.currentShareListOffset,0>=k&&(k=0),g.setCurThumbListData("",b),n=oneffice.currentShareListOffset+oneffice.currentShareListLimit):
(d=oneffice_cloud_currentItemList,n=oneffice_cloud_currentItemList.length);for(;k<n&&void 0!==d[k];k++){var m=k;h&&(m+=1);l=makeFileItem(d[k],m);a.appendChild(l)}g.createThumbnailView(h?oneffice_cloud_currFolderSeq:"",f,b)}setElementFade(a,c);return e}catch(t){dalert(t)}}function clearShareProcess(){null!=oneffice.currentShareRenderTimer&&(clearTimeout(oneffice.currentShareRenderTimer),oneffice.currentShareRenderTimer=null);oneffice.currentShareRenderUse=!1;oneffice.currentShareListOffset=0}
function convertNewsListData(b,a){try{for(var c=[],d=CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE,f=null,e=0;e<a.length;e++)if(f=a[e],"1"!==f.deleted)switch(b){case d+CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST:onefficeUtil.isRegArticle(f.seq)||c.push(f);break;case d+CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST:onefficeUtil.isRegArticle(f.seq)&&c.push(f);break;default:c.push(f)}return c}catch(g){dalert(g)}}
function convertShareListData(b,a){var c=[];if(CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST===b)for(b=0;b<a.length;b++)a[b].owner_id===oneffice_cloud_myInfoData.id&&1!=a[b].deleted&&c.push(a[b]);else if(CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST===b)for(b=0;b<a.length;b++)a[b].owner_id!==oneffice_cloud_myInfoData.id&&c.push(a[b]);else for(b=0;b<a.length;b++)"1"!==a[b].deleted&&c.push(a[b]);return c}
function getListDataProcess(b,a,c,d){oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARE&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST&&clearShareProcess();1!=d&&(oneffice.currentShareListOffset=0);try{switch(oneffice_cloud_currentBrowserMode){case CLOUD_CONST_BROWSER_MODE_SHARE:case CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST:case CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST:var f=oneffice.getListViewMgr();
oneffice.currentShareRenderUse&&0!==oneffice_cloud_currentItemList.length?(parseInt(b),0===oneffice.currentShareListOffset&&(dzeJ("#dze_idx_filelist").html(""),dzeJ("#drive_thumbnailItemPanel").html("")),oneffice_cloud_currentItemList=onefficeUtil.SortFileList(oneffice_cloud_currentItemList,f.m_nSortArrowImgDegree),g_updateListSuccessCB(a,oneffice_cloud_currentItemList,null,!0)):(oneffice.currentShareListOffset=0,getFolderItemsInShare(function(c){dzeJ("#dze_idx_filelist").html("");dzeJ("#drive_thumbnailItemPanel").html("");
oneffice.currentShareListOffset=0;parseInt(b);oneffice_cloud_currentItemList=onefficeUtil.SortFileList(c,f.m_nSortArrowImgDegree);g_updateListSuccessCB(a,oneffice_cloud_currentItemList,null,!0);oneffice.currentShareRenderTimer=setTimeout(function(){oneffice.currentShareRenderUse=!1},1E3*oneffice.currentShareRenderTime)}));break;case CLOUD_CONST_BROWSER_MODE_RECENT:getFolderItemsInRecent(100,function(b){!1===oneffice_cloud_firstload&&0===b.length?(oneffice_cloud_firstload=!0,changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_RECENT),
selectBrowserFolderItem("",!0)):g_updateListSuccessCB(a,b)});break;case CLOUD_CONST_BROWSER_MODE_SECURITY:getFolderItemsInSecurity(function(b){g_updateListSuccessCB(a,b)});break;case CLOUD_CONST_BROWSER_MODE_FAVORITE:getFolderItemsInFavorite(function(b){g_updateListSuccessCB(a,b)});break;case CLOUD_CONST_BROWSER_MODE_TRASHBOX:getFolderItemsInTrashbox(function(b){g_updateListSuccessCB(a,b)});break;case CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT:case CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH:getSearchItemsAllFolder(b,
c,function(c){g_updateListSuccessCB(a,c,b)});break;case CLOUD_CONST_BROWSER_MODE_NEWSROOM:case CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST:case CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST:getFolderItemsInNewsroom(function(b){g_updateListSuccessCB(a,b)});break;default:getAllItemsInFolder(b,c,function(c){g_updateListSuccessCB(a,c,b)})}}catch(e){dalert(e)}}
function focusFuncInitList(){0<oneffice_cloud_current_search_BackupItemList.length||null===oneffice_cloud_myInfoData||(updateFileList(oneffice_cloud_currFolderSeq,!1),selectBrowserFolderItem(oneffice_cloud_currFolderSeq))}
function updateFileList(b,a,c){try{"undefined"===typeof b&&(b=oneffice_cloud_currFolderSeq);"undefined"===typeof a&&(a=!0);if("undefined"===typeof c){var d=document.getElementById("dze_idx_cloud_search_input");c=!1===fnObjectCheckNull(d)?d.value:""}"function"===typeof endCurrentSearchStatus&&endCurrentSearchStatus();var f=document.getElementById("dze_idx_filelist");if(fnObjectCheckNull(f))return!1;oneffice.m_bFolderChangeUpdate&&(oneffice.m_bFolderChangeUpdate=!1,resetFolderListItems(!0));if(!isNaN(b)&&
!1===oneffice_cloud_SearchMode){var e=parseInt(b);CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_MAX>e&&(e-=CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE,changeCurBrowserMode(e))}getListDataProcess(b,a,c);setTimeout(function(){updateCloudContainerSize(!0)},a?100:0)}catch(g){dalert(g)}}
function setCurrentItemList(b){try{var a=0,c=oneffice.getListViewMgr(),d=c.getSearchMgr();if(!b)return null;var f=c.getThumbListView();oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_MYONEFFICE&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARE&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST&&JSON.stringify(b)===JSON.stringify(oneffice_cloud_currentItemList)&&!d.m_bForceUpdate||
oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH||(oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARE&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST&&(oneffice_cloud_currentItemList=b),oneffice_cloud_checkedItemList=[],f&&c.setCurThumbListData(oneffice_cloud_currFolderSeq),d.m_bForceUpdate&&(d.m_bForceUpdate=!1),a=1);return a}catch(e){dalert(e)}}
function setCurItemListPreProcess(b,a,c){try{if(fnObjectCheckNull(b))return 0;oneffice.m_FileItemListDiv||(oneffice.m_FileItemListDiv=document.getElementById("dze_idx_filelist"));fnObjectCheckNull(oneffice.m_FileItemListDiv);for(var d=0;d<b.length;d++)""===b[d].subject&&b[d].regdate&&(b[d].subject=oneffice.unTitleMsg+" "+b[d].regdate.replace(/:/g,"").substr(5,b[d].regdate.length));var f=oneffice.getListViewMgr(),e=onefficeUtil.SortFileList(b,f.m_nSortArrowImgDegree,c);e=removeOnefficeGuideDoc(e);
if(!fnObjectCheckNull(a)&&a){var g=makeOnefficeGuideDoc();for(d=g.length-1;0<=d;d--)g[d]&&e.unshift(g[d])}return setCurrentItemList(e)}catch(h){dalert(h)}}function removeOnefficeGuideDoc(b){var a=g_arrGuideDoc;if(a){for(var c=[],d=0,f=a.length;d<f;d++)c.push(a[d].seq);for(d=0;d<b.length;d++)0<=c.indexOf(b[d].seq)&&(b.splice(d,1),d--);return b}}
function folderPathMove(b){var a=oneffice.getListViewMgr();oneffice_cloud_currFolderSeq=b;a.getListViewType()&&(a.m_bChkListInit=!0,a.m_nCheckLstInitMode=CHECKLISTINITMODE.CLK_PATHFOLDER);updateFileList(b);resetBrowserFolderSelection(oneffice_cloud_currFolderSeq);a.isRootFolder()||a.updateRootFolderStack(b)}function createFolderSubPath(b){var a=[],c=[],d=b.length-3;a[0]=b[0];for(var f=1;b.length>f;f++){var e=b[f];d>f?(c.push(e),a[1]=["folderlist","..."]):a.push(e)}return{path:a,subPath:c}}
function createSubFolderList(b){var a=dzeJ("<div></div>");dzeJ(".cloud_folder_sub_container").remove();a.addClass("cloud_folder_sub_container");for(var c=0;c<b.length;c++){var d=b[c],f=d[0];d=d[1];var e=dzeJ("<div></div>");e.addClass("cloud_folder_sub_list");e.text(d);e.attr("title",d);e.on("click",function(){folderPathMove(f)});a.append(e)}return a}
function viewFolderPathInfo(b){try{var a=dzeJ("#dze_idx_toolbar_menu_list"),c=dzeJ("#dze_idx_folderlist");a.attr("folderPathSeq",b);c.attr("folderPathSeq",b);var d=dzeJ("<div/>",{id:"dze_idx_folder_path_info_container"});d.css("float","left");d.css("margin","13px 0 13px 20px");var f=dzeJ("<div />");f.css("verticalAlign","middle");f.css("float","left");f.css("padding","5px 0");f.css("width","18px");f.css("height","18px");f.css("marginRight","8px");var e=dzeJ("<img />",{src:""});e.css("float","left");
f.append(e);d.append(f);if(oneffice_cloud_currentBrowserMode!=CLOUD_CONST_BROWSER_MODE_MYONEFFICE){a.html("");c.html("");var g=dzeJ("<span/>").css("fontWeight","bold");b="./image/cloud/ico_cloud_renewal_menu_";switch(oneffice_cloud_currentBrowserMode){case CLOUD_CONST_BROWSER_MODE_RECENT:g.text(ID_RES_CONST_STRING_BROWSER_RECENT);b+="recent.png";break;case CLOUD_CONST_BROWSER_MODE_SHARE:g.text(ID_RES_CONST_STRING_BROWSER_SHARE);b+="share.png";break;case CLOUD_CONST_BROWSER_MODE_MY_SHARE_LIST:g.text(ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST);
b+="share_out.png";break;case CLOUD_CONST_BROWSER_MODE_SHARED_BY_LIST:g.text(ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST);b+="share_in.png";break;case CLOUD_CONST_BROWSER_MODE_SECURITY:g.text(ID_RES_CONST_STRING_BROWSER_SECURITY);b+="security.png";break;case CLOUD_CONST_BROWSER_MODE_FAVORITE:g.text(ID_RES_CONST_STRING_BROWSER_FAVORITE);b+="favorite.png";break;case CLOUD_CONST_BROWSER_MODE_TRASHBOX:g.text(ID_RES_CONST_STRING_BROWSER_TRASHBOX);b+="trashbox.png";g.css("cursor","pointer");var h=dzeJ("<div />");
h.css("float","right");h.css("verticalAlign","middle");var l=dzeJ("<img />",{src:""});l.css("float","right");l.css("marginLeft","5px");l.css("marginTop","5px");l.attr("src","./image/cloud/ico_cloud_menu_dropdown.png");h.append(l);g.append(h);g.click(function(){createTrashMenu(g)});break;case CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT:case CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH:g.attr("id","dze_idx_search_result_text");g.css("fontWeight","");b+="oneffice.png";f.remove();break;case CLOUD_CONST_BROWSER_MODE_NEWSROOM:g.text(ID_RES_CONST_STRING_BROWSER_NEWSROOM);
b+="newsroom.png";break;case CLOUD_CONST_BROWSER_MODE_MYNEWS_LIST:g.text(ID_RES_CONST_STRING_BROWSER_MYNEWS_LIST);b+="mynews.png";break;case CLOUD_CONST_BROWSER_MODE_SEND_MYNEWS_LIST:g.text(ID_RES_CONST_STRING_BROWSER_SEND_MYNEWS_LIST),b+="send_mynews.png"}g.addClass("folder_nav_list_item");e.attr("src",b);d.append(g);oneffice_cloud_currentBrowserMode==CLOUD_CONST_BROWSER_MODE_NEWSROOM&&(d[0].innerHTML+='<span ondblclick="onGetAccessUserFunctionInfo();" style="width:10px;">&nbsp;</span>');c.append(d);
a.append(c);a.append(oneffice.getListViewMgr().makeRightCtrl());oneffice.getListViewMgr().updateMenuItem()}else e.attr("src","./image/cloud/ico_cloud_renewal_menu_oneffice.png"),onefficeGW.getFolderPathInfo([],b,function(b){var f=oneffice.getListViewMgr(),e=b,g=null,h=null;f.m_bDirectFolder&&f.checkDirectFolderSeq(e);b=createFolderSubPath(e);e=b.path;for(var k=e.length,l=0;l<e.length;l++){0<l&&(h=dzeJ("<span/>"),h.html("&nbsp;&gt;&nbsp;"),h.addClass("folder_nav_list_item"),h.css("padding","5px 0"),
d.append(h));if(h="folderlist"===e[l][0]){var q=createSubFolderList(b.subPath);dzeJ("#dze_idx_browser_right_container").append(q)}g=dzeJ("<span/>");q=dzeJ("<span/>");q.html(e[l][1]);q.addClass("folder_nav_list_item_text");g.html(q);g.attr("docNo",e[l][0]);g.attr("title",e[l][1]);g.addClass(h?" sub_folder_popup":"");l==k-1&&(g.css("fontWeight","bold"),0!=l&&(h=dzeJ("<img />",{src:""}),h.css("float","right"),h.css("marginLeft","5px"),h.css("marginTop","5px"),h.attr("src","./image/cloud/ico_cloud_menu_dropdown.png"),
h.addClass("dze_idx_cloud_control_hover_dropdown"),g.addClass("dze_idx_cloud_control_hover"),g.append(h)));g.css("cursor","pointer");0===l?g.css("padding","5px 5px 5px 0"):g.css("padding","5px");(function(){var a=e[l][0];g.click(function(b){oneffice_cloud_currFolderSeq==a&&1<k?createFolderMenu(this):"folderlist"!==a||CLOUD_POPUP_FOLDER_NAVI_LIST_SHOW?folderPathMove(a):(setTimeout(function(){CLOUD_POPUP_FOLDER_NAVI_LIST_SHOW=!0},100),dzeJ(".sub_folder_popup").addClass("active"),dzeJ(".cloud_folder_sub_container").show())})})();
g.addClass("folder_nav_list_item");d.append(g)}c.html("");a.html("");c.append(d);a.append(c);a.append(f.makeRightCtrl());f.updateMenuItem()})}catch(k){dalert(k)}}
function reload(b){try{cmnDlg.isShowDlg()||duzon_dialog.dialogExtStatus||(!1===oneffice_cloud_firstload?oneffice_cloud_firstload=!0:oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT||oneffice_cloud_currentBrowserMode===CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH||0<oneffice_cloud_current_search_BackupItemList.length||("undefined"===typeof b&&(b=!1),updateFileList(oneffice_cloud_currFolderSeq,b),selectBrowserFolderItem(oneffice_cloud_currFolderSeq)))}catch(a){dalert(a)}}
function superUserCopyDocument(b){try{cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,"\uc0ac\uc6a9\uc790 \ubcf5\uc0ac ",getRenameFileContent(),[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){a=document.getElementById("dze_idx_rename_filename_input");if(""===a.value||"undefined"===a.value)alert("\ubb38\uc11c \ubc88\ud638\uac00 \uc5c6\uc2b5\ub2c8\ub2e4."),duzon_dialog.closeDialog();onefficeGW.copyFileToFolder(a.value,"",function(a){alert("\ubb38\uc11c \ubcf5\uc0ac \uc644\ub8cc ");
duzon_dialog.closeDialog()})},function(a){duzon_dialog.closeDialog()}],function(){},function(){},!0)}catch(a){dalert(a)}}function viewHomeUserInfo(){try{alert(ID_RES_CONST_STRING_COMMING_SOON)}catch(b){dalert(b)}}function removeHomeUserInfo(){try{var b=dzeJ("#dze_idx_cloud_user_info_BG");b&&b.remove();var a=dzeJ("#dze_idx_cloud_user_info_container");a&&a.remove();var c=dzeJ("#dze_idx_cloud_user_info_arrow");c&&c.remove()}catch(d){dalert(d)}}
function makeUserInfoDetailHTML(b){try{var a="";a+="<table cellspacing=0 cellpadding=0 border=0 style='width:100%; height:100%;'>";a+="<tr>";a+="<td><p style='margin:0; text-align:center;'><img width='64px' height='64px' style='margin-top:24px;border-radius:32px;' src='"+b.pic+"' /></p></td>";a+="</tr>";a+="<tr>";a+="<td><p id='dze_idx_cloud_user_info_name' style='text-align:center;'>"+b.name+"</p></td>";a+="</tr>";a+="<tr>";a+="<td style='width:100%; height:1px; border:solid #F0F0F0; border-width:1px 0 0 0;' />";
a+="</tr>";a+="<tr>";a+="<td>";a+="<span style='float:left; margin:5px 18px;'>"+ID_RES_CONST_STRING_USAGE+"</span>";a+="<span style='float:right; margin:5px 18px; color:#9E9E9E;'>26MB/200MB(13%)</span>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td style='padding:0 18px 8px;'>";a+="<div id='dze_idx_cloud_user_progress'>";a+="<div id='dze_idx_cloud_user_progress_bar' style='width:15%;'>15%</div>";a+="</div>";a+="</td>";a+="</tr>";a+="<tr>";a+="<td style='width:100%; height:1px; border:solid #F0F0F0; border-width:1px 0 0 0;' />";
a+="</tr>";a+="<tr>";a+="<td style='padding:0 18px 13px;'>";a+="<div>";a+="<table cellspacing=0 cellpadding=0 border=0 style='width:100%; height:100%;'>";a+="<tr>";a+="<td style='padding: 5px 0;'>"+ID_RES_CONST_STRING_BROWSER_MY+"</td>";a+="<td style='padding: 5px 0;'><span style='color:#1C90FB; font-weight:bold;'>24</span>\uac1c</td>";a+="<td style='padding: 5px 0; text-align:right; color:#9E9E9E;'>14.05MB</td>";a+="</tr>";a+="<tr>";a+="<td style='padding: 5px 0;'>"+ID_RES_CONST_STRING_SHARED_DOCUMENT+
"</td>";a+="<td style='padding: 5px 0;'><span style='color:#1C90FB; font-weight:bold;'>19</span>\uac1c</td>";a+="<td style='padding: 5px 0; text-align:right; color:#9E9E9E;'>9.84MB</td>";a+="</tr>";a+="<tr>";a+="<td style='padding: 5px 0;'>"+ID_RES_CONST_STRING_BROWSER_TRASHBOX+"</td>";a+="<td style='padding: 5px 0;'><span style='color:#1C90FB; font-weight:bold;'>7</span>\uac1c</td>";a+="<td style='padding: 5px 0; text-align:right; color:#9E9E9E;'>2.15MB</td>";a+="</tr>";a+="</table>";a+="</div>";
a+="</td>";return a+"</tr></table>"}catch(c){dalert(c)}}
function openOnlineManualPop(b){try{b=1300;var a=768;window.screen&&window.screen.availWidth&&window.screen.availHeight&&(b=b>window.screen.availWidth?window.screen.availWidth:b,a=a>window.screen.availHeight?window.screen.availHeight:a);var c=onefficeCommon.openWindow("oneffice_manual.html","onefficeHelpWindow","width="+b+",height="+a+",left=0,top=0,resizable=yes,scrollbars=yes");null==c?g_browserCHK.mobile||cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DISABLE_POPUP_BLOCKER,2,"screen_center"):
c.focus()}catch(d){dalert(d)}}
function openWriteMailView(b,a){try{var c=oneffice_cloud_myInfoData.emailUrl+ONEFFICE_GW_API_WRITE_MAIL;c+="?kind=plain&to=&fileList="+encodeURIComponent("1|"+b+"|"+a.size+"|"+a.url);b=1300;a=768;window.screen&&window.screen.availWidth&&window.screen.availHeight&&(b=b>window.screen.availWidth?window.screen.availWidth:b,a=a>window.screen.availHeight?window.screen.availHeight:a);var d=onefficeCommon.openWindow(c,"mailWriteWindow","width="+b+",height="+a+",left=0,top=0,resizable=yes,scrollbars=yes");null==
d?g_browserCHK.mobile||cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_DISABLE_POPUP_BLOCKER,2,"screen_center"):d.focus()}catch(f){dalert(f)}}function searchCloud(){try{searchCloudItems()}catch(b){dalert(b)}}
function searchCloudItems(){try{var b=oneffice.getListViewMgr(),a=b.getSearchMgr();oneffice_cloud_SearchMode&&(oneffice_cloud_search_more_index=0,a.setSearchType(SEARCH_TYPE.NONE),oneffice_cloud_SearchMode=!1,setFolderSearchEnable(!0));a.changeSearchViewDisplay(!0);setFolderSearchEnable(!1);var c=document.getElementById("dze_idx_cloud_search_input").value;a.setKeyword(c);dzeJ("#dze_idx_cloud_search_end_btn").show();setSearchScrollEventHandler();oneffice_cloud_SearchMode=!0;oneffice_cloud_currentBrowserMode!==
CLOUD_CONST_BROWSER_MODE_SEARCH_RESULT&&oneffice_cloud_currentBrowserMode!==CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH&&(oneffice_cloud_backupBrowserMode=oneffice_cloud_currentBrowserMode);changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_UNIFIED_SEARCH);b.resetCheckListFunc(!1);updateFileList(oneffice_cloud_currFolderSeq,!0,c)}catch(d){dalert(d)}}
function searchCloudEnd(b,a){try{var c=oneffice.getListViewMgr().getSearchMgr();c.changeSearchViewDisplay(!1);var d=!0===fnObjectCheckNull(b)?!0:b;a="number"==typeof a?a:-1;setFolderSearchEnable(!0);var f=document.getElementsByClassName("cloud_search_more_btn");for(b=0;b<f.length;b++)f[b].firstChild.innerText=ID_RED_CONST_STRING_VIEW_MORE,f[b].style.width="56px";document.getElementById("dze_idx_cloud_search_input").value="";c.setKeyword(null);c.setSearchType(SEARCH_TYPE.NONE);dzeJ("#dze_idx_cloud_search_end_btn").hide();
oneffice_cloud_SearchMode=!1;oneffice_cloud_firstload=!0;d&&-1==a&&(changeCurBrowserMode(oneffice_cloud_backupBrowserMode),reload(!0))}catch(e){dalert(e)}}function newTemplateFile(b){try{CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_RECENT==oneffice_cloud_currFolderSeq&&(oneffice_cloud_currFolderSeq=""),onefficeGW.setCurrFolderInfo(oneffice_cloud_currFolderSeq),onefficeGW.newTemplateFile(oneffice_cloud_currNEditNumber,b)}catch(a){dalert("newTemplateFile = "+a)}}
function newFile(b){try{CLOUD_CONST_BROWSER_MODE_FOLDER_SEQ_BASE+CLOUD_CONST_BROWSER_MODE_RECENT==oneffice_cloud_currFolderSeq&&(oneffice_cloud_currFolderSeq=""),onefficeGW.setCurrFolderInfo(oneffice_cloud_currFolderSeq),onefficeGW.newFile(oneffice_cloud_currNEditNumber,b)}catch(a){dalert(a)}}function newArticle(){try{onefficeGW.setCurrFolderInfo(CLOUD_CONST_STRING_NEWSROOM_SEQ),onefficeGW.newTemplateFile(oneffice_cloud_currNEditNumber,"category:5, data:0")}catch(b){dalert(b)}}
function newFolder(b){try{cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,ID_RES_CONST_STRING_NEW_FOLDER,getNewFolderContent(),[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){a=document.getElementById("dze_idx_new_folder_name_input");checkCreateFolderName(a.value)},function(a){duzon_dialog.closeDialog()}],function(){var a=onefficeGW.checkFileName(ID_RES_CONST_STRING_DEFAULT_FOLDER_NAME,null,!1);a=ID_RES_CONST_STRING_DEFAULT_FOLDER_NAME+(!0===fnObjectCheckNull(a)||0===a?"":"("+a+
")");dzeJ("#dze_idx_new_folder_name_input").prop("value",a).select().keydown(function(a){a.keyCode===ID_KEYCODE_ENTER&&checkCreateFolderName(this.value)})},function(){},!0)}catch(a){dalert(a)}}function fileObjectConvert(b,a){if(void 0!==b){var c=0;if(!m_nListViewType&&(null===oneffice_cloud_checkedItemList[0]||a)){c=void 0!=oneffice_cloud_currFolderList[0]?oneffice_cloud_currFolderList[0].seq:0;if(0===c)return b;onefficeGW.getFolderContent(c,function(a){b=a},!1)}return b}}
function renameFile(b,a,c){try{void 0===c&&(c=!1);var d=oneffice.getListViewMgr();a=fileObjectConvert(a,c);if(void 0===a)return!1;cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,ID_RES_CONST_STRING_RENAME,getRenameFileContent(d.getDocTitle(a)),[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){b=document.getElementById("dze_idx_rename_filename_input");oneffice.m_bFolderChangeUpdate=!0;checkRenameFile(a,b.value)},function(a){duzon_dialog.closeDialog()}],function(){var b=document.getElementById("dze_idx_rename_filename_input");
b.setSelectionRange(0,b.value.length);b.onkeydown=function(b){ID_KEYCODE_ENTER==b.keyCode&&(oneffice.m_bFolderChangeUpdate=!0,checkRenameFile(a,this.value))}},function(){},!0)}catch(f){dalert(f)}}function copyFileInNewsRoom(b,a,c){try{checkCopyListTo(a,CLOUD_CONST_STRING_NEWSROOM_SEQ,c,!0)&&(updateFileList(oneffice_cloud_currFolderSeq),selectBrowserFolderItem(oneffice_cloud_currFolderSeq))}catch(d){dalert(d)}}
function copyFileInBrowser(b,a,c,d){try{if(void 0!=a&&1===a.length&&(a[0]=fileObjectConvert(a[0],d),void 0===a[0]))return!1;var f=!1,e=c?ID_RES_DIALOG_STRING_MOVE:ID_RES_CONST_STRING_COPY;cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,e,getMoveFileContent(),[ID_RES_CONST_STRING_NEW_FOLDER,ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(a){a=dzeJ(".viewFolderTreeItems.active");"0"===a[0].getAttribute("open")&&a.find("> div:eq(0)").dblclick();onefficeGW.addNewFolderInputOnFolderTree(function(a,
b){a===oneffice_cloud_currFolderSeq&&(f=!0)})},function(b){b=dzeJ("#dze_idx_save_folder_seq_form")[0];var d=!1;e===ID_RES_CONST_STRING_COPY&&(d=!0);checkCopyListTo(a,b.value,c,d)&&(updateFileList(oneffice_cloud_currFolderSeq),selectBrowserFolderItem(oneffice_cloud_currFolderSeq),duzon_dialog.closeDialog())},function(a){duzon_dialog.closeDialog()}],function(){var a=document.getElementById("dze_idx_folder_tree");onefficeGW.viewFolderTree(a,!0)},function(){f&&(updateFileList(oneffice_cloud_currFolderSeq),
selectBrowserFolderItem(oneffice_cloud_currFolderSeq),f=!1)},!0)}catch(g){dalert(g)}}function mergeSelectedDoc(){try{1<oneffice_cloud_checkedItemList.length&&newFile(!0)}catch(b){dalert(b)}}
function sharePermCompleteCB(){try{var b=oneffice.getListViewMgr(),a=b.getListViewType();b.m_nUpdateSharePermCntSuccessCB++;if(0===oneffice_cloud_shareIDList.length&&b.m_nUpdateSharePermCnt&&b.m_nUpdateSharePermCnt==b.m_nUpdateSharePermCntSuccessCB){a&&(b.m_bChkListInit=!0,b.m_nCheckLstInitMode=CHECKLISTINITMODE.SHARED);var c=String.format(ID_RES_CONST_STRING_SHARE_STATUS_CHANGED,b.getDocTitle(oneffice_cloud_checkedItemList[0]));cmnCtrlToast.showToastMsg(null,c,2,"screen_center");duzon_dialog.closeDialog();
b.m_nUpdateSharePermCnt=0;b.m_nUpdateSharePermCntSuccessCB=0;updateFileList(oneffice_cloud_currFolderSeq,!1)}}catch(d){dalert(d)}}function updateShareBtnStatus(b){try{var a=document.getElementById("TB_MENU_SHARE_BTN_"+oneffice_cloud_currNEditNumber);if(a){var c=document.getElementById("TB_MENU_SHARE_BTN_IMG_"+oneffice_cloud_currNEditNumber);b?(a.removeAttribute("emptyShareInfo"),c&&(c.style.opacity=1)):(a.setAttribute("emptyShareInfo","yes"),c&&(c.style.opacity=.5))}}catch(d){dalert(d)}}
function shareInfoDlgOKProcess(){try{var b=!1,a=0,c=dzeJ("#dze_idx_share_info_container").attr("docSeq");if("none"!==dzeJ("#dze_idx_share_info_open_link_div").css("display")){var d=dzeJ("#dze_idx_share_info_open_share_perm_0");if("cloud_share_dialog_td_click_btn_disabled"==d.attr("class"))b=!1,onefficeGW.unshareDocument(c,SHARE_TARGET.ALL,"",function(){oneffice.parentFileContent.share_perm=0;focusFuncInitList()});else{b=!0;var f=d.attr("sharetype"),e=dzeJ("#dze_idx_share_permission_select_button_0").attr("shareviewmode");
f.toLowerCase()!=e.toLowerCase()&&onefficeGW.shareDocument(c,SHARE_TARGET.ALL,"",e,function(a){oneffice.parentFileContent.share_perm=shaerData.share_perm})}}updateSharePermissionList(!0);a=changeSharePermissionList(function(){focusFuncInitList()});b||0<oneffice_cloud_sharePermORGList.length||0<oneffice_cloud_sharePermPersonList.length||0<a?updateShareBtnStatus(!0):updateShareBtnStatus(!1);duzon_dialog.closeDialog()}catch(g){dalert(g)}}
function shareDlgOKProcess(b){try{var a=updateSharePermissionList();changeSharePermissionList();if(a)getShareInfoForAccessManager(oneffice.currFileSeq),cmnDlg.m_unLoadCB=function(){updateFileList(oneffice_cloud_currFolderSeq,!1)},duzon_dialog.closeDialog();else{var c=oneffice.getListViewMgr(),d=0,f=SHARE_TARGET.PERSON;b="";var e=getShareDocumentSelectedMode(),g=getShareNotificationType(),h=document.getElementById("dze_idx_share_document_add_comment").value;if(-1!==g)if(g===SHARE_TYPE_OPTION_EXTERNAL)duzon_dialog.closeDialog(),
setTimeout(function(){fnHandler_downloadPdf(null,null,oneffice_cloud_currNEditNumber,!0)},100);else{CLOUD_DIALOG_EDIT_SHARE_OPTION&&(document.getElementById("dze_idx_share_document_allow_edit_permission"),document.getElementById("dze_idx_share_document_allow_edit_permission_div"));1===oneffice_cloud_checkedItemList.length&&copyShareLink(onefficeGW.getDocumentShareOpenURL(oneffice_cloud_checkedItemList[0].seq,oneffice_cloud_myInfoData.group_seq));var l=oneffice_cloud_shareIDList.length+oneffice_cloud_mygroup_shareIDList.length;
if(0===l)cmnDlg.m_unLoadCB=function(){updateFileList(oneffice_cloud_currFolderSeq,!1)},duzon_dialog.closeDialog();else{if(1===l){0<oneffice_cloud_shareIDList.length?"c"==oneffice_cloud_shareIDList[0].empDeptFlag?(b=oneffice_cloud_shareIDList[0].compSeq,f=SHARE_TARGET.COMPANY):""!==oneffice_cloud_shareIDList[0].empSeq?(b=oneffice_cloud_shareIDList[0].empSeq,f=SHARE_TARGET.PERSON):(b=oneffice_cloud_shareIDList[0].deptSeq,f=SHARE_TARGET.DEPARTMENT):(b=oneffice_cloud_mygroup_shareIDList[0].empSeq,f=SHARE_TARGET.PERSON);
for(var k=0;k<oneffice_cloud_checkedItemList.length;k++)onefficeGW.shareDocument(oneffice_cloud_checkedItemList[k].seq,f,b,e,function(a){d++;d===oneffice_cloud_checkedItemList.length&&(a=1<oneffice_cloud_checkedItemList.length?String.format(ID_RES_CONST_STRING_NOTI_SHARE_MULTI_DOCUMENT,oneffice_cloud_checkedItemList.length):String.format(ID_RES_CONST_STRING_NOTI_SHARE_DOCUMENT,c.getDocTitle(oneffice_cloud_checkedItemList[0])),cmnCtrlToast.showToastMsg(null,a,2,"screen_center"),makeShareMemberListAndSendNoti(g,
h),cmnDlg.m_unLoadCB=function(){},1<oneffice_cloud_checkedItemList.length?showDialogDocumentShareLinkList(event):duzon_dialog.closeDialog(),updateFileList(oneffice_cloud_currFolderSeq,!1))})}else for(a=0;a<oneffice_cloud_checkedItemList.length;a++){var n=0;for(k=0;k<oneffice_cloud_shareIDList.length;k++)"c"==oneffice_cloud_shareIDList[k].empDeptFlag?(b=oneffice_cloud_shareIDList[k].compSeq,f=SHARE_TARGET.COMPANY):""!==oneffice_cloud_shareIDList[k].empSeq?(b=oneffice_cloud_shareIDList[k].empSeq,f=
SHARE_TARGET.PERSON):(b=oneffice_cloud_shareIDList[k].deptSeq,f=SHARE_TARGET.DEPARTMENT),onefficeGW.shareDocument(oneffice_cloud_checkedItemList[a].seq,f,b,e,function(a){n++;n===l*oneffice_cloud_checkedItemList.length&&(a=1<oneffice_cloud_checkedItemList.length?String.format(ID_RES_CONST_STRING_NOTI_SHARE_MULTI_DOCUMENT,oneffice_cloud_checkedItemList.length):String.format(ID_RES_CONST_STRING_NOTI_SHARE_DOCUMENT,c.getDocTitle(oneffice_cloud_checkedItemList[0])),cmnCtrlToast.showToastMsg(null,a,2,"screen_center"),
makeShareMemberListAndSendNoti(g,h),cmnDlg.m_unLoadCB=function(){},duzon_dialog.closeDialog(),1<oneffice_cloud_checkedItemList.length&&showDialogDocumentShareLinkList(event),updateFileList(oneffice_cloud_currFolderSeq,!1))});for(k=0;k<oneffice_cloud_mygroup_shareIDList.length;k++)b=oneffice_cloud_mygroup_shareIDList[k].empSeq,f=SHARE_TARGET.PERSON,onefficeGW.shareDocument(oneffice_cloud_checkedItemList[a].seq,f,b,e,function(a){n++;n===l*oneffice_cloud_checkedItemList.length&&(a=1<oneffice_cloud_checkedItemList.length?
String.format(ID_RES_CONST_STRING_NOTI_SHARE_MULTI_DOCUMENT,oneffice_cloud_checkedItemList.length):String.format(ID_RES_CONST_STRING_NOTI_SHARE_DOCUMENT,c.getDocTitle(oneffice_cloud_checkedItemList[0])),cmnCtrlToast.showToastMsg(null,a,2,"screen_center"),makeShareMemberListAndSendNoti(g,h),cmnDlg.m_unLoadCB=function(){},duzon_dialog.closeDialog(),1<oneffice_cloud_checkedItemList.length&&showDialogDocumentShareLinkList(event),updateFileList(oneffice_cloud_currFolderSeq,!1))})}getShareInfoForAccessManager(oneffice.currFileSeq)}}}}catch(m){dalert(m)}}
function checkOwnerDocument(b,a){var c=!1;a||oneffice.m_ListViewMgr.getListViewType()!==DRIVE_FILE_VIEW.THUMBNAIL_ITEM?(oneffice.m_ListViewMgr.getListViewType()===DRIVE_FILE_VIEW.FILE_ITEM||a)&&b.owner_id===oneffice_cloud_myInfoData.id&&(c=!0):b.userData&&oneffice_cloud_myInfoData.id===b.userData.nOwnerID&&(c=!0);return c}
function isTempFileSelected(b){for(var a=oneffice.getListViewMgr(),c=oneffice_cloud_checkedItemList,d=0;d<c.length;d++){var f=a.getDocRegDate(c[d]),e=a.getDocTitle(c[d]);if("string"==typeof f&&e===oneffice.unTitleMsg+" "+f.replace(/:/g,"").substr(5,f.length))return b&&cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_EXIST_TEMP_DOCUMENT+" "+ID_RES_CONST_STRING_ENTER_SUBJECT,2,"screen_center"),!0}return!1}
function setShareDocument(b,a){try{isTempFileSelected(!0)||(oneffice_cloud_shareIDList=[],oneffice_cloud_mygroup_shareIDList=[],cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,ID_RES_CONST_STRING_SHARE_DOCUMENT,getShareDocumentContentV2(),[ID_RES_CONST_STRING_SHARE_DOCUMENT,ID_RES_DIALOG_BTN_CANCEL],[function(b){shareDlgOKProcess(b,a);void 0!=a&&onefficeCommon.simpleSaveFile(a)},function(a){duzon_dialog.closeDialog()}],function(){dzeJ("#dze_idx_share_document_add_comment").val("");oneffice_cloud_shareLinkPermItemOpened=
!1;initOrgSelectedItem();addOrgSelectedEvent();loadSharingUserInfo(!0);document.getElementById("dze_idx_share_document_selected_user_input").focus()},function(){dze_menu_control&&dze_menu_control.resizePropertyTableInfo(dze_menu_control.ui_mode,oneffice_cloud_currNEditNumber)},!0,!0))}catch(c){dalert(c)}}
function showDialogDocumentShareInfo(b,a,c){try{onefficeCommon.getFileContent(a,function(d){if(null===d)return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_RECENT_NO_SHARE_DOCUMENT,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR),!1;d=(c=d.owner_id===oneffice_cloud_myInfoData.id?!0:!1)?[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL]:[ID_RES_DIALOG_BTN_OK];var f=[function(a){shareInfoDlgOKProcess(a)},function(a){duzon_dialog.closeDialog()}];c||(f=[function(a){duzon_dialog.closeDialog()}]);cmnDlg.viewBasicDlg(b,
oneffice_cloud_currNEditNumber,ID_RES_CONST_STRING_SHARE_DOCUMENT,getShareInfoDocumentContent(a,c),d,f,function(){},function(){dze_menu_control&&dze_menu_control.resizePropertyTableInfo(dze_menu_control.ui_mode,oneffice_cloud_currNEditNumber)},!1,!0)},void 0,void 0,void 0,!0)}catch(d){dalert(d)}}
function showDialogDocumentShareLinkList(b){try{cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,ID_RES_CONST_STRING_SHARE_DOCUMENT+" URL",getShareLinkListContent(),[ID_RES_DIALOG_BTN_OK],[function(a){duzon_dialog.closeDialog()}],function(){},function(){},!1)}catch(a){dalert(a)}}
function deleteRecentList(b){if(fnObjectCheckNull(b))dlog("\uc120\ud0dd\ub41c \ud56d\ubaa9\uc774 \uc5c6\ub2e4.");else{var a=b[0].seq,c="";c=fnObjectCheckNull(b[0].userData)?b[0].owner_id:b[0].userData.nOwnerID;onefficeGW.deleteRecentList(a,c,!0,function(){dlog("\ucd5c\uadfc \ubaa9\ub85d \uc81c\uac70 ");updateFileList(oneffice_cloud_currFolderSeq)})}}
function copyShareLink(b,a){try{var c="";if(fnObjectCheckNull(b)){var d=document.getElementById("dze_idx_share_document_link");c=d?d.innerHTML:onefficeGW.getDocumentShareOpenURL(oneffice_cloud_checkedItemList[0].seq,oneffice_cloud_myInfoData.group_seq)}else c=b;if(g_bBrowserType_IE)window.clipboardData.setData("Text",c);else{var f=document.createElement("input");f.style.position="fixed";f.style.opacity=0;f.value=c;document.body.appendChild(f);f.select();document.execCommand("copy");document.body.removeChild(f)}(!0===
fnObjectCheckNull(b)||!1===fnObjectCheckNull(a)&&a)&&cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_COPIED,2,"screen_center")}catch(e){dalert(e)}}
function unShareDocument(b){try{var a=oneffice.getListViewMgr(),c=a.getListViewType();if(1===oneffice_cloud_checkedItemList.length){var d=a.getShareType(oneffice_cloud_checkedItemList[0]),f=a.getShareID(oneffice_cloud_checkedItemList[0]),e=a.getDocTitle(oneffice_cloud_checkedItemList[0]);"1"==d?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_DENY_UNSHARE_DEPARTSHARE_DOCUMENT,2,"screen_center"):onefficeGW.unshareDocument(oneffice_cloud_checkedItemList[0].seq,d,f,function(){c&&(a.m_bChkListInit=
!0,a.m_nCheckLstInitMode=CHECKLISTINITMODE.SHARED);cmnCtrlToast.showToastMsg(null,String.format(ID_RES_CONST_STRING_NOTI_UNSHARE_DOCUMENT,e),2,"screen_center");updateFileList(oneffice_cloud_currFolderSeq,!1)})}else{var g=0,h=0;for(b=0;b<oneffice_cloud_checkedItemList.length;b++)d=a.getShareType(oneffice_cloud_checkedItemList[0]),f=a.getShareID(oneffice_cloud_checkedItemList[0]),e=a.getDocTitle(oneffice_cloud_checkedItemList[0]),c&&(a.m_bChkListInit=!0,a.m_nCheckLstInitMode=CHECKLISTINITMODE.SHARED),
"1"==d?(h++,g+h===oneffice_cloud_checkedItemList.length&&(0===g?cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_NOTI_DENY_UNSHARE_DEPARTSHARE_DOCUMENT,2,"screen_center"):cmnCtrlToast.showToastMsg(null,String.format(ID_RES_CONST_STRING_NOTI_UNSHARE_MULTI_DOCUMENT,g),2,"screen_center"),updateFileList(oneffice_cloud_currFolderSeq,!1))):onefficeGW.unshareDocument(oneffice_cloud_checkedItemList[b].seq,d,f,function(){g++;g+h===oneffice_cloud_checkedItemList.length&&(cmnCtrlToast.showToastMsg(null,String.format(ID_RES_CONST_STRING_NOTI_UNSHARE_MULTI_DOCUMENT,
g),2,"screen_center"),updateFileList(oneffice_cloud_currFolderSeq,!1))})}}catch(l){dalert(l)}}
function unShareDocumentWithSelectList(b){try{var a=0<dzeJ("#dze_idx_share_info_container").length?dzeJ("#dze_idx_share_info_container").attr("docSeq"):oneffice.currFileSeq;if(""==a)for(a=0;a<oneffice_cloud_checkedItemList.length;a++)for(var c=0;c<b.length;c++){var d=b[c].share_id,f=b[c].share_type;onefficeGW.unshareDocument(oneffice_cloud_checkedItemList[a].seq,f,d,function(){sharePermCompleteCB()})}else for(c=0;c<b.length;c++)d=b[c].share_id,f=b[c].share_type,onefficeGW.unshareDocument(a,f,d,function(){sharePermCompleteCB()})}catch(e){dalert(e)}}
function makeShareMemberListAndSendNoti(b,a){try{if(SHARE_TYPE_OPTION_NONE!==b){var c=[],d=0,f=[];f=g_bBrowserType_IE||g_bBrowserType_EDGE?JSON.parse(JSON.stringify(oneffice_cloud_checkedItemList)):getObjectClone(oneffice_cloud_checkedItemList);for(var e=getShareDocumentSelectedMode(),g=oneffice_cloud_shareIDList.length+oneffice_cloud_mygroup_shareIDList.length,h=0;h<oneffice_cloud_shareIDList.length;h++)"c"==oneffice_cloud_shareIDList[h].empDeptFlag?onefficeGW.getEmpListInGroup({company_id:oneffice_cloud_shareIDList[h].compSeq},
function(h){d++;for(var l=0;l<h.length;l++)c.push(h[l]);d===g&&sendShareNotification(b,a,c,f,e)}):""!==oneffice_cloud_shareIDList[h].empSeq?(c.push(oneffice_cloud_shareIDList[h]),d++):""!==oneffice_cloud_shareIDList[h].deptSeq?onefficeGW.getEmpListInGroup({dept_no:oneffice_cloud_shareIDList[h].deptSeq},function(h){d++;for(var l=0;l<h.length;l++)c.push(h[l]);d===g&&sendShareNotification(b,a,c,f,e)}):d++;for(h=0;h<oneffice_cloud_mygroup_shareIDList.length;h++)c.push(oneffice_cloud_mygroup_shareIDList[h]),
d++;d===g&&sendShareNotification(b,a,c,f,e)}}catch(l){dalert(l)}}
function sendShareNotification(b,a,c,d,f){try{var e=makeShareInfoMessage(b,a,d,f),g=makeShareMemberList(b,c);switch(parseInt(b)){case SHARE_TYPE_OPTION_MAIL:b="[ONEFFICE "+ID_RES_CONST_STRING_SHARE_DOCUMENT+"] ";if(d){var h=oneffice.getListViewMgr().getDocTitle(d[0]);1<d.length&&(h=' "'+h+'" \uc678 '+(d.length-1)+"\uc758 \ubb38\uc11c");b+=h}onefficeGW.sendMail(g,b,e);break;case SHARE_TYPE_OPTION_NOTE:onefficeGW.sendNoteMessage(g,e)}}catch(l){dalert(l)}}
function makeShareInfoMessage(b,a,c,d){try{var f=oneffice.getListViewMgr(),e="";d="R"==d?ID_RES_CONST_STRING_VIEWING:ID_RES_TOOL_STRING_MENU_EDIT;var g=a.split(/\r?\n/);g[g.length-1]||g.pop();var h=0==g.length;switch(parseInt(b)){case SHARE_TYPE_OPTION_MAIL:var l=getFullUrlFromPath(g_dzEditorBasePath+"image/Oneffice.png"),k=getFullUrlFromPath(g_dzEditorBasePath+"image/cloud/ico_cloud_file.png"),n=String.format(ID_RES_CONST_STRING_INVITE_YOU_SHARE_DOCUMENT,"<strong>"+oneffice_cloud_myInfoData.name+
"</strong>","<strong>"+d+"</strong>");e+='<table cellpadding="0" cellspacing="0" width="100%" height="100%" style="background-color: #f5f5f5;">';e+="<tbody>";e+="<tr>";e+='<td style="padding:20px; vertical-align:top">';e+='<table cellspacing="0" cellpadding="0" style="width:700px; margin:0px auto; background-color:#ffffff; border:1px solid #cccccc; border-collapse:collapse;">';e+="<tbody>";e+="<tr>";e+='<td style="padding:30px 40px; text-align:center" colspan="2">';e+='<img src="'+l+'"></img>';e+=
"</td>";e+="</tr>";e+="<tr>";e+='<td style="padding:20px 40px" colspan="2">';e+="<p>"+n+"</p>";e+="</td>";e+="</tr>";for(var m=0;m<c.length;m++){var t=onefficeGW.getDocumentShareOpenURL(c[m].seq,oneffice_cloud_myInfoData.group_seq),u=f.getDocTitle(c[m]);e+="<tr>";e+='<td style="padding:5px 40px;">';e+='<p><img src="'+k+'" style="vertical-align:middle; margin-right:5px"></img><a href="'+t+'" target="_blank" style="line-height:26px; vertical-align:middle; text-decoration:none; color:#000000;"><strong>'+
u+"</strong></a></p>";e+="</td>";e+='<td style="width:80px; padding:5px 40px;">';e+='<div style="width:90px; height:26px; text-align:center; background-color:#1c90fb; color:#ffffff; cursor:pointer;"><a href="'+t+'" target="_blank" style="line-height:26px; vertical-align:middle; text-decoration:none; color:#ffffff;">'+ID_RES_CONST_STRING_DOCUMENT_OPEN+"</a></div>";e+="</td>";e+="</tr>"}if(!h){e+="<tr>";e+='<td style="padding:5px 40px;" colspan="2">';e+='<hr style="background-color:#6aa4d9; height:1px; border:0px;"></hr>';
e+="</td>";e+="</tr>";e+="<tr>";e+='<td style="padding:5px 40px 0px 40px;" colspan="2">';e+='<table cellpadding="0" cellspacing="0" style="width:100%; border-collapse:collapse; background-color:#f5f5f5; border:1px solid #cccccc">';e+="<tbody>";e+="<tr>";e+='<td style="padding:10px 15px; height:150px; vertical-align:top; word-wrap:break-word; word-break:break-all;">';for(m=0;m<g.length;m++)e+="<p>"+g[m]+"</p>";e+="</td>";e+="</tr>";e+="</tbody>";e+="</table>";e+="</td>";e+="</tr>"}e+="<tr>";e+='<td style="padding:5px 40px 20px 40px;" colspan="2"></td>';
e+="</tr>";e+="</tbody>";e+="</table>";e+="</td>";e+="</tr>";e+="</tbody>";e+="</table>";break;case SHARE_TYPE_OPTION_NOTE:var p=f.getDocTitle(c[0]);if(1<c.length)for(e+='[ONEFFICE \uacf5\uc720] "'+p+'" \uc678 '+(c.length-1)+"\uac1c\uc758 \ubb38\uc11c\r\n\r\n",e+=oneffice_cloud_myInfoData.name+"\ub2d8\uc774 \ub2e4\uc74c \ubb38\uc11c\ub97c "+d+" \ud558\ub3c4\ub85d \ucd08\ub300\ud558\uc600\uc2b5\ub2c8\ub2e4.\r\n\r\n",""!=a&&(e+="\r\n\u25a3 \uba54\uc2dc\uc9c0 \u25a3\r\n",e+=a+"\r\n\r\n"),m=0;m<c.length;m++)e+=
"\r\n\u25a3 \ubb38\uc11c \uc81c\ubaa9 \u25a3\r\n",e+=f.getDocTitle(c[m])+"\r\n\r\n",e+="[URL \ub9c1\ud06c]\r\n",e+=onefficeGW.getDocumentShareOpenURL(c[m].seq,oneffice_cloud_myInfoData.group_seq)+"\r\n\r\n";else e+="[ONEFFICE \uacf5\uc720] "+p+"\r\n\r\n",e+=oneffice_cloud_myInfoData.name+"\ub2d8\uc774 \ub2e4\uc74c \ubb38\uc11c\ub97c "+d+" \ud558\ub3c4\ub85d \ucd08\ub300\ud558\uc600\uc2b5\ub2c8\ub2e4.\r\n\r\n",""!=a&&(e+="\u25a3 \uba54\uc2dc\uc9c0 \u25a3\r\n",e+=a+"\r\n\r\n"),e+="\u25a3 URL \ub9c1\ud06c \u25a3\r\n",
e+=onefficeGW.getDocumentShareOpenURL(c[0].seq,oneffice_cloud_myInfoData.group_seq)+"\r\n\r\n"}return e}catch(r){dalert(r)}}
function makeShareMemberList(b,a){try{var c=[];switch(parseInt(b)){case SHARE_TYPE_OPTION_MAIL:for(var d=0;d<a.length;d++){var f=a[d];if(f.empName){b="";if(f.emailAddr)b=f.emailAddr;else if(f.loginId)b=f.loginId;else if(f.empNameAdv)b=f.empNameAdv.replace("(",""),b=b.replace(")","");else continue;c.push({empName:a[d].empName,email:b+"@"+oneffice_cloud_myInfoData.mail_domain})}}break;case SHARE_TYPE_OPTION_NOTE:for(d=0;d<a.length;d++)c.push(a[d].empSeq)}return c}catch(e){dalert(e)}}
function setDocumentSecurity(b,a){try{var c=oneffice.getListViewMgr().isSecurity(a);cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,c?ID_RES_CONST_STRING_DOCUMENT_SECURITY_RESET:ID_RES_CONST_STRING_DOCUMENT_SECURITY_SETTING,onefficeGW.getDocumentSecuritySettingContainer(c),[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(b){onefficeGW.onDocumentSecuritySettingOkClick(a.seq,c)},function(a){duzon_dialog.closeDialog()}],function(){onefficeGW.onDocumentSecuritySettingDialogOnload()},function(){},
!0)}catch(d){dalert(d)}}
function checkCreateFolderName(b){try{if(""==b)return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_PLEASE_INPUT_FOLDER_NAME,2,"screen_center"),!1;var a=oneffice_cloud_currFolderSeq;switch(1*oneffice_cloud_currFolderSeq){case 12003:case 12016:case 12017:case 12002:case 12004:case 12009:case 12010:case 12011:a="";break;case 12030:a=CLOUD_CONST_STRING_NEWSROOM_SEQ;break;default:a=oneffice_cloud_currFolderSeq}onefficeGW.createFolderContent(a,b,function(b){updateFileList(a);selectBrowserFolderItem(a);
duzon_dialog.closeDialog()})}catch(c){dalert(c)}}function reloadOnListUpdate(){try{oneffice.m_bFolderChangeUpdate=!0,reload(!0)}catch(b){dalert(b)}}
function checkRenameFile(b,a){try{if(""===a.trim())return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_PLEASE_INPUT_RENAME,2,"screen_center"),!1;onefficeGW.renameDocument(b,a,function(){updateFileList(oneffice_cloud_currFolderSeq);selectBrowserFolderItem(oneffice_cloud_currFolderSeq);duzon_dialog.closeDialog()},function(){})}catch(c){dalert(c)}}
function chkCpyLstToCBAfterProcess(){try{oneffice.getListViewMgr(),updateFileList(oneffice_cloud_currFolderSeq,!1),duzon_dialog.closeDialog()}catch(b){dalert(b)}}
function chkMenuMoveFolder(b,a){try{var c=!0,d=0;if(""===b)return!0;for(var f=dzeJ(".cloud_browser_list_item_folder[folderseq="+b+"]"),e=dzeJ(".cloud_browser_list_item_folder[folderseq="+a+"]"),g=""===e.attr("depth")?0:Number(e.attr("depth"));c;){var h=f.attr("folderseq"),l=f.attr("parentseq"),k=""===f.attr("depth")?0:Number(f.attr("depth"));if(h===a&&g<=k){c=!1;break}if(""===l||""===h||100===d)break;f=dzeJ(".cloud_browser_list_item_folder[folderseq="+l+"][depth="+(k-1)+"]");d++}if(!c)return!1}catch(n){return!1}return!0}
function chkPopupMoveFolder(b,a){var c=!0,d=0;if(""===b)return!0;for(b=dzeJ(".viewFolderTreeItems[folderseq="+b+"]");c;){var f=b.attr("folderseq");if(f===a){c=!1;break}if(""===f||100===d)break;b=b.parent();d++}return c?!0:!1}
function EndMoveEvent(){var b=document.getElementById("dze_idx_toolbar_menu_list"),a=document.getElementById("drive_thumbnailItemPanel");dzeJ(".dragMouse").removeClass("dragMouse");dzeJ(".movable").removeClass("movable");dzeJ(a).off("mousemove");dzeJ(b).off("mouseover");(b=document.getElementById("copyDiv"))&&b.parentNode.removeChild(b)}
function checkCopyListTo(b,a,c,d){try{var f=oneffice.getListViewMgr(),e=f.getListViewType();f.m_bChkListInit=!0;void 0===d&&(d=!1);if(null===a||"undefined"===typeof a)a="";if(c){for(var g=0;g<b.length;g++){var h=b[g],l=e?h.parentFolderSeq:h.folderSeq;if(h.seq==a&&l==a||0<dzeJ(".viewFolderTreeItems").length&&!chkPopupMoveFolder(a,h.seq)||0===dzeJ(".viewFolderTreeItems").length&&!chkMenuMoveFolder(a,h.seq))return cmnCtrlToast.showToastMsg(null,ID_RES_CONST_STRING_WARNING_CANNOT_MOVE_SELECTED_FOLDER,
2,"screen_center"),EndMoveEvent(),!1}var k=0,n=0;for(g=0;g<b.length;g++)h=b[g],e?h.parentFolderSeq=a:h.folderSeq=a,c=null,c=f.isFolder(h)?onefficeGW.saveFolderContent:onefficeGW.saveFileContent,e&&(f.m_nCheckLstInitMode=CHECKLISTINITMODE.MOVE_FILE,h=f.convertFileListData(h)),c(h,function(a){"string"===typeof a&&a&&0<a.length?k++:"number"===typeof a&&0<a&&k++;k===b.length?(cmnCtrlToast.showToastMsg(null,String.format(ID_RES_CONST_STRING_NOTI_MOVED_DOCUMENT_LIST,k),2,"screen_center",!0,TOAST_TYPE_OPTION_OK),
resetFolderListItems(!0),duzon_dialog.closeDialog(),oneffice_cloud_SearchMode&&searchCloudEnd(!0,CLOUD_CONST_BROWSER_MODE_MYONEFFICE),oneffice.getListViewMgr().m_bDirectFolder=!0,changeCurBrowserMode(CLOUD_CONST_BROWSER_MODE_MYONEFFICE,!0),chkCpyLstToCBAfterProcess()):k+n===b.length&&(alert(String.format(ID_RES_CONST_STRING_NOTI_MOVED_LIST_FAIL,n)),chkCpyLstToCBAfterProcess())},function(a){n++;k+n===b.length&&(alert(String.format(ID_RES_CONST_STRING_NOTI_MOVED_LIST_FAIL,n)),chkCpyLstToCBAfterProcess())})}else{var m=
0;n=0;f.m_nCheckLstInitMode=CHECKLISTINITMODE.COPY_FILE;for(g=0;g<b.length;g++)onefficeCommon.getFileContent(b[g].seq,function(c){onefficeGW.copyFileToFolder(c.seq,a,function(f){d&&onefficeGW.saveFileContent({type:1,seq:f,folderSeq:a,subject:c.subject+ID_RES_STRING_COPY_SUBJECT_TEXT,content:"",readonly:"",important:""},function(c){"string"===typeof f&&f&&0<f.length?m++:"number"===typeof f&&0<f&&m++;m===b.length&&(""===a?(cmnCtrlToast.showToastMsg(null,String.format(ID_RES_CONST_STRING_NOTI_COPIED_DOCUMENT,
ID_RES_CONST_STRING_BROWSER_MY),2,"screen_center"),chkCpyLstToCBAfterProcess()):a==CLOUD_CONST_STRING_NEWSROOM_SEQ?(cmnCtrlToast.showToastMsg(null,"\ud574\ub2f9 \uae30\uc0ac\uac00 \ubcf5\uc0ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4.",2,"screen_center"),chkCpyLstToCBAfterProcess()):onefficeGW.getFolderContent(a,function(a){cmnCtrlToast.showToastMsg(null,String.format(ID_RES_CONST_STRING_NOTI_COPIED_DOCUMENT,null===a||"undefined"===a.subject?ID_RES_CONST_STRING_BROWSER_MY:a.subject),2,"screen_center");chkCpyLstToCBAfterProcess()}))},
null,!0)},function(a){n++;m+n===b.length&&(alert(ID_RES_CONST_STRING_NOTI_COPIED_LIST_FAIL),chkCpyLstToCBAfterProcess())})})}}catch(t){dalert(t)}}
function getNewFolderContent(){try{var b=document.createElement("div");b.id="dze_idx_new_folder_container";b.style.width="auto";b.style.height="auto";var a=document.createElement("input"),c=document.createElement("p"),d=document.getElementsByClassName("folder_nav_list_item"),f="";a.id="dze_idx_new_folder_name_input";a.style.textAlign="left";a.style.width="300px";a.setAttribute("value",ID_RES_CONST_STRING_NEW_FOLDER);for(var e=d.length,g=0;g<e;g++){var h=d[g];h=h.cloneNode(!0);dzeJ(h).find(".folder_nav_list_item_text").removeClass("folder_nav_list_item_text");
if(g===e-1){var l=h.querySelectorAll("img");l&&0<l.length&&forEach(l,function(a,b){b.parentNode.removeChild(b)})}f=f.concat(h.innerHTML)}switch(f){case ID_RES_CONST_STRING_BROWSER_SHARE:case ID_RES_CONST_STRING_BROWSER_MY_SHARE_LIST:case ID_RES_CONST_STRING_BROWSER_SHARED_BY_LIST:case ID_RES_CONST_STRING_BROWSER_RECENT:case ID_RES_CONST_STRING_BROWSER_FAVORITE:case ID_RES_CONST_STRING_BROWSER_SECURITY:case ID_RES_CONST_STRING_BROWSER_TRASHBOX:f=ID_RES_CONST_STRING_BROWSER_MY}c.innerHTML="<br/>"+ID_RES_CONST_STRING_FOLDER_LOCATION+
" : "+f;c.style.maxWidth="300px";c.style.wordBreak="break-all";b.appendChild(a);b.appendChild(c);return b.outerHTML}catch(k){dalert(k)}}
function getRenameFileContent(b){try{var a=document.createElement("div");a.id="dze_idx_rename_file_container";a.style.width="auto";a.style.height="auto";var c=document.createElement("input");c.id="dze_idx_rename_filename_input";c.style.textAlign="left";c.style.width="300px";c.style.height="18px";c.setAttribute("value",b);a.appendChild(c);return a.outerHTML}catch(d){dalert(d)}}
function getMoveFileContent(b){return"<div id='dze_idx_folder_tree' ondragstart='return false' onselectstart='return false' style='width:310px;height:180px;overflow:auto;border:#a0a0a0 1px solid;'></div><input type='hidden' id='dze_idx_save_folder_seq_form' value='' />"}
function setRepositionDialogOnCenter(b){try{var a=document.getElementById("idx_dlg"),c=0,d=0;g_objLayerKit.getLayerDocument().documentElement.scrollWidth?g_objLayerKit.getLayerWindow().innerHeight?(c=g_objLayerKit.getLayerWindow().innerWidth,d=g_objLayerKit.getLayerWindow().innerHeight):(c=g_objLayerKit.getLayerDocument().documentElement.clientWidth,d=g_objLayerKit.getLayerDocument().documentElement.clientHeight):(c=g_objLayerKit.getLayerDocument().body.scrollWidth,d=g_objLayerKit.getLayerDocument().body.scrollHeight);
var f=a.offsetWidth,e=a.offsetHeight;if(b){var g=document.getElementsByClassName("duzon_dialog_extends")[0];f+=g.offsetWidth}a.style.top=(d-e)/2+"px";a.style.left=(c-f)/2+"px"}catch(h){dalert(h)}}
function setElementFade(b,a){try{var c=oneffice.getListViewMgr(),d=b.nextElementSibling;"dze_idx_filelist"==b.id&&c.getListViewType()!=DRIVE_FILE_VIEW.FILE_ITEM&&a&&d&&"drive_thumbnailItemPanel"==d.id&&(b=d);!0===a?duzon_dialog.fade("in",b):c.getListViewType()!=DRIVE_FILE_VIEW.THUMBNAIL_ITEM&&(b.style.display="block")}catch(f){dalert(f)}}
function openInformationPanel(){try{var b=document.getElementById("dze_idx_information_panel");!0===fnObjectCheckNull(b)&&(b=document.createElement("div"),b.id="dze_idx_information_panel",b.style.height=window.innerHeight-60+"px",document.getElementById("dze_idx_cloud_container").appendChild(b));panelManager.getInstance().showPanel(PANEL_MAIN_TYPE.CLOUD_FILE)}catch(a){dalert(a)}}
function getShareInfoForAccessManager(b){setTimeout(function(){onefficeGW.getShareInfo(b,function(a){if(0==fnObjectCheckNull(a)&&0<a.length){console.dir(a);for(var b=0;b<a.length;b++)if("W"===a[b].share_perm){if(oneffice.accessManagerSearchInterval){dlog("\ubb38\uc11c \uc811\uadfc \uad00\ub9ac\uc790 \uad8c\ud55c\uc774 \uc774\ubbf8 \uc2e4\ud589 \uc911");return}oneffice.parentFileContent.share_perm="W";onefficeGW.setAccessManager(oneffice.currFileSeq,oneffice.parentFileContent.my_id,function(a){1<=
a.result&&onefficeUtil.searchAccessManagerConnectInterval()});return}oneffice.parentFileContent.share_perm="R";oneffice.accessManagerSearchInterval&&(clearInterval(oneffice.accessManagerSearchInterval),oneffice.accessManagerSearchInterval=void 0,onefficeGW.delAccessManager(oneffice.currFileSeq,oneffice.parentFileContent.my_id));oneffice.requestManagerSearchInterval&&(clearInterval(oneffice.requestManagerSearchInterval),oneffice.requestManagerSearchInterval=void 0)}},!0)},500)}
var g_arrOpendToast={},loadChgOwn=function(){if(0<=document.location.href.indexOf("//localhost:80"))return function(){};var b=function(a,b){for(var c=b.length-1;0<=c;c--)if(b[c]&&b[c].id===a)return b[c].name;return""},a=function(){try{if(dzeUiConfig.bUseChgOwn){var a=oneffice_cloud_chgOwnInfo;if(a){var b=a.req_doc_list;dzeJ("span[txt_chg_own]").each(function(a,c){(a=c.seq)&&b&&-1<b.indexOf(a)?(c.style.display="",c.innerHTML=ID_RES_STRING_CHG_OWN_ING):(c.style.display="none",c.innerHTML="")});dzeJ("img[ico_chg_own]").each(function(a,
c){(a=c.seq)&&b&&-1<b.indexOf(a)?c.style.display="":c.style.display="none"});var c=a.req_accept_doc_list;if(c)try{var g={};dzeJ("div[seq]").each(function(a,b){if((a=b.getAttribute("seq"))&&""===b.style.display&&-1<c.indexOf(a))throw g;})}catch(h){updateFileList(oneffice_cloud_currFolderSeq,!1)}}}}catch(h){dalert(h)}},c=function(a,c,e){try{if(!cmnDlg.isShowDlg()&&!cmnMsg.isShowMsg()){var d={positionClass:"toast-bottom-right",preventDuplicates:!1,showDuration:500,closeDuration:300,hideDuration:300,
closeButton:!0,timeOut:0,extendedTimeOut:0},f=null;forEach(a,function(a,b){a=null;switch(b.type){case "accept":a=ID_RES_CONST_STRING_ACCEPT;break;case "reject":a=ID_RES_CONST_STRING_REJECT;break;default:return}if(!g_arrOpendToast[b.req_id]){var c=cloneSimpleObject(d);c.onclick=c.onCloseClick=function(){f!==b.req_id&&(f=b.req_id,onefficeGW.changeOwner(b.req_id,"confirm",null,null),updateFileList(oneffice_cloud_currFolderSeq,!1))};c.onHidden=function(){delete g_arrOpendToast[b.req_id]};g_arrOpendToast[b.req_id]=
toastr.success(String.format(ID_RES_STRING_CHG_OWN_TOAST4,'<span style="color:blue;">'+ID_RES_STRING_CHG_OWN+"</span>",a),null,c)}});forEach(c,function(a,c){"request"!==c.type||g_arrOpendToast[c.req_id]||(a=cloneSimpleObject(d),a.onclick=function(){f!==c.req_id&&(f=c.req_id,c.org_owner_name=b(c.org_owner_id,e),c.new_owner_name=b(c.new_owner_id,e),viewChgOwnResDlg(c))},a.onHidden=function(){delete g_arrOpendToast[c.req_id]},g_arrOpendToast[c.req_id]=toastr.success(String.format(ID_RES_STRING_CHG_OWN_TOAST5,
b(c.org_owner_id,e),'<br><span style="color:blue; text-decoration: underline;">'+ID_RES_CONST_STRING_DIRECT_GO+"</span>"),null,a))})}}catch(l){dalert(l)}};return function(d,f){try{var e=dzeUiConfig;if(!e||!e.bUseChgOwn)return!1;onefficeGW.getChangeOwner(function(e){var g=e.req_list,l=e.res_list;e=e.emp_list;if(l&&g&&e){var k=oneffice_cloud_chgOwnInfo;k||(oneffice_cloud_chgOwnInfo=k={});for(var n=g.length,m=null,t=null,u,p=0;p<n;p++)g[p]&&(u=g[p].type,"request"===u?(m||(m=[]),m=m.concat(g[p].doc_no_list)):
"accept"===u&&(t||(t=[]),t=t.concat(g[p].doc_no_list)));k.req_doc_list=m;k.req_accept_doc_list=t;try{if(dzeUiConfig.bUseChgOwn){var r=oneffice_cloud_chgOwnInfo.req_doc_list;if(p=oneffice_cloud_currentItemList)for(var q=0,v=p.length;q<v;q++)r&&-1<r.indexOf(p[q].seq)?p[q].owner_change=!0:p[q].owner_change=!1;var w=oneffice.getListViewMgr();if(p=w?w.m_CurThumbnailViewListData:null)for(q=0,v=p.length;q<v;q++)r&&-1<r.indexOf(p[q].seq)?(p[q].owner_change=!0,p[q].docData&&(p[q].docData.owner_change=!0)):
(p[q].owner_change=!1,p[q].docData&&(p[q].docData.owner_change=!1))}}catch(x){dalert(x)}a();if(!1!==f&&(c(g,l,e),!0===d)){g=onefficeUtil.getRequestParameter("chgown");r=null;if(g)for(p=0;p<n;p++)if(l[p]&&l[p].req_id===g&&"request"===l[p].type){r=l[p];break}r&&(r.org_owner_name=b(r.org_owner_id,e),r.new_owner_name=b(r.new_owner_id,e),viewChgOwnResDlg(r))}}},null)}catch(g){dalert(g)}}}();
function viewChgOwnReqDlg(b){try{if(dzeUiConfig.bUseChgOwn&&!isTempFileSelected(!0)){for(var a=null,c=[],d=oneffice_cloud_checkedItemList,f=0,e=d.length;f<e;f++){var g=d[f].seq;onefficeCommon.isOnefficeGuideDoc(g)||c.push(g)}if(0>=c.length)cmnCtrlToast.showToastMsg(null,ID_RES_DIALOG_ALERT_SELECTFILE,2,"screen_center");else{oneffice_cloud_shareIDList=[];oneffice_cloud_mygroup_shareIDList=[];var h=function(){cmnMsg.showMsg("confirm",ID_RES_STRING_CHG_OWN_POP_REQ,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],
function(){onefficeGW.createChangeOwnerReq(a.empSeq,c,function(b){b&&b.req_id?(cmnCtrlToast.showToastMsg(null,ID_RES_STRING_CHG_OWN_TOAST,2,"screen_center"),b="chgown="+b.req_id,b+="&groupseq="+oneffice_cloud_myInfoData.group_seq,b=onefficeGW.getOnefficeURL(!0)+"?"+encodeURIComponent(window.btoa(b)),onefficeGW.sendNoteMessage([a.empSeq],String.format(ID_RES_STRING_CHG_OWN_NOTE_MSG,oneffice_cloud_myInfoData.name,b)),loadChgOwn(!1,!1)):cmnCtrlToast.showToastMsg(null,"CHG_OWN_FAIL4",2,"screen_center")},
null);cmnMsg.hideMsg();cmnDlg.close()},function(){cmnMsg.hideMsg()})};cmnDlg.viewBasicDlg(b,oneffice_cloud_currNEditNumber,ID_RES_STRING_CHG_OWN,getChgOwnReqDlgContent(),[ID_RES_DIALOG_BTN_OK],[function(){var b="";(a=oneffice_cloud_shareIDList.concat(oneffice_cloud_mygroup_shareIDList))?b||1===a.length||(b=ID_RES_STRING_CHG_OWN_SEL_ERR1):b=ID_RES_STRING_CHG_OWN_SEL_ERR0;a=a[0];b||a.empSeq!==oneffice_cloud_myInfoData.id||(b=ID_RES_STRING_CHG_OWN_SEL_ERR2);b?cmnCtrlToast.showToastMsg(null,b,2,"screen_center"):
h()}],function(){oneffice_cloud_shareLinkPermItemOpened=!1;initOrgSelectedItem();addOrgSelectedEvent();document.getElementById("dze_idx_share_document_selected_user_input").focus()},null,!0)}}}catch(l){dalert(l)}}
function viewChgOwnResDlg(b){try{if(b&&dzeUiConfig.bUseChgOwn){var a=function(a){return!0===g_browserCHK.mobile?cmnMsg.showMsg("check",a,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg()}):cmnCtrlToast.showToastMsg(null,a,2,"screen_center",!0,TOAST_TYPE_OPTION_OK)},c=function(a){return!0===g_browserCHK.mobile?cmnMsg.showMsg("alert",a,null,[ID_RES_DIALOG_BTN_OK],function(){cmnMsg.hideMsg()}):cmnCtrlToast.showToastMsg(null,a,2,"screen_center",!0,TOAST_TYPE_OPTION_ERROR)},d=function(){cmnDlg.viewBasicDlg(null,
oneffice_cloud_currNEditNumber,ID_RES_STRING_CHG_OWN_SEL_FOLDER,getMoveFileContent(),[ID_RES_CONST_STRING_NEW_FOLDER,ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],[function(){onefficeGW.addNewFolderInputOnFolderTree(function(a,b){})},function(){var d=document.getElementById("dze_idx_save_folder_seq_form");d&&onefficeGW.changeOwner(b.req_id,"accept",d.value,function(d){var e=g_arrOpendToast[b.req_id];e&&(toastr.clear(e),delete g_arrOpendToast[b.req_id]);if(d&&0<d.count){a(ID_RES_STRING_CHG_OWN_TOAST1);
updateFileList(oneffice_cloud_currFolderSeq,!1);var f=d.doc_no_list;if(f){var l=g_updateListSuccessCB,k=oneffice_cloud_currFolderSeq;g_updateListSuccessCB=function(){l.apply(this,arguments);k===oneffice_cloud_currFolderSeq&&oneffice.getListViewMgr().selectFile(f);g_updateListSuccessCB=l}}}else c(ID_RES_STRING_CHG_OWN_TOAST6)},null);duzon_dialog.closeDialog()},function(){duzon_dialog.closeDialog()}],function(){onefficeGW.viewFolderTree(document.getElementById("dze_idx_folder_tree"),!0)},function(){},
!0)};cmnMsg.showMsg("confirm",String.format(ID_RES_STRING_CHG_OWN_POP_ACCEPT,b.org_owner_name),null,[ID_RES_CONST_STRING_ACCEPT,ID_RES_CONST_STRING_DENY],function(){d();cmnMsg.hideMsg()},function(){onefficeGW.changeOwner(b.req_id,"reject","",function(){c(ID_RES_STRING_CHG_OWN_TOAST2);var a=g_arrOpendToast[b.req_id];a&&(toastr.clear(a),delete g_arrOpendToast[b.req_id])},null);cmnMsg.hideMsg()})}}catch(f){dalert(f)}}
function viewChgOwnCancelDlg(b){try{if(dzeUiConfig.bUseChgOwn&&!isTempFileSelected(!0)){var a=oneffice_cloud_chgOwnInfo.req_doc_list;if(a){var c=[];b=oneffice_cloud_checkedItemList;for(var d=0,f=b.length;d<f;d++){var e=b[d].seq;-1<a.indexOf(e)&&c.push(e)}0>=c.length||cmnMsg.showMsg("alert",ID_RES_STRING_CHG_OWN_POP_CANCEL,null,[ID_RES_DIALOG_BTN_OK,ID_RES_DIALOG_BTN_CANCEL],function(){onefficeGW.cancelChangeOwner(c,function(){cmnCtrlToast.showToastMsg(null,ID_RES_STRING_CHG_OWN_TOAST3,2,"screen_center",
!0,TOAST_TYPE_OPTION_ERROR);loadChgOwn()},null);cmnMsg.hideMsg()},function(){cmnMsg.hideMsg()})}}}catch(g){dalert(g)}}function check1Day(){try{if("undefined"==typeof localStorage)return!0;for(var b="",a=(new Date).getTime(),c="",d=0,f=localStorage.length;d<f;d++)if(b=localStorage.key(d),"compatibility2Weeks"==b&&(c=duzon_http.parseJSON(localStorage.getItem(b)),864E5>a-c))return!1;return!0}catch(e){dalert(e)}}
function showCompatibilityGuide(){try{var b=makeCompatibilityHTML();b.style.zIndex=3E4;document.body.appendChild(b)}catch(a){dalert(a)}}function onChromeDownload(){window.open("https://www.google.com/intl/ko/chrome/","_blank")}function onCompatibilityClose(){dzeJ(".compatibility_main_popup").slideUp(300,function(){dzeJ(".compatibility_main_popup").remove()});var b=(new Date).getTime();localStorage.setItem("compatibility2Weeks",b)}
function makeCompatibilityHTML(){try{var b=document.createElement("div");b.className="compatibility_main_popup";var a="";a+="<img style='float: left; margin: 25px 5px 0 30px;' src='./image/cloud/oneffice_comp_icon.png' />";g_bBrowserType_IE?(a+="<p class='compatibility_info_big' style='margin-bottom: 15px; margin-top: 22px; font-family:\"\ub9d1\uc740 \uace0\ub515\"; letter-spacing: -1.5px;'>\ub294 \ud06c\ub86c \ube0c\ub77c\uc6b0\uc800\uc5d0 \ucd5c\uc801\ud654 \ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4.</p>",
a+="<p class='compatibility_info_small' style='margin-bottom: 4px; font-family:\"\ub9d1\uc740 \uace0\ub515\"; letter-spacing: -1px;'>IE\ube0c\ub77c\uc6b0\uc800 \uc81c\uacf5\uc0ac\uc758 \uae30\uc220 \uc9c0\uc6d0 \ubd80\uc7ac\ub85c \uc77c\ubd80 \uae30\ub2a5\uc774 \uc815\uc0c1 \ub3d9\uc791\ud558\uc9c0 \uc54a\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>",a+="<p class='compatibility_info_small' style='font-family:\"\ub9d1\uc740 \uace0\ub515\"; letter-spacing: -1px;'>\ud06c\ub86c \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c ONEFFICE\ub97c \uc0ac\uc6a9\ud558\uc2dc\uba74 \uc548\uc815\uc801\uc774\uace0 \ube60\ub978 \ubb38\uc11c \uc791\uc131\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4.</p>"):
(a+="<p class='compatibility_info_big' style='margin-bottom: 15px;'>\ub294 \ud06c\ub86c \ube0c\ub77c\uc6b0\uc800\uc5d0 \ucd5c\uc801\ud654 \ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4.</p>",a+="<p class='compatibility_info_small' style='margin-bottom: 4px;'>\uae30\ud0c0 \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c\ub294 \uc77c\ubd80 \uae30\ub2a5\uc774 \uc815\uc0c1 \uc791\ub3d9\ud558\uc9c0 \uc54a\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p>",a+="<p class='compatibility_info_small'>\ud06c\ub86c \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c ONEFFICE\ub97c \uc0ac\uc6a9\ud558\uc2dc\uba74 \uc548\uc815\uc801\uc774\uace0 \ube60\ub978 \ubb38\uc11c \uc791\uc131\uc774 \uac00\ub2a5\ud569\ub2c8\ub2e4.</p>");
a+="<div onclick='onChromeDownload();' class='compatibility_download_btn'>CHROME \ub2e4\uc6b4\ub85c\ub4dc</div>";b.innerHTML=a+"<img style='float: right; position: absolute; bottom: 0px; right: 0px;' src='./image/cloud/oneffice_comp_chrome_logo.png' /><img onclick='onCompatibilityClose();' class='compatibility_close_btn' src='./image/cloud/oneffice_comp_close.png'/>";return b}catch(c){dalert(c)}}
function updateTemplateListSize(b){try{var a=document.getElementById("dze_idx_toolbar_menu_list"),c=document.getElementById("dze_idx_filelist_container"),d=document.getElementById("dze_idx_top_panel"),f=document.getElementById("idx_home_cloud_more_att"),e=document.getElementById("dze_idx_new_template_more_btn_text"),g=document.getElementById("dze_idx_cloud_template_list_panel");a&&c&&d||dalert("null Container");if(b){var h=document.getElementById("template_top_table").offsetHeight,l=document.getElementById("dze_idx_browser_right_container").offsetHeight-
(h+60+35);changeCss("#dze_idx_cloud_template_list_panel","height",l+"px",document);changeCss("#dze_idx_cloud_template_list_panel","overflow","auto",document);f.src="./image/cloud/icon-close-arr.png";e.innerText=ID_RES_ADJUST_VIEW_CLOSE+" ";dzeJ("#dze_idx_filelist_search").hide();dzeJ("#dze_idx_top_panel").animate({height:"100%"},600,function(){changeCss(".cloud_container","min-width","740px",document);setTemplateScrollEventHandler()})}else{f.src="./image/cloud/icon-more-arr.png";e.innerText=ID_RED_CONST_STRING_VIEW_MORE+
" ";changeCss("#dze_idx_cloud_template_list_panel","overflow","hidden",document);c=document.getElementById("dze_idx_filelist");"none"!==c.style.display&&changeCss(".cloud_container","min-width","1024px",document);var k=document.getElementById("dze_idx_cloud_template_scrollbar");k.style.opacity=0;k.style.display="none";k.style.top="0px";g.removeEventListener("scroll",function(){},!1);dzeJ("#dze_idx_top_panel").animate({height:"300px"},600,function(){dzeJ("#dze_idx_filelist_search").show();changeCss("#dze_idx_cloud_template_list_panel",
"height","280px",document);g.scrollTop=0})}}catch(n){dalert("updateTemplateListSize = "+n)}};
